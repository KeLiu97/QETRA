originalTitle,body,reformulatedTitle
Interface 'go' with C libraries," How does one interface a Go program with a C library?I've been browsing Go's source code but I still didn't figured it out. If someone has already done so, could you share, please?UPDATED: Thanks to @fserb, I am posting some documentation from the Go sources: Cgo enables the creation of Go packages that call C code. Usage: cgo [compiler options] file.go The compiler options are passed through uninterpreted when invoking gcc to compile the C parts of the package. The input file.go is a syntactically valid Go source file that imports the pseudo-package ""C"" and then refers to types such as C.size_t, variables such as C.stdout, or functions such as C.putchar. If the import of ""C"" is immediately preceded by a comment, that comment is used as a header when compiling the C parts of the package. For example: Cgo transforms the input file into four output files: two Go source files, a C file for 6c (or 8c or 5c), and a C file for gcc. The standard package makefile rules in Make.pkg automate the process of using cgo. See $GOROOT/misc/cgo/stdio and $GOROOT/misc/cgo/gmp for examples. Cgo does not yet work with gccgo. <code>  // #include <stdio.h>// #include <errno.h>import ""C""",Interface Go with C libraries
Go: Cannot use (type struct) as (type interface)  in field value," I have the following code: When I try to compile, I get the following error: If I comment the offending line out, it compiles and runs fine. What's happening here? What am I missing? <code>  // eventloop.gotype Object interface { ActivateSlot(name string, parameters vector.Vector);}// main.goimport loop ""./eventloop""// ...const slotname = ""printer""type printer struct { slot loop.Slot;}func (p *printer) Init() { p.slot = loop.Slot{slotname, p}; // offending line}func (p *printer) ActivateSlot(name string, parameters vector.Vector) { fmt.Println(""Slot called: "", name); } jurily@jurily ~/workspace/go $ ./build.shmain.go:23: cannot use p (type *printer) as type *eventloop.Object in field value",Cannot use (*struct) as (*interface) in field value
Go: Cannot use (*struct) as (*interface) in field value," I have the following code: When I try to compile, I get the following error: If I comment the offending line out, it compiles and runs fine. What's happening here? What am I missing? <code>  // eventloop.gotype Object interface { ActivateSlot(name string, parameters vector.Vector);}// main.goimport loop ""./eventloop""// ...const slotname = ""printer""type printer struct { slot loop.Slot;}func (p *printer) Init() { p.slot = loop.Slot{slotname, p}; // offending line}func (p *printer) ActivateSlot(name string, parameters vector.Vector) { fmt.Println(""Slot called: "", name); } jurily@jurily ~/workspace/go $ ./build.shmain.go:23: cannot use p (type *printer) as type *eventloop.Object in field value",Cannot use (*struct) as (*interface) in field value
"Checking if a channel has a ready-to-read value, using Go."," How do I check whether a channel has a value for me to read?I don't want to block when reading a channel. I want to see whether it has a value. If it does have one, I'll read it. If it doesn't have one (yet), I'll do something else and check back again later. <code> ","Checking if a channel has a ready-to-read value, using Go"
Null value in golang," How do you express a ""null"" value in Go? And I want to say <code>  type Node struct { next *Node data interface{}} return &Node{ data: NULL, next: NULL }","How do you express a ""null"" value in Go?"
Null value in Go," How do you express a ""null"" value in Go? And I want to say <code>  type Node struct { next *Node data interface{}} return &Node{ data: NULL, next: NULL }","How do you express a ""null"" value in Go?"
How do I print the pointer value of a Go object?," I am just playing around with Go and do not yet have a good mental model of when structs are passed by value or by reference.This may be a very dumb question but I just want to experiment a bit and see if I am still working on the same object or I have made a copy of it (passed it by value).Is there a way to print the pointer (or internal id if pointer value is changed by gc) of an object? gives on my windows (8g compiled version): Why does the pointer value from within the go routine show a different value? The quantity on the original object did get changed so it was working with the same object. Is there a way to see an object id that is persistent? <code>  package mainimport ( ""runtime"" )type Something struct { number int queue chan int}func gotest( s *Something, done chan bool ) { println( ""from gotest:"") println( &s ) for num := range s.queue { println( num ) s.number = num } done <- true}func main() { runtime.GOMAXPROCS(4) s := new(Something) println(&s) s.queue = make(chan int) done := make(chan bool) go gotest(s, done) s.queue <- 42 close(s.queue) <- done println(&s) println(s.number)} 0x4930d4from gotest:0x4974d8420x4930d442",How do I print the pointer value of a Go object? What does the pointer value mean?
Go: Is there a way to avoid the implementation of the full sort.Interface for slices of structs?, If I have an array/slice of structs in Go and want to sort them using the sort package it seems to me that I need to implement the whole sort interface which contains 3 methods:LenSwapLessIt seems that Len and Swap should always have the same implementation no matter the type of struct is in the array.Is there a way to avoid having the implement Len and Swap every time or is this just a limitation from the lack of Generics in Go? <code> ,Is there a way to avoid the implementation of the full sort.Interface for slices of structs?
"in golang, how to determine an interface{} value's ""real"" type?"," I have not found a good resource for using interface{} types. For example Do you know of a good introduction to using Go's interface{}?specific questions:how do I get the ""real"" Type of w?is there any way to get the string representation of a type?is there any way to use the string representation of a type toconvert a value? <code>  package mainimport ""fmt""func weirdFunc(i int) interface{} { if i == 0 { return ""zero"" } return i}func main() { var i = 5 var w = weirdFunc(5) // this example works! if tmp, ok := w.(int); ok { i += tmp } fmt.Println(""i ="", i)}","How to determine an interface{} value's ""real"" type?"
What does the '.' in a go import statement do?," In the Go tutorial, and most of the Go code I've looked at, packages are imported like this: But in http://bazaar.launchpad.net/~niemeyer/lpad/trunk/view/head:/session_test.go, the gocheck package is imported with a . (period): What is the significance of the . (period)? <code>  import ( ""fmt"" ""os"" ""launchpad.net/lpad"" ...) import ( ""http"" . ""launchpad.net/gocheck"" ""launchpad.net/lpad"" ""os"" )",What does the '.' (dot or period) in a Go import statement do?
What does the '.' (dot or period) in a go import statement do?," In the Go tutorial, and most of the Go code I've looked at, packages are imported like this: But in http://bazaar.launchpad.net/~niemeyer/lpad/trunk/view/head:/session_test.go, the gocheck package is imported with a . (period): What is the significance of the . (period)? <code>  import ( ""fmt"" ""os"" ""launchpad.net/lpad"" ...) import ( ""http"" . ""launchpad.net/gocheck"" ""launchpad.net/lpad"" ""os"" )",What does the '.' (dot or period) in a Go import statement do?
Grouping of constants in Go language, What is preferred (or right) way to group large number of related constants in the Go language? For example C# and C++ both have enum for this. <code> ,Create an enum from a group of related constants in Go
Dose go language have function (method) overloading," I'm porting a C library to Go. A C function (with varargs) is defined like this: So I created wrapper C functions: If I define function in Go like this: The Go compiler complains: So does Go support function (method) overloading, or does this error mean something else?  <code>  curl_easy_setopt(CURL *curl, CURLoption option, ...); curl_wrapper_easy_setopt_str(CURL *curl, CURLoption option, char* param);curl_wrapper_easy_setopt_long(CURL *curl, CURLoption option, long param); func (e *Easy)SetOption(option Option, param string) { e.code = Code(C.curl_wrapper_easy_setopt_str(e.curl, C.CURLoption(option), C.CString(param)))}func (e *Easy)SetOption(option Option, param long) { e.code = Code(C.curl_wrapper_easy_setopt_long(e.curl, C.CURLoption(option), C.long(param)))} *EasySetOption redeclared in this block",Does the Go language have function/method overloading?
Does the language Go  have function/method overloading?," I'm porting a C library to Go. A C function (with varargs) is defined like this: So I created wrapper C functions: If I define function in Go like this: The Go compiler complains: So does Go support function (method) overloading, or does this error mean something else?  <code>  curl_easy_setopt(CURL *curl, CURLoption option, ...); curl_wrapper_easy_setopt_str(CURL *curl, CURLoption option, char* param);curl_wrapper_easy_setopt_long(CURL *curl, CURLoption option, long param); func (e *Easy)SetOption(option Option, param string) { e.code = Code(C.curl_wrapper_easy_setopt_str(e.curl, C.CURLoption(option), C.CString(param)))}func (e *Easy)SetOption(option Option, param long) { e.code = Code(C.curl_wrapper_easy_setopt_long(e.curl, C.CURLoption(option), C.long(param)))} *EasySetOption redeclared in this block",Does the Go language have function/method overloading?
Does the language Go have function/method overloading?," I'm porting a C library to Go. A C function (with varargs) is defined like this: So I created wrapper C functions: If I define function in Go like this: The Go compiler complains: So does Go support function (method) overloading, or does this error mean something else?  <code>  curl_easy_setopt(CURL *curl, CURLoption option, ...); curl_wrapper_easy_setopt_str(CURL *curl, CURLoption option, char* param);curl_wrapper_easy_setopt_long(CURL *curl, CURLoption option, long param); func (e *Easy)SetOption(option Option, param string) { e.code = Code(C.curl_wrapper_easy_setopt_str(e.curl, C.CURLoption(option), C.CString(param)))}func (e *Easy)SetOption(option Option, param long) { e.code = Code(C.curl_wrapper_easy_setopt_long(e.curl, C.CURLoption(option), C.long(param)))} *EasySetOption redeclared in this block",Does the Go language have function/method overloading?
how work type conversion in go?," how to convert go's type from uint8 to unit32?Just code: ~>6g test.go && 6l -o test test.6 && ./test test.go:10: cannot convert uInt8 (type []uint8) to type uint32 <code>  package mainimport ( ""fmt"")func main() { uInt8 := []uint8{0,1,2,3} var uInt32 uint32 uInt32 = uint32(uInt8) fmt.Printf(""%v to %v\n"", uInt8, uInt32)}",How to convert [4]uint8 into uint32 in Go?
How does type conversion work in go?," how to convert go's type from uint8 to unit32?Just code: ~>6g test.go && 6l -o test test.6 && ./test test.go:10: cannot convert uInt8 (type []uint8) to type uint32 <code>  package mainimport ( ""fmt"")func main() { uInt8 := []uint8{0,1,2,3} var uInt32 uint32 uInt32 = uint32(uInt8) fmt.Printf(""%v to %v\n"", uInt8, uInt32)}",How to convert [4]uint8 into uint32 in Go?
Go: copying all elements of a map into another," Given I can copy all entries from src into dst by doing Is there a more idiomatic way to do this?copy only works on slices (and string as a source). <code>  var dst, src map[K]V for k, v := range src { dst[k] = v}",Copying all elements of a map into another
How to replace a single char inside a string - golang," I am getting a physical location address from a user and trying to arrange it to create a URL that would use later to get a JSON response from Google Geocode API.The final URL string result should be similar to this one, without spaces: http://maps.googleapis.com/maps/api/geocode/json?address=1600+Amphitheatre+Parkway,+Mountain+View,+CA&sensor=trueI do not know how to replace white spaces in my URL string and have commas instead. I did read a little about the strings and regexp packages and I have created the following code:  <code>  package mainimport ( ""fmt"" ""bufio"" ""os"" ""http"")func main() { // Get the physical address r := bufio.NewReader(os.Stdin) fmt.Println(""Enter a physical location address: "") line, _, _ := r.ReadLine() // Print the inputted address address := string(line) fmt.Println(address) // Need to see what I'm getting // Create the URL and get Google's Geocode API JSON response for that address URL := ""http://maps.googleapis.com/maps/api/geocode/json?address="" + address + ""&sensor=true"" fmt.Println(URL) result, _ := http.Get(URL) fmt.Println(result) // To see what I'm getting at this point}",How to replace a single character inside a string in Golang?
Go append []byte arrays," I recently tried appending two byte array slices in Go and came across some odd errors. My code is: And the errors are: Which taken into consideration the alleged robustness of Go's slices shouldn't be a problem:http://code.google.com/p/go-wiki/wiki/SliceTricksWhat am I doing wrong, and how should I go about appending two byte arrays? <code>  one:=make([]byte, 2)two:=make([]byte, 2)one[0]=0x00one[1]=0x01two[0]=0x02two[1]=0x03log.Printf(""%X"", append(one[:], two[:]))three:=[]byte{0, 1}four:=[]byte{2, 3}five:=append(three, four) cannot use four (type []uint8) as type uint8 in appendcannot use two[:] (type []uint8) as type uint8 in append",How can I use Go append with two []byte slices or arrays?
How to convert (translate) C to Go?," What tool to use to convert C source code into Go source code?For example, if the C code contains: the corresponding Go code generated by the tool should be: The tool does not need to be perfect. It is OK if some parts of the generated Go code need to be corrected by hand. <code>  struct Node { struct Node *left, *right; void *data;};char charAt(char *s, int i) { return s[i];} type Node struct { left, right *Node data interface{}}func charAt(s string, i int) byte { return s[i]}",Tool to convert (translate) C to Go?
Git - Ignore compiled Google Go, My compiled Go code does not end with an extension on Linux. Any tips for handling ignoring these in the .gitignore file? <code> ,Git: Ignore compiled Google Go
"Any nice way to simulate ""Maybe"" or ""option"" type in Go?"," I'm sending a reply to a request over a chan X, where X is a struct. The request is a search operation, so ideally I'd like to be able to return either an X, or report it wasn't found.This would be a task for a Maybe X in Haskell or an x option in OCaml. Is there any decent way to do this in Go? I'm not returning a pointer (as the original object I'm returning might be modified later), so I can't just return nil.Edit: right now I'm making it a chan interface{} and either sending an X or nil, but this is ugly and defeats type-safety. <code> ","Is there a nice way to simulate a ""Maybe"" or ""option"" type in Go?"
How to use leveldb in golang?," From http://code.google.com/p/leveldb/, it seems not explicit or easy to use LevelDB with Go.But I really want to know how to use it in Go.Could anyone give me a clue? <code> ",How to use LevelDB in go?
golang: format a string without printing?," Is there a simple way to format a string in Go without printing the string?I can do: But I want the formatted string returned rather than printed so I can manipulate it further.I could also do something like: But this becomes difficult to read when the format string is complex, and cumbersome when one or many of the parts aren't strings and have to be converted first, like Is there a simpler way to do this? <code>  bar := ""bar""fmt.Printf(""foo: %s"", bar) s := ""foo: "" + bar i := 25s := ""foo: "" + strconv.Itoa(i)",Format a Go string without printing?
Golang: format a string without printing?," Is there a simple way to format a string in Go without printing the string?I can do: But I want the formatted string returned rather than printed so I can manipulate it further.I could also do something like: But this becomes difficult to read when the format string is complex, and cumbersome when one or many of the parts aren't strings and have to be converted first, like Is there a simpler way to do this? <code>  bar := ""bar""fmt.Printf(""foo: %s"", bar) s := ""foo: "" + bar i := 25s := ""foo: "" + strconv.Itoa(i)",Format a Go string without printing?
Python style generators in Go," I'm currently working through the Tour of Go, and I thought that goroutines have been used similarly to Python generators, particularly with Question 66. I thought 66 looked complex, so I rewrote it to this: This seems to work. A couple of questions:If I turn up the buffer size on the channel to say, 10, fibonacci would fill up 10 further spots, as quickly as possible, and main would eat up the spots as quickly as it could go. Is this right? This would be more performant than a buffer size of 1 at the expense of memory, correct?As the channel doesn't get closed by the fibonacci sender, what happens memory-wise when we go out of scope here? My expectation is that once c and go fibonacci is out of scope, the channel and everything on it gets garbage-collected. My gut tells me this is probably not what happens. <code>  package mainimport ""fmt""func fibonacci(c chan int) { x, y := 1, 1 for { c <- x x, y = y, x + y }}func main() { c := make(chan int) go fibonacci(c) for i := 0; i < 10; i++ { fmt.Println(<-c) }}",Python-style generators in Go
Is it possible to have nested templates in Go using the standard library? (Google App Engine)," How do I get nested templates like Jinja has in the python runtime. TBC what I mean is how do I have a bunch of templates inherit from a base templates, just filing in blocks of the base templates, like Jinja/django-templates does. Is it possible using just html/template in the standard library.If that is not a possibility, what are my alternatives. Mustache seems to be an option but would I then be missing out on those nice subtle features of html/template like the context sensitive escaping etc.? What other alternatives are ther?(Environment: Google App Engin, Go runtime v1, Dev - Mac OSx lion)Thanks for reading. <code> ",Is it possible to have nested templates in Go using the standard library?
golang: find the path to the executable," I compile a program with Go for various platforms and run it by calling a relative path or just by its name (if it is in the PATH variable).Is it possible to find out where the executable is?Say, my program is called ""foo(.exe)"". I can run ./foo, foo (if it's in the PATH), ../../subdir/subdir/foo.I have tried to use os.Args[0] and I guess I should check if the program name contains something different besides ""foo"". If yes, use filepath.Abs, if no, use (I can't find the function name, there is a function that looks through the PATH to check where the program is). <code> ",Find the path to the executable
Go: find the path to the executable," I compile a program with Go for various platforms and run it by calling a relative path or just by its name (if it is in the PATH variable).Is it possible to find out where the executable is?Say, my program is called ""foo(.exe)"". I can run ./foo, foo (if it's in the PATH), ../../subdir/subdir/foo.I have tried to use os.Args[0] and I guess I should check if the program name contains something different besides ""foo"". If yes, use filepath.Abs, if no, use (I can't find the function name, there is a function that looks through the PATH to check where the program is). <code> ",Find the path to the executable
Trimming strings in Go," I'm trying to read an entire line from the console (including whitespace), then process it. Using bufio.ReadString, the newline character is read together with the input, so I came up with the following code to trim the newline character: Is there a more idiomatic way to do this? That is, is there already a library that takes care of the ending null byte when extracting substrings for you?(Yes, I know there is already a way to read a line without the newline character in go readline -> string but I'm looking more for elegant string manipulation.) <code>  input,_:=src.ReadString('\n')inputFmt:=input[0:len(input)-2]+"""" //Need to manually add end of string",Extracting substrings in Go
What language do use to write a gaming library? (Go or Rust)," What language, between Go and Rust, would you use to create a library for games (no bindings)?Go is a simpler language that leans more heavily on garbage collection. Rust is a more complex language that can be safely used without the GC at all which is perfect for low-level systems programming. <code> ","What language use to write a gaming library, Go or Rust?"
can you pass functions as parameters in go?," In Java I can do something like and ""run"" the code in the method later. It's a pain to handle (anonymous inner class), but it can be done.Does Go have something that can facilitate a function/callback being passed in as a parameter? <code>  derp(new Runnable { public void run () { /* run this sometime later */ } })",Can functions be passed as parameters?
Can Functions be passed as parameters in Go?," In Java I can do something like and ""run"" the code in the method later. It's a pain to handle (anonymous inner class), but it can be done.Does Go have something that can facilitate a function/callback being passed in as a parameter? <code>  derp(new Runnable { public void run () { /* run this sometime later */ } })",Can functions be passed as parameters?
Type converting slices of interfaces in go," I'm curious why Go does't implicitly convert []T to []interface{} when it will implicitly convert T to interface{}. Is there something non-trivial about this conversion that I'm missing? Example: go build complains cannot use a (type []string) as type []interface {} in function argumentAnd if I try to do it explicitly, same thing: b := []interface{}(a) complains cannot convert a (type []string) to type []interface {}So every time I need to do this conversion (which seems to come up a lot), I've been doing something like this: Is there a better way to do this, or standard library functions to help with these conversions? It seems kind of silly to write 4 extra lines of code every time I want to call a function that can take a list of e.g. ints or strings. <code>  func foo([]interface{}) { /* do something */ }func main() { var a []string = []string{""hello"", ""world""} foo(a)} b = make([]interface{}, len(a), len(a))for i := range a { b[i] = a[i]}",Type converting slices of interfaces
Type converting slices of interfaces in Go," I'm curious why Go does't implicitly convert []T to []interface{} when it will implicitly convert T to interface{}. Is there something non-trivial about this conversion that I'm missing? Example: go build complains cannot use a (type []string) as type []interface {} in function argumentAnd if I try to do it explicitly, same thing: b := []interface{}(a) complains cannot convert a (type []string) to type []interface {}So every time I need to do this conversion (which seems to come up a lot), I've been doing something like this: Is there a better way to do this, or standard library functions to help with these conversions? It seems kind of silly to write 4 extra lines of code every time I want to call a function that can take a list of e.g. ints or strings. <code>  func foo([]interface{}) { /* do something */ }func main() { var a []string = []string{""hello"", ""world""} foo(a)} b = make([]interface{}, len(a), len(a))for i := range a { b[i] = a[i]}",Type converting slices of interfaces
importing packages in go," In the Go programming language, why after importing a package do I still have to prefix a method within that package with the package name?i.e. Isn't this redundant? In Java, for example, you can do things like importing Files.readAllLines etc without having Files imported. <code>  import ""io/ioutil""func main() { content, err = iotuil.ReadFile(""somefile.txt"") // etc..}","In Go, how to import function directly, without need to prefix with the package name when I call it?"
Importing packages in go," In the Go programming language, why after importing a package do I still have to prefix a method within that package with the package name?i.e. Isn't this redundant? In Java, for example, you can do things like importing Files.readAllLines etc without having Files imported. <code>  import ""io/ioutil""func main() { content, err = iotuil.ReadFile(""somefile.txt"") // etc..}","In Go, how to import function directly, without need to prefix with the package name when I call it?"
C-style macros in golang," I've been playing with go for a week and something I miss from C is preprocessor macros.What could I use to get this feature, besides hacking a build script that pipes go files through clang -E ? <code> ",C-style macros in Go
Conditional statment in GAE GO Package Template," How is it possible to perform a conditional statement in html template in GAE GO? I was trying to accomplish this to make an option selected in a select html tag: There is in the reference doc but this only evaluates to true if .Grade has value. Any help would be highly appreciated. Thanks! <code>  <select name="".Grade""> <option value=""""></option> <option value=""1"" {{ if .Grade=""1"" }} selected=""selected"" {{ end }}>Grade One</option> <option value=""2"" {{ if .Grade=""2"" }} selected=""selected"" {{ end }}>Grade Two</option> <option value=""3"" {{ if .Grade=""3"" }} selected=""selected"" {{ end }}>Grade Three</option> <option value=""4"" {{ if .Grade=""4"" }} selected=""selected"" {{ end }}>Grade Four</option> <option value=""5"" {{ if .Grade=""5"" }} selected=""selected"" {{ end }}>Grade Five</option> <option value=""6"" {{ if .Grade=""6"" }} selected=""selected"" {{ end }}>Grade Six</option></select> {{ if .Grade }} selected=""selected"" {{ end }} ",Conditional statement in GAE Go template package
Difference between net/http and net/http/cgi in Golang," What's the difference?If I use net/http/fcgi package, every request will be executed in new goroutine. It seems to be the same for net/http ListenAndServe...isn't it?What advantages and disadvantages? <code> ",Difference between net/http and net/http/fcgi in Golang
GAE Go  How to do GetMulti with non-existent entity keys?," I've found myself needing to do a GetMulti operation with an array of keys for which some entities exist, but some do not.My current code, below, returns an error (datastore: no such entity).err := datastore.GetMulti(c, keys, infos)So how can I do this? I'd use a ""get or insert"" method, but there isn't one. <code> ",GAE Go  How to use GetMulti with non-existent entity keys?
Decode base64 in golang," here is my code and i don't understand why the decode function doesn't work.Little insight would be great please. It gaves me :[Decode error - output not utf-8][Decode error - output not utf-8] <code>  func EncodeB64(message string) (retour string) { base64Text := make([]byte, base64.StdEncoding.EncodedLen(len(message))) base64.StdEncoding.Encode(base64Text, []byte(message)) return string(base64Text)}func DecodeB64(message string) (retour string) { base64Text := make([]byte, base64.StdEncoding.DecodedLen(len(message))) base64.StdEncoding.Decode(base64Text, []byte(message)) fmt.Printf(""base64: %s\n"", base64Text) return string(base64Text)}",Encode/Decode base64
"In go's http package, how do I get the query string on a POST request?", I'm using the httppackage from Go to deal with POST request. How can I access and parse the content of the query string from the Requestobject ? I can't find the answer from the official documentation. <code> ,"In Go's http package, how do I get the query string on a POST request?"
Suitable struct type for unmarshal og geojson," I want to unmarshal a geojson string into a suitable struct type.I have three different geojson strings that I want to unmarshal into the same struct: I came up with a struct type that Im not totally happy with: See this link for complete example:http://play.golang.org/p/Bt-51BX__AI would rather not use interface{} for Coordinates. I would instead use somehting that give me some validation for example Coordinates [] float64 for Pointand Coordinates[][] float64 for LineString.Is it possible to create a struct type so that Point, LineString and Polygon all can be represented in Coordinates without using interface? <code>  var jsonBlobPointString = []byte(`{""Type"":""Point"", ""Coordinates"":[1.1,2.0]}`)var jsonBlobLineString = []byte(`{""Type"":""LineString"", ""Coordinates"":[[1.1,2.0],[3.0,6.3]]}`)var jsonBlobPolygonString = []byte(`{""Type"":""Polygon"", ""Coordinates"":[[[1.1,2.0],[3.0,6.3],[5.1,7.0],[1.1,2.0]]]}`) type GeojsonType struct { Type string Coordinates interface{}}",Suitable struct type for unmarshal of geojson
"Using golang's ""compress/gzip"""," I'm new to Go, and can't figure out how to use the compress/gzip package to my advantage. Basically, I just want to write something to a file, gzip it and read it directly from the zipped format through another script. I would really appreciate if someone could give me an example on how to do this. <code> ","How can I use the ""compress/gzip"" package to gzip a file?"
"How can I use golang's ""compress/gzip"" package to gzip a file?"," I'm new to Go, and can't figure out how to use the compress/gzip package to my advantage. Basically, I just want to write something to a file, gzip it and read it directly from the zipped format through another script. I would really appreciate if someone could give me an example on how to do this. <code> ","How can I use the ""compress/gzip"" package to gzip a file?"
Is it possible to use environment variables in a cgo CLFAGS comment?," I'm attempting to write some C bindings for the Go language, and have run into a sort of sticky situation when setting up the Cgo compilation in Windows. I have code that looks like the following: which is allows me to avoid installing Dlls, libs, and header files directly into my C:\Windows directory, but doesn't allow for much flexibility when other developers are working with a different file system setup (they all need the libs to be in C:/dev/extlibs/...).Is there a way I could referent an environment variable from within the code? Perhaps something along the lines of: Or is there another way that people solve this issue that I have missed? I've spent some time googling around on this subject and haven't seen much that has been useful, so any information and/or resources could be a real help! <code>  // #cgo windows CFLAGS: -I C:/dev/extlibs/include/// #cgo windows LDFLAGS: -lMyLib -L C:/dev/extlibs/lib/// #include <mylib/mylib.h>import ""C"" // #cgo windows CFLAGS: -I $EXTLIBS$/include/",Is it possible to use environment variables in a cgo CFLAGS comment?
How can I open a file using a relative path in Go?," I'm using io/ioutil to read a small text file: And that works fine, but this isn't exactly portable. In my case, the files I want to open are in my GOPATH, for example: Since the data folder rides right alongside the source code, I'd love to just specify the relative path: But then I get this error: panic: open data/file.txt: no such file or directoryHow can I open files using their relative path, especially if they live alongside my Go code?(Note that my question is specifically about opening files relative to the GOPATH. Opening files using any relative path in Go is as easy as giving the relative path instead of an absolute path; files are opened relative to the compiled binary's working directory. In my case, I want to open files relative to where the binary was compiled. In hindsight, this is a bad design decision.) <code>  fileBytes, err := ioutil.ReadFile(""/absolute/path/to/file.txt"") /Users/matt/Dev/go/src/github.com/mholt/mypackage/data/file.txt data/file.txt",How can I open files relative to my GOPATH?
How can I open files using a relative paths in Go?," I'm using io/ioutil to read a small text file: And that works fine, but this isn't exactly portable. In my case, the files I want to open are in my GOPATH, for example: Since the data folder rides right alongside the source code, I'd love to just specify the relative path: But then I get this error: panic: open data/file.txt: no such file or directoryHow can I open files using their relative path, especially if they live alongside my Go code?(Note that my question is specifically about opening files relative to the GOPATH. Opening files using any relative path in Go is as easy as giving the relative path instead of an absolute path; files are opened relative to the compiled binary's working directory. In my case, I want to open files relative to where the binary was compiled. In hindsight, this is a bad design decision.) <code>  fileBytes, err := ioutil.ReadFile(""/absolute/path/to/file.txt"") /Users/matt/Dev/go/src/github.com/mholt/mypackage/data/file.txt data/file.txt",How can I open files relative to my GOPATH?
How can I open files using relative paths in Go?," I'm using io/ioutil to read a small text file: And that works fine, but this isn't exactly portable. In my case, the files I want to open are in my GOPATH, for example: Since the data folder rides right alongside the source code, I'd love to just specify the relative path: But then I get this error: panic: open data/file.txt: no such file or directoryHow can I open files using their relative path, especially if they live alongside my Go code?(Note that my question is specifically about opening files relative to the GOPATH. Opening files using any relative path in Go is as easy as giving the relative path instead of an absolute path; files are opened relative to the compiled binary's working directory. In my case, I want to open files relative to where the binary was compiled. In hindsight, this is a bad design decision.) <code>  fileBytes, err := ioutil.ReadFile(""/absolute/path/to/file.txt"") /Users/matt/Dev/go/src/github.com/mholt/mypackage/data/file.txt data/file.txt",How can I open files relative to my GOPATH?
Chaining functions in Go / Golang?," I tried doing this: But I got these errors: Why can't I make this chain work? <code>  package mainimport ( ""fmt"" ""strings"")type String stringfunc (s *String) tolower() String { *s = String(strings.ToLower(string(*s))) return *s}func (s *String) toupper() String { *s = String(strings.ToUpper(string(*s))) return *s}func main() { var s String = ""ASDF"" (s.tolower()).toupper() // this fails // s.toupper();s.tolower(); // this works // s.tolower().toupper() // this fails too fmt.Println(s)} prog.go:30: cannot call pointer method on s.tolower()prog.go:30: cannot take the address of s.tolower()Program exited.",Chaining functions in Go?
What this code does in go?," When I was reading: http://golang.org/doc/effective_go.html#errorsI found such line: err.(*os.PathError) in this context: What exactly is err.(*os.PathError) in Go? <code>  for try := 0; try < 2; try++ { file, err = os.Create(filename) if err == nil { return } if e, ok := err.(*os.PathError); ok && e.Err == syscall.ENOSPC { deleteTempFiles() // Recover some space. continue } return }",What is err.(*os.PathError) in Go?
GOlang: how to follow location with cookie," In case the response to an http request is a redirection (http code 302) with a cookie,how can you instruct your Go client to follow the new location with the cookie that has been received?in CURL, this can be easily achieved by setting the client with: how can you do that in Go? <code>  COOKIEFILE = """" AUTOREFERER = 1 FOLLOWLOCATION = 1",Golang: how to follow location with cookie
Golang: How to Get the Directory of the Currently running File?," In nodejs I use __dirname . What is the equivalent of this in Golang?I have googled and found out this article http://andrewbrookins.com/tech/golang-get-directory-of-the-current-file/ . Where he uses below code But is it the right way or idiomatic way to do in Golang? <code>  _, filename, _, _ := runtime.Caller(1)f, err := os.Open(path.Join(path.Dir(filename), ""data.csv""))",How to get the directory of the currently running file?
the best way to test for an empty string in GO?," Which method is best (most idomatic) for testing non-empty strings (in Go)? Or: Or something else? <code>  if len(mystring) > 0 { } if mystring != """" { }",What is the best way to test for an empty string in Go?
"In golang, how to define multiple name tags in a struct"," I need to get an item from a mongo database, so I defined a struct like this Now I also need to encode it to JSON, but it encodes the fields as uppercase (i get PageId instead of pageId) so i also need to define field tags for JSON. I tried something like this but it didn't work: So how can this be done, define multiple name tags in a struct? <code>  type Page struct { PageId string `bson:""pageId""` Meta map[string]interface{} `bson:""meta""`} type Page struct { PageId string `bson:""pageId"",json:""pageId""` Meta map[string]interface{} `bson:""meta"",json:""pageId""`}",How to define multiple name tags in a struct
Why this small code gives a deadlock," I'm sure that there is a simple explanation to this trivial situation, but I'm new to the go concurrency model.when I run this example I get this error : Why ?Wrapping c <- in a goroutine makes the example run as we expected Again, why ?Please, I need deep explanation , not just how to eliminate the deadlock and fix the code.  <code>  package mainimport ""fmt""func main() { c := make(chan int) c <- 1 fmt.Println(<-c)} fatal error: all goroutines are asleep - deadlock!goroutine 1 [chan send]:main.main() /home/tarrsalah/src/go/src/github.com/tarrsalah/tour.golang.org/65.go:8 +0x52exit status 2 package mainimport ""fmt""func main() { c := make(chan int) go func(){ c <- 1 }() fmt.Println(<-c)}",Why does the use of an unbuffered channel in the same goroutine result in a deadlock?
Why using unbuffered channel in the the same goroutine gives a deadlock," I'm sure that there is a simple explanation to this trivial situation, but I'm new to the go concurrency model.when I run this example I get this error : Why ?Wrapping c <- in a goroutine makes the example run as we expected Again, why ?Please, I need deep explanation , not just how to eliminate the deadlock and fix the code.  <code>  package mainimport ""fmt""func main() { c := make(chan int) c <- 1 fmt.Println(<-c)} fatal error: all goroutines are asleep - deadlock!goroutine 1 [chan send]:main.main() /home/tarrsalah/src/go/src/github.com/tarrsalah/tour.golang.org/65.go:8 +0x52exit status 2 package mainimport ""fmt""func main() { c := make(chan int) go func(){ c <- 1 }() fmt.Println(<-c)}",Why does the use of an unbuffered channel in the same goroutine result in a deadlock?
Why using unbuffered channel in the same goroutine gives a deadlock," I'm sure that there is a simple explanation to this trivial situation, but I'm new to the go concurrency model.when I run this example I get this error : Why ?Wrapping c <- in a goroutine makes the example run as we expected Again, why ?Please, I need deep explanation , not just how to eliminate the deadlock and fix the code.  <code>  package mainimport ""fmt""func main() { c := make(chan int) c <- 1 fmt.Println(<-c)} fatal error: all goroutines are asleep - deadlock!goroutine 1 [chan send]:main.main() /home/tarrsalah/src/go/src/github.com/tarrsalah/tour.golang.org/65.go:8 +0x52exit status 2 package mainimport ""fmt""func main() { c := make(chan int) go func(){ c <- 1 }() fmt.Println(<-c)}",Why does the use of an unbuffered channel in the same goroutine result in a deadlock?
GoLang: Access struct property by name," Here is a simple go program that is not working : Error: prog.go:18: invalid operation: v[property] (index of type *Vertex)What I want is to access the Vertex X property using its name. If I do v.X it works, but v[""X""] doesn't. Can someone tell me how to make this work ? <code>  package mainimport ""fmt""type Vertex struct { X int Y int}func main() { v := Vertex{1, 2} fmt.Println(getProperty(&v, ""X""))}func getProperty(v *Vertex, property string) (string) { return v[property]}",Access struct property by name
How to dump goroutine stacktrace?," I have Java background, and I love to use signal QUIT to inspect Java thread dump.How to let Golang print out all goroutines stack trace? <code> ",How to dump goroutine stacktraces?
Indentation in Go," Is there a standard Google Go coding conventions document somewhere that sets whether tabs or spaces are preferred for indentation in Go source code?What is the official recommendation, if any? <code> ",Indentation in Go: tabs or spaces?
Mock functions in Golang," I'm puzzled with dependencies. I want to be able to replace some function calls with mock ones. Here's a snippet of my code: I'd like to be able to test downloader() without actually getting a page through http - i.e. by mocking either get_page (easier since it returns just the page content as a string) or http.Get().I found this thread which seems to be about a similar problem. Julian Phillips presents his library, Withmock as a solution, but I'm unable to get it to work. Here's the relevant parts of my testing code, which is largely cargo cult code to me, to be honest: The test output is following:ERROR: Failed to install '_et/http': exit status 1 output: can't loadpackage: package _et/http: found packages http (chunked.go) and main(main_mock.go) in/var/folders/z9/ql_yn5h550s6shtb9c5sggj40000gn/T/withmock570825607/path/src/_et/httpIs the Withmock a solution to my testing problem? What should I do to get it to work? <code>  func get_page(url string) string { get_dl_slot(url) defer free_dl_slot(url) resp, err := http.Get(url) if err != nil { return """" } defer resp.Body.Close() contents, err := ioutil.ReadAll(resp.Body) if err != nil { return """" } return string(contents)}func downloader() { dl_slots = make(chan bool, DL_SLOT_AMOUNT) // Init the download slot semaphore content := get_page(BASE_URL) links_regexp := regexp.MustCompile(LIST_LINK_REGEXP) matches := links_regexp.FindAllStringSubmatch(content, -1) for _, match := range matches{ go serie_dl(match[1], match[2]) }} import ( ""testing"" ""net/http"" // mock ""code.google.com/p/gomock"")...func TestDownloader (t *testing.T) { ctrl := gomock.NewController() defer ctrl.Finish() http.MOCK().SetController(ctrl) http.EXPECT().Get(BASE_URL) downloader() // The rest to be written}",Mock functions in Go
"Golang , Go : get the type of array"," I am using reflect package to get the type of arbitrary array, but getting How do I get the type from array? I know how to get it from value. http://play.golang.org/p/sNw8aL0a5f <code>  prog.go:17: cannot use sample_array1 (type []int) as type []interface {} in function argument [process exited with non-zero status] func GetTypeArray(arr []interface{}) reflect.Type { return reflect.TypeOf(arr[0]) }",Golang: get the type of slice
Go: What does range or map return?," Go has very neat multiple return values paradigm. But It looks like v, ok := map[key] and v, k := range m use different mechanism with same notation. Here is a simple example: In above example, k := f2() gives error as f2 returns two values, whereas v, ok := m[""One""] and v := m[""One""] - both expressions work without any error.Why is that different behavior? <code>  func f2() (k, v string) { return ""Hello"", ""World""}func main(){ k := f2() // Doesn't work : multiple-value f2() in single-value context m := map[string]int{""One"": 1} // It works v, ok := m[""One""] // How it all work? v := m[""One""] for k := range m {}}",What does range or map return?
What is idiomatic go's equivalent of C's ternary operator?," In C/C++ (and many languages of that family), a common idiom to declare and initialize a variable depending on a condition uses the ternary conditional operator : Go doesn't have the conditional operator. What is the most idiomatic way to implement the same piece of code as above ? I came to the following solution, but it seems quite verbose Is there something better ? <code>  int index = val > 0 ? val : -val var index intif val > 0 { index = val} else { index = -val}",What is the idiomatic Go equivalent of C's ternary operator?
Go: json.Unmarshal nested object into string or []byte," I'm trying to Unmarshal some json so that a nested object does not get parsed but just treated as a string or []byte.So I want to get the following: Unmarshaled into: I get the following error: playground demo <code>  { ""id"" : 15, ""foo"" : { ""foo"": 123, ""bar"": ""baz"" }} type Bar struct { ID int64 `json:""id""` Foo []byte `json:""foo""`} json: cannot unmarshal object into Go value of type []uint8",json.Unmarshal nested object into string or []byte
Cyclic dependencies and interfaces in golang," I am a long time python developer. I was trying out Go, converting an existing python app to Go. It is modular and works really well for me.Upon creating the same structure in Go, I seem to land in cyclic import errors, a lot more than I want to. Never had any import problems in python. I never even had to use import aliases. So I may have had some cyclic imports which were not evident in python. I actually find that strange. Anyways, I am lost, trying to fix these in Go. I have read that interfaces can be used to avoid cyclic dependencies. But I don't understand how. I didn't find any examples on this either. Can somebody help me on this?The current python application structure is as follows: settings/database.py has generic functions like connect() which opens a db session. So an app in the apps package calls database.connect() and a db session is opened. The same is the case with settings/routes.py it has functions that allow apps to add their sub-routes to the main route object. The settings package is more about functions than data/constants. This contains code that is used by apps in the apps package, that would otherwise have to be duplicated in all the apps. So if I need to change the router class, for instance, I just have to change settings/router.py and the apps will continue to work with no modifications.  <code>  /main.py/settings/routes.py contains main routes depends on app1/routes.py, app2/routes.py etc/settings/database.py function like connect() which opens db session/settings/constants.py general constants/apps/app1/views.py url handler functions/apps/app1/models.py app specific database functions depends on settings/database.py/apps/app1/routes.py app specific routes/apps/app2/views.py url handler functions/apps/app2/models.py app specific database functions depends on settings/database.py/apps/app2/routes.py app specific routes",Cyclic dependencies and interfaces
Cyclic dependencies and interfaces in Golang," I am a long time python developer. I was trying out Go, converting an existing python app to Go. It is modular and works really well for me.Upon creating the same structure in Go, I seem to land in cyclic import errors, a lot more than I want to. Never had any import problems in python. I never even had to use import aliases. So I may have had some cyclic imports which were not evident in python. I actually find that strange. Anyways, I am lost, trying to fix these in Go. I have read that interfaces can be used to avoid cyclic dependencies. But I don't understand how. I didn't find any examples on this either. Can somebody help me on this?The current python application structure is as follows: settings/database.py has generic functions like connect() which opens a db session. So an app in the apps package calls database.connect() and a db session is opened. The same is the case with settings/routes.py it has functions that allow apps to add their sub-routes to the main route object. The settings package is more about functions than data/constants. This contains code that is used by apps in the apps package, that would otherwise have to be duplicated in all the apps. So if I need to change the router class, for instance, I just have to change settings/router.py and the apps will continue to work with no modifications.  <code>  /main.py/settings/routes.py contains main routes depends on app1/routes.py, app2/routes.py etc/settings/database.py function like connect() which opens db session/settings/constants.py general constants/apps/app1/views.py url handler functions/apps/app1/models.py app specific database functions depends on settings/database.py/apps/app1/routes.py app specific routes/apps/app2/views.py url handler functions/apps/app2/models.py app specific database functions depends on settings/database.py/apps/app2/routes.py app specific routes",Cyclic dependencies and interfaces
golang text/html template - call other templates with dynamic name," I do not see a way to call templates (text or html) with a dynamic name. Example:This works: This errors with ""unexpected ""$BlahVar"" in template invocation"": The overall problem I'm trying to solve is that I need to render templates conditionally based on a configuration file - so I don't know the names of the templates ahead of time. Obviously I can put a function in the FuncMap which just does a separate template parsing and invocation and returns that result but was wondering if there is a Better Way. <code>  {{template ""Blah"" .}} {{$BlahVar := ""Blah""}}{{template $BlahVar .}}",Call other templates with dynamic name
Equivanet to sizeof(aType) in goLang," C++ and several other languages have a function called sizeof(int) (or whatever type you need) that returns the number of bytes consumed by a particular data type, in the current system.Is there an equivalent function in Go? What is it? <code> ",Equivalent of sizeof(aType) in Go
"Go ""inheritence"" - using embedded type in a struct as a method parameter"," I'm trying to firm up the concept of inheritence that Go provides (rather ""composition"" than pure inheritence, perhaps). However, I'm failing to grasp why I can't use the ""parent"" type as a func parameter to produce a generic function that acts on the parameter. Assuming my understanding's incorrect, how can I achieve what I want in Go?EditNote: I don't want to attach the behaviour to the structI'd like to keep the pointer type as the method parameter because I'm working separately on a pet project and this requires I manipulate the struct passed in before then acting on it.In reality my Dog struct would have additional fields/members; hopefully this doesn't muddy the water further <code>  package mainimport ""log""type Animal struct { Colour string Name string}type Dog struct { Animal}func PrintColour(a *Animal) { log.Printf(""%s\n"", a.Colour)}func main () { a := new (Animal) a.Colour = ""Void"" d := new (Dog) d.Colour = ""Black"" PrintColour(a) PrintColour(d)}","Go ""inheritance"" - using anonymous type in a struct as a method parameter"
"Go ""inheritence"" - using anonymous type in a struct as a method parameter"," I'm trying to firm up the concept of inheritence that Go provides (rather ""composition"" than pure inheritence, perhaps). However, I'm failing to grasp why I can't use the ""parent"" type as a func parameter to produce a generic function that acts on the parameter. Assuming my understanding's incorrect, how can I achieve what I want in Go?EditNote: I don't want to attach the behaviour to the structI'd like to keep the pointer type as the method parameter because I'm working separately on a pet project and this requires I manipulate the struct passed in before then acting on it.In reality my Dog struct would have additional fields/members; hopefully this doesn't muddy the water further <code>  package mainimport ""log""type Animal struct { Colour string Name string}type Dog struct { Animal}func PrintColour(a *Animal) { log.Printf(""%s\n"", a.Colour)}func main () { a := new (Animal) a.Colour = ""Void"" d := new (Dog) d.Colour = ""Black"" PrintColour(a) PrintColour(d)}","Go ""inheritance"" - using anonymous type in a struct as a method parameter"
Unmarshalling JSON string into a constant in google go," In my Go code I have the following situation: My expected JSON would look like the following: Can I create a mapping such that json.Unmarshal will set the right operator constant in the Filter struct?I am aware of the Unmarshaler interface but I don't think this can really be used on a constant value..I would really like to keep the constants in my go code since this nicely enforces type checking and consistency when I pass them around. <code>  type Operator intconst ( UNKNOWN Operator = iota EQUALS CONTAINS BETWEEN DISTANCE)type Filter struct { Field string `json:""field""` Operator Operator `json:""operator""` Values []string `json:""values""`} { ""operator"": ""EQUALS"", ""field"": ""name"", ""values"": [ ""John"", ""Doe"" ]}",Unmarshalling JSON string into a constant
Why doesn't Go allow nested function declarations (functions inside functions)?," Lambdas work as expected: However, the following declaration inside a declaration is not allowed: For what reason are nested functions not allowed? <code>  func main() { inc := func(x int) int { return x+1; }} func main() { func inc(x int) int { return x+1; }}",What are the problems that are mitigated by not allowing nested function declarations in Go?
Good unit testing in Golang," I always thought that good unit test, are test that are independent. By 'independent' i mean that when function 'A' uses 'B', and we test function 'A', we mock/stub out 'B' in case when 'B' does not work correctly it will not fail 'A'.But when we check sources of golang packages that principle is not respected.For example lets check url.go and url_test.go in url packages:url.go: url_test.go: As we can see parseQuery use QueryUnescape. In test QueryUnescape is not stubbed in any way. So if QueryUnescape will work wrong, parseQuerytest will fail.So authors of package not always meet requirement of 'independent' unit test. What was the reason to not bother about this principle in this case, is there some rule that allow programmer of accepting this form of unit tests?After writing independent test in python, I'am little confused about balancing between writing perfect test(which much affects in golang about design of code) and results. <code>  func parseQuery(m Values, query string) (err error) { for query != """" { ... key, err1 := QueryUnescape(key) ... func TestParseQuery(t *testing.T) { for i, test := range parseTests { form, err := ParseQuery(test.query) ...",Good unit testing in Go
What can cause a client.Call rpc to return an error in Go?," When does c.Call(...) return a non-nil value? Can the c.Call(...) only return an error when a network failure occurs (packets lost or timed out or something along those lines)?If the server srv crashes, will c.Call(...) return an error?Specifically, can c.Call(...) return an error AFTER the request successfully arrived at srv but BEFORE the rpcname handler function returns? <code>  import ( ""net/rpc"" ""fmt"")func call(srv string, rpcname string, args interface{}, reply interface{}) bool { c, errx := rpc.Dial(""unix"", srv) if errx != nil { return false } defer c.Close() err := c.Call(rpcname, args, reply) if err == nil { return true } fmt.Println(err) return false}",What can cause a client.Call rpc to return an error in Go (golang)?
How to limit the connection count of an HTTP Server implemented in go?," I am trying to implement an HTTP Server in Golang.My problem is, I have to limit the maximum active connections count at any particular time to 20. <code> ",How to limit the connections count of an HTTP Server implemented in Go?
Golang - TLS with selfsigned certificate," I'm trying to establish a TLS connection with the use of a self signed server certificate.I generated the certificate with this example code: http://golang.org/src/pkg/crypto/tls/generate_cert.goMy relevant client code looks like that: And the relevant server code like that: Because the server certificate is self signed is use the same certificate for the server and the clients CA_Pool however this does not seem to work since i always get this error: What's my mistake? <code>  // server cert is self signed -> server_cert == ca_certCA_Pool := x509.NewCertPool()severCert, err := ioutil.ReadFile(""./cert.pem"")if err != nil { log.Fatal(""Could not load server certificate!"")}CA_Pool.AppendCertsFromPEM(severCert)config := tls.Config{RootCAs: CA_Pool}conn, err := tls.Dial(""tcp"", ""127.0.0.1:8000"", &config)if err != nil { log.Fatalf(""client: dial: %s"", err)} cert, err := tls.LoadX509KeyPair(""./cert.pem"", ""./key.pem"")config := tls.Config{Certificates: []tls.Certificate{cert}}listener, err := tls.Listen(""tcp"", ""127.0.0.1:8000"", &config)for { conn, err := listener.Accept() if err != nil { log.Printf(""server: accept: %s"", err) break } log.Printf(""server: accepted from %s"", conn.RemoteAddr()) go handleConnection(conn)} client: dial: x509: certificate signed by unknown authority (possibly because of ""x509: invalid signature: parent certificatecannot sign this kind of certificate"" while trying to verify candidate authority certificate ""serial:0"")",TLS with selfsigned certificate
Golang What is the use of buffered channels?," I understand from this question ""Golang - What is channel buffer size?"" that if the channel is buffered it won't block. But I don't understand whats the use of it. Suppose if I have 2 goroutines, 1st one will received data1 and 2nd one receives data2 then it will block till any subroutines gets free to process data3. I don't understand what difference did it make ? It would have executed the same way without buffer. Can you explain a possible scenario where buffering is useful ? <code>  c := make(chan int, 1)c <- data1 // doesn't blockc <- data2 // blocks until another goroutine receives from the channelc <- data3c <- data4",What is the use of buffered channels in Go?
Golang: syscall.Kill does not kill daemonized processes," I made program in Go that kills a process with syscall.Kill()But if I daeminze that process with fork() + setsid() then syscall.Kill() does not kill that process.If I use shell kill then I'm able to kill that process in both cases.I tried different signals: SIGINT, SIGTERM and SIGKILL buthey do not kill the daemon. <code> ",Unable to `syscall.Kill()` a daemonized Go process
`syscall.Kill()` in Go does not kill daemonized processes," I made program in Go that kills a process with syscall.Kill()But if I daeminze that process with fork() + setsid() then syscall.Kill() does not kill that process.If I use shell kill then I'm able to kill that process in both cases.I tried different signals: SIGINT, SIGTERM and SIGKILL buthey do not kill the daemon. <code> ",Unable to `syscall.Kill()` a daemonized Go process
Loosing 0 for single-digit hours with golang time package," I'm trying to format a series a date such as:March 12th, 2013, 3pm looks like : 2013-03-12-15.txtMarch 12th, 2013, 4am looks like : 2013-03-12-4.txtUsing golang and the Time package Which unfortunately add a zero in front of the single-digit hour : 2013-03-12-04.txtIs there an idiomatic way to reach the desired output, or I must tweak myself something with the String package ?Thanks in advance for your help ! <code>  package mainimport ( ""time"" ""fmt"")const layout = ""2006-01-02-15.txt""func main() { t := time.Date(2013, time.March, 12, 4, 0, 0, 0, time.UTC) fmt.Println(t.Format(layout))}",Losing 0 for single-digit hours with golang time package
How to handle error with different error code in golang," When I use ioutil to read a file, it may return an error. But if I want to filter some error code, what should I do? In the code snippet above, when a file has no permission, fmt.Println(err.Error()) will print ""open xxxxx: permission denied.If I want to capture this kind error, how can I know that file read failed because permission was denied?Should I search err.Error() for the string permission denied - this looks ungraceful. Is there any better way? Thanks in advance. Update After trying @Intermernet solution, I found that it will not hit case os.ErrPermission, it will hit default and print ""open xxx: Permission denied"".@Aedolon solution is ok, os.IsPermission(err) can tell that a file has failed with permission deny.  <code>  res, err := ioutil.ReadFile(""xxx"")if err != nil { fmt.Println(err.Error()) }...",How do I check for specific types of error among those returned by ioutil.ReadFile?
How to handle different error code with ioutil.ReadFile in golang," When I use ioutil to read a file, it may return an error. But if I want to filter some error code, what should I do? In the code snippet above, when a file has no permission, fmt.Println(err.Error()) will print ""open xxxxx: permission denied.If I want to capture this kind error, how can I know that file read failed because permission was denied?Should I search err.Error() for the string permission denied - this looks ungraceful. Is there any better way? Thanks in advance. Update After trying @Intermernet solution, I found that it will not hit case os.ErrPermission, it will hit default and print ""open xxx: Permission denied"".@Aedolon solution is ok, os.IsPermission(err) can tell that a file has failed with permission deny.  <code>  res, err := ioutil.ReadFile(""xxx"")if err != nil { fmt.Println(err.Error()) }...",How do I check for specific types of error among those returned by ioutil.ReadFile?
How to check for specific type of error among those returned by ioutil.ReadFile?," When I use ioutil to read a file, it may return an error. But if I want to filter some error code, what should I do? In the code snippet above, when a file has no permission, fmt.Println(err.Error()) will print ""open xxxxx: permission denied.If I want to capture this kind error, how can I know that file read failed because permission was denied?Should I search err.Error() for the string permission denied - this looks ungraceful. Is there any better way? Thanks in advance. Update After trying @Intermernet solution, I found that it will not hit case os.ErrPermission, it will hit default and print ""open xxx: Permission denied"".@Aedolon solution is ok, os.IsPermission(err) can tell that a file has failed with permission deny.  <code>  res, err := ioutil.ReadFile(""xxx"")if err != nil { fmt.Println(err.Error()) }...",How do I check for specific types of error among those returned by ioutil.ReadFile?
"Best practice ""returning"" structs in Go?"," In Go there are various ways to return a struct value or slice thereof. For individual ones I've seen: I understand the differences between these. The first returns a copy of the struct, the second a pointer to the struct value created within the function, the third expects an existing struct to be passed in and overrides the value.I've seen all of these patterns be used in various contexts, I'm wondering what the best practices are regarding these. When would you use which? For instance, the first one could be ok for small structs (because the overhead is minimal), the second for bigger ones. And the third if you want to be extremely memory efficient, because you can easily reuse a single struct instance between calls. Are there any best practices for when to use which?Similarly, the same question regarding slices: Again: what are best practices here. I know slices are always pointers, so returning a pointer to a slice isn't useful. However, should I return a slice of struct values, a slice of pointers to structs, should I pass in a pointer to a slice as argument (a pattern used in the Go App Engine API)? <code>  type MyStruct struct { Val int}func myfunc() MyStruct { return MyStruct{Val: 1}}func myfunc() *MyStruct { return &MyStruct{}}func myfunc(s *MyStruct) { s.Val = 1} func myfunc() []MyStruct { return []MyStruct{ MyStruct{Val: 1} }}func myfunc() []*MyStruct { return []MyStruct{ &MyStruct{Val: 1} }}func myfunc(s *[]MyStruct) { *s = []MyStruct{ MyStruct{Val: 1} }}func myfunc(s *[]*MyStruct) { *s = []MyStruct{ &MyStruct{Val: 1} }}",Pointers vs. values in parameters and return values
Golang: Compare two slices," Is there a way in Go to compare two slices and get the elements in slice X that are not in slice Y and vice versa? <code>  X := []int{10, 12, 12, 12, 13} Y := []int{12, 14, 15}func compare(X, Y []int) calling compare(X, Y) result1 := []int{10, 12, 12, 13} // if you're looking for elements in slice X that are not in slice Ycalling compare(Y, X) result2 := []int{14, 15} // if you're looking for elements in slice Y that are not in slice X",Compare two slices
golang - how to download file in browser from golang server?," My code get file from remote url and download file in browser: code: http://play.golang.org/p/x-EyR2zFjvGet file is ok, but how to downloaded it in browser? <code>  func Index(w http.ResponseWriter, r *http.Request) { url := ""http://upload.wikimedia.org/wikipedia/en/b/bc/Wiki.png"" ... resp, err := client.Get(url) if err != nil { fmt.Println(err) } defer resp.Body.Close() body, err := ioutil.ReadAll(resp.Body) if err != nil { fmt.Println(err) } fmt.Println(len(body)) //download the file in browser}func main() { http.HandleFunc(""/"", Index) err := http.ListenAndServe("":8000"", nil) if err != nil { fmt.Println(err) }}",How to download file in browser from Go server
Parallel For-Loop in GoogleGo," I want the for-loop to be parallel using go routines. i tried using channels but that didnt work. My main problem is, that i want to wait for all iterations to be finished before continuing. That's why simply writing go before it doesn't work. I tried to using channels (i think the wrong way) but that made my code even slower My struct looks like this: <code>  func createPopulation(populationSize int, individualSize int) []Individual { population := make([]Individual, populationSize) //i want this loop to be work parallel for i := 0; i < len(population); i++ { population[i] = createIndividual(individualSize) } return population}func createIndividual(size int) Individual { var individual = Individual{make([]bool, size), 0} for i := 0; i < len(individual.gene); i++ { if rand.Intn(2)%2 == 1 { individual.gene[i] = true } else { individual.gene[i] = false } } return individual} type Individual struct { gene []bool fitness int}",Parallel For-Loop
golang - Get name of struct field using reflection," What is the way of printing ""Foo"" here? In this example, what prints is ""string"". http://play.golang.org/p/ZnK6PRwEPp <code>  type A struct { Foo string}func (a *A) PrintFoo() { fmt.Println(""Foo value is "" + a.Foo)}func main() { a := &A{Foo: ""afoo""} val := reflect.Indirect(reflect.ValueOf(a)) fmt.Println(val.Field(0).Type().Name())}",Get name of struct field using reflection
golang - Marshal sql.NullString with omitempty," How is one supposed to not render the null sql.NullString if it is not valid? - http://play.golang.org/p/pzSWS9vE0JIt doesn't seem to be working with omitempty struct tag and I can't quite figure out what to return from the MarshalJSON such that omitempty will be honored <code>  type NS struct { sql.NullString}func (ns *NS) MarshalJSON() ([]byte, error) { fmt.Println(""Marshaling json for NS"") if ns.String == """" && !ns.Valid { return []byte(""null""), nil } return json.Marshal(ns.String)}type A struct { RStr string `json:rstr,omitempty""` Str NS `json:""str,omitempty""`}func main() { a := A{RStr: ""rstr""} s, _ := json.Marshal(&a) fmt.Println(string(s))}",Marshal sql.NullString with omitempty
I do not understand this syntax," I am studying a sample Go application that stores data in mongodb. The code at this line (https://github.com/zeebo/gostbook/blob/master/context.go#L36) seems to access an user ID stored in a gorilla session: Would someone please explain to me the syntax here? I understand that sess.Values[""user""] gets a value from the session, but what is the part that follows? Why is the expression after the dot in parentheses? Is this a function invocation? <code>  if uid, ok := sess.Values[""user""].(bson.ObjectId); ok { ...}","What is the meaning of ""dot parenthesis"" syntax?"
"What is the meaning of ""dot parenthesis"" syntax in Golang?"," I am studying a sample Go application that stores data in mongodb. The code at this line (https://github.com/zeebo/gostbook/blob/master/context.go#L36) seems to access an user ID stored in a gorilla session: Would someone please explain to me the syntax here? I understand that sess.Values[""user""] gets a value from the session, but what is the part that follows? Why is the expression after the dot in parentheses? Is this a function invocation? <code>  if uid, ok := sess.Values[""user""].(bson.ObjectId); ok { ...}","What is the meaning of ""dot parenthesis"" syntax?"
How to send a POST request in Golang?," I am trying to make a POST request but I can't get it done. Nothing is received on the other side.Is this how it is supposed to work? I'm aware of the PostForm function but I think I can't use it because it can't be tested with httputil, right? <code>  hc := http.Client{}req, err := http.NewRequest(""POST"", APIURL, nil)form := url.Values{}form.Add(""ln"", c.ln)form.Add(""ip"", c.ip)form.Add(""ua"", c.ua)req.PostForm = formreq.Header.Add(""Content-Type"", ""application/x-www-form-urlencoded"")glog.Info(""form was %v"", form)resp, err := hc.Do(req)",How to send a POST request in Go?
golang - how to compare struct is equal?," I want to check if two structs, slices and maps are equal.But I'm running into problems with the following code. See my comments at the relevant lines. http://play.golang.org/p/AZIzW2WunI <code>  package mainimport ( ""fmt"" ""reflect"")type T struct { X int Y string Z []int M map[string]int}func main() { t1 := T{ X: 1, Y: ""lei"", Z: []int{1, 2, 3}, M: map[string]int{ ""a"": 1, ""b"": 2, }, } t2 := T{ X: 1, Y: ""lei"", Z: []int{1, 2, 3}, M: map[string]int{ ""a"": 1, ""b"": 2, }, } fmt.Println(t2 == t1) //error - invalid operation: t2 == t1 (struct containing []int cannot be compared) fmt.Println(reflect.ValueOf(t2) == reflect.ValueOf(t1)) //false fmt.Println(reflect.TypeOf(t2) == reflect.TypeOf(t1)) //true //Update: slice or map a1 := []int{1, 2, 3, 4} a2 := []int{1, 2, 3, 4} fmt.Println(a1 == a2) //invalid operation: a1 == a2 (slice can only be compared to nil) m1 := map[string]int{ ""a"": 1, ""b"": 2, } m2 := map[string]int{ ""a"": 1, ""b"": 2, } fmt.Println(m1 == m2) // m1 == m2 (map can only be compared to nil)}","How to compare if two structs, slices or maps are equal?"
"golang - how to compare struct, slice, map is equal?"," I want to check if two structs, slices and maps are equal.But I'm running into problems with the following code. See my comments at the relevant lines. http://play.golang.org/p/AZIzW2WunI <code>  package mainimport ( ""fmt"" ""reflect"")type T struct { X int Y string Z []int M map[string]int}func main() { t1 := T{ X: 1, Y: ""lei"", Z: []int{1, 2, 3}, M: map[string]int{ ""a"": 1, ""b"": 2, }, } t2 := T{ X: 1, Y: ""lei"", Z: []int{1, 2, 3}, M: map[string]int{ ""a"": 1, ""b"": 2, }, } fmt.Println(t2 == t1) //error - invalid operation: t2 == t1 (struct containing []int cannot be compared) fmt.Println(reflect.ValueOf(t2) == reflect.ValueOf(t1)) //false fmt.Println(reflect.TypeOf(t2) == reflect.TypeOf(t1)) //true //Update: slice or map a1 := []int{1, 2, 3, 4} a2 := []int{1, 2, 3, 4} fmt.Println(a1 == a2) //invalid operation: a1 == a2 (slice can only be compared to nil) m1 := map[string]int{ ""a"": 1, ""b"": 2, } m2 := map[string]int{ ""a"": 1, ""b"": 2, } fmt.Println(m1 == m2) // m1 == m2 (map can only be compared to nil)}","How to compare if two structs, slices or maps are equal?"
"How to compare struct, slice, map are equal?"," I want to check if two structs, slices and maps are equal.But I'm running into problems with the following code. See my comments at the relevant lines. http://play.golang.org/p/AZIzW2WunI <code>  package mainimport ( ""fmt"" ""reflect"")type T struct { X int Y string Z []int M map[string]int}func main() { t1 := T{ X: 1, Y: ""lei"", Z: []int{1, 2, 3}, M: map[string]int{ ""a"": 1, ""b"": 2, }, } t2 := T{ X: 1, Y: ""lei"", Z: []int{1, 2, 3}, M: map[string]int{ ""a"": 1, ""b"": 2, }, } fmt.Println(t2 == t1) //error - invalid operation: t2 == t1 (struct containing []int cannot be compared) fmt.Println(reflect.ValueOf(t2) == reflect.ValueOf(t1)) //false fmt.Println(reflect.TypeOf(t2) == reflect.TypeOf(t1)) //true //Update: slice or map a1 := []int{1, 2, 3, 4} a2 := []int{1, 2, 3, 4} fmt.Println(a1 == a2) //invalid operation: a1 == a2 (slice can only be compared to nil) m1 := map[string]int{ ""a"": 1, ""b"": 2, } m2 := map[string]int{ ""a"": 1, ""b"": 2, } fmt.Println(m1 == m2) // m1 == m2 (map can only be compared to nil)}","How to compare if two structs, slices or maps are equal?"
How do goroutines work?," How can other goroutines keep executing whilst invoking a syscall? (when using GOMAXPROCS=1)As far as I'm aware of, when invoking a syscall the thread gives up control until the syscall returns.How can Go achieve this concurrency without creating a system thread per blocking-on-syscall goroutine?From the documentation: Goroutines They're called goroutines because the existing termsthreads, coroutines, processes, and so onconvey inaccurate connotations. A goroutine has a simple model: it is a function executing concurrently with other goroutines in the same address space. It is lightweight, costing little more than the allocation of stack space. And the stacks start small, so they are cheap, and grow by allocating (and freeing) heap storage as required. Goroutines are multiplexed onto multiple OS threads so if one should block, such as while waiting for I/O, others continue to run. Their design hides many of the complexities of thread creation and management. <code> ",How do goroutines work? (or: goroutines and OS threads relation)
GOLANG Read archived csv," I'm facing some issues in reading archived CSV files.So I want to use the csv package and the gzip package for this, but I don't know how to combine them. The gzip.Reader(p []bytes) and the csv.Reader() have different signatures.This is my reader function: Do you have any suggestions ? <code>  func reader(filename string, c chan string) { fi, err := os.Open(filename) var r *bufio.Reader if err != nil { fmt.Println(""%q"",err) os.Exit(1) } fz, err := g.NewReader(fi) if err != nil { r = bufio.NewReader(fi) }else { r = bufio.NewReader(fz) } for { line, err := r.ReadString('\n') if err != nil { fmt.Println(""done reading file"") c <- ""done"" break }else{ c <- fmt.Sprintf(""%q"",strings.Fields(line)) } }} ",How do I read a gzipped CSV file?
struct type anonymous fields access," I am trying to learn golang and at moment I am trying to understand pointers. I defined three struct type As you can see, in the Cars struct I defined an embedded type pointer *Engine. Look in the main. When I try to compile, I've got the following errors How can I access the power field? <code>  type Engine struct { power int } type Tires struct { number int } type Cars struct { *Engine Tires } func main() { car := new(Cars) car.number = 4 car.power = 342 fmt.Println(car) } panic: runtime error: invalid memory address or nil pointer dereference[signal 0xb code=0x1 addr=0x0 pc=0x23bb] ",struct type embedded fields access
Delete Element in Slice Golang," How does this delete trick with the append function work?It would seem that it's grabbing everything before the first element (empty array)Then appending everything after the first element (position zero)What does the ... (dot dot dot) do? <code>  func main() { a := []string{""Hello1"", ""Hello2"", ""Hello3""} fmt.Println(a) // [Hello1 Hello2 Hello3] a = append(a[:0], a[1:]...) fmt.Println(a) // [Hello2 Hello3]}",Delete element in a slice
"""Catching"" panics in Go lang"," With the following code, if no file argument is given, a panic is thrown for line 9 panic: runtime error: index out of range as expected.How can I 'catch' this panic and handle it when directly when passing something to it (os.Args[1]) that causes the panic? Much like try/catch in PHP or try/except in Python.I've had a search here on StackOverflow but I've not found anything that answers this as such. <code>  package mainimport ( ""fmt"" ""os"")func main() { file, err := os.Open(os.Args[1]) if err != nil { fmt.Println(""Could not open file"") } fmt.Printf(""%s"", file)}",Catching panics in Golang
Golang html output is being interpreted as plain text instead of being received as html," I'm sure this is just something dumb I'm doing, but I'm new to Go, so not sure what's going on here. I have the following basic setup. The contents of base.html are as follows: When I run the server and load the page, I see the HTML inside the template verbatim -- instead of the interpreted version. Turns out, the template is being wrapped in pre tags, and is subsequently being wrapped in a new document.So what's going on? Why is go by default treating this as plain text rather than sending it over as html, so that the browser can render it properly? Surely this must be a simple misunderstanding, but not getting anything in searches. Ideas? <code>  requestHandler := http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) { t := template.New(""test"") t, _ := template.ParseFiles(""base.html"") t.Execute(w, """")})server := &http.Server{ Addr: "":9999"", Handler: requestHandler, ReadTimeout: 10 * time.Second, WriteTimeout: 10 * time.Second, MaxHeaderBytes: 1 << 20,}log.Fatal(server.ListenAndServe()) <DOCTYPE html><html>",HTML output is being interpreted as plain text instead of being received as html
Return local beginning of day time object in Go," To get a local beginning of today time object I extract YMD and reconstruct the new date. That looks like a kludge. Do I miss some other standard library function?code also runnable at http://play.golang.org/p/OSRl0nxyB7 : <code>  func Bod(t time.Time) time.Time { year, month, day := t.Date() return time.Date(year, month, day, 0, 0, 0, 0, t.Location())}func main() { fmt.Println(Bod(time.Now()))}",Return local beginning of day time object
Go Tour Slices Exercise logic," I am trying to complete the Exercise: Slices from the Go Tour.However I don't really understand what I'm being asked to do. Implement Pic. It should return a slice of length dy, each element of which is a slice of dx 8-bit unsigned integers. When you run the program, it will display your picture, interpreting the integers as grayscale (well, bluescale) values.I have the following code I have created the slice of length dy so far. However I don't understand the next step. Do I need to create a for loop in which I assign every element of my slice to a value in the range of dx? I don't ask for code but rather for an explanation/clarification <code>  package mainimport ""golang.org/x/tour/pic""func Pic(dx, dy int) [][]uint8 { a := make([][]uint8, dy) return a}func main() { pic.Show(Pic)}",Tour of Go exercise #18: Slices
do golang channels maintain order," In Go, do buffered channels have any order guarantee?For example:you have two goroutines A & B that share a channel. A pushes data onto the channel while B reads from it. Are you guranted that B will read data In the same order that A put it into the channel?I understand that if there are multiple producers or consumers the order may be non-deterministic, but I'm specifically asking about having just 1 producer and 1 consumer. <code> ",Do buffered channels maintain order?
do Golang channels maintain order," In Go, do buffered channels have any order guarantee?For example:you have two goroutines A & B that share a channel. A pushes data onto the channel while B reads from it. Are you guranted that B will read data In the same order that A put it into the channel?I understand that if there are multiple producers or consumers the order may be non-deterministic, but I'm specifically asking about having just 1 producer and 1 consumer. <code> ",Do buffered channels maintain order?
What are the primary differences between 'go' and 'gccgo'?," What are the primary differences between the two popular Go compilers, 'gc' and 'gccgo'? Build performance? Run-time performance? Command line options? Licensing?I'm not looking for opinions on which is best, just a basic overview of their differences, so I can decide which is best for my needs. <code> ",What are the primary differences between 'gc' and 'gccgo'?
Golang: How can I to find out if uploaded the file is an image?," I am building a web application.On one of the pages there is an upload form, where user can upload a file. After the upload is done, I want to check on the server if the uploaded file is an image.Is it possible to check this beyond simple file extension checking (i.e.not assuming that a *.png filename is actually a PNG image)?For example, if I edit a JPEG image adding/editing a byte in a random place to make an invalid JPEG file, I want to detect that it is not a JPEG image anymore. I used to do such type of thing via PHP some time ago, using a GD library.I would like to know if it is possible to do with Go? <code> ",How to check if a file is a valid image?
How can I to find out if uploaded the file is an image in Go," I am building a web application.On one of the pages there is an upload form, where user can upload a file. After the upload is done, I want to check on the server if the uploaded file is an image.Is it possible to check this beyond simple file extension checking (i.e.not assuming that a *.png filename is actually a PNG image)?For example, if I edit a JPEG image adding/editing a byte in a random place to make an invalid JPEG file, I want to detect that it is not a JPEG image anymore. I used to do such type of thing via PHP some time ago, using a GD library.I would like to know if it is possible to do with Go? <code> ",How to check if a file is a valid image?
How can I to find out if uploaded the file is an image in Go?," I am building a web application.On one of the pages there is an upload form, where user can upload a file. After the upload is done, I want to check on the server if the uploaded file is an image.Is it possible to check this beyond simple file extension checking (i.e.not assuming that a *.png filename is actually a PNG image)?For example, if I edit a JPEG image adding/editing a byte in a random place to make an invalid JPEG file, I want to detect that it is not a JPEG image anymore. I used to do such type of thing via PHP some time ago, using a GD library.I would like to know if it is possible to do with Go? <code> ",How to check if a file is a valid image?
how to remove last element from a slice in GoLang?," I've seen people say just create a new slice by appending the old one but what if you want to remove the last element in the slice?If you try to replace i (the last element) with i+1, it returns an out of bounds error since there is no i+1. <code>  *slc = append(*slc[:item], *slc[item+1:]...)",How to remove the last element from a slice?
How to remove last element from a slice in Go?," I've seen people say just create a new slice by appending the old one but what if you want to remove the last element in the slice?If you try to replace i (the last element) with i+1, it returns an out of bounds error since there is no i+1. <code>  *slc = append(*slc[:item], *slc[item+1:]...)",How to remove the last element from a slice?
Golang TCP read is non blocking," I am trying to make a server and client in Go, I have managed to communicate with the server and client. But the problem I have is that the TCP read in golang is non-blocking.What I would like to know if is it possible for the read in golang to be blocking like read in C.Thank YouEDIT:Here is the source code of the server: and my client: <code>  func Init_tcp() *net.TCPListener { laddr, err := net.ResolveTCPAddr(""tcp"", "":4243"") if err != nil { log.Fatal(err) } tcp, err := net.ListenTCP(""tcp"", laddr) if err != nil { log.Fatal(err) } return tcp}func main() { tcp := Init_tcp() conn, _ := tcp.Accept() data := make([]byte, 512) conn.SetNoDelay(false) for { conn.Read(data) fmt.Println(data) }} func Init_tcp() *net.TCPConn { laddr, err := net.ResolveTCPAddr(""tcp"", ""127.0.0.1:4243"") if err != nil { log.Fatal(err) } tcp, err := net.DialTCP(""tcp"", nil, laddr) if err != nil { log.Fatal(err) } return tcp}func main() { tcp := Init_tcp() tcp.Write([]byte(""hello world""))}",Go TCP read is non blocking
"Error, infinite loop"," I am going through ""A Tour of Go"" tutorial.I would like to check the answer to this question: Note: a call to fmt.Sprint(e) inside the Error method will send the program into an infinite loop. You can avoid this by converting e first: fmt.Sprint(float64(e)). Why?I believe this is because when the Sprint function is called, since the error is non-nil, the Error function() will again be called, and so forth, resulting in an infinite loop.  <code> ",Why would a call to fmt.Sprint(e) inside the Error() method result in an infinite loop?
Serialize to JSON a mixed type array in Go," I want to return a structure that looks like this: That's an array of arrags that is string, floating point number, unicode character.If it was Python I'd be able to: But in Go you can't have an array (or slice) of mixed types. I thought of using a struct like this: But I don't want each to become a dictionary, I want it to become an array of 3 elements each.  <code>  { results: [ [""ooid1"", 2.0, ""Sme text""], [""ooid2"", 1.3, ""ther text""], ]} import jsonjson.dumps({'results': [[""ooid1"", 2.0, u""Sme text""], ...]) type Row struct { Ooid string Score float64 Text rune}",Serialize a mixed type JSON array in Go
"what stat represent total heap, stat, and heap minus stack"," Go runtime has a lot of different variables related to heap and stack and some of the stack numbers are part of the heap numbers, leading to confusion (for me). For example, in this link. it says In the runtime docs (excerpt below), it gives 7 different heap related fields (that is, fields of the memstat struct) without clearly explaining which ones include stack, and similarly, which stack fields are included in heap, and how that relates to total allocations.this is a problem, because I want to compare heap against stack, but I don't want to choose a heap variable that includes stack (obviously).Questions1). Does total allocation field include heap, stack or both?2) which heap fields do not include numbers stack?3) which heap fields include numbers for stack?4) which stack fields do not include numbers for heap? <code>  // Stack numbers are part of the heap numbers, separate those out for user consumption stats.StackSys = stats.StackInuse stats.HeapInuse -= stats.StackInuse stats.HeapSys -= stats.StackInuse Alloc uint64 // bytes allocated and still in use TotalAlloc uint64 // bytes allocated (even if freed) Sys uint64 // bytes obtained from system (sum of XxxSys below) Lookups uint64 // number of pointer lookups Mallocs uint64 // number of mallocs Frees uint64 // number of frees // Main allocation heap statistics. HeapAlloc uint64 // bytes allocated and still in use HeapSys uint64 // bytes obtained from system HeapIdle uint64 // bytes in idle spans HeapInuse uint64 // bytes in non-idle span HeapReleased uint64 // bytes released to the OS HeapObjects uint64 // total number of allocated objects // Low-level fixed-size structure allocator statistics. // Inuse is bytes used now. // Sys is bytes obtained from system. StackInuse uint64 // bytes used by stack allocator StackSys uint64","which fields in memstats struct refer only to heap, only to stack"
Golang: Accessing a map using its reference," I try to loop through a map, that I pass as a pointer to a function, but I can't find a way to access the elements. This is the code: Line 4 in this example return following compile error: I tried brackets, but it had no effect. If I take away all reference operators (* &) then it compiles fine. How must I write this? <code>  func refreshSession(sessions *map[string]Session) { now := time.Now() for sid := range *sessions { if now.After(*sessions[sid].timestamp.Add(sessionRefresh)) { delete( *sessions, sid ) } }} ./controller.go:120: invalid operation: sessions[sid] (type *map[string]Session does not support indexing)",Accessing a map using its reference
Go test skip directory," Is it possible to skip directories from testing. For example given the structure below is it possible to test mypackage, mypackage/other and mypackage/net but not mypackage/scripts? I mean without to write a go test command for each (e.g. go test; go test net; go test other) <code>  mypackagemypackage/netmypackage/othermypackage/scripts",Running tests and skipping some packages
Go: running tests and skipping some packages," Is it possible to skip directories from testing. For example given the structure below is it possible to test mypackage, mypackage/other and mypackage/net but not mypackage/scripts? I mean without to write a go test command for each (e.g. go test; go test net; go test other) <code>  mypackagemypackage/netmypackage/othermypackage/scripts",Running tests and skipping some packages
golang url parameters mapping," Is there a native way for inplace url parameters in native Go?For Example, if I have a URL: http://localhost:8080/blob/123/test I want to use this URL as /blob/{id}/test.This is not a question about finding go libraries. I am starting with the basic question, does go itself provide a basic facility to do this natively. <code> ",Go url parameters mapping
Parsing a Json array of Json objects in golang?," I am trying to get each JSON object out of a JSON array. I get this data via a HTTP post.I know what my data will look like: My example code and my structs look like this: I am not sure where how to iterate over the JSON array and get the JSON objects and then just work with the JSON objects. <code>  { ""array"":[ { ""entity_title"":""University of Phoenix"", ""entity_org_name"":""CS Club"", ""possible_user_name"":""Johnny Ive"", ""posibble_user_email"":""Johhny.Ive@uop.edu"", ""user_position_title"":""President"", ""msg_body_id"":4 }, { ""entity_title"":""University of San Francisco"", ""entity_org_name"":""Marketing club"", ""possible_user_name"":""steve jobs"", ""posibble_user_email"":""steven.job@uop.edu"", ""user_position_title"":""Student"", ""msg_body_id"":5 } ] } type MsgCreateUserArray struct { CreateUser []MsgCreateUserJson `json:""createUserArray""` } type MsgCreateUserJson struct { EntityTitleName string `json:""entity_title_name""` EntityOrgName string `json:""entity_org_name""` PossibleUserName string `json:""possible_user_name""` PossibleUserEmail string `json:""possible_user_email""` UserPositionTitle string `json:""user_position_title""` MsgBodyId string `json:""msg_body_id, omitempty""` }func parseJson(rw http.ResponseWriter, request *http.Request) { decodeJson := json.NewDecoder(request.Body) var msg MsgCreateUserArray err := decodeJson.Decode(&msg) if err != nil { panic(err) } log.Println(msg.CreateUser)}func main() { http.HandleFunc(""/"", parseJson) http.ListenAndServe("":1337"", nil)}",Parsing a JSON array of JSON objects?
Does go have standard Err variables?," Just started using Golang. I think that it is idiomatic to declare an error variable and use it in your error structure to determine what went wrong, as is done in strconv.go. There, ErrRange and ErrSyntax is declared, and when appropriate, references to those are stored in NumError structs when they return. I think that the reason is because then the address of the reference to the error stored in NumError can be compared with the ErrRange and ErrSyntax variables to determine which type of error was returned.Are there ""standard"" such declared error types? In Java, for example, you have things like java.lang.IllegalArgumentException. Is there, for instance, ErrArgument or ErrUnsupportedOperation that I can use in my own code instead of creating new error variables that mean the same thing every time? <code> ",Does Go have standard Err variables?
Compiler: too many argumens given despite that all are given," I want to use the struct DataResponse as parameter for JSON() to respond with the user. By initializing an instance of DataResponse I get the error message, that too many arguments are given, but gave all that are necessary. The following error message is thrown by the compiler: DataResponse requires two parameters that are given and Data is an interface so it should accept models.User as datatype. <code>  type DataResponse struct { Status int `json:""status""` Data interface{} `json:""data""`}func GetUser(rw http.ResponseWriter, req *http.Request, ps httprouter.Params) { user := models.User{} // Fetching user from db resp := DataResponse(200, user) JSON(rw, resp) // rw is the ResponseWriter of net/http} too many arguments to conversion to DataResponse: DataResponse(200, user)",Compiler: too many arguments given despite that all are given
What does go build build?, New Go programmers often don't know or get confused what the fundamental go build command does.What do exactly the go build and go install commands build and where do they put the result/output? <code> ,What does go build build? (go build vs. go install)
Golang: Type cast custom types to base types," How can I convert custom type to interface{} and then to base type (ex. uint8)?I can't use direct cast like uint16(val.(Year)) because I may not know all custom types, but I can determinate base types (uint8, uint32,...) in runtimeThere are many custom types (usually used as enums) based on numeric:ex: and so on...The question is about type casting from interface{} to base types: http://play.golang.org/p/cyAnzQ90At <code>  type Year uint16type Day uint8type Month uint8 package mainimport ""fmt""type Year uint16// ....//Many others custom types based on uint8func AsUint16(val interface{}) uint16 { return val.(uint16) //FAIL: cannot convert val (type interface {}) to type uint16: need type assertion}func AsUint16_2(val interface{}) uint16 { return uint16(val) //FAIL: cannot convert val (type interface {}) to type uint16: need type assertion}func main() { fmt.Println(AsUint16_2(Year(2015)))}",Type cast custom types to base types
How do make golang tests sequential?," When I run go test, my output: But after I run go test again, all my tests pass.Tests fail only when I reset my mysql database, and then run go test for the first time. For every GET request, I do a POST request before to ensure that there is data created in the DB. Could anyone help me with how to make sure that tests are run sequentially? That is the POST requests are run before the GET requests? <code>  --- FAIL: TestGETSearchSuccess (0.00s) Location: drivers_api_test.go:283 Error: Not equal: 200 (expected) != 204 (actual)--- FAIL: TestGETCOSearchSuccess (0.00s) Location: drivers_api_test.go:391 Error: Not equal: 200 (expected) != 204 (actual)",How to run golang tests sequentially?
"How do I turn a bool into an int, in go?"," I'm used to C/Java, where I could use ?: as in: Since Go does not have a ternary operator, how do I do that in go? <code>  func g(arg bool) int { return mybool ? 3 : 45;}",How do I turn a bool into an int?
How to get the size of struct and its contents in golang?," I have a struct, say: I create a slice of that struct: a := []ASDF{}I do operations on that slice of the struct (adding/removing/updating structs that vary in contents); how can I get the total size in bytes (for memory) of the slice and its contents? Is there a built-in to do this or do I need to manually run a calculation using unsafe.Sizeof and then len each string? <code>  type ASDF struct { A uint64 B uint64 C uint64 D uint64 E uint64 F string}",How to get the size of struct and its contents in bytes in golang?
A tour of Golang exercise: rot13Reader," I'm trying to solve the Tour of Go exercise rot13Reader:Here is my solution: It returns You prnpxrq tur poqr!, that means only the first word of ""Lbh penpxrq gur pbqr!"" is cracked. How can I crack the whole sentence?  <code>  package mainimport ( ""io"" ""os"" ""strings"")type rot13Reader struct { r io.Reader}func rot13(x byte) byte { switch { case x >= 65 && x <= 77: fallthrough case x >= 97 && x <= 109: x = x + 13 case x >= 78 && x <= 90: fallthrough case x >= 110 && x >= 122: x = x - 13 } return x}func (r13 *rot13Reader) Read(b []byte) (int, error) { n, err := r13.r.Read(b) for i := 0; i <= n; i++ { b[i] = rot13(b[i]) } return n, err}func main() { s := strings.NewReader(""Lbh penpxrq gur pbqr!"") r := rot13Reader{s} io.Copy(os.Stdout, &r)}",Tour of Go exercise #23: rot13Reader
Tour of Go exercise: rot13Reader," I'm trying to solve the Tour of Go exercise rot13Reader:Here is my solution: It returns You prnpxrq tur poqr!, that means only the first word of ""Lbh penpxrq gur pbqr!"" is cracked. How can I crack the whole sentence?  <code>  package mainimport ( ""io"" ""os"" ""strings"")type rot13Reader struct { r io.Reader}func rot13(x byte) byte { switch { case x >= 65 && x <= 77: fallthrough case x >= 97 && x <= 109: x = x + 13 case x >= 78 && x <= 90: fallthrough case x >= 110 && x >= 122: x = x - 13 } return x}func (r13 *rot13Reader) Read(b []byte) (int, error) { n, err := r13.r.Read(b) for i := 0; i <= n; i++ { b[i] = rot13(b[i]) } return n, err}func main() { s := strings.NewReader(""Lbh penpxrq gur pbqr!"") r := rot13Reader{s} io.Copy(os.Stdout, &r)}",Tour of Go exercise #23: rot13Reader
"Golang - Documentation On ""All Known Implementation"" of Interfaces"," Few months into learning Go, I just discover that os.File implements the io.Reader interface by implementing the Read(b []byte) (n int, err error) function. This allows me to use a buffered reader to read a file by do something like: Unless I miss it, it looks like there isn't an ""All Known Implementing Classes"" in Go documents on interfaces, like those found in Java interfaces documentation.Are there any ways to identify the types that implement an interface in Go? <code>  f, err := os.Open(""myfile.txt"")bufReader := bufio.NewReader(f)","Documentation On ""All Known Implementation"" of Interfaces"
Golang: unit testing values of large struct," I was wondering if there is a generic way of unit testing the values of a rather large struct without having to write many if statements below each other. I know in Go we can use table-driven unit tests, but I have not yet found how we can implement this table-driven approach with structs.My goal is to create a struct, do something with it, and unit test the new values of the struct. Does anybody know how I can achieve this with table-driven tests or if there's a better way to do it? <code> ",Comparing multiple struct fields in Go
Is it possible to transport a TCP connection over websockets?," I'm wondering, is it possible to transport/tunnel a TCP connection though the websockets protocol?There is a websockets package and it seems I could io.copy the TCP connection into the websockets connection but I don't know how to reassemble it as TCPConn on the other end. For example I would like to create a socks5 ServerN(behind NAT) on one end and a ServerIE on the other end. An internet user would make a socks5 request (though the socks5 protocol) to ServerIE and ServerIE would send the socks5 request through the websocket connection to ServerNAT. ServerNAT will then process the socks5 request(i.e. it's a socks5 server).EDIT:I've wrote some code but unfortunately it gets stuck on reading from the TCP connection into WS. To run it: go run main.go -logtostderr To trigger the TCP listener you can issue a request on port 8080 (e.g. curl --socks5 localhost:8080 google.com -v or curl localhost:8080 -v) <code>  package mainimport ( ""flag"" log ""github.com/golang/glog"" ""golang.org/x/net/websocket"" ""bufio"" ""net"" ""net/http"" ""time""// ""io"")func main() { flag.Parse() defer log.Flush() log.Infof(""wsServer()"") wsCh := wsServer() log.Infof(""wsNAT()"") natWS, err := wsNAT() if err != nil { log.Error(err) return } done := make(chan struct{}, 1) log.Infof(""listenTCP()"") conn := listenTCP() buf := bufio.NewReader(conn) go func() { log.Infof(""Write TCP to WS"") n, err := buf.WriteTo(natWS) if err != nil { log.Fatal(err) return } log.Infof(""newConn.ws.ReadFrom(conn) %v"", n) close(done) }() wsToTCP(<- wsCh) <-done}// wsNAT dials /ws endpoint and returns a websocket connection.func wsNAT() (*websocket.Conn, error) { time.Sleep(1 * time.Second) origin := ""http://localhost/"" url := ""ws://localhost:12345/ws"" return websocket.Dial(url, """", origin)} // wsServer returns the websocket // connections received on /ws endpointfunc wsServer() chan *websocket.Conn { wsCh := make(chan *websocket.Conn, 1) http.Handle(""/ws"", websocket.Handler(func(ws *websocket.Conn) { wsCh <- ws time.Sleep(1 *time.Hour) })) go func() { err := http.ListenAndServe("":12345"", nil) if err != nil { panic(""ListenAndServe: "" + err.Error()) } }() return wsCh}// wsToTCP reads a ws connection and converts its payload// to a TCP connection.func wsToTCP(ws *websocket.Conn) { conn := &net.TCPConn{} var msg []byte if _, err := ws.Read(msg); err != nil { log.Error(err) return } log.Infof(""msg %v"", msg) n, err := conn.Write(msg) if err != nil { log.Errorf(""conn.Write %v, msg %v"", err, msg) return } log.Infof(""conn is %v, copied %v"", conn, n) // END: do something with the connection // ..... }//ListenTCP returns the first TCP connection received on port 8080func listenTCP() *net.TCPConn { addr := &net.TCPAddr{IP: net.ParseIP(""0.0.0.0""), Port: 8080} lr, err := net.ListenTCP(""tcp"", addr) if err != nil { panic(err) } defer lr.Close() ieConn, err := lr.AcceptTCP() if err != nil { panic(err) } log.Infof(""connection accepted"") return ieConn}",Is it possible to transport a TCP connection over websockets or another protocol?
Golang - Convert SHA1 Hex to Base 16 Integer," I need some help porting an algorithm from Ruby to Go.In Ruby I have: Which creates a SHA1 hex string, converts it to an integer in base 16 and then back to a string in base 32.How do I achieve the same in Go? <code>  hex = Digest::SHA1.hexdigest(str).to_i(16)hex.to_s(32)",Convert SHA1 Hex to Base 16 Integer
Golang JSON omitempty With time.Time Field," Trying to json Marshal a struct that contains 2 time fields. But I only want the field to come through if it has a time value. So I'm using json:"",omitempty"" but it's not working.What can I set the Date value to so json.Marshal will treat it like an empty (zero) value and not include it in the json string?Playground: http://play.golang.org/p/QJwh7yBJloActual Outcome: {""Timestamp"":""2015-09-18T00:00:00Z"",""Date"":""0001-01-01T00:00:00Z""}Desired Outcome: {""Timestamp"":""2015-09-18T00:00:00Z""}Code: <code>  package mainimport ( ""encoding/json"" ""fmt"" ""time"")type MyStruct struct { Timestamp time.Time `json:"",omitempty""` Date time.Time `json:"",omitempty""` Field string `json:"",omitempty""`}func main() { ms := MyStruct{ Timestamp: time.Date(2015, 9, 18, 0, 0, 0, 0, time.UTC), Field: """", } bb, err := json.Marshal(ms) if err != nil { panic(err) } fmt.Println(string(bb))}",JSON omitempty With time.Time Field
pointer arithmetic in go," Considering you can (can't think of a great way to put it, but) manipulate pointers in Go, is it possible to perform pointer arithmetic like you would in C, say for iterating over an array? I know loops are just fine for that kind of things these days but I'm just curious if it's possible. <code> ",Pointer arithmetic in Go
Go get first directory of path," In Go, is it possible to get the root directory of a path so that foo/bar/file.txtreturns foo? I know about path/filepath, but prints foo/bar/file.txt and 1 whereas I would have expected foo and 3. <code>  package mainimport ( ""fmt"" ""path/filepath"")func main() { parts := filepath.SplitList(""foo/bar/file.txt"") fmt.Println(parts[0]) fmt.Println(len(parts))}",Get the first directory of a path in GO
Redfine const in golang for test," I'm writing an http client for a service and for testing I want to use a net/http/httptest server instead of calling out to the remote API. I can easily do this if I make the baseUrl a global variable which gets set to the url of my test server. However, this makes the production code more fragile because baseUrl can also be changed during runtime. My preference would be to make baseUrl a const for production code but still be able to change. <code>  package mainconst baseUrl = ""http://google.com""// in main_test.gots := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) { ... }const baseUrl = ts.URL// above line throws const baseUrl already defined error",Redefine const in golang for test
Golang Web - HTML Comment is not rendered," I'm building go web application. I found some anomaly on the rendered html page. All of my html comments <!-- --> are suddenly not being rendered. My guess it's because the go version I used (just updated to higher version), because it was fine before I updated it.This is my code: And this is the rendered page source:Because of this issue, many of my KnockoutJS codes which are written using containerless control flow syntax goes crazy, it doesn't work at all.What should I do to solve this? Thanks in advance <code>  <!-- prepare the breadcrumbs --><ul class=""breadcrumb"" data-bind=""foreach: viewModel.breadcrumbs""> <!-- ko if: ($index() + 1) < len(viewModel.breadcrumbs()) --> <li> <a data-bind=""attr: { href: href }""> <i class=""fa fa-home""></i> <span data-bind=""text: title""></span> </a> </li> <!-- /ko --> <!-- ko if: ($index() + 1) == len(viewModel.breadcrumbs()) --> <li class=""active"" data-bind=""text: title""></li> <!-- /ko --></ul>",Go - HTML comments are not rendered
Golang Web - HTML Comments are not rendered," I'm building go web application. I found some anomaly on the rendered html page. All of my html comments <!-- --> are suddenly not being rendered. My guess it's because the go version I used (just updated to higher version), because it was fine before I updated it.This is my code: And this is the rendered page source:Because of this issue, many of my KnockoutJS codes which are written using containerless control flow syntax goes crazy, it doesn't work at all.What should I do to solve this? Thanks in advance <code>  <!-- prepare the breadcrumbs --><ul class=""breadcrumb"" data-bind=""foreach: viewModel.breadcrumbs""> <!-- ko if: ($index() + 1) < len(viewModel.breadcrumbs()) --> <li> <a data-bind=""attr: { href: href }""> <i class=""fa fa-home""></i> <span data-bind=""text: title""></span> </a> </li> <!-- /ko --> <!-- ko if: ($index() + 1) == len(viewModel.breadcrumbs()) --> <li class=""active"" data-bind=""text: title""></li> <!-- /ko --></ul>",Go - HTML comments are not rendered
command not found go on mac," I want to use Go, but I'm having trouble running the go command. I installed go1.5.2 darwin/amd64, but when I run the command go version, I get an error in the terminal zsh: command not found: go. I added the path export PATH=$PATH:/usr/local/go/bin to the bash profile, but I still get the error (I restarted the terminal btw). I uninstalled and reinstalled, but no luck. Can anybody help me troubleshoot this? I'm not sure if there was an error in the installation, but it downloaded ok. I may have to download an older version of go if this doesn't workout. <code> ",Command not found go  on Mac after installing Go
How to set the file version with go build?," I use go build to build a exe file.Then i view the property of the file(Right click the file -> property),In detail tab,the file's version is empty.How i to set the version of the exe file. <code> ","How to set the ""file version"" field in PE header of EXE files?"
What is the right approach to encapsulate platform specific code in GO?," I want to develop a small Go application, which shows the used key stroke shortcuts to the audience of a presentation.To hook into the keyboard events I will have to use some platform specific code. What is the Go way to encapsulate platform specific code? I've been searching for keywords like compiler switch or platform modules, but I couldn't really find something about. <code> ",What is the right approach to encapsulate platform specific code in Go?
Is it possible to host multiple domain TLS net/http in golang?," I have multiple domain (let's say abc.com and xyz.org) with diffrent certificate. Is it possible to use key and certificate based on hostname without going deep low level and net.Listen, etc. Just using simple http.ListenAndServeTLS(...) or similar ?Basically like what nginx does. <code> ",Is it possible to host multiple domain TLS in golang with net/http?
Golang Json single value parsing," In python you can take a json object and grab a specific item from it without declaring a struct, saving to a struct then obtaining the value like in Go. Is there a package or easier way to store a specific value from json in Go?python Go <code>  res = res.json()return res['results'][0] type Quotes struct {AskPrice string `json:""ask_price""`}quote := new(Quotes)errJson := json.Unmarshal(content, &quote)if errJson != nil { return ""nil"", fmt.Errorf(""cannot read json body: %v"", errJson)}",JSON single value parsing
Golang FuncType pointer of a struct member," Given the following types : I would like to pass the method process of the type A to another function and be able to access the content of the underlying instance of A.How should i pass the method to another function? Via a pointer? And how should it be called ?The Process() method won't modify the instance of A, i am using a pointer on the method receiver because the struct is quite large. The idea behind my question is to avoid declaring the function Process() outside the struct and pass a ton of arguments to it (instead it access to the members of the struct). <code>  type A struct { ...}func (a *A) Process() { ...}",Golang func pointer of a struct member
How to parse huge XML file with various elements in GO?," How can you parse a huge XML file that's having various elements (i.e. not same element repeated multiple times).Example: I want to write a script in Go that would allow me to split this file in multiple smaller files with specific amount of tags per file.All examples on how to parse XML with Go seems to rely on knowing the elements that you have in the file.Can the file be parsed without knowing that? Something like for each element in XML no matter what element is there (header, item, something, etc...) <code>  <stuff> <header>...</header> <item>...</item> ... <item>...</item> <something>...</sometihng></stuff>",How to parse huge XML file with various elements in Go?
How to setup Let's Encrypt for a Go server application," I have my own domain with web services written in Go. I am using the inbuilt Go web server, without Nginx or Apache in front.I would like to start serving over HTTPS and I realized Let's Encrypt is just about to become THE WAY for doing that.Can anyone share the whole setup procedure for configuring a Go app running on a Linux server? <code> ",How to set up Let's Encrypt for a Go server application
Using C(++) in a GoLang application for performance," I've started studying Go a couple of days ago and came by its CGO thing and the gccgo compiler. From my understanding this allows a Go program to compile using the Go compiler and compile C libraries using a C compiler and reference those libraries from inside a Go program. This is really interesting to me because this allows us to leverage C's performance (if needed) from our main program with little overhead.However I'm not sure how little that is, so I'm asking here: Are there cases where you would create a C library just to use it from inside your Go application? Or is this feature only to facilitate re-usability of existing C code?P.S: I think at the moment CGO doesn't support C++ but there was a post here of someone that was able to wrap C++ code using C functions and call them successfully. <code> ",Using C(++) in a Go application for performance
"Running code at noon, golang", Is it possible to execute code at a noon everyday? The program is handling user input the rest of its run time but needs to run a function at noon to output some text. What is the most effective way to do this? <code> ,Running code at noon in Golang
Golang logging http responses (in addition to requests)," I am using Go and the Gorilla web toolkit's mux and handler packages to build a complex application, part of which requires a http server. Gorilla's mux and handler packages work wonderfully and I am able to successfully get the http server up and running and it has been quite simple to log requests.However, I am unable to determine how I may log responses. Ideally, I would like a mechanism, similar to Gorilla's LoggingHandler, that ""wraps"" the logging mechanism easily.Is there a Go package that does easily wraps / logs responses? Is there a way to use Go or Gorilla's capabilities in this fashion that I have not considered? <code> ",Logging http responses (in addition to requests)
Relative imports in goLang," I have a go Project with the following directory structure I am trying to access function test1 from login.go. Here is what I have done But I always get Unresolved reference test1. I am new to go . Can anyone help why I am getting this error? <code>  utils(pkg) | auth.go (has a function names test1)controllers(pkg) | login.go (has a function names test2) import ""../utils""func test2(c *gin.Context) bool{ utils.test1()}",Relative imports in Go
Golang return pointer to interface error," I have a basic function in Go that opens a file and tries to decode its JSON contents.I am trying to extract the default json.NewDecoder() function so I can easily mock this in my tests.However, my implementation seems to return an error: cannot use json.NewDecoder (type func(io.Reader) *json.Decoder) as type decoderFactory in argument to NewConfigCode: Here's a link to the Go playgroundWhere am I going wrong? <code>  package mainimport ( ""encoding/json"" ""fmt"" ""io"" ""os"")type openFile func(name string) (*os.File, error)type decoderFactory func(r io.Reader) decodertype decoder interface { Decode(v interface{}) error}type Config struct { ConsumerKey, ConsumerSecret, AccessToken, AccessTokenSecret string}func NewConfig(open openFile, d decoderFactory) (*Config, error) { c := new(Config) file, err := open(""some.file"") if err != nil { return nil, fmt.Errorf(""error opening config file"") } defer file.Close() decoder := d(file) if err := decoder.Decode(&c); err != nil { return nil, fmt.Errorf(""error decoding config JSON"") } return c, nil}func main() { _, err := NewConfig(os.Open, json.NewDecoder) if err != nil { fmt.Fprintf(os.Stderr, ""something bad happened: %v\n"", err) }}",Golang return pointer to interface throws error
How do I open temporary page in browser in golang?, How do I temporarily open a web page in browser using golang?Like here is how it is done using HTTPServer in python. <code> ,How start web server to open page in browser in golang?
Go implicit convertion to interface does momory allocation?," When defining a function with variadic arguments of type interface{} (e.g. Printf), the arguments are apparently implicitly converted to interface instances. Does this conversion imply memory allocation? Is this conversion fast? When concerned by code efficiency, should I avoid using variadic functions? <code> ",Go implicit conversion to interface does memory allocation?
Golang idomatic nested error handling," I have recently gotten into Go and have seen a lot of discussion about how to do error handling.the pattern that I have seen laid out is the following: often times when managing amqp connections, my condition is that I want to continue only if the error is nil, because then I need to do something on the connection: as you can see I only want to run the line c.RegisterSomethingOnConnection if the error returned from Connect() is nil.However, I dislike the above due to the early returns. Early returns make me uncomfortable because in the long run it hurts readability and obscures exactly when a function exits. My solution so far has been to do the following: I like to do this for 2 reasons. First, it prevents returning nil. Second, I find it makes the code more maintainable as you can add easily add functionality before returning (i.e. logging) and not have certain paths miss the added functionality due to an early return.Is what I have done acceptable idiomatic Go or do I just need to get over my dislike of early returns and follow the that pattern? <code>  err := DoSomething()if err != nil { //handle}// continue c, err := Connect()if err != nil { return nil, err}s,err := c.RegisterSomethingOnConnection()if err != nil { return nil, err}val, err := s.DoSomething()return val, err var err errorvar val ReturnTypec,err := Connect()if err == nil { s,err := c.RegisterSomethingOnConnection() if err == nil { val,err = s.DoSomething() }}return val,err",Acceptable Golang idiomatic nested error handling?
Retrive item list by checking multiple attribute values in MongoDB in golang," This question based on MongoDB,How to retrieve selected items retrieve by selecting multiple condition.It is like IN condition in Mysql SELECT * FROM venuelist WHERE venueid IN (venueid1, venueid2)I have attached json data structure that I have used.[Ref: JSON STRUCTUE OF MONGODB ].As an example, it has a venueList then inside the venue list, It has several attribute venue id and sum of user agents name and total count as value.user agents mean user Os,browser and device information. In this case I used os distribution.In that case i was count linux,ubuntu count on particular venueid.it is like that, Finally I want to get count of all linux user count by selecting venueid list in one find query in MongoDB.As example, I want to select all count of linux users by conditioning if venue id VID1212 or VID4343Ref: JSON STRUCTUE OF MONGODB I am using golang as language to manipulation data with mongoldb using mgo.v2 package expected out put is : output linux : 12+2 = 14 ubuntu : 4+0 = 4 Don't consider inner list in venuelist. <code>  ""sum"" : [ { ""name"" : ""linux"", ""value"" : 12 }, { ""name"" : ""ubuntu"", ""value"" : 4 }], { ""_id"" : ObjectId(""57f940c4932a00aba387b0b0""), ""tenantID"" : 1, ""date"" : ""2016-10-09 00:23:56"", ""venueList"" : [ { ""id"" : VID1212, ""sum"" : [ { ""name"" : ""linux"", ""value"" : 12 }, { ""name"" : ""ubuntu"", ""value"" : 4 } ], ssidList : [ // this is list of ssids in venue { ""id"" : SSID1212, ""sum"" : [ { ""name"" : ""linux"", ""value"" : 8 }, { ""name"" : ""ubuntu"", ""value"" : 6 } ], macList : [ // this is mac list inside particular ssid ex: this is mac list inside the SSID1212 { ""id"" : 12:12:12:12:12:12, ""sum"" : [ { ""name"" : ""linux"", ""value"" : 12 }, { ""name"" : ""ubuntu"", ""value"" : 1 } ] } ] } ] }, { ""id"" : VID4343, ""sum"" : [ { ""name"" : ""linux"", ""value"" : 2 } ], ""ssidList"" : [ { ""id"" : SSID4343, ""sum"" : [ { ""name"" : ""linux"", ""value"" : 2 } ], ""macList"" : [ { ""id"" : 43:43:43:43:43:34, ""sum"" : [ { ""name"" : ""linux"", ""value"" : 2 } ] } ] } ] } ]}",Retrieve item list by checking multiple attribute values in MongoDB in golang
Dictionary equivalent of Python in Go language, I am looking for a way to store multiple values for each key (just like we can in python using dictionary) using Go.Is there a way this can be achieved in Go? <code> ,Go equivalent of Python's Dictionary
GraphQL Unknown field in InputObject," I'm attempting to pass an object as an argument to a query (rather than a scalar). From the docs it seems that this should be possible, but I can't figure out how to make it work.I'm using graphql-go, here is the test schema: And the inputtype I'm attempting to use (I've tried both an InputObject and a standard Object) And here is the graphql query I'm using to test: I'm getting the following error: The thing is, when I change the type to a string, it works fine. How do I use an object as an input arg?Thanks! <code>  var fileDocumentType = graphql.NewObject(graphql.ObjectConfig{Name: ""FileDocument"",Fields: graphql.Fields{ ""id"": &graphql.Field{ Type: graphql.String, Resolve: func(p graphql.ResolveParams) (interface{}, error) { if fileDoc, ok := p.Source.(data_format.FileDocument); ok { return fileDoc.Id, nil } return """", nil }, }, ""tags"": &graphql.Field{ Type: graphql.NewList(tagsDataType), Args: graphql.FieldConfigArgument{ ""tags"": &graphql.ArgumentConfig{ Type: tagsInputType, }, }, Resolve: func(p graphql.ResolveParams) (interface{}, error) { fmt.Println(p.Source) fmt.Println(p.Args) if fileDoc, ok := p.Source.(data_format.FileDocument); ok { return fileDoc.Tags, nil } return nil, nil }, },},}) var tagsInputType = graphql.NewInputObject(graphql.InputObjectConfig{Name: ""tagsInput"",Fields: graphql.Fields{ ""keyt"": &graphql.Field{ Type: graphql.String, }, ""valuet"": &graphql.Field{ Type: graphql.String, },},}) { list(location:""blah"",rule:""blah"") { id,tags(tags:{keyt:""test"",valuet:""test""}) { key, value }, { datacentre, handlerData { key, value } } } } wrong result, unexpected errors: [Argument ""tags"" has invalid value {keyt: ""test"", valuet: ""test""}.In field ""keyt"": Unknown field.In field ""valuet"": Unknown field.]",graphql-go : Use an Object as Input Argument to a Query
How to use sqlx to query IN a slice?," I want to query a table in mysql database for values IN a slice: But I get this error: How can I fix this?  <code>  var qids []int//fill qids dynamicallyerr = database.SQL.Select(&quotes, ""SELECT * FROM quote WHERE qid IN $1"", qids)if err != nil { log.Println(err)} sql: converting Exec argument #0's type: unsupported type []int, a slicequotes []",How to use sqlx to query mysql IN a slice?
Golang: How to install go fonts for golang developement, Go recently announced Go font most suitable for go development. https://blog.golang.org/go-fonts blog post has some details about it.However it is not very clear to me how to install them in my mac to use them in Go development. Can anyone help me out here please. <code> ,Golang: How to install official Go fonts for Golang developement
Is unamed arguments a thing in Go?," I am writing a parser in Go for Go, and to test it I downloaded a bunch of files from github projects.In https://github.com/andlabs/ui I bumped into a file containing this piece of code: It confuse me a bit to see a pointer to a Button without a name as a function argument, which makes it impossible to reference from inside the function.However, it seems to be syntactically correct given that the compiler doesn't complains.What is the purpose of unamed functions arguments in Go? <code>  func moveLabel(*Button) { from := movingCurrent to := 0 if from == 0 { to = 1 } movingBoxes[from].Delete(0) movingBoxes[to].Append(movingLabel, false) movingCurrent = to}",Is unnamed arguments a thing in Go?
How to use Golang Reflection to get the type of a struct field that is a slice?," I'm trying to use reflection to build a routine that will list the Name, Kind and Type of all fields in an arbitrary struct that gets passed in. Here is what I've got so far: The output is as follows: When the field is a slice, the type is blank. I tried several ways to get the slice's data type, but all attempts resulted in a panic... usually this one: What changes need to be made to this code so that the type for all fields, including slices, will be listed in the output?Here's the playground link: https://play.golang.org/p/zpfrYkwvlZ <code>  type StatusVal inttype Foo struct { Name string Age int}type Bar struct { Status StatusVal FSlice []Foo}func ListFields(a interface{}) { v := reflect.ValueOf(a).Elem() for j := 0; j < v.NumField(); j++ { f := v.Field(j) n := v.Type().Field(j).Name t := f.Type().Name() fmt.Printf(""Name: %s Kind: %s Type: %s\n"", n, f.Kind(), t) }}func main() { var x Bar ListFields(&x)} Name: Status Kind: int Type: StatusValName: FSlice Kind: slice Type: reflect: call of reflect.Value.Elem on slice Value",How to use Go reflection pkg to get the type of a slice struct field?
Read contents of tar file with golang without unzipping," I have been able to loop through the files in a tar file, but I am stuck on how to read the contents of those files as string. I would like to know how to print the contents of the files as a string?This is my code below <code>  package mainimport ( ""archive/tar"" ""fmt"" ""io"" ""log"" ""os"" ""bytes"" ""compress/gzip"")func main() { file, err := os.Open(""testtar.tar.gz"") archive, err := gzip.NewReader(file) if err != nil { fmt.Println(""There is a problem with os.Open"") } tr := tar.NewReader(archive) for { hdr, err := tr.Next() if err == io.EOF { break } if err != nil { log.Fatal(err) } fmt.Printf(""Contents of %s:\n"", hdr.Name) }}",Read contents of tar file without unzipping to disk
Go cannot assign to struct field in map," I have the data structure like this: Users is another struct.Then when I tried to append some new Users values in the Users slice like this: I kept getting this error: Also tried the workaround here https://github.com/golang/go/issues/3117 so like this: But no luck, still exactly same error.And also tried to declare the map with pointer, so: snapshots := make(map[string] *Snapshot, 1), still no luck. <code>  type Snapshot struct { Key string Users []Users}snapshots := make(map[string] Snapshot, 1)// then did the initializationsnapshots[""test""] = Snapshot { Key: ""testVal"", Users: make([]Users, 0),} snapshots[""test""].Users = append(snapshots[""test""].Users, user) cannot assign to struct field snapshots[""test""].Users in map tmp := snapshots[""test""].Userstmp = append(tmp, user)snapshots[""test""].Users = tmp",Cannot assign to struct field in a map
make a custom 404 with golang and mux," Here is my code about a small demonstration webserver written with the Go language and the gorilla mux package : But I don't find a way on how to implement a custom 404 page.But I can't make a r.HandleFunc(""/"",...) but it will be too greedy. <code>  package mainimport ( ""fmt"" ""github.com/gorilla/mux"" ""net/http"")func handler(w http.ResponseWriter, r *http.Request) { vars := mux.Vars(r) fmt.Fprintf(w, ""Hi there, I love %s!"", vars[""username""])}func homeHandler(w http.ResponseWriter, r *http.Request) { if r.URL.Path != ""/"" { errorHandler(w, r, http.StatusNotFound) return } vars := mux.Vars(r) fmt.Fprintf(w, ""Hi there, I love %s!"", vars[""username""])}func main() { r := mux.NewRouter() r.HandleFunc(""/help/{username}/"", handler) http.Handle(""/"", r) http.ListenAndServe("":8080"", nil)}",setup 404 NotFound handler on a gorilla mux router
Writer in golang - beginner trying to understand them," As a beginner in Go, I have problems understanding io.Writer. My target: take a struct and write it into a json file.Approach:- use encoding/json.Marshal to convert my struct into bytes- feed those bytes to an os.File WriterThis is how I got it working: After reading this article, I changed my program to this: In my opinion, the first example is a more straightforward and easier to understand for a beginner... but I have the feeling that the 2nd example is the Go idiomatic way of achieving the target. Questions:1. is above assumption correct (that 2nd option is Go idiomatic) ?2. Is there a difference in the above options ? Which option is better ?3. other ways to achieve the same target ? Thank you,WM <code>  package mainimport ( ""os"" ""encoding/json"")type Person struct { Name string Age uint Occupation []string}func MakeBytes(p Person) []byte { b, _ := json.Marshal(p) return b}func main() { gandalf := Person{ ""Gandalf"", 56, []string{""sourcerer"", ""foo fighter""}, } myFile, err := os.Create(""output1.json"") if err != nil { panic(err) } myBytes := MakeBytes(gandalf) myFile.Write(myBytes)} package mainimport ( ""io"" ""os"" ""encoding/json"")type Person struct { Name string Age uint Occupation []string}// Correct name for this function would be simply Write// but I use WriteToFile for my understandingfunc (p *Person) WriteToFile(w io.Writer) { b, _ := json.Marshal(*p) w.Write(b)}func main() { gandalf := Person{ ""Gandalf"", 56, []string{""sourcerer"", ""foo fighter""}, } myFile, err := os.Create(""output2.json"") if err != nil { panic(err) } gandalf.WriteToFile(myFile)}",io.Writer in Go - beginner trying to understand them
How to covert Unix time to time.Time in golang?," I want to covert Unix time (1494505756) to UTC formatjust I want to restore timeNow to UTC format. How to do that?  <code>  import ""time""timeNow := time.Now()",How to convert Unix time to time.Time in golang?
How remove \n from lines from golang?," end it add \n on every line , end program to work , only work with last line...Please put example, i try anything end any solution what i find here not work for me. <code>  file, _ := os.Open(""x.txt"") f := bufio.NewReader(file) for { read_line, _ := ReadString('\n') fmt.Print(read_line) // other code what work with parsed line... }",How remove \n from lines
golang http.Request: get file name from url," How do I get only the file name one.json from the following request: http://localhost/slow/one.json?I just need to serve this file and others from the url? This is a test server that I need to respond very slow. <code>  http.HandleFunc(""/slow/"", func(w http.ResponseWriter, r *http.Request) { log.Println(""Slow..."") log.Println(r.URL.Path[1:]) time.Sleep(100 * time.Millisecond) http.ServeFile(w, r, r.URL.Path[1:])})",http.Request: get file name from url
How can i let a function randomly return either a true or a false in go, I want to have a function that I can call to get a random true or false on each call: How can I return a random boolean? <code>  randBoolean() // true randBoolean() // false randBoolean() // false randBoolean() // true,How can I let a function randomly return either a true or a false in go
Best practices constructing an empty array in GoLang?," I'm wondering about best practices when initializing empty arrays.i.e. Is there any difference here between arr1, arr2, and arr3? I know that they make empty []int but I wonder, is one syntax preferable to the others? Personally I find the first to be most readable but that's beside the point here. One key point of contention may be the array capacity, presumably the default capacity is the same between the three as it is unspecified. Is declaring arrays of unspecified capacity ""bad""? I can assume it comes with some performance cost but how ""bad"" is it really?/tldr:Is there any difference between the 3 ways to make an emptyarray?What is the default capacity of an array when unspecified?What is the performance cost of using arrays with unspecified capacity? <code>  myArr1 := []int{}myArr2 := make([]int,0)var myArr3 []int",Best practices constructing an empty array
Golang. Download files by chunks in multiple threads," I need to download files, chunk by chunk in multiple threads.For example, I have 1k files, each file ~100Mb-1Gb and I can download these files only by chunks 4096Kb(each http get request gives me only 4kb).It might be to long to download it in one thread, so I want to download them, let's say in 20 threads(one thread for one file) and I also need to download a few chunks in each of these threads, simultaneously.Is there any example that shows such logic? <code> ",Download files by chunks in multiple threads in Go
Download files by chunks in multiple threads in Golang," I need to download files, chunk by chunk in multiple threads.For example, I have 1k files, each file ~100Mb-1Gb and I can download these files only by chunks 4096Kb(each http get request gives me only 4kb).It might be to long to download it in one thread, so I want to download them, let's say in 20 threads(one thread for one file) and I also need to download a few chunks in each of these threads, simultaneously.Is there any example that shows such logic? <code> ",Download files by chunks in multiple threads in Go
Assign default value for struct field in golang," I want to assign default value for struct field in Go. I am not sure if it is possible but while creating/initializing object of the struct, if I don't assign any value to the field, I want it to be assigned from default value. Any idea how to achieve it? <code>  type abc struct { prop1 int prop2 int // default value: 0}obj := abc{prop1: 5}// here I want obj.prop2 to be 0",Assign default value for struct field
Why i can't get the address when type conversion in go," When I compile this code, the compiler tells me that I cannot take the address of str(s). So my question is whether a type conversion may look for a new address to locate the current new s, or something else that I haven't thought of? <code>  func main() { s := ""hello, world"" type str string sp := &str(s)}",Why can't I get the address of a type conversion in Go?
Add single value at index in slice," Given I want to insert array2[2] i.e 6 at array1[1] i.e before 3 so that array1 becomes a slice of {1, 6, 3, 4, 5}. How can I do it?Most the techniques I read online involve using the : operator but results in remaining elements being inserted as well. How can I append single values at an index in a slice? <code>  array1 := []int{1, 3, 4, 5}array2 := []int{2, 4, 6, 8}",Insert a value in a slice at a given index
Insert value in a slice at given index," Given I want to insert array2[2] i.e 6 at array1[1] i.e before 3 so that array1 becomes a slice of {1, 6, 3, 4, 5}. How can I do it?Most the techniques I read online involve using the : operator but results in remaining elements being inserted as well. How can I append single values at an index in a slice? <code>  array1 := []int{1, 3, 4, 5}array2 := []int{2, 4, 6, 8}",Insert a value in a slice at a given index
Golang - Testing - Fill os.Stdin for function that reads from it," How do I fill os.Stdin in my test for a function that reads from it using a scanner?I request a user command line input via a scanner using following function: Now how do I test this case and simulate a user input?Following example does not work. Stdin is still empty. <code>  func userInput() error { scanner := bufio.NewScanner(os.Stdin) println(""What is your name?"") scanner.Scan() username = scanner.Text() /* ... */} func TestUserInput(t *testing.T) { var file *os.File file.Write([]byte(""Tom"")) os.Stdin = file err := userInput() /* ... */}",Fill os.Stdin for function that reads from it
"Golang: I want to split a file into equally sized ""chunks"", or slices and use goroutines to process them simultaneously"," Using Go, I have large log files. Currently I open them, create a new scanner bufio.NewScanner, and then for scanner.Scan() to loop through the lines. Each line is sent through a processing function, which matches it to regular expressions and extracts data. I would like to process this file in chunks simultaneously using goroutines. I believe this may be quicker than looping through the whole file sequentially.It can take a few seconds per file, and I'm wondering if I can process a single file in, say, 10 pieces at a time. I believe I can sacrifice the memory if needed. I have ~3gb, and the biggest log file is maybe 75mb.I see that a scanner has a .Split() method, where you can provide a custom split function, but I wasn't able to find a good solution using this method.I've also tried creating a slice of slices, looping through the scanner with scanner.Scan() and appending scanner.Text() to each slice.eg: I'm new to Go and concerned about efficiency and performance. I want to learn how to write good Go code! Any help or advice is really appreciated. <code>  // pseudocode because I couldn't get this to work eitherscanner := bufio.NewScanner(logInfo)threads := [[], [], [], [], []]i := 0for scanner.Scan() { i = i + 1 if i > 5 { i = 0 } threads[i] = append(threads[i], scanner.Text())}fmt.Println(threads)","I want to split a file into equally sized ""chunks"", or slices and use goroutines to process them simultaneously"
How are go channels different from js generators?," Go channels can be used to communicate in between goroutines. Similarly, the yield and next syntax can be used to communicate between two generators. Am I right in my assumption? If not, where am I wrong? <code> ",How are Go channels different from JavaScript generators?
Golang response with JSON," I am new to Go, and I am trying to practice with building a simple HTTP server. However I met some problems with JSON responses. I wrote following code, then try postman to send some JSON data. However, my postman always gets an empty response and the content-type is text/plain; charset=utf-8. Then I checked a sample in http://www.alexedwards.net/blog/golang-response-snippets#json. I copied and pasted the sample, and it was working well. But I cannot see any difference between mine and the sample. Can someone give some help? <code>  package mainimport ( ""encoding/json"" ""net/http"")type ResponseCommands struct { key string value bool}func main() { http.HandleFunc(""/"", handler) http.ListenAndServe("":5432"", nil)}func handler(rw http.ResponseWriter, req *http.Request) { responseBody := ResponseCommands{""BackOff"", false} data, err := json.Marshal(responseBody) if err != nil { http.Error(rw, err.Error(), http.StatusInternalServerError) return } rw.WriteHeader(200) rw.Header().Set(""Content-Type"", ""application/json"") rw.Write(data)}",Making HTTP responses with JSON
How Go runtime check if goroutine is blocked?," Go docs says that: When a coroutine blocks, such as by calling a blocking system call, the run-time automatically moves other coroutines on the same operating system thread to a different, runnable thread so they won't be blockedBut how does runtime detect that goroutine is blocked?For example if I will run calculation in one of go-routine will it be evaluated as blocking operation? I am getting result: baz, boo bar. But why? Does Go understand that foo is blocking? <code>  package mainimport ( ""fmt"" ""runtime"")func f(from string, score int) { for i := 0; i < score; i++ { for z := 0; z < score; z++ { } } fmt.Println(from, "" Done"")} func main() {runtime.GOMAXPROCS(1)f(""direct"", 300000)go f(""foo"", 200000)go f(""bar"", 20000)go f(""baz"", 2000) go func(msg string) { fmt.Println(msg) }(""going without loop"") var input string fmt.Scanln(&input) fmt.Println(""done"")}",How Go runtime checks if goroutine is blocked?
Using a subquery in 'FROM'," I would like to know how I can use a subquery in FROM clause using gorm. It would look like the following: I have built the subquery using golang: But how can I use this as a subquery in FROM?If there is a method that turns a gorm query into a SQL string, then I can simply plug that string into a raw SQL. But there does not seem to be such method. Any suggestions? <code>  SELECT * FROM ( SELECT foo.* FROM foo WHERE bar = ""baz"") AS t1WHERE t1.id = 1; db.Model(Foo{}).Where(""bar = ?"", ""baz"")",Using a subquery in 'FROM' in gorm
"go : The term 'go' is not recognized as the name of a cmdlet, function, script file, or operable program"," After running... I get this error <code>  go run main.go go : The term 'go' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verifythat the path is correct and try again.","The term 'go' is not recognized as the name of a cmdlet, function, script file, or operable program"
Golang - how do you remove the first character of a string?, What is the suggested method to remove the first character of a string?I've looked through the documentation for string methods but I don't see anything that works like javascript's String.slice(). <code> ,How do you remove the first character of a string?
go- How to clean a sync.map," I can't have access to map inside Range loop method. I just want an equivalente method of normal map apply in sync.map https://play.golang.org/p/515_MFqSvCm <code>  package mainimport ( ""sync"")type list struct { code string fruit}type fruit struct { name string quantity int}func main() { lists := []list{list{""asd"", fruit{""Apple"", 5}}, list{""ajsnd"", fruit{""Apple"", 10}}, list{""ajsdbh"", fruit{""Peach"", 15}}} map1 := make(map[string]fruit) var map2 sync.Map for _, e := range lists { map1[e.code] = e.fruit map2.Store(e.code, e.fruit) } //erase map for k, _ := range map1 { delete(map1, k) } //cant pass map as argument,so I cant delete its values map2.Range(aux)}func aux(key interface{}, value interface{}) bool { map2.Delete(key) //doesnt work return true}",How to clean a sync.map?
How can I trim whitespaces in GO from a slice after Split," I have a string that is comma separated, so it could betest1, test2, test3 or test1,test2,test3 or test1, test2, test3.I split this in Go currently with strings.Split(s, "",""), but now I have a []string that can contain elements with an arbitrary numbers of whitespaces.How can I easily trim them off? What is best practice here?This is my current code I come from Java and assumed that there is a map/reduce etc functionality in Go also, therefore the question. <code>  var property= os.Getenv(env.templateDirectories)if property != """" { var dirs = strings.Split(property, "","") for index,ele := range dirs { dirs[index] = strings.TrimSpace(ele) } return dirs}",How can I trim whitespaces in Go from a slice after Split
detect last item inside a range using go-templates," This program outputs simply 1,4,2,but I would like to print 1,4,2.As you can see the comma is printed after each items of an array. Is there a way to change {{range $i, $el := .items}}{{$el}},{{end}} and be sure that last item will print ""."" instead of "","" <code>  package mainimport ""os""import ""text/template""func main() { params := map[string]interface{}{ ""items"": [3]int{1, 4, 2}, } tpl := ""{{range $i, $el := .items}}{{$el}},{{end}}"" lister, _ := template.New(""foo"").Parse(tpl) lister.Execute(os.Stdout, params)}",detect last item inside an array using range inside go-templates
How to cancel fmt.Scanf," I have a very simple command line utility and at the end of it I'm waiting for a user to hit the enter key to end the program: Now I want to change it and if the enter key hasn't been hit for some time, I want to cancel Scanf and do something else. Is it possible to cancel waiting for user's input? <code>  fmt.Scanf(""\n"") // wait for hitting the enter key to end the program",How to cancel fmt.Scanf after a certain timeout?
How to cancel fmt.Scanf after timeout," I have a very simple command line utility and at the end of it I'm waiting for a user to hit the enter key to end the program: Now I want to change it and if the enter key hasn't been hit for some time, I want to cancel Scanf and do something else. Is it possible to cancel waiting for user's input? <code>  fmt.Scanf(""\n"") // wait for hitting the enter key to end the program",How to cancel fmt.Scanf after a certain timeout?
How to cancel fmt.Scanf after a timeout," I have a very simple command line utility and at the end of it I'm waiting for a user to hit the enter key to end the program: Now I want to change it and if the enter key hasn't been hit for some time, I want to cancel Scanf and do something else. Is it possible to cancel waiting for user's input? <code>  fmt.Scanf(""\n"") // wait for hitting the enter key to end the program",How to cancel fmt.Scanf after a certain timeout?
"All the suddan go tool: no such tool ""compile"""," I had installed go on my Ubuntu desktop and it worked fine before I switch off the computer. Now as I started my machine and resumed my work on the project, I get this When I try to build a project. The only thing that I did before poweroff which might have some effect was to install godoc using I had install go directly by downloading go1.10.1.linux-amd64.tar.gz file, not using apt-getgo env $ go version I can still run comiled go code. What could have gone wrong here? How can I fix it?  <code>  $ go buildgo tool: no such tool ""compile""go tool: no such tool ""compile""go tool: no such tool ""compile""go tool: no such tool ""compile""go tool: no such tool ""compile"" sudo apt-get install golang-doc GOARCH=""amd64""GOBIN=""""GOCACHE=""/home/me/.cache/go-build""GOEXE=""""GOHOSTARCH=""amd64""GOHOSTOS=""linux""GOOS=""linux""GOPATH=""/home/me/go""GORACE=""""GOROOT=""/usr/local/go""GOTMPDIR=""""GOTOOLDIR=""/usr/local/go/pkg/tool/linux_amd64""GCCGO=""gccgo""CC=""gcc""CXX=""g++""CGO_ENABLED=""1""CGO_CFLAGS=""-g -O2""CGO_CPPFLAGS=""""CGO_CXXFLAGS=""-g -O2""CGO_FFLAGS=""-g -O2""CGO_LDFLAGS=""-g -O2""PKG_CONFIG=""pkg-config""GOGCCFLAGS=""-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build255010769=/tmp/go-build -gno-record-gcc-switches"" go version go1.10.1 linux/amd64","All of a sudden go tool: no such tool ""compile"""
"What do ""value semantics"" and ""pointer semantics"" mean in Go(Golang)?"," What is the meaning of Value semantics and Pointer semantics in Go? In this course, the author used to mention many times about above terms when explaining internals of arrays and slices which I couldn't understand it completely. <code> ","What do ""value semantics"" and ""pointer semantics"" mean in Go?"
"Go + MySQL. How to read a row from a table to a map, Without knowing columns"," In my golang app i need to do SQL query to MySQL to get single row and put result in a map[string]string keys are column names.But i don't know what will be columns. Query is like I use ""database/sql"" .I found only Scan function but this doesn't work for my condition. I don't know how many variables will be there. And also I need column names.Is it possible to do with database/sql ?Update. I found how to solve part of this problem. How to get column names from a result set. So, i can use to make keys for a map. But i still don't know how to get values. Because, values can have different type. P.S. This question is not duplicate of ""Get table column names in mysql?"". I wanted to get columns of returned data set, not just a table. <code>  SELECT * FROM mytable db.QueryRow(""SELECT * FROM mytable"").Scan(&var1, &var2,...) rows, err := db.Query(sqlcommand)cols, err := rows.Columns() data = make(map[string]string)if rows.Next() { columns := make([]interface{}, len(cols)) columnPointers := make([]interface{}, len(cols)) for i, _ := range columns { columnPointers[i] = &columns[i] } err = rows.Scan(columnPointers...) for i, colName := range cols { // value is in columns[i] of interface type. // How to extract it from here? // .... data[colName] = val }}","How to read a row from a table to a map, Without knowing columns"
Go template : Get index number from range, In to get the index number php: How can I get the index number in go? <code>  foreach much as index => each{ //get index number from index} {{ range .post }} {{ // how can i get index number? }} {{ .Id }} {{ .Name}}{{ end}},Get index number from range
How to return nil strong in Go," I have a function which returns a string under certain circumstances, namely when the program runs in Linux or MacOS, otherwise the return value should be nil in order to omit some OS-specific checks further in code. however when I try to compile this code I get an error:test.go:10:3: cannot use nil as type string in return argument.If I return just an empty string like return """", I cannot compare this return value with nil further in code.So the question is how to return a correct nil string value? <code>  func test() (response string) { if runtime.GOOS != ""linux"" { return nil } else { /* blablabla*/ }}",How to Return Nil String in Go?
How to return nil string in Go?," I have a function which returns a string under certain circumstances, namely when the program runs in Linux or MacOS, otherwise the return value should be nil in order to omit some OS-specific checks further in code. however when I try to compile this code I get an error:test.go:10:3: cannot use nil as type string in return argument.If I return just an empty string like return """", I cannot compare this return value with nil further in code.So the question is how to return a correct nil string value? <code>  func test() (response string) { if runtime.GOOS != ""linux"" { return nil } else { /* blablabla*/ }}",How to Return Nil String in Go?
Go: How to create local module and add version to it and use it in my another module?," I've created a library as the module for personal use outside of ""GOPATH"" in ""database"" folder with this command ""go mod init database,"" and I don't know:How to use/import this module in another module?OS: Windows 7, Go: v1.11 <code> ","How to use a module that is outside of ""GOPATH"" in another module?"
How to create local module and add version to it and use it in my another module?," I've created a library as the module for personal use outside of ""GOPATH"" in ""database"" folder with this command ""go mod init database,"" and I don't know:How to use/import this module in another module?OS: Windows 7, Go: v1.11 <code> ","How to use a module that is outside of ""GOPATH"" in another module?"
Get current resource usage of a pod with kubernetes go client," The kubernetes go client has tons of methods and I can't find how I can get the current CPU & RAM usage of a specific (or all pods).Can someone tell me what methods I need to call to get the current usage for pods & nodes?My NodeList: Kubernetes Go Client: https://github.com/kubernetes/client-goMetrics package: https://github.com/kubernetes/kubernetes/tree/master/staging/src/k8s.io/metricsAs far as I got the metrics server implements the Kubernetes metrics package in order to fetch the resource usage from pods and nodes, but I couldn't figure out where & how they do it: https://github.com/kubernetes-incubator/metrics-server <code>  nodes, err := clientset.CoreV1().Nodes().List(metav1.ListOptions{})",Get current resource usage of a pod in Kubernetes with Go client
Adding label to golfing prometheus collector," I'm trying to figure out how to add a label to a prometheus collector. Any ideas what I'm missing here? I have two files: main.go and collector.goI used the following link as a guide. https://rsmitty.github.io/Prometheus-Exporters/I mocked up this example, so I could post it here. I'm ultimately not going to pull ""date +%s"" for the command. Just can't figure out where to add labels.For the label I'm trying to add a hostname, so I have a result like: I'm also really new to golang, so there is a good chance I'm going about this all wrong! I'm ultimately trying to get prometheus to pull the cmd result on each scrape.main.go collector.go <code>  # HELP cmd_result Shows the cmd result# TYPE cmd_result gaugecmd_result{host=""my_device_hostname""} 1.919256141363144e-76 package mainimport ( ""net/http"" log ""github.com/Sirupsen/logrus"" ""github.com/prometheus/client_golang/prometheus"" ""github.com/prometheus/client_golang/prometheus/promhttp"")func main() { //Create a new instance of the collector and //register it with the prometheus client. cmd := newCollector() prometheus.MustRegister(cmd) //This section will start the HTTP server and expose //any metrics on the /metrics endpoint. http.Handle(""/metrics"", promhttp.Handler()) log.Info(""Beginning to serve on port :8080"") log.Fatal(http.ListenAndServe("":8080"", nil))} package mainimport ( ""encoding/binary"" ""fmt"" ""math"" ""os/exec"" ""strings"" ""github.com/prometheus/client_golang/prometheus"")type cmdCollector struct { cmdMetric *prometheus.Desc}func newCollector() *cmdCollector { return &cmdCollector{ cmdMetric: prometheus.NewDesc(""cmd_result"", ""Shows the cmd result"", nil, nil, ), }}func (collector *cmdCollector) Describe(ch chan<- *prometheus.Desc) { ch <- collector.cmdMetric}func (collector *cmdCollector) Collect(ch chan<- prometheus.Metric) { var metricValue float64 command := string(""date +%s"") cmdResult := exeCmd(command) metricValue = cmdResult ch <- prometheus.MustNewConstMetric(collector.cmdMetric, prometheus.GaugeValue, metricValue)}func exeCmd(cmd string) float64 { parts := strings.Fields(cmd) out, err := exec.Command(parts[0], parts[1]).Output() if err != nil { fmt.Println(""error occured"") fmt.Printf(""%s"", err) } cmdProcessResult := Float64frombytes(out) return cmdProcessResult}func Float64frombytes(bytes []byte) float64 { bits := binary.LittleEndian.Uint64(bytes) float := math.Float64frombits(bits) return float}",Adding label to golang prometheus collector
Lazy evaluation in Go," My understanding of short circuit evaluation is that an expression is only called when needed in an if statement. Does Go follow this?For instance, would I get better performance on average from: ...to this: ...since isValidQueryParams is a function with much more overhead than r == nil or testing the length of a map?i.e. will the interpreter evaluate r == nil first, see it's true and not bother to evaluate the other conditions?EDIT: Incorrectly referred to short circuit evaluation as lazy evaluation <code>  if !isValidQueryParams(&queries) || r == nil || len(queries) == 0 { return """", fmt.Errorf(""invalid querystring"")} if r == nil || len(queries) == 0 || !isValidQueryParams(&queries) { return """", fmt.Errorf(""invalid querystring"")}",Short circuit evaluation in Go
Golang : How to get error message in exec command," I am using Go to create a CLI. I am executing a command and if there is an error thrown from the OS I want to print it. This only gives me the exit status code This is not descriptive enough.When I run the command directly in terminal I get the error message clearly. Is there a way to print the message? <code>  cmd := exec.Command(""abc"", ""run"", pathToFile)err := cmd.Start()if err != nil { fmt.Printf(""Error : %v \n"", err) os.Exit(1)}err = cmd.Wait()if err != nil { fmt.Printf(""Error: %v \n"", err) os.Exit(1)} Error: exit status 1 source does not exist 'test.exe'",How to get error message from exec command
Efficient sorting of an array of strings with a custom defined alphabet in Go," Please read to the bottom before marking this as duplicateI would like to be able to sort an array of strings (or a slice of structs based on one string value) alphabetically, but based on a custom alphabet or unicode letters.Most times people advise using a collator that supports different pre-defined locales/alphabets. (See this answer for Java), but what can be done for rare languages/alphabets that are not available in these locale bundles?The language I would like to use is not available in the list of languages supported and usable by Golangs's collate, so I need to be able to define a custom alphabet, or order of Unicode characters/runes for sorting. Others suggest translate the strings into an english/ASCII sortable alphabet first, and then sort that. That's what's been suggested by a similar question in this solution done in Javascript or this solution in Ruby. But surely there must be a more efficient way to do this with Go.Is it possible to create a Collator in Go that uses a custom alphabet/character set? Is that what func NewFromTable is for?It seems that I should be able to use the Reorder function but it looks like this is not yet implemented in the language? The source code shows this: How can I define a custom alphabet order for comparing and sorting strings in go? <code>  func Reorder(s ...string) Option { // TODO: need fractional weights to implement this. panic(""TODO: implement"")}",How can I define a custom alphabet order for comparing and sorting strings in go?
Golang how to create a hidden file in Windows/Mac/Linux?," I build an console application, need create some hidden files. As well I know filename start with dot will hidden in Linux and mac, but windows?Set file attributes?Is there a way to create hidden files and directories in both Windows / Linux / Mac? <code> ",How to create a hidden file in Windows/Mac/Linux?
GO Escape analysis shows channel as leaking param," What I'm trying to do:I'm trying to understand/build a go pipeline with three stages. Stage 1 writes to channel A. Stage 2 has multiple go routines. Each go routine reads from Channel A, performs some operation and writes result to Channel Bn(Channel B1, B2..Bn). Stage 3 has creates n(=total number of Channels in Stage 2) go routines, each go routine reads from one Channel from stage 2. It is based on bounded parallelism described in https://blog.golang.org/pipelinesIssue:The pipeline works fine as expected, the operation is distributed among go routines. But when I did an escape analysis and found that channel parameter sent from one stage to another is reported as ""leaking param"".Code snippet:For simplicity, I'm posting code that shows stage 1 channel creation, and a stage 2 that prints value read from stage channel 1. Here is the escape analysis result Why is escape analysis reporting leaking param on in and completionFlag flag? <code>  package mainimport ""fmt""func createStageOne(numOfJobs int) <-chan int { stageOneChannel := make(chan int) go func(nJobs int) { for i := 0; i < nJobs; i++ { stageOneChannel <- i } close(stageOneChannel) }(numOfJobs) return stageOneChannel} // stageOneChannel closes and go routine exits once nJobs are completed func createStageTwo(in <-chan int, completionFlag chan struct{}) { go func() { for n := range in { fmt.Println(""Received from stage 1 channel "", n) } completionFlag <- struct{}{} }()}// Comes out of for loop when stage 1 channel closes and go routine also exitsfunc main() { numOfJobs := 10 stageOneChannel := createStageOne(numOfJobs) done := make(chan struct{}) createStageTwo(stageOneChannel, done) <-done} $ go build -gcflags ""-m -l""# concurrentHTTP/stackoverflow./pipeline.go:7:5: func literal escapes to heap./pipeline.go:7:5: func literal escapes to heap./pipeline.go:6:25: make(chan int) escapes to heap./pipeline.go:17:5: func literal escapes to heap./pipeline.go:17:5: func literal escapes to heap./pipeline.go:16:21: leaking param: in./pipeline.go:16:36: leaking param: completionFlag./pipeline.go:19:16: ""Received from stage 1 channel "" escapes to heap./pipeline.go:19:16: n escapes to heap./pipeline.go:19:15: createStageTwo.func1 ... argument does not escape./pipeline.go:29:14: make(chan struct {}) escapes to heap",Escape analysis shows channel as leaking param
Golang: Easily Know if Any Test Fails," I test my code with go test ./... -v -short.Unfortunately, -v only prints out each test as it happens, but does not leave a summary of the results at the bottom like in Java. This means that if any test failed somewhere at the top, I have to scroll up and look for the word FAIL or search for it in a text editor.The -failfast flag isn't helping either because some of my tests still get printed after the first test failure for some reason.I don't really care if tests get run after the initial test failure. I just want to be able to easily tell if any test failed, preferably in just one place (e.g. a summary of how many tests passed or failed, or by seeing a flag if all tests passed or not).Is there a way to easily tell if there was a test failure because I don't want to accidentally continue coding if I still have test failures.I'm on Windows 10 64-bit.UPDATE: Many thanks to @icza for the findstr tip. I later realized that I also wanted to see the error descriptions along with the test failures, but did not want to run go test twice. This is what I came up with for CMD (does not work on Powershell): Now findstr should report test failures as well as error descriptions. And if you want to see the full test results, simply open test-results.txt. <code>  go test ./... -v -short > test-results.txt & findstr ""FAIL _test"" test-results.txt",How to easily find out which tests fail
Golang: Easily find out which tests fail," I test my code with go test ./... -v -short.Unfortunately, -v only prints out each test as it happens, but does not leave a summary of the results at the bottom like in Java. This means that if any test failed somewhere at the top, I have to scroll up and look for the word FAIL or search for it in a text editor.The -failfast flag isn't helping either because some of my tests still get printed after the first test failure for some reason.I don't really care if tests get run after the initial test failure. I just want to be able to easily tell if any test failed, preferably in just one place (e.g. a summary of how many tests passed or failed, or by seeing a flag if all tests passed or not).Is there a way to easily tell if there was a test failure because I don't want to accidentally continue coding if I still have test failures.I'm on Windows 10 64-bit.UPDATE: Many thanks to @icza for the findstr tip. I later realized that I also wanted to see the error descriptions along with the test failures, but did not want to run go test twice. This is what I came up with for CMD (does not work on Powershell): Now findstr should report test failures as well as error descriptions. And if you want to see the full test results, simply open test-results.txt. <code>  go test ./... -v -short > test-results.txt & findstr ""FAIL _test"" test-results.txt",How to easily find out which tests fail
go modules: how to use a forked module," I forked a go module, and want to use the fork in my project that uses versioned modules via v1.12. My code is not inside my GOPATH. My project's go.mod: protoc-gen-twirp_typescript is a tool for protoc, so here is my tools.go: When I run go mod tidy to download my dependencies, I get this error: Why am I getting this error? I thought the replace directive in go.mod allows for the forked modules go.mod to stay untouched. <code>  module github.com/me/myprojgo 1.12require ( go.larrymyers.com/protoc-gen-twirp_typescript v0.0.0-20190605194555-ffbfe407b60f)replace go.larrymyers.com/protoc-gen-twirp_typescript => github.com/rynop/protoc-gen-twirp_typescript master // +build toolspackage toolsimport ( // protocol buffer compiler plugins _ ""github.com/golang/protobuf/protoc-gen-go"" _ ""github.com/mwitkow/go-proto-validators/protoc-gen-govalidators"" _ ""github.com/twitchtv/twirp/protoc-gen-twirp"" _ ""github.com/rynop/protoc-gen-twirp_typescript"") go: finding github.com/rynop/protoc-gen-twirp_typescript mastergo: finding github.com/rynop/protoc-gen-twirp_typescript latestgo: github.com/rynop/protoc-gen-twirp_typescript@v0.0.0-20190618203538-a346b5d9c8fb: parsing go.mod: unexpected module path ""go.larrymyers.com/protoc-gen-twirp_typescript""","How to use a forked module, with versioned Go Modules (v1.11+, GO111MODULE=on)"
How to use a forked module," I forked a go module, and want to use the fork in my project that uses versioned modules via v1.12. My code is not inside my GOPATH. My project's go.mod: protoc-gen-twirp_typescript is a tool for protoc, so here is my tools.go: When I run go mod tidy to download my dependencies, I get this error: Why am I getting this error? I thought the replace directive in go.mod allows for the forked modules go.mod to stay untouched. <code>  module github.com/me/myprojgo 1.12require ( go.larrymyers.com/protoc-gen-twirp_typescript v0.0.0-20190605194555-ffbfe407b60f)replace go.larrymyers.com/protoc-gen-twirp_typescript => github.com/rynop/protoc-gen-twirp_typescript master // +build toolspackage toolsimport ( // protocol buffer compiler plugins _ ""github.com/golang/protobuf/protoc-gen-go"" _ ""github.com/mwitkow/go-proto-validators/protoc-gen-govalidators"" _ ""github.com/twitchtv/twirp/protoc-gen-twirp"" _ ""github.com/rynop/protoc-gen-twirp_typescript"") go: finding github.com/rynop/protoc-gen-twirp_typescript mastergo: finding github.com/rynop/protoc-gen-twirp_typescript latestgo: github.com/rynop/protoc-gen-twirp_typescript@v0.0.0-20190618203538-a346b5d9c8fb: parsing go.mod: unexpected module path ""go.larrymyers.com/protoc-gen-twirp_typescript""","How to use a forked module, with versioned Go Modules (v1.11+, GO111MODULE=on)"
Golang - error loading module requirements," I have a rest api I built in Go with gin that has been working for months now on my local machine running 1.12.1. I decided it was going to a docker deploy so I started building with 1.12.6 when I started see errors during module retrieval. I went back to my local machine, ran running 1.12.1 and ran go clean -modcache, now the error is there as well. I've tried regenerating multiple times even editing the go.sum file to different versions of gofight but I'm lost and run out of ideas.The output w/error: go.mod go.sum (the line for the module in question, posting the whole thing exceeds SO post length) I've also tried adjusting the go 1.12 statement in go.mod for the specific subversions I'm attempting to build with but that had no effect.What does this error mean? How can I fix it? <code>  go: github.com/appleboy/gofight@v2.0.0+incompatible: go.mod has post-v2 module path ""github.com/appleboy/gofight/v2"" at revision v2.0.0go: error loading module requirements module go-hybrid-alertgo 1.12require ( cloud.google.com/go v0.37.0 firebase.google.com/go v3.6.0+incompatible github.com/Luzifer/go-openssl v2.0.0+incompatible github.com/PuerkitoBio/goquery v1.5.0 github.com/antchfx/htmlquery v1.0.0 // indirect github.com/antchfx/xmlquery v1.0.0 // indirect github.com/antchfx/xpath v0.0.0-20190129040759-c8489ed3251e // indirect github.com/appleboy/gin-jwt v0.0.0-20190216100112-ca1084e5d5a2 github.com/gin-contrib/sse v0.0.0-20190301062529-5545eab6dad3 // indirect github.com/gin-gonic/gin v1.3.0 github.com/go-redis/redis v6.15.2+incompatible github.com/gobwas/glob v0.2.3 // indirect github.com/gocolly/colly v1.2.0 github.com/kennygrant/sanitize v1.2.4 // indirect github.com/kisielk/godepgraph v0.0.0-20181003180210-9a9a3d47fba3 // indirect github.com/levigross/grequests v0.0.0-20190130132859-37c80f76a0da // indirect github.com/mattn/go-isatty v0.0.7 // indirect github.com/mitchellh/mapstructure v1.1.2 github.com/saintfish/chardet v0.0.0-20120816061221-3af4cd4741ca // indirect github.com/temoto/robotstxt v0.0.0-20180810133444-97ee4a9ee6ea // indirect github.com/ugorji/go/codec v0.0.0-20190316083543-95c34d148dff // indirect golang.org/x/crypto v0.0.0-20190313024323-a1f597ede03a golang.org/x/net v0.0.0-20190313220215-9f648a60d977 google.golang.org/api v0.2.0 gopkg.in/dgrijalva/jwt-go.v3 v3.2.0 // indirect gopkg.in/go-playground/validator.v8 v8.18.2 // indirect) github.com/appleboy/gofight v2.0.0+incompatible/go.mod h1:H/tvof1oZHnZdlBd+AeODZGkk1C+D2na0NXr0iXuZHA=",go.mod has post-v2 module path at revision v2.0.0
Golang : Failed to find any PEM data in key," I am trying to run an HTTPS rest server locally. I followed this help: Golang TLSIt works fine when using self-signed certificates as in the above tutorial. But when I replace these certificates with one I generated from GoDaddy for one of my websites, I get ListenAndServe: tls: failed to find any PEM data in key inputThese certificates work properly on the apache server but not on my local Go server. <code>  package mainimport ( ""log"" ""net/http"")func HelloServer(w http.ResponseWriter, req *http.Request) { w.Header().Set(""Content-Type"", ""text/plain"") _, _ = w.Write([]byte(""This is an example server.\n""))}func main() { //https://localhost:443/hello http.HandleFunc(""/hello"", HelloServer) err := http.ListenAndServeTLS("":443"", ""../../../../../sslcert/server.crt"", ""../../../../../sslcert/server.key"", nil) if err != nil { log.Fatal(""ListenAndServe: "", err) }}",Failed to find any PEM data in key
How can I convert my mgo sessions to mongo-go-driver clients using connection poling?," Long, long ago, when we were using mgo.v2, we created some wrapper functions that copied the session, set the read pref and returned that for consumption by other libraries, e.g. We now just pass the default client (initialized using mongo.Connect and passed into a connection singleton) in an init function and then consumed like this: My understanding is that to leverage connection pooling, you need to use the same client (which is contained in defaultConn), and session is now implicitly handled inside of the .All()/cursor teardown. Please correct me if I'm wrong here.It would be nice if we could still set the readpref on these connections (e.g. set NearestMode on this connection before returning), but what's the community/standard way of doing that?I know I could call mongo.Connect over and over again, but is that expensive?I could create different clients - each client with a different readpref - but I was thinking that if a write occurred on that connection, it wouldn't ever go back to reading from a slave.It looks like I *can create sessions explicitly, but I'm not certain I should or if there are any implications around managing those explicitly in the new driver. <code>  func NewMonotonicConnection() (conn *Connection, success bool) { conn := &Connection{ session: baseSession.Copy(), } conn.session.SetMode(mongo.Monotonic, true) return conn, true} func NewMonotonicConnection() (conn *Connection, success bool) { conn = defaultConnection return conn, true}",How can I convert my mgo sessions to mongo-go-driver clients using connection pooling?
how to resolve Consider preallocating (prealloc) in golang lint?," I catch Consider preallocating [to] (prealloc) this problen in golangci-lintmy code is: Do you have an idea to resolve this problem in lint? <code>  var to []stringfor _, t := range s.To { to = append(to, t.String())}",How to resolve Consider preallocating (prealloc) lint?
"GoLang Error: interface conversion interface {} is []interface {}, not map[string]interface {}"," I am building a project that takes a term from the user and then performs a google search and returns a list of titles in json format.I am using the serpwow API to perform the google search and am trying to parse the response.However I am getting the error that states: I have looked through various forms and have tried to learn how mapping works but I am not sure why in this case, my mapping is not working. The table for organic results looks like this: and here is a snip of my code: }Can someone please help me figure our where my logic is wrong? <code>  panic: interface conversion: interface {} is []interface {}, not map[string]interface {}. ""organic_results"": [ { ""position"": 1, ""title"": ""The 10 Best Pizza Places in Dublin - TripAdvisor"", ""link"": ""https://www.tripadvisor.ie/Restaurants-g186605-c31-Dublin_County_Dublin.html"", ""domain"": ""www.tripadvisor.ie"", ""displayed_link"": ""https://www.tripadvisor.ie ... County Dublin Dublin"", ""snippet"": ""Best Pizza in Dublin, County Dublin: Find TripAdvisor traveller reviews of Dublin Pizza places and search by price, location, and more."", ""prerender"": false, ""snippet_matched"": [ ""Pizza"", ""Pizza"" ], ""cached_page_link"": ""https://webcache.googleusercontent.com/search?q=cache:OS-Ar9hB_ngJ:https://www.tripadvisor.ie/Restaurants-g186605-c31-Dublin_County_Dublin.html+&cd=4&hl=en&ct=clnk&gl=ie"", ""related_page_link"": ""https://www.google.com/search?q=related:https://www.tripadvisor.ie/Restaurants-g186605-c31-Dublin_County_Dublin.html+pizza&tbo=1&sa=X&ved=2ahUKEwicjYKvvNjmAhVoSBUIHa9MBhcQHzADegQIARAH"", ""block_position"": 2 }, package mainimport ( ""fmt"" ""strings"" serpwow ""github.com/serpwow/google-search-results-golang"")func main() { // set API key apiKey := ""Key_Hidden"" //read term to search fmt.Print(""What term would you like to search in google? "") var term string fmt.Scanln(&term) // set up our search parameters parameters := map[string]interface{}{ ""q"": term, } // retrieve the search results as JSON response, error := serpwow.GetJSON(parameters, apiKey) // print the response, or error, if one occurred if error != nil { fmt.Println(error) } else { //extract title from organic results //result := fmt.Sprintf(""%v"", response[""organic_results""].(map[string]interface{})[""title""]) for _, item := range response[""organic_results""].([]interface{}) { fmt.Sprintf(""%v"", item.(map[string]interface{})[""title""]) } //s := []string{result, ""\n""} //fmt.Printf(strings.Join(s, "" ""))}","Error: interface conversion interface {} is []interface {}, not map[string]interface {}"
golangci-lint is there a way to ignore an entire file e.g. via `//nolint`?," With golangci-lint I know I can use skip-dirs or skip-files settings but these just stop reporting at the end and I think the tool still does the ""work"", quoting docs : ... which files to skip: they will be analyzed, but issues from them won't be reported. ...Is there way, say with a variant of //nolint to prevent some files getting analysed by golangci-lint in the first place so we don't waste build-time resources - memory/cpu - on them them ? I also tried lines at the top like // Code generated by XXX. DO NOT EDIT. and these like //nolint stop reporting but I think golangci-lint is still doing the analysis - i.e. tool runs slow with high memory when big ""ignored"" files are present. From https://github.com/golangci/golangci-lint#nolint I can do And indeed no lint errors are reported BUT I still get excessive memory usagee.g When I remove the big files golangci-lint behaves fine. <code>  > //nolint:unparam > package pkg 13:14 $ golangci-lint run --timeout 30m -v INFO [config_reader] Config search paths: [ REMOVED FOR STACKOVERFLOW POST] INFO [config_reader] Used config file .golangci.yml INFO [lintersdb] Active 17 linters: [deadcode dogsled errcheck gocyclo golint gosimple govet ineffassign misspell nakedret scopelint staticcheck structcheck typecheck unconvert unused varcheck] INFO [lintersdb] Active 17 linters: [deadcode dogsled errcheck gocyclo golint gosimple govet ineffassign misspell nakedret scopelint staticcheck structcheck typecheck unconvert unused varcheck] INFO [loader] Go packages loading at mode 575 (deps|imports|name|types_sizes|compiled_files|exports_file|files) took 15.003932542s INFO [runner/filename_unadjuster] Pre-built 0 adjustments in 831.549179ms INFO [runner/unused/goanalysis] analyzers took 15.395924718s with top 10 stages: U1000: 13.12191427s, buildssa: 2.274010448s INFO [runner/goanalysis_metalinter/goanalysis] analyzers took 8m25.344883444s with top 10 stages: golint: 6m29.017594865s, ineffassign: 50.003663795s, vrp: 34.694968113s, misspell: 5.91752885s, buildssa: 4.09136586s, SA2003: 1.003697913s, copylocks: 660.780161ms, SA4000: 601.476823ms, SA4018: 510.871677ms, SA4004: 476.466048ms INFO [runner] Issues before processing: 28876, after processing: 0 INFO [runner] Processors filtering stat (out/in): skip_files: 28876/28876, skip_dirs: 28876/28876, identifier_marker: 53/53, path_prettifier: 28876/28876, autogenerated_exclude: 53/28876, exclude: 0/53, filename_unadjuster: 28876/28876, cgo: 28876/28876 INFO [runner] processing took 60.293318ms with stages: autogenerated_exclude: 33.592255ms, path_prettifier: 18.17708ms, skip_dirs: 4.421717ms, filename_unadjuster: 1.497968ms, cgo: 1.333012ms, identifier_marker: 1.036647ms, exclude: 220.939s, nolint: 8.996s, max_same_issues: 1.448s, uniq_by_line: 592ns, exclude-rules: 544ns, max_from_linter: 467ns, skip_files: 386ns, diff: 362ns, path_shortener: 331ns, source_code: 309ns, max_per_file_from_linter: 265ns INFO [runner] linters took 6m47.422489108s with stages: goanalysis_metalinter: 6m28.298523575s, unused: 19.033707326s INFO File cache stats: 2 entries of total size 40.4MiB INFO Memory: 4114 samples, avg is 7797.4MB, max is 8629.2MB INFO Execution took 7m3.337365705s","golangci-lint - want to ""really"" ignore a go file not simply analyse it and suppress warnings - my current ignore approach eats memory and is slow"
golangci-lint - want to really ignore a go file not simply analyse it and suppress warnings - my current ignore approach eats memory and is slow," With golangci-lint I know I can use skip-dirs or skip-files settings but these just stop reporting at the end and I think the tool still does the ""work"", quoting docs : ... which files to skip: they will be analyzed, but issues from them won't be reported. ...Is there way, say with a variant of //nolint to prevent some files getting analysed by golangci-lint in the first place so we don't waste build-time resources - memory/cpu - on them them ? I also tried lines at the top like // Code generated by XXX. DO NOT EDIT. and these like //nolint stop reporting but I think golangci-lint is still doing the analysis - i.e. tool runs slow with high memory when big ""ignored"" files are present. From https://github.com/golangci/golangci-lint#nolint I can do And indeed no lint errors are reported BUT I still get excessive memory usagee.g When I remove the big files golangci-lint behaves fine. <code>  > //nolint:unparam > package pkg 13:14 $ golangci-lint run --timeout 30m -v INFO [config_reader] Config search paths: [ REMOVED FOR STACKOVERFLOW POST] INFO [config_reader] Used config file .golangci.yml INFO [lintersdb] Active 17 linters: [deadcode dogsled errcheck gocyclo golint gosimple govet ineffassign misspell nakedret scopelint staticcheck structcheck typecheck unconvert unused varcheck] INFO [lintersdb] Active 17 linters: [deadcode dogsled errcheck gocyclo golint gosimple govet ineffassign misspell nakedret scopelint staticcheck structcheck typecheck unconvert unused varcheck] INFO [loader] Go packages loading at mode 575 (deps|imports|name|types_sizes|compiled_files|exports_file|files) took 15.003932542s INFO [runner/filename_unadjuster] Pre-built 0 adjustments in 831.549179ms INFO [runner/unused/goanalysis] analyzers took 15.395924718s with top 10 stages: U1000: 13.12191427s, buildssa: 2.274010448s INFO [runner/goanalysis_metalinter/goanalysis] analyzers took 8m25.344883444s with top 10 stages: golint: 6m29.017594865s, ineffassign: 50.003663795s, vrp: 34.694968113s, misspell: 5.91752885s, buildssa: 4.09136586s, SA2003: 1.003697913s, copylocks: 660.780161ms, SA4000: 601.476823ms, SA4018: 510.871677ms, SA4004: 476.466048ms INFO [runner] Issues before processing: 28876, after processing: 0 INFO [runner] Processors filtering stat (out/in): skip_files: 28876/28876, skip_dirs: 28876/28876, identifier_marker: 53/53, path_prettifier: 28876/28876, autogenerated_exclude: 53/28876, exclude: 0/53, filename_unadjuster: 28876/28876, cgo: 28876/28876 INFO [runner] processing took 60.293318ms with stages: autogenerated_exclude: 33.592255ms, path_prettifier: 18.17708ms, skip_dirs: 4.421717ms, filename_unadjuster: 1.497968ms, cgo: 1.333012ms, identifier_marker: 1.036647ms, exclude: 220.939s, nolint: 8.996s, max_same_issues: 1.448s, uniq_by_line: 592ns, exclude-rules: 544ns, max_from_linter: 467ns, skip_files: 386ns, diff: 362ns, path_shortener: 331ns, source_code: 309ns, max_per_file_from_linter: 265ns INFO [runner] linters took 6m47.422489108s with stages: goanalysis_metalinter: 6m28.298523575s, unused: 19.033707326s INFO File cache stats: 2 entries of total size 40.4MiB INFO Memory: 4114 samples, avg is 7797.4MB, max is 8629.2MB INFO Execution took 7m3.337365705s","golangci-lint - want to ""really"" ignore a go file not simply analyse it and suppress warnings - my current ignore approach eats memory and is slow"
Runtime internal error when building with latest Golang version (1.14)," After upgrading my go installation folder to Go 1.14 I am receiving a runtime error every time I try to build a program: I tried to downgrade to version 1.13.8 and build and run go fine. My OS is Linux Mint 19.2. <code>  sudo tar -C /usr/local -xzf go1.14.linux-amd64.tar.gz ~/playground/go/src/hello go build hello# runtime/internal/atomic/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:18:6: Load redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:16:24/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:24:6: Loadp redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:22:32/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:30:6: Load64 redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:28:26/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:36:6: LoadAcq redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:34:27/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:41:6: Xadd redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:39:37/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:44:6: Xadd64 redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:42:39/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:47:6: Xadduintptr redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:45:47/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:50:6: Xchg redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:48:36/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:53:6: Xchg64 redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:51:38/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:56:6: Xchguintptr redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:54:45/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:56:6: too many errors sudo rm -rf /usr/local/go && sudo tar -C /usr/local -xzf go1.13.8.linux-amd64.tar.gz~ go versiongo version go1.13.8 linux/amd64~/go go build hello && go run hellohello, world","What causes this runtime internal error about ""previous declaration at"" when building with Go 1.14 after upgrading from Go 1.13?"
"Runtime internal error when building with Go 1.14, but not 1.13"," After upgrading my go installation folder to Go 1.14 I am receiving a runtime error every time I try to build a program: I tried to downgrade to version 1.13.8 and build and run go fine. My OS is Linux Mint 19.2. <code>  sudo tar -C /usr/local -xzf go1.14.linux-amd64.tar.gz ~/playground/go/src/hello go build hello# runtime/internal/atomic/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:18:6: Load redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:16:24/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:24:6: Loadp redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:22:32/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:30:6: Load64 redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:28:26/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:36:6: LoadAcq redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:34:27/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:41:6: Xadd redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:39:37/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:44:6: Xadd64 redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:42:39/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:47:6: Xadduintptr redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:45:47/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:50:6: Xchg redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:48:36/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:53:6: Xchg64 redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:51:38/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:56:6: Xchguintptr redeclared in this block previous declaration at /usr/local/go/src/runtime/internal/atomic/atomic_amd64.go:54:45/usr/local/go/src/runtime/internal/atomic/atomic_amd64x.go:56:6: too many errors sudo rm -rf /usr/local/go && sudo tar -C /usr/local -xzf go1.13.8.linux-amd64.tar.gz~ go versiongo version go1.13.8 linux/amd64~/go go build hello && go run hellohello, world","What causes this runtime internal error about ""previous declaration at"" when building with Go 1.14 after upgrading from Go 1.13?"
"GOlang: Can't import gorilla/mux (github.com/gorilla/mux@v1.7.4: is explicitly required in go.mod, but not marked as explicit in vendor/modules.txt)"," In Go, I was trying simple database connection. I need to import gorilla/mux, but I couldn't.I am using VS Code. After cd ing to my project directory, I created main.go and did run go get -u github.com/gorilla/muxHere is main.go [Note that, after executing go get -u github.com/gorilla/mux terminal shows ]Look i have no other syntax error in mini map. At red mark, when I put mouse, the hover text, its funny to me:1)imported but not usedbut the next line2)no package for import github.com/gorilla/mux)lol didn't that go against 1) ?Someone please explain why that occursHowever, After using go build in terminalHere is terminal: [Note : I did 'go mod vendor' also, but no change]So someone point me why I can't import gorilla/mux or pq. What else I have to do?(and please explain what does that mean? is explicitly required in go.mod, but not marked as explicit in vendor/modules.txt) <code>  package mainimport ( ""database/sql"" ""fmt"" ""github.com/gorilla/mux"" _ ""github.com/lib/pq"")const ( host = ""localhost"" port = 3000 user = ""postgres"" password = ""postgres"" dbname = ""test1"")func main() { psqlInfo := fmt.Sprintf(""host=%s port=%d user=%s ""+ ""password=%s dbname=%s sslmode=disable"", host, port, user, password, dbname) db, err := sql.Open(""postgres"", psqlInfo) if err != nil { panic(err) } defer db.Close() err = db.Ping() if err != nil { panic(err) } fmt.Println(""Successfully connected!"")} C:\Go\src\github.com\IamFrost\go-rest-api>go get -v -u github.com/gorilla/muxgo: golang.org/x/text upgrade => v0.3.2go: golang.org/x/crypto upgrade => v0.0.0-20200429183012-4b2356b1ed79go: golang.org/x/sys upgrade => v0.0.0-20200430082407-1f5687305801go: golang.org/x/net upgrade => v0.0.0-20200425230154-ff2c4b7c35a0go: downloading golang.org/x/sys v0.0.0-20200430082407-1f5687305801golang.org/x/sys/cpugolang.org/x/crypto/chacha20poly1305crypto/tls C:\Go\src\github.com\IamFrost\go-rest-api>go buildgo: inconsistent vendoring in C:\Go\src: github.com/gorilla/mux@v1.7.4: is explicitly required in go.mod, but not marked as explicit in vendor/modules.txt github.com/lib/pq@v1.4.0: is explicitly required in go.mod, but not marked as explicit in vendor/modules.txt golang.org/x/crypto@v0.0.0-20200429183012-4b2356b1ed79: is explicitly required in go.mod, but not marked as explicit in vendor/modules.txt golang.org/x/net@v0.0.0-20200425230154-ff2c4b7c35a0: is explicitly required in go.mod, but not marked as explicit in vendor/modules.txt golang.org/x/sys@v0.0.0-20200430082407-1f5687305801: is explicitly required in go.mod, but not marked as explicit in vendor/modules.txt golang.org/x/crypto@v0.0.0-20200128174031-69ecbb4d6d5d: is marked as explicit in vendor/modules.txt, but not explicitly required in go.mod golang.org/x/net@v0.0.0-20191126235420-ef20fe5d7933: is marked as explicit in vendor/modules.txt, but not explicitly required in go.mod golang.org/x/sys@v0.0.0-20200201011859-915c9c3d4ccf: is marked as explicit in vendor/modules.txt, but not explicitly required in go.modrun 'go mod vendor' to sync, or use -mod=mod or -mod=readonly to ignore the vendor directory","Can't import gorilla/mux (github.com/gorilla/mux@v1.7.4: is explicitly required in go.mod, but not marked as explicit in vendor/modules.txt)"
K8S - Get deployment liveness via go code," We have defined K8s liveness and readiness probes in our deployment resource (we have defied there liveness...), we need with client-go lib to access this liveness probe, how can we do that?I've tried it with the client-go libhttps://github.com/kubernetes/client-goas follows: I've also tried to play around with the go library but did not find any deployment property on client.CoreV1(). However I do find service pod etc. What am I missing here?PodList, err := client.CoreV1().Pods(""mynamespace"").List(metav1.ListOptions{LabelSelector: ""run=liveness-app""})At the end I need to get the pod liveness status according to the liveness probe which is defined in the deployment. I mean live or dead <code>  client.Discovery().RESTClient().Get()",K8S Get deployment liveness probe status
Get deployment liveness," We have defined K8s liveness and readiness probes in our deployment resource (we have defied there liveness...), we need with client-go lib to access this liveness probe, how can we do that?I've tried it with the client-go libhttps://github.com/kubernetes/client-goas follows: I've also tried to play around with the go library but did not find any deployment property on client.CoreV1(). However I do find service pod etc. What am I missing here?PodList, err := client.CoreV1().Pods(""mynamespace"").List(metav1.ListOptions{LabelSelector: ""run=liveness-app""})At the end I need to get the pod liveness status according to the liveness probe which is defined in the deployment. I mean live or dead <code>  client.Discovery().RESTClient().Get()",K8S Get deployment liveness probe status
k8s Get deployment liveness probe status," We have defined K8s liveness and readiness probes in our deployment resource (we have defied there liveness...), we need with client-go lib to access this liveness probe, how can we do that?I've tried it with the client-go libhttps://github.com/kubernetes/client-goas follows: I've also tried to play around with the go library but did not find any deployment property on client.CoreV1(). However I do find service pod etc. What am I missing here?PodList, err := client.CoreV1().Pods(""mynamespace"").List(metav1.ListOptions{LabelSelector: ""run=liveness-app""})At the end I need to get the pod liveness status according to the liveness probe which is defined in the deployment. I mean live or dead <code>  client.Discovery().RESTClient().Get()",K8S Get deployment liveness probe status
How to validate an email address in Golang," I have checked the StackOverflow and couldn't find any question that answers how to validate email in Go Language.After some research, I figured out and solved it as per my need.I have this regex and Go function, which work fine: The problem is that it accepts the special characters that I don't want. I tried to use some from other languages' ""regex"" expression, but it throws the error ""unknown escape"" in debug.Could anyone give me a good regex or any fast solution (pkg) that works with GoLang? <code>  import ( ""fmt"" ""regexp"")func main() { fmt.Println(isEmailValid(""test44@gmail.com"")) // true fmt.Println(isEmailValid(""test$@gmail.com"")) // true -- expected ""false"" }// isEmailValid checks if the email provided is valid by regex.func isEmailValid(e string) bool { emailRegex := regexp.MustCompile(""^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$"") return emailRegex.MatchString(e)}",How to validate an email address in Go
net/http server does not send 100 Continue unless client sends Transfer-Encoding: chunked," I'm writing a HTTP server in Go that will receive requests from clients with a Expect: 100-continue header. However, it appears that the net/http server doesn't send a HTTP/1.1 100 Continue unless the client also sends a Transfer-Encoding: Chunked header, which some clients (for example, ffmpeg with an icecast:// destination) do not.Here's a minimal server, that writes into a bytes.Buffer (I've reproduced the same behaviour with a more complicated server that, for example, uses io.Copy() to write into a file): And here's a transcript of two HTTP conversations (via telnet), where the server sends a 100 in one but not in the other: Is this a bug in Go, or am I misunderstanding the HTTP spec? The spec reads:Upon receiving a request which includes an Expect request-header field with the ""100-continue"" expectation, an origin server MUST respond with 100 (Continue) status and continue to read from the input stream, or respond with a final status code. The origin server MUST NOT wait for the request body before sending the 100 (Continue) response.Edit: Sending a non-zero Content-Length header in the initial request also makes the server reply with a 100 Continue. (Although, if I understand the spec correctly, it should still reply with a Continue irregardless.) <code>  func main() { http.HandleFunc(""/"", func(writer http.ResponseWriter, r *http.Request) { log.Printf(""Expect header: %v\n"", r.Header.Get(""Expect"")) log.Printf(""Transfer-Encoding header: %v\n"", r.Header.Get(""Transfer-Encoding"")) buf := new(bytes.Buffer) defer func() { log.Printf(""Buffer size: %d\n"", buf.Len()) }() defer r.Body.Close() log.Println(""Writing."") io.Copy(buf, r.Body) }) log.Fatal(http.ListenAndServe("":3948"", nil))} PUT /telnetlol HTTP/1.1Host: localhostExpect: 100-continueHTTP/1.1 200 OKDate: Thu, 18 Mar 2021 10:59:09 GMTContent-Length: 0 PUT /telnetlol HTTP/1.1Host: localhostExpect: 100-continueTransfer-Encoding: chunkedHTTP/1.1 100 ContinuetestHTTP/1.1 200 OKDate: Thu, 18 Mar 2021 10:59:35 GMTContent-Length: 0Connection: close",net/http server does not send 100 Continue unless client sends Transfer-Encoding: chunked or nonzero Content-Length
Cannot run debug Golang using VSCode on Mac M1," I found a topic that encounter the same problem (Can't debug Golang in vscode apple m1) but I'm not sure it's an old solution or not because I'm using the Go version with and on when I run debug (fn+f5) a Debug console shows: and there is a Pop-up error: I have tried downgrade go version to 1.16.8 arm64 with dlv 1.6.1 but still got the same error.I can use go build successfully on both versions. <code>  go1.17.1 darwin/arm64 dlv version 1.7.2 VSCode version 1.60.2 (arm64) Mac M1 BigSur (11.6) Starting: /Users/username/go/bin/dlv-dap dap --check-go-version=false --listen=127.0.0.1:53115 --log-dest=3 from /Users/username/go/src/project-nameDAP server listening at: 127.0.0.1:53115 Failed to launch: could not launch process: can not run under Rosetta, check that the installed build of Go is right for your CPU architecture",Cannot run debug Go using VSCode on Mac M1
Cannot use .this error when using _ for multiple type parameters in method declaration," I am playing around with type parameters (generics) using Go 1.18beta1.ProblemConsider the following snippet: This snippet fails to build with the following error: I attempted to use _ in the method declaration because of the following statement in the Type Parameters Proposal:The type parameters listed in a method declaration need not have the same names as the type parameters in the type declaration. In particular, if they are not used by the method, they can be _.QuestionIs the build error above a bug in 1.18beta1 or am I missing something?Snippet variations that build successfullyUse type parameter namesI can make the code build successfully if I change the String method declaration to the following (replace the _ with actual type parameters): Single type parameterI managed to use the _ successfully when only using a single type parameter: Instantiate Foo with same type for T1 and T2_ also works in method declaration if Foo is instantiated with the same type (e.g. string for both T1 and T2): <code>  package mainimport ( ""fmt"")func main() { foo := &Foo[string, int]{ valueA: ""i am a string"", valueB: 123, } fmt.Println(foo)}type Foo[T1 any, T2 any] struct { valueA T1 valueB T2}func (f *Foo[_,_]) String() string { return fmt.Sprintf(""%v %v"", f.valueA, f.valueB)} <autogenerated>:1: cannot use .this (type *Foo[string,int]) as type *Foo[go.shape.string_0,go.shape.string_0] in argument to (*Foo[go.shape.string_0,go.shape.int_1]).String func (f *Foo[T1,T2]) String() string { return fmt.Sprintf(""%v %v"", f.valueA, f.valueB)} package mainimport ( ""fmt"")func main() { foo := &Foo[string]{""i am a string""} fmt.Println(foo)}type Foo[T1 any] struct { value T1}func (f *Foo[_]) String() string { return fmt.Sprintf(""%v"", f.value)} package mainimport ( ""fmt"")func main() { foo := &Foo[string, string]{ valueA: ""i am a string"", valueB: ""i am also a string"", } fmt.Println(foo)}type Foo[T1 any, T2 any] struct { valueA T1 valueB T2}func (f *Foo[_,_]) String() string { return fmt.Sprintf(""%v %v"", f.valueA, f.valueB)}","""Cannot use .this"" error when using _ for multiple type parameters in method declaration"
