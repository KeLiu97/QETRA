originalTitle,body,reformulatedTitle
What is the difference between an int and an Integer in C?," I was reading More Joel on Software when I came across Joel Spolsky saying something about a particular type of programmer knowing the difference between an int and an Integer in Java/C# (Object-Oriented Programming Languages).So, what is the difference? <code> ",What is the difference between an int and an Integer in Java and C#?
What is the difference between an int and an Integer in Java/C#?," I was reading More Joel on Software when I came across Joel Spolsky saying something about a particular type of programmer knowing the difference between an int and an Integer in Java/C# (Object-Oriented Programming Languages).So, what is the difference? <code> ",What is the difference between an int and an Integer in Java and C#?
What is the difference between an int and an Integer?," I was reading More Joel on Software when I came across Joel Spolsky saying something about a particular type of programmer knowing the difference between an int and an Integer in Java/C# (Object-Oriented Programming Languages).So, what is the difference? <code> ",What is the difference between an int and an Integer in Java and C#?
What is the difference between an int and an Integer in Java/C#?," I was reading More Joel on Software when I came across Joel Spolsky saying something about a particular type of programmer knowing the difference between an int and an Integer in Java/C# (Object-Oriented Programming Languages).So, what is the difference? <code> ",What is the difference between an int and an Integer in Java and C#?
Checking For File Lock in C#," Is there any way to check whether a file is locked without using a try/catch block? Right now, the only way I know of is to just open the file and catch any System.IO.IOException. <code> ",How to check for file lock?
How to check For File Lock in C# ?," Is there any way to check whether a file is locked without using a try/catch block? Right now, the only way I know of is to just open the file and catch any System.IO.IOException. <code> ",How to check for file lock?
How to RedirectToAction in ASP.NET MVC (Preview 4) without losing request data," Using ASP.NET MVC there are situations (such as form submission) that may require a RedirectToAction. One such situation is when you encounter validation errors after a form submission and need to redirect back to the form, but would like the URL to reflect the URL of the form, not the action page it submits to.As I require the form to contain the originally POSTed data, for user convenience, as well as validation purposes, how can I pass the data through the RedirectToAction()? If I use the viewData parameter, my POST parameters will be changed to GET parameters. <code> ",How to RedirectToAction in ASP.NET MVC without losing request data
C#: Can I have a method return IEnumerator<T> and use it in a foreach loop?," I need to set the height of every textbox on my form, some of which are nested within other controls. I thought I could do something like this: Using it like this: But of course the compiler spits its dummy, because foreach expects an IEnumerable rather than an IEnumerator.Is there a way to do this without having to create a separate class with a GetEnumerator() method? <code>  private static IEnumerator<TextBox> FindTextBoxes(Control rootControl){ foreach (Control control in rootControl.Controls) { if (control.Controls.Count > 0) { // Recursively search for any TextBoxes within each child control foreach (TextBox textBox in FindTextBoxes(control)) { yield return textBox; } } TextBox textBox2 = control as TextBox; if (textBox2 != null) { yield return textBox2; } }} foreach(TextBox textBox in FindTextBoxes(this)){ textBox.Height = height;}",Can I have a method returning IEnumerator<T> and use it in a foreach loop?
C#: Can I have a method return IEnumerator<T> and use it in a foreach loop?," I need to set the height of every textbox on my form, some of which are nested within other controls. I thought I could do something like this: Using it like this: But of course the compiler spits its dummy, because foreach expects an IEnumerable rather than an IEnumerator.Is there a way to do this without having to create a separate class with a GetEnumerator() method? <code>  private static IEnumerator<TextBox> FindTextBoxes(Control rootControl){ foreach (Control control in rootControl.Controls) { if (control.Controls.Count > 0) { // Recursively search for any TextBoxes within each child control foreach (TextBox textBox in FindTextBoxes(control)) { yield return textBox; } } TextBox textBox2 = control as TextBox; if (textBox2 != null) { yield return textBox2; } }} foreach(TextBox textBox in FindTextBoxes(this)){ textBox.Height = height;}",Can I have a method returning IEnumerator<T> and use it in a foreach loop?
C# eval equivalent?," I can do an eval(""something()""); to execute the code dynamically in JavaScript. Is there a way for me to do the same thing in C#?An example of what I am trying to do is: I have an integer variable (say i) and I have multiple properties by the names: ""Property1"", ""Property2"", ""Property3"", etc.Now, I want to perform some operations on the "" Propertyi "" property depending on the value of i. This is really simple with Javascript. Is there any way to do this with C#? <code> ",How can I evaluate C# code dynamically?
How can I read the properties of a C# class dynamically?," I can do an eval(""something()""); to execute the code dynamically in JavaScript. Is there a way for me to do the same thing in C#?An example of what I am trying to do is: I have an integer variable (say i) and I have multiple properties by the names: ""Property1"", ""Property2"", ""Property3"", etc.Now, I want to perform some operations on the "" Propertyi "" property depending on the value of i. This is really simple with Javascript. Is there any way to do this with C#? <code> ",How can I evaluate C# code dynamically?
sgen.exe fails," After changing the output directory of a visual studio project it started to fail to build with an error very much like: I changed the output directory to target/win_x32/release/results but the path in sgen doesn't seem to have been updated. There seems to be no reference in the project to what path is passed into sgen so I'm unsure how to fix it. As a workaround I have disabled the serialization generation but it would be nice to fix the underlying problem. Has anybody else seen this? <code>  C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\bin\sgen.exe /assembly:C:\p4root\Zantaz\trunk\EASDiscovery\EASDiscoveryCaseManagement\obj\Release\EASDiscoveryCaseManagement.dll /proxytypes /reference:C:\p4root\Zantaz\trunk\EASDiscovery\EasDiscovery.Common\target\win_x32\release\results\EASDiscovery.Common.dll /reference:C:\p4root\Zantaz\trunk\EASDiscovery\EasDiscovery.Export\target\win_x32\release\results\EASDiscovery.Export.dll /reference:c:\p4root\Zantaz\trunk\EASDiscovery\ItemCache\target\win_x32\release\results\EasDiscovery.ItemCache.dll /reference:c:\p4root\Zantaz\trunk\EASDiscovery\RetrievalEngine\target\win_x32\release\results\EasDiscovery.RetrievalEngine.dll /reference:C:\p4root\Zantaz\trunk\EASDiscovery\EASDiscoveryJobs\target\win_x32\release\results\EASDiscoveryJobs.dll /reference:""C:\Program Files\Infragistics\NetAdvantage for .NET 2008 Vol. 1 CLR 2.0\Windows Forms\Bin\Infragistics2.Shared.v8.1.dll"" /reference:""C:\Program Files\Infragistics\NetAdvantage for .NET 2008 Vol. 1 CLR 2.0\Windows Forms\Bin\Infragistics2.Win.Misc.v8.1.dll"" /reference:""C:\Program Files\Infragistics\NetAdvantage for .NET 2008 Vol. 1 CLR 2.0\Windows Forms\Bin\Infragistics2.Win.UltraWinChart.v8.1.dll"" /reference:""C:\Program Files\Infragistics\NetAdvantage for .NET 2008 Vol. 1 CLR 2.0\Windows Forms\Bin\Infragistics2.Win.UltraWinDataSource.v8.1.dll"" /reference:""C:\Program Files\Infragistics\NetAdvantage for .NET 2008 Vol. 1 CLR 2.0\Windows Forms\Bin\Infragistics2.Win.UltraWinDock.v8.1.dll"" /reference:""C:\Program Files\Infragistics\NetAdvantage for .NET 2008 Vol. 1 CLR 2.0\Windows Forms\Bin\Infragistics2.Win.UltraWinEditors.v8.1.dll"" /reference:""C:\Program Files\Infragistics\NetAdvantage for .NET 2008 Vol. 1 CLR 2.0\Windows Forms\Bin\Infragistics2.Win.UltraWinGrid.v8.1.dll"" /reference:""C:\Program Files\Infragistics\NetAdvantage for .NET 2008 Vol. 1 CLR 2.0\Windows Forms\Bin\Infragistics2.Win.UltraWinListView.v8.1.dll"" /reference:""C:\Program Files\Infragistics\NetAdvantage for .NET 2008 Vol. 1 CLR 2.0\Windows Forms\Bin\Infragistics2.Win.UltraWinMaskedEdit.v8.1.dll"" /reference:""C:\Program Files\Infragistics\NetAdvantage for .NET 2008 Vol. 1 CLR 2.0\Windows Forms\Bin\Infragistics2.Win.UltraWinStatusBar.v8.1.dll"" /reference:""C:\Program Files\Infragistics\NetAdvantage for .NET 2008 Vol. 1 CLR 2.0\Windows Forms\Bin\Infragistics2.Win.UltraWinTabControl.v8.1.dll"" /reference:""C:\Program Files\Infragistics\NetAdvantage for .NET 2008 Vol. 1 CLR 2.0\Windows Forms\Bin\Infragistics2.Win.UltraWinToolbars.v8.1.dll"" /reference:""C:\Program Files\Infragistics\NetAdvantage for .NET 2008 Vol. 1 CLR 2.0\Windows Forms\Bin\Infragistics2.Win.UltraWinTree.v8.1.dll"" /reference:""C:\Program Files\Infragistics\NetAdvantage for .NET 2008 Vol. 1 CLR 2.0\Windows Forms\Bin\Infragistics2.Win.v8.1.dll"" /reference:""C:\Program Files\Microsoft Visual Studio 8\ReportViewer\Microsoft.ReportViewer.Common.dll"" /reference:""C:\Program Files\Microsoft Visual Studio 8\ReportViewer\Microsoft.ReportViewer.WinForms.dll"" /reference:C:\p4root\Zantaz\trunk\EASDiscovery\PreviewControl\target\win_x32\release\results\PreviewControl.dll /reference:C:\p4root\Zantaz\trunk\EASDiscovery\Quartz\src\Quartz\target\win_x32\release\results\Scheduler.dll /reference:c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\System.configuration.dll /reference:c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\System.Data.dll /reference:c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\System.Design.dll /reference:c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\System.DirectoryServices.dll /reference:c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\System.dll /reference:c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\System.Drawing.dll /reference:c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\System.Web.dll /reference:c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\System.Web.Services.dll /reference:c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\System.Windows.Forms.dll /reference:c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\System.Xml.dll /compiler:/delaysign- Error: The specified module could not be found. (Exception from HRESULT: 0x8007007E) C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Microsoft.Common.targets(1902,9): error MSB6006: ""sgen.exe"" exited with code 1.",sgen.exe fails during build
Anyone know a good workaround for the lack of an enum generic constraint?," What I want to do is something like this: I have enums with combined flagged values. So then I could do: Unfortunately, C#'s generic where constraints have no enum restriction, only class and struct. C# doesn't see enums as structs (even though they are value types) so I can't add extension types like this.Does anyone know a workaround? <code>  public static class EnumExtension{ public static bool IsSet<T>( this T input, T matchTo ) where T:enum //the constraint I want that doesn't exist in C#3 { return (input & matchTo) != 0; }} MyEnum tester = MyEnum.FlagA | MyEnum.FlagBif( tester.IsSet( MyEnum.FlagA ) ) //act on flag a",workaround for the lack of an enum generic constraint
Memcached on Windows (x64)," Does anyone know IF, WHEN or HOW I can get Memcached running on a Windows 64bit environment? I'm setting up a new hosting solution and would much prefer to run a 64bit OS, and since it's an ASP.Net MVC solution with SQL Server DB, the OS is either going to be Windows Server 2003 or (hopefully!) 2008.I know that this could spill over into a debate regarding 32bit vs 64bit on servers, but let's just say that my preference is 64bit and that I have some very good reasons.So far, I've tried a number of options and found a bit of help related to getting this up on a 32bit machine (and succeeded I might add), but since the original Windows port is Win32 specific, this is hardly going to help when installing as a service on x64. It also has a dependency on the libevent for which I can only get a Win32 compiled version.I suspect that simply loading all this up in C++ and hitting ""compile"" (for 64bit) wouldn't work, not least because of the intricate differences in 32 and 64bit architectures, but I'm wondering if anyone is working on getting this off the ground? Unfortunately, my expertise lie in managed code (C#) only, otherwise I would try and take this on myself, but I can't believe I'm the only guy out there trying to get memcached running on a 64 bit Windows server....am I?UpdateYes I'm afraid I'm still looking for an answer to this - all my efforts (with my pathetic C++ skills) to make a stable build have failed - I've trashed one server and 3 VM's just trying it out so now I turn to the real experts.Is anyone planning on porting this to 64bit? Or are you really suggesting that I use MS Velocity instead? I shudder at the thought.Update:@Lars - I do use Enyim actually - it's very good, but what you're referring to is a client, rather than the server part.@DannySmurf - I've only been able to install it as a service on a 32 bit OS. 64 bit OS rejects the installation of this Win32 service. Of course yes, lots of Win32 code works seamlessly on x64 architecture, hence you can run 32bit apps (like Office for instance) or games on Vista/XP 64 etc, but this doesn't translate directly when it comes to services. I'm no expert, I suspect that it has to do with the syncs or eventing that services need to subscribe to, and I suspect that 64 and 32 don't play nicely. I'm happy to be corrected on any of this, but to answer your question - yes I have tried.@OJ - thanks very much for the straight-forward response. I thought as much, but wasn't sure if anyone else had suggestions or had already gone down this route. Maybe when StackOverflow is LIVE, then more people will respond and let me know if this is something being looked into, and although I can try and compile it myself - I simply can't ""trust"" (with my C++ experience level) that it would provide ""Enterprise Level"" reliability in such a crucial component of large scalable solutions. I think it would need educated intervention rather than my unsanitised experimental approach before I could be confident. One little oversight on my part, could bring the site down. Oh well... till next time. <code> ",Can I get Memcached running on a Windows (x64) 64bit environment?
I can get Memcached running on a Windows (x64) 64bit environment?," Does anyone know IF, WHEN or HOW I can get Memcached running on a Windows 64bit environment? I'm setting up a new hosting solution and would much prefer to run a 64bit OS, and since it's an ASP.Net MVC solution with SQL Server DB, the OS is either going to be Windows Server 2003 or (hopefully!) 2008.I know that this could spill over into a debate regarding 32bit vs 64bit on servers, but let's just say that my preference is 64bit and that I have some very good reasons.So far, I've tried a number of options and found a bit of help related to getting this up on a 32bit machine (and succeeded I might add), but since the original Windows port is Win32 specific, this is hardly going to help when installing as a service on x64. It also has a dependency on the libevent for which I can only get a Win32 compiled version.I suspect that simply loading all this up in C++ and hitting ""compile"" (for 64bit) wouldn't work, not least because of the intricate differences in 32 and 64bit architectures, but I'm wondering if anyone is working on getting this off the ground? Unfortunately, my expertise lie in managed code (C#) only, otherwise I would try and take this on myself, but I can't believe I'm the only guy out there trying to get memcached running on a 64 bit Windows server....am I?UpdateYes I'm afraid I'm still looking for an answer to this - all my efforts (with my pathetic C++ skills) to make a stable build have failed - I've trashed one server and 3 VM's just trying it out so now I turn to the real experts.Is anyone planning on porting this to 64bit? Or are you really suggesting that I use MS Velocity instead? I shudder at the thought.Update:@Lars - I do use Enyim actually - it's very good, but what you're referring to is a client, rather than the server part.@DannySmurf - I've only been able to install it as a service on a 32 bit OS. 64 bit OS rejects the installation of this Win32 service. Of course yes, lots of Win32 code works seamlessly on x64 architecture, hence you can run 32bit apps (like Office for instance) or games on Vista/XP 64 etc, but this doesn't translate directly when it comes to services. I'm no expert, I suspect that it has to do with the syncs or eventing that services need to subscribe to, and I suspect that 64 and 32 don't play nicely. I'm happy to be corrected on any of this, but to answer your question - yes I have tried.@OJ - thanks very much for the straight-forward response. I thought as much, but wasn't sure if anyone else had suggestions or had already gone down this route. Maybe when StackOverflow is LIVE, then more people will respond and let me know if this is something being looked into, and although I can try and compile it myself - I simply can't ""trust"" (with my C++ experience level) that it would provide ""Enterprise Level"" reliability in such a crucial component of large scalable solutions. I think it would need educated intervention rather than my unsanitised experimental approach before I could be confident. One little oversight on my part, could bring the site down. Oh well... till next time. <code> ",Can I get Memcached running on a Windows (x64) 64bit environment?
can I get Memcached running on a Windows (x64) 64bit environment?," Does anyone know IF, WHEN or HOW I can get Memcached running on a Windows 64bit environment? I'm setting up a new hosting solution and would much prefer to run a 64bit OS, and since it's an ASP.Net MVC solution with SQL Server DB, the OS is either going to be Windows Server 2003 or (hopefully!) 2008.I know that this could spill over into a debate regarding 32bit vs 64bit on servers, but let's just say that my preference is 64bit and that I have some very good reasons.So far, I've tried a number of options and found a bit of help related to getting this up on a 32bit machine (and succeeded I might add), but since the original Windows port is Win32 specific, this is hardly going to help when installing as a service on x64. It also has a dependency on the libevent for which I can only get a Win32 compiled version.I suspect that simply loading all this up in C++ and hitting ""compile"" (for 64bit) wouldn't work, not least because of the intricate differences in 32 and 64bit architectures, but I'm wondering if anyone is working on getting this off the ground? Unfortunately, my expertise lie in managed code (C#) only, otherwise I would try and take this on myself, but I can't believe I'm the only guy out there trying to get memcached running on a 64 bit Windows server....am I?UpdateYes I'm afraid I'm still looking for an answer to this - all my efforts (with my pathetic C++ skills) to make a stable build have failed - I've trashed one server and 3 VM's just trying it out so now I turn to the real experts.Is anyone planning on porting this to 64bit? Or are you really suggesting that I use MS Velocity instead? I shudder at the thought.Update:@Lars - I do use Enyim actually - it's very good, but what you're referring to is a client, rather than the server part.@DannySmurf - I've only been able to install it as a service on a 32 bit OS. 64 bit OS rejects the installation of this Win32 service. Of course yes, lots of Win32 code works seamlessly on x64 architecture, hence you can run 32bit apps (like Office for instance) or games on Vista/XP 64 etc, but this doesn't translate directly when it comes to services. I'm no expert, I suspect that it has to do with the syncs or eventing that services need to subscribe to, and I suspect that 64 and 32 don't play nicely. I'm happy to be corrected on any of this, but to answer your question - yes I have tried.@OJ - thanks very much for the straight-forward response. I thought as much, but wasn't sure if anyone else had suggestions or had already gone down this route. Maybe when StackOverflow is LIVE, then more people will respond and let me know if this is something being looked into, and although I can try and compile it myself - I simply can't ""trust"" (with my C++ experience level) that it would provide ""Enterprise Level"" reliability in such a crucial component of large scalable solutions. I think it would need educated intervention rather than my unsanitised experimental approach before I could be confident. One little oversight on my part, could bring the site down. Oh well... till next time. <code> ",Can I get Memcached running on a Windows (x64) 64bit environment?
Generic Type Checking," Is there a way to enforce/limit the types that are passed to primitives? (bool, int, string, etc.)Now, I know you can limit the generic type parameter to a type or interface implementation via the where clause. However, this doesn't fit the bill for primitives (AFAIK) because they do not all have a common ground (apart from object before someone says! :P).So, my current thoughts are to just grit my teeth and do a big switch statement and throw an ArgumentException on failure.EDIT 1:Just to clarify:The code definition should be like this: And instantiation: EDIT 2@Jon Limjap - Good point, and something I was already considering. I'm sure there is a generic method that can be used to determine if the type is of a value or reference type.This could be useful in instantly removing a lot of the objects I don't want to deal with (but then you need to worry about the structs that are used such as Size ). Interesting problem no? :)Here it is: Taken from MSDN.I'm curious. Could this be done in .NET 3.x using extension methods? Create an interface, and implement the interface in the extension methods (which would probably be cleaner than a bit fat switch). Plus if you then need to later extend to any lightweight custom types, they can also implement the same interface, with no changes required to the base code.What do you guys think?The sad news is I am working in Framework 2!! :DEDIT 3This was so simple following on from Jon Limjaps Pointer.. So simple I almost want to cry, but it's great because the code works like a charm!So here is what I did (you'll laugh!):Code added to the generic class Then a little utility method to check the type and throw an exception, All that then needs to be done is to call EnforcePrimitiveType() in the classes constructors. Job done! :-)The only downside, it only throws an exception at runtime (obviously) rather than design time. But that's no big deal and could be picked up with utilities like FxCop (which we don't use at work).Special thanks to Jon Limjap on this one! <code>  public class MyClass<GenericType> .... MyClass<bool> = new MyClass<bool>(); // LegalMyClass<string> = new MyClass<string>(); // LegalMyClass<DataSet> = new MyClass<DataSet>(); // IllegalMyClass<RobsFunkyHat> = new MyClass<RobsFunkyHat>(); // Illegal (but looks awesome!) where T: struct bool TypeValid(){ // Get the TypeCode from the Primitive Type TypeCode code = Type.GetTypeCode(typeof(PrimitiveDataType)); // All of the TypeCode Enumeration refer Primitive Types // with the exception of Object and Empty (Null). // Since I am willing to allow Null Types (at this time) // all we need to check for is Object! switch (code) { case TypeCode.Object: return false; default: return true; }} private void EnforcePrimitiveType(){ if (!TypeValid()) throw new InvalidOperationException( ""Unable to Instantiate SimpleMetadata based on the Generic Type of '"" + typeof(PrimitiveDataType).Name + ""' - this Class is Designed to Work with Primitive Data Types Only."");}",Generic type checking
obligatorily function call," I have a ""Status"" class in C#, used like this: You get the idea.All callers of MyFunction should check the returned Status: Lazy callers however can ignore the Status. or Is it possible to make this impossible? e.g. an throw exceptionIn general: is it possible to write a C# class on which you have to call a certain function?In the C++ version of the Status class, I can write a test on some private bool bIsChecked in the destructor and ring some bells when someone doesn't check this instance.What is the equivalent option in C#?I read somewhere that ""You don't want a destructor in your C# class""Is the Dispose method of the IDisposable interface an option?In this case there are no unmanaged resources to free.Additionally, it is not determined when the GC will dispose the object.When it eventually gets disposed, is it still possible to know where and when you ignored that specific Status instance?The ""using"" keyword does help, but again, it is not required for lazy callers. <code>  Status MyFunction(){ if(...) // something bad return new Status(false, ""Something went wrong"") else return new Status(true, ""OK"");} Status myStatus = MyFunction();if ( ! myStatus.IsOK() ) // handle it, show a message,... MyFunction(); // call function and ignore returned Status { Status myStatus = MyFunction(); } // lose all references to myStatus, without calling IsOK() on it",Enforcing required function call
Views in seperate assemblies in ASP.NET MVC," I'm trying to create a webapplication where I want to be able to plug-in separate assemblies. I'm using MVC preview 4 combined with Unity for dependency injection, which I use to create the controllers from my plugin assemblies. I'm using WebForms (default aspx) as my view engine.If I want to use a view, I'm stuck on the ones that are defined in the core project, because of the dynamic compiling of the ASPX part. I'm looking for a proper way to enclose ASPX files in a different assembly, without having to go through the whole deployment step. Am I missing something obvious? Or should I resort to creating my views programmatically?Update: I changed the accepted answer. Even though Dale's answer is very thorough, I went for the solution with a different virtual path provider. It works like a charm, and takes only about 20 lines in code altogether I think. <code> ",Views in separate assemblies in ASP.NET MVC
Generics in c# & accessing the  static members of T," My question concerns c# and how to access Static members ... Well I don't really know how to explain it (which kind of is bad for a question isn't it?) I will just give you some sample code: So thank you guys for your answers (By the way the question is: how would I solve this problem without getting an error). This probably quite an easy question for you!Edit: Thank you all for your answers!Though I think the try - catch phrase is the most elegant, I know from my experience with vb that it can really be a bummer. I used it once and it took about 30 minutes to run a program, which later on only took 2 minutes to compute just because I avoided try - catch.This is why I chose the switch statement as the best answer. It makes the code more complicated but on the other hand I imagine it to be relatively fast and relatively easy to read. (Though I still think there should be a more elegant way ... maybe in the next language I learn)Though if you have some other suggestion I am still waiting (and willing to participate) <code>  Class test<T>{ int method1(Obj Parameter1){ //in here I want to do something which I would explain as T.TryParse(Parameter1); //my problem is that it does not work ... I get an error. //just to explain: if I declare test<int> (with type Integer) //I want my sample code to call int.TryParse(). If it were String //it should have been String.TryParse() }}",Generics in c# & accessing the static members of T
ASP.NET - asp:xxx Controls versus standard HTML," I'm getting into ASP.NET (C# - I know it doesn't matter for this particular question, but full disclosure and all that), and while I love that the asp:-style controls save me a lot of tedious HTML-crafting, I am often frustrated with certain behaviors. I encountered one last night when working with Master Pages: my <asp:BulletedList ID=""nav"">, when converted into HTML, became <ul id=""ct100_nav"">.There are other issues--I noticed that when you auto-populate a DataGrid, it adds attributes to the resulting table that I don't necessarily want there.I know that there is a certain amount of ""convention over configuration"" that you have to accept when you rely on a framework to take over some of your tedious duties, but the ""conventions"" in these cases aren't so much any established conventions, but rather unnecessary extras. I know why the ID adds the prefix, but I should be able to tweak and turn things like this off, especially since, as a bit of a web standards evangelist, I don't duplicated HTML id's in a single page anyway.So the question here is for those ASP.NET devs more seasoned than I: in your experiences in developing and deploying apps, how do you leverage these controls? Do you find yourself resorting back to hard-coded HTML? Do you use a blend? I don't want to design my HTML around idiosyncratic quirks in these controls, but, if possible, I'd like to leverage them when possible. What's a boy to do? <code> ",Controls versus standard HTML
Conditional formating - percentage to color conversion," What's the easiest way to convert a percentage to a color ranging from Green (100%) to Red (0%), with Yellow for 50%?I'm using plain 32bit RGB - so each component is an integer between 0 and 255. I'm doing this in C#, but I guess for a problem like this the language doesn't really matter that much.Based on Marius and Andy's answers I'm using the following solution: Works perfectly - Only adjustment I had to make from Marius solution was to use 256, as (255 - (percent - 50) * 5.12 yield -1 when 100%, resulting in Yellow for some reason in Silverlight (-1, 255, 0) -> Yellow ... <code>  double red = (percent < 50) ? 255 : 256 - (percent - 50) * 5.12;double green = (percent > 50) ? 255 : percent * 5.12;var color = Color.FromArgb(255, (byte)red, (byte)green, 0);",Conditional formatting -- percentage to color conversion
"What is a good use of lambda expressions, and how can I learn to use them?"," I've read that Lambda Expressions are an incredibly powerful addition to C#, yet I find myself mystified by them. How can they improve my life or make my code better? Can anyone point to a good resource for learning such expressions?They seem cool as hell, but how do they relate to my day-to-day life as an asp.net developer?Edit: Thanks for the examples, and thanks for the link to Eric White's articles. I'm still digesting those now. One quick question: are lambda expressions useful for anything other than querying? Every example I've seen has been a query construct. <code> ",What is appliance and how to use lambda expressions?
"What is a good use of lambda expressions, and how to use lambda expressions?"," I've read that Lambda Expressions are an incredibly powerful addition to C#, yet I find myself mystified by them. How can they improve my life or make my code better? Can anyone point to a good resource for learning such expressions?They seem cool as hell, but how do they relate to my day-to-day life as an asp.net developer?Edit: Thanks for the examples, and thanks for the link to Eric White's articles. I'm still digesting those now. One quick question: are lambda expressions useful for anything other than querying? Every example I've seen has been a query construct. <code> ",What is appliance and how to use lambda expressions?
How costly is Reflection? Really.," I constantly hear how bad reflection is to use. While I generally avoid reflection and rarely find situations where it is impossible to solve my problem without it, I was wondering... For those who have used reflection in applications, have you measured performance hits and, is it really so bad? <code> ",How costly is .NET reflection?
How costly is Reflection?," I constantly hear how bad reflection is to use. While I generally avoid reflection and rarely find situations where it is impossible to solve my problem without it, I was wondering... For those who have used reflection in applications, have you measured performance hits and, is it really so bad? <code> ",How costly is .NET reflection?
tesseract interface, How do you OCR an tiff file using Tesseract's interface in c#?Currently I only know how to do it using the executable. <code> ,OCR with the Tesseract interface
.NET: How to unit test Windows Service," .NET Framework: 2.0Preferred Language: C#I am new to TDD (Test Driven Development).First of all, is it even possible to unit test Windows Service?Windows service class is derived from ServiceBase, which has overridable methods, OnStart OnStopHow can I trigger those methods to be called as if unit test is an actual service that calls those methods in proper order?At this point, am I even doing a Unit testing? or an Integration test?I have looked at WCF service question but it didn't make any sense to me since I have never dealt with WCF service. <code> ",How can I unit test a Windows Service?
Google Suggestish text box, What would be the best way to develop a text box that remembers the last x number of entries that were put into it. This is a standalone app written with C#. <code> ,Google Suggestish text box  (autocomplete)
Very slow compile times on Visual Studio," We are getting very slow compile times, which can take upwards of 20+ minutes on dual core 2GHz, 2G Ram machines.A lot of this is due to the size of our solution which has grown to 70+ projects, as well as VSS which is a bottle neck in itself when you have a lot of files. (swapping out VSS is not an option unfortunately, so I don't want this to descend into a VSS bash)We are looking at merging projects. We are also looking at having multiple solutions to achieve greater separation of concerns and quicker compile times for each element of the application. This I can see will become a DLL hell as we try to keep things in synch.I am interested to know how other teams have dealt with this scaling issue, what do you do when your code base reaches a critical mass that you are wasting half the day watching the status bar deliver compile messages.UPDATEI neglected to mention this is a C# solution. Thanks for all the C++ suggestions, but it's been a few years since I've had to worry about headers.EDIT:Nice suggestions that have helped so far (not saying there aren't other nice suggestions below, just what has helped)New 3GHz laptop - the power of lost utilization works wonders when whinging to managementDisable Anti Virus during compile'Disconnecting' from VSS (actually the network) during compile - I may get us to remove VS-VSS integration altogether and stick to using the VSS UIStill not rip-snorting through a compile, but every bit helps.Orion did mention in a comment that generics may have a play also. From my tests there does appear to be a minimal performance hit, but not high enough to sure - compile times can be inconsistent due to disc activity. Due to time limitations, my tests didn't include as many Generics, or as much code, as would appear in live system, so that may accumulate. I wouldn't avoid using generics where they are supposed to be used, just for compile time performanceWORKAROUNDWe are testing the practice of building new areas of the application in new solutions, importing in the latest dlls as required, them integrating them into the larger solution when we are happy with them.We may also do them same to existing code by creating temporary solutions that just encapsulate the areas we need to work on, and throwing them away after reintegrating the code. We need to weigh up the time it will take to reintegrate this code against the time we gain by not having Rip Van Winkle like experiences with rapid recompiling during development. <code> ",Very slow compile times on Visual Studio 2005
Recursive Lamba to Traverse a Tree in C#, Can someone show me how to implement a recursive lambda expression to traverse a tree structure in C#.  <code> ,Recursive lambda expression to traverse a tree in C#
Applying AOP," I've been using some basic AOP style solutions for cross-cutting concerns like security, logging, validation, etc. My solution has revolved around Castle Windsor and DynamicProxy because I can apply everything using a Boo based DSL and keep my code clean of Attributes. I was told at the weekend to have a look at PostSharp as it's supposed to be a ""better"" solution. I've had a quick look at PostSharp, but I've been put off by the Attribute usage.Has anyone tried both solutions and would care to share their experiences? <code> ",Applying Aspect Oriented Programming
Get external IP address in C#," I need to find out the external IP of the computer a C# application is running on. In the application I have a connection (via .NET remoting) to a server. Is there a good way to get the address of the client on the server side?(I have edited the question, to be a little more clear. I'm apologize to all kind people who did their best to respond to the question, when I perhaps was a little too vague)Solution:I found a way that worked great for me. By implementing a custom IServerChannelSinkProvider and IServerChannelSink where I have access to CommonTransportKeys.IPAddress, it's easy to add the client ip on the CallContext. And then later (when I get a request from a client) just get the IP from the CallContext like this. I can now send the IP back to the client. <code>  public ServerProcessing ProcessMessage(IServerChannelSinkStack sinkStack, IMessage requestmessage, ITransportHeaders requestHeaders, System.IO.Stream requestStream, out IMessage responseMessage, out ITransportHeaders responseHeaders, out System.IO.Stream responseStream){ try { // Get the IP address and add it to the call context. IPAddress ipAddr = (IPAddress)requestHeaders[CommonTransportKeys.IPAddress]; CallContext.SetData(""ClientIP"", ipAddr); } catch (Exception) { } sinkStack.Push(this, null); ServerProcessing srvProc = _NextSink.ProcessMessage(sinkStack, requestmessage, requestHeaders, requestStream, out responseMessage, out responseHeaders, out responseStream); return srvProc;} public string GetClientIP(){ // Get the client IP from the call context. object data = CallContext.GetData(""ClientIP""); // If the data is null or not a string, then return an empty string. if (data == null || !(data is IPAddress)) return string.Empty; // Return the data as a string. return ((IPAddress)data).ToString();}",Get external IP address over remoting in C#
Fastest api for rendering text in WinForms?," We need to optimize the text rendering for a C# Windows Forms application displaying a large number of small strings in an irregular grid. At any time there can be well over 5000 cells visible that update 4 times per second. The font family and size is consistent across the cells, though the color may vary from cell to cell, as will bold/italic/plain.I've seen conflicting information on the web about TextRenderer.DrawText vs. Graphics.DrawString being the fastest/best, which reduces to a GDI vs. GDI+ comparison at the Win32 level. I've also seen radically different results on Windows XP vs. Windows Vista, but my main target is Windows XP. Articles promising great advances under WinFX and DirectX 10 aren't helpful here :-)What's the best approach here? I'm not afraid of introducing a small C++/CLI layer and optimizing device context handling to squeeze out more performance, but I'd like some definitive advice about which direction to take.EDIT:Thanks for the initial responses. I'll be trying a combination of background bitmap rendering and sticking with the GDI equivalent calls. <code> ",Fastest API for rendering text in Windows Forms?
Future of Winforms?," I have an app that I've written in C#/WinForms (my little app). To make it cross-platform, I'm thinking of redoing it in Adobe AIR. Are there any arguments in favor of WinForms as a cross-platform app? Is there a cross-platform future for Winforms (e.g., Mono, etc.)? Suggestions for cross-platform UI development?By cross-platform I mean, currently, Mac OSX, Windows and Linux.This question was asked again and answered with better success. <code> ","Making a C#/Winform application cross-platform - should I use AIR, Mono, or something else?"
Should I start using LINQ?, Currently I am using NetTiers to generate my data access layer and service layer. I have been using NetTiers for over 2 years and have found it to be very useful. At some point I need to look at LINQ so my questions are...Has anyone else gone from NetTiers to LINQ To SQL?Was this switch over a good or bad thing?Is there anything that I should be aware of?Would you recommend this switch?Basically I would welcome any thoughts. <code> ,Should I start using LINQ To SQL?
OpenCV Wrappers for DotNet," I've seen there are a few of them. opencvdotnet, SharperCV, EmguCV, One on Code Project. Does anyone have any experience with any of these? I played around with the one on Code Project for a bit, but as soon as I tried to do anything complicated I got some nasty uncatchable exceptions (i.e. Msgbox exceptions). Cross platform (supports Mono) would be best. <code> ",.Net (dotNet) wrappers for OpenCV?
OpenCV wrappers for .Net (dotNet)?," I've seen there are a few of them. opencvdotnet, SharperCV, EmguCV, One on Code Project. Does anyone have any experience with any of these? I played around with the one on Code Project for a bit, but as soon as I tried to do anything complicated I got some nasty uncatchable exceptions (i.e. Msgbox exceptions). Cross platform (supports Mono) would be best. <code> ",.Net (dotNet) wrappers for OpenCV?
Looking for a simple standalone persistant dictionary implementation in C#," For an open source project I am looking for a good, simple implementation of a Dictionary that is backed by a file. Meaning, if an application crashes or restarts the dictionary will keep its state. I would like it to update the underlying file every time the dictionary is touched. (Add a value or remove a value). A FileWatcher is not required but it could be useful. Requirements: Open Source, with no dependency on native code (no sqlite) Ideally a very short and simple implementationWhen setting or clearing a value it should not re-write the entire underlying file, instead it should seek to the position in the file and update the value.Similar Questions Persistent Binary Tree / Hash table in .NetDisk backed dictionary/cache for c#PersistentDictionary<Key,Value> <code>  class PersistentDictionary<T,V> : IDictionary<T,V>{ public PersistentDictionary(string filename) { } }",Looking for a simple standalone persistent dictionary implementation in C#
Dynamically choose/change CSS at run-time, Is there a way to check if the user has a different version of the CSS cached by their browser and if so force their browser to pull the new version? <code> ,Force browser to use new CSS
Dynamically change CSS at run-time and force browser cache to use new CSS version, Is there a way to check if the user has a different version of the CSS cached by their browser and if so force their browser to pull the new version? <code> ,Force browser to use new CSS
Dynamically change CSS at run-time and force browser cache to use new CSS, Is there a way to check if the user has a different version of the CSS cached by their browser and if so force their browser to pull the new version? <code> ,Force browser to use new CSS
Dynamically change CSS at run-time and force browser to use new CSS, Is there a way to check if the user has a different version of the CSS cached by their browser and if so force their browser to pull the new version? <code> ,Force browser to use new CSS
"What is ""Best Practice"" For Comparing to Instances of a Reference Type?"," I came across this recently, up until now I have been happily overriding the equality operator (==) and/or Equals method in order to see if two references types actually contained the same data (i.e. two different instances that look the same).I have been using this even more since I have been getting more in to automated testing (comparing reference/expected data against that returned).While looking over some of the coding standards guidelines in MSDN I came across an article that advises against it. Now I understand why the article is saying this (because they are not the same instance) but it does not answer the question:What is the best way to compare two reference types?Should we implement IComparable? (I have also seen mention that this should be reserved for value types only).Is there some interface I don't know about?Should we just roll our own?!Many Thanks ^_^UpdateLooks like I had mis-read some of the documentation (it's been a long day) and overriding Equals may be the way to go..If you are implementing referencetypes, you should consider overridingthe Equals method on a reference typeif your type looks like a base typesuch as a Point, String, BigNumber,and so on. Most reference types shouldnot overload the equality operator,even if they override Equals. However,if you are implementing a referencetype that is intended to have valuesemantics, such as a complex numbertype, you should override the equalityoperator. <code> ","What is ""Best Practice"" For Comparing Two Instances of a Reference Type?"
How do i embed an image in a .NET HTML Mail Message," I have an HTML Mail template, with a place holder for the image. I am getting the image I need to send out of a database and saving it into a photo directory. I need to embed the image in the HTML Message.I have explored using an AlternateView: <code>  AlternateView htmlView = AlternateView.CreateAlternateViewFromString(""<HTML> <img src=cid:VisitorImage> </HTML>"");LinkedResource VisitorImage = new LinkedResource(p_ImagePath);VisitorImage.ContentId= ""VisitorImage"";htmlView.LinkedResources.Add(VisitorImage);",How do I embed an image in a .NET HTML Mail Message?
LINQ to entities - Building where clauses to test within a many to many relationship.," So, I am using the Linq entity framework. I have 2 entities: Content and Tag. They are in a many-to-many relationship with one another. Content can have many Tags and Tag can have many Contents. So I am trying to write a query to select all contents where any tags names are equal to blahThe entities both have a collection of the other entity as a property(but no IDs). This is where I am struggling. I do have a custom expression for Contains (so, whoever may help me, you can assume that I can do a ""contains"" for a collection). I got this expression from: http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2670710&SiteID=1Edit 1I ended up finding my own answer. <code> ",LINQ to entities - Building where clauses to test collections within a many to many relationship
LINQ to entities - Building where clauses to test collections within a many to many relationship.," So, I am using the Linq entity framework. I have 2 entities: Content and Tag. They are in a many-to-many relationship with one another. Content can have many Tags and Tag can have many Contents. So I am trying to write a query to select all contents where any tags names are equal to blahThe entities both have a collection of the other entity as a property(but no IDs). This is where I am struggling. I do have a custom expression for Contains (so, whoever may help me, you can assume that I can do a ""contains"" for a collection). I got this expression from: http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2670710&SiteID=1Edit 1I ended up finding my own answer. <code> ",LINQ to entities - Building where clauses to test collections within a many to many relationship
C#: Try-catch every line of code without individual try-catch blocks," I do not currently have this issue, but you never know, and thought experiments are always fun.Ignoring the obvious problems that you would have to have with your architecture to even be attempting this, let's assume that you had some horribly-written code of someone else's design, and you needed to do a bunch of wide and varied operations in the same code block, e.g.: Multiplied by a hundred. Some of these might work, others might go badly wrong. What you need is the C# equivalent of ""on error resume next"", otherwise you're going to end up copying and pasting try-catches around the many lines of code.How would you attempt to tackle this problem? <code>  WidgetMaker.SetAlignment(57);contactForm[""Title""] = txtTitle.Text;Casserole.Season(true, false);((RecordKeeper)Session[""CasseroleTracker""]).Seasoned = true;",Try-catch every line of code without individual try-catch blocks
System.Data.OracleClient: How can I mock/fake/stub OracleException?," In my tests I need to test what happens when an OracleException is thrown (due to a stored procedure failure). I am trying to setup Rhino Mocks to For whatever reason however, OracleException seems to be sealed with no public constructor. What can I do to test this?Edit: Here is exactly what I'm trying to instantiate: <code>  Expect.Call(....).Throw(new OracleException()); public sealed class OracleException : DbException { private OracleException(string message, int code) { ...}}",How can I mock/fake/stub sealed OracleException with no public constructor?
C#: File-size format provider," Is there any easy way to create a class that uses IFormatProvider that writes out a user-friendly file-size? It should result in strings formatted something like ""2,5 MB"", ""3,9 GB"", ""670 bytes"" and so on. <code>  public static string GetFileSizeString(string filePath){ FileInfo info = new FileInfo(@""c:\windows\notepad.exe""); long size = info.Length; string sizeString = size.ToString(FileSizeFormatProvider); // This is where the class does its magic...}",File-size format provider
What is the best scripting language to embed in a C# desktop application.," We are writing a complex rich desktop application and need to offer flexibility in reporting formats so we thought we would just expose our object model to a scripting langauge. Time was when that meant VBA (which is still an option), but the managed code derivative VSTA (I think) seems to have withered on the vine.What is now the best choice for an embedded scripting language on Windows .NET? <code> ",What is the best scripting language to embed in a C# desktop application?
Find the next TCP port in .Net," I want to create a new net.tcp://localhost:x/Service endpoint for a WCF service call, with a dynamically assigned new open TCP port.I know that TcpClient will assign a new client side port when I open a connection to a given server.Is there a simple way to find the next open TCP port in .NET?I need the actual number, so that I can build the string above. 0 does not work, since I need to pass that string to another process, so that I can call back on that new channel. <code> ",Find the next TCP port in .NET
Cross-thread operation not valid: Control accessed from a thread other than the thread it was created on.," I have a scenario. (Windows Forms, C#, .NET)There is a main form which hosts some user control.The user control does some heavy data operation, such that if I directly call the UserControl_Load method the UI become nonresponsive for the duration for load method execution.To overcome this I load data on different thread (trying to change existing code as little as I can) I used a background worker thread which will be loading the data and when done will notify the application that it has done its work. Now came a real problem. All the UI (main form and its child usercontrols) was created on the primary main thread. In the LOAD method of the usercontrol I'm fetching data based on the values of some control (like textbox) on userControl. The pseudocode would look like this:CODE 1 The Exception it gave was Cross-thread operation not valid: Control accessed from a thread other than the thread it was created on.To know more about this I did some googling and a suggestion came up like using the following codeCODE 2 BUT BUT BUT... it seems I'm back to square one. The Application again become nonresponsive. It seems to be due to the execution of line #1 if condition. The loading task is again done by the parent thread and not the third that I spawned.I don't know whether I perceived this right or wrong. I'm new to threading.How do I resolve this and also what is the effect of execution of Line#1 if block?The situation is this: I want to load data into a global variable based on the value of a control. I don't want to change the value of a control from the child thread. I'm not going to do it ever from a child thread. So only accessing the value so that the corresponding data can be fetched from the database. <code>  UserContrl1_LoadDataMethod(){ if (textbox1.text == ""MyName"") // This gives exception { //Load data corresponding to ""MyName"". //Populate a globale variable List<string> which will be binded to grid at some later stage. }} UserContrl1_LoadDataMethod(){ if (InvokeRequired) // Line #1 { this.Invoke(new MethodInvoker(UserContrl1_LoadDataMethod)); return; } if (textbox1.text == ""MyName"") // Now it wont give an exception { //Load data correspondin to ""MyName"" //Populate a globale variable List<string> which will be binded to grid at some later stage }}",Cross-thread operation not valid: Control accessed from a thread other than the thread it was created on
ASP.NET MVC Input Validation, I'm currently working on a blog application in ASP.NET MVC.I can't quite figure out how to handle my input validation! As far as I understand the view itself cannot know about input validation!? So how am I going to do this? <code> ,ASP.NET MVC input validation
Asynchrnonous WPF Commands," Note: The code in this question is part of deSleeper if you want the full source.One of the things I wanted out of commands was a baked design for asynchronous operations. I wanted the button pressed to disable while the command was executing, and come back when complete. I wanted the actual work to be performed in a ThreadPool work item. And lastly, I wanted a way to handle any errors that occurred during the asynchronous processing.My solution was an AsyncCommand: so the question is: Is all this necessary? I've noticed built in asynchronous support for data-binding, so why not command execution? Perhaps it's related to the parameter question, which is my next question. <code>  public abstract class AsyncCommand : ICommand{ public event EventHandler CanExecuteChanged; public event EventHandler ExecutionStarting; public event EventHandler<AsyncCommandCompleteEventArgs> ExecutionComplete; public abstract string Text { get; } private bool _isExecuting; public bool IsExecuting { get { return _isExecuting; } private set { _isExecuting = value; if (CanExecuteChanged != null) CanExecuteChanged(this, EventArgs.Empty); } } protected abstract void OnExecute(object parameter); public void Execute(object parameter) { try { IsExecuting = true; if (ExecutionStarting != null) ExecutionStarting(this, EventArgs.Empty); var dispatcher = Dispatcher.CurrentDispatcher; ThreadPool.QueueUserWorkItem( obj => { try { OnExecute(parameter); if (ExecutionComplete != null) dispatcher.Invoke(DispatcherPriority.Normal, ExecutionComplete, this, new AsyncCommandCompleteEventArgs(null)); } catch (Exception ex) { if (ExecutionComplete != null) dispatcher.Invoke(DispatcherPriority.Normal, ExecutionComplete, this, new AsyncCommandCompleteEventArgs(ex)); } finally { dispatcher.Invoke(DispatcherPriority.Normal, new Action(() => IsExecuting = false)); } }); } catch (Exception ex) { IsExecuting = false; if (ExecutionComplete != null) ExecutionComplete(this, new AsyncCommandCompleteEventArgs(ex)); } } public virtual bool CanExecute(object parameter) { return !IsExecuting; }}",Asynchronous WPF Commands
Are their any 'ok' Image Recognition libraries for .NET?," I want to be able to compare an image taken from a webcam to an image stored on my computer.The library doesn't need to be one hundred percent accurate as it won't be used in anything mission critical (e.g. police investigation), I just want something OK I can work with.I have tried a demonstration project for Image Recognition from CodeProject, and it only works with small images / doesn't work at all when I compare an exact same image 120x90 pixels (this is not classified as OK :P ).Has there been any success with image recognition before?If so, would you be able to provide a link to a library I could use in either C# or VB.NET? <code> ",Are there any OK image recognition libraries for .NET?
Are there any 'ok' Image Recognition libraries for .NET?," I want to be able to compare an image taken from a webcam to an image stored on my computer.The library doesn't need to be one hundred percent accurate as it won't be used in anything mission critical (e.g. police investigation), I just want something OK I can work with.I have tried a demonstration project for Image Recognition from CodeProject, and it only works with small images / doesn't work at all when I compare an exact same image 120x90 pixels (this is not classified as OK :P ).Has there been any success with image recognition before?If so, would you be able to provide a link to a library I could use in either C# or VB.NET? <code> ",Are there any OK image recognition libraries for .NET?
WebBrowser Control from .Net -- How to Inject Javascript?," I've tried this: scriptEl.InnerHtml and scriptEl.InnerText both give errors: Is there an easy way to inject a script into the dom? <code>  string newScript = textBox1.Text;HtmlElement head = browserCtrl.Document.GetElementsByTagName(""head"")[0];HtmlElement scriptEl = browserCtrl.Document.CreateElement(""script"");lblStatus.Text = scriptEl.GetType().ToString();scriptEl.SetAttribute(""type"", ""text/javascript"");head.AppendChild(scriptEl);scriptEl.InnerHtml = ""function sayHello() { alert('hello') }""; System.NotSupportedException: Property is not supported on this type of HtmlElement. at System.Windows.Forms.HtmlElement.set_InnerHtml(String value) at SForceApp.Form1.button1_Click(Object sender, EventArgs e) in d:\jsight\installs\SForceApp\SForceApp\Form1.cs:line 31 at System.Windows.Forms.Control.OnClick(EventArgs e) at System.Windows.Forms.Button.OnClick(EventArgs e) at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent) at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks) at System.Windows.Forms.Control.WndProc(Message& m) at System.Windows.Forms.ButtonBase.WndProc(Message& m) at System.Windows.Forms.Button.WndProc(Message& m) at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m) at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m) at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)",How to inject Javascript in WebBrowser control?
How do I create a Microsft Jet (Access) database without an interop assembly?, I need to create an access (mdb) database without using the ADOX interop assembly. How can this be done? <code> ,How do I create a Microsoft Jet (Access) database without an interop assembly?
How would you simplfy Entering and Exiting a ReaderWriterLock?, This seems very noisy to me. Five lines of overhead is just too much. So how would you simply this? <code>  m_Lock.EnterReadLock()Try Return m_List.CountFinally m_Lock.ExitReadLock()End Try,How would you simplify Entering and Exiting a ReaderWriterLock?
Learning LINQ: QSort," I took the plunge this afternoon and began studying LINQ, so far just mucking around with LINQ on collections. One of the first things I tried was to implement QSort.Now -- ignoring the fact that I could just use an ORDERBY and that this is a very silly qsort implementation -- what I came up with was this: The only thing that really bugs me is all of the casting involved. Are there any LINQ tricks I might use? Or am I just using LINQ for things it wasn't intended for? <code>  public class lqsort{ public static List<int> QSLinq(List<int> _items) { if (_items.Count <= 1) return _items; int _pivot = _items[0]; List<int> _less = (from _item in _items where _item < _pivot select _item).ToList(); List<int> _same = (from _item in _items where _item == _pivot select _item).ToList(); List<int> _greater = (from _item in _items where _item > _pivot select _item).ToList(); return (QSLinq(_less).Concat(_same.Concat(QSLinq(_greater)))).ToList(); }}",Learning LINQ: QuickSort
c# indexof n th occurence of a string," Unless I am missing an obvious built-in method, what is the quickest way to get the nth occurrence of a string within a string?I realize that I could loop the IndexOf method by updating its start index on each iteration of the loop. But doing it this way seems wasteful to me. <code> ",Get the index of the nth occurrence of a string?
C# - indexOf  the nth occurrence of a string?," Unless I am missing an obvious built-in method, what is the quickest way to get the nth occurrence of a string within a string?I realize that I could loop the IndexOf method by updating its start index on each iteration of the loop. But doing it this way seems wasteful to me. <code> ",Get the index of the nth occurrence of a string?
C# Equivalent of the following statement please, Could you please show me the C# Equivalent of this VB.NET code: I am not sure where/how to add it in for C#: The code is suppose to tell the class to expect a list of tasks from the controller... <code>  Public Partial Class Index Inherits System.Web.Mvc.Viewpage(Of List(Of Task))End Class public partial class DirList : System.Web.Mvc.ViewPage{},VB.NET generics to C# syntax
C# - How to get Program Files (x86) on Vista x64," I'm using: In order to determine if a program is detected on a users machine (it's not ideal, but the program I'm looking for is a right old kludge of a MS-DOS application, and I couldn't think of another method).On Windows XP and 32-bit versions of Windows Vista this works fine. However, on x64 Windows Vista the code returns the x64 Program Files folder, whereas the application is installed in Program Files x86. Is there a way to programatically return the path to Program Files x86 without hard wiring ""C:\Program Files (x86)""? <code>  FileInfo( System.Environment.GetFolderPath( System.Environment.SpecialFolder.ProgramFiles) + @""\MyInstalledApp""",C# - How to get Program Files (x86) on Windows 64 bit
C# - How to get Program Files (x86) on Windows Vista 64 bit," I'm using: In order to determine if a program is detected on a users machine (it's not ideal, but the program I'm looking for is a right old kludge of a MS-DOS application, and I couldn't think of another method).On Windows XP and 32-bit versions of Windows Vista this works fine. However, on x64 Windows Vista the code returns the x64 Program Files folder, whereas the application is installed in Program Files x86. Is there a way to programatically return the path to Program Files x86 without hard wiring ""C:\Program Files (x86)""? <code>  FileInfo( System.Environment.GetFolderPath( System.Environment.SpecialFolder.ProgramFiles) + @""\MyInstalledApp""",C# - How to get Program Files (x86) on Windows 64 bit
How do I use LINQ .Contains(string[]) instead of .Contains(string)," I got one big question.I got a linq query to put it simply looks like this: The values of the string[] array would be numbers like (1,45,20,10,etc...)the Default for .Contains is .Contains(string).I need it to do this instead: .Contains(string[])...EDIT : One user suggested writing an extension class for string[]. I would like to learn how, but any one willing to point me in the right direction?EDIT : The uid would also be a number. That's why it is converted to a string.Help anyone? <code>  from xx in tablewhere xx.uid.ToString().Contains(string[])select xx",How do I use LINQ Contains(string[]) instead of Contains(string)
LINQ to SQL associations - how to change the value of associated field," I have 2 classes with a LINQ association between them i.e.: The association here is between Table1.ID -> Table2.ForiegnIDI need to be able to change the value of Table2.ForiegnID, however I can't and think it is because of the association (as when I remove it, it works).Therefore, does anyone know how I can change the value of the associated field Table2.ForiegnID? <code>  Table1: Table2:ID IDName Description ForiegnID",How to change the value of associated field
Whats the main difference between int.Parse() and Convert.ToInt32 , What is the main difference between int.Parse() and Convert.ToInt32()?Which one is to be preferred <code> ,What's the main difference between int.Parse() and Convert.ToInt32
Whats the main difference between int.Parse() and Convert.ToInt32, What is the main difference between int.Parse() and Convert.ToInt32()?Which one is to be preferred <code> ,What's the main difference between int.Parse() and Convert.ToInt32
Preserving order in SQL, I use LINQ to Objects instructions on an ordered array. Which operations shouldn't I do to be sure the order of the array is not changed? <code> ,Preserving order with LINQ
Best Server-side .Net PDF editing library," What's the best .NET PDF editing library available, and why?It needs to be used on an IIS web-server.Specifically, I need to edit a PDF which was generated by reporting services.Factors I'm interested in:SpeedMemory ConsumptionPriceQuality of documentationLibrary stabilitySize of libraryWhatever else you think is important <code> ",Best Server-side .NET PDF editing library
How do I prevent and/or handle a StackOverflowException? (C#)," I would like to either prevent or handle a StackOverflowException that I am getting from a call to the XslCompiledTransform.Transform method within an Xsl Editor I am writing. The problem seems to be that the user can write an Xsl script that is infinitely recursive, and it just blows up on the call to the Transform method. (That is, the problem is not just the typical programmatic error, which is usually the cause of such an exception.)Is there a way to detect and/or limit how many recursions are allowed? Or any other ideas to keep this code from just blowing up on me? <code> ",How do I prevent and/or handle a StackOverflowException?
Nunit and 64bits," I am on Vista 64 bits and I have a project built with x86 configuration. All work fine. Now, we are at the time to create test. We have NUnit 2.4.8 but we have a lot of problem.The test are loading trough the Nunit.exe (gui) when we select the .dll directly but when executing we have a system.badimageformatexception.I have read by searching on Google few trick about the nunit.exe.config but none work. (changing to UTF8... uncomment .net version for startup).Any idea?UpdateI have clean the solution and erase all BIN folder. Now when I compile I clearly see that I have only the /x86/ in the bin directory and not the old /debug/ that was in x64.When I go with Nunit I have an exception (in the loading) : System.IO.FileNotFoundException...Server stack trace: at System.Reflection.Assembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, Assembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection) at System.Reflection.Assembly.InternalLoad(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection) at System.Reflection.Assembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection) at System.Reflection.Assembly.Load(String assemblyString) at NUnit.Core.Builders.TestAssemblyBuilder.Load(String path) at NUnit.Core.Builders.TestAssemblyBuilder.Build(String assemblyName, Boolean autoSuites) at NUnit.Core.Builders.TestAssemblyBuilder.Build(String assemblyName, String testName, Boolean autoSuites) at NUnit.Core.TestSuiteBuilder.BuildSingleAssembly(TestPackage package) at NUnit.Core.TestSuiteBuilder.Build(TestPackage package) at NUnit.Core.SimpleTestRunner.Load(TestPackage package) at NUnit.Core.ProxyTestRunner.Load(TestPackage package) at NUnit.Core.ProxyTestRunner.Load(TestPackage package) at NUnit.Core.RemoteTestRunner.Load(TestPackage package) at System.Runtime.Remoting.Messaging.StackBuilderSink._PrivateProcessMessage(IntPtr md, Object[] args, Object server, Int32 methodPtr, Boolean fExecuteInContext, Object[]& outArgs) at System.Runtime.Remoting.Messaging.StackBuilderSink.SyncProcessMessage(IMessage msg, Int32 methodPtr, Boolean fExecuteInContext)Exception rethrown at [0]: at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg) at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type) at NUnit.Core.TestRunner.Load(TestPackage package) at NUnit.Util.TestDomain.Load(TestPackage package) at NUnit.Util.TestLoader.LoadTest(String testName)Update 2I am compiling with ANY CPU that I have modified to be x86 instead of x64. The reason is for the debug. This has been already discussed in the previous link. I have to confirm that NUnit is running in 64bits mod and Corflags.exe <code> ",Nunit.exe cannot work on Vista 64bits if x86 build
C# - Exception messages in English?," We are logging any exceptions that happen in our system by writing the Exception.Message to a file. However, they are written in the culture of the client. And Turkish errors don't mean a lot to me.So how can we log any error messages in English without changing the users culture? <code> ",Exception messages in English?
LINQ DataContext.Translate and properties with name different than the source.," I am working with some tables where I want the C# class to have a different property name than the underlying table column. However, when I use the Translate method to read the results, the properties that don't match the source name never get populated. Even when I use Linq to generate the SQL.For instance, my table is defined in the DB like this: Here's the class it maps to (generated by the LINQ designer...LINQ attributes and other stuff left out for brevity): When I do the following, the Login and Pwd properties are not populated but the UserId and the Active properties are. !At this point, I inspect the user object and I can see that the Login and Pwd columns are not populated!Here is the sql that was generated: Originally, when the UserId column had a different property name I was getting an exception The required column [UserId] does not exist in the results. I looked around and I saw a response from some MSFT people that said it was a bug.Is this related? Was it ever fixed? Does anyone know when it will be fixed?Edit: Some more info.The bug that I think this is related to has a comment from Kathy Lu MSFT on 14 Aug 2007 here, where she says: Thank you for reporting this issue. From your issue we were able reproduce the issue and the product team is looking into an appropriate triage and resolution.I'm wondering if this is related to what I'm experiencing and if I can get more info about it. I searched linq translate site:connect.microsoft.com but I didn't find anything. <code>  CREATE TABLE User_Entry ( UserId int IDENTITY (1, 1) NOT NULL, Login_Id varchar (50) NOT NULL, Active char(1) NOT NULL, PASSWORD varchar(75) NULL) public partial class User{ int UserId; string Login; string Active, string Pwd} Data.DbContext db = new Data.DbContext();IQueryable query = db.Users.Where(usr => usr.Login == request.LoginString);SqlCommand cmd = (SqlCommand)data.GetCommand(query);... execute the command (asynchronously) ...User user = db.Translate<User>( dataReaderResult ).FirstOrDefault(); exec sp_executesql N'SELECT [t0].[UserID] AS [UserId], [t0].[Login_ID] AS [Login], [t0].[Active], [t0].[PASSWORD] AS [Pwd]FROM [dbo].[User_Entry] AS [t0]WHERE [t0].[Login_ID] = @p0', N'@p0 varchar(13)', @p0 = 'test_user'",LINQ to SQL DataContext.Translate and properties with name different than the source
LINQ to SQL DataContext.Translate and properties with name different than the source.," I am working with some tables where I want the C# class to have a different property name than the underlying table column. However, when I use the Translate method to read the results, the properties that don't match the source name never get populated. Even when I use Linq to generate the SQL.For instance, my table is defined in the DB like this: Here's the class it maps to (generated by the LINQ designer...LINQ attributes and other stuff left out for brevity): When I do the following, the Login and Pwd properties are not populated but the UserId and the Active properties are. !At this point, I inspect the user object and I can see that the Login and Pwd columns are not populated!Here is the sql that was generated: Originally, when the UserId column had a different property name I was getting an exception The required column [UserId] does not exist in the results. I looked around and I saw a response from some MSFT people that said it was a bug.Is this related? Was it ever fixed? Does anyone know when it will be fixed?Edit: Some more info.The bug that I think this is related to has a comment from Kathy Lu MSFT on 14 Aug 2007 here, where she says: Thank you for reporting this issue. From your issue we were able reproduce the issue and the product team is looking into an appropriate triage and resolution.I'm wondering if this is related to what I'm experiencing and if I can get more info about it. I searched linq translate site:connect.microsoft.com but I didn't find anything. <code>  CREATE TABLE User_Entry ( UserId int IDENTITY (1, 1) NOT NULL, Login_Id varchar (50) NOT NULL, Active char(1) NOT NULL, PASSWORD varchar(75) NULL) public partial class User{ int UserId; string Login; string Active, string Pwd} Data.DbContext db = new Data.DbContext();IQueryable query = db.Users.Where(usr => usr.Login == request.LoginString);SqlCommand cmd = (SqlCommand)data.GetCommand(query);... execute the command (asynchronously) ...User user = db.Translate<User>( dataReaderResult ).FirstOrDefault(); exec sp_executesql N'SELECT [t0].[UserID] AS [UserId], [t0].[Login_ID] AS [Login], [t0].[Active], [t0].[PASSWORD] AS [Pwd]FROM [dbo].[User_Entry] AS [t0]WHERE [t0].[Login_ID] = @p0', N'@p0 varchar(13)', @p0 = 'test_user'",LINQ to SQL DataContext.Translate and properties with name different than the source
"In Windows, what is the most reliable way to determine whether an application window is offscreen?"," I am trying to debug a strange issue with users that have LogMeIn installed. After a few days, some of my dialogs that my app opens can end up offscreen. If I could reliable detect that, I could programmatically move the dialogs back where they are visible again.Note: this has to work for multiple monitors and use the win32 API. However, if you know how to do it from .NET I can probably extrapolate from there...Update: For the curious, the bug mentioned above has to do with wxWidgets. If you run a wxWidgets application, then walk away and let your screen saver go, then log in remotely with LogMeIn, then try to open a dialog from your app, you will have trouble if you use wxDisplay::GetFromPoint(pos) or wxWindowBase::Center() to position the dialog. <code> ",How to determine whether a Windows application is offscreen?
Schould I agree to ban using statement form my c# projects?," My colleague insists on explicitly specifying the namespace in code as opposed to using the using directive. In other words he wants to use the fully qualified name for each type every time this type occurs in code. Something like instead of: You can imagine the consequences.The pros he gives: It's simpler to copy and paste code into other source files. It is more readable (you see the namespaces right away). My cons:I have to write more The code is less readable (I guess de gustibus non disputandum est) No one does it! What do you think about this? <code>  public class MyClass{ public static void Main() { System.Console.WriteLine(""Foo""); }} using System;public class MyClass{ public static void Main() { Console.WriteLine(""Foo""); }}","Should I agree to ban the ""using"" directive from my C# projects?"
Should I agree to ban using statement form my c# projects?," My colleague insists on explicitly specifying the namespace in code as opposed to using the using directive. In other words he wants to use the fully qualified name for each type every time this type occurs in code. Something like instead of: You can imagine the consequences.The pros he gives: It's simpler to copy and paste code into other source files. It is more readable (you see the namespaces right away). My cons:I have to write more The code is less readable (I guess de gustibus non disputandum est) No one does it! What do you think about this? <code>  public class MyClass{ public static void Main() { System.Console.WriteLine(""Foo""); }} using System;public class MyClass{ public static void Main() { Console.WriteLine(""Foo""); }}","Should I agree to ban the ""using"" directive from my C# projects?"
"Should I agree to ban the ""using"" statement in my c# projects?"," My colleague insists on explicitly specifying the namespace in code as opposed to using the using directive. In other words he wants to use the fully qualified name for each type every time this type occurs in code. Something like instead of: You can imagine the consequences.The pros he gives: It's simpler to copy and paste code into other source files. It is more readable (you see the namespaces right away). My cons:I have to write more The code is less readable (I guess de gustibus non disputandum est) No one does it! What do you think about this? <code>  public class MyClass{ public static void Main() { System.Console.WriteLine(""Foo""); }} using System;public class MyClass{ public static void Main() { Console.WriteLine(""Foo""); }}","Should I agree to ban the ""using"" directive from my C# projects?"
"Should I agree to ban the ""using"" statement from my c# projects?"," My colleague insists on explicitly specifying the namespace in code as opposed to using the using directive. In other words he wants to use the fully qualified name for each type every time this type occurs in code. Something like instead of: You can imagine the consequences.The pros he gives: It's simpler to copy and paste code into other source files. It is more readable (you see the namespaces right away). My cons:I have to write more The code is less readable (I guess de gustibus non disputandum est) No one does it! What do you think about this? <code>  public class MyClass{ public static void Main() { System.Console.WriteLine(""Foo""); }} using System;public class MyClass{ public static void Main() { Console.WriteLine(""Foo""); }}","Should I agree to ban the ""using"" directive from my C# projects?"
"Should I agree to ban the ""using"" directive from my c# projects?"," My colleague insists on explicitly specifying the namespace in code as opposed to using the using directive. In other words he wants to use the fully qualified name for each type every time this type occurs in code. Something like instead of: You can imagine the consequences.The pros he gives: It's simpler to copy and paste code into other source files. It is more readable (you see the namespaces right away). My cons:I have to write more The code is less readable (I guess de gustibus non disputandum est) No one does it! What do you think about this? <code>  public class MyClass{ public static void Main() { System.Console.WriteLine(""Foo""); }} using System;public class MyClass{ public static void Main() { Console.WriteLine(""Foo""); }}","Should I agree to ban the ""using"" directive from my C# projects?"
What's the hardest or most misunderstood aspeect of LINQ?," Background: Over the next month, I'll be giving three talks about or at least including LINQ in the context of C#. I'd like to know which topics are worth giving a fair amount of attention to, based on what people may find hard to understand, or what they may have a mistaken impression of. I won't be specifically talking about LINQ to SQL or the Entity Framework except as examples of how queries can be executed remotely using expression trees (and usually IQueryable).So, what have you found hard about LINQ? What have you seen in terms of misunderstandings? Examples might be any of the following, but please don't limit yourself!How the C# compiler treats query expressionsLambda expressionsExpression treesExtension methodsAnonymous typesIQueryableDeferred vs immediate executionStreaming vs buffered execution (e.g. OrderBy is deferred but buffered)Implicitly typed local variablesReading complex generic signatures (e.g. Enumerable.Join) <code> ",What's the hardest or most misunderstood aspect of LINQ?
C# - Optimising binary serialization for multi-dimensional generic arrays," I have a class that I need to binary serialize. The class contains one field as below: These multi-dimensional arrays can be fairly large (hundreds of thousands of elements) and of any primitive type. When I tried standard .net serialization on an object the file written to disk was large and I think .net is storing a lot of repeated data about element types and possibly not as efficiently as could be done.I have looked around for custom serializers but have not seen any that deal with multi-dimensional generic arrays. I have also experimented with built-in .net compression on a byte array of the memory stream following serializing with some success, but not as quick / compressed as I had hoped.My question is, should I try and write a custom serializer to optimally serialize this array for the appropriate type (this seems a little daunting), or should I use standard .net serialization and add compression?Any advice on the best approach would be most appreciated, or links to resources showing how to tackle serialization of a multi-dimensional generic array - as mentioned existing examples I have found do not support such structures. <code>  private T[,] m_data;",Optimising binary serialization for multi-dimensional generic arrays
C# .NET - Stream DataSet (of XML data) to ZIP file?," I have a DataSet consisting of XML data, I can easily output this to a file: However what I want to do is compress the XML into a ZIP or other type of compressed file and then just save this file to disk while splitting the ZIP file into 1MB chunks. I do not really want to save the uncompressed file, and then zip it, then split it.What I'm looking for specifically is:a suitable compression library that I can stream the XML to and have the zip file(s) saved to disksome sample C# code that can show me how to do this. <code>  DataSet ds = new DataSet();DataTable dt = new DataTable();ds.Tables.Add(dt);ds.Load(reader, LoadOption.PreserveChanges, ds.Tables[0]);ds.WriteXml(""C:\\test.xml"");",.NET - Stream DataSet (of XML data) to ZIP file?
c# create an instance of a class from a string, Is there a way to create an instance of a class based on the fact I know the name of the class at runtime. Basically I would have the name of the class in a string. <code> ,Create an instance of a class from a string
Best way to create a disposable singleton in C#," I have a singleton that uses the ""static readonly T Instance = new T();"" pattern. However, I ran into a case where T is disposable, and actually needs to be disposed for unit tests. How can I modify this pattern to support a disposable singleton?The interface I would like is something like: Note - the pattern has to be thread-safe, of course.Edit - for the purpose of production code, this is a true singleton. The thing is that it locks some files, and so for cleanup in unit tests we have to dispose it.I would also prefer a pattern that can be reused, if possible. <code>  var x = Foo.Instance;var y = Foo.Instance; // x == y...x.Release(); // this causes the next Foo.Instance to return a fresh object // also, it assumes no further operations on x/y will be performed.",Disposable singleton in C#
X = X++; vs X++;, Have you ever tried this before? Output: 10.but for Output: 11.Could anyone explain why this? <code>  static void Main(string[] args){ int x = 10; x = x++; Console.WriteLine(x);} static void Main(string[] args){ int x = 10; x++; Console.WriteLine(x);},What's the difference between X = X++; vs X++;?
Best way to reverse a string in C# 2.0, I've just had to write a string reverse function in C# 2.0 (i.e. LINQ not available) and came up with this: Personally I'm not crazy about the function and am convinced that there's a better way to do it. Is there? <code>  public string Reverse(string text){ char[] cArray = text.ToCharArray(); string reverse = String.Empty; for (int i = cArray.Length - 1; i > -1; i--) { reverse += cArray[i]; } return reverse;},Best way to reverse a string
how i can fill an array from user input C#, What would be the best way to fill an array from user input?Would a solution be showing a prompt message and then get the values from from the user? <code> ,How to Fill an array from user input C#?
How to use reflection to call generic Method?," What's the best way to call a generic method when the type parameter isn't known at compile time, but instead is obtained dynamically at runtime?Consider the following sample code - inside the Example() method, what's the most concise way to invoke GenericMethod<T>() using the Type stored in the myType variable? <code>  public class Sample{ public void Example(string typeName) { Type myType = FindType(typeName); // What goes here to call GenericMethod<T>()? GenericMethod<myType>(); // This doesn't work // What changes to call StaticMethod<T>()? Sample.StaticMethod<myType>(); // This also doesn't work } public void GenericMethod<T>() { // ... } public static void StaticMethod<T>() { //... }}",How do I use reflection to call a generic method?
What's the best way to extract a one-dimensional array from a two-dimensional array in C#?," Say I have a rectangular string array - not a jagged array What's the best way to extract a one-dimensional array from this (either a single row or a single column)? I can do this with a for loop, of course, but I'm hoping .NET has a more elegant way built in.Bonus points for converting the extracted string array to an object array. <code>  string[,] strings = new string[8, 3];",What's the best way to extract a one-dimensional array from a rectangular array in C#?
How do I enable a second monitor in C#, Is it possible to enable a second monitor programatically and extend the Windows Desktop onto it in C#? It needs to do the equivalent of turning on the checkbox in the image below. <code> ,How do I enable a second monitor in C#?
"Are you obsessed with redundant ""Using"" statements?"," I know VS2008 has the remove and sort function for cleaning up using directives, as does Resharper. Apart from your code being ""clean"" and removing the problem of referencing namespaces which might not exist in the future, what are the benefits of maintaining a ""clean"" list of using directives?Less code?Faster compilation times? <code> ","What are the benefits of maintaining a ""clean"" list of using directives in C#?"
"What are the benefits of maintaining a ""clean"" list of using statments in C#?"," I know VS2008 has the remove and sort function for cleaning up using directives, as does Resharper. Apart from your code being ""clean"" and removing the problem of referencing namespaces which might not exist in the future, what are the benefits of maintaining a ""clean"" list of using directives?Less code?Faster compilation times? <code> ","What are the benefits of maintaining a ""clean"" list of using directives in C#?"
Reording a list of positional items," I have a Request object which contains a list of Approvers. An approver has a name and an approval position.Mathew Mark Luke JohnUltimately, a request will move through this chain, starting at Mathew and ended at John.I need to be able to re-order these allowing adds and deletes as outlined below.An approver can be -Added at a certain position - ie. Add Peter at position 3 in which case the new order would beMathew Mark PeterLuke JohnDelete - ie. Delete Mark in which case the new order isMathew Luke JohnEdited - ie you can change John's position to 1 in which case the new order isJohnMathew Mark Luke I have come up with a number of solutions, however none of them is particular elegant.Any help would be much appreciated <code> ",Reordering a list of positional items
Parse DateTime with timezone of form PST/CEST/UTC/etc," I'm trying to parse an international datetime string similar to: So far I've got something like: The problem is what should I use for the '...' in the format string? Looking at the Custom Date and Time Format String MSDN page doesn't seem to list a format string for parsing timezones in PST/CEST/GMT/UTC form. <code>  24-okt-08 21:09:06 CEST CultureInfo culture = CultureInfo.CreateSpecificCulture(""nl-BE"");DateTime dt = DateTime.ParseExact(""24-okt-08 21:09:06 CEST"", ""dd-MMM-yy HH:mm:ss ..."", culture);",Parse DateTime with time zone of form PST/CEST/UTC/etc
.NET AppDomain using COM interop problem," Here's the core problem: I have a .NET application that is using COM interop in a separate AppDomain. The COM stuff seems to be loading assemblies back into the default domain, rather than the AppDomain from which the COM stuff is being called.What I want to know is: is this expected behaviour, or am I doing something wrong to cause these COM related assemblies to be loaded in the wrong AppDomain? Please see a more detailed description of the situation below...The application consists of 3 assemblies:- the main EXE, the entry point of the application.- common.dll, containing just an interface IController (in the IPlugin style)- controller.dll, containing a Controller class that implements IController and MarshalByRefObject. This class does all the work and uses COM interop to interact with another application.The relevant part of the main EXE looks like this: The common.dll only contains these 2 things: And the controller.dll contains this class (which also calls the COM interop stuff): When first running the application, Assembly.GetAssemblies() looks as expected, with common.dll being loaded in both AppDomains, and controller.dll only being loaded into the controller domain. After calling c.Run() however I see that assemblies related to the COM interop stuff have been loaded into the default AppDomain, and NOT in the AppDomain from which the COM interop is taking place.Why might this be occurring?And if you're interested, here's a bit of background:Originally this was a 1 AppDomain application. The COM stuff it interfaces with is a server API which is not stable over long periods of use. When a COMException (with no useful diagnostic information as to its cause) occurs from the COM stuff, the entire application has to restarted before the COM connection will work again. Simply reconnecting to the COM app server results in immediate COM exceptions again. To cope with this I have tried to move the COM interop stuff into a seperate AppDomain so that when the mystery COMExceptions occur I can unload the AppDomain in which it occurs, create a new one and start again, all without having to manually restart the application. That was the theory anyway... <code>  AppDomain controller_domain = AppDomain.CreateDomain(""Controller Domain"");IController c = (IController)controller_domain.CreateInstanceFromAndUnwrap(""controller.dll"", ""MyNamespace.Controller"");result = c.Run();AppDomain.Unload(controller_domain); public enum ControllerRunResult{FatalError, Finished, NonFatalError, NotRun}public interface IController{ ControllerRunResult Run();} public class Controller: IController, MarshalByRefObject",Does COM interop respect .NET AppDomain boundaries for assembly loading?
Default capacity of StringList , What is the default capacity of a StringBuilder?And when should (or shouldn't) the default be used? <code> ,Default capacity of StringBuilder 
Product with LINQ," I am learning LINQ and have a very simple question that I think will help my understand the technology better. How can I find the product of an array of ints?For example, what is the LINQ way to do: <code>  int[] vals = { 1, 3, 5 };return vals[0] * vals[1] * vals[2];",Calculate product with LINQ
Get a methods contents from a cs file," I have a requirement to get the contents of every method in a cs file into a string. What I am looking for is when you have an input of a cs file, a dictionary is returned with the method name as the key and the method body as the value.I have tried Regex and reflection with no success, can anyone help?Thanks <code> ",Get a method's contents from a cs file
C# Uploading files to file server," Currently I have an application that receives an uploaded file from my web application. I now need to transfer that file to a file server which happens to be located on the same network (however this might not always be the case).I was attempting to use the webclient class in C# .NET. The machine located at 192.168.1.28 is a file server and has a share c:\Files.As of right now I am receiving an error of Login failed bad user name or password, but I can open explorer and type in that path login successfully. I can also login using remote desktop, so I know the user account works.Any ideas on this error?Is it possible to transfer a file directly like that? With the webclient class or maybe some other class? <code>  string filePath = ""C:\\test\\564.flv""; try { WebClient client = new WebClient(); NetworkCredential nc = new NetworkCredential(uName, password); Uri addy = new Uri(""\\\\192.168.1.28\\Files\\test.flv""); client.Credentials = nc; byte[] arrReturn = client.UploadFile(addy, filePath); Console.WriteLine(arrReturn.ToString()); } catch (Exception ex) { Console.WriteLine(ex.Message); }",Uploading files to file server using webclient class
Default string initialization: NULL or Empy?," I have always initialized my strings to NULL, with the thinking that NULL means the absence of a value and """" or String.Empty is a valid value. I have seen more examples lately of code where String.Empty is considered the default value or represents no value. This strikes me as odd, with the newly added nullable types in c# it seems like we are taking strides backwards with strings by not using the NULL to represent 'No Value'.What do you use as the default initializer and why?Edit: Based on the answers I futher my further thoughtsAvoiding error handling If the value shouldn't be null, why did it get set to NULL in the first place? Perhaps it would be better to identify the error at the place where it occurs rather than cover it up through out the rest of your codebase?Avoiding null checks If you are tired of doing null checks in code, wouldn't it be better to abstract the null checks? Perhaps wrap (or extend!) the string methods to make them NULL safe? What happens if you constantly use String.Empty and a null happens to work it's way into your system, do you start adding NULL checks anyways?I can't help but return to the opinion that it is laziness. Any DBA would slap you nine ways to silly if you used '' instead of null in his\her database. I think the same principles apply in programming and there should be somebody to smack those upside the head who use String.Empty rather than NULL to represent no value.Related QuestionsIn C#, should I use string.Empty or String.Empty or ?What is the difference between String.Empty and Null or empty string to represent no data in table column? <code> ",Default string initialization: NULL or Empty?
C# 3.5 Func/OrderBy type inference ," So odd situation that I ran into today with OrderBy: Then: This is fine, but I was going to create a method instead because it might be usable somewhere else other than an orderBy. Now when I try to plug that into the OrderBy: It can't infer the type like it can if I use a Func. Seems like to me they should be the same since the method itself is ""strongly typed"" like the Func.Side Note: I realize I can do this: <code>  Func<SomeClass, int> orderByNumber = currentClass => currentClass.SomeNumber; someCollection.OrderBy(orderByNumber); private int ReturnNumber(SomeClass currentClass){ return currentClass.SomeNumber;} someCollection.OrderBy(ReturnNumber); Func<SomeClass, int> orderByNumber = ReturnNumber;",C# 3.0 Func/OrderBy type inference 
WebClient.DownloadStringAsync is freezing my UI," I have in my Form constructor, after the InitializeComponent the following code: When I start my form, the UI doesn't appears till client_DownloadDataCompleted is raised.The client_DownloadDataCompleted method is empty, so there's no problem there.What I'm doing wrong?How is supposed to do this without freezing the UI?Thanks for your time.Best regards.FULL CODE: Program.cs Form1.cs <code>  using (WebClient client = new WebClient()){ client.DownloadDataCompleted += new DownloadDataCompletedEventHandler(client_DownloadDataCompleted); client.DownloadDataAsync(""http://example.com/version.txt"");} using System;using System.Windows.Forms;namespace Lala{ static class Program { /// <summary> /// The main entry point for the application. /// </summary> [STAThread] static void Main() { Application.EnableVisualStyles(); Application.SetCompatibleTextRenderingDefault(false); Application.Run(new Form1()); } }} using System;using System.Net;using System.Windows.Forms;namespace Lala{ public partial class Form1 : Form { WebClient client = new WebClient(); public Form1() { client.DownloadDataCompleted += new DownloadDataCompletedEventHandler(client_DownloadDataCompleted); client.DownloadDataAsync(new Uri(""http://www.google.com"")); InitializeComponent(); } void client_DownloadDataCompleted(object sender, DownloadDataCompletedEventArgs e) { textBox1.Text += ""A""; } } partial class Form1 { /// <summary> /// Required designer variable. /// </summary> private System.ComponentModel.IContainer components = null; /// <summary> /// Clean up any resources being used. /// </summary> /// <param name=""disposing"">true if managed resources should be disposed; otherwise, false.</param> protected override void Dispose(bool disposing) { if (disposing && (components != null)) { components.Dispose(); } base.Dispose(disposing); } #region Windows Form Designer generated code /// <summary> /// Required method for Designer support - do not modify /// the contents of this method with the code editor. /// </summary> private void InitializeComponent() { this.button1 = new System.Windows.Forms.Button(); this.textBox1 = new System.Windows.Forms.TextBox(); this.SuspendLayout(); // // button1 // this.button1.Location = new System.Drawing.Point(12, 12); this.button1.Name = ""button1""; this.button1.Size = new System.Drawing.Size(75, 23); this.button1.TabIndex = 0; this.button1.Text = ""button1""; this.button1.UseVisualStyleBackColor = true; // // textBox1 // this.textBox1.Location = new System.Drawing.Point(12, 41); this.textBox1.Multiline = true; this.textBox1.Name = ""textBox1""; this.textBox1.Size = new System.Drawing.Size(468, 213); this.textBox1.TabIndex = 1; // // Form1 // this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F); this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font; this.ClientSize = new System.Drawing.Size(492, 266); this.Controls.Add(this.textBox1); this.Controls.Add(this.button1); this.Name = ""Form1""; this.Text = ""Form1""; this.ResumeLayout(false); this.PerformLayout(); } #endregion private System.Windows.Forms.Button button1; private System.Windows.Forms.TextBox textBox1; }}",WebClient.DownloadDataAsync is freezing my UI
How to detect using if a pendrive is plugged into a USB port ?, Is there a way to find out when in a LAN anyone plugs in a pendrive to the USB port? Programatically (in C# preferably) or through some tool. Basically I'd imagine a client application sits on each terminal and monitors the USB ports and sends the information to the server. a.) Can I get the details of the file(s) being copied?b.) Is there a way to do this without a client application? EDITI dont want to disable the USB port entirely. its to be on a need to have basis. Basically just want the users on the LAN to share data responsibly and know that whatever data is tranfered is monitored and logged and can be questioned later. <code> ,How to detect using c# if a pendrive is plugged into a USB port ?
Randomize a List<T> in C#," What is the best way to randomize the order of a generic list in C#? I've got a finite set of 75 numbers in a list I would like to assign a random order to, in order to draw them for a lottery type application. <code> ",Randomize a List<T>
Built in .Net algorithm to round value up to 10," How to, in C# round any value to 10 interval? For example, if I have 11, I want it to return 10, if I have 136, then I want it to return 140. I can easily do it by hand But I am looking for an builtin algorithm to do this job, something like Math.Round(). The reason why I won't want to do by hand is that I don't want to write same or similar piece of code all over my projects, even for something as simple as the above.  <code>  return ((int)(number / 10)) * 10;",Built in .Net algorithm to round value to the nearest 10 interval
Built in .Net algorithm to round value up to the nearest 10 interval," How to, in C# round any value to 10 interval? For example, if I have 11, I want it to return 10, if I have 136, then I want it to return 140. I can easily do it by hand But I am looking for an builtin algorithm to do this job, something like Math.Round(). The reason why I won't want to do by hand is that I don't want to write same or similar piece of code all over my projects, even for something as simple as the above.  <code>  return ((int)(number / 10)) * 10;",Built in .Net algorithm to round value to the nearest 10 interval
How to get client datetime in ASP.NET C#?, When I use DateTime.Now I get the date and time from the server point of view. Is there any way to get the client date and time in ASP.NET? <code> ,How to get client date and time in ASP.NET?
Can a C# program mesaure its own CPU usage somehow?," I am working on a background program that will be running for a long time, and I have a external logging program (SmartInspect) that I want to feed with some values periodically, to monitor it in realtime when debugging.I know I can simply fire up multiple programs, like the Task Manager, or IARSN TaskInfo, but I'd like to keep everything in my own program for this, as I also wants to add some simple rules like if the program uses more than X% CPU, flag this in the log.I have a background thread that periodically feeds some statistics to SmartInspect, like memory consumption, working set, etc.Is it possible for this thread to get a reasonably accurate measure of how much of the computer's CPU resources it consumes? The main program is a single-threaded application (apart from the watchdog thread that logs statistics) so if a technique is limited to how much does a single thread use then that would be good too.I found some entries related to something called rusage for Linux and C. Is there something similar I can use for this?Edit: Ok, I tried the performance counter way, but it added quite a lot of GC-data each time called, so the graph for memory usage and garbage collection skyrocketed. I guess I'll just leave this part out for now. <code> ",Can a C# program measure its own CPU usage somehow?
Unique ways to use the Null Coalescing operator," I know the standard way of using the null coalescing operator in C# is to set default values. But what else can ?? be used for? It doesn't seem as useful as the ternary operator, apart from being more concise and easier to read than: So given that fewer even know about null coalescing operator...Have you used ?? for something else?Is ?? necessary, or should you just use the ternary operator (thatmost are familiar with) <code>  string nobody = null;string somebody = ""Bob Saget"";string anybody = """";anybody = nobody ?? ""Mr. T""; // Returns Mr. Tanybody = somebody ?? ""Mr. T""; // Returns ""Bob Saget"" nobody = null;anybody = nobody == null ? ""Bob Saget"" : nobody; // Returns Bob Saget",Unique ways to use the null coalescing operator
c# how do you find the caller function?," Closed as exact duplicate of ""How can I find the method that called the current method?""Is this possible with c#? <code>  void main(){ Hello();}void Hello(){ // how do you find out the caller is function 'main'?}",How do you find the caller function?
.Net WinForms Design Time Rules," I have an object that starts a thread, opens a file, and waits for input from other classes. As it receives input, it writes it to disk. Basically, it's a thread safe data logging class...Here's the weird part. When I open a form in the designer (VisualStudio2008) that uses the object the file gets created. It's obviously running under the design time vhost process...The odd thing is I've not been able to reproduce the issue in another project. I'm not sure what the rules are for code that gets executed in the designer and code that does not. For example, creating a file in a Windows Forms constructor doesn't actually create the file at design time...What is the explanation? Is there a reference? <code> ",.NET Windows Forms design time rules
StructureMap : How to define default constructor by code ?," I can't figure out how to define the default constructor (when it exists overloads) for a type in StructureMap (version 2.5) by code.I want to get an instance of a service and the container has to inject a Linq2Sql data context instance into it.I wrote this in my 'bootstrapper' method : When I run my app, I got this error : StructureMap Exception Code: 202 No Default Instance defined for PluginFamily MyNamespace.Data.SqlRepository.MyDataContext, MyNamespace.Data, Version=1.0.0.0, Culture=neutral, PublicKeyToken=nullIf I comment out all Linq2Sql generated contructors that I don't need, it works fine.Update : Oh, and I forgot to say that I would not use the [StructureMap.DefaultConstructor] attribute. <code>  ForRequestedType<MyDataContext>().TheDefault.Is.OfConcreteType<MyDataContext>();",How to define a default constructor by code using StructureMap?
StructureMap : How to define default constructor by code?," I can't figure out how to define the default constructor (when it exists overloads) for a type in StructureMap (version 2.5) by code.I want to get an instance of a service and the container has to inject a Linq2Sql data context instance into it.I wrote this in my 'bootstrapper' method : When I run my app, I got this error : StructureMap Exception Code: 202 No Default Instance defined for PluginFamily MyNamespace.Data.SqlRepository.MyDataContext, MyNamespace.Data, Version=1.0.0.0, Culture=neutral, PublicKeyToken=nullIf I comment out all Linq2Sql generated contructors that I don't need, it works fine.Update : Oh, and I forgot to say that I would not use the [StructureMap.DefaultConstructor] attribute. <code>  ForRequestedType<MyDataContext>().TheDefault.Is.OfConcreteType<MyDataContext>();",How to define a default constructor by code using StructureMap?
Add custom design time command to WInForms control," I have a custom WinForms control (inherits from control, i.e. without user interface jsut as Timer) to which I want to add a custom command add design time. This could be similar to the ""right click and choose 'Edit Items...'"" of a menu.Is this posisble? How?Also, could you recommend some general reading (online) about improving the design time experience of custom controls?  <code> ",Add custom design time command to WinForms control
List major differences between C# and java?," I just want to clarify one thing. This is not a question on which one is better, that part I leave to someone else to discuss. I don't care about it.I've been asked this question on my job interview and I thought it might be useful to learn a bit more.These are the ones I could come up with:Java is ""platform independent"". Well nowadays you could say there is the Mono project so C# could be considered too butI believe it is a bit exaggerating. Why? Well, when a new release of Java is done it is simultaneously available on all platforms it supports, on the other hand how many features of C# 3.0 are still missing in the Mono implementation? Or is it really CLR vs. JRE that we should compare here?Java doesn't support events and delegates. As far as I know.In Java all methods are virtualDevelopment tools: I believe there isn't such a tool yet as Visual Studio. Especially if you've worked with team editions you'll know what I mean.Please add others you think are relevant.Update:Just popped up my mind, Java doesn't have something like custom attributes on classes, methods etc. Or does it? <code> ",What are major differences between C# and Java?
C# - Is there a better alternative than this to 'switch on type'?," Seeing as C# can't switch on a Type (which I gather wasn't added as a special case because is relationships mean that more than one distinct case might apply), is there a better way to simulate switching on type other than this? <code>  void Foo(object o){ if (o is A) { ((A)o).Hop(); } else if (o is B) { ((B)o).Skip(); } else { throw new ArgumentException(""Unexpected type: "" + o.GetType()); }}",Is there a better alternative than this to 'switch on type'?
What are Staticly linked and Dynamicly linked?," I often hear the terms 'statically linked' and 'dynamically linked', often in reference to code written in C, C++ or C#. What are they, what exactly are they talking about, and what are they linking? <code> ",What do 'statically linked' and 'dynamically linked' mean?
MVC: How do I pass a list (from a class in Model) to a repeater in a View, How do I do the above? I've started using MVC and I'm having issues passing data around.My specific problem is to do with a list of objects I have in my Model which I need to access in a View and iterate through.Thanks in advance. <code> ,ASP.NET MVC: How do I pass a list (from a class in Model) to a repeater in a View?
How do I test my data access layer with NUnit?," I want to write unit tests with NUnit that hit the database. I'd like to have the database in a consistent state for each test. I thought transactions would allow me to ""undo"" each test so I searched around and found several articles from 2004-05 on the topic:http://weblogs.asp.net/rosherove/archive/2004/07/12/180189.aspxhttp://weblogs.asp.net/rosherove/archive/2004/10/05/238201.aspxhttp://davidhayden.com/blog/dave/archive/2004/07/12/365.aspxhttp://haacked.com/archive/2005/12/28/11377.aspxThese seem to resolve around implementing a custom attribute for NUnit which builds in the ability to rollback DB operations after each test executes.That's great but... Does this functionality exists somewhere in NUnit natively?Has this technique been improved upon in the last 4 years? Is this still the best way to test database-related code?Edit: it's not that I want to test my DAL specifically, it's more that I want to test pieces of my code that interact with the database. For these tests to be ""no-touch"" and repeatable, it'd be awesome if I could reset the database after each one.Further, I want to ease this into an existing project that has no testing place at the moment. For that reason, I can't practically script up a database and data from scratch for each test. <code> ",How do I test database-related code with NUnit?
How do I create this expression tree in C#?," I am trying to create an expression tree that represents the following: Shortened for clarity, I have the following: What am I doing wrong? Anyone have any suggestions? <code>  myObject.childObjectCollection.Any(i => i.Name == ""name""); //'myObject.childObjectCollection' is represented here by 'propertyExp'//'i => i.Name == ""name""' is represented here by 'predicateExp'//but I am struggling with the Any() method reference - if I make the parent method//non-generic Expression.Call() fails but, as per below, if i use <T> the //MethodInfo object is always null - I can't get a reference to itprivate static MethodCallExpression GetAnyExpression<T>(MemberExpression propertyExp, Expression predicateExp){ MethodInfo method = typeof(Enumerable).GetMethod(""Any"", new[]{ typeof(Func<IEnumerable<T>, Boolean>)}); return Expression.Call(propertyExp, method, predicateExp);}",How do I create an expression tree calling IEnumerable<TSource>.Any(...)?
MVC question . .," Should the model just be data structures? Where do the services (data access, business logic) sit in MVC?Lets assume I have a view that shows a list of customer orders. I have a controller class that handles the clicks on the view controls (buttons, etc).Should the controller kick off the data access code? Think button click, reload order query. Or should this go through the model layer at all?Any example code would be great! <code> ","MVC: View and Model Interaction Regarding Data Access, etc"
ASP.NET MVC - Should the model just be a data structure?," Should the model just be data structures? Where do the services (data access, business logic) sit in MVC?Lets assume I have a view that shows a list of customer orders. I have a controller class that handles the clicks on the view controls (buttons, etc).Should the controller kick off the data access code? Think button click, reload order query. Or should this go through the model layer at all?Any example code would be great! <code> ","MVC: View and Model Interaction Regarding Data Access, etc"
Calling Overriden Constructor and Base Constructor in C#," I have two classes, Foo and Bar, that have constructors like this: Now I want to introduce a constructor for Bar that takes an int, but I want the stuff that happens in Bar() to run as well as the stuff from Foo(int). Something like this: Is there any way to do this in C#? The best I have so far is putting the work done by Bar() into a function, that also gets called by Bar(int), but this is pretty inelegant. <code>  class Foo{ Foo() { // do some stuff } Foo(int arg) { // do some other stuff }}class Bar : Foo{ Bar() : base() { // some third thing }} Bar(int arg) : Bar(), base(arg){ // some fourth thing}",Calling Overridden Constructor and Base Constructor in C#
C# Streaming WebCam Video, I want to make a simple server application where people can connect using a browser-based client (which I will make later) to watch streaming video. And I want to use C#.What do I need to capture video or rapid images through a webcam and send them over the network? <code> ,How can I stream webcam video with C#?
Sorting XML nodes based on DateTime attribute C#," I have a XML Structure that looks like this. I am trying to find a way to SORT the nodes based on the sTime attribute which is a DateTime.ToString() value. The trick is I need to keep the Nodes in tact and for some reason I can't find a way to do that. I'm fairly certain that LINQ and XPath have a way to do it, but I'm stuck because I can't seem to sort based on DateTime.ToString() value. I also need to maintain a pointer to the NODE to retrieve the values of the other attributes. Perhaps this isn't a simple as I thought it would be.Thanks.Solution: Here's what I ended up using. Taking the selected answer and the IComparable class this is how I get the XML nodes sorted based on the sTime attribute and then get the all the attributes into the appropriate Arrays to be used later. <code>  <sales> <item name=""Games"" sku=""MIC28306200"" iCat=""28"" sTime=""11/26/2008 8:41:12 AM"" price=""1.00"" desc=""Item Name"" /> <item name=""Games"" sku=""MIC28307100"" iCat=""28"" sTime=""11/26/2008 8:42:12 AM"" price=""1.00"" desc=""Item Name"" />...</sales> XPathDocument saleResults = new XPathDocument(@""temp/salesData.xml"");XPathNavigator navigator = saleResults.CreateNavigator();XPathExpression selectExpression = navigator.Compile(""sales/item/@sTime"");selectExpression.AddSort(""@sTime"", XmlSortOrder.Descending, XmlCaseOrder.None, """", XmlDataType.Number);XPathNodeIterator nodeIterator = navigator.Select(selectExpression);while( nodeIterator.MoveNext() ) { string checkMe = nodeIterator.Current.Value; } XPathDocument saleResults = new XPathDocument(@""temp/salesData.xml""); XPathNavigator navigator = saleResults.CreateNavigator(); XPathExpression selectExpression = navigator.Compile(""sales/item""); XPathExpression sortExpr = navigator.Compile(""@sTime""); selectExpression.AddSort(sortExpr, new DateTimeComparer()); XPathNodeIterator nodeIterator = navigator.Select(selectExpression); int i = 0; while (nodeIterator.MoveNext()) { if (nodeIterator.Current.MoveToFirstAttribute()) { _iNameList.SetValue(nodeIterator.Current.Value, i); } if (nodeIterator.Current.MoveToNextAttribute()) { _iSkuList.SetValue(nodeIterator.Current.Value, i); } ... nodeIterator.Current.MoveToParent(); i++; }","Sorting XML nodes based on DateTime attribute C#, XPath"
"Sorting XML nodes based on DateTime attribute C#, XPath, LINQ"," I have a XML Structure that looks like this. I am trying to find a way to SORT the nodes based on the sTime attribute which is a DateTime.ToString() value. The trick is I need to keep the Nodes in tact and for some reason I can't find a way to do that. I'm fairly certain that LINQ and XPath have a way to do it, but I'm stuck because I can't seem to sort based on DateTime.ToString() value. I also need to maintain a pointer to the NODE to retrieve the values of the other attributes. Perhaps this isn't a simple as I thought it would be.Thanks.Solution: Here's what I ended up using. Taking the selected answer and the IComparable class this is how I get the XML nodes sorted based on the sTime attribute and then get the all the attributes into the appropriate Arrays to be used later. <code>  <sales> <item name=""Games"" sku=""MIC28306200"" iCat=""28"" sTime=""11/26/2008 8:41:12 AM"" price=""1.00"" desc=""Item Name"" /> <item name=""Games"" sku=""MIC28307100"" iCat=""28"" sTime=""11/26/2008 8:42:12 AM"" price=""1.00"" desc=""Item Name"" />...</sales> XPathDocument saleResults = new XPathDocument(@""temp/salesData.xml"");XPathNavigator navigator = saleResults.CreateNavigator();XPathExpression selectExpression = navigator.Compile(""sales/item/@sTime"");selectExpression.AddSort(""@sTime"", XmlSortOrder.Descending, XmlCaseOrder.None, """", XmlDataType.Number);XPathNodeIterator nodeIterator = navigator.Select(selectExpression);while( nodeIterator.MoveNext() ) { string checkMe = nodeIterator.Current.Value; } XPathDocument saleResults = new XPathDocument(@""temp/salesData.xml""); XPathNavigator navigator = saleResults.CreateNavigator(); XPathExpression selectExpression = navigator.Compile(""sales/item""); XPathExpression sortExpr = navigator.Compile(""@sTime""); selectExpression.AddSort(sortExpr, new DateTimeComparer()); XPathNodeIterator nodeIterator = navigator.Select(selectExpression); int i = 0; while (nodeIterator.MoveNext()) { if (nodeIterator.Current.MoveToFirstAttribute()) { _iNameList.SetValue(nodeIterator.Current.Value, i); } if (nodeIterator.Current.MoveToNextAttribute()) { _iSkuList.SetValue(nodeIterator.Current.Value, i); } ... nodeIterator.Current.MoveToParent(); i++; }","Sorting XML nodes based on DateTime attribute C#, XPath"
APS.NET Custom 404 Returning 200 OK Instead of 404 Not Found," After trying to setup my site for Google Webmaster Tools I found that my Custom ASP.NET 404 page was not returning the 404 status code. It displayed the correct custom page and told the browser that everything is OK. This is consider a soft 404 or false 404. Google doesn't like this. So I found many articles on the issue but the solution I want didn't seem to work.The solution I want to work is adding the following two lines to the code behind Page_Load method of the custom 404 page. This doesn't work. The page still returns 200 OK. I found however that if I hard code the following code into the design code it will work properly. The page is using a master page. And I am configuring custom error pages in my web.config. I would really rather use the code behind option but I can't seem to make it work without putting a the hack inline code in the design / layout. <code>  Response.Status = ""404 Not Found"";Response.StatusCode = 404; <asp:Content ID=""ContentMain"" ContentPlaceHolderID=""ContentPlaceHolderMaster"" runat=""server""><% Response.Status = ""404 Not Found""; Response.StatusCode = 404;%> ... Much more code ...</asp:content>",ASP.NET Custom 404 Returning 200 OK Instead of 404 Not Found
Debugging a dll.," I am using a third-party DLL. For some particular cases, a function in the DLL is throwing an exception. Is it possible to debug the DLL in the Visual Studio?After the answer from Andrew Rollings, I am able to view the code, but is there any easy way to debug through the code in Visual Studio? <code> ",Debugging a third-party DLL in Visual Studio?
Debugging a third-party DLL in Visual Studio.NET?," I am using a third-party DLL. For some particular cases, a function in the DLL is throwing an exception. Is it possible to debug the DLL in the Visual Studio?After the answer from Andrew Rollings, I am able to view the code, but is there any easy way to debug through the code in Visual Studio? <code> ",Debugging a third-party DLL in Visual Studio?
C# 'var' vs specific type performance," Earlier I asked a question about why I see so many examples use the varkeyword and got the answer that while it is only necessary for anonymous types, that it is used nonetheless to make writing code 'quicker'/easier and 'just because'.Following this link (""C# 3.0 - Var Isn't Objec"") I saw that var gets compiled down to the correct type in the IL (you will see it about midway down article).My question is how much more, if any, IL code does using the var keyword take, and would it be even close to having a measurable level on the performance of the code if it was used everywhere? <code> ",Will using 'var' affect performance?
How to make IEnumberable<T> readonly?," Why are the lists list1Instance and p in the Main method of the below code pointing to the same collection? Can we change this behavior with out changing the return type of List1.Get()? Thanks <code>  class Person { public string FirstName = string.Empty; public string LastName = string.Empty; public Person(string firstName, string lastName) { this.FirstName = firstName; this.LastName = lastName; } } class List1 { public List<Person> l1 = new List<Person>(); public List1() { l1.Add(new Person(""f1"",""l1"")); l1.Add(new Person(""f2"", ""l2"")); l1.Add(new Person(""f3"", ""l3"")); l1.Add(new Person(""f4"", ""l4"")); l1.Add(new Person(""f5"", ""l5"")); } public IEnumerable<Person> Get() { foreach (Person p in l1) { yield return p; } //return l1.AsReadOnly(); } } class Program { static void Main(string[] args) { List1 list1Instance = new List1(); List<Person> p = new List<Person>(list1Instance.Get()); UpdatePersons(p); bool sameFirstName = (list1Instance.l1[0].FirstName == p[0].FirstName); } private static void UpdatePersons(List<Person> list) { list[0].FirstName = ""uf1""; } }",How to make IEnumerable<T> readonly?
"New to C#, why does Property Set throw StackOverflow exception?"," I know java and would normally put in getter/setter methods. I am interested in doing it in C# with the following code, but it throws a StackOverflow exception. What am I doing wrong?Calling Code Property Code  <code>  c.firstName = ""a""; public String firstName;{ get { return firstName; } set { firstName = value; }}",Why does Property Set throw StackOverflow exception?
"Linq2Sql Many:Many question, How would you do this"," I know many:many isn't supported in Linq2Sql but I am working on a workaroundI am working with my little SO clone and I have a table with Questions and a table with Tags and a linking table QuestionTag so I have a classic many:many relationship between Questions and Tags. To display the list of Questions on the front page I have this class I want to fill up from a Linq2Sql query The problem is how should I fill up the Tag collection. I found out this isn't possible to do in 1 single query so I have divided this into 2 queries, 1 to get the questions and 1 to get the tags and later try to join them. I know many:many is supported in Entity framework so how do they do it? How would you do this? Any alternative approach? The query should of course be efficient. <code>  public class ListQuestion{ public int QuestionID { get; set; } public string Title{ get; set; } public IEnumerable<Tag> Tags { get; set; }}public IEnumerable<ListQuestion> GetQuestions(){ from q in Questions ................. select new ListQuestion{ ... }}","Linq2Sql Many:Many question, How would you do this?"
Best way to print from c# / .net?," What is the best way to print stuff from c#/.net?The question is in regard to single pages as well as to reports containing lots of pages. It would be great to get a list of the most common printing libs containing the main features and gotchas of each of them.[Update] for standard windows clients (or servers), not for web apps, please. <code> ",Best way to print for Windows Clients (Not Web Apps)?
Convert string to Brushes/Brush name in C#," I have a configuration file where a developer can specify a text color by passing in a string: Rather than have a gigantic switch statement look for all of the possible colors, it'd be nice to just use the properties in the class System.Drawing.Brushes instead so internally I can say something like: Except that the values in Brush/Brushes aren't enums. So Enum.Parse gives me no joy. Suggestions? <code>  <text value=""Hello, World"" color=""Red""/> Brush color = Brushes.Black; // Default // later on... this.color = (Brush)Enum.Parse(typeof(Brush), prasedValue(""color""));",Convert string to Brushes/Brush color name in C#
WPF: Is it possible to use a converter within a style?, Is it possible to use a converter within a style? For instance I am trying to create a styled TextBlock whose text resizes based on the ActualHeight property of the TextBlock. The resizing would be done via a converter. <code> ,Is it possible to use a converter within a style?
Best/Easiest way to create ZIP archive in .Net," Which method do you think is the ""best"".Use the System.IO.Packaging namespace?Use interop with the Shell?Third party library for .NET?Interop with open source unmanaged DLL?[I can target Framework 3.5; best = easiest to design, implement, and maintain.]I am mostly interested in why you think the chosen approach is best. <code> ",What is the best/easiest way to create ZIP archive in .NET?
How do I get the name of  aproperty from a property in C# (2.0)," I know I could have an attribute but that's more work than I want to go to... and not general enough.I want to do something like where I'd expect value to equal ""TestProp""but I can't for the life of me find the right reflection methods to write the GetName method...EDIT: Why do I want to do this? I have a class to store settings read from a 'name', 'value' table. This is populated by a generalised method based upon reflection. I'd quite like to write the reverse... FURTHER EDIT: I am just in code, have an instance of Whotsit and I want to get the text string of the 'TestProp' property. It seems kind of weird I know, I can just use the literal ""TestProp"" - or in the case of my class to datatable function I'd be in a foreach loop of PropertyInfos. I was just curious... The original code had string constants, which I found clumsy. <code>  class Whotsit{ private string testProp = ""thingy""; public string TestProp { get { return testProp; } set { testProp = value; } }}...Whotsit whotsit = new Whotsit();string value = GetName(whotsit.TestProp); //precise syntax up for grabs.. /// <summary>/// Populates an object from a datatable where the rows have columns called NameField and ValueField. /// If the property with the 'name' exists, and is not read-only, it is populated from the /// valueField. Any other columns in the dataTable are ignored. If there is no property called/// nameField it is ignored. Any properties of the object not found in the data table retain their/// original values./// </summary>/// <typeparam name=""T"">Type of the object to be populated.</typeparam>/// <param name=""toBePopulated"">The object to be populated</param>/// <param name=""dataTable"">'name, 'value' Data table to populate the object from.</param>/// <param name=""nameField"">Field name of the 'name' field'.</param>/// <param name=""valueField"">Field name of the 'value' field.</param>/// <param name=""options"">Setting to control conversions - e.g. nulls as empty strings.</param>public static void PopulateFromNameValueDataTable<T> (T toBePopulated, System.Data.DataTable dataTable, string nameField, string valueField, PopulateOptions options) { Type type = typeof(T); bool nullStringsAsEmptyString = options == PopulateOptions.NullStringsAsEmptyString; foreach (DataRow dataRow in dataTable.Rows) { string name = dataRow[nameField].ToString(); System.Reflection.PropertyInfo property = type.GetProperty(name); object value = dataRow[valueField]; if (property != null) { Type propertyType = property.PropertyType; if (nullStringsAsEmptyString && (propertyType == typeof(String))) { value = TypeHelper.EmptyStringIfNull(value); } else { value = TypeHelper.DefaultIfNull(value, propertyType); } property.SetValue(toBePopulated, System.Convert.ChangeType(value, propertyType), null); } } }",How do I get the name of a property from a property in C# (2.0)
A new expression requires () or [] after type - C#," The following code for a co-worker throws the following error when he tries to compile it using VS 2008:Error: A new expression requires () or [] after typeCode:MyClass Structure: Sample Source Code: It ""works on my machine"", but not his. Any idea why?UPDATE He is targeting the 3.5 .NET framework He is using the System.Collections.Generics namespaceThe MyClass object does have a constructorUPDATE 1:@Funky81 - Your example and my example were able to compile on my PC.Update 2: Included schema of MyClass in sampleUPDATE 3:@DK - I had my co-worker add the following configuration section to his application: And he received the following compilation error: Unrecognized element 'providerOption'. <code>  public class MyClass{ public MyClass() {} public string Property1 { get; set; } public string Property2 { get; set; }} List<MyClass> x = new List<MyClass>();x.Add(new MyClass { Property1 = ""MyValue"", Property2 = ""Another Value""}); <system.codedom> <compilers> <compiler language=""c#;cs;csharp"" extension="".cs"" warningLevel=""4"" type=""Microsoft.CSharp.CSharpCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089""> <providerOption name=""CompilerVersion"" value=""v3.5""/> <providerOption name=""WarnAsError"" value=""false""/> </compiler> <compiler language=""vb;vbs;visualbasic;vbscript"" extension="".vb"" warningLevel=""4"" type=""Microsoft.VisualBasic.VBCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089""> <providerOption name=""CompilerVersion"" value=""v3.5""/> <providerOption name=""OptionInfer"" value=""true""/> <providerOption name=""WarnAsError"" value=""false""/> </compiler> </compilers> </system.codedom>",A new expression requires () or [] after type compilation error - C#
Difference between method shadowing and overriding in C#?, What's difference between shadowing and overriding a method in C#? <code> ,Difference between shadowing and overriding in C#?
C# Home Automation Library," I'm a C# developer looking to get into home automation as a hobby. I have done a little research, but was wondering if anyone knows of a good .NET library that supports Insteon hardware. I'd rather use Insteon than X10 due to reliability issues.My ultimate objective at this point is to have a simple home automation server (maybe lights and climate control) with a secure ASP.NET web application interface. I'm more interested in actually building it and learning about it rather than finding an existing solution.Thanks for any suggestions or comments.Edit:Thanks for the help, everyone.Does anyone have experience with Z-wave technology? Seems promising - appears to be higher quality hardware, includes a core library, supports .NET, etc. ControlThink appears to have a pretty good controller and SDK.Here's an interesting application to consider: Stall Status: Know Before You Go <code> ",Home Automation Library
parsing JSon using JSon.net," I'm trying to parse some JSON using the JSon.Net library. The documentation seems a little sparse and I'm confused as to how to accomplish what I need. Here is the format for the JSON I need to parse through. The only data I really need from this is the stuff in the objects array. Is it possible for me to parse through that with something like the JSonTextReader and just pull out the things I want, like OBJECT_TYPE and the x and y position? I can't seem to get JSonTextReader to work the way I want it to and I find little to no examples of usage for it. It seems like serializing first then using LINQ with my object would be ideal and every example I find discusses serializing the JSON first, but I'm not sure how I would build an object for this structure. Particularly the objects array which would need to be something like a list of Pairs of attribute and position objects. I have no idea how I would code my object so JSon.Net would know how to serialize that.I thought I could write my own simple parser to just pull out everything I need into an attributes object that I created, but I'm having little luck. Hopefully this all makes sense, any ideas? <code>  { ""displayFieldName"" : ""OBJECT_NAME"", ""fieldAliases"" : { ""OBJECT_NAME"" : ""OBJECT_NAME"", ""OBJECT_TYPE"" : ""OBJECT_TYPE"" }, ""positionType"" : ""point"", ""reference"" : { ""id"" : 1111 }, ""objects"" : [ { ""attributes"" : { ""OBJECT_NAME"" : ""test name"", ""OBJECT_TYPE"" : ""test type"" }, ""position"" : { ""x"" : 5, ""y"" : 7 } } ]}",Parsing JSON using Json.net
how to do subquery in LINQ," Here's an example of the query I'm trying to convert to LINQ: There is a FK relationship between CompanyRolesToUsers and Users, but it's a many to many relationship and CompanyRolesToUsers is the junction table.We already have most of our site built, and we already have most of the filtering working by building Expressions using a PredicateExtensions class.The code for the straightforward filters looks something like this: I'm trying to add a predicate for a subselect in another table. (CompanyRolesToUsers)What I'd like to be able to add is something that does this: Is there any way to do this? It's frustrating because I can write the stored procedure easily, but I'm new to this LINQ thing and I have a deadline. I haven't been able to find an example that matches up, but I'm sure it's there somewhere. <code>  SELECT *FROM UsersWHERE Users.lastname LIKE '%fra%' AND Users.Id IN ( SELECT UserId FROM CompanyRolesToUsers WHERE CompanyRoleId in (2,3,4) ) if (!string.IsNullOrEmpty(TextBoxLastName.Text)) { predicateAnd = predicateAnd.And(c => c.LastName.Contains( TextBoxLastName.Text.Trim())); }e.Result = context.Users.Where(predicateAnd); int[] selectedRoles = GetSelectedRoles();if( selectedRoles.Length > 0 ){ //somehow only select the userid from here ???: var subquery = from u in CompanyRolesToUsers where u.RoleID in selectedRoles select u.UserId; //somehow transform this into an Expression ???: var subExpression = Expression.Invoke(subquery); //and add it on to the existing expressions ???: predicateAnd = predicateAnd.And(subExpression);}",How to do a subquery in LINQ?
xUnit : Assert two List<T> are equal ?," I'm new to TDD and xUnit so I want to test my method that looks something like: Is there any Assert method that I can use ? I think something like this would be nice Is there something like this ? <code>  List<T> DeleteElements<T>(this List<T> a, List<T> b); List<int> values = new List<int>() { 1, 2, 3 };List<int> expected = new List<int>() { 1 };List<int> actual = values.DeleteElements(new List<int>() { 2, 3 });Assert.Exact(expected, actual);",xUnit : Assert two List<T> are equal?
Why WITH Construct is not included in C#. WITH Construct is really cool in VB.NET?," I am C# developer. I really love the curly brace because I came from C, C++ and Java background. However, I also like the other programming languages of the .NET Family such as VB.NET. Switching back and forth between C# and VB.NET is not really that big of deal if you have been programming for a while in .NET. That is very common approach in the company where I work. As C# guy, I really like the XML literal and with keywords provided by the VB.NET compiler. I wish Microsoft had included those features in C# also. I am just curious , what other developer has to say about it! <code> ","Why is the with() construct not included in C#, when it is really cool in VB.NET?"
Code to create capticha code in ASP.NET?," I want to create a CAPTCHA similar to http://www.gigbooks.com/getcaptcha.php this one. But its in PHP an anyone provide me the code to create the same in ASP.NET ?I am using ASP.NET 2.0 (C#)Thanks, <code> ",Code to create CAPTCHA code in ASP.NET?
What is the different between API functions CreateConsole and AttachConsole(-1)?," Could you please explain me, what is the different between API functions AllocConsole and AttachConsole(-1) ? I mean if AttachConsole gets ATTACH_PARENT_PROCESS(DWORD)-1. <code> ",What is the different between API functions AllocConsole and AttachConsole(-1)?
Embed text file into .NET assembly," I would like to embed a text file in an assembly so that I can load the text without having to read it from disk, and so that everything I need is contained within the exe. (So that it's more portable)Is there a way to do this? I assume something with the resource files?And if you can, how do you do it and how do you programaticaly load the text into a string? <code> ",How to embed a text file in a .NET assembly?
"What happend to the ""TagLib#"" library?"," What is the current status of TagLib# (TagLib sharp)?The official homepage www.taglib-sharp.com (link removed due to the NSFW nature of the new site that's parked at that address. -BtL) doesn't exist anymore!I've found the project on ohloh where the old homepage is still linked. Also the download link points to the old site.BUT the ohloh development pages are linked to a mono-project SVN repository, which seems to be under active development (last commit date: 2009/02/20, current version number: 2.0.3.2).Furthermore, on the developer.novell.com wiki the same SVN repo is linked.So, is there any up-to-date homepage or, at least, any up-to-date binary+documentation releases? <code> ","What happened to the ""TagLib#"" library?"
C# equivelant of NaN or IsNumeric," What is the most efficient way of testing an input string whether it contains a numeric value (or conversely Not A Number)? I guess I can use Double.Parse or a regex (see below) but I was wondering if there is some built in way to do this, such as javascript's NaN() or IsNumeric() (was that VB, I can't remember?). <code>  public static bool IsNumeric(this string value){ return Regex.IsMatch(value, ""^\\d+$"");}",What is the C# equivalent of NaN or IsNumeric?
C# equivalent of NaN or IsNumeric," What is the most efficient way of testing an input string whether it contains a numeric value (or conversely Not A Number)? I guess I can use Double.Parse or a regex (see below) but I was wondering if there is some built in way to do this, such as javascript's NaN() or IsNumeric() (was that VB, I can't remember?). <code>  public static bool IsNumeric(this string value){ return Regex.IsMatch(value, ""^\\d+$"");}",What is the C# equivalent of NaN or IsNumeric?
"Delegates and Lambdas and LINQ, Oh My! (A cry for help to Jon Skeet and other C# Gurus)"," As a fairly junior developer, I'm running into a problem that highlights my lack of experience and the holes in my knowledge. Please excuse me if the preamble here is too long.I find myself on a project that involves my needing to learn a number of new (to me) technologies, including LINQ (to OBJECTS and to XML for purposes of this project) among others. Everything I've read to this point suggests that to utilize LINQ I'll need to fully understand the following (Delegates, Anonymous Methods and Lambda Expressions).OK, so now comes the fun. I've CONSUMED delegates in the past as I have worked with the .NET event model, but the majority of the details have been hidden from me (thanks Microsoft!). I understand that on a basic level, delegate instances are pointers to methods (a gross over-simplification, I know).I understand that an anonymous method is essentially an in-line unnamed method generally (if not exclusively) created as a target for a delegate.I also understand that lambdas are used in varying ways to simplfy syntax and can be used to point a simple anonymous method to a delegate.Pardon me if my any of my descriptions are WAY off here, this is the basic level to which I understand these topics.So, the challenge:Can anyone tell me if at least on a basic level if my understanding of these items is even close? I'm not looking for complex esoteric minutiae, just the basics (for now).To what degree do I need to truly understand these concepts before applying LINQ in a project to reasonable effect? I want to understand it fully and am willing to spend the time. I simply may not HAVE the time to fully grok all of this stuff before I need to produce some work.Can anyone point me to some good articles that explain these subjects and apply them to ""real world"" examples so that I can get my head around the basics of the topics and application of them? What I mean by real world, is how might I use this in the context of ""Customers and Invoices"" rather than abstract ""Vectors and Shapes"" or ""Animals and Cows"". The scenario can be somewhat contrived for demonstration purposes, but hopefully not strictly academic. I have found a number of examples on-line and in books, but few seem to be ""Plain English"" explanations.Thank you all in advance for your patience, time and expertise. <code> ","Delegates and Lambdas and LINQ, Oh My!"
quick way to retrieve user information active directory," How to query user information from Active Directory? I have code that works, but it's really slow. I'm using C#.This is the code I currently use: What would faster code look like to get user information from AD? <code>  static void Main(string[] args) { SearchResultCollection sResults = null; try { //modify this line to include your domain name string path = ""LDAP://EXTECH""; //init a directory entry DirectoryEntry dEntry = new DirectoryEntry(path); //init a directory searcher DirectorySearcher dSearcher = new DirectorySearcher(dEntry); //This line applies a filter to the search specifying a username to search for //modify this line to specify a user name. if you want to search for all //users who start with k - set SearchString to ""k"" dSearcher.Filter = ""(&(objectClass=user))""; //perform search on active directory sResults = dSearcher.FindAll(); //loop through results of search foreach (SearchResult searchResult in sResults) { if (searchResult.Properties[""CN""][0].ToString() == ""Adit"") { ////loop through the ad properties //foreach (string propertyKey in //searchResult.Properties[""st""]) //{ //pull the collection of objects with this key name ResultPropertyValueCollection valueCollection = searchResult.Properties[""manager""]; foreach (Object propertyValue in valueCollection) { //loop through the values that have a specific name //an example of a property that would have multiple //collections for the same name would be memberof //Console.WriteLine(""Property Name: "" + valueCollection..ToString()); Console.WriteLine(""Property Value: "" + (string)propertyValue.ToString()); //[""sAMAccountName""][0].ToString(); } //} Console.WriteLine("" ""); } } } catch (InvalidOperationException iOe) { // } catch (NotSupportedException nSe) { // } finally { // dispose of objects used if (sResults != null) sResults.Dispose(); } Console.ReadLine(); }",Quick way to retrieve user information Active Directory
Microsoft Reporting: Setting parameters of subreports in code," How can I set a parameter of a sub-report? I have successfully hooked myself up to the SubreportProcessing event, I can find the correct sub-report through e.ReportPath, and I can add datasources through e.DataSources.Add. But I find no way of adding report parameters??I have found people suggesting to add them to the master report, but I don't really want to do that, since the master report shouldn't have to be connected to the sub-report at all, other than that it is wrapping the sub-report.I am using one report as a master template, printing name of the report, page numbers etc. And the subreport is going to be the report itself. And if I could only find a way to set those report parameters of the sub-report I would be good to go...Clarification: Creating/Defining the parameters is not the problem. The problem is to set their values. I thought the natural thing to do was to do it in the SubreportProcessing event. And the SubreportProcessingEventArgs do in fact have a Parameters property. But it is read only! So how do you use that? How can I set their value? <code> ",Microsoft Reporting: Setting subreport parameters in code
C# - How do I scroll selected treeview node into view, I have a System.Windows.Forms.TreeView docked inside a panel. I am setting a node selected programmatically. What method or property would I use to have the treeview scroll the selected into view? <code> ,Scroll selected TreeView node into view
Leading Zero Date Format C# (asp.net)," I have this function... But I want it with the leading zero still on lower digits (1-9) so the date is 11-09-2009 (mm-dd-yyyy)...Now If I wasn't converting it id use string.Format(""{0:d}"", dateVar) how do I do this in the conversion?***** Solution *****Used a slightly modified version of the answer below (i.e. one that would render). <code>  private string dateConvert(string datDate){ System.Globalization.CultureInfo cultEnGb = new System.Globalization.CultureInfo(""en-GB""); System.Globalization.CultureInfo cultEnUs = new System.Globalization.CultureInfo(""en-US""); DateTime dtGb = Convert.ToDateTime(datDate, cultEnGb.DateTimeFormat); datDate = dtGb.ToString(cultEnUs.DateTimeFormat.ShortDatePattern); return datDate;} Convert.ToDateTime(datDate).ToString(""MM-dd-yyyy"");",Leading Zero Date Format C#
Is there any way of just disposing of an out parameter in c#?," I'm making a call: but I don't actually care about the messages. If it was an input parameter I didn't care about I'd just pass in a null. If it was the return I didn't care about I'd just leave it off. Is there a way to do something similar with an out, or do I need to declare a variable that I will then ignore? <code>  myResult = MakeMyCall(inputParams, out messages);",How to explicitly discard an out argument?
Is there any way of just not bothering with an out parameter in c#?," I'm making a call: but I don't actually care about the messages. If it was an input parameter I didn't care about I'd just pass in a null. If it was the return I didn't care about I'd just leave it off. Is there a way to do something similar with an out, or do I need to declare a variable that I will then ignore? <code>  myResult = MakeMyCall(inputParams, out messages);",How to explicitly discard an out argument?
Shortcut for creating single item list," In C#, is there an inline shortcut to instantiate a List<T> with only one item.I'm currently doing: Having this code everywhere reduces readability. I've thought of using a utility method like this: So I could do: Is there a shorter / cleaner way?Thanks. <code>  new List<string>( new string[] { ""title"" } )) public static List<T> SingleItemList<T>( T value ){ return (new List<T>( new T[] { value } ));} SingleItemList(""title"");",Shortcut for creating single item list in C#
Can I dynamically hadd HTML within a div tag from C# on load event? ," Mind you, I am using master pages, but can I locate a div within the page and throw some html in there? Thanks.  <code> ",Can I dynamically add HTML within a div tag from C# on load event? 
What is Linq?," What is LINQ? I know it's for databases, but what does it do? <code> ",What is LINQ and what does it do?
What is Linq and what does it do?," What is LINQ? I know it's for databases, but what does it do? <code> ",What is LINQ and what does it do?
Is there a quick way to remove using statements C#," Is there a quick way to determine whether you are using certain namespaces in your application. I want to remove all the unneccessary using statements like using System.Reflection and so on, but I need a way to determine if I am using those libraries or not. I know that the tool Resharper does this for you, but is there a quick and dirty and Free way to do this? <code> ",Is there a quick way to remove using statements in C#?
Is there a quick way to remove using statements in C#," Is there a quick way to determine whether you are using certain namespaces in your application. I want to remove all the unneccessary using statements like using System.Reflection and so on, but I need a way to determine if I am using those libraries or not. I know that the tool Resharper does this for you, but is there a quick and dirty and Free way to do this? <code> ",Is there a quick way to remove using statements in C#?
Change the node names in an XML file using c#," I have a huge bunch of XML files with the following structure: I need to change the each of the ""Content"" node names to StuffxContent; basically prepend the parent node name to the content node's name.I planned to use the XMLDocument class and figure out a way, but thought I would ask if there were any better ways to do this. <code>  <Stuff1> <Content>someContent</name> <type>someType</type></Stuff1><Stuff2> <Content>someContent</name> <type>someType</type></Stuff2><Stuff3> <Content>someContent</name> <type>someType</type></Stuff3>......",Change the node names in an XML file using C#
reinterpret_cast in in C#," I'm looking for a way to reinterpret an array of type byte[] as a different type, say short[]. In C++ this would be achieved by a simple cast but in C# I haven't found a way to achieve this without resorting to duplicating the entire buffer.Any ideas? <code> ",reinterpret_cast in C#
C#/.NET: Replace host in Uri," What is the nicest way of replacing the host-part of an Uri using .NET?I.e.: System.Uri does not seem to help much. <code>  string ReplaceHost(string original, string newHostName);//...string s = ReplaceHost(""http://oldhostname/index.html"", ""newhostname"");Assert.AreEqual(""http://newhostname/index.html"", s);//...string s = ReplaceHost(""http://user:pass@oldhostname/index.html"", ""newhostname"");Assert.AreEqual(""http://user:pass@newhostname/index.html"", s);//...string s = ReplaceHost(""ftp://user:pass@oldhostname"", ""newhostname"");Assert.AreEqual(""ftp://user:pass@newhostname"", s);//etc.",Replace host in Uri
Masked TextBox in WPF, Do you know any freely available WPF component for using masks (regex) in textbox? <code> ,Where can I find a free masked TextBox in WPF?
Cool uses of Attributes (CLR)?," What are some cool applications for custom attributes in CLR/C# code that you've done or heard about? Also interesting new uses of the standard attributes is also ok!Edit: Since Java's annotations seems to be the same as CLR's attrbutes, uses of Java annotations is also valid. <code> ",Cool uses of Attributes or Annotations (CLR or Java)?
Advantages of Extension Methods," A ""non-believer"" of C# was asking me what the purpose to extension methods was. I explained that you could then add new methods to objects that were already defined, especially when you don't own/control the source to the original object.He brought up ""Why not just add a method to your own class?"" We've been going round and round (in a good way). My general response is that it is another tool in the toolbelt, and his response is it is a useless waste of a tool... but I thought I'd get a more ""enlightened"" answer.What are some scenarios that you've used extension methods that you couldn't have (or shouldn't have) used a method added on to your own class? <code> ",What Advantages of Extension Methods have you found?
How do you Read SharePoint Lists Programatically?," I currently use the Linq to SharePoint to retrieve data from several SharePoint lists.This is my current preferred method of coding my way from ASP.NET and WinForms to retrieve this data. My only issue with this project:I have to manually generate the SPML file and add this to the development environment, compile it in the project, and only then I am able to use it to connect to the List.This is great for projects that require connecting to the one and the same list always.But I am having users creating new workspaces (sites) with each its own List from which I want to retrieve data automagically (same as linq to sharepoint does, but not statically).Can you recommend your preferred way of accessing data from several SharePoint Lists and sites in C# WinForms and/or ASP.NET outside an actual SharePoint environment where I can specify the a new source site and list at run time? <code> ",How do you Read SharePoint Lists Programmatically?
C#/.NET: Blocking and waiting for an event," It sometimes want to block my thread while waiting for a event to occur.I usually do it something like this: However, it seems that this should be something that I could extract to a common class (or perhaps even something that already exists in the framework).I would like to be able to do something like this: But I can't really find a way to construct such a class (I can't find a good valid way to pass the event as an argument). Can anyone help?To give an example of why this can be useful, consider something like this: This is much more concise and readable than the equivalent code written with the logic spread out between many methods. But to implement WaitForUsbStickOrCancel(), WaitForUsbStickToBeRemoved and WaitUntilUserPressesDone() (assume that the we get an event when usb sticks are inserted or removed) I need to reimplement ""EventWaiter"" each time. Of course you have to be careful to never run this on the GUI-thread, but sometimes that is a worthwhile tradeoff for the simpler code.The alternative would look something like this: I find that much harder to read. Admittedly, it is far from always that the flow will be so linear, but when it is, I like the first style.It is comparable to using ShowMessage() and Form.ShowDialog() - they also block until some ""event"" occurs (though they will run a message-loop if they are called on the gui-thread). <code>  private AutoResetEvent _autoResetEvent = new AutoResetEvent(false);private void OnEvent(object sender, EventArgs e){ _autoResetEvent.Set();}// ...button.Click += OnEvent;try{ _autoResetEvent.WaitOne();}finally{ button.Click -= OnEvent;} EventWaiter ew = new EventWaiter(button.Click);ew.WaitOne();EventWaiter ew2 = new EventWaiter(form.Closing);ew2.WaitOne(); var status = ShowStatusForm();status.ShowInsertUsbStick();bool cancelled = WaitForUsbStickOrCancel();if(!cancelled){ status.ShowWritingOnUsbStick(); WriteOnUsbStick(); status.AskUserToRemoveUsbStick(); WaitForUsbStickToBeRemoved(); status.ShowFinished();}else{ status.ShowCancelled();}status.WaitUntilUserPressesDone(); var status = ShowStatusForm();status.ShowInsertUsbStick();usbHandler.Inserted += OnInserted;status.Cancel += OnCancel;//...void OnInserted(/*..*/){ usbHandler.Inserted -= OnInserted; status.ShowWritingOnUsbStick(); MethodInvoker mi = () => WriteOnUsbStick(); mi.BeginInvoke(WritingDone, null);}void WritingDone(/*..*/){ /* EndInvoke */ status.AskUserToRemoveUsbStick(); usbHandler.Removed += OnRemoved;}void OnRemoved(/*..*/){ usbHandler.Removed -= OnRemoved; status.ShowFinished(); status.Done += OnDone;}/* etc */",Blocking and waiting for an event
Why it is not posible to define generic indexers in .NET?, Why can't you create a generic indexer in .NET?the following code throws a compiler error: Does this mean you can't create a generic indexer for a generic member collection? <code>  public T this<T>[string key]{ get => /* Return generic type T. */},Why it is not possible to define generic indexers in .NET?
C# Is String in Array," What would be the best way to look in a string[] to see if it contains a element. This was my first shot at it. But perhaps there is something that I am overlooking. The array size will be no larger than 200 elements. <code>  bool isStringInArray(string[] strArray, string key){ for (int i = 0; i <= strArray.Length - 1; i++) if (strArray[i] == key) return true; return false;}",Is string in array?
use decimal values as attribute params in c# ?," I've been trying to use decimal values as params for a field attribute but I get a compiler error.I found this blog post link saying it wasn't possible in .NET to use then, does anybody know why they choose this or how can I use decimal params? <code> ",use decimal values as attribute params in c#?
Precedence of C# ?? operator," I've just tried the following, the idea being to concatenate the two strings, substituting an empty string for nulls. -- Debug (amusing that ? is print, doesn't exactly help readability...) -> ""Hello""Correct is: I was kind of expecting ""Hello World"", or just ""World"" if a is null. Obviously this is todo with operator precedence and can be overcome by brackets, is there anywhere that documents the order of precedence for this new operator.(Realising that I should probably be using stringbuilder or String.Concat)Thanks. <code>  string a=""Hello"";string b="" World""; ? a ?? """" + b ?? """" ? (a??"""")+(b??"""")""Hello World""",What is the operator precedence of C# null-coalescing (??) operator?
How to simulate windows shutdown while debugging (c#/.net winforms app)?," I have an issue with my application when Windows shuts down - my app isn't exiting nicely, resulting in the End Task window being displayed. How can I use the debugger to see what's going on? Is there a way to send the Windows shutdown message(s) to my application so it thinks Windows is shutting down, so I can see exactly how it behaves? <code> ",How to simulate Windows shutdown for debugging?
How to simulate windows shutdown while debugging?," I have an issue with my application when Windows shuts down - my app isn't exiting nicely, resulting in the End Task window being displayed. How can I use the debugger to see what's going on? Is there a way to send the Windows shutdown message(s) to my application so it thinks Windows is shutting down, so I can see exactly how it behaves? <code> ",How to simulate Windows shutdown for debugging?
Why should i learn C#?, I want to know why I should learn C#? What features does C# have that Java does not? <code> ,Why should I learn C#?
Are the functional programming features provided in C# rich enough? What's missing," What are the primary differences between LISP and C# with regards to functional programming? In specific, if a LISP programmer was to switch to using C#, what are the features they are most likely to miss? <code> ",Functional Programming in C# vs LISP
How can I make an Observable Hashset in C# ?," Currently I am using an ObservableCollection within a WPF application, the application is an implementation of Conway's Game of life and works well for about 500 cells but after that it begins to slow down significantly. I originally wrote the application using a HashSet but couldn't find any way to bind the cells to a canvas.Is there a way to get my HashSet to notify its binding object of changes? My Cell class is a simple integer X,Y pair, if the pair exists the cell is alive otherwise dead. The Cell implements INotifyPropertyChanged and overrides GetHashCode and Equals. I couldn't get the cell to display any changes, just the cells present immediately after loading. Is there any way to Bind a Hashset to items on a Canvas? <code> ",How can I make an Observable Hashset in C#?
What is the fastest way to programatically check the well-formedness of XML files in C#?," I have large batches of XHTML files that are manually updated. During the review phase of the updates I would like to programmatically check the well-formedness of the files.I am currently using a XmlReader, but the time required on an average CPU is much longer than I expected.The XHTML files range in size from 4KB to 40KB and verifying takes several seconds per file. Checking is essential but I would like to keep the time as short as possible as the check is performed while files are being read into the next process step.Is there a faster way of doing a simple XML well-formedness check? Maybe using external XML libraries?I can confirm that validating ""regular"" XML based content is lightning fast using the XmlReader, and as suggested the problem seems to be related to the fact that the XHTML DTD is read each time a file is validated. Note that in addition to the DTD, corresponding .ent files (xhtml-lat1.ent, xhtml-symbol.ent, xhtml-special.ent) are also downloaded.Since ignoring the DTD completely is not really an option for XHTML as the well-formedness is closely linked to allowed HTML entities (e.g., a &nbsp; will promptly introduce validation errors when we ignore the DTD).The problem was solved by using a custom XmlResolver as suggested, in combination with local (embedded) copies of both the DTD and entity files. I will post the solution here once I cleaned up the code <code>  <!DOCTYPE html PUBLIC ""-//W3C//DTD XHTML 1.0 Transitional//EN"" ""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"">",What is the fastest way to programmatically check the well-formedness of XML files in C#?
What is slicing in c++?," Can C++ slicing apply to other languages too, like Java/C#? <code> ",C++ slicing in Java / C#
How do I get  the header height of a Listview - c#, Can somebody tell me how to get the header height of a ListView. <code> ,How do I get the header height of a Listview
Windows Service Stops Automatically," I made a Window service and let it work automatically and under localsystem account, when the service starts it fires this message for me and then stops The [service name] service on local computer started and then stopped. Some Services stop automatically if they are not in use by another services or programs.What's the problem and what's the solution? <code> ",Windows service stops automatically
Embedding a File Explorer instance in a WinForms app form," My (C#, .NET 3.5) application generates files and, in addition to raising events that can be caught and reacted to, I want to display the target folder to the user in a form. The file-list is being shown within the same form as other information.I'm using an instance of the WebBrowser control (System.Windows.Forms.WebBrowser), then navigating to the folder. This shows some default view of the explorer window, with the file summary panel on the left and the files in the 'Tiles' (large icon and text) view.For example, I'd like to suppress the panel and to view the file list in the Details view. The user can get to this via a right-click, context menu, but I'd like it to come up automatically.I'd rather not have to build my own TreeView, DataGridView or whatever; the WebBrowser control does all the updating and re-sorting and whatnot 'for free'.Is there a better way? A different control to use or some additional arguments to pass to the control?And if I could trap events (for example, files being selected/renamed/double-clicked, etc.) then all the better! <code>  wb.Navigate(@""c:\path\to\folder\"");",Embedding a File Explorer instance in a Windows Forms application form
c# pass through mouse events to parent control," Environment: .NET Framework 2.0, VS 2008.I am trying to create a subclass of certain .NET controls (label, panel) that will pass through certain mouse events (MouseDown, MouseMove, MouseUp) to its parent control (or alternatively to the top-level form). I can do this by creating handlers for these events in instances of the standard controls, e.g.: I cannot move the event handler into a subclass of the control, because the methods that raise the events in the parent control are protected and I don't have a qualifier for the parent control: Cannot access protected member System.Windows.Forms.Control.OnMouseDown(System.Windows.Forms.MouseEventArgs) via a qualifier of type System.Windows.Forms.Control; the qualifier must be of type TheProject.NoCaptureLabel (or derived from it).I am looking into overriding the WndProc method of the control in my sub-class, but hopefully someone can give me a cleaner solution. <code>  public class TheForm : Form{ private Label theLabel; private void InitializeComponent() { theLabel = new Label(); theLabel.MouseDown += new MouseEventHandler(theLabel_MouseDown); } private void theLabel_MouseDown(object sender, MouseEventArgs e) { int xTrans = e.X + this.Location.X; int yTrans = e.Y + this.Location.Y; MouseEventArgs eTrans = new MouseEventArgs(e.Button, e.Clicks, xTrans, yTrans, e.Delta); this.OnMouseDown(eTrans); }}",Pass-through mouse events to parent control
WPF Image to Byte[]," I'm trying to convert from System.Windows.Controls.Image to byte[] and I didnt know which method from Image class could help in this scenary, by the way I really dont know what should I do, cause in my LINQ model the field appears as Binary type, I have to change this if I want to save it like a byte[] type?I found code posted here, but without using WPF:  <code>  Bitmap newBMP = new Bitmap(originalBMP, newWidth, newHeight);System.IO.MemoryStream stream = new System.IO.MemoryStream();newBMP.Save(stream, System.Drawing.Imaging.ImageFormat.Bmp);PHJProjectPhoto myPhoto = new PHJProjectPhoto { ProjectPhoto = stream.ToArray(), // <<--- This will convert your stream to a byte[] OrderDate = DateTime.Now, ProjectPhotoCaption = ProjectPhotoCaptionTextBox.Text, ProjectId = selectedProjectId};",WPF Image to byte[]
Hiw to bind LINQ data to dropdownlist, The last two lines of this code do not work correctly -- the results are coming back from the LINQ query. I'm just not sure how to successfully bind the indicated columns in the results to the textfield and valuefield of the dropdownlist: <code>  protected void BindMarketCodes() { List<lkpMarketCode> mcodesList = new List<lkpMarketCode>(); LINQOmniDataContext db = new LINQOmniDataContext(); var mcodes = from p in db.lkpMarketCodes orderby 0 select p; mcodesList = mcodes.ToList<lkpMarketCode>(); //bind to Country COde droplist dd2.DataSource = mcodesList; dd2.DataTextField = mcodesList[0].marketName; dd2.DataValueField = mcodesList[0].marketCodeID.ToString(); },How to bind LINQ data to dropdownlist
C# generic list <T> how to get the type of T?," Let's say I have a generic member in a class or method, like so: When I instantiate the class, the T becomes MyTypeObject1, so the class has a generic list property: List<MyTypeObject1>. The same applies to a generic method in a non-generic class: I would like to know what type of objects the list of my class contains. So what type of T does the list property called Bar or the local variable baz contain?I cannot do Bar[0].GetType(), because the list might contain zero elements. How can I do it? <code>  public class Foo<T>{ public List<T> Bar { get; set; } public void Baz() { // get type of T } } public class Foo{ public void Bar<T>() { var baz = new List<T>(); // get type of T }}",How to get the type of T from a member of a generic class or method
How to get the type of T from a generic List<T>," Let's say I have a generic member in a class or method, like so: When I instantiate the class, the T becomes MyTypeObject1, so the class has a generic list property: List<MyTypeObject1>. The same applies to a generic method in a non-generic class: I would like to know what type of objects the list of my class contains. So what type of T does the list property called Bar or the local variable baz contain?I cannot do Bar[0].GetType(), because the list might contain zero elements. How can I do it? <code>  public class Foo<T>{ public List<T> Bar { get; set; } public void Baz() { // get type of T } } public class Foo{ public void Bar<T>() { var baz = new List<T>(); // get type of T }}",How to get the type of T from a member of a generic class or method
How to get the type of T from a generic List<T>?," Let's say I have a generic member in a class or method, like so: When I instantiate the class, the T becomes MyTypeObject1, so the class has a generic list property: List<MyTypeObject1>. The same applies to a generic method in a non-generic class: I would like to know what type of objects the list of my class contains. So what type of T does the list property called Bar or the local variable baz contain?I cannot do Bar[0].GetType(), because the list might contain zero elements. How can I do it? <code>  public class Foo<T>{ public List<T> Bar { get; set; } public void Baz() { // get type of T } } public class Foo{ public void Bar<T>() { var baz = new List<T>(); // get type of T }}",How to get the type of T from a member of a generic class or method
How to get the type of T from a member of a generic class or method?," Let's say I have a generic member in a class or method, like so: When I instantiate the class, the T becomes MyTypeObject1, so the class has a generic list property: List<MyTypeObject1>. The same applies to a generic method in a non-generic class: I would like to know what type of objects the list of my class contains. So what type of T does the list property called Bar or the local variable baz contain?I cannot do Bar[0].GetType(), because the list might contain zero elements. How can I do it? <code>  public class Foo<T>{ public List<T> Bar { get; set; } public void Baz() { // get type of T } } public class Foo{ public void Bar<T>() { var baz = new List<T>(); // get type of T }}",How to get the type of T from a member of a generic class or method
What .net library can I count on," I am writing an app to discover what features exist on a pc. The user would go to a web page, download the app and execute it (with all the appropriate warnings, this is not spyware). The app would use the standard MS api to determine such things as connection speed, installed memory, firewall health, etc. Writing the app is not a problem, I could use Scripting Host, C#, C++, etc. The question is, if I chose C# is there any guarantee that a certain flavor of windows would have .net installed? The target pc is XP SP2 or better and Vista.Thanks for the help. <code> ",Which versions of .NET Framework I can count on?
How can i list colors with WPF?," How can I get list of all colors I can pick in Visual Studio Designer (which is System.Windows.Media.Colors, but that isn't a collection) and put them into my own ComboBox using WPF and XAML markup?  <code> ",How can I list colors in WPF with XAML?
How can I list colors with WPF?," How can I get list of all colors I can pick in Visual Studio Designer (which is System.Windows.Media.Colors, but that isn't a collection) and put them into my own ComboBox using WPF and XAML markup?  <code> ",How can I list colors in WPF with XAML?
WPF TextBox DataBind on EnterKey press," The default databinding on TextBox is TwoWay and it commits the text to the property only when TextBox lost its focus.Is there any easy XAML way to make the databinding happen when I press the Enter key on the TextBox?. I know it is pretty easy to do in the code behind, but imagine if this TextBox is inside some complex DataTemplate. <code> ",Bind TextBox on Enter-key press
ASP.net page without a codebehind," I have an ASP.Net page with a C# code behind.However, I've been asked to not use a code behind - so that it will be easier to deploy in SharePoint. Is there a way to include the C# code in the ASP.Net page, without using a separate code behind file? <code> ",ASP.net page without a code behind
Create a For Loop C#, I need a for loop which will complete all its Iterations even if there's any exception in any one of the iterations. <code> ,How handle an exception in a loop and keep iterating?
C#: No implicit conversion between 'lambda expression' and 'lambda expression' ??," Type of conditional expression cannot be determined because there is no implicit conversion between 'lambda expression' and 'lambda expression'Say whaat? Could someone please explain this compile error to me? This is the code that produces it: This does not: And neither do this: <code>  protected override Func<System.IO.Stream> GetStream() { return someBool ? () => EmbeddedResourceExtractor.GetFile(""SomeFile1.ext"") : () => EmbeddedResourceExtractor.GetFile(""SomeFile2.ext""); } protected override Func<System.IO.Stream> GetStream() { return () => EmbeddedResourceExtractor.GetFile(""SomeFile1.ext""); } protected override Func<System.IO.Stream> GetStream() { if(someBool) return () => EmbeddedResourceExtractor.GetFile(""SomeFile1.ext""); return () => EmbeddedResourceExtractor.GetFile(""SomeFile2.ext""); }",No implicit conversion between 'lambda expression' and 'lambda expression'?
C#: No implicit conversion between 'lambda expression' and 'lambda expression'?," Type of conditional expression cannot be determined because there is no implicit conversion between 'lambda expression' and 'lambda expression'Say whaat? Could someone please explain this compile error to me? This is the code that produces it: This does not: And neither do this: <code>  protected override Func<System.IO.Stream> GetStream() { return someBool ? () => EmbeddedResourceExtractor.GetFile(""SomeFile1.ext"") : () => EmbeddedResourceExtractor.GetFile(""SomeFile2.ext""); } protected override Func<System.IO.Stream> GetStream() { return () => EmbeddedResourceExtractor.GetFile(""SomeFile1.ext""); } protected override Func<System.IO.Stream> GetStream() { if(someBool) return () => EmbeddedResourceExtractor.GetFile(""SomeFile1.ext""); return () => EmbeddedResourceExtractor.GetFile(""SomeFile2.ext""); }",No implicit conversion between 'lambda expression' and 'lambda expression'?
Delegates: Predicate Action Func, Can someone provide a good explanation (hopefully with examples) of these 3 most important delegates:PredicateActionFunc <code> ,Delegates: Predicate vs. Action vs. Func
How can I create a temp file with a specific extension with .net ?," I need to generate a unique temporary file with a .csv extension.What I do right now is However, this doesn't guarantee that my .csv file will be unique.I know the chances I ever got a collision are very low (especially if you consider that I don't delete the .tmp files), but this code doesn't looks good to me.Of course I could manually generate random file names until I eventually find a unique one (which shouldn't be a problem), but I'm curious to know if others have found a nice way to deal with this problem. <code>  string filepath = System.IO.Path.GetTempFileName().Replace("".tmp"", "".csv"");",How can I create a temp file with a specific extension with .NET?
How can I create a temp file with a specific extension with .net?," I need to generate a unique temporary file with a .csv extension.What I do right now is However, this doesn't guarantee that my .csv file will be unique.I know the chances I ever got a collision are very low (especially if you consider that I don't delete the .tmp files), but this code doesn't looks good to me.Of course I could manually generate random file names until I eventually find a unique one (which shouldn't be a problem), but I'm curious to know if others have found a nice way to deal with this problem. <code>  string filepath = System.IO.Path.GetTempFileName().Replace("".tmp"", "".csv"");",How can I create a temp file with a specific extension with .NET?
Dynamic array in c#, Is there any method for creating a dynamic array in C#?  <code> ,Dynamic array in C#
Get RTF from RichTextBox," How do I get the text in RTF of a RichTextBox? I'm trying to get like this, but the property does not exist. <code>  RichTextBox rtb = new RichTextBox();string s = rtb.Rtf;",How to get RTF from RichTextBox
C# Work out min and hours," I have a minute value and i want to have to 2 string values one with how many hours and the other with the minutes, e.g.:Value - 121 minutesstring hours = 2string minutes = 1Value - 58 minutesstring hours = 0string minutes = 58How can I work this out in C#? <code> ",Work out min and hours
Coding guides: How do you spilt up your large source files?," The project I'm working on has just hit 4200 lines in the main C# file, which is causing IntelliSense to take a few seconds (sometimes up to 6 or so) to respond, during which Visual Studio locks up. I'm wondering how everyone else splits their files and whether there's a consensus.I tried to look for some guides and found Google's C++ guide, but I couldn't see anything about semantics such as function sizes and file sizes; maybe it's there - I haven't looked at it for a while.So how do you split your files? Do you group your methods by the functions they serve? By types (event handlers, private/public)? And at what size limit do you split functions?To clarify, the application in question handles data - so its interface is a big-ass grid, and everything revolves around the grid. It has a few dialogs forms for management, but it's all about the data. The reason why it's so big is that there is a lot of error checking, event handling, and also the grid set up as master-detail with three more grids for each row (but these load on master row expanded). I hope this helps to clarify what I'm on about. <code> ",Coding guides: How do you split up your large source files?
Diferent orientation ina Multiple page PrintDocument (How to)," I have a PrintDocument that has several pages.One page in that document must be in a Landscape orientations instead of Portrail.As the PrintPage event is triggered for each page on the document... at the very begining of that event handler I set the PrintPageEventArgs.PageSettings.Landscape to true.That doesn't works on THAT page... but I can see that Landscape is set to true and taked into account in the NEXT page.I assume that somehow... after the event is triggered for a certain page you are not able to change the page orientation. That is more of less logic if you think it... but HOW COULD I SET THAT FLAG before EVENT fires in a multiple page PrintDocument? Note: I don't know in advance if the ""next"" page will going to actually need a Landscape orientation. <code> ",Different orientation in a Multiple page PrintDocument (How to)
Different orientation ina Multiple page PrintDocument (How to)," I have a PrintDocument that has several pages.One page in that document must be in a Landscape orientations instead of Portrail.As the PrintPage event is triggered for each page on the document... at the very begining of that event handler I set the PrintPageEventArgs.PageSettings.Landscape to true.That doesn't works on THAT page... but I can see that Landscape is set to true and taked into account in the NEXT page.I assume that somehow... after the event is triggered for a certain page you are not able to change the page orientation. That is more of less logic if you think it... but HOW COULD I SET THAT FLAG before EVENT fires in a multiple page PrintDocument? Note: I don't know in advance if the ""next"" page will going to actually need a Landscape orientation. <code> ",Different orientation in a Multiple page PrintDocument (How to)
Pass event to function in C#," I am looking to pass an event to a helper function. This function will attach a method to the event. However, I am having trouble properly passing the event. I have tried passing a EventHandler<TEventArgs>. It compiles, but events are not attached (but are still added; it seems a copy of the event handler is made).For example, if I have this: And the helper function: And the caller: <code>  public event EventHandler<EventArgs> MyEvent; public static void MyHelperFunction<TEventArgs>(EventHandler<TEventArgs> eventToAttachTo){ eventToAttachTo += (sender, e) => { Console.WriteLine(""Hello world""); };} MyHelperFunction(MyEvent);MyEvent(null, new EventArgs()); // Does nothing.",How can I pass an event to a function in C#?
Omitting namespace when serializing an object?," The code looks like this: The resulting serialized document includes namespaces, like so: To remove the xsi and xsd namespaces, I can follow the answer from How to serialize an object to XML without getting xmlns=?.I want my message tag as <message> (without any namespace attributes). How can I do this? <code>  StringBuilder builder = new StringBuilder();XmlWriterSettings settings = new XmlWriterSettings();settings.OmitXmlDeclaration = true;using (XmlWriter xmlWriter = XmlWriter.Create(builder, settings)){ XmlSerializer s = new XmlSerializer(objectToSerialize.GetType()); s.Serialize(xmlWriter, objectToSerialize);} <message xmlns:xsi=\""http://www.w3.org/2001/XMLSchema-instance\"" xmlns:xsd=\""http://www.w3.org/2001/XMLSchema\"" xmlns=""urn:something""> ...</message>",Omitting all xsi and xsd namespaces when serializing an object in .NET?
Omitting xml namespaces when serializing an object?," The code looks like this: The resulting serialized document includes namespaces, like so: To remove the xsi and xsd namespaces, I can follow the answer from How to serialize an object to XML without getting xmlns=?.I want my message tag as <message> (without any namespace attributes). How can I do this? <code>  StringBuilder builder = new StringBuilder();XmlWriterSettings settings = new XmlWriterSettings();settings.OmitXmlDeclaration = true;using (XmlWriter xmlWriter = XmlWriter.Create(builder, settings)){ XmlSerializer s = new XmlSerializer(objectToSerialize.GetType()); s.Serialize(xmlWriter, objectToSerialize);} <message xmlns:xsi=\""http://www.w3.org/2001/XMLSchema-instance\"" xmlns:xsd=\""http://www.w3.org/2001/XMLSchema\"" xmlns=""urn:something""> ...</message>",Omitting all xsi and xsd namespaces when serializing an object in .NET?
Omitting all xml namespaces when serializing an object?," The code looks like this: The resulting serialized document includes namespaces, like so: To remove the xsi and xsd namespaces, I can follow the answer from How to serialize an object to XML without getting xmlns=?.I want my message tag as <message> (without any namespace attributes). How can I do this? <code>  StringBuilder builder = new StringBuilder();XmlWriterSettings settings = new XmlWriterSettings();settings.OmitXmlDeclaration = true;using (XmlWriter xmlWriter = XmlWriter.Create(builder, settings)){ XmlSerializer s = new XmlSerializer(objectToSerialize.GetType()); s.Serialize(xmlWriter, objectToSerialize);} <message xmlns:xsi=\""http://www.w3.org/2001/XMLSchema-instance\"" xmlns:xsd=\""http://www.w3.org/2001/XMLSchema\"" xmlns=""urn:something""> ...</message>",Omitting all xsi and xsd namespaces when serializing an object in .NET?
ASP.NET / C# what is the best way to recursively copy contents, What is the best way to recursively copy a folder's content into another folder using C# and ASP.NET? <code> ,What is the best way to recursively copy contents in C#?
Youtube API integration ASP.net - upload video with a single page," we are trying to use the Google YouTube API to upload videos from our website to YouTube through the browser directly. The API works in two steps, in the first step we need to create an Video object with all the metadata like title,tags,description, category etc. Then we need to send a request with this object to YouTube and get a Token object generated as a response. This token object has a Token Value and a Token URL as its members. In second step they suggest that we should create a Form with the action attribute set to the Token URL. This form should have a file upload control and a hidden field with the Token Value as its value. When this form is posted, it would upload the video to YouTube.This works great if we have it as a two step process, asking users for the metadata first and then redirecting them on to second page for the actual video upload. However, we are trying to accomplish this in a single page, appearing as a single step to the user. We have a MasterPage with the 'aspnetForm' specified in it, because of which we cant have another form with runat='server' property. We have tried modifying the aspnetFrom's action attribute using JavaScript/code-behind but it stays the same, whatever we do.We have also tried to put another nested form, whose action tag would be set on the button click event, after the first response from YouTube with token is received. But even this doesn't work, as the form isn't created at the time this method is called.. We have tried several approaches but none seems to work.. any suggestions on this would be great.If you have any more questions to understand the situation clearly.. please let me know.. Update:Thanks for the responses guys.We changed the business logic a little bit to resolve the issue. It was long back and I am not looking for a resolution as of now.. However, the question is still open and getting responses. I really appreciate all the help and hence, would leave the question open for any further discussions. <code> ",YouTube API integration ASP.NET - upload video with a single page
Is there a C# case insensitive equals operator?, I know that the following is case sensitive: So is there an operator which will compare two strings in an insensitive manner? <code>  if (StringA == StringB) {,Is there an equals operator in C# that is case insensitive?
In C# why is string a reference type that behaves like a value type?, A String is a reference type even though it has most of the characteristics of a value type such as being immutable and having == overloaded to compare the text rather than making sure they reference the same object.Why isn't string just a value type then? <code> ,"In C#, why is String a reference type that behaves like a value type?"
Getting the IP address of server in C#," How do I get the IP address of the server that calls my ASP.NET page? I have seen stuff about a Response object, but am very new at c#. Thanks a ton. <code> ",Getting the IP address of server in ASP.NET?
Linq expression trees," In the following code: ...what is the meaning of (i & 1) == 1? <code>  Expression<Func<int, bool>> isOdd = i => (i & 1) == 1;",What is the meaning of the & operator?
& Operator," In the following code: ...what is the meaning of (i & 1) == 1? <code>  Expression<Func<int, bool>> isOdd = i => (i & 1) == 1;",What is the meaning of the & operator?
What is the meaning of this expression?," In the following code: ...what is the meaning of (i & 1) == 1? <code>  Expression<Func<int, bool>> isOdd = i => (i & 1) == 1;",What is the meaning of the & operator?
What is the meaning of & (single and / single anpersand operator) in C#?," In the following code: ...what is the meaning of (i & 1) == 1? <code>  Expression<Func<int, bool>> isOdd = i => (i & 1) == 1;",What is the meaning of the & operator?
Array contains," I have two arrays. For example: What is the best way to determine if they have the same elements? <code>  int[] Array1 = new[] {1, 2, 3, 4, 5, 6, 7, 8, 9};int[] Array2 = new[] {9, 1, 4, 5, 2, 3, 6, 7, 8};",Testing equality of arrays in C#
Testing Equality of Arrays in C#," I have two arrays. For example: What is the best way to determine if they have the same elements? <code>  int[] Array1 = new[] {1, 2, 3, 4, 5, 6, 7, 8, 9};int[] Array2 = new[] {9, 1, 4, 5, 2, 3, 6, 7, 8};",Testing equality of arrays in C#
Delete dynamically generated PDF file immediately after it has been dispalyed to user," I'm creating a PDF file on the fly using ITextSharp and ASP.NET 1.1. My process is as follows -Create file on server Redirect browser to newly created PDFfile so it is displayed to userWhat I'd like to do is delete the PDF from the server as soon it is displayed in the users browser. The PDF file is large so it is not an option to hold it in memory, an initial write to the server is required. I'm currently using a solution that periodically polls for files then deletes them, but I'd prefer a solution that deletes the file immediately after it has been downloaded to the client machine. Is there a way to do this? <code> ",Delete dynamically generated PDF file immediately after it has been displayed to user
How to create a new application pool in a Web Setup Project," I need to deploy my web service. It needs to run in a separate application pool in IIS with its own credentials. Is it possible to do this by using a Web Setup Project in VS 2008?By default, I seem to only be able to choose an existing application pool. <code> ",How can I create a new application pool in a Web Setup Project?
Inner Join in DataTable in C#," Let T1 and T2 are DataTables with following fields I need the joint table How this can be done in C# code in a simple way? Thanks. <code>  T1(CustID, ColX, ColY)T2(CustID, ColZ) TJ (CustID, ColX, ColY, ColZ)",Inner join of DataTables in C#
using linked list," Another programmer was mentioning that they haven't found a use case for using a linked list data structure in any professional software in his career. I couldn't think of any good examples off the top of my head. He is mostly a C# and Java developerCan anyone give some examples where this was the correct data structure to solve a particular real world problem?Related: What is a practical, real world example of the Linked List? <code> ",What are real world examples of when Linked Lists should be used?
What is the longest legal statment block you can make with only C# keywords?," I was writing some code in C#, and I found myself writing: when I noticed that both the return and the new were both C# keywords. So I wondered what is the longest legal sequence of keywords in C#. All I could think of is: Where internal static override void are all keywords. Can you think of a longer sequence of keywords?Note: There's really no point to the question. I'm just hoping to pour more some fun on the fire :-) <code>  return new MyClass(... internal static override void MyFunc(...",What is the longest legal statement block you can make with only C# keywords?
"C#: Checking if two Expression<Func<T, bool>> are the same"," Is it possible to find out if two expressions are the same? Like given the following four expressions: Then, at least we can see that:a == ba != ca != dBut can I do anything to find this out in my code? Took a peek in the msdn library, where it says that Equals: Determines whether the specified Object is equal to the current Object. (Inherited from Object.) which I guess means that at least the Expression class hasn't overrided the equals method to become Equatable? So how would you do this? Or am I asking too much here? :p <code>  Expression<Func<int, bool>> a = x => false; Expression<Func<int, bool>> b = x => false; Expression<Func<int, bool>> c = x => true; Expression<Func<int, bool>> d = x => x == 5;","How to check if two Expression<Func<T, bool>> are the same"
"Naming, Declearing and Defining delegates and events conventions"," How do you name delegates, events and instance of events?I use this: Is this an accepted way? Notice lower and upper casesWhere do you place delegates and events?I usually put delegates in an a namespace best reflecting them: Where do you define events?I usually place them into the class that uses them.I notice that a lot of people define delegates and events in the same class. How common is that? <code>  delegate void OnSomethingHandler();event OnSomethingHandler onSomething; mynamespace.Def.SomethingLike{}mynamespace.Def.SomethingElseLike{}","Naming, declaring and defining delegates and events conventions"
How do I keep a Connection open on Multiple Queries?, I am using multiple queries to pull data from the same server in my application. The issue is that I have to open a new connection every time I have a new query. Is it even possible to:Open the connection Run query Pull results Run another query Pull another result Run final query Pull another result Close connection. <code> ,How can I keep a Connection open when performing multiple queries?
DirectX application on 64 bit windows ," I am developing a WPF application where the 3D part is handled by DirectX 9 (a lot of 3d that did not run fast enough using WPF). The problem is the application is released with ""Any CPU"" as configuration and when a user runs it on a 64 bit windows, the direcX part crashes (System.BadImageFormatException). Apparently the dlls included for the directX part is not usable on a 64 bit windows. This has happened with some other 3:rd part dlls that we use in our application but this we have solved by changing the dlls in runtime to the ones built for x64 if the user are running on a 64 bit windows machine. Do any of you know where I can find DirectX 9 dlls for x64? If they exist at all. The ones I need are:Microsoft.DirectX.Direct3DMicrosoft.DirectX.Direct3DXMicrosoft.DirectXIf they do not exist, can the problem be solved in some other way? I cannot change the configuration to x86 because the application is released via ClickOnce and a change of configuration make ClickOnce stop working (the configuration is included in the ClickOnce key)Let me add that the I am using a Winforms part hosted by the WPF application and that the winforms part is using the DirectX dlls I am asking about. This was a much better and faster way of presenting a lot of 3D meshes in WPF than to use WPF:s 3D. Unfortunately this problem occurred instead. <code> ",DirectX application on 64 bit windows
What's this genetic algorithm good for?," I found this very cool C++ sample , literally the ""Hello World!"" of genetic algorithms.I so decided to re-code the whole thing in C# and this is the result.Now I am asking myself: is there any practical application along the lines of generating a target string starting from a population of random strings?EDIT: my buddy on twitter just tweeted that ""is useful for transcription type things such as translation. Does not have to be Monkey's"". I wish I had a clue. <code> ","What's the ""Hello World!"" of genetic algorithms good for?"
OnDataBinding vs Inline," I thought I would ask this question to see why many examples and people prefer to use inline databinding in the aspx code vs implementing an OnDataBinding event when using WebForms.For any databound control (eg. Repeater, GridView, etc) I always implement the OnDataBinding method for field level controls if I need to do anything that isn't built in out of the box (eg. I need to do an Eval). Most examples I see have the code right in the aspx page using the inline <%# syntax.Example of inline ASP.NET code: Example of how I prefer to do it:In the aspx: In the codebehind .cs: I personally prefer the codebehind method because it keeps my aspx pages clean and I don't have all this inline code all over the place and the next guy just knows to always look in the .cs files for code changes. The seperation of presentation and code is also maintained better this way as the HTML is place holders only and the codebind is determining what is actually being put in control.Now these are very basic examples. The field could be a integer that you want to format with leading 0s or a DateTime that needs a specific format etc. It could also take all sort of manipulation and code to get the finally value that should be stored in the 'Text' property at the end.Where do you draw the line and move it to the codebehind if you are using inline code?What are the pros and cons for doing it either way?Does one take more overhead than the other?Edit Note: I am not talking about assigning a value to a control that is just on the page but one that is being databound to because it exists in a repeater template or gridview item template etc... Obviously a literal sitting on a page you can just assign in code.Edit Note: I thought I would gather more response, especially with regards to the overhead. Do most people NOT use the OnDataBinding events? <code>  <asp:Literal ID=""litExample"" runat=""server"" Text='<%# Eval(""ExampleField"").ToString() %>' /> <asp:Literal ID=""litExample"" runat=""server"" OnDataBinding=""litExample_DataBinding"" /> protected void litExample_DataBinding(object sender, System.EventArgs e){ Literal lit = (Literal)(sender); lit.Text = string.Format(""{1} - {2}"", Eval(""ExampleField"").ToString(), Eval(""ExampleField2"").ToString());}","OnDataBinding vs Inline: pros, cons and overhead"
convert bool[] to byte[] C#, I have a List<bool> which I want to convert to a byte[]. How do i do this? list.toArray() creates a bool[]. <code> ,Convert bool[] to byte[]
C#: Passing a delegate with two parameters as a parameter function," I have a sequence of functions that look very similar but for a single line, like the following two (but I have many more of them): I was thinking about using delegates to remove this repetition in code in some elegant way, that would have allowed me to invoke something like: thereby declaring a delegate like the following: and where HowManyDaysInTheFirstPeriod whould be something like the following: Unfortunately, the compiler complains that comparer needs two parameters. I am relatively new to C# and hit a road-block here. How would you solve this? <code>  private static int HowManyHoursInTheFirstYear(IList<T> samples){ DateTime firstDate = samples[0].Date; int count = 0; while (count < samples.Count && samples[count].Date.Year == firstDate.Year) { count++; } return count;}private static int HowManyDaysInTheFirstMonth(IList<T> samples){ DateTime firstDate = samples[0].Date; int count = 0; while (count < samples.Count && samples[count].Date.Month == firstDate.Month) // <--- only change! count++; } return count;} HowManyDaysInTheFirstPeriod( samples, delegate(DateTime d1, DateTime d2) { return d1.Month == d2.Month; }); delegate bool DateComparer(DateTime first, DateTime second); private static int HowManySamplesInFirstPeriod IList<T> samples, DateComparer comparer){ DateTime firstDate = samples[0].Date; int count = 0; while (count < samples.Count && comparer()) { count++; }}",Passing a delegate with two parameters as a parameter function
How to assgn array values at run time," Consider I have an Array, Here I have assigned values for it. But in my problem I get these values only at runtime.How can I assign them to an array.For example:I get the max size of array from user and the values to them now how do I assign them to the array int [].Or can I use anyother data types like ArrayList etc which I can cast to Int[] at the end? <code>  int[] i = {1,2,3,4,5};",How to assign array values at run time
System.IO.FileLoadException during unit test," I have a very wierd problem happening to me during unit testing (MSTest in Visual Studio - .NET 3.5 SP1):I click ""Run All Tests in solution""All tests passes, except for one particular class, where every tests throws the following exception: ""System.IO.FileLoadException: Loading this assembly would produce a different grant set from other instances. (Exception from HRESULT: 0x80131401).""I then go and set a breakpoint in the class. Result: all tests in the class passes (the same tests that failed before).I click ""Run All Tests in solution"". All tests passes, except for another class.I go set a breakpoint in the class. Result: All tests in the class passesI click ""Run All Tests in solution"". All tests passes, except for the first testclass again.etc.As you can see the problem is very inconsistent, making it hard to debug.I've tried using Fusion Log Viewer, but that gave me confusing results I didn't quite understand.What should I be looking for? Has anyone else experienced this problem?Update:Some additional info was requested.The tests has run fine for months - I think last time I ran them was thursday, and then they ran fine. I've been trying to examine the source control history, to see if something has changed, but nothing out of the ordinary. I could track back and check out the project at different days back in time, but we're using Visual Source Safe (I know - not my descission :-( ) so I'm hesitating to do that.The tests are regular unit tests, and I'm using Moq for mock-objects... But as I said - it has worked fine until recently.I was just hoping for some advice on how to debug this issue. <code> ",Debugging assembly load issue
What are the Dragons of using a Singleton in a multithreaded application," I'm looking at using a singleton in a multithreaded Win service for doing logging, and wanted to know what are some of the problems I might encounter. I have already set up the get instance to handle syncing with Is there anything else I might need to worry about? <code>  private static volatile Logging _instance; private static object _syncRoot = new object(); private Logging(){} public static Logging Instance { get { if (_instance==null) { lock(_syncRoot) { if (_instance == null) { _instance = new Logging(); } } } return _instance; } }",What are the Dangers of using a Singleton in a multithreaded application
Solution to a recursive problem (code kata), This came up while talking to a friend and I thought I'd ask here since it's an interesting problem and would like to see other people's solutions.The task is to write a function Brackets(int n) that prints all combinations of well-formed brackets from 1...n. For Brackets(3) the output would be <code>  ()(()) ()() ((())) (()()) (())() ()(()) ()()(),Finding all combinations of well-formed brackets
Random Hex string," I'm generating some charts that need a hex string for the colors.Example: I'm creating these dynamically, so I would like to generate the hex code for each dataseries randomly.What is the best way to do this? <code>  <dataseries name=""ford"" color=""FF00FF"" />",How do I create a random hex string that represents a color?
When to override GetHshCode() ???, When should we override the GetHashCode() method provided by 'Object' class in 'System' namespace? <code> ,When to override GetHashCode()?
How to get user client ip address in asp.net?," We have Request.UserHostAddress to get the IP address in ASP.NET, but this is usually the user's ISP's IP address, not exactly the user's machine IP address who for example clicked a link. How can I get the real IP Address?For example, in a Stack Overflow user profile it is: ""Last account activity: 4 hours ago from 86.123.127.8"", but my machine IP address is a bit different. How does Stack Overflow get this address? In some web systems there is an IP address check for some purposes. For example, with a certain IP address, for every 24 hours can the user just have only 5 clicks on download links? This IP address should be unique, not for an ISP that has a huge range of clients or Internet users.Did I understand well? <code> ",How to get a user's client IP address in ASP.NET?
How to get user's client ip address in asp.net?," We have Request.UserHostAddress to get the IP address in ASP.NET, but this is usually the user's ISP's IP address, not exactly the user's machine IP address who for example clicked a link. How can I get the real IP Address?For example, in a Stack Overflow user profile it is: ""Last account activity: 4 hours ago from 86.123.127.8"", but my machine IP address is a bit different. How does Stack Overflow get this address? In some web systems there is an IP address check for some purposes. For example, with a certain IP address, for every 24 hours can the user just have only 5 clicks on download links? This IP address should be unique, not for an ISP that has a huge range of clients or Internet users.Did I understand well? <code> ",How to get a user's client IP address in ASP.NET?
how to create pluggable ASP.Net website ?," What are the best practices to create a site, with ability to develop plugins for it? Like you want to create a blog module, and you want users or co-developers to add plugins to extend this module functionality.Update:Thanks for the ultra speed answers, but I think this is over kill for me. Isn't there a simpler solution, like I have seen blogengine plugin creation system is you just have to decorate the class plugin with [Extension].I am kind of mid core developer, so I was thinking of base class, inheritance, interfaces, what do you think ? <code> ",how to create pluggable ASP.Net website?
dynamic return type function, How can I create a function that will have a dynamic return type based on the parameter type?Like  <code>  protected DynamicType Test(DynamicType type){return ; },dynamic return type of a function
Remove WS-Addressing/WS-Security sections from C# Web Service Client request," I've got a simple C# web service proxy class that I created with WSDL.exe. I am invoking a method on the remote web service, and it is including a bunch of WS-Addressing and WS-Security headers that I do not want (and that the server is choking on). Here is an example of the raw soap request: But I don't care about the WS-Addressing/WS-Security stuff. I've done nothing to include it. The .NET WSE 3.0 package seems to be adding them by default. Is there any way to get rid of these? I can see no properties on my proxy object that allow me to remove these sections. I've tried: Those cause a null reference exception when I invoke my web service method.I want the SOAP request to look like this: Thanks in advance <code>  <?xml version=""1.0"" encoding=""utf-8""?><soap:Envelope xmlns:soap=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:wsa=""http://schemas.xmlsoap.org/ws/2004/08/addressing"" xmlns:wsse=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"" xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd""> <soap:Header> <wsa:Action></wsa:Action> <wsa:MessageID>urn:uuid:22f12267-b162-4703-a451-2d1c5c5a619b</wsa:MessageID> <wsa:To>http://example.com/wstest</wsa:To> <wsse:Security> <wsu:Timestamp wsu:Id=""Timestamp-5c9f0ef0-ab45-421d-a633-4c4fad26d945""> <wsu:Created>2009-04-15T16:27:25Z</wsu:Created> <wsu:Expires>2009-04-15T16:32:25Z</wsu:Expires> </wsu:Timestamp> </wsse:Security> </soap:Header> <soap:Body> <Func1 xmlns=""http://example.com""> <arg_1 xmlns="""">blah</arg_1> <arg_2 xmlns="""">blah2</arg_2></arg_2> </Func1> </soap:Body></soap:Envelope> proxyObject.Addressing.Clear();proxyObject.Security.Clear(); <?xml version=""1.0"" encoding=""utf-8""?><soap:Envelope xmlns:soap=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema""> <soap:Header> </soap:Header> <soap:Body> <Func1 xmlns=""http://example.com""> <arg_1 xmlns="""">blah</arg_1> <arg_2 xmlns="""">blah2</arg_2></arg_2> </Func1> </soap:Body></soap:Envelope>",Remove WS-Addressing/WS-Security sections from WSE 3.0 Client request
Exclude certain file extensions when get files from a directory," How to exclude certain file type when getting files from a directory?I tried But it seems that this function can only choose the file types you want to include, not exclude.  <code>  var files = Directory.GetFiles(jobDir);",Exclude certain file extensions when getting files from a directory
"OO: Why should constructors on abstract classes be protected, not public?"," ReSharper suggests changing the accessibility of a public constructor in an abstract class to protected, but it does not state the rationale behind this.Can you shed some light? <code> ","Why should constructors on abstract classes be protected, not public?"
Serialise object to XmlDocument," In order to return useful information in SoapException.Detail for an asmx web service, I took an idea from WCF and created a fault class to contain said useful information. That fault object is then serialised to the required XmlNode of a thrown SoapException.I'm wondering whether I have the best code to create the XmlDocument - here is my take on it: Is there a better way of doing this?UPDATE: I actually ended up doing the following, because unless you wrap the XML in a <detail> xml element, you get a SoapHeaderException at the client end: UPDATE 2: Given John Saunders excellent answer, I've now started using the following: <code>  var xmlDocument = new XmlDocument();var serializer = new XmlSerializer(typeof(T));using (var stream = new MemoryStream()){ serializer.Serialize(stream, theObjectContainingUsefulInformation); stream.Flush(); stream.Seek(0, SeekOrigin.Begin); xmlDocument.Load(stream);} var serialiseToDocument = new XmlDocument();var serializer = new XmlSerializer(typeof(T));using (var stream = new MemoryStream()){ serializer.Serialize(stream, e.ExceptionContext); stream.Flush(); stream.Seek(0, SeekOrigin.Begin); serialiseToDocument.Load(stream);}// Remove the xml declarationserialiseToDocument.RemoveChild(serialiseToDocument.FirstChild);// Memorise the node we wantvar serialisedNode = serialiseToDocument.FirstChild;// and wrap it in a <detail> elementvar rootNode = serialiseToDocument.CreateNode(XmlNodeType.Element, ""detail"", """");rootNode.AppendChild(serialisedNode); private static void SerialiseFaultDetail(){ var fault = new ServiceFault { Message = ""Exception occurred"", ErrorCode = 1010 }; // Serialise to the XML document var detailDocument = new XmlDocument(); var nav = detailDocument.CreateNavigator(); if (nav != null) { using (XmlWriter writer = nav.AppendChild()) { var ser = new XmlSerializer(fault.GetType()); ser.Serialize(writer, fault); } } // Memorise and remove the element we want XmlNode infoNode = detailDocument.FirstChild; detailDocument.RemoveChild(infoNode); // Move into a root <detail> element var rootNode = detailDocument.AppendChild(detailDocument.CreateNode(XmlNodeType.Element, ""detail"", """")); rootNode.AppendChild(infoNode); Console.WriteLine(detailDocument.OuterXml); Console.ReadKey();}",Serialize object to XmlDocument
asp.net MVC - reset the value of textarea after form submition," I want to send a message to userID=3 by going to /MyController/Message/3This executes Message() [get] action, I enter some text in the text area and click on Save to post the formMessage() [post] action saves the changes, resets the value of SomeText to empty string and returns to the view.At this point I expect the text area to be empty because I have set ViewData[""SomeText""] to string.Empty.Why is text area value not updated to empty string after post action?Here are the actions: And the corresponding view: <code>  [AcceptVerbs(HttpVerbs.Get)]public ActionResult Message(int ID){ ViewData[""ID""] = ID; return View();}[AcceptVerbs(HttpVerbs.Post)]public ActionResult Message(int ID, string SomeText){ // save Text to database SaveToDB(ID, SomeText); // set the value of SomeText to empty and return to view ViewData[""SomeText""] = string.Empty; return View();} <%@ Page Title="""" Language=""C#"" MasterPageFile=""~/Views/Shared/Site.Master"" Inherits=""System.Web.Mvc.ViewPage"" %><asp:Content ID=""Content1"" ContentPlaceHolderID=""MainContent"" runat=""server""><% using (Html.BeginForm()) { %> <%= Html.Hidden(""ID"", ViewData[""ID""])%> <label for=""SomeText"">SomeText:</label> <%= Html.TextArea(""SomeText"", ViewData[""SomeText""]) %> <input type=""submit"" value=""Save"" /><% } %></asp:Content>",Reset the value of textarea after form submission
Rset the value of textarea after form submition," I want to send a message to userID=3 by going to /MyController/Message/3This executes Message() [get] action, I enter some text in the text area and click on Save to post the formMessage() [post] action saves the changes, resets the value of SomeText to empty string and returns to the view.At this point I expect the text area to be empty because I have set ViewData[""SomeText""] to string.Empty.Why is text area value not updated to empty string after post action?Here are the actions: And the corresponding view: <code>  [AcceptVerbs(HttpVerbs.Get)]public ActionResult Message(int ID){ ViewData[""ID""] = ID; return View();}[AcceptVerbs(HttpVerbs.Post)]public ActionResult Message(int ID, string SomeText){ // save Text to database SaveToDB(ID, SomeText); // set the value of SomeText to empty and return to view ViewData[""SomeText""] = string.Empty; return View();} <%@ Page Title="""" Language=""C#"" MasterPageFile=""~/Views/Shared/Site.Master"" Inherits=""System.Web.Mvc.ViewPage"" %><asp:Content ID=""Content1"" ContentPlaceHolderID=""MainContent"" runat=""server""><% using (Html.BeginForm()) { %> <%= Html.Hidden(""ID"", ViewData[""ID""])%> <label for=""SomeText"">SomeText:</label> <%= Html.TextArea(""SomeText"", ViewData[""SomeText""]) %> <input type=""submit"" value=""Save"" /><% } %></asp:Content>",Reset the value of textarea after form submission
Reset the value of textarea after form submition," I want to send a message to userID=3 by going to /MyController/Message/3This executes Message() [get] action, I enter some text in the text area and click on Save to post the formMessage() [post] action saves the changes, resets the value of SomeText to empty string and returns to the view.At this point I expect the text area to be empty because I have set ViewData[""SomeText""] to string.Empty.Why is text area value not updated to empty string after post action?Here are the actions: And the corresponding view: <code>  [AcceptVerbs(HttpVerbs.Get)]public ActionResult Message(int ID){ ViewData[""ID""] = ID; return View();}[AcceptVerbs(HttpVerbs.Post)]public ActionResult Message(int ID, string SomeText){ // save Text to database SaveToDB(ID, SomeText); // set the value of SomeText to empty and return to view ViewData[""SomeText""] = string.Empty; return View();} <%@ Page Title="""" Language=""C#"" MasterPageFile=""~/Views/Shared/Site.Master"" Inherits=""System.Web.Mvc.ViewPage"" %><asp:Content ID=""Content1"" ContentPlaceHolderID=""MainContent"" runat=""server""><% using (Html.BeginForm()) { %> <%= Html.Hidden(""ID"", ViewData[""ID""])%> <label for=""SomeText"">SomeText:</label> <%= Html.TextArea(""SomeText"", ViewData[""SomeText""]) %> <input type=""submit"" value=""Save"" /><% } %></asp:Content>",Reset the value of textarea after form submission
How can I get Doc filename from c#?, I'm working on a MS Word AddIn (VSTO).The idea is that I work on a Word document and I send it somewhere.I have all the code I need except one thing: is there a way I can get the filename of the Word document I'm working on? (assuming that is already saved) <code> ,How can I get the filename of a Word document from C#?
How do I use TransactionScope in C#?," I am trying to use TransactionScope, but keep getting the exception below.The app is running on a different machine than the database, if that matters. I am using SQL Server 2005. Network access for Distributed Transaction Manager (MSDTC) has been disabled. Please enable DTC for network access in the security configuration for MSDTC using the Component Services Administrative tool. EditI made some changes based on the feedback. Now I'm getting this error: ""Error HRESULT E_FAIL has been returned from a call to a COM component."" ""Communication with the underlying transaction manager has failed.""SolutionI think the accepted answer fixed the initial issue I was getting. The 2nd error seems to be specific to Entity Framework. I'll post another question for it.Here are the properties on the client:Client http://www.portnine.com/data/images/Misc/client.jpgHere are the properties on the server:Server http://www.portnine.com/data/images/Misc/server.jpg <code>  using (TransactionScope tsTransScope = new TransactionScope()){ //Do stuff here tsTransScope.Complete();}",How to use TransactionScope in C#?
How do I override ToString in C# enums?," In the post Enum ToString, a method is described to use the custom attribute DescriptionAttribute like this: And then, you call a function GetDescription, using syntax like: But that doesn't really help me when I want to simply populate a ComboBox with the values of an enum, since I cannot force the ComboBox to call GetDescription.What I want has the following requirements:Reading (HowNice)myComboBox.selectedItem will return the selected value as the enum value.The user should see the user-friendly display strings, and not just the name of the enumeration values. So instead of seeing ""NotNice"", the user would see ""Not Nice At All"".Hopefully, the solution will require minimal code changes to existing enumerations.Obviously, I could implement a new class for each enum that I create, and override its ToString(), but that's a lot of work for each enum, and I'd rather avoid that.Any ideas?Heck, I'll even throw in a hug as a bounty :-) <code>  Enum HowNice { [Description(""Really Nice"")] ReallyNice, [Description(""Kinda Nice"")] SortOfNice, [Description(""Not Nice At All"")] NotNice} GetDescription<HowNice>(NotNice); // Returns ""Not Nice At All""",How do I have an enum bound combobox with custom string formatting for enum values?
Image resizing - sometimes very poor quality?!," I'm resizing some images to the screen resolution of the user; if the aspect ratio is wrong, the image should be cut.My code looks like this: In most cases, this works fine. But for some images, the result has an extremely poor quality. It looks like the would have been resized to something very small (thumbnail size) and enlarged again.. But the resolution of the image is correct. What can I do?Example orig image:alt text http://img523.imageshack.us/img523/1430/naturaerowoods.jpgExample resized image:Note: I have a WPF application but I use the WinForms function for resizing because it's easier and because I already need a reference to System.Windows.Forms for a tray icon. <code>  protected void ConvertToBitmap(string filename) { var origImg = System.Drawing.Image.FromFile(filename); var widthDivisor = (double)origImg.Width / (double)System.Windows.Forms.Screen.PrimaryScreen.Bounds.Width; var heightDivisor = (double)origImg.Height / (double)System.Windows.Forms.Screen.PrimaryScreen.Bounds.Height; int newWidth, newHeight; if (widthDivisor < heightDivisor) { newWidth = (int)((double)origImg.Width / widthDivisor); newHeight = (int)((double)origImg.Height / widthDivisor); } else { newWidth = (int)((double)origImg.Width / heightDivisor); newHeight = (int)((double)origImg.Height / heightDivisor); } var newImg = origImg.GetThumbnailImage(newWidth, newHeight, null, IntPtr.Zero); newImg.Save(this.GetBitmapPath(filename), System.Drawing.Imaging.ImageFormat.Bmp); }",Image resizing - sometimes very poor quality?
Does anyone know a way to get the FQDN of local machine in C#?, How can you get the FQDN of a local machine in C#? <code> ,How to find FQDN of local machine in C#/.NET ?
Csharp XmlDcoument.SelectSingleNode Xml attribute id," I'm working with an XML document that contains a structure that looks similar to this: I'm currently loading this from a file into an XML document in this fashion: However I'm running into a problem and only with this one particular document when I try to run the next line of code: Am I on the right track by guessing that this is returning null because of an issue with using an attribute named 'id' or am I missing something in code? <code>  <MT> <Events> <event id=""1""> <field name=""blah"" value=""a_value"" type=""atype"" /> . . . </event> </Events> </MT> XmlDocument xdoc = new XmlDocument();xdoc.Load(""somefile.xml""); //Successfully loads btw xdoc.SelectSingleNode(""//event[@id='1']""); //This returns a null ",Why is SelectSingleNode returning null?
File Upload with RegularExpressionValidator not working with Firefox only IE., I have a FileUpload with a RegularExpressionValidator with the following Validation Expression: This way I make sure the User only upload images.But for some reason it does not work when I use Firefox. Why is that and how can I go around the problem? <code>  ^(([a-zA-Z]:)|(\\{2}\w+)\$?)(\\(\w[\w].*))+(.gif|.jpg|.JPG|.JPEG|.GIF|.jpeg|.png|.bmp|.3dm|.3dmf|.ai|.drw|.dxf|.esp|.mng|.png|.ps|.psp|.svg|.tiff)$,File Upload with RegularExpressionValidator not working with Firefox only IE
JSON.Net: convert json string to xml or xml to json string?," I started to use Json.NET to convert a string in JSON format to object or viceversa. I am not sure in the Json.NET framework, is it possible to convert a string in JSON to XML format and viceversa? <code> ",How to convert JSON to XML or XML to JSON?
Json.NET: convert JSON string to XML or XML to JSON string," I started to use Json.NET to convert a string in JSON format to object or viceversa. I am not sure in the Json.NET framework, is it possible to convert a string in JSON to XML format and viceversa? <code> ",How to convert JSON to XML or XML to JSON?
Convert JSON string to XML or XML to JSON string," I started to use Json.NET to convert a string in JSON format to object or viceversa. I am not sure in the Json.NET framework, is it possible to convert a string in JSON to XML format and viceversa? <code> ",How to convert JSON to XML or XML to JSON?
Convert JSON to XML or XML to JSON by using Json.NET," I started to use Json.NET to convert a string in JSON format to object or viceversa. I am not sure in the Json.NET framework, is it possible to convert a string in JSON to XML format and viceversa? <code> ",How to convert JSON to XML or XML to JSON?
Convert JSON to XML or XML to JSON," I started to use Json.NET to convert a string in JSON format to object or viceversa. I am not sure in the Json.NET framework, is it possible to convert a string in JSON to XML format and viceversa? <code> ",How to convert JSON to XML or XML to JSON?
Entity Framework - Using Transactions or SaveChanges(false) and AcceptAllChanges()?," I have been investigating transactions and it appears that they take care of themselves in EF as long as I pass false to SaveChanges() and then call AcceptAllChanges() if there are no errors: What if something goes bad? don't I have to rollback or, as soon as my method goes out of scope, is the transaction ended?What happens to any indentiy columns that were assigned half way through the transaction? I presume if somebody else added a record after mine before mine went bad then this means there will be a missing Identity value.Is there any reason to use the standard TransactionScope class in my code? <code>  SaveChanges(false);// ...AcceptAllChanges();",Using Transactions or SaveChanges(false) and AcceptAllChanges()?
"The ""??"" signs in code", I was wondering about ?? signs in C# code. What is it for? And how can I use it?What about int?? Is it a nullable int?See also:?? Null Coalescing Operator > What does coalescing mean? <code> ,"What is the ""??"" operator for?"
C# MD5 hasher locking file," Edit: I've retitled this to an example as the code works as expected.I am trying to copy a file, get a MD5 hash, then delete the copy. I am doing this to avoid process locks on the original file, which another app writes to. However, I am getting a lock on the file I've copied. I am then getting a 'process cannot access the file' exception on File.Delete()'.I would expect that with the using statement, the filestream would be closed nicely. I have also tried declaring the filestream separately, removing using, and putting fs.Close() and fs.Dispose() after the read.After this, I commented out the actually md5 computation, and the code excutes, with the file being deleted, so it looks like it's something to do with ComputeHash(fs). <code>  File.Copy(pathSrc, pathDest, true);String md5Result;StringBuilder sb = new StringBuilder();MD5 md5Hasher = MD5.Create();using (FileStream fs = File.OpenRead(pathDest)){ foreach(Byte b in md5Hasher.ComputeHash(fs)) sb.Append(b.ToString(""x2"").ToLower());}md5Result = sb.ToString();File.Delete(pathDest);",C# MD5 hasher example
DrawString weirdness in C# Winforms," I have subclassed a control in C# WinForms, and am custom drawing text in my OnPaint() handler.The font is set to Courier New using the following code in my form: In the control itself, the string is stored in realText, and I use the following code to draw it to the screen: The result for some random example text looks as follows:http://img219.imageshack.us/img219/1778/courier.pngIf you zoom in, you can see for example, that the space between the first 'as' is different than the space between the second 'as' (1 pixels versus 2 pixels). Does anybody have any idea what might be causing this, or how I can prevent it from happening? There is a lot more similar weirdness in spacing as I draw with different fonts, but I assume they're all results of the same problem.Thanks in advance for any ideas you may have. <code>  FontFamily family = new FontFamily(""Courier New"");this.myControl.Font = new Font(family, 10); protected override void OnPaint(PaintEventArgs e){ base.OnPaint(e); e.Graphics.DrawString(realText, Font, new SolidBrush(ForeColor), ClientRectangle);}",Why is DrawString exhibiting unexpected behavior in C# Winforms?
ASP.Net MVC Issue," I have a very simple ASP.Net MVC Application that I have produced from an online tutorial. I've followed it exactly, step by step and have tried multiple times but keep getting the same error when I execute the code.The program just displays an index page which lists a series of data from an sql server database using linq to sql.This is the error:Could not load type 'MvcApplication1.Views.Home.Index'.Any ideas what the problem could be? <code> ","ASP.Net MVC ""Could Not Load Type"" when executing"
C# How to create extension methods with lambada expressions," Currently i am creating an extension method that accepts parameters. Using the below example, how could one convert this using lambda expressions? What are the pro/cons using lambda vs normal method parameters?Thanks <code>  public static decimal ChangePercentage(this IEnumerable<Trade> trades, DateTime startDate, DateTime endDate){ var query = from trade in trades where trade.TradeTime >= startDate where trade.TradeTime <= endDate orderby trade.TradeTime descending select trade; return (query.First().Value - query.Last().Value) / query.First().Value * 100;}",How to create extension methods with lambda expressions
C# How to create extension methods with lambda expressions," Currently i am creating an extension method that accepts parameters. Using the below example, how could one convert this using lambda expressions? What are the pro/cons using lambda vs normal method parameters?Thanks <code>  public static decimal ChangePercentage(this IEnumerable<Trade> trades, DateTime startDate, DateTime endDate){ var query = from trade in trades where trade.TradeTime >= startDate where trade.TradeTime <= endDate orderby trade.TradeTime descending select trade; return (query.First().Value - query.Last().Value) / query.First().Value * 100;}",How to create extension methods with lambda expressions
WPF -- simple checkbox binding question," While it is trivial to store a checkbox's checked state in a variable using the checkbox's Click event, how would I do it via databinding? All the examples I have found have the UI updated from some datasource, or bind one control to another; I want to update a member variable when the checkbox is clicked.TIA for any pointers... <code> ",WPF checkbox binding
Linq .Any VS .Exists - Whats the difference?," Using LINQ on collections, what is the difference between the following lines of code? and Update 1When I disassemble .Exists it looks like there is no code.Update 2Anyone know why there is no code there for this one? <code>  if(!coll.Any(i => i.Value)) if(!coll.Exists(i => i.Value))",LINQ .Any VS .Exists - What's the difference?
Linq .Any VS .Exists - What's the difference?," Using LINQ on collections, what is the difference between the following lines of code? and Update 1When I disassemble .Exists it looks like there is no code.Update 2Anyone know why there is no code there for this one? <code>  if(!coll.Any(i => i.Value)) if(!coll.Exists(i => i.Value))",LINQ .Any VS .Exists - What's the difference?
how can i dynamically create an array in c#, How can I dynamically create an array in C#? <code> ,Dynamically Create an Array in C#
MSTest: Problems with DeploymentItem attribute," I'm currently maintaining an ""old"" system written in C#.net, removing some obsolete features and doing some refactoring. Thanks god, the previous guy wrote some unit tests (MSTests). I quite comfortable with JUnit tests, but didn't do yet much with MSTests.The test methods have a DeploymentItem attribute, specifying a text file which is parsed by the business logic method that is being tested and a 2nd DeploymentItem where just a path has been specified containing a bunch of TIF files that have to be deployed too. The tests worked before, but now I had to change the names of the TIF files contained in the \files\tif directory. According to a rule, the TIF filenames have to match a certain pattern which is also checked by the ExistsTifTest() method.Now I had to change the filenames in order to adapt them to the new requirements and suddently the TIF files are no more being deployed as before.Can someone give me a hint why this happens or what may be the cause? The same thing happens also if I add a new text-file say ""my2ndTest.txt"" beside the ""valid_entries.txt"" in the \files\valid\ directory with the according DeploymentItem attribute on the test method. The file doesn't get deployed?I got the images now deployed by defining the deployment path directly in the testrunconfig, but I'd like to understand why these things happen or why for instance my new file ""my2ndTest.txt"" doesn't get deployed while the others do. <code>  [TestMethod()][DeploymentItem(@""files\valid\valid_entries.txt"")][DeploymentItem(@""files\tif\"")]public void ExistsTifTest(){ ...}",Problems with DeploymentItem attribute
Return value caching without boilerplate code," For methods where ...there exists a static one-to-one mapping between the input and the output, andthe cost of creating the output object is relatively high, andthe method is called repeatedly with the same input... there is a need for caching result values.In my code the following result value caching pattern is repeated a lot (pseudo-code in Java, but the question is language-agnostic): Repeating this structure all the time is a clear violation of the DRY principle.Ideally, I'd like the code above to be reduced to the following: Where the theoretical CacheResult annotation would take care of the caching I'm currently doing by hand. The general term for this type of caching is ""memoization"".A good example of the exact functionality I'm looking for is Perl core module ""Memoize"".In which languages does such a Memoize-like caching solution exist (either at the language level or the library level)? In particular - does such a solution exist for any major platform such as Java or .NET? <code>  private static Map<Input, Output> fooResultMap = new HashMap<Input, Output>();public getFoo(Input input) { if (fooResultMap.get(input) != null) { return fooResultMap.get(input); } Output output = null; // Some code to obtain the object since we don't have it in the cache. fooResultMap.put(input, output); return output;} @CacheResultpublic getFoo(Input input) { Output output = null; // Some code to obtain the object since we don't have it in the cache. return output;}",Which languages have support for return value caching without boilerplate code?
How to copy the contents of a String to clipboard in C#," If I have some text in a String, how can I copy that to the clipboard so that the user can paste it into another window (for example, from my application to Notepad)? <code> ",How do I copy the contents of a String to the clipboard in C#?
How to copy the contents of a String to the clipboard in C#?," If I have some text in a String, how can I copy that to the clipboard so that the user can paste it into another window (for example, from my application to Notepad)? <code> ",How do I copy the contents of a String to the clipboard in C#?
Possible to crawl a login form protected site in C#?," Would it be possible to write a screen-scraper for a website protected by a form login. I have access to the site, of course, but I have no idea how to login to the site and save my credentials in C#. Also, any good examples of screenscrapers in C# would be hugely appreciated.Has this already been done?  <code> ",Screen-scraping a site with a asp.net form login in C#?
Regex: Named Capturing Groups in C#," I'm having a hard time finding a good resource that explains how to use Named Capturing Groups in C#. This is the code that I have so far: However this always just shows the full line: I have experimented with several other ""methods"" that I've found on various websites but I keep getting the same result.How can I access the named capturing groups that are specified in my regex? <code>  string page = Encoding.ASCII.GetString(bytePage);Regex qariRegex = new Regex(""<td><a href=\""(?<link>.*?)\"">(?<name>.*?)</a></td>"");MatchCollection mc = qariRegex.Matches(page);CaptureCollection cc = mc[0].Captures;MessageBox.Show(cc[0].ToString()); <td><a href=""/path/to/file"">Name of File</a></td> ",How do I access named capturing groups in a .NET Regex?
Regex: Named Capturing Groups in .NET," I'm having a hard time finding a good resource that explains how to use Named Capturing Groups in C#. This is the code that I have so far: However this always just shows the full line: I have experimented with several other ""methods"" that I've found on various websites but I keep getting the same result.How can I access the named capturing groups that are specified in my regex? <code>  string page = Encoding.ASCII.GetString(bytePage);Regex qariRegex = new Regex(""<td><a href=\""(?<link>.*?)\"">(?<name>.*?)</a></td>"");MatchCollection mc = qariRegex.Matches(page);CaptureCollection cc = mc[0].Captures;MessageBox.Show(cc[0].ToString()); <td><a href=""/path/to/file"">Name of File</a></td> ",How do I access named capturing groups in a .NET Regex?
using statement with try catch block, Is there any difference between these tow pieces of code & which approach is better. <code>  try{ using() { //Do stuff }}catch{ //Handle exception}using(){ try { //Do stuff } catch { //Handle exception }},Catch exceptions within a using block vs outside the using block - which is better ?
"How to turn ""Lorem Lipsum Et"" into ""Lorem lipsum et"" with C# ?"," I could write my own algorithm to do it, but I feel there should be the equivalent to ruby's humanize in C#. I googled it but only found ways to humanize dates.Examples:A way to turn ""Lorem Lipsum Et"" into ""Lorem lipsum et"" A way to turn ""Lorem lipsum et"" into ""Lorem Lipsum Et"" <code> ","How to capitalize the first character of each word, or the first character of a whole string, with C#?"
Generic .Net Produce/Consumer ," I'm toying with the idea of implementing a generic Producer/Consumer pair + processing queue in C# for fun. The idea is you can just create objects that implement appropriate IProducer and IConsumer interfaces (default implementations supplied), which will consist mainly of delegates, pass them to a QueueProcessor class instance, tell it how many consumers you want, and go.But I say to myself, ""Self, surely this has been done before.""So does anyone know of a good, generic implementation of the producer/consumer pattern in C# (VB.Net is okay, too)? The basic requirements I'm looking for:Use generics for the produced and consumed types (input, queued task, and output types, or any combination thereof)Allow you specify how many consumers will work the queueAllow you to link up or chain multiple queues into a pipeline (tricky with multiple Consumers, I know)Allow you to implement your own Producers and ConsumersAllow you to turn any IEnumerable into a producer (okay if I have to implement that myself, as long it's possible)Delegate based (you can use lambda syntax for the basic consumer or producer work to process a single item)Or if there is none, what pitfalls have prevented it and do you have any thoughts on how to implement it? <code> ",Generic .Net Producer/Consumer 
What happens during the garbage collection when 2nd generation is full," I'm re-reading CLR via C# right now and have some questions about garbage collection in .NET. In the book, after Generation 0 is filled, garbage collection starts and moves all outstanding object references to the Generation 1. The same happens when the Generation 1 is filled. But what happens when second generation is filled? There are no other generations to move references. Is the size of Generation 2 expanded by the CLR? <code> ",What happens during Garbage Collection if Generation 2 is filled?
Updating <appname>.config file from an Installer Class," I've tried updating my application's .config file during installer (via a .NET Installer Class Action). But, I can't seem to get ConfigurationManager to list any properties or be able to set anything.I learned of this approach from several stackoverflow posts that pointed me to this guide: http://raquila.com/software/configure-app-config-application-settings-during-msi-install/I've investigated the differences between my project and his and noticed that my configuration files are formatted differently. I believe this has to do with the fact that i'm using ""Settings"" files. Config files formatted in the guide look like: Where mine looks like: To shed some light on what was going on... I tried printing out the list of settings like so: I have tried several permutations of this... and in all cases output is ""appSettings was null"".I also tried initializing the configuration manager in several different ways... For each of them the section count returned was 20. (I have no idea where the 20 comes from... I would have expected it to be 3).HasFile was true for the first case and false for the second. Namespace Declared was false in both cases. Thanks!EDIT (6-18-09): Still looking into this question. Anyone else have any ideas? Thanks.Search Keywords: ""Object Reference Not Set to not set to an instance"" <-- this occurs when trying to write to a property.  <code>  <?xml version=""1.0"" encoding=""utf-8"" ?> <configuration> <appSettings> <add key=""Param1"" value="""" /> <add key=""Param2"" value="""" /> <add key=""Param3"" value="""" /> </appSettings> </configuration> <?xml version=""1.0"" encoding=""utf-8"" ?><configuration> <configSections> <sectionGroup name=""userSettings"" type=""System.Configuration.UserSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" > <section name=""MyAppName.Properties.Settings"" type=""System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" allowExeDefinition=""MachineToLocalUser"" requirePermission=""false"" /> <section name=""MyAppName.Settings1"" type=""System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" allowExeDefinition=""MachineToLocalUser"" requirePermission=""false"" /> </sectionGroup> <sectionGroup name=""applicationSettings"" type=""System.Configuration.ApplicationSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" > <section name=""MyAppName.Settings1"" type=""System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" requirePermission=""false"" /> </sectionGroup> </configSections> <userSettings> <MyAppName.Properties.Settings> <setting name=""TESTSETTING"" serializeAs=""String""> <value>asdfasdfasdf</value> </setting> </MyAppName.Properties.Settings> <MyAppName.Settings1> <setting name=""VerboseErrorMode"" serializeAs=""String""> <value>False</value> </setting> <applicationSettings> <MyAppName.Settings1> <setting name=""RunOnStartup"" serializeAs=""String""> <value>True</value> </setting> </MyAppName.Settings1> </applicationSettings></configuration> Configuration config = ConfigurationManager.OpenExeConfiguration(exePath); // Try getting the Settings1 Section AppSettingsSection appSettings = (AppSettingsSection)config.GetSection(""Settings1""); // Also tried myNamespace.Settings1 if (appSettings != null) { valList = ""Settings1: ""; foreach (string key in appSettings.Settings.AllKeys) { string value = appSettings.Settings[key].Value; valList += (""Key: '"" + key + ""' = '"" + value + ""'\n""); } } else { valList = ""appSettings was null""; } MessageBox.Show(valList); MessageBox.Show(valList); Configuration config = ConfigurationManager.OpenExeConfiguration(exePath); MessageBox.Show(""Section Count: "" + config.Sections.Count); MessageBox.Show(""Has File: "" + config.HasFile); MessageBox.Show(""Namespace Declared: "" + config.NamespaceDeclared); config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None); MessageBox.Show(""Section Count: "" + config.Sections.Count); MessageBox.Show(""Has File: "" + config.HasFile); MessageBox.Show(""Namespace Declared: "" + config.NamespaceDeclared);",Updating <appname>.config file from an Custom Installer Class Action.
Is there an existing library of extension methods for C#? or share your own.," Possible Duplicate: Post your extension goodies for C# .Net (codeplex.com/extensionoverflow) I'm fond of C# 3.0. One of my favorite parts is extension methods. I like to think of extension methods as utility functions that can apply to a broad base of classes. I am being warned that this question is subjective and likely to be closed, but I think it's a good question, because we all have ""boilerplate"" code to do something relatively static like ""escape string for XML"" - but I have yet to find a place to collect these.I'm especially interested in common functions that perform logging/debugging/profiling, string manipulation, and database access. Is there some library of these types of extension methods out there somewhere?Edit: moved my code examples to an answer.(Thanks Joel for cleaning up the code!) <code> ",Is there an existing library of extension methods for C#? or share your own
Remove ClickOnce from a WinForms app," I have a WinForms application that was going to use ClickOnce. But it turns out ClickOnce won't work for my application, so I'd like to remove it. Only...there doesn't seem to be an obvious way to do this. There's no ""Un-ClickOnce"" button. Does anybody know what steps I need to take to get my app to be like it was before ClickOnce integrated itself?(I know I can create a new project and import stuff into it, but it seems silly to have to do that, so I'm hoping there's another way.) <code> ",Remove ClickOnce from a Windows Forms application
Datagridview causing IndexOutOfRangeExceptionn when clicked upon," I have a datagridview which we will call dataGridViewExample.My object (the uncommon datatypes is because my database is SQLite): Here is the relevant code: When MyForm gets called with a .ShowDialog, it shows up fine and displays my DataGridView example just fine. As you can read from the code, the ExampleListis initially empty, so it just shows an empty datagridview with 4 columns: Vnr, Name, Price & Amount. If I click inside it etc. nothing happens - so everything is working as planned, so far.Everytime I call AddtoDataGridViewExample() it adds the new object to the Datagridview, and the datagridview does update, listing all the objects added so far (they show themself as rows, again according to plan).Now, remember that I just said that nothing happened if you clicked inside DataGridViewExample before I have called AddtoDataGridViewExample()?Well, after having called AddtoDataGridViewExample() once or more, the program will crash if I click inside DataGridViewExample (for example: the users wants to select a row). It throws an IndexOutOfRangeException and talks about an -1 index.It also throws the exception in the other form, on the line where I call MyForm with .ShowDialog();I really am stuck on this, do you guys have any idea what is wrong?? My only clue is that I do believe the refresh of DataGridViewExample's datasource might be the cause of the problem. Another important note: I have yet bound any events to my DataGridViewExample. So you can rule that idea out.Here is all DataGridViewExample's properties: <code>  class MyObject{ public Int64 Vnr { get; set; } public string Name { get; set; } public Single Price { get; set; } public int Amount { get; set; }} //This form gets called with a .ShowDialog(); in my form1.private List<MyObjecte> ExampleList = new List<MyObject>();public MyForm(){ dataGridViewExample.DataSource = OrdreInkbsListe;}private void AddtoDataGridViewExample(){ //Add a new MyObject to the list ExampleList.Add(new myObject() { Vnr = newVnr, Amount = newAmount, Price = newPrice, Name = newName }); //refresh datasource dataGridViewExample.DataSource = null; dataGridViewExample.Refresh(); dataGridViewExample.DataSource = OrdreInkbsListe; ddataGridViewExample.Refresh();} this.dataGridViewExample.AllowUserToAddRows = false;this.dataGridViewExample.AllowUserToDeleteRows = false;this.dataGridViewExample.AllowUserToResizeColumns = false;this.dataGridViewExample.AllowUserToResizeRows = false;this.dataGridViewExample.AutoSizeColumnsMode = System.Windows.Forms.DataGridViewAutoSizeColumnsMode.Fill;this.dataGridViewExample.ColumnHeadersHeightSizeMode = System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode.AutoSize;this.dataGridViewExample.Location = new System.Drawing.Point(591, 53);this.dataGridViewExample.MultiSelect = false;this.dataGridViewExample.Name = ""dataGridViewExample"";this.dataGridViewExample.ReadOnly = true;this.dataGridViewExample.RowHeadersVisible = false;this.dataGridViewExample.SelectionMode = System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect;this.dataGridViewExample.ShowEditingIcon = false;this.dataGridViewExample.Size = new System.Drawing.Size(240, 150);this.dataGridViewExample.TabIndex = 31;",Datagridview causing IndexOutOfRangeException when clicked upon
How do i test this method which creates a new Process?, How can I test the following method?It is a method on a concrete class implementation of an interface.I have wrapped the Process class with an interface that only exposes the methods and properties I need. The ProcessWrapper class is the concrete implementation of this interface. <code>  public void Initiate(IEnumerable<Cow> cows) { foreach (Cow c in cows) { c.Process = new ProcessWrapper(c); c.Process.Start(); count++; } },How do I unit test code that creates a new Process?
How to make protected AND internal?," Here is my shortened abstract class: Here is a derived class: The idea is, I want to be able to call Report.Headers from anywhere in the assembly, but only allow it to be set by derived classes. I tried making Headers just internal, but protected does not count as more restrictive than internal. Is there a way to make Headers internal and its set accessor protected AND internal?I feel like I'm grossly misusing access modifiers, so any design help would be greatly appreciate. <code>  abstract class Report { protected internal abstract string[] Headers { get; protected set; }} class OnlineStatusReport : Report { static string[] headers = new string[] { ""Time"", ""Message"" } protected internal override string[] Headers { get { return headers; } protected set { headers = value; } } internal OnlineStatusReport() { Headers = headers; }}",How to make a property protected AND internal in C#?
C# algorithm for generating hierarchy," I've got a text file that looks like this: I'm looking for a generic C# algorithm that will create an object hierarchy from this. A ""Hierarchize"" function, if you will, that turns this data into an object hierarchy.Any ideas?edit I've already parsed the file into .NET objects: Now I need to actually arrange the objects into an object graph. <code>  { Id = 1, ParentId = 0, Position = 0, Title = ""root"" }{ Id = 2, ParentId = 1, Position = 0, Title = ""child 1"" }{ Id = 3, ParentId = 1, Position = 1, Title = ""child 2"" }{ Id = 4, ParentId = 1, Position = 2, Title = ""child 3"" }{ Id = 5, ParentId = 4, Position = 0, Title = ""grandchild 1"" } class Node{ public int Id { get; } public int ParentId { get; } public int Position { get; } public string Title { get; }}",C# algorithm for generating hierarchy
How to deserialize a text file into an object graph (C#)?," I've got a text file that looks like this: I'm looking for a generic C# algorithm that will create an object hierarchy from this. A ""Hierarchize"" function, if you will, that turns this data into an object hierarchy.Any ideas?edit I've already parsed the file into .NET objects: Now I need to actually arrange the objects into an object graph. <code>  { Id = 1, ParentId = 0, Position = 0, Title = ""root"" }{ Id = 2, ParentId = 1, Position = 0, Title = ""child 1"" }{ Id = 3, ParentId = 1, Position = 1, Title = ""child 2"" }{ Id = 4, ParentId = 1, Position = 2, Title = ""child 3"" }{ Id = 5, ParentId = 4, Position = 0, Title = ""grandchild 1"" } class Node{ public int Id { get; } public int ParentId { get; } public int Position { get; } public string Title { get; }}",C# algorithm for generating hierarchy
From C# to Java. A Noob question.," I wanted to learn to program and looked at both Java and C#. I decided to go with C# because it was so easy to just open a form and plop some buttons and text boxes on it. With just one download, C# Express got me going. From what I saw with Java that couldnt be done. At least not without downloading and configuring other software. All of which I found no easy instructions for. But I really wanted to learn Java. I really dont want to learn how to create UIs AND a new language. Id rather just to concentrate on the code itself. Is there an easy way (like C# basically) to create Java apps? <code> ",What is the Java equivalent to C#'s Windows Forms for building GUI apps easily and rapidly
IXmlSerializable & Objects," I need to be able to Xml Serialize a class which is internal, so I must implement IXmlSerializable.This class has a two strings and a List in it.I know to read and write the strings using WriteElementString & ReadElementContentAsString.However, I'm lost on how to read & write the List in the ReadXml & WriteXml methods.How do I do this, or is there a way to serialize and deserialize the object while maintaining it's internal accessibility? <code> ",Implementing IXmlSerializable for Classes Containing Collections
Loop Though An Objects Properties In C#," I have two objects of the same type, and I want to loop through the public properties on each of them and alert the user about which properties don't match.Is it possible to do this without knowing what properties the object contains? <code> ",Compare two objects' properties to find differences?
Loop Through An Objects Properties In C#," I have two objects of the same type, and I want to loop through the public properties on each of them and alert the user about which properties don't match.Is it possible to do this without knowing what properties the object contains? <code> ",Compare two objects' properties to find differences?
C#:  wcf return an XmlDocument?, I have a WCF service where Im building up a block of XML using an XmlWriter. Once complete I want to have the WCF return it as an XmlDocument.But if I have XmlDocument in the [OperationContract] it doesnt work: The WCF test utility gives: System.Runtime.Serialization.InvalidDataContractException: Type 'System.Xml.XmlDocument' cannot be serialized. <code>  [OperationContract]XmlDocument GetNextLetter();,wcf return an XmlDocument?
What's better? INotifyPropertyChanged or having separate xxxChanged events?," I'm designing a new class in C# which has a few properties. My users will want to know when each of them changes.What's a better choice? INotifyPropertyChanged style of implementation, or just having separate events corresponding to my properties? Or both? <code> ",What's better? INotifyPropertyChanged or having separate *Changed events?
C# List<> Order with 3 properties," Say I have a Person class with Name, Age, Level properties.I know how to order by one of the properties, with But how can I order by Name, Age and Level.An equivalente of the sql sentence : ORDER BY Name, Age, LevelThank you <code>  PersonList.Sort(delegate(Person p1, Person p2) { return p1.Name.CompareTo(p2.Name); });",C# List<> Order with 3 properties .Net 2.0
How can I easily create a .NET HttpWebRequest class from a Socket's recieved byte[]'s," I have a socket that is receiving HTTP requests.So I have a raw http request in byte[] form from my socket.I have to study this request - BUTInstead of reinventing the wheel - can I 'cast' this byte array into a System.Net.HttpWebRequest or something similar?----- UPDATE ---------So anyway I couldn't find the answer. By digging a little further though I think it could be done by calling functions in:HttpApi.dll I think that the HttpWebRequest uses this dll (winxpsp2)the interesting structure is the HTTP_REQUEST I have only just started C# so delving into ??COM?? programming is over my head.AND looking through the ducumentation, I cant see an 'entry' (by which I mean a simple send bytes-> receieve HTTP_REQUEST).Anyhoo! if anyone wants to point me in the direction of some nice WINDOWS KERNEL MODE HTTP SERVERS INCLUDING SSL then feel free it would be a great read and something to consider for the future. <code>  C++typedef struct _HTTP_REQUEST { ULONG Flags; HTTP_CONNECTION_ID ConnectionId; HTTP_REQUEST_ID RequestId; HTTP_URL_CONTEXT UrlContext; HTTP_VERSION Version; HTTP_VERB Verb; USHORT UnknownVerbLength; USHORT RawUrlLength; PCSTR pUnknownVerb; PCSTR pRawUrl; HTTP_COOKED_URL CookedUrl; HTTP_TRANSPORT_ADDRESS Address; HTTP_REQUEST_HEADERS Headers; ULONGLONG BytesReceived; USHORT EntityChunkCount; PHTTP_DATA_CHUNK pEntityChunks; HTTP_RAW_CONNECTION_ID RawConnectionId; PHTTP_SSL_INFO pSslInfo;}HTTP_REQUEST_V1, *PHTTP_REQUEST_V1;",How Create a .NET HttpWebRequest class from a Socket's received byte[]'s
How Create a .NET HttpWebRequest class from a Socket's recieved byte[]'s," I have a socket that is receiving HTTP requests.So I have a raw http request in byte[] form from my socket.I have to study this request - BUTInstead of reinventing the wheel - can I 'cast' this byte array into a System.Net.HttpWebRequest or something similar?----- UPDATE ---------So anyway I couldn't find the answer. By digging a little further though I think it could be done by calling functions in:HttpApi.dll I think that the HttpWebRequest uses this dll (winxpsp2)the interesting structure is the HTTP_REQUEST I have only just started C# so delving into ??COM?? programming is over my head.AND looking through the ducumentation, I cant see an 'entry' (by which I mean a simple send bytes-> receieve HTTP_REQUEST).Anyhoo! if anyone wants to point me in the direction of some nice WINDOWS KERNEL MODE HTTP SERVERS INCLUDING SSL then feel free it would be a great read and something to consider for the future. <code>  C++typedef struct _HTTP_REQUEST { ULONG Flags; HTTP_CONNECTION_ID ConnectionId; HTTP_REQUEST_ID RequestId; HTTP_URL_CONTEXT UrlContext; HTTP_VERSION Version; HTTP_VERB Verb; USHORT UnknownVerbLength; USHORT RawUrlLength; PCSTR pUnknownVerb; PCSTR pRawUrl; HTTP_COOKED_URL CookedUrl; HTTP_TRANSPORT_ADDRESS Address; HTTP_REQUEST_HEADERS Headers; ULONGLONG BytesReceived; USHORT EntityChunkCount; PHTTP_DATA_CHUNK pEntityChunks; HTTP_RAW_CONNECTION_ID RawConnectionId; PHTTP_SSL_INFO pSslInfo;}HTTP_REQUEST_V1, *PHTTP_REQUEST_V1;",How Create a .NET HttpWebRequest class from a Socket's received byte[]'s
How to get the MonthName in c#?," How does one go about finding the month name in C#? I don't want to write a huge switch statement or if statement on the month int. In VB.Net you can use MonthName(), but what about C#? <code> ",How to get the month name in C#?
What is the fastest way to combine to xml file into one," If I have two string of xml1 and xml2 which both represent xml in the same format. What is the fastest way to combine these together? The format is not important, but I just want to know how can I get rid off or ?xml1 : xm2 : and have something like this :  <code>  <?xml version=""1.0"" encoding=""utf-8""?><AllNodes> <NodeA> <NodeB>test1</NodeB> <NodeB>test2</NodeB> </NodeA></AllNodes> <?xml version=""1.0"" encoding=""utf-8""?><AllNodes> <NodeA> <NodeB>test6</NodeB> <NodeB>test7</NodeB> </NodeA> <NodeA> <NodeB>test99</NodeB> <NodeB>test23</NodeB> </NodeA></AllNodes> <?xml version=""1.0"" encoding=""utf-8""?> <AllNodes> <NodeA> <NodeB>test1</NodeB> <NodeB>test2</NodeB> </NodeA> <NodeA> <NodeB>test6</NodeB> <NodeB>test7</NodeB> </NodeA> <NodeA> <NodeB>test99</NodeB> <NodeB>test23</NodeB> </NodeA> </AllNodes>",What is the fastest way to combine two xml files into one
What is the fastest way to combine two xml file into one," If I have two string of xml1 and xml2 which both represent xml in the same format. What is the fastest way to combine these together? The format is not important, but I just want to know how can I get rid off or ?xml1 : xm2 : and have something like this :  <code>  <?xml version=""1.0"" encoding=""utf-8""?><AllNodes> <NodeA> <NodeB>test1</NodeB> <NodeB>test2</NodeB> </NodeA></AllNodes> <?xml version=""1.0"" encoding=""utf-8""?><AllNodes> <NodeA> <NodeB>test6</NodeB> <NodeB>test7</NodeB> </NodeA> <NodeA> <NodeB>test99</NodeB> <NodeB>test23</NodeB> </NodeA></AllNodes> <?xml version=""1.0"" encoding=""utf-8""?> <AllNodes> <NodeA> <NodeB>test1</NodeB> <NodeB>test2</NodeB> </NodeA> <NodeA> <NodeB>test6</NodeB> <NodeB>test7</NodeB> </NodeA> <NodeA> <NodeB>test99</NodeB> <NodeB>test23</NodeB> </NodeA> </AllNodes>",What is the fastest way to combine two xml files into one
How to detect if the mouse is inside the whole form and child controls in C#?," I need to detect when the user moves the mouse over the Form and all its child controls and also when it leaves the Form. I tried the MouseEnter and MouseLeave events of the Form, I tried the WM_MOUSEMOVE & WM_MOUSELEAVE and WM_NCMOUSEMOVE & WM_NCMOUSELEAVE pairs of windows messages but none seem to work as I want...Most of my Form is occupied by child controls of many sorts, there's not much client area visible. This means that if I move the mouse very quickly the mouse movement will not be detected, although the mouse is inside the Form.For instance, I have a TextBox that is docked at the bottom and between the desktop and the TextBox, there's only a very small border. If I quickly move the mouse from the bottom into the TextBox, the mouse movement won't be detected, but the mouse is inside the TextBox, therefore, inside the Form.How can I achieve what I need? <code> ",How to detect if the mouse is inside the whole form and child controls?
How do I bind a Combo so the displaymember is concat of 2 fields of source datatable?," I'd like to bind a ComboBox to a DataTable (I cannot alter its original schema) I want the ComboBox show tbldata.Name + tbldata.Surname.Of course adding the new name+surname as a field to the tbldata just before binding is possible, but I am hoping for a more elegant solution along the lines of (pseudocode) <code>  cbo.DataSource = tbldata;cbo.DataTextField = ""Name"";cbo.DataValueField = ""GUID"";cbo.DataBind(); cbo.DataTextField = ""Name"";cbo.DataTextField += ""Surname"";",How do I bind a ComboBox so the displaymember is concat of 2 fields of source datatable?
"How to fix ""The ConnectionString property has not been initialized"" ?"," When I start my application I get: The ConnectionString property has not been initialized.Web.config: The stack being: I'm fairly new to .NET and I don't get this one. I found a lot of answers on Google, but none really fixed my issue.What does that mean? Is my web.config bad? Is my function bad? Is my SQL configuration not working correctly (I'm using sqlexpress)?My main problem here is that I'm not sure where to start to debug this... anything would help.EDIT:Failling code: sqlQuery is a query like ""select * from table"". sqlParams is not relevant here.The other problem here is that my company uses MySQLHelper, and I have no visibility over it (only have a dll for a helper lib). It has been working fine in other projects, so I'm 99% that the error doesn't come from here.I guess if there's no way of debuging it without seeing the code I'll have to wait to get in touch with the person who created this helper in order to get the code. <code>  <connectionStrings> <add name=""MyDB"" connectionString=""Data Source=localhost\sqlexpress;Initial Catalog=mydatabase;User Id=myuser;Password=mypassword;"" /></connectionStrings> System.Data.SqlClient.SqlConnection.PermissionDemand() +4876643System.Data.SqlClient.SqlConnectionFactory.PermissionDemand(DbConnection outerConnection) +20System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory) +117System.Data.SqlClient.SqlConnection.Open() +122 MySQLHelper.ExecuteNonQuery(ConfigurationManager.AppSettings[""ConnectionString""],CommandType.Text,sqlQuery,sqlParams);","How to fix ""The ConnectionString property has not been initialized"""
Use Linq to find repeating elements," Let's assume I have a list with objects of type Value. Value has a Name property: Now I want to get a list of all ""repeating"" values (elements where the name property was identical with the name property of the previous element).In this example I want a list with the two elements ""world"" and ""a"" (id = 2 and 5) to be returned.Is this event possible with linq?Of course I could so smth. like this: but since I want to use this query in a more complex context, maybe there is a ""linqish"" solution. <code>  private List<Value> values = new List<Value> { new Value { Id = 0, Name = ""Hello"" }, new Value { Id = 1, Name = ""World"" }, new Value { Id = 2, Name = ""World"" }, new Value { Id = 3, Name = ""Hello"" }, new Value { Id = 4, Name = ""a"" }, new Value { Id = 5, Name = ""a"" },}; List<Value> tempValues = new List<Value>();String lastName = String.Empty();foreach (var v in values){ if (v.Name == lastName) tempValues.Add(v); lastName = v.Name;}",Use Linq to find consecutively repeating elements
Parse and execute formulas with C#," I am looking for an open source library to parse and execute formula/functions in C#.I would like to create a bunch of objects that derive from an interface (i.e. IFormulaEntity) which would have properties/methods/values and the allow a user to specify formulas for those objects.For example, I might have Then allow an application user to write something like; This ""looks like C#"" but it would be a simplified programming language. I know it's alot to ask. I would expect my users to be reasonably capable (i.e. can write their own Excel formulas). <code>  public class Employee : IForumulaEntity{ public double Salary { get; set; } public void SendMessage(string message)} Employee person = <get from datasource>if (person.Salary > 1000) person.Salary += 1000;person.SendMessage(""Hello"");",Parse and execute formulas with C#
**DELETE MY ACCOUNT**," I am looking for an open source library to parse and execute formula/functions in C#.I would like to create a bunch of objects that derive from an interface (i.e. IFormulaEntity) which would have properties/methods/values and the allow a user to specify formulas for those objects.For example, I might have Then allow an application user to write something like; This ""looks like C#"" but it would be a simplified programming language. I know it's alot to ask. I would expect my users to be reasonably capable (i.e. can write their own Excel formulas). <code>  public class Employee : IForumulaEntity{ public double Salary { get; set; } public void SendMessage(string message)} Employee person = <get from datasource>if (person.Salary > 1000) person.Salary += 1000;person.SendMessage(""Hello"");",Parse and execute formulas with C#
performanc of byte vs. int in .NET," In pre-.NET world I always assumed that int is faster than byte since this is how processor works.Now it's matter habit of using int even when bytes could work, for example when byte is what is stored in database Question: How .NET handles byte type versus int from point view of performance/memory.Update:Thanks for the input. Unfortunately, nobody really answered the question. How .NET handles byte vs. int.And if there is no difference in performance, then I like how chills42 put it:int for arithmeticsbytes for binaryWhich I will continue to do. <code> ",performance of byte vs. int in .NET
Favorite way to create an new IEnumerable<T> sequence in C#?," I usually create a sequence from a single value using array syntax, like this: Or using a new List. I'd like to hear if anyone has a more expressive way to do the same thing. <code>  IEnumerable<string> sequence = new string[] { ""abc"" };",Favorite way to create an new IEnumerable<T> sequence from a single value?
observer pattern implemented in C# with delegates?," There is a question already answered which is In C#, isn't the observer pattern already implemented using Events?It asks if the observer pattern is already implemented in c# using events.While I get the events and observer pattern, isn't the observer pattern really just delegates and events is a further implementation? <code> ",Observer pattern implemented in C# with delegates?
How does HashSet differ from Set?," Old questionMy understanding is that C# has in some sense HashSet and set types. I understand what HashSet is. But why set is a separate word? Why not every set is HashSet<Object>?New questionWhy does C# has no generic Set type, similar to Dictionary type? From my point of view, I would like to have a set with standard lookup/addition/deletion performance. I wouldn't care much whether it is realized with hashes or something else. So why not make a set class that would actually be implemented as a HashSet in this version of C# but perhaps somewhat different in a future version?Or why not at least interface ISet?AnswerLearned thanks to everyone who answered below: ICollection implements a lot of what you'd expect from ISet. From my point of view, though, ICollection implements IEnumerable while sets don't have to be enumerable --- example: set of real numbers between 1 and 2 (even more, sets can be generated dynamically). I agree this is a minor rant, as 'normal programmers' rarely need uncountable sets.Ok, I think I get it. HashSet was absolutely meant to be called Set but the word Set is reserved in some sense. More specifically, creators of .NET architecture wanted to have a consistent set (sic!) of classes for different languages. This means that every name of the standard class must not coincide with any keyword in the .NET languages. The word Set, however, is used in VB.NET which is actually case-insensitive (is it?) so unfortunately there is no room for maneuvre there.Mystery solved :)EpilogueThe new answer by Alex Y. links to the MSDN page which describes the upcoming .NET 4.0 interface ISet which behaves pretty much as I thought it should and is implemented by HashedSet. Happy end.  <code> ",Why have HashSet but not Set in C#?
What is the difference between HashSet and Set in C#?," Old questionMy understanding is that C# has in some sense HashSet and set types. I understand what HashSet is. But why set is a separate word? Why not every set is HashSet<Object>?New questionWhy does C# has no generic Set type, similar to Dictionary type? From my point of view, I would like to have a set with standard lookup/addition/deletion performance. I wouldn't care much whether it is realized with hashes or something else. So why not make a set class that would actually be implemented as a HashSet in this version of C# but perhaps somewhat different in a future version?Or why not at least interface ISet?AnswerLearned thanks to everyone who answered below: ICollection implements a lot of what you'd expect from ISet. From my point of view, though, ICollection implements IEnumerable while sets don't have to be enumerable --- example: set of real numbers between 1 and 2 (even more, sets can be generated dynamically). I agree this is a minor rant, as 'normal programmers' rarely need uncountable sets.Ok, I think I get it. HashSet was absolutely meant to be called Set but the word Set is reserved in some sense. More specifically, creators of .NET architecture wanted to have a consistent set (sic!) of classes for different languages. This means that every name of the standard class must not coincide with any keyword in the .NET languages. The word Set, however, is used in VB.NET which is actually case-insensitive (is it?) so unfortunately there is no room for maneuvre there.Mystery solved :)EpilogueThe new answer by Alex Y. links to the MSDN page which describes the upcoming .NET 4.0 interface ISet which behaves pretty much as I thought it should and is implemented by HashedSet. Happy end.  <code> ",Why have HashSet but not Set in C#?
"How can I quickly create large (>1gb) text+binary files with ""natural"" content? (C#)"," For purposes of testing compression, I need to be able to create large files, ideally in text, binary, and mixed formats. The content of the files should be neither completely random nor uniform.A binary file with all zeros is no good. A binary file with totally random data is also not good. For text, a file with totally random sequences of ASCII is not good - the text files should have patterns and frequencies that simulate natural language, or source code (XML, C#, etc). Pseudo-real text.The size of each individual file is not critical, but for the set of files, I need the total to be ~8gb.I'd like to keep the number of files at a manageable level, let's say o(10). For creating binary files, I can new a large buffer and do System.Random.NextBytes followed by FileStream.Write in a loop, like this: With a large enough buffer, let's say 512k, this is relatively fast, even for files over 2 or 3gb. But the content is totally random, which is not what I want. For text files, the approach I have taken is to use Lorem Ipsum, and repeatedly emit it via a StreamWriter into a text file. The content is non-random and non-uniform, but it does has many identical repeated blocks, which is unnatural. Also, because the Lorem Ispum block is so small (<1k), it takes many loops and a very, very long time. Neither of these is quite satisfactory for me. I have seen the answers to Quickly create large file on a windows system?. Those approaches are very fast, but I think they just fill the file with zeroes, or random data, neither of which is what I want. I have no problem with running an external process like contig or fsutil, if necessary.The tests run on Windows.Rather than create new files, does it make more sense to just use files that already exist in the filesystem? I don't know of any that are sufficiently large. What about starting with a single existing file (maybe c:\windows\Microsoft.NET\Framework\v2.0.50727\Config\enterprisesec.config.cch for a text file) and replicating its content many times? This would work with either a text or binary file. Currently I have an approach that sort of works but it takes too long to run. Has anyone else solved this?Is there a much faster way to write a text file than via StreamWriter?Suggestions?EDIT: I like the idea of a Markov chain to produce a more natural text. Still need to confront the issue of speed, though. <code>  Int64 bytesRemaining = size;byte[] buffer = new byte[sz];using (Stream fileStream = new FileStream(Filename, FileMode.Create, FileAccess.Write)){ while (bytesRemaining > 0) { int sizeOfChunkToWrite = (bytesRemaining > buffer.Length) ? buffer.Length : (int)bytesRemaining; if (!zeroes) _rnd.NextBytes(buffer); fileStream.Write(buffer, 0, sizeOfChunkToWrite); bytesRemaining -= sizeOfChunkToWrite; } fileStream.Close();}","How can I quickly create large (>1gb) text+binary files with ""natural"" content? (C#)"
"bHow can I quickly create large (>1gb) text+binary files with ""natural"" content? (C#)"," For purposes of testing compression, I need to be able to create large files, ideally in text, binary, and mixed formats. The content of the files should be neither completely random nor uniform.A binary file with all zeros is no good. A binary file with totally random data is also not good. For text, a file with totally random sequences of ASCII is not good - the text files should have patterns and frequencies that simulate natural language, or source code (XML, C#, etc). Pseudo-real text.The size of each individual file is not critical, but for the set of files, I need the total to be ~8gb.I'd like to keep the number of files at a manageable level, let's say o(10). For creating binary files, I can new a large buffer and do System.Random.NextBytes followed by FileStream.Write in a loop, like this: With a large enough buffer, let's say 512k, this is relatively fast, even for files over 2 or 3gb. But the content is totally random, which is not what I want. For text files, the approach I have taken is to use Lorem Ipsum, and repeatedly emit it via a StreamWriter into a text file. The content is non-random and non-uniform, but it does has many identical repeated blocks, which is unnatural. Also, because the Lorem Ispum block is so small (<1k), it takes many loops and a very, very long time. Neither of these is quite satisfactory for me. I have seen the answers to Quickly create large file on a windows system?. Those approaches are very fast, but I think they just fill the file with zeroes, or random data, neither of which is what I want. I have no problem with running an external process like contig or fsutil, if necessary.The tests run on Windows.Rather than create new files, does it make more sense to just use files that already exist in the filesystem? I don't know of any that are sufficiently large. What about starting with a single existing file (maybe c:\windows\Microsoft.NET\Framework\v2.0.50727\Config\enterprisesec.config.cch for a text file) and replicating its content many times? This would work with either a text or binary file. Currently I have an approach that sort of works but it takes too long to run. Has anyone else solved this?Is there a much faster way to write a text file than via StreamWriter?Suggestions?EDIT: I like the idea of a Markov chain to produce a more natural text. Still need to confront the issue of speed, though. <code>  Int64 bytesRemaining = size;byte[] buffer = new byte[sz];using (Stream fileStream = new FileStream(Filename, FileMode.Create, FileAccess.Write)){ while (bytesRemaining > 0) { int sizeOfChunkToWrite = (bytesRemaining > buffer.Length) ? buffer.Length : (int)bytesRemaining; if (!zeroes) _rnd.NextBytes(buffer); fileStream.Write(buffer, 0, sizeOfChunkToWrite); bytesRemaining -= sizeOfChunkToWrite; } fileStream.Close();}","How can I quickly create large (>1gb) text+binary files with ""natural"" content? (C#)"
C#/.NET: What is the best way to combine a path and a filename?," What is the best way to combine a path with a filename?That is, given c:\foo and bar.txt, I want c:\foo\bar.txt.Given c:\foo and ..\bar.txt, I want either an error or c:\foo\bar.txt (so I cannot use Path.Combine() directly). Similarly for c:\foo and bar/baz.txt, I want an error or c:\foo\baz.txt (not c:\foo\bar\baz.txt).I realize, I could check that the filename does not contain '\' or '/', but is that enough? If not, what is the correct check? <code> ",What is the best way to combine a path and a filename in C#/.NET?
ItemsControl with horisontal orientation, Do you know any controls inherited from the ItemsControl that have horizontal orientation of items? <code> ,ItemsControl with horizontal orientation
How defensive should i program?," i was working with a small routine that is used to create a database connection:Before Then i began looking into the .NET framework documentation, to see what the documented behaviour of various things are, and seeing if i can handle them.For example: The documentation says that calling ConnectionStrings throws a ConfigurationErrorException if it could not retrieve the collection. In this case there is nothing i can do to handle this exception, so i will let it go.Next part is the actual indexing of the ConnectionStrings to find connectionName: In this instance the ConnectionStrings documentation says that the property will return null if the connection name could not be found. i can check for this happening, and throw an exception to let someone high up that they gave an invalid connectionName: i repeat the same excercise with: The GetFactory method has no documentation on what happens if a factory for the specified ProviderName couldn't be found. It's not documented to return null, but i can still be defensive, and check for null: Next is construction of the DbConnection object: Again the documentation doesn't say what happens if it couldn't create a connection, but again i can check for a null return object: Next is setting a property of the Connection object: The docs don't say what happens if it could not set the connection string. Does it throw an exception? Does it ignore it? As with most exception, if there was an error while trying to set the ConnectionString of a connection, there's nothing i can do to recover from it. So i'll do nothing.And finally, opening the database connection: The Open method of DbConnection is abstract, so it's up to whatever provider is descending from DbConnection to decide what exceptions they throw. There is also no guidance in the abstract Open methods documentation about what i can expect to happen if there's an error. If there was an error connecting, i know i cannot handle it - i'll have to let it bubble up where the caller can show some UI to the user, and let them try again.After SummarySo my four line function, became 12 lines, and required 5 mintues of documentation lookup. In the end i did catch one case where a method is allowed to return null. But in practice all i did was convert an access violation exception (if i attempts to call methods on a null reference) into an InvalidArgumentException. i also catch two possible cases where there could be null return objects; but again i only traded one exception for another. On the positive side, it did catch two problems, and explain what happened in the exception message, rather than bad things happening down the road (i.e. the buck stops here)But is it worth it? Is this overkill? Is this defensive programming gone awry?  <code>  public DbConnection GetConnection(String connectionName){ ConnectionStringSettings cs= ConfigurationManager.ConnectionStrings[connectionName]; DbProviderFactory factory = DbProviderFactories.GetFactory(cs.ProviderName); DbConnection conn = factory.CreateConnection(); conn.ConnectionString = cs.ConnectionString; conn.Open(); return conn;} ConfigurationManager.ConnectionStrings... ...ConnectionStrings[connectionName]; ConnectionStringSettings cs= ConfigurationManager.ConnectionStrings[connectionName];if (cs == null) throw new ArgumentException(""Could not find connection string \""""+connectionName+""\""""); DbProviderFactory factory = DbProviderFactories.GetFactory(cs.ProviderName); DbProviderFactory factory = DbProviderFactories.GetFactory(cs.ProviderName);if (factory == null) throw new Exception(""Could not obtain factory for provider \""""+cs.ProviderName+""\""""); DbConnection conn = factory.CreateConnection() DbConnection conn = factory.CreateConnection()if (conn == null) throw new Exception.Create(""Connection factory did not return a connection object""); conn.ConnectionString = cs.ConnectionString; conn.Open(); public DbConnection GetConnection(String connectionName){ //Get the connection string info from web.config ConnectionStringSettings cs= ConfigurationManager.ConnectionStrings[connectionName]; //documented to return null if it couldn't be found if (cs == null) throw new ArgumentException(""Could not find connection string \""""+connectionName+""\""""); //Get the factory for the given provider (e.g. ""System.Data.SqlClient"") DbProviderFactory factory = DbProviderFactories.GetFactory(cs.ProviderName); //Undefined behaviour if GetFactory couldn't find a provider. //Defensive test for null factory anyway if (factory == null) throw new Exception(""Could not obtain factory for provider \""""+cs.ProviderName+""\""""); //Have the factory give us the right connection object DbConnection conn = factory.CreateConnection(); //Undefined behaviour if CreateConnection failed //Defensive test for null connection anyway if (conn == null) throw new Exception(""Could not obtain connection from factory""); //Knowing the connection string, open the connection conn.ConnectionString = cs.ConnectionString; conn.Open() return conn;}",How defensively should I program?
How defensive should I program?," i was working with a small routine that is used to create a database connection:Before Then i began looking into the .NET framework documentation, to see what the documented behaviour of various things are, and seeing if i can handle them.For example: The documentation says that calling ConnectionStrings throws a ConfigurationErrorException if it could not retrieve the collection. In this case there is nothing i can do to handle this exception, so i will let it go.Next part is the actual indexing of the ConnectionStrings to find connectionName: In this instance the ConnectionStrings documentation says that the property will return null if the connection name could not be found. i can check for this happening, and throw an exception to let someone high up that they gave an invalid connectionName: i repeat the same excercise with: The GetFactory method has no documentation on what happens if a factory for the specified ProviderName couldn't be found. It's not documented to return null, but i can still be defensive, and check for null: Next is construction of the DbConnection object: Again the documentation doesn't say what happens if it couldn't create a connection, but again i can check for a null return object: Next is setting a property of the Connection object: The docs don't say what happens if it could not set the connection string. Does it throw an exception? Does it ignore it? As with most exception, if there was an error while trying to set the ConnectionString of a connection, there's nothing i can do to recover from it. So i'll do nothing.And finally, opening the database connection: The Open method of DbConnection is abstract, so it's up to whatever provider is descending from DbConnection to decide what exceptions they throw. There is also no guidance in the abstract Open methods documentation about what i can expect to happen if there's an error. If there was an error connecting, i know i cannot handle it - i'll have to let it bubble up where the caller can show some UI to the user, and let them try again.After SummarySo my four line function, became 12 lines, and required 5 mintues of documentation lookup. In the end i did catch one case where a method is allowed to return null. But in practice all i did was convert an access violation exception (if i attempts to call methods on a null reference) into an InvalidArgumentException. i also catch two possible cases where there could be null return objects; but again i only traded one exception for another. On the positive side, it did catch two problems, and explain what happened in the exception message, rather than bad things happening down the road (i.e. the buck stops here)But is it worth it? Is this overkill? Is this defensive programming gone awry?  <code>  public DbConnection GetConnection(String connectionName){ ConnectionStringSettings cs= ConfigurationManager.ConnectionStrings[connectionName]; DbProviderFactory factory = DbProviderFactories.GetFactory(cs.ProviderName); DbConnection conn = factory.CreateConnection(); conn.ConnectionString = cs.ConnectionString; conn.Open(); return conn;} ConfigurationManager.ConnectionStrings... ...ConnectionStrings[connectionName]; ConnectionStringSettings cs= ConfigurationManager.ConnectionStrings[connectionName];if (cs == null) throw new ArgumentException(""Could not find connection string \""""+connectionName+""\""""); DbProviderFactory factory = DbProviderFactories.GetFactory(cs.ProviderName); DbProviderFactory factory = DbProviderFactories.GetFactory(cs.ProviderName);if (factory == null) throw new Exception(""Could not obtain factory for provider \""""+cs.ProviderName+""\""""); DbConnection conn = factory.CreateConnection() DbConnection conn = factory.CreateConnection()if (conn == null) throw new Exception.Create(""Connection factory did not return a connection object""); conn.ConnectionString = cs.ConnectionString; conn.Open(); public DbConnection GetConnection(String connectionName){ //Get the connection string info from web.config ConnectionStringSettings cs= ConfigurationManager.ConnectionStrings[connectionName]; //documented to return null if it couldn't be found if (cs == null) throw new ArgumentException(""Could not find connection string \""""+connectionName+""\""""); //Get the factory for the given provider (e.g. ""System.Data.SqlClient"") DbProviderFactory factory = DbProviderFactories.GetFactory(cs.ProviderName); //Undefined behaviour if GetFactory couldn't find a provider. //Defensive test for null factory anyway if (factory == null) throw new Exception(""Could not obtain factory for provider \""""+cs.ProviderName+""\""""); //Have the factory give us the right connection object DbConnection conn = factory.CreateConnection(); //Undefined behaviour if CreateConnection failed //Defensive test for null connection anyway if (conn == null) throw new Exception(""Could not obtain connection from factory""); //Knowing the connection string, open the connection conn.ConnectionString = cs.ConnectionString; conn.Open() return conn;}",How defensively should I program?
The type <type> exists in both dlls," I have 1 DLL in the .Net 3.5 framework and another in 2.0. The ListBoxItem class exists in 2.0 and I have linked the class in the 3.5 DLL in the same namespace.When I try to compile I get an ""exists in both"" error. How can I compile this and maintain the same structure.I don't want reference the 2.0 DLL to 3.5 to eliminate this problem, I want keep these DLLs separate. <code> ",The type <type> exists in both DLLs
Automatic files uploading," UPDATEDSee post #3 below.There is a need to upload a file to the web automatically (without browser). Host - Mini File Host v1.2 (if this does matter). Didn't find specific api in documentation, so at first i sniffed browser requests in Firebug as follows : Here we can see parameter, headers, content type and chunks of information (1 - file name and type, 2 - file contents, 3 - additional params - description and password, not necessarily applied).So i've created a class that emulates such a behaviour step by step : HttpWebRequest on the url, apply needed parameters to request, form request strings with StringBuilder and convert them to byte arrays, read a file using FileStream, putting all that stuff to MemoryStream and then writing it to request (took major part of a code from an article at CodeProject where it uploads a file to Rapidshare host). Neat and tidy, but... It doesn't seem to work :(. As result it returns initial upload page, not a result page with links i could parse and present to a user... Here are main methods of an Uploader class : Plays with ProtocolVersion (1.0, 1.1), AllowAutoRedirect (true/false), even known ServicePoint.Expect100Continue (false) didn't fix an issue. Even a 5sec timeout before getting response (thought in case of a big file it doesn't uploads so quick) didn't help.Content type ""octet-stream"" was chosen by purpose to upload any file (could use some switch for most popular jpg/zip/rar/doc etc., but that one seems universal). Boundary is generated randomly from timer ticks, not a big deal. What else? :/I could give up and forget this, but i feel i'm pretty close to solve and then forget about it :P.In case you need the whole application to run and debug - here it is (70kb, zipped C# 2.0 VS2k8 solution, no ads, no viruses) :@Mediafire@FileQube@FileDropper <code>  Params : doValue : verifyPOST /upload.php?do=verify HTTP/1.1Host: webfile.ukrwest.netUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.2; ru; rv:1.9.0.8) Gecko/2009032609 Firefox/3.0.8 (.NET CLR 4.0.20506)Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: ru,en-us;q=0.7,en;q=0.3Accept-Encoding: gzip,deflateAccept-Charset: windows-1251,utf-8;q=0.7,*;q=0.7Keep-Alive: 300Connection: keep-aliveReferer: http://filehoster.awardspace.com/index.phpContent-Type: multipart/form-data; boundary=---------------------------27368237179714Content-Length: 445-----------------------------27368237179714Content-Disposition: form-data; name=""upfile""; filename=""Test.file""Content-Type: application/octet-stream12345678901011121314151617sample text-----------------------------27368237179714Content-Disposition: form-data; name=""descr""-----------------------------27368237179714Content-Disposition: form-data; name=""pprotect""-----------------------------27368237179714-- // Step 1 - request creation private HttpWebRequest GetWebrequest(string boundary) { Uri uri = new Uri(""http://filehoster.awardspace.com/index.php?do=verify""); System.Net.HttpWebRequest httpWebRequest = (System.Net.HttpWebRequest)System.Net.WebRequest.Create(uri); httpWebRequest.CookieContainer = _cookies; httpWebRequest.ContentType = ""multipart/form-data; boundary="" + boundary; httpWebRequest.UserAgent = ""Mozilla/5.0 (Windows; U; Windows NT 5.2; ru; rv:1.9.0.8) Gecko/2009032609 Firefox/3.0.8 (.NET CLR 4.0.20506)""; httpWebRequest.Referer = ""http://filehoster.awardspace.com/index.php""; httpWebRequest.Method = ""POST""; httpWebRequest.KeepAlive = true; httpWebRequest.Timeout = -1; //httpWebRequest.Accept = ""text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8""; httpWebRequest.Headers.Add(""Accept-Charset"", ""windows-1251,utf-8;q=0.7,*;q=0.7""); httpWebRequest.Headers.Add(""Accept-Encoding"", ""gzip,deflate""); httpWebRequest.Headers.Add(""Accept-Language"", ""ru,en-us;q=0.7,en;q=0.3""); //httpWebRequest.AllowAutoRedirect = true; //httpWebRequest.ProtocolVersion = new Version(1,1); //httpWebRequest.SendChunked = true; //httpWebRequest.Headers.Add(""Cache-Control"", ""no-cache""); //httpWebRequest.ServicePoint.Expect100Continue = false; return httpWebRequest;}// Step 2 - first message part (before file contents)private string GetRequestMessage(string boundary, string FName, string description, string password){ System.Text.StringBuilder stringBuilder = new StringBuilder(); stringBuilder.Append(""--""); stringBuilder.Append(boundary); stringBuilder.Append(""\r\n""); stringBuilder.Append(""Content-Disposition: form-data; name=\""""); stringBuilder.Append(""upfile""); stringBuilder.Append(""\""; filename=\""""); stringBuilder.Append(FName); stringBuilder.Append(""\""""); stringBuilder.Append(""\r\n""); stringBuilder.Append(""Content-Type: application/octet-stream""); stringBuilder.Append(""\r\n""); return stringBuilder.ToString();}// Step 4 - additional request parameters. Step 3 - reading file is in method belowprivate string GetRequestMessageEnd(string boundary){ System.Text.StringBuilder stringBuilder = new StringBuilder(); stringBuilder.Append(boundary); stringBuilder.Append(""\r\n""); stringBuilder.Append(""Content-Disposition: form-data; name=\""descr\""""); stringBuilder.Append(""\r\n""); stringBuilder.Append(""\r\n""); stringBuilder.Append(""Default description""); stringBuilder.Append(""\r\n""); stringBuilder.Append(boundary); stringBuilder.Append(""\r\n""); stringBuilder.Append(""Content-Disposition: form-data; name=\""pprotect\""""); stringBuilder.Append(""\r\n""); stringBuilder.Append(""\r\n""); stringBuilder.Append(""""); stringBuilder.Append(""\r\n""); stringBuilder.Append(boundary); stringBuilder.Append(""--""); //stringBuilder.Append(""\r\n""); //stringBuilder.Append(boundary); //stringBuilder.Append(""\r\n""); return stringBuilder.ToString();}// Main methodpublic string ProcessUpload(string FilePath, string description, string password){ // Chosen file information FileSystemInfo _file = new FileInfo(FilePath); // Random boundary generation DateTime dateTime2 = DateTime.Now; long l2 = dateTime2.Ticks; string _generatedBoundary = ""----------"" + l2.ToString(""x""); // Web request creation System.Net.HttpWebRequest httpWebRequest = GetWebrequest(_generatedBoundary); // Main app block - form and send request using (System.IO.FileStream fileStream = new FileStream(_file.FullName, FileMode.Open, FileAccess.Read, FileShare.Read)) { byte[] bArr1 = Encoding.ASCII.GetBytes(""\r\n--"" + _generatedBoundary + ""\r\n""); // Generating pre-content post message string firstPostMessagePart = GetRequestMessage(_generatedBoundary, _file.Name, description, password); // Writing first part of request byte[] bArr2 = Encoding.UTF8.GetBytes(firstPostMessagePart); Stream memStream = new MemoryStream(); memStream.Write(bArr1, 0, bArr1.Length); memStream.Write(bArr2, 0, bArr2.Length); // Writing file byte[] buffer = new byte[1024]; int bytesRead = 0; while ((bytesRead = fileStream.Read(buffer, 0, buffer.Length)) != 0) { memStream.Write(buffer, 0, bytesRead); } // Generating end of a post message string secondPostMessagePart = GetRequestMessageEnd(_generatedBoundary); byte[] bArr3 = Encoding.UTF8.GetBytes(secondPostMessagePart); memStream.Write(bArr3, 0, bArr3.Length); // Preparing to send httpWebRequest.ContentLength = memStream.Length; fileStream.Close(); Stream requestStream = httpWebRequest.GetRequestStream(); memStream.Position = 0; byte[] tempBuffer = new byte[memStream.Length]; memStream.Read(tempBuffer, 0, tempBuffer.Length); memStream.Close(); // Sending request requestStream.Write(tempBuffer, 0, tempBuffer.Length); requestStream.Close(); } // Delay (?) System.Threading.Thread.Sleep(5000); // Getting response string strResponse = """"; using (Stream stream = httpWebRequest.GetResponse().GetResponseStream()) using (StreamReader streamReader = new StreamReader(stream/*, Encoding.GetEncoding(1251)*/)) { strResponse = streamReader.ReadToEnd(); } return strResponse;}",Big files uploading (WebException: The connection was closed unexpectedly)
Is there a way to specify application icon for a click once application manifest using Mage/MageUI?," I need a way to specify an application icon for a ClickOnce deployment. Basically this will be the icon shown for the application shortcut in the Start Menu - Program Files, also during the installation of the application.I can do this from the Visual Studio IDE (by specifying the application icon in the application tab of the project properties).But I can not figure out a way to do this using Mage/MageUI. Is there way to do this using Mage/MageUI? <code> ",Is there a way to specify the application icon for a ClickOnce application manifest using Mage/MageUI?
PdfSharp save to MemoryStream," I want to save a PdfSharp.Pdf.PdfDocument by its Save method to a Stream, but it doesn't attach the PDF header settings to it. So when I read back the Stream and return it to the user, he see that the PDF file is invalid. Is there a solution to attach the PDF header settings when PDFsharp saves to memory? <code> ",PDFsharp save to MemoryStream
In C# what is the difference between a destructor and a Finalize method in a class," What is the difference, if there is one, between a destructor and a Finalize method in a class?I recently discovered that Visual Studio 2008 considers a destructor synonymous with a Finalize method, meaning that Visual Studio won't let you simultaneously define both methods in a class.For example, the following code fragment: Gives the following error on the call to Finalize in the destructor: The call is ambiguous between the following methods or properties: 'TestFinalize.~TestFinalize()' and 'TestFinalize.Finalize()'And if the call to Finalize is commented out, it gives the following error: Type 'ManagementConcepts.Service.TestFinalize' already defines a member called 'Finalize' with the same parameter types <code>  class TestFinalize{ ~TestFinalize() { Finalize(); } public bool Finalize() { return true; }}",In C# what is the difference between a destructor and a Finalize method in a class?
How can we work with VB6 dll called from a multithreaded c# windows service application?," I'm running a multithreaded windows service that need to call a VB6 dll. There's no documentation about this VB6 dll and this legacy system supports a very critical business process.At first time (1st thread), this dll performs well. As other threads need access, it start provide wrong results.I read one guys saying: ""Just be careful of one thing if you are using VB6. Your threading model is going to have to change to support apartments if you are running a multithreaded service. VB only supports multiple single-threaded apartments, but .NET runs fully free threaded normally. The thread that calls into the VB6 DLL needs to be compatible with the DLL.""Another guy from team gave me the idea to put this ddl in a separated application domain. But I'm not sure.How can we work with VB6 dll called from a multithreaded c# windows service application? <code> ",Call VB6 DLL from a multithreaded c# windows service application?
find comport," How to find available COM ports in my PC? I am using framework v1.1. Is it possible to find all COM ports? If possible, help me solve the problem. <code> ",How to find available COM ports?
C# reportviewer control export programatically," Does anyone know if you can programmatically save a report shown in a reportviewer control in C#?When a report is shown there are ""Export to..."" buttons and I would like to automate the saving to PDF function. <code> ",Export C# reportviewer control programmatically
MD5 Encryption Given a Key in C#," I've been looking for a way to hash a given string in C# that uses a predetermined key. On my adventures through the internet trying to find an example i have seen lots of MD5CryptoServiceProvider examples which seem to use a default key for the machine, but none of them that apply a specific key. I need to have a specific key to encode data as to synchronize it to someone else's server. I hand them a hashed string and an ID number and they use that analyze the data and return a similar set to me. So is there anyway to get md5 to hash via a specific key that would be consistent to both.I would prefer this to be done in C#, but if its not possible with the libraries can you do so with some web languages like php or asp?Edit: Misunderstood the scenario I was thrown into and after a little sitting and thinking about why they would have me use a key it appears they want a key appended to the end of the string and hashed. That way the server can appended the key it has along with the data passed to ensure its a valid accessing computer. Anyways... thanks all ^_^Edit2: As my comment below says, it was the term 'salting' I was oblivious to. Oh the joys of getting thrown into something new with no directions. <code> ",MD5 Hashing Given a Key in C#
C# HashTable Vs Dictionary - Can the Dictionary be as fast?," I am trying to figure out when and why to use a Dictionary or a HashTable. I have done a bit of a search on here and have found people talking about the generic advantages of the Dictionary which I totally agree with, which leads the boxing and unboxing advantage for a slight performance gain.But I have also read the Dictionary will not always return the objects in the order they are inserted, thing it is sorted. Where as a HashTable will. As I understand it this leads to the HashTable being far faster for some situations.My question is really, what might those situations be? Am I just wrong in my assumptions above? What situations might you use to choose one above the other, (yes the last one is a bit ambiguous). <code> ",.NET HashTable Vs Dictionary - Can the Dictionary be as fast?
Best way to access a C# from a aspx file in .NET," Let's say I have two files default.aspx and the associated default.aspx.cs.default.aspx.cs: Is there a way that in the default.aspx I could do something like: ... or something similar, without having to use databinders or something complicated like this? And if there's no way around binding the data, what would be the best way to do it? <code>  protected void Page_Load(object sender, EventArgs e){ var myObject = new MyObject();} <%= myObject.SomePropertyOfThisObject%>",Best way to access properties of my code behind class from the markup in ASP.NET
Best way to access properties of my codebehind class from the markup in ASP.NET," Let's say I have two files default.aspx and the associated default.aspx.cs.default.aspx.cs: Is there a way that in the default.aspx I could do something like: ... or something similar, without having to use databinders or something complicated like this? And if there's no way around binding the data, what would be the best way to do it? <code>  protected void Page_Load(object sender, EventArgs e){ var myObject = new MyObject();} <%= myObject.SomePropertyOfThisObject%>",Best way to access properties of my code behind class from the markup in ASP.NET
"Method has to be overriden but isn't abstract, C sharp"," I want to implement a function in the base class but I also want it to be overridden in the derived classes every time. So it is more like ""abstract function but with a body"".What am I looking for? Am I looking for the right thing? <code> ",Method has to be overridden but isn't abstract?
Method has to be overriden but isn't abstract?," I want to implement a function in the base class but I also want it to be overridden in the derived classes every time. So it is more like ""abstract function but with a body"".What am I looking for? Am I looking for the right thing? <code> ",Method has to be overridden but isn't abstract?
C# - IDataReader to Object mapping using generics.," How can I map a DataReader object into a class object by using generics?For example I need to do the following: And later I need to call this class-method like the following: Note that, the Mapper - class should be able to map object of any type represented by T.  <code>  public class Mapper<T> { public static List<T> MapObject(IDataReader dr) { List<T> objects = new List<T>(); while (dr.Read()) { //Mapping goes here... } return objects; } } IDataReder dataReader = DBUtil.Fetchdata(""SELECT * FROM Book"");List<Book> bookList = Mapper<Book>.MapObject(dataReder);foreach (Book b in bookList){ Console.WriteLine(b.ID + "", "" + b.BookName);}",C# - IDataReader to Object mapping using generics
How to unit-test an MVC controller action which depends on authentification in c#?," I'd like to write (in c#) a unit-test for an MVC controller action which might return one view or the other, depending on whether the request is authenticated. How can this be done? <code> ",How to unit-test an MVC controller action which depends on authentication in c#?
Compact Framework Current Folder...., How do I know which is the current folder of an App?I mean... Is there a way to know where is the exe located from the running code? <code> ,Compact Framework Current Folder
"in c#, when we are writing a method which gets for example 6 parameter and we want to break the parameters in 3 lines, how could we break the lines? "," In c#, when we are writing a method which gets for example 6 parameters, and we want to break the parameters in 3 lines, how could we break the lines?  <code> ",How do I break lines for a method definition with many parameters in C#?
(.net) DefaultMemberAttribute - what does it do?," I've already read the MSDN article about it. It seems internally it is the way c# sets which is the function that is going to work as indexer(am I right?). Now, I've seen the following example: Now, I don't get it what it means.Thanks all. But I still can't get its usefulness, apart from the indexer thing. When are we going to call InvokeMember? <code>  [DefaultMemberAttribute(""Main"")]public class Program { public static void Main() { ... }}",DefaultMemberAttribute - what does it do?
What is the point of the key parameter in AddModelError?," I've added validation checks in my controller that modify the ModelState if the validation fails.For example: However, I never know value to pass for the key parameter in ModelState.AddModelError. (In the example, I just set it to my UI display name.) What is the parameter for and how should I use it? <code>  private bool ValidateMoney(string raw, string name, decimal min, decimal max) { try { var dec = Convert.ToDecimal(raw); if (dec < min) { throw new ArgumentOutOfRangeException(name + "" must be >= "" + min); } else if (dec > max) { throw new ArgumentOutOfRangeException(name + "" must be <= "" + max); } } catch (Exception ex) { ModelState.AddModelError(name, ex.GetUserMessage()); } return ModelState.IsValid;}",What is the point of the key parameter in ModelState.AddModelError in ASP.NET MVC?
C# Web Browser Control," I am trying to use C# to access the content of a webpage. For example, I want to grab the text of the body of google homepage. I know this is doable in C# with its web browser control. But I couldn't find a good, simple example of doing it. All the resources I found online involve creating Forms and GUI, which I don't need, I just need a good old Console Application.If anyone can provide a simple console-based code snippet that accomplishes the above, it'll be greatly appreciated. <code> ",Access the Contents of a Web Page with C#
Why is instantiating a collection of new generic objects in a generic method slow?," The code below is extremely slow for tables of any significant size. (100, 1000, etc...) The culprit is instantiating my objects with new T(). Note that this isn't my finalized code, I've just broken parts of it out in order to more easily profile. Instantiation and initialization will happen together once I refactor the code back into shape.Is there any way to speed this up? I'm probably forgetting something really simple, or maybe I'm boned. Hopefully, the former. edit for more info:The constructor of any given ModelType will look like this: The constructor of any given ModelTypeInfo will simply set some string and string[] values, and that class' only job is to provide the values set.edit for even more info:Since it seems to be a hot topic, here is what my method looks like for reals before breaking out object construction and initialization: <code>  public static IList<T> ToList<T>(this DataTable table) where T : Model, new(){ T[] entities = new T[table.Rows.Count]; // THIS LOOP IS VERY VERY SLOW for (int i = 0; i < table.Rows.Count; i++) entities[i] = new T(); // THIS LOOP IS FAST for (int i = 0; i < table.Rows.Count; i++) entities[i].Init(table, table.Rows[i]); return new List<T>(entities);} public ModelType(){ _modelInfo = new ModelTypeInfo();} public static IList<T> ToList<T>(this DataTable table, ModelInfo modelInfo) where T : Model, new(){ var tempRepository = new Repository<T>(modelInfo); var list = new List<T>(); foreach (DataRow row in table.Rows) list.Add(tempRepository.FromData(table, row)); return list;}",How can I speed up instantiating a large collection of objects?
C# events of a non-delegate type," I've implemented a class that looks like this interface: This CustomEvent class works much like a MulticastDelegate. It can invoked. It can be combined with another CustomEvent. And a CustomEvent can be removed from another CustomEvent.Now, I want to declare a class like this: Unfortunately, this code does not compile. A Compiler Error CS0066 appears:'EventProvider.MyEvent': event must be of a delegate typeBasically, what I need is a property that has add and remove accessors instead of get and set. I think the only way to have that is using the event keyword. I know that one obvious alternative is to declare two methods that would do the adding and removing, but I want to avoid that too.Does anybody knows if there is a nice solution this problem? I wonder if there is any way to cheat the compiler to accept a non-delegate type as an event. A custom attribute, perhaps.By the way, someone asked a similar question in experts-exchange.com. Since that site is not free, I can't see the responses. Here is the topic: http://www.experts-exchange.com/Programming/Languages/C_Sharp/Q_21697455.html <code>  [ImmutableObject(true)]public interface ICustomEvent{ void Invoke(object sender, EventArgs e); ICustomEvent Combine(EventHandler handler); ICustomEvent Remove(EventHandler handler); ICustomEvent Combine(ICustomEvent other); ICustomEvent Remove(ICustomEvent other);} class EventProvider{ public event CustomEvent MyEvent; private void OnMyEvent() { var myEvent = this.MyEvent; if (myEvent != null) myEvent.Invoke(this, EventArgs.Empty); }}",Events of a non-delegate type
selenium c# open firefox window in selenium with addons," when I run my test in selenium, the newly opened firefox window is opened without my installed addons like xpathchecker. Is it possible to setup selenium so that it will use firefox with installed addons?  <code> ",Open firefox window in selenium with firefox addons loaded?
data adapter and data reader, What is the difference between data adapter and data reader? <code> ,what is the difference between data adapter and data reader?
what is the difference between data adapter adn data reader?, What is the difference between data adapter and data reader? <code> ,what is the difference between data adapter and data reader?
Invalid attempt to read when no data is present.," When I debug until line 7, it is OK, but after that dr throws an exception:Invalid attempt to read when no data is present.I don't understand why I'm getting that exception, since I do have data in the table with username=sumant.Please tell me whether the 'if' statement is correct or not. And how do I fix the error? <code>  private void button1_Click(object sender, EventArgs e) { string name; name = textBox5.Text; SqlConnection con10 = new SqlConnection(""con strn""); SqlCommand cmd10 = new SqlCommand(""select * from sumant where username=@name""); cmd10.Parameters.AddWithValue(""@name"",name); cmd10.Connection = con10; cmd10.Connection.Open();//line 7 SqlDataReader dr = cmd10.ExecuteReader(); } if ( textBox2.Text == dr[2].ToString()) { //do something; }",Invalid attempt to read when no data is present
Distinct Values in C# Dictionary, I'm trying to loop over distinct values over a dictionary list:So I have a dictionary of key value pairs .How do I get just the distinct values of string keys from the dictionary list? <code> ,"Distinct Values in Dictionary<TKey,TValue>"
Changing element value in Enumerable<T> ForEach method," I have the following code: I would expect that all elements in the list are now ""WW"" but they are still the original value. How come? What do I have to do different? <code>  newsplit.ToList().ForEach(x => x = ""WW"");",Changing element value in List<T>.ForEach ForEach method
Inverting a colour (or color for our trans-atlantic cousins)? (c#)," I know that this won't directly invert a colour, it will just 'oppose' it. I was wondering if anyone knew a simple way (a few lines of code) to invert a colour from any given colour?At the moment I have this (which isn't exactly the definition of an invert, because if I pass it a grey / gray colour it will return something extremely similar e.g. 127, 127, 127): <code>  const int RGBMAX = 255;Color InvertMeAColour(Color ColourToInvert){ return Color.FromArgb(RGBMAX - ColourToInvert.R, RGBMAX - ColourToInvert.G, RGBMAX - ColourToInvert.B);}",How do I invert a colour?
Inverting a color (or colour for our trans-atlantic cousins)? (c#)," I know that this won't directly invert a colour, it will just 'oppose' it. I was wondering if anyone knew a simple way (a few lines of code) to invert a colour from any given colour?At the moment I have this (which isn't exactly the definition of an invert, because if I pass it a grey / gray colour it will return something extremely similar e.g. 127, 127, 127): <code>  const int RGBMAX = 255;Color InvertMeAColour(Color ColourToInvert){ return Color.FromArgb(RGBMAX - ColourToInvert.R, RGBMAX - ColourToInvert.G, RGBMAX - ColourToInvert.B);}",How do I invert a colour?
How do I invert a colour?," I know that this won't directly invert a colour, it will just 'oppose' it. I was wondering if anyone knew a simple way (a few lines of code) to invert a colour from any given colour?At the moment I have this (which isn't exactly the definition of an invert, because if I pass it a grey / gray colour it will return something extremely similar e.g. 127, 127, 127): <code>  const int RGBMAX = 255;Color InvertMeAColour(Color ColourToInvert){ return Color.FromArgb(RGBMAX - ColourToInvert.R, RGBMAX - ColourToInvert.G, RGBMAX - ColourToInvert.B);}",How do I invert a colour?
How do I invert a colour / color? (C# .net)," I know that this won't directly invert a colour, it will just 'oppose' it. I was wondering if anyone knew a simple way (a few lines of code) to invert a colour from any given colour?At the moment I have this (which isn't exactly the definition of an invert, because if I pass it a grey / gray colour it will return something extremely similar e.g. 127, 127, 127): <code>  const int RGBMAX = 255;Color InvertMeAColour(Color ColourToInvert){ return Color.FromArgb(RGBMAX - ColourToInvert.R, RGBMAX - ColourToInvert.G, RGBMAX - ColourToInvert.B);}",How do I invert a colour?
How do I invert a colour / color?," I know that this won't directly invert a colour, it will just 'oppose' it. I was wondering if anyone knew a simple way (a few lines of code) to invert a colour from any given colour?At the moment I have this (which isn't exactly the definition of an invert, because if I pass it a grey / gray colour it will return something extremely similar e.g. 127, 127, 127): <code>  const int RGBMAX = 255;Color InvertMeAColour(Color ColourToInvert){ return Color.FromArgb(RGBMAX - ColourToInvert.R, RGBMAX - ColourToInvert.G, RGBMAX - ColourToInvert.B);}",How do I invert a colour?
c# Mersenne Twister random integer generator implementation (SFMT) monte carlo simulation," So far I've been using the C# Mersenne Twister found here to generate random numbers:http://www.centerspace.net/resources.phpI just discovered SFMT which is supposed to be twice as fast here:http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/SFMT/Can anyone point me at a C# implementation of SFMT?My requirements are to generate an integer between (and including) 0 and 2^20 (1048576).I need to do this trillions of times everyday for a simulation running on a 24 hour clock so I am prepared to spend days tweaking this to perfection.Currently I've tweaked the Center Space Mersenne Twister by adding a new method to fit my requirements: Using the method genrand_int32() I'd like to produce my own version, genrand_int20(), that generates an integer between (and including) 0 and 2^20 to save on the cast above and shift but I don't understand the mathematics. Exactly how can I do this?Also is using an uint going to be faster that int, or is just a matter of addressable numbers? Because I only need up to 1048576, I am only concerned with speed.Also this will be running on a Windows Server 2003 R2 SP2 (32bit) box with .NET 2. Processor is AMD Opteron 275 (4 core). <code>  public uint Next20(){ return (uint)(genrand_int32() >> 12);}",C# Mersenne Twister random integer generator implementation (SFMT) monte carlo simulation
What is the collection equievlent of a multi-dimensional aray?," I've got a group of data that looks like this: Now, certainly, I could create an array of string[x][y] = z, but this array has to be resizable, and i'd prefer to use the string representations of the indexers than convert to numeric. The reason is that i will need to look up the data by string, and i don't see the point in needless string->number conversions.My first thought was this: and this works, but is somewhat cumbersome. It also feels wrong and kludgy and not particularly efficient.So what's the best way to store this sort of data in a collection? I also thought of creating my own collection class, but I'd rather not if I don't have to. I'd rather just use the existing tools. <code>  001 001 One001 002 Two001 003 Three002 001 One002 002 Two002 003 Three... Dictionary<string, Dictionary<string, string>> data;data = new Dictionary<string, Dictionary<string, string>>();Dictionary<string, string> subdata = Dictionary<string, string>();subdata.Add(key, string);data.add(key2, subdata);",What is the collection equivalent of a multi-dimensional array?
What is the collection equivalent of a multi-dimensional aray?," I've got a group of data that looks like this: Now, certainly, I could create an array of string[x][y] = z, but this array has to be resizable, and i'd prefer to use the string representations of the indexers than convert to numeric. The reason is that i will need to look up the data by string, and i don't see the point in needless string->number conversions.My first thought was this: and this works, but is somewhat cumbersome. It also feels wrong and kludgy and not particularly efficient.So what's the best way to store this sort of data in a collection? I also thought of creating my own collection class, but I'd rather not if I don't have to. I'd rather just use the existing tools. <code>  001 001 One001 002 Two001 003 Three002 001 One002 002 Two002 003 Three... Dictionary<string, Dictionary<string, string>> data;data = new Dictionary<string, Dictionary<string, string>>();Dictionary<string, string> subdata = Dictionary<string, string>();subdata.Add(key, string);data.add(key2, subdata);",What is the collection equivalent of a multi-dimensional array?
C# newbie: calculate days remaining to a birthday?," I have a DateTime object with a person's birthday. I created this object using the person's year, month and day of birth, in the following way: I would like to know how many days are remaining before this person's next birthday. What is the best way to do so in C# (I'm new to the language)? <code>  DateTime date = new DateTime(year, month, day);",Calculate days remaining to a birthday?
How can I pass a property of a class as a parameter of a method in c#," I have a class that has a dozen or so properties that represent various financial fields. I have another class that needs to perform some calculations on each of those fields separately. The code inside those calculation methods are identical except for the field that it does the calculation on.Is there a way that I can pass a property name as a parameter and just have one method that does all of the performing work instead of the 12 methods for each property?Also, I'm sure this can be accomplished via reflection, but I've seen in other code where lambdas are used in this same kind of fashion and was wondering if this is a candidate where this can be used.As requested, here is an example: My goal is to just make one method called GetTotalAmountByDate() and pass in a begin date, and end date and the name of the property (ReleasedFederalAmount or ReleasedLocalAmount, etc.) it needs to access.I hope this depicts accurately what I'm trying to accomplish. <code>  public class FinancialInfo{ public virtual DateTime AuditDate { get; set; } public virtual decimal ReleasedFederalAmount { get; set; } public virtual decimal ReleasedNonFederalAmount { get; set; } public virtual decimal ReleasedStateAmount { get; set; } public virtual decimal ReleasedLocalAmount { get; set; } public virtual decimal ReleasedPrivateAmount { get; set; } // more fields like this}public class FinancialLedger(){ public virtual DateTime? BeginDate { get; set; } public virtual DateTime? EndDate { get; set; } public virtual IList<FinancialInfo> Financials { get; set; } //not actual implementation, but you get the idea public decimal GetTotalReleasedFederalAmountByDate() { if (BeginDate == null && EndDate == null) return 0; decimal total = 0; foreach (var fi in Financials) { if (someCondition) if (someSubCondition) total += fi.ReleasedFederalAmount; else if (someOtherCondition) if (someOtherSubCondition) total += fi.ReleasedFederalAmount; else if (anotherCondigion) total += fi.ReleasedFederalAmount; } return total; } public decimal GetTotalReleasedNonFederalAmountByDate() { // same logic as above method, // but it accesses fi.ReleasedNonFederalAmount; } // More methods the same as the previous, just accessing different // members of FinancialInfo}",How can I pass a property of a class as a parameter of a method?
C# find most recent file in dir," I need to find the most recently modified file in a directory. I know I can loop through every file in a folder and compare File.GetLastWriteTime, but is there a better way to do this without looping?. <code> ","How to find the most recent file in a directory using .NET, and without looping?"
How to find the most recent file in a directory using .NET?," I need to find the most recently modified file in a directory. I know I can loop through every file in a folder and compare File.GetLastWriteTime, but is there a better way to do this without looping?. <code> ","How to find the most recent file in a directory using .NET, and without looping?"
"How to find the most recent file in a directory using .Net, and without looping?"," I need to find the most recently modified file in a directory. I know I can loop through every file in a folder and compare File.GetLastWriteTime, but is there a better way to do this without looping?. <code> ","How to find the most recent file in a directory using .NET, and without looping?"
C#: Public Fields versus Automatic Properties," We're often told we should protect encapsulation by making getter and setter methods (properties in C#) for class fields, instead of exposing the fields to the outside world.But there are many times when a field is just there to hold a value and doesn't require any computation to get or set. For these we would all do this number: Well, I have a confession, I couldn't bear writing all that (really, it wasn't having to write it, it was having to look at it), so I went rogue and used public fields.Then along comes C# 3.0 and I see they added automatic properties: Which is tidier, and I'm thankful for it, but really, what's so different than just making a public field? <code>  public class Book{ private string _title; public string Title { get => _title; set => _title = value; }} public class Book{ public string Title { get; set; } } public class Book{ public string Title;}",Public Fields versus Automatic Properties
state management in winforms (c#)," Hi can I'm very new to windows forms. Here I want to maintain state (like session in web applications) in windows forms.Actually i want to store user login details in session. But i think there is no concept of session in winforms. So what is the alternative method to handle this type of situation.Regards,Nagu <code> ",How do I maintain user login details in a Winforms application?
how to save configuation in app.config in c# winform, Can someone give me an example of how to save a key/value in app.config using C# and WinForms? <code> ,How to Save Configuation in app.config in C# Winforms
Reading settings from app.config or web.config in .net," I'm working on a C# class library that needs to be able to read settings from the web.config or app.config file (depending on whether the DLL is referenced from an ASP.NET web application or a Windows Forms application).I've found that works, but that code has been marked as deprecated by Microsoft.I've read that I should be using: However, the System.Configuration.ConfigurationManager class doesn't seem to be available from a C# Class Library project.What is the best way to do this? <code>  ConfigurationSettings.AppSettings.Get(""MySetting"") ConfigurationManager.AppSettings[""MySetting""]",Reading settings from app.config or web.config in .NET
c# windows service, Does anyone know if there is a way to install a Windows service created in C# without making an installer? <code> ,How do I install a C# Windows service without creating an installer?
how to store/retreieve RSA public/private key ," I want to use RSA public key encryption. What is the best way to store or retrieve private and public keys? Is XML a good idea here?How to get the keys? Because RSAParameters have the following members: D, DP, DQ, Exponent, InverseQ, Modulus, P, QWhich one is the key? <code>  RSAParameters privateKey = RSA.ExportParameters(true);RSAParameters publicKey = RSA.ExportParameters(false);",How to store/retrieve RSA public/private key
Authorize using a constant expression," I am trying to set the Authorize for my controllers can do the following: How ever the names of the roles are held in the database, and therefore I would like to try and do the following: but I get the following error: An attribute argument must be a constant expression, typeof expression or array creation expression of an attribute parameter typeAny way around this? <code>  [Authorize(Roles = ""Approver"")] [Authorize(Roles = Settings.Instance.RoleEmployee)]",Authorize attribute using a constant expression
How to get caller ID in C# ?, I want to use 56K modem for getting telephone number of who calls the home phone. Is there a way to achieve this with C# ?  <code> ,How to get Caller ID in C#?
How to get Caller ID in C#?, I want to use 56K modem for getting telephone number of who calls the home phone. Is there a way to achieve this with C# ?  <code> ,How to get Caller ID in C#?
How to get CallerID in C#?, I want to use 56K modem for getting telephone number of who calls the home phone. Is there a way to achieve this with C# ?  <code> ,How to get Caller ID in C#?
C#: Drag and drop between two instances of the same application," I have created a small Windows Forms test application to try out some drag/drop code. The form consists of three PictureBoxes. My intention was to grab a picture from one PictureBox, display it as a custom cursor during the drag operation, then drop it on another PictureBox target.This works fine from one PictureBox to another as long as they are on the same form.If I open two instances of the same application and attempt to drag/drop between them, I get the following cryptic error: This remoting proxy has no channel sink which means either the server has no registered server channels that are listening, or this application has no suitable client channel to talk to the server.For some reason, however, it does work to drag/drop to Wordpad (but not MS Word or Paintbrush).The three PictureBoxes get their events hooked up like this: Then there are the four events like this: Any help would be greatly appreciated! <code>  foreach (Control pbx in this.Controls) { if (pbx is PictureBox) { pbx.AllowDrop = true; pbx.MouseDown += new MouseEventHandler(pictureBox_MouseDown); pbx.GiveFeedback += new GiveFeedbackEventHandler(pictureBox_GiveFeedback); pbx.DragEnter += new DragEventHandler(pictureBox_DragEnter); pbx.DragDrop += new DragEventHandler(pictureBox_DragDrop); }} void pictureBox_MouseDown(object sender, MouseEventArgs e) { int width = (sender as PictureBox).Image.Width; int height = (sender as PictureBox).Image.Height; Bitmap bmp = new Bitmap(width, height); Graphics g = Graphics.FromImage(bmp); g.DrawImage((sender as PictureBox).Image, 0, 0, width, height); g.Dispose(); cursorCreatedFromControlBitmap = CustomCursors.CreateFormCursor(bmp, transparencyType); bmp.Dispose(); Cursor.Current = this.cursorCreatedFromControlBitmap; (sender as PictureBox).DoDragDrop((sender as PictureBox).Image, DragDropEffects.All);} void pictureBox_GiveFeedback(object sender, GiveFeedbackEventArgs gfea) { gfea.UseDefaultCursors = false;} void pictureBox_DragEnter(object sender, DragEventArgs dea) { if ((dea.KeyState & 32) == 32) { // ALT is pressed dea.Effect = DragDropEffects.Link; } else if ((dea.KeyState & 8) == 8) { // CTRL is pressed dea.Effect = DragDropEffects.Copy; } else if ((dea.KeyState & 4) == 4) { // SHIFT is pressed dea.Effect = DragDropEffects.None; } else { dea.Effect = DragDropEffects.Move; }} void pictureBox_DragDrop(object sender, DragEventArgs dea) { if (((IDataObject)dea.Data).GetDataPresent(DataFormats.Bitmap)) (sender as PictureBox).Image = (Image)((IDataObject)dea.Data).GetData(DataFormats.Bitmap);}",Drag and Drop between Instances of the same Windows Forms Application
Will there be generic attributes in c# 4?," So - if there isn't particular reason why there isn't generic attributes,I'm wondering - maybe they will be implemented?Those would be great for ASP.NET MVC action filters. <code> ",Will there be generic attributes in C# 4?
Getting an item in a list c#," I have the following list item How can I pull an item in configuration where name = value?For example: lets say I have 100 configuration objects in that list.How can I get : Configurations.name[""myConfig""]Something like that?UPDATE: Solution for .net v2 please <code>  public List<Configuration> Configurations{ get; set;} public class Configuration { public string Name { get; set; } public string Value { get; set; } }",Getting an item in a list
"Following code errors out at the line commented with ""---errors is here---"". What is wrong?"," From sample example 4 of MSDN ""Threading Tutorial""Following code errors out at the line commented with ""---errors is here---"".What is wrong?  <code>  using System;using System.Threading;public class MutexSample{ static Mutex gM1; static Mutex gM2; const int ITERS = 100; static AutoResetEvent Event1 = new AutoResetEvent(false); static AutoResetEvent Event2 = new AutoResetEvent(false); static AutoResetEvent Event3 = new AutoResetEvent(false); static AutoResetEvent Event4 = new AutoResetEvent(false); public static void Main(String[] args) { Console.WriteLine(""Mutex Sample ...""); // Create Mutex initialOwned, with name of ""MyMutex"". gM1 = new Mutex(true, ""MyMutex""); // Create Mutex initialOwned, with no name. gM2 = new Mutex(true); Console.WriteLine("" - Main Owns gM1 and gM2""); AutoResetEvent[] evs = new AutoResetEvent[4]; evs[0] = Event1; // Event for t1 evs[1] = Event2; // Event for t2 evs[2] = Event3; // Event for t3 evs[3] = Event4; // Event for t4 MutexSample tm = new MutexSample(); Thread thread1 = new Thread(new ThreadStart(tm.t1Start)); Thread thread2 = new Thread(new ThreadStart(tm.t2Start)); Thread thread3 = new Thread(new ThreadStart(tm.t3Start)); Thread thread4 = new Thread(new ThreadStart(tm.t4Start)); thread1.Start(); // Does Mutex.WaitAll(Mutex[] of gM1 and gM2) thread2.Start(); // Does Mutex.WaitOne(Mutex gM1) thread3.Start(); // Does Mutex.WaitAny(Mutex[] of gM1 and gM2) thread4.Start(); // Does Mutex.WaitOne(Mutex gM2) Thread.Sleep(2000); Console.WriteLine("" - Main releases gM1""); gM1.ReleaseMutex(); // t2 and t3 will end and signal Thread.Sleep(1000); Console.WriteLine("" - Main releases gM2""); gM2.ReleaseMutex(); // t1 and t4 will end and signal // Waiting until all four threads signal that they are done. WaitHandle.WaitAll(evs); Console.WriteLine(""... Mutex Sample""); } public void t1Start() { Console.WriteLine(""t1Start started, Mutex.WaitAll(Mutex[])""); Mutex[] gMs = new Mutex[2]; gMs[0] = gM1; // Create and load an array of Mutex for WaitAll call gMs[1] = gM2; Mutex.WaitAll(gMs); // Waits until both gM1 and gM2 are released Thread.Sleep(2000); Console.WriteLine(""t1Start finished, Mutex.WaitAll(Mutex[]) satisfied""); Event1.Set(); // AutoResetEvent.Set() flagging method is done } public void t2Start() { Console.WriteLine(""t2Start started, gM1.WaitOne( )""); gM1.WaitOne(); // Waits until Mutex gM1 is released ---errors is here--- Console.WriteLine(""t2Start finished, gM1.WaitOne( ) satisfied""); Event2.Set(); // AutoResetEvent.Set() flagging method is done } public void t3Start() { Console.WriteLine(""t3Start started, Mutex.WaitAny(Mutex[])""); Mutex[] gMs = new Mutex[2]; gMs[0] = gM1; // Create and load an array of Mutex for WaitAny call gMs[1] = gM2; Mutex.WaitAny(gMs); // Waits until either Mutex is released Console.WriteLine(""t3Start finished, Mutex.WaitAny(Mutex[])""); Event3.Set(); // AutoResetEvent.Set() flagging method is done } public void t4Start() { Console.WriteLine(""t4Start started, gM2.WaitOne( )""); gM2.WaitOne(); // Waits until Mutex gM2 is released Console.WriteLine(""t4Start finished, gM2.WaitOne( )""); Event4.Set(); // AutoResetEvent.Set() flagging method is done }}",Why does MSDN sample from Threading Tutorial crash?
Where do we use Debug/Trace statements , I use C# (using VS IDE) for development. I am confused about Debug/Trace statements.Where and why do we use these statements? I have often seen these in other developer's source code. Can someone provide pointers? <code> ,Where do we use Debug/Trace statements
"Authentication, Authorization, User and Role Managment and general Security in C#"," I need to know how to go about implementing general security for a C# application. What options do I have in this regard? I would prefer to use an existing framework if it meets my needs - I don't want to re-invent the wheel.My requirements are as follows:the usual username/password authenticationmanaging of users - assign permissions to usersmanaging of roles - assign users to roles, assign permissions to rolesauthorization of users based on their username and roleI am looking for a free / open-source framework/library that has been time-tesed and used by the .Net community.My application takes a client/server approach, with the server running as a windows service, connecting to a SQL Server database. Communication between client and server will be through WCF.One other thing that is important is that I need to be able to assign specific users or roles permissions to View/Update/Delete a specific entity, whether it be a Customer, or Product etc. For e.g. Jack can view a certain 3 of 10 customers, but only update the details of customers Microsoft, Yahoo and Google, and can only delete Yahoo. <code> ","Authentication, Authorization, User and Role Management and general Security in .NET"
"Authentication, Authorization, User and Role Managment and general Security in .NET"," I need to know how to go about implementing general security for a C# application. What options do I have in this regard? I would prefer to use an existing framework if it meets my needs - I don't want to re-invent the wheel.My requirements are as follows:the usual username/password authenticationmanaging of users - assign permissions to usersmanaging of roles - assign users to roles, assign permissions to rolesauthorization of users based on their username and roleI am looking for a free / open-source framework/library that has been time-tesed and used by the .Net community.My application takes a client/server approach, with the server running as a windows service, connecting to a SQL Server database. Communication between client and server will be through WCF.One other thing that is important is that I need to be able to assign specific users or roles permissions to View/Update/Delete a specific entity, whether it be a Customer, or Product etc. For e.g. Jack can view a certain 3 of 10 customers, but only update the details of customers Microsoft, Yahoo and Google, and can only delete Yahoo. <code> ","Authentication, Authorization, User and Role Management and general Security in .NET"
XML array serialization issue in C#," I am using VSTS2008 + C# + .Net 3.0. I am using below code to serialize XML, and my object contains array type property, but there some additional elements' layer (in my sample, MyInnerObject and MyObject) generated which I want to remove from the generated XML file. Any ideas?Current generated XML file, Expected XML file, Current code, <code>  <?xml version=""1.0""?><MyClass xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema""> <MyObjectProperty> <MyObject> <MyInnerObjectProperty> <MyInnerObject> <ObjectName>Foo Type</ObjectName> </MyInnerObject> </MyInnerObjectProperty> </MyObject> </MyObjectProperty></MyClass> <?xml version=""1.0""?><MyClass xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema""> <MyObjectProperty> <MyInnerObjectProperty> <ObjectName>Foo Type</ObjectName> </MyInnerObjectProperty> </MyObjectProperty></MyClass> public class MyClass{ private MyObject[] _myObjectProperty; [XmlArrayItemAttribute(IsNullable=false)] public MyObject[] MyObjectProperty { get { return _myObjectProperty; } set { _myObjectProperty = value; } }}public class MyObject{ private MyInnerObject[] _myInnerObjectProperty; [XmlArrayItemAttribute(IsNullable = false)] public MyInnerObject[] MyInnerObjectProperty { get { return _myInnerObjectProperty; } set { _myInnerObjectProperty = value; } }}public class MyInnerObject{ public string ObjectName;}public class Program{ static void Main(string[] args) { XmlSerializer s = new XmlSerializer(typeof(MyClass)); FileStream fs = new FileStream(""foo.xml"", FileMode.Create); MyClass instance = new MyClass(); instance.MyObjectProperty = new MyObject[1]; instance.MyObjectProperty[0] = new MyObject(); instance.MyObjectProperty[0].MyInnerObjectProperty = new MyInnerObject[1]; instance.MyObjectProperty[0].MyInnerObjectProperty[0] = new MyInnerObject(); instance.MyObjectProperty[0].MyInnerObjectProperty[0].ObjectName = ""Foo Type""; s.Serialize(fs, instance); return; }}",Removing Wrapper Elements from XML-Serialized Array
'null' cannot be returned for anonymous methods?, I have a generic method like: Which basically performs a lookup in a db and in some cases it does not (and cannot return) a result and I would like to return null.However that's obviously not possible because of 'There is no implicit conversion between T and null'. What should I do in this case? <code>  public T GetLevelElement<T>(string name) where T : ILevelElement{ //[...]},Cannot return 'null' from generic methods?
'null' cannot be returned for generic methods?, I have a generic method like: Which basically performs a lookup in a db and in some cases it does not (and cannot return) a result and I would like to return null.However that's obviously not possible because of 'There is no implicit conversion between T and null'. What should I do in this case? <code>  public T GetLevelElement<T>(string name) where T : ILevelElement{ //[...]},Cannot return 'null' from generic methods?
"NetworkStream, is there a DataAvailable Event? (C#)"," Ok, so I'm a little confused as to why I can't find this anywhere, or if it doesn't exist then why have Microsoft not implemented it?So here's my scenario, I have a NetworkStream, which has a lovely little boolean called DataAvailable, and what I need is an event, that jumps out and says ""Hey, there's data available for you!"" (because I'm lazy and I'd rather be told that there's data available than to keep asking ""Alright, is there any data available?"" over and over again until I get the response ""Actually, this time there is"").Something similar a SerialPort (which has a nice event (DataReceived), that kindly informs me that data is being received from the port) would have been nice. But I'm using a Socket with a NetworkStream.Point me in the correct direction if there's something blatently obvious that I'm missing, but if not, does this mean I am going to have to use some Data Binding on the DataAvailable property, and when it is set to true, to call my own 'home made' event/function? If this is going to be the way could you please give me a small example to get the ball rolling?EditMy perfect answer would be for someone to come along and explain to me how I can find/create something extremely similar to the DataReceived Event used with a SerialPort, but implemented for a Socket that is streaming via a NetworkStream!Thanks in advance again, appreciated. <code> ","NetworkStream, is there something similar to DataReceived for a SerialPort? (C#)"
Creating an event on a property? (C#)," I am using a class that I cannot edit, it has a property (a boolean) of which it would be nice to be informed when it changes, I can't edit the properties get or set as I am importing the class from a .dll (which I don't have the code for).How do I create an event/function that is fired when the property is changed?AdditionalIt is only changed within its own class, directly to the underlying private variable.E.g. <code>  private bool m_MyValue = false;public bool MyValue { get { return m_MyValue; } }private void SomeFunction() { m_MyValue = true; }",Firing an event / function on a property? (C#)
WPF thread and GUI without CheckAccess?," I have a thread that call an object that get some stuff from Internet. When this object is filled up with all information required, it raises an event with an object will all the information. The event is consumed by the controller that has started the thread.The returned object from the event is than added into a collection that is binded the the GUI via a View Model approach.The problem is that I can't use the CheckAccess with the binding... how can I fix the problem of using Object that has been created from an other thread of the main one?The error that I receive when I add the object to the collection of the main thread is : This type of CollectionView does not support changes to its SourceCollection from a thread different from the Dispatcher thread.This the the controller: <code>  public class WebPingerController{ private IAllQueriesViewModel queriesViewModel; private PingerConfiguration configuration; private Pinger ping; private Thread threadPing; public WebPingerController(PingerConfiguration configuration, IAllQueriesViewModel queriesViewModel) { this.queriesViewModel = queriesViewModel; this.configuration = configuration; this.ping = new Pinger(configuration.UrlToPing); this.ping.EventPingDone += new delPingerDone(ping_EventPingDone); this.threadPing = new Thread(new ThreadStart(this.ThreadedStart)); } void ping_EventPingDone(object sender, QueryStatisticInformation info) { queriesViewModel.AddQuery(info);//ERROR HAPPEN HERE } public void Start() { this.threadPing.Start(); } public void Stop() { try { this.threadPing.Abort(); } catch (Exception e) { } } private void ThreadedStart() { while (this.threadPing.IsAlive) { this.ping.Ping(); Thread.Sleep(this.configuration.TimeBetweenPing); } }}",WPF thread and GUI how to access object from different thread?
Why are not Static Web Methods available in WebServices ? , I just wanna learn why I can't static web methods in web services ? Why is it restricted ?Can some body give me concise explanation of this. <code> ,Why are Static Methods not Usable as Web Service Operations in ASMX Web Services ? 
ASP.NET - Get the Principal within namespace for a DirectoryEntry / sid," I am using Active Directory in a custom MembershipProvider class to authenticate users in an ASP.NET 2.0 intranet application and associate their sid with a profile for the application.When the ActiveDirectoryMembershipProvider is used, the ProviderUserKey object for the MembershipUser is as follows As I understand it, YY is the principal within the namespace (also referred to as a group/domain).When using the custom MembershipProvider, I can get the sid using the objectSid property of a DirectoryEntry object The sidValue in this case is identical, except it does not contain the principal YY.My question is two-foldIs the principal required in order to uniquely identify an individual? Is it possible to obtain the principal from the DirectoryEntry object (or through any other classes available in System.DirectoryServices)?EDIT:Having done some further reading ({1} {2}), I now know that the sid can change if the user is moved from one group/domain to another. In light of this, would using the GUID defined in the DirectoryEntry Properties[""objectGUID""] be a better choice for uniquely identifying a user? <code>  SecurityIdentifier sid = (SecurityIdentifier)Membership.GetUser().ProviderUserKey;string sidValue = sid.ToString();/* sidValue = ""S-1-5-21-XXXX-XXXX-XXXX-YY"" */ DirectoryEntry entry = new DirectoryEntry(path, username, password);SecurityIdentifier sid = new SecurityIdentifier((byte[])entry.Properties[""objectSid""].Value, 0);string sidValue = sid.ToString();/* sidValue = ""S-1-5-21-XXXX-XXXX-XXXX"" */",ASP.NET - Get the Principal / Relative Identifier (RID) for a DirectoryEntry / SID
How can I use the string value of a  C# enum value in a case statement?," I have defined a C# enum as and can use its value as a string as in: However when I try to use it in a case statement it fails to compile: I thought enums were constants. How do I get around this?(I cannot parse the value into an enum as some of the values are outside the range) <code>  public enum ORDER{ ... unknown, partial01, partial12, partial23,} string ss = ORDER.partial01.ToString(); string value = ...switch (value){ case null: break; case ""s"": // OK break; case ORDER.partial01.ToString(): // compiler throws ""a constant value is expected"" break; ...",How can I use the string value of a C# enum value in a case statement?
How to get the list of key in dictionary c#, I only want the Keys and not the Values of a Dictionary.I haven't been able to get any code to do this yet. Using another array proved to be too much work as I use remove also.How do I get a List of the Keys in a Dictionary? <code> ,How do I get the list of keys in a Dictionary?
How to get the list of key in dictionary, I only want the Keys and not the Values of a Dictionary.I haven't been able to get any code to do this yet. Using another array proved to be too much work as I use remove also.How do I get a List of the Keys in a Dictionary? <code> ,How do I get the list of keys in a Dictionary?
How do I get the list of keys in a dictionary?, I only want the Keys and not the Values of a Dictionary.I haven't been able to get any code to do this yet. Using another array proved to be too much work as I use remove also.How do I get a List of the Keys in a Dictionary? <code> ,How do I get the list of keys in a Dictionary?
What is the best practise for storing database connection details in .NET?," This might be a duplicate (question) but I am looking specifically for the .NET best practice.How to store database connection strings, username and password etc. in a safe way? Is an encrypted app.config best in most cases?I would also like to be able to set the password in the config file and then have it encrypted as soon as the application starts. (I am not asking for a solution as I have solved this before, I'm just looking for best practise(s)).I'm also interested in alternative solutions that you have good experiences with. <code> ",What is the best practice for storing database connection details in .NET?
Why can't we change apartment state of a ThreadPool thread?," Recently, I encountered this situation where I wanted to display a form on another thread (not the main/UI thread). I used a threadpool thread. The form hosted a RCW (for a COM component). Instantiating the form gave me an exception that the thread must be a STA. I tried to set the apartment state as STA. But, that didn't work either. I finally ended up creating a thread explicitly and that worked(I used ShowDialog and needn't create a meesage pump).EDIT:I know that threadpool threads are MTA. But, why can't it be set to STA?Just curious about this.Another question that just popped in my head: Why don't we require a message pump when Showdialog() (to display a form) is used <code> ",Why can't we change apartment state of a ThreadPool thread and why don't we require a messagepump when ShowDialog is used?
Programatically create a web site in IIS using C# and set port number," We have been able to create a web site. We did this using the information in this link:https://msdn.microsoft.com/en-us/library/ms525598.aspxHowever, we would like to use a port number other that port 80. How do we do this?We are using IIS 6 <code> ",Programmatically create a web site in IIS using C# and set port number
fill List<int> using LINQ," In python you can do something like this: I do know how to program a extension method that fills a array, list or whatever you need with random values.I find this cumbersome though, and I really admire how you can do it in python.Although, I only know of Enumerable.Range, which only can be used for generating fixed sequences, to my knowledge.Is it possible in C# as well? <code>  arr = list(set(randint(-50, 50) for _ in range(10)))",Fill List<int> using LINQ
Catch Custom Exception from Web Service," I have a web service in which I have created a custom exception. Let's say the name of this exception is InvalidContractException. What I would like to do is if a specific step occurs, I want to throw this exception. However, I can't figure out how the client would catch the InvalidContractException in order to handle it properly. This is an ASP.Net Web Service written in C# <code> ",Catch Custom Exception from ASMX Web Service
Are there any alternative frameworks to Asp.Net Dynamic Data?," I have been playing around with Dynamic Data but I find the filtering and navigation aspects basically useless for but the simplest scenarios, even in preview 4. I specifically want to be able to handle hierarchical self-reference tables when editing the data.Does anyone know of an open source project / or cheap alternative framework to getting similar out of the box functionality?UPDATE:Dynamic Data allows you to easily hook up a L2S or EF class very easily by setting the global.aspx to use that context. You get basic dynamic navigation and filtering with crud features for whatever tables you have linked in your DBML if your using L2S. I am wanting to use it as a back end management tool. <code> ",Are there any alternative scaffolding frameworks to Asp.Net Dynamic Data?
C# System.Windows.Forms.TreeView: Stop expand/collapse on double-click?," Is there a simple way to disable the auto-expand/collapse of a TreeView node when it is double-clicked? I've been unable to find an answer to this question that works without checking in BeforeExpand/BeforeCollapse if the current system time matches that expected for a double-click - overriding OnNodeMouseDoubleClick and/or OnDoubleClick does not seem to suffice. Or, is checking the system time and seeing if it fits a double-click the only way to do this?Thanks for your help,-Walt <code> ",C# System.Windows.Forms.TreeView: Stop auto expand/collapse on double-click (and execute another handler)
SOLVED: C# System.Windows.Forms.TreeView: Stop auto expand/collapse on double-click (and execute another handler)," Is there a simple way to disable the auto-expand/collapse of a TreeView node when it is double-clicked? I've been unable to find an answer to this question that works without checking in BeforeExpand/BeforeCollapse if the current system time matches that expected for a double-click - overriding OnNodeMouseDoubleClick and/or OnDoubleClick does not seem to suffice. Or, is checking the system time and seeing if it fits a double-click the only way to do this?Thanks for your help,-Walt <code> ",C# System.Windows.Forms.TreeView: Stop auto expand/collapse on double-click (and execute another handler)
preprocessor directive...C#," Looking for a preprocessor directive in c# for importing dll based on whether the executable is 64bit or 32 bit: <code>  #if WIN64[DllImport(""ZLIB64.dll"", CallingConvention=CallingConvention.Cdecl)]#else[DllImport(""ZLIB32.dll"", CallingConvention=CallingConvention.Cdecl)]",Preprocessor directive in C# for importing based on platform
Why ref and out in csharp ?," While using keyword ref, calling code needs to initialize passed arguments, but with keyword out we need not do so.Why don't we use out everywhere?What is exact difference between the two?Please give example of a situation in which we need to use ref and can't use out? <code> ",Why ref and out in C#?
.NET Compact Fw 3.5: Background worker," I want to use something similar to the BackgroundWorker, which is known from the full .NET Framework, on mobile devices. Sadly it is not available in the compact framework.What can I use instead? <code> ",Is there a BackgroundWorker replacement for .NET Compact Framework 3.5?
"Reverse Dictionary<key, value> "," Actually my previous question got me thinkingand I realized that reversing a Dictionary is not trivial.What is the most elegant and readable way to do it?Same scenario student Many to Many with Classesoriginal Dicitonary<int, List<int>> where the key is studentId and the Value is a List<int> that contains classId and want to revert to Dictionary<classId, List<studentId>>ThanksUpdate:Actually I just tested Luke and Bruno's solutions and they return the right amount of classed whoever they all have the same student, will update as i go along. <code> ","Reverse many-to-many Dictionary<key, List<value>>"
using Math object in C#," I have to display ratings and for that, I need increments as follows:InputRounded1.011.111.211.31.51.41.51.51.51.61.51.71.51.82.01.92.02.02.02.12.0and so on...Is there a simple way to compute the required values? <code> ",How do I round to the nearest 0.5?
Is there a way to return Anonimous Type from method?," I know I can't write a method like: I can do it otherwise: but I don't want to do the second option because, if I do so, I will have to use reflection.Why I want to do that:Today i have a method inside my aspx page that returns a datatable as result and I cannot change it, I was trying to convert this DataTable to an Anonymous method with the properties that I want to work with. I didn't want to create a class only to do that and as I will need to perform the same query more than one time, I Thought to create a method that returns an anonymous type would be a good ideia. <code>  public var MyMethod(){ return new{ Property1 = ""test"", Property2=""test""};} public object MyMethod(){ return new{ Property1 = ""test"", Property2=""test""}}",Is there a way to return Anonymous Type from method?
Is there a way to return Anonymous Type from method?," I know I can't write a method like: I can do it otherwise: but I don't want to do the second option because, if I do so, I will have to use reflection.Why I want to do that:Today i have a method inside my aspx page that returns a datatable as result and I cannot change it, I was trying to convert this DataTable to an Anonymous method with the properties that I want to work with. I didn't want to create a class only to do that and as I will need to perform the same query more than one time, I Thought to create a method that returns an anonymous type would be a good ideia. <code>  public var MyMethod(){ return new{ Property1 = ""test"", Property2=""test""};} public object MyMethod(){ return new{ Property1 = ""test"", Property2=""test""}}",Is there a way to return Anonymous Type from method?
Is there a builting C#/.Net System API for HSV to RGB?," Is there an API built into the .NET framework for converting HSV to RGB? I didn't see a method in System.Drawing.Color for this, but it seems surprising that there wouldn't be one in the platform. <code> ",Is there a built-in C#/.NET System API for HSV to RGB?
Is there a built-in C#/.Net System API for HSV to RGB?," Is there an API built into the .NET framework for converting HSV to RGB? I didn't see a method in System.Drawing.Color for this, but it seems surprising that there wouldn't be one in the platform. <code> ",Is there a built-in C#/.NET System API for HSV to RGB?
Which is faster: Union or Concat? (C# Linq), Which is faster: Union or Concat?I don't care about the order of the elements.Enumerable.Union MethodEnumerable.Concat Method <code> ,Which is faster: Union or Concat?
C#: How do I add a ToolTip to a control?," I would like to display a ToolTip for when the mouse is hovering over a control.How does one create a tooltip in code, but also in the designer? <code> ",How do I add a ToolTip to a control?
EventHandlers unsubscribe," From the Designer in VS let's say you double click on a button and it generates this Click event handler. the subscription code is in the designer.cs. I was wondering, in the dispose the Form MUST I unsubcribe the event ?Also, all control that are in the form will it be disposed when the forms disposes? it actually call dispose on each control recursively? <code> ",Must I unsubscribe all event handlers?
Reducing memory usage of .NET applications," What are some tips to reduce the memory usage of .NET applications? Consider the following simple C# program. Compiled in release mode for x64 and running outside Visual Studio, the task manager reports the following: It's a little better if it's compiled just for x86: I then tried the following program, which does the same but tries to trim process size after runtime initialization: The results on x86 Release outside Visual Studio: Which is a little better, but it still seems excessive for such a simple program. Are there any tricks to make a C# process a bit leaner? I'm writing a program that's designed to run in the background most of the time. I'm already doing any user interface stuff in a separate Application Domain which means the user interface stuff can be safely unloaded, but taking up 10MB when it's just sitting in the background seems excessive.P.S. As to why I would care --- (Power)users tend to worry about these things. Even if it has nearly no effect on performance, semi-tech-savvy users (my target audience) tend to go into hissy fits about background application memory usage. Even I freak when I see Adobe Updater taking 11MB of memory and feel soothed by the calming touch of Foobar2000, which can take under 6MB even when playing. I know in modern operating systems, this stuff really doesn't matter that much technically, but that doesn't mean it doesn't have an affect on perception. <code>  class Program{ static void Main(string[] args) { Console.ReadLine(); }} Working Set: 9364kPrivate Working Set: 2500kCommit Size: 17480k Working Set: 5888kPrivate Working Set: 1280kCommit Size: 7012k class Program{ static void Main(string[] args) { minimizeMemory(); Console.ReadLine(); } private static void minimizeMemory() { GC.Collect(GC.MaxGeneration); GC.WaitForPendingFinalizers(); SetProcessWorkingSetSize(Process.GetCurrentProcess().Handle, (UIntPtr) 0xFFFFFFFF, (UIntPtr)0xFFFFFFFF); } [DllImport(""kernel32.dll"")] [return: MarshalAs(UnmanagedType.Bool)] private static extern bool SetProcessWorkingSetSize(IntPtr process, UIntPtr minimumWorkingSetSize, UIntPtr maximumWorkingSetSize);} Working Set: 2300kPrivate Working Set: 964kCommit Size: 8408k",Reducing memory usage of .NET applications?
C# Winform UI Componets Layer Order," When we add any UI or container in WinForms, the later added component comes over the earlier added components, we can say it is in a higher layer.How to change that layer order or component order after adding components? <code> ",WinForm UI components layer order
How can I set exact height of listbox in winforms (C#)?," I've been having some difficulties with setting the height of a listbox.Code like this... ... works only for some numbers. It seems that height of listbox may be only multiplication of height of its element. Is there a way how to ""override"" this behaviour? <code>  listbox1.Height = some_number;",How can I set the exact height of a listbox in Windows Forms (C#)?
Do Large High Trafiic Websites use ORMs?, I have finally decided to go with the Entity Framework since it has the best performance out of all the ORMs. But before I start reading and writing code I just want to know if there are any high traffic websites out there that use ORMs.  <code> ,Do Large High-Traffic Websites use ORMs?
ISynchronizeInvoke in C#?, What is the working procedure of ISynchronizeInvoke? How to work with it in C#?  <code> ,How to Use ISynchronizeInvoke interface?
WinForms: force GUI update from UI Thread," In WinForms, how do I force an immediate UI update from UI thread? What I'm doing is roughly: Label text does not get set to ""Please Wait..."" before the operation.I solved this using another thread for the operation, but it gets hairy and I'd like to simplify the code. <code>  label.Text = ""Please Wait...""try { SomewhatLongRunningOperation(); }catch(Exception e){ label.Text = ""Error: "" + e.Message; return;}label.Text = ""Success!"";",Force GUI update from UI Thread
What does [STAThread] do ? , I am learning C# 3.5 and I want to know what [STAThread] does in our programs?  <code> ,What does [STAThread] do?
What does [STAThread] do ?, I am learning C# 3.5 and I want to know what [STAThread] does in our programs?  <code> ,What does [STAThread] do?
How to fire textIndexChanged event on j query onkeyup?, I have asp.net TextBox with ontextchanged event this is search text box in my application.I have search code in this event. how can I fire this event with the help of j query onkeyup.If i enter text in text box it will fire ontextchanged without press enter or mouse.This is an example of event what i need. But i dont know how to fire ontextchanged on this.http://viralpatel.net/blogs/demo/sum-textbox-value-javascript.html <code> ,How to fire TextBox.TextChanged event on jquery onkeyup?
MS Word Office Automation - Filling Text Form Fields And Check Box Form Fields," Does anyone have any good advice or experience on how to create an engine using C# (VB.NET is okay too) that is generic enough to handle most cases of MS Word text fields I need to fill with data I'm getting from a database? In short, I'm about to embark on this little Office automation excursion and I'm hoping a little bit of feedback here may help me to avoid some time consuming errors.Cheers and thanks in advance for any advice;Dave <code> ",MS Word Office Automation - Filling Text Form Fields And Check Box Form Fields And Mail Merge
Build c# Generic Type defintion at runtime.," At present I'm having to do something like this to build a Type definition at runtime to pass to my IOC to resolve. Simplified: I know the generic type argument at runtime only. Is there something that will allow me to do something like this (fake code): Or shall I just stick to my hack, passInType.GetType() convert to string, build generic type string.. feel dirty <code>  Type t = Type.GetType(""System.Collections.Generic.List`1[[ConsoleApplication2.Program+Person""); Type t = Type.GetTypeWithGenericTypeArguments( typeof(List) , passInType.GetType());",Build c# Generic Type definition at runtime
SQl Table and C# Enumeration, Suppose I have n types of users in my application.I am using an UserType enumeration to distinguish them.Do I need to keep a table in my database named UserType?So that I can find the user type any time by querying the tables rather than searching the application source code.Doing so my source code may become somewhat complicated.Should I admit this trade off? <code> ,SQL Table and C# Enumeration
C# Passing properties by reference," I'm trying to do do the following: This is giving me a compile error. I think its pretty clear what I'm trying to achieve. Basically I want GetString to copy the contents of an input string to the WorkPhone property of Client.Is it possible to pass a property by reference? <code>  GetString( inputString, ref Client.WorkPhone)private void GetString(string inValue, ref string outValue){ if (!string.IsNullOrEmpty(inValue)) { outValue = inValue; }}",Passing properties by reference in C#
What is the static variable initialization order in C#?," DependencyProperty.AddOwner MSDN page offers an example with two classes with static members, and the member of one class depends on the member of the other class for initialization. I think MSDN is wrong - the initialization order of static variables is unreliable in C# just like it is in C++ or anywhere else. I'm probably wrong because the WPF library itself is written that way and it works just fine. What am I missing? How can C# compiler possibly know the safe initialization order? <code> ",What is the static variable initialization order across classes in C#?
Hierarchical Entity - Load whole tree," I have a standard self referencing table of Categories. In my entity model I have made associations Children and Parent. Is it possible to load the whole Category object without lazy loading? if I use the code below, it loads only to the second level. Is it possible to load references if I have all the category objects already loaded?One method to load it is to add the Children property multiple times but this generates a very long insane T-SQL code and also it doesn't do what I want. <code>  db.Categories.MergeOption = System.Data.Objects.MergeOption.NoTracking;var query = from c in db.Categories.Include(""Children"") where c.IsVisible == true orderby c.SortOrder, c.Id select c; db.Categories.Include(""Children.Children.Children.Children.Children"")",Eager load a self-referencing table
Entity framework: eager load whole self-referencing table," I have a standard self referencing table of Categories. In my entity model I have made associations Children and Parent. Is it possible to load the whole Category object without lazy loading? if I use the code below, it loads only to the second level. Is it possible to load references if I have all the category objects already loaded?One method to load it is to add the Children property multiple times but this generates a very long insane T-SQL code and also it doesn't do what I want. <code>  db.Categories.MergeOption = System.Data.Objects.MergeOption.NoTracking;var query = from c in db.Categories.Include(""Children"") where c.IsVisible == true orderby c.SortOrder, c.Id select c; db.Categories.Include(""Children.Children.Children.Children.Children"")",Eager load a self-referencing table
How to uniquly identify computer using C#?," How to uniquely identify computer (mainboard) using C#(.Net/Mono, local application)?Edition. We can identify mainboard in .Net using something like this (see Get Unique System Identifiers in C#): But unfortunately Mono does not support System.Management. How to do it under Mono for Linux? - I don't know :( <code>  using System.Management;...ManagementObjectSearcher searcher = new ManagementObjectSearcher(""select * from Win32_MotherboardDevice"");...",How to uniquely identify computer using C#?
mocking vs faking when to use what.?," Can anyone come up with guidelines suggesting the ideal scenarios to choose mocking versus faking, i.e., setting up the essentials manually? I am a bit confused with how to approach this situation. <code> ",When to use mocking versus faking in C# unit testing?
"Mocking vs. faking, when to use what?"," Can anyone come up with guidelines suggesting the ideal scenarios to choose mocking versus faking, i.e., setting up the essentials manually? I am a bit confused with how to approach this situation. <code> ",When to use mocking versus faking in C# unit testing?
When to use mocking versus faking in C# unit testing," Can anyone come up with guidelines suggesting the ideal scenarios to choose mocking versus faking, i.e., setting up the essentials manually? I am a bit confused with how to approach this situation. <code> ",When to use mocking versus faking in C# unit testing?
How can I toggle a control's visibility in a DataTrigger?," This code works (when ControlType=""dropDown"" then the background yellow): But this code does not work (when ControlType=""dropDown"" then the TextBlock is still invisible): Why can't I set visibility in a style as I can background? <code>  <Window x:Class=""TestCollapsed.Views.MainView"" xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" xmlns:c=""clr-namespace:TestCollapsed.Commands"" Title=""Main Window"" Height=""400"" Width=""800""> <Window.Resources> <Style x:Key=""DropDownStyle"" TargetType=""TextBlock""> <Style.Triggers> <DataTrigger Binding=""{Binding ControlType}"" Value=""dropDown""> <Setter Property=""Background"" Value=""Yellow""/> </DataTrigger> </Style.Triggers> </Style> </Window.Resources> <StackPanel> <TextBlock Visibility=""Visible"" Text=""This is going to be the dropdown control."" Style=""{StaticResource DropDownStyle}""/> </StackPanel></Window> <Window x:Class=""TestCollapsed.Views.MainView"" xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" xmlns:c=""clr-namespace:TestCollapsed.Commands"" Title=""Main Window"" Height=""400"" Width=""800""> <Window.Resources> <Style x:Key=""DropDownStyle"" TargetType=""TextBlock""> <Style.Triggers> <DataTrigger Binding=""{Binding ControlType}"" Value=""dropDown""> <Setter Property=""Visibility"" Value=""Visible""/> </DataTrigger> </Style.Triggers> </Style> </Window.Resources> <StackPanel> <TextBlock Visibility=""Collapsed"" Text=""This is going to be the dropdown control."" Style=""{StaticResource DropDownStyle}""/> </StackPanel></Window>",How can I toggle a TextBlock's visibility in a DataTrigger?
"String/Character Encoding and the difference between GetBytes(), GetString() and Convert() in C#"," We are having trouble getting a Unicode string to convert to a UTF-8 string to send over the wire: Although we have converted the string to UTF-8, it's not arriving as UTF-8. <code>  // Start with our unicode string.string unicode = ""Convert: \u10A0"";// Get an array of bytes representing the unicode string, two for each character.byte[] source = Encoding.Unicode.GetBytes(unicode);// Convert the Unicode bytes to UTF-8 representation.byte[] converted = Encoding.Convert(Encoding.Unicode, Encoding.UTF8, source);// Now that we have converted the bytes, save them to a new string.string utf8 = Encoding.UTF8.GetString(converted);// Send the converted string using a Microsoft function.MicrosoftFunc(utf8);","In C# String/Character Encoding what is the difference between GetBytes(), GetString() and Convert()?"
windows form application (C#): set textbox to overwrite mode," Is it possible to force a textbox in a windows forms application to work in ""overwrite mode"", i.e. have characters replaced when the user types instead of added?Otherwise, is there a standard way to get this behavior? <code> ",How to Set WinForms Textbox to overwrite mode
how to add event listener via fluent nhibernate?," I want to add an event listener (IPreUpdateEventListener) to add NHibernate but I can't seem to find an example when using a fluent configuration.I want to be able to add the listener when I create the session factory, e.g. when the following code is execute. Anyone know how to do this? <code>  _sessionFactory = Fluently.Configure() .Database(MsSqlConfiguration.MsSql2005.ConnectionString(connectionString).ShowSql()) .Mappings(m => m.FluentMappings.AddFromAssemblyOf<IEntity>()) .BuildSessionFactory();",How to add event listener via Fluent NHibernate?
Multiple Modifier Keys in C#," I am using a keydown event to detect keys pressed and have several key combinations for various operations. For some reason the key combination in which I hit Ctrl + Shift + C is not working. I have re ordered them, and placed it at the top thinking it might be interference from the Ctrl + C, and even removed the Ctrl + C to see if it was causing a problem. It still does not work. I know it's probably something very simple, but can't quite grasp what it is. All of my 1 modifier + 1 key combination's work fine, as soon as I add a second modifier is when it no longer works. <code>  if (e.KeyCode == Keys.C && e.Modifiers == Keys.Control && e.Modifiers == Keys.Shift){ //Do work}else if (e.KeyCode == Keys.V && e.Modifiers == Keys.Control){ //Paste}",How to use multiple modifier keys in C#
calling a javascript function in c# application," I am using the webBrowser control in C# to load a webpage and need to call a JavaScript function that returns a string value. I got a solution to use the InvokeScript method, and I tried a lot, but everything has failed. <code> ",Calling a Javascript function in the C# webBrowser control
"Structuremap, consturctor that takes a list of plugins."," I got an interface like this and a class I want structuremap to fill out the constructor argument on WriterMerger with all registered IWriter's.I registered the different writers with however calling Returns an exception ""No Default Instance defined for PluginFamily System.Collections.Generic.IEnumerable`1[[IWriter..]]"" (class name edited)Any trick for doing this automatically? or will i have to make a custom factory method? <code>  public interface IWriter{ ...} public class WriterMerger{ public WriterMerger(IEnumerable<IWriter> writers) ...} StructureMap.ObjectFactory.Initialize(x =>{ x.ForRequestedType<IWriter>().AddConcreteType<MemoryWriter>(); x.ForRequestedType<IWriter>().AddConcreteType<FlatFileWriter>(); x.ForRequestedType<IWriter>().AddConcreteType<DbWriter>();} ObjectFactory.CreateInstance<WriterMerger>();","Structuremap, constructor that takes a list of plugins"
linq c# decendends," I have the following XML structure: I want to iterate over the name nodes with Linq.I tried this: But it didn't work the way I need it to. Any suggestions? <code>  <row> <field name=""Id"">1</field> <field name=""AreaId"">1</field> <field name=""Name"">&quot;</field></row><row> <field name=""Id"">2</field> <field name=""AreaId"">4</field> <field name=""Name""></field></row> var items = (from i in doc.Descendants(""row"") select new { Text = i.Value }).ToList();",C# - Select XML Descendants with Linq
C# - Unable to cast object of type MyObject to type MyObject," I have this scenario where a webservice method I'm consuming in C# returns a Business object, when calling the webservice method with the following code I get the exception ""Unable to cast object of type ContactInfo to type ContactInfo"" in the reference.cs class of the web referenceCode: Any help would be much appreciated.  <code>  ContactInfo contactInfo = new ContactInfo();Contact contact = new Contact();contactInfo = contact.Load(this.ContactID.Value);",Unable to cast object of type MyObject to type MyObject
Multline Text in a WPF Button through C#," How do I get multi-line text on a WPF Button using only C#? I have seen examples of using <LineBreak/> in XAML, but my buttons are created completely programmatically in C#. The number and labels on the buttons correspond to values in the domain model, so I don't think I can use XAML to specify this.I have tried the naive approach below, but it does not work. or In either case, all i see is the first line (""Two"") of the text. <code>  Button b = new Button();b.Content = ""Two\nLines""; b.Content = ""Two\r\nLines"";",Multiline Text in a WPF Button
Multline Text in a WPF Button," How do I get multi-line text on a WPF Button using only C#? I have seen examples of using <LineBreak/> in XAML, but my buttons are created completely programmatically in C#. The number and labels on the buttons correspond to values in the domain model, so I don't think I can use XAML to specify this.I have tried the naive approach below, but it does not work. or In either case, all i see is the first line (""Two"") of the text. <code>  Button b = new Button();b.Content = ""Two\nLines""; b.Content = ""Two\r\nLines"";",Multiline Text in a WPF Button
guid like in youtube, Is it possible to generate short GUID like in YouTube (N7Et6c9nL9w)? How can it be done? I want to use it in web app. <code> ,YouTube-like GUID
What are the minimum permissions a user needs to install and run a ClickOnce app based on .NET 3.5?," Googling reveals many technical details and framework/OS prerequisites, but it seems to be hard to find a source that lists the permissions that are required for installing and running a ClickOnce application.This is especially interesting for delivering software to customers that work in large corporate networks with many security restrictions and centralized policies that define which version of what is installed, etc. ""Standard"" users in these networks are still pretty much technically constrained in what they are allowed to do and what not (sadly, but that's another topic...).What are the permissions that a user needs to start a ClickOnce application from the network?Are there differences if the .NET Framework 3.5 is already installed? Does it work without an existing installation of the .NET Framework or an old version (for example, 1.1/2.0) with the same permissions as above?To make it a little more specific, what permissions are required if the .NET Framework 3.5 is not installed yet? What permissions are required if the .NET Framework 3.5 is present? <code> ",What are the minimum permissions a user needs to install and run a ClickOnce application based on .NET 3.5?
WPF: hide the TabControl header," What's the programmatic way (ie not using styles as in this question, but using code) to hide the TabControl header? I'll be glad for a snippet. <code> ",Hide the TabControl header
WPF: Binding to the PasswordBOX in MVVM - working solution?," I have come across a problem with binding to a PasswordBox. It seems it's a security risk but I am using the MVVM pattern so I wish to bypass this. I found some interesting code here (has anyone used this or something similar?)http://www.wpftutorial.net/PasswordBox.htmlIt technically looks great, but I am unsure of how to retrieve the password.I basically have properties in my LoginViewModel for Username and Password. Username is fine and is working as it's a TextBox.I used the code above as stated and entered this When I had the PasswordBox as a TextBox and Binding Path=Password then the property in my LoginViewModel was updated.My code is very simple, basically I have a Command for my Button. When I press it CanLogin is called and if it returns true it calls Login.You can see I check my property for Username here which works great.In Login I send along to my service a Username and Password, Username contains data from my View but Password is Null|Empty This is what I am doing I have my TextBox, this is no problem, but in my ViewModel the Password is empty.Am I doing something wrong or missing a step?I put a breakpoint and sure enough the code enter the static helper class but it never updates my Password in my ViewModel. <code>  <PasswordBox ff:PasswordHelper.Attach=""True"" ff:PasswordHelper.Password=""{Binding Path=Password}"" Width=""130""/> private DelegateCommand loginCommand;public string Username { get; set; }public string Password { get; set; }public ICommand LoginCommand{ get { if (loginCommand == null) { loginCommand = new DelegateCommand( Login, CanLogin ); } return loginCommand; }}private bool CanLogin(){ return !string.IsNullOrEmpty(Username);}private void Login(){ bool result = securityService.IsValidLogin(Username, Password); if (result) { } else { }} <TextBox Text=""{Binding Path=Username, UpdateSourceTrigger=PropertyChanged}"" MinWidth=""180"" /><PasswordBox ff:PasswordHelper.Attach=""True"" ff:PasswordHelper.Password=""{Binding Path=Password}"" Width=""130""/>",How to bind to a PasswordBox in MVVM
Programatically adding Images to RTF Document," I am trying to add a image to a RTF document which I am creating. I would prefer to not use 'copy/paste' methods (that involve pasting the image within a RichTextBox and then accessing the .RTF property) which purge the clipboard (as this will be a bother and confusion for my end users).The code I have so far returns the string that needs to be inserted into the RTF document to print the image. The inputted image (located at $path) is usually in bmp or jpeg format, but at this stage I am not concerned with how the image is stored within the RTF only that i can get it to work. However the problem is that this code does not work because as far as I can tell, the string str does not have the correct string conversion to work within the RTF.Edit: My problem was missing a space after the \hex in @""\hex "" and also not stripping out the ""-"" characters from the returned value of the BitConverter <code>  public string GetImage(string path, int width, int height){ MemoryStream stream = new MemoryStream(); string newPath = Path.Combine(Environment.CurrentDirectory, path); Image img = Image.FromFile(newPath); img.Save(stream, System.Drawing.Imaging.ImageFormat.Png); byte [] bytes = stream.ToArray(); string str = BitConverter.ToString(bytes, 0).Replace(""-"", string.Empty); //string str = System.Text.Encoding.UTF8.GetString(bytes); string mpic = @""{\pict\pngblip\picw"" + img.Width.ToString() + @""\pich"" + img.Height.ToString() + @""\picwgoa"" + width.ToString() + @""\pichgoa"" + height.ToString() + @""\hex "" + str + ""}""; return mpic}",Programmatically adding Images to RTF Document
"Problem with windows 7, office 2007 and DCOM "," I have a problem with a C# ASP .NET project in Visual Studio 2008This problem started when I reinstalled my computer with Windows 7 Ultimate (x64). To this I'm also using Office 2007. The error message I'm getting is: System.UnauthorizedAccessException: Retrieving the COM class factory for component with CLSID {000209FF-0000-0000-C000-000000000046} failed due to the following error: 80070005. at xxx.Utility.WordDocument..ctor(String filePath, HttpServerUtility util) at customer_communication.BuCreate_click(Object sender, EventArgs e) in c:\xxx\Website\customer\communication.aspx.cs:line 127 <code> ",System.UnauthorizedAccessException: Retrieving the COM class factory for Word Interop fails with error 80070005
System.UnauthorizedAccessException: Retrieving the COM class factory for component with CLSID {000209FF-0000-0000-C000-000000000046} failed due to the following error: 80070005.," I have a problem with a C# ASP .NET project in Visual Studio 2008This problem started when I reinstalled my computer with Windows 7 Ultimate (x64). To this I'm also using Office 2007. The error message I'm getting is: System.UnauthorizedAccessException: Retrieving the COM class factory for component with CLSID {000209FF-0000-0000-C000-000000000046} failed due to the following error: 80070005. at xxx.Utility.WordDocument..ctor(String filePath, HttpServerUtility util) at customer_communication.BuCreate_click(Object sender, EventArgs e) in c:\xxx\Website\customer\communication.aspx.cs:line 127 <code> ",System.UnauthorizedAccessException: Retrieving the COM class factory for Word Interop fails with error 80070005
System.UnauthorizedAccessException: Retrieving the COM class factory for Word Interop fails with error 80070005.," I have a problem with a C# ASP .NET project in Visual Studio 2008This problem started when I reinstalled my computer with Windows 7 Ultimate (x64). To this I'm also using Office 2007. The error message I'm getting is: System.UnauthorizedAccessException: Retrieving the COM class factory for component with CLSID {000209FF-0000-0000-C000-000000000046} failed due to the following error: 80070005. at xxx.Utility.WordDocument..ctor(String filePath, HttpServerUtility util) at customer_communication.BuCreate_click(Object sender, EventArgs e) in c:\xxx\Website\customer\communication.aspx.cs:line 127 <code> ",System.UnauthorizedAccessException: Retrieving the COM class factory for Word Interop fails with error 80070005
Making Methods All Static in Clas," I was told by my colleague based on one of my classes (it is an instance class) that if you have no fields in your class (backing fields), just make all methods static in the class or make the class a singleton so that you don't have to use the keyword new for calling methods in this BL class.I assume this is common and good practice? Basic OOP? I just want to see people's opinion on that.I think basically he's saying since there's no state, no need for the methods to be instance methods.I'm not sure about making it a singleton every time as an option in this case...is that some sort of pattern or good advice he's giving me?Here's the class I'm talking about (please do not repost any of this code in this thread, this is private): http://www.elbalazo.net/post/class.txt <code> ",Making Methods All Static in Class
How to solve COM Exception?, When I try to create a instance of a COM class it throws an exception as Class not registered (Exception from HRESULT: 0x80040154 (REGDB_E_CLASSNOTREG))Please suggest how could i solve it? <code> ,How to solve COM Exception Class not registered (Exception from HRESULT: 0x80040154 (REGDB_E_CLASSNOTREG))?
"Foreach Control in Form1, how can I do something to all the TextBoxes in my Form?"," How can I use a Foreach Statement to do something to my TextBoxes? <code>  foreach (Control X in this.Controls){ Check if the controls is a TextBox, if it is delete it's .Text letters.}","Foreach Control in form, how can I do something to all the TextBoxes in my Form?"
Find windows folder programicly in c#," I am writing a program to kill and restart explorer but I don't want to hard code the location because some people install windows in different places (for example I found someone who had it installed in the d:\ drive where the C:\ drive did exist but had nothing installed on it)I tried looking under Environment.SpecialFolder. but I don't see a ""windows"" option under thatWhat is the best way to do this? <code> ",Find windows folder programmatically in c#
Find windows folder programatically in c#," I am writing a program to kill and restart explorer but I don't want to hard code the location because some people install windows in different places (for example I found someone who had it installed in the d:\ drive where the C:\ drive did exist but had nothing installed on it)I tried looking under Environment.SpecialFolder. but I don't see a ""windows"" option under thatWhat is the best way to do this? <code> ",Find windows folder programmatically in c#
Best practice for C# Auto-Implemented Property and local variable that differ only by case," Let me give you an example: I've taken to using this in this scenario, because I have minor paranoia that relying on case alone might be confusing or worse might actually lead to bugs.What is the ""best practice"" here?EDIT:So far, it sounds like this is a lot more subjective than I thought. I figured people would come down strongly on one side or the other. <code>  public class MyClass{ public string MyProperty { get; set; } public MyClass(string myProperty) { MyProperty = myProperty; // bad? this.MyProperty = myProperty; // good? }}",Best practice for C# Auto-Implemented Property and local variable that differ only by case?
What is the most efficient way in C# to determine if a string starts with a number and then get all following numbers up until the first non-numeric character?," I have a requirement to sort some strings that contain data like this: And they want the results ordered like this:""2009 Arrears""""2009 Arrears Interest""""2008 Arrears""""2008 Arrears Interest""It seems like I need to create a function to see if the string starts with a number. If so, the function will get all numbers up until the first character and sort the numeric result descending and then sort the remaining characters ascending. I am having trouble trying to write a method that gets all starting numbers in a string. What would be an efficient way to do that? <code>  var strings = new List<string>{""2009 Arrears"",""2008 Arrears"",""2008 Arrears Interest"",""2009 Arrears Interest""};",How to efficiently determine if a string starts with a number and then get all following numbers up until the first non-numeric character?
The .Net equivalent of static libraries?," I'm building a tool in managed code (mostly C++/CLI) in two versions, a 'normal user' version and a 'pro' version. The fact that the core code is identical between the two versions has caused me a little trouble as I want to package the resulting tool as a single assembly (DLL) and I don't want to have to include the .cpp files for the common code in the projects of the two versions of the tools. I'd rather have a project for the common code and a project for each version of the tool and have each version of the tools project depend on the common code and link it in as desired.In unmanaged C++ I'd do this by placing the common code in a static library and linking both versions of the tool to it. I don't seem to be able to get this to work in C++/CLI. It seems that I'm forced to build the common code into a DLL assembly and that results in more DLL's than I'd like.So, in summary, I can't work out how to build the common code in one project and link it with each of the final product projects to produce two single DLL assemblies that both include the common code.I'm probably doing something wrong but I tried to work out how to do this using netmodules and whatever and I just couldn't get it to work. In the end the only way I got it working was to tell the linker to link the build products of the common code assembly rather than the results which works but is a bit of a hack IMHO.Anyway, does anyone have any suggestions for how I SHOULD be solving this problem?Edited: I guess I should have mentioned the fact that the assemblies generated are not 100% managed code, they contain a mix of managed and unmanaged code as is, probably, quite common with assemblies produced with C++/CLI... <code> ",The .NET equivalent of static libraries?
Buildspeed MSBuild vs. Visual Studio for C# Projects," I encounter a noticable difference in the speed when building the same solution one time with Devenv and the other time with msbuild /m.As an information I have set the parameter ""number of parallel build processes"" in Visual studio to 4.Is there any posiblity to speed up the build inside Visual Studio (Version 9.0.30729.1 SP)? <code> ",How can I speed up Visual Studio builds to match MSBuild parallel performance?
When to use Facotry method pattern?, When to use Factory method pattern?Please provide me some specific idea when to use it in project? and how it is a better way over new keyword? <code> ,When to use Factory method pattern?
C#: How to mark a method will throw unconditionally?," Is there a way to decorate a method that will do some logging, then throw an exception unconditionally, as such?I have code like this: If I try writing it like this I get a problem: Any suggestions? Thanks. <code>  void foo(out int x){ if( condition() ) { x = bar(); return; } // notice that x is not yet set here, but compiler doesn't complain throw new Exception( ""missed something."" );} void foo(out int x){ if( condition() ) { x = bar(); return; } // compiler complains about x not being set yet MyMethodThatAlwaysThrowsAnException( ""missed something."" );}",How to mark a method will throw unconditionally?
C# Ensure string contains only ASCII," I have a C# routine that imports data from a CSV file, matches it against a database and then rewrites it to a file. The source file seems to have a few non-ASCII characters that are fouling up the processing routine. I already have a static method that I run each input field through but it performs basic checks like removing commas and quotes. Does anybody know how I could add functionality that removes non-ASCII characters too? <code> ",Remove all non-ASCII characters from string
Difference in months," In C#/.NET TimeSpan has TotalDays, TotalMinutes, etc. but I can't figure out a formula for total months difference. Variable days per month and leap years keep throwing me off. How can I get TotalMonths?Edit Sorry for not being more clear: I know I can't actually get this from TimeSpan but I thought using TotalDays and TotalMinutes would be a good example to express what I was looking for ... except I'm trying to get Total Months.Example: Dec 25, 2009 - Oct 6, 2009 = 2 TotalMonths. Oct 6th to Nov 5th equals 0 months. On Nov 6th, 1 month. On Dec 6th, 2 months <code> ",calculating the difference in months between two dates
How can I calculate the difference in months between two dates?," In C#/.NET TimeSpan has TotalDays, TotalMinutes, etc. but I can't figure out a formula for total months difference. Variable days per month and leap years keep throwing me off. How can I get TotalMonths?Edit Sorry for not being more clear: I know I can't actually get this from TimeSpan but I thought using TotalDays and TotalMinutes would be a good example to express what I was looking for ... except I'm trying to get Total Months.Example: Dec 25, 2009 - Oct 6, 2009 = 2 TotalMonths. Oct 6th to Nov 5th equals 0 months. On Nov 6th, 1 month. On Dec 6th, 2 months <code> ",calculating the difference in months between two dates
C# write to Excel using Linq, I'm writing an app where I need to retrieve some rows from a DB and dump them into an Excel spreadsheet. I'm using Linq to retrieve these rows. Is it possible to dump these rows directly into their counterparts in the Excel sheet (where one cell in Excel corresponds to one cell from the DB)? <code> ,How can I write to an Excel spreadsheet using Linq?
C# Uncompress data file with DeflaterStream," I'm having trouble reading a compressed (deflated) data file using C# .NET DeflateStream(..., CompressionMode.Decompress). The file was written earlier using DeflateStream(..., CompressionMode.Compress), and it seems to be just fine (I can even decompress it using a Java program).However, the first Read() call on the input stream to decompress/inflate the compressed data returns a length of zero (end of file).Here's the main driver, which is used for both compression and decompression: Here's the basic code for decompression, which is what is failing: The call marked FAILS always returns zero. Why? I know it's got to be something simple, but I'm just not seeing it.Here's the basic code for compression, which works just fine, and is almost exactly the same as the decompression method with the names swapped: SolvedAfter seeing the correct solution, the constructor statement should be changed to: which keeps the underlying input stream open, and the following line needs to be added following the inp.Flush() call: The Close() calls forces the deflater stream to flush its internal buffers. The true flag prevents it from closing the underlying stream, which is closed later in Main(). The same changes should also be made to the Compress() method. <code>  public void Main(...){ Stream inp; Stream outp; bool compr; ... inp = new FileStream(inName, FileMode.Open, FileAccess.Read); outp = new FileStream(outName, FileMode.Create, FileAccess.Write); if (compr) Compress(inp, outp); else Decompress(inp, outp); inp.Close(); outp.Close();} public long Decompress(Stream inp, Stream outp){ byte[] buf = new byte[BUF_SIZE]; long nBytes = 0; // Decompress the contents of the input file inp = new DeflateStream(inp, CompressionMode.Decompress); for (;;) { int len; // Read a data block from the input stream len = inp.Read(buf, 0, buf.Length); //<<FAILS if (len <= 0) break; // Write the data block to the decompressed output stream outp.Write(buf, 0, len); nBytes += len; } // Done outp.Flush(); return nBytes;} public long Compress(Stream inp, Stream outp){ byte[] buf = new byte[BUF_SIZE]; long nBytes = 0; // Compress the contents of the input file outp = new DeflateStream(outp, CompressionMode.Compress); for (;;) { int len; // Read a data block from the input stream len = inp.Read(buf, 0, buf.Length); if (len <= 0) break; // Write the data block to the compressed output stream outp.Write(buf, 0, len); nBytes += len; } // Done outp.Flush(); return nBytes;} inp = new DeflateStream(inp, CompressionMode.Decompress, true); inp.Close();",Uncompress data file with DeflateStream
C# Uncompress data file with DeflateStream," I'm having trouble reading a compressed (deflated) data file using C# .NET DeflateStream(..., CompressionMode.Decompress). The file was written earlier using DeflateStream(..., CompressionMode.Compress), and it seems to be just fine (I can even decompress it using a Java program).However, the first Read() call on the input stream to decompress/inflate the compressed data returns a length of zero (end of file).Here's the main driver, which is used for both compression and decompression: Here's the basic code for decompression, which is what is failing: The call marked FAILS always returns zero. Why? I know it's got to be something simple, but I'm just not seeing it.Here's the basic code for compression, which works just fine, and is almost exactly the same as the decompression method with the names swapped: SolvedAfter seeing the correct solution, the constructor statement should be changed to: which keeps the underlying input stream open, and the following line needs to be added following the inp.Flush() call: The Close() calls forces the deflater stream to flush its internal buffers. The true flag prevents it from closing the underlying stream, which is closed later in Main(). The same changes should also be made to the Compress() method. <code>  public void Main(...){ Stream inp; Stream outp; bool compr; ... inp = new FileStream(inName, FileMode.Open, FileAccess.Read); outp = new FileStream(outName, FileMode.Create, FileAccess.Write); if (compr) Compress(inp, outp); else Decompress(inp, outp); inp.Close(); outp.Close();} public long Decompress(Stream inp, Stream outp){ byte[] buf = new byte[BUF_SIZE]; long nBytes = 0; // Decompress the contents of the input file inp = new DeflateStream(inp, CompressionMode.Decompress); for (;;) { int len; // Read a data block from the input stream len = inp.Read(buf, 0, buf.Length); //<<FAILS if (len <= 0) break; // Write the data block to the decompressed output stream outp.Write(buf, 0, len); nBytes += len; } // Done outp.Flush(); return nBytes;} public long Compress(Stream inp, Stream outp){ byte[] buf = new byte[BUF_SIZE]; long nBytes = 0; // Compress the contents of the input file outp = new DeflateStream(outp, CompressionMode.Compress); for (;;) { int len; // Read a data block from the input stream len = inp.Read(buf, 0, buf.Length); if (len <= 0) break; // Write the data block to the compressed output stream outp.Write(buf, 0, len); nBytes += len; } // Done outp.Flush(); return nBytes;} inp = new DeflateStream(inp, CompressionMode.Decompress, true); inp.Close();",Uncompress data file with DeflateStream
How to tell is a PropertyInfo is of a particular enum type?," I have the following code: When I get to a field of type Enum, or in this case NameSpace.MyEnum, I want to do something special. I can't simply SetValue because the value coming from the database is let's say ""m"" and the value in the Enum is ""Mr"". So I need to call another method. I know! Legacy systems right?So how do I determine when a PropertyInfo item is of a particular enumeration type?So in the above code I'd like to first check whether the PropertyInfo type is of a specif enum and if it is then call my method and if not then simply allow SetValue to run. <code>  public class DataReader<T> where T : class{ public T getEntityFromReader(IDataReader reader, IDictionary<string, string> FieldMappings) { T entity = Activator.CreateInstance<T>(); Type entityType = entity.GetType(); PropertyInfo[] pi = entityType.GetProperties(); string FieldName; while (reader.Read()) { for (int t = 0; t < reader.FieldCount; t++) { foreach (PropertyInfo property in pi) { FieldMappings.TryGetValue(property.Name, out FieldName); Type genericType = property.PropertyType; if (!String.IsNullOrEmpty(FieldName)) property.SetValue(entity, reader[FieldName], null); } } } return entity; }}",How to tell if a PropertyInfo is of a particular enum type?
C# reflection: GetProperties() with BindingFlags.DeclaredOnly," If I use I get all of the properties from the type and it's parent. However I only want to retrieve the properties defined explicitly in this type (not the parents). I thought that was what the BindingFlags.DeclaredOnly option was for. However, when I try this: I get 0 properties.Anyone know what I am doing wrong? <code>  sometype.GetProperties(); sometype.GetProperties(BindingFlags.DeclaredOnly);",Using GetProperties() with BindingFlags.DeclaredOnly in .NET Reflection
.NET reflection: GetProperties() with BindingFlags.DeclaredOnly," If I use I get all of the properties from the type and it's parent. However I only want to retrieve the properties defined explicitly in this type (not the parents). I thought that was what the BindingFlags.DeclaredOnly option was for. However, when I try this: I get 0 properties.Anyone know what I am doing wrong? <code>  sometype.GetProperties(); sometype.GetProperties(BindingFlags.DeclaredOnly);",Using GetProperties() with BindingFlags.DeclaredOnly in .NET Reflection
How to determine if a process ID is running., I'm using C# .NET 2.0. I need to determine if a PID exists. I came up with the following code: Is there a better way to do this other than iterating all the processes? <code>  private bool ProcessExists(int iProcessID){ foreach (Process p in Process.GetProcesses()) { if (p.Id == iProcessID) { return true; } } return false;},How to determine if a process ID exists
How to determine if a process ID exists., I'm using C# .NET 2.0. I need to determine if a PID exists. I came up with the following code: Is there a better way to do this other than iterating all the processes? <code>  private bool ProcessExists(int iProcessID){ foreach (Process p in Process.GetProcesses()) { if (p.Id == iProcessID) { return true; } } return false;},How to determine if a process ID exists
Easiest way to split a string on newlines in .net?," I need to split a string into newlines in .NET and the only way I know of to split strings is with the Split method. However that will not allow me to (easily) split on a newline, so what is the best way to do it? <code> ",Easiest way to split a string on newlines in .NET?
C# Anonymous types problem," What is wrong with this code-snippet? I am getting the following errors: How to re-set values into an anonymous type object? <code>  class Program{ static void Main(string[] args) { var obj = new { Name = ""A"", Price = 3.003 }; obj.Name = ""asdasd""; obj.Price = 11.00; Console.WriteLine(""Name = {0}\nPrice = {1}"", obj.Name, obj.Price); Console.ReadLine(); }} Error 5 Property or indexer 'AnonymousType#1.Name' cannot be assigned to -- it is read only .....\CS_30_features.AnonymousTypes\Program.cs 65 13 CS_30_features.AnonymousTypesError 6 Property or indexer 'AnonymousType#1.Price' cannot be assigned to -- it is read only .....\CS_30_features.AnonymousTypes\Program.cs 66 13 CS_30_features.AnonymousTypes",C# Anonymous types cannot be assigned to -- it is read only
Formatting Large Numbers ," I have a requirement to format large numbers like 4,316,000 as ""4.3m"".How can I do this in C#? <code> ",Formatting Large Numbers with .NET
C#:  Formatting Large Numbers ," I have a requirement to format large numbers like 4,316,000 as ""4.3m"".How can I do this in C#? <code> ",Formatting Large Numbers with .NET
"CSharp Threading :Applying Monitor.Wait,lock,PulsAll"," I am new to CSharp and Threading.To be familiar with Monitor.Wait,Monitor.lock and Monitor.PulseAll,I framed a scenario described below.""A FootballGround is being shared by different teams for practicing purpose. At any time only one team can use the ground for their practice. A team can use the ground for 30 minutes for their practice. Once the time reaches 25 minutes it should signal other threads that the ground is about to free after 5 minutes.When the ground is wet (enum has three values free,allotted,wet) no team is allowed to lock the ground and all should wait for 10 minutesHonestly speaking, I do not know how turn the description in to actual coding. Based on my understanding I designed the outline. Here I do not know how to apply locks and signalls.kindly help me . <code>  namespace ThreadingSimulation { // A Random Activity can be picked up from this enum by a team public enum RandomGroundStatus { free, allotted, Wet }class FootBallGround{ public void Playing(object obj) { // Here the name of the team which is using the ground will be printed // Once the time is reached to 25 minnutes the active thread acquired // the lock will signal other threads } public void GroundCleaningInProgress(object obj) { // Ground cleaning is in progress all of you // wait for 10 minutes }} class Team { string teamName; static void Main() { //select random value for GrandStatus from enum // if the ground is wet no team is allowed to get the // ground for 10 minutes //if the ground is free ""Team A"" locks the ground // otherwise ""Team B"" locks the ground } }}","C# Threading: Using Monitor.Wait, Lock and PulseAll"
Is it possible to restart a PC using .NET *without* using p/invoke?," Is it possible, without employing pinvoke, to restart a PC using .NET?I kind of just repeated the title, but I'm not too sure how to elaborate much further!Edit:I should have mentioned that don't want to use ""shutdown -r"" as a solution.I was really after a pure .NET way, something like:Environment.ShutDown();In other words, something that is maintained with .NET as new versions of Windows arise.Edit 2:Please stop asking ""what's wrong with p/invoke"". Those sort of answers are exactly what SO users seem to love; the supposed ""lateral"" approach to answering a question. However, although there is no real problem with p/invoke and I will happily use it, what on earth is wrong with asking if .NET has a more official way of achieving something? If it's in .NET then any API changes between OSes will (most likely) get reflected. Whatever the reason, it's not a crime to seek to minimise DLL import usage is it?I'm sure if I included something in a question like: And you could just do: Everyone one here would scream: ""what is wrong with using SomeNamespace.ClimbWall();??""Sigh. <code>  [DllImport(""something32.dll"")]static extern int ClimbWall32Ex(IntPtr32 blah); SomeNamespace.ClimbWall();","Is it possible to restart a PC using ""pure"" .NET and *without* using p/invoke?"
Iterationg trough GroupCollection in C#," I'm currently trying to use regular expressions in C#: Can I iterate through the matchresult.Groups GroupCollection and add the key-value pairs to my gameinfo dictionary? <code>  Regex reg_gameinfo = new Regex(@""PokerStars Game #(?<HID>[0-9]+):\s+(?:HORSE)? \(?(?<GAME>Hold'em|Razz|7 Card Stud|Omaha|Omaha Hi/Lo|Badugi) (?<LIMIT>No Limit|Limit|Pot Limit),? \(?(?<CURRENCYSIGN>\$|)?(?<SB>[.0-9]+)/\$?(?<BB>[.0-9]+) (?<CURRENCY>.*)\) - (?<DATETIME>.*$)"", RegexOptions.Multiline);Match matchresults = reg_gameinfo.Match(rawtext);Dictionary<string,string> gameinfo = new Dictionary<string,string>();if (matchresults.Success){ gameinfo.Add(""HID"", matchresults.Groups[""HID""].Value); gameinfo.Add(""GAME"", matchresults.Groups[""GAME""].Value); ...}",Iteration through GroupCollection in C#
How do C# deep copy constructors work with inheiritance?," I wish to implement a deepcopy of my classes hierarchy in C# This will not work as when Cloning the Child only a parent is new-ed. In my code some classes have large hierarchies.What is the recommended way of doing this? Cloning everything at each level without calling the base class seems wrong? There must be some neat solutions to this problem, what are they?Can I thank everyone for their answers. It was really interesting to see some of the approaches. I think it would be good if someone gave an example of a reflection answer for completeness. +1 awaiting!  <code>  public Class ParentObj : ICloneable{ protected int myA; public virtual Object Clone () { ParentObj newObj = new ParentObj(); newObj.myA = theObj.MyA; return newObj; }}public Class ChildObj : ParentObj{ protected int myB; public override Object Clone ( ) { Parent newObj = this.base.Clone(); newObj.myB = theObj.MyB; return newObj; }}",I need to implement C# deep copy constructors with inheritance. What patterns are there to choose from?
How do I implement C# deep copy constructors work with inheiritance?," I wish to implement a deepcopy of my classes hierarchy in C# This will not work as when Cloning the Child only a parent is new-ed. In my code some classes have large hierarchies.What is the recommended way of doing this? Cloning everything at each level without calling the base class seems wrong? There must be some neat solutions to this problem, what are they?Can I thank everyone for their answers. It was really interesting to see some of the approaches. I think it would be good if someone gave an example of a reflection answer for completeness. +1 awaiting!  <code>  public Class ParentObj : ICloneable{ protected int myA; public virtual Object Clone () { ParentObj newObj = new ParentObj(); newObj.myA = theObj.MyA; return newObj; }}public Class ChildObj : ParentObj{ protected int myB; public override Object Clone ( ) { Parent newObj = this.base.Clone(); newObj.myB = theObj.MyB; return newObj; }}",I need to implement C# deep copy constructors with inheritance. What patterns are there to choose from?
How do I implement C# deep copy constructors work with inheritance?," I wish to implement a deepcopy of my classes hierarchy in C# This will not work as when Cloning the Child only a parent is new-ed. In my code some classes have large hierarchies.What is the recommended way of doing this? Cloning everything at each level without calling the base class seems wrong? There must be some neat solutions to this problem, what are they?Can I thank everyone for their answers. It was really interesting to see some of the approaches. I think it would be good if someone gave an example of a reflection answer for completeness. +1 awaiting!  <code>  public Class ParentObj : ICloneable{ protected int myA; public virtual Object Clone () { ParentObj newObj = new ParentObj(); newObj.myA = theObj.MyA; return newObj; }}public Class ChildObj : ParentObj{ protected int myB; public override Object Clone ( ) { Parent newObj = this.base.Clone(); newObj.myB = theObj.MyB; return newObj; }}",I need to implement C# deep copy constructors with inheritance. What patterns are there to choose from?
How do I implement C# deep copy constructors with inheritance?," I wish to implement a deepcopy of my classes hierarchy in C# This will not work as when Cloning the Child only a parent is new-ed. In my code some classes have large hierarchies.What is the recommended way of doing this? Cloning everything at each level without calling the base class seems wrong? There must be some neat solutions to this problem, what are they?Can I thank everyone for their answers. It was really interesting to see some of the approaches. I think it would be good if someone gave an example of a reflection answer for completeness. +1 awaiting!  <code>  public Class ParentObj : ICloneable{ protected int myA; public virtual Object Clone () { ParentObj newObj = new ParentObj(); newObj.myA = theObj.MyA; return newObj; }}public Class ChildObj : ParentObj{ protected int myB; public override Object Clone ( ) { Parent newObj = this.base.Clone(); newObj.myB = theObj.MyB; return newObj; }}",I need to implement C# deep copy constructors with inheritance. What patterns are there to choose from?
How GetSchemaTable() works?, How does GetSchemaTable() work?Where does it get its information in RDBMS? <code>  OleDbDataReader oleDbDataReader = oleDbCommand.ExecuteReader(CommandBehavior.KeyInfo);DataTable dataTable = oleDbDataReader.GetSchemaTable();,How Does GetSchemaTable() Work?
Redirect stdout+stderr on c# windows service," I've written a Windows service in C# using the ServiceBase helper. During its execution, some procedures in an external native DLL are called. Annoyingly, those procedures write to stdout and/or stderr in an uncontrolled manner as no sources are given for this DLL.Is it possible to redirect those outputs from the C# service to a log file? <code> ",Redirect stdout+stderr on a C# Windows service
lUCENE.NET TermQuery wildcard search," I have a lucene index I am trying to do a wildcard search.In index i have a character like'234Test2343'I am trying to do the search like %Test%..My lucene syntax looks like I don't get the results back. Any thoughts?Thanks <code>  string catalogNumber=""test"";Term searchTerm = new Term(""FIELD"", ""*""+catalogNumber+""*"");Query query = new TermQuery(searchTerm);",Lucene.Net TermQuery wildcard search
C# - displaying the build date," I currently have an app displaying the build number in its title window. That's well and good except it means nothing to most of the users, who want to know if they have the latest build - they tend to refer to it as ""last Thursday's"" rather than build 1.0.8.4321.The plan is to put the build date there instead - So ""App built on 21/10/2009"" for example.I'm struggling to find a programmatic way to pull the build date out as a text string for use like this.For the build number, I used: after defining how those came up.I'd like something like that for the compile date (and time, for bonus points).Pointers here much appreciated (excuse pun if appropriate), or neater solutions... <code>  Assembly.GetExecutingAssembly().GetName().Version.ToString()",Displaying the build date
Does a StreamReader lock a text file whilst it is in use? Can I prevent this?," The StreamReader locks a text file whilst it is reading it.Can I force the StreamReader to work in a ""read-only"" or ""non locking"" mode?My workaround would be to copy the file to a temp location and read it from there but I would prefer to use the StreamReader directly if possible.Any alternative suggetions?Background:I've written a small app to get some stats out of a log file. This file is constantly being updating (several times a second) by an outside program lets call AAXXYY. Reviewing the output suggests that my app may be locking the file and preventing AAXXYY from writing. This is what I'm doing <code>  private void btnGetStats_Click(object sender, EventArgs e) { int countStarts = 0; int countEnds = 0; IList<string> sessions = new List<string>(); using(StreamReader stRead = new StreamReader(openFileDialog1.FileName,Encoding.Unicode)) { while(!stRead.EndOfStream) { string line = stRead.ReadLine(); if(line.Contains(""Session start"")) { countStarts++; sessions.Add(line.Substring(line.IndexOf(""[""), line.LastIndexOf(""]"") - line.IndexOf(""[""))); } if (line.Contains(""Session end"")) { countEnds++; sessions.Remove(line.Substring(line.IndexOf(""[""), line.LastIndexOf(""]"") - line.IndexOf(""[""))); } } } txtStarts.Text = countStarts.ToString(); txtEnds.Text = countEnds.ToString(); txtDifference.Text = (countStarts - countEnds).ToString(); listBox1.DataSource = sessions; }",Can I prevent a StreamReader from locking a text file whilst it is in use?
how to calculate the difference between 2 dates and return number of days," I see that this question has been answered for Java, JavaScript, and PHP, but not C#. So, how might one calculate the number of days between two dates in C#? <code> ",Calculate difference between two dates (number of days)?
C#: Calculate difference between two dates (number of days)?," I see that this question has been answered for Java, JavaScript, and PHP, but not C#. So, how might one calculate the number of days between two dates in C#? <code> ",Calculate difference between two dates (number of days)?
How to encryt a string in .NET?, I have to encrypt/decrypt some sensitive information in a Xml file?Yes I can do that by writing my own custom algorithms. I am wondering if there is already a built in way in .NET to do that and also what points I always need to take care.. <code> ,How to encrypt a string in .NET?
Search keyword highlight in ASP.Net C#," I am outputting a list of search results for a given string of keywords, and I want any matching keywords in my search results to be highlighted. Each word should be wrapped in a span or similar. I am looking for an efficient function to do this.E.g.Keywords: ""lorem ipsum""Result: ""Some text containing lorem and ipsum""Desired HTML output: ""Some text containing <span class=""hit"">lorem</span> and <span class=""hit"">ipsum</span>""My results are case insensitive. <code> ",Search keyword highlight in ASP.Net
"Which is better performance in foreach, declare vaiable once on inside it?"," What is better for performance wise declaring the variable outside the foreach statment and the each time reassign it in side it (foreach) or create an new variable inside foreachfor example or this one? sure here I'm speak about item object.thank you all. <code>  private List<ListItem> GetItems() { var items = new List<ListItem>(); var collection = new List<int> { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 }; ListItem item; foreach (var i in collection) { item = new ListItem { Text = i.ToString() }; items.Add(item); } return items; } private List<ListItem> GetItems() { var items = new List<ListItem>(); var collection = new List<int> { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 }; foreach (var i in collection) { ListItem item = new ListItem { Text = i.ToString() }; items.Add(item); } return items; }","foreach, performance-wise. Should we declare variable once before loop or inside it?"
Why does C# 3 allow the implicit conversion of literal zero (0) to any Enum?," C#3 (Visual Studio 2008) introduced a breaking change to the language (http://msdn.microsoft.com/en-us/library/cc713578.aspx, see change 12) that allows any literal zero to be implicitly converted to an Enum. This seems odd in many ways. Does anyone know why this is part of the spec? Why not a literal one? Or seven? Why is zero special? And it makes some very counterintuitive overload resolution choices. For instance. Very confusing, and an intentionally introduced breaking change to the language. Any ideas? <code>  function string F(object o) { return o.ToString(); }function string F(DbType t) { return t.ToString(); }int i = 0;F((long)0) == ""String"" // would have been ""0"" in VS 2005F(0) == ""String""F(i) == ""0""",Why does C# allow the implicit conversion of literal zero (0) to any Enum?
WinForms.TreeView - The best way to filter nodes," What's the best/efficient way to filter Treeview nodes?For example: I typed ""abc"" and only the nodes contained ""abc"" become visible. Then I typed ""abcd"", and I should to see the only nodes containing ""abcd"" text. And so on, so each time I changed filter criterion the TreeView content also changes.Any ideas? <code> ",The best way to filter TreeView nodes
Faster way to find out if a user exists on a system? [Windows XP & C#]," I have an application that checks to see if a user exists (if not create it) every time it starts. This is done as follows: The problem is on the majority of the systems where it is deployed. This can take 6 - 10 seconds, which is too long ... I need to find a way to reduce this (as much as possible). Is there a better or faster way I can use to verify if a user exists on the system or not?I know there are other ways to solve this, like have the other applications sleep for 10 seconds, or have this tool send a message when it is ready, etc... But if I can greatly reduce the time it takes to find the user, it would make my life much easier. <code>  bool bUserExists = false;DirectoryEntry dirEntryLocalMachine = new DirectoryEntry(""WinNT://"" + Environment.MachineName + "",computer"");DirectoryEntries dirEntries = dirEntryLocalMachine.Children;foreach (DirectoryEntry dirEntryUser in dirEntries){ bUserExists = dirEntryUser.Name.Equals(""UserName"", StringComparison.CurrentCultureIgnoreCase); if (bUserExists) break;}",Faster way to find out if a user exists on a system?
Game Programming - Game architecture question," recently I have been trying my hand at coding a game in C#. I'm not using XNA for this, as I thought I would learn more if I coded the game from scratch (although I am using a multimedia engine).I'm trying to design a 2D RPG game - a bit ambitious I know, however I have a reasonably well understanding of at least the basic parts of the game (ie the 'boiler plate' code), and I've reached a part where I don't know where to go from here.In the 2D game, you progress through the game via walking around different 'areas'. Once you hit a 'portal tile', you are transported to the next area etc.I'm having trouble understanding how these area object should be set up. This was my first idea: Each area has a few different collection structures (for example, a visibility quadtree, a collision quadtree, an AI entity List etc). So if I were to add an enemy entity into the game, it would be put into the visibility quadtree, the collision quadtree (because you can collide with entities) and the AI entity list. When the area receives an update request, it tells each of these structures to update themselves, which in turn tell the entities to update themselves. All good, so far.My question is this: What if this enemy needs to communicate with other objects? For example, it might need to know whether the player was in a certain range of it. Or whether it had been hit by the player. Or where all the collidable objects are in the area (so it could pathfind).The first (and bad) solution to this problem would be simply to pass each entity a reference to each collection. But this obviously encourages tightly coupled objects, which is not good.The second solution I came up with was for each entity to be able to query the area, via message structures. So an enemy would be able to say ""Give me a list of each entity within X distance of my position"" and the area would return an answer. However, this would get increasingly difficult as I would have to code more and more possibilities into the area (""Give me a list of entities that are not within X distance of myself"", ""Give me a list of all entities with health lower than X"" etc).What I'm looking for is a time tested solution to this problem of inter object communication, and basically how to set up an area. I suppose it would need some kind of messaging system as well, although I'm not sure.Thanks for reading. <code> ",Game Programming - communication between game objects in 2d
Get the opposite of a union for a generic list, I have 2 separate List and I need to compare the two and get everything but the intersection of the two lists. How can I do this (C#)? <code> ,Get the symmetric difference from generic lists
WPF - Problems overwriting (re-saving) image when it was set as image source.," Good day all,I am having some trouble with image permissions.I am loading an image from file, resizing it and then saving it out to another folder.I am then displaying this like so: This is working fine, the trouble comes if the user then selects another image immediately after and tries to save it over the original file.An exception is generated upon saving my image ""ExternalException: A generic error occurred in GDI+.""After some playing around i have narrowed the error down to imgAsset.Source = new BitmapImage(uriSource); as removing this line and not setting the imagesource will allow me to overwrite this file many times.I have also tried setting the source to something else, before re-saving in the hope that the old reference would be disposed, this was not the case.How can i get past this error?Thanks,KohanEdit Now using this code i am not getting the exception however the image source is not updating. Also since i am not using a SourceStream, im not sure what i need to dispose of to get this working. <code>  uriSource = new Uri(Combine(imagesDirectoryTemp, generatedFileName), UriKind.Absolute); imgAsset.Source = new BitmapImage(uriSource); uriSource = new Uri(Combine(imagesDirectoryTemp, generatedFileName), UriKind.Absolute); imgTemp = new BitmapImage(); imgTemp.BeginInit(); imgTemp.CacheOption = BitmapCacheOption.OnLoad; imgTemp.UriSource = uriSource; imgTemp.EndInit(); imgAsset.Source = imgTemp;",Problems overwriting (re-saving) image when it was set as image source
Directory.Delete doesn't work. Access denied error but under Windows Explorer it's ok.," I have searched the SO but find nothing.Why this doesn't work? Above line will throw exception ""Access is denied"". I have admin rigths and I can delete the dir with Explorer.It looks like some forbidden chars? but Windows Explorer can handle it. How can I delete directories with names like that? <code>  Directory.Delete(@""E:\3\{90120000-001A-0000-0000-0000000FF1CE}-C"");",Directory.Delete doesn't work. Access denied error but under Windows Explorer it's ok
Is it possible to use ref types in C# build-in Action<> delegate?," C# has built-in delegates Action<> and Func<>. Is it possible to use 'ref' type parameters for this delegates? For example, this code: Will compile. But if I use Action<>, it will not compile: Any hints? <code>  public delegate void DTest( ref Guid a );public event DTest ETest; public event Action< ref Guid > ETest;",Is it possible to use ref types in C# built-in Action<> delegate?
Can I have an optional boolean parameter for an ASP.NET SOAP Webservice," I want to build a webservice with this signature, which does not throw an exception if param2 is left empty. Is this possible? The exception is a System.ArgumentException that is thrown when trying to convert the empty string to boolean.Ideas that have not worked so far:method overloading is not allowed for webservices, like as suggested here:make bool nullable bool?. Same exception.manipulate the WSDL, see this answerMy question is related to this question, but the only answer points to WCF contracts, which I have not used yet. <code>  [WebMethod]public string HelloWorld(string param1, bool param2) { } public string HelloWorld(string param1){ return HelloWorld(param1, false);}",Can I have an optional parameter for an ASP.NET SOAP web service
Does C# resolve dependencies amongy static data member  automatically?," If one static data member depends on another static data member, does C#/.NET guarantee the depended static member is initialized before the dependent member?For example, we have one class like: When Foo.b is accessed, is it always ""abcdef"" or can be ""def""?If this is not guaranteed, is there any better way to make sure depended member initialized first? <code>  class Foo{ public static string a = ""abc""; public static string b = Foo.a + ""def"";}",Does C# resolve dependencies among static data members automatically?
"in C# , How can i read a connection string stored in my web.config file connection string"," In C# class library, how can I read a connection string stored in my web.config file connection string tag? As in: <code>  <connectionStrings> <add name=""CLessConStringLocal"" connectionString=""server=localhost;database=myDb;uid=sa;pwd=mypassword;""/></connectionStrings>","In C# , how can I read a connection string stored in my web.config file connection string?"
"Auto-scrolling text box uses more memory than expected (C#, .NET v3.5)"," I have an application that logs messages to the screen using a TextBox. The update function uses some Win32 functions to ensure that the box automatically scrolls to the end unless the user is viewing another line. Here is the update function: Now the strange thing is that the text box consumes at least double the memory that I would expect it to. For example, when there are ~1MB of messages in the TextBox, the application can consume up to 6MB of memory (in addition to what it uses when the logToScreen is set to false). The increase is always at least double what I expect, and (as in my example) sometimes more.What is more strange is that using: Does not free the memory (in fact, it increases slightly).Any idea where the memory is going as I'm logging these messages? I don't believe it has anything to do with the Win32 calls, but I've included it to be thorough.EDIT:The first couple of responses I got were related to how to track a memory leak, so I thought I should share my methodology. I used a combination of WinDbg and perfmon to track the memory use over time (from a couple hours to days). The total number of bytes on all CLR heaps does not increase by more than I expect, but the total number of private bytes steadily increases as more messages are logged. This makes WinDbg less useful, as it's tools (sos) and commands (dumpheap, gcroot, etc.) are based on .NET's managed memory.This is likely why GC.Collect() can not help me, as it is only looking for free memory on the CLR heap. My leak appears to be in un-managed memory. <code>  private bool logToScreen = true;// Constants for extern calls to various scrollbar functionsprivate const int SB_HORZ = 0x0;private const int SB_VERT = 0x1;private const int WM_HSCROLL = 0x114;private const int WM_VSCROLL = 0x115;private const int SB_THUMBPOSITION = 4;private const int SB_BOTTOM = 7;private const int SB_OFFSET = 13;[DllImport(""user32.dll"")]static extern int SetScrollPos(IntPtr hWnd, int nBar, int nPos, bool bRedraw);[DllImport(""user32.dll"", CharSet = CharSet.Auto)]private static extern int GetScrollPos(IntPtr hWnd, int nBar);[DllImport(""user32.dll"")]private static extern bool PostMessageA(IntPtr hWnd, int nBar, int wParam, int lParam);[DllImport(""user32.dll"")]static extern bool GetScrollRange(IntPtr hWnd, int nBar, out int lpMinPos, out int lpMaxPos);private void LogMessages(string text){ if (this.logToScreen) { bool bottomFlag = false; int VSmin; int VSmax; int sbOffset; int savedVpos; // Make sure this is done in the UI thread if (this.txtBoxLogging.InvokeRequired) { this.txtBoxLogging.Invoke(new TextBoxLoggerDelegate(LogMessages), new object[] { text }); } else { // Win32 magic to keep the textbox scrolling to the newest append to the textbox unless // the user has moved the scrollbox up sbOffset = (int)((this.txtBoxLogging.ClientSize.Height - SystemInformation.HorizontalScrollBarHeight) / (this.txtBoxLogging.Font.Height)); savedVpos = GetScrollPos(this.txtBoxLogging.Handle, SB_VERT); GetScrollRange(this.txtBoxLogging.Handle, SB_VERT, out VSmin, out VSmax); if (savedVpos >= (VSmax - sbOffset - 1)) bottomFlag = true; this.txtBoxLogging.AppendText(text + Environment.NewLine); if (bottomFlag) { GetScrollRange(this.txtBoxLogging.Handle, SB_VERT, out VSmin, out VSmax); savedVpos = VSmax - sbOffset; bottomFlag = false; } SetScrollPos(this.txtBoxLogging.Handle, SB_VERT, savedVpos, true); PostMessageA(this.txtBoxLogging.Handle, WM_VSCROLL, SB_THUMBPOSITION + 0x10000 * savedVpos, 0); } }} this.txtBoxLogging.Clear();for (int i = 0; i < 3; i++){ GC.Collect(); GC.WaitForPendingFinalizers();}",Auto-scrolling text box uses more memory than expected
dynamic code generation," I am currently developing an application where you can create ""programs"" with it without writing source code, just click&play if you like.Now the question is how do I generate an executable program from my data model. There are many possibilities but I am not sure which one is the best for me. I need to generate assemblies with classes and namespace and everything which can be part of the application.CodeDOM class: I heard of lots of limitations and bugs of this class. I need to create attributes on method parameters and return values. Is this supported?Create C# source code programmatically and then call CompileAssemblyFromFile on it: This would work since I can generate any code I want and C# supports most CLR features. But wouldn't this be slow?Use the reflection ILGenerator class: I think with this I can generate every possible .NET code. But I think this is much more complicated and error prone than the other approaches?Are there other possible solutions?EDIT:The tool is general for developing applications, it is not restricted to a specific domain. I don't know if it can be considered a visual programming language. The user can create classes, methods, method calls, all kinds of expressions. It won't be very limitating because you should be able to do most things which are allowed in real programming languages. At the moment lots of things must still be written by the user as text, but the goal at the end is, that nearly everything can be clicked together. <code> ",Dynamic code generation
C# testing to see if a result is an integer?," I'm just curious as to whether there is something built into either the C# language or the .NET Framework that tests to see if something is an integer It seems to me that there might be, but I am only a first-year programming student, so I don't know. <code>  if (x is an int) // Do something",C# testing to see if a string is an integer?
annonmous c# delegate ," Hi all i am trying to write and anonymous delegate. as the integer variable is shared among the delegate i need it to be the local instance of every delegate such that rs[0] always gets nics[0], rs[1] always gets nics[1] and so on... how will i achieve this. Abdul khaliq <code>  for (int i = 0; i < nics.Count; i++) { rs[i] = new RollingSeries(monitor, new RollingSeries.NextValueDelegate(delegate() { return GetNetworkUtilization(nics[i]); })); }",Anonymous c# delegate within a loop
anonymous c# delegate ," Hi all i am trying to write and anonymous delegate. as the integer variable is shared among the delegate i need it to be the local instance of every delegate such that rs[0] always gets nics[0], rs[1] always gets nics[1] and so on... how will i achieve this. Abdul khaliq <code>  for (int i = 0; i < nics.Count; i++) { rs[i] = new RollingSeries(monitor, new RollingSeries.NextValueDelegate(delegate() { return GetNetworkUtilization(nics[i]); })); }",Anonymous c# delegate within a loop
interesting OutOfMemoryException with StringBuilder ," I have the need to continuously build large strings in a loop and save them to database which currently occasionally yields an OutOfMemoryException.What is basically going on here is I create a string using XmlWriter with StringBuilder based on some data. Then I call a method from an external library that converts this xml string to some other string. After that the converted string is saved to the database. This whole thing is done repeatedly in a loop about a 100 times for different data.The strings by itself are not too big (below 500kByte each) and the process memory is not increasing during this loop. But still, occasionally I get a OutOfMemeoryExcpetion within StringBuilder.Append. Interestingly this exception does not result in a crash. I can catch that exception and continue the loop.What is going on here? Why would I get an OutOfMemoryException although there is still enough free memory available in the system? Is this some GC heap problem?Given that I can't circumvent converting all these strings, what could I do to make this work reliably? Should I force a GC collection? Should put a Thread.Sleep into the loop? Should I stop using StringBuilder? Should simply retry when confronted with a OutOfMemoryException? <code> ",Interesting OutOfMemoryException with StringBuilder
interesting OutOfMemoryException with StringBuilder," I have the need to continuously build large strings in a loop and save them to database which currently occasionally yields an OutOfMemoryException.What is basically going on here is I create a string using XmlWriter with StringBuilder based on some data. Then I call a method from an external library that converts this xml string to some other string. After that the converted string is saved to the database. This whole thing is done repeatedly in a loop about a 100 times for different data.The strings by itself are not too big (below 500kByte each) and the process memory is not increasing during this loop. But still, occasionally I get a OutOfMemeoryExcpetion within StringBuilder.Append. Interestingly this exception does not result in a crash. I can catch that exception and continue the loop.What is going on here? Why would I get an OutOfMemoryException although there is still enough free memory available in the system? Is this some GC heap problem?Given that I can't circumvent converting all these strings, what could I do to make this work reliably? Should I force a GC collection? Should put a Thread.Sleep into the loop? Should I stop using StringBuilder? Should simply retry when confronted with a OutOfMemoryException? <code> ",Interesting OutOfMemoryException with StringBuilder
resharper - question on exception warning," Consider this method (pardon the sad attempt at Chuck Norris humor :) ): In resharper, I get a warning on the ""throw e"" line saying ""Exception rethrow possibly intended"". But obviously in this case that's not the intention, since e could be wrapped in ChuckNorrisException, and if I just use ""throw"", that wrapped exception wouldn't get thrown.I know I can suppress the resharper warning, but then it will be turned off for all scenarios if I'm not mistaken. I just wondered if anybody else had encountered this. The only workaround I've found is to make another exception variable (e2, for example), and throw that. That may be the best I can do here. Seems like resharper could detect this issue though and be smart enough to know that if e is modified, then throw e is ok.Thanks.[EDIT]Sorry, I forgot a step. Before the throw, I need to log the exception, so I can't just do: I have to do: <code>  public class ChuckNorrisException : Exception{ public ChuckNorrisException() { } public ChuckNorrisException(string message) : base(message) { } public ChuckNorrisException(string message, Exception cause) : base(message, cause) { } protected ChuckNorrisException(SerializationInfo info, StreamingContext context) : base(info, context) { }}static void ExceptionTest(double x){ try { double y = 10 / x; Console.WriteLine(""quotient = "" + y); } catch (Exception e) { e = e is DivideByZeroException ? new ChuckNorrisException(""Only Chuck Norris can divide by 0!"", e) : e; throw e; }} e = e is DivideByZeroException ? new ChuckNorrisException(""Only Chuck Norris can divide by 0!"", e) : e;throw e; e = e is DivideByZeroException ? new ChuckNorrisException(""Only Chuck Norris can divide by 0!"", e) : e;LogException(e);throw e;",Resharper Exception rethrow possibly intended
Question about Environment.ProcessCount," I am curious as to what the .NET property Environment.ProcessorCount actually returns. Does it return the number of cores, the number of processors or both? If my computer had 2 processors, each with 4 cores, would Environment.ProcessorCount return 2, 4, or 8? <code> ",Question about Environment.ProcessorCount
format of for loops," All over the web, code samples have for loops which look like this: while I used the following format: I do this because I believe it to be more efficient, but does this really matter in most cases? <code>  for(int i = 0; i < 5; i++) for(int i = 0; i != 5; ++i)",Technical reasons behind the choice of for-loop-expressions?
Technical reasons behind formatting when incrementing by 1 in a 'for' loop?," All over the web, code samples have for loops which look like this: while I used the following format: I do this because I believe it to be more efficient, but does this really matter in most cases? <code>  for(int i = 0; i < 5; i++) for(int i = 0; i != 5; ++i)",Technical reasons behind the choice of for-loop-expressions?
LockFileEX from C#," BackgroundI'm trying to implement block file locking in my C# application. The built-in FileStream.Lock method throws an exception if it is unable to acquire the lock.The underlying LockFile method returns a status code however I'd prefer not to use a spin-lock to wait for the file to be unlocked. QuestionDoes anyone have any code snippets in C# showing how to properly construct the OVERLAPPED structure with a wait handle and pass it to LockFileEx and wait for the operation to complete? I am trying to avoid using the Overlapped.Pack methods partially because they're unsafe but mostly because they require an IOCompletionCallback which isn't what I'm trying to achieve.I have the declarations but the construction & use of the OverLapped structure seems to be a little bit more complicated. Note: I know I need to manually pin the overlapped structure until the wait completes. My current code looks like: ResolutionThe code that ended up working as I wanted was: This code will block until the exclusive lock on the region can be acquired. <code>  ManualResetEvent evt = new ManualResetEvent(false);OVERLAPPED overlapped = new OVERLAPPED();overlapped.OffsetLow = offsetLow;overlapped.OffsetHigh = offsetHigh;overlapped.hEvent = evt.SafeHandle;GCHandle h = GCHandle.Alloc(overlapped, GCHandleType.Pinned);int hr = Win32.LockFileEX(_handle, LockFlags.Exclusive, 0, offsetLow, offsetHigh, GCHandle.ToIntPtr(h));if(hr == 0){ int error = Marshal.GetLastWin32Error(); if(error = Win32.ERROR_IO_PENDING) { evt.WaitOne(); } else { //ohpoo }} [StructLayout(LayoutKind.Sequential)]public struct OVERLAPPED{ public uint internalLow; public uint internalHigh; public uint offsetLow; public uint offsetHigh; public IntPtr hEvent;}[DllImport(""Kernel32.dll"", SetLastError = true)]private static extern bool LockFileEx(SafeFileHandle handle, uint flags, uint reserved, uint countLow, uint countHigh, ref OVERLAPPED overlapped);private const uint LOCKFILE_EXCLUSIVE_LOCK = 0x00000002;public static void Lock(FileStream stream, ulong offset, ulong count){ uint countLow = (uint)count; uint countHigh = (uint)(count >> 32); OVERLAPPED overlapped = new OVERLAPPED() { internalLow = 0, internalHigh = 0, offsetLow = (uint)offset, offsetHigh = (uint)(offset >> 32), hEvent = IntPtr.Zero, }; if (!LockFileEx(stream.SafeFileHandle, LOCKFILE_EXCLUSIVE_LOCK, 0, countLow, countHigh, ref overlapped)) { //TODO: throw an exception }} ",Using LockFileEX in C#
C# Web Browser component is IE7 not IE8? How to change this?," So I have an C# Form application that utilizes the web browser component. Apparently Response.Write(Request.Browser.Version.ToString()); returns ""7.0"" when I visit my test page from the web browser component.How can I make this web browser component use IE8? <code> ",Web Browser component is IE7 not IE8? How to change this?
Is it possible to clone a Value type?," Is it possible to clone an object, when it's known to be a boxed ValueType, without writing type specific clone code?Some code for reference The partical issue I have is with a value stack based virtual instruction machine. (And Im too lazy to write typeof(int) typeof(DateTime)....)update I think I confused myself (and a few other people). The working solution I have is; <code>  List<ValueType> values = new List<ValueType> {3, DateTime.Now, 23.4M};DuplicateLastItem(values); List<ValueType> values = new List<ValueType> { 3, DateTime.Now, 23.4M }; // Clonevalues.Add(values[values.Count() - 1]);// Overwrite originalvalues[2] = 'p';foreach (ValueType val in values) Console.WriteLine(val.ToString());",Is it possible to clone a ValueType?
Help parsing GML data using C# Linq to XML," I know this is most likly very basic and been asked a thousand times but for some reason I just can't get it to work.I have a gml file that looks like the following: All I need to be able to do is read the X and Y from each gml:coord node. I am using C# 3.0 and LINQ so it should be easy but everything I try just returns empty results.I have only done xml parsing in VB so the C# way is a bit foreign to me at the moment.Thanks,Nathan <code>  <?xml version='1.0' encoding='UTF-8'?><schemaxmlns='http://www.w3.org/2000/10/XMLSchema'xmlns:gml='http://www.opengis.net/gml'xmlns:xlink='http://www.w3.org/1999/xlink'xmlns:xsi='http://www.w3.org/2000/10/XMLSchema-instance'xsi:schemaLocation='http://www.opengis.net/gml/feature.xsd'><gml:Polygon srsName='http://www.opengis.net/gml/srs/epsg.xml#4283'> <gml:outerBoundaryIs> <gml:LinearRing> <gml:coord> <gml:X>152.035953</gml:X> <gml:Y>-28.2103190007845</gml:Y> </gml:coord> <gml:coord> <gml:X>152.035957</gml:X> <gml:Y>-28.2102020007845</gml:Y> </gml:coord> <gml:coord> <gml:X>152.034636</gml:X> <gml:Y>-28.2100120007845</gml:Y> </gml:coord> <gml:coord> <gml:X>152.034617</gml:X> <gml:Y>-28.2101390007845</gml:Y> </gml:coord> <gml:coord> <gml:X>152.035953</gml:X> <gml:Y>-28.2103190007845</gml:Y> </gml:coord> </gml:LinearRing> </gml:outerBoundaryIs></gml:Polygon></schema>",Parsing GML data using C# Linq to XML
"C# WCF Service, how to get the web site URL from within a class library?"," I have a WCF service running in IIS that calls a function in a class library where httpContext is available. How can I dynamically get the web site url, this may also be a virtual directory? <code> ","WCF Service, how to get the web site URL from within a class library?"
Opacity is not getting applied in WPF PopupControl., How to do it? <code>  Popup popUpControl = new Popup();popUpControl.PlacementTarget = this; popUpControl.StaysOpen = true;popUpControl.Child = new MyUserControl(); /// my user control popUpControl.Opacity = 0.5; // this code has no effect in the appearance of the popuppopUpControl.IsOpen = true;,Opacity is not getting applied to the WPF Popup control
When to use memory-mapped files ?," I have an application that receives chunks of data over the network, and writes these to disk.Once all chunks have been received, they can be decoded/recombined into the single file they actually represent.I'm wondering if it's useful to use memory-mapped files or not - first for writing the single chunks to disk, second for the single file into which all of them are decoded.My own feeling is that it might be useful for the second case only, anyone got some ideas on this?Edit:It's a C# app, and I'm only planning an x64 version.(So running into the 'largest contigious free space' problem shouldn't be relevant) <code> ",When to use memory-mapped files?
Why this performance diference? (Exception catching)," After reading a question here about what things our computer could do in one second I made a little test I had in mind for a while and I'm very surprised by the results. Look:Simple program to catch a null exception, takes almost one second to do 1900 iterations: Alternatively, checking if test == null before doing the assignation, the same pogram can do aprox 200000000 iterations in one second. Anyone has a detailed explanation on why this HUGE diference ?EDIT: Running the test in Release mode, outside Visual studio i'm getting 35000-40000 iterations vs 400000000 iterations (always aprox)Note I'm running this with a crappy PIV 3.06Ghz <code>  for(long c = 0; c < 200000000; c++){ try { test = null; test.x = 1; } catch (Exception ex) { }} for(long c = 0; c < 1900; c++){ test = null; f (!(test == null)) { test.x = 1; }}",Why this performance difference? (Exception catching)
C# Resized images have black borders.," I have a problem with image scaling in .NET. I use the standard Graphics type to resize images like in this example: But I have a big problem with resized images: they have gray and black borders and it's extremely important to make have images without them.Why do they appear and what I can to do make them disappear? Sample Output: <code>  public static Image Scale(Image sourceImage, int destWidth, int destHeight){ Bitmap toReturn = new Bitmap(sourceImage, destWidth, destHeight); toReturn.SetResolution(sourceImage.HorizontalResolution, sourceImage.VerticalResolution); using (Graphics graphics = Graphics.FromImage(toReturn)) { graphics.CompositingQuality = System.Drawing.Drawing2D.CompositingQuality.HighQuality; graphics.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.HighQuality; graphics.InterpolationMode = InterpolationMode.HighQualityBicubic; graphics.DrawImage(sourceImage, 0, 0, destWidth, destHeight); } return toReturn; }",C# Resized images have black borders
Is fxcop a valuable/effective tool for improving code quality?  ," I have a large high quality c# framework codebase that I nevertheless want to try to improve.Is fxcop an effective tool for improving .NET frameworks? I know Microsoft uses the tool internally, but how do external users find it? Worthwhile? I already have a zillion lines of code and a well established style, can it be adapted to our style and still provide good guidance?Roughly, how long will it take to set up? Hours, days, weeks? Will I learn something useful sooner that later? <code> ",Is fxcop a valuable/effective tool for improving code quality?
"TestInitialize gets fired for every test, in my Visual Studio unit tests?"," I'm using Visual Studio 2010 Beta 2. I've got a single [TestClass], which has a [TestInitialize], [TestCleanup] and a few [TestMethods].Every time a test method is run, the initialize and cleanup methods are ALSO run!I was under the impression that the [TestInitialize] & [TestCleanup] should only be run once, per local test run.Is that correct? If not, what is the proper way to do this? <code> ",Why does TestInitialize get fired for every test in my Visual Studio unit tests?
Why TestInitialize gets fired for every test in my Visual Studio unit tests?," I'm using Visual Studio 2010 Beta 2. I've got a single [TestClass], which has a [TestInitialize], [TestCleanup] and a few [TestMethods].Every time a test method is run, the initialize and cleanup methods are ALSO run!I was under the impression that the [TestInitialize] & [TestCleanup] should only be run once, per local test run.Is that correct? If not, what is the proper way to do this? <code> ",Why does TestInitialize get fired for every test in my Visual Studio unit tests?
There is a way of converting one Int32 into two Int16?," I think that this is not possible because Int32 has 1 bit sign and have 31 bit of numeric information and Int16 has 1 bit sign and 15 bit of numeric information and this leads to having 2 bit signs and 30 bits of information.If this is true then I cannot have one Int32 into two Int16. Is this true?Thanks in advance.EXTRA INFORMATION: Using Vb.Net but I think that I can translate without problems a C# answer.What initially I wanted to do was to convert one UInt32 to two UInt16 as this is for a library that interacts with WORD based machines. Then I realized that Uint is not CLS compliant and tried to do the same with Int32 and Int16.EVEN WORSE: Doing a = CType(c And &HFFFF, Int16); throws OverflowException. I expected that statement being the same as a = (Int16)(c & 0xffff); (which does not throw an exception). <code> ",Is there a nice way to split an int into two shorts (.NET)?
There is a way of splitting one Int32 into two Int16?," I think that this is not possible because Int32 has 1 bit sign and have 31 bit of numeric information and Int16 has 1 bit sign and 15 bit of numeric information and this leads to having 2 bit signs and 30 bits of information.If this is true then I cannot have one Int32 into two Int16. Is this true?Thanks in advance.EXTRA INFORMATION: Using Vb.Net but I think that I can translate without problems a C# answer.What initially I wanted to do was to convert one UInt32 to two UInt16 as this is for a library that interacts with WORD based machines. Then I realized that Uint is not CLS compliant and tried to do the same with Int32 and Int16.EVEN WORSE: Doing a = CType(c And &HFFFF, Int16); throws OverflowException. I expected that statement being the same as a = (Int16)(c & 0xffff); (which does not throw an exception). <code> ",Is there a nice way to split an int into two shorts (.NET)?
c#: why have empty get set properties instead of using a public member variable?," Possible Duplicate: C#: Public Fields versus Automatic Properties Duplicate? I think not: This question is not the same as ""Why use properties instead of public field"". A property with a specified getter and setter is far different than a public field. My question was, is a property WITHOUT a getter and setter, any different.With the somewhat recent ability to have empty getters and setters, what is the benefit of using them instead of just declaring a public member variable?Example: versus: <code>  public string MyProperty{ get; set;} public string MyProperty;",Why have empty get set properties instead of using a public member variable?
How to find extension of a file?," In my web application (asp.net,c#) I am uploading video file in a page but I want to upload only flv videos. How can I restrict when I upload other extension videos? <code> ",How to find the extension of a file in C#?
How to find the extension of a file?," In my web application (asp.net,c#) I am uploading video file in a page but I want to upload only flv videos. How can I restrict when I upload other extension videos? <code> ",How to find the extension of a file in C#?
hit testing in C#," I have a list of strings, I need to be able to simply probe if a new string is in the table or not. When the list is large, testing a simple list directly is pretty inefficient... so typically I use a Dictionary to get constant lookup speeds, although I don't actually care about the value. This seems like a misuse of a dictionary, so I'm wondering what other approaches I could take.Is there a better way to do hit testing that I am unaware of? <code> ",Unique set of strings in C#
How to show address bar in webbrowser control in a C# winform?, How to show address bar in WebBrowser control in a Windows Form? <code> ,How to show address bar in WebBrowser control
"What is the [,] thing means in c#?"," As in: And how do I search for it in the documentation? <code>  public string[,] GetHelp() { return new string[,] {...things...}}","What does [,] mean in c#?"
Why value-types are stored onto Stacks ?," Why does C# (.Net) prefer stack to store value types? What is the primary reason behind this design? Is it because read/write operations to the stack take better advantage of the machine processor?Also, maybe you can justify why not others? <code> ",Why value-types are stored onto Stacks?
Why value-types are stored onto Stacks in C# ?," Why does C# (.Net) prefer stack to store value types? What is the primary reason behind this design? Is it because read/write operations to the stack take better advantage of the machine processor?Also, maybe you can justify why not others? <code> ",Why value-types are stored onto Stacks?
what is a regular expression for parsing out individual sentences.," I am looking for a good .NET regular expression that I can use for parsing out individual sentences from a body of text.It should be able to parse the following block of text into exactly six sentences: This is proving a little more challenging than I originally thought.Any help would be greatly appreciated. I am going to use this to train the system on known bodies of text. <code>  Hello world! How are you? I am fine.This is a difficult sentence because I use I.D.Newlines should also be accepted. Numbers should not cause sentence breaks, like 1.23.",What is a regular expression for parsing out individual sentences?
C#.Net - In enum for C#," I would like to find a way to check to see if a set of values are contained in my variable. I am a transplant to .NET from Delphi. This is fairly easy code to write in Delphi, but I am not sure how to do it in C#. <code>  [Flags]public enum Combinations{ Type1CategoryA = 0x01, // 00000001 Type1CategoryB = 0x02, // 00000010 Type1CategoryC = 0x04, // 00000100 Type2CategoryA = 0x08, // 00001000 Type2CategoryB = 0x10, // 00010000 Type2CategoryC = 0x20, // 00100000 Type3 = 0x40 // 01000000}bool CheckForCategoryB(byte combinations){ // This is where I am making up syntax if (combinations in [Combinations.Type1CategoryB, Combinations.Type2CategoryB]) return true; return false; // End made up syntax}",Set In enum for C#
wrapper c# for kernel32.dll api," Any helper class anywhere which wrapps kernel32 APIs, with all functions-methods and structures? Or any wrapper generator?I want ALL methods of kernel32.dll in C# like this: <code>  [DllImport(""kernel32.dll"",EntryPoint=""RtlMoveMemory"")] public static extern void RtlMoveMemory(int des, int src, int count); [DllImport(""kernel32.dll"", EntryPoint = ""OpenProcess"")] public static extern IntPtr OpenProcess(uint dwDesiredAccess, bool bInheritHandle, uint dwProcessId); [DllImport(""kernel32"", CharSet = CharSet.Ansi)] public extern static int GetProcAddress(int hwnd, string procedureName); [DllImport(""kernel32.dll"", EntryPoint = ""GetModuleHandle"")] public static extern int GetModuleHandle(string lpModuleName); [DllImport(""kernel32.dll"", EntryPoint = ""VirtualAllocEx"")] public static extern IntPtr VirtualAllocEx(IntPtr hProcess, IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect); [DllImport(""kernel32"")] [return: MarshalAs(UnmanagedType.Bool)] public static extern bool CloseHandle(IntPtr hObject); [DllImport(""kernel32"", EntryPoint = ""CreateRemoteThread"")] public static extern IntPtr CreateRemoteThread(IntPtr hProcess, IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, uint lpThreadId); [DllImport(""kernel32.dll"", EntryPoint = ""WriteProcessMemory"")] public static extern IntPtr WriteProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, byte[] buffer, uint size, IntPtr lpNumberOfBytesWritten);",Wrapper C# for kernel32.dll API
string.Replace not working," For the following code, I can't get the string.Replace to work: when I debug and check parameters they have values I expect - i.e. someID.ToString() got ""1087163075"", and sessionID has ""108716308"" and someTestString contains ""1087163075"".I have no idea why this would not work change someTestStringComplete sample: the result (in someTestString) should be this: but it doesn't change. The string for someTestString remains unchanged after hitting my code. <code>  someTestString.Replace(someID.ToString(), sessionID); string someTestString = ""<a href='myfoldert/108716305-1.jpg' target='_blank'>108716305-1.jpg</a>""someTestString.Replace(""108716305"", ""NewId42""); ""<a href='myfoldert/NewId42-1.jpg' target='_blank'>NewId42-1.jpg</a>"" ",string.Replace (or other string modification) not working
.NET Framework on Andriod," Is anyone aware of any projects out there to port a version of the .NET framework to the Android platform, kind of like Mono.Touch? <code> ",.NET Framework on Android
Which is best for data store Strcut/Classes ??," We have seen lots of discussion in SO regarding the class vs struct in c#. Mostly ended with conclusions saying its a heap/stack memory allocation. And recommending to use structs in small data structures.Now I have a situation to decide the simple data store among these two choices. Currenlty in our application we have thousands of classes, just acts as simple data stores (only exposed public fields) and they passed among different modules and services.As per my understanding, I felt it's better to move ahead with struct instead classes for the performance reasons. Because these are simple data structures only act as data stores.Before proceeding with this, I need some expert advice from the people who have experienced this struggle.is my understanding correct?I have seen most ORMs have classes as data stores. So I doubt there should a reason to go ahead with classes instead structs. what would that be? <code> ",Which is best for data store Struct/Classes?
Which is best for data store Struct/Classes ??," We have seen lots of discussion in SO regarding the class vs struct in c#. Mostly ended with conclusions saying its a heap/stack memory allocation. And recommending to use structs in small data structures.Now I have a situation to decide the simple data store among these two choices. Currenlty in our application we have thousands of classes, just acts as simple data stores (only exposed public fields) and they passed among different modules and services.As per my understanding, I felt it's better to move ahead with struct instead classes for the performance reasons. Because these are simple data structures only act as data stores.Before proceeding with this, I need some expert advice from the people who have experienced this struggle.is my understanding correct?I have seen most ORMs have classes as data stores. So I doubt there should a reason to go ahead with classes instead structs. what would that be? <code> ",Which is best for data store Struct/Classes?
Why use private variables when we can use properties ?," Sorry If I am being noob, I have this doubt, why do we use private variables and set them using properties ? Why can't we just use properites alone ?I am talking about situations like this I am thinking of simply using Why redundant private variable? are these two strategies different ? can anyone please throw some light on this.Thanks <code>  private string _testVariable;public string MyProperty{ get { return _testVariable;} set {_testVariable = value;}} public string MyProperty { get; set; } ",Why should I use a private variable in a property accessor?
C#: Alternative to NetworkStream.Read that indicates remote host has closed the connection?," With regards to handling a TCP/IP connection using the TcpClient class, is there an alternative for checking whether the remote host has closed the connection other than waiting for the NetworkStream.Read method to return a 0? <code> ",Alternative to NetworkStream.Read that indicates remote host has closed the connection?
c# http web request keeps timing out," I am making a Http Webrequest to an available site that I can visit fine, but the HTTP Web request keeps timing out. Is there any reason why this code might allow it to timeout when it shouldn't?I've tried upping the timeout setting, but it still continues to timeout. <code>  Uri CameraUrl = new Uri(""http://"" + cfg_cameraIps[i]); HttpWebRequest myRequest = (HttpWebRequest)WebRequest.Create(CameraUrl); myRequest.Timeout = 5000; myRequest.Method = ""HEAD""; try { HttpWebResponse webresponse; webresponse = (HttpWebResponse)myRequest.GetResponse(); if (webresponse.StatusCode.ToString() == ""OK"") { continue; }",C# HTTP web request keeps timing out
How to set project wide #def in C#," I have several classes in a project which need to only be in certain builds of the application which are currently not ready for release or debug.To prevent these classes from being used, I want to set around them this: Unfortunately, I don't know how to setup a project-wide #define.Is there functionality in Visual Studio to set project-wide definitions?If there is, though I don't need it right now, is there a functionality to set solution-wide definitions?If there is no functionality for such (seeing as C# does not have include files, I suppose it's possible), is there any method or plugin of doing this functionality without using the command line compiler and /D? <code>  #if USE_MYCLASS// Code here...#endif",How to set project wide #define in C#
ObjectContext.AddObject adding all related objects as well as the object passed in...," I'm trying to add a ProfileProperty into the ProfileProperties table using ObjectContext.AddObject.The db fields for the ProfileProperties table are: The db fields for the ProfilePropertyDefinitions table are: The variables for the ProfileProperty object passed in are: The ProfilePropertyDefinitionID and UserID both are foreign keys, so after creating the ProfileProperty object I select the User and the ProfilePropertyDefinition from their tables to fill the ProfileProperty with the related objects. Then, when I try to AddObject, passing in an object with those variables I get an error: InnerException = {""Cannot insert the value NULL into column 'PropertyName', table 'mydbserver.dbo.ProfilePropertyDefinitions'; column does not allow nulls. INSERT fails.\r\nThe statement has been terminated.""}I did a break to check to see what the object I passed in was holding and it has this: QuestionsWhy is saying that the PropertyName is null when it's there? Why is it trying to add the ProfilePropertyDefinition object into the ProfilePropertyDefinitions table in the first place? (I don't want it to add or update related objects)Service Layer AddProfile() Repository Add(): <code>  ProfilePropertyIDProfilePropertyDefinitionIDUserIDPropertyValue ProfilePropertyDefinitionIDPropertyName ProfilePropertyIDProfilePropertyDefinitionUserPropertyValue ProfilePropertyID = -1ProfilePropertyDefinition = { ProfilePropertyDefinitionID = 3 PropertyName = ""First Name"" }User = /*Not going to put details here, but assume the user object is there*/PropertyValue = ""Matt"" public int AddProfile(ProfilePropertyViewModel property){ int objId = -1; ProfileProperty profile = null; if (ValidateProfile(property)) { try { using (DbTransaction transaction = _profileRepository.BeginTransaction()) { profile = ProfilePropertyTranslator.ViewToDomain(property); profile.User = _userRepository.SelectByKey(UserColumns.UserName, property.UserName); profile.ProfilePropertyDefinitionReference.EntityKey = new EntityKey(""GraffytysDBEntities.ProfilePropertyDefinition"", ""ProfilePropertyDefinitionID"", property.ProfilePropertyDefinitionID); _profileRepository.Add(profile); if (_profileRepository.Save() >= 0) { transaction.Commit(); objId = property.ProfilePropertyId; } } } catch(Exception ex) { throw ex; } } return objId; } public void Add(E entity) { _ctx.AddObject(entity.GetType().Name, entity); }",Having Entity Framework trouble
Help with excel automation addin, I am a newbie with add-in programming and need help with the following scenario:I have an C# Excel automation add-in that calls a few UDFs. I want to do a user name and password check during when the automation add-in loads for which a screen where the user can enter his details must pop up on load of the add-in. How can it be done using an automation add-in? How can event handling be done in general using automation addins ? I want some calculations to be done when the user presses F9 to calculate the UDF formula in some of the cells.Are there any articles that explains event handling in automation add-ins? <code> ,Automation add-in vs. COM add-in
"What does the keyword ""<<"" mean in c#?"," I was doing some basic audio programming in C# using the NAudio package and I came across the following expression and I have no idea what it means, as i've never seen the << operator being used before. So what does << mean?Please give a quick explaination of this expression. <code>  short sample = (short)((buffer[index + 1] << 8) | buffer[index + 0]);","What does the operator ""<<"" mean in C#?"
Storing a Method as a Member Variable of a Class in C#," I have this as one of my members of the class 'KeyEvent': And the constructor: What I want to do is instead of calling D() there, I want to store that method (D) as a member variable of KeyEvent, so something like: And then later in another method of KeyEvent, do something like: How can I do this? <code>  private delegate void eventmethod(); public KeyEvent(eventmethod D) { D();} stored_method = D(); stored_method();",Storing a method as a member variable of a class
Why are C# operator overloads static?, Why does C# require operator overloads to be static methods rather than member functions (like C++)? (Perhaps more specifically: what was the design motivation for this decision?) <code> ,Why must C# operator overloads be static?
why i get this error: Unsafe code may only appear if compiling with /unsafe," Why do I get the following error? Unsafe code may only appear if compiling with /unsafe""?I work in C# and Visual Studio 2008 for programming on WindowsCE. <code> ","Why do I get the error ""Unsafe code may only appear if compiling with /unsafe""?"
"Why do I get this error: ""Unsafe code may only appear if compiling with /unsafe""?"," Why do I get the following error? Unsafe code may only appear if compiling with /unsafe""?I work in C# and Visual Studio 2008 for programming on WindowsCE. <code> ","Why do I get the error ""Unsafe code may only appear if compiling with /unsafe""?"
How to Debug a Class Library in Visual Studio," I am working on a class library (DLL) project in Visual Studio 2008; programming in C#. In order to test my DLL I just created a second project that is a console application and in that project I can reference the first and run tests. Is there a simpler way of doing this? Can I just create another file within my class library project that has the tests in it and then somehow tell Visual Studio to run that file?I know one way would be to add a text file to my project and then write my test code in JScript. Then in the Project settings on the debug menu I can tell it to Start External Program (JScript). Then, the name of my test file, test.js, goes in the Command Line Arguments box. But, I am wondering if there is a way to do it using C# code instead of JScript? <code> ",How to debug a class library in Visual Studio
Can a C# expression ever return void?," I have the following method, and I want to know if there is anything that can go in place default(void) below because there is a compiler error that says that void is not valid here: I realize that I can use the if-else statement instead of the ternary operator (or that I could call a dummy method to return void). Also, the Select extension method does not like lambdas that return void. It seems to say that the type cannot be inferred, but of course if I specify the type like this, either: I was curious from a language design standpoint, why we don't have expressions that can return void or the data type for variables that is void. <code>  private void applyDefaultsIfNecessary(ApplicationConfiguration configuration){ var defaults = new Dictionary<Predicate<ApplicationConfiguration>, Action<ApplicationConfiguration>>() { // { rule, action } - if rule is true, execute action { (c) => c.ConnectionString == null , (c) => c.ConnectionString = ""foo"" }, { (c) => c.OutputExcelFilePath == null, (c) => c.ConnectionString = ""bar"" }, { (c) => c.OutputDirectory == null, (c) => c.OutputDirectory = ""baz"" } }; //Nothing to select, but we want to loop throough the dict and invoke action, if rule is true. //It is a pity there is no extension method called DoForEach on collections. defaults.Select((item) => item.Key.Invoke(configuration) ? item.Value.Invoke(configuration) : default(void) );} defaults.Select<ApplicationConfiguration, void>((item) => { if (item.Key.Invoke(configuration)) item.Value.Invoke(configuration); } );",Can a C# lambda expression ever return void?
Check for internet connection, What is the fastest and most efficient way to check for Internet connectivity in .NET? <code> ,What is the best way to check for Internet connectivity using .NET?
Check for Internet connectivity, What is the fastest and most efficient way to check for Internet connectivity in .NET? <code> ,What is the best way to check for Internet connectivity using .NET?
What is the best way to check for Internet connectivity using .Net?, What is the fastest and most efficient way to check for Internet connectivity in .NET? <code> ,What is the best way to check for Internet connectivity using .NET?
Programmatically getting the current visual studio ide solution directory from addins," I have some tools that perform updates on .NET solutions, but they need to know the directory where the solution is located.I added these tools as External Tools, where they appear in the IDE Tools menu, and supplying $(SolutionDir) as an argument. This works fine.However, I want these tools to be easier to access in the IDE for the user through a custom top level menu (for which I created a Visual Studio integration package project) and through a context menu on solution nodes (for which I created a Visual Studio add-in project). I'm looking for a way to get the current solution directory through these contexts.I tried getting the solution information from the VisualStudio.DTE object: But, this returns the solution directory for the add ins, not the current solution.I tried echoing $(SolutionDir) and reading it back: But, this returned the directory for the IDE, not the current solution.I didn't see any relevant information in the solution node CommandBar.Alternatively, if there was a way to programmatically access the defined Visual Studio external tools and launch them (using the already defined macro arguments), that would work.What is the solution? <code>  EnvDTE.DTE dte = (EnvDTE.DTE)System.Runtime.InteropServices.Marshal.GetActiveObject(""VisualStudio.DTE"");string solutionDir = System.IO.Path.GetDirectoryName(dte.Solution.FullName); System.Diagnostics.ProcessStartInfo procStartInfo = new System.Diagnostics.ProcessStartInfo(""cmd"", ""echo $(SolutionDir)"");// The following commands are needed to redirect the standard output.// This means that it will be redirected to the Process.StandardOutput StreamReader.procStartInfo.RedirectStandardOutput = true;procStartInfo.UseShellExecute = false;// Do not create the black window.procStartInfo.CreateNoWindow = true;// Now we create a process, assign its ProcessStartInfo and start itSystem.Diagnostics.Process proc = new System.Diagnostics.Process();proc.StartInfo = procStartInfo;proc.Start();// Get the output into a stringstring result = proc.StandardOutput.ReadToEnd();",Programmatically getting the current Visual Studio IDE solution directory from addins
Hey Guys I am a vb.net programmer Looking to convert to C# Any Ideas, I am looking to switch to C#. I come from a C / C++ background but C# is a little different for me. I am switching mainly because of Silverlight and MVVM; all examples are in C#. Any information is in C# and I am confused when I read through it all. What is a good place to start learning C# when starting with existing C / C++ knowledge? <code> ,Learning C# as a VB.NET programmer
C# Com Interop with Windows Media Player Visualisation," I am attempting to create a Windows Media Player (WMP) Visualization plugin in C#. I am quite new to exposing C# to COM and may have missed something basic. I have persisted with this for 3 days (about 20 hours) and not got past the single issue I will describe below.For those who don't know, WMP visualizations are the pretty images that show in media player while listening to music.In a nutshell: WMP will call certain methods on my C# COM interface, but not others.I have WMP 11 installedI downloaded the Latest Windows SDK which contains a C++ plugin wizard to compile a working visualization sample. This sample registers and works without issues in WMP.The dev kit contains a C++ header file named effects.h that contains 2 interfaces that must be implemented to get the plugin to work with WMP. It doesn't appear to much more complicated than that.Here they are As I mentioned, my COM knowledge my not be the best. This is what I did to port it to C#.I converted the interfaces to following The code for the class implementing the interfaces is as follows As you can see my code is pretty empty, nothing more than stubs really. My debugging is simple but does the job.Once this is compiled with a strong name it can be registered with:regasm assemblyname.dll /tlbthen dropped in the gac. Open regedit and add the the following info: Under HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MediaPlayer\Objects\Effects New Key: WmpTestPlugin Under the new key add a new string value: Name: classid Value: {C476FF24-5E5C-419d-9110-05EC2EED8511}So we have built a plugin that conforms to the interfaces, registered it in the GAC and told media player it's there.If you open media player and right-click on the visualization space a menu will appear. In that menu will be our new plugin. When you move your mouse down to the new item WMP will call GetPresetCount on the plugin (this will log to the file). Then WMP is supposed to call GetPresetTitle but it NEVER does for me.If you open tools\options from the menu bar and select the Plugins tab you can select the new plugin. If you click Properties WMP will call GetCapabilities then DisplayPropertyPage and a message box from the plugin will appear. WMP then crashes. In the C++ version FinalConstruct() is called on a CComCoClass interface - I don't have this and don't know what it is. I think it may be lower level than I am using??I have tried many many things to get this to work including changing the method declarations. Please can someone look at it and help. I've looked all over the web for a solution and found nothing.Thanks for reading, Nanook <code>  MIDL_INTERFACE(""D3984C13-C3CB-48e2-8BE5-5168340B4F35"")IWMPEffects : public IUnknown{public: virtual /* [helpstring][local] */ HRESULT STDMETHODCALLTYPE Render( /* [in] */ TimedLevel *pLevels, /* [in] */ HDC hdc, /* [in] */ RECT *prc) = 0; virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE MediaInfo( /* [in] */ LONG lChannelCount, /* [in] */ LONG lSampleRate, /* [in] */ BSTR bstrTitle) = 0; virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE GetCapabilities( /* [out] */ DWORD *pdwCapabilities) = 0; virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE GetTitle( /* [out] */ BSTR *bstrTitle) = 0; virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE GetPresetTitle( /* [in] */ LONG nPreset, /* [out] */ BSTR *bstrPresetTitle) = 0; virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE GetPresetCount( /* [out] */ LONG *pnPresetCount) = 0; virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE SetCurrentPreset( /* [in] */ LONG nPreset) = 0; virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE GetCurrentPreset( /* [out] */ LONG *pnPreset) = 0; virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE DisplayPropertyPage( /* [in] */ HWND hwndOwner) = 0; virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE GoFullscreen( /* [in] */ BOOL fFullScreen) = 0; virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE RenderFullScreen( /* [in] */ TimedLevel *pLevels) = 0;};MIDL_INTERFACE(""695386EC-AA3C-4618-A5E1-DD9A8B987632"")IWMPEffects2 : public IWMPEffects{public: virtual HRESULT STDMETHODCALLTYPE SetCore( /* [in] */ IWMPCore *pPlayer) = 0; virtual HRESULT STDMETHODCALLTYPE Create( /* [in] */ HWND hwndParent) = 0; virtual HRESULT STDMETHODCALLTYPE Destroy( void) = 0; virtual HRESULT STDMETHODCALLTYPE NotifyNewMedia( /* [in] */ IWMPMedia *pMedia) = 0; virtual HRESULT STDMETHODCALLTYPE OnWindowMessage( /* [in] */ UINT msg, /* [in] */ WPARAM WParam, /* [in] */ LPARAM LParam, /* [in] */ LRESULT *plResultParam) = 0; virtual HRESULT STDMETHODCALLTYPE RenderWindowed( /* [in] */ TimedLevel *pData, /* [in] */ BOOL fRequiredRender) = 0;}; using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Runtime.InteropServices;namespace WmpTestPlugin{ [ComVisible(true)] [InterfaceType(ComInterfaceType.InterfaceIsIUnknown)] [Guid(""D3984C13-C3CB-48e2-8BE5-5168340B4F35"")] public interface IWmpEffects { int Render(ref TimedLevel pLevels, IntPtr Hdc, ref RECT pRC); int MediaInfo(int lChannelCount, int lSampleRate, string bstrTitle); int GetCapabilities(ref int pdwCapabilities); int GetTitle(ref string bstrTitle); int GetPresetTitle([In] int nPreset, [MarshalAs(UnmanagedType.BStr)] ref string bstrPresetTitle); int GetPresetCount(ref int count); int SetCurrentPreset(int currentpreset); int GetCurrentPreset(ref int currentpreset); int DisplayPropertyPage(IntPtr hwndOwner); int GoFullScreen(bool fFullscreen); int RenderFullScreen(ref TimedLevel pLevels); } [ComVisible(true)] [InterfaceType(ComInterfaceType.InterfaceIsIUnknown)] [Guid(""695386EC-AA3C-4618-A5E1-DD9A8B987632"")] public interface IWmpEffects2 : IWmpEffects { int SetCore(IntPtr pPlayer); int Create(IntPtr hwndParent); int Destroy(); int NotifyNewMedia(IntPtr pMedia); int OnWindowMessage(int Msg, int WParam, int LParam, ref int plResultParam); int RenderWindowed(ref TimedLevel pData, bool fRequiredRender); } [ComVisible(true)] [StructLayout(LayoutKind.Sequential)] public struct Data { [MarshalAs(UnmanagedType.ByValArray, SizeConst = 0x400)] public byte[] Data0; [MarshalAs(UnmanagedType.ByValArray, SizeConst = 0x400)] public byte[] Data1; } [ComVisible(true)] public enum PlayerState { Stop_State, Pause_State, Play_State } [ComVisible(true)] [StructLayout(LayoutKind.Sequential)] public struct TimedLevel { public Data Frequency; public Data Waveform; public PlayerState State; public long TimeStamp; } [ComVisible(true)] [StructLayout(LayoutKind.Sequential)] public struct RECT { public int Left; public int Top; public int Right; public int Bottom; }} using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Runtime.InteropServices;using WmpTestPlugin;using System.IO;using System.Windows.Forms; [ComVisible(true)] [Guid(""C476FF24-5E5C-419d-9110-05EC2EED8511"")] //[ProgId(""WmpTestPlugin.WmpTest"")] [ClassInterface(ClassInterfaceType.None)] public class TestPlugin : IWmpEffects2 { [DllImport(""user32.dll"", EntryPoint = ""GetClientRect"")] private static extern bool getClientRect(IntPtr windowHandle, ref IntPtr rectangle); private const int EFFECT_CANGOFULLSCREEN = 1; private const int EFFECT_HASPROPERTYPAGE = 2; private const int S_OK = 0; private const int S_FALSE = 1; private const int E_ABORT = unchecked((int)0x80004004); private const int E_ACCESSDENIED = unchecked((int)0x80070005); private const int E_FAIL = unchecked((int)0x80004005); private const int E_HANDLE = unchecked((int)0x80070006); private const int E_INVALIDARG = unchecked((int)0x80070057); private const int E_NOINTERFACE = unchecked((int)0x80004002); private const int E_NOTIMPL = unchecked((int)0x80004001); private const int E_OUTOFMEMORY = unchecked((int)0x8007000E); private const int E_POINTER = unchecked((int)0x80004003); private const int E_UNEXPECTED = unchecked((int)0x8000FFFF); public TestPlugin() { _parentHwnd = IntPtr.Zero; _preset = 0; File.AppendAllText(""C:\\wmp.txt"", string.Format(""{0} : Construct{1}"", DateTime.Now.ToString(), Environment.NewLine)); } ~TestPlugin() { File.AppendAllText(""C:\\wmp.txt"", string.Format(""{0} : Deconstruct{1}"", DateTime.Now.ToString(), Environment.NewLine)); } #region IWmpEffects2 Members /// <summary> /// Set WMP core interface /// </summary> /// <param name=""pPlayer""></param> /// <returns></returns> public int SetCore(IntPtr pPlayer) { File.AppendAllText(""C:\\wmp.txt"", string.Format(""{0} : SetCore{1}"", DateTime.Now.ToString(), Environment.NewLine)); // release any existing WMP core interfaces //ReleaseCore(); if (pPlayer == IntPtr.Zero) return S_OK; _playerCore = pPlayer; //connect up any events return S_OK; } /// <summary> /// Invoked when the visualization should be initialized. /// /// If hwndParent != NULL, RenderWindowed() will be called and the visualization /// should draw into the window specified by hwndParent. This will be the /// behavior when the visualization is hosted in a window. /// /// If hwndParent == NULL, Render() will be called and the visualization /// should draw into the DC passed to Render(). This will be the behavior when /// the visualization is hosted windowless (like in a skin for example). /// </summary> /// <param name=""hwndParent""></param> /// <returns></returns> public int Create(IntPtr hwndParent) { File.AppendAllText(""C:\\wmp.txt"", string.Format(""{0} : Create{1}"", DateTime.Now.ToString(), Environment.NewLine)); _parentHwnd = hwndParent; return S_OK; } /// <summary> /// Invoked when the visualization should be released. /// Any resources allocated for rendering should be released. /// </summary> /// <returns></returns> public int Destroy() { File.AppendAllText(""C:\\wmp.txt"", string.Format(""{0} : Destroy{1}"", DateTime.Now.ToString(), Environment.NewLine)); _parentHwnd = IntPtr.Zero; return S_OK; } /// <summary> /// Invoked when a new media stream begins playing. /// The visualization can inspect this object for properties (like name or artist) /// that might be interesting for visualization. /// </summary> /// <param name=""pMedia""></param> /// <returns></returns> public int NotifyNewMedia(IntPtr pMedia) { File.AppendAllText(""C:\\wmp.txt"", string.Format(""{0} : NotifyNewMedia{1}"", DateTime.Now.ToString(), Environment.NewLine)); return S_OK; } /// <summary> /// Window messages sent to the parent window. /// </summary> /// <param name=""Msg""></param> /// <param name=""WParam""></param> /// <param name=""LParam""></param> /// <param name=""plResultParam""></param> /// <returns></returns> public int OnWindowMessage(int Msg, int WParam, int LParam, ref int plResultParam) { File.AppendAllText(""C:\\wmp.txt"", string.Format(""{0} : OnWindowMessage{1}"", DateTime.Now.ToString(), Environment.NewLine)); // return S_OK only if the plugin has handled the window message // return S_FALSE to let the defWindowProc handle the message //if (_parentHwnd == IntPtr.Zero) //m_NonWindowedRenderer.OnWindowMessage(&m_RenderContext, msg, WParam, LParam, plResultParam); //else // m_WindowedRenderer.OnWindowMessage(&m_RenderContext, msg, WParam, LParam, plResultParam); return S_FALSE; } /// <summary> /// Called when an effect should render itself to the screen. /// The fRequiredRender flag specifies if an update is required, otherwise the /// update is optional. This allows visualizations that are fairly static (for example, /// album art visualizations) to only render when the parent window requires it, /// instead of n times a second for dynamic visualizations. /// </summary> /// <param name=""pData""></param> /// <param name=""fRequiredRender""></param> /// <returns></returns> public int RenderWindowed(ref TimedLevel pData, bool fRequiredRender) { File.AppendAllText(""C:\\wmp.txt"", string.Format(""{0} : RenderWindowed{1}"", DateTime.Now.ToString(), Environment.NewLine)); //windowed // NULL parent window should not happen if (_parentHwnd == IntPtr.Zero) return E_UNEXPECTED; //RECT rect = new RECT(); //TestPlugin.getClientRect(_parentHwnd, ref rect); //do render// return S_OK; } #endregion #region IWmpEffects Members /// <summary> /// Called when an effect should render itself to the screen. /// </summary> /// <param name=""pLevels""></param> /// <param name=""Hdc""></param> /// <param name=""pRC""></param> /// <returns></returns> public int Render(ref TimedLevel pLevels, IntPtr Hdc, ref RECT pRC) { File.AppendAllText(""C:\\wmp.txt"", string.Format(""{0} : Render{1}"", DateTime.Now.ToString(), Environment.NewLine)); //not windowed //do render return S_OK; } /// <summary> /// Everytime new media is loaded, this method is called to pass the /// number of channels (mono/stereo), the sample rate of the media, and the /// title of the media /// </summary> /// <param name=""lChannelCount""></param> /// <param name=""lSampleRate""></param> /// <param name=""bstrTitle""></param> /// <returns></returns> public int MediaInfo(int lChannelCount, int lSampleRate, string bstrTitle) { File.AppendAllText(""C:\\wmp.txt"", string.Format(""{0} : MediaInfo{1}"", DateTime.Now.ToString(), Environment.NewLine)); return S_OK; } /// <summary> /// Returns the capabilities of this effect. Flags that can be returned are: /// EFFECT_CANGOFULLSCREEN -- effect supports full-screen rendering /// EFFECT_HASPROPERTYPAGE -- effect supports a property page /// </summary> /// <param name=""pdwCapabilities""></param> /// <returns></returns> public int GetCapabilities(ref int pdwCapabilities) { File.AppendAllText(""C:\\wmp.txt"", string.Format(""{0} : GetCapabilities{1}"", DateTime.Now.ToString(), Environment.NewLine)); //no capabilities pdwCapabilities = EFFECT_HASPROPERTYPAGE; return S_OK; } /// <summary> /// Invoked when a host wants to obtain the title of the effect /// </summary> /// <param name=""bstrTitle""></param> /// <returns></returns> public int GetTitle(ref string bstrTitle) { File.AppendAllText(""C:\\wmp.txt"", string.Format(""{0} : GetTitle{1}"", DateTime.Now.ToString(), Environment.NewLine)); bstrTitle = ""Test Wmp C# Plugin""; return S_OK; } /// <summary> /// Invoked when a host wants to obtain the title of the given preset /// </summary> /// <param name=""nPreset""></param> /// <param name=""bstrPresetTitle""></param> /// <returns></returns> public int GetPresetTitle(int nPreset, ref string bstrPresetTitle) { File.AppendAllText(""C:\\wmp.txt"", string.Format(""{0} : GetPresetTitle{1}"", DateTime.Now.ToString(), Environment.NewLine)); //bstrPresetTitle = ""Default""; return S_OK; } /// <summary> /// Invoked when a host wants to obtain the number of supported presets /// </summary> /// <param name=""count""></param> /// <returns></returns> public int GetPresetCount(ref int count) { File.AppendAllText(""C:\\wmp.txt"", string.Format(""{0} : GetPresetCount{1}"", DateTime.Now.ToString(), Environment.NewLine)); count = 1; return S_OK; } /// <summary> /// Invoked when a host wants to obtain the index of the current preset /// </summary> /// <param name=""currentpreset""></param> /// <returns></returns> public int SetCurrentPreset(int currentpreset) { File.AppendAllText(""C:\\wmp.txt"", string.Format(""{0} : SetCurrentPreset{1}"", DateTime.Now.ToString(), Environment.NewLine)); _preset = currentpreset; return S_OK; } /// <summary> /// Invoked when a host wants to obtain the index of the current preset /// </summary> /// <param name=""currentpreset""></param> /// <returns></returns> public int GetCurrentPreset(ref int currentpreset) { File.AppendAllText(""C:\\wmp.txt"", string.Format(""{0} : GetCurrentPreset{1}"", DateTime.Now.ToString(), Environment.NewLine)); currentpreset = _preset; return S_OK; } /// <summary> /// Invoked when a host wants to display the property page for the effect /// </summary> /// <param name=""hwndOwner""></param> /// <returns></returns> public int DisplayPropertyPage(IntPtr hwndOwner) { File.AppendAllText(""C:\\wmp.txt"", string.Format(""{0} : DisplayPropertyPage, Owner={1}{2}"", DateTime.Now.ToString(), hwndOwner.ToString(), Environment.NewLine)); MessageBox.Show(""Hello Me!""); return S_OK; } public int GoFullScreen(bool fFullscreen) { File.AppendAllText(""C:\\wmp.txt"", string.Format(""{0} : GoFullScreen{1}"", DateTime.Now.ToString(), Environment.NewLine)); return S_OK; } public int RenderFullScreen(ref TimedLevel pLevels) { File.AppendAllText(""C:\\wmp.txt"", string.Format(""{0} : RenderFullScreen{1}"", DateTime.Now.ToString(), Environment.NewLine)); return S_OK; } #endregion private IntPtr _parentHwnd; private int _preset; private IntPtr _playerCore; }",C# Com Interop with Windows Media Player Visualisation (With Sample Code)
Encryption compatable between Android and C#," I've found plenty of examples how to do encryption in C#, and a couple for Android, but I'm particularly looking for a way to handle encrypting (using something like AES, TripleDES, etc.) from Android, and eventually wind up being decrypted in C#. I found an example for encoding AES in Android and encoding/decoding AES in C# but am not sure if these are compatible (C# requires an IV, nothing is specified for this in the Android example). Also, a recommendation on a good way of encoding the encrypted string for transmission over HTTP (Base64?) would be helpful. Thanks. <code> ",Encryption compatible between Android and C#
DDD - How to implement performant repositories for searching.," I have a question regarding DDD and the repository pattern. Say I have a Customer repository for the Customer aggregate root. The Get & Find methods return the fully populated aggregate, which includes objects like Address, etc. All good. But when the user is searching for a customer in the UI, I just require a 'summary' of the aggregate - just a flat object with summarised information. One way I could deal with this is to call the find method on the repository as normal, and then in the application layer, map each customer aggregate to a CustomerSearchResult / CustomerInfo DTO, and send them back to the client. But my problem with this is performance; each Customer aggregate may require multiple queries to populate all of the associations. So if my search criteria matched 50 customers, that's quite a hit on the DB for potentially retrieving data I'm not even going to need.The other issue is that I may wish to include summarised data about the customer that is outside of the Customer's aggregate root boundary, such as the date of the last order made for example. Order has it's own aggregate and therefore to get the customer's order information I would have to call the OrderRepository, also degrading performance.So now I think I'm left with two options:Add an additional Find method to the CustomerRepository which returns a list of these summary objects by doing one efficient query.Create a purpose built readonly CustomerInfoRepository, that just has the find method described in 1.But both of these feel like I'm going against the principles of DDD. My repositories inherit from a generic base: Repository where T : IAggregateRoot. These summary info object are not an aggregates, and are of a different type to T, so really #1 goes against the design. Perhaps for #2 I would create an abstract SearchRepository without the IAggregateRoot constraint?There are many similar scenarios in my domain. How would you implement this scenario? Thanks, DaveUpdateAfter reading Theo's answer, I think I will go with option #2 and create a specialised SearchRepository within my infrastructure geared towards these scenarios. The application layer (WCF services) can then call these repositories that just populate the summary DTOs directly rather than mapping domain entities to DTOs.**** Update 2 ****Although I asked this over a year ago I thought I'd just add that I've since discovered CQRS which is aimed at solving this exact problem. Udi Dahan (http://www.udidahan.com/) and Greg Young (http://codebetter.com/gregyoung/) have written a lot about it. If you are creating a distributed application with DDD, CQRS is for you! <code> ",DDD - How to implement high-performing repositories for searching
"calculating differenvr between time ,and then compare difference is less than 5 MIN", I want to calculate the difference between two times and then compare difference is less than 5 MIN..Please note I want difference in min. using c#.net <code> ,"Calculating the difference between 2 times, and then compare the difference to see if it is less than 5 minutes."
Tools for Building an OCA," I will be building an in-house, Occasionally Connected App (OCA). What technologies would you suggest I employ.Here are my parameters:.NET Shop(3.5sp1)C# for code behind (winform,wpf,silverlight)SQL Server Backend (2005 or possibly 2008 pending approval)Solo DeveloperSolo SQL AdministratorLow Tech end usersLow bandwidth to 5 Branch officesThis is a LOB app but not a POS. Majority of users have laptops that they take to Member's HomeThe Data for this App is stored in 5 separate Databases, though in one SQL instance.I am looking for specific recommendations on which path to choose. Merge Replication or Sync Framework database synchronization providers? SQL Express or SQL CE at the Subscriber? Can I use LINQ to SQL for the DAL?Is a Silverlight 'Offline/Out of Browser App' Example Here, feasible?This is my first LARGE business application so any experienced comments are welcome.As requested here is some additional info on the type of Data. My users are Nurses and Social Workers who go to Member's homes and create ""Plans"" or ""Health Assessment Reviews"" for them. These are things like a Medication List or a List of there current ""Providers"". Steps to achieve members' goals or a list of there current/past Diagnosis's. Things like that.Also the typical Members Name, Address, Phone Number, etc. Mostly this is a Data Storage and Retrieval app that facilitates reporting. Very little ""processing"" takes place and Nurses and Social Workers work in teams that are assigned members so I usually have very little crossover or potential data conflicts. Nurses and SW's also are responsible for different area's of the MCP(Member Centered Plan)Additional question; Is Sync Framework really only a viable option if I can use SQL 2008? Seems that way due to the Change Tracking etc....thoughts? <code> ",Tools for Building an OCA (Occasionally Connected Application)
Code explanation needed. C#," I know what this code is doing but I'm not sure on the syntax. It doesn't seem to conform to a ""standard"" format. Is it mostly LINQ? The first part makes sense but it's the part in the brackets I don't understand. How can we use s without declaring it? And how are we putting logic into a method call? <code>  return db.Subjects.SingleOrDefault(s => s.ID == ID);",How does this LINQ Expression work?
Clever Uses of C# Iterators," C# 2 and VB.Net 8 introduced a new feature called iterators, which were designed to make it easier to return enumerables and enumerators.However, iterators are actually a limited form of coroutines, and can be used to do many useful things that have nothing to do with collections of objects.What non-standard uses of iterators have you seen in real code? <code> ",Clever Uses of .Net 2 Iterators
List<T>::AddRange implementation suboptimal," Profiling my C# application indicated that significant time is spent in List<T>.AddRange. Using Reflector to look at the code in this method indicated that it calls List<T>.InsertRange which is implemented as such: One can argue that the simplicity of the interface (only having one overload of InsertRange) justifies the performance overhead of runtime type cheching and casting.But what could be the reason behind the 3 lines I have indicated with (*) ?I think it could be rewritten to the faster alternative: Do you see any reason for not using this simpler and apparently faster alternative?Edit:Thanks for the answers. So consensus opinion is that this is a protective measure against the input collection implementing the CopyTo in a defective/malicious manner. To me it seems like a overkill to constantly pay the price of 1) runtime type checking 2) dynamic allocation of the temporary array 3) double the copy operation, when all this could have been saved by defining 2 or a few more overloads of InsertRange, one getting IEnumerable as now, the second getting a List<T>, third getting T[]. The later two could have been implemented to run around twice as fast as in the current case.Edit 2:I did implement a class FastList, identical to List, except that it also provides an overload of AddRange which takes a T[] argument. This overload does not need the dynamic type verification, and double-copying of elements. I did profile this FastList.AddRange against List.AddRange by adding 4-byte arrays 1000 times to a list which was initially emtpy. My implementation beats the speed of standard List.AddRange with a factor of 9 (nine!). List.AddRange takes about 5% of runtime in one of the important usage scenarios of our application, replacing List with a class providing a faster AddRange could improve application runtime by 4%. <code>  public void InsertRange(int index, IEnumerable<T> collection){ if (collection == null) { ThrowHelper.ThrowArgumentNullException(ExceptionArgument.collection); } if (index > this._size) { ThrowHelper.ThrowArgumentOutOfRangeException(ExceptionArgument.index, ExceptionResource.ArgumentOutOfRange_Index); } ICollection<T> is2 = collection as ICollection<T>; if (is2 != null) { int count = is2.Count; if (count > 0) { this.EnsureCapacity(this._size + count); if (index < this._size) { Array.Copy(this._items, index, this._items, index + count, this._size - index); } if (this == is2) { Array.Copy(this._items, 0, this._items, index, index); Array.Copy(this._items, (int) (index + count), this._items, (int) (index * 2), (int) (this._size - index)); } else { T[] array = new T[count]; // (*) is2.CopyTo(array, 0); // (*) array.CopyTo(this._items, index); // (*) } this._size += count; } } else { using (IEnumerator<T> enumerator = collection.GetEnumerator()) { while (enumerator.MoveNext()) { this.Insert(index++, enumerator.Current); } } } this._version++;}private T[] _items; is2.CopyTo(this._items, index);",List<T>.AddRange implementation suboptimal
What does Using(.....){...) mean," Possible Duplicates: Using the using statment in c# What is the C# Using block and why should I use it? Just wondering what this means? I've seen lots of tutorials online that have the syntax: Why is it used? I tried searching Google, but it comes up with the 'using' keyword which is used for including dll's and other files. <code>  using (SqlCeCommand cmd2 = new SqlCeCommand(""SELECT city FROM cities JOIN states ON states.id=cities.state WHERE states.state='"" + read.GetString(0) + ""'"", con)){ SqlCeDataReader readCities = cmd2.ExecuteReader(); while (readCities.Read()) { parent.Nodes.Add(readCities.GetString(0)); }}",What does Using(.....){...} mean
Using UTF characters in C# controls," I want to add the Greek letter omega (U+03A9) to a label I've placed on the form. I've already switched the encoding of the form, but how do I set the content of the label such that an omega appears and not UTF char code.So taking this XAML I want the U+03A9 to be converted to an omegain the code behind I believe I can do something like But I'm wondering if I can do this strickly in the XAML <code>  <Label Height=""25"">U+03A9</Label> targetEncoding = Encoding.getEncoding(utfEncoding);lblOmega.Content = targetEncoding.getBytes(""\u03A9"");",Using Unicode characters in C# controls
Visual Stuidio Go to Definition (F12) opens Object Browser instead of Code View," I'm running VS2005, and when I right click on an object and select Go to Definition it brings me to the object browser instead of the actual code.Is there some settings that I can change to fix this? Note: it works properly for C# solutions, I am having the problem with Basic. <code> ",Visual Studio Go to Definition (F12) opens Object Browser instead of Code View
C# auto highlight text in a textbox control, How do you auto highlight text in a textbox control when the control gains focus. <code> ,Auto highlight text in a textbox control
is order of fields is important in anonymous types automatic initialization?," I got a scenario to create the anonymous list from the anonymous types, and i achieved that using these are the error messages System.Collections.Generic.List.Add(AnonymousType#1)' has some invalid arguments Argument '1': cannot convert from 'AnonymousType#2' to 'AnonymousType#1'whats the reason behind that??  <code>  public static List<T> MakeList<T>(T itemOftype) { List<T> newList = new List<T>(); return newList; } static void Main(string[] args) { //anonymos type var xx = new { offsetname = x.offName, RO = y.RO1 }; //anonymos list var customlist = MakeList(xx); //It throws an error because i have given the wrong order customlist.Add(new { RO = y.RO2, offsetname = x.offName }); customlist.Add(new { RO = y.RO3, offsetname = x.offName }); //but this works customlist.Add(new { offsetname = x.offName, RO = y.RO2 }); customlist.Add(new { offsetname = x.offName, RO = y.RO3 }); }",is order of field important in anonymous types automatic initialization?
Why doesn't this throw a NullReferenceException?," I would expect the compiler to attempt to cast x as an int, but apparently it does not.Edit by 280Z28: Changed NullReferenceException to InvalidOperationException, which is what Nullable<T>.Value throws when HasValue is false. <code>  int? x = null;x = x + 1; // Works, but x remains null",Why doesn't attempting to add to a null value throw an InvalidOperationException?
Why doesn't this throw an InvalidOperationException?," I would expect the compiler to attempt to cast x as an int, but apparently it does not.Edit by 280Z28: Changed NullReferenceException to InvalidOperationException, which is what Nullable<T>.Value throws when HasValue is false. <code>  int? x = null;x = x + 1; // Works, but x remains null",Why doesn't attempting to add to a null value throw an InvalidOperationException?
How to execute a executable recourse whithin C#, Is it possible to execute an exe file that is included in the project as a resource? Can I fetch the file as a byte array and execute it in memory?I don't want to write the file to a temporary location and execute it there. I'm searching for a solution where I can execute it in memory. (It's not a .NET assembly.) <code> ,How to execute an executable embedded as resource
How to execute a executable resourse whithin C#, Is it possible to execute an exe file that is included in the project as a resource? Can I fetch the file as a byte array and execute it in memory?I don't want to write the file to a temporary location and execute it there. I'm searching for a solution where I can execute it in memory. (It's not a .NET assembly.) <code> ,How to execute an executable embedded as resource
How to determine if PropertyInfo.Type is a struct?," Given a PropertyInfo instance, which has a Type property, how does one determine if it is a struct? I found there are properties such as IsPrimitive, IsInterface, etc. but I'm not sure how to ask for a struct?EDIT:To clarify question.Suppose I have a method: What do I write instead of IsStruct? <code>  public Boolean Check(PropertyInfo pi){ return pi.Type.IsStruct;}",How to determine if Type is a struct?
What is a good code structure for api-independant vertex processing?," Currently working on a 3D media engine using C# and I have come across a little conundrum. I have my rending loop figured out, I got a great plug-in architecture and content management system and even a material pipeline all planned out. Then engine is planned to use DirectX and OpenGL (via 'renderer' plug-ins), along with both APIs' programmable pipe-line. Anyways, at the beginning of this week I started on working on the engines abstract layer for processing vertices (I have been dreading this for weeks now). And as some of you know, vertex handling between graphic APIs' is not at all related or the same. Well kinda related ;), but not the same. In OpenGL handling vertices is very straight-forward, you create the custom vertex structure, send it to the GPU and then let your shaders handle the rest. This is perfect for a flexible graphics pipe-line, OpenGL is not required to know what elements are contained with each vertex. DirectX on the other-hand requires us to create declarations for each vertex structure and then send them to the GPU.The issue is that I will not know what type of vertex structure is being passed and I would definitely like to avoid creating the abstraction layer that involves declaring each element of a vertex through enumerations and some abstract 'VertexDeclaration' class; this would cause some issues:1) Getting vertex elements will be a pain to say the least. I could use some 'VertexSemantic' and ask for the positions of vertex 'a - z', but when processing a lot of vertices for something like skeletal animation, it can have a lot of overhead.2) Not very user-friendly considering the engines' main focus is 'newbies'. I would like for users to be able to create custom vertices and mesh buffers, without having to declare a ton of objects, consuming valuable development time. 3) more? Now I could do something with attributes and then create declarations for vertex structures inside the DirectX renderer. For instance, go ahead and create some enums: Now I can create an attribute that users can apply to the 'fields' of each element in their vertex structure: An example of what a custom vertex structure could look like: This would be nice. In the DirectX plug-in (renderer) I could just create a utility class that can create the semantics for each structure type and then cache the data so the declarations don't have to be recreated for each vertex. I could even add a NONE enumeration value to ELementUsage so that custom values may be used for what ever means... but then again they would only work in OpenGL because DirectX requires you to mark each vertex... unless there is something I am missing.My question(s):Is there a better way to go about this (besides using the attirbutes)? Is there a way to avoid using VertexDeclarations in DirectX?Is there any thing you may not understand about 'my' question?EDIT:An issue with using attributes would be getting element data from each vertex. Say I wanted to get the positions of each vertex in a mesh buffer. Since I went with attributes, I can't just do 'vertex.Position', I would have to create a utility method that could extract a field reference from a vertex structure, like 'Utility.GetElement(vertex, ElementUsage.POSITION)' . This method would need to use reflection to first find the attribute, then return the reference to the field value. Setting the value would not even (i think) be possible?Another way would be to create an IElement interface and implement each element (Positon, Normal, etc). The interface could have Name property that I can return directly inside the inherited element structure, like the PositionElements' Name property would just return ""Positon"". Next I could hold the array of IElement indside a Vertex struct that contains methods like AddElement(IElement), GetElement(string name), GetElement(int index), Insert, Replace, etc. I would implement all elements known to DirectX so that the renderer plug-in could parse a vertex structure to create an array of vertex declarations. The issue with this is that I am not sure if an array '[]' can be used as vertex element data. Like, what other bytes does an array contain (if any) that would hinder me from passing the Vertex struct (contains the IElement array) directly to DirectX, then to the GPU?Implementing it this way would be absolutely perfect for what I need it for. Another question is could the inheriting types of IElement (the elements) be a class, or do element values have to be value-types? <code>  // for getting the format layout of the elementpublic enum ElementFormat{ Float, Float2, Float3, Byte, etc, etc}// for determining the 'usage' // (here is 'another' where DirectX limits vertex structures ><)public enum ElementUsage{ Position, Normal, Color, TextureCoord, etc, etc} public class VertexElementAttribute : Attribute { #region Properties /// <summary> /// Gets the total size (in bytes) of the element. /// </summary> public int Size { get; set; } /// <summary> /// Gets the number of values contained with-in the element. /// </summary> public int Count { get; set; } /// <summary> /// Gets the type semantic of the element. /// </summary> public ElementType Type { get; set; } /// <summary> /// Gets the usage semantic of the element. /// </summary> public ElementUsage Usage { get; set; } #endregion #region Init /// <summary> /// Creates a new vertex element attribute. /// </summary> /// <param name=""count"">The number of values contained within the element.</param> /// <param name=""size"">The total size (in bytes) of the element.</param> /// <param name=""type"">The type semantic of the element.</param> /// <param name=""usage"">The usage semantic of the element.</param> public VertexElementAttribute(int count, int size, ElementType type, ElementUsage usage) { Count = count; Size = size; Type = type; Usage = usage; } #endregion } public struct VertexPositionColor{ [VertexElement(3, sizeof(Vector3), ElementType.FLOAT3, ElementUsage.POSITION)] public Vector3 Xyz; [VertexElement(4, sizeof(Color), ElementType.FLOAT4, ElementUsage.COLOR)] public Color Rgba; ... etc}",What is a good code structure for api-independent vertex processing?
"Regular expression for accepting alphnumeric characters(6-10 chars) .NET, C#"," I am building a user registration form using C# with .NET.I have a requirement to validate user entered password fields.Validation requirement is as below.It should be alphanumeric (a-z , A-Z , 0-9)It should accept 6-10 characters (minimum 6 characters, maximum 10 characters)With at least 1 alphabet and number (example: stack1over)I am using a regular expression as below. It satisfies my first 2 conditions.It fails when I enter only characters or numbers. <code>  ^([a-zA-Z0-9]{6,10})$","Regular expression for accepting alphanumeric characters (6-10 chars) .NET, C#"
"Regular expression for accepting alphnumeric characters (6-10 chars) .NET, C#"," I am building a user registration form using C# with .NET.I have a requirement to validate user entered password fields.Validation requirement is as below.It should be alphanumeric (a-z , A-Z , 0-9)It should accept 6-10 characters (minimum 6 characters, maximum 10 characters)With at least 1 alphabet and number (example: stack1over)I am using a regular expression as below. It satisfies my first 2 conditions.It fails when I enter only characters or numbers. <code>  ^([a-zA-Z0-9]{6,10})$","Regular expression for accepting alphanumeric characters (6-10 chars) .NET, C#"
How to programmaticaly resize picture in C#?, Possible Duplicate: Resize an Image C# How can I programmatically resize an image in C# so that it'll fit in a winforms control? <code> ,Resizing image programmatically in C#
How to get return value when BeginInvoke is called in C# ," I've this little method which is supposed to be thread safe. Everything works till i want it to have return value instead of void. How do i get the return value when BeginInvoke is called? Edit: I guess having BeginInvoke is not nessecary in this case as i need value from GUI before the thread can continue. So using Invoke is good as well. Just no clue how to use it in following example to return value. But not sure how to get value using that code either ;) <code>  public static string readControlText(Control varControl) { if (varControl.InvokeRequired) { varControl.BeginInvoke(new MethodInvoker(() => readControlText(varControl))); } else { string varText = varControl.Text; return varText; } } private delegate string ControlTextRead(Control varControl); public static string readControlText(Control varControl) { if (varControl.InvokeRequired) { varControl.Invoke(new ControlTextRead(readControlText), new object[] {varControl}); } else { string varText = varControl.Text; return varText; } }",How to get return value when BeginInvoke/Invoke is called in C#
How to get return value when BeginInvoke/Invoke is called in C# ," I've this little method which is supposed to be thread safe. Everything works till i want it to have return value instead of void. How do i get the return value when BeginInvoke is called? Edit: I guess having BeginInvoke is not nessecary in this case as i need value from GUI before the thread can continue. So using Invoke is good as well. Just no clue how to use it in following example to return value. But not sure how to get value using that code either ;) <code>  public static string readControlText(Control varControl) { if (varControl.InvokeRequired) { varControl.BeginInvoke(new MethodInvoker(() => readControlText(varControl))); } else { string varText = varControl.Text; return varText; } } private delegate string ControlTextRead(Control varControl); public static string readControlText(Control varControl) { if (varControl.InvokeRequired) { varControl.Invoke(new ControlTextRead(readControlText), new object[] {varControl}); } else { string varText = varControl.Text; return varText; } }",How to get return value when BeginInvoke/Invoke is called in C#
C# Windows Forms RichTextBox cursor position," I have a C# Windows Forms program that has a RichTextBox control. Whenever the text inside the box is changed (other than typing that change), the cursor goes back to the beginning.In other words, when the text in the RichTextBox is changed by using the Text property, it makes the cursor jump back.How can I keep the cursor in the same position or move it along with the edited text?Thanks <code> ",Windows Forms RichTextBox cursor position
Cascade Saves with Fluent NHibernate AutoMapping - Old Anwser Still Valid?," I want to do exactly what this question asks:Cascade Saves with Fluent NHibernate AutoMappingUsing Fluent Nhibernate Mappings to turn on ""cascade"" globally once for all classes and relation types using one call rather than setting it for each mapping individually. The answer to the earlier question looks great, but I'm afraid that the Fluent Nhibernate API altered its .WithConvention syntax last year and broke the answer... either that or I'm missing something. I keep getting a bunch of name space not found errors relating to the IOneToOnePart, IManyToOnePart and all their variations: ""The type or namespace name 'IOneToOnePart' could not be found (are you missing a using directive or an assembly reference?)""I've tried the official example dll's, the RTM dll's and the latest build and none of them seem to make VS 2008 see the required namespace.The second problem is that I want to use the class with my AutoPersistenceModelbut I'm not sure where to this line: .ConventionDiscovery.AddFromAssemblyOf() in my factory creation method. Below is the class and using statements I'm trying  <code>  private static ISessionFactory CreateSessionFactory() { return Fluently.Configure() .Database(SQLiteConfiguration.Standard.UsingFile(DbFile)) .Mappings(m => m.AutoMappings .Add(AutoMap.AssemblyOf<Shelf>(type => type.Namespace.EndsWith(""Entities"")) .Override<Shelf>(map => { map.HasManyToMany(x => x.Products).Cascade.All(); }) ) )//emd mappings .ExposeConfiguration(BuildSchema) .BuildSessionFactory();//finalizes the whole thing to send back. } using System; using System.Collections.Generic; using System.Linq; using System.Text; using System.IO; using FluentNHibernate.Conventions; using FluentNHibernate.Cfg; using FluentNHibernate.Cfg.Db; using NHibernate; using NHibernate.Cfg; using NHibernate.Tool.hbm2ddl; using FluentNHibernate.Mapping; namespace TestCode { public class CascadeAll : IHasOneConvention, IHasManyConvention, IReferenceConvention { public bool Accept(IOneToOnePart target) { return true; } public void Apply(IOneToOnePart target) { target.Cascade.All(); } public bool Accept(IOneToManyPart target) { return true; } public void Apply(IOneToManyPart target) { target.Cascade.All(); } public bool Accept(IManyToOnePart target) { return true; } public void Apply(IManyToOnePart target) { target.Cascade.All(); } } }",Cascade Saves with Fluent NHibernate AutoMapping - Old Answer Still Valid?
Determine Assembly Version during a Post Build Event?," Let's say I wanted to create a static text file which ships with each release. I want the file to be updated with the version number of the release (as specified in AssemblyInfo.cs), but I don't want to have to do this manually.I was hoping I could use a post-build event and feed the version number to a batch file like this: However I can't find any suitable variable or macro to use. Is there a way to achieve this that I've missed? <code>  call foo.bat $(AssemblyVersion)",Determine assembly version during a post-build event
C#: Self-Destruction/Erasing Itself," How can I make my C# app erase itself (self-destruct)? Here's two ways that I think might work:Supply another program that deletes the main program. How is this deleter program deleted then, though?Create a process to CMD that waits a few seconds then deletes your file. During those few seconds, you close your application.Both of those methods seem inefficient. I have a feeling that there's some built-in flag or something in Windows that allows for such stuff. How should I do it? Also, can you provide some sample code? UPDATE: Thanks for all your answers! I'm going to try them, and see where that gets me.First of all, some people have asked why I'd want my app to do this. Here's the answer: a few days ago, I read the Project Aardvark spec that Joel Spolsky posted on his blog, and it mentioned that the client app would delete itself after the remote session. I'm wondering how this works, and how, if I ever need to do this, I can accomplish such a feat. Here's a little overview of what's been suggested:Create a registry entry that tells Windows to delete the file on rebootLaunch CMD with a ping command to wait a few seconds and then delete the fileBoth of those, of course, have their disadvantages, as outlined in the comments.However, would such a method as outlined below work?There are two executables: Program.exe and Cleaner.exe. The former is the program itself, the latter is the app that deletes Program.exe and itself (if it's loaded into memory, as I'm about to explain). Is it possible for Program.exe (which has dependencies) to load all of Cleaner.exe, which doesn't have any dependencies, into memory and run it?If this is possible, could Cleaner.exe be packaged inside Program.exe, loaded into memory, and run? <code> ",How can I make my .NET application erase itself?
How can I make my C# application erase itself?," How can I make my C# app erase itself (self-destruct)? Here's two ways that I think might work:Supply another program that deletes the main program. How is this deleter program deleted then, though?Create a process to CMD that waits a few seconds then deletes your file. During those few seconds, you close your application.Both of those methods seem inefficient. I have a feeling that there's some built-in flag or something in Windows that allows for such stuff. How should I do it? Also, can you provide some sample code? UPDATE: Thanks for all your answers! I'm going to try them, and see where that gets me.First of all, some people have asked why I'd want my app to do this. Here's the answer: a few days ago, I read the Project Aardvark spec that Joel Spolsky posted on his blog, and it mentioned that the client app would delete itself after the remote session. I'm wondering how this works, and how, if I ever need to do this, I can accomplish such a feat. Here's a little overview of what's been suggested:Create a registry entry that tells Windows to delete the file on rebootLaunch CMD with a ping command to wait a few seconds and then delete the fileBoth of those, of course, have their disadvantages, as outlined in the comments.However, would such a method as outlined below work?There are two executables: Program.exe and Cleaner.exe. The former is the program itself, the latter is the app that deletes Program.exe and itself (if it's loaded into memory, as I'm about to explain). Is it possible for Program.exe (which has dependencies) to load all of Cleaner.exe, which doesn't have any dependencies, into memory and run it?If this is possible, could Cleaner.exe be packaged inside Program.exe, loaded into memory, and run? <code> ",How can I make my .NET application erase itself?
"Why does C# decimal.ToString(string) round away from zero, apparently inconsistent with the language spec?"," I see that, in C#, rounding a decimal, by default, uses MidpointRounding.ToEven. This is expected, and is what the C# spec dictates. However, given the following:A decimal dValA format string sFmt that, when passed in to dVal.ToString(sFmt), will result in a string containing a rounded version of dVal...it is apparent that decimal.ToString(string) returns a value rounded using MidpointRounding.AwayFromZero. This would appear to be a direct contradiction of the C# spec.My question is this: is there a good reason this is the case? Or is this just an inconsistency in the language?Below, for reference, I've included some code that writes to console an assortment of rounding operation results and decimal.ToString(string) operation results, each on every value in an array of decimal values. The actual outputs are embedded. After that, I've included a relevant paragraph from the C# Language Specification section on the decimal type.The example code: The paragraph from section 4.1.7 of the C# Language Specification (""The decimal type"") (get the full spec here (.doc)):The result of an operation on values of type decimal is that which would result from calculating an exact result (preserving scale, as defined for each operator) and then rounding to fit the representation. Results are rounded to the nearest representable value, and, when a result is equally close to two representable values, to the value that has an even number in the least significant digit position (this is known as bankers rounding). A zero result always has a sign of 0 and a scale of 0.It's easy to see that they may not have been considering ToString(string) in this paragraph, but I'm inclined to think it fits in this description. <code>  static void Main(string[] args){ decimal[] dArr = new decimal[] { 12.345m, 12.355m }; OutputBaseValues(dArr); // Base values: // d[0] = 12.345 // d[1] = 12.355 OutputRoundedValues(dArr); // Rounding with default MidpointRounding: // Math.Round(12.345, 2) => 12.34 // Math.Round(12.355, 2) => 12.36 // decimal.Round(12.345, 2) => 12.34 // decimal.Round(12.355, 2) => 12.36 OutputRoundedValues(dArr, MidpointRounding.ToEven); // Rounding with mr = MidpointRounding.ToEven: // Math.Round(12.345, 2, mr) => 12.34 // Math.Round(12.355, 2, mr) => 12.36 // decimal.Round(12.345, 2, mr) => 12.34 // decimal.Round(12.355, 2, mr) => 12.36 OutputRoundedValues(dArr, MidpointRounding.AwayFromZero); // Rounding with mr = MidpointRounding.AwayFromZero: // Math.Round(12.345, 2, mr) => 12.35 // Math.Round(12.355, 2, mr) => 12.36 // decimal.Round(12.345, 2, mr) => 12.35 // decimal.Round(12.355, 2, mr) => 12.36 OutputToStringFormatted(dArr, ""N2""); // decimal.ToString(""N2""): // 12.345.ToString(""N2"") => 12.35 // 12.355.ToString(""N2"") => 12.36 OutputToStringFormatted(dArr, ""F2""); // decimal.ToString(""F2""): // 12.345.ToString(""F2"") => 12.35 // 12.355.ToString(""F2"") => 12.36 OutputToStringFormatted(dArr, ""###.##""); // decimal.ToString(""###.##""): // 12.345.ToString(""###.##"") => 12.35 // 12.355.ToString(""###.##"") => 12.36 Console.ReadKey();}private static void OutputBaseValues(decimal[] dArr){ Console.WriteLine(""Base values:""); for (int i = 0; i < dArr.Length; i++) Console.WriteLine(""d[{0}] = {1}"", i, dArr[i]); Console.WriteLine();}private static void OutputRoundedValues(decimal[] dArr){ Console.WriteLine(""Rounding with default MidpointRounding:""); foreach (decimal d in dArr) Console.WriteLine(""Math.Round({0}, 2) => {1}"", d, Math.Round(d, 2)); foreach (decimal d in dArr) Console.WriteLine(""decimal.Round({0}, 2) => {1}"", d, decimal.Round(d, 2)); Console.WriteLine();}private static void OutputRoundedValues(decimal[] dArr, MidpointRounding mr){ Console.WriteLine(""Rounding with mr = MidpointRounding.{0}:"", mr); foreach (decimal d in dArr) Console.WriteLine(""Math.Round({0}, 2, mr) => {1}"", d, Math.Round(d, 2, mr)); foreach (decimal d in dArr) Console.WriteLine(""decimal.Round({0}, 2, mr) => {1}"", d, decimal.Round(d, 2, mr)); Console.WriteLine();}private static void OutputToStringFormatted(decimal[] dArr, string format){ Console.WriteLine(""decimal.ToString(\""{0}\""):"", format); foreach (decimal d in dArr) Console.WriteLine(""{0}.ToString(\""{1}\"") => {2}"", d, format, d.ToString(format)); Console.WriteLine();}","Why does .NET decimal.ToString(string) round away from zero, apparently inconsistent with the language spec?"
Why C# allows methods/Members to be public when the class is internal, I have a class which I marked as internal and I marked fields and methods as public. It compiled without errors or warnings. Is there any specific need to have methods as public and class as internal (except when they are being implemented from interfaces or classes)? <code> ,Why C# allows methods/members to be public when the class is internal
Create Zip file from stream and download it," I have a DataTable that i want to convert it to xml and then zip it, using DotNetZip. finally user can download it via Asp.Net webpage.My code in below the xml file in zip file is empty. <code>  dt.TableName = ""Declaration""; MemoryStream stream = new MemoryStream(); dt.WriteXml(stream); ZipFile zipFile = new ZipFile(); zipFile.AddEntry(""Report.xml"", """", stream); Response.ClearContent(); Response.ClearHeaders(); Response.AppendHeader(""content-disposition"", ""attachment; filename=Report.zip""); zipFile.Save(Response.OutputStream); //Response.Write(zipstream); zipFile.Dispose();",Creating Zip file from stream and downloading it
FTP upload using C#," I am writing a code to upload a zip file to an ftp server. Surprisingly the code works fine for small files, but with bigger files I end up in problem. I am using Stream object and I have noted that my code is getting stuck while trying to close the Stream (only for big files). The code runs fine if I do not close the Stream (even for big files). Does anyone see any logic in why this is happening. And if I don't close the stream is it possible that I might end up in problem in future.Code extract: The code stops responding (when the upload file is big) at: There is no exception as this part is within try-catch.I don't know how to get a stack trace. <code>  FtpWebRequest reqFTP = (FtpWebRequest)FtpWebRequest.Create(new Uri(@""ftp://"" + ftpServerIP + @""/"" + fileInf.Name));Stream strm = reqFTP.GetRequestStream(); strm.Close();",FTP upload using .NET
FTP upload using .NET," I am writing a code to upload a zip file to an ftp server. Surprisingly the code works fine for small files, but with bigger files I end up in problem. I am using Stream object and I have noted that my code is getting stuck while trying to close the Stream (only for big files). The code runs fine if I do not close the Stream (even for big files). Does anyone see any logic in why this is happening. And if I don't close the stream is it possible that I might end up in problem in future.Code extract: The code stops responding (when the upload file is big) at: There is no exception as this part is within try-catch.I don't know how to get a stack trace. <code>  FtpWebRequest reqFTP = (FtpWebRequest)FtpWebRequest.Create(new Uri(@""ftp://"" + ftpServerIP + @""/"" + fileInf.Name));Stream strm = reqFTP.GetRequestStream(); strm.Close();",FTP upload using .NET
FTP upload using C#.NET," I am writing a code to upload a zip file to an ftp server. Surprisingly the code works fine for small files, but with bigger files I end up in problem. I am using Stream object and I have noted that my code is getting stuck while trying to close the Stream (only for big files). The code runs fine if I do not close the Stream (even for big files). Does anyone see any logic in why this is happening. And if I don't close the stream is it possible that I might end up in problem in future.Code extract: The code stops responding (when the upload file is big) at: There is no exception as this part is within try-catch.I don't know how to get a stack trace. <code>  FtpWebRequest reqFTP = (FtpWebRequest)FtpWebRequest.Create(new Uri(@""ftp://"" + ftpServerIP + @""/"" + fileInf.Name));Stream strm = reqFTP.GetRequestStream(); strm.Close();",FTP upload using .NET
C# what does strongly typed mean," I've got a bunch of Warnings in a Visual Studio 2005 project, most of them are warning me that a resource name is not a valid identifier.example: MSDN online help indicates that the resource name needs to be strongly typed, and not contain spaces. What does strongly typed exactly mean? <code>  The resource name 'MB_ArchiveRestore.cs_11' is not a valid identifier.","How to resolve this ""Resource name is not a valid identifier"" compiler warning."
"UAC, Vista and C# - Programatically requesting elevation", I have a program that only requires elevation to Admin on very rare occasions so I do not want to set-up my manifest to require permanent elevation.How can I Programmatically request elevation only when I need it?I am using C# <code> ,Windows 7 and Vista UAC - Programmatically requesting elevation in C#
Windows 7 and Vista UAC - Programatically requesting elevation in C#, I have a program that only requires elevation to Admin on very rare occasions so I do not want to set-up my manifest to require permanent elevation.How can I Programmatically request elevation only when I need it?I am using C# <code> ,Windows 7 and Vista UAC - Programmatically requesting elevation in C#
Any considerations before jumping into SQLLite?," I have a WCF application that at present is using XML based file storage to store data that gets used to generate reports. Besides this processing decisions are made based on information stored in these XML files. I'm now hitting volumes of around 30 000 text files. This is incredibly taxing, and the application at times comes to a grinding halt. I've always wanted to swop out the XML DAL in favor of an RDBMS, but project managers simply won't allow it. But they would be willing to look at a serverless solution for example SQLLite. I am really tempted to just dive right in and start using it as a replacement DAL (Data Access Layer). I would need no more than around 20 tables in the whole solution, and I would expect to get no more than around 20 000 - 100 000 transactions a day, however this is extreme, the real volumes would be less than this in most cases. Update I am not expecting a great deal of simultaneous connections, when I say transactions, I essentially mean 1 or 2 clients that make calls and execute against the database in order. At times there might be a possibility of external clients making quick calls to the DB. But the bulk of DB connections will be done by my WCF service, which is a back end scheduled task, not serving 100's of people across an organization. Another good point is that I only need to retain data for 90 days, so the DB shouldn't grow too big. My main concerns are:How reliable is SQLLite? What if the DB File gets corrupted, will I loose all processing Data. How easy is the DB to back up? Will it handle my volumes? And lastly how well does the .net provider work (located here: http://sourceforge.net/projects/sqlite-dotnet2/). If you have any experience with SQLLite, please post your experiences so I can make aan informed decision to switch or not. Thanks in advance... <code> ",Any considerations before jumping into SQLite?
AppDomain Unload killing Parent AppDomain...," I am having trouble figuring something out about my AppDomain.Unload(...) call. I have a detailed explanation with code from my earlier question. As it turns out, I was performing a couple of steps that apparently, I don't need to. However, I am fairly certain that when an AppDomain is created and then held in a collection: ...when you are done with it, you must unload it: then remove domain from the collection. When I unload the domain, however, the entire application is ending. If I remove the unload, all is well...and we are simply left with removing the domain from the collection. But I fear that my child AppDomain is not really unloaded. It may eventually get GC'd I guess, but that doesn't give me a warm fuzzy. The child AppDomain assembly (a Windows Form application) is started asynchronously via an interface (IModule) that is referenced in my adapter class which inherits MarshalByRefObject. I am wondering if this reference to IModule's Start() (which the plugin module assembly implements) is not marshaling properly (because of my implementation). So, when the Shutdown() method is called, the entire application dies. Should I make my IModule an abstract class instead so it should inherit MBR as well? Puzzled...After looking at my code: ...my fear is that since IModule is an interface, even though I am creating an instance in a child domain, the assembly is leaking into my main AppDomain. Therefore, when I attempt to unload the child domain, both domains are being unloaded. Would this be correct? And what would likely be the best solution to provide Start() & Stop() methods via the MBR (adapter) object? UPDATE: see my answer below for changes --Okay, there is no leaking -- everything inherits MBR:Host : MarshalByRefObject -- instances the ModuleAdapter in a new AppDomainModuleAdapter : MarshalByRefObject -- IModule interface, interface methods (Start,Stop)MyModulePlugin : MarshalByRefObject -- Application.Run(myForm)Am I doing something wrong still? I've tried several things and it just seems to be wrong or incomplete. When I tell the ModuleAdapter to shutdown, it calls AppDomain.Unload(AppDomain.CurrentDomain) and the Host domain stops as well. I am still getting some first chance exceptions on the application exit. But the form (myForm) has been told to .Close().So, I am still looking for the correct way of doing this... <code>  private static Dictionary<string , AppDomain> HostDomains;void StartNewDomain(string domainName){ AppDomain domain = AppDomain.CreateDomain(domainName); HostDomains[domainName] = domain;} if (HostDomains.ContainsKey(domainName)){ AppDomain.Unload(HostDomains[domainName]); HostDomains.Remove(domainName);} // instances the module for access to the module's Start() method IModule module = (IModule)domain.CreateInstanceAndUnwrap( ModuleManager.Modules[modName].Name, ModuleManager.Modules[modName].EntryPoint.FullName);",AppDomain Unload killing Parent AppDomain
ASP.NET Error The conversion of a nvarchar data type to a smalldatetime data type resulted in an out-of-range value.," Hey all I'm trying to do the following insert query Buti keep getting the following error: The conversion of a nvarchar data type to a smalldatetime data type resulted in an out-of-range value. The statement has been terminated.Can anyone help me out? <code>  SqlDataSource userQuizDataSource = new SqlDataSource();userQuizDataSource.ConnectionString = ""Data Source=localhost\\SQLEXPRESS;Initial Catalog=quizApp;Integrated Security=True"";userQuizDataSource.InsertCommand = ""INSERT INTO [UserQuiz] ([DateTimeComplete], [Score], [UserName]) VALUES (@DateTimeComplete, @Score, @UserName)"";userQuizDataSource.InsertParameters.Add(""DateTimeComplete"", DateTime.Now.ToString());userQuizDataSource.InsertParameters.Add(""Score"", score.ToString());userQuizDataSource.InsertParameters.Add(""UserName"", User.Identity.Name);int rowsAffected = userQuizDataSource.Insert();",Error: The conversion of a nvarchar data type to a smalldatetime data type resulted in an out-of-range value
Add new column and data to datatable that already contains data - c#," How do I add a new DataColumn to a DataTable object that already contains data?PseudoCode <code>  //call SQL helper class to get initial data DataTable dt = sql.ExecuteDataTable(""sp_MyProc"");dt.Columns.Add(""NewColumn"", type(System.Int32));foreach(DataRow row in dr.Rows){ //need to set value to NewColumn column}",How can I add a new column and data to a datatable that already contains data?
How Can I override ToString() method in C#?," I want to override the Tostring() method for changing some characters. Is it possible? If yes, How can I do this? <code> ",How can I override the ToString() method in C#?
Extract a zip file programmatically by DotNetZip library?," I have a function that get a ZIP file and extract it to a directory(I use DotNetZip library.) My ZIP file contains multiple files and directories. But I want to extract only some of these files, not all of them.How can I make this work? <code>  public void ExtractFileToDirectory(string zipFileName, string outputDirectory){ ZipFile zip = ZipFile.Read(zipFileName); Directory.CreateDirectory(outputDirectory); zip.ExtractAll(outputDirectory,ExtractExistingFileAction.OverwriteSilently);}",Extract a ZIP file programmatically by DotNetZip library?
C# how to get (text?) value from PasswordBox?, I have a PasswordBox. how can I get the input value from the PasswordBox after the input has been finished? <code> ,C# how to get text value from PasswordBox?
Can a calculation of floating point differ on different processors?," I have an application written in C# that invokes some C code as well. The C# code gets some double as an input, performs some calculations on it, pass it to the native layer that perform its own calculations on it, and then passes back to the C# layer. If i run the same exe/dlls on different machines (all of them are x64 by Intel), is it possible that the final result i'll get will be different on different machines? <code> ",Can a calculation of floating point differ on different processors? (+passing doubles between C# and C)
Looking for some good references to help migrate a VS Add-In to a VSPackage, Following is how you would get the current solution directory from an add-in: How would you do this via a VSPackage?I'm migrating a visual studio add-in to a VSPackage as I'm intending to add some user controls that require a deeper integration with the IDE.I found some good references on the relative merits of add-ins vs integration packages such as:http://nayyeri.net/visual-studio-addin-vs-integration-package-part-1And some good tutorials on msdn on VSPackages such as:http://msdn.microsoft.com/en-us/library/cc138589.aspxI haven't found a good reference yet (on msdn or otherwise) on how the higher level interfaces in add-ins (such as DTE) map to lower level interfaces in VSPackages.Any good references out there to help with general mapping from add-in interfaces to VSPackage interfaces? <code>  _applicationObject = (DTE2)application; // retrieved from OnConnection methodstring solutionDir = System.IO.Path.GetDirectoryName(_applicationObject.Solution.FullName);,How do you get the current solution directory from a VSPackage?
How does a .NET exe work?," What happens exactly when I launch a .NET exe? I know that C# is compiled to IL code and I think the generated exe file just a launcher that starts the runtime and passes the IL code to it. But how? And how complex process is it?IL code is embedded in the exe. I think it can be executed from the memory without writing it to the disk while ordinary exe's are not (ok, yes but it is very complicated).My final aim is extracting the IL code and write my own encrypted launcher to prevent scriptkiddies to open my code in Reflector and just steal all my classes easily. Well I can't prevent reverse engineering completely. If they are able to inspect the memory and catch the moment when I'm passing the pure IL to the runtime then it won't matter if it is a .net exe or not, is it? I know there are several obfuscator tools but I don't want to mess up the IL code itself.EDIT: so it seems it isn't worth trying what I wanted. They will crack it anyway... So I will look for an obfuscation tool. And yes my friends said too that it is enough to rename all symbols to a meaningless name. And reverse engineering won't be so easy after all. <code> ",How do i prevent my code from being stolen?
C#: Break out of multiple loops at once?," What if I have nested loops, and I want to break out of all of them at once? In PHP, break takes an argument for the number of loops to break out of. Can something like this be done in C#?What about something hideous, like goto? <code>  while (true) { // ... while (shouldCont) { // ... while (shouldGo) { // ... if (timeToStop) { break; // Break out of everything? } } }} // In the innermost loopgoto BREAK// ...BREAK: break; break; break;",How to break out of multiple loops at once in C#?
How to Break out of multiple loops at once in C#?," What if I have nested loops, and I want to break out of all of them at once? In PHP, break takes an argument for the number of loops to break out of. Can something like this be done in C#?What about something hideous, like goto? <code>  while (true) { // ... while (shouldCont) { // ... while (shouldGo) { // ... if (timeToStop) { break; // Break out of everything? } } }} // In the innermost loopgoto BREAK// ...BREAK: break; break; break;",How to break out of multiple loops at once in C#?
How to generate a WSDL file from a C# webservice.," I've created a WebService like this: Is it possible to generate a WSDL file for this code without connecting to a running service? I searched and I found information about SvcUtil.exe & wsdl.exe, but these work only when retrieving the WSDL from a running WebService.(For java, there is a tool called java2wsdl, is there a equivalent for c# ?):Update:The context for this question is that I want to add new CustomWebService to SharePoint which should deployed using WSPBuilder in the _vti_bin folder on SharePoint.See also my post on SharePoint.SE.And I want to automatically generate (using msbuild commands) the 'MyServicewsdl.aspx' & 'MyServicedisco.wsdl' which must be placed in the _vti_bin folder.Maybe I'm missing some things?Output from svcutil.exe is: <code>  [WebService(Namespace = ""http://ns"")][WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]public class GroupManagerService : WebService{ public GroupManagerService() { } [WebMethod] public bool MyMethod(string loginname, string country) { // code here... }} bin\Debug>SvcUtil.exe MyWebService.dllMicrosoft (R) Service Model Metadata Tool[Microsoft (R) Windows (R) Communication Foundation, Version 3.0.4506.2152]Copyright (c) Microsoft Corporation. All rights reserved.Generating metadata files...Warning: No metadata files were generated. No service contracts were exported. To export a service, use the /serviceName option. To export data contracts, specify the /dataContractOnly option. This can sometimes occur in certain securitycontexts, such as when the assembly is loaded over a UNC network file share. Ifthis is the case, try copying the assembly into a trusted environment and running it.",How to generate a WSDL file from a C# webservice
How to mute Windows with C# / WPF?," I am learning C# and WPF and had an idea for a little utility. I want a big red button that will do only one thing: completely mute/un-mute all Windows sounds (system beeps, WMP, DVD player, etc...) I've explored the object browser in VS 2008 but can't seem to find what I need: A mute that will affect all of Windows.Is it System.Windows.Input.MediaCommands.MuteVolume and I'm just not getting how to use it?Thanks for any pointers in the right direction using C# and/or WPF. :) <code> ",How to mute Windows with WPF?
How do i define a preprocessor sybols in C# visual studios, Sorry if my terminology is wrong. I wrote #if TEST_APP in my code. Now i would like to define TEST_APP. How do i set it using visual studios 2010? This is a windows form application.Bonus if you can tell me the name of the symbol that is set in a winform project and in a web project <code> ,How do i define a preprocessor symbols in C# visual studios
Winforms DateTime Picker disable selected dates," I was wondering is it possible to disable selected dates in a DateTimePicker, so that user cannot select them. i know its possible in web forms but in windows forms im unable to do this.how can i achieve this. <code> ",How do I disable some dates on a DateTimePicker control?
Property grid item and DoubleClick.," I'm using PropertyGrid control for editing some objects in my application. I'm using custom TypeConverters and TypeEditors for better user interface.I have problem with custom TypeConverter for boolean properties. If I have this class: and I create instance and set it as SelectedObject in PropertyGrid - all is fine until the user DoubleClicked on property grid item form ""Flag"" property. After DoubleClick is raised this message:(source: tcks.wz.cz) The TypeConverter class looks: This behaviour is very confusing for users. How can I prevent it?Thanks <code>  public class MyClass { public string Name { get; set; } [System.ComponentModel.TypeConverter( typeof( BoolTypeConverter ) )] public bool Flag { get; set; }} public class BoolTypeConverter : System.ComponentModel.TypeConverter { public const string TEXT_TRUE = ""On""; public const string TEXT_FALSE = ""Off""; public const string TEXT_NONE = ""< none >""; public override object CreateInstance( System.ComponentModel.ITypeDescriptorContext context, System.Collections.IDictionary propertyValues ) { object ret = base.CreateInstance( context, propertyValues ); return ret; } public override bool GetCreateInstanceSupported( System.ComponentModel.ITypeDescriptorContext context ) { bool ret = base.GetCreateInstanceSupported( context ); return ret; } public override bool IsValid( System.ComponentModel.ITypeDescriptorContext context, object value ) { bool ret; if ( value is string ) { string tmpValue = value.ToString().Trim(); if ( string.Compare( tmpValue, TEXT_NONE, StringComparison.InvariantCultureIgnoreCase ) == 0 ) { ret = true; } else if ( string.Compare( tmpValue, TEXT_TRUE, StringComparison.InvariantCultureIgnoreCase ) == 0 ) { ret = true; } else if ( string.Compare( tmpValue, TEXT_FALSE, StringComparison.InvariantCultureIgnoreCase ) == 0 ) { ret = true; } else { bool blValue; ret = bool.TryParse( tmpValue, out blValue ); } } else { ret = base.IsValid( context, value ); } return ret; } public override bool CanConvertFrom( System.ComponentModel.ITypeDescriptorContext context, Type sourceType ) { bool ret = false; if ( sourceType == typeof( string ) ) { ret = true; } else { ret = base.CanConvertFrom( context, sourceType ); } return ret; } public override object ConvertFrom( System.ComponentModel.ITypeDescriptorContext context, System.Globalization.CultureInfo culture, object value ) { object ret = null; bool converted = false; if ( value is string ) { string tmpValue = value.ToString().Trim(); if ( string.Compare( tmpValue, TEXT_NONE, StringComparison.InvariantCultureIgnoreCase ) == 0 || string.IsNullOrEmpty( tmpValue ) ) { ret = null; converted = true; } else if ( string.Compare( tmpValue, TEXT_TRUE, StringComparison.InvariantCultureIgnoreCase ) == 0 ) { ret = true; converted = true; } else if ( string.Compare( tmpValue, TEXT_FALSE, StringComparison.InvariantCultureIgnoreCase ) == 0 ) { ret = false; converted = true; } else { bool blValue; if ( converted = bool.TryParse( tmpValue, out blValue ) ) { ret = blValue; } } } if ( false == converted ) { ret = base.ConvertFrom( context, culture, value ); } return ret; } public override bool CanConvertTo( System.ComponentModel.ITypeDescriptorContext context, Type destinationType ) { bool ret = false; if ( destinationType == typeof( bool ) ) { ret = true; } else { ret = base.CanConvertTo( context, destinationType ); } return ret; } public override object ConvertTo( System.ComponentModel.ITypeDescriptorContext context, System.Globalization.CultureInfo culture, object value, Type destinationType ) { object ret = null; bool converted = false; if ( destinationType == typeof( string ) ) { if ( null == value ) { ret = TEXT_NONE; converted = true; } else if ( value is bool? || value is bool ) { if ( (bool)value ) { ret = TEXT_TRUE; } else { ret = TEXT_FALSE; } converted = true; } else if ( value is string ) { ret = value; converted = true; } } if ( false == converted ) { ret = base.ConvertTo( context, culture, value, destinationType ); } return ret; } public override StandardValuesCollection GetStandardValues( System.ComponentModel.ITypeDescriptorContext context ) { StandardValuesCollection ret; Type tpProperty = context.PropertyDescriptor.PropertyType; if ( tpProperty == typeof( bool ) ) { ret = new StandardValuesCollection( new string[]{ TEXT_TRUE, TEXT_FALSE } ); } else if ( tpProperty == typeof( bool? ) ) { ret = new StandardValuesCollection( new string[]{ TEXT_TRUE, TEXT_FALSE, TEXT_NONE } ); } else { ret = new StandardValuesCollection( new string[0] ); } return ret; } public override bool GetStandardValuesSupported( System.ComponentModel.ITypeDescriptorContext context ) { bool ret; Type tpProperty = context.PropertyDescriptor.PropertyType; if ( tpProperty == typeof( bool ) || tpProperty == typeof( bool? ) ) { ret = true; } else { ret = false; } return ret; }}",Property grid item and DoubleClick
How to trigger event every shor interval.," I have an application that needs to check a website feed every second.Sometimes the request to the server is longer than a second. In this case, the application needs to wait until the first request completes, then start a new request immediately. How could I implement this?Also, the request should not freeze the GUI. <code> ",Triggering an event every second
C# - Difference between ISerialize attribute & inherits from ISerialize class, What's the difference between using the Serializable attribute and implementing the ISerializable interface?  <code> ,What's the difference between using the Serializable attribute & implementing ISerializable?
What's the difference between using the Serializable attribute & inheriting from an ISerializable class, What's the difference between using the Serializable attribute and implementing the ISerializable interface?  <code> ,What's the difference between using the Serializable attribute & implementing ISerializable?
why is main static?, Why is the main method entry point in most C# programs static? <code> ,Why is the main method entry point in most C# programs static?
ASP.NET applications scalability best pratices guide, Is there are a guide published by microsoft or somebody else about the best practices for creating scalable web applications? like patterns to use and how to do data access. <code> ,ASP.NET applications scalability best practices guide
Register a C#/VB.NET COM dll programatically," Question: I have a .NET dll which I use from a C++ program.Now I have to register the dll programmatically on a deployment computer.How do I do that (programmatically! not using regasm)? I remember, when I once called a VB6 dll from a C++ dll, I had to use DllRegisterServer and DllUnregisterServer.Is that still so with a .NET dll?It seems I have to somehow add the dllregisterserver function to the .NET dll. <code> ",Register a C#/VB.NET COM dll programmatically
Sharepoint fails to load a C++ dll on windows 2008," I have a SharePoint DLL that does some licensing things and as part of the code it uses an external C++ DLL to get the serial number of the hardisk.When I run this application on Windows Server 2003 it works fine, but on Windows Server 2008 the whole site (loaded on load) crashes and resets continually. This is not Windows Server 2008 R2 and is the same in 64 or 32 bits.If I put a Debugger.Break before the DLL execution then I see the code get to the point of the break and then never come back into the DLL again. I do get some debug assertion warnings from within the function, again only in Windows Server 2008, but I'm not sure this is related.I created a console application that runs the C# DLL, which in turn loads the C++ DLL, and this works perfectly on Windows Server 2008 (although it does show the assertion errors, but I have suppressed these now).The assertion errors are not in my code but within ICtypes.c, and not something I can debug.If I put a breakpoint in the DLL it is never hit and the compiler says: If I try to debug into the DLL using Visual Studio.I have tried wrapping the code used to call the DLL in: But this also does not help.I have the source code for this DLL so that is not a problem.If I delete the DLL from the directory I get an error about a missing DLL. If I replace it, back to no error or warning just a complete failure.If I replace this code with a hardcoded string the whole application works fine.Any advice would be much appreciated, I can't understand why it works as a console application, yet not when run by SharePoint. This is with the same user account, on the same machine...This is the code used to call the DLL: <code>  ""step in: Stepping over non user code"" SPSecurity.RunWithElevatedPrivileges(delegate() [DllImport(""idDll.dll"", EntryPoint = ""GetMachineId"", SetLastError = true)] extern static string GetComponentId([MarshalAs(UnmanagedType.LPStr)]String s); public static string GetComponentId() { Debugger.Break(); if (_machine == string.Empty) { string temp = """"; id= ComponentId.GetComponentId(temp); } return id; }",SharePoint fails to load a C++ DLL on Windows 2008
How to read a DiCOM file in c#?," I would like to read a DICOM file in C#. I don't want to do anything fancy, I just for now would like to know how to read in the elements, but first I would actually like to know how to read the header to see if is a valid DICOM file.It consists of Binary Data Elements. The first 128 bytes are unused (set to zero), followed by the string 'DICM'. This is followed by header information, which is organized into groups.A sample DICOM header In the above example, the header is organized into groups. The group 0002 hex is the file meta information group which contains 3 elements: one defines the group length, one stores the file version and the their stores the transfer syntax.QuestionsHow to I read the header file and verify if it is a DICOM file by checking for the 'D','I','C','M' characters after the 128 byte preamble? How do I continue to parse the file reading the other parts of the data? <code>  First 128 bytes: unused DICOM format.Followed by the characters 'D','I','C','M'Followed by extra header information such as:0002,0000, File Meta Elements Groups Len: 1320002,0001, File Meta Info Version: 2560002,0010, Transfer Syntax UID: 1.2.840.10008.1.2.1.0008,0000, Identifying Group Length: 1520008,0060, Modality: MR0008,0070, Manufacturer: MRIcro",c#: how to read parts of a file? (DICOM)
How append data to a binary file?," I have a binary file to which I want to append a chunk of data at the end of the file, how can I achieve this using C# and .net? Also is there anything to consider when writing to the end of a binary file? Thanks a lot for your help. <code> ",How to append data to a binary file?
Increase the size of sql compact 3.5 .sdf file using C#, I'm using Sql Compact3.5 as my DB with C# .NET what is the maximum size of sdf that I can give? Is there any way to programatically increase the maximum size of the sdf file? If so how? <code> ,Increase the size of sql compact 3.5 .sdf file
how do I retrieve an image from my resx file," I have added an image to my form's resource file, myForm.resx, and I would like to use it in my code file, myForm.cs, but I am not entirely clear on how to get a handle to it. <code> ",How do I retrieve an image from my resx file?
c# getting the web server name ," I am placing a JS file to remote server(s). I d like to know where the request is coming from. ie : i have a js on google.com and upon user click on the link that s produced by js, it triggers some c# code on my server, but i also have the same js on yahoo.com and i d like to be able to know where the request is coming from.How to find this ? <code> ",Getting the referrer's web server name
How to find the logged in user in Sharepoint??," I have developed a ""web part"" that has to be deployed on a Sharepoint server. I need the username of the user, who has logged in the sharepoint server within the web part. How do I get that username? <code> ",How to find the logged in user in Sharepoint?
How to detect that C# winform code is executed within Visual Studio ?, Is there a variable or a preprocessor constant that allows to know that the code is executed within the context of Visual Studio? <code> ,How to detect that C# Windows Forms code is executed within Visual Studio?
linq get sum of two columns in one query," let's say that I have a table calledItems (ID int, Done int, Total int)I can do it by two queries: But I'd like to do it in one query, something like this: Surely there is a way to call aggregate functions from LINQ syntax...?  <code>  int total = m.Items.Sum(p=>p.Total)int done = m.Items.Sum(p=>p.Done) var x = from p in m.Items select new { Sum(p.Total), Sum(p.Done)};",Get sum of two columns in one LINQ query
How do you resolve the common naming collsision between type and object?," Since the standard c# convention is to capitalize the first letter of public properties, the old c++ convention of initial capital for type names, and initial lowercase for non-type names does not prevent the classic name collision where the most obvious object name matches the type name: It seems to compile, but feels so wrong. Is there a recommend naming convention to avoid this? <code>  class FooManager{ public BarManager BarManager { get; set; } // Feels very wrong. // Recommended naming convention? public int DoIt() { // 1st and 2nd Bar Manager are different symbols return BarManager.Blarb + BarManager.StaticBlarb; }}class BarManager{ public int Blarb { get; set; } public static int StaticBlarb { get; set; }}",How do you resolve the common naming collision between type and object?
Why IList<> has less feature than List<>?," To use such great function as ConvertAll(), I have to convert IList to List, it's painful. <code> ",Why does IList<> have fewer features than List<>?
C# debug vs release performance," I've encountered the following paragraph: Debug vs. Release setting in the IDE when you compile your code in Visual Studio makes almost no difference to performance the generated code is almost the same. The C# compiler doesnt really do any optimization. The C# compiler just spits out IL and at the runtime its the JITer that does all the optimization. The JITer does have a Debug/Release mode and that makes a huge difference to performance. But that doesnt key off whether you run the Debug or Release configuration of your project, that keys off whether a debugger is attached.The source is here and the podcast is here.Can someone direct me to a Microsoft article that can actually prove this?Googling ""C# debug vs release performance"" mostly returns results saying ""Debug has a lot of performance hit"", ""release is optimized"", and ""don't deploy debug to production"". <code> ",Debug vs. Release performance
C#: Debug vs. Release performance," I've encountered the following paragraph: Debug vs. Release setting in the IDE when you compile your code in Visual Studio makes almost no difference to performance the generated code is almost the same. The C# compiler doesnt really do any optimization. The C# compiler just spits out IL and at the runtime its the JITer that does all the optimization. The JITer does have a Debug/Release mode and that makes a huge difference to performance. But that doesnt key off whether you run the Debug or Release configuration of your project, that keys off whether a debugger is attached.The source is here and the podcast is here.Can someone direct me to a Microsoft article that can actually prove this?Googling ""C# debug vs release performance"" mostly returns results saying ""Debug has a lot of performance hit"", ""release is optimized"", and ""don't deploy debug to production"". <code> ",Debug vs. Release performance
"In C# ,how do I terminate a thread that has had its call stack corrupted?"," I have a thread in my application that is running code that can potentially cause call stack corruption ( my application is a testing tool for dlls ).Assuming that I have a method of detecting if the child thread is misbehaving, how would I terminate it? From what I read, calling Thread.Abort() on the misbehaving thread would be equivalent to raising an exception inside it.I fear that that not be a good idea, provided the call stack of the thread might be corrupted.Any suggestions? <code> ",How do I terminate a .NET thread that has had its call stack corrupted?
Why LINQ will work this way?," The following code doesn't compile. The error is ArrayList is not IEnumerable This compiles: Can anybody explain what the difference is between these two snippets? Why the second works? <code>  public static ArrayList GetStudentAsArrayList(){ ArrayList students = new ArrayList { new Student() { RollNumber = 1,Name =""Alex "" , Section = 1 ,HostelNumber=1 }, new Student() { RollNumber = 2,Name =""Jonty "" , Section = 2 ,HostelNumber=2 } }; return students;} ArrayList lstStudents = GetStudentAsArrayList();var res = from r in lstStudents select r; ArrayList lstStudents = GetStudentAsArrayList();var res = from Student r in lstStudents select r;",LINQ: why does this query not work on an ArrayList?
.NET 4.0 project reference 2.0 assembly," I have a project in which I'd like to use some of the .NET 4.0 features but a core requirement is that I can use the System.Data.SQLite framework which is compiled against 2.X. I see mention of this being possible such as the accepted answer here but I don't see how to actually achieve this.When I just try and run my 4.0 project while referencing the 2.X assembly I get: Mixed mode assembly is built against version 'v2.0.50727' of the runtime and cannot be loaded in the 4.0 runtime without additional configuration information.What ""additional configuration"" is necessary? <code> ",What 'additional configuration' is necessary to reference a .NET 2.0 mixed mode assembly in a .NET 4.0 project?
ASP.NET MVC model binding with nested child models and PartialViews," I have the following types and classes: I want to edit the Page instance in my Edit.aspx View. Because EditableContent is also attached to other models, I have a PartialView called ContentEditor.ascx that is strongly typed and takes an instance of EditableContent and renders it.The rendering part all works fine, but when I post - everything inside my ContentEditor is not binded - which means that Page.Content is null.On the PartialView, I use strongly typed Html Helpers to do this: But because the input elements on the form that are rendered by ContentEditor.ascx does not get the Content prefix to its id attribute - the values are not binded to Page.I tried using loosely typed helpers to overcome this: And when I'm dealing with a property that is a List<T> of something it gets very ugly. I then have to render collection indexes manually.Should I put both Page and EditableContent as parameters to the controller action?: What am I missing? <code>  namespace MVC.Modelspublic class Page { public EditableContent Content {get; set; }}public class EditableContent{ public TemplateSection SidebarLeft {get; set; } public TemplateSection SidebarRight {get; set; }} <%= Html.HiddenFor(m => m.TemplateId) %> <%= Html.Hidden(""Content.TemplateId"", Model.TemplateId) %> public ActionResult Edit(Page page, EditableContent content) { ... }",Model binding with nested child models and PartialViews in ASP.NET MVC
Should enumerators be placed in a separate file or within another class?," I currently have a class file with the following enumeration: Or should I include the enumeration in the class where it's being used?I noticed Microsoft creates a new class file for DockStyle: <code>  using System;namespace Helper{ public enum ProcessType { Word = 0, Adobe = 1, }} using System;using System.ComponentModel;using System.Drawing.Design;namespace System.Windows.Forms{ public enum DockStyle { None = 0, Top = 1, Bottom = 2, Left = 3, Right = 4,. Fill = 5, }}",Should enumerations be placed in a separate file or within another class?
Unit test with live data," I have googled this a little and didn't really find the answer I needed. I am working on a webpage in C# with SQL Server and LINQ for a customer.I want the users to be able to send messages to each other. So what I do is that I unit test this with data that actually goes into the database.The problem is that I now depend on having at least 2 users who I know the ID of. Furthermore I have to clean up after my self. This leads to rather large unit tests that test alot in one test. Lets say I would like to update a user. That would mean that I would have to ceate the user, update it, and then delete it. This a lot of assertions in one unit test and if it fails with updating i have to manually delete it. If I would do it any other way, without saving the data to DB, I would not for sure be able to know that the data was present in the database after updating etc.What is the proper way to do this without having a test that tests a lot of functionality in one test? <code> ",Unit test insert/update/delete
"Using IoC and Dependency Injection, how do I wrap an existing implementation with a new layer of implementation without changing existing code so as not to violate the Open-Closed principle?"," I'm trying to figure out how this would be done in practice, so as not to violate the Open Closed principle.Say I have a class called HttpFileDownloader that has one function that takes a url and downloads a file returning the html as a string. This class implements an IFileDownloader interface which just has the one function. So all over my code I have references to the IFileDownloader interface and I have my IoC container returning an instance of HttpFileDownloader whenever an IFileDownloader is Resolved.Then after some use, it becomes clear that occasionally the server is too busy at the time and an exception is thrown. I decide that to get around this, I'm going to auto-retry 3 times if I get an exception, and wait 5 seconds in between each retry.So I create HttpFileDownloaderRetrier which has one function that uses HttpFileDownloader in a for loop with max 3 loops, and a 5 second wait between each loop. So that I can test the ""retry"" and ""wait"" abilities of the HttpFileDownloadRetrier I have the HttpFileDownloader dependency injected by having the HttpFileDownloaderRetrier constructor take an IFileDownloader.So now I want all Resolving of IFileDownloader to return the HttpFileDownloaderRetrier. But if I do that, then HttpFileDownloadRetrier's IFileDownloader dependency will get an instance of itself and not of HttpFileDownloader.So I can see that I could create a new interface for HttpFileDownloader called IFileDownloaderNoRetry, and change HttpFileDownloader to implement that. But that means I'm changing HttpFileDownloader, which violates Open Closed.Or I could implement a new interface for HttpFileDownloaderRetrier called IFileDownloaderRetrier, and then change all my other code to refer to that instead of IFileDownloader. But again, I'm now violating Open Closed in all my other code.So what am I missing here? How do I wrap an existing implementation (downloading) with a new layer of implementation (retrying and waiting) without changing existing code?Here's some code if it helps: <code>  public interface IFileDownloader{ string Download(string url);}public class HttpFileDownloader : IFileDownloader{ public string Download(string url) { //Cut for brevity - downloads file here returns as string return html; }}public class HttpFileDownloaderRetrier : IFileDownloader{ IFileDownloader fileDownloader; public HttpFileDownloaderRetrier(IFileDownloader fileDownloader) { this.fileDownloader = fileDownloader; } public string Download(string url) { Exception lastException = null; //try 3 shots of pulling a bad URL. And wait 5 seconds after each failed attempt. for (int i = 0; i < 3; i++) { try { fileDownloader.Download(url); } catch (Exception ex) { lastException = ex; } Utilities.WaitForXSeconds(5); } throw lastException; }}","Using IoC and Dependency Injection, how to wrap code with a new layer of implementation without violating the Open-Closed principle?"
C# How do I split a string by strings and include the delimiters?," There are many similar questions, but apparently no perfect match, that's why I'm asking.I'd like to split a random string (e.g. 123xx456yy789) by a list of string delimiters (e.g. xx, yy) and include the delimiters in the result (here: 123, xx, 456, yy, 789).Good performance is a nice bonus. Regex should be avoided, if possible.Update: I did some performance checks and compared the results (too lazy to formally check them though). The tested solutions are (in random order):GabeGuffaMafuRegexOther solutions were not tested because either they were similar to another solution or they came in too late.This is the test code: As you can see, it was really just a quick and dirty test, but I ran the test multiple times and with different order and the result was always very consistent. The measured time frames are in the range of milliseconds up to seconds for the larger datasets. I ignored the values in the low-millisecond range in my following evaluation because they seemed negligible in practice. Here's the output on my box: I compared the results and this is what I found:All 4 functions are fast enough for common usage.The naive version (aka what I wrote initially) is the worst in terms of computation time.Regex is a bit slow on small datasets (probably due to initialization overhead).Regex does well on large data and hits a similar speed as the non-regex solutions.The performance-wise best seems to be Guffa's version overall, which is to be expected from the code.Gabe's version sometimes omits an item, but I did not investigate this (bug?).To conclude this topic, I suggest to use Regex, which is reasonably fast. If performance is critical, I'd prefer Guffa's implementation. <code>  class Program{ private static readonly List<Func<string, List<string>, List<string>>> Functions; private static readonly List<string> Sources; private static readonly List<List<string>> Delimiters; static Program () { Functions = new List<Func<string, List<string>, List<string>>> (); Functions.Add ((s, l) => s.SplitIncludeDelimiters_Gabe (l).ToList ()); Functions.Add ((s, l) => s.SplitIncludeDelimiters_Guffa (l).ToList ()); Functions.Add ((s, l) => s.SplitIncludeDelimiters_Naive (l).ToList ()); Functions.Add ((s, l) => s.SplitIncludeDelimiters_Regex (l).ToList ()); Sources = new List<string> (); Sources.Add (""""); Sources.Add (Guid.NewGuid ().ToString ()); string str = """"; for (int outer = 0; outer < 10; outer++) { for (int i = 0; i < 10; i++) { str += i + ""**"" + DateTime.UtcNow.Ticks; } str += ""-""; } Sources.Add (str); Delimiters = new List<List<string>> (); Delimiters.Add (new List<string> () { }); Delimiters.Add (new List<string> () { ""-"" }); Delimiters.Add (new List<string> () { ""**"" }); Delimiters.Add (new List<string> () { ""-"", ""**"" }); } private class Result { public readonly int FuncID; public readonly int SrcID; public readonly int DelimID; public readonly long Milliseconds; public readonly List<string> Output; public Result (int funcID, int srcID, int delimID, long milliseconds, List<string> output) { FuncID = funcID; SrcID = srcID; DelimID = delimID; Milliseconds = milliseconds; Output = output; } public void Print () { Console.WriteLine (""S "" + SrcID + ""\tD "" + DelimID + ""\tF "" + FuncID + ""\t"" + Milliseconds + ""ms""); Console.WriteLine (Output.Count + ""\t"" + string.Join ("" "", Output.Take (10).Select (x => x.Length < 15 ? x : x.Substring (0, 15) + ""..."").ToArray ())); } } static void Main (string[] args) { var results = new List<Result> (); for (int srcID = 0; srcID < 3; srcID++) { for (int delimID = 0; delimID < 4; delimID++) { for (int funcId = 3; funcId >= 0; funcId--) { // i tried various orders in my tests Stopwatch sw = new Stopwatch (); sw.Start (); var func = Functions[funcId]; var src = Sources[srcID]; var del = Delimiters[delimID]; for (int i = 0; i < 10000; i++) { func (src, del); } var list = func (src, del); sw.Stop (); var res = new Result (funcId, srcID, delimID, sw.ElapsedMilliseconds, list); results.Add (res); res.Print (); } } } }} S 0 D 0 F 3 11ms1S 0 D 0 F 2 7ms1S 0 D 0 F 1 6ms1S 0 D 0 F 0 4ms0S 0 D 1 F 3 28ms1S 0 D 1 F 2 8ms1S 0 D 1 F 1 7ms1S 0 D 1 F 0 3ms0S 0 D 2 F 3 30ms1S 0 D 2 F 2 8ms1S 0 D 2 F 1 6ms1S 0 D 2 F 0 3ms0S 0 D 3 F 3 30ms1S 0 D 3 F 2 10ms1S 0 D 3 F 1 8ms1S 0 D 3 F 0 3ms0S 1 D 0 F 3 9ms1 9e5282ec-e2a2-4...S 1 D 0 F 2 6ms1 9e5282ec-e2a2-4...S 1 D 0 F 1 5ms1 9e5282ec-e2a2-4...S 1 D 0 F 0 5ms1 9e5282ec-e2a2-4...S 1 D 1 F 3 63ms9 9e5282ec - e2a2 - 4265 - 8276 - 6dbb50fdae37S 1 D 1 F 2 37ms9 9e5282ec - e2a2 - 4265 - 8276 - 6dbb50fdae37S 1 D 1 F 1 29ms9 9e5282ec - e2a2 - 4265 - 8276 - 6dbb50fdae37S 1 D 1 F 0 22ms9 9e5282ec - e2a2 - 4265 - 8276 - 6dbb50fdae37S 1 D 2 F 3 30ms1 9e5282ec-e2a2-4...S 1 D 2 F 2 10ms1 9e5282ec-e2a2-4...S 1 D 2 F 1 10ms1 9e5282ec-e2a2-4...S 1 D 2 F 0 12ms1 9e5282ec-e2a2-4...S 1 D 3 F 3 73ms9 9e5282ec - e2a2 - 4265 - 8276 - 6dbb50fdae37S 1 D 3 F 2 40ms9 9e5282ec - e2a2 - 4265 - 8276 - 6dbb50fdae37S 1 D 3 F 1 33ms9 9e5282ec - e2a2 - 4265 - 8276 - 6dbb50fdae37S 1 D 3 F 0 30ms9 9e5282ec - e2a2 - 4265 - 8276 - 6dbb50fdae37S 2 D 0 F 3 10ms1 0**634226552821...S 2 D 0 F 2 109ms1 0**634226552821...S 2 D 0 F 1 5ms1 0**634226552821...S 2 D 0 F 0 127ms1 0**634226552821...S 2 D 1 F 3 184ms21 0**634226552821... - 0**634226552821... - 0**634226552821... - 0**634226552821... - 0**634226552821... -S 2 D 1 F 2 364ms21 0**634226552821... - 0**634226552821... - 0**634226552821... - 0**634226552821... - 0**634226552821... -S 2 D 1 F 1 134ms21 0**634226552821... - 0**634226552821... - 0**634226552821... - 0**634226552821... - 0**634226552821... -S 2 D 1 F 0 517ms20 0**634226552821... - 0**634226552821... - 0**634226552821... - 0**634226552821... - 0**634226552821... -S 2 D 2 F 3 688ms201 0 ** 634226552821217... ** 634226552821217... ** 634226552821217... ** 634226552821217... **S 2 D 2 F 2 2404ms201 0 ** 634226552821217... ** 634226552821217... ** 634226552821217... ** 634226552821217... **S 2 D 2 F 1 874ms201 0 ** 634226552821217... ** 634226552821217... ** 634226552821217... ** 634226552821217... **S 2 D 2 F 0 717ms201 0 ** 634226552821217... ** 634226552821217... ** 634226552821217... ** 634226552821217... **S 2 D 3 F 3 1205ms221 0 ** 634226552821217... ** 634226552821217... ** 634226552821217... ** 634226552821217... **S 2 D 3 F 2 3471ms221 0 ** 634226552821217... ** 634226552821217... ** 634226552821217... ** 634226552821217... **S 2 D 3 F 1 1008ms221 0 ** 634226552821217... ** 634226552821217... ** 634226552821217... ** 634226552821217... **S 2 D 3 F 0 1095ms220 0 ** 634226552821217... ** 634226552821217... ** 634226552821217... ** 634226552821217... **",How do I split a string by strings and include the delimiters using .NET?
Win C#: Refresh Windows Explorer in Win7," My program sets ""HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced"" value ""Hidden"". Hovewer I'm not able to refresh the explorer to take into account this change. I've tried:1) 2) 3) 4) Nothing works. So what should I do? If I refresh Explorer myself with F5, then it works. Hovewer I would like some elegant solution, so it would refresh the display everywhere, even in OpenFile/SaveFile dialogs, which are currently open.I'm using C# .NET, Win7.Status Update #1As Anders pointed out, there is a simple way to refresh explorer windows using COM: So this part is done. Hovewer I still need to refresh the OpenFile/SaveFile dialogs, and the code above doesn't do that. Does anybody know how to refresh those dialogs?An important point is that if I change the ""Show Hidden Files"" in Folder Options in Control panel, those OpenFile/SaveFile dialogs are not refreshed by the system, I must refresh them manually using F5. I'm just looking for a method how to refresh all those dialogs using C#, so I don't need to press F5 anymore...Status Update #2Ok, so new problem with the code above - it refresh not only windows explorers, but also internet explorers... Any idea how to refresh windows explorers ONLY? <code>  SHChangeNotify(SHCNE_ASSOCCHANGED, SHCNF_IDLIST, IntPtr.Zero, IntPtr.Zero);` SHELLSTATE state = new SHELLSTATE(); state.fShowAllObjects = (uint)1; SHGetSetSettings(ref state, SSF.SSF_SHOWALLOBJECTS, true); SendMessageTimeout(HWND_BROADCAST, WM_SETTINGCHANGE, SPI_SETNONCLIENTMETRICS, 0, SMTO_ABORTIFHUNG, 5000, ref dwResult); SendMessage(HWND_BROADCAST, WM_COMMAND, 28931 /* Refresh */, 0); Guid CLSID_ShellApplication = new Guid(""13709620-C279-11CE-A49E-444553540000"");Type shellApplicationType = Type.GetTypeFromCLSID(CLSID_ShellApplication, true);dynamic shellApplication = Activator.CreateInstance(shellApplicationType);dynamic windows = shellApplication.Windows();for (int i = 0; i < windows.Count; i++) windows.Item(i).Refresh();",Refresh Windows Explorer in Win7
C# noob - find all properties of type DateTime in an class, I need to adjust the datetime of a bunch of objects.I'd like to loop through the properties of the class and if the type is dateTime adjust accordingly.Is there any kind of 'describe type' built in goodness I can use? <code> ,How do I find all properties of type DateTime in an class?
how not to allow muliple keystokes received at one key press?," when we press a key and keep pressing it the keypress and keydown event continuously fires.Is there a way to let these fire only after a complete cycle ,eg keydown and then key up.I would like the user not to be able press the key continuously rather would like the user have to press then release the key board to type a character !so that following case do not occur eg : pppppppppppppppppppppppp when user presses 'p' for 1 sec. <code> ",how not to allow multiple keystokes received at one key press?
"I have a SID of a user account, and I want the SIDs of the groups it belongs to. (C#)"," This has to be obtained from a remote machine. The following query works not for SIDs, but for group and account names. The Win32_Group objects it returns come in the forms of strings, and they only have domain and name (even though Win32_Group has a SID property).I have this sinking feeling I'll have to:Turn the SID into an account name by querying Win32_SID;Perform the query above;Turn each of the resulting group names into SIDs by querying Win32_Group. <code>  ""SELECT GroupComponent FROM Win32_GroupUser WHERE PartComponent = \""Win32_UserAccount.Domain='"" + accountDomain + ""',Name='"" + accountName + ""'\""""","I have a SID of a user account, and I want the SIDs of the groups it belongs to"
In need of a short and clear definition," I'm trying to figure out what exactly Dependency Properties are, but when I look anywhere for a definition, I only find ""how to use"" but not ""what it is"". Imagine you are asked on a job interview - what is a dependency property. What would be your answer? <code> ","Need a short and clear definition for ""Dependency Properties"""
How can I calculate what date Good Friday falls on given a year?, Does anyone have a good algorithm to calculate what date Good Friday falls on given the year as an input? Preferably in C#. <code> ,"How can I calculate what date Good Friday falls on, given a year?"
c# big paragraph tooltip," I'm trying to display a paragraph in a tooltip when I hover a certain picture box. The problem is, the tooltip takes that paragraph, and spans it on one line, all across my screen. How can I make it so that it takes a smaller, more readable area?or, maybe you have another technique to achieve the same thing, but without the tooltip function? <code> ",winforms big paragraph tooltip
How to focus a cell in Excel VSTO using C#? How to select first cell using C# in VSTO?, How to focus a cell in Excel VSTO using C# or to select first cell using C# in VSTO? <code> ,How to focus or select a cell in Excel
Are there alternatives to UltraWinGrid (for C#)?," I've been using the Infragistics UltraWinGrid for a while in a C# project, and while it's very spiffy, it is sometimes a bit heavy to run (and editing it in Visual Studio can be hazardous).I'm looking for a lighter alternative. Looks (always a big plus with Infragistics) are not as important as functionality. Namely, I'm looking for a beefed up DataGridView which:has data binding (duh!)has lock control over editingallows for sub-tables on opening a rowcan have multiple headers to group columns together (say header 1 is composed of ""Group A"" and ""Group B"", and header 2 has various columns under each group)has sorting by column (and can sort numbers properly, even if it does not have a stock method at first)has filtering by column (perhaps the most demanding spec) la UltraWinGrid/Excel (text field with a way to specify if the filter is equal, not equal, greater, lesser, starts with, ends with, etc).supports check box, text box or data bound list/combo box cellsallows cells to be merged (not the control cells of course!)can have events bound to each row (say double click) <code> ",Are there alternatives to UltraWinGrid?
WPF Getting Control null reference  during InitializeComponent," So my InitializeComponent method call in the Window's constructor is running through the XML and adding the controls and plugging them into their events. So when a property of one of the controls changes it calls the Method that subscribes to the event. The method references a control that has not yet been built. Why does this happen in this order here? It worked in WinForms because the events were not fired until later, after all the controls were created. Is there a way to force this in WPF?The other solutions I see are I need to subscribe to the events after initialization. I need to check for null whenever I deal with a control.  <code> ",WPF Getting Control null reference during InitializeComponent
.Net Regex question!," Supposed I have the following string: And I would like to change 'tag' to 'newTag' so the result would be: What is the best way to do it?I tried to search for <[/]*tag> but then I don't know how to keep the optional [/] in my result... <code>  string str = ""<tag>text</tag>""; ""<newTag>text</newTag>""",How do I replace part of a string in C#?
Log4net - how to disable creation of empty log file on app start, I have configured log4net in my app successfully but one thing is a little bit annoying for me.The log file is created (empty) after my app start even if no error occurs. I would like to log file be created only after some error. <code> ,How to disable creation of empty log file on app start?
What is the basic concept behind WaitHandle in C# .net threading ?, What is the basic concept behind WaitHandle in C# .net threading?Whats is its use?When to use it?What is the use of WaitAll and WaitAny methods inside it? <code> ,What is the basic concept behind WaitHandle?
How can I take the first 100 characters of html content ( without stripping the TAGS! )," There are lots of questions on how to strip html tags, but not many on functions/methods to close them.Here's the situation. I have a 500 character Message summary ( which includes html tags ), but I only want the first 100 characters. Problem is if I truncate the message, it could be in the middle of an html tag... which messes up stuff.Assuming the html is something like this: How would I take the first ~100 characters or so? ( Although, ideally that would be the first approximately 100 characters of ""CONTENT"" ( in between the html tags )I'm assuming the best way to do this would be a recursive algorithm that keeps track of the html tags and appends any tags that would be truncated, but that may not be the best approach.My first thoughts are using recursion to count nested tags, and when we reach 100 characters, look for the next ""<"" and then use recursion to write the closing html tags needed from there.The reason for doing this is to make a short summary of existing articles without requiring the user to go back and provide summaries for all the articles. I want to keep the html formatting, if possible.NOTE: Please ignore that the html isn't totally semantic. This is what I have to deal with from my WYSIWYG.EDIT:I added a potential solution ( that seems to work ) I figure others will run into this problem as well. I'm not sure it's the best... and it's probably not totally robust ( in fact, I know it isn't ), but I'd appreciate any feedback <code>  <div class=""bd"">""Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. <br/> <br/>Some Dates: April 30 - May 2, 2010 <br/> <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. <em>Duis aute irure dolor in reprehenderit</em> in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. <br/> </p> For more information about Lorem Ipsum doemdloe, visit: <br/> <a href=""http://www.somesite.com"" title=""Some Conference"">Some text link</a><br/> </div>",Get first 100 characters of HTML content without stripping tags
Non Unicode in HttpContext," I am using HttpContext object implemented in HttpHandler child to download a file, when I have non-ascii characters in file name it looks weird in IE whereas it looks fine in Firefox.below is the code:- when I supply '' '' '' '' '' '' '' '' '' '' in file name field it looks different than what I have in file name it looks fine in firefox. adding EncodingType and charset has been of no use.In ie it is ''''''''''''''''''_'' and in firefox it is '' '' '' '' '' '' '' '' '' ''.Any Idea how this can be fixed? <code>  context.Response.ContentType = "".cs"";context.Response.AppendHeader(""Content-Length"", data.Length.ToString());context.Response.AppendHeader(""Content-Disposition"", String.Format(""attachment; filename={0}"",filename)); context.Response.OutputStream.Write(data, 0, data.Length);context.Response.Flush();",Unicode in Content-Disposition header
Non Unicode in Content-Disposition header," I am using HttpContext object implemented in HttpHandler child to download a file, when I have non-ascii characters in file name it looks weird in IE whereas it looks fine in Firefox.below is the code:- when I supply '' '' '' '' '' '' '' '' '' '' in file name field it looks different than what I have in file name it looks fine in firefox. adding EncodingType and charset has been of no use.In ie it is ''''''''''''''''''_'' and in firefox it is '' '' '' '' '' '' '' '' '' ''.Any Idea how this can be fixed? <code>  context.Response.ContentType = "".cs"";context.Response.AppendHeader(""Content-Length"", data.Length.ToString());context.Response.AppendHeader(""Content-Disposition"", String.Format(""attachment; filename={0}"",filename)); context.Response.OutputStream.Write(data, 0, data.Length);context.Response.Flush();",Unicode in Content-Disposition header
Difference Between Property And Function., Which one is better to use when it come to return value for example And Which one is better and why? And what is best programming practice to use when we have secnario like above ? <code>  public int EmployeeAge{ get{return intEmployeeAge};} public int EmployeeAge(){ return intEmployeeAge;},Difference between Property and Method
Stack & heap understanding question," I would really appreciate if someone could tell me whether I understand it well: Also both a1 and a2 references are on the stack, while their ""object"" values are on the heap. But what about VarA variable, its still pure value type? <code>  class X{ A a1=new A(); // reference on the stack, object value on the heap a1.VarA=5; // on the stack - value type A a2=a1; // reference on the stack, object value on the heap a2.VarA=10; // on the stack - value type } class A{ int VarA;}",Are these objects's references on the Stack or on the Heap?
Is there any performance difference between Debug and Release?," I'm using MySql Connector .NET to load an account and transfer it to the client.This operation is rather intensive, considering the child elements of the account to load.In Debug mode, it takes, at most, 1 second to load the account. The average would be 500ms.In Release mode, it takes from 1 to 4 seconds to load the account. The average would be 1500ms.Since there is no #if DEBUG directive or the like in my code, I'm wondering where the difference is coming from.Is there a project build option I could change? Or does it have to do with MySql Connector .NET that would have different behaviors depending on the build mode?EDIT: Ticks monitoring. Comparison:Release takes 20x the time Debug takes (average comparison).4,404,500 / 213,000 = 20Now the first operation is indeed longer, but in general, so are all the other times for release.Any idea?EDIT 2: I added even a broader tests that calculates the total time. For 50 account loads, it takes an average of 4 seconds in debugs, and 40 seconds in release. I'm starting to get quite desperate over this - it is a serious performance issue for my application. Does anyone have a guess on how to fix this? <code>  Debug (Average: 213000 ticks)7300003200006000050000190000130000210000180000160000110000390000270000150000190000230000210000150000200000190000140000Release (Average: 4404500 ticks)129400001700001800008000080000130000120000506000050900001300005000010430000251600001500001600001300001762000010160000100000150000",Is there any (performance) difference between Debug and Release?
Divide not returning the decimal value i expect.," Possible Duplicate: What's wrong with this division? If you divide 2 / 3, it should return 0.66666666666666667. Instead, I get 0.0 in double value type and 0 in decimal.My purpose is to divide even (e.g. 2 / 3) and round to 1 always to the nearest.Any help? <code> ",Divide not returning the decimal value I expect
c# writing object to binary file, I have to write an object in to binary file.My struct looks like this. What is the best way to do the above operation? RegardsRaju <code>  Struct Company { int numberofemployees list of Struct Employee. } Struct Employee { string EmployeeName; string Designation; },C# writing object to binary file
Calculate private working set (memory) using C#.," How do I calculate the private working set of memory using C#? I'm interested in producing roughly the same figures as taskmgr.exe.I'm using the Process namespace and using methods/data like WorkingSet64 and PrivateMemorySize64, but these figures are off by 100MB or more at times. <code> ",How to calculate private working set (memory)?
How to define a DataTemplate in c# code," How can I create a DataTemplate in code (using C#) and then add a control to that DataTemplate? I am using Sivlerlight. <code>  <data:DataGrid.RowDetailsTemplate> <DataTemplate> <Border> <Border Margin=""10"" Padding=""10"" BorderBrush=""SteelBlue"" BorderThickness=""3"" CornerRadius=""5""> <TextBlock Text=""{Binding Description}"" TextWrapping=""Wrap"" FontSize=""10""> </TextBlock> </Border> </Border> </DataTemplate></data:DataGrid.RowDetailsTemplate>",How to define a DataTemplate in code?
How to write to stdin of another app?," I have a module that reads the StandardError of a process. Everything works fine, but I want to do something different. I don't know how to redirect stdin like the native way:app1.exe -someargs | app2.exe -someargsWhere app2 reads all the stdout of app1 in its stdin. <code> ",How to write to the stdin of another app?
VB Equivalent of C# Type Check, What is the Visual Basic equivalent of the following C# boolean expression? Note: The variable data is declared as IEnumerable. <code>  data.GetType() == typeof(System.Data.DataView),Visual Basic equivalent of C# type check
"How do you display a list of images, from a folder on hard drive, on ASP.NET website? "," I am trying to make a simple photo gallery website. Using ASP.NET and C#.Right now I don't have a server set up but I am just using the development one that Visual Studio Starts when you make a website project and run it. I have a folder on my hard drive that contains an unknown number of images. I want to write a piece of code that will go through each image and add them to the default webpage. I have tried this code but it doesn't work. What am I doing wrong? Should I be using a ListView control or a DataView or something like that? Do I need to add a virtual directory in order to access the images? If so, how do I to that on this test server?ALSO, how do I set the position and alignment of these pictures?For example, how would I make it so that the pictures are in a line vertically and centered on the webpage? <code>  protected void Page_Load(object sender, EventArgs e){ string[] filesindirectory = Directory.GetFiles(@""C:\Users\Jordan\Desktop\Web Images""); int i = 1; foreach (string s in filesindirectory) { Image img = new Image(); img.ID = ""image"" + i.ToString(); img.ImageUrl = s; img.Visible = true; Page.Controls.Add(img); i++; }}","How do you display a list of images, from a folder on hard drive, on ASP.NET website?"
When to go for object pooling [c#]?, When to go for object pooling using C#? Any good ex...What are the pro's and con's of maintaining a pool of frequently used objects and grab one from the pool instead of creating a new one? <code> ,When to go for object pooling?
"How do the httppost, httpput etc attributes in asp.net mvc 2 work?"," In ASP.NET MVC 2, a couple of new action filter attributes were introduced, as ""shorthand"" for attributes in ASP.NET MVC 1; for example, applying the HttpPostAttribute does the same thing as applying [AcceptVerbs(HttpVerbs.Post)] to an action method.In addition, with the more verbose syntax, it is possible to combine different methods, in order to allow for example both Post and Delete.Now I'm wondering: how do the new attributes work? If I apply both [HttpPost] and [HttpDelete], will ASP.NET MVC 2 allow both or require both (thus allowing nothing)? <code> ","How do the httppost, httpput etc attributes in ASP.NET MVC 2 work?"
C# .NET Email Regular Expression Validation," Can anyone correct the expression below to also not allow blank field? <code>  <asp:RegularExpressionValidator ID=""expEmail"" runat=""server"" ControlToValidate=""txtEmail"" ErrorMessage=""valid email address required"" ValidationExpression=""^([a-zA-Z][\w\.-]*[a-zA-Z0-9]@[a-zA-Z0-9][\w\.-]*[a-zA-Z0-9]\.[a-zA-Z][a-zA-Z\.]*[a-zA-Z]){1,70}$""></asp:RegularExpressionValidator>",Email Regular Expression Validation
IEnumerable doesn't have Count, I have the following method: Why is it that when I do .Count() above it is underlined in red?I got the following error: Error 1 'System.Collections.Generic.IEnumerable' does not contain a definition for 'Count' and no extension method 'Count' accepting a first argument of type 'System.Collections.Generic.IEnumerable' could be found (are you missing a using directive or an assembly reference?) c:\users\a\documents\visual studio 2010\Projects\NerdDinner\NerdDinner\Models\Dinner.cs 15 47 NerdDinner <code>  public bool IsValid{ get { return (GetRuleViolations().Count() == 0); }}public IEnumerable<RuleViolation> GetRuleViolations(){ //code here},IEnumerable doesn't have a Count method
Is there anyway to close a StreamWriter without closing it's BaseStream?," My root problem is that when using calls Dispose on a StreamWriter, it also disposes the BaseStream (same problem with Close).I have a workaround for this, but as you can see, it involves copying the stream. Is there any way to do this without copying the stream?The purpose of this is to get the contents of a string (originally read from a database) into a stream, so the stream can be read by a third party component.NB: I cannot change the third party component. Used as Ideally I'm looking for an imaginary method called BreakAssociationWithBaseStream, e.g. <code>  public System.IO.Stream CreateStream(string value){ var baseStream = new System.IO.MemoryStream(); var baseCopy = new System.IO.MemoryStream(); using (var writer = new System.IO.StreamWriter(baseStream, System.Text.Encoding.UTF8)) { writer.Write(value); writer.Flush(); baseStream.WriteTo(baseCopy); } baseCopy.Seek(0, System.IO.SeekOrigin.Begin); return baseCopy;} public void Noddy(){ System.IO.Stream myStream = CreateStream(""The contents of this string are unimportant""); My3rdPartyComponent.ReadFromStream(myStream);} public System.IO.Stream CreateStream_Alternate(string value){ var baseStream = new System.IO.MemoryStream(); using (var writer = new System.IO.StreamWriter(baseStream, System.Text.Encoding.UTF8)) { writer.Write(value); writer.Flush(); writer.BreakAssociationWithBaseStream(); } return baseStream;}",Is there any way to close a StreamWriter without closing its BaseStream?
Is there any way to close a StreamWriter without closing it's BaseStream?," My root problem is that when using calls Dispose on a StreamWriter, it also disposes the BaseStream (same problem with Close).I have a workaround for this, but as you can see, it involves copying the stream. Is there any way to do this without copying the stream?The purpose of this is to get the contents of a string (originally read from a database) into a stream, so the stream can be read by a third party component.NB: I cannot change the third party component. Used as Ideally I'm looking for an imaginary method called BreakAssociationWithBaseStream, e.g. <code>  public System.IO.Stream CreateStream(string value){ var baseStream = new System.IO.MemoryStream(); var baseCopy = new System.IO.MemoryStream(); using (var writer = new System.IO.StreamWriter(baseStream, System.Text.Encoding.UTF8)) { writer.Write(value); writer.Flush(); baseStream.WriteTo(baseCopy); } baseCopy.Seek(0, System.IO.SeekOrigin.Begin); return baseCopy;} public void Noddy(){ System.IO.Stream myStream = CreateStream(""The contents of this string are unimportant""); My3rdPartyComponent.ReadFromStream(myStream);} public System.IO.Stream CreateStream_Alternate(string value){ var baseStream = new System.IO.MemoryStream(); using (var writer = new System.IO.StreamWriter(baseStream, System.Text.Encoding.UTF8)) { writer.Write(value); writer.Flush(); writer.BreakAssociationWithBaseStream(); } return baseStream;}",Is there any way to close a StreamWriter without closing its BaseStream?
Getting DateTimeOffset value form SQL 2008 to C#," I have a SQL 2008 table with a field called RecDate of type DateTimeOffset.For a given record the value is '2010-04-01 17:19:23.62 -05:00'In C# I create a DataTable and fill it with the results of I need to get the milliseconds, but if I do the following the milliseconds are always 0: What is the proper way to get the value in the RecDate column into the DTO variable? <code>  SELECT RecDate FROM MyTable. DateTimeOffset dto = DateTimeOffset.Parse(dt.Rows[0][0].ToString()); ",Getting DateTimeOffset value from SQL 2008 to C#
Tracking Down a Stack Overflow in My Linq Query ," I've written the following LINQ query: The objective is to retrieve a list of the countries represented by the competitors found in the system. 'countries' is an array of ISOCountry objects explicitly created and returned as an IQueryable<ISOCountry> (ISOCountry is an object of just two strings, isoCountryCode and Name). Competitors is an IQueryable<Competitor> which is bound to a database table through LINQtoSQL though I created the objects from scratch and used the LINQ data mapping decorators.For some reason, this query causes a stack overflow when the system tries to execute it. I've no idea why, I've tried trimming the Distinct, returning an anonymous type of the two strings, using 'select c', but all result in the overflow. The e.CountryID value is populated from a dropdown that was in itself populated from the IQueryable<ISOCountry>, so I know the values are appropriate but even if not, I wouldn't expect a stack overflow.Why is the overflow is occurring or why might it be happening?As requested, code for ISOCountry: It's initialised from a static utility class thus: How I finally got it to work, see below... I am still curious as to what specifically is wrong with the original query, I'm sure I've done similar things before. <code>  IQueryable<ISOCountry> entries = (from e in competitorRepository.Competitors join c in countries on e.countryID equals c.isoCountryCode where !e.Deleted orderby c.isoCountryCode select new ISOCountry() { isoCountryCode = e.countryID, Name = c.Name } ).Distinct(); public class ISOCountry{ public string isoCountryCode { get; set; } public string Name { get; set; }} public static IQueryable<ISOCountry> GetCountryCodes() { // ISO 3166-1 country names and codes from http://opencountrycodes.appspot.com/javascript ISOCountry[] countries = new ISOCountry[] { new ISOCountry { isoCountryCode= ""AF"", Name= ""Afghanistan""}, new ISOCountry { isoCountryCode= ""AX"", Name= ""Aland Islands""}, new ISOCountry { isoCountryCode= ""AL"", Name= ""Albania""}, new ISOCountry { isoCountryCode= ""DZ"", Name= ""Algeria""}, new ISOCountry { isoCountryCode= ""AS"", Name= ""American Samoa""}, ... new ISOCountry { isoCountryCode= ""YE"", Name= ""Yemen""}, new ISOCountry { isoCountryCode= ""ZM"", Name= ""Zambia""}, new ISOCountry { isoCountryCode = ""ZW"", Name = ""Zimbabwe""} }; return countries.AsQueryable(); } IList<string> entries = competitorRepository.Competitors.Select(c=>c.CountryID).Distinct().ToList();IList<ISOCountry> countries = Address.GetCountryCodes().Where(a => entries.Contains(a.isoCountryCode)).ToList();",Tracking down a stack overflow error in my LINQ query
Array that can be accesed using array['Name'] in C#," Can you do In C#Rather than: I know you can do that in PHP but is there an equivelent for C#, although im thinking highley unlikely :( <code>  array['Name']; array[0];",Array that can be accessed using array['Name'] in C#
Barcode reading method?," I recently acquired a Metrologic Barcode scanner (USB port), as everyone already knows it works as a keyboard emulator out of the box.How do I configure the scanner and my application so that my app can process the barcode data directly? That is, I don't want the user to focus on a ""Text field"" and then process the data when the KeyPress event fires. <code> ",How can I read barcodes without having the user focus a text box first?
"C# using the question mark after a type, for example: int? myVariable; what is this used for?"," Typically the main use of the question mark is for the conditional, x ? ""yes"" : ""no"".But I have seen another use for it but can't find an explanation of this use of the ? operator, for example. <code>  public int? myProperty{ get; set;}",What is the purpose of a question mark after a type (for example: int? myVariable)?
"How to save user imputed value in TextBox? (WPF, XAML)"," How to save user inputed value in a TextBox? (WPF XAML) So in my xaml window I have a TextBox. A User starts my application, inputs some values into it and presses a button or hits Enter. He closes the app, opens it up again. How to make his inputs to be saved in that TextBox in WPF? <code> ","How to save user inputed value in TextBox? (WPF, XAML)"
"Reference a GNU C DLL built in GCC against Cygwin, from C#/NET"," Here is what I want: I have a huge legacy C/C++ codebase written for POSIX, including some very POSIX specific stuff like pthreads. This can be compiled on Cygwin/GCC and run as an executable under Windows with the Cygwin DLL.What I would like to do is build the codebase itself into a Windows DLL that I can then reference from C# and write a wrapper around it to access some parts of it programatically. I have tried this approach with the very simple ""hello world"" example at http://www.cygwin.com/cygwin-ug-net/dll.html and it doesn't seem to work. I believe I should be able to reference a DLL built with the above code in C# using something like: But this approach doesn't seem to work. LoadLibrary returns null. It can find the DLL (helloworld.dll), it is just like it can't load it or find the exported function.I am sure that if I get this basic case working I can reference the rest of my codebase in this way. Any suggestions or pointers, or does anyone know if what I want is even possible? Thanks.Edit: Examined my DLL with Dependency Walker (great tool, thanks) and it seems to export the function correctly. Question: should I be referencing it as the function name Dependency Walker seems to find (_Z5hellov)? Edit2: Just to show you I have tried it, linking directly to the dll at relative or absolute path (i.e. not using LoadLibrary): This fails with: ""Unable to load DLL 'C:.....\helloworld.dll': Invalid access to memory location. (Exception from HRESULT: 0x800703E6)*****Edit 3: *****Oleg has suggested running dumpbin.exe on my dll, this is the output: Dump of file helloworld.dll File Type: DLL Section contains the following exports for helloworld.dll Summary Edit 4 Thanks everyone for the help, I managed to get it working. Oleg's answer gave me the information I needed to find out what I was doing wrong. There are 2 ways to do this. One is to build with the gcc -mno-cygwin compiler flag, which builds the dll without the cygwin dll, basically as if you had built it in MingW. Building it this way got my hello world example working! However, MingW doesn't have all the libraries that cygwin has in the installer, so if your POSIX code has dependencies on these libraries (mine had heaps) you can't do this way. And if your POSIX code didn't have those dependencies, why not just build for Win32 from the beginning. So that's not much help unless you want to spend time setting up MingW properly.The other option is to build with the Cygwin DLL. The Cygwin DLL needs an initialization function init() to be called before it can be used. This is why my code wasn't working before. The code below loads and runs my hello world example. Thanks to everyone that answered~~ <code>  #include <stdio.h>extern ""C"" __declspec(dllexport) int hello();int hello(){ printf (""Hello World!\n""); return 42;} [DllImport(""kernel32.dll"")]public static extern IntPtr LoadLibrary(string dllToLoad);[DllImport(""kernel32.dll"")]public static extern IntPtr GetProcAddress(IntPtr hModule, string procedureName);[DllImport(""kernel32.dll"")]public static extern bool FreeLibrary(IntPtr hModule);[UnmanagedFunctionPointer(CallingConvention.Cdecl)]private delegate int hello();static void Main(string[] args){ var path = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, ""helloworld.dll""); IntPtr pDll = LoadLibrary(path); IntPtr pAddressOfFunctionToCall = GetProcAddress(pDll, ""hello""); hello hello = (hello)Marshal.GetDelegateForFunctionPointer( pAddressOfFunctionToCall, typeof(hello)); int theResult = hello(); Console.WriteLine(theResult.ToString()); bool result = FreeLibrary(pDll); Console.ReadKey();} [DllImport(@""C:\.....\helloworld.dll"")] public static extern int hello(); static void Main(string[] args) { int theResult = hello(); Console.WriteLine(theResult.ToString()); Console.ReadKey(); } 00000000 characteristics4BD5037F time date stamp Mon Apr 26 15:07:43 2010 0.00 version 1 ordinal base 1 number of functions 1 number of namesordinal hint RVA name 1 0 000010F0 hello 1000 .bss 1000 .data 1000 .debug_abbrev 1000 .debug_info 1000 .debug_line 1000 .debug_pubnames 1000 .edata 1000 .eh_frame 1000 .idata 1000 .reloc 1000 .text //[DllImport(@""hello.dll"", EntryPoint = ""#1"",SetLastError = true)] //static extern int helloworld(); //don't do this! cygwin needs to be init first [DllImport(""kernel32"", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)] static extern IntPtr GetProcAddress(IntPtr hModule, string procName); [DllImport(""kernel32"", SetLastError = true)] static extern IntPtr LoadLibrary(string lpFileName); public delegate int MyFunction(); static void Main(string[] args) { //load cygwin dll IntPtr pcygwin = LoadLibrary(""cygwin1.dll""); IntPtr pcyginit = GetProcAddress(pcygwin, ""cygwin_dll_init""); Action init = (Action)Marshal.GetDelegateForFunctionPointer(pcyginit, typeof(Action)); init(); IntPtr phello = LoadLibrary(""hello.dll""); IntPtr pfn = GetProcAddress(phello, ""helloworld""); MyFunction helloworld = (MyFunction)Marshal.GetDelegateForFunctionPointer(pfn, typeof(MyFunction)); Console.WriteLine(helloworld()); Console.ReadKey(); }","Reference a GNU C (POSIX) DLL built in GCC against Cygwin, from C#/NET"
Which framework exceptions should every programmer know about ?," I've recently started a new project in C#, and, as I was coding some exception throw in a function, I figured out I didn't really know which exception I should use.Here are common exceptions that are often thrown in many programs :ArgumentException ArgumentNullExceptionInvalidOperationExceptionDivideByZeroExceptionFileNotFoundException...Are there any framework exceptions you often use in your programs ? Which exceptions should every .net programmer know about ?When do you use custom exception ?EDIT : In order to clarify the topic, the original question was more about ""which exception can I throw ?"" than ""what kind of exceptions should I catch ?"". <code> ",Which framework exceptions should every programmer know about?
c# - copy security information when creating a new folder," In my app I'm creating folders for archiving old stuff from a harddisc.When creating a new folder I must copy all NTFS rights (Groups / Users) from the source folder to the newly created destination folder.Here is what I've written so far: Is this really all I ought to do or am I missing something important? <code>  FileSecurity fileSecurity = File.GetAccessControl(filenameSource, AccessControlSections.All);FileAttributes fileAttributes = File.GetAttributes(filenameSource);File.SetAccessControl(filenameDest, fileSecurity);File.SetAttributes(filenameDest, fileAttributes);",How do I copy security information when creating a new folder?
c# order preserving data structures," MSDN has no information on the order preserving properties of data structures. So I've been making the assumption that:HashTable and HashSet do not preserve the insertion order (i.e. the ""hash"" in there is a giveaway)Dictionary and List do preserve the insertion order.From this I extrapolate that if I have a Dictionary<double, double> foo that defines a curve, foo.Keys.ToList() and foo.Values.ToList() will give me an ordered list of the scope and domain of that curve without messing about with it? <code> ",Order-preserving data structures in C#
ASP.NET MVC Get Current Area Name in View or Controller," How do you get the current area name in the view or controller?Is there anything like ViewContext.RouteData.Values[""controller""] for areas? <code> ",Get Current Area Name in View or Controller
ASP.NET MVC - Get Current Area Name in View or Controller," How do you get the current area name in the view or controller?Is there anything like ViewContext.RouteData.Values[""controller""] for areas? <code> ",Get Current Area Name in View or Controller
What is the different between C# and .Net?," May I know what is the difference between C# and .NET? When I think of C#, right away I would say it is a .NET language, but when I search for job posts, they require candidates to have C# and .NET experience. Can someone give me an explanation? <code> ",What is the difference between C# and .NET?
How to produce precisely-timed tone and silence in C#," I have a C# project that plays Morse code for RSS feeds. I write it using Managed DirectX, only to discover that Managed DirectX is old and deprecated. The task I have is to play pure sine wave bursts interspersed with silence periods (the code) which are precisely timed as to their duration. I need to be able to call a function which plays a pure tone for so many milliseconds, then Thread.Sleep() then play another, etc. At its fastest, the tones and spaces can be as short as 40ms.It's working quite well in Managed DirectX. To get the precisely timed tone I create 1 sec. of sine wave into a secondary buffer, then to play a tone of a certain duration I seek forward to within x milliseconds of the end of the buffer then play. I've tried System.Media.SoundPlayer. It's a loser [edit - see my answer below] because you have to Play(), Sleep(), then Stop() for arbitrary tone lengths. The result is a tone that is too long, variable by CPU load. It takes an indeterminate amount of time to actually stop the tone. I then embarked on a lengthy attempt to use NAudio 1.3. I ended up with a memory resident stream providing the tone data, and again seeking forward leaving the desired length of tone remaining in the stream, then playing. This worked OK on the DirectSoundOut class for a while (see below) but the WaveOut class quickly dies with an internal assert saying that buffers are still on the queue despite PlayerStopped = true. This is odd since I play to the end then put a wait of the same duration between the end of the tone and the start of the next. You'd think that 80ms after starting Play of a 40 ms tone that it wouldn't have buffers on the queue.DirectSoundOut works well for a while, but its problem is that for every tone burst Play() it spins off a separate thread. Eventually (5 min or so) it just stops working. You can see thread after thread after thread exiting in the Output window while running the project in VS2008 IDE. I don't create new objects during playing, I just Seek() the tone stream then call Play() over and over, so I don't think it's a problem with orphaned buffers/whatever piling up till it's choked.I'm out of patience on this one, so I'm asking in the hopes that someone here has faced a similar requirement and can steer me in a direction with a likely solution. <code> ",How to produce precisely-timed tone and silence?
Design pattern: polymophisim for list of objects," Suppose I have a class A, and A1, A2 inherits from A.There are 2 functions: Now I want to do something similar to both A1 and A2 in another function If I want to pass the instance of either ListA1 or ListA2, of course the types doesn't match because the compiler doesn't allow the coercion from List< A1> to List< A>. I can't do something like this: So what is the best approach to the process()? Is there any way to do it in a universal way rather than write the similar code to both List and List? <code>  List<A1> getListA1(){...}List<A2> getListA2(){...} public void process(List<A>){...} List<A1> listA1 = getListA1();List<A> newList = (List<A>)listA1; //this is not allowed.",Design pattern: Polymorphism for list of objects
Design pattern: polymorphisim for list of objects," Suppose I have a class A, and A1, A2 inherits from A.There are 2 functions: Now I want to do something similar to both A1 and A2 in another function If I want to pass the instance of either ListA1 or ListA2, of course the types doesn't match because the compiler doesn't allow the coercion from List< A1> to List< A>. I can't do something like this: So what is the best approach to the process()? Is there any way to do it in a universal way rather than write the similar code to both List and List? <code>  List<A1> getListA1(){...}List<A2> getListA2(){...} public void process(List<A>){...} List<A1> listA1 = getListA1();List<A> newList = (List<A>)listA1; //this is not allowed.",Design pattern: Polymorphism for list of objects
C# (4): double minus double giving precision problems, I have come across a precision issue with double in .NET I thought this only applied to floats but now I see that double is a float. What is the correct way to handle this? Round? Lop off the unneeded decimal places? <code>  double test = 278.97 - 90.46;Debug.WriteLine(test) //188.51000000000005//correct answer is 188.51,double minus double giving precision problems
"C#,  can we share some contents of App.config between projects?"," I have two independent projects in my Visual Studio 2008 solution. Both has its own App.config. But in one project, I need one or two properties defined in another project's App.config. Is it possible to share part of the App.config contents from other project? <code> ",Can we share some contents of App.config between projects?
Does new `dynamic' variable type in .NET 4.0 solve the single/multiple method dispatch issue in CLR?," The problem of single dispatch is mostly familiar to people engaged in coding with statically typed languages like Java and C#. The basic idea is:While the runtime polymorphism allows us to dispatch to the right method call according to the type (runtime type) of receiver, for example: The method call will be performed according to the runtime type of mything, namely Cat.This is the single dispatch capability (which is present in Java/C#).Now, if you need to dispatch not only on the runtime type of receiver, but on the types of (multiple) arguments either, you face a little problem: The second method never gets called, because in our 'consumer' code we just tend to treat different types of objects (visitors in my example) by their common supertype or interface.That's why I ask - because dynamic typing allows the multiple dispatch polymorphism and C# 4.0 has that dynamic keyword ;) <code>  IAnimal mything = new Cat();mything.chop(); public class MyAcceptor { public void accept (IVisitor vst) {...} public void accept (EnhancedConcreteVisitor vst) {...} }",Does new 'dynamic' variable type in .NET 4.0 solve the single/multiple method dispatch issue in CLR?
How Yield implements the pattern of lazy loading?, How yield implements the pattern of lazy loading? <code> ,How yield implements the pattern of lazy loading?
How yield implements the pattern of lazy loading?, How yield implements the pattern of lazy loading? <code> ,How yield implements the pattern of lazy loading?
Silverlight : How to pass data from the reqest to the respose using Webclient Asychronous mode ?," How to access VIP in the proxy_OpenReadCompleted method? <code>  void method1() { String VIP = ""test""; WebClient proxy = new WebClient(); proxy.OpenReadCompleted += new OpenReadCompletedEventHandler(proxy_OpenReadCompleted); String urlStr = ""someurl/lookup?q="" + keyEntityName + ""&fme=1&edo=1&edi=1"";}void proxy_OpenReadCompleted(object sender, OpenReadCompletedEventArgs e){ }",Silverlight: How to pass data from the request to the response using Webclient Asynchronous mode?
C# How to check if an FTP Directory Exists," Looking for the best way to check for a given directory via FTP. Currently i have the following code: This returns false whether the directory is there or not. Can someone point me in the right direction. <code>  private bool FtpDirectoryExists(string directory, string username, string password){ try { var request = (FtpWebRequest)WebRequest.Create(directory); request.Credentials = new NetworkCredential(username, password); request.Method = WebRequestMethods.Ftp.GetDateTimestamp; FtpWebResponse response = (FtpWebResponse)request.GetResponse(); } catch (WebException ex) { FtpWebResponse response = (FtpWebResponse)ex.Response; if (response.StatusCode == FtpStatusCode.ActionNotTakenFileUnavailable) return false; else return true; } return true;}",How to check if an FTP directory exists
How to check if an FTP Directory Exists," Looking for the best way to check for a given directory via FTP. Currently i have the following code: This returns false whether the directory is there or not. Can someone point me in the right direction. <code>  private bool FtpDirectoryExists(string directory, string username, string password){ try { var request = (FtpWebRequest)WebRequest.Create(directory); request.Credentials = new NetworkCredential(username, password); request.Method = WebRequestMethods.Ftp.GetDateTimestamp; FtpWebResponse response = (FtpWebResponse)request.GetResponse(); } catch (WebException ex) { FtpWebResponse response = (FtpWebResponse)ex.Response; if (response.StatusCode == FtpStatusCode.ActionNotTakenFileUnavailable) return false; else return true; } return true;}",How to check if an FTP directory exists
C# Interpreted or Compiled?," I thought that C# generated compiled code (by JIT), but I have lately discovered that I can edit code while debugging mode in C# (VS 2008). Does that mean that C# is interpreted? <code> ",Is C# interpreted or compiled?
Is C# Interpreted or Compiled?," I thought that C# generated compiled code (by JIT), but I have lately discovered that I can edit code while debugging mode in C# (VS 2008). Does that mean that C# is interpreted? <code> ",Is C# interpreted or compiled?
C#: are ranges possible with enums?," In C#, can you use number ranges in enum types, for example EDIT: The reason this is needed is to cast from a number to the enum type, eg: and the expected output is: Book 5 is a TextBook <code>  public enum BookType{ Novel = 1, Journal = 2, Reference = 3, TextBook = 4 .. 10} int iBook = 5BookType btBook = (BookType)ibookDebug.Print ""Book "" + ibook + "" is a "" btBook",are ranges possible with enums?
C#: why does the string type have a .toString() method, Why does the string data type have a .ToString() method? <code> ,Why does the string type have a .ToString() method?
C#: why does the string type have a .ToString() method, Why does the string data type have a .ToString() method? <code> ,Why does the string type have a .ToString() method?
C#: why does the string type have a .ToString() method, Why does the string data type have a .ToString() method? <code> ,Why does the string type have a .ToString() method?
C#: is there way for a class to 'remove' methods that it has inherited, Is there way for a class to 'remove' methods that it has inherited?E.g. if I don't want my class to have a ToString() method can I do something so that it is no longer available? <code> ,Is there way for a class to 'remove' methods that it has inherited?
SqlCommand.Paramaters.AddWithValue issue," I have a problem with the folowwing piece of code. I am passing a parameter (List<SqlParameter>) to a method executing the following code.When it executes SQL Server throws an error saying that the proc expects a parameter that was not provided. I know this error and understand it, and when stepping through the code I can see that the cmdExecuteReader object has a collection of parameters with the correct name and value. What could be the problem? <code>  public SqlDataReader ExecuteReader(string storedProcedure, List<SqlParameter> parameters = null) { SqlCommand cmdExecuteReader = new SqlCommand() { CommandType = System.Data.CommandType.Text, Connection = conn, CommandText = storedProcedure }; if (parameters != null) { foreach (SqlParameter param in parameters) { cmdExecuteReader.Parameters.AddWithValue(param.ParameterName, param.Value); } } if (conn.State == System.Data.ConnectionState.Closed) conn.Open(); return cmdExecuteReader.ExecuteReader(); }","SqlCommand.Parameters.AddWithValue issue: Procedure or function X expects parameter @Y, which was not supplied"
SqlCommand.Parameters.AddWithValue issue," I have a problem with the folowwing piece of code. I am passing a parameter (List<SqlParameter>) to a method executing the following code.When it executes SQL Server throws an error saying that the proc expects a parameter that was not provided. I know this error and understand it, and when stepping through the code I can see that the cmdExecuteReader object has a collection of parameters with the correct name and value. What could be the problem? <code>  public SqlDataReader ExecuteReader(string storedProcedure, List<SqlParameter> parameters = null) { SqlCommand cmdExecuteReader = new SqlCommand() { CommandType = System.Data.CommandType.Text, Connection = conn, CommandText = storedProcedure }; if (parameters != null) { foreach (SqlParameter param in parameters) { cmdExecuteReader.Parameters.AddWithValue(param.ParameterName, param.Value); } } if (conn.State == System.Data.ConnectionState.Closed) conn.Open(); return cmdExecuteReader.ExecuteReader(); }","SqlCommand.Parameters.AddWithValue issue: Procedure or function X expects parameter @Y, which was not supplied"
Resharper Warnings with MVVM," As I implement the MVVM pattern with WPF, I'm finding that ReSharper is often warning me that certain properties are never used in my ViewModels. The problem is that they are being used, but only by the data binding system. Has anyone else encountered this annoyance and is there a way to help ReSharper realize that these properties are, indeed, being used? I am glad, at least, that VS 2010 properly realizes that [Import] tagged members won't ""always be null"", but hopefully I can fix this issue as well. <code> ",ReSharper warnings with MVVM
How do I open a web browser from C#?  Process.Start() isn't working?," I have a URL and I want to launch it in the default browser. I've tried two methods: ... and the one detailed in this other question using ShellExecute.In both cases I get the error: Windows cannot find 'http://stackoverflow.com'. Make sure you typed the name correctly, and then try again.It shouldn't be trying to open it as a file though... from what I understand, it should recognize it as a URL and open it in the default browser. What am I missing?By the way: OS = Vista, and .NET = 3.5EDIT:According to this MS KB article, since Process.Start sets the UseShellExecute by default, it should launch the default browser.EDIT:Here's what does work: Unfortunately that really doesn't launch the default browser, and it also doesn't work if IE isn't installed in the ""normal"" place. I'm not sure what to do here.More information:OK, so the error I'm getting is error number -2147467259. Looking at Google for this, it appears that it's not very descriptive. It might be a file association error or something.The plot thickens:So I checked the registry key that's supposed to have my file association for http: Here's the value: That makes sense. I actually copied this string into a command prompt and replaced the %1 with http://stackoverflow.com and it worked and opened firefox. I just don't get why Process.Start isn't associating the URL with this command... <code>  Process.Start(""http://stackoverflow.com""); System.Diagnostics.Process.Start(@""C:\Program Files\Internet Explorer\IExplore.exe"", ""http://stackoverflow.com""); KEY_CLASSES_ROOT\http\shell\open\command\default ""C:\Program Files\Mozilla Firefox\firefox.exe"" -requestPending -osint -url ""%1""",How do I open a web browser from a .NET Program?  Process.Start() isn't working?
CS1685 Warning causes  a CS0433 error when targeting 3.5 in VS2010," I have a 2010 project that is targeting .NET v3.5. Inexplicably I can no longer build v3.5 projects. The project doesn't have ANY references added. It won't even let me add a reference to System.Core as it is added by the 'build system'. warning CS1685: The predefined type 'System.Func' is defined in multiple assemblies in the global alias; using definition from 'c:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorlib.dll' IFilter.cs(82,49): error CS0433: The type 'System.Func' exists in both 'c:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\v3.5\System.Core.dll' and 'c:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorlib.dll'Looks like something is grabbing onto 4.0 but I'm not quite sure how to fix it. Any one else run into this?Coworker had this same issue. It took a reinstall of Windows to correct the problemI've opened a bug on this one: https://connect.microsoft.com/VisualStudio/feedback/details/558245/warning-cs1685-when-compiling-a-v3-5-net-application-in-visual-studio-2010If the compiler is set to verbose I see this: FrameworkPathOverride = C:\Windows\Microsoft.NET\Framework\v4.0.30319which is defined as: Specifies the location of mscorlib.dll and microsoft.visualbasic.dll. This parameter is equivalent to the /sdkpath switch of the vbc.exe compiler.Some other interesting tidbits: I've created a new project all together and cannot build v3.5 at all. I can build 2.0, 3.0, 3.5 Client Profile, 4.0 and 4.0 Client Profile with no problem. VB.NET can build v3.5 but C# cannot. I've tried a reinstall of .NET 3.5, 4.0 and Visual Studio 2010 with no success. Visual Studio debug logs shown nothing interesting and Safe Mode does not work.Trying to avoid a Windows reinstall...EDIT: I've come to realize others are facing this issue as well. Link, Link, LinkReinstalled several times. Visual Studio uninstalls do not clean up after themselves. I've spun up a VM to develop on until I have a chance to reinstall my main OS. <code> ",Visual Studio 2010 Can no longer build .NET v3.5
Visual Studio 2010 Can no longer build .NET v3.5 ," I have a 2010 project that is targeting .NET v3.5. Inexplicably I can no longer build v3.5 projects. The project doesn't have ANY references added. It won't even let me add a reference to System.Core as it is added by the 'build system'. warning CS1685: The predefined type 'System.Func' is defined in multiple assemblies in the global alias; using definition from 'c:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorlib.dll' IFilter.cs(82,49): error CS0433: The type 'System.Func' exists in both 'c:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\v3.5\System.Core.dll' and 'c:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorlib.dll'Looks like something is grabbing onto 4.0 but I'm not quite sure how to fix it. Any one else run into this?Coworker had this same issue. It took a reinstall of Windows to correct the problemI've opened a bug on this one: https://connect.microsoft.com/VisualStudio/feedback/details/558245/warning-cs1685-when-compiling-a-v3-5-net-application-in-visual-studio-2010If the compiler is set to verbose I see this: FrameworkPathOverride = C:\Windows\Microsoft.NET\Framework\v4.0.30319which is defined as: Specifies the location of mscorlib.dll and microsoft.visualbasic.dll. This parameter is equivalent to the /sdkpath switch of the vbc.exe compiler.Some other interesting tidbits: I've created a new project all together and cannot build v3.5 at all. I can build 2.0, 3.0, 3.5 Client Profile, 4.0 and 4.0 Client Profile with no problem. VB.NET can build v3.5 but C# cannot. I've tried a reinstall of .NET 3.5, 4.0 and Visual Studio 2010 with no success. Visual Studio debug logs shown nothing interesting and Safe Mode does not work.Trying to avoid a Windows reinstall...EDIT: I've come to realize others are facing this issue as well. Link, Link, LinkReinstalled several times. Visual Studio uninstalls do not clean up after themselves. I've spun up a VM to develop on until I have a chance to reinstall my main OS. <code> ",Visual Studio 2010 Can no longer build .NET v3.5
C# app running as either Windows Form or as Console Application," I am looking to have one of my Windows Forms applications be run programmaticallyfrom the command line. In preparation, I have separated the logic in its own class from the Form. Now I am stuck trying to get the application to switch back and forth based on the presence of command line arguments.Here is the code for the main class: where Form1 is my form and the It works! string is just a placeholder for the actual logic.Right now, when running this from within Visual Studio (with command line arguments), the phrase It works! is printed to the Output. However, when running the /bin/Debug/Program.exe file (or /Release for that matter) the application crashes.Am I going about this the right way? Would it make more sense (i.e. take less developer time) to have my logic class be a DLL that gets loaded by two separate applications? Or is there something entirely different that I'm not aware of?Thanks in advance! <code>  static class Program{ /// <summary> /// The main entry point for the application. /// </summary> [STAThread] static void Main() { string[] args = Environment.GetCommandLineArgs(); if (args.Length > 1) // gets passed its path, by default { CommandLineWork(args); return; } Application.EnableVisualStyles(); Application.SetCompatibleTextRenderingDefault(false); Application.Run(new Form1()); } private static void CommandLineWork(string[] args) { Console.WriteLine(""It works!""); Console.ReadLine(); }",.NET app running as either Windows Form or as Console Application
combobox value string to int," I have a question about converting types. I want to change the currently selected combobox value string to an int, but I get errorsMy code: What can I do for this problem? <code>  int.Parse(age.SelectedItem.ToString());",Convert combobox string value to int
How do I configure StructureMap to use a generic repository?," I have an interface IGenericRepository<TEntity> where TEntity : IEntity and an implementation GenericRepository<TEntity> where TEntity : Entity.I'm trying to inject a specific IGenericRepository<Section> into a class using StructureMap: But when I try to use ObjectFactory.GetInstance<IGenericRepository<Section>>(); I get:StructureMap Exception Code: 202 No Default Instance defined for PluginFamily System.Data.Common.DbConnectionAny ideas why this is or what I'm doing wrong?Thanks in advance,Simon <code>  ObjectFactory.Initialize(x => { x.For(typeof(IGenericRepository<>)).Use(typeof(GenericRepository<>)); });", How do I configure StructureMap to use a generic repository?
Programatically building an MSI," I would like to create a C# program that creates an MSI based on a number of parameters. For example, based on user settings, certain files would be included, or runtime parameters set.Can anyone point me towards any documentation that might help, or give me an idea where I might start with something like this? <code> ",Programmatically building an MSI
ConcurrentDictionary and updating values," I am trying to update entries in a ConcurrentDictionary something like this: Essentially I need to iterate over the dictionary and update a field on each Value. I understand from the documentation that I need to avoid using the Value property. Instead I think I need to use TryUpdate except that I dont want to replace my whole object. Instead, I want to update a field on the object.After reading this blog entry on the PFX team blog: Perhaps I need to use AddOrUpdate and simply do nothing in the add delegate.Does anyone have any insight as to how to do this?I have tens of thousands of objects in the dictionary which I need to update every thirty seconds or so. Creating new ones in order to update the property is probably not feasible. I would need to clone the existing object, update it and replace the one in the dictionary. Id also need to lock it for the duration of the clone/add cycle. Yuck.What Id like to do is iterate over the objects and update the Counter property directly if possible.My latest research has led me to to Parallel.ForEach which sounds great but it is not supposed to be used for actions that update state.I also saw mention of Interlocked.Increment which sounds great but I still need to figure out how to use it on each element in my dictionary in a thread safe way. <code>  class Class1{ public int Counter { get; set; }}class Test{ private ConcurrentDictionary<int, Class1> dict = new ConcurrentDictionary<int, Class1>(); public void TestIt() { foreach (var foo in dict) { foo.Value.Counter = foo.Value.Counter + 1; // Simplified example } }}",Updating fields of values in a ConcurrentDictionary
indicate tuncation in ToolTipStatusLabel automatically," I have a .NET application with a StatusStrip holding three ToolTipStatusLabels. The Text of the labels are filled from the application as they show the status. For some circumstances they can hold an empty text.When I resize the window, the ToolTipStatusLabels are hidden when they cannot be fit in the StatusStrip. I would like to have the text truncated when the label cannot be fit in the StatusStrip. The default behavior to hide the label makes it difficult to distinguish between empty text or hidden label.To indicate that the text is truncated automatically, this should be indicated with an ellipsis (...). How can this be done? <code> ",indicate truncation in ToolTipStatusLabel automatically
"Why are some CLR languages called ""visual""? (Visual C#, Visual Basic .NET, Visual C++)"," I understand visual programming languages to be those languages that allow the programmer to to manipulate graphical--rather than textual--objects onscreen to build functionality.The closest thing I see in C#, VB, etc. is RAD controls, but that is just composing UI and the very simplest functionality -- it has nothing to do with the language itself, even.Why, then is C# called ""Visual C#"", Basic .NET called ""Visual Basic .NET,"" etc.?What is ""visual,"" or what is the rationale or history behind the nomenclature? <code> ","Why are some Microsoft languages called ""visual""? (Visual C#, Visual Basic .NET, Visual C++)"
LINQ and set difference," I have two collections a and b. I would like to compute the set of items in either a or b, but not in both (a logical exclusive or). With LINQ, I can come up with this: I wonder if there are other more efficient or more compact ways of producing the difference between the two collections.Edit 1: Jon Skeet posted a first solution which does not preserve the order of the items by relying on a HashSet. I wonder if there are other approaches which would preserve the order of a and b in the output. <code>  IEnumerable<T> Delta<T>(IEnumerable<T> a, IEnumerable<T> b){ return a.Except (b).Union (b.Except (a));}",Finding symmetric difference with LINQ
C# - Pass by value & Pass by Reference," Could you please explain the following behavior of C# Class. I expect the classResult as ""Class Lijo""; but actual value is Changed.Were making a copy of the reference. Though the copy is pointing to the same address, the method receiving the argument cannot change original. Still why the value gets changed ? Update: When I pass a String, it does not get actually changed. <code>  public partial class _Default : Page { protected void Page_Load(object sender, EventArgs e) { String nameString = ""string Lijo""; Person p = new Person(); p.Name = ""Class Lijo""; Utilityclass.TestMethod(nameString, p); string classResult = p.Name; Response.Write(nameString + ""....."" + classResult); }}public class Utilityclass{ public static void TestMethod(String nameString, Person k) { nameString = ""Changed""; k.Name = ""Changed""; }}public class Person{ public string Name { get; set; }}",lPass by value & Pass by Reference
How to Get a Specific Column Value from a DataTable? - C#.NET Winforms," I have a datatable. I need to fetch a certain column value based on the user input. For example, lets say the datatable has two columns CountryID and CountryName.I need to find CountryID in the datatable based on the user input country name. I could just open a connection with DB and run the query select countryID from Country where countryName = @userinput. Is there anyway i could do this on the datatable. <code> ",How to Get a Specific Column Value from a DataTable?
What is the difference between AutomationID and AutomationProperty.Name?, What is the difference between the two properties?In what context is which property used?Can you also provide a code example for each? <code> ,What is the difference between AutomationProperties.AutomationID and AutomationProperties.Name?
What is the difference between AutomationID and AutomationProperties.Name?, What is the difference between the two properties?In what context is which property used?Can you also provide a code example for each? <code> ,What is the difference between AutomationProperties.AutomationID and AutomationProperties.Name?
IronRuby as scripting language in .net," I want to use IronRuby as a scripting language (as Lua, for example) in my .NET project.For example, I want to be able to subscribe from a Ruby script to specific events, fired in the host application, and call Ruby methods from it.I'm using this code for instantiating the IronRuby engine: Supposing index.rb contains: How do I:Make C# method Subscribe (defined in host application) visible from index.rb?Invoke later handler method from the host application? <code>  Dim engine = Ruby.CreateEngine()Dim source = engine.CreateScriptSourceFromFile(""index.rb"").Compile()' Execute itsource.Execute() subscribe(""ButtonClick"", handler)def handler puts ""Hello there""end",IronRuby as a scripting language in .NET
Is there a way to make a console window flash in the task bar programatically, Basically I made console app that performs some task that takes a few minutes. I'd like to have it flash in the taskbar to let me know when it's done doing its thing. <code> ,Is there a way to make a console window flash in the task bar programmatically
Static constructor can run after the non-static constructor.  Is this a compiler bug?," The output from the following program is: Is this a compiler bug? I expected: because I thought the static constructor was ALWAYS called before the non-static constructor.I tested this with Visual Studio 2010 using both .net 3.5 and .net 4.0. <code>  Non-StaticStaticNon-Static StaticNon-StaticNon-Static using System;using System.Collections.Generic;using System.Linq;using System.Text;namespace StaticConstructorBug{ class Program { static void Main(string[] args) { var mc = new MyClass(); Console.ReadKey(); } } public class MyClass { public MyClass() { Console.WriteLine(""Non-static""); } static MyClass() { Console.WriteLine(""Static""); } public static MyClass aVar = new MyClass(); }}",Static constructor can run after the non-static constructor. Is this a compiler bug?
.net sources to download, Where can I download source code for the .NET Framework? I mean sources of libraries. I need the source for reflection methods like invoke and other. <code> ,Where can I find .NET sources to download?
.NET sources to download, Where can I download source code for the .NET Framework? I mean sources of libraries. I need the source for reflection methods like invoke and other. <code> ,Where can I find .NET sources to download?
Get the file path of the current app," The reason I asked this question is that I wanted to create a helper class for Remoting instantiation, and wanted to pass the appropriate app.exe.config (or web.config) file path to the RemotingConfiguration.Configure method, depending on the caller.Is there a way I could get the name of the config file for both Win and Web apps without checking if the application is Web or WinForms? <code> ",Get the file path of current application's config file
Determine the relative compliment of two IEnumerable<T> sets in .net, Is there an easy way to get the relative complement of two sets? Perhaps using LINQ?I have to find the relative compliment of a set A relative to B. Both A and B are of type HashSet<T> but I think the algorithm could be made more general (IEnumerable<T> or even ISet<T>)?I could use a solution in either VB.NET or C#. <code> ,Determine the relative complement of two IEnumerable<T> sets in .NET
Multiline Text as the  button label - WIndows Forms," Basically, I am creating a button in an oval shape. But my button label is too long to display in one line, so I wanted to split it into multiple lines so that the oval button looks good.How do I enable word wrap on a button? <code> ",Multiline text as the button label in Windows Forms
Which is clearer form: if(!value) or if(flag == value)  ?," I understand this is a subjective question, so I apologize if it needs to be closed, but I feel like it comes up often enough for me to wonder if there is a general preference for one form over the other.Obviously, the best answer is ""refactor the code so you don't need to test for falsehood"" but sometimes there's no easy way to do so and the ""else"" branch is simply to continue processing. So when you must have an ""if not false"" construct, which is the preferred standard:The not operator Or the test for false <code>  if (!value) if (value == false)",Which is clearer form: if(!value) or if(flag == value)?
Thread safe collections in C#," What is the standard nowadays when one needs a thread safe collection (e.g. Set).Do I synchronize it myself, or is there an inherently thread safe collection? <code> ",Thread safe collections in .NET
Check if the file is Open, Is there a way to find if a file is already open or not? <code> ,Check if a file is open
What is the use of #if in C# .NET ?, I need to know the usage of #if in C#...Thanks.. <code> ,What is the use of #if in C#?
C# Dictionary: How to delete entries from a dictionary using the value," I have a dictionary collection as bleow: From the above dictionary I want to delete all the entries where value == ""val1"", so that the result would have only following entry: My VB source code is on VS2008 and targeted for 3.5 <code>  mydic.addvalue(key1, val1)mydic.addvalue(key2, val1)mydic.addvalue(key3, val1)mydic.addvalue(key4, val2)mydic.addvalue(key5, val2) mydic.addvalue(key4, val2)mydic.addvalue(key5, val2)",How to delete entries from a dictionary using the value
"dynamic, How to test if a property is available"," My situation is very simple. Somewhere in my code I have this: So, basically my question is how to check (without throwing an exception) that a certain property is available on my dynamic variable. I could do GetType() but I'd rather avoid that since I don't really need to know the type of the object. All that I really want to know is whether a property (or method, if that makes life easier) is available. Any pointers? <code>  dynamic myVariable = GetDataThatLooksVerySimilarButNotTheSame();//How to do this?if (myVariable.MyProperty.Exists) //Do stuff",Test if a property is available on a dynamic variable
Why does C# allow abstract class with no abstract members?," The C# spec, section 10.1.1.1, states: An abstract class is permitted (but not required) to contain abstract members.This allows me to create classes like this: Or even better: This is really a concrete class; it's only abstract in so far as one can't instantiate it. For example, if I wanted to execute the logic in B.Main() I would have to first get an instance of B, which is impossible. If inheritors don't actually have to provide implementation, then why call it abstract?Put another way, why does C# allow an abstract class with only concrete members? I should mention that I am already familiar with the intended functionality of abstract types and members.  <code>  public abstract class A{ public void Main() { // it's full of logic! }} public abstract class A{ public virtual void Main() { }}public abstract class B : A{ public override sealed void Main() { // it's full of logic! }}",Why does C# allow for an abstract class with no abstract members?
How to stop C# compile on first error in VS 2010?, New information: This question has been re-asked here and has been correctly answered by Noah Richards with a solution that works in VS 2010.At work we have a C# solution with over 80 projects. Is it possible in VS 2010 to automatically stop compilation as soon as an error is encountered rather than the default behaviour which is to continue as far as possible and display a list of errors in the error window? I'm happy for it to stop either as soon as an error is encountered (file-level) or as soon as a project fails to build (project-level).I'd also note that in VS 2008 we used macros similar to some of the answers below but they don't work in VS 2010 (at least I couldn't get them to as the environment events don't seem to fire in VS 2010). Also Somewhat Related: How to automatically stop Visual C++ build at first compile error?  <code> ,How to stop C# compile on first error in VS 2010 (VS 2008 macros don't work)!
Set A Transparent Color," I have a Color, and I have a method that should return a more ""transparent"" version of that color. I tried the following method: but for some reason, no matter what the A is, the returned Color's transparency level just won't change. Any idea? <code>  public static Color SetTransparency(int A, Color color){ return Color.FromArgb(A, color.R, color.G, color.B);}",Set a transparent color
How could i add event handler for ListView Items_added in C# Windows Form Application ?, In C# Windows Form Application; Is there an event handler for the ListView control that is fired when items are added to the listview items ? <code> ,Add event handler for ListView Items_added
"How to resolve Resharper's ""unused property"" warning on properties solely for Display/Value Members?"," I have defined two properties, ""Name"" and ""ID"", for an object which I use for the DisplayMember and ValueMember of a ComboBox with a BindingList datasource.I recently installed ReSharper to evaluate it. ReSharper is giving me warnings on the object that the two properties are unused.Sample code: Am I doing something wrong or is ReSharper clueless about this particular usage? <code>  BindingList<ClassSample> SampleList = new BindingList<ClassSample>();// populate SampleListcmbSampleSelector.DisplayMember = ""Name"";cmdSampleSelector.ValueMember = ""ID"";cmbSampleSelector.DataSource = SampleList;private class ClassSample{ private string _name; private string _id; public string Name // ReSharper believes this property is unused { get { return _name; } } public string ID // ReSharper believes this property is unused { get {return _id; } } public ClassSample(string Name, string ID) { _name = Name; _id = ID; }}","How to resolve ReSharper's ""unused property"" warning on properties solely for Display/Value Members?"
Purpose Of Monitor.pulse(thread), I just want to make sure I understand something here. If I obtain a lock with Monitor.Enter or lock do I need to call Pulse before releasing the lock? I was always led to believe that a Monitor.Exit call would implicitly invoke Monitor.Pulse. Is that actually true?I'm not exactly sure when would you would use Pulse. That is what is causing confusion. <code>  Monitor.EnterMonitor.Pulse // Is that neccessary?Monitor.Exit,Purpose Of Monitor.Pulse
Task Parallel Library; TaskCreationOptions.LongRunning option and ThreadPool," TPL uses Task Schedulers to coordinate tasks. According to official document, default task scheduler uses Thread Pool, but if TaskCreationOptions.LongRunning option is presented then it will create a dedicated thread for that task (A).Question: As of now MSDN documents for Visual Studio 2010 are not ready and current online MSDN is not finalized; does anyone knows if (A) is true or false? <code> ",TaskCreationOptions.LongRunning option and ThreadPool
Why is the explicit management of threads a bad thing.," In a previous question, I made a bit of a faux pas. You see, I'd been reading about threads and had got the impression that they were the tastiest things since kiwi jello.Imagine my confusion then, when I read stuff like this: [T]hreads are A Very Bad Thing. Or, at least, explicit management of threads is a bad thingand Updating the UI across threads is usually a sign that you are abusing threads.Since I kill a puppy every time something confuses me, consider this your chance get your karma back in the black...How should I be using thread? <code> ",Why is the explicit management of threads a bad thing?
Dependency Propetry WPF," I have been reading about dependency properties in several books but all have one thing in common, they just tell us how they are implemented( using static readonly DependencyProperty etc.) but does not tell the exact way they work from inside. I mean they are implemented as static but still applies to all objects.Second point of confusion is attached properties. Is there any tutorial available that can explain all these concepts in an easy way? <code> ",What's the framework mechanism behind dependency properties?
Dependency Property WPF," I have been reading about dependency properties in several books but all have one thing in common, they just tell us how they are implemented( using static readonly DependencyProperty etc.) but does not tell the exact way they work from inside. I mean they are implemented as static but still applies to all objects.Second point of confusion is attached properties. Is there any tutorial available that can explain all these concepts in an easy way? <code> ",What's the framework mechanism behind dependency properties?
why do we need the new keyword and why is the default behavior to hide and not override?," I was looking at this blog post and had following questions:Why do we need the new keyword, is it just to specify that a base class method is being hidden. I mean, why do we need it? If we don't use the override keyword, aren't we hiding the base class method?Why is the default in C# to hide and not override? Why have the designers implemented it this way? <code> ",Why do we need the new keyword and why is the default behavior to hide and not override?
Possible to launch a process in a user's session from a service?," In Windows Vista/7/2008/2008R2, is it at all possible to launch a process in a user's session from a service? Specifically, the local session would be most useful.Everything I've been reading seems to say this isn't possible, but I figured I'd ask here before giving up completely.I'm coding in VB.NET, but will take suggestions in anything. <code> ",Launching a process in users session from a service
Launching process in users session from service," In Windows Vista/7/2008/2008R2, is it at all possible to launch a process in a user's session from a service? Specifically, the local session would be most useful.Everything I've been reading seems to say this isn't possible, but I figured I'd ask here before giving up completely.I'm coding in VB.NET, but will take suggestions in anything. <code> ",Launching a process in users session from a service
naming convention - underscore in C++/C# variables, It's common to see a _var variable name in a class field. What does the underscore mean? Is there a reference for all these special naming conventions? <code> ,Naming convention - underscore in C++ and C# variables
Why is String.Equals implemented this way?," Occasionally I like to spend some time looking at the .NET code just to see how things are implemented behind the scenes. I stumbled upon this gem while looking at the String.Equals method via Reflector.C# IL What is the reasoning for checking this against null? I have to assume there is purpose otherwise this probably would have been caught and removed by now. <code>  [ReliabilityContract(Consistency.WillNotCorruptState, Cer.MayFail)]public override bool Equals(object obj){ string strB = obj as string; if ((strB == null) && (this != null)) { return false; } return EqualsHelper(this, strB);} .method public hidebysig virtual instance bool Equals(object obj) cil managed{ .custom instance void System.Runtime.ConstrainedExecution.ReliabilityContractAttribute::.ctor(valuetype System.Runtime.ConstrainedExecution.Consistency, valuetype System.Runtime.ConstrainedExecution.Cer) = { int32(3) int32(1) } .maxstack 2 .locals init ( [0] string str) L_0000: ldarg.1 L_0001: isinst string L_0006: stloc.0 L_0007: ldloc.0 L_0008: brtrue.s L_000f L_000a: ldarg.0 L_000b: brfalse.s L_000f L_000d: ldc.i4.0 L_000e: ret L_000f: ldarg.0 L_0010: ldloc.0 L_0011: call bool System.String::EqualsHelper(string, string) L_0016: ret }",Why check this != null?
Are nullable reference types., When I declare an int as nullable Does i here become a reference type? <code>  int? i=null;,Are nullable types reference types?
Log the Number of Hits of a File in an ASP Site," Is there a way to inherently/manually log the number of times a specific file is accessed in an ASP site. For instance, I've got a few .mp3 files I have on my server and I would like to know how many times each file has been visited.What's the best way to track this? <code> ",Track File Download hits/count in ASP.Net
Which static class initialize first ? ," Which static class initializes first if we have one more static classes in our project?For example: Below code gives null exception. If you pay attention, you will see that if First class will initialize itself so secondArray field of Second would be null. But if Second class would initialize first so Second class firstArray would be null. I am trying to tell that which initialize first makes different results.I think that it is abstract question about my project. I encounter it while trying to understand why I am getting unexpected results. <code>  class Program { static void Main(string[] args) { First.Write(); Second.Write(); } } static class First { public static int[] firstArray = new int[20]; public static int[] secondArray = Second.secondArray; public static void Write() { Console.WriteLine(firstArray.ToString()); Console.WriteLine(secondArray.ToString()); } } static class Second { public static int[] firstArray = First.firstArray; public static int[] secondArray = new int[30]; public static void Write() { Console.WriteLine(firstArray.ToString()); Console.WriteLine(secondArray.ToString()); } }",Which static class initializes first?
Which static class initialize first ?," Which static class initializes first if we have one more static classes in our project?For example: Below code gives null exception. If you pay attention, you will see that if First class will initialize itself so secondArray field of Second would be null. But if Second class would initialize first so Second class firstArray would be null. I am trying to tell that which initialize first makes different results.I think that it is abstract question about my project. I encounter it while trying to understand why I am getting unexpected results. <code>  class Program { static void Main(string[] args) { First.Write(); Second.Write(); } } static class First { public static int[] firstArray = new int[20]; public static int[] secondArray = Second.secondArray; public static void Write() { Console.WriteLine(firstArray.ToString()); Console.WriteLine(secondArray.ToString()); } } static class Second { public static int[] firstArray = First.firstArray; public static int[] secondArray = new int[30]; public static void Write() { Console.WriteLine(firstArray.ToString()); Console.WriteLine(secondArray.ToString()); } }",Which static class initializes first?
Local constants naming: UpperCamelCase or lower?," Which naming convention do you use for local constants in C# and why? It seems the trade-off is between lower camel-case indicating restricted scope, and upper camel-case being more readable and easier to move to a class level. I've noticed StyleCop prefers upper camel-case. <code>  const int Pi = 3;const int pi = 3;",Naming local constants: UpperCamelCase or lowerCamelCase?
c# Combobox:How do i set the height of combobox," I have a ComboBox on a form, and its default height is 21. How do I change it? <code> ",How do I set the height of a ComboBox?
ComboBox:How do i set the height of ComboBox?," I have a ComboBox on a form, and its default height is 21. How do I change it? <code> ",How do I set the height of a ComboBox?
Sort a Custom Class List<>," I would like to sort my list with the date property.This is my custom class: An this is the List that I want to sort: I want to sort the List by the date property of the cTag class.The date is in the format dd.MM.yyyy.I read something about the IComparable interface, but I don't know how to use it. <code>  using System;using System.Collections.Generic;using System.Linq;using System.Web;namespace Test.Web{ public class cTag { public int id { get; set; } public int regnumber { get; set; } public string date { get; set; } }} List<cTag> Week = new List<cTag>();",Sort a Custom Class List<T>
C#: using the iterator variable of foreach loop in a lambda expression - why fails?," Consider the following code: After calling myClass.Execute(), the code prints the following unexpected response: Obviously, I would expect ""Hi String"", ""Hi Single"", ""Hi Int32"", but apparently it is not the case. Why the last element of the iterated array is being used in all the 3 methods instead of the appropriate one? How would you rewrite the code to achieve the desired goal?  <code>  public class MyClass{ public delegate string PrintHelloType(string greeting); public void Execute() { Type[] types = new Type[] { typeof(string), typeof(float), typeof(int)}; List<PrintHelloType> helloMethods = new List<PrintHelloType>(); foreach (var type in types) { var sayHello = new PrintHelloType(greeting => SayGreetingToType(type, greeting)); helloMethods.Add(sayHello); } foreach (var helloMethod in helloMethods) { Console.WriteLine(helloMethod(""Hi"")); } } public string SayGreetingToType(Type type, string greetingText) { return greetingText + "" "" + type.Name; }...} Hi Int32Hi Int32Hi Int32 ",Using the iterator variable of foreach loop in a lambda expression - why fails?
IsNullOrEmptyOrWhiteSpace problem in csharp, I define a string and check it by string.IsNullOrEmptyOrWhiteSpace().But I got this error: 'string' does not contain a definition for 'IsNullOrEmptyOrWhiteSpace' and no extension method 'IsNullOrEmptyOrWhiteSpace' accepting a first argument of type 'string' could be found (are you missing a using directive or an assembly reference?) D:\project\project\Controllers\aController.cs 23 24 projectWhat is the reason? <code> ,IsNullOrEmptyOrWhiteSpace method missing
IsNullOrEmptyOrWhiteSpace problem in C#, I define a string and check it by string.IsNullOrEmptyOrWhiteSpace().But I got this error: 'string' does not contain a definition for 'IsNullOrEmptyOrWhiteSpace' and no extension method 'IsNullOrEmptyOrWhiteSpace' accepting a first argument of type 'string' could be found (are you missing a using directive or an assembly reference?) D:\project\project\Controllers\aController.cs 23 24 projectWhat is the reason? <code> ,IsNullOrEmptyOrWhiteSpace method missing
How do I determine if System.Type is a custome type or a Framework type?, I want to distinctly determine if the type that I have is of custom class type (MyClass) or one provided by the Framework (System.String). Is there any way in reflection that I can distinguish my class type from system.string or other Framework provided types? <code> ,How do I determine if System.Type is a custom type or a Framework type?
Why is ComputeHash not acting deterministicly?," I've run into an interesting issue.. It seems that ComputeHash() for a ""HMACSHA256"" hash is not behaving deterministically.. if I create two instances of HashAlgorithm using HashAlgorithm.Create(""HMACSHA256"").. And run ComputeHash, I get two different results.. below is an example static class that exhibiting this behavior. I've also tried to make the call non static (actually it started non static, and I have double and triple and quadrudruple checked my input array.. its absolutely the same on each call.. I've even done stuff in the immidiate window like : And running that twice in the immidiates window via a breakpoint in the method returns two different hashes.. I know Hash is suppose to be deterministic.. So what gives? is something going on with running in a debugger? Or any other ideas? really this is just two weird for words right now :-P.. ThanksJosh <code>  internal static string HashPassword(byte[] bAll){ using (HashAlgorithm s = HashAlgorithm.Create(""HMACSHA256"")) { return Convert.ToBase64String(s.ComputeHash(bAll)); }} Convert.ToBase64String(HashAlgorithm.Create(""HMACSHA256"").ComputeHash(bAll)",Why is ComputeHash not acting deterministically?
EF : DeleteObject() in foreach loop," With Entity Framework, I try to delete some objects from my object context like that : With this code, I have a ""Collection Was Modified"" Exception.So, how can I do a batch delete ? <code>  foreach (var item in context.Items.Where( i => i.Value > 50 ) ){ context.Items.DeleteObject(item);}",DeleteObject() in foreach loop
Detect when a directory changes," Other than reading all the files and comparing them with a previous snapshot, is there a way to detect when a directory changes in C# with Windows? I don't mind PInvoke if that's what it takes.EDIT The FileSystemWatcher class is great, but one gotcha is that you must kick off any work in the callback notification to a background task/thread to avoid blocking which will cause dropped events. <code> ",How do I detect when a directory or file changes without constant scanning
Detect when a directory or file changes," Other than reading all the files and comparing them with a previous snapshot, is there a way to detect when a directory changes in C# with Windows? I don't mind PInvoke if that's what it takes.EDIT The FileSystemWatcher class is great, but one gotcha is that you must kick off any work in the callback notification to a background task/thread to avoid blocking which will cause dropped events. <code> ",How do I detect when a directory or file changes without constant scanning
how to rename file name in C# code ?, How do I rename a file using C#? <code> ,Rename a file in C#
How to rename a file in C# code?, How do I rename a file using C#? <code> ,Rename a file in C#
How do I rename a file using C# code?, How do I rename a file using C#? <code> ,Rename a file in C#
Efficient algorithm to get primes in larg numbers.," I'm a beginner in C#, I'm trying to write an application to get primes between two numbers entered by the user. The problem is: At large numbers (valid numbers are in the range from 1 to 1000000000) getting the primes takes long time and according to the problem I'm solving, the whole operation must be carried out in a small time interval. This is the problem link for more explanation:SPOJ-PrimeAnd here's the part of my code that's responsible of getting primes: Is there any faster algorithm? Thanks in advance. <code>  public void GetPrime() { int L1 = int.Parse(Limits[0]); int L2 = int.Parse(Limits[1]); if (L1 == 1) { L1++; } for (int i = L1; i <= L2; i++) { for (int k = L1; k <= L2; k++) { if (i == k) { continue; } else if (i % k == 0) { flag = false; break; } else { flag = true; } } if (flag) { Console.WriteLine(i); } } }",Efficient algorithm to get primes between two large numbers
Efficient algorithm to get primes in large numbers.," I'm a beginner in C#, I'm trying to write an application to get primes between two numbers entered by the user. The problem is: At large numbers (valid numbers are in the range from 1 to 1000000000) getting the primes takes long time and according to the problem I'm solving, the whole operation must be carried out in a small time interval. This is the problem link for more explanation:SPOJ-PrimeAnd here's the part of my code that's responsible of getting primes: Is there any faster algorithm? Thanks in advance. <code>  public void GetPrime() { int L1 = int.Parse(Limits[0]); int L2 = int.Parse(Limits[1]); if (L1 == 1) { L1++; } for (int i = L1; i <= L2; i++) { for (int k = L1; k <= L2; k++) { if (i == k) { continue; } else if (i % k == 0) { flag = false; break; } else { flag = true; } } if (flag) { Console.WriteLine(i); } } }",Efficient algorithm to get primes between two large numbers
Getting all DateTimes between two DateTime in c#," I have two DateTimes, and I want to get all DateTimes between these Dates. Such as, if my Dates are like 01.01.2010 - 05.01.2010, my function should return me a list of date (List), and it must contain 01.01.2010, 02.01.2010, 03.01.2010, 04.01.2010, and 05.01.2010.I wrote a function like this. It works fine, if my dates are in a month. It won't work if my dates are like 01.01.2010 - 05.02.2010. Because the month changed, and my function can't handle it. Is there a function in C# that returns all dates between two dates? Or how can I handle month change? Question solved, see Tim Robinson's simple answer to use. <code>  public void GetAllDatesAndInitializeTickets(DateTime startingDate, DateTime endingDate) { List<DateTime> allDates = new List<DateTime>(); int starting = startingDate.Day; int ending = endingDate.Day; for (int i = starting; i <= ending; i++) { allDates.Add(new DateTime(startingDate.Year, startingDate.Month, i)); }",Getting all DateTimes between two 'DateTime's in C#
Copying a file to a specific directory during setup wizard, I have a file - say readme.txt that I want to copy or insert to a directory say C:\Documents and Settings\fooUsername\Application Data\BarSoftwareduring the installation of my program using Visual Studio's setup project - I know it is something to do with File System Editor but not exactly sure as it has been some time since I have done this type of thing. <code> ,Copying a file to a specific directory during installation using Visual Studio Setup Project
How to make a control that can have controls inside?," I want to create a control just like a Panel.I want my control to accept some controls as childs without typing the template name, just like the Panel, as shown here: I have controls with content inside without telling what is the ITemplate.I basically want to convert this Into this Here is what I've got: The above works with <Content></Content> tags inside the control, but without it doesn't work. And the attribute isn't doing anything at all (I guess). What's missing?How can I achieve it? Any hints? Why does Panel support this? <code>  <asp:Panel runat=""server""> My content <div>Content</div></asp:Panel> <my:MyControl runat=""server""> <ContentTemplate> My content <div>Content</div> </ContentTemplate></my:MyControl> <my:MyControl runat=""server""> My content <div>Content</div></my:MyControl> public class MyControl : CompositeControl{ [TemplateInstance(TemplateInstance.Single)] public ITemplate Content { get; set; } protected override void CreateChildControls() { base.CreateChildControls(); Content.InstantiateIn(this); }}",How to make a control with children without declaring the template tag?
How to make a control render content in template without declaring template tag?," I want to create a control just like a Panel.I want my control to accept some controls as childs without typing the template name, just like the Panel, as shown here: I have controls with content inside without telling what is the ITemplate.I basically want to convert this Into this Here is what I've got: The above works with <Content></Content> tags inside the control, but without it doesn't work. And the attribute isn't doing anything at all (I guess). What's missing?How can I achieve it? Any hints? Why does Panel support this? <code>  <asp:Panel runat=""server""> My content <div>Content</div></asp:Panel> <my:MyControl runat=""server""> <ContentTemplate> My content <div>Content</div> </ContentTemplate></my:MyControl> <my:MyControl runat=""server""> My content <div>Content</div></my:MyControl> public class MyControl : CompositeControl{ [TemplateInstance(TemplateInstance.Single)] public ITemplate Content { get; set; } protected override void CreateChildControls() { base.CreateChildControls(); Content.InstantiateIn(this); }}",How to make a control with children without declaring the template tag?
Performance of .Net funcion calling (C# F#) VS C++," Since F# 2.0 has become a part of VS2010 I take an interest in F#. I wondered what's the point of using it. I'd read a bit and I made a benchmark to measure functions calling.I have used Ackermann's function :)C# C++ F# Java An then C# = 510ms c++ = 130ms F# = 185ms Java = Stackoverflow :) Is it the power of F# (except small amount of code) If we want to use .Net and gain a bit faster execution? Can I optimalize any of these codes (especially F#) ?UPDATE. I got rid off Console.WriteLine and run the C# code without the debugger: C# = 400ms <code>  sealed class Program{ public static int ackermann(int m, int n) { if (m == 0) return n + 1; if (m > 0 && n == 0) { return ackermann(m - 1, 1); } if (m > 0 && n > 0) { return ackermann(m - 1, ackermann(m, n - 1)); } return 0; } static void Main(string[] args) { Stopwatch stopWatch = new Stopwatch(); stopWatch.Start(); Console.WriteLine(""C# ackermann(3,10) = "" + Program.ackermann(3, 10)); stopWatch.Stop(); Console.WriteLine(""Time required for execution: "" + stopWatch.ElapsedMilliseconds + ""ms""); Console.ReadLine(); }} class Program{public:static inline int ackermann(int m, int n){ if(m == 0) return n + 1; if (m > 0 && n == 0) { return ackermann(m - 1, 1); } if (m > 0 && n > 0) { return ackermann(m - 1, ackermann(m, n - 1)); } return 0; }};int _tmain(int argc, _TCHAR* argv[]){ clock_t start, end; start = clock(); std::cout << ""CPP: ackermann(3,10) = "" << Program::ackermann(3, 10) << std::endl; end = clock(); std::cout << ""Time required for execution: "" << (end-start) << "" ms."" << ""\n\n""; int i; std::cin >> i; return 0;} // Ackermannlet rec ackermann m n = if m = 0 then n + 1 elif m > 0 && n = 0 then ackermann (m - 1) 1 elif m > 0 && n > 0 then ackermann (m - 1) (ackermann m (n - 1)) else 0open System.Diagnostics;let stopWatch = Stopwatch.StartNew()let x = ackermann 3 10 stopWatch.Stop();printfn ""F# ackermann(3,10) = %d"" xprintfn ""Time required for execution: %f"" stopWatch.Elapsed.TotalMilliseconds public class Main { public static int ackermann(int m, int n) { if (m==0) return n + 1;if (m>0 && n==0){ return ackermann(m - 1,1);}if (m>0 && n>0){ return ackermann(m - 1,ackermann(m,n - 1)); } return 0;} public static void main(String[] args) { System.out.println(Main.ackermann(3,10)); }}",Performance of .Net function calling (C# F#) VS C++
Value cannot be null. Parameter name: source," When using LINQ to get data from a list I encounter this error. How can this be fixed? Value cannot be null. Parameter name: source Error which i got after execution my LINQ I got that type of result (one line, orginally): System.Linq.Enumerable.WhereSelectListIterator<Roundsman.BAL.Sale, <>f__AnonymousType1<int,System.Collections.Generic.IEnumerable <<>f__AnonymousType0<Roundsman.BAL.Items.Item,System.Collections.Generic.IEnumerable <Roundsman.BAL.WeeklyRecord>>>>>  <code>  var nCounts = from sale in sal select new { SaleID = sale.OrderID, LineItem = from sli in sale.LineItems group sli by sli.Item into ItemGroup select new { Item = ItemGroup.Key, Weeks = ItemGroup.Select(s => s.Week) } };foreach (var item in nCounts){ foreach (var itmss in item.LineItem) { // MessageBox.Show(itmss.Item.Name); itemsal.Add(new Roundsman.BAL.WeeklyStockList(itmss.Item.Name.ToString(), itmss.Item.Code.ToString(), itmss.Item.Description.ToString(), Convert.ToInt32(itmss.Item.Quantity), 2, 2, 2, 2, 2, 2, 2, 2, 2)); } }","Using LINQ to find item in a List but get ""Value cannot be null. Parameter name: source"""
How to find multiple occurances with regex groups?," Why does the following code result in: there was 1 matches for 'the'and not: there was 3 matches for 'the' <code>  using System;using System.Text.RegularExpressions;namespace TestRegex82723223{ class Program { static void Main(string[] args) { string text = ""C# is the best language there is in the world.""; string search = ""the""; Match match = Regex.Match(text, search); Console.WriteLine(""there was {0} matches for '{1}'"", match.Groups.Count, match.Value); Console.ReadLine(); } }}",How to find multiple occurrences with regex groups?
"how to invoke an event after losing focus from a textbox, asp.net mvc"," I have two text boxes: A and B using Html.textboxfor. TextBox 'A' is enabled and TextBox 'B' is disabled.When I type values in Textbox 'A' and change focus away from the textbox, TextBox 'B' should be populated with some value.For example: I am entering the value of TextBox A = ""King""; if the focus is lost from the box, the value in the Textbox B should be ""Peter"", which should be filled automatically. <code> ",How to invoke an event after losing focus from a textbox that was just filled out?
shell script using curl to c#," The IBM RTC RESTful api gives an example of a shell script for authenticating with the server: This works perfectly, however i need to authenticate with the server using c#.So far i have the following, but it isn't working (returns the authorization failed page): <code>  COOKIES=./cookies.txtUSER=my_userPASSWORD=my_passwordHOST=""https://myJazzServer:9092/jazz""curl -k -c $COOKIES ""$HOST/authenticated/identity""curl -k -L -b $COOKIES -c $COOKIES -d j_username=$USER -d j_password=$PASSWORD ""$HOST/authenticated/j_security_check"" CookieContainer _cookie; public string _RTC() { HttpWebRequest request = (HttpWebRequest)WebRequest.Create(""https://myJazzServer.com:9092/jazz/authenticated/identity""); if (_cookie == null) { _cookie = new CookieContainer(); } string a; request.CookieContainer = _cookie; using (var response = request.GetResponse()) { using (StreamReader sr = new StreamReader(response.GetResponseStream())) { a = sr.ReadToEnd(); } } byte[] data = (new ASCIIEncoding()).GetBytes(""j_username=myUser&j_password=MyPass""); request = (HttpWebRequest)WebRequest.Create(""https://myJazzServer.com:9092/jazz/authenticated/j_security_check""); request.Method = ""POST""; request.ContentType = ""text/html""; request.ContentLength = data.Length; request.CookieContainer = _cookie; Stream reqStream = request.GetRequestStream(); reqStream.Write(data,0,data.Length); string b; using (var response = request.GetResponse()) { using (var reader = new StreamReader(response.GetResponseStream())) { b = reader.ReadToEnd(); } } }",c# - WebRequest HTTP POST with Cookie (port from curl script)
Is there a built in Binary Search Tree in .NET 4.0?," Is there a built-in binary search tree in .NET 4.0, or do I need to build this abstract data type from scratch?EditThis is about the binary search tree specifically, and not abstract data type ""trees"" in general. <code> ",Is there a built-in Binary Search Tree in .NET 4.0?
How to calculate actual months difference between two given dates in C#?," Example: given two dates below, finish is always greater than or equal to startstart = 2001 Jan 01finish = 2002 Mar 15So from 2001 Jan 01 to the end of 2002 Febmonths = 12 + 2 = 14For 2002 March15/30 = 0.5so grand total is 14.5 months difference.It's very easy to work out by hand but how do I code it elegantly? At the moment I have the combination of a lot of if else and while loops to achieve what I want but I believe there are simpler solutions out there.Update: the output needs to be precise (not approximation) for example:if start 2001 Jan 01 and finish 2001 Apr 16, the output should be 1 + 1 + 1= 3 (for Jan, Feb and Mar) and 16 / 31 = 0.516 month, so the total is 3.516.Another example would be if I start on 2001 Jul 5 and finish on 2002 Jul 10, the output should be 11 month up to the end of June 2002, and (31-5)/31 = 0.839 and 10/31 = 0.323 months, so the total is 11 + 0.839 + 0.323 = 12.162.I extended Josh Stodola's code and Hightechrider's code: <code>  public static decimal GetMonthsInRange(this IDateRange thisDateRange){ var start = thisDateRange.Start; var finish = thisDateRange.Finish; var monthsApart = Math.Abs(12*(start.Year - finish.Year) + start.Month - finish.Month) - 1; decimal daysInStartMonth = DateTime.DaysInMonth(start.Year, start.Month); decimal daysInFinishMonth = DateTime.DaysInMonth(finish.Year, finish.Month); var daysApartInStartMonth = (daysInStartMonth - start.Day + 1)/daysInStartMonth; var daysApartInFinishMonth = finish.Day/daysInFinishMonth; return monthsApart + daysApartInStartMonth + daysApartInFinishMonth;}",How to calculate actual months difference (calendar year not approximation) between two given dates in C#?
C# Arrow key events not arriving," Basically, I have a form with a custom control on it (and nothing else). The custom control is completely empty, and the form has KeyPreview set to true.With this setup, I am not receiving any KeyDown events for any arrow keys or Tab. Every other key that I have on my keyboard works. I have KeyDown event handlers hooked up to everything that has such events, so I'm sure I'm not missing anything.Also of note is that if I remove the (completely empty) custom control, I DO get the arrow key events.What on earth is going on here?EDIT:I added this to both the form and the control, but I'm STILL not getting arrow keys: I also checked with Spy++, and determined that the form itself is not getting any WM_KEYDOWN messages, they're all going to the control. However, that said, the control IS getting the arrow key WM_KEYDOWN messages. Sigh.Edit 2: I've also updated the ZIP file with this version. Please look at it, if you want to help...Edit 3:I've figured this out, sort of. The form is eating the arrow keys, probably in an attempt to maintain focus amongst its children. This is proven by the fact that I DO get the events if the form is empty.Anyway, if I add this code to the form, I start getting the events again: When I override this, the form doesn't get a chance to do its dirty work, and so I get my KeyDown events as I expect. I assume that a side effect of this is that I can no longer use my keyboard to navigate the form (not a big deal in this case, as it's a game, and the entire purpose of this exercise is to implement keyboard navigation!)The question still remains about how to disable this ""properly"", if there is a way... <code>  protected override void WndProc(ref Message m) { switch (m.Msg) { case 0x100: //WM_KEYDOWN //this is the control's version. In the form, it's this.Text ParentForm.Text = ((Keys)m.WParam).ToString(); break; } base.WndProc(ref m);} public override bool PreProcessMessage(ref Message msg) { switch (msg.Msg) { case 0x100: //WM_KEYDOWN return false; } return base.PreProcessMessage(ref msg);}",Arrow key events not arriving
convert list to dictionary using linq and not worrying about duplicates," I have a list of Person objects. I want to convert to a Dictionary where the key is the first and last name (concatenated) and the value is the Person object.The issue is that I have some duplicated people, so this blows up if I use this code: I know it sounds weird but I don't really care about duplicates names for now. If there are multiple names I just want to grab one. Is there anyway I can write this code above so it just takes one of the names and doesn't blow up on duplicates? <code>  private Dictionary<string, Person> _people = new Dictionary<string, Person>();_people = personList.ToDictionary( e => e.FirstandLastName, StringComparer.OrdinalIgnoreCase);",Convert list to dictionary using linq and not worrying about duplicates
Partly crashing application? How is this possible?," I have a program written in C#, running on a Windows CE device (on Compact Framework). It processes minimal user actions (button clicks), uses serial port and TCP/IP communication.The problem is sometimes the software shuts down on its own. In the background the application (or parts of the application) seems to be still running (at least in one documented case it was) because it uses the serial port, so restarting the application doesn't help. I can't reproduce the problem since it happens in most of the cases when there is no user interaction, no serial port communication and the network communication is all ""I am still alive"" messages, the software just crashes seemingly without reason. (I try to make it happen in debug mode to know at least where is the problem in the code if it is a software bug but I have had no luck so far.)Since I'm running out of ideas, the question is: what bug or exception or OS action or hardware malfunction can cause such a behaviour? The problem has been seen on different devices of the same type, so it shouldn't be a hardware error. (Or all my hardware has the same error.) Exceptions are handled, so it shouldn't be an exception. Unhandled exceptions are handled too, so it shouldn't be an unhandled exception either. (My guess is that it is caused by a StackoverflowException because I don't know any other exceptions that can't be caught, but there isn't recursion in the code, at least not willingly, so it shouldn't be a possibility either.) <code> ",Partly crashing application? How can I catch uncatchable exceptions?
C# what are the differences between OLEDB and ODBC?," Currently I can connect to a local .mdb with an Oledb connection. I am able to query, add, update and delete the database with correct results.How would connecting to an ODBC database differ in terms of c# usage from an Oledb database? <code> ",what are the differences between OLEDB and ODBC?
Which class has the responsability of drawing a Piece on a Board? The Piece or the Board?," So, I currently have a Board class that is composed of Pieces. Each Piece has a color and a string that describes the kind of piece. It also has a 2d matrix with bits either set on or off, that allows me to know which pixels to paint with the desired color or not.My question is, which class should have the responsability to draw the pieces on the board? On one hand, I'd say the Piece class should do it. But to do it, I'd have to pass a Board as reference to Piece's Draw() method and although it's not terrible I find it kinda awkward. This raises the problem that Piece would have ""to know"" the Board class.On the other hand, I could just have the Piece have a and Board would then have a method of the form: How would you do it? And why? I can't see a clear winner in any of these approaches.ThankseditI'm not talking about actually drawing things on screen. What happens is that I'm implementing a Tetris game (currently, no GUI) and I need at every moment to set the Pixels of a Square on different positions on the board as it falls to the ground. The board basically only has an accessor and a mutator for each one of the (x, y) points. Let's now say I want to draw a Square(a type of Piece) on the Board. Should the Piece know of the board and its Draw() method make the changes to the Board, or should the Board access Piece's getter method and do it itself? <code>  Boolean[,] IsPixelSet(int x, int y) void DrawPieceOnBoard() { for (int y = 0; y < height; ++y) { for (int x = 0; x < width; ++x) { if (piece.IsPixelSet(x, y) { board.DrawPixelAt(x, y, piece.GetColor()); } } }}",Which class has the responsibility of setting Piece's pixels on a Board(2d matrix)? The Piece or the Board?
Which class has the responsibility of drawing a Piece on a Board? The Piece or the Board?," So, I currently have a Board class that is composed of Pieces. Each Piece has a color and a string that describes the kind of piece. It also has a 2d matrix with bits either set on or off, that allows me to know which pixels to paint with the desired color or not.My question is, which class should have the responsability to draw the pieces on the board? On one hand, I'd say the Piece class should do it. But to do it, I'd have to pass a Board as reference to Piece's Draw() method and although it's not terrible I find it kinda awkward. This raises the problem that Piece would have ""to know"" the Board class.On the other hand, I could just have the Piece have a and Board would then have a method of the form: How would you do it? And why? I can't see a clear winner in any of these approaches.ThankseditI'm not talking about actually drawing things on screen. What happens is that I'm implementing a Tetris game (currently, no GUI) and I need at every moment to set the Pixels of a Square on different positions on the board as it falls to the ground. The board basically only has an accessor and a mutator for each one of the (x, y) points. Let's now say I want to draw a Square(a type of Piece) on the Board. Should the Piece know of the board and its Draw() method make the changes to the Board, or should the Board access Piece's getter method and do it itself? <code>  Boolean[,] IsPixelSet(int x, int y) void DrawPieceOnBoard() { for (int y = 0; y < height; ++y) { for (int x = 0; x < width; ++x) { if (piece.IsPixelSet(x, y) { board.DrawPixelAt(x, y, piece.GetColor()); } } }}",Which class has the responsibility of setting Piece's pixels on a Board(2d matrix)? The Piece or the Board?
C# objects in arrayLists. Please help!," I'm working with ArrayList in C# and I am wondering how I can add objects to an ArrayList and then retrieve the values from it?In short, how can I add, delete, edit and read from an ArrayList containing objects of classes?Thankful for all help! <code> ",C# objects in arrayLists
C# objects in arrayLists.," I'm working with ArrayList in C# and I am wondering how I can add objects to an ArrayList and then retrieve the values from it?In short, how can I add, delete, edit and read from an ArrayList containing objects of classes?Thankful for all help! <code> ",C# objects in arrayLists
"What is the Diference in Managed and Umanaged Code, Memory and Size?"," After seeing and listening a lot regarding managed and unmanaged code, and knowing the only difference is that managed is about CLR and un-managed is outside of the CLR, it makes me really curious to know it in detail. What is it all about, managed and unmanaged code, memory and size?How can code I write in C# be unmanaged while this is C# code and how does a memory of size becomes unmanaged. An example and a little insight would be helpful. <code> ","What is the difference in managed and unmanaged code, memory and size?"
"What is the Difference in Managed and Unmanaged Code, Memory and Size?"," After seeing and listening a lot regarding managed and unmanaged code, and knowing the only difference is that managed is about CLR and un-managed is outside of the CLR, it makes me really curious to know it in detail. What is it all about, managed and unmanaged code, memory and size?How can code I write in C# be unmanaged while this is C# code and how does a memory of size becomes unmanaged. An example and a little insight would be helpful. <code> ","What is the difference in managed and unmanaged code, memory and size?"
Visual Studio 2008 Locks Custom MSBuild Task Assemblies," I'm developing a custom MSBuild task that builds an ORM layer, and using it in a project. I'm being hampered by Visual Studio's behaviour of holding onto MSBuild task DLLs and not letting go. I'd like to organize my solution like this; However, when project (2) builds, it locks onto the assembly from project (1). So now I can't build project (1) again without closing the solution and re-opening it. Is there any way I can organize things so that the custom build task is not kept locked by Visual Studio? <code>  My Solution | +- (1) ORM Layer Custom Task Project | | | +- BuildOrmLayerTask.cs // here's my task | +- (2) Business Logic Project // and here's the project that uses it. | +- <UsingTask TaskName=""BuildOrmLayerTask"" AssemblyFile=""$(TaskAssembly)"" />",Visual Studio 2008 locks custom MSBuild Task assemblies
VC# - Draw / Paint Outside Form..., Can we paint images and draw text... outside a form.. i mean literally outside...i know its stupid question to ask but CAN we... <code> ,Draw / Paint Outside Form
C# HMACSHA256 Problem - Matching Facebook Signed Request Implementation ," I thought I would try and get the new Signed Request logic added to my facebook canvas application, to make this ""easy"" on myself I went to the facebook PHP sdk over at GitHub and took a look at the unit tests. My actual problem is that I cannot get the hash included in the request to match the hash I calculate using the application secret, and the data sent within the request. How this is meant to work is described at Facebook's authentication page. Answer thanks to Rasmus below, to assist anyone else here is the updated (cleaned up code):  <code>  private string VALID_SIGNED_REQUEST = ""ZcZocIFknCpcTLhwsRwwH5nL6oq7OmKWJx41xRTi59E.eyJhbGdvcml0aG0iOiJITUFDLVNIQTI1NiIsImV4cGlyZXMiOiIxMjczMzU5NjAwIiwib2F1dGhfdG9rZW4iOiIyNTQ3NTIwNzMxNTJ8Mi5JX2VURmtjVEtTelg1bm8zakk0cjFRX18uMzYwMC4xMjczMzU5NjAwLTE2Nzc4NDYzODV8dUk3R3dybUJVZWQ4c2VaWjA1SmJkekdGVXBrLiIsInNlc3Npb25fa2V5IjoiMi5JX2VURmtjVEtTelg1bm8zakk0cjFRX18uMzYwMC4xMjczMzU5NjAwLTE2Nzc4NDYzODUiLCJ1c2VyX2lkIjoiMTY3Nzg0NjM4NSJ9"";private string NON_TOSSED_SIGNED_REQUEST = ""laEjO-az9kzgFOUldy1G7EyaP6tMQEsbFIDrB1RUamE.eyJhbGdvcml0aG0iOiJITUFDLVNIQTI1NiJ9"";public void SignedRequestExample(){ var Encoding = new UTF8Encoding(); string ApplicationSecret = ""904270b68a2cc3d54485323652da4d14""; string SignedRequest = VALID_SIGNED_REQUEST; string ExpectedSignature = SignedRequest.Substring(0, SignedRequest.IndexOf('.')); string Payload = SignedRequest.Substring(SignedRequest.IndexOf('.') + 1); // Back & Forth with Signature byte[] ActualSignature = FromUrlBase64String(ExpectedSignature); string TestSignature = ToUrlBase64String(ActualSignature); // Back & Forth With Data byte[] ActualPayload = FromUrlBase64String(Payload); string Json = Encoding.GetString(ActualPayload); string TestPayload = ToUrlBase64String(ActualPayload); // Attempt to get same hash var Hmac = SignWithHMAC(ActualPayload, Encoding.GetBytes(ApplicationSecret)); var HmacBase64 = ToUrlBase64String(Hmac); var HmacHex = BytesToHex(Hmac); if (HmacBase64 != ExpectedSignature) { // YAY } else { // BOO }}private static string BytesToHex(byte[] input){ StringBuilder sb = new StringBuilder(); foreach (byte b in input) { sb.Append(string.Format(""{0:x2}"", b)); } return sb.ToString();}private string ToUrlBase64String(byte[] Input){ return Convert.ToBase64String(Input).Replace(""="", String.Empty).Replace('+', '-').Replace('/', '_');}// http://tools.ietf.org/html/rfc4648#section-5 private byte[] FromUrlBase64String(string Base64UrlSafe){ Base64UrlSafe = Base64UrlSafe.PadRight(Base64UrlSafe.Length + (4 - Base64UrlSafe.Length % 4) % 4, '='); Base64UrlSafe = Base64UrlSafe.Replace('-', '+').Replace('_', '/'); return Convert.FromBase64String(Base64UrlSafe);}private byte[] SignWithHMAC(byte[] dataToSign, byte[] keyBody){ using (var hmac = new HMACSHA256(keyBody)) { hmac.ComputeHash(dataToSign); /* CryptoStream cs = new CryptoStream(System.IO.Stream.Null, hmac, CryptoStreamMode.Write); cs.Write(dataToSign, 0, dataToSign.Length); cs.Flush(); cs.Close(); byte[] hashResult = hmac.Hash; */ return hmac.Hash; }}public string Base64ToHex(string input){ StringBuilder sb = new StringBuilder(); byte[] inputBytes = Convert.FromBase64String(input); foreach (byte b in inputBytes) { sb.Append(string.Format(""{0:x2}"", b)); } return sb.ToString();} /// Example signed_request variable from PHPSDK Unit Testingprivate string VALID_SIGNED_REQUEST = ""ZcZocIFknCpcTLhwsRwwH5nL6oq7OmKWJx41xRTi59E.eyJhbGdvcml0aG0iOiJITUFDLVNIQTI1NiIsImV4cGlyZXMiOiIxMjczMzU5NjAwIiwib2F1dGhfdG9rZW4iOiIyNTQ3NTIwNzMxNTJ8Mi5JX2VURmtjVEtTelg1bm8zakk0cjFRX18uMzYwMC4xMjczMzU5NjAwLTE2Nzc4NDYzODV8dUk3R3dybUJVZWQ4c2VaWjA1SmJkekdGVXBrLiIsInNlc3Npb25fa2V5IjoiMi5JX2VURmtjVEtTelg1bm8zakk0cjFRX18uMzYwMC4xMjczMzU5NjAwLTE2Nzc4NDYzODUiLCJ1c2VyX2lkIjoiMTY3Nzg0NjM4NSJ9"";public bool ValidateSignedRequest(){ string applicationSecret = ""904270b68a2cc3d54485323652da4d14""; string[] signedRequest = VALID_SIGNED_REQUEST.Split('.'); string expectedSignature = signedRequest[0]; string payload = signedRequest[1]; // Attempt to get same hash var Hmac = SignWithHmac(UTF8Encoding.UTF8.GetBytes(payload), UTF8Encoding.UTF8.GetBytes(applicationSecret)); var HmacBase64 = ToUrlBase64String(Hmac); return (HmacBase64 == expectedSignature); }private string ToUrlBase64String(byte[] Input){ return Convert.ToBase64String(Input).Replace(""="", String.Empty) .Replace('+', '-') .Replace('/', '_');}private byte[] SignWithHmac(byte[] dataToSign, byte[] keyBody){ using (var hmacAlgorithm = new HMACSHA256(keyBody)) { hmacAlgorithm.ComputeHash(dataToSign); return hmacAlgorithm.Hash; }}",How can I get the same HMAC256-results in C# like in the PHP unit tests?
how to create Hardlink in C# ?," How to create a hardlink in C#? Any code snippet, please? <code> ",How to create a hardlink in C#?
a way to convert string to Color in C#," I am encountering a problem which is how do I convert input strings like ""RED"" to the actual Color type Color.Red in C#. Is there a good way to do this?I could think of using a switch statement and cases statement for each color type but I don't think that is clever enough. <code> ",Convert string to Color in C#
a way to convert string to Color in C#(XNA development environment)," I am encountering a problem which is how do I convert input strings like ""RED"" to the actual Color type Color.Red in C#. Is there a good way to do this?I could think of using a switch statement and cases statement for each color type but I don't think that is clever enough. <code> ",Convert string to Color in C#
Why R# prefer consts over readonly?," I've noticed ReSharper suggestion under ""Common Practices and Code Improvements"": Convert local variable or field to constant.I've also noticed that in Bill Wagner's book ""Effective C#: 50 Specific Ways to Improve Your C#"", there is a language idiom ""Prefer readonly to const"" in which the author explains the risks of using consts.My question is not about the differences between readonly and const and when to use them, but why one source put const as a common practice/code improvement, and on the other hand, the second one treats readonly as an idiom? <code> ",Why does ReSharper prefer consts over readonly?
Why Resharper prefer consts over readonly?," I've noticed ReSharper suggestion under ""Common Practices and Code Improvements"": Convert local variable or field to constant.I've also noticed that in Bill Wagner's book ""Effective C#: 50 Specific Ways to Improve Your C#"", there is a language idiom ""Prefer readonly to const"" in which the author explains the risks of using consts.My question is not about the differences between readonly and const and when to use them, but why one source put const as a common practice/code improvement, and on the other hand, the second one treats readonly as an idiom? <code> ",Why does ReSharper prefer consts over readonly?
Why does Resharper prefer consts over readonly?," I've noticed ReSharper suggestion under ""Common Practices and Code Improvements"": Convert local variable or field to constant.I've also noticed that in Bill Wagner's book ""Effective C#: 50 Specific Ways to Improve Your C#"", there is a language idiom ""Prefer readonly to const"" in which the author explains the risks of using consts.My question is not about the differences between readonly and const and when to use them, but why one source put const as a common practice/code improvement, and on the other hand, the second one treats readonly as an idiom? <code> ",Why does ReSharper prefer consts over readonly?
IEnumerable to string," I have a DataTable that returns I want to convert this to single string value, i.e: How can i rewrite the following to get a single string <code>  IDs,1,2,3,4,5,100,101 ,1,2,3,4,5,100,101 var _values = _tbl.AsEnumerable().Select(x => x);",IEnumerable to string delimited with commas?
Regualar Expression that Matches Any Number or Letter or Dash," Given searchString = ""23423asdfa-''""This regular expression should evaluate to false but it does not! Any ideas? <code>  Regex rgx = new Regex(@""[\w-]*"");rgx.IsMatch(searchString)",Regular Expression that Matches Any Number or Letter or Dash
How to deserialize object derived from Exception class using Json.net (C#)?," I'm trying to deserialize object derived from Exception class: It gives me error: ISerializable type 'type' does not have a valid constructor. <code>  [Serializable]public class Error : Exception, ISerializable{ public string ErrorMessage { get; set; } public Error() { }} Error error = JsonConvert.DeserializeObject< Error >(""json error obj string""); ",How to deserialize object derived from Exception class using Json.net?
C# how to let Timer skip tick if the previous thread is still busy," I created a windows service, that is supposed to check a certain table in the db for new rows every 60 seconds. For every new row that was added, I need to do some heavy processing on the server that could sometimes take more than 60 seconds.I created a Timer object in my service, that ticks every 60 seconds and invokes the wanted method.Since I don't want this timer to tick while processing the new lines found, I wrapped the method in a lock { } block, so this won't be accessible by another thread.It looks something like this : Now, I'm wondering -If my timer ticks, and finds a lot of new rows on the db, and now the processing will take more than 60 seconds, the next tick won't do any processing till the previous one finished. This is the effect I want.But now, will the serviceTimer_Elapsed method go off immediatly once the first processing was finished, or will it wait for the timer to tick again.What I want to happen is - if the processing requires more than 60 seconds, than the timer will notice the thread is locked, and wait another 60 seconds to check again so I will never get stuck in a situation where there are a queue of threads waiting for the previous one to finish.How can i accomplish this result ?What is the best practice for doing this ?Thanks! <code>  Timer serviceTimer = new Timer();serviceTimer.Interval = 60;serviceTimer.Elapsed += new ElapsedEventHandler(serviceTimer_Elapsed);serviceTimer.Start();void serviceTimer_Elapsed(object sender, ElapsedEventArgs e){ lock (this) { // do some heavy processing... }}",How to let Timer skip tick if the previous thread is still busy
c# beginner: compiling from command line," I am following this tutorial:http://www.csharp-station.com/Tutorials/Lesson01.aspxI pasted this into a text file, named it Welcome.cs: Then I went into the command prompt, and pointed to the file's directory. I typed csc.exe Welcome.cs and got this error message: I am using Visual Studio 2008I tried moving csc.exe to the Windows directory, and now I am getting this error: How can I compile my C# code from the command line? <code>  // Namespace Declarationusing System;// Program start classclass WelcomeCSS{ // Main begins program execution. static void Main() { // Write to console Console.WriteLine(""Welcome to the C# Station Tutorial!""); }} csc.exe is not recognized as internal or external command fatal error cs2018: unable to find messages file 'cscompui.dll'",Compiling C# code from the command line gives error
compiling C# code from the command line gives error," I am following this tutorial:http://www.csharp-station.com/Tutorials/Lesson01.aspxI pasted this into a text file, named it Welcome.cs: Then I went into the command prompt, and pointed to the file's directory. I typed csc.exe Welcome.cs and got this error message: I am using Visual Studio 2008I tried moving csc.exe to the Windows directory, and now I am getting this error: How can I compile my C# code from the command line? <code>  // Namespace Declarationusing System;// Program start classclass WelcomeCSS{ // Main begins program execution. static void Main() { // Write to console Console.WriteLine(""Welcome to the C# Station Tutorial!""); }} csc.exe is not recognized as internal or external command fatal error cs2018: unable to find messages file 'cscompui.dll'",Compiling C# code from the command line gives error
The 'clr-namespace' URI refers to a namespace that is not included in the assembly.," I'm trying to include in my XAML some classes which convert values. However, I'm getting the following error when I compile: Undefined CLR namespace. The 'clr-namespace' URI refers to a namespace 'View.Summary.Converters' that is not included in the assembly.(View\View)And the XAML it's erroring on: Also, here is the outline of my conversion classes/namespace: I had to remove the guts of the code because the project I am working on is highly confidential. <code>  xmlns:c=""clr-namespace:View.Summary.Converters"" namespace View.Summary.Converters{ class CollapsedIfNegative : IValueConverter { } class VisibleIfNegative : IValueConverter { } class ErrorCodeToString : IValueConverter { }}",The 'clr-namespace' URI refers to a namespace that is not included in the assembly
"For what is used ""volatile"" ?", I read some articles about the volatile keyword but I could not figure out its correct usage. Could you please tell me what it should be used for in C# and in Java? <code> ,"What is the ""volatile"" keyword used for?"
C# This stream does not support seek operations [error message], I'm trying to get an image from an url using a byte stream. But i get this error message: This stream does not support seek operations.This is my code: What am i doing wrong guys? <code>  byte[] b;HttpWebRequest myReq = (HttpWebRequest)WebRequest.Create(url);WebResponse myResp = myReq.GetResponse();Stream stream = myResp.GetResponseStream();int i;using (BinaryReader br = new BinaryReader(stream)){ i = (int)(stream.Length); b = br.ReadBytes(i); // (500000);}myResp.Close();return b;,"Error ""This stream does not support seek operations"" in C#"
Is it OK to copy paste unit-tests when the logic is basically the same?," I currently have like 10 tests that test whenever my Tetris piece doesn't move left if there is a piece in the path, or a wall. Now, I will have to test the same behaviour for the right movement.Is it too bad if I just copy the 10 tests I already have for the left movement and make only the needed changes and do the same for the code itself too? Or should I go again and make each test from the beginning, even so if the logic is basically the same? <code> ",Is it OK to copy & paste unit-tests when the logic is basically the same?
c# still confused about covariance and contravariance & in/out," ok i read a bit on this topic on stackoverflow, watched this & this, but still a bit confused about co/contra-variance. from here Covariance allows a ""bigger"" (less specific) type to be substituted in an API where the original type is only used in an ""output"" position (e.g. as a return value). Contravariance allows a ""smaller"" (more specific) type to be substituted in an API where the original type is only used in an ""input"" position.i know it has to do with type safety. about the in/out thing. can i say i use in when i need to write to it, and out when its read only. and in means contra-variance, out co-variance. but from the explanation above... and here For example, a List<Banana> can't be treated as a List<Fruit> because list.Add(new Apple()) is valid for List but not for List<Banana>.so shouldn't it be, if i were to use in/ am going to write to the object, it must be bigger more generic. i know this question has been asked but still very confused.  <code> ",still confused about covariance and contravariance & in/out
interview qestion on C# implicit typing. , I have been given a sample statement: How is it possible to make this a valid statement? What code do I need to include in MyClass to support the implicit conversion from an int? <code>  MyClass myclass = 3;,Interview question on C# implicit conversion. 
Interview question on C# implicit typing. , I have been given a sample statement: How is it possible to make this a valid statement? What code do I need to include in MyClass to support the implicit conversion from an int? <code>  MyClass myclass = 3;,Interview question on C# implicit conversion. 
Immutable Collections for .NET," It seems to me there is an extreme lack of safe, immutable collection types for .NET, in particular BCL but I've not seen much work done outside either. Do anyone have any pointers to a (preferably) production quality, fast, immutable collections library for .NET. A fast list type is essential. I'm not yet prepared to switch to F#.*Edit: Note to searchers, this is being rolled into the BCL soon: .NET immutable collections <code> ","Efficient, Immutable, Extensible Collections for .NET"
c# but related to all - The difference between convert and parse., I could write the following to convert an object to an integer. But I could also write Is there any difference?Which one should I be using?Thanks in advance. <code>  Convert.ToInt32(myObject); Int.Parse(myObject.ToString());,What is the difference between Convert and Parse?
The difference between convert and parse., I could write the following to convert an object to an integer. But I could also write Is there any difference?Which one should I be using?Thanks in advance. <code>  Convert.ToInt32(myObject); Int.Parse(myObject.ToString());,What is the difference between Convert and Parse?
"C# - is there a way to flush the DNS cache from a C# WPF app? (on XP, Vista, Win7)"," Is there a way to flush the DNS cache from a C# WPF app? The application would be running on either XP, Vista, or Windows 7. <code> ","Is there a way to flush the DNS cache from a C# WPF app? (on XP, Vista, Win7)"
how to play sound from C#.Net, I have a Windows application written in C#/.NET.How can I play a specific sound when a button is clicked? <code> ,"How to play a sound in C#, .NET"
Access com vtable from c#, Is there any way in C# to access a COM object's virtual method table in order to get a function's address? <code> ,Access COM vtable from C#
[C#] Modify a dictionary which I am iterating through.," An exception was thrown: Collection was modified; enumeration operation may not execute.For some reason, it is not any more.I know you cannot remove something, while iterating through it this way. My question is: How do I solve it? <code>  foreach(BruteforceEntry be in Entries.Values){ if (be.AddedTimeRemove <= now) Entries.Remove(be.IPAddress); else if (be.Unbantime <= now && be.Unbantime.Day == DateTime.Now.Day) Entries.Remove(be.IPAddress);}",Modify a dictionary which I am iterating through
Modify a dictionary which I am iterating through.," An exception was thrown: Collection was modified; enumeration operation may not execute.For some reason, it is not any more.I know you cannot remove something, while iterating through it this way. My question is: How do I solve it? <code>  foreach(BruteforceEntry be in Entries.Values){ if (be.AddedTimeRemove <= now) Entries.Remove(be.IPAddress); else if (be.Unbantime <= now && be.Unbantime.Day == DateTime.Now.Day) Entries.Remove(be.IPAddress);}",Modify a dictionary which I am iterating through
Excel automation C#: How to delete a column?, How does one delete a column (or multiple columns) in Excel?eg. How to delete column C and shift the rest left? <code> ,How to Delete a Column Programmatically?
Repository integration tests, I want to implement integration tests of my Entity Framework driven repositories. The problem is how to rollback database state after tests are done. At the moment I'm planning to start transaction at test SetUp and roll it back at test TearDown. Are there any other solutions excepting manual database clearing? <code> ,Doing a rollback - Repository integration tests
Making an object or class not inherited," I am trying to create a c# class, but I dont want it to be inherited. How can I accomplish that? <code> ",Making a class not inherited
".NET 4 ConcurrentDictionary + ConcurrentQueue , Thread Safe ?"," I'm using the ConcurrentDictionary and ConcurrentQueue classes from .NET 4 in the following code.Is this code thread-safe? If not, how can I make it thread-safe? Demo: <code>  public class Page{ public string Name {get; set; }}public class PageQueue{ private ConcurrentDictionary<int, ConcurrentQueue<Page>> pages = new ConcurrentDictionary<int, ConcurrentQueue<Page>>(); public void Add(int id, Page page) { if (!this.pages.ContainsKey(id)) this.pages[id] = new ConcurrentQueue<Page>(); this.pages[id].Enqueue(page); } public Page GetAndRemove(int id) { Page lp = null; if(this.pages.ContainsKey(id)) this.pages[id].TryDequeue(out lp); return lp; }} public class Demo { public void RunAll() { for (int i = 0; i < 10; i++) Task.Factory.StartNew(() => Run()); } public void Run() { PageQueue pq = new PageQueue(); pq.Add(1, new Page()); pq.GetAndRemove(1); } }",Is this combination of ConcurrentDictionary and ConcurrentQueue  thread-safe?
How to get status code from webclient ?," I am using the WebClient class to post some data to a web form. I would like to get the response status code of the form submission. So far I've found out how to get the status code if there is a exception However if the form is submitted successfully and no exception is thrown then I won't know the status code(200,301,302,...)Is there some way to get the status code when there is no exceptions thrown?PS: I prefer not to use httpwebrequest/httpwebresponse <code>  Catch wex As WebException If TypeOf wex.Response Is HttpWebResponse Then msgbox(DirectCast(wex.Response, HttpWebResponse).StatusCode) End If",How to get status code from webclient?
how to I make my application as fast as windows explorer for rendering files.," I have a folder with a large amount of files inside of it. I want to be able to render each of my files as a button. And when I click on the button something will happen. As you can see there's nothing crazy in the code. I have a panel on a form and I've set auto scroll on the panel to true and auto size to false. This causes the form to maintain size and the buttons (some of them anyway) to get rendered off the form and I can scroll down to them.All good so far.If I have 100 or 200 file everything is ok, if I have 1932 files it takes about 10 seconds to render all the buttons.I've read the follow question Super slow C# custom control and I understand that the approach I'm using might not be the best to use here. And now the question at last:how does windows explorer handle this? If I open this folder in Windows explorer it opens instantly.What type of control is windows explorer using? Or is it doing it in a completly different way to me.Thanks <code>  private void Form1_Load(object sender, EventArgs e) { int x = 10; int y = 10; /// Process the list of files found in the directory. string[] fileEntries = Directory.GetFiles(@""c:\lotsofDocs""); foreach (string fileName in fileEntries) { // do something with fileName Button newbotton = new Button(); newbotton.AutoSize = true; newbotton.Text = fileName; panel1.Controls.Add(newbotton); newbotton.Location = new Point(x, y); x += 150; if (x == 760) { y += 50; x = 10; } }",how do I make my application as fast as windows explorer for rendering files.
What isn't my TimeSpan.Add() working?," There has to be an easy answer: There's only one value in the list timeSheets and it is a positive TimeSpan (verified on local inspection). <code>  var totalTime = TimeSpan.Zero;foreach (var timesheet in timeSheets){ //assume ""time"" is a correct, positive TimeSpan var time = timesheet.EndTime - timesheet.StartTime; totalTime.Add(time);}",Why isn't my TimeSpan.Add() working?
how to merge cells in a column using code behind?," C#, ASP.NET, VS08, using HTML table.I want to merge cells - rowspan and colspan spans it but does not merge it.For a clear picture,drag a HTML table control on the design viewselect the cells of a columnright click, modify, mergeI would like to do this programatically in C# coding on a button click. <code> ",How to merge cells in a column using code behind?
xml in sql server," I want to pass xml document to sql server stored procedure such as this: I want compare some field data with other table data and if it is matching that records has to inserted in to the table.Requirements:How do I pass XML to the stored procedure? I tried this, but it doesnt work:[Working] How do I access the XML data within the stored procedure? Edit: [Working] Edit 2: How to create a select query to select pages, description based on some conditions. <code>  CREATE PROCEDURE BookDetails_Insert (@xml xml) command.Parameters.Add( new SqlParameter(""@xml"", SqlDbType.Xml) { Value = new SqlXml(new XmlTextReader(xmlToSave.InnerXml, XmlNodeType.Document, null)) }); String sql = ""BookDetails_Insert""; XmlDocument xmlToSave = new XmlDocument(); xmlToSave.Load(""C:\\Documents and Settings\\Desktop\\XML_Report\\Books_1.xml""); SqlConnection sqlCon = new SqlConnection(""...""); using (DbCommand command = sqlCon.CreateCommand()) { **command.CommandType = CommandType.StoredProcedure;** command.CommandText = sql; command.Parameters.Add( new SqlParameter(""@xml"", SqlDbType.Xml) { Value = new SqlXml(new XmlTextReader(xmlToSave.InnerXml , XmlNodeType.Document, null)) }); sqlCon.Open(); DbTransaction trans = sqlCon.BeginTransaction(); command.Transaction = trans; try { command.ExecuteNonQuery(); trans.Commit(); sqlCon.Close(); } catch (Exception) { trans.Rollback(); sqlCon.Close(); throw; } <booksdetail> <isn_13>700001048</isbn_13> <isn_10>01048B</isbn_10> <Image_URL>http://www.landt.com/Books/large/00/7010000048.jpg</Image_URL> <title>QUICK AND FLUPKE</title> <Description> PRANKS AND JOKES QUICK AND FLUPKE </Description> </booksdetail> ",How to pass XML from C# to a stored procedure in SQL Server 2008?
How to pass XML from C# to a stored procedure in SQL Server?," I want to pass xml document to sql server stored procedure such as this: I want compare some field data with other table data and if it is matching that records has to inserted in to the table.Requirements:How do I pass XML to the stored procedure? I tried this, but it doesnt work:[Working] How do I access the XML data within the stored procedure? Edit: [Working] Edit 2: How to create a select query to select pages, description based on some conditions. <code>  CREATE PROCEDURE BookDetails_Insert (@xml xml) command.Parameters.Add( new SqlParameter(""@xml"", SqlDbType.Xml) { Value = new SqlXml(new XmlTextReader(xmlToSave.InnerXml, XmlNodeType.Document, null)) }); String sql = ""BookDetails_Insert""; XmlDocument xmlToSave = new XmlDocument(); xmlToSave.Load(""C:\\Documents and Settings\\Desktop\\XML_Report\\Books_1.xml""); SqlConnection sqlCon = new SqlConnection(""...""); using (DbCommand command = sqlCon.CreateCommand()) { **command.CommandType = CommandType.StoredProcedure;** command.CommandText = sql; command.Parameters.Add( new SqlParameter(""@xml"", SqlDbType.Xml) { Value = new SqlXml(new XmlTextReader(xmlToSave.InnerXml , XmlNodeType.Document, null)) }); sqlCon.Open(); DbTransaction trans = sqlCon.BeginTransaction(); command.Transaction = trans; try { command.ExecuteNonQuery(); trans.Commit(); sqlCon.Close(); } catch (Exception) { trans.Rollback(); sqlCon.Close(); throw; } <booksdetail> <isn_13>700001048</isbn_13> <isn_10>01048B</isbn_10> <Image_URL>http://www.landt.com/Books/large/00/7010000048.jpg</Image_URL> <title>QUICK AND FLUPKE</title> <Description> PRANKS AND JOKES QUICK AND FLUPKE </Description> </booksdetail> ",How to pass XML from C# to a stored procedure in SQL Server 2008?
Microsoft Speech Recognition Platform ," I wrote an app in C# for speech recognition using System.Speech which works fine on Windows 7.However I'm after creating the same app that will work on windows 2003 (x86).My programming environment:Windows 7 x64 ProVisual Studio 2008In order to develop this application in my programming environment I installed:1.Microsoft Speech Platform - Server Runtime (Version 10.1) (x86)http://www.microsoft.com/downloads/details.aspx?FamilyID=674356C4-E742-4855-B3CC-FC4D5522C449&displaylang=en&displaylang=en2.Microsoft Speech Platform - Software Development Kit (SDK) (Version 10.1) (x86)http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=4d36908b-3264-49ef-b154-f23bf7f44ef43.Microsoft Speech Platform - Server Runtime Languages (Version 10.1)(here installed SR for en-GB)http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=f704cd64-1dbf-47a7-ba49-27c5843a12d5In my program instead of System.Speech I used Microsoft.Speech.Recognition;Pasted this code from SDK documentation: I also set platform target to x86 in project properties. Code compiles but once I run or debug it recognition doesn't work. Any idea what am I missing? <code>  using Microsoft.Speech.Recognition;using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Windows.Forms;namespace WindowsFormsApplication1{ public partial class Form1 : Form { public Form1() { InitializeComponent(); } private void Form1_Load(object sender, EventArgs e) { // Create a new SpeechRecognitionEngine instance. sre = new SpeechRecognitionEngine(); // Create a simple grammar that recognizes red, green, or blue. Choices colors = new Choices(); colors.Add(""red""); colors.Add(""green""); colors.Add(""blue""); GrammarBuilder gb = new GrammarBuilder(); gb.Append(colors); // Create the actual Grammar instance, and then load it into the speech recognizer. Grammar g = new Grammar(gb); sre.LoadGrammar(g); // Register a handler for the SpeechRecognized event. sre.SpeechRecognized += new EventHandler<SpeechRecognizedEventArgs>(sre_SpeechRecognized); sre.SetInputToDefaultAudioDevice(); sre.RecognizeAsync(RecognizeMode.Multiple); } // Simple handler for the SpeechRecognized event. void sre_SpeechRecognized(object sender, SpeechRecognizedEventArgs e) { MessageBox.Show(e.Result.Text); } SpeechRecognitionEngine sre; }}",Microsoft Speech Recognition Platform
Is DotNetNuke documentation largely void or are they hiding it on purpose?," I have a difficulty with a statement on the DotNetNuke pages about the documentation only being available when you pay $2000 or more for a professional or higher license. The forums are flooded with questions, many duplicated, many unanswered, despite the hard work of the DNN community to keep up with demand.I've tried the books, but they didn't provide the answers I looked for either and while the enthusiasm of the writers is clear, the verbose printing of large boiler plate examples and the lack of information or coverage of newly introduced keywords did not give me the deeper understanding that I longed for as a module developer.On one hand I'm feeling about DotNetNuke as a great place to be in, but on the other hand, every time I need that one-liner of information on a method, I end up looking for it for ages, and stepping through the code and reverse engineering is then my best friend. I'm curious, why is a product that's been around for so long, so poorly documented on the count of the API? After all, there's a rather large commercial company behind it and it thrives by the product's expandability. Am I correct in understanding that you only get this documentation if you pay dearly? Or do module development companies have special access? <code> ",Is DotNetNuke documentation really largely void or is it only available in the commercial editions?
Is DotNetNuke documentation largely void or is it only available in the commercial editions?," I have a difficulty with a statement on the DotNetNuke pages about the documentation only being available when you pay $2000 or more for a professional or higher license. The forums are flooded with questions, many duplicated, many unanswered, despite the hard work of the DNN community to keep up with demand.I've tried the books, but they didn't provide the answers I looked for either and while the enthusiasm of the writers is clear, the verbose printing of large boiler plate examples and the lack of information or coverage of newly introduced keywords did not give me the deeper understanding that I longed for as a module developer.On one hand I'm feeling about DotNetNuke as a great place to be in, but on the other hand, every time I need that one-liner of information on a method, I end up looking for it for ages, and stepping through the code and reverse engineering is then my best friend. I'm curious, why is a product that's been around for so long, so poorly documented on the count of the API? After all, there's a rather large commercial company behind it and it thrives by the product's expandability. Am I correct in understanding that you only get this documentation if you pay dearly? Or do module development companies have special access? <code> ",Is DotNetNuke documentation really largely void or is it only available in the commercial editions?
C# Generics. Force generic interface implementation.," Is there anyway to force a constraints for a generic definition to implement a ""generic interface"" ... that is, I want the class to support passing an interface and a generic class constraining it so that the class implements the interface. For example if I say: That should be constrained so that MyImplementation implements IMyInterfaceAs far as I know that can be achieved by Now, is there anyway to also force T to be an interface?Edit: The purpose of this was to have something like: and have the list restricted to only interfaces (since it is supposed to return implementations of certain interfaces) <code>  MyGenericClass<IMyInterface, MyImplementation>.DoSomething(); public class Dynamic_Loader<T, S> where S: T private static List<T> interfaceList = new List<T>();public static List<T> InterfaceList {get { return interfaceList;}}public static void Add(S input) { interfaceList.Add(input);}",Force generic interface implementation in C#
C# Socket.Close - Should I still call Dispose?, Should I still call Dispose() on my socket after closing it?For example: I was wondering because the MSDN documentation says the following: Closes the Socket connection and releases all associated resources. <code>  mySocket.Shutdown(SocketShutdown.Both);mySocket.Close();mySocket.Dispose(); // Redundant?,Should I manually dispose the socket after closing it?
Download image from the site .net[c#]," I am trying to download images from the site. The code which I am using is working fine while the image is available. If the image it not available it is creating a problem. How to validate availability of the image?Code:Method 1: Method 2: Edit:Stream has the following statements: <code>  WebRequest requestPic = WebRequest.Create(imageUrl);WebResponse responsePic = requestPic.GetResponse();Image webImage = Image.FromStream(responsePic.GetResponseStream()); // ErrorwebImage.Save(""D:\\Images\\Book\\"" + fileName + "".jpg""); WebClient client = new WebClient();Stream stream = client.OpenRead(imageUrl);bitmap = new Bitmap(stream); // Error : Parameter is not valid.stream.Flush();stream.Close();client.dispose();if (bitmap != null){ bitmap.Save(""D:\\Images\\"" + fileName + "".jpg"");} Length '((System.Net.ConnectStream)(str)).Length' threw an exception of type 'System.NotSupportedException' long {System.NotSupportedException} Position '((System.Net.ConnectStream)(str)).Position' threw an exception of type 'System.NotSupportedException' long {System.NotSupportedException} ReadTimeout 300000 intWriteTimeout 300000 int",Download image from the site in .NET/C#
C#: Need help understanding lambda (Currying)," i am reading Accelerated C# i don't really understand the following code: in the last line what is x referring to? and there's another: How do i evaluate this? (y) => (x) => func( x, y ) what is passed where ... it does confusing. <code>  public static Func<TArg1, TResult> Bind2nd<TArg1, TArg2, TResult> ( this Func<TArg1, TArg2, TResult> func, TArg2 constant ) { return (x) => func( x, constant );} public static Func<TArg2, Func<TArg1, TResult>> Bind2nd<TArg1, TArg2, TResult>( this Func<TArg1, TArg2, TResult> func ){ return (y) => (x) => func( x, y );}",Need help understanding lambda (currying)
how to delete the file which is saved into particular destination in c# codebehind," How do I delete a file, given the full path to the file? <code> ",how to delete a file?
can be object of type datetime null? .net c#, Possible Duplicate: DateTime null value is it possible to set datetime object to null? <code> ,Can a DateTime be null?
generate default constructor in c# ?," Suppose I initialize members of a class like this: Does the compiler generate a default constructor in this situation?In general, I know that a constructor may initialize the value of class instance variables and may also perform some other initialization operations appropriate for the class. But in the above example, I have initialized the value of i and j outside of a constructor. In this situation, does the compiler still generate a default constructor? If so, what does the default constructor do? <code>  class A { public int i=4; public double j=6.0;}","In C#, is a default constructor generated when class members are initialized?"
Generate default constructor in c# ?," Suppose I initialize members of a class like this: Does the compiler generate a default constructor in this situation?In general, I know that a constructor may initialize the value of class instance variables and may also perform some other initialization operations appropriate for the class. But in the above example, I have initialized the value of i and j outside of a constructor. In this situation, does the compiler still generate a default constructor? If so, what does the default constructor do? <code>  class A { public int i=4; public double j=6.0;}","In C#, is a default constructor generated when class members are initialized?"
Generate default constructor in c#?," Suppose I initialize members of a class like this: Does the compiler generate a default constructor in this situation?In general, I know that a constructor may initialize the value of class instance variables and may also perform some other initialization operations appropriate for the class. But in the above example, I have initialized the value of i and j outside of a constructor. In this situation, does the compiler still generate a default constructor? If so, what does the default constructor do? <code>  class A { public int i=4; public double j=6.0;}","In C#, is a default constructor generated when class members are initialized?"
Use of var type in varriable declaration," Our internal audit suggests us to use explicit variable type declaration instead of using the keyword var. They argue that using of var ""may lead to unexpected results in some cases"".I am not aware of any difference between explicit type declaration and using of var once the code is compiled to MSIL.The auditor is a respected professional so I cannot simply refuse such a suggestion. <code> ","Use of ""var"" type in variable declaration"
Use of var type in variable declaration," Our internal audit suggests us to use explicit variable type declaration instead of using the keyword var. They argue that using of var ""may lead to unexpected results in some cases"".I am not aware of any difference between explicit type declaration and using of var once the code is compiled to MSIL.The auditor is a respected professional so I cannot simply refuse such a suggestion. <code> ","Use of ""var"" type in variable declaration"
c# why does this return 49: Convert.ToInt32('1') ," Possible Duplicate:c# convert char to intThis works: But this doesn't: Shouldn't this convert to actual int? <code>  int val = Convert.ToInt32(""1""); int val = Convert.ToInt32('1'); // returns 49",Why does Convert.ToInt32('1') returns 49?
Avoiding the C# compiler's desire to automatically explicitly implement an interface," I ran into a strange C# edge case and am looking for a good work-around.There is a class that I do not control that looks like this: I'd like to inherit from this class in a class I do control. Additionally, I'd like to specify an interface on it: If all of these files are in the same assembly, everything works great: But, if I move ""ClassIDoNotControl"" into another assembly, I don't get what I expected. Instead, I see ""MyCompany.IInterfaceIDoControl.SomeMethod"" for the output implying an extra stack frame.The reason is that under the covers, the C# compiler is changing ""ClassIDoControl"" to look like this: Is there a way to avoid this compiler-generated extra layer of indirection with explicitly implemented interfaces? <code>  namespace OtherCompany{ public class ClassIDoNotControl { public void SomeMethod(string argument) { Console.WriteLine((new StackFrame(1).GetMethod().Name)); } }} interface IInterfaceIDoControl{ void SomeMethod(string argument);}class ClassIDoControl : OtherCompany.ClassIDoNotControl, IInterfaceIDoControl{} namespace MyCompany{ class Program { static void Main(string[] args) { IInterfaceIDoControl i = new ClassIDoControl(); i.SomeMethod(""Hello World!""); // Prints ""Main"" } } } class ClassIDoControl : OtherCompany.ClassIDoNotControl, IInterfaceIDoControl{ void IInterfaceIDoControl.SomeMethod(string argument) { base.SomeMethod(argument); }}",Why does the C# compiler insert an explicit interface implementation?
"ASP.NET mvc, localized routes and the default language for the user"," I am using ASP.NET MVC localized routes. So when a user goes to the English site it is example.com/en/Controller/Action and the Swedish site is example.com/sv/Controller/Action.How do I make sure that when a user enters the site he/she comes to the correct language directly? I do know how to get the language I want, that is not the issue. The thing I used to do is that I put that culture into the RegisterRoutes method. But because my page is in integrated mode I cannot get the request from Application_Start.So how should I make sure that the route is correct right from the beginning? <code> ","ASP.NET MVC, localized routes and the default language for the user"
how to write date in c#," When i write a date in C# by using then it returns 2010-09-10, but I need 2010/09/10. How do I make it output slashes? <code>  DateTime.Now.ToString(""yyyy/MM/dd"")",How to format a date with slashes in C#
how to remove namspace from XML root element?," is there a simple way to remove the namespace from the XML root element. I have tried with on the serializable class. But no use. still getting the same result.sample class result xml i don't understand then whats the use of specifying namsespace in XmlRootAttribute?? <code>  [XmlRootAttribute(""MCP"", Namespace = """", IsNullable = false)] [Serializable][XmlRootAttribute(""MCP"", Namespace = """", IsNullable = false)] public class BINDRequest{ public BINDRequest() { } [XmlAttribute] public string CLIENT_REQUEST_ID { get; set; } public BINDRequestBody BIND { get; set; }} <?xml version=""1.0"" encoding=""utf-8""?><MCP xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" CLIENT_REQUEST_ID=""1""> <BIND CLIENT_ID=""test"" PASSWORD=""test"" /></MCP>",how to remove namespace from XML root element?
What is the BlockingCollection.TakeFromAny method useful for," I need to build a blocking priority queue and my hunch is that TakeFromAny may be the secret ingredient, however the documentation on that method is sparse. What is its purpose / appropriate use?My requirement is that multiple threads will add to either a high priority or low priority queue. One thread will consume these two queues always taking from the high priority queue before the low priority queue.It's quite possible that the neither the BlockingCollection or the TakeFromAny method will be of any use to me. If so, then a pointer in the right direction would be appreciated. <code> ",Is the BlockingCollection.TakeFromAny method suitable for building a blocking priority queue?
How to select a text from the RichTextBox & then color it ??," I want to create a simple editor like Notepad++ with simple functionality... I need to color a specific word in the rich text box area. How can I do that? For example: when the user write these word, I want to color them to the blue color. These words are: for, while, if, try, etc.How can I make the richtextbox to select a specific word and then color them?And, if I want to make a comment and color everything after the //, how is that done in the richtextbox?How do I number the line in the text box, so I can now the line number when I'm coding in my editor? <code> ",How to select text from the RichTextBox and then color it?
what is mean by connection.Dispose()? in c#.net, What is meant by connection.Dispose() in C#? <code> ,What is meant by connection.Dispose() in C#?
Why does an object initializer expression require IEnumerable to be implemented?," Why does this generate a compiler error: but this doesnt: What is the reason for restricting collection initializers which are syntactic sugar for a call to an Add method to classes that implement an interface which doesnt have an Add method and which isnt used? <code>  class X { public void Add(string str) { Console.WriteLine(str); } }static class Program{ static void Main() { // error CS1922: Cannot initialize type 'X' with a collection initializer // because it does not implement 'System.Collections.IEnumerable' var x = new X { ""string"" }; }} class X : IEnumerable{ public void Add(string str) { Console.WriteLine(str); } IEnumerator IEnumerable.GetEnumerator() { // Try to blow up horribly! throw new NotImplementedException(); }}static class Program{ static void Main() { // prints string and doesnt throw var x = new X { ""string"" }; }}",Why does a collection initializer expression require IEnumerable to be implemented?
Is a C# struct ever boxed when used as the return value of a function?," A simple question, but I haven't found a definitive answer on Stack Overflow. Is a C# struct (value type) always copied to the stack when returned from a function, no matter how large it might be? The reason I'm unsure is that for some instruction sets other than MSIL (such as x86), a return value usually needs to fit into a processor register, and the stack is not directly involved.If so, is it the call site that pre-allocates space on the CLR stack for the (expected) value return type?[edit: summary of replies:] For the intent of the original question, the answer is no; the CLR will never (silently) box a struct just for the purpose of sending it as a return value. <code>  struct MyStruct { int x, y, z; } MyStruct GetMyStruct() => new MyStruct(); static void Main() { var x = GetMyStruct(); // can boxing/unboxing ever occur? }",Is a C# struct ever boxed when declared as the return value of a function?
C# Get file size on disk," This gives the logical size of the file, not the size on the disk. I wish to get the size of a file on the disk in C# (preferably without interop) as would be reported by Windows Explorer.It should give the correct size, including for:A compressed fileA sparse fileA fragmented file <code>  var length = new System.IO.FileInfo(path).Length;",Get size of file on disk
Get Size of file on disk," This gives the logical size of the file, not the size on the disk. I wish to get the size of a file on the disk in C# (preferably without interop) as would be reported by Windows Explorer.It should give the correct size, including for:A compressed fileA sparse fileA fragmented file <code>  var length = new System.IO.FileInfo(path).Length;",Get size of file on disk
get values from lambda expressions parameter," basically I want to get the values of the parameters of a called method like this: <code>  var x = 1;var a = 2;var b = 3;Do<HomeController>(o => o.Save(x, ""Jimmy"", a+b+5, Math.Sqrt(81)));public static void Do<T>(Expression<Action<T>> expression) where T : Controller{ // get the values 1,Jimmy,10,9 here}",get end values from lambda expressions method parameters
Why do RealyCommands typically use lazy initialization?," When using Josh Smith's RelayCommand, most of the examples I've seen use lazy initialization such as: Rather than creating the RelayCommand in the constructor, like this: What's the benefit of using lazy initialization here? It will have to call the get property when setting up the binding, so I can't seen a reason to use this method over settings things up in the constructor. Am I missing something here? <code>  public class ViewModel{ private ICommand myCommand; public ICommand MyCommand { get { if (myCommand == null) { myCommand = new RelayCommand(p => DoSomething() ); } return myCommand; } } // ... stuff ...} public class ViewModel{ public ViewModel() { MyCommand = new RelayCommand(p => DoSomething()); } public ICommand MyCommand { get; private set; } // ... stuff ...}",Why do RelayCommands typically use lazy initialization?
what is difference between unsafe code and unmanaged code in c# ???, What is difference between unsafe code and unmanaged code in C#? <code> ,What is difference between unsafe code and unmanaged code in C#?
xml commenting in c#," I was wondering if anyone knows how to link an interface xml comment to an implementation. The problem is that I want the base comments to come from my interface first. Example: and then the implementation is: So now if I hover over the method with my mouse after instantiating the object: how can I make the comments appear in the hover popup? Is there some way I can link the interface comments to the implementation? I know there's a way in Java, but can't find the solution for C#.Thanks <code>  interface myinterface { /// <summary> /// Does something. /// </summary> void method1(string foo);} public class myclass : myinterface { public void method1(string foo) { //do something... }} myclass foo = new myclass();foo.method1(""do something"");",Inheriting XML comments from interfaces in C#
"Which is better #if DEBUG or Conditional(""DEBUG"")"," Which is better to use, and why, on a large project: or <code>  #if DEBUG public void SetPrivateValue(int value) { ... }#endif [System.Diagnostics.Conditional(""DEBUG"")]public void SetPrivateValue(int value){ ... }","#if DEBUG vs. Conditional(""DEBUG"")"
how to implement left join in JOIN Extension method in C#," I am trying to implement an outer join on this kind of query for the p.Person table.How would I do this?This example is taken from http://ashishware.com/DSLinqExample.shtml <code>  var onlyinfo = p.Person .Where(n => n.FirstName.Contains('a')) .Join(p.PersonInfo, n => n.PersonId, m => m.PersonId, (n, m) => m) .ToArray<Persons.PersonInfoRow>();",How to implement left join in JOIN Extension method
"Find the Discrete Pair of (x,y} that Satisfy Inequality Constriants"," I have a few inequalities regarding {x,y}, that satisfies the following equations: Note that x and y must be integer.Graphically it can be represented as follows, the blue region is the region that satisfies the above inequalities:The question now is, is there any function in Matlab that finds every admissible pair of {x,y}? If there is an algorithm to do this kind of thing I would be glad to hear about it as well. Of course, one approach we can always use is brute force approach where we test every possible combination of {x,y} to see whether the inequalities are satisfied. But this is the last resort, because it's time consuming. I'm looking for a clever algorithm that does this, or in the best case, an existing library that I can use straight-away. The x^2+y^2>=100 and x^2+y^2<=200 are just examples; in reality f and g can be any polynomial functions of any degree. Edit: C# code are welcomed as well.  <code>  x>=0y>=0f(x,y)=x^2+y^2>=100g(x,y)=x^2+y^2<=200","Find the Discrete Pair of {x,y} that Satisfy Inequality Constriants"
[C#] Add a expander (collapse/expand) to a Panel WinForm, I have a panel containing a DataGridView and 3 buttons at the bottom of a form. I want to add the possibility to expand and collapse this panel. Is there a way to do it in a Windows Forms application?Has someone done something similar? <code> ,Add an expander (collapse/expand) to a Panel WinForm
C# Parsing hidden fields(Html Agility Pack)," I need to write an application for a friends site which parses hidden fields. I've downloaded the Html Agility Pack library, but I'm kinda confused because there are not really any examples. The HTML field looks like this: How would I go about getting the value from this field? <code>  <input type = ""hidden"" autocomplete=""off"" value=""randomvalue"" name=""foo"">",C# Parsing hidden fields with the HTML Agility Pack
Is there a way to set a dynamic breakpoint in C#?," I have a class with a list property that seems to lose an element under certain circumstances. I cannot find out when this happens.So what I'd like to do is set up a Visual Studio breakpoint that will pause the program the moment this value changes. A conditional breakpoint would not work in this scenario, since I have no idea what is removing this breakpoint.To put it another way, I want my program to stop the moment myList.Count evaluates to a new number.Any ideas on how to do this? <code> ",Breakpoint that breaks when data changes in a managed language
How to include ampersand in connection string password when using Entity Framework?," I'm using Entity Framework 4 for a simple app and would like to bake my connection credentials into the following connection string: However, the password (which I cannot change) contains an ampersand. ASP.NET throws:Configuration Error: An error occurred while parsing EntityName. Line XX, position YYY.If I replace the ampersand in the password with &amp;, I get a SqlException: Login failed for user 'myUser'. Usually this trick works, but I'm guessing that something is failing because this is technically a connection string inside a connection string.What should I do here? Most of my classes include code like: Update: It turns out that the credentials I am using are a domain account, so what I really need is Integrated Security=True in the connection string rather than a password.Encoding the ampersand as indicated in the accepted answer should work fine, though I haven't tested it. <code>  <connectionStrings> <add name=""MyEntities"" connectionString=""metadata=res://*/MyDataModel.csdl|res://*/MyDataModel.ssdl|res://*/MyDataModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=localhost\DEV;Initial Catalog=MyDB;UserId=myUser;Password=jack&jill;MultipleActiveResultSets=True&quot;"" providerName=""System.Data.EntityClient"" /></connectionStrings> using (var context = new MyEntities()) { // do work}",How to include ampersand in connection string?
C# Console App Terminating Before ASync Call Completion," I'm currently writing a C# console app that generates a number of URLs that point to different images on a web site and then downloads as byte streams using WebClient.DownloadDataAsync().My issue is that once the first asynchronous call is made, the console app considers the program to be completed and terminates before the asynchronous call can return. By using a Console.Read() I can force the console to stay open but this doesn't seem like very good design. Furthermore if the user hits enter during the process (while the console is waiting for input) the program will terminate.Is there a better way to prevent the console from closing while I am waiting for an asynchronous call to return?Edit: the calls are asynchronous because I am providing a status indicator via the console to the user while the downloads take place. <code> ",Console App Terminating Before async Call Completion
C# polymorphism," What's the difference between run-time polymorphism and compile-time polymorphism? Also, what's the difference between early binding and late binding? Examples would be highly appreciated. <code> ",C# Polymorphism
Bitwise flags and Swith statement.," I have the following code (example), and I'm really not comfortable with so many 'if' checks: Is there some way, that i could use an 'switch' statement. Maybe if I convert them to strings, or use arrays? <code>  public enum Flags { p1 = 0x01, // 0001 p2 = 0x02, // 0010 p3 = 0x04, // 0100 p4 = 0x08 // 1000}; public static void MyMethod (Flags flag){ if ((flag & Flags.p1) == Flags.p1) DoSomething(); if ((flag & Flags.p2) == Flags.p2) DosomethingElse(); if ((flag & Flags.p3) == Flags.p3) DosomethingElseAgain(); if ((flag & Flags.p4) == Flags.p4) DosomethingElseAgainAndAgain();}MyMethod(Flags.p1 | Flags.p3);",Bitwise flags and Switch statement?
Bitwise flags and Swicth statement?," I have the following code (example), and I'm really not comfortable with so many 'if' checks: Is there some way, that i could use an 'switch' statement. Maybe if I convert them to strings, or use arrays? <code>  public enum Flags { p1 = 0x01, // 0001 p2 = 0x02, // 0010 p3 = 0x04, // 0100 p4 = 0x08 // 1000}; public static void MyMethod (Flags flag){ if ((flag & Flags.p1) == Flags.p1) DoSomething(); if ((flag & Flags.p2) == Flags.p2) DosomethingElse(); if ((flag & Flags.p3) == Flags.p3) DosomethingElseAgain(); if ((flag & Flags.p4) == Flags.p4) DosomethingElseAgainAndAgain();}MyMethod(Flags.p1 | Flags.p3);",Bitwise flags and Switch statement?
"basic question about ""using"" construct"," If I use ""using"" construct, I know that the object gets automatically disposed. What happens if a statement inside an ""using"" construct raises an exception. Is the ""using"" object still disposed? If so, when? <code> ","basic about ""using"" construct"
How to Make AutoComplete TextBox in asp.net, How do I make an autocomplete TextBox in C# that binds to a data source? <code> ,How to make an autocomplete TextBox in ASP.NET?
how can i use single query to insert multiple records from Dataset into MSSQL 2005 ?," I have a dataset in ADO.NET containing multiple records from user side. I need to insert all those rows in single query into the database, in order to avoid multiple queries <code> ",How can I use single query to insert multiple records from Dataset into SQL Server 2005 ?
How to add doublequotes to a string that is inside a variable?," I have variable like: My need is that whatever string is passed to it I have to display the content inside a div with in a double quotes. So I have written something like: But how can I add the double quotes here? So that it will display like: <code>  string title = string.empty; ......<div>""+ title +@""</div>...... ""How to add double quotes""",How can I add double quotes to a string that is inside a variable?
How to add double quotes to a string that is inside a variable?," I have variable like: My need is that whatever string is passed to it I have to display the content inside a div with in a double quotes. So I have written something like: But how can I add the double quotes here? So that it will display like: <code>  string title = string.empty; ......<div>""+ title +@""</div>...... ""How to add double quotes""",How can I add double quotes to a string that is inside a variable?
Form designer breaks on abstract templated UserControl," I have a generic abstract UserControl class, SensorControl, which I want all my sensor control panels to inherit from.The problemWhen attempting to design the EthernetSensorControl (one of my inherited UserControl forms, from within Visual Studio, the following error is displayed in the form designer: The designer could not be shown for this file because none of the classes within it can be designed. The designer inspected the following classes in the file: DeviceSensorControl --- The base class 'Engine.Sensors.SensorControl' could not be loaded. Ensure the assembly has been referenced and that all projects have been built. SensorControl class: Example inherited class, EthernetSensorControl: And the call stack:at System.ComponentModel.Design.Serialization.CodeDomDesignerLoader.EnsureDocument(IDesignerSerializationManager manager)at System.ComponentModel.Design.Serialization.CodeDomDesignerLoader.PerformLoad(IDesignerSerializationManager manager)at Microsoft.VisualStudio.Design.Serialization.CodeDom.VSCodeDomDesignerLoader.PerformLoad(IDesignerSerializationManager serializationManager)at System.ComponentModel.Design.Serialization.BasicDesignerLoader.BeginLoad(IDesignerLoaderHost host) Everything compiles and I can see the panel displayed, but I can't design it. I think the problem may be related to the partial classes. Any ideas? <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Windows.Forms;namespace Engine.Sensors{ public abstract class SensorControl<SensorType> : UserControl where SensorType : class { protected SensorType _sensor; public SensorControl(SensorType sensor) { _sensor = sensor; } }} namespace Engine.Sensors{ public partial class EthernetSensorControl : SensorControl<EthernetSensor> { public EthernetSensorControl(EthernetSensor sensor) : base(sensor) { } }}",Form designer breaks on generic abstract UserControl
How can i deploy a .Net Application that uses ODAC Without installing the Whole Component to the user ?? !!," I have written a C# application that connects to an Oracle 10g database. Using Oracle Data Access Component 11.2 ""ODAC"", it works perfectly on my machine.And now I want to deploy the application and install it in another ""clean machine"" that has the .NET Framework only! And I don't want to install the whole ODAC component to the user!How could I do that? I have tried to include all the necessary DLL files to my bin folder, like:oci.dllociw32.dllOracle.DataAccess.dllorannzsbb11.dlloraocci11.dlloraociicus11.dllOraOps11w.dllmsvcr71.dllBut still it didn't work. What should I do to solve this problem? <code> ",How can I deploy a .NET application that uses ODAC without installing the whole component to the user?
C# to Vb.Net Syntax conversion for class instantiation with properties," I am working with Workflow Foundations 4 (in C#) and am trying to write a VB.NET expression. Is there a way to do the following in VB.NET on one line? <code>  SomeObj instance = new SomeObj(){ SomeStringProp = ""a"", SomeIntProp = 17};",C# to VB.NET syntax conversion for class instantiation with properties
Are there drawbacks to creating a class that encapsulates a Generic Collection?," A part of my (C# 3.0 .NET 3.5) application requires several lists of strings to be maintained. I declare them, unsurprisingly, as List<string> and everything works, which is nice.The strings in these Lists are actually (and always) Fund IDs. I'm wondering if it might be more intention-revealing to be more explicit, e.g.: ... and this works as well. Are there any obvious drawbacks to this, either technically or philosophically?  <code>  public class FundIdList : List<string> { }",Are there drawbacks to creating a class that encapsulates Generic Collection?
Calling stored procedure from C#.net?, How does one call a stored procedure in oracle from C#? <code> ,Calling Oracle stored procedure from C#?
Calling Oracle stored procedure from C#.net?, How does one call a stored procedure in oracle from C#? <code> ,Calling Oracle stored procedure from C#?
C# - GUI not updating until code is finished," Hey, I have a sequence of code that goes something like this: Basically, the GUI does not update at all, until all the code is done executing. How to overcome this? <code>  label.Text = ""update 0"";doWork();label.Text = ""update 1"";doWork2();label.Text = ""update 2"";",GUI not updating until code is finished
Convincing old school VB6 developers to make the switch to C#," I know this question could be similar to others but really I'm looking for reasons why VB6 developers should switch to C#. My company recently approved project to be written in C#, so we have a lot of VB.Net programmers, however, we have some legacy app developers as well that are in VB6. We have a time frame to re-write those apps into .Net web apps. So no matter what they will have to learn new stuff.One of the developers today specifically asked ""why should we switch to C#?"" I responded that the community largely has decided that C# is the way to go with about 80% of the examples in C#. I am a VB.Net programmer and I am excited to finally cut my teeth on C#, however, being that I'm so new I'm not sure I can answer the ""why?"" question. My reasons are more because I want to learn it.So without descending into a VB verses C# I really am curious if there are any resources that I can send to these developers to calm their nerves.Looking forward to your input! <code> ",Convincing legacy application VB6 developers to make the switch to C#
"MS SQL, C#: Timeout exception on Transaction Rollback"," I've got a strange problem. I have a .NET program and my process logic needs a long-running transaction (~20min) on a SQL Server 2005 database. That's ok, since nobody accesses the database in parallel. When something goes wrong, the transaction should be rolled back.Infrequently and without any visible pattern the Rollback() operation on my DbTransaction object throws a SqlException: I don't know if it's really a timeout problem due to the fact, that the code works sometimes and sometimes not. Furthermore the only timeouts I know are ConnectionTimeout and CommandTimeout, but obviously those aren't the problem in this case.Does anyone have an idea about this problem?Thanks a lot, Matthias <code>  Message: ""Timeout expired. The timeout period elapsed prior to completion of the operation or the server is not responding.""StackTrace: at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection) at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj) at System.Data.SqlClient.TdsParserStateObject.ReadSniError(TdsParserStateObject stateObj, UInt32 error) at System.Data.SqlClient.TdsParserStateObject.ReadSni(DbAsyncResult asyncResult, TdsParserStateObject stateObj) at System.Data.SqlClient.TdsParserStateObject.ReadPacket(Int32 bytesExpected) at System.Data.SqlClient.TdsParserStateObject.ReadBuffer() at System.Data.SqlClient.TdsParserStateObject.ReadByte() at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) at System.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest) at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransactionYukon(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest) at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest) at System.Data.SqlClient.SqlInternalTransaction.Rollback() at System.Data.SqlClient.SqlTransaction.Rollback()","SQL Server, C#: Timeout exception on Transaction Rollback"
Can a class property be of anonymous type in C# 4.0?," As in: Note: The above doesn't compile nor work (the var cannot be used there), it's only to show my point.Update: Just to clarify the question, I had already tried using and this works, but it doesn't generate intellisense because of the dynamic typing. I am aware that anonymous typing is just a compiler trick, so I hoped I could use this trick to my advantage by declaring a structured field without having to declare a class beforehand (mainly because there's only going to be one instance of this particular kind of field). I can see now that it's not possible, but I'm not sure why that is. If the compiler is simply generating an implicit type for an anonymous object, it should be fairly simply to have the compiler generate this implicit type for a field. <code>  public class MyClass { private static var MyProp = new {item1 = ""a"", item2 = ""b""};} private static dynamic MyProp = new {item1 = ""a"", item2 = ""b""};",Can a class property/field be of anonymous type in C# 4.0?
Setting Font of TextBox from code behind," How do I set the font of a TextBox from a string in the code behind? <code>  // exampletxtEditor.FontFamily = ""Consolas"";",Setting up font of TextBox from code behind
Big Parameter-List for SQL-Query, I have a big list of int parameters for a SQL query: My problem is that in SQL Server 2000 there are a limit for parameters.I could run this query on an SQL Server 2008 too.What is the better way to do this.Edit:The list of Ids come from a C# program. Not from another table. <code>  update mytable set col='xyz'where id in (/* thousands of ints */),Big parameter list for SQL query 
Big parameter list for SQL query, I have a big list of int parameters for a SQL query: My problem is that in SQL Server 2000 there are a limit for parameters.I could run this query on an SQL Server 2008 too.What is the better way to do this.Edit:The list of Ids come from a C# program. Not from another table. <code>  update mytable set col='xyz'where id in (/* thousands of ints */),Big parameter list for SQL query 
copy rows from Datatable to another Datatable c#, How can I copy specific rows from DataTable to another Datable in c#? There will be more than one row. <code> ,Copy rows from one Datatable to another DataTable?
How do static properties work in an asp.net enviroment?," If I had a class with a static property that is set when a user loads a particular page, is that static value unique to that users session?In other words, if a second user then loads the page and sets the static property, will each user have a distinct value, or will both use the second users value? <code> ",How do static properties work in an asp.net environment?
Why the 'Moq.Proxy.CastleProxyFactory' type initializer exception when using NET40-NoCastle?," So I copied the sample code from the Moq home page pretty much verbatim, and am getting a castle proxy exception.Here's my code (as a console app for an easier sample) Everything compiles nicely, but when it calls mock.Object The following exception is thrown. So it appears to be a Castle Proxy component that's missing, but I'm referencing the binary from the NET40-NoCastle directory.Latest version of Moq (Moq.4.0.10827)And I'm new to Moq, so I may be doing something extremely dense. <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using Moq;namespace MoqTestConsole{ public interface ILoveThisFramework { bool DownloadExists(string s); } class Program { static void Main(string[] args) { Mock<ILoveThisFramework> mock = new Mock<ILoveThisFramework>(); // WOW! No record/replay weirdness?! :) mock.Setup(framework => framework.DownloadExists(""2.0.0.0"")).Returns(true); // Hand mock.Object as a collaborator and exercise it, // like calling methods on it... ILoveThisFramework lovable = mock.Object; bool download = lovable.DownloadExists(""2.0.0.0""); // Verify that the given method was indeed called with the expected value mock.Verify(framework => framework.DownloadExists(""2.0.0.0"")); } }} System.TypeInitializationException was unhandled Message=The type initializer for 'Moq.Mock`1' threw an exception. Source=Moq TypeName=Moq.Mock`1 StackTrace: at Moq.Mock`1.<InitializeInstance>b__0() in d:\Code\moq\src\Source\Mock.Generic.cs:line 138 at Moq.PexProtector.Invoke(Action action) in d:\Code\moq\src\Source\PexProtector.cs:line 56 at Moq.Mock`1.InitializeInstance() in d:\Code\moq\src\Source\Mock.Generic.cs:line 136 at Moq.Mock`1.OnGetObject() in d:\Code\moq\src\Source\Mock.Generic.cs:line 153 at Moq.Mock.GetObject() in d:\Code\moq\src\Source\Mock.cs:line 152 at Moq.Mock.get_Object() in d:\Code\moq\src\Source\Mock.cs:line 147 at Moq.Mock`1.get_Object() in d:\Code\moq\src\Source\Mock.Generic.cs:line 131 at MoqTestConsole.Program.Main(String[] args) in C:\Projects\Test\MoqTestConsole\MoqTestConsole\Program.cs:line 25 at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args) at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args) at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly() at System.Threading.ThreadHelper.ThreadStart_Context(Object state) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state) at System.Threading.ThreadHelper.ThreadStart() InnerException: System.TypeInitializationException Message=The type initializer for 'Moq.Proxy.CastleProxyFactory' threw an exception. Source=Moq TypeName=Moq.Proxy.CastleProxyFactory StackTrace: at Moq.Proxy.CastleProxyFactory..ctor() at Moq.Mock`1..cctor() in d:\Code\moq\src\Source\Mock.Generic.cs:line 54 InnerException: System.IO.FileNotFoundException Message=Could not load file or assembly 'Castle.Core, Version=2.5.0.0, Culture=neutral, PublicKeyToken=407dd0808d44fbdc' or one of its dependencies. The system cannot find the file specified. Source=Moq FileName=Castle.Core, Version=2.5.0.0, Culture=neutral, PublicKeyToken=407dd0808d44fbdc FusionLog==== Pre-bind state information ===LOG: User = jsi-dev-001\jmacintyreLOG: DisplayName = Castle.Core, Version=2.5.0.0, Culture=neutral, PublicKeyToken=407dd0808d44fbdc (Fully-specified)LOG: Appbase = file:///C:/Projects/Test/MoqTestConsole/MoqTestConsole/bin/Debug/LOG: Initial PrivatePath = NULLCalling assembly : Moq, Version=4.0.10827.0, Culture=neutral, PublicKeyToken=69f491c39445e920.===LOG: This bind starts in default load context.LOG: No application configuration file found.LOG: Using host configuration file: LOG: Using machine configuration file from C:\Windows\Microsoft.NET\Framework\v4.0.30319\config\machine.config.LOG: Post-policy reference: Castle.Core, Version=2.5.0.0, Culture=neutral, PublicKeyToken=407dd0808d44fbdcLOG: Attempting download of new URL file:///C:/Projects/Test/MoqTestConsole/MoqTestConsole/bin/Debug/Castle.Core.DLL.LOG: Attempting download of new URL file:///C:/Projects/Test/MoqTestConsole/MoqTestConsole/bin/Debug/Castle.Core/Castle.Core.DLL.LOG: Attempting download of new URL file:///C:/Projects/Test/MoqTestConsole/MoqTestConsole/bin/Debug/Castle.Core.EXE.LOG: Attempting download of new URL file:///C:/Projects/Test/MoqTestConsole/MoqTestConsole/bin/Debug/Castle.Core/Castle.Core.EXE. StackTrace: at Moq.Proxy.CastleProxyFactory..cctor() InnerException: ",Why the 'Moq.Proxy.CastleProxyFactory' type initializer exception when using NET40-NoCastle?
commenting code C# visaul studio best practise," I'm looking for a rather arbitrary answer, so this might more be a discussion. I'm wondering what the best practise for commenting my C# code in visual studio is. Right now I'm using the triple /// to generate the xml and use sand castle to build a chm or html file. But my problem is that I use code comments for two reasons:When other developers are using my code they can read the documentation, both intellisence and the chm. or html file.But I also use commenting as reminders to myself. So I can remember my thoughts when I come back half a year later, to some complex methods.How can both goals be accomplished without interfering with each other, and in the same time be a quick task, not taking a lot of coding time? <code> ",commenting code C# visual studio best practice
commenting code C# visual studio best practise," I'm looking for a rather arbitrary answer, so this might more be a discussion. I'm wondering what the best practise for commenting my C# code in visual studio is. Right now I'm using the triple /// to generate the xml and use sand castle to build a chm or html file. But my problem is that I use code comments for two reasons:When other developers are using my code they can read the documentation, both intellisence and the chm. or html file.But I also use commenting as reminders to myself. So I can remember my thoughts when I come back half a year later, to some complex methods.How can both goals be accomplished without interfering with each other, and in the same time be a quick task, not taking a lot of coding time? <code> ",commenting code C# visual studio best practice
How to see list of posible exception in some Class.(C#.NET)," I have a lot of classes that have been written in C#.NET, and I need to know what exceptions can be thrown by them. How I can do it in Visual Studio 2005. <code> ",How to see list of possible exception in some Class.(C#.NET)
Why C# member names can't be the same as the enclosing type name?," In C#, the following code doesn't compile: The question is: why?More exactly, I understand that this doesn't compile because (I quote): member names cannot be the same as their enclosing typeOk, fine. I understand that, I won't do it again, I promise.But I really don't understand why the compiler refuses to take any field having the same name as an enclosing type. What is the underlying issue that prevents me to do that? <code>  class Foo { public string Foo;}",Why can't C# member names be the same as the enclosing type name?
C# Splitting a string with uppercase," Possible Duplicates: Split a PascalCase string into separate words is there a elegant way to parse a word and add spaces before capital letters Is there a simple way to split this string""TopLeft"" to ""Top"" and ""Left"" <code> ",Splitting a string with uppercase
Alllow only numeric entry in WPF Text Box," I will like to validate user entry to ensure they are integers. How can I do it? I thought of using IDataErrorInfo which seems like the ""correct"" way to do validation in WPF. So I tried implementing it, in my ViewModel.But the thing is my text box is bound to an integer field, and there isn't any need to validate if an int is an int. I noticed that WPF automatically adds a red border around the textbox to notify the user of the error. The underlying property doesn't change to an invalid value. But I would like to notify the user of this. How can I do it? <code> ",Allow only numeric entry in WPF Text Box
what are assemblies ? , I have heard many times the word assemblies. Still I don't know what they are and its uses in programming language.  <code> ,What are assemblies ? 
C# removing strings from end of string," I have an array of strings: And I have a textbox that a user enters text into. If they type any string in the remove array at the end of the text in the textbox, it should be removed. What is the easiest way to do this?EDIT To clarify, I'm making a time parser. When you give the function a string, it does its best to parse it into this format: 08:14pm I have a textbox to test it. When the focus leaves the textbox, I need to get the text without the am/pm/a/p suffix so I can parse the number only segment. <code>  string[] remove = { ""a"", ""am"", ""p"", ""pm"" };",C# removing substring from end of string
c# why doesn't datagridview refresh?," here is what happens after i press a button: please note that i am doing this with another control called chart1 and it works fine with it, it populates it with the new requeried data, but datagridview is just staying the samethe first attempt is successful.however the second time i press it, it display the same thing!anyone know whether i am refreshing the datagridview correctly? <code>  dataGridView1.DataSource = ConnectandReadList(some_query); dataGridView1.Refresh();",why doesn't datagridview refresh?
Alternative method to maximising the Console Window - C#," I'm creating a prototype for a piece of functionality that I will be implementing in an application, specifically I am displaying data from a collection to the console window but unfortunately some of the lines span wider than the default width of the console window.I've done a bit of digging and found that the only way to increase the width of the window is to dig into the Kernel32.dll and do it manually.As elegant as pInvoke is, does a ""shorter"" way exist to increase the width e.g. (Console.Width = 300) or is using the Kernel32.dll the only way.Thanks! <code> ",How to increase the size of the console window in C#?
What's a static function in c#?," What does it mean when you add the static keyword to a method? Can you add the static keyword to class? What would it mean then? <code>  public static void doSomething(){ //Well, do something!}","What's a ""static method"" in C#?"
What's a static method in c#?," What does it mean when you add the static keyword to a method? Can you add the static keyword to class? What would it mean then? <code>  public static void doSomething(){ //Well, do something!}","What's a ""static method"" in C#?"
Namespaces for XSLT using .NET," i use the following XSLT by using XMLSpy: If i try to use it in my source (XslCompiledTransform) i get an exception telling me that the function 'lower-case()' is not part of the XSLT synthax.So i changed the transformation a little bit: Now my exception is that the script or external object prefixed by 'http://www.w3.org/2005/xpath-functions' can not be found.Whats the matter here? How can i fix it?Regards <code>  <?xml version=""1.0"" encoding=""UTF-16""?><xsl:stylesheet version=""2.0"" xmlns:xsl=""http://www.w3.org/1999/XSL/Transform"" xmlns:xs=""http://www.w3.org/2001/XMLSchema"" xmlns:fn=""http://www.w3.org/2005/xpath-functions""> <xsl:output method=""xml"" version=""1.0"" encoding=""UTF-16"" indent=""yes""/> <xsl:template match=""*""> <xsl:element name=""{lower-case(local-name())}""> <xsl:apply-templates select=""@*""/> <xsl:apply-templates select=""* | text()""/> </xsl:element> </xsl:template> <xsl:template match=""@*""> <xsl:attribute name=""{lower-case(local-name())}""><xsl:value-of select="".""/></xsl:attribute> </xsl:template></xsl:stylesheet> fn:lower-case",XSLT lower-case using .NET
Date Difference in Years C#, How can I calculate date difference between two dates in years?For example: (Datetime.Now.Today() - 11/03/2007) in years. <code> ,Date difference in years using C#
How to get the SSN in the general format of xxx-xx-xxxx from xxxxxxxxx," I am getting a social security number (SSN) from a data warehouse. While posting it to a CRM I want it to be formatted like XXX-XX-XXXX instead of XXXXXXXXX.It's like converting a simple string with dashes at positions 4 and 7. I am pretty new to C#, so what is the best way to do this? <code> ",Format a Social Security Number (SSN) as XXX-XX-XXXX from XXXXXXXXX
c# is there a way to print as landscape?," I am converting a control to a bitmap and print it: How can you specify to print it in landscape orientation? <code>  using (MemoryStream ms = new MemoryStream()){ chart1.SaveImage(ms, ChartImageFormat.Bmp); Bitmap bm = new Bitmap(ms); PrintDocument doc = new PrintDocument(); doc.PrintPage += (s, ev) => { ev.Graphics.DrawImage(bm, Point.Empty); // adjust this to put the image elsewhere ev.HasMorePages = false; }; doc.Print();}",printing an image in landscape orientation?
Winforms; is there a way to print as landscape?," I am converting a control to a bitmap and print it: How can you specify to print it in landscape orientation? <code>  using (MemoryStream ms = new MemoryStream()){ chart1.SaveImage(ms, ChartImageFormat.Bmp); Bitmap bm = new Bitmap(ms); PrintDocument doc = new PrintDocument(); doc.PrintPage += (s, ev) => { ev.Graphics.DrawImage(bm, Point.Empty); // adjust this to put the image elsewhere ev.HasMorePages = false; }; doc.Print();}",printing an image in landscape orientation?
"C# Unit Test , how to test Greater than"," In C# how can I unit test a greater than condition? I.e., iIf record count is greater than 5 the test succeed.Any help is appreciatedCode: <code>  int actualcount = target.GetCompanyEmployees().CountAssert. ?","C# unit test, how to test greater than"
I need c# function that will calculate median, I need to write function that will accept array of decimals and it will find the median.Is there a function in the .net Math library? <code> ,Calculate median in c#
Ternary operator VB vs C#: why resolves to integer and not integer?," I just shoot myself in the foot and would like to know whether there were actual reasons to make this situation possible.And anyway, this question can stay for the convenience of the future foot shooters.Suppose we have a nullable value in vb.net: We want to assign a value to it, basing on a condition, and using a ternary operator, because it's so neat and stuff: That is, if a condition is true, employ the nullability, otherwise the value.At which point the shooting occurs. For no apparent reason VB compiler decides that the common base type for Nothing and Integer is Integer, at which point it silently translates the statement to: Now, if you were to do this in C#: You would immediately get a compiler error saying that <null> doesn't mix well with int. Which is great, as my foot would have been healthier had I went the C# way this time. And for this to compile, you have to explicitly write: Now, you can do the same in VB and get the correct null-ness you would expect: But that requires having your foot shot in the first place. There's no compiler error and there's no warning. That's with Explicit On and Strict On.So my question is, why?Should I take this as a compiler bug?Or can someone explain why the compiler behaves this way? <code>  Dim i as Integer? i = If(condition(), Nothing, 42) i = If(condition(), 0, 42) i = (condition()) ? null : 42; i = (condition()) ? null : (int?)42; i = If(condition(), Nothing, CType(42, Integer?))",Ternary operator VB vs C#: why resolves Nothing to zero?
Compiling a IronPython code to EXE or DLL, Can I compile an IronPython code to EXE or DLL in a .NET runtime? <code> ,Compiling an IronPython code to EXE or DLL
How do I choose between a Semaphore and SemaphoreSlim?, Their public interfaces appear similar. The documentation states that the SemaphoreSlim is a lightweight alternative and doesn't use Windows Kernel semaphores. This resource states that the SemaphoreSlim is much faster. In what situations does the SemaphoreSlim make more sense over the Semaphore and vice versa? <code> ,How do I choose between Semaphore and SemaphoreSlim?
C# polymorphism in templates," basically, I have a custom insert function that takes a new item and a list to put it in, and it does some 'sorting' stuff to find a good place to put it in the list.problem is, I want to do this based on properties in 'Base' so it would be good to have just one function that could do this for all lists of sub types.I think what I kind of want is: but with some way of clarifying T like: 'where T is a sub class of Base' <code>  class Base{}class Sub : Base{}void AddNewBase(Base t, LinkedList<Base> list){ ... }...{ Sub asub = new Sub(); LinkedList<Sub> asubList = new LinkedList<Sub>(); AddNewBase(asub,asubList) // doesn't work} static void AddNewBase<T>(T t, LinkedList<T> list){ ... }",C# polymorphism in Generic types
What actually happends when a Byte overflows_, What actually happens when a Byte overflows?Say we have If we now do this addition I think we'll end up with byte3 = 94 but what actually happens? Did I overwrite some other memory somehow or is this totally harmless? <code>  byte byte1 = 150; // 10010110 byte byte2 = 199; // 11000111 byte byte3 = byte1 + byte2;,What actually happens when a Byte overflows?
Create multiple threads and wait all of them to complete, How can I create multiple threads and wait for all of them to complete? <code> ,Create multiple threads and wait for all of them to complete
[C#] n-dimensional Array," I want to create an n-dimensional array of doubles. At compile-time, the number of dimensions n is not known.I ended up defining the array as a dictionary, with the key being an array of ints corresponding to the different axes (so in a 3-dimensional array, I'd supply [5, 2, 3] to get the double at (5, 2, 3) in the array.However, I also need to populate the dictionary with doubles from (0, 0, ... 0) to (m1, m2, ... mn), where m1 to mn is the length of each axis.My initial idea was to create nested for-loops, but as I still don't know how many I'd need (1 for each dimension), I can't do this at compile-time.I hope I've formulated the question in an understandable manner, but feel free to ask me to elaborate parts. <code> ",n-dimensional Array
C# - Create MS Word file without having MS Word installed," How can I create Word files in C# using Visual Studio 2008, without Word on my PC?Do I need to have Word installed on my PC, to be able to create Word files using Visual Studio 2008?Thanks in advance! <code> ",Programmatically create MS Word file without having MS Word installed
C# passing extra parameters to an event handler?, Let's say I want to pass some extra data when assigning an event handler. Consider the following code: How would I go about getting someData into my evHandler method? <code>  private void setup(string someData){ Object.assignHandler(evHandler);}public void evHandler(Object sender){ // need someData here!!!},Pass extra parameters to an event handler?
incorrect stacktrace by rethrow," I rethrow an exception with ""throw;"", but the stacktrace is incorrect: The right stacktrace should be: But I get: But line 15 is the position of the ""throw;"". I have tested this with .NET 3.5. <code>  static void Main(string[] args) { try { try { throw new Exception(""Test""); //Line 12 } catch (Exception ex) { throw; //Line 15 } } catch (Exception ex) { System.Diagnostics.Debug.Write(ex.ToString()); } Console.ReadKey();} System.Exception: Test at ConsoleApplication1.Program.Main(String[] args) in Program.cs:Line 12 System.Exception: Test at ConsoleApplication1.Program.Main(String[] args) in Program.cs:Line 15",Incorrect stacktrace by rethrow
Select case in linq," how can I translate this into LINQ? Thank you! <code>  select t.age as AgeRange, count(*) as Usersfrom ( select case when age between 0 and 9 then ' 0-25' when age between 10 and 14 then '26-40' when age between 20 and 49 then '60-100' else '50+' end as age from user) tgroup by t.age",Select case in LINQ
automatic resize listboxes," I have a Windows Form with two list boxes on it. Also there is a label on top of each of them When the user resizes the form (for example maximizes it), I would like the list boxes to automatically expand in height: <code>  listbox1| || ||______|listbox2| || ||______| listbox1| || || || ||______|listbox2| || || || ||______|",Automatically resize list boxes when resizing a form.
What is the C# lambda equivalent for this Linq query?," In this example: What is the pure c# equivalent? I get this... but the into clause is a bit of a mystery, and I can't figure out how to get the Key from the Select. <code>  public void Linq40(){ int[] numbers = { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 }; var numberGroups = from n in numbers group n by n % 5 into g select new { Remainder = g.Key, Numbers = g }; foreach (var g in numberGroups) { Console.WriteLine(""Numbers with a remainder of {0} when divided by 5:"", g.Remainder); foreach (var n in g.Numbers) { Console.WriteLine(n); } }} var numberGroups = numbers.GroupBy(n => n % 5)...",What is the C# extension methods equivalent for this Linq query?
What does one question mark following a variable (DateTime) mean?," Whilst playing around in an open source project, my attempt to ToString a DateTime object was thwarted by the compiler. When I jumped to the definition, I saw this: Might someone please enlighten me on what this is called and why it might be useful? <code>  public DateTime? timestamp;",What does one question mark following a variable declaration mean?
[ASP.Net] How to configure an Http Handler in IIS 7?," Here's what I want to do:I've created a class library projectand this has a class implementingthe IHttpHandler interface. Let'scall this class ZipHandler. Let'ssay the namespace is Zip.I want that whenever any Httprequest comes for a zip file, myZipHandler should handle it,regardless of whether the request isto an Asp.Net application or anormal virtual directory.Queries:Is it possible (it should be giventhe hype about integrated pipelineetc. in IIS 7)?How to do it? <code> ",How to configure an Http Handler in IIS 7?
Differences betweens user created structs and framework structs in .NET, Why C# compiler does not allow you to compile this: but does allow you to compile: where MyStruct is defined as: Update: in the firsts case the error is: Error 1 Use of unassigned local variable 'a' <code>  int a;Console.WriteLine(a); MyStruct a;Console.WriteLine(a); struct MyStruct{},Differences between user created structs and framework structs in .NET
Can I send webrequest via specified ip address with .NET Framework?," I have a server with multi ip addresses. Now I need to communicate with several servers with http protocol. Each server only accept the request from a specified ip address of my server. But when using WebRequest(or HttpWebRequest) in .NET , the request object will choose a ip address automatically. I can't find anyway to bind the request with a address. Is there anyway to do so ? Or I have to implement a webrequest class myself ? <code> ",Can I send webrequest from specified ip address with .NET Framework?
Importing a DSA key from xml string fails for one user. Permissions? Broken installation?," A user recently reported a weird error when using my software. I use DSA signatures to verify licenses. When the software imports the public key to verify a signature, the DSA provider's FromXmlString method throws a CryptographicException with the description ""Key not valid for use in specified state.""It would appear that the _OpenCSP method called from System.Security.Cryptography.Utils.CreateProvHandle returns a NTE_BAD_KEY_STATE (0x8009000b). This is the first time anyone has reported this error to me, and that code has not changed for years.What are the likely causes of this? A masked permissions error? A broken CAPI installation? Blocked by .net trust/permissions settings? Junk stored by a key storage provider, or a KSP returning something unexpected to cryptoapi?I have googled the error code/description/etc but didn't come across any real answers as to what might cause this...An isolated version of the code that fails is here:http://forum.huagati.com/getattachment.ashx?fileid=78 ...and on the affected user's machine it returns: Update: The same code works fine when running under .net fx 2.0 on the same machine, but fails under .net fx 4.0.Update 2: It appears that the DSA provider looks for keys stored under %APPDATA%\Microsoft\Crypto\DSS\[SID] even then initializing with an existing key. Could there be a conflict with this mechanism? Anyone know more about how that key storage thing operates, and why it is hit when loading a public key from a string? <code>  using System;using System.Security.Cryptography;using System.Reflection;public class Test{ public static void Main() { try { string key = ""<DSAKeyValue><P>wrjxUnfKvH/1s5cbZ48vuhTjflRT5PjOFnr9GeUPZSIoZhYATYtME4JRKrXBtSkyioRNtE1xgghbGAyvAJ5jOWw88fLBF+P1ilsZyq72G1YcbB+co8ImQhAbWKmdCicO9/66Th2MB+7kms/oY3NaCzKEuR7J3b23dGrFpp4ccMM=</P><Q>xmxoSErIJCth91A3dSMjC6yQCu8=</Q><G>bwOLeEaoJHwSiC3i3qk9symlG/9kfzcgrkhRSWHqWhyPAfzqdV1KxJboMpeRoMoFr2+RqqKHgcdbzOypmTeN4QI/qh4nSsl5iEfVerarBOrFuRdOVcJO0d8WE233XQznd1K66nXa5L8d9SNZrM6umZ1YuBjhVsTFdPlIXKfGYhk=</G><Y>wZnEEdMUsF3U3NBQ8ebWHPOp37QRfiBn+7h5runN3YDee1e9bC7JbJf+Uq0eQmU8zDs+avEgD68NpxTKEHGr4nQ3rW6qqacj5SDbwO7nI6eN3wWrVhvrWcQm0tUO93m64HsEJREohfoL+LjqgrqIjZVT4D1KXE+k/iAb6WKAsIA=</Y><J>+zmcCCNm2kn1EXH9T45UcownEe7JH+gl3Lw2lhVzXuX/dYp5sGCA2lK119iQ+m3ogjOuwABATCVFLo6J66DsSlMd0I8WSD5WKPvypQ7QjY0Iv71J2N0FW0ZXpMlk/CE8zq4Z7arM1N564mNe</J><Seed>QDrZrUFowquY5Uay8YtUFOXnv28=</Seed><PgenCounter>Gg==</PgenCounter></DSAKeyValue>""; DSACryptoServiceProvider csp2 = new DSACryptoServiceProvider(); csp2.FromXmlString(key); Console.WriteLine(""Success!""); } catch (Exception ex) { int hResult = 0; try { PropertyInfo pi = typeof(Exception).GetProperty(""HResult"", BindingFlags.NonPublic | BindingFlags.Instance); hResult = (int)pi.GetValue(ex, null); } catch (Exception ex2) { Console.WriteLine(""HResult lookup failed: "" + ex2.ToString()); } Console.WriteLine(""Initializing CSP failed: "" + ex.ToString() + ""\r\nHResult: "" + hResult.ToString(""x"")); } Console.WriteLine(""\r\nPress Enter to continue""); Console.ReadLine(); }} Initializing CSP failed: System.Security.Cryptography.CryptographicException: Key not valid for use in specified state.at System.Security.Cryptography.Utils.CreateProvHandle(CspParameters parameters, Boolean randomKeyContainer)at System.Security.Cryptography.Utils.get_StaticDssProvHandle()at System.Security.Cryptography.DSACryptoServiceProvider.ImportParameters(DSAParameters parameters)at System.Security.Cryptography.DSA.FromXmlString(String xmlString)at Test.Main()HResult: 8009000b",Importing a DSA key from xml string fails for one user. Permissions? Broken installation? Bad KSP?
How to replace an Paragraph's text using OpenXMLSdk," I am parsing some Openxml word documents using the .Net OpenXml SDK 2.0. I need to replace certain sentences with other sentences as part of the processing. While iterating over the paragraphs, I know when I've found something I need to replace, but I am stumped as to how I can replace it. For example, lets say I need to replace the sentence ""a contract exclusively for construction work that is not building work."" with a html snippet to a Sharepoint Reusable content below.<span class=""ms-rtestate-read ms-reusableTextView"" contentEditable=""false"" id=""__publishingReusableFragment"" fragmentid=""/Sites/Sandbox/ReusableContent/132_.000"" >a contract exclusively for construction work that is not building work.</span>PS: I got the docx to Html conversion worked out using xslt, so that is kind of not a problem at this stageThe InnerText property of the Paragraph node gives me the proper text, but the inner text property itself is not settable. So Regex.Match(currentParagraph.InnerText, currentString).Successreturns true and tells me that the current paragraph contains the text I want.As I said, InnerText itself is not settable, so I tried created a new paragraph using outerxml is given below. Even though I am not too concerned about the formatting at this level and it doesn't seem to have any, the outerXML seems to have extra elements that defeat the regex. ...""16"" /><w:lang w:val=""en-AU"" /></w:rPr><w:t>a</w:t></w:r><w:proofErr w:type=""gramEnd"" /> <w:r w:rsidRPr=""00C73B58""><w:rPr><w:sz w:val=""16"" /><w:szCs w:val=""16"" /><w:lang w:val=""en-AU"" /></w:rPr><w:t xml:space=""preserve""> contract exclusively for construction work that is not building work.</w:t></w:r></w:p>So in summary, how would I replace the text in a Paragraph of OpenXml with other text. Even at the expense of losing some of the formatting. <code>  string modifiedOuterxml = Regex.Replace(currentParagraph.OuterXml, currentString, reusableContentString);OpenXmlElement parent = currentParagraph.Parent;Paragraph modifiedParagraph = new Paragraph(modifiedOuterxml);parent.ReplaceChild<Paragraph>(modifiedParagraph, currentParagraph);",How to replace an Paragraph's text using OpenXML Sdk
Authenticating WCF IPC from GUI to Windows Service," My GUI application controls its sister Windows Service using WCF's NetNamedPipeBinding. I want to prevent other applications from impersonating my GUI application and controlling my service.Is it necessary to authenticate the GUI application to the Windows Service to prevent impersonation?And how should I go about it?Edit: Remote computers should also be able to control the service given that they are authenticated (trusted by the service), so I need to add a NetTcpBinding endpoint. Any answer that incorporates this as well, would be helpful. <code> ",Authenticate WCF for IPC and Remote Access
Get SamAccountName from a UserPrinciple object," I am using the System.DirectoryServices.AccountManagement part of the .Net library to interface into ActiveDirectory.Having called GetMembers() on a GroupPrincipal object and filter the results, I now have a collection of UserPrincipal objects The above code sample will print out usernames like ""TestUser1"". I need to compare these to a list coming from another application in ""DOMAIN\TestUser1"" format.How do I get the ""DOMAIN"" part from the UserPrincipal object?I can't just append a known domain name as there are multiple domains involved and I need to differentiate DOMAIN1\TestUser1 and DOMAIN2\TestUser2. <code>  GroupPrincipal myGroup; // population of this object omitted here foreach (UserPrincipal user in myGroup.GetMembers(false).OfType<UserPrincipal>()){ Console.WriteLine(user.SamAccountName);}",Get nETBIOSName from a UserPrincipal object
difference between ObservableCollection and BindingList," I want to know the difference between ObservableCollection and BindingList because I've used both to notify for any add/delete change in Source, but I actually do not know when to prefer one over the other.Why would I choose one of the following over the other? or  <code>  ObservableCollection<Employee> lstEmp = new ObservableCollection<Employee>(); BindingList<Employee> lstEmp = new BindingList<Employee>();",Difference between ObservableCollection and BindingList
"Windows phone 7, silverlight - How to catch EndpointNotFoundException when calling async web serice?", I'm calling a web service from within a Silverlight Windows phone 7 application which works fine if the web service is available. If the web service is unavailable then an unhandled exception is caught but I don't seem able to catch it myself. My attempt is as follows: But this doesn't catch the exception and obviously GetSuppliersCompleted never get's called so I can't catch it there.I then thought I may be able to detect it by checking the connection state (proxy.State) but this despite the web service not running returns CommunicationState.Opened.Any idea's where I can handle this?Apologies if I've missed something but I have searched and not found a solution. <code>  //Get list of providers from Webservice RSAServiceClient proxy = new RSAServiceClient(); proxy.GetSuppliersCompleted += new System.EventHandler<GetSuppliersCompletedEventArgs>(ProxyGetSuppliersCompleted); try { proxy.GetSuppliersAsync(); } catch (EndpointNotFoundException) { //TODO: Handle webserice not being available } catch (Exception) { throw; },"Windows phone 7, silverlight - How to catch EndpointNotFoundException when calling async web service?"
can C# apps run without .NET framework?," I intend to learn C# and start coding Windows .exe applications, but the only thing that is holding me back is that not all potential users have the .NET framework installed and therefore would be unable to run my application.Is there any way around it?Thanks! <code> ",Can C# apps run without the .NET framework?
Error: Deleted row information cannot be accessed through the row. (C#)," To whom this may concern, I have searched a considerable amount of time, to work a way out of this error ""Deleted row information cannot be accessed through the row""I understand that once a row has been deleted from a datatable that it cannot be accessed in a typical fashion and this is why I am getting this error. The big issue is that I am not sure what to do to get my desired result, which I will outline below.Basically when a row in ""dg1"" is deleted the row beneath it takes the place of the deleted row (obviously) and thus inherits the deleted rows index. The purpose of this method is to replace and reset the rows index (via grabbing it from the corresponding value in the dataset) that took the deleted rows place and as such the index value.Right now I am just using a label (lblText) to try and get a response from the process, but it crashes when the last nested if statement trys to compare values.Here is the code: Thanks ahead of time for the help, I really did search, and if it is easy to figure out through a simple google search then allow myself to repeatably hate on me, because I DID try.gc <code>  void dg1_Click(object sender, EventArgs e) { rowIndex = dg1.CurrentRow.Index; //gets the current rows string value = Convert.ToString(dg1.Rows[rowIndex].Cells[0].Value); if (ds.Tables[0].Rows[rowIndex].RowState.ToString() == ""Deleted"") { for (int i = 0; i < dg1.Rows.Count; i++) { if (Convert.ToString(ds.Tables[0].Rows[i][0].ToString()) == value) // ^ **where the error is occurring** { lblTest.Text = ""Aha!""; //when working, will place index of compared dataset value into rowState, which is displaying the current index of the row I am focussed on in 'dg1' } } }",Error: Deleted row information cannot be accessed through the row
Is Ruby's code block same as C#'s lamda expression?, Are these two essentially the same thing? They look very similar to me. Did lambda expression borrow its idea from Ruby? <code> ,Is Ruby's code block same as C#'s lambda expression?
"How do I write Func<IList<T>, T>?"," Specifically, I want to write this: But I get a syntax error at T. Can't I have a generic anonymous method? <code>  public Func<IList<T>, T> SelectElement = list => list.First();",How can I write a generic anonymous method?
Deserialization of an array of custom classes always gives an array of nulls," I have a custom abstract base class with sub classes that I've made serializable/deseriablizeable with ISerializable. When I do serialization/deserialization of single instances of this class' sub classes, everything works fine. However, when I do an array of them I always end up with an array of nulls on deserialization. Serialization is done with BinaryFormatter.The items are contained within a: On serialization this is done in GetObjectData on the SerializationInfo parameter: And on deserialization this is done in the serialization constructor also on the SerializationInfo parameter: Deserialization always gives me an array of nulls and as I mentioned earlier, a single item serializes and deseriaizes just fine with this code:Serialization (GetObjectData method): Deserialization (Serialization Constructor): Is this a common problem? I seem to find no occurrences of anyone else running in to it at least. Hopefully there is a solution :) and if I need to supply you with more information/code just tell me.Thanks! <code>  public ObservableCollection<Trade> Trades { get; private set; } Trade[] trades = (Trade[])Trades.ToArray<Trade>(); info.AddValue(""trades"", trades); Trade[] trades = (Trade[])info.GetValue(""trades"", typeof(Trade[])); foreach (Trade t in trades) { Trades.Add(t); } info.AddValue(""trade"", Trades.First<Trade>()); Trade t = (Trade)info.GetValue(""trade"", typeof(Trade)); Trades.Add(t);",Deserialization of an array always gives an array of nulls
"why Syste,drawing.Color.Green is (0, 128,0)"," I thought it should be (0,255,0). Anyone know why? <code> ","Why is System.Drawing.Color.Green (0, 128,0)?"
"Why System.Drawing.Color.Green is (0, 128,0)?"," I thought it should be (0,255,0). Anyone know why? <code> ","Why is System.Drawing.Color.Green (0, 128,0)?"
In C# when is a value/object copied and when is its reference copied?," I keep getting the same issue over and over again where an object I want to reference is copied or where an object I want to copy is referenced. This happens when I use the = operator.For example, if I am sending the object to another form, ie: ...and then modify the object in the form, the original object does not get modified. It is as if the object was copied and not referenced. Yet, when I do this: ...and then modify anotherObject, myObject gets modified as well.The most aggravating case is when I try to Clone one of my defined objects: when I do this... ...obj1 is referenced and any modifications to obj2 changes obj1.System objects such as int, double, string, etc seem to always be copied, except for in the case of the clone method above.My question is, not taking into account the use of the ref keyword in functions, when does an object get copied and when does an object get referenced in every case of the matter (i.e. when passing to functions, when setting as other objects (like the first two above examples), when copying member variables like the third example, etc.)? <code>  SomeForm myForm = new SomeForm();SomeObject myObject = new SomeObject();myForm.formObject = myObject; SomeObject myObject = new SomeObject();SomeObject anotherObject = new SomeObject();anotherObject = myObject; public class SomeObject{ double value1, value2; //default constructor here public SomeObject(val1, val2) { value1 = val1; value2 = val2; } public void Clone(SomeObject thingToCopy) { this.value1 = thingToCopy.value1; this.value2 = thingToCopy.value2; }} SomeObject obj1 = new SomeObject(1, 2);SomeObject obj2 = new SomeObject();obj2.Clone(obj1);",When is a C# value/object copied and when is its reference copied?
Resize or Load a texture2d in XNA," i'm a newbie in XNA just in case. What i try to do is load a texture in a different size from his original, or at least have the possibility to change his size after. I see in some places that i can use: But i also read that loading textures in this way is ignoring the ContentManager, and that i'm making the job for the garbage collector more difficult.What is the Correct way to load an image in any size, using the ContentManager ?If that isn't possible can i change his size proportionally, like using a zoom?Context:I'm creating a board of n x n peaces. When n is too big i need that automatically the peaces becomes more smaller. <code>  Texture2D.FromStream(GraphicsDevice graphicsDevice, Stream stream, int width, int height, bool zoom)",Resize and Load a texture2d in XNA
How do I show console output/window in a forms application?," To get stuck in straight away, a very basic example: If I compile this with default options (using csc at command line), as expected, it will compile to a console application. Also, because I imported System.Windows.Forms, it will also show a message box.Now, if I use the option /target:winexe, which I think is the same as choosing Windows Application from within project options, as expected I will only see the Message Box and no console output.(In fact, the moment it is launched from command line, I can issue the next command before the application has even completed).So, my question is - I know that you can have ""windows""/forms output from a console application, but is there anyway to show the console from a Windows application? <code>  using System;using System.Windows.Forms;class test{ static void Main() { Console.WriteLine(""test""); MessageBox.Show(""test""); }}",How do I show a console output/window in a forms application?
Automatically close messagebox in c#, I am currently developing an application in C# where I display a MessageBox. How can I automatically close the message box after a couple of seconds? <code> ,Automatically close messagebox in C#
How do I escape characters in c# comments?," I realized today that I don't know how to escape characters in comments for C#. I want to document a generic C# class, but I cannot write a proper example since I don't know how to escape the < and > characters. Do I have to use &lt; and &gt;? I don't like if that is the case since I want to make it easy to read the comment in the actual document so I don't have to generate some kind of code document to be able to read the example code. <code> ",How do I escape characters in C# comments?
Storing a Lamda Expression in a Variable, I think my brain has become fried as i'm struggling to do something simple. In my application i have the following code to configure Nhibernate (my issue is not specific to Nhibernate). However I need to store the configuration (the stuff inside ExposeConfiguration) inside a private variable. I can do the following: Where _configuration is a private variable. But this doesn't add my extra configuration options (the EventListeners stuff). I've played around with various things but i guess my lambda knowledge isn't as good as i thought.I'd appreciate your help. Thanks <code>  return Fluently.Configure() .ExposeConfiguration(c => { c.EventListeners.PostInsertEventListeners = new IPostInsertEventListener[] { new LoggingEventListener() }; c.EventListeners.PostUpdateEventListeners = new IPostUpdateEventListener[] { new LoggingEventListener() }; }); return Fluently.Configure() .ExposeConfiguration(c => _configuration = c);,Storing a Lambda Expression in a Variable
How to build an and-or tree in C#?," I need a tree structure that supports ""and"" and ""or""ing. For example, given a regular expression like ab|c(d|e) I want to turn that into a tree.So, at first we have two ""or"" branches... it can either go down ab, or c(d|e). If you head down the ab branch, you get two nodes, a and b (or a followed by b, whatever). Then if you go down the c(d|e) branch, you get c and (d|e), then (d|e) is split into d or e.Making a tree structure is easy, you just have something like But then how do you know if the children should be ""anded"" or ""ored""? I guess each level of the tree should alternate between ""anding"" and ""oring""Does that make sense? Can anyone suggest a structure for this?A few people have suggested storing the ""operator"" on the node, which is fine, but isn't there a way to take advantage of the fact that each level always alternates or,and,or,and,...?Edit: Not quite sure why people keep assuming this is a binary tree. It's not. I was hoping the tiny code snippet would tip you off. The example just happens to have only 2 branches.Currently leaning towards this: <code>  class Node { string element; Node[] children;} abstract class Node { }class DataNode : Node{ string data;}abstract class OpNode : Node{ Node[] children;}class OrNode : OpNode { }class AndNode : OpNode { }",How to build an and-or tree?
How do I ensure c# Process.Start will expand environment variables?," I'm attempting to create a process like so: Now the environment variable ""red_root"" definitely exists in the spawned process' environment variables, but the execute doesn't seem to expand the environment variable and so the file isn't found. How can I get the Process.Start to expand the environment variable in the file name? <code>  var psi = new ProcessStartInfo{ FileName = @""%red_root%\bin\texturepreviewer.exe"", UseShellExecute = true};var process = Process.Start(psi);process.WaitForExit();",How do I ensure C#'s Process.Start will expand environment variables?
"Is there a built-in create an absolute url from a relative path such as ""~/page.aspx"" given the current URL?"," Scenario is I have a application relative url like ""~/path/to/page.aspx?query=string"". I need to programatically create a web request to that page and currently using WebRequest.Create. The problem is WebRequest.Create requires a fully qualified url including the protocol/domain/port etc. I have access to the current Request.Url object but there doesn't seem to be an easy way to get just the base url keeping the protocol (HTTP vs HTTPS) as well as any port numbers as well as the path to the application.I mean all the info there, so if need be I could just take all the parts and combine them but it seems like it might be error prone and it would be great to have something built-in that's well tested to do the job. Page.ResolveUrl gets me almost there, but it's missing the protocol and the domain/port. <code> ","Is there a built-in create an absolute (fully qualified) url from a relative path such as ""~/page.aspx"" given the current URL?"
.net enum to lower case ," I have the following enum in an ASP.NET MVC application, and I want to use that enum as a parameter. To do so, I'd like to to return the lowercase string representation of that enum. How can I get the lowercase representation of an enum in C#? I'd like for the enums to retain their natural titlecase representation as well. <code>  public enum SortOrder { Newest = 0, Rating = 1, Relevance = 2 }",How do I get the lowercase representation of an enum in C#?
MenuItem missing Icon/Image.," Im getting menuItem icon appearing only on last menuItem.If i snoop the app only last menuItem has image in icon, while if i debug all MenuItems appear to have image in icon. Also if i add submenuItem the icon on menuItem dissapears once i open submenus and the last submenu gets the icon... Any idea? PS: also tooltips on menu item dont work.Im using caliburn micro and fluent ribbon controls. <code>  <ControlTemplate x:Key=""dropDownButton""> <ef:DropDownButton Header=""{Binding DisplayName}"" ItemsSource=""{Binding Items}"" LargeIcon=""{Binding LargeIconPath}"" cm:Message.Attach=""ClickAction()"" ef:KeyTip.Keys=""{Binding KeyTip}""> <ef:DropDownButton.ItemContainerStyle> <Style TargetType=""MenuItem""> <Setter Property=""Header"" Value=""{Binding DisplayName}""/> <Setter Property=""Icon""> <Setter.Value> <Image Source=""{Binding Path=IconPath}""/> </Setter.Value> </Setter> <Setter Property=""ItemsSource"" Value=""{Binding Items}""/> <Setter Property=""cm:Message.Attach"" Value=""ClickAction()""/> <Setter Property=""ef:KeyTip.Keys"" Value=""{Binding KeyTip}""/> <Setter Property=""ToolTip""> <Setter.Value> <ef:ScreenTip Title=""{Binding DisplayName}"" HelpTopic=""ScreenTip help ..."" Image=""{Binding LargeIconPath}"" Text=""Text for ScreenTip""/> </Setter.Value> </Setter> </Style> </ef:DropDownButton.ItemContainerStyle> <ef:DropDownButton.ToolTip> <ef:ScreenTip Title=""{Binding DisplayName}"" HelpTopic=""ScreenTip help ..."" Image=""{Binding LargeIconPath}"" Text=""Text for ScreenTip""/> </ef:DropDownButton.ToolTip> </ef:DropDownButton>",WPF - MenuItem missing Icon/Image.
"C# exception handling, compact lots of small try catch blocks???"," In my object conversion code I have tons of: And so on... I do not want all conversion to fail cause of some property so I can't put all this in one try block, but I need to log if something fails and continue..Is there a way to compact all this try catch things?Pity we can't write in C# code like:  <code>  try { NativeObject.Property1= int.Parse(TextObject.Property1); } catch (Exception e) { Trace.WriteLineIf(ConverterSwitch.TraceVerbose, e); } try { NativeObject.Property2= DateTime.Parse(TextObject.Property2); } catch (Exception e) { Trace.WriteLineIf(ConverterSwitch.TraceVerbose, e); } try{ int num = int.Parse(""3""); decimal num2 = decimal.Parse(""3.4"");}catch (Exception e){ Trace.Write(e); continue; //continue execution from the point we left. (line 2)}",How can I compact lots of small Try-Catch blocks when handling exceptions in C#?
C# generics question," Let's say I have some basic interface which is generics-driven: Now I have some concrete implementation of this interface which is also generic: This looks OK, but now let's say I have other class: And let's say I want to perform a check if TShouldModelInterface actually implements any of the possible Interface<T>.If the interface wasn't generic, I would simply write something like where TShouldModelInterface : Interface.But is there any way to solve this problem if the interface is a declared as Interface<T>? <code>  public interface Inteface<T> { void Foo(T t);} public class InterfaceImpl<T> { public void Foo(T t) { // Whatever }} public class Ololo { public void BadFunction<TShouldModelInterface>(TShouldModelInterface shouldModelInterface) { // Whatever }}",C# generics question - generic interface constraint
Synchronizing .NET SerialPort writes/reads," In my application I use the .NET SerialPort class for reading and writing data. The reading is done using the DataReceived event, I assume internally on a ThreadPool thread. The writing is done by the UI thread (WinForms).I was wondering, if it's necessary to synchronize the access to the SerialPort instance, so that no Reads/Writes can happen at the same time. My conscience tells me I should put locks around these calls, but I'm puzzled as all C# SerialPort examples I find on the Internet don't use locking at all.  <code> ",Is it necessary to synchronize .NET SerialPort writes/reads?
Best place to put dll references," I'm working on a project that is stored in SVN. The project has a dependency on a third-party DLL, so it will need to have a reference to that DLL.Where is the best place to store this DLL so that anyone who opens the project from SVN can compile it? <code> ",Best place to put third-party DLLs for referencing
Basic Calculation for WPF Polygon: Area and Centriod, The System.Windows.Shapes.Shape namespace provides access to Polygon object that can be used in XAML or code. Is there a Microsoft library that provides some very basic calculations on a Polygon like area or centriod?My preference is to not re-implement these functions myself or copy a math/geometry library. <code> ,Basic Calculation for WPF Polygon: Area and Centroid
how to change resolution of a image ( DPI) , I have a JPEG picture with a DPI of 72. I want to change 72 dpi to 300 dpi.How could I change resolution of JPEG pictures using C#? <code> ,How to change resolution (DPI) of an image?
How to change resolution (DPI) of a image?, I have a JPEG picture with a DPI of 72. I want to change 72 dpi to 300 dpi.How could I change resolution of JPEG pictures using C#? <code> ,How to change resolution (DPI) of an image?
What is the proper way to save combined (new+modified) detached entities in Entity Framework?," What is the proper and fast way to save combined new and modified detached POCO entities?I was thinking about these methods: When you are working in detached environment you have to know which entity was added and which is modified - it is your responsibility to keep this information and provide it to ObjectContext.Well i agree with this statement if you found yourself in situation when you need to use EF code like this in EF definitely something is wrong with you decision. I have chosen wrong tool for this job. <code>  private void Method_2(IList<Entity> entities) //detached entities { //This method is using SELECT to check if entity exist using (var context = new ModelContainer()) { foreach (Entity entity in entities) { var foundEntity = context.CreateObjectSet<Entity>().SingleOrDefault(t => t.Id == entity.Id); context.Detach(foundEntity); //Remove it from ObjectStateManager if (foundEntity != null)//It is modified entity { context.AttachTo(""EntitySet"", entity); //Attach our entity context.ObjectStateManager.ChangeObjectState(entity, EntityState.Modified); //We know it exists } else//It is new entity { context.CreateObjectSet<Entity>().AddObject(entity); } } context.SaveChanges(); } } private void Method_1(IList<Entity> entities) //detached entities { //This method doesn't select anything from DB, but i have ta call Savechanges after each object using (var context = new ModelContainer()) { foreach (Entity entity in entities) { try { context.AttachTo(""EntitySet"", entity); context.ObjectStateManager.ChangeObjectState(entity, EntityState.Modified); context.SaveChanges(); } catch (OptimisticConcurrencyException) { context.ObjectStateManager.ChangeObjectState(entity, EntityState.Added); context.SaveChanges(); } } } }",How to save combined (new+modified) detached entities in Entity Framework?
Why EditorBrowsable doesn't work ?," I tried to hide inherited property in intellisense with EditorBrowsable (as said here Hiding user control properties from IntelliSense), when testing in client form though I can still see it why ? <code>  [Category(""Main""),Description(""Text""),Obsolete(""Don't use this""),Browsable(false),EditorBrowsable(EditorBrowsableState.Never)]public override String Text{ get { return null; }}",Why EditorBrowsable doesn't work?
Check UserID exists in  Active Directory using C#," How can we check whether the USERID exists in Active Directory or not.I have LDAP String and UserID, can I find whether that UserID exists in Active Directory or not. I am using this for ASP.NET Web Application (.NET 3.5) <code> ",Check UserID exists in Active Directory using C#
C#: DataVisualization.Charting Set Line Size, This is probably a really simple question but I am having a lot of trouble trying to figure out which property sets the line size on the Chart or Series class. The line is really narrow and hard to see.How do I set the line size for my FastLine chart? <code>  Series set1 = new Series();for (int i = 0; i < 10; i++) { set1.Points.addY(x);}set1.ChartType = SeriesChartType.FastLine;set1.Color = Color.Green;chart1.Series.Add(set1);chart1.Invalidate();,C#: System.Windows.Forms.DataVisualization.Charting.Chart Set Line Size
C# probe for and capture Javascript Alert," So I've been doing some research for a while and I'm at a dead end. I'm doing some IE automation. In C#/.NET, how do I probe for and consume a javascript alert() or confirm() so I can do things like grab its text and click the OK\Cancel buttons?Update:I need to reiterate: I need to be able to pull and verify the text from an alert() or confirm() as well as send it an OK or Cancel click. An example of such a test would be to make sure that, when I click on delete, the confirm() doesn't say ""Are you sure you'd like to go to Mexico?"" or anything else except the proper message.Just in case, let me reiterate: For the purposes of this test, I have zero control over the source of the website in question.Lastly, I'm using SHDocVw.InternetExplorer. <code> ",C# probe for and capture Javascript Alert() and Confirm()
How to read registry keys in c#, I have developed an application and installed it on a client computer. In my application I need to get its installation path. My application has a registry entry at: How can I read AppPath using C#? <code>  HKEY_LOCAL_MACHINE\SOFTWARE\MyApplication\[AppPath],Reading a registry key in C#
Reading registry keys in c#, I have developed an application and installed it on a client computer. In my application I need to get its installation path. My application has a registry entry at: How can I read AppPath using C#? <code>  HKEY_LOCAL_MACHINE\SOFTWARE\MyApplication\[AppPath],Reading a registry key in C#
C# How to save Console.Writeline Outputs to text file?," I have a program which outputs various results onto a command line console.How do I save the output to a text file using a StreamReader or other techniques? <code>  System.Collections.Generic.IEnumerable<String> lines = File.ReadAllLines(@""C:\Test\ntfs8.txt"");foreach (String r in lines.Skip(1)){ String[] token = r.Split(','); String[] datetime = token[0].Split(' '); String timeText = datetime[4]; String actions = token[2]; Console.WriteLine(""The time for this array is: "" + timeText); Console.WriteLine(token[7]); Console.WriteLine(actions); MacActions(actions); x = 1; Console.WriteLine(""================================================"");}if (x == 2){ Console.WriteLine(""The selected time does not exist within the log files!"");}System.IO.StreamReader reader = ;string sRes = reader.ReadToEnd();StreamWriter SW;SW = File.CreateText(""C:\\temp\\test.bodyfile"");SW.WriteLine(sRes);SW.Close();Console.WriteLine(""File Created"");reader.Close();",How to Save Console.WriteLine Output to Text File
How to save Console.WriteLine output to text file?," I have a program which outputs various results onto a command line console.How do I save the output to a text file using a StreamReader or other techniques? <code>  System.Collections.Generic.IEnumerable<String> lines = File.ReadAllLines(@""C:\Test\ntfs8.txt"");foreach (String r in lines.Skip(1)){ String[] token = r.Split(','); String[] datetime = token[0].Split(' '); String timeText = datetime[4]; String actions = token[2]; Console.WriteLine(""The time for this array is: "" + timeText); Console.WriteLine(token[7]); Console.WriteLine(actions); MacActions(actions); x = 1; Console.WriteLine(""================================================"");}if (x == 2){ Console.WriteLine(""The selected time does not exist within the log files!"");}System.IO.StreamReader reader = ;string sRes = reader.ReadToEnd();StreamWriter SW;SW = File.CreateText(""C:\\temp\\test.bodyfile"");SW.WriteLine(sRes);SW.Close();Console.WriteLine(""File Created"");reader.Close();",How to Save Console.WriteLine Output to Text File
"Convert two (or more) lists into one, in C# .NET"," Is it possible to convert two or more lists into one single list, in .NET using C#?For example,  <code>  public static List<Product> GetAllProducts(int categoryId){ .... }...var productCollection1 = GetAllProducts(CategoryId1);var productCollection2 = GetAllProducts(CategoryId2);var productCollection3 = GetAllProducts(CategoryId3);","Merge two (or more) lists into one, in C# .NET"
What is ReverToSelf()? - C#.net, I don't understand what RevertToSelf() does in a .net application. Checking MSDN definition it reads the definition as So does the current user context changes to a sysadmin context by stopping client's context? By calling RevertToSelf() will my code run on sys admin mode?UpdateOkay so what happens if I call RevertToSelf() in an ASP.NET application? Let us consider I dont start any impersonation. So if I call RevertToSelf() will it revert to the application pool identity?  <code>  The RevertToSelf function terminates the impersonation of a client application.,What is RevertToSelf()? - C#.net
How do I determine if a property was overriden?," I am doing a project that where I need to register all the properties, because of the system being so huge it would require a lot of work to register all the properties that i want to be dependent for the purpose of Xaml.The goal is to find all properties that are on the top of the tree.so basically The end result would be something like this If you notice I don't want to accept overridden properties because of the way I search for the properties if I do something like thisC.Property3 for example and it cannot find it it will check C's basetype and there it will find it.This is what I have so far. What I want are the following: Public properties, that are not overridden, not static, not privateEither get and set properties are allowedThey are not an array or a generic typeThey are the top of the tree ie C class in the example is the highest (The property list example is exactly what I am looking for)They are not an indexer property ( this[index] ) <code>  public class A{ public int Property1 { get; set; }}public class B : A{ public int Property2 { get; set; } public virtual int Property3 { get; set; }}public class C : B{ public override int Property3 { get; set; } public int Property4 { get; set; } public int Property5 { get; set; }} A.Property1 B.Property2 B.Property3 C.Property4 C.Property5 public static void RegisterType( Type type ){ PropertyInfo[] properties = type.GetProperties( BindingFlags.Public | BindingFlags.Instance | BindingFlags.DeclaredOnly | BindingFlags.GetProperty | BindingFlags.SetProperty ); if ( properties != null && properties.Length > 0 ) { foreach ( PropertyInfo property in properties ) { // if the property is an indexers then we ignore them if ( property.Name == ""Item"" && property.GetIndexParameters().Length > 0 ) continue; // We don't want Arrays or Generic Property Types if ( (property.PropertyType.IsArray || property.PropertyType.IsGenericType) ) continue; // Register Property } }}",How do I determine if a property was overridden?
Why and How to avoid Event Handler memory leaks ?," I just came to realize, by reading some questions and answers on StackOverflow, that adding event handlers using += in C# (or i guess, other .net languages) can cause common memory leaks...I have used event handlers like this in the past many times, and never realized that they can cause, or have caused, memory leaks in my applications.How does this work (meaning, why does this actually cause a memory leak) ?How can I fix this problem ? Is using -= to the same event handler enough ?Are there common design patterns or best practices for handling situations like this ?Example : How am I supposed to handle an application that has many different threads, using many different event handlers to raise several events on the UI ?Are there any good and simple ways to monitor this efficiently in an already built big application? <code> ",Why and How to avoid Event Handler memory leaks?
uploadify ashx file context.Session gets null in mozilla ," I have a file upload in my site which is done using uploadify it uses a ashx page to upload file to database.It works fine in IE but in Mozilla the context.Session is getting null.I have also used IReadOnlySessionState to read session.how can i get session in Mozilla like IE.here is the ashx code i have done In IE Context.Session[""User""] always have the value but in Mozilla it is always null <code>  public class Upload : IHttpHandler, IReadOnlySessionState { HttpContext context; public void ProcessRequest(HttpContext context) { string UserID = context.Request[""UserID""]; context.Response.ContentType = ""text/plain""; context.Response.Expires = -1; XmlDocument xDoc = new XmlDocument(); HttpPostedFile postedFile = context.Request.Files[""Filedata""]; try { if (context.Session[""User""] == null || context.Session[""User""].ToString() == """") { context.Response.Write(""SessionExpired""); context.Response.StatusCode = 200; } else { // does the uploading to database } } }}",Uploadify ashx file Context.Session gets null
Uploadify ashx file Context.Session gets null in mozilla ," I have a file upload in my site which is done using uploadify it uses a ashx page to upload file to database.It works fine in IE but in Mozilla the context.Session is getting null.I have also used IReadOnlySessionState to read session.how can i get session in Mozilla like IE.here is the ashx code i have done In IE Context.Session[""User""] always have the value but in Mozilla it is always null <code>  public class Upload : IHttpHandler, IReadOnlySessionState { HttpContext context; public void ProcessRequest(HttpContext context) { string UserID = context.Request[""UserID""]; context.Response.ContentType = ""text/plain""; context.Response.Expires = -1; XmlDocument xDoc = new XmlDocument(); HttpPostedFile postedFile = context.Request.Files[""Filedata""]; try { if (context.Session[""User""] == null || context.Session[""User""].ToString() == """") { context.Response.Write(""SessionExpired""); context.Response.StatusCode = 200; } else { // does the uploading to database } } }}",Uploadify ashx file Context.Session gets null
TypeForwardedToAttribute is a joke?," I came across to this attribute in this post and this one. It seems that it's very useful when we need to upgrade an old system. Then I create a test solution(with 3 projects in it) in order to use this attribute. Firstly there is a class library project named ""Animal"". Then I create a console application project, add ""Animal"" as a reference, and in the Main method I have: Now it prints ""old version"". Great! Now I begin to ""upgrade"" the existing project. I remove the class Dog in ""Animal"" add another class library project named ""AdvancedAnimal"" which contains: Add ""AdvancedAnimal"" as a reference in ""Animal"". Also AssemblyInfo.cs of ""Animal"" is modified by adding: From the usage of this attribute, from now on all Animal.Dog is forwarded to the Dog class in ""AdvancedAnimal""(actually there is no Dog class in Animal any more). I re-compile the whole solution and hope the console application prints ""new version"". But it gives me a compile error:The type name 'Dog' could not be found in the namespace 'Animal'. This type has been forwarded to assembly 'AdvancedAnimal, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' Consider adding a reference to that assembly.Oh, I'm told to add ""AdvancedAnimal"" as a reference to my console application! But if I do so, I don't need the attribute any more, because if I add ""AdvancedAnimal"" as a reference in the console application, of course Animal.Dog refers the one in ""AdvancedAnimal""! What I expect is that modifying ""Animal"", Adding ""AdvancedAnimal"", no necessary to change all other projects/class libraries because the assembly info already provides enough information. That is really convenient when upgrading a system. Otherwise, I have 20 projects referring to ""Animal"", I need to add ""AdvancedAnimal"" as a reference to all of them. And more important is, I can't find any usage of ""TypeForwardedToAttribute"" in this solution, removing it doesn't matter anything. Can you tell me what's wrong with my test/idea? <code>  namespace Animal{ public class Dog { public static string Name = ""old version""; }} Console.WriteLine(Animal.Dog.Name); namespace Animal{ public class Dog { public static string Name = ""new version""; }} [assembly: TypeForwardedTo(typeof(Animal.Dog))]",What is the correct way to use TypeForwardedToAttribute?
[C#][Windows Internals] Securely erasing a file using simple methods?," Possible Duplicate: C# - Deleting a file permanently Hello,I am using C# .NET Framework 2.0. I have a question relating to file shredding. My target operating systems are Windows 7, Windows Vista, and Windows XP. Possibly Windows Server 2003 or 2008 but I'm guessing they should be the same as the first three.My goal is to securely erase a file. I don't believe using File.Delete is secure at all. I read somewhere that the operating system simply marks the raw hard-disk data for deletion when you delete a file - the data is not erased at all. That's why there exists so many working methods to recover supposedly ""deleted"" files. I also read, that's why it's much more useful to overwrite the file, because then the data on disk actually has to be changed. Is this true? Is this generally what's needed? If so, I believe I can simply write the file full of 1's and 0's a few times. I've read:http://www.codeproject.com/KB/files/NShred.aspxhttp://blogs.computerworld.com/node/5756http://blogs.computerworld.com/node/5687Securely deleting a file in C#.NET <code> ",Securely erasing a file using simple methods?
Ninject versus Unity," At the risk of stepping into holy war territory, What are the strengths and weaknesses of these popular DI/IoC frameworks, and could one easily be considered the best? ..:NinjectUnity Castle.WindsorAutofacStructureMap Are there any other DI/IoC Frameworks for C# that I haven't listed here?In context of my use case, I'm building a client WPF app, and a WCF/SQL services infrastructure, ease of use (especially in terms of clear and concise syntax), consistent documentation, good community support and performance are all important factors in my choice.Update:The resources and duplicate questions cited appear to be out of date, can someone with knowledge of all these frameworks come forward and provide some real insight?I realise that most opinion on this subject is likely to be biased, but I am hoping that someone has taken the time to study all these frameworks and have at least a generally objective comparison.I am quite willing to make my own investigations if this hasn't been done before, but I assumed this was something at least a few people had done already.Second Update:If you do have experience with more than one DI/IoC container, please rank and summarise the pros and cons of those, thank you. This isn't an exercise in discovering all the obscure little containers that people have made, I'm looking for comparisons between the popular (and active) frameworks. <code> ",How do the major C# DI/IoC frameworks compare?
Which C# DI/IoC framework is best ," At the risk of stepping into holy war territory, What are the strengths and weaknesses of these popular DI/IoC frameworks, and could one easily be considered the best? ..:NinjectUnity Castle.WindsorAutofacStructureMap Are there any other DI/IoC Frameworks for C# that I haven't listed here?In context of my use case, I'm building a client WPF app, and a WCF/SQL services infrastructure, ease of use (especially in terms of clear and concise syntax), consistent documentation, good community support and performance are all important factors in my choice.Update:The resources and duplicate questions cited appear to be out of date, can someone with knowledge of all these frameworks come forward and provide some real insight?I realise that most opinion on this subject is likely to be biased, but I am hoping that someone has taken the time to study all these frameworks and have at least a generally objective comparison.I am quite willing to make my own investigations if this hasn't been done before, but I assumed this was something at least a few people had done already.Second Update:If you do have experience with more than one DI/IoC container, please rank and summarise the pros and cons of those, thank you. This isn't an exercise in discovering all the obscure little containers that people have made, I'm looking for comparisons between the popular (and active) frameworks. <code> ",How do the major C# DI/IoC frameworks compare?
[WPF] Resize my border when a VerticalScrollBar appear," Let me show you part of my XAML code : When too much borders are created (it is linked with an ObservableCollection), a vertical scroll bar appears, and my border doesn't resize on its own. (I would like to see the complete border, I don t want it to be cut at the end)If anyone has an idea, thanks!Don't hesitate to ask, if you need more information!Rgds,Flo <code>  <ListBox Grid.Row=""1"" ScrollViewer.HorizontalScrollBarVisibility=""Disabled"" ScrollViewer.IsDeferredScrollingEnabled=""True"" HorizontalAlignment=""Stretch"" ItemsSource=""{Binding}"" Margin=""1,1,0,0"" Name=""listBox_Faits"" Width=""290"" VerticalAlignment=""Stretch"" SelectionChanged=""listBox_Faits_SelectionChanged""> <ListBox.ItemTemplate> <DataTemplate> <Border BorderBrush=""SlateGray"" BorderThickness=""0.5"" Margin=""1,2,1,1"" Width=""{Binding ElementName=listBox_Faits, Path=Width}"">",Resize my border when a VerticalScrollBar appear
How is contravariance cooler than polymorphism...and not redundant?," .NET 4 introduces covariance. I guess it is useful. After all, MS went through all the trouble of adding it to the C# language. But, why is Covariance more useful than good old polymorphism? I wrote this example to understand why I should implement Covariance, but I still don't get it. Please enlighten me. <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;namespace Sample{ class Demo { public delegate void ContraAction<in T>(T a); public interface IContainer<out T> { T GetItem(); void Do(ContraAction<T> action); } public class Container<T> : IContainer<T> { private T item; public Container(T item) { this.item = item; } public T GetItem() { return item; } public void Do(ContraAction<T> action) { action(item); } } public class Shape { public void Draw() { Console.WriteLine(""Shape Drawn""); } } public class Circle:Shape { public void DrawCircle() { Console.WriteLine(""Circle Drawn""); } } public static void Main() { Circle circle = new Circle(); IContainer<Shape> container = new Container<Circle>(circle); container.Do(s => s.Draw());//calls shape //Old school polymorphism...how is this not the same thing? Shape shape = new Circle(); shape.Draw(); } }}",How is covariance cooler than polymorphism...and not redundant?
Image to byte array from a url., I have a hyperlink which has a image.I need to read/load the image from that hyperlink and assign it to a byte array (byte[]) in C#.Thanks. <code> ,Image to byte array from a url
How do I center a window onscreen in c#?," I need a way to center the current window. So for example, if a user pushes a button, I want the window to center itself onscreen. I know you can use the startposition property, but I cannot figure out a way to use that other than when the application first starts up. So how do I center the form on the screen? <code> ",How do I center a window onscreen in C#?
Random element of List<> from LINQ SQL, I'm using C# 3.5 and am currently using Linq to get all users from a user table and put them in a list.Now I would like to return a random user from that list. What's the best way to go about doing that?Edit: Found it here:How to get a Random Object using Linq <code> ,Random element of List<T> from LINQ SQL
How to programatically set selected Panorama item in WP7," I'm using a panorama control in a WP7 app. One of the PanoramaItems takes you to another page, which then allows you send an email through the EmailComposeTask. If you don't select to send the email and press the back button, the Panorama returns to the item you last selected. However, if you do select to send an email (and therefore leave the app), it does not return to the previously selected PanoramaItem. Instead, it returns to the first item in the Panorama. I tried keeping track of the selected index and setting it, but I got an error saying the SelectedIndex is not settable. This is confirmed on MSDN documentation http://msdn.microsoft.com/en-us/library/microsoft.phone.controls.panorama.selectedindex%28VS.92%29.aspxIs there any way to manually set the selected index/item on a panorama? If not, is there a way for it to remember what was selected, even if the user leaves the app to compose an email? <code> ",How to programmatically set selected Panorama item in WP7
How to catch an unhandled exception in Microsoft Azure (Worker) Role," I'm trying to catch all unhandled exceptions in my worker role. I tried putting a try-catch block into the Run() method (as suggested here) but with no success. The role hosts a WCF service, so there is no other logic inside the Run() method. Is there another possibility to catch exceptions at this level?Update 1To clarify the problem: The role self hosts a WCF service (initialized in OnStart()) where some operations are background operations. When the service is called and that method throws an unexpected exception, I like to catch that to write it to the log.Solution:Obviously it is like in a normal C# application:Just add a handler to the UnhandledException event like this inside the OnStart() of the Role. I was so focused on Azure that I supposed this couldn't work after all, that I didn't even try it :-) <code>  public override void Run(){ try { base.Run(); } catch (Exception ex) { Trace.TraceError(""Unhandled Exception: {0}"", ex); throw ex; }} AppDomain.CurrentDomain.UnhandledException += new UnhandledExceptionEventHandler(CurrentDomain_UnhandledException);",How to catch an unhandled exception in Windows Azure (Worker) Role
Why is this Contract.Ensure call unproven?," I have the following code in my .Net 4 app: This givens me an ensures unproven warning at compile time: What is going on? This works fine if S is an integer. It also works if I change the Ensure to S == Contract.OldValue(S + ""1""), but that's not what I want to do. <code>  static void Main(string[] args) { Func();}static string S = ""1"";static void Func() { Contract.Ensures(S != Contract.OldValue(S)); S = S + ""1"";} warning : CodeContracts: ensures unproven: S != Contract.OldValue(S)",Why is this string-based Contract.Ensure call unproven?
c# winform  how to change image file rotation status without loading it into memory , Someone told me some image file like jpg just use some bits to control the rotation status.Is there any way to change this status without loading the picture file to main memory  <code> ,how to change image file rotation status without loading it into memory 
[C#] Populating a DataGridView with Text and ProgressBars," I am creating a multi-threaded application in which each thread will appear as a row in my DataGridView. I want a ProgressBar in each row indicating the corresponding thread progress.The question is, is this possible? And if so, how? <code> ",Populating a DataGridView with Text and ProgressBars
C# public variable as writeable inside the clas but readonly outside the class," I have a .Net C# class where I need to make a variable public. I need to initialize this variable within a method (not within the constructor). However, I don't want the variable to be modifieable by other classes. Is this possible? <code> ",C# public variable as writeable inside the class but readonly outside the class
sql - C#.net simple question, What is the simplest way in C# (.cs file) to get the count from the SQL command into an int variable? <code>  SELECT COUNT(*) FROM table_name,Capturing count from an SQL query
Cannot debug tests using Resharper," I'm not able to debug my tests using Resharper-Debug option in my project. I have seen this issue raised by lots of people, but has't come across a solid suggestion which solves my issue.The strange thing is that, if I create a sample project and write a simple unit test, I'm able to debug it without any issues.However when I try to do this in my current project, it simply throws a dialog box saying ""Cannot Launch Debugger"".I have checked this with my peers, and they does't face this issue :(Also I don't have any issues while running the test.It's an XP machine and following is the version of resharper: JetBrains ReSharper 5.1 C# Edition Build 5.1.1753.4 on 2010-10-15T15:51:30 Licensed to: XXXXXXX Plugins: none. Visual Studio 9.0.21022.8. Copyright 20032011 JetBrains s.r.o.. All rights reserved. Thanks,-M <code> ",Cannot debug tests using Resharper - Cannot Launch Debugger
C#: Do I need a BindingSource AND a BindingList?," I want to display a list of people in a DataGridView in a Windows Forms app. I want my service layer to return a list of Person objects (e.g., IList<Person>). I want changes in the list to be reflected in the DataGridView and vice versa. My understanding is that using the BindingSource facilitates working with DataGridView. My question is for the two-way databinding to work, do I need: or can I do: What's the difference? If my make changes to the list will the DataGridView be updated either way? And if I have to use the BindingList, it seems a little wonky (because of creating a dependency) to return a BindingList from my service layer, is there a way around that?Microsoft says of the BindingList (in the Remarks section)http://msdn.microsoft.com/en-us/library/ms132679.aspx: ""However, the typical solutions programmer will use a class that provides data binding functionality, such as BindingSource, instead of directly using BindingList<T>."" <code>  //pseudo codeBindingSource.DataSource = IBindingList<Person> BindingSource.DataSource = IList<Person>",Do I need a BindingSource AND a BindingList for WinForms DataBinding?
Send email using System.Net.Mail through gmail. (C#)," I want to send a email through gmail server. I have put the following code but it is getting stuck while sending. Any idea please.... The xxxx.com is a mail domain in Google apps.Thanks... <code>  MailMessage mail = new MailMessage();mail.From = new System.Net.Mail.MailAddress(""apps@xxxx.com"");//create instance of smtpclientSmtpClient smtp = new SmtpClient();smtp.Port = 465;smtp.UseDefaultCredentials = true;smtp.Host = ""smtp.gmail.com""; smtp.EnableSsl = true;//recipient addressmail.To.Add(new MailAddress(""yyyy@xxxx.com""));//Formatted mail bodymail.IsBodyHtml = true;string st = ""Test"";mail.Body = st;smtp.Send(mail);",Send email using System.Net.Mail through gmail
"C#, Manage concurrency in database access"," A while ago, I wrote an application used by multiple users to handle trades creation.I haven't done development for some time now, and I can't remember how I managed the concurrency between the users. Thus, I'm seeking some advice in terms of design.The original application had the following characteristics:One heavy client per user. A single database. Access to the database for each user to insert/update/delete trades. A grid in the application reflecting the trades table. That grid being updated each time someone changes a deal. I am using WPF. Here's what I'm wondering:Am I correct in thinking that I shouldn't care about the connection to the database for each application? Considering that there is a singleton in each, I would expect one connection per client with no issue. How can I go about preventing the concurrency of the accesses? I guess I should lock when modifying the data, however don't remember how to. How do I set up the grid to automatically update whenever my database is updated (by another user, for example)?Thank you in advance for your help! <code> ",What's the best way to manage concurrency in a database access application?
How to check IF expriation date occured.," I have access only to .NET, and I have this situation. At creating an game (or any object for that matter), I set expiration date (or any date, that's not really important).Date is set at some point in future. Now What I want to do is to check if that date occurred. And this should happen completely automatically. Without user interactions.My question is.. ? Is that possible? And where to start?EDIT:I have date stored in database, and i want to periodically check if that date actually occurred. I guess asking server every second to check date stored in DB is not most optimal solution. <code> ",How to check IF expiration date occured
Need help with debugging dump files in Visual Studio," I am using Visual Studio 2010 Professional Edition, and Windows Vista.Firstly, I have this code. As you can see, it will crash the program! The program will crash on the if statement. Now, I want to find out that it crashed on that if statement. If I ""Start without Debugging"" from Visual Studio, Crash.exe crashes. It uses 1,356kb of memory. I get the Vista option of Close Program/Debug. If I choose Debug, I can open a new instance of Visual Studio, and it points me to a NullReferenceException on the if statement. This is good.Now let me assume that it crashes on another computer, and I get them to give me a Dump File via Task Manager. It is 54,567kb. Why so big! It's vast! Anyway, I am less interested in that (slightly) If I open that dump with Windbg, I get very little of use to my untrained eye: However, this is of less interest to me. As far as I can tell, I need to write commands in to get useful output, and Visual Studio is better. So I open it with Visual Studio. I can choose to ""Debug with Native Only"", but I get lots of things that mean something to clever people like you, and I am not clever! I get these two screens: So, my question:How do I show Visual Studio to my source code?Also, is there a way to get a smaller dump file? It seems ridiculously big, even after compressing. I don't understand why there couldn't be one which is only just a tiny bit bigger than the program's footprint, and still get a nice debugging, with the source code. <code>  using System;namespace Crash{ class Program { static void Main(string[] args) { string a = null; if (a.Length == 12) { // ^^ Crash } } }} Microsoft (R) Windows Debugger Version 6.12.0002.633 X86Copyright (c) Microsoft Corporation. All rights reserved.Loading Dump File [C:\Users\Richard\Desktop\Crash.DMP]User Mini Dump File with Full Memory: Only application data is availableSymbol search path is: SRV*C:\SYMBOLS*http://msdl.microsoft.com/download/symbolsExecutable search path is: Windows Server 2008/Windows Vista Version 6002 (Service Pack 2) MP (4 procs) Free x86 compatibleProduct: WinNt, suite: SingleUserTS PersonalMachine Name:Debug session time: Sat Jan 15 11:07:36.000 2011 (UTC + 0:00)System Uptime: 0 days 4:24:57.783Process Uptime: 0 days 0:00:05.000........................eax=002afd40 ebx=77afa6b4 ecx=002afd48 edx=00000001 esi=001cdaa4 edi=00000000eip=77bf5e74 esp=001cda5c ebp=001cdacc iopl=0 nv up ei ng nz ac pe cycs=001b ss=0023 ds=0023 es=0023 fs=003b gs=0000 efl=00000297ntdll!KiFastSystemCallRet:77bf5e74 c3 ret",Debugging dump files in Visual Studio
cannot convert from 'method group' to 'System.Action<object>'? Why?," I have created the following function: And defined the following method However, when I try to call DelegateCall with foo1: ...I get the following compiler error: Argument 1: cannot convert from 'method group' to 'System.Action<object>'What is the reason for this error and how can I correct it? Unfortunately, casting foo1 to Action is not an option.  <code>  public void DelegatedCall(Action<Object> delegatedMethod) public void foo1(String str) { } DelegatedCall(foo1);",Cannot convert from 'method group' to 'System.Action<object>' error
MS Test : How do I enforce exception message with ExpectedException attribute," I thought these two tests should behave identically, in fact I have written the test in my project using MS Test only to find out now that it does not respect the expected message in the same way that NUnit does.NUnit (fails): MS Test (passes): No matter what message I give the ms test, it will pass.Is there any way to get the ms test to fail if the message is not right? Can I even create my own exception attribute? I would rather not have to write a try catch block for every test where this occurs. <code>  [Test, ExpectedException(typeof(System.FormatException), ExpectedMessage = ""blah"")]public void Validate(){ int.Parse(""dfd"");} [TestMethod, ExpectedException(typeof(System.FormatException), ""blah"")]public void Validate(){ int.Parse(""dfd"");}",How do I enforce exception message with ExpectedException attribute
How to insert a new row into datatable in C#?," I have a datatable filled with staff data like.. I want to modify so that the result would be sth like.. to be concluded, I need to insert the total row at the end of each staff record.So, my question is how to insert a row into a datatable? Tkz.. <code>  Staff 1 - Day 1 - TotalStaff 1 - Day 2 - TotalStaff 1 - Day 3 - TotalStaff 2 - Day 1 - TotalStaff 2 - Day 2 - TotalStaff 2 - Day 3 - TotalStaff 2 - Day 4 - Total Staff 1 - Day 1 - TotalStaff 1 - Day 2 - TotalStaff 1 - Day 3 - TotalTotal - - Total ValueStaff 2 - Day 1 - TotalStaff 2 - Day 2 - TotalStaff 2 - Day 3 - TotalStaff 2 - Day 4 - TotalTotal - - Total Value",Insert a new row into DataTable
"Microsoft Charting, Asp mvc 3 and Razor "," Related to This topic I wonder if anyone has made the Microsoft Charting library working with Asp MVC 3 and Razor.I know about the new chart helper introduced, but since that is very limited that is not really an option.To create an action method that returns an image is also easy enough, but since all interactivity breaks down (even just simple tooltips for the bars in a bar chart) this method has several limitations.This example is probably the most helpful article I have found, but I still cant get a single easy chart working even though it does work when rendering the image only in an action method. Also I have got the samples working fine under .net 4, but obviously those arent MVC samples.SO - has anyone got Microsoft charting working fully in Asp MVC 3 with Razor and could post a link to a complete solution? <code> ","Microsoft Charting, MVC 3 and Razor "
How to tell if a string matches a particular route," How can I tell if a string matches a particular named route?I have a route like this: How can I programmatically tell if the 'url' string matches that route? Something like this: <code>  routes.MapRoute( ""FindYourNewRental"", ""find-your-new-rental/{market}/{community}.html"", new { controller = ""FindYourNewRental"", action = ""Community"" } );string url = ""http://www.website.com/find-your-new-rental/northerncalifornia/sacramento.html"" // matches url with the named route ""FindYourNewRental""if (IsRouteMatch(url, ""FindYourNewRental"")) { // do something}public bool IsRouteMatch(string url, string routeName){ // How do I code this function}",How to determine if an arbitrary URL matches a defined route
How to upload a video to youtube via using Youtube api at C#," The code below fails? What might be the problem? I solved the problem. It was my category: the category has to be Games instead of Gaming. <code>  YouTubeRequestSettings settings = new YouTubeRequestSettings(""whatwill come here ?"", ""my api key"", ""my youtube login email"", ""my youtube login password""); YouTubeRequest request = new YouTubeRequest(settings);Video newVideo = new Video();newVideo.Title = ""test 1""; newVideo.Tags.Add(new MediaCategory(""Gaming"", YouTubeNameTable.CategorySchema)); newVideo.Keywords = ""test 1 , test 2""; newVideo.Description = ""test 3 test 4""; newVideo.YouTubeEntry.Private = false; newVideo.Tags.Add(new MediaCategory(""tag 1, tag 2"", YouTubeNameTable.DeveloperTagSchema)); newVideo.YouTubeEntry.Location = new GeoRssWhere(37, -122); newVideo.YouTubeEntry.MediaSource = new MediaFileSource(""C:\\test.avi"", ""video/quicktime""); Video createdVideo = request.Upload(newVideo);",How can I upload a video to YouYube using the Youtube API in C#?
How do I download zip file from C# code?," I use HTTP GET that downloads a zip file in a browser, something like https://example.com/up/DBID/a/rRID/eFID/vVID (not the exact url)Now, when I try to do the same download in C# code(same GET method as above) for a desktop application, the zip file downloaded is not a valid archive file. When I opened this file in notepad, it was some HTML page.I think I'm not setting some header correctly. I looked around for examples. I'd found several wrt uploads, but did not see anything for downloads. Code: <code>  HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);request.Method = ""GET"";request.ContentType = ""application/zip"";try{ HttpWebResponse res = (HttpWebResponse)request.GetResponse(); using (StreamReader sr = new StreamReader(res.GetResponseStream(), System.Text.Encoding.Default)) { StreamWriter oWriter = new StreamWriter(@""D:\Downloads\1.zip""); oWriter.Write(sr.ReadToEnd()); oWriter.Close(); } res.Close();}catch (Exception ex){}",How do I download zip file in C#?
How to send series of commands to a command window process (C#)? ," We have a few commands(batch files/executables) on our network path which we have to call to initialize our 'development environment' for that command window. It sets some environmental variables, adds stuff to the Path etc. (Then only whatever working commands we type will be recognized & I don't know what goes inside those initializing commands)Now my problem is, I want to call a series of those 'working commands' using a C# program, and certainly, they will work only if the initial setup is done. How can I do that? Currently, I'm creating a batch file by scratch from the program like this for example: Then the actual commands Then finally close the file writer, and run this batch file. Now if I directly execute this using Process.<strike>Run</strike>Start(""cmd.exe"",""Dowork -arguments""); it won't run.How can I achieve this in a cleaner way, so that I have to run the initialization commands only once? (I could run cmd.exe each time with all three initializers, but they take a lot of time so I want to do it only once) <code>  file.Writeline(""InitializationStep1.bat"")file.Writeline(""InitializeStep2.exe"")file.Writeline(""InitializeStep3.exe"") file.Writeline(""Dowork -arguments -flags -blah -blah"")file.Writeline(""DoMoreWork -arguments -flags -blah -blah"")",How to send series of commands to a command window process?
How to send series of commands to a command window process? ," We have a few commands(batch files/executables) on our network path which we have to call to initialize our 'development environment' for that command window. It sets some environmental variables, adds stuff to the Path etc. (Then only whatever working commands we type will be recognized & I don't know what goes inside those initializing commands)Now my problem is, I want to call a series of those 'working commands' using a C# program, and certainly, they will work only if the initial setup is done. How can I do that? Currently, I'm creating a batch file by scratch from the program like this for example: Then the actual commands Then finally close the file writer, and run this batch file. Now if I directly execute this using Process.<strike>Run</strike>Start(""cmd.exe"",""Dowork -arguments""); it won't run.How can I achieve this in a cleaner way, so that I have to run the initialization commands only once? (I could run cmd.exe each time with all three initializers, but they take a lot of time so I want to do it only once) <code>  file.Writeline(""InitializationStep1.bat"")file.Writeline(""InitializeStep2.exe"")file.Writeline(""InitializeStep3.exe"") file.Writeline(""Dowork -arguments -flags -blah -blah"")file.Writeline(""DoMoreWork -arguments -flags -blah -blah"")",How to send series of commands to a command window process?
Create HTML table from a list in C#," I am trying to get some values from a List and then create a html table with this data but I can't get it to work properly.I have: When I step through the debugger I can see that row.Cells.Add(cell) contains the family name in the first loop and given name in the second loop but then something seems to be wrong and I can't get the table to show up on the page with this data.When I check the table.rows.add(row) it says that ""base {System.SystemException} = {""'HtmlTableRow' does not support the InnerText property.""}""What am I doing wrong here? <code>  HtmlTable table = new HtmlTable();HtmlTableRow row;HtmlTableCell cell;foreach(var item in Name){ row = new HtmlTableRow(); foreach(var familyName in item.familyName) { cell = new HtmlTableCell(); cell.InnerText = item.familyName.ToString(); row.Cells.Add(cell); } foreach (var givenName in item.givenName) { cell = new HtmlTableCell(); cell.InnerText = item.givenName.ToString(); row.Cells.Add(cell); } table.Rows.Add(row);}this.Controls.Add(table);",Create HTML table from a list
Is this safe in .NET? , Assume myObj is null. Is it safe to write this? I know some languages won't execute the second expression because the && evaluates to false before the second part is executed. <code>  if(myObj != null && myObj.SomeString != null),Is relying on && short-circuiting safe in .NET? 
Printing a picture in C#," I am trying to find how to print a picture (as in on paper) in C#. I'm trying to keep it very simple. So no use of WinForms and just using Console output.I looked for an answer myself, but couldn't make sense of any of the results. <code> ",Printing a picture from a Console Application
C# Insert value in certain position in string?," i'm looking to place a value from a text box lets say ""12"" to a certain place in a string temp variable. Then I want to place another value after that say ""10"" but with a : in between like a time. Both come from Text boxes and are validated so they can only be numbers. <code> ",Insert value into a string at a certain position?
Does using a lamda expression passed into a method slow down an Entity Framework query?," I have a method: I refactored the method to make it more general so that I can pass in a Func so that I can specify the where statement and what property from the Bars table gets assigned to MyObject.Prop like this: GetObjectsV2 seems to run much slower than GetObjects. Are there any reasons this would affect performance, and if so, are there any ways around this while still keeping the function flexible? <code>  public static void GetObjects(){ using(MyContext context = new MyContext()) { var objects = context.Bars.Where(b => b.Prop1 != null) .Select(b => new MyObject{Prop = b.Prop1, Name = b.Name}) .ToList(); foreach(var object in objects) { // do something with the object } }} public static void GetObjectsV2(Func<Bar, bool> whereFunc, Func<Bar, string> selectPropFunc){ using(MyContext context = new MyContext()) { var objects = context.Bars.Where(whereFunc) .Select(b => new MyObject{Prop = selectPropFunc(b), Name = b.Name}) .ToList(); foreach(var object in objects) { // do something with the object } }}",Does using a lambda expression passed into a method slow down an Entity Framework query?
[C#] Random Number Generation - Same Number returned," Possible Duplicates: c# - getting the same random number repeatedly Random number generator not working the way I had planned (C#) I have a method that builds a queue of ints: JE_Rand.rInt() is just a function that delegates to a function of the Random class: But when I call generateTrainingInts, the same number is enqueued each time. However, if I change rInt to use a static instance of the Random class, instead of a local instance (with function scope as it is defined above), then it appears to work correctly (enqueue random integers). Does anybody know why this happens?Edit:Dear Answerers who didn't read my question thoroughly, Like some of you pointed out, I am looking for a good explanation of why this happens. I am not looking for a solution to the same-number-generated problem, because I already fixed that like I said above. Thanks for your enthusiasm though :) I really just want to understand things like this, because my first implementation made more sense conceptually to me. <code>  public Queue<int> generateTrainingInts(int count = 60) { Queue<int> retval = new Queue<int>(); for (int i = 0; i < count; i++) { retval.Enqueue(JE_Rand.rInt(2001, 100)); } return retval; } public static int rInt(int exclUB, int incLB = 0) { Random rand = new Random(DateTime.Now.Millisecond); int t = rand.Next(incLB, exclUB); rand = null; return t; }",Random Number Generation - Same Number returned
How to return value from C# partial class method ?, Is there a way to do so as it seems partial method must return void (I really don't understand this limitation but let it be) ?  <code> ,How to return value from C# partial method ?
"WPF: Drag and drop ""files"" into Windows explorer"," I'm developing an application similar to dropbox and i show the remote files on a WPF listview. I want to drag those elements and drop it into windows explorer.I've seen code like this: But as you may think, those file are not at the local system yet, before copiying them I need to connect to server, donwload and unzip the files. Like a ftp client does.I dont how to do it but i was wondering if there is any ""drop"" event or similiar that i can handle.Thanks! <code>  var dataObject = new DataObject(DataFormats.FileDrop, files.ToArray());dataObject.SetData(DataFormats.StringFormat, dataObject);DoDragDrop(dataObject, DragDropEffects.Copy);",WPF: Drag and drop virtual files into Windows explorer
C#.NET - How do I save files to hard disk in a separate thread?," I've a camera and I'm reading the images in real time into an array.I'm applying some algorithm to the image and displaying it. Then I get the next image and display it as well. So I'm streaming images from the camera to the display. However I also want to save images to hard disk once I've displayed them. I tried using the main thread but everything slowed down too much.I then tried using ThreadPool (see code below). This doesn't slow the display down but I've found the images aren't being saved properly. It looks like they are not in the expected order and after about 50 images have been saved the subsequent image data looks garbled. I'm guessing too many threads are being started.Is there a better way to do this? I think I only need one thread to save the images. Maybe some kind of queue that saves each image sequentially. Just as long as its done in the background and doesn't slow down the display. If someone could post a code snippet that would be fantastic. <code>  short[] image1 = new short[20000];while(streaming){ ReadImageFromCamera(ref image1) ImageData data; data.fileName = imageNumber; data.image = image1; ThreadPool.QueueUserWorkItem(WriteImageToFile, data); // Send the writes to the queue}private void WriteImageToFile(object imageData) { try { ImageData data = (ImageData)imageData; System.Runtime.Serialization.Formatters.Binary.BinaryFormatter bf = new System.Runtime.Serialization.Formatters.Binary.BinaryFormatter(); string fName = myDirectory + @""/"" + Convert.ToString(data.fileName) + @"".spe""; using (Stream myStream = new FileStream(fName, FileMode.Create)) { bf.Serialize(myStream, data.image); } } catch (Exception) { }}",How do I save files to hard disk in a separate thread?
How do I get the GIU thread of winform?," I have a winforms app with multiple GUI threads. I want them to be able to access each other's thread objects without having to keep track of that information separately.Is there a function in .NET that I can feed a winforms control or window object, and get back the thread? Or a function in the API I can pinvoke for the threadID? (please no comments saying I should do it another way... also this is not about cross-thread window operations.)Thanks!EditFor those of you who for some reason believed my italicized text, congratualations, you're hired!! Here is the problem: ""App is crashing in the wild by locking up totally, that is, it stop responding. Very intermittent, and trying to debug it, it seems to never happen.""So what do do? Install an option in the program that the user can activate under our direction, whereby from another GUI thread in the same app, do a thread.abort on the main GUI thread, then we can look at the call stack in the error log. Viola, found an impossible to debug error in less than a day. (Stop now, it had nothing to do with abusing multithreading:-) I'll admit I almost didn't ask this, the reason I did was I could see an object reference to the main form, but there wasn't any for its thread. I'm giving Chris Shain the answer a/c it is a quick way, unfortunately when the thread is hanging, I wouldn't be able to do an invoke (it would hang too). A little more digging revealed the GetWindowThreadProcessId API call. But it's an unmanaged thread ID, apparently there are complications turning that into a managed thread ID.So I bit the bullet and put in a global reference to the main UI thread. Would have posted it to begin with, but hadn't written it yet.Now if you'll pardon the VB...In main public module/static class: In aborter WinForm: <code>  Public GUIThread As Threading.ThreadSub Main() '' // Create app main window ShellForm = New frmShell '' // Save main GUI Thread for abort routine GUIThread = Threading.Thread.CurrentThread If GetSetting(""MyApp"", ""Testing"", ""CrashDebug"", ""False"") = ""True"" Then '' // DO NOT run the pgm. like this normally - with try/catch around '' // Application.Run - or uncaught errors will kill the whole app!!! Try '' // This is the other of the Multiple GUI threads I talked '' // about in the Orig Post. Dim t As New Threading.Thread(AddressOf StartCrashDebug) t.Start() Application.Run(ShellForm) Catch ex As Exception '' // This error routine passes errors off to another thread which '' // logs them (and also shows messages) MyLogError(ex, ""CrashDebug - Main Window blew up"") End Try Else '' // Normal mode - uncaught errors will get caught by UnhandledException, '' // logged, and Winforms will keep the GUI alive (since we _do_ care '' // more about users than computers right ;-) Application.Run(ShellForm) End IfEnd SubSub StartCrashDebug() Dim f As New frmCrashFinder '' // Starting a window like this on a separate thread makes it Another '' // GUI thread for winforms, by design Application.Run(f) End Sub Public Class frmCrashFinder Inherits Windows.Form Private Sub Abort_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Abort.Click GUIThread.Abort() End SubEnd Class",How do I get the GUI thread of winform?
CLR has been unable to transition from COM context 0x3b2d70 to COM context ," While debugging an application i am getting the following error. The CLR has been unable to transition from COM context 0x3b2d70 to COM context 0x3b2ee0 for 60 seconds. The thread that owns the destination context/apartment is most likely either doing a non pumping wait or processing a very long running operation without pumping Windows messages. This situation generally has a negative performance impact and may even lead to the application becoming non responsive or memory usage accumulating continually over time. To avoid this problem, all single threaded apartment (STA) threads should use pumping wait primitives (such as CoWaitForMultipleHandles) and routinely pump messages during long running operations.Why system throws this error. <code> ",CLR has been unable to transition from COM context 0x3b2d70 to COM context
C# Visual Studio 2010 suddenly can't see namespace?," My C# WinForms solution has two projects.A DLL which is the main project I'm working on, and an executable WinForms I call ""Sandbox"" so that I can compile/run/debug the DLL easily in one go.I'm working in .Net 4.0 for both projects.Everything was working fine until I added some seemingly innocent code, and a reference to System.Web in the DLL.Now my Sandbox project can't see the namespace of the DLL project. I didn't change anything which I believe should have affected this.If I delete the project reference to the DLL from the Sandbox references and re-add it, then the red underlines all disappear and the colour coding comes back for all my classes etc; but as as soon as I try to build the solution, the whole thing falls apart again.When I right-click the DLL project in the Sandbox's references and view in object browser, I can see the namespace and all the stuff in there.I have a feeling this might be some sort of bug?Is this some sort of VS2010 bug? I had this same issue a few months ago and I could only fix it at the time by making a whole new project and re-importing my files. This time, however, I have a bajillion files and will only do that as a last resort!Edit:After panickedly going through and undoing all my changes, trying to find what caused the problems, it seems to be this line: If I comment out this line, then I get no namespace errors and the project builds fine. I can't see anything wrong with this line though. <code>  string url = ""http://maps.google.com?q="" + HttpUtility.UrlEncode(address);",Visual Studio 2010 suddenly can't see namespace?
Can I implement an interface that contains a property that is of child type to what is required by the base interface?," I am receiving the following error: ClassName.PropertyName cannot implement IClassType.PropertyName because it does not have the matching return type of IBasePropertyTypeNow, for the code: Is there a way to do what I am attempting? I know that the issue is with co/contravariance, but I can't seem to figure out how to do this. <code>  public class ClassName : IClassType{ public IChildPropertyType PropertyName { get; set; }}public interface IClassType{ public IBasePropertyType PropertyName { get; set; }}public interface IBasePropertyType{ // some methods}public interface IChildPropertyType : IBasePropertyType{ // some methods}",Can I implement an interface that contains a property that is of child type to what is required by the interface?
ResolveUrl without an ASP Page," I am looking for a way to resolve a relative url the way you would with a page or control instance (MSDN Docs) such as: ...but when I only have an HttpContext available to me, such as when I am in a HttpHandler. Will I need to use a custom function, such as the one seen here?Or is there a way to get at the underlying function used by the Page. <code>  Page.ResolveUrl(""~/common/Error.aspx"");",ResolveUrl without an ASP.NET Page
"It's the ""The type or namespace name 'xxxx' could not be found"" thing"," I've already wasted a few hours on this one: YES, the using is there, the reference is there, I made the entire solution in VS2010 using .NET 4.0 so it's not any of those things. If I go in Object Explorer I can find the XmlSerializer class I want in the correct namespace but if I try typing the above line in to my code file and compiling I get the dreaded The type or namespace name 'XmlSerializer' could not be found (are you missing a using directive or an assembly reference?)warning of death. I don't get it on IntelliSense either. All other threads/websites I've looked on have come up blank or with one of the solutions I've already ruled out. What am I missing?Cheers <code>  XmlSerializer serializer;","""The type or namespace name 'XmlSerializer' could not be found"" error when System.Xml.dll is referenced"
why is C# 4 optional parameters defined on interface not enforced on implementing class?," I noticed that with the optional parameters in C# 4 if you specify an optional parameter on an interface you don,t have to make that parameter optional on any implementing class: and therefore: Does anyone know why optional parameters are designed to work this way?On one hand I suppose the ability to override any default values specified on the interfaces is useful though to be honest I'm not sure if you should even be able to specify default values on the interface as that should be an implementation decision.On the other hand, this disconnect means you can't always use the concrete class and the interface interchangeably. This of course, wouldn't be a problem if the default value is specified on the implementation, but then if you're exposing your concrete class as the interface (using some IOC framework to inject the concrete class for instance) then really there's no point having the default value as the caller will have to always provide it anyway. <code>  public interface MyInterface{ void TestMethod(bool flag = false);}public class MyClass : MyInterface{ public void TestMethod(bool flag) { Console.WriteLine(flag); }} var obj = new MyClass(); obj.TestMethod(); // compiler errorvar obj2 = new MyClass() as MyInterface;obj2.TestMethod(); // prints false",Why are C# 4 optional parameters defined on interface not enforced on implementing class?
"C# CAML query to a SharePoint list, order by a lookup field."," I'm attempting to pull a list from SharePoint via CAML and I want the list returned ordered by a specific field. The field is a lookup field. The query comes back unordered when I set the OrderBy to be the lookup field, if I use a text field it's fine. The U2U CAML query builder will return this query ordered when I build it in the editor. Here's a code snippet of how I build and execute the query: The rest is a for loop that parses the collection and displays it. I can post that if necessary.Here's the SOAP call made by the CAML query tool, I scraped it from the HTTP stream with wireshark. For whatever reason the CAML query tool works, my code doesn't. Anyone know why? Thanks in advance.Edited to reflect the code I'm actually testing. I had some code that had incorrect values. <code>  String baseQuery = ""<Query><Where><Eq><FieldRef Name='paApproved' /><Value Type='Boolean'>1</Value></Eq></Where><OrderBy><FieldRef Name='paState' Ascending='True' LookupValue='TRUE' /></OrderBy></Query>"";qStates.Query = baseQuery;SPListItemCollection byState = web.Lists[""paUpdates""].GetItems(qStates); <?xml version=""1.0"" encoding=""utf-8""?><soap:Envelope xmlns:soap=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema""> <soap:Body> <GetListItems xmlns=""http://schemas.microsoft.com/sharepoint/soap/""> <listName>paUpdates</listName> <query> <Query xmlns=""""> <Where> <Eq> <FieldRef Name=""paApproved"" /> <Value Type=""Boolean"">1</Value> </Eq> </Where> <OrderBy> <FieldRef Name=""paState"" Ascending=""False"" /> </OrderBy> </Query> </query> <viewFields> <ViewFields xmlns="""" /> </viewFields> <queryOptions> <QueryOptions xmlns="""" /> </queryOptions> </GetListItems> </soap:Body></soap:Envelope>","CAML query to a SharePoint list, order by a lookup field."
.Net attribute only valid on certain types, Possible Duplicate: Specify required base class for .NET attribute targets I want to specify that my custom attribute only be valid on certain types (based on interface or base class).Like this: How can I do that? <code> ,How to make .NET attribute only valid on certain types
C# Why can't var be assigned to an anonymous method?," I have the following code: However, the following does not compile: Why can't the compiler figure out it is a Func<string, bool>? It takes one string parameter, and returns a boolean. Instead, it gives me the error: Cannot assign anonymous method to an implicitly-typed local variable.I have one guess and that is if the var version compiled, it would lack consistency if I had the following: The above wouldn't make sense since Func<> allows only up to 4 arguments (in .NET 3.5, which is what I am using). Perhaps someone could clarify the problem. Thanks. <code>  Func<string, bool> comparer = delegate(string value) { return value != ""0"";}; var comparer = delegate(string value) { return value != ""0"";}; var comparer = delegate(string arg1, string arg2, string arg3, string arg4, string arg5) { return false;};",Why can't an anonymous method be assigned to var?
C# Why can't an anonymous method be assigned to var?," I have the following code: However, the following does not compile: Why can't the compiler figure out it is a Func<string, bool>? It takes one string parameter, and returns a boolean. Instead, it gives me the error: Cannot assign anonymous method to an implicitly-typed local variable.I have one guess and that is if the var version compiled, it would lack consistency if I had the following: The above wouldn't make sense since Func<> allows only up to 4 arguments (in .NET 3.5, which is what I am using). Perhaps someone could clarify the problem. Thanks. <code>  Func<string, bool> comparer = delegate(string value) { return value != ""0"";}; var comparer = delegate(string value) { return value != ""0"";}; var comparer = delegate(string arg1, string arg2, string arg3, string arg4, string arg5) { return false;};",Why can't an anonymous method be assigned to var?
How do I read a file located in a same folder where my page resides in in ASP.NET (C#)?," How do I read a file located in a same folder where my page resides in in ASP.NET (C#)?I have a page called mypage.aspx and I'm trying to read in a file called foo.txt residing in a same directory as this page. Is there a way to open that file for reading with File.OpenRead()?Providing a relative path like File.OpenRead(""foo.txt"") fails b/c of the location of the file. <code> ",How do I read a file located in a same folder where my page resides in in ASP.NET?
Authentication to FreshBooks oauth from C# ASP.NET MVC," I'm trying to use OAuth for authentication for the FreshBooks API from my ASP.NET MVC C# app. Here is what I have so far:I'm using DotNetOpenAuth here is the code I have in my controller action The TokenManager is the same class that is provided with the DotNetOpenAuth sample, I've set my consumer secret that FreshBooks gave me.On the consumer.Channel.Send(consumer.PrepareRequestUserAuthorization(...)) I've got the following exception: ""The remote server returned an error: (400) Bad Request."".Am I doing this correctly? Based on FreshBooks documentation and DotNetOpenAuth samples that should work correctly. Is there a simpler way to authenticate with OAuth, as DotNetOpenAuth is a bit huge for simply using OAuth authentication? <code>  if (TokenManager != null){ ServiceProviderDescription provider = new ServiceProviderDescription(); provider.ProtocolVersion = ProtocolVersion.V10a; provider.AccessTokenEndpoint = new MessageReceivingEndpoint (""https://myfbid.freshbooks.com/oauth/oauth_access.php"", DotNetOpenAuth.Messaging.HttpDeliveryMethods.PostRequest); provider.RequestTokenEndpoint = new DotNetOpenAuth.Messaging.MessageReceivingEndpoint(""https://myfbid.freshbooks.com/oauth/oauth_request.php"", DotNetOpenAuth.Messaging.HttpDeliveryMethods.PostRequest); provider.UserAuthorizationEndpoint = new DotNetOpenAuth.Messaging.MessageReceivingEndpoint(""https://myfbid.freshbooks.com/oauth/oauth_authorize.php"", DotNetOpenAuth.Messaging.HttpDeliveryMethods.GetRequest); provider.TamperProtectionElements = new ITamperProtectionChannelBindingElement[] { new HmacSha1SigningBindingElement() }; var consumer = new WebConsumer(provider, TokenManager); var response = consumer.ProcessUserAuthorization(); if (response != null) { this.AccessToken = response.AccessToken; } else { // we need to request authorization consumer.Channel.Send(consumer.PrepareRequestUserAuthorization( new Uri(""http://localhost:9876/home/testoauth/""), null, null)); }}",Authentication to FreshBooks via DotNetOpenAuth 
Safe (in the C# sense) way to solve problem easily solved by pointers," This is the obvious, easiest way to solve this problem. However, I'd prefer not to use an unsafe method if I can avoid it. Basically, I have a bunch of integers which represent registers. There are assembly instructions that take register mnemonics as arguments. I'd prefer not to have the logic to determine which variable to assign to in each branch of the switch statement or make some sort of kludgey GetRegisterValue(mnemonic) and SetRegisterValue(mnemonic) functions. Is there some C#y way to do something similar?  <code>  ... { int *r1, *r2; r1 = GetCorrectRegister(first); r2 = GetCorrectRegister(second); switch ((OpCode)current.opcode) { case OpCode.ADDR: r2 = r1 + r2; break; } } ...",Safe (in the C# sense) way to implement something with pointers
How to create style based on default DataGrid style ?," I have custom control that extends DataGrid. It is called ExtendedDataGrid. I want to provide style for ExtendedDataGrid that is the same as DataGrids style except it changes the template. I have tried something like this: But it says that that the resource is not found.So I try: But it also does not work... So what do I do ? <code>  <Style TargetType=""{x:Type MyControls:ExtendedDataGrid}"" BasedOn=""{StaticResource {x:Type DataGrid}}""> <Setter Property=""Template""> ... </Setter></Style> <Style TargetType=""{x:Type MyControls:ExtendedDataGrid}"" BasedOn=""{StaticResource {ComponentResourceKey ResourceId=DataGridStyle, TypeInTargetAssembly={x:Type DataGrid}}}""> <Setter Property=""Template""> ... </Setter></Style>",How to create style based on default DataGrid style?
What difference is there between the WebClient and the HTTPWebReqeust classes in .NET?," What difference is there between the WebClient and the HttpWebRequest classes in .NET? They both do very similar things. In fact, why weren't they merged into one class (too many methods/variables etc may be one reason but there are other classes in .NET which breaks that rule).Thanks. <code> ",What difference is there between WebClient and HTTPWebRequest classes in .NET?
C# converting image to black and white," Before someone flames me for not checking the other posts, I have done that already. I have a specific question about one of the techniques that exist to convert an image to grayscale.I have read through the other posts on SO and basically copied technique 3 (ColorMatrix) from the tutorial at this site. It works very, very, quickly. The problem I'm having is that what I need is a pure BW image. (i.e.: if average(R,B,G) > 200 => white else black). I have implemented it the straightforward way, and it actually takes nearly 10x as long as the grayscale algorithm from the tutorial.I am no expert with image processing, and was wondering if there is any way to modify the snippet from the tutorial to convert images to pure black and white. If not, any efficient way would do.EDIT:Here's the code I'm using for the black and white (no brain approach): <code>  public Bitmap make_bw(Bitmap original) { Bitmap output = new Bitmap(original.Width, original.Height); for (int i = 0; i < original.Width; i++) { for (int j = 0; j < original.Height; j++) { Color c = original.GetPixel(i, j); int average = ((c.R + c.B + c.G) / 3); if (average < 200) output.SetPixel(i, j, Color.Black); else output.SetPixel(i, j, Color.White); } } return output; }",What is the fastest way to convert an image to pure black and white in C#?
LINQ: Remove Element fron XML based on attribute value?," How can I remove any element in xml based on matched attribute value?Here is my XML : I am using the following LINQ query: I am getting compile time error on select as : The type of expression in select clause is IncorrectEDIT ANSWER:this one works for me. Thanks All <code>  <Projects> <Project serverUrl=""tcp://xyz1:xxx/sdfsdf.rem"" projectName=""project1"" /> <Project serverUrl=""tcp://xyz2:xxx/sdfsdf.rem"" projectName=""project2"" /> <Project serverUrl=""tcp://xyz3:xxx/sdfsdf.rem"" projectName=""project3"" /> <Project serverUrl=""tcp://xyz4:xxx/sdfsdf.rem"" projectName=""project4"" /> <Project serverUrl=""tcp://xyz5:xxx/sdfsdf.rem"" projectName=""project5"" /> <Project serverUrl=""tcp://xyz6:xxx/sdfsdf.rem"" projectName=""project6"" /> </Projects> var remove = from elemet in xdoc.Elements(""Projects"").Elements(""Project"") where elemet.Attribute(""projectName"").Value == ""project1"" select elemet.Parent.Remove(); var xElement = (from elemet in xdoc.Elements(""Projects"").Elements(""Project"") where elemet.Attribute(""projectName"").Value == foundProject select elemet); xElement.Remove();",LINQ: Remove Element from XML based on attribute value?
c#: Ways to make use of 'using' directives less tedious.," Good programming practice these days tends to mean splitting your stuff up into lots of assemblies and namespaces (for example, see S#arp Architecture, MVC, etc.). However a side-effect of that is that you have to stick a whole bunch of 'using ' directives into every class file. You know the sort of thing: Every controller class needs to 'use' the models and viewmodels namespaces, etc., etc.Are there any techniques for making this easier? For example, is it possible to declare using directives at the namespace level instead of the file level - so that every class in a namespace 'foo' automatically is using namespace 'bar'? Or are there smart ways of setting the default 'usings' that Visual Studio adds, based on the folder you are in? Or other ways of making the adding of 'usings' less tedious? <code> ",Ways to make use of 'using' directives in C# less tedious
C#: How do I do an integer list intersection while keeping duplicates?," I'm working on a Greatest Common Factor and Least Common Multiple assignment and I have to list the common factors. Intersection() won't work because that removes duplicates. Contains() won't work because if it sees the int in the second list it returns all matching ints from the first list. Is there a way to do an Intersection that is not Distinct?edit: sorry for not providing an example, here is what I meant:if I have the sets: I would want the output <code>  {1, 2, 2, 2, 3, 3, 4, 5}{1, 1, 2, 2, 3, 3, 3, 4, 4} {1, 2, 2, 3, 3, 4}",How do I do an integer list intersection while keeping duplicates?
How do I make XAML Datagrid columns fill the entire datagrid?," I am using DataGrids in XAML (not Silverlight) with resizable columns, the DataGrid will expand if the user resizes the screen.Currently if the widths of all the DataGrid columns are less than the width of the DataGrid I get an extra ""column"" appearing which is unclickable and serves no purpose.Does anyone know how to make one column always resize to fill all the remaining space? <code> ",How do I make XAML DataGridColumns fill the entire DataGrid?
LInq to Entities Distinct Clause, I want to add a distinct to the code below. I cannot figure out the exact syntax. Thanks in advance.  <code>  var testdates = (from o in db.FMCSA_ME_TEST_DATA orderby o.DATE select new { RequestDate = o.DATE });,Linq to Entities Distinct Clause
RX Schedular - What is it?, I'm reading up on RX and totally bamboozled to what the Scheduler is intended for? Can someone explain? <code> ,RX Scheduler - What is it?
WPF DataGrid - Databinding Column Button to Page's ViewModel," I'm trying to bind a data on one of my columns to data that's in my page's ViewModel (as opposed to the objects that the grid is bound to).What I have below was recommended here, to no avail. In my ViewModel Which is set to ""HELLO"" in the ViewModel's constructorDoes anyone see what I'm doing wrong?EDITHere's the entire XAML. Relevant column is all the way at the bottom, in the grid within the gridALSO - I'm having trouble getting my entire source into here again (not sure if it's citrix or what) but I took that same exact binding expression that's not working in the datagrid's button, and I dropped it onto the Text of a plain old TextBlock apart from the grid, and it worked like a charm. I also added a new dummy text column to the grid, and used that same binding expression for the text, and it still did not work. It seems this binding expression is fine, but refuses to work anywhere near the grid.  <code>  <DataGridTemplateColumn> <DataGridTemplateColumn.CellTemplate> <DataTemplate> <Button Content=""{Binding ElementName=LayoutRoot, Path=DataContext.JUNK}""></Button> </DataTemplate> </DataGridTemplateColumn.CellTemplate> </DataGridTemplateColumn> public string JUNK { get; set; } <UserControl x:Class=""MainApp.WPF.ucFmvHistoryDisplayGrid"" xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" xmlns:mc=""http://schemas.openxmlformats.org/markup-compatibility/2006"" xmlns:d=""http://schemas.microsoft.com/expression/blend/2008"" mc:Ignorable=""d"" d:DesignHeight=""300"" d:DesignWidth=""1000"" x:Name=""LayoutRoot""><UserControl.Resources> <Style x:Name=""rightAlignedColumn"" x:Key=""rightAlignedColumn"" TargetType=""TextBlock""> <Setter Property=""HorizontalAlignment"" Value=""Right"" /> </Style> <Style x:Name=""centerAlignedColumn"" x:Key=""centerAlignedColumn"" TargetType=""TextBlock""> <Setter Property=""HorizontalAlignment"" Value=""Center"" /> </Style></UserControl.Resources><Grid> <DataGrid x:Name=""dbTop"" ItemsSource=""{Binding PropertyGroupSource}"" HorizontalAlignment=""Left"" Background=""White"" CanUserAddRows=""False"" CanUserDeleteRows=""False"" CanUserReorderColumns=""False"" CanUserResizeRows=""False"" IsReadOnly=""True"" AutoGenerateColumns=""False"" Grid.Row=""1"" Width=""800""> <DataGrid.Columns> <DataGridTextColumn Width=""120"" Header=""Property Num"" Binding=""{Binding PropertyNum}""></DataGridTextColumn> <DataGridTextColumn Width=""120"" Header=""Alt Description"" Binding=""{Binding AltDescription}""></DataGridTextColumn> <DataGridTextColumn Width=""80"" Header=""County"" Binding=""{Binding County}""></DataGridTextColumn> <DataGridTextColumn Width=""100"" Header=""State"" Binding=""{Binding State}"" ElementStyle=""{StaticResource centerAlignedColumn}""></DataGridTextColumn> <DataGridTextColumn Width=""85"" Header=""Phase"" Binding=""{Binding Phase}""></DataGridTextColumn> <DataGridTextColumn Width=""85"" Header=""FMV"" Binding=""{Binding FmvTotal}""></DataGridTextColumn> <DataGridTextColumn Width=""100"" Header=""Assessed Value"" Binding=""{Binding AssessedValueTotal}""></DataGridTextColumn> </DataGrid.Columns> <DataGrid.RowDetailsTemplate> <DataTemplate> <Border Margin=""5"" BorderBrush=""Black"" BorderThickness=""1""> <DataGrid Margin=""5"" Background=""White"" CanUserAddRows=""False"" CanUserDeleteRows=""False"" CanUserReorderColumns=""False"" CanUserResizeRows=""False"" IsReadOnly=""True"" AutoGenerateColumns=""False"" Grid.Row=""1"" ItemsSource=""{Binding PropertyFmvSource}""> <DataGrid.Columns> <DataGridTextColumn Width=""125"" Header=""County Acct Num"" Binding=""{Binding Property.CountyAccountNum, StringFormat=d}"" ElementStyle=""{StaticResource rightAlignedColumn}""></DataGridTextColumn> <DataGridTextColumn Width=""80"" Header=""City"" Binding=""{Binding Property.City, StringFormat=d}"" ElementStyle=""{StaticResource rightAlignedColumn}""></DataGridTextColumn> <DataGridTextColumn Width=""80"" Header=""Jurisdiction"" Binding=""{Binding Property.Jurisdiction, StringFormat=d}"" ElementStyle=""{StaticResource rightAlignedColumn}""></DataGridTextColumn> <DataGridTextColumn Width=""80"" Header=""FMV Date"" Binding=""{Binding MostRecentFMV.FMVDate, StringFormat=d}"" ElementStyle=""{StaticResource rightAlignedColumn}""></DataGridTextColumn> <DataGridTextColumn Width=""100"" Header=""FMV"" Binding=""{Binding MostRecentFMV.FMV, StringFormat=N0}"" ElementStyle=""{StaticResource rightAlignedColumn}""></DataGridTextColumn> <DataGridTextColumn Width=""85"" Header=""Assess Ratio"" Binding=""{Binding MostRecentFMV.AssessmentRatio, StringFormat=N3}"" ElementStyle=""{StaticResource rightAlignedColumn}""></DataGridTextColumn> <DataGridTextColumn Width=""105"" Header=""Assessed Value"" Binding=""{Binding MostRecentFMV.AssessedValue, StringFormat=N0}"" ElementStyle=""{StaticResource rightAlignedColumn}""></DataGridTextColumn> <DataGridTemplateColumn> <DataGridTemplateColumn.CellTemplate> <DataTemplate> <Button Content=""{Binding ElementName=LayoutRoot, Path=DataContext.JUNK}""></Button> </DataTemplate> </DataGridTemplateColumn.CellTemplate> </DataGridTemplateColumn> </DataGrid.Columns> </DataGrid> </Border> </DataTemplate> </DataGrid.RowDetailsTemplate> </DataGrid></Grid>",WPF DataGrid - Databinding Column to Page's ViewModel
Put WPF control into a Windows Forms Form, How do you put a WPF control into a Windows Forms Form? Most likely I will be inserting my WPF control into a Windows.Forms.Panel. <code> ,Put WPF control into a Windows Forms Form?
How to do logging in c#?," I would like to implement logging in my application, but would rather not use any outside frameworks like log4net.So I would like to do something like DOS's echo to a file. What is the most effective way to do it?Is there a way to log unhandled exceptions logged without using an outside framework? <code> ",How do I do logging in C# without using 3rd party libraries?
How do I do logging in C#?," I would like to implement logging in my application, but would rather not use any outside frameworks like log4net.So I would like to do something like DOS's echo to a file. What is the most effective way to do it?Is there a way to log unhandled exceptions logged without using an outside framework? <code> ",How do I do logging in C# without using 3rd party libraries?
Rules for C# class backward compatibility," I'm working on a C# 3.5 assembly that is consumed by many different applications in an enterprise server environment. I would like to add some properties to an existing C# class (not abstract) and maintain backwards compatibility with current clients without recompiling. Its a strongly named 3.5 assembly. Existing client applications will not be recompiled. Instead we use publisher policy assemblies to re-direct existing clients to the updated version.What are the rules for maintaining this type of class backward compatibility?I'm looking for some set of rules I can validate my code changes against. After my current attempts at updating the class clients are throwing a ""The located assembly's manifest definition does not match the assembly reference"" exception. <code> ",Rules for C# class backward compatibility/avoiding breaking changes 
return boolean value from select query," I would like to select boolean value: In Visual Studio 2010 I am doing: But I get the exception: Specified cast is not valid.How can I return a boolean value as boolean and not as int? <code>  SELECT field1, field2, 1 as is_fieldFROM TABLE bool b = row.Field<bool>(""is_field"");",Return a boolean value from a select query
Check-out for edit an item in TFS programmatically," I'm working on a utility processing files being under source control using TFS 2010.If an item is not yet checked-out for edit, I'm getting an exception, what is definitely predictable because file is in read-only mode.What ways exist to check-out a file?P.S. I want something for programmatic rather then Process.Start(""tf.exe"", ""...""); if that's applicable. <code> ",How can I programmatically check-out an item for edit in TFS?
C# Winforms panles size by side taking up 50% width each," I have two panels: panelA, panelB in a panel: panelContainer.How do I make panelA and panelB go side by side taking 50% width each of the panelContainer? <code> ",Panels side by side taking up 50% width each
C# Winforms panels side by side taking up 50% width each," I have two panels: panelA, panelB in a panel: panelContainer.How do I make panelA and panelB go side by side taking 50% width each of the panelContainer? <code> ",Panels side by side taking up 50% width each
Clickonce update cancelled by user and it never asks for update again," I've a Windows Forms application, and it is deployed through ClickOnce. During launch of the application it checks for an update and prompts the user for the same. If the user choose not to install the update for that session, it doesn't ask anymore. Is this by design or am I missing any setting?How do I make it prompt the user for an update next time he launches the application? <code> ",ClickOnce update cancelled by user and it never asks for an update again
What is the use of Zip extension method in Linq?, What is the use of Enumerable.Zip extension method in Linq? <code> ,What is the use of Enumerable.Zip extension method in Linq?
Self-referencing many-to-many relationship code first Entity Framework, I can't seem to make this work at all I tried adding Mappings but in vain. Is there a way to do so with CTP5? <code>  class Member{ public virtual IList<Member> Friends { get; set; } [Key] public int MemberId { get; set; } public string Name{ get; set; }},Self-referencing many-to-many recursive relationship code first Entity Framework
create a silverlight 4 user control and use it on windows phone silverlight app, Can I create a silverlight user control that will work on a windows phone silverlight?Is there a way to do so? I don't need very complex things. just a very simple user control with a label and a few text boxes. <code> ,How to create Silverlight 4 user control for windows phone app?
"Entity Framework ""An entity object cannot be referenced by multiple instances of IEntityChangeTracker"""," This error is thrown a lot, but I can't find the solution. I am new to the Entity Framework and in my first approach I got this error.This is what I have. I have a company class and a branch class. Both classes have their own repository. A company has one Branch, while one branch can have multiple companies.In my GUI I fill a combo with Branch objects, which I get from my BranchRepository: This is result is the datasource of the branch combobox.When I want to save the company, I do something like this: Then, I call my company repository to save my company. Here is what the save method looks like: When the save method is invoked, I get the error 'An entity object cannot be referenced by multiple instances of IEntityChangeTracker'. Clearly I'm doing something wrong, but what? <code>  public IList<Branch> GetAllBranches() { var query = _context.Branches; IList<Branch> branches = query.ToList(); return branches; } company.VisitorAddress = txtVisitAddress.Text;company.City = txtCity.Text;company.CompanyName = txtCompany.Text;company.PhoneNumber = txtPhoneNumber.Text;company.ZipCode = txtZipcode.Text;company.Branch = ((Branch)cmbBranches.SelectedItem);company.Website = txtWebsite.Text; public bool Save(Company company){ _context.AddToCompanies(company); // <-- This is where the error is thrown. _context.SaveChanges(); return true;}","C# Entity Framework ""An entity object cannot be referenced by multiple instances of IEntityChangeTracker"""
WPF: DockPanel with FirstChildFill?," I want a logical and simple way of producing a layout with one control set to fill and the rest to dock. I could use: But its not very intuitive to use. I could also do it like this: But its also quite alot of xaml. What I really want is something like this: How could this be achieved while not having to reverse the items as with DockPanel and not using a fixed number of rows and attached properties as with Grid? <code>  <DockPanel LastChildFill=""True""> <Button Content=""3"" DockPanel.Dock=""Bottom"" /> <Button Content=""2"" DockPanel.Dock=""Bottom"" /> <Button Content=""1"" /></DockPanel> <Grid> <Grid.RowDefinitions> <RowDefinition Height=""*"" /> <RowDefinition Height=""Auto"" /> <RowDefinition Height=""Auto"" /> </Grid.RowDefinitions> <Button Content=""1"" Grid.Row=""0"" /> <Button Content=""2"" Grid.Row=""1"" /> <Button Content=""3"" Grid.Row=""2"" /></Grid> <StackPanel Fill=""None|First|Last""> <Button Content=""1"" /> <Button Content=""2"" /> <Button Content=""3"" /></StackPanel>",WPF: StackPanel with FirstChildFill?
XML validation: attribute value starting with a space," I have developed a small C# script that opens an XLS file, parses it and creates a list of XML files validating them against an XSD file. I've tried to upload these validated files to a third-party online service (the same company that gave me the documentation/xsd stuff) and one generated file is not being accepted because NOT VALID.The file is not accepted because it has a space at the beginning of a decimal value in a node attribute; removing this space fixes the problem.I have created a simple test case where XDocument Validate method validates the XML with the extra-space without any problem. The result is this: Is it correct that the C# XML Parser validates this XML?Is it possible to force the Parser to be more picky about this formatting? <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Xml.Schema;using System.Xml.Linq;using System.Xml;using System.IO;namespace TestParser { class Program { static void Main(string[] args) { string xsdMarkup = @""<xs:schema xmlns:xs='http://www.w3.org/2001/XMLSchema'> <xs:element name='option'> <xs:complexType> <xs:simpleContent> <xs:extension base='xs:string'> <xs:attribute name='value' type='xs:decimal'> </xs:attribute> </xs:extension> </xs:simpleContent> </xs:complexType> </xs:element> </xs:schema>""; XmlSchemaSet schemas = new XmlSchemaSet(); schemas.Add("""", XmlReader.Create(new StringReader(xsdMarkup))); XDocument doc1 = new XDocument( new XElement(""option"",""test"", new XAttribute(""value"", "" 423423"") )); Console.WriteLine(""Validating doc1""); bool errors = false; doc1.Validate(schemas, (o, e) => { Console.WriteLine(""{0}"", e.Message); errors = true; }, true); Console.WriteLine(""doc1 {0}"", errors ? ""not valid"" : ""validated""); Console.WriteLine(); Console.WriteLine(""Contents of doc1:""); Console.WriteLine(doc1); } }} Validating doc1doc1 validatedContents of doc1:<option value="" 423423"">test</option>",XML validation: decimal attribute value starting with a space
Windows Service start failure," I want to debug a Windows service but it pops an error message saying Cannot start service from the command line or a debugger. A windows service must be installed using installutil.exe and then started with the Server explorer, windows services Administrative tools or the NET start command.I don't really have any idea about this error..... <code> ",Run a Windows Service as a console app
Help needed in adding a prefix to an xml node, Current File Format Desired Output I am using XmlElement and XmlDocument to add the prefix to the child Node element and I'm unable to accomplish it. I would be really grateful if someone could give me the right push in the right direction. <code>  <Folio><Node1>Value1</Node1><Node2>Value2</Node2><Node3>Value3</Node3></Folio> <vs:Folio><vs:Node1>Value1</vs:Node1><vs:Node2>Value2</vs:Node2><vs:Node3>Value3</vs:Node3></vs:Folio>,Adding a prefix to an xml node
get whole html document as string, Does HtmlAgilityPack have the ability to return the whole HTML markup from an HtmlDocument object as a string? <code> ,HtmlAgilityPack: Get whole HTML document as string
"Filling WPF DataGrid in C# with a Dictonary <String,String>", I want to fill my DataGrid in C# with a Dictonary.I already set my Dictionary as the ItemsSource of the DataGrid.But no data is displayed...I also set AutoGenerateColumns to true.Where is the mistake?Thanks in advance <code> ,"Filling WPF DataGrid in C# with a Dictionary <String,String>"
static variable in web applications," Can I use static variables in my web application ? what are the alternatives to static ? When I use static variables in pages and more than one user use the application, it makes conflict data (incorrect data).What are the limits of using static members?Are static members shared in memory? <code> ",Static variables in web applications
Prevent mltiple cells from being selected in DataGridView Control, Can anyone tell me how to prevent multiple cells from being selected in datagridview control? <code> ,Prevent multiple cells from being selected in DataGridView Control
c# Stats Libraries?," Does anybody know of any good and free statistics libraries for .Net?I am working on calculating T-Tests, which I have written a formula to calculate, although now I need a formula for the p-value, which is a little more complex, and not being a statistician, has me a little lost. <code> ",Is there a .Net Statistics library with T-Tests and p-values?
Statistics library," Does anybody know of any good and free statistics libraries for .Net?I am working on calculating T-Tests, which I have written a formula to calculate, although now I need a formula for the p-value, which is a little more complex, and not being a statistician, has me a little lost. <code> ",Is there a .Net Statistics library with T-Tests and p-values?
.Net Statistics library," Does anybody know of any good and free statistics libraries for .Net?I am working on calculating T-Tests, which I have written a formula to calculate, although now I need a formula for the p-value, which is a little more complex, and not being a statistician, has me a little lost. <code> ",Is there a .Net Statistics library with T-Tests and p-values?
How to convert DataTable to XML file, I want to convert a DataTable to an XML file in C#. How can I do this? <code> ,How can I convert a DataTable to an XML file in C#?
tryupdatemodel asp.net mvc 2 c#, I can't seem to find just a basic code sample to see how TryUpdateModel works? When do you use it and why? <code> ,When and why do you use TryUpdateModel in asp.net mvc 2?
TryUpdateModel asp.net mvc 2 c#, I can't seem to find just a basic code sample to see how TryUpdateModel works? When do you use it and why? <code> ,When and why do you use TryUpdateModel in asp.net mvc 2?
when and why do you use TryUpdateModel in asp.net mvc 2, I can't seem to find just a basic code sample to see how TryUpdateModel works? When do you use it and why? <code> ,When and why do you use TryUpdateModel in asp.net mvc 2?
How to ignore compiler warning when using Obsolete attribute on a class used with a Knowntype attribute," So we are trying to deprecate some of our existing classes, and have started marking them as obsolete with the ObsoleteAttribute so they will stop being used. The fact that using the KnownType attribute with a type that is marked with the Obsolete attribute and is causing a compiler warning is expected. However, in our project we have warnings treated as errors so ignoring the warning isn't an option. Is there a compiler directive to suppress this warning?The following usage causes a compiler warning: Edit: I understand using compiler directives to ignore errors, but this compiler warning doesn't have a number. <code>  ///ProductTemplateDataSet is marked with the Obsolete attribute[KnownType(typeof(ProductTemplateDataSet))]public class EntityCollectionBase : System.Data.DataSet{}",How to ignore compiler warning when using Obsolete attribute on a class used with a KnownType attribute
Add a Median Methode to a List object in C sharp," I would like to override the List object in C# in order to add a Median method like Sum or Average. I already found this function: Can you tell me how to do that? <code>  public static decimal GetMedian(int[] array){ int[] tempArray = array; int count = tempArray.Length; Array.Sort(tempArray); decimal medianValue = 0; if (count % 2 == 0) { // count is even, need to get the middle two elements, add them together, then divide by 2 int middleElement1 = tempArray[(count / 2) - 1]; int middleElement2 = tempArray[(count / 2)]; medianValue = (middleElement1 + middleElement2) / 2; } else { // count is odd, simply get the middle element. medianValue = tempArray[(count / 2)]; } return medianValue;}",Add a Median Method to a List
How reliable is Request.Browser.Cookies in ASP.NET?," The Request.Browser.Cookies property (of type bool) attribute stores information whether client's browser supports cookies and whether or not they are enabled.How reliable is the property Request.Browser.Cookies? Is it guaranteed to be correct ? Or should I rather implement redirection technique suggested by Software Monkey in this question?Please note: This in not a question ""are cookies reliable"" ? This is a question: ""Is the information whether users browser accepts cookies reliable?"" <code> ",How reliable is the Request.Browser.Cookies property in ASP.NET?
Get the selected Rows from a DataGridView.," I am adding those rows which are selected by user in ""Items Found"" grid ( left hand side of screen shot) to ""Items selected"" grid ( right hand side of screen shot) whenever the user clicks ""Add To Cart"" button.The screen shot: link http://img856.imageshack.us/img856/3015/datagridview.jpg.The Search Button brings the list of books from the Search Service.Which I display in itemsFoundList which is DataGridView. Now I am not getting how to add the selected rows to cartList(which is a DataGridView). <code>  private void searchButton_Click( object sender, EventArgs e ){ itemsFoundList.Columns.Clear (); string[] list = searchServiceClient.BookSearch ( getBookName.Text, getAuthorName.Text ); itemsFoundList.Columns.Add ( ""Items"", ""Items found:"" ); displayToGrid ( itemsFoundList, list );} private void addToCart_Click( object sender, EventArgs e ) { //I am not getting what to write here.}",Get the selected Rows from a DataGridView
How i can convert BitArray to int?, How can I convert BitArray to a single int? <code> ,How can I convert BitArray to single int?
How i can convert BitArray to single int?, How can I convert BitArray to a single int? <code> ,How can I convert BitArray to single int?
How do I get list of id's as int via Lambda," I have a DataTable, say pdt, in my code. I just want to select all table[""id""] and populate then in an integer array.I can go ahead with a foreach but I am trying to learn Lambda expressions.I can't figure out how to deal with this.I have tried and but nothing seems to work. I am pretty sure this is a basic question, help out a newbie please. <code>  List<int> Ids = pdt.Select(row => row[""Id""]; return Convert.ToInt32(r)); int[] Ids = pdt.Select(row => row[""Id""]);",How do I get list of id's as int using LINQ
C# - How to fix Error: Could not find schema information for the attribute/element ," I have a windows forms application written in VS2010 with C# and get the following errors in the app.config file: What do I have to change in the code to fix this issue? Where can I edit what's in CCP_Utility.Settings1 and CCP_Utility.Properties.Settings ?Here's the app.config code:  <code>  Message 4 Could not find schema information for the attribute 'name'Message 8 Could not find schema information for the attribute 'name'Message 12 Could not find schema information for the attribute 'name'Message 5 Could not find schema information for the attribute 'serializeAs'Message 15 Could not find schema information for the element 'CCP_Utility.Settings1'Message 2 Could not find schema information for the element 'CCP_Utility.Properties.Settings'Message 3 Could not find schema information for the element 'setting'Message 1 Could not find schema information for the element 'userSettings'Message 6 Could not find schema information for the element 'value' <configuration><configSections> <sectionGroup name=""userSettings"" type=""System.Configuration.UserSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" > <section name=""CCP_Utility.Properties.Settings"" type=""System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" allowExeDefinition=""MachineToLocalUser"" requirePermission=""false"" /> <section name=""CCP_Utility.Settings1"" type=""System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" allowExeDefinition=""MachineToLocalUser"" requirePermission=""false"" /> </sectionGroup> </configSections><userSettings> <CCP_Utility.Properties.Settings> <setting name=""SourceDir"" serializeAs=""String""> <value /> </setting> <setting name=""TargetDir"" serializeAs=""String""> <value /> </setting> <setting name=""CorpID"" serializeAs=""String""> <value /> </setting> </CCP_Utility.Properties.Settings> <CCP_Utility.Settings1> <setting name=""sourceDir"" serializeAs=""String""> <value /> </setting> <setting name=""targetDir"" serializeAs=""String""> <value /> </setting> </CCP_Utility.Settings1> </userSettings></configuration>","How to fix Error: ""Could not find schema information for the attribute/element"" by creating schema"
C# - How to fix Error: Could not find schema information for the attribute/element by creating schema," I have a windows forms application written in VS2010 with C# and get the following errors in the app.config file: What do I have to change in the code to fix this issue? Where can I edit what's in CCP_Utility.Settings1 and CCP_Utility.Properties.Settings ?Here's the app.config code:  <code>  Message 4 Could not find schema information for the attribute 'name'Message 8 Could not find schema information for the attribute 'name'Message 12 Could not find schema information for the attribute 'name'Message 5 Could not find schema information for the attribute 'serializeAs'Message 15 Could not find schema information for the element 'CCP_Utility.Settings1'Message 2 Could not find schema information for the element 'CCP_Utility.Properties.Settings'Message 3 Could not find schema information for the element 'setting'Message 1 Could not find schema information for the element 'userSettings'Message 6 Could not find schema information for the element 'value' <configuration><configSections> <sectionGroup name=""userSettings"" type=""System.Configuration.UserSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" > <section name=""CCP_Utility.Properties.Settings"" type=""System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" allowExeDefinition=""MachineToLocalUser"" requirePermission=""false"" /> <section name=""CCP_Utility.Settings1"" type=""System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" allowExeDefinition=""MachineToLocalUser"" requirePermission=""false"" /> </sectionGroup> </configSections><userSettings> <CCP_Utility.Properties.Settings> <setting name=""SourceDir"" serializeAs=""String""> <value /> </setting> <setting name=""TargetDir"" serializeAs=""String""> <value /> </setting> <setting name=""CorpID"" serializeAs=""String""> <value /> </setting> </CCP_Utility.Properties.Settings> <CCP_Utility.Settings1> <setting name=""sourceDir"" serializeAs=""String""> <value /> </setting> <setting name=""targetDir"" serializeAs=""String""> <value /> </setting> </CCP_Utility.Settings1> </userSettings></configuration>","How to fix Error: ""Could not find schema information for the attribute/element"" by creating schema"
"C# - How to fix Error: ""Could not find schema information for the attribute/element"" by creating schema"," I have a windows forms application written in VS2010 with C# and get the following errors in the app.config file: What do I have to change in the code to fix this issue? Where can I edit what's in CCP_Utility.Settings1 and CCP_Utility.Properties.Settings ?Here's the app.config code:  <code>  Message 4 Could not find schema information for the attribute 'name'Message 8 Could not find schema information for the attribute 'name'Message 12 Could not find schema information for the attribute 'name'Message 5 Could not find schema information for the attribute 'serializeAs'Message 15 Could not find schema information for the element 'CCP_Utility.Settings1'Message 2 Could not find schema information for the element 'CCP_Utility.Properties.Settings'Message 3 Could not find schema information for the element 'setting'Message 1 Could not find schema information for the element 'userSettings'Message 6 Could not find schema information for the element 'value' <configuration><configSections> <sectionGroup name=""userSettings"" type=""System.Configuration.UserSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" > <section name=""CCP_Utility.Properties.Settings"" type=""System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" allowExeDefinition=""MachineToLocalUser"" requirePermission=""false"" /> <section name=""CCP_Utility.Settings1"" type=""System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" allowExeDefinition=""MachineToLocalUser"" requirePermission=""false"" /> </sectionGroup> </configSections><userSettings> <CCP_Utility.Properties.Settings> <setting name=""SourceDir"" serializeAs=""String""> <value /> </setting> <setting name=""TargetDir"" serializeAs=""String""> <value /> </setting> <setting name=""CorpID"" serializeAs=""String""> <value /> </setting> </CCP_Utility.Properties.Settings> <CCP_Utility.Settings1> <setting name=""sourceDir"" serializeAs=""String""> <value /> </setting> <setting name=""targetDir"" serializeAs=""String""> <value /> </setting> </CCP_Utility.Settings1> </userSettings></configuration>","How to fix Error: ""Could not find schema information for the attribute/element"" by creating schema"
PredicateBuild Add Method not working," I have downloaded the predicate builder and am having a difficult time getting it to work with the entity framework. Here is my code: v_OrderDetail is the entity When I look at the results I get back every order. The And predicate doesn't seem to take. When I look at the predicate.parameters.count it only shows 1. I'm not sure, but I would expect it to show 2 after I add the second one.Any help is greatly appreciated. <code>  var context = new OrdersEntities();Expression<Func<v_OrderDetail,bool>> whereClause = w => true; var predicate = PredicateBuilder.True<v_OrderDetail>(); predicate.And(w => w.Status == ""Work""); var results = context.v_OrderDetail.AsExpandable().Where(predicate);","PredicateBuilder ""And"" Method not working"
PredicateBuilder Add Method not working," I have downloaded the predicate builder and am having a difficult time getting it to work with the entity framework. Here is my code: v_OrderDetail is the entity When I look at the results I get back every order. The And predicate doesn't seem to take. When I look at the predicate.parameters.count it only shows 1. I'm not sure, but I would expect it to show 2 after I add the second one.Any help is greatly appreciated. <code>  var context = new OrdersEntities();Expression<Func<v_OrderDetail,bool>> whereClause = w => true; var predicate = PredicateBuilder.True<v_OrderDetail>(); predicate.And(w => w.Status == ""Work""); var results = context.v_OrderDetail.AsExpandable().Where(predicate);","PredicateBuilder ""And"" Method not working"
How to get current page URL in MVC 3.," I am using the Facebook comments plugin on a blog I am building. It has some FBXML tags that are interpreted by the facebook javascript that is referenced on the page.This all works fine, but I have to pass in the current, fully-qualified URL to the plugin. What is the best way to get the URL of the current page? The request URL.SolutionHere is the final code of my solution: <code>  <div style=""width: 900px; margin: auto;""> <div id=""fb-root""></div> <fb:comments href=""URL HERE"" num_posts=""10"" width=""900""></fb:comments></div> <fb:comments href=""@Request.Url.AbsoluteUri"" num_posts=""15"" width=""900""></fb:comments>",How to get current page URL in MVC 3
Get underlying type of enum?," How can you get the underlying/derived Type(byte, short, int, etc) of an enum? <code> ",Get underlying/derived type of enum?
Powershell in C# doesn't work," I am trying to create a Windows Application that will be able to run a variety of Powershell scripts.I have a script which works as it should (when run from the Powershell prompt), and my Windows Application seems to execute it like it should, but it is unable to find the methods on my OU.When I execute the script from the Windows Application, I get these messages out: ERROR: The following exception occurred while retrieving member ""Create"": ""There is no such object on the server. "" ERROR: The following exception occurred while retrieving member ""Delete"": ""There is no such object on the server.""Powershell script: }The C# code I have is this: <code>  function New-AdUser {param ( [string] $Username = $(throw ""Parameter -Username [System.String] is required.""), [string] $Password = $(throw ""Parameter -Password [System.String] is required.""), [string] $OrganizationalUnit = ""Users"", [string] $DisplayName, [string] $FirstName, [string] $LastName, [string] $Initials,[string] $MobilePhone, [string] $Description, [switch] $CannotChangePassword, [switch] $PasswordNeverExpires, [switch] $Disabled)try { $currentDomain = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain() $dn = $currentDomain.GetDirectoryEntry().distinguishedName $ou = [ADSI] ""LDAP://CN=$OrganizationalUnit,$dn"" $userAccount = $ou.Create(""user"", ""cn=$Username"") $userAccount.SetInfo() $userAccount.userAccountControl = ($userAccount.userAccountControl.Item(0) -bxor 0x0002) #Enable the account $userAccount.SetInfo() $userAccount.sAMAccountName = $Username $userAccount.SetInfo() $userAccount.userPrincipalName = (""{0}@{1}"" -f $Username, $currentDomain.Name) if ($DisplayName) { $userAccount.displayName = $DisplayName } if ($Description) { $userAccount.description = $Description } if ($FirstName) { $userAccount.givenName = $FirstName } if ($LastName) { $userAccount.SN = $LastName } if ($Initials) { $userAccount.initials = $Initials }if ($MobilePhone) { $userAccount.mobile = $MobilePhone} $userAccount.SetInfo() $userAccount.SetPassword($Password) # Password if ($PasswordNeverExpires) { $userAccount.userAccountControl = ($userAccount.userAccountControl.Item(0) -bxor 0x10000) } if ($CannotChangePassword) { $everyOne = [System.Security.Principal.SecurityIdentifier]'S-1-1-0' $EveryoneDeny = new-object System.DirectoryServices.ActiveDirectoryAccessRule ($Everyone,'ExtendedRight','Deny', [System.Guid]'ab721a53-1e2f-11d0-9819-00aa0040529b') $self = [System.Security.Principal.SecurityIdentifier]'S-1-5-10' $SelfDeny = new-object System.DirectoryServices.ActiveDirectoryAccessRule ($self,'ExtendedRight','Deny', [System.Guid]'ab721a53-1e2f-11d0-9819-00aa0040529b') $userAccount.get_ObjectSecurity().AddAccessRule($selfDeny) $userAccount.get_ObjectSecurity().AddAccessRule($EveryoneDeny) $userAccount.CommitChanges() } $userAccount.SetInfo() if ($Disabled) { $userAccount.userAccountControl = ($userAccount.userAccountControl.Item(0) -bxor 0x0002) } $userAccount.SetInfo()} catch { Write-Error $_ $ou.Delete(""user"", ""cn=$Username"") return $false}return $true PowerShell ps = PowerShell.Create(); ps.AddScript(GetScript(""New-AdUser.ps1"")); ps.Invoke(); ps.AddCommand(""New-AdUser"").AddParameters( new List<CommandParameter>() { new CommandParameter(""Username"", username), new CommandParameter(""Password"", password), new CommandParameter(""FirstName"", firstName), new CommandParameter(""LastName"", lastName), new CommandParameter(""DisplayName"", realName), new CommandParameter(""Initials"", initials), new CommandParameter(""MobilePhone"", mobilePhone), new CommandParameter(""OrganizationalUnit"", ""Users""), new CommandParameter(""PasswordNeverExpires"") } ); var results = ps.Invoke(); foreach (var obj in results) Console.WriteLine(obj.ToString()); if (ps.Streams.Error.Count > 0) { foreach (var err in ps.Streams.Error) Console.WriteLine(""ERROR: {0}"", err.ToString()); }","PowerShell script runs from the shell, but not from my application"
Check if an element exists when parsing xml c#," I'm parsing XML. I normally parse it the way I show in the code below which is straightforward The problem is that I don't own the XML I'm parsing and I can't change it. Sometimes there is no thumbnail element (there are no tags) and I get an Exception.Is there a way to maintain this simplicity and check if the element exists? Or do I have to get first an XElement list with LINQ, to then check it and fill only the existing object properties? <code>  void wc_DownloadStringCompleted(object sender, DownloadStringCompletedEventArgs e){ XDocument dataDoc = XDocument.Load(new StringReader(e.Result)); var listitems = from noticia in dataDoc.Descendants(""Noticia"") select new News() { id = noticia.Element(""IdNoticia"").Value, published = noticia.Element(""Data"").Value, title = noticia.Element(""Titol"").Value, subtitle = noticia.Element(""Subtitol"").Value, thumbnail = noticia.Element(""Thumbnail"").Value }; itemList.ItemsSource = listitems;}",Check if an element exists when parsing XML
C# - Check if an element exists when parsing XML," I'm parsing XML. I normally parse it the way I show in the code below which is straightforward The problem is that I don't own the XML I'm parsing and I can't change it. Sometimes there is no thumbnail element (there are no tags) and I get an Exception.Is there a way to maintain this simplicity and check if the element exists? Or do I have to get first an XElement list with LINQ, to then check it and fill only the existing object properties? <code>  void wc_DownloadStringCompleted(object sender, DownloadStringCompletedEventArgs e){ XDocument dataDoc = XDocument.Load(new StringReader(e.Result)); var listitems = from noticia in dataDoc.Descendants(""Noticia"") select new News() { id = noticia.Element(""IdNoticia"").Value, published = noticia.Element(""Data"").Value, title = noticia.Element(""Titol"").Value, subtitle = noticia.Element(""Subtitol"").Value, thumbnail = noticia.Element(""Thumbnail"").Value }; itemList.ItemsSource = listitems;}",Check if an element exists when parsing XML
c# Get all available FontFamily," I have an input box, and people type a font in and it saves what they type as a JPEG. All works fine. But when they type a font name like 'times new roman' it has to be capitalised properly to 'Times New Roman' or it wont work!Can I just iterate all the available fonts somehow and present it to them as a dropdown list so there are no spelling problems and they definitely will only be using fonts on the system? <code> ",C# Get all available FontFamily
How to swap without third variable?, I have to swap two variables with a number value without using a third variable. What is the simple solution? <code> ,How to swap without a third variable?
[C#] how to use string.join to join value from and object array?," I have an array of object e.g: and within MyObject it contains a string property, If I want to join the whole array of objects by their stringValue, how can I do it? <code>  MyObject[] objs; object[0].stringValue",how to use string.join to join value from an object array?
how to use string.join to join value from and object array?," I have an array of object e.g: and within MyObject it contains a string property, If I want to join the whole array of objects by their stringValue, how can I do it? <code>  MyObject[] objs; object[0].stringValue",how to use string.join to join value from an object array?
Setting SqlParameter with 0 sets null," I was doing something like this: But I stop getting the exception when I put it like this: Can anyone tell me why SqlParameter assumes 0 is the same as null?Edit: MSDN Explains this here: SqlParameter Constructor <code>  SqlParameter param = new SqlParameter(""@Param"", 0) { SqlDbType = SqlDbType.Int };private void TestParam(SqlParameter param) { string test = param.Value.ToString(); // Getting NullReferenceException here} SqlParameter param = new SqlParameter(""@Param"", SqlDbType.Int) { Value = 0 };private void TestParam(SqlParameter param) { string test = param.Value.ToString(); // Everything OK}",SqlParameter with default value set to 0 doesn't work as expected
The ObjectContext instance has been disposed and can no longer be used for operations that require a connection.," I have this view: I have this controller for the HttpPost: Here is the View for Results: I keep getting this error: The ObjectContext instance has been disposed and can no longer be used for operations that require a connection.I can't figure out why. <code>  @model MatchGaming.Models.ProfileQuery@{ ViewBag.Title = ""Index"";}<h2>Index</h2> <script src=""@Url.Content(""~/Scripts/jquery.validate.min.js"")"" type=""text/javascript""></script><script src=""@Url.Content(""~/Scripts/jquery.validate.unobtrusive.min.js"")"" type=""text/javascript""></script>@using (Html.BeginForm(""Results"", ""Profiles"")) { @Html.ValidationSummary(true) <fieldset> <legend>ProfileQuery</legend> @Html.EditorFor(model=>model.SearchString) <p> <input type=""submit"" value=""Create"" /> </p> </fieldset>}<div> @Html.ActionLink(""Back to List"", ""Index"")</div> [HttpPost]public ActionResult Results(ProfileQuery profileQuery){ Debug.Write(profileQuery.SearchString); using(var db = new MatchGamingEntities()) { var SearchUserName = db.Users.SingleOrDefault(a=> a.UserName.Contains(profileQuery.SearchString)); var Users = from m in db.Users join m2 in db.MyProfiles on m.UserId equals m2.UserId where m.UserName == SearchUserName.UserName select new UserViewModel { UserName = m.UserName, LastActivityDate = m.LastActivityDate, Address = m2.Address, City = m2.City, State = m2.State, Zip = m2.Zip }; return View(Users.AsEnumerable()); }} @model IEnumerable<MatchGaming.Models.UserViewModel> @{ ViewBag.Title = ""Results"";}<h2>Results</h2><fieldset> <legend>UserViewModel</legend> @foreach (var item in Model){ <div class=""display-label"">UserName</div> <div class=""display-field"">@item.UserName</div> <div class=""display-label"">LastActivityDate</div> <div class=""display-field"">@String.Format(""{0:g}"", item.LastActivityDate)</div> <div class=""display-label"">Address</div> <div class=""display-field"">@item.Address</div> <div class=""display-label"">City</div> <div class=""display-field"">@item.City</div> <div class=""display-label"">State</div> <div class=""display-field"">@item.State</div> <div class=""display-label"">Zip</div> <div class=""display-field"">@item.Zip</div> }</fieldset>",The ObjectContext instance has been disposed and can no longer be used for operations that require a connection
Inherit List<T>," What is the fastest way to implement a new class that inherits from List<T>? One problem I've encountered: By simply doing (1), I've found that I'm not getting the benefit of inheriting any constructors from List<T>.In the end, I'd like Animals to behave a lot like a List<T> (e.g., can be constructed, compatibility with Linq). But in addition, I'd also like to be able to add my own custom methods. <code>  class Animal {}class Animals : List<Animal> {} // (1)",Inheriting from List<T>
Inheriting from List<T>," What is the fastest way to implement a new class that inherits from List<T>? One problem I've encountered: By simply doing (1), I've found that I'm not getting the benefit of inheriting any constructors from List<T>.In the end, I'd like Animals to behave a lot like a List<T> (e.g., can be constructed, compatibility with Linq). But in addition, I'd also like to be able to add my own custom methods. <code>  class Animal {}class Animals : List<Animal> {} // (1)",Inheriting from List<T>
assign value usnig linq., this is my collection of company list I want to assign values to Name property using LINQ (I want to assing name property of company id 1)how do I assign it.? <code>  public class Company{ public int id { get; set; } public int Name { get; set; }}List<Company> listofCompany = new List<Company>(); listofCompany.Where(d => d.Id = 1);,assign value using linq
assign value using linq., this is my collection of company list I want to assign values to Name property using LINQ (I want to assing name property of company id 1)how do I assign it.? <code>  public class Company{ public int id { get; set; } public int Name { get; set; }}List<Company> listofCompany = new List<Company>(); listofCompany.Where(d => d.Id = 1);,assign value using linq
How do I change the .net framework bootstrapper package?," I have a C# project that I previously had targeting .NET 4.0, and now I want to target .NET 3.5, but I am getting this warning: The version of the .NET Framework launch condition '.NET Framework 3.5' does not match the selected .NET Framework bootstrapper package. Update the .NET Framework launch condition to match the version of the .NET Framework selected in the Prerequisites Dialog Box. But when I look under Publish->Prerequisites, .NET framework 3.5 SP1 is checked.What do I need to do to get rid of this warning? There is no checkbox for .NET framework 3.5 without SP1, can I just not check any box?I checked the launch condition, and the .NET framework launch condition version is already 3.5. <code> ",How do I change the .NET framework bootstrapper package?
"C# - How is an ""int"" assigned to an object ?"," How are we able to assign an integer to an object in .NET?Reference types are derived from System.Object and value types are from System.ValueType.So, how is it possible? <code> ","How is an ""int"" assigned to an object?"
MVC3: WebGrid Column Format Issue," I've been trying to change the format of a single column in a WebGrid without much success. Said column is this: The error is: The best overloaded method match for 'System.Web.Helpers.WebGrid.Column(string, string, System.Func, string, bool)' has some invalid argumentsI am confused as the method signature matches. Also, if I change the column to the below then it works without any errors: For reference, EmailLink is a very basic HtmlHelper extension method: Can anyone tell me what the issue here is, and how I can solve it? <code>  grid.Column( columnName: ""EmailAddress"", header: ""Email Address"", format:(item) => Html.EmailLink(item.EmailAddress, item.EmailAddress, """"), canSort: false), grid.Column( columnName: ""EmailAddress"", header: ""Email Address"", format:(item) => new HtmlString(String.Format(""<a href=\""mailto:{0}\"" class=\""{2}\"">{1}</a>"", item.EmailAddress, item.EmailAddress, """")), canSort: false), public static IHtmlString EmailLink(this HtmlHelper helper, string emailAddress, string linkText, string linkClass) { return new HtmlString(String.Format(""<a href=\""mailto:{0}\"" class=\""{2}\"">{1}</a>"", emailAddress, linkText, linkClass));}",WebGrid Column Format Issue in MVC3
Designing Application that can Accept Components, Like there are many Applications which are just basic but you can have install add-ins for it which extends its functionality in that Application. For example: How do they design such applications and how does the application accept the module and how can it automatically integrate.Secondly I do not know if the above process is generic or some language or tool dependent. Can we make such application in WPF or Winforms? <code>  Fire Bug in Mozilla Firefox.,Designing Application that can accept add ins
Is it possible to turn a byte into a two-digit hexadecimal number using ToString()?," I can turn a byte into a hexadecimal number like this: but it will have only one digit if it is less than 0x10. I need it with a leading zero. Is there a format string that makes it possible to do this in a single call to ToString? <code>  myByte.ToString(""X"")",Turn byte into two-digit hexadecimal number just using ToString?
"Why do I still get ""the query contains references to items defined on a different data context"" message?"," Initially I had written this query using LINQ-to-SQL And when I executed it, and saw result in the QuickWatch.., it showed this message: the query contains references to items defined on a different data contextOn googling, I found this topic at Stackoverflow itself, where I learned simulating cross context joins and as suggested there, I changed my query a bit to this: This query is using these SimulateXyz methods: But even this approach didn't solve the problem. I'm still getting this message in QuickWatch...: the query contains references to items defined on a different data contextAny solution for this problem? Along with the solution, I would also want to know why the problem still exists, and how exactly the new solution removes it, so that from next time I could solve such problems myself. I'm new to LINQ, by the way. <code>  var result = from w in PatternDataContext.Windows join cf in PatternDataContext.ControlFocus on w.WindowId equals cf.WindowId join p in PatternDataContext.Patterns on cf.CFId equals p.CFId join r in ResultDataContext.Results on p.PatternId equals r.PatternId join fi in ResultDataContext.IclFileInfos on r.IclFileId equals fi.IclFileId join sp in sessionProfileDataContext.ServerProfiles on fi.ServerProfileId equals sp.ProfileId join u in infrastructure.Users on sp.UserId equals u.Id where w.Process.Equals(processName) select u.DistributedAppId; var result = from w in PatternDataContext.Windows join cf in PatternDataContext.ControlFocus on w.WindowId equals cf.WindowId join p in PatternDataContext.Patterns on cf.CFId equals p.CFId join r in SimulateJoinResults() on p.PatternId equals r.PatternId join fi in SimulateJoinIclFileInfos() on r.IclFileId equals fi.IclFileId join sp in SimulateJoinServerProfiles() on fi.ServerProfileId equals sp.ProfileId join u in SimulateJoinUsers() on sp.UserId equals u.Id where w.Process.Equals(processName) select u.DistributedAppId; private static IQueryable<Result> SimulateJoinResults(){ return from r in SessionDataProvider.Instance.ResultDataContext.Results select r;}private static IQueryable<IclFileInfo> SimulateJoinIclFileInfos(){ return from f in SessionDataProvider.Instance.ResultDataContext.IclFileInfos select f;}private static IQueryable<ServerProfile> SimulateJoinServerProfiles(){ return from sp in sessionProfileDataContext.ServerProfiles select sp;}private static IQueryable<User> SimulateJoinUsers(){ return from u in infrastructureDataContext.Users select u;}",Working with Cross Context Joins in LINQ-to-SQL
ASP.NET MVC 3 Redirect From Action Filter Attribute," What is the best way to do a redirect in an ActionFilterAttribute. I have an ActionFilterAttribute called IsAuthenticatedAttributeFilter and that checked the value of a session variable. If the variable is false, I want the application to redirect to the login page. I would prefer to redirect using the route name SystemLogin however any redirect method at this point would be fine. <code> ",Redirect From Action Filter Attribute
Sending SMS from asp.net website," Is there a way to send SMS from an ASP.NET website using a Web API? I know about web services, but don't know how to call those services from my app. <code> ",Sending SMS from an ASP.NET website
can C# store more precise data than doubles?," double in C# don't hold enough precision for my needs. I am writing a fractal program, and after zooming in a few times I run out of precision. I there a data type that can hold more precise floating-point information (i.e more decimal places) than a double? <code> ",Can C# store more precise data than doubles?
Is there a Mixed Authentication Disposition ASP.NET Module (MADAM) port for ASP.NET MVC?," The Mixed Authentication Disposition ASP.NET Module (MADAM) is exactly what I need for the project I'm building in MVC2. I'm not an expert on authentication, could MADAM be quickly retrofitted to work with the MVC pipeline?http://msdn.microsoft.com/en-us/library/aa479391.aspx <code> ",Is there a port of the Mixed Authentication Disposition ASP.NET Module (MADAM) for ASP.NET MVC?
"ASP.NET MVC, C#: How can I make a logout of all site user?"," I'm using MySQL Connector/.NET, all its providers with FormsAuthentication.I need all users to log out at some moment. The method FormsAuthentication.SignOut() does not work like I want. How can I make a logout of all site users? <code> ", How can I force a log out of all users for a website?
"ASP.NET MVC, C#: How can I make a logout of all site users?"," I'm using MySQL Connector/.NET, all its providers with FormsAuthentication.I need all users to log out at some moment. The method FormsAuthentication.SignOut() does not work like I want. How can I make a logout of all site users? <code> ", How can I force a log out of all users for a website?
C#: Instantiate a type dynamicly using Reflection?," I need to instatiate a C# type dynamically, using reflection. Here is my scenario: I am writing a base class, which will need to instantiate a certain object as a part of its initialization. The base class won't know what type of object it is supposed to instantiate, but the derived class will. So, I want to have the derived class pass the type to the base class in a base() call. The code looks something like this: In other words, the base class is delegating to its derived type the choice of the object type to be instantiated.Can someone please assist? <code>  public abstract class MyBaseClass{ protected MyBaseClass(Type myType) { // Instantiate object of type passed in /* This is the part I'm trying to figure out */ }}public class MyDerivedClass : MyBaseClass{ public MyDerivedClass() : base(typeof(Whatever)) { }}",How to instantiate a type dynamically using reflection?
Is parsing null in to a method acceptable," Null is an odd data type for me, it seems as though it is wrong to ever use, maybe its the null pointer errors i got so often as a beginner that now have me associating any instance of null to some kind of evil!Anyway my question is in some cases is it ok to use null as a parameter? for example, a method may need a and b to do a task, but in some cases it may only need a. Is parsing in null ok for b in those odd instances and checking if(b==null) then we know what called it?Or am i way of the mark here? i must admit, what got me wondering whether this was acceptable was, the method in question could be overlaoded, but it would have a difference of possibly 5 or 6 lines out of the whole method. This made me worried about code duplication. <code> ",Is passing null in to a method acceptable
Why this class don't have default constructor in C#?," Case 1: I am trying this And got compilation error 'System.Windows.Forms.MessageBox' has no constructors definedCase 2:Then, I have made a class without constructor and tried myClass my = new myClass(); This time I found no error.Now, my question: Why I am getting error in 1st case? Since, both are classes and every class have default constructor, thenWhere is default constructor in 1st case? <code>  MessageBox m = new MessageBox(); class myClass{}",Why doesn't the MessageBox class have a default constructor in C#?
PowerShell - Provide a .NET method as a delegate callback," What is the syntax to pass .NET method as a delegate callback to a .NET object in PowerShell.For example:C#: PowerShell: This doesn't work. <code>  public class Class1{ public static void MyMethod(Action<object> obj) { obj(""Hey!""); }}public class Class2{ public static void Callback(object obj) { Console.Writeline(obj.ToString()); }} [Class1]::MyMethod([Class2]::Callback)",Provide a .NET method as a delegate callback
Usage & versus &&, I came across this: The second case could be a scenario for short circuiting.So can't we always use just & instead of &&? <code>  bool Isvalid = isValid & CheckSomething()bool Isvalid = isValid && CheckSomething(),Usage of '&' versus '&&' in C#
Usage of '&' versus '&&', I came across this: The second case could be a scenario for short circuiting.So can't we always use just & instead of &&? <code>  bool Isvalid = isValid & CheckSomething()bool Isvalid = isValid && CheckSomething(),Usage of '&' versus '&&' in C#
custom Data Annotations MVC c#," I have the follwing question about MVC 2 with C#.Here is my Model: Now I want to reach the Tooltext item in my view, e. g.: or in the BL: Is this possible? <code>  public class Pmjob{ [Tooltext=""Hier soll der Name eingegeben werden""] [DisplayName(""Type"")] public int Name { get; set; }} @Html.ToolTextFor(Model => Model.Pmjob.Name) if ( Model.Pmjob.Name.Tooltext == """") {}",Custom Data Annotations ASP.NET MVC C#
Custom Data Annotations MVC c#," I have the follwing question about MVC 2 with C#.Here is my Model: Now I want to reach the Tooltext item in my view, e. g.: or in the BL: Is this possible? <code>  public class Pmjob{ [Tooltext=""Hier soll der Name eingegeben werden""] [DisplayName(""Type"")] public int Name { get; set; }} @Html.ToolTextFor(Model => Model.Pmjob.Name) if ( Model.Pmjob.Name.Tooltext == """") {}",Custom Data Annotations ASP.NET MVC C#
c# - why cant i use 'this.' to access my class constant," In C# .NET, why can't I access constants in a class with the 'this' keyword?Example: <code>  public class MyTest{ public const string HI = ""Hello""; public void TestMethod() { string filler; filler = this.HI; //Won't work. filler = HI //Works. }}",Why can't I use 'this.' in C# to access my class constant?
C# Is it slower to reference an array variable?," I've got an array of integers, and I'm looping through them: If I do: Is there any performance gain/loss?From my understanding, C/C++ array elements are accessed directly, i.e. an n-element array of integers has a contiguous memory block of length n * sizeof(int), and the program access element i by doing something like *data[i] = *data[0] + (i * sizeof(int)). (Please excuse my abuse of notation, but you get what I mean.)So this means C/C++ should have no performance gain/loss for referencing array variables.What about C#?C# has a bunch of extra overhead like data.Length, data.IsSynchronized, data.GetLowerBound(), data.GetEnumerator().Clearly, a C# array is not the same as a C/C++ array.So what's the verdict? Should I store int value = data[i] and work with value, or is there no performance impact? <code>  for (int i = 0; i < data.Length; i++){ // do a lot of stuff here using data[i]} for (int i = 0; i < data.Length; i++){ int value = data[i]; // do a lot of stuff with value instead of data[i]}","In C#, Is it slower to reference an array variable?"
Convert datetime column to datetime2 column in MSSQL ?," I have a SQL Server 2005 database with a datetime column. There is already data in the table but now the customer needs dates before 1753. So I decided to migrate the database to a SQL Server 2008 to use the datetime2 type. However I can't just switch the type of the column from datetime to datetime2. Is there a way to do this conversion or do I have to reimport the data? Thank you,Daniel <code> ",Convert datetime column to datetime2 column in SQL Server ?
Windows Phone 7: How to parse Bezier Path string?," I have a need to parse Bezier Path Strings, but apparently the System.Windows.Media.Geometryversion in the .Net CF framework doesn't have the Parse() method that is available in it's normal counterpart. However, entering the following XAML does work, so there must be a way the system parses the Path Data String.<Path Stroke=""Blue"" Data=""M 0 0 Q 10 10 20 0""/>Any clue on how I can initiate this parsing myself with a custom string outside XAML?I ofcourse could also try to write my own parser using regex or so, but I would prefer not to handle this myself, since the framework clearly is capable of it.UpdateWhen using the suggested XAMLReader, I get a strange Exception when I set a StrokeThickness to the newly created Path: When I change codepath to render using my manual parser, everything works correctly.Am I missing something here? Nothing changes except the parser.Manually Generating Data: Using XamlReader  <code>  path.StrokeThickness = strokeWidth; //ArgumentException ??? (strokeWidth = 6) //""M {0} {1} Q {2} {3} {4} {5}"" String regex_input = @""M (\d+) (\d+) Q (\d+) (\d+) (\d+) (\d+)""; Regex regex = new Regex(regex_input); Match match = regex.Match(pathData); int startx = int.Parse(match.Groups[1].Value); int starty = int.Parse(match.Groups[2].Value); int controlx = int.Parse(match.Groups[3].Value); int controly = int.Parse(match.Groups[4].Value); int endx = int.Parse(match.Groups[5].Value); int endy = int.Parse(match.Groups[6].Value); PathGeometry geo = new PathGeometry(); PathFigure figure = new PathFigure(); figure.StartPoint = new Point(startx, starty); QuadraticBezierSegment quad = new QuadraticBezierSegment(); quad.Point1 = new Point(controlx, controly); quad.Point2 = new Point(endx, endy); figure.Segments.Add(quad); geo.Figures.Add(figure); path.Data = geo; String formattedXAMLInput = String.Format(""<Path xmlns='http://schemas.microsoft.com/winfx/2006/xaml/presentation' Stroke='Black' Data='{0}'/>"", pathData); Path xamlpath = (Path)XamlReader.Load(formattedXAMLInput); Geometry xamldata = xamlpath.Data; path.Data = xamldata;",Windows Phone 7: How to parse Bezier Path string like in XAML?
how to use tasks and continuations," I'm a little confused about how to use Tasks with conditional Continuations.If I have a task, and then I want to continue with a tasks that handle success and error, and then wait on those to complete. Is this the preferred way of doing task success/failure branching? Also, how am I supposed to join all these tasks, suppose I've created a long line of continuations, each having their own error handling. Calling WaitAll on these invariably throws, because some of the continuations will be cancelled due to the TaskContinuationOptions, and calling Wait on a cancelled task throws.How do I join these without getting the ""A task was cancelled"" exception""? <code>  void FunctionThrows() {throw new Exception(""faulted"");}static void MyTest(){ var taskThrows = Task.Factory.StartNew(() => FunctionThrows()); var onSuccess = taskThrows.ContinueWith( prev => Console.WriteLine(""success""), TaskContinuationOptions.OnlyOnRanToCompleted); var onError = taskThrows.ContinueWith( prev => Console.WriteLine(prev.Exception), TaskContinuationOptions.OnlyOnFaulted); //so far, so good //this throws because onSuccess was cancelled before it was started Task.WaitAll(onSuccess, onError);} //for example var task1 = Task.Factory.StartNew(() => ...) var task1Error = task1.ContinueWith( //on faulted var task2 = task1.ContinueWith( //on success var task2Error = task2.ContinueWith( //on faulted var task3 = task2.ContinueWith( //on success //etc",Using Tasks with conditional continuations
How to use tasks and continuations," I'm a little confused about how to use Tasks with conditional Continuations.If I have a task, and then I want to continue with a tasks that handle success and error, and then wait on those to complete. Is this the preferred way of doing task success/failure branching? Also, how am I supposed to join all these tasks, suppose I've created a long line of continuations, each having their own error handling. Calling WaitAll on these invariably throws, because some of the continuations will be cancelled due to the TaskContinuationOptions, and calling Wait on a cancelled task throws.How do I join these without getting the ""A task was cancelled"" exception""? <code>  void FunctionThrows() {throw new Exception(""faulted"");}static void MyTest(){ var taskThrows = Task.Factory.StartNew(() => FunctionThrows()); var onSuccess = taskThrows.ContinueWith( prev => Console.WriteLine(""success""), TaskContinuationOptions.OnlyOnRanToCompleted); var onError = taskThrows.ContinueWith( prev => Console.WriteLine(prev.Exception), TaskContinuationOptions.OnlyOnFaulted); //so far, so good //this throws because onSuccess was cancelled before it was started Task.WaitAll(onSuccess, onError);} //for example var task1 = Task.Factory.StartNew(() => ...) var task1Error = task1.ContinueWith( //on faulted var task2 = task1.ContinueWith( //on success var task2Error = task2.ContinueWith( //on faulted var task3 = task2.ContinueWith( //on success //etc",Using Tasks with conditional continuations
Regex help with extracting certain part of a String," Hey Im trying to extract certain information from a string. The String looks like Name: music mix.mp3 Size: 2356KBI would like to extract the file name only with the extension.I dont have much knowledge in regex, so I was hoping to get some help here. Thanks! <code> ",Regex for extracting certain part of a String
c# httwebrequest with xml file, I'm developing the client-side of a third party webservice. The purpose is that I send xml-file to the server.How should I attach the xml-file to the httpwebrequest? What contentType is needed? More suggestions?I cannot use mtom or dime.ie because I am using httpwebrequest. I am unable to use WCF either. <code> ,C# HttpWebRequest with XML Structured Data
C# Httpwebrequest with XML file, I'm developing the client-side of a third party webservice. The purpose is that I send xml-file to the server.How should I attach the xml-file to the httpwebrequest? What contentType is needed? More suggestions?I cannot use mtom or dime.ie because I am using httpwebrequest. I am unable to use WCF either. <code> ,C# HttpWebRequest with XML Structured Data
What does the .NET/CLR C# String.Length property return? Surrogate neutral length or complete character length.," The documentation and language varies between VS 2008 and 2010:VS 2008 Documentation Internally, the text is stored as a readonly collection of Char objects, each of which represents one Unicode character encoded in UTF-16. ... The length of a string represents the number of characters regardless of whether the characters are formed from Unicode surrogate pairs or not. To access the individual Unicode code points in a string, use the StringInfo object. - http://msdn.microsoft.com/en-us/library/ms228362%28v=vs.90%29.aspxVS 2010 Documentation Internally, the text is stored as a sequential read-only collection of Char objects. ... The Length property of a string represents the number of Char objects it contains, not the number of Unicode characters. To access the individual Unicode code points in a string, use the StringInfo object. - http://msdn.microsoft.com/en-us/library/ms228362%28v=VS.100%29.aspxThe language used in both cases doesn't clearly differentiate between ""character"", ""Unicode character"", ""Char class"", ""Unicode surrogate pair"", and ""Unicode code point"".The language in the VS2008 documentation stating that a ""string represents the number of characters regardless of whether the characters are formed from Unicode surrogate pairs or not"" seems to be defining ""character"" as as object that may be the result of a Unicode surrogate pair, which suggests that it may represent a 4-byte sequence rather than a 2-byte sequence. It also specifically states at the beginning that a ""char"" object is encoded in UTF-16, which suggests that it could represent a surrogate pair (being 4 bytes instead of 2). I'm fairly certain that is wrong though.The VS2010 documentation is a little more precise. It draws a distinction between ""char"" and ""Unicode character"", but not between ""Unicode character"" and ""Unicode code point"". If a code point refers to half a surrogate pair, and a ""Unicode character"" represents a full pair, then the ""Char"" class is named incorrectly, and does not refer to a ""Unicode character"" at all (which they state it does not), and it's really a Unicode code point.So are both of the following statements true? (Yes, I think.)String.Length represents the Unicode code-point length, andString.Length represents neither the Unicode character length nor what we would consider to be a true character length (number of characters that would be displayed), but rather the number of ""Char"" objects, which each represent a Unicode code point (not a Unicode character). <code> ",What does the .NET String.Length property return? Surrogate neutral length or complete character length.
Entity Frame work Code First Date filed creation," I am using Entity Framework Code First method to create my database table. The following code creates a DATETIME column in the database, but I want to create a DATE column. How can I create a column of type DATE, during table creation? <code>  [DataType(DataType.Date)][DisplayFormatAttribute(ApplyFormatInEditMode = true, DataFormatString = ""{0:d}"")]public DateTime ReportDate { get; set; }",Entity Framework Code First Date field creation
C#: How to replace \\ to \," I have this string temp and I want to replace \\ with \ I've tried doing temp.Replace(""\\"", ""\"") however the output is hkI want the output to be \h\kHow to replace ""\\"" with ""\""?Thank you <code>  string temp = ""\\h\\k"";",C#: How to replace \\ with \
WPF: ControlTemplate Storyboard color animation problem," I have a problem with color animation. This is my source: The problem is:Cannot convert the value in attribute 'Style' to object of type 'System.Windows.Style'. Cannot freeze this Storyboard timeline tree for use across threads. Error at object 'System.Windows.Controls.Button' in markup file 'HLSLEditor;component/mainwindow.xaml' Line 223 Position 25.When using fixed colors it worked, but it cannot work with the Foreground color of the parent...How do I do an animation to the foreground or background color?Thanks! <code>  <Window.Resources> <hedit:BrushToColorConverter x:Key=""BrushToColorConverter"" /> <Style x:Key=""MyButtonStyle"" TargetType=""Button""> <Setter Property=""OverridesDefaultStyle"" Value=""True""/> <Setter Property=""Margin"" Value=""5""/> <Setter Property=""Template""> <Setter.Value> <ControlTemplate TargetType=""Button""> <ControlTemplate.Resources> <Storyboard x:Key=""buttonAnimIn""> <!-- Problem line --> <ColorAnimation Storyboard.TargetName=""bntBack"" Storyboard.TargetProperty=""Color"" To=""{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Converter={StaticResource BrushToColorConverter}}"" /> </Storyboard> <Storyboard x:Key=""buttonAnimOut""> <ColorAnimation Storyboard.TargetName=""bntBack"" Storyboard.TargetProperty=""Color"" To=""Blue"" /> </Storyboard> <Storyboard x:Key=""buttonAnimForegroundIn""> <ColorAnimation Storyboard.TargetName=""btnFore"" Storyboard.TargetProperty=""Color"" To=""Blue"" /> </Storyboard> <Storyboard x:Key=""buttonAnimForegroundOut""> <ColorAnimation Storyboard.TargetName=""btnFore"" Storyboard.TargetProperty=""Color"" To=""Red"" /> </Storyboard> </ControlTemplate.Resources> <Border Name=""border"" BorderThickness=""1"" Padding=""4,2"" BorderBrush=""DarkGray"" CornerRadius=""3""> <Border.Background> <SolidColorBrush Color=""Blue"" x:Name=""bntBack"" /> </Border.Background> <ContentControl HorizontalAlignment=""Center"" VerticalAlignment=""Center"" Content=""{TemplateBinding Content}""> <ContentControl.Foreground> <SolidColorBrush Color=""Red"" x:Name=""btnFore"" /> </ContentControl.Foreground> </ContentControl > </Border> <ControlTemplate.Triggers> <EventTrigger RoutedEvent=""Button.MouseEnter""> <BeginStoryboard Storyboard=""{StaticResource buttonAnimIn}"" /> <BeginStoryboard Storyboard=""{StaticResource buttonAnimForegroundIn}"" /> </EventTrigger> <EventTrigger RoutedEvent=""Button.MouseLeave""> <BeginStoryboard Storyboard=""{StaticResource buttonAnimOut}"" /> <BeginStoryboard Storyboard=""{StaticResource buttonAnimForegroundOut}"" /> </EventTrigger> </ControlTemplate.Triggers> </ControlTemplate> </Setter.Value> </Setter> </Style></Window.Resources>",ControlTemplate Storyboard color animation problem
Directory EnumerateFiles vs GetFiles, What is the difference between Directory.EnumerateFiles vs GetFiles?Obviously one returns an array and the other return Enumerable.Anything else? <code> ,What is the difference between Directory.EnumerateFiles vs Directory.GetFiles?
What is the differnce between Directory.EnumerateFiles vs Directory.GetFiles?, What is the difference between Directory.EnumerateFiles vs GetFiles?Obviously one returns an array and the other return Enumerable.Anything else? <code> ,What is the difference between Directory.EnumerateFiles vs Directory.GetFiles?
how to check if item is selected from a ccomboBox in C#," I'm pretty new here.I have a form, and want to check if the user filled it in correctly. In the form there's a combo box; how can I build the ""if"" statement for checking whether the user picked an item from it ?P.S. Sorry for my bad English, it's not my mother tongue. :) <code> ",how to check if item is selected from a comboBox in C#
"Inhert from Form, which has parameters"," I have a Form named ScanFolder, and I need another Form, that needs to be very similar to ScanFolder, so I decided to use form inheritance. But there seems to be some misunderstanding with the constructor.ScanFolder looks like: I tried to inherit Form like this: But I get warning Constructor on type 'mhmm.ScanFolder' not found, and also there is an error on Arch2 Form edit mode, where I see a call stack error.So I tried something like this: But it is still the same.As you can see, I clearly don't have any idea what I'm doing. What I'm trying to achieve is getting Arch2 to look the same as ScanFolder, so I can see it in designer view and also override some methods or event handlers. <code>  public partial class ScanFolder : Form{ public ScanFolder(MainForm parent, bool[] autoModes, GlobalMethods GMethodsClass) { //Doing something with parameters }} public partial class Arch2 : ScanFolder{} public partial class Arch2 : ScanFolder{ public Arch2(MainForm parent, bool[] autoModes, GlobalMethods GMethodsClass) : base(parent, autoModes, GMethodsClass) { }}",Inherit from a 'Form' which has parameters
"Inherit from Form, which has parameters"," I have a Form named ScanFolder, and I need another Form, that needs to be very similar to ScanFolder, so I decided to use form inheritance. But there seems to be some misunderstanding with the constructor.ScanFolder looks like: I tried to inherit Form like this: But I get warning Constructor on type 'mhmm.ScanFolder' not found, and also there is an error on Arch2 Form edit mode, where I see a call stack error.So I tried something like this: But it is still the same.As you can see, I clearly don't have any idea what I'm doing. What I'm trying to achieve is getting Arch2 to look the same as ScanFolder, so I can see it in designer view and also override some methods or event handlers. <code>  public partial class ScanFolder : Form{ public ScanFolder(MainForm parent, bool[] autoModes, GlobalMethods GMethodsClass) { //Doing something with parameters }} public partial class Arch2 : ScanFolder{} public partial class Arch2 : ScanFolder{ public Arch2(MainForm parent, bool[] autoModes, GlobalMethods GMethodsClass) : base(parent, autoModes, GMethodsClass) { }}",Inherit from a 'Form' which has parameters
"SVM - All my training data is getting selected as support Vectors :-(, why?"," I am trying to use SVM for News article classification.I created a table that contains the features (unique words found in the documents) as rows.I created weight vectors mapping with these features. i.e if the article has a word that is part of the feature vector table that location is marked as 1 or else 0.Ex:- Training sample generated... 1 1:1 2:1 3:1 4:1 5:1 6:1 7:1 8:1 9:1 10:1 11:1 12:1 13:1 14:1 15:1 16:1 17:1 18:1 19:1 20:1 21:1 22:1 23:1 24:1 25:1 26:1 27:1 28:1 29:1 30:1As this is the first document all the features are present. I am using 1, 0 as class labels.I am using svm.Net for classification.I gave 300 weight vectors manually classified as training data and the model generated is taking all the vectors as support vectors, which is surely overfitting.My total features (unique words/row count in feature vector DB table) is 7610.What could be the reason?Because of this over fitting my project is now in pretty bad shape. It is classifying every article available as a positive article.In LibSVM binary classification is there any restriction on the class label?I am using 0, 1 instead of -1 and +1. Is that a problem? <code> ","LibSVM turns all my training vectors into support vectors, why?"
Save Image to database with MVC [ create method ]," I am trying to save image to database with Create method. but when try this code, I get this error: The input is not a valid Base-64 string as it contains a non-base 64 character, more than two padding characters, or a non-white space character among the padding characters.*I am very beginner to MVC. I will really appreciate for the response, Many thanks in advance. Here is my create view code: Web.config: Database entry: <code>  [Authorize][HttpPost]public ActionResult Create(Customers saveCustomer){ try { // TODO: Add insert logic here var upload = Request.Files[""ImageData""]; if (upload.ContentLength > 0) { string savedFileName = Path.Combine( ConfigurationManager.AppSettings[""FileUploadDirectory""], ""customers_"" + saveCustomer.FirstName + ""_"" + saveCustomer.LastName + "".jpg""); upload.SaveAs(savedFileName); } _db.Customers.InsertOnSubmit(saveCustomer); _db.SubmitChanges(); return RedirectToAction(""Index""); } catch { return View(); }} <%@ Page Title="""" Language=""C#"" MasterPageFile=""~/Views/Shared/Site.Master"" Inherits=""System.Web.Mvc.ViewPage<Reservation.Models.Customers>"" %> <asp:Content ID=""Content1"" ContentPlaceHolderID=""TitleContent"" runat=""server""> Create</asp:Content><asp:Content ID=""Content2"" ContentPlaceHolderID=""MainContent"" runat=""server""> <h2> Create</h2> <% using (Html.BeginForm(""Create"", ""Customers"", FormMethod.Post, new {enctype=""multipart/form-data""})) {%> <%: Html.ValidationSummary(true) %> <fieldset> <legend>Add new customer record</legend> <div class=""editor-label""> <%: Html.LabelFor(model => model.FirstName) %> </div> <div class=""editor-field""> <%: Html.TextBoxFor(model => model.FirstName) %> <%: Html.ValidationMessageFor(model => model.FirstName) %> </div> <div class=""editor-label""> <%: Html.LabelFor(model => model.LastName) %> </div> <div class=""editor-field""> <%: Html.TextBoxFor(model => model.LastName) %> <%: Html.ValidationMessageFor(model => model.LastName) %> </div> <div class=""editor-label""> <%: Html.LabelFor(model => model.Email) %> </div> <div class=""editor-field""> <%: Html.TextBoxFor(model => model.Email) %> <%: Html.ValidationMessageFor(model => model.Email) %> </div> <div class=""editor-label""> <%: Html.LabelFor(model => model.Phone) %> </div> <div class=""editor-field""> <%: Html.TextBoxFor(model => model.Phone) %> <%: Html.ValidationMessageFor(model => model.Phone) %> </div> <div class=""editor-label""> <%: Html.LabelFor(model => model.CustomerNote) %> </div> <div class=""editor-field""> <%: Html.TextBoxFor(model => model.CustomerNote) %> <%: Html.ValidationMessageFor(model => model.CustomerNote) %> </div> <div> <input type=""file"" id=""ImageData"" name=""ImageData"" /> </div> <p> <input type=""submit"" value=""Add recrod"" /> </p> </fieldset> <% } %> <div> <%: Html.ActionLink(""Back to List"", ""Index"") %> </div></asp:Content> <appSettings> <add key=""FileUploadDirectory"" value=""~/Resources/images/customers/"" /></appSettings> Column Name Data Type Allow NullsImageData image yes ",Save image to database with ASP.NET MVC
Clear performance," I have this 2 examples:1 Example: Series is class from System.Windows.Forms.DataVisualization dll2 Example: Why there is so huge difference between those Clear methods?And how can I clear seria.Point faster ? <code>  Series seria = new Series(""name""); for(int i = 0 ; i < 100000 ; i++) { seria.Points.Add(new DataPoint(i, i)); } seria.Points.Clear(); // - this line executes 7.10 seconds !!!!!!!!!! List<DataPoint> points = new List<DataPoint>(); for (int i = 0; i < 100000; i++) { points.Add(new DataPoint(i, i)); } points.Clear(); // - this line executes 0.0001441 seconds !!!!!!!!!!",DataPointCollection Clear performance
c# using question," If you employ a using clause to dispose of a connection, are other items within the clause that implement IDisposable also automatically disposed? If not, how do you handle making sure all IDisposable items are automatically disposed? <code>  public static DataTable ReturnDataTable( string ConnectionString, string CommandTextString, CommandType CommandType, int CommandTimeout, List<System.Data.SqlClient.SqlParameter> ParameterList = null){ using (System.Data.SqlClient.SqlConnection Connection = new System.Data.SqlClient.SqlConnection()) { Connection.ConnectionString = ConnectionString; System.Data.SqlClient.SqlCommand Command = new System.Data.SqlClient.SqlCommand(); Command.Connection = Connection; Command.CommandText = CommandTextString; Command.CommandType = CommandType; Command.CommandTimeout = CommandTimeout; if (ParameterList != null) { if (ParameterList.Count > 0) { foreach (SqlParameter parameter in ParameterList) { Command.Parameters.AddWithValue( parameter.ParameterName, parameter.Value); } } } System.Data.DataTable DataTable = new System.Data.DataTable(); System.Data.SqlClient.SqlDataAdapter DataAdapter = new System.Data.SqlClient.SqlDataAdapter(); DataAdapter.SelectCommand = Command; DataAdapter.Fill(DataTable); return DataTable; }}",C# 'using' statement question
Connection Strings for Entities," I want to share same Database information across multiple entities in Silverlight.. but I want the connection string to be named xyz and have everyone access that connection string from machine.config... The meta data part of the entities will be different since I didn't name the entities the same..Can I put multiple entities in that metadata section?Here is an example.. I want to use this connection string but note that i put multiple entities in the metadata section..Basically I want to take this Connection String And this Connection String To make this Connection String But it simply doesn't work. Neither project can connect to it. <code>  <add name=""XYZ"" connectionString=""metadata=res://*/ModEntity.csdl|res://*/ModEntity.ssdl|res://*/ModEntity.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=SomeServer;Initial Catalog=SomeCatalog;Persist Security Info=True;User ID=Entity;Password=SomePassword;MultipleActiveResultSets=True&quot;"" providerName=""System.Data.EntityClient"" /> <add name=""XYZ"" connectionString=""metadata=res://*/Entity.csdl|res://*/Entity.ssdl|res://*/Entity.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=SOMESERVER;Initial Catalog=SOMECATALOG;Persist Security Info=True;User ID=Entity;Password=Entity;MultipleActiveResultSets=True&quot;"" providerName=""System.Data.EntityClient"" /> <add name=""XYZ"" connectionString=""metadata=res://*/Entity.csdl|res://*/Entity.ssdl|res://*/Entity.msl|res://*/ModEntity.csdl|res://*/ModEntity.ssdl|res://*/ModEntity.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=SOMESERVER;Initial Catalog=SOMECATALOG;Persist Security Info=True;User ID=Entity;Password=SOMEPASSWORD;MultipleActiveResultSets=True&quot;"" providerName=""System.Data.EntityClient"" /> string encConnection = ConfigurationManager.ConnectionStrings[connectionName].ConnectionString;Type contextType = typeof(test_Entities);object objContext = Activator.CreateInstance(contextType, encConnection);return objContext as test_Entities; ",Connection Strings for Entity Framework
cast datetime to int, I have the following DateTime 4/25/2011 5:12:13 PMand tried this to convert it to int But it still getting 2011425 how can i get the time as well? <code>  int result = dateDate.Year * 10000 + dateDate.Month * 100 + dateDate.Day + dateDate.Hour + dateDate.Minute + dateDate.Second;,How can I convert a DateTime to an int?
persistent dynamic control c# asp.net," Is there a way to create dynamic controls which will persist even after the postback? In other words, when the user clicks on the button, a new textbox will be generated and when clicks again the first one will remain while a second one will be generated. How can I do this using asp.net ? I know that if I can create the controls in the page_init event then they will persist but I dont know if it possible to handle a button click before the page_init occurs, therefore there must be another way. <code>  <asp:Button onclick=""Some_event"" Text=""Add TextBox"" ID=""id1"" runat=""server"" />//once clicked:<asp:TextBox ID=""txt1"" ......></asp:TextBox>//when clicked again:<asp:TextBox ID=""txt1"" ......></asp:TextBox><asp:TextBox ID=""txt2"" ......></asp:TextBox>//and so on...",Persistent dynamic control in ASP.Net
how to write a method with delegate parameter in C# / .NET 4.0," I've been using the way that I declare delegate in class level: However this is really cumbersome and I can't see instantly what the delegate is like. So I would like to do it like this: so that I don't have the separate definition.The above is not allowed for some reason. So how can I do it? <code>  protected delegate void FieldsDelegate();//and then write a method e.g.protected int CreateComponent(DbConnection cnctn, string tableName, Dictionary<string, object> changedFieldValues, FieldsDelegate fieldsDelegate) protected int CreateComponent(DbConnection cnctn, string tableName, Dictionary<string, object> changedFieldValues, delegate void fieldsDelegate())",how to write a method with delegate parameter in C# / .NET 4.0?
HTMLayout in C#," I am new to HTMLayout and just know about the nabu library, and dont know how to create html based forms using nabu library, could anyone provide an example or opensource application that uses HTMLayout in a .Net setup? <code> ",HTML layout in .NET
static objects in a baseclass, In an abstract base class if we have some static fields then what happens to them ?Is their scope the classes which inherit from this base class or just the type from which it is inheriting (each subclass has it's own copy of the static field from the abstract base class)? <code> ,Static fields in a base class and derived classes
NPOI : How To Read File using NPOI," I found NPOI is very good to write Excel files with C#.But I want to open, read and modify Excel files in C#.How can I do this? <code> ",How to read file using NPOI
Url encoding with Double Quots," i need to pass special characters trough the webservice. i used the code HttpUtility.UrlEncode(""french character"")but the encoding is not working correctly if the string contains a double Quotseg: HttpUtility.UrlEncode("""")it encodes fine. but not decodes properly......Thank in advance ...... <code> ",Url encoding with French Character
unit testing c-sharp proprties," I am working with a class that has lots of properties. For example; Now to unit test; I did the xUnit test something like here, I hate how I am hard-coding expected = 3. What's a good way to test this property for accessor and mutator? <code>  public class Bib{ public int PartQty { get; set; }} [Fact] public void CanGetAndSetPartQuantity() { const int expected = 3; var target = new Bib() {PartQty = expected}; Assert.Equal(expected, target.PartQty); }",unit testing c# properties
What is .axd file ?," What kind of purpose do .axd files serve?I know that it is used in the ASP.Net AJAX Toolkit and its controls. I'd like to know more about it.I tried Googling for it, but could not find getting basic information. <code> ",What is an .axd file?
"Does a method name starting with ""Does"" looks good?"," Is it a good practice to start a method name with ""Does"" (in C#)? It looks a little bit weird to me, so I would like to get your opinion. I am writing a method which check if an account exists or not, should the signature be ""bool DoesAccountExist(id)""? Is there a better name?Thanks! <code> ","Does a method name starting with ""Does"" look good?"
c# listen for key press in console app," How can I continue to run my console application until a key press (like Esc is pressed?)I'm assuming its wrapped around a while loop. I don't like ReadKey as it blocks operation and asks for a key, rather than just continue and listen for the key press. How can this be done? <code> ",Listen for key press in .NET console app
Is null checking is required for IEnumberable object?," From the above statement, do i need to check Null for the selectedRows variable? selectedRows is an IEnumerable variable. <code>  var selectedRows = from drow in ugTable.Rows .Cast<Infragistics.Win.UltraWinGrid.UltraGridRow>() .Where(drow => drow != null && drow.Selected) select drow;if(selectedRows.Count()==1){//do something with selected rows}",Is null checking required for IEnumerable object?
Is null checking required for IEnumberable object?," From the above statement, do i need to check Null for the selectedRows variable? selectedRows is an IEnumerable variable. <code>  var selectedRows = from drow in ugTable.Rows .Cast<Infragistics.Win.UltraWinGrid.UltraGridRow>() .Where(drow => drow != null && drow.Selected) select drow;if(selectedRows.Count()==1){//do something with selected rows}",Is null checking required for IEnumerable object?
recursive tree algorithm (extended knights tree?)," Taking into account a 5x5 grid, it requires all possible combinations of knights moves to be recorded, from every single starting square, via every subsequent square.I envisaged it as being a binary tree like structure, but as each square on the board can have more than 2 potential next moves, I don't think it would work. I looked into A*/Pathfinding algorithms, but they all require an end node to work with from what I can see, and I don't know the end node as it is on going every time and would be different.My pseudocode thus far is: Any advice/pointers would be greatly appreciated as I am very lost! <code>  For each square on the board Check if this key has potential moves If Potential moves <Some way of selecting a next move (this could be the square we just originated from too!)> Register this move into a collection we can check against for subsequent moves Recursively call function with the square we just landed on Else ContinueEnd",Recursive tree search
System.Threading.Timer not continous," I am having troubles with creating a continuous timer. There are multipule staggered threads created on timers which will run for some time then come to a complete stop. The maximum threads I am allowing is 5 and the timer interval is set to 10000. So in theory there would be 1 thread executed every 2 seconds. This happens for a while, but then it stops. currently I am testing in a console app and writing the responses to the app.I am not exactly sure what is happening here Any help here is greatly appreciated! Cheers! <code>  internal class EngineThreadGenerator{ private readonly AutoResetEvent _autoEvent; private readonly Action<string, string> _processQueueDelegate; private readonly Action<string, string> _purgeQueueDelegate; private void createAllowedEmailThreads() { for (int counter = 0; counter < AppSettings.ProcessQueueAllowedThreads; counter++) { EmailThread _emailThread = new EmailThread(_collection, _processQueueDelegate, _purgeQueueDelegate); TimerCallback _timerCallback = _emailThread.InitEmailThread; Timer _stateTimer = new Timer(_timerCallback, _autoEvent, 0, AppSettings.ProcessIntervalInMilliseconds); pauseLoop(); } }",System.Threading.Timer not continuous
A Multiline Checkbox in C#, How do I extend the text in a Windows Forms CheckBox to more than one line? <code> ,How is CheckBox with multi-line text done in Windows Forms?
Winforms CheckBox with multi-line text: How is it done?, How do I extend the text in a Windows Forms CheckBox to more than one line? <code> ,How is CheckBox with multi-line text done in Windows Forms?
TypeConverters are stubborn! How can I use one with a ConfigurationSection?," So I've got a ConfigurationSection/ConfigurationElementCollection that has a configuration like this: And here is how I handle the mimeFormats: And obviously I need a TypeConverter that actually does something (instead of this empty shell): How do I set up a TypeConverter that will allow type conversion from/to string? I've tried using the MSDN examples but I keep getting error message: TypeConverter cannot convert from System.String.Essentially, how can it be set up so that it will just work with whatever ConfigurationSection is trying to do? <code>  <mimeFormats> <add mimeFormat=""text/html"" /></mimeFormats> public class MimeFormatElement: ConfigurationElement{ #region Constructors /// <summary> /// Predefines the valid properties and prepares /// the property collection. /// </summary> static MimeFormatElement() { // Predefine properties here _mimeFormat = new ConfigurationProperty( ""mimeFormat"", typeof(MimeFormat), ""*/*"", ConfigurationPropertyOptions.IsRequired ); } private static ConfigurationProperty _mimeFormat; private static ConfigurationPropertyCollection _properties; [ConfigurationProperty(""mimeFormat"", IsRequired = true)] public MimeFormat MimeFormat { get { return (MimeFormat)base[_mimeFormat]; } }}public class MimeFormat{ public string Format { get { return Type + ""/"" + SubType; } } public string Type; public string SubType; public MimeFormat(string mimeFormatStr) { var parts = mimeFormatStr.Split('/'); if (parts.Length != 2) { throw new Exception(""Invalid MimeFormat""); } Type = parts[0]; SubType = parts[1]; }} public class MimeFormatConverter : TypeConverter{ public override bool CanConvertFrom(ITypeDescriptorContext context, Type sourceType) { throw new NotImplementedException(); } public override object ConvertFrom(ITypeDescriptorContext context, CultureInfo culture, object value) { throw new NotImplementedException(); } public override bool CanConvertTo(ITypeDescriptorContext context, Type destinationType) { throw new NotImplementedException(); } public override object ConvertTo(ITypeDescriptorContext context, CultureInfo culture, object value, Type destinationType) { throw new NotImplementedException(); }}",How can I use TypeConverters with a ConfigurationSection?
DirectorySecurity not setting permissions correctly!," I have a C# code which creates a folder and sets some permissions on it. Here is the code sample: When I check the permissions set on the folder created above, instead of having Read and Modify (which is what I have set in the code), it shows only ""Special Permissions"" as checked.Please can some one help me with this? I am new to ACL, so don't understand it very well. <code>  static void Main(string[] args){ Directory.CreateDirectory(""C:\\vk07""); DirectorySecurity dirSec = Directory.GetAccessControl(""C:\\vk07""); dirSec.AddAccessRule(new FileSystemAccessRule(""INTRANET\\fGLBChorusUsers"", FileSystemRights.ReadAndExecute, AccessControlType.Allow)); Directory.SetAccessControl(""C:\\vk07"", dirSec);}",DirectorySecurity not setting permissions correctly
how to get the number field the of List ?," How to get the list index where you can find the closest number? <code>  List<int> list = new List<int> { 2, 5, 7, 10 };int number = 9;int closest = list.Aggregate((x,y) => Math.Abs(x-number) < Math.Abs(y-number) ? x : y);",How to get the list index of the nearest number?
How to get the number field the of List ?," How to get the list index where you can find the closest number? <code>  List<int> list = new List<int> { 2, 5, 7, 10 };int number = 9;int closest = list.Aggregate((x,y) => Math.Abs(x-number) < Math.Abs(y-number) ? x : y);",How to get the list index of the nearest number?
how to get the number field the of List ?," How to get the list index where you can find the closest number? <code>  List<int> list = new List<int> { 2, 5, 7, 10 };int number = 9;int closest = list.Aggregate((x,y) => Math.Abs(x-number) < Math.Abs(y-number) ? x : y);",How to get the list index of the nearest number?
OpenXml some problems," because of small documentation i have problems with OpenXml SpreadSheetDocument in C#.How to make top row with filter?How to make colors to alternate?I want to put unicode characters in my SheetData, but when i oppen the excel it gives me an error..Change the top row color.Can you say if there are some proper ways to do this, some more documentation than these available on msdn, or post some StyleSheet code?Sorry for my english.Thanks. <code> ","OpenXml Spreadsheet. Value filters, styles and unicode characters."
deleting Directory at runtime, I just want to delete the Directory which is in the project folder.That folder having all web sharing authority and permission.The problem is arising when i am deleting the folder.Folder is deleted from the serverpath(Virtual Directory).But my problem is that when i complete my task and click on any control it will redirect me to the Login page with the return url as there is a secure authentication on the root directory is available <code> ,Deleting Directory at runtime
Moq - mock.Raise should raise event in tested unit without having a Setup.," I have a presenter class, that attaches an event of the injected view.Now I would like to test the presenter reacting correctly to the event.This is the view interface IView: This is the view implementing IView: This is the presenter under test: This is the test fixture testing MyPresenter: I am using Moq 4. Is it possible to do what I want? <code>  public interface IView { event EventHandler MyEvent; void UpdateView(string test);} public partial class MyView : IView{ public event EventHandler MyEvent; public MyView() { this.combo.SelectedIndexChanged += this.OnSelectedIndexChanged; } public void UpdateView(string test) { this.textBox.Text = test; } private OnSelectedIndexChanged(Object sender, EventArgs e) { if (this.MyEvent != null) { this.MyEvent(sender, e); } }} public class MyPresenter{ private IView _view; public MyPresenter(IView view) { this._view = view; this._view.MyEvent += this.OnMyEvent; } private void OnMyEvent(Object sender, EventArgs e) { this._view.UpdateView(); }} [TestClass]public class MyPresenterFixture(){ private MyPresenter testee; private Mock<IView> mockView; [TestMethod] public void ShouldReactOnMyEvent() { // arrange this.mockView = new Mock<IView>(MockBehavior.Strict); this.testee = new MyPresenter(this.mockView.Object); // act this.mockView.Raise(mock => mock.MyEvent += null); // this does not fire // assert and verify this.mockView.Verify(mock => mock.UpdateView(It.IsAny<string>()); }}",Moq - mock.Raise should raise event in tested unit without having a Setup
How to add a GridView Column on code-behind? ASP.NET C#," I'm trying to add a column to a GridView, in ASP.NET 2.0 However, i cant find the right option. I'd like equivalents to the following: <code>  gridViewPoco.Columns.Add(...) <asp:BoundField><asp:TemplateField>",How to add a GridView Column on code-behind?
C# detect windows errors/popups," My app doesn't cover all the exception scenarios. During run time, sometimes a window pops up which shows the error for ex: ""System Null reference exception"" or ""The file or directory is corrupted and unreadable"". Once the error window comes up, it doesn't go away until the user responds with the buttons.I want to capture these exception and don't want to show these error windows to the users. <code> ",detect windows errors/popups
How does lock work exactly? C#," I see that for using objects which are not thread safe we wrap the code with a lock like this: So, what happens when multiple threads access the same code (let's assume that it is running in a ASP.NET web application). Are they queued? If so how long will they wait?What is the performance impact because of using locks? <code>  private static readonly Object obj = new Object();lock (obj){ // thread unsafe code}",What does a lock statement do under the hood?
How does lock work exactly?," I see that for using objects which are not thread safe we wrap the code with a lock like this: So, what happens when multiple threads access the same code (let's assume that it is running in a ASP.NET web application). Are they queued? If so how long will they wait?What is the performance impact because of using locks? <code>  private static readonly Object obj = new Object();lock (obj){ // thread unsafe code}",What does a lock statement do under the hood?
Is embeded CSS code in C# code bad?," I see this type of code when looking through our working code base: or Disclaimer: I have not worked with CSS before. but I heard that we should separate css, js, html, C#, other than put them together.so, is the above code bad? If yes, how is the better approach? <code>  private Button AddClearButton() { return new Button { OnClientClick = string.Format(@""$('.{0}').css('background-color', '#FBFBFB'); $('#' + {1}).val(''); $('#' + {2}).val(''); return false;"", _className, _hiddenImageNameClientId, _hiddenPathClientId), Text = LanguageManager.Instance.Translate(""/button/clear"") }; } _nameAndImageDiv = new HtmlGenericControl(""div""); var imageDiv = new HtmlGenericControl(""div""); imageDiv.Attributes.Add(""style"", ""width: 70px; height: 50px; text-align: center; padding-top: 5px; ""); var nameDiv = new HtmlGenericControl(""div""); nameDiv.Attributes.Add(""style"", ""width: 70px; word-wrap: break-word; text-align: center;""); var image = new HostingThumbnailImage();",Is embedding CSS/jQuery code in C# code bad?
Is embeding CSS/jQuery code in C# code bad?," I see this type of code when looking through our working code base: or Disclaimer: I have not worked with CSS before. but I heard that we should separate css, js, html, C#, other than put them together.so, is the above code bad? If yes, how is the better approach? <code>  private Button AddClearButton() { return new Button { OnClientClick = string.Format(@""$('.{0}').css('background-color', '#FBFBFB'); $('#' + {1}).val(''); $('#' + {2}).val(''); return false;"", _className, _hiddenImageNameClientId, _hiddenPathClientId), Text = LanguageManager.Instance.Translate(""/button/clear"") }; } _nameAndImageDiv = new HtmlGenericControl(""div""); var imageDiv = new HtmlGenericControl(""div""); imageDiv.Attributes.Add(""style"", ""width: 70px; height: 50px; text-align: center; padding-top: 5px; ""); var nameDiv = new HtmlGenericControl(""div""); nameDiv.Attributes.Add(""style"", ""width: 70px; word-wrap: break-word; text-align: center;""); var image = new HostingThumbnailImage();",Is embedding CSS/jQuery code in C# code bad?
why my wpf application horribly slow to start after the machine is rebooted?," Does anyone know why it is so horribly slow to start a .net application after the machine is rebooted(i.e cold start) ? After researching in google I found some clues for speeding it up i.e. Merging assembliesSetting resource languageNGENGAC installation, etc.Is that all enough to make my .net application faster or anything else is there I am missing ? <code> ",why my .net application horribly slow to start after the machine is rebooted?
Why huge performance hit 2048x2048 array versus 2047x2047?," I am making some matrix multiplication benchmarking, as previously mentioned in Why is MATLAB so fast in matrix multiplication?Now I've got another issue, when multiplying two 2048x2048 matrices, there is a big difference between C# and others. When I try multiply only 2047x2047 matrices, it seems normal. Added some others for comparsion too.1024x1024 - 10 seconds.1027x1027 - 10 seconds.2047x2047 - 90 seconds.2048x2048 - 300 seconds.2049x2049 - 91 seconds. (update)2500x2500 - 166 secondsThat is three and a half minute difference for the 2k by 2k case.using 2dim arrays <code>  //Array init like thisint rozmer = 2048;float[,] matice = new float[rozmer, rozmer];//Main multiply codefor(int j = 0; j < rozmer; j++){ for (int k = 0; k < rozmer; k++) { float temp = 0; for (int m = 0; m < rozmer; m++) { temp = temp + matice1[j,m] * matice2[m,k]; } matice3[j, k] = temp; } }",Why is there huge performance hit in 2048x2048 versus 2047x2047 array multiplication?
How to know programatically whether Message Queueing is enabled on the machine or not?," I know that when I try to create new MessageQueue, system throws InvalidOperationException if the Message Queuing is not enabled. But how to know programmatically whether Message Queueing is enabled on the machine or not?I am using C# 2.0 & C# 4.0 in two different code bases. <code> ",How to know programmatically whether Message Queueing is enabled on the machine or not?
"algorithms for brackets (NCAA, etc.)"," I'm trying implement a bracket in my program (using C#/.NET MVC) and I am stuck trying to figure out some algorithm.For example, I have a bracket like this with 8 entries (A,B,C,D,E,F,G,H)I'm trying to figure out if there's an algorithmic way todepending on # of entries, find # ofgames per rounddepending on # of entries, for aspecific game #, what is thecorresponding game # in the nextround?For example, in this case, for 8 entries, the example are:for round 1, there are 4 games. Round 2, 2 games. Round 3, 1 gamegame 2 in round 1 corresponds to game 5 in round 2.I also thought about storing this info in a table, but it seems overkill since it never changes, but here it is anyway:Any help will be greatly appreciated!Cheers,Dean <code> ","algorithms for tournament brackets (NCAA, etc.)"
Memory optimized OrderBy and Take," I have 9 GB of data, and I want only 10 rows. When I do: I get an OutOfMemoryException. I would like to use an OrderByAndTake method, optimized for lower memory consumption. It's easy to write, but I guess someone already did. Where can I find it.Edit: It's Linq-to-objects. The data comes from a file. Each row can be discarded if its value for Column1 is smaller than the current list of 10 biggest values. <code>  data.OrderBy(datum => datum.Column1) .Take(10) .ToArray();",Memory optimized OrderBy and Take?
C# error - Incorrect syntax near the keyword 'User'.:," I am using SQL to insert data to SQL Database file using C# as follows. I am getting the following error when command is executing. Incorrect syntax near the keyword 'User'.: INSERT INTO User (login, password, status) VALUES (@login, @password, @status)How can I solve this please?edit:missed parameter values added.. <code>  String cs = System.Configuration.ConfigurationManager.ConnectionStrings[""connection1""].ConnectionString; SqlConnection conn = new SqlConnection(cs); String sql = ""INSERT INTO User (login, password, status) "" + ""VALUES (@login, @password, @status)""; SqlCommand comm = new SqlCommand(sql, conn); comm.Parameters.Add(""@login"", System.Data.SqlDbType.VarChar); comm.Parameters.Add(""@password"", System.Data.SqlDbType.VarChar); comm.Parameters.Add(""@status"", System.Data.SqlDbType.Bit); try { conn.Open(); Console.WriteLine(conn.ToString()); comm.ExecuteNonQuery(); conn.Close(); return true; } catch (Exception ex) { throw (ex); } finally { conn.Close(); } comm.Parameters[""@login""].Value = this.Username; comm.Parameters[""@password""].Value = this._password; comm.Parameters[""@status""].Value = this.Status;",SQL error: Incorrect syntax near the keyword 'User'
SQL error - Incorrect syntax near the keyword 'User'.:," I am using SQL to insert data to SQL Database file using C# as follows. I am getting the following error when command is executing. Incorrect syntax near the keyword 'User'.: INSERT INTO User (login, password, status) VALUES (@login, @password, @status)How can I solve this please?edit:missed parameter values added.. <code>  String cs = System.Configuration.ConfigurationManager.ConnectionStrings[""connection1""].ConnectionString; SqlConnection conn = new SqlConnection(cs); String sql = ""INSERT INTO User (login, password, status) "" + ""VALUES (@login, @password, @status)""; SqlCommand comm = new SqlCommand(sql, conn); comm.Parameters.Add(""@login"", System.Data.SqlDbType.VarChar); comm.Parameters.Add(""@password"", System.Data.SqlDbType.VarChar); comm.Parameters.Add(""@status"", System.Data.SqlDbType.Bit); try { conn.Open(); Console.WriteLine(conn.ToString()); comm.ExecuteNonQuery(); conn.Close(); return true; } catch (Exception ex) { throw (ex); } finally { conn.Close(); } comm.Parameters[""@login""].Value = this.Username; comm.Parameters[""@password""].Value = this._password; comm.Parameters[""@status""].Value = this.Status;",SQL error: Incorrect syntax near the keyword 'User'
C# Memmory optimization for large arrays," Here are two code parts in c++ and c# doing absolutely the same thing:C++http://ideone.com/UfL5R time: 0.01s memmory: 2576 kBC#http://ideone.com/baXYm time: 0.05s mem: 38288 kBHow can I improve the C# code to prove that C# can be as fast as C++ to my colleague?As you can see the C# execution time is 5 time larger, and the memory consumption is 15 times larger. <code>  #include <stdio.h>int main(int argc, char *argv[]) { char p[1000000]; unsigned int i,j; unsigned long long s=0; for(i=2;i<1000000;i++) p[i]=1; for(i=2;i<500000;) { for(j=2*i;j<1000000;j+=i) p[j]=0; for(i++;!p[i];i++); } for(i=3,s=2;i<1000000;i+=2) if(p[i]) s+=i; printf (""%lld\n"",s); return 0;} using System;namespace ConsoleApplication4{ internal class Program { private static void Main(string[] args) { var p = new byte[1000000]; ulong i, j; double s = 0; for(i=2;i<1000000;i++) p[i]=1; for(i=2;i<500000;) { for(j=2*i;j<1000000;j+=i) p[j]=0; for(i++;p[i]==0;i++); } for(i=3,s=2;i<1000000;i+=2) if(p[i]!=0) s+=i; Console.WriteLine(s); } }}",C# Memory optimization for large arrays
marshalling wchar_t* from c++ to c# as out parameter or return value.," I have tried to do this in many ways, but none is working. Does anyone have a correct example for this? I just want to move the wchar_t* value from a function to the C# level. <code> ",How do I marshal wchar_t* from C++ to C# as an out parameter or return value?
marshalling wchar_t* from c++ to c# as out parameter or return value," I have tried to do this in many ways, but none is working. Does anyone have a correct example for this? I just want to move the wchar_t* value from a function to the C# level. <code> ",How do I marshal wchar_t* from C++ to C# as an out parameter or return value?
What's better to use: datagrid or listview(details view) for displaying >50000 rows table ?, I want to display >50000 rows in a table. Which is the best control to use: a DataGrid or a ListView (in details view)? Which of these controls will have the better performance? <code> ,What's better to use: a DataGrid or ListView for displaying large amounts of data?
Switch statement inside a swithc statement (C#)?," I have to evaluate many conditions. In my case, I have to do something like this: Is it good practice to have another switch in case 5? If not, what's better? Having if statements there? <code>  switch(id){ case 5: // switch some other cases here case 6: // set some value ... }",Switch statement inside a switch statement?
Switch statement inside a switch statement (C#)?," I have to evaluate many conditions. In my case, I have to do something like this: Is it good practice to have another switch in case 5? If not, what's better? Having if statements there? <code>  switch(id){ case 5: // switch some other cases here case 6: // set some value ... }",Switch statement inside a switch statement?
GUID COMB strategy in EF4.1 (CodeFirst)," Is there any way to implement the Guid COMB identity strategy for objects in the new Entity Framework 4.1 using the CodeFirst design? I thought setting the StoreGeneratedPattern would work, but it still gives me normal GUIDs.  <code> ",GUID COMB strategy in EF
MS Visual Studio: How to exclude certain Project Folders from publishing ?, I have certain folders which I want to keep in the project but not to include it in publishing. Is that possible? <code> ,MS Visual Studio: How to exclude certain Project Folders from publishing?
How to save an object for latter retriving it.," I have a list of objects and I need to save that somewhere in my computer. I have read some forums and I know that the object has to be Serializable. But it would be nice if I can get an example. For example if I have the following: But how can I store object1 somewhere in my computer and later retrieve? <code>  [Serializable]public class SomeClass{ public string someProperty { get; set; }}SomeClass object1 = new SomeClass { someProperty = ""someString"" };",How to save/restore serializable object to/from file?
How to save an object to later retrieve," I have a list of objects and I need to save that somewhere in my computer. I have read some forums and I know that the object has to be Serializable. But it would be nice if I can get an example. For example if I have the following: But how can I store object1 somewhere in my computer and later retrieve? <code>  [Serializable]public class SomeClass{ public string someProperty { get; set; }}SomeClass object1 = new SomeClass { someProperty = ""someString"" };",How to save/restore serializable object to/from file?
is inaccessible due to its prtection level," I can't figure this out. The problem is that the distance, club, cleanclub, hole, scores and par all say inaccessible due to protection level and I don't know why because I thought I did everything right. this is the derived class: This is the interface: here is the main code: <code>  namespace homeworkchap8{ public class Clubs { protected string club; protected string distance; protected string cleanclub; protected string scores; protected string par; protected string hole; public string myclub { get { return club; } set {club = value; } } public string mydistance { get { return distance; } set { distance = value; } } public string mycleanclub { get { return cleanclub; } set { cleanclub = value; } } public string myscore { get { return scores; } set { scores = value; } } public string parhole { get { return par; } set { par = value; } } public string myhole { get { return hole; } set { hole = value;} } } } namespace homeworkchap8{ public class SteelClubs : Clubs, ISwingClub { public void SwingClub() { Console.WriteLine(""You hit a "" + myclub + "" "" + mydistance); } public void clean() { if (mycleanclub != ""yes"") { Console.WriteLine(""your club is dirty""); } else { Console.WriteLine(""your club is clean""); } } public void score() { Console.WriteLine(""you are on hole "" + myhole + "" and you scored a "" + myscore + "" on a par "" + parhole); } }} namespace homeworkchap8{ public interface ISwingClub { void SwingClub(); void clean(); void score(); } } namespace homeworkchap8{ class main { static void Main(string[] args) { SteelClubs myClub = new SteelClubs(); Console.WriteLine(""How far to the hole?""); myClub.distance = Console.ReadLine(); Console.WriteLine(""what club are you going to hit?""); myClub.club = Console.ReadLine(); myClub.SwingClub(); SteelClubs mycleanclub = new SteelClubs(); Console.WriteLine(""\nDid you clean your club after?""); mycleanclub.cleanclub = Console.ReadLine(); mycleanclub.clean(); SteelClubs myScoreonHole = new SteelClubs(); Console.WriteLine(""\nWhat hole are you on?""); myScoreonHole.hole = Console.ReadLine(); Console.WriteLine(""What did you score on the hole?""); myScoreonHole.scores = Console.ReadLine(); Console.WriteLine(""What is the par of the hole?""); myScoreonHole.par = Console.ReadLine(); myScoreonHole.score(); Console.ReadKey(); } }}",is inaccessible due to its protection level
.NET: Faster way to communicate using TcpClient?," I'm writing a client/server application in C#, and it's going great. For now, everything works and it's all pretty robust. My problem is that I run into some delays when sending packets across the connection.On the client side I'm doing this: (Left out some exception catching etc.) The server does the opposite, i.e. it blocks on NetworkStream.Read() until it has a whole request, then processes it and sends a response using Write().The raw speed of Write()/Read() isn't a problem (i.e. sending large packets is fast), but sending several small packets, one after another, without closing the connection, can be terribly slow (delays of 50-100 ms). What's strange is that these delays show up on LAN connections with typical ping times <1 ms, but they do not occur if the server is running on localhost, even though the ping time would effectively be the same (at least the difference should not be on the order of 100 ms). That would make sense to me if I were reopening the connection on every packet, causing lots of handshaking, but I'm not. It's just as if the server going into a wait state throws it out of sync with the client, and then it stumbles a bit as it reestablishes what is essentially a lost connection.So, am I doing it wrong? Is there a way to keep the connection between TcpServer and TcpClient synchronised so the server is always ready to receive data? (And vice versa: sometimes processing the request from the client takes a few ms, and then the client doesn't seem to be ready to receive the response from the server until it's had a few moments to wake up after blocking on Read().) <code>  NetworkStream ns = tcpClient.GetStream();// Send packetbyte[] sizePacket = BitConverter.GetBytes(request.Length);byte[] requestWithHeader = new byte[sizePacket.Length + request.Length];sizePacket.CopyTo(requestWithHeader, 0);request.CopyTo(requestWithHeader, sizePacket.Length);ns.Write(requestWithHeader, 0, requestWithHeader.Length);// Receive responsens.Read(sizePacket, 0, sizePacket.Length);int responseLength = BitConverter.ToInt32(sizePacket, 0);byte[] response = new byte[responseLength];int bytesReceived = 0;while (bytesReceived < responseLength){ int bytesRead = ns.Read(response, bytesReceived, responseLength - bytesReceived); bytesReceived += bytesRead;}",Faster way to communicate using TcpClient?
Which WCF exceptions should I retry and how would I approach it within this Using Statement," I'm attempting to extend this answer on SO to make a WCF client retry on transient network failures and handle other situations that require a retry such as authentication expiration.Question:What are the WCF exceptions that need to be handled, and what is the correct way to handle them? Here are a few sample techniques that I'm hoping to see instead of or in addition to proxy.abort():Delay X seconds prior to retryClose and recreate a New() WCF client. Dispose the old one.Don't retry and rethrow this errorRetry N times, then throwSince it's unlikely one person knows all the exceptions or ways to resolve them, do share what you know. I'll aggregate the answers and approaches in the code sample below. <code>  // USAGE SAMPLE //int newOrderId = 0; // need a value for definite assignment //Service<IOrderService>.Use(orderService=> //{ // newOrderId = orderService.PlaceOrder(request); //} /// <summary> /// A safe WCF Proxy suitable when sessionmode=false /// </summary> /// <param name=""codeBlock""></param> public static void Use(UseServiceDelegateVoid<T> codeBlock) { IClientChannel proxy = (IClientChannel)_channelFactory.CreateChannel(); bool success = false; try { codeBlock((T)proxy); proxy.Close(); success = true; } catch (CommunicationObjectAbortedException e) { // Object should be discarded if this is reached. // Debugging discovered the following exception here: // ""Connection can not be established because it has been aborted"" throw e; } catch (CommunicationObjectFaultedException e) { throw e; } catch (MessageSecurityException e) { throw e; } catch (ChannelTerminatedException) { proxy.Abort(); // Possibly retry? } catch (ServerTooBusyException) { proxy.Abort(); // Possibly retry? } catch (EndpointNotFoundException) { proxy.Abort(); // Possibly retry? } catch (FaultException) { proxy.Abort(); } catch (CommunicationException) { proxy.Abort(); } catch (TimeoutException) { // Sample error found during debug: // The message could not be transferred within the allotted timeout of // 00:01:00. There was no space available in the reliable channel's // transfer window. The time allotted to this operation may have been a // portion of a longer timeout. proxy.Abort(); } catch (ObjectDisposedException ) { //todo: handle this duplex callback exception. Occurs when client disappears. // Source: https://stackoverflow.com/questions/1427926/detecting-client-death-in-wcf-duplex-contracts/1428238#1428238 } finally { if (!success) { proxy.Abort(); } } }",How to handle WCF exceptions (consolidated list with code)
Aggregation of WCF exception handling approaches," I'm attempting to extend this answer on SO to make a WCF client retry on transient network failures and handle other situations that require a retry such as authentication expiration.Question:What are the WCF exceptions that need to be handled, and what is the correct way to handle them? Here are a few sample techniques that I'm hoping to see instead of or in addition to proxy.abort():Delay X seconds prior to retryClose and recreate a New() WCF client. Dispose the old one.Don't retry and rethrow this errorRetry N times, then throwSince it's unlikely one person knows all the exceptions or ways to resolve them, do share what you know. I'll aggregate the answers and approaches in the code sample below. <code>  // USAGE SAMPLE //int newOrderId = 0; // need a value for definite assignment //Service<IOrderService>.Use(orderService=> //{ // newOrderId = orderService.PlaceOrder(request); //} /// <summary> /// A safe WCF Proxy suitable when sessionmode=false /// </summary> /// <param name=""codeBlock""></param> public static void Use(UseServiceDelegateVoid<T> codeBlock) { IClientChannel proxy = (IClientChannel)_channelFactory.CreateChannel(); bool success = false; try { codeBlock((T)proxy); proxy.Close(); success = true; } catch (CommunicationObjectAbortedException e) { // Object should be discarded if this is reached. // Debugging discovered the following exception here: // ""Connection can not be established because it has been aborted"" throw e; } catch (CommunicationObjectFaultedException e) { throw e; } catch (MessageSecurityException e) { throw e; } catch (ChannelTerminatedException) { proxy.Abort(); // Possibly retry? } catch (ServerTooBusyException) { proxy.Abort(); // Possibly retry? } catch (EndpointNotFoundException) { proxy.Abort(); // Possibly retry? } catch (FaultException) { proxy.Abort(); } catch (CommunicationException) { proxy.Abort(); } catch (TimeoutException) { // Sample error found during debug: // The message could not be transferred within the allotted timeout of // 00:01:00. There was no space available in the reliable channel's // transfer window. The time allotted to this operation may have been a // portion of a longer timeout. proxy.Abort(); } catch (ObjectDisposedException ) { //todo: handle this duplex callback exception. Occurs when client disappears. // Source: https://stackoverflow.com/questions/1427926/detecting-client-death-in-wcf-duplex-contracts/1428238#1428238 } finally { if (!success) { proxy.Abort(); } } }",How to handle WCF exceptions (consolidated list with code)
Php Decrypt a String from C# .NET RIJNDAEL 256," Fixed it. for whatever reason, Php was converting the +'s from the GET variablesinto spaces--I am trying to decrypt a string that is being decrypted in C#.NET.The results of the code vary, There were several occasions where the final string had some parts decrypted, and the rest of it was random characters.Most of the time the ""decrypted"" string is just all random characters, I also tried some Php functions to remove PKCS7 padding but none of them fixed the problem.I've looked at several similar questions on the site but none of them were of help.C# Php: Php output:IV: WzsMlG39tfCGuX2EQM3vq8CoqGA xC0nW jICls8Cno=key: b0dJN2c6cklVUX1qUGlFfGMweXRKbH5fSEMuXjAgfQo= Encrypted String: oLxa21fxfQGg0EJ5rwMjEzMblvcaTq0AInDAsD88wAkNeLqOdon0ukLjz49Hpp36KPTKcTGkj1f7EPYPAAbuADnr3Ff0zpptZkx2d22VRbHrMgj QLF9vDxQRT3er3UAXsAfKKTyW8qeSIgrzACFLX3yoro/bzWic rt7ED7y0jZ7a1Hci3GMz/4KhwaftarbV QQWStJlSOqdxAdmtRRe84Vi3085S6um51bNrh5QzGRH PcpucfqaTb3junfO9g67j2JUQaM/Tj1EGnv6oX3wATR/LuWyhnhrCH86u10I=key size: 32block size: 32cipher: Rijndael-256iv size: 32Result:/ci^/cgsc(Original String (JSON):{""user"":""jsmith"",""firstName"":""John"",""lastName"":""Smith"",""phone"":""12223334444.5555"",""email"":""john.smith@domain.com"",""address"":""123 Some Street"",""address2"":""apt 456"",""city"":""Some City"",""state"":""LA"",""zip"":""55555""} <code>  $data = base64_decode(str_replace(' ', '+', $_GET['data'])); // called as Response.Redirect(url + encryptParams(param));private string encryptData(string data){ Rijndael aes = Rijndael.Create(); aes.KeySize = 256; aes.BlockSize = 256; aes.Mode = CipherMode.CBC; aes.Padding = PaddingMode.PKCS7; aes.Key = Convert.FromBase64String(""b0dJN2c6cklVUX1qUGlFfGMweXRKbH5fSEMuXjAgfQo=""); ICryptoTransform crypto = aes.CreateEncryptor(aes.Key, aes.IV); byte[] txt = ASCIIEncoding.UTF8.GetBytes(data); byte[] cipherText = crypto.TransformFinalBlock(txt, 0, txt.Length); return ""&data="" + Convert.ToBase64String(cipherText) + ""&iv="" + Convert.ToBase64String(aes.IV);} $data = base64_decode($_GET['data']); $iv = base64_decode($_GET['iv']); echo ""<br /><b>IV</b>: "" . $_GET['iv'] . ""<br /><b>Encrypted String</b>: <br /><textarea>"".$_GET['data'].""</textarea>"" . ""<br /><b>key size:</b> "" . mcrypt_get_key_size ( MCRYPT_RIJNDAEL_256, MCRYPT_MODE_CBC) . ""<br /><b>block size:</b> "" . mcrypt_get_block_size ( MCRYPT_RIJNDAEL_256, MCRYPT_MODE_CBC) . ""<br /><b>cipher:</b> "" . mcrypt_get_cipher_name ( MCRYPT_RIJNDAEL_256 ) . ""<br /><b>iv size:</b> "" . mcrypt_get_iv_size ( MCRYPT_RIJNDAEL_256, MCRYPT_MODE_CBC) . ""<br />""; echo ""Result: "" . mcrypt_decrypt ( MCRYPT_RIJNDAEL_256, base64_decode(""b0dJN2c6cklVUX1qUGlFfGMweXRKbH5fSEMuXjAgfQo=""), $data, MCRYPT_MODE_CBC, $iv );",Php Decrypt a String from C# .NET RIJNDAEL 256 [solved]
Disable Serialization in Specific Property," I have a class object for XML serialization the serialization The problem is, it's also serializing the Subscriber property. I only want the RequestXML and MetaXML to be serialized into XML. How can I exclude the Subscriber property in the serialization process? <code>  [XmlType(""PAYMENT"")]public class PaymentXML{ [XmlElement(ElementName = ""REQUEST"")] public RequestXML Request { get; set; } [XmlElement(ElementName = ""META"")] public MetaXML Request { get; set; } //Property that I dont want to be serialized public Subscriber Subscriber { get; set; }} var xml = new PaymentXML();string path = HttpContext.Current.Server.MapPath(@_xmlResponseDir + _responsePath);using (var sw = new StreamWriter(path)){ var ns = new XmlSerializerNamespaces(); ns.Add("""", """"); var serializer = new XmlSerializer(typeof(PaymentXML), new XmlRootAttribute(""XML"")); serializer.Serialize(sw, xml, ns);}",Disable Serialization for Specific Property
C# - Adding DataGridView columns programmatically," I have a DataGridView filled with productinformation. The datagridview has totally 50 columns but the users don't always need all the columns, I want to help them to be able to choose which columns to show and which ones not to show. One solution that I would like to programm is that when the user right clicks on the columns they can choose from a list that pops up choose which columns to show and which ones not to shos. Just like the image below.How can I do that. I would really appreciate any help. <code> ",Adding DataGridView columns programmatically
C# - Adding DataGridView programmatically," I have a DataGridView filled with productinformation. The datagridview has totally 50 columns but the users don't always need all the columns, I want to help them to be able to choose which columns to show and which ones not to show. One solution that I would like to programm is that when the user right clicks on the columns they can choose from a list that pops up choose which columns to show and which ones not to shos. Just like the image below.How can I do that. I would really appreciate any help. <code> ",Adding DataGridView columns programmatically
C# - Adding DataGridView columns programmatically," I have a DataGridView filled with productinformation. The datagridview has totally 50 columns but the users don't always need all the columns, I want to help them to be able to choose which columns to show and which ones not to show. One solution that I would like to programm is that when the user right clicks on the columns they can choose from a list that pops up choose which columns to show and which ones not to shos. Just like the image below.How can I do that. I would really appreciate any help. <code> ",Adding DataGridView columns programmatically
C#: Sharing objects between a BackgroundWorker and main thread," I have a ListBox object in my main thread (WPF application). Why am I not able to access it in BackgroundWorker thread. As far as I know, the stack is separate for each thread, but the heap is common. Isn't ListBox object created in heap. In that case why is it not accessible. I tried passing the ListBox reference as parameter and tried to access its contents in the BackgroundWorker. Is the concept of sharing objects between threads different from C++? <code> ", Sharing objects between a BackgroundWorker and main thread
Html Agility Pack - Problem selecting subnoce," I want to export my Asics running plan to iCal and since Asics do not offer this service, I decided to build a little scraper for my own personal use. What I want to do is to take all the scheduled runs from my plan and generate an iCal feed based on that. I am using C# and Html Agility Pack.What I want to do is iterate through all my scheduled runs (they are div nodes). Then next I want to select a few different nodes with my run nodes. My code looks like this: My problem is that run.SelectSingleNode(""//div[@class='date']"").InnerText does not select the node with the given XPath within the given run node. It selects the first node that matches the XPath in the entire document.How can I select the single node with the given XPath within the current node?Thank you.UpdateI tried updating my XPath string to this: This should select the <div class=""date""></div> element within the current node, right? Well, I tried this but got this error: Expression must evaluate to a node-set. Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. Exception Details: System.Xml.XPath.XPathException: Expression must evaluate to a node-set.Any suggestions? <code>  foreach (var run in doc.DocumentNode.SelectSingleNode(""//div[@id='scheduleTable']"").SelectNodes(""//div[@class='pTdBox']"")){ number++; string date = run.SelectSingleNode(""//div[@class='date']"").InnerText; string type = run.SelectSingleNode(""//span[@class='menu']"").InnerHtml; string distance = run.SelectSingleNode(""//span[@class='distance']"").InnerHtml; string description = run.SelectSingleNode(""//div[@class='description']"").InnerHtml; ViewData[""result""] += ""Dato: "" + date + ""<br />""; ViewData[""result""] += ""Tyep: "" + type + ""<br />""; ViewData[""result""] += ""Distance: "" + distance + ""<br />""; ViewData[""result""] += ""Description: "" + description + ""<br />""; ViewData[""result""] += run.InnerHtml.Replace(""<"", ""&lt;"").Replace("">"", ""&gt;"") + ""<br />"" + ""<br />"" + ""<br />"";} string date = run.SelectSingleNode("".div[@class='date']"").InnerText;",Html Agility Pack - Problem selecting subnode
How can i create dynamic button click event on dynamic button (C sharp ASP.NET)?, I am creating one button on a page dynamically. Now I want to use the button click event on that button.How can I do this in C# ASP.NET? <code> ,How can I create a dynamic button click event on a dynamic button?
How can i create dynamic button click event on dynamic button, I am creating one button on a page dynamically. Now I want to use the button click event on that button.How can I do this in C# ASP.NET? <code> ,How can I create a dynamic button click event on a dynamic button?
How can i create dynamic button click event on dynamic button?, I am creating one button on a page dynamically. Now I want to use the button click event on that button.How can I do this in C# ASP.NET? <code> ,How can I create a dynamic button click event on a dynamic button?
"How to determine if compilation debug=""true"" n web.config"," I am drawing a blank here for something that should be simple...I am trying to do something like: <code>  <my:control runat=""server"" id=""myid"" Visible=""<%= (is compilation debug mode?) %>"" />","How to determine if compilation debug=""true"" in web.config"
What would be an alternate to [SetUp] and [TearDown] in MSTest?," When I use MSTest Framework, and copy the code that Selenium IDE generated for me, MSTest doesn't recognize [TearDown] and [SetUp]. What is the alternative to this? <code> ",What would be an alternate to [TearDown] and [SetUp] in MSTest?
Func<T> delegate real world uses," I've recently been playing around with the delegate Func<T, TResult> and creating methods that return different instances Func<T, TResult> containing lambda but what I have struggled to come up with is any good real world ideas of why one might want to return (or even create such an instance). There is an example on MSDN where they do the following... And although it looks pretty and is an interesting concept I fail to see what advantages such code provides.So could someone here please provide any real world examples where they have had to use Func<T, TResult> and in general why one might want to use this delegate? <code>  Func<string, string> convertMethod = UppercaseString;private static string UppercaseString(string inputString){ return inputString.ToUpper();}","Func<T, TResult> delegate real world uses"
Is it Possible to Create New Classes on RunTime C#," Hi is it possible to Create New Classes in C# ,classes which the Application Read's from XML and Declare they're Attributes also reading from XML .like : bests. <code>  <item id=1> <Name>John</Name> <Surname>Kennedy</Surname> <Age>24</Age></item>",Is it Possible to Create New Classes at RunTime C#
How to correctly convert System.Nullable<Double> gotten from LinqToSql to Double?, I've got a table with some nullable double fields. Working with LinqToSQL trying to use the field directly I get Argument type System.Nullable is not assignable to parameter type doubleHow do I deal with this correctly? <code> ,How to correctly deal with System.Nullable<T> fields of LinqToSql classes?
How to correctly deal with System.Nullable<T> fields of  LinqToSql classes?, I've got a table with some nullable double fields. Working with LinqToSQL trying to use the field directly I get Argument type System.Nullable is not assignable to parameter type doubleHow do I deal with this correctly? <code> ,How to correctly deal with System.Nullable<T> fields of LinqToSql classes?
Why can't we change access specifier while overriding methods in C#?," In C#, we can not change access modifier while overriding a method from base class.e.g. This is not valid in C#, It will give compile time error.I want to know the reason, why it's not allowed. Is there any technical problem or can it lead to something which is not consistent in terms of access restriction??? <code>  Class Base{ **protected** string foo() { return ""Base""; }}Class Derived : Base{ **public** override string foo() { return ""Derived""; }}",Why can't we change access modifier while overriding methods in C#?
how to convert List<List<int>> to multidimensional array, What is the best way to convert a list into an array of type int[][]? <code>  List<List<int>> lst = new List<List<int>>();,How to convert List<List<int>> to an array of arrays
How to convert List<List<int>> to multidimensional array, What is the best way to convert a list into an array of type int[][]? <code>  List<List<int>> lst = new List<List<int>>();,How to convert List<List<int>> to an array of arrays
Problems serializing types for a .NET WCF Service: Service Wsdl defines empty types in XSD.," I am writing a web service using WCF.I created data contracts.I created my service contract (interface). I defined methods (whose parameters are typed as for the data contracts).I implemented the service contract creating a service class.I hosted my service using a svc file and IIS.I tried my service, looked for http://localhost/myvirtdiriis/myservice.svc --> The service was loaded, and a nice web page describing the presence of my service showed.I wanted to look at the WSDL. Using the provided link I can see that types are only defined, I can see just the types definition (like <complexType>), but nothing inside (types are empty).I coded a simple client, a call to an operation went good, but when returning the type it is empty (internal fields have the construction values, while my service place some values there), for example, a call to an operation returning a type having three strings set by the operation contract method to ""Hello"", ""Hello2"" and ""Hello3"", returns the type having these strings set to """" (construction values, as if no changes happened).What happened?It seems that serialization fails.I am providing some:A1) A part of the service contract: A2) The service implementation: B) Types: C) WSDL (a part, the one concerning type definitions) The piece above is included here: NOTE:If I remove the MessageContract attribute from BrowseResponse and BrowseRequest (both removed otherwose the runtime gets crazy), the problem persists....Is it really an issue concerning messagecontracts???MAYBE THE SOLUTIONOK everybody, maybe I can see the light...If I remove all DataContract(s) and ServiceContract(s) attributes namespace and names (always without MessageContract(s)), everything works. Well, I get wsdl and types, but t worked even with them (but always without MessageContract(s)).Here's why (I would like to get confirm from you):The namespace I specified: http://opcfoundation.org/webservices/XMLDA/1.0/ is not a simple name, well, here you can find WSDL definitions for my operations and types (already defined). My svc does not generate complete WSDL definitions with types BECAUSE IT ALREADY HAS THEM defined in that namespace I provided!!!What do you think about this? <code>  [ServiceContract(Namespace = ""http://opcfoundation.org/webservices/XMLDA/1.0/"")] public interface IOCXSService { [OperationContract(Action = ""http://opcfoundation.org/webservices/XMLDA/1.0/Browse"")] BrowseResponse Browse(BrowseRequest request); ...} public class MyService : IOCXSService { ... public BrowseResponse Browse(BrowseRequest request) { ... } ... } [DataContract(Namespace = ""http://opcfoundation.org/webservices/XMLDA/1.0/"", Name = ""BrowseResponse"")] [System.ServiceModel.MessageContractAttribute(WrapperName = ""BrowseResponse"", WrapperNamespace = ""http://opcfoundation.org/webservices/XMLDA/1.0/"", IsWrapped = true)] public class BrowseResponse { [DataMember(Name = ""BrowseResult"", Order = 0)] public OCXS.OCXSServiceLibrary.OPCXMLDA10.ReplyBase BrowseResult; [DataMember(Name = ""Elements"", Order = 1)] public BrowseElement[] Elements; [DataMember(Name = ""Errors"", Order = 2)] public OPCError[] Errors; [DataMember(Name = ""ContinuationPoint"", Order = 3)] public string ContinuationPoint; [DataMember(Name = ""MoreElements"", Order = 4)] public bool MoreElements; public BrowseResponse() { } public BrowseResponse(OCXS.OCXSServiceLibrary.OPCXMLDA10.ReplyBase BrowseResult, BrowseElement[] Elements, OPCError[] Errors, string ContinuationPoint, bool MoreElements) { this.BrowseResult = BrowseResult; this.Elements = Elements; this.Errors = Errors; this.ContinuationPoint = ContinuationPoint; this.MoreElements = MoreElements; }[DataContract(Namespace = ""http://opcfoundation.org/webservices/XMLDA/1.0/"", Name = ""ReplyBase"")] public class ReplyBase : System.ComponentModel.INotifyPropertyChanged { private System.DateTime rcvTimeField; private System.DateTime replyTimeField; private string clientRequestHandleField; private string revisedLocaleIDField; private serverState serverStateField; [DataMember(Name = ""RcvTime"", Order = 0)] public System.DateTime RcvTime { get { return this.rcvTimeField; } set { this.rcvTimeField = value; this.RaisePropertyChanged(""RcvTime""); } } [DataMember(Name = ""ReplyTime"", Order = 1)] public System.DateTime ReplyTime { get { return this.replyTimeField; } set { this.replyTimeField = value; this.RaisePropertyChanged(""ReplyTime""); } } [DataMember(Name = ""ClientRequestHandle"", Order = 2)] public string ClientRequestHandle { get { return this.clientRequestHandleField; } set { this.clientRequestHandleField = value; this.RaisePropertyChanged(""ClientRequestHandle""); } } [DataMember(Name = ""RevisedLocaleID"", Order = 3)] public string RevisedLocaleID { get { return this.revisedLocaleIDField; } set { this.revisedLocaleIDField = value; this.RaisePropertyChanged(""RevisedLocaleID""); } } [DataMember(Name = ""ServerState"", Order = 4)] public serverState ServerState { get { return this.serverStateField; } set { this.serverStateField = value; this.RaisePropertyChanged(""ServerState""); } } public event System.ComponentModel.PropertyChangedEventHandler PropertyChanged; protected void RaisePropertyChanged(string propertyName) { System.ComponentModel.PropertyChangedEventHandler propertyChanged = this.PropertyChanged; if ((propertyChanged != null)) { propertyChanged(this, new System.ComponentModel.PropertyChangedEventArgs(propertyName)); } } }[DataContract(Namespace = ""http://opcfoundation.org/webservices/XMLDA/1.0/"", Name = ""BrowseElement"")] public class BrowseElement : INotifyPropertyChanged { private ItemProperty[] propertiesField; private string nameField; private string itemPathField; private string itemNameField; private bool isItemField; private bool hasChildrenField; [DataMember(Name = ""Properties"", Order = 0)] public ItemProperty[] Properties { get { return this.propertiesField; } set { this.propertiesField = value; this.RaisePropertyChanged(""Properties""); } } [DataMember(Name = ""Name"", Order = 1)] public string Name { get { return this.nameField; } set { this.nameField = value; this.RaisePropertyChanged(""Name""); } } [DataMember(Name = ""ItemPath"", Order = 2)] public string ItemPath { get { return this.itemPathField; } set { this.itemPathField = value; this.RaisePropertyChanged(""ItemPath""); } } [DataMember(Name = ""ItemName"", Order = 3)] public string ItemName { get { return this.itemNameField; } set { this.itemNameField = value; this.RaisePropertyChanged(""ItemName""); } } [DataMember(Name = ""IsItem"", Order = 4)] public bool IsItem { get { return this.isItemField; } set { this.isItemField = value; this.RaisePropertyChanged(""IsItem""); } } [DataMember(Name = ""HasChildren"", Order = 5)] public bool HasChildren { get { return this.hasChildrenField; } set { this.hasChildrenField = value; this.RaisePropertyChanged(""HasChildren""); } } public event System.ComponentModel.PropertyChangedEventHandler PropertyChanged; protected void RaisePropertyChanged(string propertyName) { System.ComponentModel.PropertyChangedEventHandler propertyChanged = this.PropertyChanged; if ((propertyChanged != null)) { propertyChanged(this, new System.ComponentModel.PropertyChangedEventArgs(propertyName)); } } }[DataContract(Namespace = ""http://opcfoundation.org/webservices/XMLDA/1.0/"", Name = ""OPCError"")] public class OPCError : System.ComponentModel.INotifyPropertyChanged { private string textField; private System.Xml.XmlQualifiedName idField; [DataMember(Name = ""Text"", Order = 0)] public string Text { get { return this.textField; } set { this.textField = value; this.RaisePropertyChanged(""Text""); } } [DataMember(Name = ""ID"", Order = 1)] public System.Xml.XmlQualifiedName ID { get { return this.idField; } set { this.idField = value; this.RaisePropertyChanged(""ID""); } } public event System.ComponentModel.PropertyChangedEventHandler PropertyChanged; protected void RaisePropertyChanged(string propertyName) { System.ComponentModel.PropertyChangedEventHandler propertyChanged = this.PropertyChanged; if ((propertyChanged != null)) { propertyChanged(this, new System.ComponentModel.PropertyChangedEventArgs(propertyName)); } } } <?xml version=""1.0"" encoding=""UTF-8""?><xs:schema xmlns:tns=""http://opcfoundation.org/webservices/XMLDA/1.0/"" targetNamespace=""http://opcfoundation.org/webservices/XMLDA/1.0/"" xmlns:xs=""http://www.w3.org/2001/XMLSchema"" elementFormDefault=""qualified""><xs:element name=""Browse""> <xs:complexType> <xs:sequence/> </xs:complexType> </xs:element> <xs:element name=""BrowseResponse""> <xs:complexType> <xs:sequence/> </xs:complexType> </xs:element> <xs:element name=""GetProperties""> <xs:complexType> <xs:sequence/> </xs:complexType> </xs:element> <xs:element name=""GetPropertiesResponse""> <xs:complexType> <xs:sequence/> </xs:complexType> </xs:element> <xs:element name=""GetStatus""> <xs:complexType> <xs:sequence/> </xs:complexType> </xs:element> <xs:element name=""GetStatusResponse""> <xs:complexType> <xs:sequence/> </xs:complexType> </xs:element> <xs:element name=""Read""> <xs:complexType> <xs:sequence/> </xs:complexType> </xs:element> <xs:element name=""ReadResponse""> <xs:complexType> <xs:sequence/> </xs:complexType> </xs:element> <xs:element name=""Subscribe""> <xs:complexType> <xs:sequence/> </xs:complexType> </xs:element> <xs:element name=""SubscribeResponse""> <xs:complexType> <xs:sequence/> </xs:complexType> </xs:element> <xs:element name=""SubscriptionCancel""> <xs:complexType> <xs:sequence/> </xs:complexType> </xs:element> <xs:element name=""SubscriptionCancelResponse""> <xs:complexType> <xs:sequence/> </xs:complexType> </xs:element> <xs:element name=""SubscriptionPolledRefresh""> <xs:complexType> <xs:sequence/> </xs:complexType> </xs:element> <xs:element name=""SubscriptionPolledRefreshResponse""> <xs:complexType> <xs:sequence/> </xs:complexType> </xs:element> <xs:element name=""Write"">-<xs:complexType><xs:sequence/></xs:complexType></xs:element> <xs:element name=""WriteResponse""> <xs:complexType> <xs:sequence/> </xs:complexType> </xs:element></xs:schema> <?xml version=""1.0"" encoding=""UTF-8""?><wsdl:definitions xmlns:wsam=""http://www.w3.org/2007/05/addressing/metadata"" xmlns:wsx=""http://schemas.xmlsoap.org/ws/2004/09/mex"" xmlns:wsa10=""http://www.w3.org/2005/08/addressing"" xmlns:msc=""http://schemas.microsoft.com/ws/2005/12/wsdl/contract"" xmlns:wsaw=""http://www.w3.org/2006/05/addressing/wsdl"" xmlns:wsap=""http://schemas.xmlsoap.org/ws/2004/08/addressing/policy"" xmlns:wsp=""http://schemas.xmlsoap.org/ws/2004/09/policy"" xmlns:wsa=""http://schemas.xmlsoap.org/ws/2004/08/addressing"" xmlns:tns=""http://opcfoundation.org/webservices/XMLDA/1.0/"" xmlns:soap12=""http://schemas.xmlsoap.org/wsdl/soap12/"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"" xmlns:soapenc=""http://schemas.xmlsoap.org/soap/encoding/"" xmlns:soap=""http://schemas.xmlsoap.org/wsdl/soap/"" xmlns:wsdl=""http://schemas.xmlsoap.org/wsdl/"" targetNamespace=""http://opcfoundation.org/webservices/XMLDA/1.0/""><wsdl:types><xsd:schema targetNamespace=""http://opcfoundation.org/webservices/XMLDA/1.0/Imports""><xsd:import namespace=""http://opcfoundation.org/webservices/XMLDA/1.0/"" schemaLocation=""http://localhost/OCXS/OCXS.svc?xsd=xsd0""/></xsd:schema></wsdl:types><wsdl:message name=""BrowseRequest""><wsdl:part name=""parameters"" element=""tns:Browse""/></wsdl:message><wsdl:message name=""BrowseResponse""><wsdl:part name=""parameters"" element=""tns:BrowseResponse""/></wsdl:message><wsdl:message name=""GetPropertiesRequest""><wsdl:part name=""parameters"" element=""tns:GetProperties""/></wsdl:message><wsdl:message name=""GetPropertiesResponse""><wsdl:part name=""parameters"" element=""tns:GetPropertiesResponse""/></wsdl:message><wsdl:message name=""GetStatusRequest""><wsdl:part name=""parameters"" element=""tns:GetStatus""/></wsdl:message><wsdl:message name=""GetStatusResponse""><wsdl:part name=""parameters"" element=""tns:GetStatusResponse""/></wsdl:message><wsdl:message name=""ReadRequest""><wsdl:part name=""parameters"" element=""tns:Read""/></wsdl:message>-<wsdl:message name=""ReadResponse""><wsdl:part name=""parameters"" element=""tns:ReadResponse""/></wsdl:message><wsdl:message name=""SubscribeRequest""><wsdl:part name=""parameters"" element=""tns:Subscribe""/></wsdl:message><wsdl:message name=""SubscribeResponse""><wsdl:part name=""parameters"" element=""tns:SubscribeResponse""/></wsdl:message><wsdl:message name=""SubscriptionCancelRequest""><wsdl:part name=""parameters"" element=""tns:SubscriptionCancel""/></wsdl:message><wsdl:message name=""SubscriptionCancelResponse""><wsdl:part name=""parameters"" element=""tns:SubscriptionCancelResponse""/></wsdl:message><wsdl:message name=""SubscriptionPolledRefreshRequest""><wsdl:part name=""parameters"" element=""tns:SubscriptionPolledRefresh""/></wsdl:message><wsdl:message name=""SubscriptionPolledRefreshResponse""><wsdl:part name=""parameters"" element=""tns:SubscriptionPolledRefreshResponse""/></wsdl:message><wsdl:message name=""WriteRequest""><wsdl:part name=""parameters"" element=""tns:Write""/></wsdl:message>-<wsdl:message name=""WriteResponse""><wsdl:part name=""parameters"" element=""tns:WriteResponse""/></wsdl:message><wsdl:portType name=""IOCXSService"">-<wsdl:operation name=""Browse""><wsdl:input name=""BrowseRequest"" message=""tns:BrowseRequest"" wsaw:Action=""http://opcfoundation.org/webservices/XMLDA/1.0/Browse""/><wsdl:output name=""BrowseResponse"" message=""tns:BrowseResponse"" wsaw:Action=""http://opcfoundation.org/webservices/XMLDA/1.0/IOCXSService/BrowseResponse""/></wsdl:operation><wsdl:operation name=""GetProperties""><wsdl:input name=""GetPropertiesRequest"" message=""tns:GetPropertiesRequest"" wsaw:Action=""http://opcfoundation.org/webservices/XMLDA/1.0/GetProperties""/><wsdl:output name=""GetPropertiesResponse"" message=""tns:GetPropertiesResponse"" wsaw:Action=""http://opcfoundation.org/webservices/XMLDA/1.0/IOCXSService/GetPropertiesResponse""/></wsdl:operation><wsdl:operation name=""GetStatus""><wsdl:input name=""GetStatusRequest"" message=""tns:GetStatusRequest"" wsaw:Action=""http://opcfoundation.org/webservices/XMLDA/1.0/GetStatus""/><wsdl:output name=""GetStatusResponse"" message=""tns:GetStatusResponse"" wsaw:Action=""http://opcfoundation.org/webservices/XMLDA/1.0/IOCXSService/GetStatusResponse""/></wsdl:operation><wsdl:operation name=""Read""><wsdl:input name=""ReadRequest"" message=""tns:ReadRequest"" wsaw:Action=""http://opcfoundation.org/webservices/XMLDA/1.0/Read""/><wsdl:output name=""ReadResponse"" message=""tns:ReadResponse"" wsaw:Action=""http://opcfoundation.org/webservices/XMLDA/1.0/IOCXSService/ReadResponse""/></wsdl:operation>-<wsdl:operation name=""Subscribe""><wsdl:input name=""SubscribeRequest"" message=""tns:SubscribeRequest"" wsaw:Action=""http://opcfoundation.org/webservices/XMLDA/1.0/Subscribe""/><wsdl:output name=""SubscribeResponse"" message=""tns:SubscribeResponse"" wsaw:Action=""http://opcfoundation.org/webservices/XMLDA/1.0/IOCXSService/SubscribeResponse""/></wsdl:operation><wsdl:operation name=""SubscriptionCancel""><wsdl:input name=""SubscriptionCancelRequest"" message=""tns:SubscriptionCancelRequest"" wsaw:Action=""http://opcfoundation.org/webservices/XMLDA/1.0/SubscriptionCancel""/><wsdl:output name=""SubscriptionCancelResponse"" message=""tns:SubscriptionCancelResponse"" wsaw:Action=""http://opcfoundation.org/webservices/XMLDA/1.0/IOCXSService/SubscriptionCancelResponse""/></wsdl:operation><wsdl:operation name=""SubscriptionPolledRefresh""><wsdl:input name=""SubscriptionPolledRefreshRequest"" message=""tns:SubscriptionPolledRefreshRequest"" wsaw:Action=""http://opcfoundation.org/webservices/XMLDA/1.0/SubscriptionPolledRefresh""/><wsdl:output name=""SubscriptionPolledRefreshResponse"" message=""tns:SubscriptionPolledRefreshResponse"" wsaw:Action=""http://opcfoundation.org/webservices/XMLDA/1.0/IOCXSService/SubscriptionPolledRefreshResponse""/></wsdl:operation><wsdl:operation name=""Write""><wsdl:input name=""WriteRequest"" message=""tns:WriteRequest"" wsaw:Action=""http://opcfoundation.org/webservices/XMLDA/1.0/Write""/><wsdl:output name=""WriteResponse"" message=""tns:WriteResponse"" wsaw:Action=""http://opcfoundation.org/webservices/XMLDA/1.0/IOCXSService/WriteResponse""/></wsdl:operation></wsdl:portType></wsdl:definitions>",Problems serializing types for a .NET WCF Service: Service WSDL defines empty types in XSD
"Calculate Years, Months, wereks and Days"," In my application, a user enters two dates. A scheduled start date, and a scheduled end date. We have to take those dates, and populate 4 fields, based on the difference.So, lets say he selects 1st Jan, 2010 as a start, and 2nd of March, 2011 as the end, we need to end up with:Years: 1Months: 2Weeks: 0Days 1Meaning the total duration is 1 year, 2 months and 1 day.Is there a standard way of doing this? Or would I need to write a method that has a lot of pretty tricky logic to work it out? I was hoping I'd be lucky, and there would be a date-diff type .Net class available.  <code> ","Calculate Years, Months, weeks and Days"
C# .NET: How to throw a compiler error?," Simple question, how do you force the C# compiler to throw a compilation error.Update: Perhaps it's better to use an Assert.Fail() instead?I have a custom-attribute that should only be applied to ONE member of a class. Inside of my other class' static method it looks for that one member and I want it to fail (not throw an exception) if more than one member had the attribute applied to it. <code>  public class Foo{ [MyCustomAttribute] public String FooString { get; set; } [MyCustomAttribute] public String OtherFooString { get; set; }}public class Bar<T> where T : class, new(){ static Bar() { //If more than one member of type Foo has MyCustomAttribute //applied to it compile error or Assert.Fail()? }}",How to throw a compiler error if more than one member has the same Attribute
[C#] Set cookie," In my project I'm using C# app client and tomcat6 web application server.I wrote this snippet in the C# client: Everytime I invoke this method, I get a new session at server side. I suppose it's because I should use HTTP cookies in my client. But I don't know how to do that, can you help me? <code>  public bool isServerOnline(){ Boolean ret = false; try { HttpWebRequest req = (HttpWebRequest)HttpWebRequest.Create(VPMacro.MacroUploader.SERVER_URL); req.Method = ""HEAD""; req.KeepAlive = false; HttpWebResponse resp = (HttpWebResponse)req.GetResponse(); if (resp.StatusCode == HttpStatusCode.OK) { // HTTP = 200 - Internet connection available, server online ret = true; } resp.Close(); return ret; } catch (WebException we) { // Exception - connection not available Log.e(""InternetUtils - isServerOnline - "" + we.Status); return false; }}",Keeping a session when using HttpWebRequest
Converting an Image Path from physical path," I use asp.net 4 and c#.I have this code that allow me to find the physical path for an image.As you can see I get my machine physical pagh file:///C:. Result: But I need display this image at the Front end of my web application so I would need a result like this: How to do it?PS: I need to convert the result of variable pathRaw.Hope I was able to express myself unfortunately I'm not sure about terminology in this case.Thanks for your help! <code>  string pathRaw = HttpContext.Current.Request.PhysicalApplicationPath + ""Statics\\Cms\\Front-End\\Images\\Raw\\""; file:///C:/......../f005aba1-e286-4d9e-b9db-e6239f636e63.jpg http://localhost:1108/Statics/Cms/Front-End/Images/Raw/f005aba1-e286-4d9e-b9db-e6239f636e63.jpg",Converting physical path to relative one in respect of http://localhost:
Can I use Linq's except with a lambda expression comparer?," I know I can call linq's Except and specify a custom IEqualityComparer, but implementing a new Comparer class for each data type seems like an overkill for this purpose. Can I use a lambda expression to provide the equality function, like when I use Where or other LINQ functions?If I can't, is there an alternative? <code> ",Can I use Linq's Except() with a lambda expression comparer?
Form with attachements upload and email sending," I need to make form with a textarea and an image upload field. When somebody submit it I want it to send email (with text from textarea) with attachements (from input file upload field) to me. My simple form looks like that: I found PHP scripts that are doing something like that, but how could I do it in ASP.NET MVC (could be with JavaScript)? <code>  @using (Html.BeginForm()){ @Html.ValidationSummary(true) <fieldset> @Html.TextArea(""Question""); <input type=""file""/> <input type=""submit"" value=""Send"" /> </fieldset>}",Form with attachments upload and email sending
Query Validation using c#," I am looking for a query validator in C#, which allows me to parse the SQL text from a textbox and verify whether it's correct or not before sending it for execution (MS SQL or DB2 queries). <code> ",Query validation using C#
ApplicationSettings in ASP.NET, Just now I came across ApplicationSettings in .NET WinForms that could handle complex types.Currently I am using AppSettings in my ASP.NET WebForms which can handle only string.Can I use ApplicationSettings in Webforms? If so how? <code> ,Custom type application settings in ASP.NET
ASP.NET error parsing a Web.Config AppSettings value with a querystring - Why?," In my AppSettings in web.config, I have something like this: However, it seems that when an ampersand (&) is included in an AppSettings value, ASP.NET throws the following error: An error occurred while parsing EntityNameWhy does this happen, and how can I include URLs like this in App.config? <code>  <appSettings> <add key=""ExternalSystemUrl"" value=""http://domain.com/page.aspx?id={0}&action=eat&object=bacon"" /></appSettings>",Error parsing AppSettings value with a query string
wpf how to bind to DataContext existance?, I set the datacontext dynamically in code. I would like a button on screen to be enabled/disabled depending if DataContext == null or not. I can do it in code when I assign the DataContext but it would be better if I can bind like that :) <code> ,wpf how to bind to DataContext existence?
Why C# don't support the return of refferences?," I have read that .NET supports return of references, but C# doesn't. Is there a special reason? Why I can't do something like: <code>  static ref int Max(ref int x, ref int y) { if (x > y) return ref x; else return ref y; } ",Why doesn't C# support the return of references?
Why are there no ||= or &&= operators?," We have equivalent assignment operators for all Logical operators, Shift operators, Additive operators and all Multiplicative operators.Why did the logical operators get left out?Is there a good technical reason why it is hard? <code> ",Why are there no ||= or &&= operators in C#?
Global rename on MVC project resulting in multiple types for controller error," This has happenned before and I can't remember how I solved it. I renamed an MVC project then did a ReSharper refactor to update the namespaces. Now when I run I get the following error when I run the project: I have done a search for everywhere in the solution where the old EkmDomains.FrontEnd namespace ocurrs and replaced it with the new one but to no avail...Anyone have any ideas? <code>  Multiple types were found that match the controller named 'Dashboard'. This can happen if the route that services this request ('{controller}/{action}/{id}') does not specify namespaces to search for a controller that matches the request. If this is the case, register this route by calling an overload of the 'MapRoute' method that takes a 'namespaces' parameter.The request for 'Dashboard' has found the following matching controllers:EkmDomains.FrontEnd.Controllers.DashboardControllerEkmDomains.Web.Controllers.DashboardController",Rename ASP.NET MVC project resulting in multiple types for controller error
Compiler Version vs. NET Framework Version," Scenario:I have VS 2010 (C# 4 compiler) targeting 3.5 on my client machine.I am developing ASP.NET applications. I use optional parameters (C# 4 supported) in a class file and compile the code everything appears to work fine. Later on an issue that is discovered at Runtime where an old (classic I believe) ASPX is using the function. No function accepts only x arguments where x is one less than the optional parameter is the runtime error.Does this mean normal classes and such use the C# compiler of the client, while the views (aspx) and such use the compiler on the server - thus causing issues if C# 4 is used in view/form files? <code> ",Compiler Version vs. NET Framework Version - Scenario with ASP.NET applications
.Net Remove javascript and css code blocks from html page.," I have HTML string with the JavaScript and CSS code blocks: How to strip those blocks? Any suggestion about the regular expressions that can be used to remove those? <code>  <script type=""text/javascript""> alert('hello world');</script><style type=""text/css""> A:link {text-decoration: none} A:visited {text-decoration: none} A:active {text-decoration: none} A:hover {text-decoration: underline; color: red;}</style>",.NET Remove/Strip JavaScript and CSS code blocks from HTML page
Organizing eventlogs into floders," I want to create multiple services and I want them to log each in a log entry under the same directory/folder that I specify so when I open Windows Event Viewer I can see them all placed in one folder. For example service1 would log into service1_log, service2 would log into service2_log and both service1_log and service2_log would reside in one folder named Myservices.I haven't found anything in Windows Event Log API or any other API that would fit into this problem..I can see in windows event viewer there are folders but I can only create logs into the root of the logs hierarchy there.Thanks in advanceTomas <code> ",Organizing eventlogs into folders
Linq to get a closet number that is fewer or bigger than a certain number.," Suppose I have this number list: Suppose that I want to get the closest number that is less than 11, it would be 8Suppose that I want to get the closest number that is greater than 13 that would be 14.The numbers in list can't be duplicated and are always ordered. How can I write Linq for this? <code>  List<int> = new List<int>(){3,5,8,11,12,13,14,21}",LINQ to find the closest number that is greater / less than an input
LINQ to find number that is greater / less than an input," Suppose I have this number list: Suppose that I want to get the closest number that is less than 11, it would be 8Suppose that I want to get the closest number that is greater than 13 that would be 14.The numbers in list can't be duplicated and are always ordered. How can I write Linq for this? <code>  List<int> = new List<int>(){3,5,8,11,12,13,14,21}",LINQ to find the closest number that is greater / less than an input
How to keep area of canvas centered in ScrollViewer when Zoomed in or out," Everyone,I have a WPF app that has a canvas that I have wrapped in a scroll Viewer. I have a slider in the status bar that allows the user to zoom in and out (just like Win 7's mspaint). Here is some of the XAML: When I zoom in, and the scrollbars are visible, the scrollbars, no matter where they are set, jump to the middle. It is exactly as if the value of the scrollbars stay the same but the max value increases.What can I do to get them to ... say, if they were in the lower right corner, to stay in the lower right corner after a zoom in or out?BTW, here is my Zoom in and out code: So, no rocket science in my code but ... Update idea: If I had access to the value and the max value of the scrollbars, could I get the percentage between the two and then after the zooming (scaling) I could re-apply the value of the scrollbar as a percentage of the max value????? But where is the value and the max value available?Any help would be appreciated. I cannot think that I am the only one that has this problem since MSPaint (the Windows 7 version) works correctly and I assume it is a XAML app.Here is a link (http://www.leesaunders.net/examples/zoomexample/zoomexample.zip) to a minimum working example project (VS 2010). When you run it, just move the scroll bars then zoom in a level, you will see the issue right away. <code>  <ScrollViewer Name=""Map"" VerticalScrollBarVisibility=""Auto"" HorizontalScrollBarVisibility=""Auto""> <Canvas x:Name=""WallsCanvas"" Height=""800"" Width=""1000"" ClipToBounds=""True""> <Canvas.LayoutTransform> <ScaleTransform x:Name=""WallsCanvasScale"" ScaleX=""1"" ScaleY=""1"" /> </Canvas.LayoutTransform> </Canvas></ScrollViewer> private void SliderValueChanged(object sender, RoutedPropertyChangedEventArgs<double> e){ var scales = new []{.125, .25, .5, 1, 2, 4, 8}; var scale = scales[(int)((Slider) sender).Value]; ScaleChanged(scale, WallsCanvasScale);}private static void ScaleChanged(double scale, ScaleTransform st){ st.ScaleX = scale; st.ScaleY = scale;}","How to keep area of canvas centered in a ScrollViewer when Zoomed in or out, and not everything can be displayed in the viewing window"
How to keep area of canvas centered in ScrollViewer when Zoomed in or out and not everything can displayed in the viewing window," Everyone,I have a WPF app that has a canvas that I have wrapped in a scroll Viewer. I have a slider in the status bar that allows the user to zoom in and out (just like Win 7's mspaint). Here is some of the XAML: When I zoom in, and the scrollbars are visible, the scrollbars, no matter where they are set, jump to the middle. It is exactly as if the value of the scrollbars stay the same but the max value increases.What can I do to get them to ... say, if they were in the lower right corner, to stay in the lower right corner after a zoom in or out?BTW, here is my Zoom in and out code: So, no rocket science in my code but ... Update idea: If I had access to the value and the max value of the scrollbars, could I get the percentage between the two and then after the zooming (scaling) I could re-apply the value of the scrollbar as a percentage of the max value????? But where is the value and the max value available?Any help would be appreciated. I cannot think that I am the only one that has this problem since MSPaint (the Windows 7 version) works correctly and I assume it is a XAML app.Here is a link (http://www.leesaunders.net/examples/zoomexample/zoomexample.zip) to a minimum working example project (VS 2010). When you run it, just move the scroll bars then zoom in a level, you will see the issue right away. <code>  <ScrollViewer Name=""Map"" VerticalScrollBarVisibility=""Auto"" HorizontalScrollBarVisibility=""Auto""> <Canvas x:Name=""WallsCanvas"" Height=""800"" Width=""1000"" ClipToBounds=""True""> <Canvas.LayoutTransform> <ScaleTransform x:Name=""WallsCanvasScale"" ScaleX=""1"" ScaleY=""1"" /> </Canvas.LayoutTransform> </Canvas></ScrollViewer> private void SliderValueChanged(object sender, RoutedPropertyChangedEventArgs<double> e){ var scales = new []{.125, .25, .5, 1, 2, 4, 8}; var scale = scales[(int)((Slider) sender).Value]; ScaleChanged(scale, WallsCanvasScale);}private static void ScaleChanged(double scale, ScaleTransform st){ st.ScaleX = scale; st.ScaleY = scale;}","How to keep area of canvas centered in a ScrollViewer when Zoomed in or out, and not everything can be displayed in the viewing window"
Trim the String in C#, String variable stores value as like .. careteam order 4-26-11.csvi need to trim the value .. in c# as like careteamorder4-26-11.csv - by removing the space ..!how to remove empty space in the string variable ? <code> ,Remove White Space Characters From String
"Search specific string and return whole line, C-Sharp"," What I would like to do is find all instances of a string in a text file, then add the full lines containing the said string to an array.For example: Searching eng, for example, must add the first two lines to the array, including of course the many more instances of 'eng' in the file.How can this be done, using a text file input and C#? <code>  eng GB Englishlir LR Liberian Creole Englishmao NZ Maori",Search specific string and return whole line
Using an Icollection as a datasource for datagridview.," I've extracted the setting names and their respective values out of a configuration file into an ordered dictionary. The dictionary contains keys and values which are of the ICollection class. I want to bind that data and display it in a DataGridView. I've tried copying the strings to arrays and displaying those arrays, but when I ran the program the columns were blank and it did not seem to be binded at all.I've also attempted to set the DataGridView source directly to one the ordered dictionary collections (keys or values), but that also did not result in anything I wanted; the columns were still blank. However, a third column is made with the column name as ""length"" and displays the lengths of the entries in the ICollection. But needless to say I do not want the lengths, I want the entries themselves.Here is the code that I am using for this question: Upon the loading of the form, I load the configuration file and a private member called m_Settings has all the key-value pairs. Then I create a list and add the keys and the values separately. After setting the binding source to 'data', I run the program and both columns I added are both blank. Any ideas as to how I could get the ordered dictionary and display the entries in two columns labelled ""Settings"" and ""Values""? I believe that lists were compatible DataSources for DataGridViews, but now I'm starting to second-guess myself.Any help or direction is greatly appreciated! I'll be happy to provide more information if needed.Thanks!EDIT:Here is the revised code with the implemented myStruct class: However, when I set the binding DataDource to list, nothing appears on the DataGridView, it's simply empty. Anyone know why? <code>  private void Form4_Load(object sender, EventArgs e) { loadconfigfile(Properties.Settings.Default.Config); List<Object> data = new List<Object>(); data.Add(m_Settings.Keys); data.Add(m_Settings.Values); bindingSource1.DataSource = data; dataGridView1.DataSource = bindingSource1; dataGridView1.Refresh(); } List<myStruct> list = new List<myStruct>(); for(int index = 0; index < m_Settings.Count; index++) { myStruct pair = new myStruct(keys[index], values[index].ToString()); list.Add(pair); } public class myStruct { private string Key { get; set; } private string Value { get; set; } public myStruct(string key, string value) { Key = key; Value = value; } }",Using a list as a data source for DataGridView
Using a list as a datasource for datagridview.," I've extracted the setting names and their respective values out of a configuration file into an ordered dictionary. The dictionary contains keys and values which are of the ICollection class. I want to bind that data and display it in a DataGridView. I've tried copying the strings to arrays and displaying those arrays, but when I ran the program the columns were blank and it did not seem to be binded at all.I've also attempted to set the DataGridView source directly to one the ordered dictionary collections (keys or values), but that also did not result in anything I wanted; the columns were still blank. However, a third column is made with the column name as ""length"" and displays the lengths of the entries in the ICollection. But needless to say I do not want the lengths, I want the entries themselves.Here is the code that I am using for this question: Upon the loading of the form, I load the configuration file and a private member called m_Settings has all the key-value pairs. Then I create a list and add the keys and the values separately. After setting the binding source to 'data', I run the program and both columns I added are both blank. Any ideas as to how I could get the ordered dictionary and display the entries in two columns labelled ""Settings"" and ""Values""? I believe that lists were compatible DataSources for DataGridViews, but now I'm starting to second-guess myself.Any help or direction is greatly appreciated! I'll be happy to provide more information if needed.Thanks!EDIT:Here is the revised code with the implemented myStruct class: However, when I set the binding DataDource to list, nothing appears on the DataGridView, it's simply empty. Anyone know why? <code>  private void Form4_Load(object sender, EventArgs e) { loadconfigfile(Properties.Settings.Default.Config); List<Object> data = new List<Object>(); data.Add(m_Settings.Keys); data.Add(m_Settings.Values); bindingSource1.DataSource = data; dataGridView1.DataSource = bindingSource1; dataGridView1.Refresh(); } List<myStruct> list = new List<myStruct>(); for(int index = 0; index < m_Settings.Count; index++) { myStruct pair = new myStruct(keys[index], values[index].ToString()); list.Add(pair); } public class myStruct { private string Key { get; set; } private string Value { get; set; } public myStruct(string key, string value) { Key = key; Value = value; } }",Using a list as a data source for DataGridView
C# generics: How to compare values of generic types?," How do I compare values of generic types?I have reduced it to a minimal sample: The error is: Operator '>=' cannot be applied to operands of type 'T' and 'T'.What on earth!? T is already constrained to IComparable, and even when constraining it to value types (where T: struct), we still can't apply any of the operators <, >, <=, >=, == or !=. (I know that workarounds involving Equals() exist for == and !=, but it doesn't help for the relational operators).So, two questions:Why do we observe this weird behaviour? What keeps us from comparing the values of generic types which are known to be IComparable? Doesn't it somehow defeat the entire purpose of generic constraints?How do I resolve this, or at least work around it?(I realize there are already a handful of questions related to this seemingly simple problem - but none of the threads gives an exhaustive or workable answer, so here.) <code>  public class Foo<T> where T : IComparable{ private T _minimumValue = default(T); public bool IsInRange(T value) { return (value >= _minimumValue); // <-- Error here }}",How to compare values of generic types?
C# StreamReader and binary data," I have this text file what contains different fields. Some fields may contain binary data. I need to get all the data in the file but right now when using StreamReader then it wont read the binary data block and data what comes after that. What would be the best solution to solve this problem?Example: Right now i read in the file like this: EDIT: I know the start and end positions of the binary fields. <code>  field1|field2|some binary data here|field3 public static string _fileToBuffer(string Filename){ if (!File.Exists(Filename)) throw new ArgumentNullException(Filename, ""Template file does not exist""); StreamReader reader = new StreamReader(Filename, Encoding.Default, true); string fileBuffer = reader.ReadToEnd(); reader.Close(); return fileBuffer;}",StreamReader and binary data
Should I set my object properties default values to null or use the CLR default values for each type?," I have been trying to figure out the best way to handle default values. Setting a ID value to 0 makes sense, but if it is a money value or other that is not initially set, when you encounter it later in your code, it is impossible to tell if it has been set or was set to 0. If a money value is set to null, then you know it has not been set. Additionally, when dealing with the database, it is simple to know if you need to write a null value to a field vs trying to figure out if it is supposed to be null or not. What is the accepted way to handle this? vs <code>  Class MyModel{ public int Id {get;set;} public string Title {get;set;} public DateTime CreatedDate {get;set;} public bool IsActive {get;set;} //CLR will automatically set these values Public MyModel() { Id = 0; Title = String.Empty; CreatedDate = ""1/1/0001""; IsActive = false; }} Class MyModel{ public int? Id {get;set;} public string Title {get;set;} public DateTime? CreatedDate {get;set;} public bool? IsActive {get;set;} //CLR will automatically set these values Public MyModel() { Id = null; Title = null; CreatedDate = null; IsActive = null; }}",Should I make my object properties nullable or use the CLR default values for each type?
Problems using DllImport in c# on Windows Server 2008 R2?," I have a .NET 3.5 executable, compiled with 'Any CPU' and when I attempt to run it on Windows Server 2008 x64 R2 - It gives me: Has anyone else encountered/solved this issue?I suspect the DLLImports is that it doesn't even make it to main() --I should also add that this works fine on non-R2 Win Server 2008 x64EDIT: Nevermind -- the dll import doesn't appear to be the cause of the issue --I commented it out and tried it, the same behavior occurred.Renaming question.EDIT II: This kernel base dll error seems to be rather common but I can't find any reason why.Complete error per request: I can't attach a debugger in time and cannot install VS on faulting machine :-(Here is the windbg output, I'm afraid it is just gibberish to me... I don't know if anyone can make sense of it. More information: Seems like when I run 'analyze', the money error file is But I don't understand how this could be -- .NET 3.5 is installed!I'm an idiot - I had to go enable .NET Framework 3.5.1 Features in the Features Pane of Win2008 R2 x64. I guess at least I learned a little about windbg... <code>  Faulting application name: mcb.exe, version: 0.1.0.8, time stamp: 0x4e08e871Faulting module name: KERNELBASE.dll, version: 6.1.7600.16385, time stamp: 0x4a5bdfe0 Faulting application name: mcb.exe, version: 0.1.0.8, time stamp: 0x4e08eb21Faulting module name: KERNELBASE.dll, version: 6.1.7600.16385, time stamp: 0x4a5bdfe0Exception code: 0xe0434f4dFault offset: 0x000000000000aa7dFaulting process id: 0x%9Faulting application start time: 0x%10Faulting application path: %11Faulting module path: %12Report Id: %13 Executable search path is: ModLoad: 00000000`01180000 00000000`0132c000 mcb.exe ModLoad: 00000000`77710000 00000000`778bc000 ntdll.dllModLoad: 000007fe`f4dc0000 000007fe`f4e2f000 C:\Windows\SYSTEM32\MSCOREE.DLLModLoad: 00000000`775f0000 00000000`7770f000 C:\Windows\system32\KERNEL32.dllModLoad: 000007fe`fd8f0000 000007fe`fd95b000 C:\Windows\system32\KERNELBASE.dll(1870.15fc): Break instruction exception - code 80000003 (first chance)*** ERROR: Symbol file could not be found. Defaulted to export symbols for ntdll.dll - ntdll!CsrSetPriorityClass+0x40:00000000`777c0fb0 cc int 30:000> gModLoad: 000007fe`fd500000 000007fe`fd557000 C:\Windows\system32\apphelp.dllModLoad: 000007fe`fea90000 000007fe`feb6b000 C:\Windows\system32\ADVAPI32.dllModLoad: 000007fe`fde60000 000007fe`fdeff000 C:\Windows\system32\msvcrt.dllModLoad: 000007fe`feb70000 000007fe`feb8f000 C:\Windows\SYSTEM32\sechost.dllModLoad: 000007fe`fdcb0000 000007fe`fddde000 C:\Windows\system32\RPCRT4.dllModLoad: 000007fe`fe7f0000 000007fe`fe861000 C:\Windows\system32\SHLWAPI.dllModLoad: 000007fe`ff9b0000 000007fe`ffa17000 C:\Windows\system32\GDI32.dllModLoad: 00000000`774f0000 00000000`775ea000 C:\Windows\system32\USER32.dllModLoad: 000007fe`fda40000 000007fe`fda4e000 C:\Windows\system32\LPK.dllModLoad: 000007fe`fe9c0000 000007fe`fea8a000 C:\Windows\system32\USP10.dllModLoad: 000007fe`ff980000 000007fe`ff9ae000 C:\Windows\system32\IMM32.DLLModLoad: 000007fe`fe2e0000 000007fe`fe3e9000 C:\Windows\system32\MSCTF.dllModLoad: 000007fe`f3cc0000 000007fe`f466e000 C:\Windows\Microsoft.NET\Framework64\v2.0.50727\mscorwks.dllModLoad: 00000000`75370000 00000000`75439000 C:\Windows\WinSxS\amd64_microsoft.vc80.crt_1fc8b3b9a1e18e3b_8.0.50727.4927_none_88dce9872fb18caf\MSVCR80.dllModLoad: 000007fe`feb90000 000007fe`ff916000 C:\Windows\system32\shell32.dllModLoad: 000007fe`fe0d0000 000007fe`fe2d2000 C:\Windows\system32\ole32.dllModLoad: 000007fe`fd670000 000007fe`fd67f000 C:\Windows\system32\profapi.dllModLoad: 000007fe`f27e0000 000007fe`f36bb000 C:\Windows\assembly\NativeImages_v2.0.50727_64\mscorlib\10e3a3015e967b69f90d58230a694f67\mscorlib.ni.dllModLoad: 000007fe`fd560000 000007fe`fd56f000 C:\Windows\system32\CRYPTBASE.dllModLoad: 000007fe`f2650000 000007fe`f27d4000 C:\Windows\Microsoft.NET\Framework64\v2.0.50727\mscorjit.dllModLoad: 00000642`ff4a0000 00000642`ff4aa000 C:\Windows\Microsoft.NET\Framework64\v2.0.50727\culture.dll(1870.15fc): C++ EH exception - code e06d7363 (first chance)(1870.15fc): C++ EH exception - code e06d7363 (first chance)(1870.15fc): C++ EH exception - code e06d7363 (first chance)(1870.15fc): C++ EH exception - code e06d7363 (first chance)(1870.15fc): C++ EH exception - code e06d7363 (first chance)(1870.15fc): CLR exception - code e0434f4d (first chance)(1870.15fc): C++ EH exception - code e06d7363 (first chance)(1870.15fc): C++ EH exception - code e06d7363 (first chance)(1870.15fc): C++ EH exception - code e06d7363 (first chance)(1870.15fc): C++ EH exception - code e06d7363 (first chance)(1870.15fc): C++ EH exception - code e06d7363 (first chance)(1870.15fc): CLR exception - code e0434f4d (first chance)ModLoad: 000007fe`f1c30000 000007fe`f264e000 C:\Windows\assembly\NativeImages_v2.0.50727_64\System\98ac7ad6dcf7484bf8b4478ea6951cb6\System.ni.dllModLoad: 000007fe`f19f0000 000007fe`f1c27000 C:\Windows\assembly\NativeImages_v2.0.50727_64\System.Drawing\62f46b8689863e5f23b1b69fe9c92eaf\System.Drawing.ni.dllModLoad: 000007fe`f0950000 000007fe`f19e6000 C:\Windows\assembly\NativeImages_v2.0.50727_64\System.Windows.Forms\1109b73499e4e9b612bf55e2014d94df\System.Windows.Forms.ni.dll(1870.15fc): C++ EH exception - code e06d7363 (first chance)(1870.15fc): C++ EH exception - code e06d7363 (first chance)(1870.15fc): C++ EH exception - code e06d7363 (first chance)(1870.15fc): C++ EH exception - code e06d7363 (first chance)(1870.15fc): C++ EH exception - code e06d7363 (first chance)(1870.15fc): CLR exception - code e0434f4d (first chance)(1870.15fc): C++ EH exception - code e06d7363 (first chance)(1870.15fc): CLR exception - code e0434f4d (first chance)(1870.15fc): CLR exception - code e0434f4d (!!! second chance !!!)*** ERROR: Symbol file could not be found. Defaulted to export symbols for C:\Windows\system32\KERNELBASE.dll - KERNELBASE!RaiseException+0x3d:000007fe`fd8faa7d 4881c4c8000000 add rsp,0C8h 0:000> |* ~* kp. 0 Id: 198c.1874 Suspend: 1 Teb: 000007ff`fffde000 UnfrozenChild-SP RetAddr Call Site00000000`0043a8c0 00000000`753a96d0 KERNELBASE!RaiseException+0x3900000000`0043a990 00000000`7775f001 MSVCR80!_CxxCallCatchBlock+0x18000000000`0043aa40 000007fe`f3e721da ntdll!RcFrameConsolidation+0x300000000`0043e640 000007fe`f3e3543f mscorwks!MethodDesc::MakeJitWorker+0x1ea00000000`0043e760 000007fe`f3e2702a mscorwks!MethodDesc::DoPrestub+0x116f00000000`0043e910 000007fe`f3f8d387 mscorwks!PreStubWorker+0x1fa00000000`0043e9d0 000007fe`f3f8d4a2 mscorwks!ThePreStubAMD64+0x8700000000`0043eaa0 000007fe`f3e66ef3 mscorwks!CallDescrWorker+0x8200000000`0043eaf0 000007fe`f3e56d1f mscorwks!CallDescrWorkerWithHandler+0xd300000000`0043eb90 000007fe`f3ee35b7 mscorwks!MethodDesc::CallDescr+0x24f00000000`0043ede0 000007fe`f3eff358 mscorwks!ClassLoader::RunMain+0x22b00000000`0043f040 000007fe`f3ec7835 mscorwks!Assembly::ExecuteMainMethod+0xbc00000000`0043f330 000007fe`f3db349f mscorwks!SystemDomain::ExecuteMainMethod+0x49100000000`0043f900 000007fe`f3ef8ab0 mscorwks!ExecuteEXE+0x4700000000`0043f950 000007fe`f5195b21 mscorwks!CorExeMain+0xac00000000`0043f9b0 00000000`7760f56d MSCOREE!CorExeMain_Exported+0x5700000000`0043f9e0 00000000`77742cc1 KERNEL32!BaseThreadInitThunk+0xd00000000`0043fa10 00000000`00000000 ntdll!RtlUserThreadStart+0x1d 1 Id: 198c.13f8 Suspend: 1 Teb: 000007ff`fffdc000 UnfrozenChild-SP RetAddr Call Site00000000`020df7f8 000007fe`fd8f13a6 ntdll!NtWaitForMultipleObjects+0xa00000000`020df800 00000000`775ff190 KERNELBASE!WaitForMultipleObjectsEx+0xe800000000`020df900 000007fe`f3f1b525 KERNEL32!WaitForMultipleObjects+0xb000000000`020df990 000007fe`f3efe331 mscorwks!DebuggerRCThread::MainLoop+0xbd00000000`020dfa40 000007fe`f3db5caa mscorwks!DebuggerRCThread::ThreadProc+0xf900000000`020dfa90 00000000`7760f56d mscorwks!DebuggerRCThread::ThreadProcStatic+0x5600000000`020dfae0 00000000`77742cc1 KERNEL32!BaseThreadInitThunk+0xd00000000`020dfb10 00000000`00000000 ntdll!RtlUserThreadStart+0x1d 2 Id: 198c.1840 Suspend: 1 Teb: 000007ff`fffda000 UnfrozenChild-SP RetAddr Call Site00000000`1ae1f608 000007fe`fd8f10ac ntdll!ZwWaitForSingleObject+0xa00000000`1ae1f610 000007fe`f3df72e2 KERNELBASE!WaitForSingleObjectEx+0x7900000000`1ae1f6b0 000007fe`f3df73d3 mscorwks!ZapImage::OutputDebugInfo+0xaa00000000`1ae1f710 000007fe`f3f0f0a9 mscorwks!CLREvent::WaitEx+0x6300000000`1ae1f7c0 000007fe`f3ef922a mscorwks!WKS::WaitForFinalizerEvent+0x4900000000`1ae1f7f0 000007fe`f3ee4ffc mscorwks!WKS::GCHeap::FinalizerThreadWorker+0x4a00000000`1ae1f830 000007fe`f3ea85ad mscorwks!MethodTableBuilder::AllocateFromHighFrequencyHeap+0x7000000000`1ae1f880 000007fe`f3ef0f2d mscorwks!List<tagNgenDependents * __ptr64>::AddTail+0x11d00000000`1ae1f950 000007fe`f3da4d1e mscorwks!ZapStubPrecode::GetType+0x3900000000`1ae1f990 000007fe`f3eff984 mscorwks!ManagedThreadBase_NoADTransition+0x4200000000`1ae1f9f0 000007fe`f3db0718 mscorwks!WKS::GCHeap::FinalizerThreadStart+0x7400000000`1ae1fa30 00000000`7760f56d mscorwks!Thread::intermediateThreadProc+0x7800000000`1ae1fb00 00000000`77742cc1 KERNEL32!BaseThreadInitThunk+0xd00000000`1ae1fb30 00000000`00000000 ntdll!RtlUserThreadStart+0x1d EXCEPTION_MESSAGE: Could not load file or assembly 'System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=b77aMANAGED_OBJECT_NAME: System.IO.FileNotFoundExceptionMANAGED_STACK_COMMAND: !pe 24b6010",KERNELBASE.dll error running c# app on Windows Server 2008 R2?
relative path in winform," I have an Image in my application and I have a picture in my WinForms. But I just want to use a relative path and not the full path like above.For example something like this: and cont...../not working. Any suggestions? <code>  public static string Correct_Icons = @""C:\Users\xyz\Documents\Visual Studio 2008\Projects\FileShareMgmt\FileShareMgmt\Resources\Correct.png"";public static string warning_Icon = @""C:\Users\xyz\Documents\Visual Studio 2008\Projects\FileShareMgmt\FileShareMgmt\Resources\Warning.png"";cell.Value = Image.FromFile(""Resources/warning_Icon); public static string Correct_Icons = ""\Resources\Correct.png"";",Loading image from code using relative path in Windows Forms
Loading image from relative path in Windows Forms," I have an Image in my application and I have a picture in my WinForms. But I just want to use a relative path and not the full path like above.For example something like this: and cont...../not working. Any suggestions? <code>  public static string Correct_Icons = @""C:\Users\xyz\Documents\Visual Studio 2008\Projects\FileShareMgmt\FileShareMgmt\Resources\Correct.png"";public static string warning_Icon = @""C:\Users\xyz\Documents\Visual Studio 2008\Projects\FileShareMgmt\FileShareMgmt\Resources\Warning.png"";cell.Value = Image.FromFile(""Resources/warning_Icon); public static string Correct_Icons = ""\Resources\Correct.png"";",Loading image from code using relative path in Windows Forms
Uploading videos to Flickr from Asp.net Application," I am attempting to allow user to upload videos to Flickr from an Asp.net application using the FlickrNet library/API. I've obtained an API key and an API secret from Flickr. Additionally I am retrieving an authToken using the AuthGetFrob method from the FlickrNet library. My Using Statements are as Follows I have created two methods to accomplish this task. One which gets and returns the AuthToken And One the Uploads the File Using that AuthToken However, when I make the call to 'UploadPicture' the following exception is thrown. 'Invalid auth token (98)'. The contents of the AuthRequest Http request looks like this. And the content of the Upload methods Http request looks like this. I saw a similar post on the flickr forums here but based on my understanding, it appears that I am doing everything right yet still cannot figure what I am doing wrong. Any help would be greatly appreciated.  <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using FlickrNet; private string GetAuthenticateToken(){ Flickr flickr = new Flickr(FLICKR_API_KEY, FLICKR_API_SECRET); string frob = flickr.AuthGetFrob(); return flickr.AuthCalcUrl(frob, AuthLevel.Write);} public void UploadFile(string fileName, string title, string description){ try { string authToken = GetAuthenticateToken(); Flickr flickr = new Flickr(FLICKR_API_KEY, FLICKR_API_SECRET, authToken); string photoId = flickr.UploadPicture(fileName, title, description, """", true, false, false); } catch (Exception ex) { throw ex; }} <?xml version=""1.0"" encoding=""utf-8"" ?><rsp stat=""ok""><frob>72157627073829842-9d8e31b9dcf41ea1-162888</frob></rsp> <?xml version=""1.0"" encoding=""utf-8"" ?><rsp stat=""fail""> <err code=""98"" msg=""Invalid auth token"" /></rsp>",Flickr 'Invalid auth token (98)' Uploading videos from Asp.net Application
C# Honestly what's the difference between public variable and public property accessor, Possible Duplicates: What is the difference between a field and a property in C# Should I use public properties and private fields or public fields for data? What is the difference between: and <code>  public string varA; public string varA { get; set; },"Honestly, what's the difference between public variable and public property accessor?"
How can I write methods to work with multiple number types?," I'm trying to write classes which handle different number types. I know that C# (and .Net in general, I believe) has no INumber interface, so I cannot use something like the following: That's okay, though, because I'd like to avoid the boxing/unboxing of every one of my numbers. I could, however, use conditional compilation for each type I want to support: This means I'll need to compile a different Library.dll and LibraryF.dll, however. Is there any more elegant solution to this?Obviously, in my example, I can simply write the code twice. I would like to use this process, however, to create large complicated data structures with an integer version and floating-point version, so do not want the possibility of copy-paste errors when updating my structure. Nor do I want the speed loss from wrapping the floating-point structure in an integral-wrapper, and unnecessarily converting all inputs to the more lenient data type. <code>  public class Adder<T> where T:INumber { public T Add(T a, T b) { return a + b; } } #if FLOAT public class AdderF { public float Add(float a, float b)#else public class Adder { public int Add(int a, int b)#endif { return a + b; } }",How can I write a single class to compile multiple times with different number types?
How to find the source of a request," I have a Web solution which contains two projects (A and B) with B referencing A.In A I have an Html extension method that obviously can be called from either A or B.My question is once the method is called (usually from a partial view) is there a way inside the method to figure out whether the call came from Assembly A or Assembly B without passing anything to it?I tried to see if I can do anything with HttpContext.Current.Request but could not find anything useful. I can get the URI but that still does not tell me which assembly the file that originated the Request is in.Thanks for your answers - the method returns a string and the string is from a string.resx file which I have one for each assembly. That is why I need to know which file to access to return the string. Since each assembly ""registers"" itself on start up if I add a new assembly my method will not change, since it will just look up the assembly.In fact my whole project will not change. The reason why I am not introducing another parameter at this time is b/c it will mean a HUGE amount of changes and I honestly don't see the benefit. While I see your point and I generally agree with it I think in my case it's not that the method returns different things , it's just grabbing the correct resource file based on the assembly. <code> ",How to find out which assembly handled the request
C#: Basic ArrayList question: Unable to declare an ArrayList," I'm not able to declare an ArrayList. Here's my code. (I'd much rather use Lists, but I'm just trying to understand the concept of an ArrayList). When I compile this, I get this error: I'm using the namespace System.Collections (not .Generic)What is causing this and how do I fix it? <code>  private void button1_Click(object sender, EventArgs e){ ArrayList salesTotals = new ArrayList(); decimal[] decimalSales = { 1000m, 2000m, 3000m }; foreach (decimal singleSales in decimalSales) { salesTotals.Add(singleSales); }} 'ArrayList' is a 'namespace' but is used like a 'type'",Unable to declare an ArrayList
C#: Unable to declare an ArrayList," I'm not able to declare an ArrayList. Here's my code. (I'd much rather use Lists, but I'm just trying to understand the concept of an ArrayList). When I compile this, I get this error: I'm using the namespace System.Collections (not .Generic)What is causing this and how do I fix it? <code>  private void button1_Click(object sender, EventArgs e){ ArrayList salesTotals = new ArrayList(); decimal[] decimalSales = { 1000m, 2000m, 3000m }; foreach (decimal singleSales in decimalSales) { salesTotals.Add(singleSales); }} 'ArrayList' is a 'namespace' but is used like a 'type'",Unable to declare an ArrayList
C#.NET Service to Linux Daemon," I am writing a portable service/daemon using .NET 3.5, my windows service is running, but I was wondering about the mono port...Mono-service is what I am looking for if I understand correctly. How exactly does this work though? I assume I need mono compatible code throughout my service, right? For example, I am using SQLite. Is it correct that in order to use this with mono I should refactor my code to use mono namespaces etc, such as Mono.Data.SQLite? May I still use Settings.settings?Also, I've read that daemons don't implement onStart/Stop methods, so do I need to change my code to run under mono/linux? i.e. is it ok to have these methods in my code, and ok to run ServiceBase.Run()? Does Mono-service accommodate these? <code> ",.NET Service to Linux Daemon
Search ActiveDirectory using first name in C#?," UserPrincipal's FindByIdentity method allows me to search ActiveDirectory using username.However, I also want to be able to search using user's real name (e.g. Wayne, Bruce)How can I do this? <code> ",Search ActiveDirectory using full name in C#?
mvc implementing iprincipal and iidentity with use of custom membership and role provider," I'm stuck with the implementation of a custom iprincpal and iidentity object. I spend a day now for searching how to implement these right and extend it with more informations.I want to extend the Information @Context.User.Identity.Name with custom variables like full name or something else.EDIT: Now i got the following code but if i try to read @((CustomPrincipal)Context.User.Identity).Nachname I'm getting a error that System.Web.Security.FormsIdentity could not be casted to CustomPrincipal. Any ideas? AccountModel: global.asax: <code>  public class CustomPrincipal : GenericPrincipal{ public CustomPrincipal(IIdentity identity, String[] roles) : base(identity, roles){ } public String Vorname { get; set; } public String Nachname { get; set; } } public class FormsAuthenticationService : IFormsAuthenticationService{ public void SignIn(string userName, bool createPersistentCookie) { if (String.IsNullOrEmpty(userName)) throw new ArgumentException(""Der Wert darf nicht NULL oder leer sein."", ""userName""); // Grab user information to insert KIMembershipUser membershipUser = (KIMembershipUser)Membership.GetUser(userName); var customInfo = String.Format(""{0}|{1}"", membershipUser.Vorname, membershipUser.Nachname); // Create and encrypt the ticket var ticket = new FormsAuthenticationTicket( 2, // Version number userName, // Username DateTime.Now, // Issue date DateTime.Now.AddMinutes(30), // Expiration date createPersistentCookie, // Is it persistent? customInfo // User data ); var encTicket = FormsAuthentication.Encrypt(ticket); // Store the ticket into a cookie var cookie = FormsAuthentication.GetAuthCookie(FormsAuthentication.FormsCookieName,createPersistentCookie); cookie.Value = encTicket; // Append the cookie to the response HttpContext.Current.Response.Cookies.Add(cookie); //FormsAuthentication.SetAuthCookie(userName, createPersistentCookie); } public void SignOut() { FormsAuthentication.SignOut(); }} protected void Application_PostAuthenticateRequest(){ // Collect current security information var principal = HttpContext.Current.User as RolePrincipal; if (principal == null) return; var identity = principal.Identity as FormsIdentity; if (identity == null) return; var roles = principal.GetRoles(); // Extract user data in the authentication ticket var customInfo = identity.Ticket.UserData; var tokens = customInfo.Split('|'); // Build a richer principal object var CustomPrincipal = new CustomPrincipal(identity, roles){ Vorname = tokens[0], Nachname = tokens[1] }; // Store the new principal in the HttpContext HttpContext.Current.User = CustomPrincipal; }",Implementing IPrincipal and IIdentity in MVC with use of custom membership and role provider
"difference between a page method, a web service and http handler"," I'm looking to create json objects in the client and then transfer these objects back to the server for processing. These are the following options I'm considering:a page methoda web servicea custom http handlerI'm looking to use jquery to send the objects. The plan is to convert the json object into c# objects that in turn go into queries. During the processing, I'll need access to the users' session that's working in SQL server session mode. The pages where these calls will be running will be on https. The return objects will also be json objects. I'll consider scalability, security and performance.I was wondering what would be the ups/downs of using each option.Thanks for your suggestions. <code> ","differences between doing ajax using a page method, a web service and a custom http handler"
"difference between using a page method, a web service and a custom http handler"," I'm looking to create json objects in the client and then transfer these objects back to the server for processing. These are the following options I'm considering:a page methoda web servicea custom http handlerI'm looking to use jquery to send the objects. The plan is to convert the json object into c# objects that in turn go into queries. During the processing, I'll need access to the users' session that's working in SQL server session mode. The pages where these calls will be running will be on https. The return objects will also be json objects. I'll consider scalability, security and performance.I was wondering what would be the ups/downs of using each option.Thanks for your suggestions. <code> ","differences between doing ajax using a page method, a web service and a custom http handler"
Convert List list string to List string, Possible Duplicate: Linq: List of lists to a long list I have convert it using LINQ.List<List<string>> to List<string>.If the leaves overlap one. Must be In one line. <code> ,Convert List<List<string>> to List<string>
How to properly call an external WCF Service from SharePoint?," I would like to call an external WCF Service from within SharePoint. Using normal WCF calls immediately causes a SocketException (An existing connection was forcibly closed by the remote host), which can be circumvented with SPSecurity.RunWithElevatePrivileges. [SocketException (0x2746): An existing connection was forcibly closed by the remote host] System.Net.Sockets.Socket.Receive(Byte[] buffer, Int32 offset, Int32 size, SocketFlags socketFlags) +85 System.ServiceModel.Channels.SocketConnection.ReadCore(Byte[] buffer, Int32 offset, Int32 size, TimeSpan timeout, Boolean closing) +204 [CommunicationException: The socket connection was aborted. This could be caused by an error processing your message or a receive timeout being exceeded by the remote host, or an underlying network resource issue. Local socket timeout was '00:00:58.7210000'.] System.ServiceModel.Channels.SocketConnection.ReadCore(Byte[] buffer, Int32 offset, Int32 size, TimeSpan timeout, Boolean closing) +15307563 System.ServiceModel.Channels.SocketConnection.Read(Byte[] buffer, Int32 offset, Int32 size, TimeSpan timeout) +90 System.ServiceModel.Channels.DelegatingConnection.Read(Byte[] buffer, Int32 offset, Int32 size, TimeSpan timeout) +34 System.ServiceModel.Channels.ConnectionStream.Read(Byte[] buffer, Int32 offset, Int32 count, TimeSpan timeout) +34 System.ServiceModel.Channels.ConnectionStream.Read(Byte[] buffer, Int32 offset, Int32 count) +88 System.Net.FixedSizeReader.ReadPacket(Byte[] buffer, Int32 offset, Int32 count) +58 System.Net.Security.NegotiateStream.StartFrameHeader(Byte[] buffer, Int32 offset, Int32 count, AsyncProtocolRequest asyncRequest) +62 System.Net.Security.NegotiateStream.StartReading(Byte[] buffer, Int32 offset, Int32 count, AsyncProtocolRequest asyncRequest) +54 System.Net.Security.NegotiateStream.ProcessRead(Byte[] buffer, Int32 offset, Int32 count, AsyncProtocolRequest asyncRequest) +402 [IOException: The read operation failed, see inner exception.] System.Net.Security.NegotiateStream.ProcessRead(Byte[] buffer, Int32 offset, Int32 count, AsyncProtocolRequest asyncRequest) +704 System.Net.Security.NegotiateStream.Read(Byte[] buffer, Int32 offset, Int32 count) +154 System.ServiceModel.Channels.StreamConnection.Read(Byte[] buffer, Int32 offset, Int32 size, TimeSpan timeout) +87 [CommunicationException: The socket connection was aborted. This could be caused by an error processing your message or a receive timeout being exceeded by the remote host, or an underlying network resource issue. Local socket timeout was '00:00:58.7210000'.] System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg) +10257978 System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type) +539 MyApp.FunctionThatCallsService()That got me thinking: SharePoint does it, and they do it in a nice way where they have individual service configurations in 14\WebClients.I reflected and cloned a lot of it (The Extension Methods on the ChannelFactory are used internally all over the place - SPChannelFactoryOperations), but I wonder: Are the ""proper"" APIs that SharePoint uses to call it's own WCF Services exposed to external code, so that I can call my non-SharePoint WCF Services from custom SharePoint code?(This is a farm solution deployed to the GAC, so neither CAS nor Sandboxing applies) <code> ",How to properly call an external WCF Service from SharePoint 2010?
Is it possible to use a lower-versioned assembly than the one referenced from a 3rd-party DLL using a binding redirect?," I'm using an older version of NHibernate (v3.0.0.1001) and I'm stuck to it because the new LINQ provider breaks quite a few of my queries (something I'll be trying to fix later). I want to update a library that uses NHibernate v3.1.0.4000.I've tried adding a binding redirect in the App.config: But when I compile, I get:error CS1705: Assembly 'My3rdPartyDll, Version=0.5.0.170, Culture=neutral, PublicKeyToken=null' uses 'NHibernate, Version=3.1.0.4000, Culture=neutral, PublicKeyToken=aa95f207798dfdb4' which has a higher version than referenced assembly 'NHibernate, Version=3.0.0.1001, Culture=neutral, PublicKeyToken=aa95f207798dfdb4'Is it possible to use a binding redirect to point to a downgrade? <code>  <?xml version=""1.0""?><configuration> <runtime> <assemblyBinding xmlns=""urn:schemas-microsoft-com:asm.v1""> <dependentAssembly> <assemblyIdentity name=""NHibernate"" publicKeyToken=""aa95f207798dfdb4"" culture=""neutral""/> <bindingRedirect oldVersion=""0.0.0.0-3.1.0.4000"" newVersion=""3.0.0.1001""/> </dependentAssembly> </assemblyBinding> </runtime></configuration>",Downgrade (use a lower-versioned library) with a binding redirect
Which writing to file method to use ?," I'm really getting confused by how many different ways there is to write data to a file just with System.IO.I mean, between FileStream, StreamWriter or just the System.IO.file methods... Which one is the best to use?It even gets more confusing when you see you can use different constructs with any of them, like using using or not.Is there any difference between them? Online tutorials seems to only stick to one of them and completely ignores the other ones. Some of these tutorials are even using different ways of referencing the file to write in (using the File type in some cases, FileInfo types in others, or even just a string for its path/name).Any of them is more efficient than the other? <code> ",Which writing to file method to use?
"c#, 'Froms' does not exist in the namespace system.windows"," I have just started working on c#, and was fiddling with some code sample that I got from some forum.This code is using a namespace using system.windows.forms for which I am getting an error: Forms does not exist in the namespace system.windows. Also I am getting some error related to undefined functions for senddown & sendup which I believe to be in the Forms name space.I am using visual studio 10 (with .net frame work 4.0). Any idea how to fix this error? <code> ",'Forms' does not exist in the namespace system.windows
"c#, 'Forms' does not exist in the namespace system.windows"," I have just started working on c#, and was fiddling with some code sample that I got from some forum.This code is using a namespace using system.windows.forms for which I am getting an error: Forms does not exist in the namespace system.windows. Also I am getting some error related to undefined functions for senddown & sendup which I believe to be in the Forms name space.I am using visual studio 10 (with .net frame work 4.0). Any idea how to fix this error? <code> ",'Forms' does not exist in the namespace system.windows
How to send continous keypress to a program?," I have been using SendKeys.Send() & SendKeys.SendWait() to send keys to the foreground program (a program different from the application written).I tried sending a continuous key-press by sending repeatedly the same key with a certain delay between them but the effect was not the same as a continuous keypress in that application.My question is: How can I send a continuous key-press to a program? The effect of that keypress must be the same as pressing myself that key continuously in the application.SOLUTION EDITThe solution was to call the method: with the parameters obtained from:public System.Diagnostics.Process[] p = System.Diagnostics.Process.GetProcessesByName(""process"");p[0].MainWindowHandle is hWndand using Spy on the window:right clicking on a message line in Spy shows the wMsg, wParam and lParam (all 3 in hexadecimal)SendMessage(p[0].MainWindowHandle, (uint)0x0100, (UIntPtr)0x00000041, (IntPtr)(0x001E0001));By sending only one WM_KEYDOWN message the effect is as the key is pressed continuously. To stop the program acting as the key is continuously pressed i have to press that key on the keyboard and release it, so that WM_KEYUP is generated. Sending WM_KEYUP in the code gives an System.OverFlow ""Arithmetic operation resulted in an overflow."" exception. Any ideea why that might happen?Thanks for your replies: Ation and takrl <code>  [DllImport(""User32.dll"")]static extern int SendMessage(IntPtr hWnd, uint wMsg, UIntPtr wParam, IntPtr lParam);",How to send continuous keypress to a program?
How to let a parent class know about a change in its chilren?," This is an example code: Let's say I now have two instances of my classes, one as myParent, and the other as myChild.I have two visual elements, that each have a property bound to the IsChnaged property of my instances; ElementA bound to myParent.IsChanged and ElementB bound to myChild.IsChanged.When myChild.Value differs from its default value, the myChild.IsChanged is set to true and the ElementB is updated accordingly.What I need is when either of the myParent children (which here is only one) have their IsChanged value set to true, its own (the parent's) IsChanged value be set to true and its corresponding element (ElementA here) be updated accordingly.The myParent.IsChanged is only read once (when the binding is set) and it has no sense about its children changing. Where should i put the RaiseChanged(""IsChanged"") for MyParent? How can I let the parent know when its children have changed?Thanks in advance <code>  public class MyParent : INotifyPropertyChanged{ List<MyChild> MyChildren; public bool IsChanged { get { foreach (var child in MyChildren) { if (child.IsChanged) return true; } return false; } } public event PropertyChangedEventHandler PropertyChanged; private void RaiseChanged(string propName) { if (PropertyChanged != null) PropertyChanged.Invoke(this, new PropertyChangedEventArgs(propName)); }}public class MyChild : INotifyPropertyChanged{ private int _Value; public int Value { get { return _Value; } set { if (_Value == value) return; _Value = value; RaiseChanged(""Value""); RaiseChanged(""IsChanged""); } } private int _DefaultValue; public int DefaultValue { get { return _DefaultValue; } set { if (_DefaultValue == value) return; _DefaultValue = value; RaiseChanged(""DefaultValue""); RaiseChanged(""IsChanged""); } } public bool IsChanged { get { return (Value != DefaultValue); } } public event PropertyChangedEventHandler PropertyChanged; private void RaiseChanged(string propName) { if (PropertyChanged != null) PropertyChanged.Invoke(this, new PropertyChangedEventArgs(propName)); }}",How to let a parent class know about a change in its children?
Is the size of a WinForm limited to screen resolution?," Why is it, that in the Visual Studio WinForms designer I cannot increase the size of my Form above the resolution of the screen I am currently working on? I think it should somehow be possible to develop an application aimed at higher resolutions on a lower res system. The fact that this would clip the Form during debugging should not be an issue. Is there perhaps some setting in Visual Studio for this, which I cannot seem to find?EDIT:My main issue is that I need to be able to design a (for example) 1440x900 sized form on a laptop with a (for example) 1360x768 screen. <code> ",Is the size of a Form in Visual Studio designer limited to screen resolution?
Can C# style object initialization be used in java," In C# it's possible to write: I can see that array initialization can be done in a similar way but can something similar to the above be done in Java too, and if so, what's the syntax? <code>  MyClass obj = new MyClass(){ field1 = ""hello"", field2 = ""world"", field3 = new MyOtherClass() { etc.... }}",Can C# style object initialization be used in Java?
easiest way to add code to all methods and properties that don't have a custom attribute," There are a a lot of questions and answers around AOP in .NET here on StackOverflow, often mentioning PostSharp and other third-party products. So there seems to be quite a range of AOP optons in the .NET and C# world. But each of those has their restrictions, and after downloading the promising PostSharp I found in their documentation that 'methods have to be virtual' in order to be able to inject code (edit: see ChrisWue's answer and my comment - the virtual constraint must have been on one of the contenders, I suppose). I haven't investigated the accuracy of this statement any further, but it's categoricality made me return back to StackOverflow.So I'd like to get an answer to this very specific question:I want to inject simple ""if (some-condition) Console.WriteLine"" style code to every method and property (static, sealed, internal, virtual, non-virtual, doesn't matter) in my project that does not have a custom annotation, in order to dynamically test my software at run-time. This injected code should not remain in the release build, it is just meant for dynamic testing (thread-related) during development.What's the easiest way to do this? I stumbled upon Mono.Cecil, which looks ideal, except that you seem to have to write the code that you want to inject in IL. This isn't a huge problem, it's easy to use Mono.Cecil to get an IL version of code written in C#. But nevertheless, if there was something simpler, ideally even built into .NET (I'm still on .NET 3.5), I'd like to know. [Update: If the suggested tool is not part of the .NET Framework, it would be nice if it was open-source, like Mono.Cecil, or freely available] <code> ",Easiest way to inject code to all methods and properties that don't have a custom attribute
easiest way to inject code to all methods and properties that don't have a custom attribute," There are a a lot of questions and answers around AOP in .NET here on StackOverflow, often mentioning PostSharp and other third-party products. So there seems to be quite a range of AOP optons in the .NET and C# world. But each of those has their restrictions, and after downloading the promising PostSharp I found in their documentation that 'methods have to be virtual' in order to be able to inject code (edit: see ChrisWue's answer and my comment - the virtual constraint must have been on one of the contenders, I suppose). I haven't investigated the accuracy of this statement any further, but it's categoricality made me return back to StackOverflow.So I'd like to get an answer to this very specific question:I want to inject simple ""if (some-condition) Console.WriteLine"" style code to every method and property (static, sealed, internal, virtual, non-virtual, doesn't matter) in my project that does not have a custom annotation, in order to dynamically test my software at run-time. This injected code should not remain in the release build, it is just meant for dynamic testing (thread-related) during development.What's the easiest way to do this? I stumbled upon Mono.Cecil, which looks ideal, except that you seem to have to write the code that you want to inject in IL. This isn't a huge problem, it's easy to use Mono.Cecil to get an IL version of code written in C#. But nevertheless, if there was something simpler, ideally even built into .NET (I'm still on .NET 3.5), I'd like to know. [Update: If the suggested tool is not part of the .NET Framework, it would be nice if it was open-source, like Mono.Cecil, or freely available] <code> ",Easiest way to inject code to all methods and properties that don't have a custom attribute
C# Enity Framework loading from database without proxy classes?," In Entity Framework 4 Is it possible to choose to load some queries into a POCO without it using proxy classes? (For the purpose of caching that object for future read only use). I am using the Repository - Service pattern.By this I mean: What I want is for the order.Customer to actually use the POCO type MyApp.Models.Entities.Customer instead of a proxy to that type.EDIT: Based on Ladislav's suggestion to add a ""GetUnproxied"" method to the Repository, I've made this change: Is this correct? It does not look thread safe to me. Both methods use the same ObjectContext instance, so it might be possible for ProxyCreationEnabled == false to happen on one thread and then public IQueryable<T> GetQuery() to be called on another thread - which would suddenly mean that the proxy method could return the non proxied object. <code>  var order = _orderService.GetById(1);// after order is loaded then we can see in the debugger that:// order.Customer is of type System.Data.Entity.DynamicProxy.Customer_17631AJG_etc // this is the current method that must return a DynamicProxypublic IQueryable<T> GetQuery(){ return ObjectSet.AsQueryable();}// this is the new additional method that must return the plain POCOpublic IQueryable<T> GetReadOnly(){ ObjectContext.ContextOptions.ProxyCreationEnabled = false; var readOnly = ObjectSet.AsQueryable(); ObjectContext.ContextOptions.ProxyCreationEnabled = true; return readOnly;}",Loading from database without proxy classes?
C# Entity Framework loading from database without proxy classes?," In Entity Framework 4 Is it possible to choose to load some queries into a POCO without it using proxy classes? (For the purpose of caching that object for future read only use). I am using the Repository - Service pattern.By this I mean: What I want is for the order.Customer to actually use the POCO type MyApp.Models.Entities.Customer instead of a proxy to that type.EDIT: Based on Ladislav's suggestion to add a ""GetUnproxied"" method to the Repository, I've made this change: Is this correct? It does not look thread safe to me. Both methods use the same ObjectContext instance, so it might be possible for ProxyCreationEnabled == false to happen on one thread and then public IQueryable<T> GetQuery() to be called on another thread - which would suddenly mean that the proxy method could return the non proxied object. <code>  var order = _orderService.GetById(1);// after order is loaded then we can see in the debugger that:// order.Customer is of type System.Data.Entity.DynamicProxy.Customer_17631AJG_etc // this is the current method that must return a DynamicProxypublic IQueryable<T> GetQuery(){ return ObjectSet.AsQueryable();}// this is the new additional method that must return the plain POCOpublic IQueryable<T> GetReadOnly(){ ObjectContext.ContextOptions.ProxyCreationEnabled = false; var readOnly = ObjectSet.AsQueryable(); ObjectContext.ContextOptions.ProxyCreationEnabled = true; return readOnly;}",Loading from database without proxy classes?
Any ideas what a Bannon operator is in C#?," Working on a C# console app, I have a line: rowsFound is a DataRow[], tempUsers is a DataTable, and userData is a SqlDataReader. I had the wrong index for userData (it was 1) and I got this error: When I inserted the correct index (2), the error went away.Any ideas on what a ""Bannon operator"" is? <code>  rowsFound = tempUsers.Select(""EmailAddress = '"" + userData[2].ToString() + ""'""); System.Data.SyntaxErrorException was unhandled Message=Syntax error: Missing operand after 'Bannon' operator. Source=System.DataStackTrace: at System.Data.ExpressionParser.Parse() at System.Data.DataExpression..ctor(DataTable table, String expression, Type type) at System.Data.Select..ctor(DataTable table, String filterExpression, String sort, DataViewRowState recordStates) at System.Data.DataTable.Select(String filterExpression)","Error ""Missing operand after 'Bannon' operator"" - what 'Bannon' operator is?"
Solving a timeout SQL error," I am getting this error: Timeout expired. The timeout period elapsed prior to completion of the operation or the server is not responding.I know there are already guides out there to help solve this but they are not working for me. What am I missing or where should I add the code to these SQL statements in my C# program: I am getting the timeout error at this line: <code>  String sql = project1.Properties.Resources.myQueryData;SqlDataAdapter sqlClearQuestDefects = new SqlDataAdapter(sql, ""Data Source=ab;Initial Catalog=ac;User ID=ad; Password =aa"");DataSet lPlanViewData = new DataSet();sqlClearQuestDefects.Fill(lPlanViewData, ""PlanViewData""); SqlDataAdapter sqlClearQuestDefects = new SqlDataAdapter(sql, ""Data Source=ab;Initial Catalog=ac;User ID=ad; Password =aa"");",Solving a timeout error for SQL query
Solving a timeout error for SQL qurey," I am getting this error: Timeout expired. The timeout period elapsed prior to completion of the operation or the server is not responding.I know there are already guides out there to help solve this but they are not working for me. What am I missing or where should I add the code to these SQL statements in my C# program: I am getting the timeout error at this line: <code>  String sql = project1.Properties.Resources.myQueryData;SqlDataAdapter sqlClearQuestDefects = new SqlDataAdapter(sql, ""Data Source=ab;Initial Catalog=ac;User ID=ad; Password =aa"");DataSet lPlanViewData = new DataSet();sqlClearQuestDefects.Fill(lPlanViewData, ""PlanViewData""); SqlDataAdapter sqlClearQuestDefects = new SqlDataAdapter(sql, ""Data Source=ab;Initial Catalog=ac;User ID=ad; Password =aa"");",Solving a timeout error for SQL query
Is it more or less effiicent to perform a check before performing a Replace in C#?," This is an almost academic question but I'm curious as to its answer.Suppose you have a loop that performs a routine replace on every row in a dataset. Let's say there's 10,000 such rows.Is it more efficient to have something like this: Or to check whether the row even contains the character that is to be replaced in the first place, like this: Is there any difference in terms of efficiency? I realize that that the difference might be very minor bit I'm interested in knowing if one way is better than the other regardless of how much better it may be. Also, would your answer be different if the probability of finding the character that's to be replaced was 10% from it it being 90%? <code>  Row = Row.Replace('X', 'Y'); if (Row.Contains('X')) Row = Row.Replace('X', 'Y');",Is it more or less efficient to perform a check before performing a Replace in C#?
Is it more or less efficent to perform a check before performing a Replace in C#?," This is an almost academic question but I'm curious as to its answer.Suppose you have a loop that performs a routine replace on every row in a dataset. Let's say there's 10,000 such rows.Is it more efficient to have something like this: Or to check whether the row even contains the character that is to be replaced in the first place, like this: Is there any difference in terms of efficiency? I realize that that the difference might be very minor bit I'm interested in knowing if one way is better than the other regardless of how much better it may be. Also, would your answer be different if the probability of finding the character that's to be replaced was 10% from it it being 90%? <code>  Row = Row.Replace('X', 'Y'); if (Row.Contains('X')) Row = Row.Replace('X', 'Y');",Is it more or less efficient to perform a check before performing a Replace in C#?
Why is List Sort an instance method but Array Sort static?," I'm trying to understand the design decision behind this part of the language. I admit i'm very new to it all but this is something which caught me out initially and I was wondering if I'm missing an obvious reason. Consider the following code: Why are they not both implemented in the same way - intuitively to me it would make more sense if they were both instance methods? <code>  List<int> MyList = new List<int>() { 5, 4, 3, 2, 1 };int[] MyArray = {5,4,3,2,1};//Sort the listMyList.Sort();//This was an instance method//Sort the ArrayArray.Sort(MyArray);//This was a static method",Why is List.Sort() an instance method but Array.Sort() static?
Reference added but Namespacse does not recognized," I added a DLL to my project. The DLL contains the namespace test.security. Now, test.security is not recognized. Why is this?I am using this DLL in other projects and I have no other problems. <code> ",Reference added but Namespace is not recognized
Memory tiling managment and Large Objects c#," I have a set of images that stored in a 3D array of type Int16 , the number of images i cache can reach up to 600 images or more which affect the memory performance the garbage collection performance.I heard about memory tiling that can enhance the memory management as it sets the sub-array elements in a separate chunk.- can I use memory tiling in my case?- if yes, how can I use it? <code> ",Memory tiling management and Large Objects C#
How to capture the screen in C#.net using the Windows api functions ? Including the mouse pointer.," I'm using the below code to capture the screen in a bitmap. The screen is captured, but I'm unable to get the mouse pointer on the screen. Could you suggest some alternative approach so that the mouse is captured as well? <code>  private Bitmap CaptureScreen() { // Size size is how big an area to capture // pointOrigin is the upper left corner of the area to capture int width = Screen.PrimaryScreen.Bounds.X + Screen.PrimaryScreen.Bounds.Width; int height = Screen.PrimaryScreen.Bounds.Y + Screen.PrimaryScreen.Bounds.Height; Size size = new Size(width, height); Point pointOfOrigin = new Point(0, 0); Bitmap bitmap = new Bitmap(size.Width, size.Height); { using (Graphics graphics = Graphics.FromImage(bitmap)) { graphics.CopyFromScreen(pointOfOrigin, new Point(0, 0), size); } return bitmap; } }",How to capture the screen and mouse pointer using Windows APIs? 
C# .net (using visual studio 2010) query all users in an OU within Active Directory and output usernames to listbox," I'm needing to modify a custom attribute we've added to the schema, but on an all user basis. The attribute is an MD5 hash, that I'm already storing as a public variable. I'm trying to get a list of all users within specified OU to be listed within the listbox so that you can select all the users or individual users to have the values applied to.Here is my current code for Form1.cs <code>  using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Windows.Forms;using System.Security.Cryptography;using System.DirectoryServices;namespace WindowsFormsApplication1{ public partial class Form1 : Form { String Password; public Form1() { InitializeComponent(); } private void Form1_Load(object sender, EventArgs e) { } private void textBox1_TextChanged(object sender, EventArgs e) { Password = textBox1.Text; } private void button1_Click(object sender, EventArgs e) { System.Security.Cryptography.MD5CryptoServiceProvider x = new System.Security.Cryptography.MD5CryptoServiceProvider(); byte[] bs = System.Text.Encoding.UTF8.GetBytes(Password); bs = x.ComputeHash(bs); System.Text.StringBuilder s = new System.Text.StringBuilder(); foreach (byte b in bs) { s.Append(b.ToString(""x2"").ToLower()); } Password = s.ToString(); textBox2.Text = Password; } private void button2_Click(object sender, EventArgs e) { } private void textBox2_TextChanged(object sender, EventArgs e) { } private void button3_Click(object sender, EventArgs e) { } private void listBox1_SelectedIndexChanged(object sender, EventArgs e) { } }}",query all users in an OU within Active Directory and output usernames to listbox
"How do languages like C++/CLI or Scala which need covariant return types (and ""real"" class variance) run on the CLR?"," The CLR does not support covariant return types or full variance (i. e. applied to classes, not only interfaces and delegates), but there are languages targeting the CLR which use one or both of these features.Is there some practical workaround for the CLR to enable this functionality or do these languages employ some kind of rewriting/erasure/... technique to fully support their feature set? <code> ","How do languages Scala which need covariant return types and ""real"" class variance run on the CLR?"
Creating a centralized log system, I'm planning to create a centralized log system for my application. My application contains several separate applications what work on different client machines. I was planning to start using Exception Handling block from Enterprise Library. It's looks really great and does exactly what I need by creating event logs from the exceptions.The question now is that I would like to create these logs into one place. So when the client computers are in the same domain then they would create the logs into the domain controller event logs. Has anybody seen any good articles about this or have any other good ideas about creating a centralized log system?EDIT: Im talking about C# and the Windows OS-s. <code> ,Creating a centralized exception logging system
C# compiler not recongnizing yield return methods as similar?," If I have two yield return methods with the same signature, the compiler does not seem to be recognizing them to be similar.I have two yield return methods like this: With this, I would expect the following statement to compile fine:Func<int, IEnumerable<int>> generator = 1 == 0 ? EvenNumbers : OddNumbers; // Does not compileI get the error message Type of conditional expression cannot be determined because there is no implicit conversion between 'method group' and 'method group'However, an explicit cast works:Func<int, IEnumerable<int>> newGen = 1 == 0 ? (Func<int, IEnumerable<int>>)EvenNumbers : (Func<int, IEnumerable<int>>)OddNumbers; // Works fineAm I missing anything or Is this a bug in the C# compiler (I'm using VS2010SP1)?Note: I have read this and still believe that the first one should've compiled fine.EDIT: Removed the usage of var in the code snippets as that wasn't what I intended to ask. <code>  public static IEnumerable<int> OddNumbers(int N) { for (int i = 0; i < N; i++) if (i % 2 == 1) yield return i; } public static IEnumerable<int> EvenNumbers(int N) { for (int i = 0; i < N; i++) if (i % 2 == 0) yield return i; }",C# compiler not recognizing yield return methods as similar?
How to periodically flush dapper.net cache when used with MS sql server," Can someone please explain what this means (from the Dapper.net website)Limitations and caveatsDapper caches information about every query it runs, this allow it to materialize objects quickly and process parameters quickly. The current implementation caches this information in a ConcurrentDictionary object. The objects it stores are never flushed. If you are generating SQL strings on the fly without using parameters it is possible you will hit memory issues. We may convert the dictionaries to an LRU Cache. I am not able to understand what the line in bold means. I am using SQL Server and c# client.Can someone please give a sample of c# code that will create this memory issue. thank you <code> ",How to periodically flush dapper.net cache when used with SQL Server
Enum.GetNames results in unexpected order if negative enum constant," I have the following enum definition (in C#): Now, when I do an Enum.GetNames() on this type I get a string array with 9 elements as expected, but the order is All, Trace, ... , Off, General, which is not what I was expecting. Here's the MSDN documentation for Enum.GetNames(): ""Remarks: The elements of the return value array are sorted by the values of the enumerated constants.""What's going on here? I can change my program to take this ""functionality"" into account, but I'd kind of like to know why .NET is doing what it's doing. <code>  public enum ELogLevel{ General = -1, // Should only be used in drop-down box in Merlinia Administrator log settings All = 0, // Should not be used as a level, only as a threshold, effectively same as Trace Trace = 1, Debug = 2, Info = 3, Warn = 4, Error = 5, Fatal = 6, Off = 7 // Should not be used as a level, only as a threshold}",Enum.GetNames() results in unexpected order with negative enum constants
where does value type inside a Class is stored?," Possible Duplicate: Fields of class, are they stored in the stack or heap? If I have and I'm doing: where is k stored? On the heap or the stack? And why? <code>  Class A{ int k=0;} A x = new A();",Where is value type inside a class is stored?
Is it possible to pass two objects into a contoller action with each mapped to a custom model binder?," Can I do something like this? Where I have the following in my global.asax.cs application_start UpdateSo, I tried to see what is wrong. Here is my new code. It seems that the problem is with this WizardViewModel and it's binder. What ""tells"" the application to expect and incoming Wizard model? Where I have the following in my global.asax.cs application_start Complete Binder Code <code>  [HttpPost]public ActionResult Index(WizardViewModel wizard, IStepViewModel step){ ModelBinders.Binders.Add(typeof(IStepViewModel), new StepViewModelBinder()); ModelBinders.Binders.Add(typeof(WizardViewModel), new WizardViewModelBinder()); [HttpPost]public ActionResult Index(WizardViewModel wizard){ ModelBinders.Binders.Add(typeof(WizardViewModel), new WizardViewModelBinder()); namespace Tangible.Binders{ public class StepViewModelBinder : DefaultModelBinder { protected override object CreateModel(ControllerContext controllerContext, ModelBindingContext bindingContext, Type modelType) { var stepTypeValue = bindingContext.ValueProvider.GetValue(""StepType""); var stepType = Type.GetType((string)stepTypeValue.ConvertTo(typeof(string)), true); var step = Activator.CreateInstance(stepType); bindingContext.ModelMetadata = ModelMetadataProviders.Current.GetMetadataForType(() => step, stepType); return step; } } public class WizardViewModelBinder : DefaultModelBinder { protected override object CreateModel(ControllerContext controllerContext, ModelBindingContext bindingContext, Type modelType) { var wizardValue = bindingContext.ValueProvider.GetValue(""wizard""); if (wizardValue != null) { var wizardType = Type.GetType((string)wizardValue.ConvertTo(typeof(string)), true); var wizard = Activator.CreateInstance(wizardType); bindingContext.ModelMetadata = ModelMetadataProviders.Current.GetMetadataForType(() => wizard, wizardType); return wizard; } else { var wizard = new Tangible.Models.WizardViewModel(); wizard.Initialize(); return wizard; } } }}",A created a new CustomModelBinder from one that already worked.  Why does the new one never get called to do any binding?
When to use Lazy<T> in C#," I found this article about Lazy: Laziness in C# 4.0 LazyWhat is the best practice to have best performance using Lazy objects?Can someone point me to a practical use in a real application? In other words, when should I use it? <code> ",When should I use Lazy<T>?
Using Autofac to inject log4net into contoller.," Trying to use Autofac to inject a log4net class into my controller, but I get the following exception: None of the constructors found with 'Public binding flags' on type 'MvcApplication6.Controllers.HomeController' can be invoked with the available services and parameters: Cannot resolve parameter 'log4net.ILog logger' of constructor 'Void .ctor(log4net.ILog)'.I have created a module to inject the Log class using the correct type: I then register the module within my ASP.NET MVC Application_Start method: I have added a constuctor to the controller which takes an ILog as a parameter: I am sure I have missed a step, so any help would be appreciated. <code>  public class LogInjectionModule : Module{ protected override void AttachToComponentRegistration(IComponentRegistry registry, IComponentRegistration registration) { registration.Preparing += OnComponentPreparing; } static void OnComponentPreparing(object sender, PreparingEventArgs e) { var t = e.Component.Activator.LimitType; e.Parameters = e.Parameters.Union(new[] { new ResolvedParameter((p, i) => p.ParameterType == typeof(ILog), (p, i) => LogManager.GetLogger(t)) }); }} protected void Application_Start(){ ContainerBuilder builder = new ContainerBuilder(); builder.RegisterControllers(typeof (MvcApplication).Assembly) ; var container = builder.Build() ; DependencyResolver.SetResolver(new AutofacDependencyResolver(container)); builder.RegisterModule(new LogInjectionModule()); AreaRegistration.RegisterAllAreas(); RegisterGlobalFilters(GlobalFilters.Filters); RegisterRoutes(RouteTable.Routes);} namespace MvcApplication6.Controllers{ public class HomeController : Controller { ILog _log; public HomeController(ILog logger) { _log = logger; } public ActionResult Index() { ViewBag.Message = ""Welcome to ASP.NET MVC!""; _log.Info(""Log message from Index()""); return View(); } public ActionResult About() { _log.Info(""Log message from About()""); return View(); } }}",Using Autofac to inject log4net into controller
Method cannot be translated into a store expression," I have a class method: and evaluating of an expression throw an exception: LINQ to Entities does not recognize the method 'System.Decimal GetPrice(System.Guid)' method, and this method cannot be translated into a store expression.I am using this very same code in other places and works just fine : Any idea how to solve it? <code>  public static class ProductExtensions { public static decimal GetPrice(this Product product, Guid rateId) { return product.Prices .Where(p => p.Rate.RateId == rateId) .Select(b => b.UnitPrice) .DefaultIfEmpty(product.UnitPrice) .First(); } } decimal? total = (from cartItems in storeDB.Carts where cartItems.CartId == shoppingCartId select (int?)cartItems.Count * cartItems.Product.GetPrice(store.RateId)) .Sum(); // Get the price for given rate decimal price = product.GetPrice(rate.RateId);",Method GetPrice() cannot be translated into a store expression
C# Load an assembly from an embedded resource," I would like to load a dll file (Test.dll) as an assembly. I am able to do this using both direct Visual Studio references (ie. loading the dll as a reference to my C# application) as well as loading the dll using the Assembly.LoadFile(filename) method. Now, I would like to add my dll file as an embedded resource to my Visual Studio application, and load the dll file as an assembly. I know how to load this resource as a byte array, is there some correlation between the byte array and the assembly that I could use? Furthermore, I need to be able to call a method located within the dll file. See the code below - it will further explain what I am doing. If I am missing anything here, please respectfully let me know and I will edit the original post.  <code>  Assembly SampleAssembly = Assembly.LoadFrom(""WindowsFormsApplication2.ThisisaTESTDLL.dll"");Type myType = SampleAssembly.GetTypes()[0];MethodInfo Method = myType.GetMethod(""myVoid"");object myInstance = Activator.CreateInstance(myType,null);Method.Invoke(myInstance,new object[] { ""param1"", ""param1""});",Load an assembly from an embedded resource
CQRS and primary key," For my project, which is a potentially big web site, I have chosen to separate the command interface from the query interface. As a result, submitting commands are one-way operations that don't return a result. This means that the client has to provide the key, for example: Obviously I can't use an int for the primary key, so a Guid is a logical choice - except that I read everywhere about the performance impact it has, which scares me :)But then I also read about COMB Guids, and how they provide the advantages of Guid's while still having a good performance. I also found an implementation here: Sequential GUID in Linq-to-Sql?.So before I take this important decision: does someone have experience with this matter, of advice?Thanks a lot!Lud <code>  service.SubmitCommand(new AddUserCommand() { UserId = key, ... });",CQRS and primary key: guid or not?
how to solve circular reference problem," How do you solve circular reference problems like Class A has class B as one of its properties, while Class B has Class A as one of its properties?How to do architect for those kind of problems?If you take an example of NHibernate, there will be a parent-child relationship between objects.How is it able to handle those parent child scenarios? <code> ",How to solve circular reference?
Why GetType returns System.Integer instead of Nullable<Int32>?, Why is the output of this snippet System.Int32 instead of Nullable<Int32>? <code>  int? x = 5;Console.WriteLine(x.GetType());,Why GetType returns System.Int32 instead of Nullable<Int32>?
How to cause XmlSerialize to generate attributes instead of elements by default," Is there a way to cause XmlSerializer to serialize primitive class members (e.g. string properties) as XML attributes, not as XML elements, without having to write [XmlAttribute] in front of each property declaration?I.e. is there a global switch that tells XmlSerializer to serialize all primitive class members as XML attributes?Assume that we have the following class: Then XmlSerializer generates this code by default: What I want, however, is this code: Again: I want to do that without [XmlAttribute] (or without XmlAttributeOverrides, which would be even more work).One possible solution would be to use a generic postprocessing step that applies an XSLT transform to convert elements to attributes. But I wonder whether there is a simpler solution. <code>  public class Person{ public string FirstName { ... } public string LastName { ... }} <Person> <FirstName>John</FirstName> <LastName>Doe</LastName></Person> <Person FirstName=""John"" LastName=""Doe""/>",How to cause XmlSerializer to generate attributes instead of elements by default
Discover new MEF parts dinamically," I'm using MEF to load plugins in my app. Everything works, but I want new parts to be discovered when they are dropped into my app folder. Is this possible? DirectoryCatalog has a Changed event but I'm not sure how it works.This is my code right now: <code>  public sealed class RevealerFactory{ private static readonly Lazy<RevealerFactory> lazy = new Lazy<RevealerFactory>(() => new RevealerFactory()); public static RevealerFactory Instance { get { return lazy.Value; } } private FileSystemWatcher watcher; private RevealerFactory() { Initialize(); } [ImportMany(RequiredCreationPolicy = CreationPolicy.Shared)] private IEnumerable<Lazy<IRevealer, IRevealerCapabilities>> Revealers { get; set; } public IRevealer GetRevealer(Uri uri) { return (from revealer in Revealers where uri.Host.Equals(revealer.Metadata.Host, StringComparison.OrdinalIgnoreCase) && revealer.Value.IsRevelable(uri) select revealer.Value).FirstOrDefault(); } private void Initialize() { var catalog = new DirectoryCatalog( Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + ""/SDownloader/Revealers""); var container = new CompositionContainer(catalog); container.ComposeParts(this); }}",How to discover new MEF parts while the application is running?
How do I discover new MEF parts dynamically?," I'm using MEF to load plugins in my app. Everything works, but I want new parts to be discovered when they are dropped into my app folder. Is this possible? DirectoryCatalog has a Changed event but I'm not sure how it works.This is my code right now: <code>  public sealed class RevealerFactory{ private static readonly Lazy<RevealerFactory> lazy = new Lazy<RevealerFactory>(() => new RevealerFactory()); public static RevealerFactory Instance { get { return lazy.Value; } } private FileSystemWatcher watcher; private RevealerFactory() { Initialize(); } [ImportMany(RequiredCreationPolicy = CreationPolicy.Shared)] private IEnumerable<Lazy<IRevealer, IRevealerCapabilities>> Revealers { get; set; } public IRevealer GetRevealer(Uri uri) { return (from revealer in Revealers where uri.Host.Equals(revealer.Metadata.Host, StringComparison.OrdinalIgnoreCase) && revealer.Value.IsRevelable(uri) select revealer.Value).FirstOrDefault(); } private void Initialize() { var catalog = new DirectoryCatalog( Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + ""/SDownloader/Revealers""); var container = new CompositionContainer(catalog); container.ComposeParts(this); }}",How to discover new MEF parts while the application is running?
How to discover new MEF parts dynamically?," I'm using MEF to load plugins in my app. Everything works, but I want new parts to be discovered when they are dropped into my app folder. Is this possible? DirectoryCatalog has a Changed event but I'm not sure how it works.This is my code right now: <code>  public sealed class RevealerFactory{ private static readonly Lazy<RevealerFactory> lazy = new Lazy<RevealerFactory>(() => new RevealerFactory()); public static RevealerFactory Instance { get { return lazy.Value; } } private FileSystemWatcher watcher; private RevealerFactory() { Initialize(); } [ImportMany(RequiredCreationPolicy = CreationPolicy.Shared)] private IEnumerable<Lazy<IRevealer, IRevealerCapabilities>> Revealers { get; set; } public IRevealer GetRevealer(Uri uri) { return (from revealer in Revealers where uri.Host.Equals(revealer.Metadata.Host, StringComparison.OrdinalIgnoreCase) && revealer.Value.IsRevelable(uri) select revealer.Value).FirstOrDefault(); } private void Initialize() { var catalog = new DirectoryCatalog( Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + ""/SDownloader/Revealers""); var container = new CompositionContainer(catalog); container.ComposeParts(this); }}",How to discover new MEF parts while the application is running?
Exchange two values by one sentence: a=b+(b=a)*0;," This sentence can swap the value between a and b.I've tried it with C# and it works.But I just don't konw how it works.e.g.a = 1, b = 2I list the steps of it as below: But the value of b may be wrong.Could anyone help me? It puzzles me a lot. <code>  a=b+(b=a)*0; b = a -> a = 1, b = 1b * 0 -> a = 1, b = 1b + 0 -> a = 1, b = 1a = b -> a = 1, b = 1 ?",Swap trick: a=b+(b=a)*0;
Accessing active directory from C#," On the SearchResultCollection results = ds.FindAll(); line I get an exception: A referral was returned from the serverWhy do I get that exception and what does it mean? <code>  DirectoryEntry oDE = new DirectoryEntry(""LDAP://DC=Test1,DC=Test2,DC=gov,DC=lk"");using (DirectorySearcher ds = new DirectorySearcher(oDE)){ ds.PropertiesToLoad.Add(""name""); ds.PropertiesToLoad.Add(""userPrincipalName""); ds.Filter = ""(&(objectClass=user))""; SearchResultCollection results = ds.FindAll(); foreach (SearchResult result in results) { Console.WriteLine(""{0} - {1}"", result.Properties[""name""][0].ToString(), result.Properties[""userPrincipalName""][0].ToString()); }}","""A referral was returned from the server"" exception when accessing AD from C#"
C# - Keep trying to talk to server when the Internet is down," So my application is exchanging request/responses with a server (no problems), until the internet connection dies for a couple of seconds, then comes back. Then a code like this:response = (HttpWebResponse)request.GetResponse();will throw an exception, with a status like ReceiveFailure, ConnectFailure, KeepAliveFailure etc.Now, it's quite important that if the internet connection comes back, I am able to continue communicating with the server, otherwise I'd have to start again from the beginning and that will take a long time.How would you go about resuming this communication when the internet is back? At the moment, I keep on checking for a possibility to communicate with the server, until it is possible (at least theoretically). My code attempt looks like this: However, the problem is that the second try-catch statement keeps throwing an exception even when the internet is back.What am I doing wrong? Is there another way to go about fixing this?Thanks! <code>  try{ response = (HttpWebResponse)request.GetResponse();}catch (WebException ex){ // We have a problem receiving stuff from the server. // We'll keep on trying for a while if (ex.Status == WebExceptionStatus.ReceiveFailure || ex.Status == WebExceptionStatus.ConnectFailure || ex.Status == WebExceptionStatus.KeepAliveFailure) { bool stillNoInternet = true; // keep trying to talk to the server while (stillNoInternet) { try { response = (HttpWebResponse)request.GetResponse(); stillNoInternet = false; } catch { stillNoInternet = true; } } }}",Keep trying to talk to server when the Internet is down
Can I use strings in finalizer method?," I have a class that should delete some file when disposed or finalized. Inside finalizers I can't use other objects because they could have been garbage-collected already.Am I missing some point regarding finalizers and strings could be used?UPD: Something like that: <code>  public class TempFileStream : FileStream{ private string _filename; public TempFileStream(string filename) :base(filename, FileMode.Open, FileAccess.Read, FileShare.Read) { _filename = filename; } protected override void Dispose(bool disposing) { base.Dispose(disposing); if (_filename == null) return; try { File.Delete(_filename); // <-- oops! _filename could be gc-ed already _filename = null; } catch (Exception e) { ... } }}",Which objects can I use in a finalizer method?
.NET Stopwatch - Performance Penalty," Possible Duplicates: Is DateTime.Now the best way to measure a function's performance? Stopwatch vs. using System.DateTime.Now for timing events I have code which needs to run as fast as possible. To be able to log the execution time, I use the Stopwatch class. I suspect, Stopwatch may effect the performance in a bad way. Maybe using a DateTime difference may be more effective?Which one do you think has better performance? OR <code>  Stopwatch sw = new Stopwatch();sw.Start();int a = 5;// Critical lines of codelong elapsedMs = se.Elapsed.TotalMilliseconds; DateTime startDate = DateTime.Now;int a = 5;// Critical lines of codelong elapsedMs = DateTime.Now.Subtract(startDate).TotalMilleseconds;",.NET Stopwatch - performance penalty
Cannot access a disposed object. C#," I have a countdown Timer form - on the first form the user will enter the countdown time - warning times, end message, etc. There are also two Radio buttons (Max/Min) and depending on which is selected they will open a new Max or Min form where the time will actually start to countdown. It is working fine and counting down as I expect. However, if I exit the Max or Min form and try to run again with new times I get the error. The code is below - note the comment out ShowDialog(this); was something I tried - it let me close and open the new forms ok but it did not actually start the countdown. UpdateLabels is the function that does the updating of Labels. I also tried the following which I read online as a possible solution but it also did not work... Can anyone help me out - I can post the UpdateLabels function if needed. I am pretty new to UI C# development so any help would be great. Thanks. <code>  bool Max = rbMax.Checked; if (Max == true) { //_Max.ShowDialog(this); _Max.Show(); } else //_Min.ShowDialog(this); _Min.Show(); UpdateLabels(); } private void Max_FormClosing(object sender, FormClosingEventArgs e) { this.Hide(); this.Parent = null; }",Cannot access a disposed object?
"asp .net , how to change CurrentCulture at runtime?"," I need to change cultures at runtime according to resource files for each culture.I need to change the attributes of the controls in my form, according to two cultures which have designated .resx files I can load the page either with the fallback resource, or on pageload give the UICulture = ""he-IL"" value and it loads fine with the wanted resources. The problem is I need to make these changes at runtime.1.. after I change the value on a button click event It still returns to the initialized value of ""en-US"" How can I commit a change to the UICulture at runtime ?2.. how can i reference the fallback resource file if for instance i don't know it's ""en-US"" ? <code>  resorces1.aspx.resx // default resorces1.aspx.he-IL.resx // hebrew culture btn_change_Click(....) { UICulture = ""he-IL"" ; }",How to change CurrentCulture at runtime?
how convert NameValueCollection to JSON string?," I tried: it returns: [""foo""] I expected {""foo"" : ""baa""} How do I to do this? <code>  NameValueCollection Data = new NameValueCollection(); Data.Add(""foo"",""baa""); string json = new JavaScriptSerializer().Serialize(Data);",how to convert NameValueCollection to JSON string?
How to remove leading Zeros," How to remove leading zeros in strings using C#?For example in the following numbers, I would like to remove all the leading zeros. <code>  0001234000000123400001234",How to remove leading zeros using C#
How to remove leading zeros," How to remove leading zeros in strings using C#?For example in the following numbers, I would like to remove all the leading zeros. <code>  0001234000000123400001234",How to remove leading zeros using C#
C# Dictionary containing with only Serializable objects," I am looking for a way to ensure that only serializable objects are stored into a Dictionary in C#.To be more specific I'm looking to do something similar to this: The problem with this is that I cannot store primitive types like integers, booleans, or strings.Is there a way to ensure that my Dictionary contains only objects which can be serialized? <code>  Dictionary<String, ISerializable> serialDict = new Dictionary<String, ISerializable>();",Dictionary containing with only Serializable objects
How to embed multiple images in email body using C# .NET," I'm writing a program that sends emails to users with multiple images (charts) embedded in the Email message body (HTML).When I tried the sample located here..which worked well when I have to embed only one imagehttp://www.systemnetmail.com/faq/4.4.aspx.But, when i tried to embed multiple images using the below code, none of the images are being embedded , instead they are sent as attachments. Any clues as what I'm missing?I checked the .htm file which is also sent as attachment with the email, and html source looks as follows: So the Q is how to send multiple images in the html body , not as attachment. <code>  public MailMessage MailMessage(Metric metric, DateTime date){ MailMessage msg = new MailMessage(); msg.From = new MailAddress(""test@gmail.com"", ""User1""); msg.To.Add(new MailAddress(""test@gmail.com"")); msg.Subject = ""Trend for metric: "" + metric.Name; msg.IsBodyHtml = true; // Generate the charts for the given metric var charts = this.GenerateCharts(metric, date); int i = 0; string htmlBody = ""<html><body>""; List<LinkedResource> resources = new List<LinkedResource>(); foreach (var chart in charts) { string imageTag = string.Format(""<img src=cid:chart{0} /><br>"", i); htmlBody += imageTag; LinkedResource graph = new LinkedResource(chart.Value, ""image/jpeg""); graph.ContentId = ""chart"" + i; resources.Add(graph); i++; } htmlBody += ""</body></html>""; // Alternate view for embedded images AlternateView avText = AlternateView.CreateAlternateViewFromString(metric.Name, null, MediaTypeNames.Text.Html); AlternateView avImages = AlternateView.CreateAlternateViewFromString(htmlBody, null, MediaTypeNames.Text.Html); // Add all the images as linked resources resources.ForEach(x => avImages.LinkedResources.Add(x)); // Add the views for image msg.AlternateViews.Add(avText); msg.AlternateViews.Add(avImages); return msg;} <html>><body><img src=cid:chart0 /><br><img src=cid:chart1 /><br><img src=cid:chart2/><br><img src=cid:chart3 /><br><img src=cid:chart4 /><br></body></html>",How to embed multiple images in email body using .NET
C# - Calculating all addresses within a subnet...for IPv6," I have seen plenty of great C# examples which demonstrate how to convert IPv4 addresses provided in CIDR notation (e.g. 192.168.0.1/25) into their relevant ranges (192.168.0.1 - 192.168.0.126). My program needs to be able to do this (to compute all the addresses within my local subnet) but I want to also support IPv6.If my C# program has all of my typical ipconfig information (IPv4 address, subnet mask, IPv6 address, link-local v6 address, default gateway) - how would I go about generating a list of all of the IPv6 addresses in my local subnet and outputting them to the console? <code> ",Calculating all addresses within a subnet...for IPv6
How to view the last 10 DataPoints in a chart that's updating each seccond?," I have this code: This part of my code is the timer's tick event where i draw a chart and i need to update it every tick.I keep adding points and when the points count reaches MAX_POINTS(10) it removes the first point and adds a new one at the end. The problem is when it reaches MAX_POINTS it starts removing points at the end and the graph doesn't autoscroll. All points get deleted and no new points get added.Please help me and say what I need to change the chart to work as I said.EDIT 1: I am using Windows Forms.EDIT 2: AddXY and RemoveAt are not mine they are from the points collection.EDIT 3: I also want to know how to have a 'scope' and see the data for the last hour or for the last week or for the last month.EDIT 4: I changed my question a bit, I now want to scale the chart to show the points from the last hour/day <code>  private void timer_Tick(object sender, EventArgs e) { timer.Stop(); for (int i = 0; i < TOTAL_SENSORS; i++) { DateTime d = DateTime.Now; devices[i].Value = float.Parse(serialPort.ReadLine()); if (chart1.Series[i].Points.Count > MAX_POINTS) { //see the most recent points } chart1.Series[i].Points.AddXY(d, devices[i].Value); } timer.Start(); }",How to view the last 10 DataPoints in a chart that's updating each second?
are C# events synchronous?," There are two parts to this question:Does raising an event block the thread, or does it start execution of EventHandlers asynchronously and the thread goes continues on at the same time?Are the individual EventHandlers (subscribed to the event) run synchronously one after another, or are they run asynchronously with no guarantee that others aren't running at the same time? <code> ",Are C# events synchronous?
.net error handling," I have been writing .NET applications and have been impressed with the error handling included in the framework.When catching an error that has been throw by the processes or somewhere in the code I like to include the message (ex.Message, which is usually pretty general) but also the stacktrace (ex.stacktrace) which helps to trace the problem back to a specific spot.For a simple example let's say for instance that we are recording numbers to a log in a method: Is there any way to see the method called (in this case ExampleMethod) with the specific number that was passed that potentially crashed the method call? I believe you could log this perhaps in the catch block but I am interested essentially in catching the method call and parameters that caused the system to throw the exception.Any ideas? <code>  public void ExampleMethod(int number){ try{ int num = number ...open connection to file ...write number to file } catch(Exception ex){ .... deal with exception (ex.message,ex.stacktrace etc...) } finally{ ...close file connection }}",.NET error handling
Inharitence problem in C#," I'm refactoring some code and want to classes a bit higher in the inheritance chain be a bit more strict with their parameters. As I'm not sure I'm explaining this correctly, here's what I've got: ISvdPredictor uses ISvdModel: Now I want to implement another variation: Which uses IBiasSvdModel which derives from ISvdModel: IBiasSvdPredictor will not work with ISvdModel.The problem is that when I implement IBiasSvdPredictor I'd have to implement 2 pairs of PredictRating methods. One from ISvdPredictor and the other from IBiasSvdPredictor. What do I need to do to be able to just implement those from IBiasSvdPredictor?I've tried generics as well, but couldn't restrict the PredictRating for BiasSvdPredictor to IBiasSvdModel using the where directive. I may be doing this all wrong so any suggestion might help. I think you get what I'm trying to do.EDIT: If anyone needs more context see https://github.com/gligoran/RecommendationSystem. I'm writing this code for my thesis for BSc. <code>  public interface ISvdPredictor{ List<string> Users { get; set; } List<string> Artists { get; set; } float PredictRating(ISvdModel model, string user, string artist); float PredictRating(ISvdModel model, int userIndex, int artistIndex);} public interface ISvdModel{ float[,] UserFeatures { get; set; } float[,] ArtistFeatures { get; set; }} public interface IBiasSvdPredictor : ISvdPredictor{ float PredictRating(IBiasSvdModel model, string user, string artist); float PredictRating(IBiasSvdModel model, int userIndex, int artistIndex);} public interface IBiasSvdModel : ISvdModel{ float GlobalAverage { get; set; } float[] UserBias { get; set; } float[] ArtistBias { get; set; }}",Inheritance problem in C#
Inheritence problem in C#," I'm refactoring some code and want to classes a bit higher in the inheritance chain be a bit more strict with their parameters. As I'm not sure I'm explaining this correctly, here's what I've got: ISvdPredictor uses ISvdModel: Now I want to implement another variation: Which uses IBiasSvdModel which derives from ISvdModel: IBiasSvdPredictor will not work with ISvdModel.The problem is that when I implement IBiasSvdPredictor I'd have to implement 2 pairs of PredictRating methods. One from ISvdPredictor and the other from IBiasSvdPredictor. What do I need to do to be able to just implement those from IBiasSvdPredictor?I've tried generics as well, but couldn't restrict the PredictRating for BiasSvdPredictor to IBiasSvdModel using the where directive. I may be doing this all wrong so any suggestion might help. I think you get what I'm trying to do.EDIT: If anyone needs more context see https://github.com/gligoran/RecommendationSystem. I'm writing this code for my thesis for BSc. <code>  public interface ISvdPredictor{ List<string> Users { get; set; } List<string> Artists { get; set; } float PredictRating(ISvdModel model, string user, string artist); float PredictRating(ISvdModel model, int userIndex, int artistIndex);} public interface ISvdModel{ float[,] UserFeatures { get; set; } float[,] ArtistFeatures { get; set; }} public interface IBiasSvdPredictor : ISvdPredictor{ float PredictRating(IBiasSvdModel model, string user, string artist); float PredictRating(IBiasSvdModel model, int userIndex, int artistIndex);} public interface IBiasSvdModel : ISvdModel{ float GlobalAverage { get; set; } float[] UserBias { get; set; } float[] ArtistBias { get; set; }}",Inheritance problem in C#
how to get single value by using entity frameowrk," I have a and i am populating these product details using datagridview that working fine and i need to get the categoryname for selected row in datagridview for that i have done like this.... got an what i need to do to get the single category name for selected cell in productgridview productnam column any suggestions.. pls ..many thanks.... Modified Code: got an error : <code>  table product with colums product_id prodcut_name category_id another table category category_id category_name private void productGridview_Cellclick(object sender, DataGridViewCellEventArgs e) { string productname = Convert.ToString(selectedRow.Cells[""productnam""].Value); var categoryids = from cats in abc.products where cats.product_Name.Equals(productname) select cats.category_Id; var catogynames = from categorytypes in abc.categories where categorytypes.category_Name.Equals(categoryids) select categorytypes.category_Name; string categorynames = catogynames; } error : cannot implicitly convert type sysytem.linq.iqueryble<string> to string ... not supported exception:Unable to create a constant value of type 'System.Object'. Only primitive types ('such as Int32, String, and Guid') are supported in this context.",how to get single value by using entity framework
C# + high resolution timer," I want to have a timer with about 5millisecond resolution. but the current Timer in .Net has a resolution of about 50ms. I could not find any working solution that creates a high resolution timer, although some claim that you can do it in C#. <code> ",High resolution timer
WDetermining an msi version from the file itself, I have an MSI file built from my C# Visual Studio 2010. The version is set through the Version property. I wanted to know if there is a way to determine the version without having to install the file. Currently when right click and view the properties it isn't displayed.  <code> ,Determining the version of an MSI without installing it
c# Response.Redirect does not redirect to the external URL," Context: User is currently in the following page: http://myinternaldomain.com/page/Issue:When user clicks on a button in the above page, the MVC Controller method that handles this click should do some processing and redirect the user to an external domain say google.com. I tried the 2 statements below separately but both calls append the external url to the current internal page that the user is on: Both of the above statements result in user getting redirected to: http://myinternaldomain.com/page/www.google.cominstead of just redirecting the user to www.google.com.What am I missing here? <code>  System.Web.HttpContext.Current.Response.Redirect(""www.google.com""); // plain old HttpResponse objectreturn Controller.Response.Redirect(""www.google.com""); // MVC Controller's response object",Why does Response.Redirect not redirect external URL?
Problem with typed dataset nullable date value," I have a datatable in a typed dataset with a date columnWhen I change the NullValue property to return null or empty , vs 2008 wont let me.it says The value entered is not valid for the current data type.I need to be able to set null values por this column. <code> ",Have issue with typed dataset nullable date value
C# - does passing Reference Types using ref save memory?," In C#, the parameters to a method can be either reference types or value types. When passing reference types, a copy of the reference is passed. This way, if inside a method we try to reassign the passed reference to another object instance, outside of the method the reassignment is not visible.To make this working, C# has the ref modifier. Passing a reference type with ref actually uses the original reference instead of a copy. (Correct me if I'm wrong).In this case, since we are not creating a copy of the reference, are we saving any memory? If a method is extensively called, does this improve the overall performance of the application?Thanks! <code> ",Does passing Reference Types using ref save memory?
"CRM 2011 - Assign new owner to appointment. ""There should be only one owner party for an activity"""," I need to change the owner of an appointment record when creating a new appointment. I'm using a plugin for the create message and i've found this code to assign a new owner to the appointment: But when I test this i get the following error: Invalid Argument: There should be only one owner party for an activityI guess i have to remove the current owner first and then assign the new owner. But how can i do this?Thanks for any help! <code>  entity = context.PostEntityImages[""PostImage""];......AssignRequest request = new AssignRequest();//request.RequestNamerequest.Assignee = new EntityReference(""systemuser"", owners.ToList()[0].Id);request.Target = new EntityReference(Appointment.EntityLogicalName, entity.Id);service.Execute(request);","Assign new owner to appointment. ""There should be only one owner party for an activity"""
cannot convert string to Guid in C#.NET," Why would the cast (to a System.Guid type) statement be invalid (second line in try block)?For example, suppose I have a string with a value of ""5DD52908-34FF-44F8-99B9-0038AFEFDB81"". I'd like to convert that to a GUID. Is that not possible? <code>  Guid ownerIdGuid = Guid.Empty; try { string ownerId = CallContextData.Current.Principal.Identity.UserId.ToString(); ownerIdGuid = (Guid)ownerId; } catch { // Implement catch }",Cannot convert string to GUID in C#.NET
"Fingerprint System (C#): ""Exception of type 'System.Windows.Forms.AxHost+InvalidActiveXStateException' was thrown"""," I am getting an error in my simple project.This is my code: I already added reference composites AxInterop.ZKFPEngXControl and Interop.ZKFPEngXControl.While debugging, I click the button, and a warning appears:InvalidActiveXStateException was handled.""Exception of type 'System.Windows.Forms.AxHost+InvalidActiveXStateException' was thrown""** <code>  if (axZKFPEngX1.InitEngine() == 0) { label1.Text = ""Connected"";}else { label1.Text = ""Connection Failed"";}",Exception of type 'System.Windows.Forms.AxHost+InvalidActiveXStateException' was thrown
Fluent NHibernate issue," Update: I have fixed this issueI have the following block of code which should ultimately update a record which errors on Session.Evict(entity) with a KeyNotFoundException, and the following message: The given key was not present in the dictionary.Am I misunderstanding something? I assume if session.Contains(entity) is true, then the key should exist and therefore session.Evict() should work as expected?Stack trace is as follows: <code>  if (session.Contains(entity)){ session.Evict(entity);} System.Collections.Generic.KeyNotFoundException : The given key was not present in the dictionary.at System.Collections.Generic.Dictionary`2.get_Item(TKey key)at NHibernate.Engine.StatefulPersistenceContext.RemoveEntity(EntityKey key)at NHibernate.Event.Default.DefaultEvictEventListener.OnEvict(EvictEvent event)at NHibernate.Impl.SessionImpl.FireEvict(EvictEvent evictEvent)at NHibernate.Impl.SessionImpl.Evict(Object obj)at Core.Repository.NHibernate.Repository.NoIdRepository`1.Update(T entity) in NoIdRepository.cs: line 26at Core.Tests.Repository.NHibernate.Repository.TestInstanceVersionRepository.Test_Saving_Data() in TestInstanceVersionRepository.cs: line 63 ",NHibernate - KeyNotFoundException: The given key was not present in the dictionary
NHibernate issue," Update: I have fixed this issueI have the following block of code which should ultimately update a record which errors on Session.Evict(entity) with a KeyNotFoundException, and the following message: The given key was not present in the dictionary.Am I misunderstanding something? I assume if session.Contains(entity) is true, then the key should exist and therefore session.Evict() should work as expected?Stack trace is as follows: <code>  if (session.Contains(entity)){ session.Evict(entity);} System.Collections.Generic.KeyNotFoundException : The given key was not present in the dictionary.at System.Collections.Generic.Dictionary`2.get_Item(TKey key)at NHibernate.Engine.StatefulPersistenceContext.RemoveEntity(EntityKey key)at NHibernate.Event.Default.DefaultEvictEventListener.OnEvict(EvictEvent event)at NHibernate.Impl.SessionImpl.FireEvict(EvictEvent evictEvent)at NHibernate.Impl.SessionImpl.Evict(Object obj)at Core.Repository.NHibernate.Repository.NoIdRepository`1.Update(T entity) in NoIdRepository.cs: line 26at Core.Tests.Repository.NHibernate.Repository.TestInstanceVersionRepository.Test_Saving_Data() in TestInstanceVersionRepository.cs: line 63 ",NHibernate - KeyNotFoundException: The given key was not present in the dictionary
/#if Not Debug in c#?," I have the line in vb code: which I must convert, and I don't see it in c#? Is there something equivalent to it, or is there some workaround? <code>  #if Not Debug",#if Not Debug in c#?
Bestpractices: Ways of keeping configuration code out of logic code using Dependency Injection," How can keep all the configuration file code out of my logic code using Settings (ApplicationSettingsBase) and Dependency Injection?With configuration I mean a customer specific configuration file.Do I really have to inject a configuration class everytime I need it or is there another pattern?It would be great to get some sample code!Samples:Static Configuration: Non static Configuration: Static Context with non static configuration: <code>  public static class StaticConfiguration{ public static bool ShouldApplySpecialLogic { get; set; } public static string SupportedFileMask { get; set; }}public class ConsumerOfStaticConfiguration{ public void Process() { if (StaticConfiguration.ShouldApplySpecialLogic) { var strings = StaticConfiguration.SupportedFileMask.Split(','); foreach (var @string in strings) { } } }} public interface IConfiguration{ bool ShouldApplySpecialLogic { get; set; } string SupportedFileMask { get; set; }}public class Configuration : IConfiguration{ public bool ShouldApplySpecialLogic { get; set; } public string SupportedFileMask { get; set; }}public class Consumer{ private readonly IConfiguration _configuration; public Consumer(IConfiguration configuration) { _configuration = configuration; } public void Process() { if (_configuration.ShouldApplySpecialLogic) { var strings = _configuration.SupportedFileMask.Split(','); foreach (var @string in strings) { } } }} public static class Context{ public static IConfiguration Configuration { get; set; }}public class ConsumerOfStaticContext{ public void Process() { if (Context.Configuration.ShouldApplySpecialLogic) { var strings = Context.Configuration.SupportedFileMask.Split(','); foreach (var @string in strings) { } } }}",Ways of keeping configuration code out of logic code using Dependency Injection
Ways of keeping configuration code out of logic code using Dependency Injection," How can keep all the configuration file code out of my logic code using Settings (ApplicationSettingsBase) and Dependency Injection?With configuration I mean a customer specific configuration file.Do I really have to inject a configuration class everytime I need it or is there another pattern?It would be great to get some sample code!Samples:Static Configuration: Non static Configuration: Static Context with non static configuration: <code>  public static class StaticConfiguration{ public static bool ShouldApplySpecialLogic { get; set; } public static string SupportedFileMask { get; set; }}public class ConsumerOfStaticConfiguration{ public void Process() { if (StaticConfiguration.ShouldApplySpecialLogic) { var strings = StaticConfiguration.SupportedFileMask.Split(','); foreach (var @string in strings) { } } }} public interface IConfiguration{ bool ShouldApplySpecialLogic { get; set; } string SupportedFileMask { get; set; }}public class Configuration : IConfiguration{ public bool ShouldApplySpecialLogic { get; set; } public string SupportedFileMask { get; set; }}public class Consumer{ private readonly IConfiguration _configuration; public Consumer(IConfiguration configuration) { _configuration = configuration; } public void Process() { if (_configuration.ShouldApplySpecialLogic) { var strings = _configuration.SupportedFileMask.Split(','); foreach (var @string in strings) { } } }} public static class Context{ public static IConfiguration Configuration { get; set; }}public class ConsumerOfStaticContext{ public void Process() { if (Context.Configuration.ShouldApplySpecialLogic) { var strings = Context.Configuration.SupportedFileMask.Split(','); foreach (var @string in strings) { } } }}",Ways of keeping configuration code out of logic code using Dependency Injection
"""No imaging component suitable to complete this operation was found."" in C#"," I have programmed an application that it needs to download *.png files and set it into the background of the button in WPF. So, when i run this program, it faces the Error as No imaging component suitable to complete this operation was found."" My code is as below : First application downloads the file with WebClient class's object: and when download completed event occurred: NOTEBecause of run these blocks of codes in BackgroundWorker, I use Dispatcher to set button Background propertySo, when i run the program, System.NotSupportedException occurred as below : Exception from HRESULT: 0x88982F50 Error Code : -2003292336 Message : No imaging component suitable to complete this operation was found. Source : PresentationCore Stack Trace : at System.Windows.Media.Imaging.BitmapDecoder.SetupDecoderFromUriOrStream(Uri uri, Stream stream, BitmapCacheOption cacheOption, Guid& clsId, Boolean& isOriginalWritable, Stream& uriStream, UnmanagedMemoryStream& unmanagedMemoryStream, SafeFileHandle& safeFilehandle) at System.Windows.Media.Imaging.BitmapDecoder.CreateFromUriOrStream(Uri baseUri, Uri uri, Stream stream, BitmapCreateOptions createOptions, BitmapCacheOption cacheOption, RequestCachePolicy uriCachePolicy, Boolean insertInDecoderCache) at System.Windows.Media.Imaging.BitmapImage.FinalizeCreation() at System.Windows.Media.Imaging.BitmapSource.CompleteDelayedCreation() at System.Windows.Media.Imaging.BitmapSource.get_WicSourceHandle() at System.Windows.Media.Imaging.BitmapSource.get_DUCECompatiblePtr() at System.Windows.Media.Imaging.BitmapSource.UpdateBitmapSourceResource(Channel channel, Boolean skipOnChannelCheck) at System.Windows.Media.Imaging.BitmapSource.AddRefOnChannelCore(Channel channel) at System.Windows.Media.Imaging.BitmapSource.System.Windows.Media.Composition.DUCE.IResource.AddRefOnChannel(Channel channel) at System.Windows.Media.ImageBrush.AddRefOnChannelCore(Channel channel) at System.Windows.Media.Brush.System.Windows.Media.Composition.DUCE.IResource.AddRefOnChannel(Channel channel) at System.Windows.Media.RenderData.System.Windows.Media.Composition.DUCE.IResource.AddRefOnChannel(Channel channel) at System.Windows.UIElement.RenderContent(RenderContext ctx, Boolean isOnChannel) at System.Windows.Media.Visual.UpdateContent(RenderContext ctx, VisualProxyFlags flags, Boolean isOnChannel) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle) at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx) at System.Windows.Media.Visual.Render(RenderContext ctx, UInt32 childIndex) at System.Windows.Media.CompositionTarget.Compile(Channel channel) at System.Windows.Media.CompositionTarget.System.Windows.Media.ICompositionTarget.Render(Boolean inResize, Channel channel) at System.Windows.Media.MediaContext.Render(ICompositionTarget resizedCompositionTarget) at System.Windows.Media.MediaContext.RenderMessageHandlerCore(Object resizedCompositionTarget) at System.Windows.Media.MediaContext.RenderMessageHandler(Object resizedCompositionTarget) at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs) at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler) at System.Windows.Threading.DispatcherOperation.InvokeImpl() at System.Threading.ExecutionContext.runTryCode(Object userData) at System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state) at System.Windows.Threading.DispatcherOperation.Invoke() at System.Windows.Threading.Dispatcher.ProcessQueue() at System.Windows.Threading.Dispatcher.WndProcHook(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled) at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled) at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o) at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs) at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler) at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Int32 numArgs) at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam) at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG& msg) at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame) at System.Windows.Application.RunDispatcher(Object ignore) at System.Windows.Application.RunInternal(Window window) at WPF_KSMMessenger.App.Main() in C:\Users\Hossein\Desktop\WPF_KSMMessenger\WPF_KSMMessenger\obj\x86\Debug\App.g.cs:line 0 at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args) at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly() at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state) at System.Threading.ThreadHelper.ThreadStart()What should I do to solve this problem?Thanks for your attention. <code>  System.Net.WebClient wClient = new System.Net.WebClient();Uri downloadUri = new Uri(MyUri, UriKind.Absolute);wClient.DownloadFileAsync(downloadUri, ""MyImage.png"");wClient.DownloadFileCompleted += new System.ComponentModel.AsyncCompletedEventHandler(wClient_DownloadFileCompleted); ImageBtn.Dispatcher.Invoke(new Action(() =>{ ImageBrush ib = new ImageBrush(); BitmapImage bi = new BitmapImage(); bi.BeginInit(); bi.UriSource = new Uri(""MyImage.png"", UriKind.Relative); bi.EndInit(); ib.ImageSource = bi; ImageBtn.Background = ib;}","""No imaging component suitable to complete this operation was found."""
Difference Between Extension Method and Member Method?," Consider this code: Will the above throw NullReferenceException?The answer is : it depends on what f() is. If it's a member method, then yes, it will throw exception. If it's an extension method, then no, it will not throw any extension.This difference leads to a question: how each type of method is implemeneted and viewed by C# compilers? Also, why member method must throw exception even if it doesn't access any member data? It seems that C# compiler makes an assumption in advance that member method will access member data, and so it throws exception if the object is null, as using null object member data cannot be accessed. However, in case of extension method, it postpones this decision till it actually attempts to access member data using null reference, only then it throws exception.How far my understanding is correct? And if that is so, why this difference?Yes, I know that if f() is an extension method, then a.f() is equivalent to writing AExt.f(a), so the latter shouldn't throw exception until a is used to access member. But my focus is mostly on the compiler implementations (which can implement even member methods in the same way). <code>  A a = null; a.f(); //Will it throw NullReferenceException?",Extension Method and Member Method :  why each is implemented differently by compilers (internally)?
Why is list when passed without ref to a function acting like passed with ref? (C#)," If I did not get this terribly wrong, this behaviour is strange for me. Rather than explaining, I'll post a sample code below and please tell me why does I get output x and not y. Output should, I assume would be 3. But I get the output as 5. I understand the output can be 5 if I do this: <code>  private void button1_Click(object sender, EventArgs e) { List<int> l = new List<int>() { 1, 2, 3 }; Fuss(l); MessageBox.Show(l.Count.ToString()); } private void Fuss(List<int> l) { l.Add(4); l.Add(5); } private void button1_Click(object sender, EventArgs e) { List<int> l = new List<int>() { 1, 2, 3 }; Fuss(ref l); MessageBox.Show(l.Count.ToString()); } private void Fuss(ref List<int> l) { l.Add(4); l.Add(5); }",Why is list when passed without ref to a function acting like passed with ref?
Why can't I use the array initiliazer with an implicitly typed variable?," Why can't I use the array initializer with an implicitly typed variable? Is there a technical reason for this limitation? Why can't it infer the type like it would for: The compiler clearly knows what I am trying to do, it just won't allow it: CS0820: Cannot assign array initializer to an implicitly typed localUpdate: I compiled a program using the four legal array declaration methods, and it generates the same IL: http://pastebin.com/28JDAFbLThis just adds to my confusion. And ""it is like this because the spec says so"" is of little help. Why is the spec like this? What is the rationale here? <code>  string[] words = { ""apple"", ""strawberry"", ""grape"" }; // legalstring[] words = new string[]{ ""apple"", ""strawberry"", ""grape"" }; // legalvar words = new []{ ""apple"", ""strawberry"", ""grape"" }; // legalvar words = new string[]{ ""apple"", ""strawberry"", ""grape"" }; // legalvar words = { ""apple"", ""strawberry"", ""grape"", ""peach"" }; // ILLEGAL var number = 10;var text = ""Hello"";",Why can't I use the array initializer with an implicitly typed variable?
"How the Right most column of a dataGridView, could fill the remaining part of the form?"," I have a DataGridView with 5 columns, with dock = filled. I want the last (rightmost) column's width to fill the remaining right side of the form, when the form is maximized. How can I do that? <code> ",How the Rightmost column of a DataGridView could fill the remaining part of the form?
C# Managed PNG Optimization Library Available?," I am looking to build in PNG optimization (a PNG ""sqeezer/squisher"" of sorts) into my builds (TFS 2010 Build Workflow). I want to create a new build activity and as with all my activities, I prefer to have all my code managed with little to no dependencies.I have searched (Googled) and found many different PNG libraries for PNG optimiaztion. PNGOUT, PNGCRUSH, OptiPNG, etc. None of them are really .NET. They all seem like great tools. I prefer not to call EXE files (separate processes) from my code activity because you never really know what will happen (less reliable).So i thought maybe PNGGauntlet would be an option. But looking quickly at the installed application, its merely an C# GUI that calls the binary pngout.exe. That is exactly what I don't want to do.So my question is this : Is there an open-source and/or free .NET library (DLL) that does PNG compression?  <code> ",Managed PNG Optimization Library Available?
C# How to check if a file exists in a folder," I need to check if an xml file exists in the folder. Is this the best way to check a file exists in the folder.I need to check just an xml file is present <code>  DirectoryInfo di = new DirectoryInfo(ProcessingDirectory);FileInfo[] TXTFiles = di.GetFiles(""*.xml"");if (TXTFiles.Length == 0){ log.Info(""no files present"")}",How to check if a file exists in a folder?
How to get the address of the windows fonts folder?, I'm using C# to get the exact path of the system's fonts folder. Couldn't find which class/dll does it. <code> ,How to get the path to the Windows fonts folder?
C# wpf Excel image in a cell," How do I insert an image (of type Image) into a specific cell in a Excel sheet and now ?I was hoping for But I assume it is not that easy./StefanThanks for your input doitgoodThe following code works for meIn my case my Image source is a viewport (myViewPort)The placement of the image is determinated by cell <code>  taperSheet = (Microsoft.Office.Interop.Excel.Worksheet)excelSheets.get_Item(""Taper"");Microsoft.Office.Interop.Excel.Range cell = GetMyPictureCELL(taperSheet);Image myImage = new Image();RenderTargetBitmap bmp;bmp = new RenderTargetBitmap((int)this.Width, (int)this.Height, 96, 96, PixelFormats.Pbgra32);bmp.Render(myViewPort);myImage.Source = bmp;myImage.Stretch = Stretch.Uniform; cell.Add(myImage) try{ Image myImage = new Image(); RenderTargetBitmap bmp; PngBitmapEncoder encoder; string fileName; System.IO.Stream stream; object missing = System.Reflection.Missing.Value; Microsoft.Office.Interop.Excel.Picture pic = null; Microsoft.Office.Interop.Excel.Pictures p = null; bmp = new RenderTargetBitmap((int)this.Width, (int)this.Height, 96, 96, PixelFormats.Pbgra32); bmp.Render(myViewPort); myImage.Source = bmp; myImage.Stretch = Stretch.Uniform; fileName = System.IO.Path.GetTempFileName(); stream = System.IO.File.OpenWrite(fileName); encoder = new PngBitmapEncoder(); encoder.Frames.Add(BitmapFrame.Create(bmp)); encoder.Save(stream); stream.Close(); p = taperSheet.Pictures(missing) as Microsoft.Office.Interop.Excel.Pictures; pic = p.Insert(fileName, missing); pic.Left = cell.Left; pic.Top = cell.Top;}catch { }",Excel image in a cell
How to disable selection on TextBox," I want to disable selecting text and clicking in the middle of text in a TextBox, but the user must be able to enter this TextBox and write at the end of earlier text, so I cannot make it ReadOnly or Enable = false.I try to handle MouseDown and do the following: It helps with placing a cursor in the middle of text, but the user still can make a selection from the end.I also make a MessageBox() on MouseDown event, but in this case the user cannot click on textBox and write anything.The last try was to set a focus() in another Control and focus back, after a period of time, but it didn't work at all. User still can make a selection.How can I do it? <code>  input.Select(input.Text.Length, 0);",How to disable the selection on a TextBox
Json.Net Serialized object losing it's Id value," I am using Json.Net to serialize and deserialize an object.I am experiencing an issue where the deserialized object recordPosted has zero as its Id.Whereas the Serialized record will contain an Id of 180 How would I resolve this?Edit <code>  JsonSerializerSettings jsSettings = new JsonSerializerSettings();jsSettings.ReferenceLoopHandling = ReferenceLoopHandling.Ignore;var recordAsJson = JsonConvert.SerializeObject(recordToUpdate, Formatting.None, jsSettings);//recordAsJson = {""Id"":180,.... var recordPosted = JsonConvert.DeserializeObject<record>(recordAsJson); //recordPosted = Id : 0 public virtual int Id { get; private set; }",Json.Net Serialized object losing its Id value
"Is there a way to create a static readonly array, but the values are calculate in build time"," Is there a way I can create a static array with readonly values, but using some logic to create it? Let me try to explain:I know I can do this: but is it possible to do something like: EDITED:A good solution to my question: Static Constructor! http://msdn.microsoft.com/en-us/library/k9x6w0hc%28v=VS.100%29.aspx :D <code>  public static readonly int[] myArray = { 1, 2, 3 }; public static readonly int[] myArray2 = { for (int i = 0; i < 256; i++) { float[i] = i; }};","Is there a way to create a static readonly array, but the values are calculated at build time"
"Is there a way to create a static readonly array, but the values are calculated in build time"," Is there a way I can create a static array with readonly values, but using some logic to create it? Let me try to explain:I know I can do this: but is it possible to do something like: EDITED:A good solution to my question: Static Constructor! http://msdn.microsoft.com/en-us/library/k9x6w0hc%28v=VS.100%29.aspx :D <code>  public static readonly int[] myArray = { 1, 2, 3 }; public static readonly int[] myArray2 = { for (int i = 0; i < 256; i++) { float[i] = i; }};","Is there a way to create a static readonly array, but the values are calculated at build time"
What is diff between prop and full property?, Is there any difference between the two pieces of code below? Or is the top just a short form of the bottom one? and  <code>  public string Name { get; set; } private string _Name;public string Name{ get { return _Name; } set { _Name = value; }},What is the difference between prop and a full property?
C# - IDisposable Question, Say I have the following: Two Questions:1.I'm a little confused on when my IDisposable members would actually get called. Would they get called when an instance of CdsUpperAlarmLimit goes out of scope?2.How would I handle disposing of objects created in the CdsUpperAlarmLimit class? Should this also derive from IDisposable? <code>  public abstract class ControlLimitBase : IDisposable {}public abstract class UpperAlarmLimit : ControlLimitBase {}public class CdsUpperAlarmLimit : UpperAlarmLimit {},IDisposable Question
remove %20 from the Url, I have a problem: This statement gives %20 for me. I want to remove this. Is there any way other than replace? <code>  System.IO.Path.GetDirectoryName(new Uri(Assembly.GetExecutingAssembly().CodeBase).AbsolutePath),Remove %20 From the Url
C# Threading Task," Is there a way to Interupt a sleeping thread? If I have code similar to this. I'm wanting to execute DoWork() every hour. So, I'd like to sleep a little longer then 10 seconds. Say check every 10 minutes or so. However, if set my sleep to 10 minutes, and I want to kill this background task, I have to wait for the sleep to resume.My actual code is using a Threading.ManualResetEvent to shut down the background work, but my issue is with the ThreadSleep code. I can post more code if necessary.OK, I'm going to add a bit more complete code here as I think it will answer some of the questions. My problem is here, This waits for the Thread.Sleep within the ExecuteWorker() that is running in my background thread.  <code>  while(true){ if(DateTime.Now.Subtract(_lastExecuteTime).TotalHours > 1){ DoWork(); _lastExecuteTime = DateTime.Now(); continue; } Thread.Sleep(10000) //Sleep 10 seconds if(somethingIndicatingQuit){ break; }} private readonly ManualResetEvent _shutdownEvent = new ManualResetEvent(false);private readonly ManualResetEvent _pauseEvent = new ManualResetEvent(true);private Thread _backGroundWorkerThread;//This starts our workpublic void Start() { _backGroundWorkerThread = new Thread(ExecuteWorker) {IsBackground = true, Name = WorkerName + ""_Thread""}; _shutdownEvent.Reset(); _backGroundWorkerThread.Start();}internal void Stop() { //Signal the shutdown event _shutdownEvent.Set(); //Make sure to resume any paused threads _pauseEvent.Set(); //Wait for the thread to exit _backGroundWorkerThread.Join();}private void ExecuteWorker() { while (true) { _pauseEvent.WaitOne(Timeout.Infinite); //This kills our process if (_shutdownEvent.WaitOne(0)) { break; } if (!_worker.IsReadyToExecute) { //sleep 5 seconds before checking again. If we go any longer we keep our service from shutting down when it needs to. Thread.Sleep(5000); continue; } DoWork(); }} _backGroundWorkerThread.Join();",Interrupt a sleeping Thread
REGEX error in C#: [x-y] range in reverse order," I am creating a Regex and so far I did this and tried it, and I get the following error. After messing around for a bit and trying to find error in my regex I simply changed me regex to and it worked. Then I tried some other combinations which worked. Then I tried some others which didn't work. So apparently ""-"" has problem at some places but no problem at others. Is that a bug? or am I missing something?UpdateThanks guys for pointing out that ""-"" is assumed as range if it is in middle or not escaped by ""\"". However, why did it work for [/-?] or [/-\?], is it really defining range here or taking it literally? <code>  ^([0][1-9]|1[0-2])[/-.] parsing ""^([0][1-9]|1[0-2])[/-.]"" - [x-y] range in reverse order. Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. Exception Details: System.ArgumentException: parsing ""^([0][1-9]|1[0-2])[/-.]"" - [x-y] range in reverse order. ([0][1-9]|1[0-2])[-/.] so basically only changed this [/-.] to [-/.] [/-] [/.] [/.-] [/-?] [/-\*] [/-\+]",.NET Regex Error: [x-y] range in reverse order
How Inteface can achieve Multiple Inheritance," In many books it is written that interfaces are a replacement of multiple inheritance, but I don't find any similarity between both of them. Inheritance is mostly important for re-usability of code and functionality and multiple inheritance was helping to re-use code from more than one class, but in interface I didn't find any such feature except that a class can inherit from more than one interface. Interface is just declaration of functions/methods and it didn't contain any implementation part by itself, so class which are inheriting this interface should have to write their own implementation code. So I don't feel any re-usability of code in case of interface. Is any document or link which will clear my doubts with you answer please share. <code> ",How interfaces achieve multiple inheritance
Learning SRP with C#," I am trying to learn the Single Responsibility Principle (SRP) but it is being quite difficult as I am having a huge difficult to figure out when and what I should remove from one class and where I should put/organize it.I was googling around for some materials and code examples, but most materials I found, instead of making it easier to understand, made it hard to understand. For example if I have a list of Users and from that List I have a class Called Control that does lots of things like Send a greeting and goodbye message when a user comes in/out, verify weather the user should be able to enter or not and kick him, receive user commands and messages, etc.From the example you don't need much to understand I am already doing too much into one class but yet I am not clear enough on how to split and reorganize it afterwards.If I understand the SRP, I would have a class for joining the channel, for the greeting and goodbye, a class for user verification, a class for reading the commands, right ?But where and how would I use the kick for example ?I have the verification class so I am sure I would have all sort of user verification in there including weather or not a user should be kicked.So the kick function would be inside the channel join class and be called if the verification fails ?For example: Would appreciate if you guys could lend me a hand here with easy to understand C# materials that are online and free or by showing me how I would be splitting the quoted example and if possible some sample codes, advice, etc. <code>  public void UserJoin(User user){ if (verify.CanJoin(user)) { messages.Greeting(user); } else { this.kick(user); }}",Learning Single Responsibility Principle with C#
Most effiecent way of reading data from a stream," I have an algorithm for encrypting and decrypting data using symmetric encryption. anyways when I am about to decrypt, I have: I have to read data from the cs CryptoStream and place that data into a array of bytes. So one method could be: another technique could be: I cannot know in advance the length of the stream cs:or perhaps I should implement my stack class. I will be encrypting a lot of information therefore making this code efficient will save a lot of time <code>  CryptoStream cs = new CryptoStream(ms, cryptoTransform, CryptoStreamMode.Read); System.Collections.Generic.List<byte> myListOfBytes = new System.Collections.Generic.List<byte>(); while (true) { int nextByte = cs.ReadByte(); if (nextByte == -1) break; myListOfBytes.Add((Byte)nextByte); } return myListOfBytes.ToArray(); ArrayList chuncks = new ArrayList();byte[] tempContainer = new byte[1048576];int tempBytes = 0;while (tempBytes < 1048576){ tempBytes = cs.Read(tempContainer, 0, tempContainer.Length); //tempBytes is the number of bytes read from cs stream. those bytes are placed // on the tempContainer array chuncks.Add(tempContainer);}// later do a for each loop on chunks and add those bytes",Most efficient way of reading data from a stream
How to loop through all controls in a Winform or how to find if a particular control is a container control? (C#)," I will tell my requirement. I need to have a keydown event for each control in the Windows Forms form. It's better to do so rather than manually doing it for all controls if what I have to do for all keydown events is the same.So I could basically do this: But here, the foreach doesn't loop inside those controls which reside inside a groupBox or a tabControl. I mean if the form (this) contains a groupBox or some other container control, then I can get a keydown event for that particular container control. And the foreach doesn't loop through controls that reside inside that container control.Question 1: How do I get a keydown event for ""all"" the controls in a form?If the above puzzle is solved, then my problem is over.This is what I can otherwise do:Mainly pseudo code I know I will have to go through FunctionWhichGeneratesKeyDownForAllItsChildControls(c) many times over to get keydown for all controls if there are groupboxes inside a groupbox or so. I can do it. My question is,Question 2: How do I check if c is a container control? <code>  foreach (Control c in this.Controls) c.KeyDown+= new KeyEventHandler(c_KeyDown); foreach (Control c in this.Controls){ c.KeyDown += new KeyEventHandler(c_KeyDown); if (c is Container control) FunctionWhichGeneratesKeyDownForAllItsChildControls(c)}",How to loop through all controls in a Windows Forms form or how to find if a particular control is a container control?
How to loop through all controls in a Winform or how to find if a particular control is a container control?," I will tell my requirement. I need to have a keydown event for each control in the Windows Forms form. It's better to do so rather than manually doing it for all controls if what I have to do for all keydown events is the same.So I could basically do this: But here, the foreach doesn't loop inside those controls which reside inside a groupBox or a tabControl. I mean if the form (this) contains a groupBox or some other container control, then I can get a keydown event for that particular container control. And the foreach doesn't loop through controls that reside inside that container control.Question 1: How do I get a keydown event for ""all"" the controls in a form?If the above puzzle is solved, then my problem is over.This is what I can otherwise do:Mainly pseudo code I know I will have to go through FunctionWhichGeneratesKeyDownForAllItsChildControls(c) many times over to get keydown for all controls if there are groupboxes inside a groupbox or so. I can do it. My question is,Question 2: How do I check if c is a container control? <code>  foreach (Control c in this.Controls) c.KeyDown+= new KeyEventHandler(c_KeyDown); foreach (Control c in this.Controls){ c.KeyDown += new KeyEventHandler(c_KeyDown); if (c is Container control) FunctionWhichGeneratesKeyDownForAllItsChildControls(c)}",How to loop through all controls in a Windows Forms form or how to find if a particular control is a container control?
C#: In what situations would I unchecked?, For example: In what ways would this be useful? can you think of any? <code>  int value = Int32.MaxValue;unchecked{ value += 1;},In what situations would I specify operation as unchecked?
Easiest Way To Read And Write Files In C#?," There are a lot of different ways to read and write files (text files, not binary) in C#. I just need something that is easy and uses the least amount of code, because I am going to be working with files a lot in my project. I only need something for string since all I need is to read and write strings. <code> ",Easiest way to read from and write to files
TypeDescriptor.GetProperties v Type.GetProperties, I'm looking at some code where an MSDN author uses the following in different methods of the same class: Would you use the former because its faster and you only need to query a property and the latter if you need to manipulate it? Something else? <code>  if ( TypeDescriptor.GetProperties(ModelInstance)[propertyName] != null ) return;var property = ModelInstance.GetType().GetProperty(propertyName);,TypeDescriptor.GetProperties vs. Type.GetProperties
Draw a Fill Rectangle, I a have a PictureBox with a picture in a Windows Form application in C# language.I want draw a FillRectangle in some location of picturebox.but i also need to see picture of picture box.how can i draw this rectangle with low opacity to see image of picturebox? <code> ,Draw a Fill Rectangle with low opacity
Get ListVIew item text from other window," I want to make a little application that changes the default playback device in windows 7. The only solution was to interact with the Sound Applet. I succeeded to get the handle to the SysListView32 window that has the devices name but i cant get the text from the ListView.This is the code used: The result (strLvi) are some chinese letters. What is wrong in the script?UPDATE: LVITEM struct is this: The sLIstView handle is correct... a checked in spy++.What test do i need to perform to check where is the problem? I could give you all the script if that would help. <code>  IntPtr sListView = (window handle received from another function)LVITEM lvi = new LVITEM();lvi.mask = LVIF_TEXT;lvi.cchTextMax = 1024;lvi.iItem = 0; // i tried with a loop trought all the itemslvi.iSubItem = 0;lvi.pszText = Marshal.AllocHGlobal(1024);IntPtr ptrLvi = Marshal.AllocHGlobal(Marshal.SizeOf(lvi));Marshal.StructureToPtr(lvi, ptrLvi, false);SendMessage(sListView, (int)WinMesages.LVM_GETITEMW, IntPtr.Zero, ptrLvi);string strLvi = Marshal.PtrToStringAuto(lvi.pszText); private struct LVITEM{ public uint mask; public int iItem; public int iSubItem; public uint state; public uint stateMask; public IntPtr pszText; public int cchTextMax; public int iImage; public IntPtr lParam;}",Get ListView item text from other window
Using Server.Mappath in MVC3," I have the code It returnsC:\inetpub\wwwroot\websiteName\SERVICENAME\App_Data\FileName.xslWhy am I getting the path to the ServiceController, SERVICENAME? I want the path to App_Data which is inC:\inetpub\wwwroot\websiteName\App_Data\FileName.xsl <code>  string xsltPath = System.Web.HttpContext.Current.Server.MapPath(@""App_Data"") + ""\\"" + TransformFileName",Using Server.MapPath in MVC3
PInvoke when you don't know the DLL?," In C#, I'm trying to PInvoke a ""simple"" function I have in C++. The issue is that I don't know the name or location of the library at compile time. In C++, this is easy: For the life of me I can't figure out how to do this in C#. I wouldn't have any trouble if I knew the dll name, it would look something like this: How do I do this without knowing the dll I'm loading from at compile time? <code>  typedef HRESULT (*SomeFuncSig)(int, IUnknown *, IUnknown **);const char *lib = ""someLib.dll""; // Calculated at runtimeHMODULE mod = LoadLibrary(lib);SomeFuncSig func = (SomeFuncSig)GetProcAddress(""MyMethod"");IUnknown *in = GetSomeParam();IUnknown *out = NULL;HRESULT hr = func(12345, in, &out);// Leave module loaded to continue using foo. [DllImport(""someLib.dll"")]uint MyMethod(int i, [In, MarshalAs(UnmanagedType.Interface)] IUnknown input, [Out, MarshalAs(UnmanagedType.Interface)] out IUnknown output);",PInvoke when you don't know the DLL at compile time?
Can this be replaced with a Linq query?," I have a Message object which wraps a message format I do not have control over. The format is a simple list of Key/Value pairs. I want to extract a list of Users from a given Message. For example given the following message... I want to extract four Users with the provided properties set. The initial keys 200/300....405 represent fields I don't need and can skip to get to the User data. Each users data is in consecutive fields but the number of fields varies depending on how much information is known about a user. The following method does what I'm looking for. It uses an enumeration of possible key types and a method to find the index of the first field with user data. I'm wondering if its possible to replace the method with a Linq query. I'm having trouble telling Linq to select a new user and populate its fields with all matching data until you find the start of the next user entry. Note: Relative key numbers are random (not 1,2,3,4) in the real message format. <code>  1. 200->....2. 300->....3. ....4. 405->.... 5. 001->first_user_name6. 002->first_user_phone7. 003->first_user_fax8. 001->second_user_name9. 001->third_user_name10. 002->third_user_phone11. 003->third_user_fax12. 004->third_user_address13. .....14. 001->last_user_name15. 003->last_user_fax private List<User> ParseUsers( Message message ){ List<User> users = new List<User>( ); User user = null; String val = String.Empty; for( Int32 i = message.IndexOfFirst( Keys.Name ); i < message.Count; i++ ) { val = message[ i ].Val; switch( message[ i ].Key ) { case Keys.Name: user = new User( val ); users.Add( user ); break; case Keys.Phone: user.Phone = val; break; case Keys.Fax: user.Fax = val; break; case Keys.Address: user.Address = val; break; default: break; } } return users;}",Replace for-switch loop with a Linq query
Multiple threads to act on a form," I'm practising on threading and came across this problem. The situation is like this:I have 4 progress bars on a single form, one for downloading a file, one for showing the page loading status etc...I have to control the progress of each ProgressBar from a separate thread.The problem is I'm getting an InvalidOperationException which says Cross-thread operation not valid: Control 'progressBar1' accessed from a thread other than the thread it was created on.Am I wrong in this approach or can anybody tell me how to implement this? <code> ",Accessing a form's control from a separate thread
How close BackgroundWorker thread when applcation is deactivated?," I create thread with BackgroundWorker, and in the loop I check every time if CancellationPending is true or not, like this: When application is deactivated, the thread wasn't closed, it is aborted and the exception occurs. How close threads with BackgroundWorker when application is deactivated? <code>  public MainPage() { InitializeComponent(); bw = new BackgroundWorker(); bw.WorkerReportsProgress = true; bw.WorkerSupportsCancellation = true; bw.DoWork += new DoWorkEventHandler(bw_DoWork); bw.ProgressChanged += new ProgressChangedEventHandler(bw_ProgressChanged); bw.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bw_RunWorkerCompleted); } private void ButtonStart_Click(object sender, RoutedEventArgs e) { if (bw.IsBusy != true) { bw.RunWorkerAsync(); } } private void ButtonCancel_Click(object sender, RoutedEventArgs e) { if (bw.WorkerSupportsCancellation) { bw.CancelAsync(); } } private void bw_DoWork(object sender, DoWorkEventArgs e) { BackgroundWorker worker = sender as BackgroundWorker; for (int i = 1; i <= 100; i++) { Debug.WriteLine(""The tread is working""); if (worker.CancellationPending) { e.Cancel = true; bw.CancelAsync(); break; } else { System.Threading.Thread.Sleep(500); worker.ReportProgress(i); } } } private void bw_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e) { if (e.Cancelled) { tbProgress.Text = ""Canceled""; } else if (e.Error != null) { tbProgress.Text = ""Error: "" + e.Error.Message; } else { tbProgress.Text = ""Done""; } } private void bw_ProgressChanged(object sender, ProgressChangedEventArgs e) { tbProgress.Text = e.ProgressPercentage.ToString() + ""%""; }",How close BackgroundWorker thread when application is deactivated?
C# Access current domain name on Application_Start, Normally to access the current domain name e.g where the site is hosted I do something like But HttpContext is not avaible on Application_Start only from Application_BeginRequest.Any ideas? <code>  string rURL = HttpContext.Current.Request.Url.ToString().ToLower();,Access current domain name on Application_Start
Google Angular Framework - Worth the risk?," I have been asked to build a small web application for one of our clients and think it might be a good opportunity to try out a different framework for building web applications. Most of the applications we build are based on asp.net web forms and we have no yet done anything in an MVC architecture but I am eager to start building web applications in a more structured manner with the right tools.I have been researching things like asp.net MVC and the likes which look quite good but I am wondering is there anything to be said for using something like the Google AngularJS Framework.If possible I would still like to be able to write my server side code using c# and I have not researched AngularJS enough to know if this is even possible, although I assume I could use web services. Has anyone had any experience with developing an app using AngularJS and if so, how was it and can you point me in the right direction for some tutorials? <code> ",Google AngularJS Framework - Worth the risk?
gridview - allowing one column to be edited but not another," i have an asp.net c# application.my gridview has a datasource that has 2 fields.1 field cannot be edited by the user, but i need the other one to be editable!is this possible to do? <code> ",Allowing one column to be edited but not another
How to get data from TCPPacket using SharpPcap [C#]?," I need small sniffer for my report so I went with C# and SharpPcap. I have raw packet with all packet data. Then I get Packet out of it with some info such as source/destination/protocol/etc. After that I get tcp packet out of that.Now how do I get only actual packet data that software sent/received? <code>  packet = Packet.ParsePacket(rawCapture.LinkLayerType, rawCapture.Data);tcpPacket = TcpPacket.GetEncapsulated(packet);",How to get data from TCPPacket using SharpPcap?
Is there a named mutex in Compact Framework? (C#)," I am having a hard time figuring out what good a mutex is without naming it. Specifically I want to make my Windows Mobile 6.5 app single-instance.There are a few questions and answers on this site about how to do that - and the best ones seem to use named mutexes.Unfortunately the CTORS for mutexes in compact framework do not take a string - one can only create a mutex.Now, what good is a mutex if it has no associated ID?Am I missing something?How do I use a mutex to protect a resource across multiple applications if I can't name them? <code> ",What is the use for a Mutex if you can't name it?
EF Competing SaveChanges() Calls," I am building a batch processing system. Batches of Units come in quantities from 20-1000. Each Unit is essentially a hierarchy of models (one main model and many child models). My task involves saving each model hierarchy to a database as a single transaction (either each hierarchy commits or it rolls back). Unfortunately EF was unable to handle two portions of the model hierarchy due to their potential to contain thousands of records. What I've done to resolve this is set up SqlBulkCopy to handle these two potentially high count models and let EF handle the rest of the inserts (and referential integrity).Batch Loop: Unit: Right now I'm essentially stuck between a rock and a hard place. If I leave the IsolationLevel set to ReadCommitted, I get deadlocks between EF INSERT statements in different Tasks. If I set the IsolationLevel to ReadUncommitted (which I thought would be fine since I'm not doing any SELECTs) I get DbConcurrencyExceptions.I've been unable to find any good information about DbConcurrencyExceptions and Entity Framework but I'm guessing that ReadUncommitted is essentially causing EF to receive invalid ""rows inserted"" information.UPDATEHere is some background information on what is actually causing my deadlocking issues while doing INSERTS:http://connect.microsoft.com/VisualStudio/feedback/details/562148/how-to-avoid-using-scope-identity-based-insert-commands-on-sql-server-2005Apparently this same issue was present a few years ago when Linq To SQL came out and Microsoft fixed it by changing how scope_identity() gets selected. Not sure why their position has changed to this being a SQL Server problem when the same issue came up with Entity Framework. <code>  foreach (var unitDetails in BatchUnits){ var unitOfWork = new Unit(unitDetails); Task.Factory.StartNew(() => { unitOfWork.ProcessX(); // data preparation unitOfWork.ProcessY(); // data preparation unitOfWork.PersistCase(); });} class Unit{ public PersistCase() { using (var dbContext = new CustomDbContext()) { // Need an explicit transaction so that // EF + SqlBulkCopy act as a single block using (var scope = new TransactionScope(TransactionScopeOption.Required, new TransactionOptions() { IsolationLevel = System.Transaction.IsolationLevel.ReadCommitted })) { // Let EF Insert most of the records // Note Insert is all it is doing, no update or delete dbContext.Units.Add(thisUnit); dbContext.SaveChanges(); // deadlocks, DbConcurrencyExceptions here // Copy Auto Inc Generated Id (set by EF) to DataTables // for referential integrity of SqlBulkCopy inserts CopyGeneratedId(thisUnit.AutoIncrementedId, dataTables); // Execute SqlBulkCopy for potentially numerous model #1 SqlBulkCopy bulkCopy1 = new SqlBulkCopy(...); ... bulkCopy1.WriteToServer(dataTables[""#1""]); // Execute SqlBulkCopy for potentially number model #2 SqlBulkCopy bulkCopy2 = new SqlBulkCopy(...); ... bulkCopy2.WriteToServer(dataTables[""#2""]); // Commit transaction scope.Complete(); } } }}",EF Competing SaveChanges() Calls
Gaussian fit in C#/.NET," In a project I'm working on I need to obtain a Gaussian fit from a set of points - needing mean and variance for some processing, and possibly an error degree (or accuracy level) to let me figure out if the set of points really have a normal distribution.I've found this questionbut it is limited to 3 points only - whereas I need a fit that can work with any number of points.What I need is similar to the labview Gaussian Peak FitI have looked at mathdotnet and aforge.net (using both in the same project), but I haven't found anything.Does anybody know any C# or (easily convertible) C/C++ or Java solutions?Alternatively, I've been told that an iterative algorithm should be used - I could implement it by myself (if not too much math-complicated). Any idea about what I can use? I've read a lot of articles (on Wikipedia and others found via Google) but I haven't found any clear indication of a solution. <code> ",Gaussian fit in C#
C# is it possible to select text on a Windows form label?, Is it possible to highlight/select part of text in a Windows Form label control? I know its possible with RTFtextbox control but that using that control would be overkill as I need to create many instances of the label. <code> ,Is it possible to select text on a Windows form label?
VISUAL STUDIO 2010 Right Click Refactor," In VS2010 C#, when I right-click there is ""Refactor"" menu with following options:Rename Extract Method Encapsulate Field Extract Interface Remove Parameters Reorder ParametersAre these options available in VS2010 VB.Net? All I can see is ""Rename"" when I right click? <code> ",Refactoring options in Visual Studio 2010 differ between C# and VB
Visual Studio 2010 Right Click Refactor," In VS2010 C#, when I right-click there is ""Refactor"" menu with following options:Rename Extract Method Encapsulate Field Extract Interface Remove Parameters Reorder ParametersAre these options available in VS2010 VB.Net? All I can see is ""Rename"" when I right click? <code> ",Refactoring options in Visual Studio 2010 differ between C# and VB
How to configure SSL on appharbor with ServiceStack.net web services," I am developing a set of web services using ServiceStack.net. I plan to host these services on Appharbor. I am fairly new to appharbor and cloud hosting in general. I see that there is an interface within the dashboard to upload my SSL cert. What other configuration do I need to do to AppHarbor and/or my application to get this working properly?Another note, My Servicestack services will be hosted within an MVC website. I will require all servicestack calls to be made over SSL and have implemented a request filter to check for this and throw a 403 if a non-secure call is attempted. <code> ",How to configure SSL on AppHarbor with ServiceStack.net web services
Play two sounds after each other in c# winform," I want to play two sounds one after the other in reaction to a button click. When the first sound finishes, the second sound should start playing.My problem is that every time the button is clicked these two sounds are different and I don't know their lengths in order to use Thread.Sleep. But I don't want these sounds to play on top of each other. <code> ",How do I play two sounds one after the other in a Windows Forms application?
How do I play two sounds one after the other in a .NET Windows application?," I want to play two sounds one after the other in reaction to a button click. When the first sound finishes, the second sound should start playing.My problem is that every time the button is clicked these two sounds are different and I don't know their lengths in order to use Thread.Sleep. But I don't want these sounds to play on top of each other. <code> ",How do I play two sounds one after the other in a Windows Forms application?
"Why does the following ""dynamic"" code fail?"," Why does the following test fail? With the following error: Test method MyTests.DynamicTests.TestDynamic threw exception: Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: The best overloaded method match for 'MyTests.DynamicTests.ListOfIntsTotaller.Total(System.Collections.Generic.List<int>)' has some invalid argumentsShouldn't the binder be smart enough to match list to its underlying type of List<int> and thus successfully bind to the GetTotal method? <code>  [TestClass]public class DynamicTests{ public class ListOfIntsTotaller { public float Total(List<int> list) { return list.Sum(); } } public static class TotalFormatter { public static string GetTotal(IEnumerable list, dynamic listTotaller) { // Get a string representation of a sum return listTotaller.Total(list).ToString(); } } [TestMethod] public void TestDynamic() { var list = new List<int> { 1, 3 }; var totaller = new ListOfIntsTotaller(); Assert.AreEqual(""4"", totaller.Total(list).ToString()); // passes Assert.AreEqual(""4"", TotalFormatter.GetTotal(list, totaller)); // fails }}",Why does this runtime dynamic binding fail?
Why does this rutime dynamic binding fail?," Why does the following test fail? With the following error: Test method MyTests.DynamicTests.TestDynamic threw exception: Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: The best overloaded method match for 'MyTests.DynamicTests.ListOfIntsTotaller.Total(System.Collections.Generic.List<int>)' has some invalid argumentsShouldn't the binder be smart enough to match list to its underlying type of List<int> and thus successfully bind to the GetTotal method? <code>  [TestClass]public class DynamicTests{ public class ListOfIntsTotaller { public float Total(List<int> list) { return list.Sum(); } } public static class TotalFormatter { public static string GetTotal(IEnumerable list, dynamic listTotaller) { // Get a string representation of a sum return listTotaller.Total(list).ToString(); } } [TestMethod] public void TestDynamic() { var list = new List<int> { 1, 3 }; var totaller = new ListOfIntsTotaller(); Assert.AreEqual(""4"", totaller.Total(list).ToString()); // passes Assert.AreEqual(""4"", TotalFormatter.GetTotal(list, totaller)); // fails }}",Why does this runtime dynamic binding fail?
Silverlight Image anti-aliasing," I'm trying to print an image (QR code) from Silverlight 4 app, however the image is antialised when printed (I have tried both XPS file printer and hardware printer)image is blury, and is not readable by barcode reader.Image from printed XPS document http://img805.imageshack.us/img805/7677/qraliasing.pngI'm using this simple code to print it: <code>  WriteableBitmap bitmap = new WriteableBitmap(width, height);//write bitmap pixelsImage image = new Image(){Stretch = Stretch.None};image.Source = bitmap;image.Width = bitmap.PixelWidth;image.Height = bitmap.PixelHeight;//PrintPrintDocument printDocument = new PrintDocument();printDocument.PrintPage += (sender, args) =>{ args.PageVisual = image;};printDocument.Print(""QrCode"");",Silverlight printing anti-aliasing
why is this so much slower in c++?," I have converted this simple method from C# to C++. It reads a path table and populates a list of lists of ints (or a vector of vectors of ints).A sample line from the path table would be something like I realise there are better ways of doing this in general, but for now I just want to know why my C++ code is taking so much longer. e.g. 10 minutes as opposed to 10 seconds with the C# version. Here is my C++ code. I'm guessing I've done something a bit drastically wrong. Here is the C# version: Sorry this is so specific, but I'm stumped.EDIT - A lot of people have said they have tested this code, and it takes mere seconds for them. All I know is, if I comment out the call to this function, the program loads in seconds. With the function call it takes 5 minutes. Almost exactly. I'm really stumped. What could the problem be?Here is the PathTable it's using.EDIT - I tried running the function in a program on its own, and it took a few seconds, but I'm afraid I don't know enough to be able to know how to fix this problem. Obviously it's not the code. What could it be? I checked where it's being called to see if there were multiple calls, but there aren't. It's in a constructor of the game's level and that is only called once.EDIT - I understand that the code is not the best it could be, but that isn't the point here. It runs quickly on its own - about 3 seconds and that's fine for me. The problem I'm trying to solve is why it takes so much longer inside the project.EDIT - I commented out all of the game code apart from the main game loop. I placed the method into the initialize section of the code which is run once on start up. Apart from a few methods setting up a window it's now pretty much the same as the program with ONLY the method in, only it STILL takes about 5 minutes to run. Now I know it has nothing to do with dependencies on the pathLookupVectors. Also, I know it's not a memory thing where the computer starts writing to the hard drive because while the slow program is chugging away running the method, I can open another instance of Visual Studio and run the single method program at the same time which completes in seconds. I realise that the problem might be some basic settings, but I'm not experienced so apologies if this does disappointingly end up being the reason why. I still don't have a clue why it's taking so much longer. <code>  0 12 5 16 n //Parses the text path vector into the enginevoid Level::PopulatePathVectors(string pathTable){ // Read the file line by line. ifstream myFile(pathTable); for (unsigned int i = 0; i < nodes.size(); i++) { pathLookupVectors.push_back(vector<vector<int>>()); for (unsigned int j = 0; j < nodes.size(); j++) { string line; if (getline(myFile, line)) //Enter if a line is read successfully { stringstream ss(line); istream_iterator<int> begin(ss), end; pathLookupVectors[i].push_back(vector<int>(begin, end)); } } } myFile.close();} private void PopulatePathLists(string pathList){ // Read the file and display it line by line. StreamReader streamReader = new StreamReader(pathList); for (int i = 0; i < nodes.Count; i++) { pathLookupLists.Add(new List<List<int>>()); for (int j = 0; j < nodes.Count; j++) { string str = streamReader.ReadLine(); pathLookupLists[i].Add(new List<int>()); //For every string (list of ints) - put each one into these lists int count = 0; string tempString = """"; while (str[count].ToString() != ""n"") //While character does not equal null terminator { if (str[count].ToString() == "" "") //Character equals space, set the temp string //as the node index, and move on { pathLookupLists[i][j].Add(Convert.ToInt32(tempString)); tempString = """"; } else //If characters are adjacent, put them together { tempString = tempString + str[count]; } count++; } } } streamReader.Close();}",Why is this so much slower in C++?
LINQ to SQL: How Can I define Nullable EntitySet<>?," For each entity that has a one to many relation with other entity when i trying to add a new item it seems like i have to define these list of items that relates to this entity.For example, lets say that i have a ProductType entity that has a list of Products as following: when i try to add a new ProductType like that: it gives me an exception that Products is null: the same problem with all the entities that has a one to many relation with other entities. so how can i allow null for the EntitySet<> that represents a one to many Relation <code>  [Table]public class ProductType{ [Column(IsPrimaryKey = true, IsDbGenerated = true)] public int Id { get; private set; } [Column] public string Name { get; set; } private EntitySet<Product> _products; [Association(Storage = ""_products"", ThisKey = ""Id"", OtherKey = ""ProductTypeId"")] public EntitySet<Product> Products { get { return _products; } set { _products.Assign(value); } }} ProductType newType = new ProductType { Name = ""newType"" };_productRepository.Add(newType); //InsertOnSubmit() and SaveChanges() Object reference not set to an instance of an object",How Can I define Nullable EntitySet<>?
Using an RSA Private Key to decrypt a string that was encrypted using RSA Public Key," I know the main answer I am likely to get is why the hell would you want to do that?! Unfortunately despite my protests I have to do it, even though I know it makes little sense.I have functions written in .Net to decrypt using a private key, encrypt using a public key.I also RSA sign and verify and have a reasonable understanding of how this all work I think.I am now being sent a value that is RSA encrypted using a private key which I am supposed to derive a usable value by decrypting using the public key.I can't seem to figure out how to do this. Am I being an idiot? Is this a normal thing to do?I am told by the person sending me the value that this is no problem in PHP. I don't know and haven't used PHP yet. I can't find a library to do it in any of the main languages I know i.e. C++, Java, C#. The server I am working on uses .Net.I am hoping someone might be able help me. It would be great if there is some kind of reasonable solution besides begging them to change what they are doing.This is my method (updated from my previous bad one as pointed out by Iridium) but when I try to decrypt the value I get an exception ""Error occurred while decoding OAEP padding.""If I use rsa.Decrypt(bytes, false) I get a bad key exception. The two methods above InitRSAProvider and LoadRsaPublicKey were gotten out of tutorials to allow PEM keys as Strings to be used with .Net. <code>  public static string DecryptUsingPublic(string dataEncrypted, string publicKey) { if (dataEncrypted == null) throw new ArgumentNullException(""dataEncrypted""); if (publicKey == null) throw new ArgumentNullException(""publicKey""); try { RSAParameters _publicKey = LoadRsaPublicKey(publicKey, false); RSACryptoServiceProvider rsa = InitRSAProvider(_publicKey); byte[] bytes = Convert.FromBase64String(dataEncrypted); byte[] decryptedBytes = rsa.Decrypt(bytes, true); ArrayList arrayList = new ArrayList(); arrayList.AddRange(decryptedBytes); return Encoding.UTF8.GetString(decryptedBytes); } catch { return null; } } private static RSAParameters LoadRsaPublicKey(String publicKeyFilePath, Boolean isFile) { RSAParameters RSAKeyInfo = new RSAParameters(); byte[] pubkey = ReadFileKey(publicKeyFilePath, ""PUBLIC KEY"", isFile); byte[] SeqOID = { 0x30, 0x0D, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x01, 0x05, 0x00 }; byte[] seq = new byte[15]; // --------- Set up stream to read the asn.1 encoded SubjectPublicKeyInfo blob ------ MemoryStream mem = new MemoryStream(pubkey); BinaryReader binr = new BinaryReader(mem); //wrap Memory Stream with BinaryReader for easy reading byte bt = 0; ushort twobytes = 0; try { twobytes = binr.ReadUInt16(); if (twobytes == 0x8130) //data read as little endian order (actual data order for Sequence is 30 81) binr.ReadByte(); //advance 1 byte else if (twobytes == 0x8230) binr.ReadInt16(); //advance 2 bytes else return RSAKeyInfo; seq = binr.ReadBytes(15); //read the Sequence OID if (!CompareBytearrays(seq, SeqOID)) //make sure Sequence for OID is correct return RSAKeyInfo; twobytes = binr.ReadUInt16(); if (twobytes == 0x8103) //data read as little endian order (actual data order for Bit String is 03 81) binr.ReadByte(); //advance 1 byte else if (twobytes == 0x8203) binr.ReadInt16(); //advance 2 bytes else return RSAKeyInfo; bt = binr.ReadByte(); if (bt != 0x00) //expect null byte next return RSAKeyInfo; twobytes = binr.ReadUInt16(); if (twobytes == 0x8130) //data read as little endian order (actual data order for Sequence is 30 81) binr.ReadByte(); //advance 1 byte else if (twobytes == 0x8230) binr.ReadInt16(); //advance 2 bytes else return RSAKeyInfo; twobytes = binr.ReadUInt16(); byte lowbyte = 0x00; byte highbyte = 0x00; if (twobytes == 0x8102) //data read as little endian order (actual data order for Integer is 02 81) lowbyte = binr.ReadByte(); // read next bytes which is bytes in modulus else if (twobytes == 0x8202) { highbyte = binr.ReadByte(); //advance 2 bytes lowbyte = binr.ReadByte(); } else return RSAKeyInfo; byte[] modint = { lowbyte, highbyte, 0x00, 0x00 }; //reverse byte order since asn.1 key uses big endian order int modsize = BitConverter.ToInt32(modint, 0); byte firstbyte = binr.ReadByte(); binr.BaseStream.Seek(-1, SeekOrigin.Current); if (firstbyte == 0x00) { //if first byte (highest order) of modulus is zero, don't include it binr.ReadByte(); //skip this null byte modsize -= 1; //reduce modulus buffer size by 1 } byte[] modulus = binr.ReadBytes(modsize); //read the modulus bytes if (binr.ReadByte() != 0x02) //expect an Integer for the exponent data return RSAKeyInfo; int expbytes = (int)binr.ReadByte(); // should only need one byte for actual exponent data (for all useful values) byte[] exponent = binr.ReadBytes(expbytes); RSAKeyInfo.Modulus = modulus; RSAKeyInfo.Exponent = exponent; return RSAKeyInfo; } catch (Exception) { return RSAKeyInfo; } finally { binr.Close(); } //return RSAparams; } private static RSACryptoServiceProvider InitRSAProvider(RSAParameters rsaParam) { // // Initailize the CSP // Supresses creation of a new key // CspParameters csp = new CspParameters(); //csp.KeyContainerName = ""RSA Test (OK to Delete)""; const int PROV_RSA_FULL = 1; csp.ProviderType = PROV_RSA_FULL; const int AT_KEYEXCHANGE = 1; // const int AT_SIGNATURE = 2; csp.KeyNumber = AT_KEYEXCHANGE; // // Initialize the Provider // RSACryptoServiceProvider rsa = new RSACryptoServiceProvider(csp); rsa.PersistKeyInCsp = false; // // The moment of truth... // rsa.ImportParameters(rsaParam); return rsa; } private static int GetIntegerSize(BinaryReader binr) { byte bt = 0; byte lowbyte = 0x00; byte highbyte = 0x00; int count = 0; bt = binr.ReadByte(); if (bt != 0x02) //expect integer return 0; bt = binr.ReadByte(); if (bt == 0x81) count = binr.ReadByte(); // data size in next byte else if (bt == 0x82) { highbyte = binr.ReadByte(); // data size in next 2 bytes lowbyte = binr.ReadByte(); byte[] modint = { lowbyte, highbyte, 0x00, 0x00 }; count = BitConverter.ToInt32(modint, 0); } else { count = bt; // we already have the data size } while (binr.ReadByte() == 0x00) { //remove high order zeros in data count -= 1; } binr.BaseStream.Seek(-1, SeekOrigin.Current); //last ReadByte wasn't a removed zero, so back up a byte return count; } private static bool CompareBytearrays(byte[] a, byte[] b) { if (a.Length != b.Length) return false; int i = 0; foreach (byte c in a) { if (c != b[i]) return false; i++; } return true; }",Using an RSA Public Key to decrypt a string that was encrypted using RSA Private Key
how to add calculator to start menu search?," I want to make a calculator and add it to the Windows 7 start menu that can calculate functions in the search text box. For example, I write ""2*2="" in the search text box and it shows me ""2*2=4"".I don't know how I can do this :(Does Microsoft have any API for this? <code> ",How to add a calculator to start menu search?
c#: abstract class using interfaces," I'd like to create an abstract class in c#, that ""inherits"" from different interfaces, but leaves the concrete implementation to the subclass. The compiler however complains, that the class doesnt implement the methods specified in the interfaces. I'm used to Java where this always worked, so I'm not sure how it is supposed to work in c#. Anyway, this is my code:  <code>  public abstract class MyClass : IDisposable, IPartImportsSatisfiedNotification { private string name; public MyClass(string name) { this.name = name; } }",Creating an abstract class that implements multiple interfaces in c#
awaitable Task based queue," I'm wondering if there exists an implementation/wrapper for ConcurrentQueue, similar to BlockingCollection where taking from the collection does not block, but is instead asynchronous and will cause an async await until an item is placed in the queue.I've come up with my own implementation, but it does not seem to be performing as expected. I'm wondering if I'm reinventing something that already exists.Here's my implementation: <code>  public class MessageQueue<T>{ ConcurrentQueue<T> queue = new ConcurrentQueue<T>(); ConcurrentQueue<TaskCompletionSource<T>> waitingQueue = new ConcurrentQueue<TaskCompletionSource<T>>(); object queueSyncLock = new object(); public void Enqueue(T item) { queue.Enqueue(item); ProcessQueues(); } public async Task<T> Dequeue() { TaskCompletionSource<T> tcs = new TaskCompletionSource<T>(); waitingQueue.Enqueue(tcs); ProcessQueues(); return tcs.Task.IsCompleted ? tcs.Task.Result : await tcs.Task; } private void ProcessQueues() { TaskCompletionSource<T> tcs=null; T firstItem=default(T); while (true) { bool ok; lock (queueSyncLock) { ok = waitingQueue.TryPeek(out tcs) && queue.TryPeek(out firstItem); if (ok) { waitingQueue.TryDequeue(out tcs); queue.TryDequeue(out firstItem); } } if (!ok) break; tcs.SetResult(firstItem); } }}",awaitable Task based queue
Awaitable task based queue," I'm wondering if there exists an implementation/wrapper for ConcurrentQueue, similar to BlockingCollection where taking from the collection does not block, but is instead asynchronous and will cause an async await until an item is placed in the queue.I've come up with my own implementation, but it does not seem to be performing as expected. I'm wondering if I'm reinventing something that already exists.Here's my implementation: <code>  public class MessageQueue<T>{ ConcurrentQueue<T> queue = new ConcurrentQueue<T>(); ConcurrentQueue<TaskCompletionSource<T>> waitingQueue = new ConcurrentQueue<TaskCompletionSource<T>>(); object queueSyncLock = new object(); public void Enqueue(T item) { queue.Enqueue(item); ProcessQueues(); } public async Task<T> Dequeue() { TaskCompletionSource<T> tcs = new TaskCompletionSource<T>(); waitingQueue.Enqueue(tcs); ProcessQueues(); return tcs.Task.IsCompleted ? tcs.Task.Result : await tcs.Task; } private void ProcessQueues() { TaskCompletionSource<T> tcs=null; T firstItem=default(T); while (true) { bool ok; lock (queueSyncLock) { ok = waitingQueue.TryPeek(out tcs) && queue.TryPeek(out firstItem); if (ok) { waitingQueue.TryDequeue(out tcs); queue.TryDequeue(out firstItem); } } if (!ok) break; tcs.SetResult(firstItem); } }}",awaitable Task based queue
tart a new line in wpf textbox," I created a small GUI with WPF, containing a Textbox.I want the user to have the ability to start a new line .How do I let the user start a new line in the WPF textbox (with \n or \r)? I want the user to be able to start a new line by pressing ""enter"". <code> ",Start a new line in wpf textbox
"how get red of ""A blocking operation was interrupted by a call to WSACancelBlockingCall"""," Could you help me to get rid of this exception: System.Net.Sockets.SocketException: ""A blocking operation was interrupted by a call to WSACancelBlockingCall""What the below code does: sends UDP message to the server and fetches reply(NAK or ACK)Code that throws exception: m_receiveBytes = m_receiver.Receive(ref m_from); Code: <code>  public partial class _Default : System.Web.UI.Page{ static readonly object lockScheduleIem = new object(); IPAddress m_AddressSend; IPAddress m_AddressRecieve; int m_groupPortSend; int m_groupPortReceive; IPEndPoint m_IPAddressSend; IPEndPoint m_IPAddressReceive; Byte[] m_receiveBytes; Thread m_thread; UdpClient m_receiver; ManualResetEvent m_mre; UdpClient m_sender; IPEndPoint m_from; protected void Page_Init(object sender, EventArgs e) { m_AddressSend = IPAddress.Parse(""10.43.60.177""); m_AddressRecieve = IPAddress.Parse(""10.43.60.99""); int.TryParse(""60200"", out m_groupPortSend); int.TryParse(""206"", out m_groupPortReceive); m_IPAddressSend = new IPEndPoint(m_AddressSend, m_groupPortSend); m_IPAddressReceive = new IPEndPoint(m_AddressRecieve, m_groupPortReceive); m_mre = new ManualResetEvent(false); m_from = new IPEndPoint(IPAddress.Any, 0); } protected void Page_Load(object sender, EventArgs e) { } protected void Button1_Click(object sender, EventArgs e) { try { TimeSpan timeout; timeout = new TimeSpan(0, 0, 0, 0, 5000); m_sender = new UdpClient(); m_receiveBytes = null; m_receiver = new UdpClient(m_IPAddressReceive); m_thread = new Thread(new ThreadStart(ThreadProc)); m_thread.Start(); string str = string.Empty; using (StreamReader sr = new StreamReader(@""C:\UDPmsgArchive\UDPmsg_Of_2011_10_18_13_7_33_968_634545400539687500.xml"")) str = sr.ReadToEnd(); byte[] XMLbytes = Encoding.ASCII.GetBytes(str); m_sender.Send(XMLbytes, XMLbytes.Length, m_IPAddressSend); m_mre.WaitOne(timeout, true); m_mre.Reset(); m_receiver.Close(); if (m_receiveBytes != null) Response.Write(Encoding.ASCII.GetString(m_receiveBytes, 0, m_receiveBytes.Length)); else Response.Write(""string.Empty""); } catch (Exception ex) { Response.Write(ex.ToString()); } } public void ThreadProc() { try { m_receiveBytes = m_receiver.Receive(ref m_from); // ERROR HERE m_mre.Set(); m_receiver.Close(); } finally { m_mre.Set(); } }}","How do I stop SocketException: ""A blocking operation was interrupted by a call to WSACancelBlockingCall"" from being thrown?"
Get more than 100 decimal digits in c#, Is it possible to get more than 100 decimal digits in C#?If yes what is the necessary portion of code?In Java there something call BigDecimal but it still can't reach more than 55 digits. <code> ,How can I get more than 100 decimal digits in C#?
programmatically make textblock with hyperlick in between text," In XAML I have the following code: Now I'd like to get rid of the whole TextBlock XAML and add that bit programmatically. I have no trouble creating the TextBlock, setting the Text property to 'click please' and adding a Hyperlink to TextBlock.Content. But how do I position the Hyperlink in between 'click' and 'please'? And how do I set the text of the hyperlink to 'here'?I haven't got much going, so far all I got is this: <code>  <Label Width=""120"" Height=""20"" Name=""label1"" SnapsToDevicePixels=""True"" HorizontalAlignment=""Left"" VerticalAlignment=""Bottom""> <TextBlock VerticalAlignment=""Center"" HorizontalAlignment=""Left""> click <Hyperlink RequestNavigate=""Hyperlink_RequestNavigate"" NavigateUri=""foo"">here</Hyperlink> please </TextBlock> </Label> label2.Content = new TextBlock() { Text = ""click please"" }; //(label2.Content as TextBlock).Content does not exist? //and even if it does.. how do I squeeze the hyperlink in between the text?",programmatically make textblock with hyperlink in between text
MVC Redirect to Index from another Controller," I have been looking through trying to find some way to redirect to an Index view from another controller. This is what I tried right now. Now the code I was given to has a ActionLink that links to the page I need to Redirect too. <code>  public ActionResult Index(){ ApplicationController viewModel = new ApplicationController(); return RedirectToAction(""Index"", viewModel);} @Html.ActionLink(""Bally Applications"",""../Application"")",How to redirect to Index from another controller?
different between RoutedEventHandler and Event, What is the difference between and  <code>  this.Loaded += new RoutedEventHandler(MainWindow_Loaded); childWindow.MyEvent += new EventHandler(childWindow_MyEvent);,Difference Between RoutedEventHandler and EventHandler
C# and regular expressions," I have a huge file of code with many lines like this: What i`m trying to do is to find every part of the code with string of cyrilic symbols with another text that i provide. My problem is that i cant seem to make good enought expressions so i can catch the lines.Another problem is that some times the lines contain only one such string but other times they contain 2 or more on one line.Every such string is similar and it look like this: I tried to make it with Regex class but I can't seem to make good enough pattern to the strings. <code>  Enterprise::TextMessageBox::Show(String::Format(S"" :\n\n{0}"", e->Message), S""""); S""some cyrilic symbols""",Matching Cyrillic symbols in C#
Matching cyrilic symbols in C#," I have a huge file of code with many lines like this: What i`m trying to do is to find every part of the code with string of cyrilic symbols with another text that i provide. My problem is that i cant seem to make good enought expressions so i can catch the lines.Another problem is that some times the lines contain only one such string but other times they contain 2 or more on one line.Every such string is similar and it look like this: I tried to make it with Regex class but I can't seem to make good enough pattern to the strings. <code>  Enterprise::TextMessageBox::Show(String::Format(S"" :\n\n{0}"", e->Message), S""""); S""some cyrilic symbols""",Matching Cyrillic symbols in C#
Random object not Disposing in C#," I am working on a smooth terrain generation algorithm in C# and using XNA to display the data.I am making it so it creates a new point halfway between each point per iteration, at a random height between the two. This works OK, and I have set it so that on the second iteration it chooses a random point like in slide two, rather than trying to make a new point between points that are on the same axis.What is happening is that the loop is using the same random value from the previous iteration: http://i.stack.imgur.com/UmWr7.pngThis is not ideal obviously, as it is not a proper random generation.If I use a Thread.Sleep(20) after each point generation it works correctly: http://i.stack.imgur.com/KziOg.pngI don't want to have to use the Sleep workaround if possible as it is very slow, and I would like to use this in real-time. I'm pretty sure this has something to do with the C# garbage collector.Here is my Get Point Code Is the garbage collection a part of the issue?Any suggestions or solutions on solving this?? <code>  Random r = new Random();int x = (p1.X + p2.X) / 2;int y;if (!initial) y = r.Next(Math.Min(p1.Y, p2.Y), Math.Max(p1.Y, p2.Y));else y = r.Next(Math.Min(p1.Y, p2.Y) - Game1.screenHeight / 2, Math.Max(p1.Y, p2.Y) + Game1.screenHeight / 2);return new Point(x, y);",Random object not disposing in C#
C#: How to use session state of web service on client app," I am using a client app to connect to a web service for authenticated user only. Here is simplest example: My web service code: Here is my code on client app (Windows form, not web base): In my example MainForm.m_ccSessionInfo is a static member, I want to keep the session cookies value in this one! However, it don't work :( . The ws.WelcomeMsg() is always return an empty string. <code>  public class TestService : System.Web.Services.WebService{ [WebMethod(EnableSession = true)] public string WelcomeMsg() { return ""Hello: "" + Session[""UserName""] + ""! Welcome to our store.""; } [WebMethod(EnableSession = true)] public void SetUserName(string sName) { Session[""UserName""] = sName; }} private void btnSetName_Click(object sender, EventArgs e){ TestService.TestService ws = new TestService.TestService(); //Create a web service MainForm.m_ccSessionInfo = new System.Net.CookieContainer(); //Create a CookieContainer ws.CookieContainer = MainForm.m_ccSessionInfo; //Set CookieContainer of the web service ws.SetUserName(txtUserName.Text); //Set value of session ws = null;}private void btnWelcome_Click(object sender, EventArgs e){ TestService.TestService ws = new TestService.TestService(); //Create a web service ws.CookieContainer = MainForm.m_ccSessionInfo; //Set CookieContainer back string sWelcome = ws.WelcomeMsg(); //Get value from session property ws = null; System.Diagnostics.Debug.WriteLine(sWelcome); }",Maintain Session While Calling an ASMX Web Service
How to use session state of web service on client app," I am using a client app to connect to a web service for authenticated user only. Here is simplest example: My web service code: Here is my code on client app (Windows form, not web base): In my example MainForm.m_ccSessionInfo is a static member, I want to keep the session cookies value in this one! However, it don't work :( . The ws.WelcomeMsg() is always return an empty string. <code>  public class TestService : System.Web.Services.WebService{ [WebMethod(EnableSession = true)] public string WelcomeMsg() { return ""Hello: "" + Session[""UserName""] + ""! Welcome to our store.""; } [WebMethod(EnableSession = true)] public void SetUserName(string sName) { Session[""UserName""] = sName; }} private void btnSetName_Click(object sender, EventArgs e){ TestService.TestService ws = new TestService.TestService(); //Create a web service MainForm.m_ccSessionInfo = new System.Net.CookieContainer(); //Create a CookieContainer ws.CookieContainer = MainForm.m_ccSessionInfo; //Set CookieContainer of the web service ws.SetUserName(txtUserName.Text); //Set value of session ws = null;}private void btnWelcome_Click(object sender, EventArgs e){ TestService.TestService ws = new TestService.TestService(); //Create a web service ws.CookieContainer = MainForm.m_ccSessionInfo; //Set CookieContainer back string sWelcome = ws.WelcomeMsg(); //Get value from session property ws = null; System.Diagnostics.Debug.WriteLine(sWelcome); }",Maintain Session While Calling an ASMX Web Service
Programatically disable caps lock," I'm using SendKeys in an automation program for work. I've been plodding along, and am now trying to iron out all the bugs that I've created :-)One of which, is that when I used SendKeys.Send(""Test""), if the CapsLock is on, it will produce ""tEST"" as opposed to ""Test"".I've used the following code to attempt to detect the capsLock state, and toggle it if necessary: And then immediately use SendKeys to send some text: Which STILL comes out as: ""tHIS iS aN oVER cAPITALIZED tEST sTRING"".Is there any way to get around this problem?Answered! Just to clarify for anyone else, the problem was resolved by using I first attempted to use: Which did not work at all. <code>  bool tmp = Control.IsKeyLocked(Keys.CapsLock);if (tmp){ keybd_event(0x14, 0x45, KEYEVENTF_EXTENTEDKEY, (UIntPtr)0); keybd_event(0x14, 0x45, KEYEVENTF_EXTENTEDKEY | KEYEVENTF_KEYUP, (UIntPtr)0); //Application.DoEvents(); <-Testing.} SendKeys.SendWait(""This Is An Over Capitalized Test String""); SendKeys.SendWait(""{CAPSLOCK}"" + text); SendKeys.SendWait(""{CAPSLOCK}"");SendKeys.SendWait(""This Is An Over Capitalized Test String"");",Programmatically disable caps lock
C# - assign datetime value to today's date with specific time, I have a variable which is defined as a DateTime. I need to assign it today's date but have the time be 4 PM. How do I do this? <code> ,Assign datetime value to today's date with specific time
how to force exit application?," I have a multi threaded C# application and it has reader writer lock,but it gives a timeout exception on some computers(not being able to acquire a lock in time) and I need to forcefully close all threads.how do I do it without getting any extra exceptions? <code> ",How to force exit application in C#?
Which is better between a readonly modifier and a private setter in C# 4.0?, I've been working on creating a class and suddenly a thought came to my mind of what is the difference between the two codes: AND Can you guys give me idea when to use the following better. thanks. <code>  public readonly string ProductLocation; public string ProductLocation{ get; private set;},Which is better between a readonly modifier and a private setter?
Get country list in other languages beside english," I can get the list of country names using below code, (copied from somewhere i can't remember)My question is, can i get the list of countries in other languages such as Thai ? <code>  /// <summary> /// method for generating a country list, say for populating /// a ComboBox, with country options. We return the /// values in a Generic List<T> /// </summary> /// <returns></returns> public static List<string> GetCountryList() { //create a new Generic list to hold the country names returned List<string> cultureList = new List<string>(); //create an array of CultureInfo to hold all the cultures found, these include the users local cluture, and all the //cultures installed with the .Net Framework CultureInfo[] cultures = CultureInfo.GetCultures(CultureTypes.AllCultures & ~CultureTypes.NeutralCultures); //loop through all the cultures found foreach (CultureInfo culture in cultures) { //pass the current culture's Locale ID (http://msdn.microsoft.com/en-us/library/0h88fahh.aspx) //to the RegionInfo contructor to gain access to the information for that culture RegionInfo region = new RegionInfo(culture.LCID); //make sure out generic list doesnt already //contain this country if (!(cultureList.Contains(region.EnglishName))) //not there so add the EnglishName (http://msdn.microsoft.com/en-us/library/system.globalization.regioninfo.englishname.aspx) //value to our generic list cultureList.Add(region.EnglishName); } return cultureList; }",Get country list in other languages besides english
Using of AspectPriority," I'm using PostSharp 2.1.5.1 and had a warning today: Aspect dependencies (defined on ""MyNamespace.MyAspect.MyVerificationAttribute"") will be disabled from the Starter Edition in future versions. Use the AspectPriority property instead.Seems to me that following line is causing that warning: Could someone point me to a correct example of how to use AspectPriority? Are the following examples up to date?http://www.sharpcrafters.com/blog/post/introducing-postsharp-2-0-3-aspect-dependencies.aspx (section ""Old Good Aspect Priority"")http://www.sharpcrafters.com/blog/post/Day-3-Applying-Aspects-with-Multicasting-Part-2.aspx (section ""Aspect Priority"")Thanks. <code>  [AspectRoleDependency(AspectDependencyAction.Order, AspectDependencyPosition.After, StandardRoles.Tracing)]",Usage of AspectPriority
Docked multiline textbox is covered by StatusStrip., I am having a form in which I have multiple line textbox and status strip both docked to the bottom of the form.Textbox must be docked so it can be resizable while the whole form is resizable.The problem is that the status strip is covering the textbox on the bottom of the from covering scroll bars down arrow.Is there any way to make textbox docked to the bottom while still displaying above the status strip?Regards. <code> ,Docked multiline textbox is covered by StatusStrip
The return type of the members on an Interface Implementation must match exactly the inferface definition?," According to CSharp Language Specification. An interface defines a contract that can be implemented by classes and structs. An interface does not provide implementations of the members it definesit merely specifies the members that must be supplied by classes or structs that implement the interface.So I a have this: And what I mean is. ""I have a contract with a property as a collection of integers that you can enumerate"".Then I want the following interface Implementation: And I get the following compiler error: 'Test' does not implement interface member 'ITest.Integers'. 'Test.Integers' cannot implement 'ITest.Integers' because it does not have the matching return type of 'System.Collections.Generic.IEnumerable'.As long as I can say my Test class implement the ITest contract because the List of int property is in fact an IEnumerable of int.So way the c# compiler is telling me about the error? <code>  interface ITest{ IEnumerable<int> Integers { get; set; }} class Test : ITest{ public List<int> Integers { get; set; }}",The return type of the members on an Interface Implementation must match exactly the interface definition?
very basic linq to sql query for a real beginner, Trying to learn Linq using LinqPad and getting frustated with how to start on it. Let's say I want to write a C# Expression and a C# statment where I have a table in SQL server named Products and I want to pull all rows where price is greater then 50. How would yo write it? <code> ,Steps for a beginner to run very basic linq to sql query using Linqpad
No boxing or conversion for generic Type parameter," What's wrong with the following code? I cannot see the reason for the error mentioned below. I'm using Mono, could this be a bug in Mono, and will it compile without errors in VStudio? I'm getting the compile error: /ClientFactory.cs(14,14): Error CS0314: The type `T' cannot be used as type parameter `T' in the generic type or method `.ClientFactory.CreateClient(string, string)'. There is no boxing or type parameter conversion from `T' to `System.ServiceModel.ClientBase' (CS0314) <code>  public static class ClientFactory { public static T CreateClient<T, I>() /* error here */ where T : ClientBase<I>, I where I : class { return CreateClient<T, I>(null, null); } public static T CreateClient<T, I>(string endpointConfigurationName) /* error here */ where T : ClientBase<I>, I where I : class { return CreateClient<T, I>(endpointConfigurationName, null); } public static T CreateClient<T, I>(string endpointConfigurationName, string remoteAddress) /* error here */ where T : ClientBase<I>, I where I : class { return CreateClient<T, I>(endpointConfigurationName, remoteAddress, Settings.Default.UserName, Settings.Default.Password); } public static T CreateClient<T, I>(string endpointConfigurationName, string remoteAddress, string userName, string password) /* NO error here, this method compiles fine */ where T : ClientBase<I>, I where I : class { T client; /* get client instance */ /* do stuff with it */ return client; } }",No boxing or type parameter conversion for generic Type parameter with Mono
No boxing or type parameter conversion for generic Type parameter," What's wrong with the following code? I cannot see the reason for the error mentioned below. I'm using Mono, could this be a bug in Mono, and will it compile without errors in VStudio? I'm getting the compile error: /ClientFactory.cs(14,14): Error CS0314: The type `T' cannot be used as type parameter `T' in the generic type or method `.ClientFactory.CreateClient(string, string)'. There is no boxing or type parameter conversion from `T' to `System.ServiceModel.ClientBase' (CS0314) <code>  public static class ClientFactory { public static T CreateClient<T, I>() /* error here */ where T : ClientBase<I>, I where I : class { return CreateClient<T, I>(null, null); } public static T CreateClient<T, I>(string endpointConfigurationName) /* error here */ where T : ClientBase<I>, I where I : class { return CreateClient<T, I>(endpointConfigurationName, null); } public static T CreateClient<T, I>(string endpointConfigurationName, string remoteAddress) /* error here */ where T : ClientBase<I>, I where I : class { return CreateClient<T, I>(endpointConfigurationName, remoteAddress, Settings.Default.UserName, Settings.Default.Password); } public static T CreateClient<T, I>(string endpointConfigurationName, string remoteAddress, string userName, string password) /* NO error here, this method compiles fine */ where T : ClientBase<I>, I where I : class { T client; /* get client instance */ /* do stuff with it */ return client; } }",No boxing or type parameter conversion for generic Type parameter with Mono
Number of query values and destination fields are not the same in c#," I am getting an error while inserting data into a database.The error is: ""Number of query values and destination fields are not the same"".Insert code: What am I doing wrong? <code>  OleDbConnection vconn = new OleDbConnection(""Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\Users\\Mutyyba\\Documents\\Database1.accdb"");vconn.Open();string name = textBox1.Text;string address = textBox3.Text;int rollno = Convert.ToInt32(textBox2.Text);string vquery = ""insert into Table1 values(@vname,@vrollno,@vaddress)"";OleDbCommand vcomm = new OleDbCommand(vquery, vconn);vcomm.Parameters.AddWithValue(""@vname"", name);vcomm.Parameters.AddWithValue(""@vrollno"", rollno);vcomm.Parameters.AddWithValue(""@vaddress"", address);vcomm.ExecuteNonQuery();MessageBox.Show(""your record has been recorded sucessfully!"");vconn.Close();",Number of query values and destination fields are not the same error
"Get actual return type from a Func<T, object> instance"," I have a method that accepts a Expression<Func<T, object>> instance. I want to get at the actual data type being returned by a specific expression instance, rather than object.I can get it to work for direct property references, so if I pass in the expression x => x.IntegerProperty I can get a Type reference for an integer. This approach requires converting it to a MemberExpression.However, I can't get it to work for arbitrary expressions. For instance, if the expression is x => x.IntegerProperty.ToString() I want to get a Type reference for a string. I can't compile this to a MemberExpression, and if I just .Compile() it and check the return type I get ""object"".How can I look at the specific expression instance and derive the actual return type? <code> ","Get actual return type from a Expression<Func<T, object>> instance"
C# WPF datagridview calculated columns, I am trying to transfer my excel app to WPF datagrid. I am going to enter data to Column A and in column B I would like to make calculation taking previus cell and current cell of A column and add Column B previus cell. calculation example : B2 = B1 + (A2-A1). What is best approach of doing so?  <code> ,DataGrid calculated columns
Web error: PLS-00306: wrong number or types of arguments (C# passing stored procedure to Oracle)," Have been fighting this for two days and am very frustrated but feel like I am making progress. After reviewing Oracle's online docs I am here. Receiving the following error upon code execution: ORA-06550: line 1, column 15: PLS-00306: wrong number or types of arguments in call to 'P_SALTEDHASH' ORA-06550: line 1, column 7: PL/SQL: Statement ignoredStored procedure looks like this: My code: <code>  PROCEDURE stored_procedure_name ( p_passwd IN VARCHAR2, p_salt IN VARCHAR2, p_saltedhash_passwd OUT VARCHAR2 ) string stored_procedure_name = ""stored_procedure_name""; // create the command object OracleCommand cmd = conn.CreateCommand(); cmd.Connection = conn; cmd.CommandType = CommandType.StoredProcedure; cmd.CommandText = stored_procedure_name; cmd.BindByName = true; //Oracle Parameters necessary for the p_saltedhash function cmd.Parameters.Add(""p_passwd"", p_passwd); cmd.Parameters.Add(""p_salt"", p_salt); OracleParameter p_saltedhash_passwd = new OracleParameter(""p_saltedhash_passwd"", OracleDbType.Varchar2); p_saltedhash_passwd.Direction = ParameterDirection.ReturnValue; cmd.Parameters.Add(p_saltedhash_passwd); // execute the pl/sql block cmd.ExecuteNonQuery(); Response.Write(""Pin hash is: "" + p_saltedhash_passwd);`",ORA-06550   wrong number or types of arguments when calling Oracle stored procedure
"Meaning of ""%"" operation in C#"," Recently I discovered that C#'s operator % is applicable to double. Tried some things out, and after all came up with this test: Everything in this test works.Is a % b always equivalent to a - b*Math.Round(a/b)? If not, please explain to me how this operator really works.EDIT: Answering to James L, I understand that this is a modulo operator and everything. I'm curious only about how it works with double, integers I understand. <code>  class Program{ static void test(double a, double b) { if (a % b != a - b * Math.Truncate(a / b)) { Console.WriteLine(a + "", "" + b); } } static void Main(string[] args) { test(2.5, 7); test(-6.7, -3); test(8.7, 4); //... }}","Meaning of ""%"" operation in C# for the numeric type double"
"Meaning of ""%"" operation in C# for the numric type double"," Recently I discovered that C#'s operator % is applicable to double. Tried some things out, and after all came up with this test: Everything in this test works.Is a % b always equivalent to a - b*Math.Round(a/b)? If not, please explain to me how this operator really works.EDIT: Answering to James L, I understand that this is a modulo operator and everything. I'm curious only about how it works with double, integers I understand. <code>  class Program{ static void test(double a, double b) { if (a % b != a - b * Math.Truncate(a / b)) { Console.WriteLine(a + "", "" + b); } } static void Main(string[] args) { test(2.5, 7); test(-6.7, -3); test(8.7, 4); //... }}","Meaning of ""%"" operation in C# for the numeric type double"
Is SimpleDateFormat class in Java equivalent to Custom Date and Time Format Strings in C#?," Anyone knows an equivalent class of Java's SimpleDateFormat in C#? I wonder if i can convert the following java code using Custom Date and Time Format Strings in C# <code>  SimpleDateFormat format = new SimpleDateFormat(""EEE, dd MMM yyyy HH:mm:ss z"", Locale.US); TimeZone tz = TimeZone.getDefault();format.setTimeZone(TimeZone.getTimeZone(""GMT""));str = format.format(new Date());",What is the equivalent of Java's SimpleDateFormat class in C#?
C# - The performance cost to using ref instead of returning same types?," Hi this is something that's really bothering me and I'm hoping someone has an answer for me. I've been reading about ref (and out) and I'm trying to figure out if I'm slowing down my code using refs. Commonly I will replace something like: with because to my eyes this is easier to read AND code than this I know precisely what I'm doing on the code using ref, as opposed to returning a value. However, performance is something I take seriously, and apparently dereferencing and cleanup is a lot slower when you use refs.What I'd like to know is why every post I read says there is very few places you would typically pass a ref (I know the examples are contrived, but I hope you get the idea), when it seems to me that the ref example is smaller, cleaner and more exact.I'd also love to know why ref really is slower than returning a value type - to me it would seem to me, if I was going to edit the function value a lot before returning it, that it would be quicker to reference the actual variable to edit it as opposed to an instance of that variable shortly before it gets cleaned from memory. <code>  int AddToInt(int original, int add){ return original+add; } void AddToInt(ref int original, int add){ original+=add; } // 1st parameter gets the result AddToInt(ref _value, _add); _value = AddToInt(_value, _add);",The performance cost to using ref instead of returning same types?
"string val = Request.QueryString[""foo""]; vs. string val = Request.QueryString[""foo""] as string;"," I need explanations.. I using C#.NET to web applications, I always write: and then What's the difference: I was advised to do: What's the difference? <code>  string val = Request.QueryString[""foo""]; if(!string.IsNullOrEmpty(val)) string val = Request.QueryString[""foo""]; string val = Request.QueryString[""foo""] as string;if(!string.IsNullOrEmpty(val)) ",How better check Request.QueryString string parameter for null?
MVC: How to access events of view from Controller," My question is regarding implementing MVC pattern in winformsI learned that the controller object is responsible for handling the events raised in the view. Can any one please tell me how can the controller reacts to the text input or button press event in the view? I mean how can the controller know that some event happened without it being handled in the view as these controls(textbox,button) are private to view. <code> ", How to access events of View from Controller
Clarification aboout .net framework," So I'm working on a project which is built in the version visual studio 2005 under the framework 2.0. Now I moved the project to the new version of the visual studio 2010 sp1 under the version and start to realize they are throwing this errors and warnings with the dependencies, for example Bring me the consequence that the application doesn't read the reference that I added, but changing the framework. .Net framework 4.0 the problem was solved. Testing I change them to .net framework 4.0 client profile and I realized the build errors and warnings appear again.Now my question it's why setting .net 4.0 work and not with the client profile?? I need a good explanation because I'm not an expert in this part.  <code>  Warning 1 could not be resolved because it has a dependency on ""System.Data.OracleClient, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" which is not in the currently targeted framework "".NETFramework,Version=v4.0,Profile=Client"". ",Why isn't System.Data.OracleClient available in .NET 4.0 Client Profile?
What does Lambda Exprresion Compile() method do?," I am trying to understand AST in C#. I wonder, what exactly Compile() method from this example does. To prevent misunderstandings, I understand the Expression.Lambda and Expression.Call constructs. What interests me is the Compile() method. Does it somehow produce real MSIL? Can I see the MSIL? <code>  // Some code skipped Expression<Func<string, int, int, string>> data = Expression.Lambda<Func<string, int, int, string>>( Expression.Call(s, typeof(string).GetMethod(Substring, new Type[] { typeof(int), typeof(int) }), a, b), s, a, b ); Func<string, int, int, string> fun = data.Compile(); ",What does Lambda Expression Compile() method do?
mvc3 embeddable blog engine, I have a website that I would like to embed a blog into. I don't want a seperate website living in a subdirectory. I already have OpenId Authentication and Facebook OAuth implemented and a lot of functionality in my web app but I don't have too much content. I would like to add an easy way to author content using Windows Live writer but would like to maintain a consistent look/feel in my site. Are there any blog engines in ASP.NET MVC that can be embedded or added as an MVC area? <code> ,ASP.NET MVC 3 embeddable blog engine
Is it possible to run an XNA game with .NET or XNA installed?," I've developed an XNA game that I'd like to show a few people at my school, but unfortunately the school computers don't have XNA or the right version of the .NET frameworks installed. And since they are school computers, I can't just just install them. My questions is whether it is possible or not to run my game without these installed. I was hoping that I might be able to just copy some DLLs or something onto my flash drive or something similar. <code> ",Is it possible to run an XNA game without .NET or XNA installed?
Redirecting to another page in asp.net MVC using javascript/Jquery," I want to redirect from one page to another page in ASP.NET MVC 3.0 using JavaScript/jQuery/Ajax. On button click event I have written JavaScript code like below. My controller code is like this: When I click on a button it is calling the Details action inside BranchController, but it doesn't return to the Details view.I didn't get any error or exception. It's showing status 200 OK in Firebug. What is wrong in my code and how can I redirect to the Details view page? <code>  function foo(id){ $.post('/Branch/Details/' + id);} public ViewResult Details(Guid id){ Branch branch = db.Branches.Single(b => b.Id == id); return View(branch);}",Redirecting to another page in ASP.NET MVC using JavaScript/jQuery
Right click menu in Console app - C#," I've searched a bit, but I can't seem to figure out how to make the console menu appear when right clicking in the console window in my own Console app like the following:How do I make the menu appear in my own console app when right clicking the console window?And yes, I do know that I can use the upper-left icon to make the menu functions appear, but I'm looking for the right-click solution!(The problem seems to appear when I execute the .exe file directly instead of running it through CMD.EXE) <code> ",How do I make the right click menu in a Console app appear?
Right click menu in Console app," I've searched a bit, but I can't seem to figure out how to make the console menu appear when right clicking in the console window in my own Console app like the following:How do I make the menu appear in my own console app when right clicking the console window?And yes, I do know that I can use the upper-left icon to make the menu functions appear, but I'm looking for the right-click solution!(The problem seems to appear when I execute the .exe file directly instead of running it through CMD.EXE) <code> ",How do I make the right click menu in a Console app appear?
C#: Constraining a generic type argument to numeric types," I'm defining a generic type: What I would really like to do is constrain T to be a numeric type (one of the ints or floats.) There's no INumeric in the CLR. Is there an interface or collection of interfaces that could be used here to constrain the type to one of the boxed numeric classes? <code>  public class Point<T> where T : IConvertible, IComparable",Constraining a generic type argument to numeric types
empty a C# ListView," I have a simple Windows form containing among other components, a ListView object named list. On the form, a button enables me to empty the list on click with list.Items.Clear(). This works fine.Now I have a separate class Test, whose method update() is called on some events external to the form. At construction of the form, I pass a reference to the list using the SetList method. In debug mode, update() is called on the events that I trigger, and its content executed, but my list isn't cleared. Why is this? The reference is properly set, I checked. when I look closer at my list being modified by putting breakpoints in update(), list is cleaned and stays cleaned. It really seems like it is another list being modified, but I have only one and never do any new on it... ???? <code>  class Test{ private ListView list; public void setList(ListView list) { this.list = list; } public void update() { this.list.Items.Clear(); }}",Empty a ListView
Is this a valid way to simplify my Azure classes," I have many Azure classes containing fields for date and modified by tracking. Fields such as: I want to avoid repetition so I was considering creating a class to contain these such as this: For my data classes then instead of having them inherit from TableServiceEntity I would like to set these up as follows: Is this a valid and sensible way to add additional information to the fields. The reason I am asking here is because I am planning to do this to a lot of classes and I want to ensure I do the right thing. <code>  [DisplayName(""Created By"")]public string CreatedBy { get; set; }[DisplayName(""Modified By"")]public string ModifiedBy { get; set; } public class TableServiceEntityRowInfo : TableServiceEntity { [DisplayName(""Created By"")] public string CreatedBy { get; set; } [DisplayName(""Modified By"")] public string ModifiedBy { get; set; }} public class MyClass : TableServiceEntityRowInfo {}",Is this a valid way to simplify my inherited classes?
Regex Split sentence to words while persevering white space C#," I'm using Regex.Split() to take the user input and turn it into individual words in a list but at the moment it removes any spaces they add, I would like it to keep the whitespace. <code>  string[] newInput = Regex.Split(updatedLine, @""\s+"");",Regex.Split() sentence to words while preserving whitespace
Get values from an enum into a generic list in C#, I don't know how to convert the following line from VB to C#: My version doesn't work: The best overloaded method match for 'System.Collections.Generic.List.List(System.Collections.Generic.IEnumerable)' has some invalid argumentsThe constructor-parameter doesn't take it that way - what cast (or else) am I missing?For clarification: It is wrapped up within the following generic method <code>  Dim values As New List(Of T)(System.Enum.GetValues(GetType(T))) List<T> values = new List<T>(System.Enum.GetValues(typeof(T))); public static void BindToEnum<T>(){ List<T> values = new List<T>(System.Enum.GetValues(typeof(T))); //...},Get values from an enum into a generic List
Why WPF editable ComboBox caret is going outside od textbox," I'm trying to build a template for combobox based on msdn examples but I have strange error. More precisely if I wrote long text in normal combobox the text is moving to left and we see caret all the time. However in msdn examples when I wrote long text caret is moving outside of combo. Here is picute how it look like:When I select text it looks like this:I have used examples from Framework 3.5 and Framework 4 combobox help and after copy and paste I'm keep getting the same situation. Thanks for any help.EDIT: <code>  <Window x:Class=""ComboBoxTest.MainWindow"" xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" Title=""Framework 3.5"" Height=""350"" Width=""525""> <Window.Resources> <ControlTemplate x:Key=""ComboBoxToggleButton"" TargetType=""ToggleButton""> <Grid> <Grid.ColumnDefinitions> <ColumnDefinition /> <ColumnDefinition Width=""20"" /> </Grid.ColumnDefinitions> <Border x:Name=""Border"" Grid.ColumnSpan=""2"" CornerRadius=""2"" Background=""White"" BorderBrush=""Black"" BorderThickness=""1"" /> <Border Grid.Column=""0"" CornerRadius=""2,0,0,2"" Margin=""1"" Background=""#FFF"" BorderBrush=""Black"" BorderThickness=""0,0,1,0"" /> <Path x:Name=""Arrow"" Grid.Column=""1"" Fill=""#444"" HorizontalAlignment=""Center"" VerticalAlignment=""Center"" Data=""M 0 0 L 4 4 L 8 0 Z"" /> </Grid> <ControlTemplate.Triggers> <Trigger Property=""ToggleButton.IsMouseOver"" Value=""true""> <Setter TargetName=""Border"" Property=""Background"" Value=""Black"" /> </Trigger> <Trigger Property=""ToggleButton.IsChecked"" Value=""true""> <Setter TargetName=""Border"" Property=""Background"" Value=""LightGray"" /> </Trigger> <Trigger Property=""IsEnabled"" Value=""False""> <Setter TargetName=""Border"" Property=""Background"" Value=""#EEE"" /> <Setter TargetName=""Border"" Property=""BorderBrush"" Value=""#AAA"" /> <Setter Property=""Foreground"" Value=""#888"" /> <Setter TargetName=""Arrow"" Property=""Fill"" Value=""#888"" /> </Trigger> </ControlTemplate.Triggers> </ControlTemplate> <!-- something is wrong here but what?? --> <ControlTemplate x:Key=""ComboBoxTextBox"" TargetType=""TextBox""> <Border x:Name=""PART_ContentHost"" Focusable=""False"" /> </ControlTemplate> <Style x:Key=""MsComboBox"" TargetType=""ComboBox""> <Setter Property=""SnapsToDevicePixels"" Value=""true"" /> <Setter Property=""OverridesDefaultStyle"" Value=""true"" /> <Setter Property=""ScrollViewer.HorizontalScrollBarVisibility"" Value=""Auto"" /> <Setter Property=""ScrollViewer.VerticalScrollBarVisibility"" Value=""Auto"" /> <Setter Property=""ScrollViewer.CanContentScroll"" Value=""true"" /> <Setter Property=""MinWidth"" Value=""120"" /> <Setter Property=""MinHeight"" Value=""20"" /> <Setter Property=""Template""> <Setter.Value> <ControlTemplate TargetType=""ComboBox""> <Grid> <ToggleButton Name=""ToggleButton"" Template=""{StaticResource ComboBoxToggleButton}"" Grid.Column=""2"" Focusable=""false"" IsChecked=""{Binding Path=IsDropDownOpen,Mode=TwoWay,RelativeSource={RelativeSource TemplatedParent}}"" ClickMode=""Press""></ToggleButton> <ContentPresenter Name=""ContentSite"" IsHitTestVisible=""False"" Content=""{TemplateBinding SelectionBoxItem}"" ContentTemplate=""{TemplateBinding SelectionBoxItemTemplate}"" ContentTemplateSelector=""{TemplateBinding ItemTemplateSelector}"" Margin=""3,3,23,3"" VerticalAlignment=""Center"" HorizontalAlignment=""Left"" /> <TextBox x:Name=""PART_EditableTextBox"" Style=""{x:Null}"" Template=""{StaticResource ComboBoxTextBox}"" HorizontalAlignment=""Left"" VerticalAlignment=""Center"" Margin=""3,3,23,3"" Focusable=""True"" Background=""Transparent"" Visibility=""Hidden"" IsReadOnly=""{TemplateBinding IsReadOnly}"" /> <Popup Name=""Popup"" Placement=""Bottom"" IsOpen=""{TemplateBinding IsDropDownOpen}"" AllowsTransparency=""True"" Focusable=""False"" PopupAnimation=""Slide""> <Grid Name=""DropDown"" SnapsToDevicePixels=""True"" MinWidth=""{TemplateBinding ActualWidth}"" MaxHeight=""{TemplateBinding MaxDropDownHeight}""> <Border x:Name=""DropDownBorder"" Background=""Black"" BorderThickness=""1"" BorderBrush=""#888"" /> <ScrollViewer Margin=""4,6,4,6"" SnapsToDevicePixels=""True""> <StackPanel IsItemsHost=""True"" KeyboardNavigation.DirectionalNavigation=""Contained"" /> </ScrollViewer> </Grid> </Popup> </Grid> <ControlTemplate.Triggers> <Trigger Property=""IsEditable"" Value=""true""> <Setter Property=""IsTabStop"" Value=""false"" /> <Setter TargetName=""PART_EditableTextBox"" Property=""Visibility"" Value=""Visible"" /> <Setter TargetName=""ContentSite"" Property=""Visibility"" Value=""Hidden"" /> </Trigger> </ControlTemplate.Triggers> </ControlTemplate> </Setter.Value> </Setter> </Style> </Window.Resources> <Grid> <ComboBox Height=""23"" HorizontalAlignment=""Left"" Margin=""12,12,0,0"" Name=""comboBox1"" VerticalAlignment=""Top"" IsEditable=""True"" Width=""185"" Style=""{StaticResource MsComboBox}"" /> <ComboBox Height=""23"" HorizontalAlignment=""Left"" Margin=""12,41,0,0"" Name=""comboBox2"" VerticalAlignment=""Top"" IsEditable=""True"" Width=""185"" /> </Grid></Window>",Why is the caret in this editable ComboBox exceeding the bounds?
Add a single line to the top of text file c#," My app pulls data and appends it to a text file but I need to find out how I can programmatically look at the first line of the text file and see if it matches the following text: DateTime,VirtualIP,VirtualPort,VirtualName,DestinationIP,DestPort,Status,DesiredIf it does then continue doing the normal function (snippet below), if the first line is not the same as above then I want to insert the above in the first line without overwriting whats currently there. How can I do this? (essentially pushing everything one line down so I can add what I want on the first line)...btw this is being saved as a csv file that can be opened in excel. This file does not get deleted a lot but in the event that it does I want it to have the correct column names at the top. ie: <code>  try{ // ... for (int j = 0; j < memberStatus.Result.Count; j++) { VirtualMemberStatus status = memberStatus.Result[j]; //text += String.Format(""Name: {4}, Member: {0}:{1}, Status: {2}, Desired: {3}"" + Environment.NewLine, status.Member.Address, status.Member.Port, status.EffectiveStatus, status.DesiredStatus, virtualKey.Key); text += String.Format(""{5},{4},{0},{1},{2},{3}"" + Environment.NewLine, status.Member.Address, status.Member.Port, status.EffectiveStatus, status.DesiredStatus, virtualKey.Key.Replace("":"", "",""), DateTime.UtcNow); }}catch{ //ERROR CODE 2 //MessageBox.Show(""Error occurred, check device name (case senstive) and admin group. This error may also occur due to connection loss, try again.""); errors += String.Format(""{0} Error Code: 2, Error occurred, check device name (case senstive) and admin group. This error may also occur due to connection loss, try again."" + Environment.NewLine, DateTime.UtcNow);}this.resultsTextBox.Text = text; DateTime,VirtualIP,VirtualPort,VirtualName,DestinationIP,DestPort,Status,Desired",Add a single line to the top of text file
c# visual studio related," When you type ""this."" , you usually get all the routines, events, and more... of the current class you are in. And when you simply stand over one of the routines in the long list without choosing one, you usually get a description next to it. How can I do that ? Let assume I have a class called CAR with two routines: speed_up(), and brake().How can I make the person using my class to see a description of the two functions when he types: <code>  CAR mycar = new CAR();mycar.",How to get intellisense for custom created classes?
"I'm using too many dictionaries within dictionaries in my code, is that a code smell?"," I'm using a lot of dictionary collections that contain other dictionary collections like: I'm looping through these maps, and passing them around in parameters in my code.This seems like a bad idea since you can't really extend the nature of these collections now.Should I wrap these around in a class? <code>  Dictionary<Guid, List<string>>()Dictionary<Guid, Dictionary<Guid, List<string>>>()",Using many dictionaries within dictionaries in my code
How to choose a good namespace name?," English in not my native language, therefore it is a little more difficult to pick a good name for a namespace. Are there any best practices, conventions or rules I should adhere to?One example to make you see my problem a bit better:We have a set of classes that have to do with the way a company is organized (we can create organizational charts with it). Currently the namespace is CFW.CoreSystem.Organizational. Is this a good name?Comments are most welcome!(There are many questions about good class names, but this question is about namespaces!)EditWhat is linguistically the best way to name a namespace? (CFW.CoreSystem.Configuration is better than CFW.CoreSystem.Configurables). <code> ",How to choose a good namespace name? [Linguistically]
Minimilist LINQ approach - System.NullReferenceException, I'm wondering if it's possible to get this working: It works until there are no more images for that product at which point it throws... I made a fix for it but I'd prefer to keep it as minimal as possible and stay in Linq so was hoping there was a way to get my initial statement to function.The ugly fix: <code>  product.PrimaryImage = db.ProductImages .Where(p => p.Product.ID == product.ID) .OrderBy(p => p.Order ?? 999999) .ThenBy(p => p.ID) .FirstOrDefault() .Name;db.SaveChanges(); System.NullReferenceException: Object reference not set to an instance of an object. ProductImages primaryProductImage = db.ProductImages.Where(p => p.Product.ID == product.ID).OrderBy(p => p.Order ?? 999999).ThenBy(p => p.ID).FirstOrDefault();string primaryImage = (primaryProductImage != null) ? primaryProductImage.Name : null;product.PrimaryImage = primaryImage;db.SaveChanges();,Minimalist LINQ approach - System.NullReferenceException
"Is ""yield keyword"" useful?", The yield keyword documentation says: The yield keyword signals to the compiler that the method in which it appears is an iterator block.I have encountered code using the yield keyword outside any iterator block. Should this be considered as a programing mistake or is it just fine?EDIT Sorry forgot to post my code: Thanks. <code>  int yield = previousVal/actualVal;return yield; // Should this be allowed!!!???,"Is ""yield keyword"" useful outside of an iterator block?"
Casting float to decimal looses prescision in C#," In C# 4.0, the following cast behaves very unexpectedly: Casting to double works just fine: Is this by design? <code>  (decimal)1056964.63f1056965 (double)1056964.63f1056964.625(decimal)(double)1056964.63f1056964.625",Casting float to decimal loses precision in C#
separate string using string.format() function or LINQ," Is there a way to change ""ABCDEFGHIJKLMNOP"" to ""ABCD-EFGH-IJKL-MNOP"" using string.format() function or perhaps LINQ ?I am using this statement is there a better and clearer way to accomplish this? <code>  Out= String.Format(""{0}-{1}"", String.Format(""{0}-{1}-{2}"", In.Substring(0, 4), In.Substring(4, 4), In.Substring(8, 4)), In.Substring(12, 4)); ",What is the best way to separate string using string.format() function or LINQ ?
Your best code improvements using LINQ," I've been reading about LINQ to Objects, and now my colleagues want me to present it to them. Now, I have an OK understanding of the operators and the syntax choices, but I've heard you can avoid heavy nested loops by using LINQ. I'm having trouble coming up with a good set of ""before and after"" code listings to demonstrate this though. I found a great example of sorting and grouping with and without LINQ in Magennis' book, and he also has an example of writing xml. But what about those nested loops? Is this even a realistic claim, given that we usually need a foreach loop or two to iterate over the results of the query anyway?If anyone can explain this idea to me (ideally with specific examples), I would greatly appreciate it. <code> ",How can I use LINQ to avoid nested loops?
Request for an example of using LINQ to avoid nested loops," I've been reading about LINQ to Objects, and now my colleagues want me to present it to them. Now, I have an OK understanding of the operators and the syntax choices, but I've heard you can avoid heavy nested loops by using LINQ. I'm having trouble coming up with a good set of ""before and after"" code listings to demonstrate this though. I found a great example of sorting and grouping with and without LINQ in Magennis' book, and he also has an example of writing xml. But what about those nested loops? Is this even a realistic claim, given that we usually need a foreach loop or two to iterate over the results of the query anyway?If anyone can explain this idea to me (ideally with specific examples), I would greatly appreciate it. <code> ",How can I use LINQ to avoid nested loops?
How To Make A TextBox Accept Only Alphabets?, How can I make a TextBox only accept alphabetic characters with spaces? <code> ,How to make a TextBox accept only alphabetic characters?
C# - Save List<T> to XML file," I want to save records fetched from database in an XML file,take x number of records from XML file into a custom collection List<T>process them and save updated items back into XML file.'T' is a simple object with value type properties, something like - Please guide me how can I save custom collection List<T> to XML file and vice-versa?Also, because I am not sending out this XML file, will it make sense to go for XmlSerializer as suggested in some of the replies? <code>  public class T{ public int Id {get; set;} public string property1 {get; set;} public string property2 {get; set;}}",Save List<T> to XML file
"Rhino Mocks recieve argument, modify it and return?"," I'm trying to write something like this: I want to get actual object that passed to mock, modify it and return back.Is this scenario possible with Rhino Mocks? <code>  myStub.Stub(_ => _.Create(Arg<Invoice>.It.Anything)).Callback(i => { i.Id = 100; return i; });","Rhino Mocks receive argument, modify it and return?"
How to properly architect a decoupled design," I am working on a game project using Microsoft XNA framework, although this question is a generic one that involves decoupling of classes/systems.Let's say i have a class (simplified to suit this example) as shown here: I would like to reuse as much code as i can between multiple platforms that use C#.The problem of directly referncing the Color struct is that this type is defined in the XNA assemblies, creating a strong coupling (or dependency) between my code and XNA.The other framework i will be using may (or may not) have its own Color object, with its own set of properties and API.I would like to have the same source file ""know"" to use either the XNA or other framework's implementation automagically.I know other types of decoupling methods such as IoC, but that would mean i would be plugging in different versions of a system/class, instead of reusing the same class in different contexts.Is this even possible to do? how would u suggest to keep such a system portable?I've seen some cases (in native C++ development) where you would define a set of classes that mirror the classes the framework you're using has (for example here - define Color again), and so it is possible to ""re-map"" this later on to use different classes, upon need.Another option is to mess around using #IFDEF to play with the using statements in the header of the class (switching from XNA to other platforms).What is the best alternative in this case? <code>  public class GameCell{ public Color Color { get; set; }}",How to properly decouple classes from frameworks (source level decoupling)
getting System.Data.DataRowView while getting value from combobox c#," I'm trying to get data from database according to the item selected in the ComboBox but when I try to access the selected ComboBox item it gives me ""System.Data.DataRowView"" [...?]I did the same thing with a simple select query in another function and that works fine but I don't know why it doesn't work in this query: Can anybody tell me what might be the problem? <code>  _dataAdapter.SelectCommand.CommandText = ""SELECT lt.Name FROM Leader as lt LEFT JOIN Material as mt ON lt.Student_id=mt.lead_id where lt.Name="" + ""'"" + cmbLeader.SelectedItem.ToString() + ""'"";",Getting System.Data.DataRowView while getting value from ComboBox
C# + MS SQL ExecuteScalar() not returning last inserted id," I have the following function that executes an query and returns true on success and false on failure. No I wanted to extend the method so that with every insert query that is fired, the class var insertId contains the ID of the last inserted row.The problem is that insertId is always 0, so somehow the executeScalar() is not returning the ID.Any ideas? Or other solutions to get the ID of the last insert query.... <code>  public int insertId; public bool executeCommand(string q) { q += ""; SELECT @@IDENTITY AS LastID""; bool retour = true; SqlConnection myCon = new SqlConnection(Settings.DSN); SqlCommand cmd = new SqlCommand(q, myCon); try { cmd.Connection.Open(); insertId = (int)cmd.ExecuteScalar(); if (insertId > 0) { MessageBox.Show(insertId.ToString()); } myCon.Close(); } catch (Exception ex) { this.error = ex.Message; retour = false; } return retour; }",C# + SQL Server ExecuteScalar() not returning last inserted id
I want to save svg image rendered by a javascript to local disk as .png file. C#," I am new to SVG and not an advanced user of JavaScript. I have a webpage with svg content dynamically rendered by javascript. In Internet Explorer when I right click on the svg content, I get option ""Save Picture As"" and I am able to save the content as png or svg.How do I programatically do it by having a button and allow user to save the content in png on to their machine. <code> ",Save svg image rendered by a javascript to local disk as .png file
C# Many instances of a Singleton objetc," I'm having an issue with the Singleton pattern.It is really weird, but it looks like there are two or three instances of my Singleton Pattern.My website, is an actions site, with timers and I'm handling those timers and prices with my Singleton Object.What is happening is that some people see some prices, and other people see other prices always when they are in different networks.For example, In my office, my people see some auction at 0.56 cents, everybody sees the same, but in another network, for example, my house, I see 0.55 cents and also the timers have different values.Having said this, I've tested my Singleton, by generating a GUID and logging it in my log file. Here is some code In this code, I generate the token on the constructor, and log the creation of a new Singleton, then... in the SomeAction method, I log who is doing that action.After this, we made a couple of tests and downloaded the log file.To my surprise, I see only one ""New Singleton Instance bla"" which is correct. but then, many calls to the SomeAction Method with different GUIDs, which is weird.I checked that object is only created in the static constructor, and I also checked that there is no manual creation anywhere.For more information, this only happens on my production server, which is a goDaddy hosting. I've asked if there is more than one application pool for my website and they say there is only one app Pool. <code>  public class Singleton{ private static Singleton instance; private static System.Threading.Mutex mutex; System.Guid token; private Singleton() { token = System.Guid.NewGuid(); Logger.Log(""New singleton Instance"" + token.toString()); } static Singleton() { instance = new Singleton(); mutex = new System.Threading.Mutex(); } public static Singleton Acquire() { mutex.WaitOne(); return instance; } // Each call to Acquire() requires a call to Release() public static void Release() { mutex.ReleaseMutex(); } public void SomeAction() { Logger.Log(token.toString() + "" - SomeAction""); }}",C# Many instances of a Singleton object
convert svg to image programatically," I'm trying to convert my svg to an imageI've been looking into several tools and still can't make this happen :(1. SVG rendering enginebut I'm having trouble with it since it has no documentationthis is my code: or this: neither works!I get the error: The problem seems that svgDocument is null!2. Inkscapemy code: but nothing happen!! i think im missing something to save the image instead of RewritePath()if u have a better solution for me plz post it with an example on how to use it,thanksthis is my svg: <code>  using (FileStream fileStream = File.OpenRead(@""C:\sample.svg"")) { MemoryStream memoryStream = new MemoryStream(); memoryStream.SetLength(fileStream.Length); fileStream.Read(memoryStream.GetBuffer(), 0, (int)fileStream.Length); SvgDocument svgDocument = SvgDocument.Open(memoryStream); string imagePath = ""local.jpg""; svgDocument.Draw().Save(imagePath); } var sampleDoc = SvgDocument.Open(@""C:\sample.svg""); sampleDoc.Draw().Save(@""C:\sample.png""); Object reference not set to an instance of an object.Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. Exception Details: System.NullReferenceException: Object reference not set to an instance of an object.Source Error: Line 363: SvgDocument svgDocument = SvgDocument.Open(memoryStream);Line 364: string imagePath = ""local.jpg"";Line 365: svgDocument.Draw().Save(imagePath);Line 366: }Line 367: string svgFileName = HttpContext.Current.Server.MapPath(""sample.svg""); string PngRelativeDirectory = HttpContext.Current.Server.MapPath(""~/""); string pngName = ""svgpieresult.png""; string pngFileName = HttpContext.Current.Server.MapPath(""pngName); // ignored assume sample.svg is in the web app directory //using (StreamWriter writer = new StreamWriter(svgFileName, false)) //{ // writer.Write(svgXml); //} string inkscapeArgs = string.Format(@""-f """"{0}"""" -e """"{1}"""""", svgFileName, pngFileName); Process inkscape = Process.Start( new ProcessStartInfo(""C:\\Program Files\\inkscape\\inkscape.exe"", inkscapeArgs)); inkscape.WaitForExit(3000); //Context.RewritePath(pngName); context.Response.Redirect(PngRelativeDirectory + pngName); <?xml version=""1.0"" standalone=""yes""?><!DOCTYPE svg PUBLIC ""-//W3C//DTD SVG 1.1//EN"" ""http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd""><svg width=""598px"" height=""346px"" xmlns=""http://www.w3.org/2000/svg"" xmlns:xlink=""http://www.w3.org/1999/xlink"" version=""1.1""><defs><linearGradient x1=""0"" y1=""0"" x2=""1"" y2=""0.9999999999999998"" id=""theme-94ae0a-6b7e07""><stop offset=""0%"" stop-color=""#94ae0a"" stop-opacity=""1""></stop><stop offset=""100%"" stop-color=""#6b7e07"" stop-opacity=""1""></stop></linearGradient><linearGradient x1=""0"" y1=""0"" x2=""1"" y2=""0.9999999999999998"" id=""theme-115fa6-0c4578""><stop offset=""0%"" stop-color=""#115fa6"" stop-opacity=""1""></stop><stop offset=""100%"" stop-color=""#0c4578"" stop-opacity=""1""></stop></linearGradient><linearGradient x1=""0"" y1=""0"" x2=""1"" y2=""0.9999999999999998"" id=""theme-a61120-780c17""><stop offset=""0%"" stop-color=""#a61120"" stop-opacity=""1""></stop><stop offset=""100%"" stop-color=""#780c17"" stop-opacity=""1""></stop></linearGradient><linearGradient x1=""0"" y1=""0"" x2=""1"" y2=""0.9999999999999998"" id=""theme-ff8809-d56e00""><stop offset=""0%"" stop-color=""#ff8809"" stop-opacity=""1""></stop><stop offset=""100%"" stop-color=""#d56e00"" stop-opacity=""1""></stop></linearGradient><linearGradient x1=""0"" y1=""0"" x2=""1"" y2=""0.9999999999999998"" id=""theme-ffd13e-ffc50b""><stop offset=""0%"" stop-color=""#ffd13e"" stop-opacity=""1""></stop><stop offset=""100%"" stop-color=""#ffc50b"" stop-opacity=""1""></stop></linearGradient><linearGradient x1=""0"" y1=""0"" x2=""1"" y2=""0.9999999999999998"" id=""theme-a61187-780c61""><stop offset=""0%"" stop-color=""#a61187"" stop-opacity=""1""></stop><stop offset=""100%"" stop-color=""#780c61"" stop-opacity=""1""></stop></linearGradient><linearGradient x1=""0"" y1=""0"" x2=""1"" y2=""0.9999999999999998"" id=""theme-24ad9a-1b8374""><stop offset=""0%"" stop-color=""#24ad9a"" stop-opacity=""1""></stop><stop offset=""100%"" stop-color=""#1b8374"" stop-opacity=""1""></stop></linearGradient><linearGradient x1=""0"" y1=""0"" x2=""1"" y2=""0.9999999999999998"" id=""theme-7c7474-625b5b""><stop offset=""0%"" stop-color=""#7c7474"" stop-opacity=""1""></stop><stop offset=""100%"" stop-color=""#625b5b"" stop-opacity=""1""></stop></linearGradient><linearGradient x1=""0"" y1=""0"" x2=""1"" y2=""0.9999999999999998"" id=""theme-a66111-78460c""><stop offset=""0%"" stop-color=""#a66111"" stop-opacity=""1""></stop><stop offset=""100%"" stop-color=""#78460c"" stop-opacity=""1""></stop></linearGradient></defs><rect width=""100%"" height=""100%"" fill=""#fff"" fill-opacity=""0"" stroke=""none"" /><path d=""M 230 173L 272.3305450559981 68.22822443395302A 113 113 0 0 1 343 173L 343 173A 113 113 0 0 1 272.3305450559981 277.771775566047L 272.3305450559981 277.771775566047L 230 173Z"" fill=""none"" stroke=""rgb(200, 200, 200)"" stroke-width=""6"" stroke-opacity=""1"" transform=""matrix(1,0,0,1,1,2)"" /><path d=""M 230 173L 272.3305450559981 68.22822443395302A 113 113 0 0 1 343 173L 343 173A 113 113 0 0 1 272.3305450559981 277.771775566047L 272.3305450559981 277.771775566047L 230 173Z"" fill=""none"" stroke=""rgb(150, 150, 150)"" stroke-width=""4"" stroke-opacity=""1"" transform=""matrix(1,0,0,1,0,1)"" /><path d=""M 230 173L 272.3305450559981 68.22822443395302A 113 113 0 0 1 343 173L 343 173A 113 113 0 0 1 272.3305450559981 277.771775566047L 272.3305450559981 277.771775566047L 230 173Z"" fill=""none"" stroke=""rgb(100, 100, 100)"" stroke-width=""2"" stroke-opacity=""1"" transform=""matrix(1,0,0,1,0,1)"" /><path d=""M 230 173L 210.37775592363687 61.7167239096205A 113 113 0 0 1 241.81171634924485 60.619025823385115L 241.81171634924485 60.619025823385115A 113 113 0 0 1 272.3305450559981 68.22822443395302L 272.3305450559981 68.22822443395302L 230 173Z"" fill=""none"" stroke=""rgb(200, 200, 200)"" stroke-width=""6"" stroke-opacity=""1"" transform=""matrix(1,0,0,1,1,2)"" /><path d=""M 230 173L 210.37775592363687 61.7167239096205A 113 113 0 0 1 241.81171634924485 60.619025823385115L 241.81171634924485 60.619025823385115A 113 113 0 0 1 272.3305450559981 68.22822443395302L 272.3305450559981 68.22822443395302L 230 173Z"" fill=""none"" stroke=""rgb(150, 150, 150)"" stroke-width=""4"" stroke-opacity=""1"" transform=""matrix(1,0,0,1,0,1)"" /><path d=""M 230 173L 210.37775592363687 61.7167239096205A 113 113 0 0 1 241.81171634924485 60.619025823385115L 241.81171634924485 60.619025823385115A 113 113 0 0 1 272.3305450559981 68.22822443395302L 272.3305450559981 68.22822443395302L 230 173Z"" fill=""none"" stroke=""rgb(100, 100, 100)"" stroke-width=""2"" stroke-opacity=""1"" transform=""matrix(1,0,0,1,0,1)"" /><path d=""M 230 173L 120.3565829308124 200.33717420276244A 113 113 0 0 1 135.23022582216709 111.4557890433019L 135.23022582216709 111.4557890433019A 113 113 0 0 1 210.37775592363687 61.7167239096205L 210.37775592363687 61.7167239096205L 230 173Z"" fill=""none"" stroke=""rgb(200, 200, 200)"" stroke-width=""6"" stroke-opacity=""1"" transform=""matrix(1,0,0,1,1,2)"" /><path d=""M 230 173L 120.3565829308124 200.33717420276244A 113 113 0 0 1 135.23022582216709 111.4557890433019L 135.23022582216709 111.4557890433019A 113 113 0 0 1 210.37775592363687 61.7167239096205L 210.37775592363687 61.7167239096205L 230 173Z"" fill=""none"" stroke=""rgb(150, 150, 150)"" stroke-width=""4"" stroke-opacity=""1"" transform=""matrix(1,0,0,1,0,1)"" /><path d=""M 230 173L 120.3565829308124 200.33717420276244A 113 113 0 0 1 135.23022582216709 111.4557890433019L 135.23022582216709 111.4557890433019A 113 113 0 0 1 210.37775592363687 61.7167239096205L 210.37775592363687 61.7167239096205L 230 173Z"" fill=""none"" stroke=""rgb(100, 100, 100)"" stroke-width=""2"" stroke-opacity=""1"" transform=""matrix(1,0,0,1,0,1)"" /><path d=""M 230 173L 151.5036041381333 254.28539743826758A 113 113 0 0 1 132.13912937235844 229.5L 132.13912937235844 229.5A 113 113 0 0 1 120.3565829308124 200.33717420276244L 120.3565829308124 200.33717420276244L 230 173Z"" fill=""none"" stroke=""rgb(200, 200, 200)"" stroke-width=""6"" stroke-opacity=""1"" transform=""matrix(1,0,0,1,1,2)"" /><path d=""M 230 173L 151.5036041381333 254.28539743826758A 113 113 0 0 1 132.13912937235844 229.5L 132.13912937235844 229.5A 113 113 0 0 1 120.3565829308124 200.33717420276244L 120.3565829308124 200.33717420276244L 230 173Z"" fill=""none"" stroke=""rgb(150, 150, 150)"" stroke-width=""4"" stroke-opacity=""1"" transform=""matrix(1,0,0,1,0,1)"" /><path d=""M 230 173L 151.5036041381333 254.28539743826758A 113 113 0 0 1 132.13912937235844 229.5L 132.13912937235844 229.5A 113 113 0 0 1 120.3565829308124 200.33717420276244L 120.3565829308124 200.33717420276244L 230 173Z"" fill=""none"" stroke=""rgb(100, 100, 100)"" stroke-width=""2"" stroke-opacity=""1"" transform=""matrix(1,0,0,1,0,1)"" /><path d=""M 230 173L 208.43858352245047 283.92387172958604A 113 113 0 0 1 177.8224067044411 273.23222414913903L 177.8224067044411 273.23222414913903A 113 113 0 0 1 151.5036041381333 254.28539743826758L 151.5036041381333 254.28539743826758L 230 173Z"" fill=""none"" stroke=""rgb(200, 200, 200)"" stroke-width=""6"" stroke-opacity=""1"" transform=""matrix(1,0,0,1,1,2)"" /><path d=""M 230 173L 208.43858352245047 283.92387172958604A 113 113 0 0 1 177.8224067044411 273.23222414913903L 177.8224067044411 273.23222414913903A 113 113 0 0 1 151.5036041381333 254.28539743826758L 151.5036041381333 254.28539743826758L 230 173Z"" fill=""none"" stroke=""rgb(150, 150, 150)"" stroke-width=""4"" stroke-opacity=""1"" transform=""matrix(1,0,0,1,0,1)"" /><path d=""M 230 173L 208.43858352245047 283.92387172958604A 113 113 0 0 1 177.8224067044411 273.23222414913903L 177.8224067044411 273.23222414913903A 113 113 0 0 1 151.5036041381333 254.28539743826758L 151.5036041381333 254.28539743826758L 230 173Z"" fill=""none"" stroke=""rgb(100, 100, 100)"" stroke-width=""2"" stroke-opacity=""1"" transform=""matrix(1,0,0,1,0,1)"" /><path d=""M 230 173L 270.49557829861897 278.4945881941838A 113 113 0 0 1 239.84859893048534 285.57000088436723L 239.84859893048534 285.57000088436723A 113 113 0 0 1 208.43858352245047 283.92387172958604L 208.43858352245047 283.92387172958604L 230 173Z"" fill=""none"" stroke=""rgb(200, 200, 200)"" stroke-width=""6"" stroke-opacity=""1"" transform=""matrix(1,0,0,1,1,2)"" /><path d=""M 230 173L 270.49557829861897 278.4945881941838A 113 113 0 0 1 239.84859893048534 285.57000088436723L 239.84859893048534 285.57000088436723A 113 113 0 0 1 208.43858352245047 283.92387172958604L 208.43858352245047 283.92387172958604L 230 173Z"" fill=""none"" stroke=""rgb(150, 150, 150)"" stroke-width=""4"" stroke-opacity=""1"" transform=""matrix(1,0,0,1,0,1)"" /><path d=""M 230 173L 270.49557829861897 278.4945881941838A 113 113 0 0 1 239.84859893048534 285.57000088436723L 239.84859893048534 285.57000088436723A 113 113 0 0 1 208.43858352245047 283.92387172958604L 208.43858352245047 283.92387172958604L 230 173Z"" fill=""none"" stroke=""rgb(100, 100, 100)"" stroke-width=""2"" stroke-opacity=""1"" transform=""matrix(1,0,0,1,0,1)"" /><path d=""M 230 173L 272.3305450559981 68.22822443395302A 113 113 0 0 1 343 173L 343 173A 113 113 0 0 1 272.3305450559981 277.771775566047L 272.3305450559981 277.771775566047L 230 173Z"" fill=""url(#theme-94ae0a-6b7e07)"" stroke-width=""0px"" transform=""matrix(1,0,0,1,0,0)"" /><path d=""M 230 173L 210.37775592363687 61.7167239096205A 113 113 0 0 1 241.81171634924485 60.619025823385115L 241.81171634924485 60.619025823385115A 113 113 0 0 1 272.3305450559981 68.22822443395302L 272.3305450559981 68.22822443395302L 230 173Z"" fill=""url(#theme-115fa6-0c4578)"" stroke-width=""0px"" transform=""matrix(1,0,0,1,0,0)"" /><path d=""M 230 173L 120.3565829308124 200.33717420276244A 113 113 0 0 1 135.23022582216709 111.4557890433019L 135.23022582216709 111.4557890433019A 113 113 0 0 1 210.37775592363687 61.7167239096205L 210.37775592363687 61.7167239096205L 230 173Z"" fill=""url(#theme-a61120-780c17)"" stroke-width=""0px"" transform=""matrix(1,0,0,1,0,0)"" /><path d=""M 230 173L 151.5036041381333 254.28539743826758A 113 113 0 0 1 132.13912937235844 229.5L 132.13912937235844 229.5A 113 113 0 0 1 120.3565829308124 200.33717420276244L 120.3565829308124 200.33717420276244L 230 173Z"" fill=""url(#theme-ff8809-d56e00)"" stroke-width=""0px"" transform=""matrix(1,0,0,1,0,0)"" /><path d=""M 230 173L 208.43858352245047 283.92387172958604A 113 113 0 0 1 177.8224067044411 273.23222414913903L 177.8224067044411 273.23222414913903A 113 113 0 0 1 151.5036041381333 254.28539743826758L 151.5036041381333 254.28539743826758L 230 173Z"" fill=""url(#theme-ffd13e-ffc50b)"" stroke-width=""0px"" transform=""matrix(1,0,0,1,0,0)"" /><path d=""M 230 173L 270.49557829861897 278.4945881941838A 113 113 0 0 1 239.84859893048534 285.57000088436723L 239.84859893048534 285.57000088436723A 113 113 0 0 1 208.43858352245047 283.92387172958604L 208.43858352245047 283.92387172958604L 230 173Z"" fill=""url(#theme-a61187-780c61)"" stroke-width=""0px"" transform=""matrix(1,0,0,1,0,0)"" /><text x=""286.5"" y=""173"" font-size=""18"" font-family=""Arial"" text-anchor=""middle"" fill=""#333333"" transform=""matrix(1,0,0,1,0,0)"" ><tspan x=""286.5"" dy=""4.5"">January</tspan></text><text x=""235.1665388416979"" y=""116.73671822229682"" font-size=""18"" font-family=""Arial"" text-anchor=""middle"" fill=""#cccccc"" transform=""matrix(0.0914,-0.9958,0.9958,0.0914,97.4145,340.2432)"" ><tspan x=""235.1665388416979"" dy=""4.5"">February</tspan></text><text x=""182.2358551905599"" y=""142.81993256099588"" font-size=""18"" font-family=""Arial"" text-anchor=""middle"" fill=""#cccccc"" transform=""matrix(0.8454,0.5342,-0.5342,0.8454,104.4655,-75.2608)"" ><tspan x=""182.2358551905599"" dy=""4.5"">March</tspan></text><text x=""181.4045806349622"" y=""201.8224776300739"" font-size=""18"" font-family=""Arial"" text-anchor=""middle"" fill=""#333333"" transform=""matrix(0.8601,-0.5101,0.5101,0.8601,-77.5769,120.7761)"" ><tspan x=""181.4045806349622"" dy=""4.5"">April</tspan></text><text x=""204.31408267270237"" y=""223.32378812306592"" font-size=""18"" font-family=""Arial"" text-anchor=""middle"" fill=""#333333"" transform=""matrix(0.4546,-0.8907,0.8907,0.4546,-87.4823,303.7766)"" ><tspan x=""204.31408267270237"" dy=""4.5"">May</tspan></text><text x=""235.16653884169793"" y=""229.26328177770318"" font-size=""18"" font-family=""Arial"" text-anchor=""middle"" fill=""#cccccc"" transform=""matrix(0.0914,0.9958,-0.9958,0.0914,441.9649,-25.8825)"" ><tspan x=""235.16653884169793"" dy=""4.5"">June</tspan></text><rect x=""459.5"" y=""85.5"" width=""78"" height=""173"" fill=""#FFF"" stroke=""#000"" stroke-width=""1"" transform=""matrix(1,0,0,1,0,0)"" /><text x=""485"" y=""102"" font-size=""12"" font-family=""Helvetica, sans-serif"" fill=""#000"" transform=""matrix(1,0,0,1,0,0)"" ><tspan x=""485"" dy=""3"">January</tspan></text><rect x=""0"" y=""0"" width=""12"" height=""12"" fill=""url(#theme-94ae0a-6b7e07)"" transform=""matrix(1,0,0,1,465,96)"" /><text x=""485"" y=""129"" font-size=""12"" font-family=""Helvetica, sans-serif"" fill=""#000"" transform=""matrix(1,0,0,1,0,0)"" ><tspan x=""485"" dy=""3"">February</tspan></text><rect x=""0"" y=""0"" width=""12"" height=""12"" fill=""url(#theme-115fa6-0c4578)"" transform=""matrix(1,0,0,1,465,123)"" /><text x=""485"" y=""156"" font-size=""12"" font-family=""Helvetica, sans-serif"" fill=""#000"" transform=""matrix(1,0,0,1,0,0)"" ><tspan x=""485"" dy=""3"">March</tspan></text><rect x=""0"" y=""0"" width=""12"" height=""12"" fill=""url(#theme-a61120-780c17)"" transform=""matrix(1,0,0,1,465,150)"" /><text x=""485"" y=""183"" font-size=""12"" font-family=""Helvetica, sans-serif"" fill=""#000"" transform=""matrix(1,0,0,1,0,0)"" ><tspan x=""485"" dy=""3"">April</tspan></text><rect x=""0"" y=""0"" width=""12"" height=""12"" fill=""url(#theme-ff8809-d56e00)"" transform=""matrix(1,0,0,1,465,177)"" /><text x=""485"" y=""210"" font-size=""12"" font-family=""Helvetica, sans-serif"" fill=""#000"" transform=""matrix(1,0,0,1,0,0)"" ><tspan x=""485"" dy=""3"">May</tspan></text><rect x=""0"" y=""0"" width=""12"" height=""12"" fill=""url(#theme-ffd13e-ffc50b)"" transform=""matrix(1,0,0,1,465,204)"" /><text x=""485"" y=""237"" font-size=""12"" font-family=""Helvetica, sans-serif"" fill=""#000"" transform=""matrix(1,0,0,1,0,0)"" ><tspan x=""485"" dy=""3"">June</tspan></text><rect x=""0"" y=""0"" width=""12"" height=""12"" fill=""url(#theme-a61187-780c61)"" transform=""matrix(1,0,0,1,465,231)"" /><rect x=""0"" y=""-9"" width=""63"" height=""21"" fill=""#f00"" fill-opacity=""0"" transform=""matrix(1,0,0,1,465,96)"" /><rect x=""0"" y=""-9"" width=""68"" height=""21"" fill=""#f00"" fill-opacity=""0"" transform=""matrix(1,0,0,1,465,123)"" /><rect x=""0"" y=""-9"" width=""53"" height=""21"" fill=""#f00"" fill-opacity=""0"" transform=""matrix(1,0,0,1,465,150)"" /><rect x=""0"" y=""-9"" width=""44"" height=""21"" fill=""#f00"" fill-opacity=""0"" transform=""matrix(1,0,0,1,465,177)"" /><rect x=""0"" y=""-9"" width=""41"" height=""21"" fill=""#f00"" fill-opacity=""0"" transform=""matrix(1,0,0,1,465,204)"" /><rect x=""0"" y=""-9"" width=""47"" height=""21"" fill=""#f00"" fill-opacity=""0"" transform=""matrix(1,0,0,1,465,231)"" /></svg>",convert svg to image programmatically
Click Event noch fired in WPF Datagrid in unselected row," I have a DataGrid (WPF 4) like this: The issue I experience is, that a button of the DataGridTemplateColumn does not fire the click-event, if its row is not selected. So I have to click a button twice, one time to select its row and then to raise the click event.I read about similiar problems with checkbox-columns, but there the suggestion was obviously to use a template column. I tested to use the PreviewMouseDown-Event of the button, which works, but is not what I want, since then the button does not follow its usual grpahical click behaviour.What am I missing here? How can I get that click event by just clicking once, regardless of whether the row was selected or not? <code>  <DataGrid Margin=""0,0,0,5"" VerticalAlignment=""Top"" Height=""192"" BorderBrush=""#aaa"" Background=""White"" HorizontalAlignment=""Left"" ItemsSource=""{Binding Namen, Mode=OneWay}"" ScrollViewer.VerticalScrollBarVisibility=""Visible"" AutoGenerateColumns=""False"" ColumnHeaderHeight=""24"" SelectionChanged=""DataGridAuslaendischeAlteNamen_SelectionChanged""> <DataGrid.Columns> <DataGridTextColumn Width=""*"" Header=""Namenseintrag"" Binding=""{Binding DisplayName, Mode=OneWay}"" /> <DataGridTextColumn Width=""75"" Header=""gltig von"" Binding=""{Binding GueltigAb, StringFormat=d, Mode=OneWay}"" /> <DataGridTextColumn Width=""75"" Header=""gltig bis"" Binding=""{Binding GueltigBis, StringFormat=d., Mode=OneWay}"" /> <DataGridTemplateColumn Width=""20"" IsReadOnly=""True""> <DataGridTemplateColumn.CellTemplate> <DataTemplate> <Button Style=""{DynamicResource CaratRemoveButton}"" Click=""Button_Click"" CommandParameter=""{Binding}"" PreviewMouseDown=""Button_PreviewMouseDown"" /> </DataTemplate> </DataGridTemplateColumn.CellTemplate> </DataGridTemplateColumn> </DataGrid.Columns> </DataGrid>",Click Event not fired in WPF Datagrid in unselected row
How to count occurences of unique values in Dictionary ?," I have a Dictionary with doubles as values and strings as keys. I want to count occurrences of each value in this Dictionary and I want to know this value (that is for instance repeated).for instance: I want to get a list: How can I do it?  <code>  key1, 2key2, 2key3, 3key4, 2key5, 5key6, 5 2 - 3 (times)3 - 1 (once)5 - 2 (twice)",How to count occurrences of unique values in Dictionary?
How to count occurences of unique values in Dictionary?," I have a Dictionary with doubles as values and strings as keys. I want to count occurrences of each value in this Dictionary and I want to know this value (that is for instance repeated).for instance: I want to get a list: How can I do it?  <code>  key1, 2key2, 2key3, 3key4, 2key5, 5key6, 5 2 - 3 (times)3 - 1 (once)5 - 2 (twice)",How to count occurrences of unique values in Dictionary?
convert int to string by format," Possible Duplicate: Number formatting: how to convert 1 to ""01"", 2 to ""02"", etc.? How can I convert int to string using the following scheme?1 converts to 0001123 converts to 0123Of course, the length of the string is dynamic. For this sample, it is: How can I convert like it? <code>  int length = 4;",Convert int (number) to string with leading zeros? (4 digits)
WPF List<string> INotifyPropertyChanged event," I have a simple class with a string property and a List property and I have the INofityPropertyChanged event implemented, but when I do an .Add to the string List this event is not hit so my Converter to display in the ListView is not hit. I am guessing the property changed is not hit for an Add to the List....how can I implement this in a way to get that property changed event hit???Do I need to use some other type of collection?!Thanks for any help! <code>  namespace SVNQuickOpen.Configuration{ public class DatabaseRecord : INotifyPropertyChanged { public DatabaseRecord() { IncludeFolders = new List<string>(); } #region INotifyPropertyChanged Members public event PropertyChangedEventHandler PropertyChanged; protected void Notify(string propName) { if (this.PropertyChanged != null) { PropertyChanged(this, new PropertyChangedEventArgs(propName)); } } #endregion private string _name; public string Name { get { return _name; } set { this._name = value; Notify(""Name""); } } private List<string> _includeFolders; public List<string> IncludeFolders { get { return _includeFolders; } set { this._includeFolders = value; Notify(""IncludeFolders""); } } }}",List<string> INotifyPropertyChanged event
Inheriting from System.ValueType, Am I correct in believing that any object that doesn't inherit from System.ValueType must therefore by definition be a reference type?I've been unable to find any conclusive documentation to backup this notion. <code> ,Are all objects that don't inherit from System.ValueType reference type?
Find a substring in a case-insensitive way, Possible Duplicate: Case insensitive contains(string) With Contains() method of String class a substring can be found.How to find a substring in a string in a case-insensitive manner? <code> ,Find a substring in a case-insensitive way - C#
Getting Filename from url in C# ASP.NET," Currently we have a solution that grabs the filename from the URL using this We found that if there are query strings attached that include characters such as quotes it returns with an error of Illegal characters in path.For example if the url is Then it won't get the filename. Is there a better, cleaner way to get ""mypage""? <code>  currentFile = Path.GetFileNameWithoutExtension(url); http:\\myurl.com\mypage.aspx?utm_content=This+Is+""Broken""",Getting Filename from url in C#
Where sould I define my NinjectModule and my factories?," I read a few things around on this site :It is best to configure our container at the launch the applicationIt is best to avoid making our libraries dependent on a dependency injection frameworkIt is recommended to use factories to initialize objects whose properties are defined at the runtimeI use Ninject. If I understand these recommendations, it is necessary that:My libraries do not use NInject.dllTherefore, my NinjectModules must be defined in the project of my applicationMy factories (which are created on this principle) must also be defined in the project of my application, and not directly in the libraryThat seems strange, especially for factories. I have many projects that use the same library. Should all these projects redefine ninject modules and factories? What do you think ? <code> ",Where should I define my NinjectModule and my factories?
Respoce Redirect dought subfolder issue," I am using a Response.Redirect(""login.aspx"");Since I moved my login.aspx to my Account subfolder, I tried the following code, however it doesn't work. The URL this tries to redirect to this: The full code is: and one more thing both the default page and login page use the same master page. <code>  Response.Redirect(""Account/login.aspx""); http://localhost/BuzzEnhance/Account/Login.aspx public partial class BuzzMaster : MasterPage{ protected void Page_Load(object sender, EventArgs e) { if (!IsPostBack) { if (Session[""Username""] != null) { username.Text = Session[""Username""].ToString(); } else { Response.Redirect(""Account/Login.aspx""); } } } }",Response.Redirect() to redirect to a page in a subfolder
Response.Redirect to a page in a subfolder," I am using a Response.Redirect(""login.aspx"");Since I moved my login.aspx to my Account subfolder, I tried the following code, however it doesn't work. The URL this tries to redirect to this: The full code is: and one more thing both the default page and login page use the same master page. <code>  Response.Redirect(""Account/login.aspx""); http://localhost/BuzzEnhance/Account/Login.aspx public partial class BuzzMaster : MasterPage{ protected void Page_Load(object sender, EventArgs e) { if (!IsPostBack) { if (Session[""Username""] != null) { username.Text = Session[""Username""].ToString(); } else { Response.Redirect(""Account/Login.aspx""); } } } }",Response.Redirect() to redirect to a page in a subfolder
Redirecting Native DLL's STDOUT to Memory Stream?," How can I stream data (text) from a managed assembly to a native library and stream data (text) back to the managed assembly?Specifically, I want to expose a System.IO.Stream of some sort on the .NET side, and (most importantly) a FILE * on the native side.The signature of the native method should be:FILE * foo(FILE * bar);The signature of a wrapper around the native p/invoke call should be:CustomStream foo(CustomStream bar);I do not want to use callback methods on the native side (one for getting more data and one for setting more data). I want to use a FILE * on the native side - and all of the associated methods which operate upon it such as fprintf. I do not want any disk I/O. This needs to be an in-memory operation.I have complete control over both the managed assembly and the native library. The solution must work with .NET 2.0I'm willing to create any sort of managed or unmanaged shim layer required to pull this off.The ""obvious"" solution is to use STDIN and STDOUT and launch a child process - however I don't want a separate process. Also, my attempts to redirect the STDIN and STDOUT streams of a native library which isn't a console application on Windows have failed somewhat spectacularly (and with much head-banging).Based on this question:Redirect stdout+stderr on a C# Windows service I attempted to modify the approach to (at least) solve the ""response"" stream half of my problem - but without a FileStream (since I want something more analogous to a MemoryStream). However, FileStream is the only stream type which exposes a suitable low-level stream handle.Otherwise, I'm pretty well stuck and am currently thinking I'll need to dive deeper and come up with my own hand-rolled native<->managed stream implementation but don't really know where to start. SolutionFinally! I've posted a complete sample project here:http://pastebin.com/jcjHdnwzThis is for .NET 3.5 and uses the AnonymousPipeServerStream - but with a little bit of reflector-ing, it's easy enough to duplicate the inner workings of the AnonymousPipeServerStream in .NET 2.0.Thanks for your help shf301 for pointing me to the native pipe API, which got me looking into the Microsoft docs for a better understanding of what's going on, and for pointing out I needed to use the _open_osfhandle method to get the FILE * reference. <code> ",How can I stream data from a managed assembly to a native library and back again?
Can't connect to SQL Database," I'm currently developing a web application using asp.net c#. I got a server where I today was going to publish my website and its database. Its a server that runs Windows Server 2008 R2. But I have one issue:My website doesn't seem to get access to the database. If I run the website from another computer on my local network I can access the server's database, BUT I can't when I run the website from the same server where the database is. This is really weird. I hope someone can help. I just get an error that says, it can't access the database.The most weird of all is that I'm using the same connection string on both computers, but it still doesn't work. Are there maybe some sort of settings in Windows Server 2008?Here is my connection string: <code>  <add name=""ConnectionString"" connectionString=""Data Source=AXELS;Initial Catalog=Sailor;Persist Security Info=True;User ID=sa;Password=saab123"" providerName=""System.Data.SqlClient"" />",Can't connect to SQL Server database
How to dynamicly open PDFs in default PDF reader?," i've got an PDF file and want to open it on clients desktop (so i don't know the directory of his default PDF reader)... seems not to work here... <code>  ...File.WriteAllBytes(pdfByteArray, path);File.Open(path, FileMode.Open);...",How to programatically open PDFs in default PDF reader?
Grouping by week - C#," I am writing an Excel exporter for a bespoke application I am creating, and I have a question about LINQ grouping in C#.Basically, this new Excel exporter class is given two dates. The class then retrieves all consignments between this date range.As part of this exporter, I need to be able to group the dates into weeks, and get the values for that week. So for example, if I'm given 07/12/2011 and 22/12/2011 (dd/MM/yyyy format), I need to group all consignments between them ranges into weeks (each week beginning with Sunday). The ideal result using the above dates would be Any ideas? <code>  Week 1: (consignments between 04/12/2011 and 10/12/2011) Week 2: (consignments between 11/12/2011 and 17/12/2011) Week 3: (consignments between 18/11/2011 and 24/12/2011)",How to group dates by week?
C#: How to invoke a method on the UI thread from within a worker thread?," I'm working on a project which uses the following technologies:C# (.NET 4.0)WCFPRISM 4I'm currently making an asynchronous call to one of our Web Services using the Begin/End methods generated by a proxy. The call is successful and the client is able to receive the Web Service's response on a worker thread.Once the response is received, I proceed to raise an event. The class subscribed to the event proceeds to request a UI navigation using PRISM: Since the asynchronous WCF response is not captured on the UI thread, I'm forced to invoke the UI thread using Application.Current.Dispatcher.BeginInvoke(...).The problem here is that the invoke seems to do nothing. The UI is not updated, and no exception is thrown.How should I invoke the UI thread from within an event that is raised on a worker thread?Edit: This question has been re-asked at the following link, since the supposed duplicate does not provide an answer:Request UI navigation using PRISM 4 on an asynchronous WCF response thread <code>  Application.Current.Dispatcher.BeginInvoke(new Action(() => this.RegionManager.RequestNavigate(RegionNames.LoginContentRegion, projectSelectionViewUri)));",How to invoke a method on the UI thread from within a worker thread?
How to invoke a method on the UI thread from within a worker thread?," I'm working on a project which uses the following technologies:C# (.NET 4.0)WCFPRISM 4I'm currently making an asynchronous call to one of our Web Services using the Begin/End methods generated by a proxy. The call is successful and the client is able to receive the Web Service's response on a worker thread.Once the response is received, I proceed to raise an event. The class subscribed to the event proceeds to request a UI navigation using PRISM: Since the asynchronous WCF response is not captured on the UI thread, I'm forced to invoke the UI thread using Application.Current.Dispatcher.BeginInvoke(...).The problem here is that the invoke seems to do nothing. The UI is not updated, and no exception is thrown.How should I invoke the UI thread from within an event that is raised on a worker thread?Edit: This question has been re-asked at the following link, since the supposed duplicate does not provide an answer:Request UI navigation using PRISM 4 on an asynchronous WCF response thread <code>  Application.Current.Dispatcher.BeginInvoke(new Action(() => this.RegionManager.RequestNavigate(RegionNames.LoginContentRegion, projectSelectionViewUri)));",How to invoke a method on the UI thread from within a worker thread?
C#: How to invoke a method on the UI thread from within a worker thread?," I'm working on a project which uses the following technologies:C# (.NET 4.0)WCFPRISM 4I'm currently making an asynchronous call to one of our Web Services using the Begin/End methods generated by a proxy. The call is successful and the client is able to receive the Web Service's response on a worker thread.Once the response is received, I proceed to raise an event. The class subscribed to the event proceeds to request a UI navigation using PRISM: Since the asynchronous WCF response is not captured on the UI thread, I'm forced to invoke the UI thread using Application.Current.Dispatcher.BeginInvoke(...).The problem here is that the invoke seems to do nothing. The UI is not updated, and no exception is thrown.How should I invoke the UI thread from within an event that is raised on a worker thread?Edit: This question has been re-asked at the following link, since the supposed duplicate does not provide an answer:Request UI navigation using PRISM 4 on an asynchronous WCF response thread <code>  Application.Current.Dispatcher.BeginInvoke(new Action(() => this.RegionManager.RequestNavigate(RegionNames.LoginContentRegion, projectSelectionViewUri)));",How to invoke a method on the UI thread from within a worker thread?
Manipulating lines of data (C#)," I have millions of lines generated from data updated every second which look like this: The column on the left represents time (hhmmss format), and the column on the right is data which is updated second-by-second. As you can see however, it isn't actually second-by-second, and there are some missing times (10:45:04, 10:45:07, 10:45:08 are missing in this example). My goal is to add in the missing seconds, and to use the data from the previous second for that missing second, like this: I don't want the ""--"" in the result, I just put those there to mark the added lines. So far I've tried to accomplish this using StreamReader and StreamWriter, but it doesn't seem like they're going to get me what I want. I'm a newbie programmer and a newbie to C#, so if you could just point me in the right direction, that would be great. I'm really just wondering if this is even possible to do in C#...I've spent a lot of time on MSDN and here on SO looking for a solution to this, but so far haven't found any. Edit: The lines are in a text file, and I want to store the newly created data in a new text file. <code>  104500 4783104501 8930104502 21794104503 21927104505 5746104506 9968104509 5867104510 46353104511 7767104512 4903 104500 4783104501 8930104502 21794104503 21927104504 21927 --104505 5746104506 9968104507 9968 --104508 9968 --104509 5867104510 46353104511 7767104512 4903",Manipulating lines of data
C# Anti-forgery token fails on IE only MVC 3," In my MVC 3 project i have a login page that uses the anti-forgery logic built into MVC 3.On Firefox & Opera it works just fine, but on IE I get this: I'm really stumped on why only IE suffers this, I checked the cookie settings and they are set the same as the other browsers so I'm at a lost here.When I use the anti forgery code, I use both a SALT and the domain check (which shouldn't matter but worth telling).Here is the view code: ViewBag.AppDomain is a value from web.config for easy setting during testing and production usage.If I remove the domain and path portion from the antiforgery tag, it works just fine. So one of those two must be the problem. <code>  A required anti-forgery token was not supplied or was invalid. @model login.Models.LogOnModel@{ ViewBag.Title = ""Log On"";}<script src=""@Url.Content(""~/Scripts/jquery.validate.min.js"")"" type=""text/javascript""> </script><script src=""@Url.Content(""~/Scripts/jquery.validate.unobtrusive.min.js"")"" type=""text/javascript""></script><script type=""text/javascript"">$(function () { //focus on form. $(""#UserName"").focus();});</script> @using (Html.BeginForm(""LogOn"", ""Account"", FormMethod.Post, new { @class = ""form login"" })) {@Html.AntiForgeryToken(""!@#Hq4("", ViewBag.AppDomain, ""/"")<div id=""box""><h1>Login</h1>Please enter your username and password. @Html.ActionLink(""Register"", ""Register"") if you don't have an account.<div class=""block"" id=""block-login""> <h2> Login Form</h2> <div class=""content login""> @Html.ValidationSummary(true) <div class=""group buffer""> <div class=""left""> <label class=""label right""> @Html.LabelFor(m => m.UserName)</label> </div> <div class=""right""> @Html.TextBoxFor(m => m.UserName, new { @class = ""text_field"" }) @Html.ValidationMessageFor(m => m.UserName) </div> </div> <div class=""group buffer""> <div class=""left""> <label class=""label right""> @Html.LabelFor(m => m.Password)</label> </div> <div class=""right""> @Html.PasswordFor(m => m.Password, new { @class = ""text_field"" }) @Html.ValidationMessageFor(m => m.Password) </div> </div> <div class=""group buffer""> <div class=""left""> <label class=""label right""> @Html.LabelFor(m => m.RememberMe)</label> </div> <div class=""right""> @Html.CheckBoxFor(m => m.RememberMe) </div> </div> <div class=""group navform buffer""> <div class=""right""> <button class=""button"" type=""submit""> <img src=""@Url.Content(""~/Content/images/icons/key.png"")"" alt=""Save"" /> Login </button> </div> </div> </div></div></div>}",ASP.NET MVC 3 web site anti-forgery token fails only on IE
C# Anti-forgery token fails on IE only ASP.NET MVC 3," In my MVC 3 project i have a login page that uses the anti-forgery logic built into MVC 3.On Firefox & Opera it works just fine, but on IE I get this: I'm really stumped on why only IE suffers this, I checked the cookie settings and they are set the same as the other browsers so I'm at a lost here.When I use the anti forgery code, I use both a SALT and the domain check (which shouldn't matter but worth telling).Here is the view code: ViewBag.AppDomain is a value from web.config for easy setting during testing and production usage.If I remove the domain and path portion from the antiforgery tag, it works just fine. So one of those two must be the problem. <code>  A required anti-forgery token was not supplied or was invalid. @model login.Models.LogOnModel@{ ViewBag.Title = ""Log On"";}<script src=""@Url.Content(""~/Scripts/jquery.validate.min.js"")"" type=""text/javascript""> </script><script src=""@Url.Content(""~/Scripts/jquery.validate.unobtrusive.min.js"")"" type=""text/javascript""></script><script type=""text/javascript"">$(function () { //focus on form. $(""#UserName"").focus();});</script> @using (Html.BeginForm(""LogOn"", ""Account"", FormMethod.Post, new { @class = ""form login"" })) {@Html.AntiForgeryToken(""!@#Hq4("", ViewBag.AppDomain, ""/"")<div id=""box""><h1>Login</h1>Please enter your username and password. @Html.ActionLink(""Register"", ""Register"") if you don't have an account.<div class=""block"" id=""block-login""> <h2> Login Form</h2> <div class=""content login""> @Html.ValidationSummary(true) <div class=""group buffer""> <div class=""left""> <label class=""label right""> @Html.LabelFor(m => m.UserName)</label> </div> <div class=""right""> @Html.TextBoxFor(m => m.UserName, new { @class = ""text_field"" }) @Html.ValidationMessageFor(m => m.UserName) </div> </div> <div class=""group buffer""> <div class=""left""> <label class=""label right""> @Html.LabelFor(m => m.Password)</label> </div> <div class=""right""> @Html.PasswordFor(m => m.Password, new { @class = ""text_field"" }) @Html.ValidationMessageFor(m => m.Password) </div> </div> <div class=""group buffer""> <div class=""left""> <label class=""label right""> @Html.LabelFor(m => m.RememberMe)</label> </div> <div class=""right""> @Html.CheckBoxFor(m => m.RememberMe) </div> </div> <div class=""group navform buffer""> <div class=""right""> <button class=""button"" type=""submit""> <img src=""@Url.Content(""~/Content/images/icons/key.png"")"" alt=""Save"" /> Login </button> </div> </div> </div></div></div>}",ASP.NET MVC 3 web site anti-forgery token fails only on IE
ASP.NET MVC 3 web site anti-forgery token fails only on IE," In my MVC 3 project i have a login page that uses the anti-forgery logic built into MVC 3.On Firefox & Opera it works just fine, but on IE I get this: I'm really stumped on why only IE suffers this, I checked the cookie settings and they are set the same as the other browsers so I'm at a lost here.When I use the anti forgery code, I use both a SALT and the domain check (which shouldn't matter but worth telling).Here is the view code: ViewBag.AppDomain is a value from web.config for easy setting during testing and production usage.If I remove the domain and path portion from the antiforgery tag, it works just fine. So one of those two must be the problem. <code>  A required anti-forgery token was not supplied or was invalid. @model login.Models.LogOnModel@{ ViewBag.Title = ""Log On"";}<script src=""@Url.Content(""~/Scripts/jquery.validate.min.js"")"" type=""text/javascript""> </script><script src=""@Url.Content(""~/Scripts/jquery.validate.unobtrusive.min.js"")"" type=""text/javascript""></script><script type=""text/javascript"">$(function () { //focus on form. $(""#UserName"").focus();});</script> @using (Html.BeginForm(""LogOn"", ""Account"", FormMethod.Post, new { @class = ""form login"" })) {@Html.AntiForgeryToken(""!@#Hq4("", ViewBag.AppDomain, ""/"")<div id=""box""><h1>Login</h1>Please enter your username and password. @Html.ActionLink(""Register"", ""Register"") if you don't have an account.<div class=""block"" id=""block-login""> <h2> Login Form</h2> <div class=""content login""> @Html.ValidationSummary(true) <div class=""group buffer""> <div class=""left""> <label class=""label right""> @Html.LabelFor(m => m.UserName)</label> </div> <div class=""right""> @Html.TextBoxFor(m => m.UserName, new { @class = ""text_field"" }) @Html.ValidationMessageFor(m => m.UserName) </div> </div> <div class=""group buffer""> <div class=""left""> <label class=""label right""> @Html.LabelFor(m => m.Password)</label> </div> <div class=""right""> @Html.PasswordFor(m => m.Password, new { @class = ""text_field"" }) @Html.ValidationMessageFor(m => m.Password) </div> </div> <div class=""group buffer""> <div class=""left""> <label class=""label right""> @Html.LabelFor(m => m.RememberMe)</label> </div> <div class=""right""> @Html.CheckBoxFor(m => m.RememberMe) </div> </div> <div class=""group navform buffer""> <div class=""right""> <button class=""button"" type=""submit""> <img src=""@Url.Content(""~/Content/images/icons/key.png"")"" alt=""Save"" /> Login </button> </div> </div> </div></div></div>}",ASP.NET MVC 3 web site anti-forgery token fails only on IE
C# ASP.NET MVC 3 web site anti-forgery token fails only on IE," In my MVC 3 project i have a login page that uses the anti-forgery logic built into MVC 3.On Firefox & Opera it works just fine, but on IE I get this: I'm really stumped on why only IE suffers this, I checked the cookie settings and they are set the same as the other browsers so I'm at a lost here.When I use the anti forgery code, I use both a SALT and the domain check (which shouldn't matter but worth telling).Here is the view code: ViewBag.AppDomain is a value from web.config for easy setting during testing and production usage.If I remove the domain and path portion from the antiforgery tag, it works just fine. So one of those two must be the problem. <code>  A required anti-forgery token was not supplied or was invalid. @model login.Models.LogOnModel@{ ViewBag.Title = ""Log On"";}<script src=""@Url.Content(""~/Scripts/jquery.validate.min.js"")"" type=""text/javascript""> </script><script src=""@Url.Content(""~/Scripts/jquery.validate.unobtrusive.min.js"")"" type=""text/javascript""></script><script type=""text/javascript"">$(function () { //focus on form. $(""#UserName"").focus();});</script> @using (Html.BeginForm(""LogOn"", ""Account"", FormMethod.Post, new { @class = ""form login"" })) {@Html.AntiForgeryToken(""!@#Hq4("", ViewBag.AppDomain, ""/"")<div id=""box""><h1>Login</h1>Please enter your username and password. @Html.ActionLink(""Register"", ""Register"") if you don't have an account.<div class=""block"" id=""block-login""> <h2> Login Form</h2> <div class=""content login""> @Html.ValidationSummary(true) <div class=""group buffer""> <div class=""left""> <label class=""label right""> @Html.LabelFor(m => m.UserName)</label> </div> <div class=""right""> @Html.TextBoxFor(m => m.UserName, new { @class = ""text_field"" }) @Html.ValidationMessageFor(m => m.UserName) </div> </div> <div class=""group buffer""> <div class=""left""> <label class=""label right""> @Html.LabelFor(m => m.Password)</label> </div> <div class=""right""> @Html.PasswordFor(m => m.Password, new { @class = ""text_field"" }) @Html.ValidationMessageFor(m => m.Password) </div> </div> <div class=""group buffer""> <div class=""left""> <label class=""label right""> @Html.LabelFor(m => m.RememberMe)</label> </div> <div class=""right""> @Html.CheckBoxFor(m => m.RememberMe) </div> </div> <div class=""group navform buffer""> <div class=""right""> <button class=""button"" type=""submit""> <img src=""@Url.Content(""~/Content/images/icons/key.png"")"" alt=""Save"" /> Login </button> </div> </div> </div></div></div>}",ASP.NET MVC 3 web site anti-forgery token fails only on IE
What are the chances to get a Guid.NewGuid () doublet?," Possible Duplicate: Is a GUID unique 100% of the time? Simple proof that GUID is not unique In MSDN you can read:The chance that the value of the new Guid will be all zeros or equal to any other Guid is very low.Say that you have an method that will create a file every second, and you use the method Guid.NewGuid() for filename, is it possible to get the same Guid then? Or will the local computer keep track in some way? How low is the chance ?  <code> ",What are the chances to get a Guid.NewGuid () duplicate?
C# Mouse emulation in a different program," I'm working on my own software to operate the mouse on my computer using C# and the kinect SDK. I really want to try using it to play a game like Red Alert, or some sort of RTS, or even just for general navigation.The problem that I've found is that when using a program with a different mouse, like red alert or going into a virtual machine where mouse integration isn't supported, the program will not pick up on the calls that the C# program is making to the System.Windows.Forms.Cursor calls, let alone the mouse_event calls. I'm new to interfacing with windows and what is happening here, can someone explain/pose a solution?--UPDATE--As an update, I'm still not entirely sure what's going on, but I seem to have found a workaround for red alert in particular;Since red alert is a fairly low graphics program, it is trivial to run it within a virtual machine specifically for me, vmware workstation with an XP client. If you use the mouse_event code it works well, HOWEVER, something that I struggled with was finding the correct code to represent mouse movement. It would seem that the MOVE flag moves the mouse relatively, which I didn't want, and the absolute tag didn't move the mouse at all. It is, in fact, the OR of them that produces absolute movement on the screen, so my code for mouse movement and clicking emulation ended up looking like this: for clicking and for mouse movement, where x and y are the new coordinates out of 65535 (the absolute range). Is it perfect? Nah. But it works for now. I think there's something to do with the way windows ignores certain programs when it runs ra, maybe because of compatibility mode? I don't have another game to test it with right now, but I'll post results with a non-compatibility mode in the future.Pete(It wouldn't let me post as an answer for another two hours and I have to sleep to catch a flight in the morning!) <code>  mouse_event((int)0x00000002, cursor.X, cursor.Y, 0, 0); mouse_event((int)(0x00000001 | 0x00008000), x, y, 0 0);",Mouse emulation in a different program
Cannot convert from an IEnumerable to an ICollection," I have defined the following: When I run this code: I get the following message: Can someone explain what I am doing wrong. I am very confused about the difference between Enumerable, Collections and using the ToList()Added informationLater in my code I have the following: Would I be okay to define Items as an IEnumerable? <code>  public ICollection<Item> Items { get; set; } Items = _item.Get(""001""); Error 3 Cannot implicitly convert type 'System.Collections.Generic.IEnumerable<Storage.Models.Item>' to 'System.Collections.Generic.ICollection<Storage.Models.Item>'. An explicit conversion exists (are you missing a cast?) for (var index = 0; index < Items.Count(); index++) ",Cannot convert from an IEnumerable<T> to an ICollection<T>
How to rander Partial View in MVC3," I am trying to render partial view in my application and could not display the value. Here is what my View looks like.My Main Index View Partial View Here is the controller that returns the view. Here is code for Model When I try to display the value in TD, it does not show anything.Can you please help me with this? <code>  <div id=""RPPricingNameModel""> @Html.Partial(""RPPricingPlanNames"") </div><script type=""text/javascript""> $(""#RPPricingNameModel"").load(""/Home/GetPlanNameModel""); </script> @model PlanNameModel <table style= ""vertical-align:top; left:0px; top:0px; position:absolute; border-width:1px; border-style:solid; border-color:Green; width:130px; text-align:left;""> <tr> <td style="" font-size:15px; font-weight:bold; color:Black;""> @Model.Header <div> @Html.LabelFor(x => x.Header) </div> </td> </tr><table> public ActionResult GetPlanNameModel(){ PlanNameModel planNameModel = new PlanNameModel(); planNameModel.Header = ""Plans""; //return View(planNameModel); return PartialView(planNameModel); } public class RPPricingPlanNameModel{ public string Header { get; set; }}",How to render Partial View in MVC3
Proper way to do C# rounding for currency conversion in Paypal?," I'm building an ecommerce site integrated with paypal.We take multiple currencies, so I want to make sure that (for accounting reasons) i'm correctly performing any math for currency conversion.After multiplying the currency conversion * the original currency, I always end up with lots of trailing numbers after the decimal point.Is there a standard way to do this? Should I truncate or round? Do I need to round multiple times in case rounding the 1/1000 decimal will affect rounding the 1/100 decimal?Should I be doing something like: I've been having trouble finding good information about how this is done (hopefully US and Europe are the same). <code>  Math.Round(Math.Round(x, 3), 2)",Proper way to do rounding for currency conversion in Paypal?
How to routing in MVC3," I'm having a problem trying to get routing to work with ASP.NET MVC 3.0. I have the following routes declared: When I visit: The site works correctly, and it appears to hit Default route.When I visit: I get a 404: Server Error in '/' Application. The resource cannot be found. Description: HTTP 404. The resource you are looking for (or one of its dependencies) could have been removed, had its name changed, or is temporarily unavailable. Please review the following URL and make sure that it is spelled correctly. Requested URL: /1Here are the actions those routes correspond to: How do I structure my routes so that all three action methods are hit correctly? <code>  public static void RegisterRoutes(RouteCollection routes){ routes.IgnoreRoute(""{resource}.axd/{*pathInfo}""); routes.MapRoute( ""Default"", ""{controller}/{action}/{id}"", new { controller = ""Home"", action = ""RsvpForm"", id = UrlParameter.Optional } ); routes.MapRoute( ""TestRoute"", ""{id}"", new { controller = ""Product"", action = ""Index3"", id = UrlParameter.Optional } ); routes.MapRoute( ""TestRoute2"", ""{action}"", new { controller = ""Home"", action = ""Index"", id = UrlParameter.Optional } );} http://localhost http://localhost/1 public ActionResult Index3(int? id){ Product myProduct = new Product { ProductID = 1, Name = ""Product 1 - Index 3"", Description = ""A boat for one person"", Category = ""Watersports"", Price = 275M }; Product myProduct2 = new Product { ProductID = 2, Name = ""Product 2 - Index 3"", Description = ""A boat for one person"", Category = ""Watersports"", Price = 275M }; ViewBag.ProcessingTime = DateTime.Now.ToShortTimeString(); if (id == 1) return View(""index"", myProduct); else return View(""index"", myProduct2);}",How to fix a 404 with routes in ASP.NET MVC?
Is Injection Possiable through Dynamic LINQ?," Using the Dynamic LINQ library (link), is it vulnerable to injection? and (if so) how can this be protected against?Some background from Security Considerations (Entity Framework): LINQ to Entities injection attacks: Although query composition is possible in LINQ to Entities, it is performed through the object model API. Unlike Entity SQL queries, LINQ to Entities queries are not composed by using string manipulation or concatenation, and they are not susceptible to traditional SQL injection attacks.Since Dynamic SQL is composed using strings does that mean that it might be susceptible to injection vectors? Or will LINQ to SQL automatically take care of parametrizing your values based on the underlying datatype within the Dynamic LINQ library?Or is it entirely safe since the dynamic query will be performed in memory rather than against the SQL (thereby negating any benefits from SQL indexes)?I have been working through understanding the DynamicLibrary.cs code but I'm sure I could be easily overlooking something.As this question is about the Dynamic LINQ Library itself, this question can be considered to apply to both linq-to-sql and linq-to-entities (despite above reference to Entity Framework). <code> ",Is Injection Possible through Dynamic LINQ?
Operator Overriding is supported by C#, I have gone to an interview where I was asked to answer a question: Is operator overriding supported by C#?I know that operator overloading is supported but I have no idea about overriding a operator. Is it possible? <code> ,Is Operator Overriding supported by C#
send a table in email C#," I have a requirement to send the results of a query in emails. I am using two methods:GetDataTable() : to execute the query and obtain datatable(which needs to be sent in email)SendAutomatedEmail() : to send automated emails.Problem: i need to send data table or html table in email, something like code below. this works fine for a string in place of dataTable <code>  public static void Main(string[] args){ DataTable datatable = GetDataTable(); SendAutomatedEmail(datatable );} public static DataTable GetDataTable(string CommandText) { string cnString = ConfigurationManager.ConnectionStrings[""Connection2""].ConnectionString; SqlConnection sqlConnection = new SqlConnection(cnString); string CommandText = ""select * from dbo.fs010100 (nolock)""; SqlCommand sqlCommand = new SqlCommand( CommandText, sqlConnection); SqlDataAdapter sqlDataAdapter = new System.Data.SqlClient.SqlDataAdapter(); sqlDataAdapter.SelectCommand = sqlCommand; DataTable dataTable = new DataTable(); dataTable.Locale = System.Globalization.CultureInfo.InvariantCulture; // Adds or refreshes rows in the DataSet to match those in the data source try { sqlDataAdapter.Fill(dataTable); sqlConnection.Close(dataTable ); } catch (Exception _Exception) { sqlConnection.Close(); //Console.WriteLine(_Exception.Message); return null; } return dataTable; } public static void SendAutomatedEmail(DataTable dt, string recipient = ""user@domain.com"") { try { string mailServer = ""server.com""; MailMessage message = new MailMessage( ""it@domain.com"", recipient, ""Test Email"", dt.ToString() ); SmtpClient client = new SmtpClient(mailServer); var AuthenticationDetails = new NetworkCredential(""user@domain.com"", ""password""); client.Credentials = AuthenticationDetails; client.Send(message); } catch (Exception e) { } }",Send a table in email
Convert minuts to full time C#, I need convert 1815 minutes to 30:15 (30 hours and 15 minutes)Is there an easy way to do this that I am missing? <code> ,Convert minutes to full time C#
Lost Model properties when Model Binding in ASP.NET MVC POST," Is there any issues with modelbinding IEnumerable types to an MVC POST?Some properties in my Model are not being bound upon a post to an action. Seems that properties on the model like strings are ok, but my IEnumerable is what is not being bound.Here's a snippet of my code: And here is what those properties look like in the model: The view works fine and outputs a list of textboxes with the expected values in them. But the post Action which gets fired only recognises the Test string as a property. The model state does not contain my IEnumerable data either. <code>  <%: Html.TextBoxFor(m => m.ResponseInfo.SubsetInfo.Test) %> <% for (int i = 0; i < Model.ResponseInfo.SubsetInfo.BandAvailabilities.Count(); i++) {%> <%: Html.TextBoxFor(m => m.ResponseInfo.SubsetInfo.BandAvailabilities.ToArray()[i].BandName) %> <% } %> public IEnumerable<BandAvailabilityInfo> BandAvailabilities { get; set; }public string Test { get; set; }",Modelbinding IEnumerable in ASP.NET MVC POST?
typeof() to check for decimal values," what is the easiest way to check if a typeof() is mathematically usable(numeric).do i need to use the TryParse method or check it by this: if there is a more easy way to achieve this, your free to suggest <code>  if (!(DC.DataType == typeof(int) || DC.DataType == typeof(double) || DC.DataType == typeof(long) || DC.DataType == typeof(short) || DC.DataType == typeof(float))) { MessageBox.Show(""Non decimal data cant be calculated""); return; }",typeof() to check for Numeric values
How can CSharp use a legacy DLL simply without registration(regsvr32), SituationI run a build system that executes many builds for many project. To avoid one build impacting another we lock down the build user to only its workspace. Builds run as a non privileged users who only have write ability to the workspace.ChallengeDuring our new build we need to use a legacy 3rdparty DLL that exposes its interface through COM. The dev team wants to register the build(regsrv32.exe) but our build security regime blocks this activity. If we relax the regime then the 3rdparty DLL will impact other builds and if I have two build which need two different versions I may have the wrong build compile against the wrong version (a very real possibility).QuestionAre there any other options besides registration to handle legacy DLLs which expose their interface via COM?Thanks for the helpPeter <code> ,How can C# use a legacy DLL simply without registration(regsvr32)
WPF DataGridTextColumn Visibility Binding," I'm trying to bind column visibility to that of another element like this: but I get this error in VS output: Is there a pure XAML way to accomplish this? <code>  <Window x:Class=""WpfApplication1.MainWindow"" xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" Title=""MainWindow"" Height=""350"" Width=""525""><Window.Resources> <BooleanToVisibilityConverter x:Key=""BooleanToVisibilityConverter"" /></Window.Resources><StackPanel> <CheckBox x:Name=""chkColumnVisible"" Content=""Show column"" /> <DataGrid x:Name=""MyDataGrid"" AutoGenerateColumns=""False""> <DataGrid.Columns> <DataGridTextColumn Header=""Column1"" Visibility=""{Binding ElementName=chkColumnVisible, Path=IsChecked, Converter={StaticResource BooleanToVisibilityConverter}}""/> </DataGrid.Columns> </DataGrid></StackPanel> System.Windows.Data Error: 2 : Cannot find governing FrameworkElement or FrameworkContentElement for target element. BindingExpression:Path=IsChecked; DataItem=null; target element is 'DataGridTextColumn' (HashCode=48860040); target property is 'Visibility' (type 'Visibility')",DataGridTextColumn Visibility Binding
C# Converting Seconds into DateTime," I would like to subtract seconds from a date, for example:Lets say I have 1300 seconds in a unsigned integer, I would like to take the current date and time, subtract 1,300 seconds from it, and end up with:01/13/2012 2:15 PM (format doesn't really matter).I did try:  <code>  DateTime dt = new DateTime(); dt.Add(new TimeSpan(0, 0, ui.OnlineTime)); Online.Text = dt.ToLongDateString();",Get a DateTime by subtracting seconds from the current date
How is Math.Pow() implemented in .Net Framework?," I was looking for an efficient approach for calculating ab (say a = 2 and b = 50). To start things up, I decided to take a look at the implementation of Math.Pow() function. But in .NET Reflector, all I found was this: What are some of the resources wherein I can see as what's going on inside when I call Math.Pow() function? <code>  [MethodImpl(MethodImplOptions.InternalCall), SecuritySafeCritical]public static extern double Pow(double x, double y);",How is Math.Pow() implemented in .NET Framework?
SerializationException -," i am trying to serialize a field of my class. Withou it serialization is fine, with it a get SerializationException.Field is : private readonly ObservableCollection<CellVM> Values;Exception is I am targeting Framework 3.5.I found some suggestions, that it could be problem with serialization of observalble collections, but that should be fixed by 3.5 sp1.Have no idea how to fix that, any ideas? thank you.CellVM class: CellVM SuperClass (ancestor): <code>  Type System.ComponentModel.PropertyChangedEventManager in assembly WindowsBase, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35 is not marked as serializable. [Serializable]public class CellVM:ANotifyPropertyChanged{ public Cell model; public int X { get { return model.X; } set { model.X = value; OnPropertyChanged(""X""); } } public int Y { get { return model.Y; } set { model.Y = value; OnPropertyChanged(""Y""); } } public string Value { get { return model.ActualValue; } set { model.ActualValue = value; OnPropertyChanged(""Value""); } } [NonSerialized] private bool _isActive; public bool IsActive { get { return _isActive; } set { _isActive = value; OnPropertyChanged(""IsActive""); OnPropertyChanged(""BackgroundBrush""); OnPropertyChanged(""HighlightBrush""); } } public bool IsReadOnly { get { if(model.InitialValue.Equals(model.RightValue)) { return true; } return false; } } public bool IsHighLighted { get; set; } private bool _isInvalid; public bool IsInvalid { get { return _isInvalid; } set { _isInvalid = value; OnPropertyChanged(""IsInvalid""); OnPropertyChanged(""BackgroundBrush""); } } private bool _isValueMode; public bool IsValueMode { get { return _isValueMode; } set { _isValueMode = value; OnPropertyChanged(""IsValueMode""); OnPropertyChanged(""ValueVisibility""); OnPropertyChanged(""PossibilityVisibility""); } } [NonSerialized] private FontWeight _valueFontWeight; public FontWeight ValueFontWeight { get { return _valueFontWeight; } set { _valueFontWeight = value; OnPropertyChanged(""ValueFontWeight"");} } [NonSerialized] private Brush _valueColor; public Brush ValueColor { get { if(_valueColor == null) { return new SolidColorBrush(Colors.Black); } return _valueColor; } set { _valueColor = value; OnPropertyChanged(""ValueColor""); } } public Visibility ValueVisibility { get { if(IsValueMode) { return Visibility.Visible; } return Visibility.Hidden; } } public Visibility PossibilityVisibility { get { if (!IsValueMode) { return Visibility.Visible; } return Visibility.Hidden; } } private bool _isCheckInvalid; public bool IsCheckInvalid { get { return _isCheckInvalid; } set { _isCheckInvalid = value; OnPropertyChanged(""IsCheckInvalid""); OnPropertyChanged(""HighlightBrush""); } } public Brush HighlightBrush { get { if(IsActive && IsReadOnly) { return ColorManager.CellActive; } if (IsCheckInvalid) { ColorAnimation animation = new ColorAnimation { From = Colors.Firebrick, To = Colors.WhiteSmoke, Duration = new Duration(TimeSpan.FromSeconds(1)), AutoReverse = true }; SolidColorBrush brush = new SolidColorBrush(Colors.Firebrick); animation.RepeatBehavior = RepeatBehavior.Forever; animation.AccelerationRatio = 0.5; brush.BeginAnimation(SolidColorBrush.ColorProperty, animation); return brush; } return new SolidColorBrush(Colors.Transparent); } } public Brush BackgroundBrush { get { if (IsActive) { if (!IsReadOnly) { return ColorManager.CellActive; } } if (IsInvalid) { return ColorManager.CellInvalid; } if (IsHighLighted) { return ColorManager.CellHighlighted; } return new SolidColorBrush(Colors.White); } } [NonSerialized] private Brush _backgroundAnimationBrush; public Brush BackgroundAnimationBrush { get { return _backgroundAnimationBrush; } set { _backgroundAnimationBrush = value; OnPropertyChanged(""BackgroundAnimationBrush""); } } public Brush PossibilitiesBrush { get { return new SolidColorBrush(PossibilitiesColor); } } private Colour _possibilitiesColor; public Colour PossibilitiesColor { get { if (_possibilitiesColor == null) { return new Colour(Colors.Black); } return _possibilitiesColor; } set { _possibilitiesColor = value; OnPropertyChanged(""PossibilitiesColor""); OnPropertyChanged(""PossibilitiesBrush""); } } public ObservableCollection<string> Possibilities { get { return model.Possibilities; } set { model.Possibilities = value; OnPropertyChanged(""Possibilities""); OnPropertyChanged(""PossibilityVisibility""); } } private string _toolTip; public string ToolTip { get { return _toolTip; } set { _toolTip = value; OnPropertyChanged(""ToolTip""); } } public CellVM(Cell model,bool isHighlighted) { this.model = model; IsValueMode = true; IsHighLighted = isHighlighted; } public void signalError(string message) { ToolTip = message; IsInvalid = true; } public void resetError() { if(IsCheckInvalid) { return; } ToolTip = null; IsInvalid = false; } public void AnimateError() { ColorAnimation animation = new ColorAnimation { From = Colors.Firebrick, To = Colors.Transparent, Duration = new Duration(TimeSpan.FromSeconds(1.5)), AutoReverse = false }; animation.Completed += new EventHandler(animation_Completed); SolidColorBrush brush = new SolidColorBrush(Colors.Transparent); animation.AccelerationRatio = 0.5; BackgroundAnimationBrush = brush; brush.BeginAnimation(SolidColorBrush.ColorProperty, animation); } public void AnimateHint() { ColorAnimation animation = new ColorAnimation { From = Colors.DarkGreen, To = Colors.Transparent, Duration = new Duration(TimeSpan.FromSeconds(1.5)), AutoReverse = false }; animation.Completed += new EventHandler(animation_Completed); SolidColorBrush brush = new SolidColorBrush(Colors.Transparent); animation.AccelerationRatio = 0.5; BackgroundAnimationBrush = brush; brush.BeginAnimation(SolidColorBrush.ColorProperty, animation); } private void animation_Completed(object sender, EventArgs e) { BackgroundAnimationBrush = null; }} [Serializable]public abstract class ANotifyPropertyChanged : INotifyPropertyChanged{ public event PropertyChangedEventHandler PropertyChanged; protected virtual void OnPropertyChanged(string propertyName) { PropertyChangedEventHandler handler = this.PropertyChanged; if (handler != null) { var e = new PropertyChangedEventArgs(propertyName); handler(this, e); } }}",SerializationException when serializing instance of a class which implements INotifyPropertyChanged
How to detect and avoid infinite loops," I want to make sure that my web application is performance wise and will not make any performance problems. When I searched, I found that one of the most common problems related to the performance issue is the ""infinite loops"" problem.I want to ask:Where should I begin to check that my code never causes infinite loops?Are there any articles, advices, instructions, examples? I will be grateful.ex:May this code cause an infinite loop? Thanks in advance <code>  public static IEnumerable<SubjectNode> ReadSubjectNodes(string filePath){ using (FileStream fs = new FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.Read)) using (XmlReader xrdr = new XmlTextReader(fs)) while (xrdr.Read()) if (xrdr.NodeType == XmlNodeType.Element && xrdr.LocalName == ""subject"") yield return new SubjectNode(xrdr.GetAttribute(""id""), xrdr.GetAttribute(""name""), xrdr.GetAttribute(""short""));}",How to detect and avoid infinite loops?
How do I find the intersect of two sets of non-contiguious Times?, I am trying to build a tool that calculates something called quota based upon when employees are scheduled to work and when they request off.My ShiftSet object is a set of Shift objects which consist of a StartTime and EndTime (both of type time(7). Each ShiftSet corresponds to a day.ScheduleExceptions are times that an employee has off. There can be any number of overlapping or non-overlapping ScheduleExceptions in a day. They are of the datetime data type.An example of a ShiftSet:08:00-10:0010:00-12:0013:00-15:0015:00-17:00 An example of ScheduleExceptions for that same day:07:30-10:3014:35-16:00What I need to do is to find the amount of time that the employee is working on a day. The way I can figure to do this is to calculate the intersection of ShiftSet and the inverse of ScheduleExceptions.How would I do this with time? I would prefer to use Linq if possible. <code> ,How do I find the intersect of two sets of non-contiguous Times?
How do I find the intersect of two sets of non-contiguous Times?, I am trying to build a tool that calculates something called quota based upon when employees are scheduled to work and when they request off.My ShiftSet object is a set of Shift objects which consist of a StartTime and EndTime (both of type time(7). Each ShiftSet corresponds to a day.ScheduleExceptions are times that an employee has off. There can be any number of overlapping or non-overlapping ScheduleExceptions in a day. They are of the datetime data type.An example of a ShiftSet:08:00-10:0010:00-12:0013:00-15:0015:00-17:00 An example of ScheduleExceptions for that same day:07:30-10:3014:35-16:00What I need to do is to find the amount of time that the employee is working on a day. The way I can figure to do this is to calculate the intersection of ShiftSet and the inverse of ScheduleExceptions.How would I do this with time? I would prefer to use Linq if possible. <code> ,How do I find the intersect of two sets of non-contiguous Times?
How do I apply a conditional operator to a field of a child element using the official MongoDB-CSharp-Driver?," I'm trying to generate a query that finds all large, red things with a cost greater than 3. This query seems to be what I'm after: But, I am unable to find an elegant way to create the cost condition using the official MongoDB CSharp Driver. This is one hack which seems to create the query: Another way to do it which seems to work is like this: Are either of these approaches a good way to accomplish this? Is there another?I need to use techniques which allow me to dynamically build the query and add fields that will be involved in the query. I was hoping to find a way to add a condition via query.Add( ) but I don't know if that is possible.Any help is appreciated. <code>  { ""color"" : ""red"", ""size"" : ""large"", ""cost"" : { ""$gt"" : 3.0 } } QueryConditionList gt = Query.GT(""cost"", BsonDouble.Create(3));QueryDocument query = new QueryDocument();query.Add(""color"", ""red"");query.Add(""size"", ""large"");query.Add(gt.ToBsonDocument().Elements);List<BsonDocument> results = events.Find(query).ToList(); QueryDocument query = new QueryDocument();query.Add(""color"", ""red"");query.Add(""size"", ""large"");query.Add(""cost"", new BsonDocument(""$gt"", BsonDouble.Create(3)));List<BsonDocument> results = events.Find(query).ToList();",How do I dynamically apply a conditional operator to a field using the official MongoDB-CSharp-Driver?
Get out of multiples loops?," Possible Duplicate: Breaking out of a nested loop I have this code But break only ""breaks"" the most inner loop (sorry for my english) and I want to leave them all...I was thinking about :GOTO, but I've always been told to not use itA sort of boolean-flagIs there any more elegant way ? like provided by C# ?Thanks in advance for any help ! <code>  foreach (___){ foreach (___) { foreach (___) { if (condition) { //break out of all loops } } }}",Get out of multiple loops?
Shortcut for creating constructor with variables (C# VS2010)," In VisualStudio2010 C# you can, in a class, type ctor and then press tab and Visual Studio will create a constructor for that class for me. It is very convenient.But is there a way to make Visual Studio create a constructor with all my variables, properties and so on?For example, And for this I want ctor + tab to make me a <code>  public class User{ public String UserName { get; private set; }} public User(string UserName){ this.UserName = UserName;}",Shortcut for creating constructor with variables (C# Visual Studio 2010)
Is it possible to override the required attribute? ASP.NET MVC3," I'm curious to find out if it is possible to override the [Required] attribute that has been set on a model. I'm sure there most be a simple solution to this problem, any takers? <code> ",Is it possible to override the required attribute on a property in a model?
Is it possible to override the required attribute on a property in a model? ASP.NET MVC3," I'm curious to find out if it is possible to override the [Required] attribute that has been set on a model. I'm sure there most be a simple solution to this problem, any takers? <code> ",Is it possible to override the required attribute on a property in a model?
How to list all users in ActiveDirectory in DropDownList Control," I am using Visual Studio 2005 C#.I am trying to retrieve the list of users in my Active Directory and insert them into a DropDownList control.May I know how do I pull out the users and how can I insert them into the DropDownList control?EDIT:There are many parts of the functionality I would wish to complete. Firstly is to list all users in a DropDownList, and having 2 checkboxes, User and Admin, and base on the role assigned to the user in the DDL, appropriate checkboxes will be checked.Checking and unchecking of the role checkboxes will also assign/revoke the roles accordingly. <code> ",How to list all users in Active Directory in DropDownList Control
is this lock usage is thread saftey?, I know that is wrong to use lock(this) or any shared object.I wonder if this usage is OK? Is this thread safe? In OtherClass we lock with a private object so if the class A lock with its private lock can the list still change in the the lock block in OtherClass? <code>  public class A{ private readonly object locker = new object(); private List<int> myList; public A() { myList = new List<int>() } private void MethodeA() { lock(locker) { myList.Add(10); } } public void MethodeB() { CallToMethodInOtherClass(myList); }}public class OtherClass{ private readonly object locker = new object(); public CallToMethodInOtherClass(List<int> list) { lock(locker) { int i = list.Count; } }},Is this lock usage thread safe?
Find out battery status in C# or .NET," I have an application that gets detailed system information, and I have been able to get the percent of charge remaining but not the percent of the battery itself.Explanation: As time goes on, the battery slowly gets worse and worse, and some applications, like Dell Support Center on Laptops, display the status of the battery, not the status of the charge, which used to be 100% but now is 90%.How can I get this value in C# or .NET? <code> ",Find out battery charge capacity in percentage using C# or .NET
Converting a byte array to PNG/JPG C#," I am currently working on an application that requires high-performance conversion of an unpadded byte array to either a PNG or JPEG. The image format doesn't matter, just as long as it's fast.I have tried the .NET libraries and the performance is very bad. Can anyone recommend a good freeware library for this?EDIT: the byte[] is an 8bit grayscale bitmap <code> ",Converting a byte array to PNG/JPG
How to check for multiple attributes in xPath?," I'd like to select stylesheets in an XHTML document, which contain not only description, but also href.For example should be selected, and should not.At present, I'm doing it like this: but I suspect there's a much better way of doing this. Is there? <code>  <link rel=""stylesheet"" href=""123""/> <link rel=""stylesheet""/> foreach (XmlNode n in xml.SelectNodes(@""//link[@rel='stylesheet']"")){ if (n.Attributes[""href""]==null||n.Attributes[""""].Value==null) { continue; } var l = Web.RelativeUrlToAbsoluteUrl(stuffLocation, n.Attributes[""href""].Value);}",How to check for multiple attributes in XPath?
C# Attributes: One Attribute to Rule The All?," Is it possible to assign an attribute on a property and use it in order to assign other attributes - doing so without using reflection?The code: I would like to do something like this: <code>  public class CashierOut : BaseActivity{ [Description(""Flag indicates whether break to execution."")] [DefaultValue(false)] [MyCustomAttribute(ParameterGroups.Extended)] public bool CancelExecution { get; set; } [Description(""Flag indicates whether allow exit before declation."")] [DefaultValue(true)] [MyCustomAttribute(ParameterGroups.Extended)] [DisplayName(""Exit before declaration?"")] public bool AllowExitBeforeDeclare { get; set; }} public class CashierOut : BaseActivity{ [MyResourceCustom(""CashierOut.CancelExecution"")] public bool CancelExecution { get; set; } [MyResourceCustom(""CashierOut.AllowExitBeforeDeclare"")] public bool AllowExitBeforeDeclare { get; set; }}public sealed class MyResourceCustom : Attribute{ public string ResourcePath { get; private set; } public ParameterGroupAttribute(string resourcePath) { ResourcePath = resourcePath; // Get attributes attributes value from external resource using the path. }}",C# Attributes: One Attribute to Rule Them All?
How to organize better the unit test project for a large solution with a lot of projects?," I need to add unit tests for an existing solution with a lot of projects. Building the project takes a long time, so I decided to create another seperate solution for unit test projects. I don't know what's better: reference to dll or include in unit test solutions existing projects that I want to test.How should I organize my test cases, and why? Please base answers on your own direct experiences. <code> ",Organizing a unit test project for large solutions
C# Return Different Types?," I have a method which returns different types of instances (classes): How can I do this and later work with the variables, e.g. radio.Play(), etc?Do I need to use generics, and if so, how? <code>  public [What Here?] GetAnything(){ Hello hello = new Hello(); Computer computer = new Computer(); Radio radio = new Radio(); return radio; or return computer; or return hello //should be possible?! }",C# Return different types?
How to make the process of scanning ports faster?," I'm trying to asynchronously scan TCP ports. Since the open ports take just a few hundredths of milliseconds to complete they're fine, but when ports are closed I have to wait for the response.So what happens is that I run the app and almost right away I see the port 80 to be open. Then I must wait like half a minute for all the other ports to get scanned.EDIT. plus I would like to show the respond as it happens, with out waiting for other ports to be checked.How to make this faster? <code>  private void btnStart_Click(object sender, EventArgs e){ for (int port = 79; port < 90; port++) { ScanPort(port); }}private void ScanPort(int port){ TcpClient client = new TcpClient(); client.BeginConnect(IPAddress.Parse(""74.125.226.84""), port, new AsyncCallback(CallBack), client);}private void CallBack(IAsyncResult result){ bool connected = false; using (TcpClient client = (TcpClient)result.AsyncState) { try { client.EndConnect(result); connected = client.Connected; } catch (SocketException) { } } if (connected) { this.Invoke((MethodInvoker)delegate { txtDisplay.Text += ""open2"" + Environment.NewLine; }); } else { this.Invoke((MethodInvoker)delegate { txtDisplay.Text += ""closed2"" + Environment.NewLine; }); } }",How to make the process of scanning TCP ports faster?
Writing an Addin Framework in C#," I am writing an Addin Framework in C# and I'm wondering how I can make Addin's unloadable without requiring a restart of the application.I heard of AppDomains but how do these work? Can an Addin add extendability classes and be called in the Main AppDomain by Interfaces and still be unloadable and call cleanup code resulting in those classes being removed without that Assembly being in the Main AppDomain?Or are there other methods of achieving unloadable addins, but IIRC other then AppDomain's you cannot unload an Assembly.I also want the addin engine to be compatible with Mono if possible, so any answers try to stay compatible with Mono, if you can. <code> ",Writing an Addin or Plugin Framework in C#
DllNotFoundException with DllImport in Mono on Mac," I'm trying to interop with the ImageMagick library in Mono on a Mac. I installed the ImageMagick library with MacPorts and have verified that the file libMagickWand.dylib exists in the directory /opt/local/lib. I've also created a soft link to that file in the directory /usr/local/lib.Here's my DllImport statement: Here's my App.config: And, at the call to WandGenesis();, I get a DllNotFoundException, with the message 'libMagickWand'.I've read this page and I think I'm following all the rules. Is there anything else I can try?Update:I ran the .exe with MONO_LOG_LEVEL=debug. Here is the pertinent information: wrong architecture: I'm running Snow Leopard in 32-bit mode and always have. I installed ImageMagick with MacPorts, and I installed Mono with the Mac package from mono-project.com. What would have been compiled with a different architecture?Update:I think I found my problem: Update:...but I'm still having issues. I can't seem to figure out how to compile ImageMagick with i386 architecture. When I try to do so using flags, it complains about other libraries that were compiled as 64-bit. <code>  [DllImport(""libMagickWand"", EntryPoint = ""MagickWandGenesis"")]static extern void WandGenesis(); <?xml version=""1.0"" encoding=""utf-8""?><configuration> <dllmap dll=""libMagickWand"" target=""/opt/local/lib/libMagickWand.dylib"" /></configuration> Mono: DllImport error loading library 'dlopen(/opt/local/lib/libMagickWand.5.dylib, 9):no suitable image found.Did find: /opt/local/lib/libMagickWand.5.dylib: mach-o, but wrong architecture'. MacBook-Pro:lib ken$ lipo -info libMagickWand.5.dylibNon-fat file: libMagickWand.5.dylib is architecture: x86_64",DllNotFoundException with DllImport in Mono on Mac: wrong architecture
What is the Best .Net technology to synchronizing local and remote SQL server databases?, 1) I am having a desktop application (machine A) using C# and SQL Server. I have another local machine (machine B) it also has its own SQL server instance. I want to synchronize As database with Bdatabase. This process should happen in a time interval.2) I also have an ASP.NET web application running on web server (machine C). I also want to synchronize As database with Cs database. (SQL Server as well.)I have to develop a solution for this problem. The problem is I am not quite sure what technology I am going to use. I have to use a .NET technology or similar Microsoft technology. Our main application was written in C#. <code> ,Does a .NET technology for synchronizing local and remote SQL server databases exist?
Will c# string.GetHashCode() return negative value?," I tried with batch of random strings, all values I got are positive, but I wondering:Will String.GetHashCode() return negative or 0?Since the return value is int, so I guess it might be, so if it is the case, I have to change my logic.If you have answer or have some official sources, please share <code> ",Will string.GetHashCode() return negative value?
ASP.Net Com-InterOp Excel Generation issue when hositing," In my ASP.Net application I'm generating a Excel file using MsExcel Object Libby (Com-InterOp) . The application worked fine in the VS dev. environment.But when I host it in the server I'm getting following error, if I'm no user is logged in to the server through Remote desktop Connection. ""Retrieving the COM class factory for component with CLSID {00024500-0000-0000-C000-000000000046} failed due to the following error: 8000401a The server process could not be started because the configured identity is incorrect. Check the username and password. (Exception from HRESULT: 0x8000401A).""I've set DCOM configurations as well. The strange thing is that at least one user should be connected to the server through RDC. If so everyone can generate excels. If not above error throws. Rest of the functionality of the application works fine. The server is Windows Server 2008, IIS7. And the users connecting the application through a VPN.Has any one experienced a issue like this?Thanks in advance. <code> ",ASP.Net Com-InterOp Excel Generation issue when hosting
Using ReSharper to Sort Methods by Type then Name," I've been trying to get ReSharpers Code Cleanup to not only sort any members alphabetically by name, but to sort them primarily by their type (whether that be a methods return type or a properties type etc.), then by their name.For example: Would become: Ideally, I would like the other default behaviours to remain the same e.g. where Constructors, Properties are positioned/grouped, and if a number of members appear within a region (as in the example above), for that group of members to be sorted independently from members outside of that group/region.Can anyone recommend the code necessary within the ReSharper Type Members Layout pattern editor to achieve this please? <code>  #region "" Properties ""public string Name { get; set; }public int Age { get; set; }#endregion#region "" Instance Methods ""public void SecondMethod()...public void FirstMethod()...public Post GetPost()...public List<Post> GetPosts()...#endregion #region "" Properties ""public int Age { get; set; }public string Name { get; set; }#endregion#region "" Instance Methods ""public List<Post> GetPosts()...public Post GetPost()...public void FirstMethod()...public void SecondMethod()...#endregion",Using ReSharper to Sort Members by Type then Name
"C# String.Substring(): Copy, or Reference?"," When a string is created using the SubString() method, is the resulting string a copy of the elements of the original string (so there are now 2 memory locations with the same information) or is it a reference to the existing memory location?If it is a copy, is there a way to make it a reference instead? <code> ","String.Substring(): Copy, or Reference?"
CheckedListBox search for an item by text," I have a CheckedListBox bound to a DataTable. Now I need to check some items programmatically, but I find that the SetItemChecked(...) method only accepts the item index.Is there a practical way to get an item by text/label, without knowing the item index?(NOTE: I've got limited experience with WinForms...) <code> ",CheckedListBox - Search for an item by text
"Can Jenkins run automated (NUnit) tests for Visual Studio C# (express, 2010)?"," I'm looking to run automated NUnit tests for a C# application, nightly and on each commit to svn.Is this something that Jenkins-CI can do?Is there an online tutorial or how-to document which documents a similar setup that I can look at? <code> ",How do you run NUnit tests from Jenkins?
Moq It.Is<string>()," With Moq, is it valid to have more than one Matching Argument? In this example I want the mockMembershipService to return a different ProviderUserKey depending on the User supplied. The SetUp defaults to the second statement rather than evaluating each on its own merits. <code>  It.Is<string>() mockMembershipService.Setup( x => x.GetUser( It.Is<string>( s => s.Contains(""Joe""))) .ProviderUserKey).Returns(""1234abcd"");mockMembershipService.Setup( x => x.GetUser( It.Is<string>( s => s.Contains(""Tracy""))) .ProviderUserKey).Returns(""5678efgh"");",Multiple Moq It.Is<string>() Matching Arguments
Mulitple Moq It.Is<string>() Matching Arguments," With Moq, is it valid to have more than one Matching Argument? In this example I want the mockMembershipService to return a different ProviderUserKey depending on the User supplied. The SetUp defaults to the second statement rather than evaluating each on its own merits. <code>  It.Is<string>() mockMembershipService.Setup( x => x.GetUser( It.Is<string>( s => s.Contains(""Joe""))) .ProviderUserKey).Returns(""1234abcd"");mockMembershipService.Setup( x => x.GetUser( It.Is<string>( s => s.Contains(""Tracy""))) .ProviderUserKey).Returns(""5678efgh"");",Multiple Moq It.Is<string>() Matching Arguments
How to access the toolstripmenuItem child?," H all,I created a menu strip in Winform not dynamically. And it's all in invisible, when the user is have rights only it visible. My one of username have full rights,. For this I wrote the below code,.. But this is visible the menuItem and child menuItem,. my few childItem menu have more childItem. That means, In TsmMaster and tsmregisterMaster are visible but I can't access the registerMasters Childs(ClassMaster, division Master....)See the below image,..Please give your suggestion.  <code>  private void menuActive(MenuStrip menus){ foreach (ToolStripMenuItem menu in menus.Items) { menu.Visible = true; for (int i = 0; i < menu.DropDown.Items.Count; i++) { menu.DropDown.Items[i].Visible = true; } }}",Access the ToolStripMenuItem child in WinForms
Whats the best way to pick a random element by weight in c#?," Lets assume:List<element> which element is: What I want to achieve is, select an element randomly by the weight.For example: So the chance Element_1 got selected is 100/(100+50+200)=28.57%the chance Element_2 got selected is 50/(100+50+200)=14.29%the chance Element_3 got selected is 200/(100+50+200)=57.14%I know I can create a loop, calculate total, etc...What I want to learn is, whats the best way to do this by Linq in ONE line (or as short as possible), thanks.UPDATEI found my answer below. First thing I learn is: Linq is NOT magic, it's slower then well-designed loop.So my question becomes find a random element by weight, (without as short as possible stuff :) <code>  public class Element(){ int Weight {get;set;}} Element_1.Weight = 100;Element_2.Weight = 50;Element_3.Weight = 200;",Whats the most concise way to pick a random element by weight in c#?
C# EventHandler: What is going on in this code?," this code that adds registers new EventHandler(s) for an event named as NewMail (the eventargs class is named NewMailEventArgs. (source : CLR via C#, chapter 11 Events)What I don't understand is the do part, first we are assigning newMail to prevHandler, then newMail is changed (in CompareExchange) to newHandler? Then we are checking if newMail != prevHandler?I am really kinda confused. Can any one help me understand what exactly is going on in here, specially in the do loop? <code>  // A PUBLIC add_xxx method (xxx is the event name)// Allows methods to register interest in the event.public void add_NewMail(EventHandler<NewMailEventArgs> value) { // The loop and the call to CompareExchange is all just a fancy way // of adding a delegate to the event in a thread-safe way. EventHandler<NewMailEventArgs> prevHandler; EventHandler<NewMailEventArgs> newMail = this.NewMail; do { prevHandler = newMail; EventHandler<NewMailEventArgs> newHandler = (EventHandler<NewMailEventArgs>)Delegate.Combine(prevHandler, value); newMail = Interlocked.CompareExchange<EventHandler<NewMailEventArgs>>(ref this.NewMail, newHandler, prevHandler); } while(newMail != prevHandler);}",EventHandler: What is going on in this code?
C#: Set up dot instead of comma in numeric values," I have new XmlDocument object, i.g. xml is created during my program...I want all numeric values in created xml was with dot symbol instead of comma by default.Can I do something to declare it once, not to parse every decimal value?I.e. To set up this dot instead of comma somewhere in the beginning and don't worry about this till the end? <code> ",Set up dot instead of comma in numeric values
How to set CurrentUICulture/CurrentCulture correctly?," I'm working on a SL5 app with C# and I'm looking to internationalize it. I found the following to set the UI culture: Some controls like the DatePicker seem to pick this up. If I format any datetime by using the 'd' format string, I still get the default format ""M/dd/yyyy"" however.Exactly how does SL interpret culture and how can I set it correctly for the entire application?ThanksUPDATE:Found the answer:First of all, set the appropriate cultures in the Application_Startup: The key element however is to add the following to force the RootVisual's culture/language: <code>  var culture = new CultureInfo(Thread.CurrentThread.CurrentUICulture.TwoLetterISOLanguageName);Thread.CurrentThread.CurrentUICulture = culture;Thread.CurrentThread.CurrentCulture = culture; var culture = new CultureInfo(""nl-BE"");Thread.CurrentThread.CurrentUICulture = culture;Thread.CurrentThread.CurrentCulture = culture; var root = RootVisual as Page;if (root != null){ root.Language = XmlLanguage.GetLanguage(Thread.CurrentThread.CurrentCulture.Name);}",How to set Silverlight CurrentUICulture/CurrentCulture correctly?
What version of Unicode is supported by the .NET platform or how can I use higher planes?," Updated question With regards to character classes, comparison, sorting, normalization and collations, what Unicode version or versions are supported by which .NET platforms?Original questionI remember somewhat vaguely having read that .NET supported Unicode version 3.0 and that the internal UTF-16 encoding is not really UTF-16 but actually uses UCS-2, which is not the same. It seems, for instance, that characters above U+FFFF are not possible, i.e. consider: and it stores the string ""9"".I'm basically looking for definitive references of answers to the following:If it isn't true UTF-16 in .NET, what is it?What version of Unicode is supported by .NET?If recent versions are not supported or planned in the near future, does anybody know of a (non)commercial library or how I can workaround this issue?) I updated the question as with passing time, it seems more appropriate with respect to the answers and to the larger community. I left the original question in place of which parts have been answered in the comments. Also the old UCS-2 (no surrogates) was used in now-ancient 32 bit Windows versions, .NET has always used UTF-16 (with surrogates) internally. <code>  string s = ""\u1D7D9""; // (""Mathematical double-struck digit one"") ",What version of Unicode is supported by which .NET platform and on which version of Windows in regards to character classes?
How to get the sessionState timeout value?," I am implementing my own session provider, and would like to know if the default of 20 minutes is set in the session provider automatically? Is this value provided whether or not an entry is in the configuration file?If not should my session provider is supposed to get it from another location? <code> ",Get the session timeout value when it's not set in the configuration?
How to get the session timeout value in a session provider when it's not set in the configuration?," I am implementing my own session provider, and would like to know if the default of 20 minutes is set in the session provider automatically? Is this value provided whether or not an entry is in the configuration file?If not should my session provider is supposed to get it from another location? <code> ",Get the session timeout value when it's not set in the configuration?
Wanted: JSON template in C#," I need to serialize objects to JSON. I would like to do it with a template instead of using data annotations (as most frameworks do). Does anybody know a good way of doing this?A picture says more than 1000 words. I'm looking for something that looks like this:For example, if I had a class like this: And a had template string that could look like this: I want to get a JSON object, whose properties are filled in according to Key, Name and Related.Name of the object.Basically I'm searching for a JSON serialization method that supports templating instead. <code>  public class Test { public string Key { get; set; } public string Name { get; set; } public string Code { get; set; } public Test Related { get; set; } } { id: ""$Key"", name: ""$Name"", related: ""$Related.Name""}",Templated serialization of C# objects to JSON
Wanted: templated serialization to JSON in C#," I need to serialize objects to JSON. I would like to do it with a template instead of using data annotations (as most frameworks do). Does anybody know a good way of doing this?A picture says more than 1000 words. I'm looking for something that looks like this:For example, if I had a class like this: And a had template string that could look like this: I want to get a JSON object, whose properties are filled in according to Key, Name and Related.Name of the object.Basically I'm searching for a JSON serialization method that supports templating instead. <code>  public class Test { public string Key { get; set; } public string Name { get; set; } public string Code { get; set; } public Test Related { get; set; } } { id: ""$Key"", name: ""$Name"", related: ""$Related.Name""}",Templated serialization of C# objects to JSON
"C# StringBuilder, add Tab between Values"," I have a small problem:I have a List of fields, with 3 Values. I want to build my String with these three Values,delimited by a ""TAB""..Code: The Tab is only between the 3rd and 2nd Value (Between 1st and 2nd is a Space ?!)So I tried this: Then I have 2 Tabs between 3rd and 2nd, one Tab between 1st and 2nd and also a Spacebetween 1st and 2nd..(The Space is always there, how to avoid that?)So what I have to do? Need only (without spaces..) a Tab between these Values.. <code>  StringBuilder stringBuilder = new StringBuilder();foreach (string field in fields){ stringBuilder.Append(field).Append(""\t"");}stringBuilder.AppendLine();return stringBuilder.ToString(); StringBuilder stringBuilder = new StringBuilder();foreach (string field in fields){ stringBuilder.Append(field + ""\t"").Append(""\t"");}stringBuilder.AppendLine();return stringBuilder.ToString();","StringBuilder, add Tab between Values"
hiding an control in c# using css," i am trying to make the control not visable through the css but still the control is been shown.i tried doing like thishtml1.Visible = false;but this creates an gap in the menu where is been used i want to hide the control and do not want to display the gap therehow can we achive this.any help on this would be great <code>  HtmlAnchor html1 = (HtmlAnchor)holder.FindControl(""lblA1"");html1.Attributes.Add(""class"", ""display:none"");",Hiding a control in Asp.net using css
C# Visual Studio 2010 Track Bar Only fire event on final value not ever time value changes," I am working on a pretty basic C# visual studio forms application but am having some issue getting the track bar to act as I want it to so hoping someone in the community might have a solution for this. What I have is a pretty basic application with the main part being a track bar with a value of 0 to 100. The user sets the value of the track to represent ""the amount of work to perform"" at which point the program reaches out to some devices and tells them to do ""x"" amount of work (x being the value of the trackbar). So what I do is use the track bars scroll event to catch when the track bars value has changed and inside the handler call out to the devices and tells them how much work to do.My issue is that my event handler is called for each value between where the track bar currently resides and where ever it ends. So if it is slid from 10 to 30, my event handler is called 20 times which means I am reaching out to my devices and telling them to run at values I don't even want them to run at. Is there someway only to event when scroll has stopped happening so you can check the final value? <code> ",Track Bar Only fire event on final value not ever time value changes
JavaScriptSerializer.Deserialize into a dictionary," I am trying to parse Open Exchange Rates JSON in Json, and I'm using this approach: If I understand the JavaScriptSerializer.Deserialize properly I need to define and object to turn the Json into.I can successfully serialize it using datatypes like this: I would like to be able to replay ""CurrencyRates rates"" with something like: but the parser always returns the rateDictionary as null. Any idea if this is possible, or do you have a better solution?Edit:Json looks like this: <code>  HttpWebRequest webRequest = GetWebRequest(""http://openexchangerates.org/latest.json"");HttpWebResponse response = (HttpWebResponse)webRequest.GetResponse();string jsonResponse = string.Empty;using (StreamReader sr = new StreamReader(response.GetResponseStream())){ jsonResponse = sr.ReadToEnd();}var serializer = new JavaScriptSerializer();CurrencyRateResponse rateResponse = serializer.Deserialize<CurrencyRateResponse>(jsonResponse); public class CurrencyRateResponse{ public string disclaimer { get; set; } public string license { get; set; } public string timestamp { get; set; } public string basePrice { get; set; } public CurrencyRates rates { get; set; }}public class CurrencyRates{ public string AED { get; set; } public string AFN { get; set; } public string ALL { get; set; } public string AMD { get; set; } } public Dictionary<string, decimal> rateDictionary { get; set; } { ""disclaimer"": ""this is the disclaimer"", ""license"": ""Data collected from various providers with public-facing APIs"", ""timestamp"": 1328880864, ""base"": ""USD"", ""rates"": { ""AED"": 3.6731, ""AFN"": 49.200001, ""ALL"": 105.589996, ""AMD"": 388.690002, ""ANG"": 1.79 }}",JavaScriptSerializer.Deserialize() into a dictionary
C# Contravariance on subclass return types," Does anyone know why covariant return types are not supported in C#? Even when attempting to use an interface, the compiler complains that it is not allowed. See the following example. Thanks for any responses. <code>  class Order{ private Guid? _id; private String _productName; private double _price; protected Order(Guid? id, String productName, double price) { _id = id; _productName = productName; _price = price; } protected class Builder : IBuilder<Order> { public Guid? Id { get; set; } public String ProductName { get; set; } public double Price { get; set; } public virtual Order Build() { if(Id == null || ProductName == null || Price == null) throw new InvalidOperationException(""Missing required data!""); return new Order(Id, ProductName, Price); } } }class PastryOrder : Order{ PastryOrder(Guid? id, String productName, double price, PastryType pastryType) : base(id, productName, price) { } class PastryBuilder : Builder { public PastryType PastryType {get; set;} public override PastryOrder Build() { if(PastryType == null) throw new InvalidOperationException(""Missing data!""); return new PastryOrder(Id, ProductName, Price, PastryType); } }}interface IBuilder<in T>{ T Build();}public enum PastryType{ Cake, Donut, Cookie}",C# Covariance on subclass return types
C# windows appication Event: CLR20r3 on application start," I created a C# application and installed it on my test box. My app works perfect on my dev box, but when I install in on a different machine it crashes in the Main(). I get the EventType: CLR20r3here is the Event Message I used the details and looked up the error code in IL Disassembler and cam back with the following... .NET 4.0 has been uninstalled and re installed on the system and did not change anything. I have searched all over the net and everyone with the same problem do not seem to have a solution. I have now spent a day and a half on this problem. I would hate to miss my deadline do to not being able to launch the application.This is the only code in my Main() Here are the details from the Event Viewer EventData Not sure how the designer can have a FileNotFound Exception. I am using the DotNetBar.dll and I am referencing it out of the install directory, so that should be good. I can post my designer if you want, but there is quite a bit there. <code>  Problem signature: Problem Event Name: CLR20r3 Problem Signature 01: logfileviewer.exe Problem Signature 02: 1.0.0.0 Problem Signature 03: 4f356c9c Problem Signature 04: LogFileViewer Problem Signature 05: 1.0.0.0 Problem Signature 06: 4f356c9c Problem Signature 07: 94 Problem Signature 08: 44 Problem Signature 09: System.IO.FileNotFoundException OS Version: 6.1.7601.2.1.0.256.1 Locale ID: 1033 Additional Information 1: 0a9e Additional Information 2: 0a9e372d3b4ad19135b953a78882e789 Additional Information 3: 0a9e Additional Information 4: 0a9e372d3b4ad19135b953a78882e789 Method #5 (06000094) ------------------------------------------------------- MethodName: .ctor (06000094) Flags : [Public] [HideBySig] [ReuseSlot] [SpecialName] [RTSpecialName] [.ctor] (00001886) RVA : 0x000081d0 ImplFlags : [IL] [Managed] (00000000) CallCnvntn: [DEFAULT] hasThis ReturnType: Void No arguments. static void Main() { Application.EnableVisualStyles(); Application.SetCompatibleTextRenderingDefault(false); Application.Run(new frmMain()); } Application: LogFileViewer.exe Framework Version: v4.0.30319 Description: The process was terminated due to an unhandled exception. Exception Info: System.IO.FileNotFoundException Stack: at LogFileViewer.frmMain.InitializeComponent() at LogFileViewer.frmMain..ctor() at LogFileViewer.Program.Main() Application: LogFileViewer.exe Framework Version: v4.0.30319 Description: The process was terminated due to an unhandled exception. Exception Info: System.IO.FileNotFoundException Stack: at LogFileViewer.frmMain.InitializeComponent() at LogFileViewer.frmMain..ctor() at LogFileViewer.Program.Main() ",C# windows application Event: CLR20r3 on application start
Accessing dictionary items instantiated in child thread.," I'm currently grappling with threads and hoping that someone can clearly explain how to resolve the following error.I have a global Dictionary<string, BitmapImage> dic which I instantiate in the main thread.The main thread creates a child thread to populate the dictionary with images.The main thread then tries to access the dictionary and throws an exceptionThe calling thread cannot access this object because a different thread owns itI have no issues accessing the dictionary itself e.g. dic.ContainsKey(""key"") works just fine, it's just when I try to access a BitmapImage in the dictionary that the error occurs.I'm guessing it's because BitmapImages stored in the dictionary are instantiated in the child thread and it's causing an issue - any ideas how I can get around this?I've looked at loads of threading tutorials and advice here but it seems like everywhere else tells you how to access a parent thread object from a child thread whereas I'm trying to do the opposite.Thanks. <code> ",Accessing dictionary items instantiated in child thread
Tell if a var is a perfect number in the binary sequence?, Possible Duplicate: How to check if a number is a power of 2 I want to determine if a number is in 1248163264128256512102420484096819216384...I tried this: As you can see it returns 100000000000000...How should I efficiently make the above print to be 0 for all of them including 1? <code>  public static void Main(string[] args){ int result = 1; for (int i = 0; i < 15; i++) { //Console.WriteLine(result); Console.WriteLine(result % 2); result *= 2; } },Determine if number is in the binary sequence 1 2 4 8 16 32 64 etc
Determine if number is in the binary sequence 1 2 4 8 16 32 64 , Possible Duplicate: How to check if a number is a power of 2 I want to determine if a number is in 1248163264128256512102420484096819216384...I tried this: As you can see it returns 100000000000000...How should I efficiently make the above print to be 0 for all of them including 1? <code>  public static void Main(string[] args){ int result = 1; for (int i = 0; i < 15; i++) { //Console.WriteLine(result); Console.WriteLine(result % 2); result *= 2; } },Determine if number is in the binary sequence 1 2 4 8 16 32 64 etc
How to change Menu hover color winforms, How to change the Hover (mouse over) color of a Windows application menu?Any method in C# ?ORAny way by using Windows API (DllImport) ?See image : <code> ,How to change menu hover color
How to change Menu hover color - WINFORMS, How to change the Hover (mouse over) color of a Windows application menu?Any method in C# ?ORAny way by using Windows API (DllImport) ?See image : <code> ,How to change menu hover color
cycle in the struct layout that dosn't exist," This is a simplified version of some of my code: The problem is the error Struct member 'info' causes a cycle in the struct layout. I'm after struct like value type behaviour. I could simulate this using a class and a clone member function, but I don't see why I should need to.How is this error true? Recursion could perhaps cause construction forever in some similar situations, but I can't think of any way that it could in this case. Below are examples that ought to be fine if the program would compile. edit:The solution I used was to make ""info"" a class instead of a struct and giving it a member function to returned a copy that I used when passing it. In effect simulating the same behaviour as a struct but with a class.I also created the following question while looking for an answer.Value type class definition in C#? <code>  public struct info{ public float a, b; public info? c; public info(float a, float b, info? c = null) { this.a = a; this.b = b; this.c = c; }} new info(1, 2);new info(1, 2, null);new info(1, 2, new info(3, 4));",Cycle in the struct layout that doesn't exist
cycle in the struct layout that doesn't exist," This is a simplified version of some of my code: The problem is the error Struct member 'info' causes a cycle in the struct layout. I'm after struct like value type behaviour. I could simulate this using a class and a clone member function, but I don't see why I should need to.How is this error true? Recursion could perhaps cause construction forever in some similar situations, but I can't think of any way that it could in this case. Below are examples that ought to be fine if the program would compile. edit:The solution I used was to make ""info"" a class instead of a struct and giving it a member function to returned a copy that I used when passing it. In effect simulating the same behaviour as a struct but with a class.I also created the following question while looking for an answer.Value type class definition in C#? <code>  public struct info{ public float a, b; public info? c; public info(float a, float b, info? c = null) { this.a = a; this.b = b; this.c = c; }} new info(1, 2);new info(1, 2, null);new info(1, 2, new info(3, 4));",Cycle in the struct layout that doesn't exist
how to make automapper case insensitive," I found that the mapping is a case sensitive mapping from IDataReaderwhich is a bummer as the database fields are all lower case and the POCOsare CamelCase.I found this post by Jimmy, Is AutoMapper case sensitive or insensitive?...Is there a magic switch somewhere? <code> ",C# - How to make AutoMapper case insensitive?
Should I serialize/deserialize with JSON with DataContractJsonSerializer or JavaScriptSerializer?," The .NET Framework ships with System.Runtime.Serialization.Json.DataContractJsonSerializer and System.Web.Script.Serialization.JavaScriptSerializer, both of which de/serialize JSON. How do I know when to choose one of these types over the other? MSDN doesn't make it clear what their relative advantages are.We have several projects that consume or emit JSON, and the class selected for each thus far has depended on the opinion of the primary dev on each project. Some are simple, two have complex logic regarding producing managed types from JSON (the types do not map closely to the streams) but don't have any emphasis on speed, one requires speed. None interact with WCF, at least as of now. While I'm interested in alternative libraries, I am hoping that somebody might have an answer to my question too.  <code> ",What's the difference between DataContractJsonSerializer and JavaScriptSerializer?
Should I serialize/deserialize JSON with DataContractJsonSerializer or JavaScriptSerializer?," The .NET Framework ships with System.Runtime.Serialization.Json.DataContractJsonSerializer and System.Web.Script.Serialization.JavaScriptSerializer, both of which de/serialize JSON. How do I know when to choose one of these types over the other? MSDN doesn't make it clear what their relative advantages are.We have several projects that consume or emit JSON, and the class selected for each thus far has depended on the opinion of the primary dev on each project. Some are simple, two have complex logic regarding producing managed types from JSON (the types do not map closely to the streams) but don't have any emphasis on speed, one requires speed. None interact with WCF, at least as of now. While I'm interested in alternative libraries, I am hoping that somebody might have an answer to my question too.  <code> ",What's the difference between DataContractJsonSerializer and JavaScriptSerializer?
How to deal with run-time parameters when using instance scoping?," Warning, long post ahead.I've been thinking a lot about this lately and I'm struggling to find a satisfying solution here. I will be using C# and autofac for the examples.The problemIoC is great for constructing large trees of stateless services. I resolve services and pass the data only to the method calls. Great.Sometimes, I want to pass a data parameter into the constructor of a service. That's what factories are for. Instead of resolving the service I resolve its factory and call create method with the parameter to get my service. Little more work but OK.From time to time, I want my services to resolve to the same instance within a certain scope. Autofac provides InstancePerLifeTimeScope() which is very handy. It allows me to always resolve to the same instance within an execution sub-tree. Good.And there are times when I want to combine both approaches. I want data parameter in constructor and have have the instances scoped. I have not found a satisfying way to accomplish this.Solutions1. Initialize methodInstead of passing data into the constructor, just pass it to Initialize method.Interface: Class: Registration: Usage: After resolving the service for the first time and calling Initialize I can happily resolve within the same context and get the same initialized instance. I don't like the fact that before calling Initialize I have an unusable object. There is a danger that the instance will be resolved and used somewhere else before I call Initialize().2. Holder patternThis is a pattern that holds a reference to the data object and instead of injecting the data object itself I inject the holder object.Interface: Class: Registration: Usage: This is a little bit better as I moved the responsibility of holding an instance to a different class. I can now use the holder in other services too. Other advantage is that I can hot swap data in holder if necessary. I don't like the fact that it obfuscates the code and adds another interface I have to mock during testing.3. Let container hold the instanceInterface: Class: Registration: Usage: That's right. I don't store the result of a factory call anywhere, because autofac stores it for me. This is pretty surprising to anybody who will read the code. I'm not sure if autofac was even meant to be used like this. Nice thing about this is that I need neither an extra initialize method nor extra class for holding instance.QuestionWhat is your take on this? How do you handle a situation with run-time data parameters and lifetime scoping? Am I missing a better approach? <code>  interface IMyService{ void Initialize(Data data); void DoStuff();} class MyService : IMyService{ private Data mData; public void Initialize(Data data) { mData = data; } public void DoStuff() { //... }} builder.RegisterType<MyService>().As<IMyService>().InstancePerLifetimeScope(); var myService = context.Resolve<IMyService>();myService.Init(data);// somewhere elsevar myService = context.Resolve<IMyService>(); interface IMyService{ void DoStuff();} class MyService : IMyService{ private Data mData; public MyService(IDataHolder dataHolder) { mData = dataHolder.Data; } public void DoStuff() { //... }} builder.RegisterType<MyService>().As<IMyService>();builder.RegisterType<DataHolder>().As<IDataHolder>().InstancePerLifetimeScope(); var holder = context.Resolve<IDataHolder>();holder.Data = data;// somewhere elsevar myService = context.Resolve<IMyService>(); interface IMyService{ void DoStuff();} class MyService : IMyService{ private Data mData; public MyService(Data data) { mData = dataHolder.Data; } public void DoStuff() { //... }} builder.RegisterType<MyService>().As<IMyService>().InstancePerLifetimeScope(); var myServiceFactory = context.Resolve<Func<Data, IMyService>>();myServiceFactory(data);// somewhere elsevar myService = context.Resolve<IMyService>();",How to deal with run-time parameters when using lifetime scoping?
Winforms: Making a control transparent," I am currently developing a simple image editing tool using Winforms and .NET 3.5 (work environment).I have a requirement that when the user clicks a select tool button, a square (rectangle in C#) will appear that they can scale between 100x100 and 400x400. I have this bit fixed - the issue comes with making the background of the rectangle transparent.I'm a little unclear on if transparency is supported in .NET 3.5, I've tried the following: But this has no effect - any advice would be appreciated. <code>  SetStyle(ControlStyles.SupportsTransparentBackColor, true);pnlSelectArea.BackColor = Color.Transparent;pnlSelectArea.ForeColor = Color.Transparent;selectArea1.BackColor = Color.Transparent;selectArea1.ForeColor = Color.Transparent;",Making a control transparent
"Processing audio ""on-fly"" (C#)"," Is there a way, in a C#, on a .NET, to process audio ""on-fly""? For example, if I want to evaluate average intensity of the audio AT the moment of recording (for that, I will need to have last couple of milliseconds). <code> ","Processing audio ""on-fly"" (C#, WP7)"
What are checked expressions in Java/C#?, I am a C# developer doing occasional coding in Java. Can someone explain in simple terms what are checked exceptions in Java and why is it needed? Haven't come across this term in C#. <code> ,What are checked exceptions in Java/C#?
Transparent background Label over PictureBox," In my C# Form I have a Label that displays a download percentage in the download event: The Label control's BackColor property is set to be transparent and I want it to be displayed over a PictureBox. But that doesn't appear to work correctly, I see a gray background, it doesn't look transparent on top of the picture box. How can I fix this? <code>  this.lblprg.Text = overallpercent.ToString(""#0"") + ""%"";",Transparent control over PictureBox
c#: fastest way to select all strings from list starting from," I'm looking for the fastest way to find all strings in a collection starting from a set of characters. I can use sorted collection for this, however I can't find convenient way to do this in .net. Basically I need to find low and high indexes in a collection that meet the criteria.BinarySearch on List<T> does not guarantee the returned index is that of the 1st element, so one would need to iterate up and down to find all matching strings which is not fast if one has a large list.There are also Linq methods (with parallel), but I'm not sure which data structure will provide the best results.List example, ~10M of records: Search for strings starting from: skk...Result: record indexes from x to y.UPDATE: strings can have different lengths and are unique. <code>  aaaaaaaaaaaaaaabbaaaaaaaaaaaaaabaaaaaaaaaaaaaabc...zzzzzzzzzzzzzxxzzzzzzzzzzzzzyzzzzzzzzzzzzzzzzzzzzza",Fastest way to select all strings from list starting from
Rich TExt box scroll to the bottom when new data is written to it," My program calls Java and then redirects stdout to a RichTextBox. My problem is that the vertical scrollbar always stays at the top of the box every time data is written.Even if you scroll to the bottom, once new data has been written it goes to the top. I would like the opposite.So when new data is written, it stays at the bottom. How can I do this? <code> ",Rich Text box scroll to the bottom when new data is written to it
Field Initializer in Abstract C# Class not Run when Deserializing," I have a class that defines a protected field. The protected field has a field initializer.When I deserialize the concrete class, the field initializer is not run. Why? What is the best pattern to solve the problem? If I move the initialization into a constructor, the constructor is also not invoked. ORIGINAL CLASS HIERARCHY SUPPORTING METHODS <code>  [DataContract]public class MyConcrete{ // FIELD INITIALIZER DOES NOT RUN WHEN COMMENTED IN: protected readonly Dictionary<int, string> myDict;// = new Dictionary<int, string>(); public MyConcrete() { myDict = new Dictionary<int, string>(); } private bool MyMethod(int key) { return myDict.ContainsKey(key); } private int myProp; [DataMember] public int MyProp { get { return myProp; } set { bool b = MyMethod(value); myProp = value; } // Call MyMethod to provoke error }} [DataContract]public abstract class MyAbstract{ // THIS INITIALIZER IS NOT RUN WHILE DESERIALIZING: protected readonly Dictionary<int, string> myDict = new Dictionary<int, string>(); private bool MyMethod(int key) { return myDict.ContainsKey(key); } private int myProp; [DataMember] public int MyProp { get { return myProp; } set { bool b = MyMethod(value); myProp = value; } // Call MyMethod to provoke error }}[DataContract]public class MyConcrete : MyAbstract{}class Program{ static void Main(string[] args) { string tempfn = Path.GetTempFileName(); MyConcrete concrete = new MyConcrete() { MyProp = 42 }; string data = concrete.SerializeToString<MyConcrete>(); MyConcrete rehydrated = SerializationHelper.DeserializeFromString<MyConcrete>(data); }} static public string SerializeToString<T>(this T obj){ return SerializationHelper.SerializeToString<T>(obj);}static public string SerializeToString<T>(T obj){ DataContractSerializer s = new DataContractSerializer(typeof(T)); using (MemoryStream ms = new MemoryStream()) { s.WriteObject(ms, obj); ms.Position = 0; using (StreamReader sr = new StreamReader(ms)) { string serialized = sr.ReadToEnd(); return serialized; } } }static public T DeserializeFromString<T>(string serializedDataAsString){ DataContractSerializer s = new DataContractSerializer(typeof(T)); using (MemoryStream ms = new MemoryStream(Encoding.UTF8.GetBytes(serializedDataAsString))) { object s2 = s.ReadObject(ms); return (T)s2; }}",Field Initializer in C# Class not Run when Deserializing
Read only one line of text from a file, How can I read just the first two lines of a file my program saves? (They represent a username and a password.) <code> ,Read only the first few lines of text from a file
Flatten IEnumerable<IEnumerable<>>; understanding generics," I wrote this extension method (which compiles): The code below causes a compile time error (no suitable method found), why?: If I implement the extension like below, I get no compile time error: Edit(2): This question I consider answered, but it raised another question regarding overload resolution and type constraints. This question I put here: Why aren't type constraints part of the method signature? <code>  public static IEnumerable<J> Flatten<T, J>(this IEnumerable<T> @this) where T : IEnumerable<J>{ foreach (T t in @this) foreach (J j in t) yield return j;} IEnumerable<IEnumerable<int>> foo = new int[2][];var bar = foo.Flatten(); public static IEnumerable<J> Flatten<J>(this IEnumerable<IEnumerable<J>> @this){ foreach (IEnumerable<J> js in @this) foreach (J j in js) yield return j;}",Flatten IEnumerable<IEnumerable<>>; understanding generics
Understanding generics in C#: overload resolution and type constraints," UPDATE: As of C# 7.3, this should no longer be an issue. From the release notes: When a method group contains some generic methods whose type arguments do not satisfy their constraints, these members are removed from the candidate set.Pre C# 7.3:So I read Eric Lippert's 'Constraints are not part of the signature', and now I understand that the spec specifies that type constraints are checked AFTER overload resolution, but I'm still not clear on why this MUST be the case. Below is Eric's example: This doesn't compile because overload resolution for: Foo(new Giraffe()) infers that Foo<Giraffe> is the best overload match but then the type constraints fail and a compile-time error is thrown. In Eric's words: The principle here is overload resolution (and method type inference) find the best possible match between a list of arguments and each candidate methods list of formal parameters. That is, they look at the signature of the candidate method. Type constraints are NOT part of the signature, but why can't they be? What are some scenarios where it is a bad idea to consider type constraints part of the signature? Is it just difficult or impossible to implement? I'm not advocating that if the best chosen overload is for whatever reason impossible to call then silently fallback to the second best; I would hate that. I'm just trying to understand why type constraints can't be used to influence the choosing of the best overload.I'm imagining that internally in the C# compiler, for overload resolution purposes only (it doesn't permanently rewrite the method), the following: gets transformed to: Why can't you sort of ""pull in"" the type constraints into the formal parameter list? How does this change the signature in any bad way? I feel like it only strengthens the signature. Then Foo<Reptile> will never be considered as an overload candidate.Edit 2: No wonder my question was so confusing. I didn't properly read Eric's blog and I quoted the wrong example. I've edited in the example I think more appropriate. I've also changed the title to be more specific. This question doesn't seem as simple as I first imagined, perhaps I'm missing some important concept. I'm less sure that this is stackoverflow material, it may be best for this question/discussion to be moved elsewhere. <code>  static void Foo<T>(T t) where T : Reptile { }static void Foo(Animal animal) { }static void Main() { Foo(new Giraffe()); } static void Foo<T>(T t) where T : Reptile { } static void Foo(Reptile t) { }",Why aren't type constraints part of the method signature?
How do i make a class iterable c#, This is my class I want to make that class iterable to be used like the way below myVarWordSimilarity is csWordSimilarity type. So I want to iterate all public int variables. How do I need to modify csWordSimilarity class for making it iterable like the way above. <code>  public class csWordSimilarity{ public int irColumn1 = 0; public int irColumn2 = 0; public int irColumn3 = 0; public int irColumn4 = 0; public int irColumn5 = 0;} foreach (int irVal in myVarWordSimilarity){} ,How do I make a class iterable?
How do i make a class iterable, This is my class I want to make that class iterable to be used like the way below myVarWordSimilarity is csWordSimilarity type. So I want to iterate all public int variables. How do I need to modify csWordSimilarity class for making it iterable like the way above. <code>  public class csWordSimilarity{ public int irColumn1 = 0; public int irColumn2 = 0; public int irColumn3 = 0; public int irColumn4 = 0; public int irColumn5 = 0;} foreach (int irVal in myVarWordSimilarity){} ,How do I make a class iterable?
C# Asynchronus File Download with Progress Bar," I am attempting to have a progress bar's progress change as the WebClient download progress changes. This code still downloads the file yet when I call startDownload() the window freezes as it downloads the file. I would like for the user to be able to see the progress change as the splash screen loads. Is there any way to fix this so that the user can see the progress of progressBar2 change? <code>  private void startDownload(){ WebClient client = new WebClient(); client.DownloadProgressChanged += new DownloadProgressChangedEventHandler(client_DownloadProgressChanged); client.DownloadFileCompleted += new AsyncCompletedEventHandler(client_DownloadFileCompleted); client.DownloadFileAsync(new Uri(""http://joshua-ferrara.com/luahelper/lua.syn""), @""C:\LUAHelper\Syntax Files\lua.syn"");}void client_DownloadProgressChanged(object sender, DownloadProgressChangedEventArgs e){ double bytesIn = double.Parse(e.BytesReceived.ToString()); double totalBytes = double.Parse(e.TotalBytesToReceive.ToString()); double percentage = bytesIn / totalBytes * 100; label2.Text = ""Downloaded "" + e.BytesReceived + "" of "" + e.TotalBytesToReceive; progressBar1.Value = int.Parse(Math.Truncate(percentage).ToString());}void client_DownloadFileCompleted(object sender, AsyncCompletedEventArgs e){ label2.Text = ""Completed"";}",Asynchronous File Download with Progress Bar
Writing to output window of Visual Studio?," I am trying to write a message to the output window for debugging purposes. I searched for a function like Java's system.out.println(""""). I tried Debug.Write, Console.Write, and Trace.Write. It does not give an error, but it does not print anything either.""Define DEBUG constant"" and ""Define TRACE constant"" options are checked.Menu Tools Options Debugging ""Redirect all Output Window text to the Immediate Window"" option is not checked.Configuration: Active (Debug)Note: I created a project with the wizard as ""Windows Forms Application"" if relevant. I have no idea where to look. <code> ",Writing to output window of Visual Studio
Programmically manage Windows FireWall," I am trying to programmatically create an Outbound Windows firewall rule. In addition, I'd like to programmatically enable and disable this rule. How can I go about doing this in C#? Manually, I can do this by going into control panel, clicking on Windows Firewall, then clicking advanced settings.  <code> ",Programmatically manage Windows Firewall
Programmatically manage Windows FireWall," I am trying to programmatically create an Outbound Windows firewall rule. In addition, I'd like to programmatically enable and disable this rule. How can I go about doing this in C#? Manually, I can do this by going into control panel, clicking on Windows Firewall, then clicking advanced settings.  <code> ",Programmatically manage Windows Firewall
Simple Grammar c#," I have a program with GrammarBuilders and Grammer that is used in a SpeechRecognitionEngine to recognize speech. Can I, rather than recognizing from audio, use the same grammar to recognize a typed command (in a string)? Something like commandGrammar.parse(commandString)? <code> ",Simple Grammar for Speech Recognition
ExecuteNonQuery returning value of 0 when succesfully deleting a record," I have a slight issue in my C# code in Asp.net when deleting a row from sql server. I am using ExecuteNonQuery to determine which message I render to the page. If ExecuteNonQuery returns a 1 then I display success message. Where I am becoming stuck is I have the same logic for adding a record and updating a record and my code works fine. See below for the code. Rows affected currently returns 0. This is a simple SQL statement so my sql is hard-coded in C# and I am not using a stored procedure. Any ideas how I can make this work? <code>  private void Delete_row(string ImageId) { string sSQL = ""delete FROM dbo.Image_library_UK_temp where Image_id="" + ImageId; using (SqlConnection dbConnection = new SqlConnection(app_settings.sql_conn_string_db)) { try { //delete the row from db dbConnection.Open(); SqlCommand command = new SqlCommand(sSQL, dbConnection); command.CommandType = CommandType.Text; command.CommandTimeout = 1024; command.ExecuteNonQuery(); int rowsAffected = command.ExecuteNonQuery(); if (rowsAffected == 1) { messagepanel1.ShowSuccessMessage(""The image "" + txtImgTitle.Text + ""has been deleted from the system.""); DisableValidation(); } } catch (Exception ex) { messagepanel1.ShowErrorMessage(""Error: Deletion unsuccessful""); } Session.RemoveAll(); generateTable(false); } }",ExecuteNonQuery returning value of 0 when successfully deleting a record
Using Alot Of Hardcoded Strings In Code," When I am looking at my code and I am writing things like.. Or Are you guys doing this? When is this ok to do and when shouldn't you be doing this? What if any would be a better approach to write this if any?Thanks For the Comments: I guess I should add what if (for this example purposes) I am only using this role comparison once? Is it still a better idea to make a whole new class? Also should I have 1 class called ""constants"" are multiple classes that that hold specific constants, like ""roles"" class for example? <code>  if (role == ""Customer""){ bCustomer = true;}else if (role == ""Branch""){ bIsBranch = true;} foreach(DataRow as row in myDataSet.Tables[0].Rows){ row[""someField""]=somefield.Tostring()}",Using a lot of hardcoded strings in code
c# $ dollar character in cookies," I have this function to retreive response cookies in a CookieContainer (this.cookies) But, when I debug the request in Fiddler, I get this:Why there is a ""$"" in cookies?According MSDN public Cookie( string name, string value, string path, string domain ) name Type: System.String The name of a Cookie. The following characters must not be used inside name: equal sign, semicolon, comma, newline (\n), return (\r), tab (\t), and space character. The dollar sign character (""$"") cannot be the first character.How can I remove this character? <code>  private void getCookies(string url){ // request HttpWebRequest request = CreateWebRequestObject(url); request.CookieContainer = this.cookies; request.Headers.Add(""Accept-Encoding"", ""gzip, deflate""); request.Headers.Add(""Accept-Language"", "" es-MX,es;q=0.8,en-us;q=0.5,en;q=0.3""); request.Accept = ""text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8""; request.Method = ""GET""; request.UserAgent = ""Mozilla/5.0 (Windows NT 5.1; rv:10.0.2) Gecko/20100101 Firefox/10.0.2""; // response using (HttpWebResponse response = (HttpWebResponse)request.GetResponse()) { foreach (Cookie c in response.Cookies) { this.cookies.Add(new Cookie(c.Name, c.Value, c.Path, c.Domain)); } }}","""$"" dollar character prefixing cookies names"
"Getting ""UnauthorizedAccessException"" in a backgroundworker on a 'new' statement"," I'm doing some heavy work on a backgroundworker, so that it doesn't affect my Silverlight UI thread. However, in the DoWork function I'm getting this exception:UnauthorizedAccessException ""Invalid cross-thread access"".I know I can't access the UI thread from the BackgroundWorker, However, this exception occurs on this line: How is that accessing my ui thread??Here's the actual piece of code I've narrowed it down to. I'm basically doing work creating listboxitems which i'd like to insert to the sourceList listbox: <code>  ListBoxItem insert = new ListBoxItem(); void FillSourceList(){ busyIndicator.IsBusy = true; BackgroundWorker bw = new BackgroundWorker(); bw.DoWork += (sender, args) => { List<ListBoxItem> x = new List<ListBoxItem>(); for (int i = 0; i < 25; i++ ) { ListBoxItem insert = new ListBoxItem(); //<---Getting exception here insert.Content = ""whatever""; x.Add(insert); } args.Result = x; }; bw.RunWorkerCompleted += (sender, args) => { foreach (ListBoxItem insert in (List<ListBoxItem>)(args.Result)) sourceList.Items.Add(insert); busyIndicator.IsBusy = false; }; bw.RunWorkerAsync();}","Getting ""UnauthorizedAccessException"" in a BackgroundWorker without accessing UI thread"
"Getting ""UnauthorizedAccessException"" in a backgroundworker without accessing UI thread"," I'm doing some heavy work on a backgroundworker, so that it doesn't affect my Silverlight UI thread. However, in the DoWork function I'm getting this exception:UnauthorizedAccessException ""Invalid cross-thread access"".I know I can't access the UI thread from the BackgroundWorker, However, this exception occurs on this line: How is that accessing my ui thread??Here's the actual piece of code I've narrowed it down to. I'm basically doing work creating listboxitems which i'd like to insert to the sourceList listbox: <code>  ListBoxItem insert = new ListBoxItem(); void FillSourceList(){ busyIndicator.IsBusy = true; BackgroundWorker bw = new BackgroundWorker(); bw.DoWork += (sender, args) => { List<ListBoxItem> x = new List<ListBoxItem>(); for (int i = 0; i < 25; i++ ) { ListBoxItem insert = new ListBoxItem(); //<---Getting exception here insert.Content = ""whatever""; x.Add(insert); } args.Result = x; }; bw.RunWorkerCompleted += (sender, args) => { foreach (ListBoxItem insert in (List<ListBoxItem>)(args.Result)) sourceList.Items.Add(insert); busyIndicator.IsBusy = false; }; bw.RunWorkerAsync();}","Getting ""UnauthorizedAccessException"" in a BackgroundWorker without accessing UI thread"
LINQ - compare two lists, I have two lists: How to check using LINQ if in the listA exists an element wchich deosn't exists in the listB ? I can use the foreach loop but I'm wondering if I can do this using LINQ <code>  List<int> listA List<int> listB,Find if listA contains any elements not in listB
"C# WinRT, update UI from thread"," Since the Windows 8 consumer preview was released a few days ago, I am working on the new WinRT (for Metro Applications) in C# and I had ported my self written IRC class to the new threading and networking. The problem is: My class is running an thread for receiving messages from the server. If this happens, the thread is making some parsing and then firing an event to inform the application about this. The subscribed function then 'should' update the UI (an textblock).This is the problem, the thread cannot update the UI and the invoker method that has worked with .NET 4.0 doesn't seem to be possible anymore. Is there an new workaround for this or even an better way to update the UI ? If I try to update the UI from the event subscriber i will get this Exception: The application called an interface that was marshalled for a different thread (Exception from HRESULT: 0x8001010E (RPC_E_WRONG_THREAD)) <code> ",Update UI from thread in WinRT
"If C# is not interpreted, then why VM is needed?"," I have read a lot of controversy about C#, where some say it's interpreted, some say it's not. I do know it's compiled into the MSIL and then JITed when run, depending on the processor etc...but isn't it still interpreted in the way it needs a VM (.NET) to run? <code> ","If C# is not interpreted, then why is a VM needed?"
How to detect javascript execution in WebBrowser control," I have a WebBrowser control in my C# application. The web browser is under the user's control, that is, he can load any web page his computer can access on the web (of course limited by proxy, hosts file and so on).I need to know and to be notified when there is a Javascript call inside the page loaded in the web browser component.First example: given a link like this When the user clicks the link I need to know that the function ""jsFunct"" has been called.Second example: given a call like I need to know that, 1 second after the execution of the script, the function jsFunct has been called.The best thing would be to have an event fired when the function is called. It would also be great if the event could get the Javascript code executed, or at least the function name in the arguments.EDIT:Even if the question is related to the webbrowser component, anything that allows the user to detect javascript activation (even via js) would be fine, being able to inject a js that handles the javascript event and passes it to the wb control triggering some event that it can handle. <code>  <a href=""javascript:void(0)"" onclick=""jsFunct();"">test</a> <script type=""text/javascript""> window.setTimeout(""jsFunct()"", 1000);</script>",How to detect Javascript execution in WebBrowser control
"C#, how do I parse json without json .net?"," I'm trying to build a Metro application for Windows 8 on Visual Studio 2011.and while I'm trying to do that, I'm having some issues on how to parse JSON without JSON.NET library (It doesn't support the metro applications yet).Anyway, I want to parse this: <code>  { ""name"":""Prince Charming"", ""artist"":""Metallica"", ""genre"":""Rock and Metal"", ""album"":""Reload"", ""album_image"":""http:\/\/up203.siz.co.il\/up2\/u2zzzw4mjayz.png"", ""link"":""http:\/\/f2h.co.il\/7779182246886""}",How to parse JSON without JSON.NET library?
"Why is it not possible to deserialize a Dictionary<string, object> with XamlWriter.Save"," The above statement returns a NotSupportedException.The strange thing is that I can use the XamlReader to serialize a dictionary. The XML: <code>  public static string GetXml(Dictionary<string, object> parameters){ return XamlWriter.Save(parameters);} public static Dictionary<string, object> GetParameters(IBuildDetail buildDetail, string buildDefinition){ var tfsProject = buildDetail.BuildDefinition.TeamProject; var buildServer = buildDetail.BuildServer; var buildDef = buildServer.GetBuildDefinition(tfsProject, buildDefinition); using (var stringReader = new StringReader(buildDef.ProcessParameters)) { using (var xmlTextReader = new XmlTextReader(stringReader)) { return (Dictionary<string, object>) XamlReader.Load(xmlTextReader); } }} <?xml version=""1.0"" ?><Dictionary x:TypeArguments=""x:String, x:Object"" xmlns=""clr-namespace:System.Collections.Generic;assembly=mscorlib"" xmlns:mtbwa=""clr-namespace:Microsoft.TeamFoundation.Build.Workflow.Activities;assembly=Microsoft.TeamFoundation.Build.Workflow"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml""> <mtbwa:BuildSettings ProjectsToBuild=""$/XXX/Product/Company.XXX.Common/Company.XXX.Common.Basic/Company.XXX.Common.Basic.csproj"" x:Key=""BuildSettings""> <mtbwa:BuildSettings.PlatformConfigurations> <mtbwa:PlatformConfigurationList Capacity=""4""> <mtbwa:PlatformConfiguration Configuration=""DEMO"" Platform=""AnyCPU""/> <mtbwa:PlatformConfiguration Configuration=""Release"" Platform=""AnyCPU""/> </mtbwa:PlatformConfigurationList> </mtbwa:BuildSettings.PlatformConfigurations> </mtbwa:BuildSettings> <mtbwa:TestSpecList Capacity=""0"" x:Key=""TestSpecs""/> <x:String x:Key=""BuildNumberFormat""> $(BuildDefinitionName) 6.0.0$(Rev:.r) </x:String> <mtbwa:CodeAnalysisOption x:Key=""RunCodeAnalysis""> Never </mtbwa:CodeAnalysisOption> <mtbwa:AgentSettings MaxWaitTime=""00:15:00"" TagComparison=""MatchExactly"" Tags="""" x:Key=""AgentSettings""/> <x:Boolean x:Key=""AssociateChangesetsAndWorkItems""> False </x:Boolean> <x:Boolean x:Key=""CreateWorkItem""> False </x:Boolean> <x:Boolean x:Key=""PerformTestImpactAnalysis""> False </x:Boolean> <x:Boolean x:Key=""CreateLabel""> False </x:Boolean> <x:Boolean x:Key=""DisableTests""> True </x:Boolean> <x:Boolean x:Key=""DoCheckinAssemblyInfoFiles""> True </x:Boolean> <x:String x:Key=""AssemblyVersionPattern""> 6.0.0.0 </x:String> <x:String x:Key=""AssemblyFileVersionPattern""> 6.0.0.B </x:String> <x:Boolean x:Key=""UseObfuscation""> True </x:Boolean> <x:String x:Key=""ObfuscatorFilePath""> C:\Program Files (x86)\LogicNP Software\Crypto Obfuscator For .Net 2011 R3\co.exe </x:String> <x:String x:Key=""ObfuscatorProjectFile""> $/XXX/Product/BuildProcess/Company.XXX.ZZZ.obproj </x:String> <x:String x:Key=""ProjectPath""> $/XXX/Product/Company.XXX.Common </x:String></Dictionary>","TFS 2010: Why is it not possible to deserialize a Dictionary<string, object> with XamlWriter.Save when I can use XamlReader for deserializing"
"Why is it not possible to deserialize a Dictionary<string, object> with XamlWriter.Save when I can use XamlReader for desrializing a dictionary"," The above statement returns a NotSupportedException.The strange thing is that I can use the XamlReader to serialize a dictionary. The XML: <code>  public static string GetXml(Dictionary<string, object> parameters){ return XamlWriter.Save(parameters);} public static Dictionary<string, object> GetParameters(IBuildDetail buildDetail, string buildDefinition){ var tfsProject = buildDetail.BuildDefinition.TeamProject; var buildServer = buildDetail.BuildServer; var buildDef = buildServer.GetBuildDefinition(tfsProject, buildDefinition); using (var stringReader = new StringReader(buildDef.ProcessParameters)) { using (var xmlTextReader = new XmlTextReader(stringReader)) { return (Dictionary<string, object>) XamlReader.Load(xmlTextReader); } }} <?xml version=""1.0"" ?><Dictionary x:TypeArguments=""x:String, x:Object"" xmlns=""clr-namespace:System.Collections.Generic;assembly=mscorlib"" xmlns:mtbwa=""clr-namespace:Microsoft.TeamFoundation.Build.Workflow.Activities;assembly=Microsoft.TeamFoundation.Build.Workflow"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml""> <mtbwa:BuildSettings ProjectsToBuild=""$/XXX/Product/Company.XXX.Common/Company.XXX.Common.Basic/Company.XXX.Common.Basic.csproj"" x:Key=""BuildSettings""> <mtbwa:BuildSettings.PlatformConfigurations> <mtbwa:PlatformConfigurationList Capacity=""4""> <mtbwa:PlatformConfiguration Configuration=""DEMO"" Platform=""AnyCPU""/> <mtbwa:PlatformConfiguration Configuration=""Release"" Platform=""AnyCPU""/> </mtbwa:PlatformConfigurationList> </mtbwa:BuildSettings.PlatformConfigurations> </mtbwa:BuildSettings> <mtbwa:TestSpecList Capacity=""0"" x:Key=""TestSpecs""/> <x:String x:Key=""BuildNumberFormat""> $(BuildDefinitionName) 6.0.0$(Rev:.r) </x:String> <mtbwa:CodeAnalysisOption x:Key=""RunCodeAnalysis""> Never </mtbwa:CodeAnalysisOption> <mtbwa:AgentSettings MaxWaitTime=""00:15:00"" TagComparison=""MatchExactly"" Tags="""" x:Key=""AgentSettings""/> <x:Boolean x:Key=""AssociateChangesetsAndWorkItems""> False </x:Boolean> <x:Boolean x:Key=""CreateWorkItem""> False </x:Boolean> <x:Boolean x:Key=""PerformTestImpactAnalysis""> False </x:Boolean> <x:Boolean x:Key=""CreateLabel""> False </x:Boolean> <x:Boolean x:Key=""DisableTests""> True </x:Boolean> <x:Boolean x:Key=""DoCheckinAssemblyInfoFiles""> True </x:Boolean> <x:String x:Key=""AssemblyVersionPattern""> 6.0.0.0 </x:String> <x:String x:Key=""AssemblyFileVersionPattern""> 6.0.0.B </x:String> <x:Boolean x:Key=""UseObfuscation""> True </x:Boolean> <x:String x:Key=""ObfuscatorFilePath""> C:\Program Files (x86)\LogicNP Software\Crypto Obfuscator For .Net 2011 R3\co.exe </x:String> <x:String x:Key=""ObfuscatorProjectFile""> $/XXX/Product/BuildProcess/Company.XXX.ZZZ.obproj </x:String> <x:String x:Key=""ProjectPath""> $/XXX/Product/Company.XXX.Common </x:String></Dictionary>","TFS 2010: Why is it not possible to deserialize a Dictionary<string, object> with XamlWriter.Save when I can use XamlReader for deserializing"
"Why is it not possible to deserialize a Dictionary<string, object> with XamlWriter.Save when I can use XamlReader for deserializing"," The above statement returns a NotSupportedException.The strange thing is that I can use the XamlReader to serialize a dictionary. The XML: <code>  public static string GetXml(Dictionary<string, object> parameters){ return XamlWriter.Save(parameters);} public static Dictionary<string, object> GetParameters(IBuildDetail buildDetail, string buildDefinition){ var tfsProject = buildDetail.BuildDefinition.TeamProject; var buildServer = buildDetail.BuildServer; var buildDef = buildServer.GetBuildDefinition(tfsProject, buildDefinition); using (var stringReader = new StringReader(buildDef.ProcessParameters)) { using (var xmlTextReader = new XmlTextReader(stringReader)) { return (Dictionary<string, object>) XamlReader.Load(xmlTextReader); } }} <?xml version=""1.0"" ?><Dictionary x:TypeArguments=""x:String, x:Object"" xmlns=""clr-namespace:System.Collections.Generic;assembly=mscorlib"" xmlns:mtbwa=""clr-namespace:Microsoft.TeamFoundation.Build.Workflow.Activities;assembly=Microsoft.TeamFoundation.Build.Workflow"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml""> <mtbwa:BuildSettings ProjectsToBuild=""$/XXX/Product/Company.XXX.Common/Company.XXX.Common.Basic/Company.XXX.Common.Basic.csproj"" x:Key=""BuildSettings""> <mtbwa:BuildSettings.PlatformConfigurations> <mtbwa:PlatformConfigurationList Capacity=""4""> <mtbwa:PlatformConfiguration Configuration=""DEMO"" Platform=""AnyCPU""/> <mtbwa:PlatformConfiguration Configuration=""Release"" Platform=""AnyCPU""/> </mtbwa:PlatformConfigurationList> </mtbwa:BuildSettings.PlatformConfigurations> </mtbwa:BuildSettings> <mtbwa:TestSpecList Capacity=""0"" x:Key=""TestSpecs""/> <x:String x:Key=""BuildNumberFormat""> $(BuildDefinitionName) 6.0.0$(Rev:.r) </x:String> <mtbwa:CodeAnalysisOption x:Key=""RunCodeAnalysis""> Never </mtbwa:CodeAnalysisOption> <mtbwa:AgentSettings MaxWaitTime=""00:15:00"" TagComparison=""MatchExactly"" Tags="""" x:Key=""AgentSettings""/> <x:Boolean x:Key=""AssociateChangesetsAndWorkItems""> False </x:Boolean> <x:Boolean x:Key=""CreateWorkItem""> False </x:Boolean> <x:Boolean x:Key=""PerformTestImpactAnalysis""> False </x:Boolean> <x:Boolean x:Key=""CreateLabel""> False </x:Boolean> <x:Boolean x:Key=""DisableTests""> True </x:Boolean> <x:Boolean x:Key=""DoCheckinAssemblyInfoFiles""> True </x:Boolean> <x:String x:Key=""AssemblyVersionPattern""> 6.0.0.0 </x:String> <x:String x:Key=""AssemblyFileVersionPattern""> 6.0.0.B </x:String> <x:Boolean x:Key=""UseObfuscation""> True </x:Boolean> <x:String x:Key=""ObfuscatorFilePath""> C:\Program Files (x86)\LogicNP Software\Crypto Obfuscator For .Net 2011 R3\co.exe </x:String> <x:String x:Key=""ObfuscatorProjectFile""> $/XXX/Product/BuildProcess/Company.XXX.ZZZ.obproj </x:String> <x:String x:Key=""ProjectPath""> $/XXX/Product/Company.XXX.Common </x:String></Dictionary>","TFS 2010: Why is it not possible to deserialize a Dictionary<string, object> with XamlWriter.Save when I can use XamlReader for deserializing"
Dynamic View of ExpandoObjects drops Properties with null Values," I have some code that works with ExpandoObjects populated by database calls. Invariably some of the values are nulls. When I look at the objects as an ExpandoObject, I see all the keys and values (nulls included) in the underlying dictionary. But if I try to access them through a dynamic reference, any key that has a corresponding null value does not show up in the dynamic view of the object. I get an ArgumentNullException when I try to access it via property syntax on the dynamic reference.I know I could work around this by working directly with an ExpandoObject, adding a bunch of try catches, mapping the expando to a concrete type, etc., but that kind of defeats the purpose of having this dynamic object in the first place. The code that consumes the dyanmic object would work fine if some of the properties had null values. Is there a more elgent or succinct way of ""unhiding"" these dynamic properties that have null values?Here's code that demonstrates my ""problem"" <code>  dynamic dynamicRef = new ExpandoObject();ExpandoObject expandoRef = dynamicRef;dynamicRef.SimpleProperty = ""SomeString"";dynamicRef.NulledProperty = null;string someString1 = string.Format(""{0}"", dynamicRef.SimpleProperty);// My bad; this throws because the value is actually null, not because it isn't// present. Set a breakppoint and look at the quickwatch on the dynamicRef vs.// the expandoRef to see why I let myself be led astray. NulledProperty does not// show up in the Dynamic View of the dynamicRefstring someString2 = string.Format(""{0}"", dynamicRef.NulledProperty);","Dynamic View of ExpandoObjects ""hides"" Properties with null Values"
CLR Hosting: Call a function with an arbitrary value?," I need to take a C++ program, load CLR and call a function in a C# library. The function I need to call takes in a COM interface as the parameter.My problem is, the CLR hosting interface only seems to let you call a method with this signature: Example, this C++ code loads CLR and runs the P.Test function in ""test.exe"": What I need to do is call a function with this method signature (note I own the C# code, so I can change it): Where IFoo is a com interface. I could even do what I need to if I could call a function like this: I could have SomeFunction construct a correct delegate then use Marshal.GetFunctionPointerForDelegate. However, I can't figure out how to make the hosting interfaces do anything other than call a function with an int func(string) signature.Does anyone know how to call a C# function from C++ code with a different signature?(Note I cannot use C++/CLI for this. I need to use the hosting APIs.) <code>  int Foo(String arg) ICLRRuntimeHost *pClrHost = NULL;HRESULT hrCorBind = CorBindToRuntimeEx(NULL, L""wks"", 0, CLSID_CLRRuntimeHost, IID_ICLRRuntimeHost, (PVOID*)&pClrHost);HRESULT hrStart = pClrHost->Start();DWORD retVal;HRESULT hrExecute = pClrHost->ExecuteInDefaultAppDomain(L""C:\\Test.exe"", L""P"", L""Test"", L"""", &retVal); void SomeFunction(IFoo interface) IntPtr SomeFunction();",CLR Hosting: Call a function with an arbitrary method signature?
"Stackoverflow, Redis, and Cache invalidation"," Now that Stack Overflow uses redis, do they handle cache invalidation the same way? i.e. a list of identities hashed to a query string + name (I guess the name is some kind of purpose or object type name). Perhaps they then retrieve individual items that are missing from the cache directly by id (which bypasses a bunch of database indexes and uses the more efficient clustered index instead perhaps). That'd be smart (the rehydration that Jeff mentions?).Right now, I'm struggling to find a way to pivot all of this in a succinct way. Are there any examples of this kind of thing that I could use to help clarify my thinking prior to doing a first cut myself?Also, I'm wondering where the cutoff is between using a .net cache (System.Runtime.Caching or System.Web.Caching) and going out and using redis. Or is Redis just hands down faster?Here's the original SO question from 2009:https://meta.stackexchange.com/questions/6435/how-does-stackoverflow-handle-cache-invalidationA couple of other links:https://meta.stackexchange.com/questions/69164/does-stackoverflow-use-caching-and-if-so-how/69172#69172https://meta.stackexchange.com/questions/110320/stack-overflow-db-performance-and-redis-cache <code> ","Stack Overflow, Redis, and Cache invalidation"
Remove grinds from chart. c#, How can I remove chart grid lines in a System.Windows.Forms.DataVisualization.Charting chart? <code> ,Remove grid lines from Winforms Chart
Issue with VB.NET/C# data table Select statement," The following VB line, where _DSversionInfo is a DataSet, returns no rows: but inspection shows that the table contains rows with FileID's of 92, 93, 94, 90, 88, 89, 215, 216. The table columns are all of type string.Further investigation showed that using the ID of 88, 215 and 216 will only return rows if the number is quoted.ie _DSversionInfo.Tables(""VersionInfo"").Select(""FileID='88'"")All other rows work regardless of whether the number is quoted or not.Anyone got an explanation of why this would happen for some numbers but not others? I understand that the numbers should be quoted just not why some work and others don't?I discovered this in some VB.NET code but (despite my initial finger pointing) don't think it is VB.NET specific. <code>  _DSversionInfo.Tables(""VersionInfo"").Select(""FileID=88"")",Issue with data table Select statement
Creating a dustinct list of custom type in C#," I receive a List of en entity framework type and want to only return the distinct values from the List. I'm using the following approach, however it's not uniquifying the list. Any suggestions?Param: List<Flag> flags The values of Flag are as follows: ID, Flag, FlagValue. Could I use linq in this instance?Thanks. <code>  List<Flag> distinctFlags = flags.Distinct().ToList();",Creating a distinct list of custom type in C#
Get users that are 'memberof' a group (ldap/activedirectory)," I got a working solution, however I'm pretty sure there is a less resource-intensive method because the current solution involves doing a query to get the groups member and then a query to get each users information. Here is the code I have : Ideally I'd like to be able to do a single query to get every user that are member of a group, filters the properties to load and then display them. So something like this Unfortunately, that doesn't work for some reason. <code>  DirectoryEntry root = new DirectoryEntry( ""LDAP://server:port"" );DirectorySearcher searcher = new DirectorySearcher( root );searcher.Filter = ""(&(ObjectClass=Group)(CN=foo-group))"";var members = (IEnumerable)searcher.FindOne() .GetDirectoryEntry() .Invoke( ""members"" );Dictionary<string , string> results = new Dictionary<string , string>();foreach( object member in members ) { DirectoryEntry de = new DirectoryEntry( member ); results.Add( de.Properties[ ""SAMAccountname"" ][ 0 ].ToString(), de.Properties[ ""cn"" ][ 0 ].ToString() );} DirectoryEntry root = new DirectoryEntry( ""LDAP://server:port"" );DirectorySearcher searcher = new DirectorySearcher( root );searcher.PropertiesToLoad.Add( ""cn"" );searcher.PropertiesToLoad.Add( ""SAMAccountname"" );searcher.Filter = ""(&(ObjectClass=user)(memberof=foo-group))"";foreach( var user in searcher.FindAll() ) { //do whatever...}",Get users that are 'memberof' a group
Get users that are 'memberof' a group," I got a working solution, however I'm pretty sure there is a less resource-intensive method because the current solution involves doing a query to get the groups member and then a query to get each users information. Here is the code I have : Ideally I'd like to be able to do a single query to get every user that are member of a group, filters the properties to load and then display them. So something like this Unfortunately, that doesn't work for some reason. <code>  DirectoryEntry root = new DirectoryEntry( ""LDAP://server:port"" );DirectorySearcher searcher = new DirectorySearcher( root );searcher.Filter = ""(&(ObjectClass=Group)(CN=foo-group))"";var members = (IEnumerable)searcher.FindOne() .GetDirectoryEntry() .Invoke( ""members"" );Dictionary<string , string> results = new Dictionary<string , string>();foreach( object member in members ) { DirectoryEntry de = new DirectoryEntry( member ); results.Add( de.Properties[ ""SAMAccountname"" ][ 0 ].ToString(), de.Properties[ ""cn"" ][ 0 ].ToString() );} DirectoryEntry root = new DirectoryEntry( ""LDAP://server:port"" );DirectorySearcher searcher = new DirectorySearcher( root );searcher.PropertiesToLoad.Add( ""cn"" );searcher.PropertiesToLoad.Add( ""SAMAccountname"" );searcher.Filter = ""(&(ObjectClass=user)(memberof=foo-group))"";foreach( var user in searcher.FindAll() ) { //do whatever...}",Get users that are 'memberof' a group
How to sign a clickonce application," I have a ClickOnce application that I built for a client, and I need it to be from a trusted publisher. How do I go about acquiring an Authenticode certificate and sign my application with it? So that when the application is launched, it's from a trusted publisher?How do I install the certificate? Do I have to install it on my development server or does it matter where I install it?How does the whole process work? I don't want to spend 3-5 hundred dollars on a certificate, and install something wrong and be out of luck.Are there good tutorials on purchasing and installing a certificate and signing a ClickOnce application? <code> ",How to sign a ClickOnce application
How do I make a post request with c#?," TL; DR: I'm new to this language and have no idea what I'm doinghere is my class so far: when I do csc filename.cs, I get the following error: The type or namespace name 'Http' does not exist in the namespace 'System.Net' (are you missing an assembly reference?) <code>  using System;using System.Collections.Generic;using System.Net.Http;using System.Web;using System.Net;using System.IO;public class MyClass { private const string URL = ""https://sub.domain.com/objects.json?api_key=123""; private const string data = @""{""""object"""":{""""name"""":""""Title""""}}""; public static void CreateObject() { HttpWebRequest request = (HttpWebRequest)WebRequest.Create(URL); request.Method = ""POST""; request.ContentType = ""application/json""; request.ContentLength = data.Length; StreamWriter requestWriter = new StreamWriter(request.GetRequestStream(), System.Text.Encoding.ASCII); requestWriter.Write(data); requestWriter.Close(); try { // get the response WebResponse webResponse = request.GetResponse(); Stream webStream = webResponse.GetResponseStream(); StreamReader responseReader = new StreamReader(webStream); string response = responseReader.ReadToEnd(); responseReader.Close(); } catch (WebException we) { string webExceptionMessage = we.Message; } catch (Exception ex) { // no need to do anything special here.... } } static void Main(string[] args) { MyClass.CreateObject(); }}",System.Net.Http: missing from namespace? (using .net 4.5)
c#: System.Net.Http: missing from namespace? (using .net 4.5)," TL; DR: I'm new to this language and have no idea what I'm doinghere is my class so far: when I do csc filename.cs, I get the following error: The type or namespace name 'Http' does not exist in the namespace 'System.Net' (are you missing an assembly reference?) <code>  using System;using System.Collections.Generic;using System.Net.Http;using System.Web;using System.Net;using System.IO;public class MyClass { private const string URL = ""https://sub.domain.com/objects.json?api_key=123""; private const string data = @""{""""object"""":{""""name"""":""""Title""""}}""; public static void CreateObject() { HttpWebRequest request = (HttpWebRequest)WebRequest.Create(URL); request.Method = ""POST""; request.ContentType = ""application/json""; request.ContentLength = data.Length; StreamWriter requestWriter = new StreamWriter(request.GetRequestStream(), System.Text.Encoding.ASCII); requestWriter.Write(data); requestWriter.Close(); try { // get the response WebResponse webResponse = request.GetResponse(); Stream webStream = webResponse.GetResponseStream(); StreamReader responseReader = new StreamReader(webStream); string response = responseReader.ReadToEnd(); responseReader.Close(); } catch (WebException we) { string webExceptionMessage = we.Message; } catch (Exception ex) { // no need to do anything special here.... } } static void Main(string[] args) { MyClass.CreateObject(); }}",System.Net.Http: missing from namespace? (using .net 4.5)
What is time complexity of C#'s List.sort()," What is time complexity of C#'s List<T>.Sort()I guess it's o(N)But after I searched a lot, I didn't get any accurate result. <code> ",What is time complexity of .NET List.sort()
how to read a Xml file and write into List<>?, I have a List<> which I wrote into an XML file.Now I am trying to read the same file and write it back to List<>.Is there a method to do that? <code> ,How to read XML file into List<>?
How to read a XML file and write into List<>?, I have a List<> which I wrote into an XML file.Now I am trying to read the same file and write it back to List<>.Is there a method to do that? <code> ,How to read XML file into List<>?
how to get curruntcell position x and y in datagridview?," I have a Windows form with a calendar which is hidden. I want to show the form right under the current cell of a DataGridView. The position changes according to the position of current cell. I don't want the current cell or current column, I want the position so that I can set the location of my date forms.Here is what I am using but its not working: <code>  int po_X = paygrid.GetCellDisplayRectangle(e.ColumnIndex, e.RowIndex, false).Left+paygrid.Left;int po_Y = paygrid.GetCellDisplayRectangle(e.ColumnIndex, e.RowIndex, false).Bottom+paygrid.Top;form_date.Location = new System.Drawing.Point(po_X, po_Y);",How do I to get the current cell position x and y in a DataGridView?
Expression Lambda versus Satement Lambda," Fundamentally, is there any difference between a single-line expression lambda and a statement lambda? Take the following code, for example: While I prefer the first because I find the brackets to be ugly, is there anything different between the two (besides the obvious part about requiring brackets for multi-line statements)? <code>  private delegate void MyDelegate();protected static void Main(){ MyDelegate myDelegate1 = () => Console.WriteLine(""Test 1""); MyDelegate myDelegate2 = () => { Console.WriteLine(""Test 2""); }; myDelegate1(); myDelegate2(); Console.ReadKey();}",Expression Lambda versus Statement Lambda
Coding with an encrypted Souce Code. Possible or Not?," I created a simple SFX application which works on Compressing / Packing files. When someone click the output file he will be prompted for a password, if password entered correctly the file decrypt it self following a specific routines. A customer said that my file was a virus, so i scanned the file online on VirusTotal.com and i seen that the file was detected by avira in the SCAN RESULT. I reexamined the source code Line by Line, and i found that the following Lines of code are detected. What i want to do now is to find a solution which let me encrypt the class above, so instead of writing it as it is in my C# propgram i will write the encrypted string. and use a function which decrypt and execute the encrypted string at Run-time. So instead of writing the above class i will write the following Then simply i call a function like: Is this possible, and how can I achieve this in the case it is.  <code>  public class SimplerAES { private static byte[] key = { 88, 54, 54, 147, 99, 201, 41, 80, 58, 100, 5, 64, 213, 99, 14, 15, 154, 35, 110, 36, 124, 25, 115, 23, 56, 44, 65, 7, 45, 254, 1, 54 }; private static byte[] vector = { 33, 8, 121, 196, 223, 45, 63, 100, 1, 32, 18, 87, 1, 158, 119, 111}; private ICryptoTransform encryptor, decryptor; private UTF8Encoding encoder; public SimplerAES() { RijndaelManaged rm = new RijndaelManaged(); encryptor = rm.CreateEncryptor(key, vector); decryptor = rm.CreateDecryptor(key, vector); encoder = new UTF8Encoding(); } public string Encrypt(string unencrypted) { return Convert.ToBase64String(Encrypt(encoder.GetBytes(unencrypted))); } public string Decrypt(string encrypted) { return encoder.GetString(Decrypt(Convert.FromBase64String(encrypted))); } public byte[] Encrypt(byte[] buffer) { MemoryStream encryptStream = new MemoryStream(); using (CryptoStream cs = new CryptoStream(encryptStream, encryptor, CryptoStreamMode.Write)) { cs.Write(buffer, 0, buffer.Length); } return encryptStream.ToArray(); } public byte[] Decrypt(byte[] buffer) { MemoryStream decryptStream = new MemoryStream(); using (CryptoStream cs = new CryptoStream(decryptStream, decryptor, CryptoStreamMode.Write)) { cs.Write(buffer, 0, buffer.Length); } return decryptStream.ToArray(); } } String MYCODE = ""687b1ddf28e8d9d3141c3b5d8d4d1863964a614c74317e88a18a10c1c4723bed18d53c99eeb5f05b6646b10b63ae14166c81b06dd487103d133a06896ed9a125e8e2a9c54a2fec82ddd8abe4ef9bbe1b99664a8bc761db2ce70cd1dd9d6898e72490ccea73d7dab056e86cec23f39328b9eb3ef3ef7942db4122178b8a319971c6de2a5cb7e23dd5ba382525a7993122bf068d9d7ac189e701e1b2120b6f5747123e320f892a51df0ff38d7fef5c24d8914a9974d36183c4885582d2ce37023cbde2c23896e608754e81cf9faf70cd64fea5e930340e185fcfe1f457710a2e8b7c977b4c851f8fb4dd49ea53216dc8242ec6ac17e5256ab16170ac49a124a3972477e6bbfefbf1e1c1f84290e023fa2d7813e7761c9e2872c2d57e8d69be34c2cbb41fd75b81604ebf57dece4c9fd6b5bce441350cc4e2ca1bc78105ee554629ff6201745088a177859d168ffffb356fb2bb327de7495db77e07d9fcc9787fc4313a5118037f5828eb2ac7a006126b21b207eb22a369b3182d1f613b43a097d214650c6fd0af057f7836586b4f55342351e93fbb03f726982f4356c801342b6efe7a9fe29ba6770a61d29656725ed21c77a17fe61ffb6d9dea55bbd1ab9e70c1ce44fc82ed710550483ae3b6049aa7d24cc142f5d521bc8beaa36d2839fb82efe59aafa713659c3e902a65c27e8fa9712cd9d232ac65fbf20bef047371317bd60331f8b8b2971cc1ba2b5e854c3d0b072ad786deb40811dcdb335d2937a1ef86a5d0923294ed9eed758670856bbd89471e4940d6dbdae6d8e4cb10235645c2e23be442a4739d0a24a56b666828269704984621ba9761d47512e0804a3a20b0f7c15ff10036dedb4ad8f1149c028de5d726f9e62244fc22b45a5096736d6dd65e9afddd05234982818f7eccd35555805169cf1ef887bf06bc4cee729513c255ff3e41de5397e45212ca921e394bfd059f30cd3404a3a7e989e374239c22aca956e39d576838bed69551040095a4e070fdecd369b7be51ae30ad0a8c4d3c23c7678a7bb661a720e88d396218b0f37bea4f7959df498b7f2e59460b32735685b551f0fe74786a119ce9343ebd4c3f2efea11f02741a067300fe836ad7943577c56b22cf54964b6bf8be4b0a61c353be7fffe90166c5a1c667938878eace2046eb254fc65ef7a3c98c7877651e1cc735bb006d5ba9fdf5f5555345570a43adbe6a49ed714d79990f408f667ac2a624511b0fc1674bdff0cd02b11a2666cb76b39c84d5aeb2b32c3777f7f577495bdef2ac7cf8a119487c8a97a6c1ec8f5b775cd7059f7edd3d8da1764467058991d6a6c5b061fdbbc255103798d5d2e2d75eff80316b65abff2b9d1514f55e2db114e207ba6d41419924e9397404750a7822daa93c5055dbd3448f8d25550cae7daf8fea9d6ab51eff5f11e88dabe81a0030a775480bb694acf95ce4cf48497fd24272853a62e1af55c5ab4e2d058ebd04f053a01b86b7d87e0c1c8bae2ed3f3e5f2096d83569aef940331f29ed27656968880433b6a892b97239acef888afb9b4f4e3dcb4bb67823ce1e80f2068805145daacea016267dadbb78f437aaed32711dcc436f9a4997cc19eb797c10ca3c8c432b4fdf9c886bdc566f233400e202630925eb837c812c9ba95957ca7035056831d93ab16cd5c9095090e64b3f90d6ff709f732237dd41a3cebe371f7328b7bd3cbb6cf695f98c69b45e1999a3595bd12cc23f5f3cfcf13e355b7a3ea5b0bbc5c60142ae85829915f48d4ae0fc896ed8113e6062a7c6e54ac8470d0c8cc5b5e5e91d702a7b19af4a9b647e84db3ad1c5c65f2f450f99cdce1be4b3a3404070de4f45f36eb0acec358452c72c475ee69615614889737b698afab9472ab2cd12a543555dbe31199b8c188232a85bbbff925a6e8bac9e0c98fd8156b34b849dcbbcb9077018c5a1d5ca7b76fa5ba3e5fa5070c47d4a4e1723503500f1b63395d60fcf8eb551fb3aaac2a52763d89584951e6adcec46cde1e0e7dc0c511fc38a9cb92413c4f4eb54a803ff18e759a9aac56760ab97f1a25f7474561964e541fac9ae4c53d1728565bfe8007c2a015d9e7a2877891a829db9a3b70e91507f060362efe6f7d51573feadb7cedfab390a6a53e171e28b4c0582c2dd944d2b227b0d79f7484795bdbe15da65c3a60d859b10cc3b20614c827eff8d78bf5a64d86d5404c14b96bbd46c2ae176064feb5ef80b5147dae06faa34982b5835fe0562ce210c27abce2e15235cd530550f1927dc2b73f732b159391fbe186a670284a81a3e22d182b0587dda31429d296b486683d3b74205ce6a15102334c43c610c44841fad92ab9456340ef55fde6814ba11a0d069dd680b7b2c63aaa5b6a7d1ab119ebbfb2c5322ee950f94f9780652e258650b2991a62f9964a6534a16104de5463f1fb278b82690999c6ff48a3eed75ca7a619ab5ae4c3c2a66b4bc7d450f597aba119cfcb292f1a91032cc0a8f11f9baabd491fff0bcea62c72f8e30c87e58b769c5a5e1f6c7aca403ace859f199fb60381412d75703966c8adcef9a6938bde96d09376692a9bffe6ab4c31d7f71c8d959feadb0e532a3e6dd8f84d9e0f114d81bb3122ba2cbb9f59b636118a0d7a3c5f177329ccb50a049a60d6"" xor_get_and_execute_original_code(MYCODE,mykey);",Coding with an encrypted Source Code. Possible or Not?
Quote escape character in string," This is probably a really simple question but I can't seem to get my head around it. I need to have a string that contains \"" without it seeing it as an escape character. I tried using @ but it won't work. The only other way I thought of doing this would be to use \u0022 but don't want to unless I can help it.Desired string - string s = ""\""\""""; // Obviously this doesn't work!Desired console output - \""\""Hope this makes sense.Thanks! <code> ","How to quote \"" (slash double-quote) in a string literal?"
"What is the difference between int,int16,int32,int64"," What is the difference between int, System.Int16, System.Int32 and System.Int64 other than their sizes? <code> ","What is the difference between int, Int16, Int32 and Int64?"
"What is the difference between INT, INT16, INT32 and INT64?"," What is the difference between int, System.Int16, System.Int32 and System.Int64 other than their sizes? <code> ","What is the difference between int, Int16, Int32 and Int64?"
MVC 4 Web Api IIS7.5 HTTP 404 Page Not Found," I have a Web Api application. It works perfectly well when I tested it using the VS 2010 debugging dev server. But I now deployed it to IIS 7.5 and I am getting a HTTP 404 error when trying to access the application.Here is my web.config <code>  <?xml version=""1.0"" encoding=""utf-8""?><configuration> <connectionStrings> <add name=""DefaultConnection"" connectionString=""Data Source=.\SQLEXPRESS;Initial Catalog=aspnet-FlowGearProxy-20123141219;Integrated Security=True"" providerName=""System.Data.SqlClient"" /> </connectionStrings> <appSettings> <add key=""webpages:Version"" value=""2.0.0.0"" /> <add key=""webpages:Enabled"" value=""true"" /> <add key=""PreserveLoginUrl"" value=""true"" /> <add key=""ClientValidationEnabled"" value=""true"" /> <add key=""UnobtrusiveJavaScriptEnabled"" value=""true"" /> </appSettings> <system.web> <compilation debug=""true"" targetFramework=""4.0"" /> <authentication mode=""Forms""> <forms loginUrl=""~/Account/Login"" timeout=""2880"" /> </authentication> <pages> <namespaces> <add namespace=""System.Web.Helpers"" /> <add namespace=""System.Web.Mvc"" /> <add namespace=""System.Web.Mvc.Ajax"" /> <add namespace=""System.Web.Mvc.Html"" /> <add namespace=""System.Web.Routing"" /> <add namespace=""System.Web.WebPages"" /> </namespaces> </pages> </system.web> <system.webServer> <validation validateIntegratedModeConfiguration=""false"" /> <modules runAllManagedModulesForAllRequests=""true"" /> </system.webServer></configuration>",HTTP 404 Page Not Found in Web Api hosted in IIS 7.5
Fuction evaluation timed out when examining variables in debug/stepping through," When debugging/stepping through code, and I try to examine a variable in the watch, I get errors for every inner-variable stating function evaluation timed out.Does anyone know why this is and how to avoid it? As it impacts my ability to debug code.This is within VS2010 Premium. <code> ",Function evaluation timed out when examining variables in debug/stepping through
Warning messages VS2010 -," I am getting many of the following warning messages. Is this something I should be concerned with? Warning 1 The element 'PropertyGroup' in namespace 'http://schemas.microsoft.com/developer/msbuild/2003' has invalid child element 'ImportByWildcardBeforeMicrosoftCommonTargets' in namespace 'http://schemas.microsoft.com/developer/msbuild/2003'. List of possible elements expected: 'Property, AllowUnsafeBlocks, AppConfigForCompiler, ApplicationIcon, ApplicationRevision, ApplicationVersion, AppDesignerFolder, AspNetConfiguration, AssemblyKeyContainerName, AssemblyKeyProviderName, AssemblyName, AssemblyOriginatorKeyFile, AssemblyOriginatorKeyFileType, AssemblyOriginatorKeyMode, AssemblyType, AutorunEnabled, BaseAddress, BootstrapperComponentsLocation, BootstrapperComponentsUrl, BootstrapperEnabled, CharacterSet, CheckForOverflowUnderflow, CLRSupport, CodePage, Configuration, ConfigurationName, ConfigurationOverrideFile, CreateDesktopShortcut, CreateWebPageOnPublish, CurrentSolutionConfigurationContents, DebugSecurityZoneURL, DebugSymbols, DebugType, DefaultClientScript, DefaultHTMLPageLayout, DefaultTargetSchema, DefineConstants, DefineDebug, DefineTrace, DelaySign, DisableLangXtns, DisallowUrlActivation, CodeAnalysisAdditionalOptions, CodeAnalysisApplyLogFileXsl, CodeAnalysisConsoleXsl, CodeAnalysisCulture, CodeAnalysisFailOnMissingRules, CodeAnalysisForceOutput, CodeAnalysisGenerateS.... C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets 20 9 Miscellaneous Files <code> ",MSBuild warning messages in VS2010
How can I check if a value can be casted to a generic type?," I have a method wrapping some external API call which often returns null. When it does, I want to return a default value. The method looks like this The problem is that (T)value might throw an invalid cast exception. So I thought I would change it to but this requires where T : struct, and I want to allow reference types as well.Then I tried adding an overload which would handle both. but I found you can't overload based on constraints.I realize I can have two methods with different names, one for nullable types and one for nonnullable types, but I'd rather not do that.Is there a good way to check if I can cast to T without using as? Or can I use as and have a single method which works for all types? <code>  public static T GetValue<T>(int input){ object value = ExternalGetValue(input); return value != null ? (T)value : default(T)} var value = ExternalGetValue(input) as Nullable<T>; public static T GetValue<T>(int input) where T : struct { ... }public static T GetValue<T>(int input) where T : class { ... }",How can I check if a value can be cast to a generic type?
dotNet 2 / 3 application refuses to run under dotNet 4," I have written a small utility to collect system data and output it to a text box. Nothing complex at all, the purpose is to audit a users machine in preparation for a software rollout. I can't say what version of .NET a user will be operating, so when I created the solution I selected framework 2.0. Debug and testing the released EXE on my machine is fine. When I load it onto an XP machine with only has .NET 4.0 (full) it refuses to run, advising me that I need to install .NET 2.0. I then updated the release to 3.0 but this did the same thing. I have .NET 4.0 on the machine, why can't this application run with a greater version installed and how can I make the application execute under all .NET versions? <code> ",.NET 2 / 3 application refuses to run under .NET 4
C# GetName for enum with duplicate values," If I have duplicate values in a C# enum, saying What should be the values of the following strings? Is it true that V1 and V2 must contain the same values?What these values should be?I haven't found anything in MSDN or here concerning such a dereferencing of enums with duplicates, point me to a link, please, if I missed that. <code>  enum MyE { value1 = 1, value2 = 2, valued = 1} MyE N = (MyE)1;string V1 = N.ToString();string V2 = GetName(MyE, 1);",GetName for enum with duplicate values
c# how to make webbrowser wait till it loads fully?," I have a C# form with a web browser control on it. I am trying to visit different websites in a loop. However, I can not control URL address to load into my form web browser element. This is the function I am using for navigating through URL addresses: How can I make my loop wait until it fully loads?My loop is something like this: <code>  public String WebNavigateBrowser(String urlString, WebBrowser wb){ string data = """"; wb.Navigate(urlString); while (wb.ReadyState != WebBrowserReadyState.Complete) { Application.DoEvents(); } data = wb.DocumentText; return data;} foreach (string urlAddresses in urls){ WebNavigateBrowser(urlAddresses, webBrowser1); // I need to add a code to make webbrowser in Form to wait till it loads}",How to make WebBrowser wait till it loads fully?
How to make webbrowser wait till it loads fully?," I have a C# form with a web browser control on it. I am trying to visit different websites in a loop. However, I can not control URL address to load into my form web browser element. This is the function I am using for navigating through URL addresses: How can I make my loop wait until it fully loads?My loop is something like this: <code>  public String WebNavigateBrowser(String urlString, WebBrowser wb){ string data = """"; wb.Navigate(urlString); while (wb.ReadyState != WebBrowserReadyState.Complete) { Application.DoEvents(); } data = wb.DocumentText; return data;} foreach (string urlAddresses in urls){ WebNavigateBrowser(urlAddresses, webBrowser1); // I need to add a code to make webbrowser in Form to wait till it loads}",How to make WebBrowser wait till it loads fully?
C# Setting value in an array via reflection," Is there a way to set a single value in an array property via reflection in c#?My property is defined like this: For ""normal"" properties I use this code to set it via reflection: How would I have to change this code to set the value in an array property at an arbitrary position?Thanks!BTW: I tried to use the index parameter, but that seems only to work for indexed properties, not properties that are arrays... <code>  double[] Thresholds { get; set; } PropertyInfo pi = myObject.GetType().GetProperty(nameOfPropertyToSet);pi.SetValue(myObject, Convert.ChangeType(valueToSet, pi.PropertyType), null);",Setting value in an array via reflection
IFrame with dynamically set source," I have an IFrame embedding a youtube video. I want to create a textbox where user (admins) can paste a new src (URL) of video and the IFrame take the new source. Here is what I have so far: And in the html code is the Iframe: I don't set any src in the beginning but when I paste a URL in the textbox and hit the button, the Iframe doesn't displays anything. <code>  protected void Edited_Click(object sender, EventArgs e) { // HtmlControl frame1 = (HtmlControl)this.FindControl(""frame1""); string url = TextBox1.Text; frame1.Attributes[""src""] = url; } <div id=""video""> <iframe title=""YouTube video player"" runat=""server"" width=""420"" frameborder=""1"" style=""height: 265px; float: left; text-align: center;"" id=""frame1"" name=""frame1"" align=""middle""></iframe> <br /> </div>",How do I dynamically set source of an IFrame?
GZipStream machine dependendence," I'm running into some strange machine/OS dependent GZipStream behavior in .NET 4.0. This is the relevant code: Running Compress(""freek"") gives me on Windows 7 and on Windows Server 2008R2. Both are 64bit. I would expect the results to be the same.Both machines give the correct result when I decompress either result. I already found out that on W7 ms.Length == 25 while on W2K8R2 ms.Length==128, but no clue why.What's going on? <code>  public static string Compress(string input) { using(var ms = new MemoryStream(Encoding.UTF8.GetBytes(input))) using(var os = new MemoryStream()) { using(var gz = new GZipStream(os,CompressionMode.Compress,true)) { ms.CopyTo(gz); } return string.Join("""",os.ToArray().Select(b=>b.ToString(""X2""))); }} 1F8B08000000000004004B2B4A4DCD06001E33909D05000000 1F8B0800000000000400ECBD07601C499625262F6DCA7B7F4AF54AD7E074A10880601324D8904010ECC188CDE692EC1D69472329AB2A81CA6556655D661640CCED9DBCF7DE7BEFBDF7DE7BEFBDF7BA3B9D4E27F7DFFF3F5C6664016CF6CE4ADAC99E2180AAC81F3F7E7C1F3F22CEEB3C7FFBFF040000FFFF1E33909D05000000",GZipStream machine dependence
How can I see the compile error-code back again in Visual Studio Error List view?," In previous versions of Visual Studio I remember I saw the error code/number in the Error List View. I may have that confused with C++ though. To see the actual compile error number I need to save and compile the project and then check the Output-window.It's nothing but a convenience to see the actual error number at once and it makes it easier to do a Google search for it. Below is a screenshot of error code CS1002.Anybody any idea how to magically show the compile time error numbers again?PS: likewise, it would be great if hitting F1 in that same window would bring me to the error description page on MSDN as opposed to the useless ""how to use the Error Window"" page. <code> ",How can I see the compile error-code number in Visual Studio Error List view?
Winforms: how to looping through combobox items value to check it?, How do I cycle through a ComboBox Values list so I can check each value and select one of them efficiently?Examples in C# or VB.Net welcome. <code> ,How to loop through a combox values list and select one of them
How to looping through combobox items value to check it?, How do I cycle through a ComboBox Values list so I can check each value and select one of them efficiently?Examples in C# or VB.Net welcome. <code> ,How to loop through a combox values list and select one of them
how to get the network interface and its right ipv4 address?," I need to know how to get all network interfaces with their IPv4 address. Or just wireless and Ethernet.To get all network interfaces details I use this: And to get the all hosted IPv4 addresses of the computer: But how to get the network interface and its right ipv4 address? <code>  foreach (NetworkInterface ni in NetworkInterface.GetAllNetworkInterfaces()) { if(ni.NetworkInterfaceType == NetworkInterfaceType.Wireless80211 || ni.NetworkInterfaceType == NetworkInterfaceType.Ethernet) { Console.WriteLine(ni.Name); }} IPAddress [] IPS = Dns.GetHostAddresses(Dns.GetHostName());foreach (IPAddress ip in IPS) { if (ip.AddressFamily == AddressFamily.InterNetwork) { Console.WriteLine(""IP address: "" + ip); }}",How do I get the network interface and its right IPv4 address?
What does <something> denote in C#," I'm new to C# and directly diving into modifying some code for a project I received. However, I keep seeing code like this : and I cannot make sense of what the means nor what it is called.If anyone would care to help me just name what this concept is called, I can search it online. However, I'm clueless as of now. <code>  class SampleCollection<T> <T> ",What does <T> denote in C#
C# : Dictionary with lock or Concurency Dictionary?, Which is preferred in a multi-threaded application: Dictionary with lock object or Concurrency DictionaryWhich is efficient and why should I use one or the other?edit 1: Storing Guid as key and bool as value.edit 2: more than 2 worker threads and one UI thread. <code> ,Dictionary with lock or Concurency Dictionary?
Bind to SelectedItems from DataGrid in MVVM," Just doing some light reading on WPF where I need to bind the selectedItems from a DataGrid but I am unable to come up with anything tangible. I just need the selected objects.DataGrid: <code>  <DataGrid Grid.Row=""5"" Grid.Column=""0"" Grid.ColumnSpan=""4"" Name=""ui_dtgAgreementDocuments"" ItemsSource=""{Binding Path=Documents, Mode=TwoWay}"" SelectedItem=""{Binding Path=DocumentSelection, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"" HorizontalAlignment=""Stretch"" VerticalAlignment=""Stretch"" Background=""White"" SelectionMode=""Extended"" Margin=""2,5"" IsReadOnly=""True"" CanUserAddRows=""False"" CanUserReorderColumns=""False"" CanUserResizeRows=""False"" GridLinesVisibility=""None"" HorizontalScrollBarVisibility=""Hidden"" columnHeaderStyle=""{StaticResource GreenTea}"" HeadersVisibility=""Column"" BorderThickness=""2"" BorderBrush=""LightGray"" CellStyle=""{StaticResource NonSelectableDataGridCellStyle}"" SelectionUnit=""FullRow"" HorizontalContentAlignment=""Stretch"" AutoGenerateColumns=""False"">",Bind to SelectedItems from DataGrid or ListBox in MVVM
ASP.NET: How to get user local time at Page_Load," I have a web page written in ASP.NET and I need to retrieve the end user's local time at Page_Load. I thought about using Javascript to get the local time (by using new Date()) but the problem is that the script is run after the server events. Any ideas on how to accomplish this?EDIT: My page is quite complex: it displays a chart with lots of calculated fields from a database, object/fields selection lists, etc; The customer now requested that it should consider the user's timezone and that the timezone should be determined automatically by the web page. The user date is important to determine the chart interval (which day to display data on).Data loading (since it is so complicated) is done in both Page_Load and Page_PreRender. Giving up these events would require a full page rewrite.FINAL SOLUTION INSPIRED BY ANSWER:Here is how I solved the problem eventually. I am keeping the local date in a cookie. Here is the method that sets the cookie: In my Master page I call this method on $(document).ready. On the page where I use this cookie I added the following code to Page_Init: Then I can just use the cookie value in the C# code.Thank you for your answers/comments! <code>  function SetLocalDateCookie() { var cookieName = 'LOCALDATE'; var localDate = new Date(); var realMonth = localDate.getMonth() + 1; var localDateString = localDate.getFullYear() + ""/"" + realMonth + ""/"" + localDate.getDate(); setCookie(cookieName, localDateString, 2); try { var exdate = new Date(); exdate.setDate(exdate.getDate() + 2); document.cookie = cookieName + ""="" + escape(localDateString) + "";expires="" + exdate.toGMTString(); } catch (e) { }} if (string.IsNullOrEmpty(CookieHandler.Instance.GetCookie(CookieKeys.LocalDate))){ Response.ClearContent(); Response.Write(@""<form id='local' method='post' name='local'> <script type='text/javascript'> SetLocalDateCookie(); document.getElementById('local').submit(); </script> </form>""); Response.Flush(); Response.End();}",How to get user local time at Page_Load
Impure methods called on readonly fields," I'm using Visual Studio 2010 + ReSharper and it shows a warning on the following code: rect is a readonly Rectangle field, and ReSharper shows me this warning:""Impure Method is called for readonly field of value type.""What are impure methods and why is this warning being shown to me? <code>  if (rect.Contains(point)){ ...}",Impure method is called for readonly field
Impure method is called for readonly field," I'm using Visual Studio 2010 + ReSharper and it shows a warning on the following code: rect is a readonly Rectangle field, and ReSharper shows me this warning:""Impure Method is called for readonly field of value type.""What are impure methods and why is this warning being shown to me? <code>  if (rect.Contains(point)){ ...}",Impure method is called for readonly field
Metro UI update," I am writing a Windows Store App toy application for Windows 8.It has just one xaml page with a TextBlock. The page has the class MyTimer as DataContext : MyTimer implements INotifyPropertyChanged and the updating of the property Time is made with a timer: with the TextBlock has a databinding on Time When I run the application i have the following exception: With the message The application called an interface that was marshalled for a different thread. (Exception from HRESULT: 0x8001010E (RPC_E_WRONG_THREAD))The real problem is that I am updating the property of the class MyTimer, not the GUI itself, I can't figure it out, but I think the solution should use something like this one. <code>  this.DataContext = new MyTimer(); public MyTimer(){ TimerElapsedHandler f = new TimerElapsedHandler(NotifyTimeChanged); TimeSpan period = new TimeSpan(0, 0, 1); ThreadPoolTimer.CreatePeriodicTimer(f, period);} private void NotifyTimeChanged(){ if (this.PropertyChanged != null){ this.PropertyChanged(this, new PropertyChangedEventArgs(""Time"")); }} <TextBlock Text=""{Binding Time}"" /> System.Runtime.InteropServices.COMException was unhandled by user code",Windows Store App UI update
C# - X509Certificate Constructor Exception," When loading a certificate from our database, on our staging server (Windows 2008 R2/IIS7.5) we get this exception: NOTE: This issue does not happen locally (Windows 7/Casini).Any insight is greatly appreciated. <code>  //cert is an EF Entity and // cert.CertificatePKCS12 is a byte[] with the certificate.var certificate = new X509Certificate(cert.CertificatePKCS12, ""SomePassword""); System.Security.Cryptography.CryptographicException: An internal error occurred. at System.Security.Cryptography.CryptographicException.ThrowCryptographicException(Int32 hr) at System.Security.Cryptography.X509Certificates.X509Utils._LoadCertFromBlob(Byte[] rawData, IntPtr password, UInt32 dwFlags, Boolean persistKeySet, SafeCertContextHandle& pCertCtx) at System.Security.Cryptography.X509Certificates.X509Certificate.LoadCertificateFromBlob(Byte[] rawData, Object password, X509KeyStorageFlags keyStorageFlags)",X509Certificate Constructor Exception
X509Certificate Constructor Exception," When loading a certificate from our database, on our staging server (Windows 2008 R2/IIS7.5) we get this exception: NOTE: This issue does not happen locally (Windows 7/Casini).Any insight is greatly appreciated. <code>  //cert is an EF Entity and // cert.CertificatePKCS12 is a byte[] with the certificate.var certificate = new X509Certificate(cert.CertificatePKCS12, ""SomePassword""); System.Security.Cryptography.CryptographicException: An internal error occurred. at System.Security.Cryptography.CryptographicException.ThrowCryptographicException(Int32 hr) at System.Security.Cryptography.X509Certificates.X509Utils._LoadCertFromBlob(Byte[] rawData, IntPtr password, UInt32 dwFlags, Boolean persistKeySet, SafeCertContextHandle& pCertCtx) at System.Security.Cryptography.X509Certificates.X509Certificate.LoadCertificateFromBlob(Byte[] rawData, Object password, X509KeyStorageFlags keyStorageFlags)",X509Certificate Constructor Exception
Change font of text in richtextbox c#," My text is in a richtextbox: I want change color font & text color of text :1- For tags -> font name = Tahoma , size= 10,color=redExample : <Parag1 Level=""One""> Or </Parag1>2- For Text between tags that tag's level is not Footer -> font name = Arial , size= 12,color=blackExample : First text of parag1. Second text of parag1. Or First text of parag4. Second text of parag4.3- For Text between tags that tag's level is Footer -> font name = Microsoft Sans Serif, size= 8,color=blueExample : First text of parag3. Second text of parag3.How can I do it in c# ?(Changes font of all text at once!) <code>  <Parag1 Level=""One"">First text of parag1. Second text of parag1.</Parag1><Parag2 Level=""Two"">First text of parag2. Second text of parag2.</Parag2><Parag3 Level=""Footer"">First text of parag3. Second text of parag3.</Parag3><Parag4 Level=""Three"">First text of parag4. Second text of parag4.</Parag4>",Change font of text in richtextbox
how to remove all instances of a specific character from a string," I am trying to remove all of a specific character from a string. I have been using String.Replace, but it does nothing, and I don't know why. This is my current code: This just leaves the string as it was before. Can anyone please explain to me as to why? <code>  if (Gamertag2.Contains(""^"")) { Gamertag2.Replace(""^"" + 1, """"); }",How to remove all instances of a specific character from a string?
"async CTP: when the method return void, is the same that a task?"," I am trying the async CTP, the versin 4.5 that allow use async methods without needing to write the Begin/End methods.My first probe is to execute an async method that return void. I see a few examples and do the following: In my WPF project I have a textBox where to see the results and a button that execute the async method.In the async method, I use await, that is need because the method is async, and the TasEx.Run to create a new thread in which execute the code.My doubt is in this point. In a few examples that I see of how to create an async method that returns void, use this way, the Task.Run or TaskEx.Run.If I am not wrong, Task.Run create a new thread where to execute the method. Then why to use an async method, if with the Task, creating a new thread, I get what I want, not to block the main thread?Also, if the async method access some shared variable, I must be careful with the concurrency, right? So I don't know the advantage of using async methods, at least in this case.In fact, I use the same code without async and without await and the result is the same, the main program is not blocking and all works as I expect. The method is this: My question is, this is the correct way to use async when the method return void? <code>  private void btnAsync01_Click(object sender, RoutedEventArgs e){ UpdateTxtLog(""click button: "" + System.DateTime.Now); method01Async(); UpdateTxtLog(""after ethod01Async: "" + System.DateTime.Now);}private async void method01Async(){ await TaskEx.Run(() => { UpdateTxtLog(""Enter method01Async: "" + System.DateTime.Now); Thread.Sleep(10000); UpdateTxtLog(""exit method01Async: "" + System.DateTime.Now); });} private void method01Async(){ TaskEx.Run(() => { UpdateTxtLog(""Enter method01Async: "" + System.DateTime.Now); Thread.Sleep(10000); UpdateTxtLog(""Exit method01Async: "" + System.DateTime.Now); });}","When the method return void, is the same that a task?"
How to make Resharper format line-wrapped ternary operators in the following way -, I really want Resharper to format my line-wrapped ternaries in this way Can anyone help with this? <code>  return navigator.IsTerminating ? navigator.Context : navigator.Context.GetSimulatableRelative(new Navigator(navigator));,How to make Resharper format line-wrapped ternary operators in the following way
"C# How to make a List<string> {get;set;} per thread,"," I have a class that requires dynamically setting a List. I also call this class 10 or so different times using Threading.public static List<string> MyList {get;set;}I'm new to threading, however, as I've been told this is unsafe. The question I have is how do I make an instance of MyList per thread?An example would be awesome! <code> ","How to make a List<string> {get;set;} per thread,"
C# % (mod) explanation," Today I was writing a program in C#, and I used % to calculate some index... My program didn't work, so I debugged it and I realized that ""%"" is not working like in other program languages that I know.For example:In Python % returns values like this: In C#: Did I do something wrong or is % not working like it should? <code>  for x in xrange (-5, 6): print x, ""% 5 ="", x % 5-5 % 5 = 0-4 % 5 = 1-3 % 5 = 2-2 % 5 = 3-1 % 5 = 40 % 5 = 01 % 5 = 12 % 5 = 23 % 5 = 34 % 5 = 45 % 5 = 0 for (int i = -5; i < 6; i++){ Console.WriteLine(i + "" % 5 = "" + i % 5);}-5 % 5 = 0-4 % 5 = -4-3 % 5 = -3-2 % 5 = -2-1 % 5 = -10 % 5 = 01 % 5 = 12 % 5 = 23 % 5 = 34 % 5 = 45 % 5 = 0",% (mod) explanation
C# extra brackets?," I'm curious about this thing... see example: All my life I've done it like case b, but since C# allows me to use it, and Visual Studio allows me to collapse that thing, I am curious - what is the real difference between case a (with braces) and case b? <code>  switch(x){ case(a): { //do stuff } break; case(b): //do stuff break;}",What is the purpose of the extra braces in Switch case?
C# extra braces?," I'm curious about this thing... see example: All my life I've done it like case b, but since C# allows me to use it, and Visual Studio allows me to collapse that thing, I am curious - what is the real difference between case a (with braces) and case b? <code>  switch(x){ case(a): { //do stuff } break; case(b): //do stuff break;}",What is the purpose of the extra braces in Switch case?
C# timer for function," I want to see how long a function is running. So I added a timer object on my form, and I came out with this code: And: But this is not counting anything. Why? <code>  private int counter = 0;// Inside button click I have:timer = new Timer();timer.Tick += new EventHandler(timer_Tick);timer.Start();Result result = new Result();result = new GeneticAlgorithms().TabuSearch(parametersTabu, functia);timer.Stop(); private void timer_Tick(object sender, EventArgs e){ counter++; btnTabuSearch.Text = counter.ToString();}",How do I measure how long a function is running?
How to measure how long is a function running?," I want to see how long a function is running. So I added a timer object on my form, and I came out with this code: And: But this is not counting anything. Why? <code>  private int counter = 0;// Inside button click I have:timer = new Timer();timer.Tick += new EventHandler(timer_Tick);timer.Start();Result result = new Result();result = new GeneticAlgorithms().TabuSearch(parametersTabu, functia);timer.Stop(); private void timer_Tick(object sender, EventArgs e){ counter++; btnTabuSearch.Text = counter.ToString();}",How do I measure how long a function is running?
How to measure how long a function is running?," I want to see how long a function is running. So I added a timer object on my form, and I came out with this code: And: But this is not counting anything. Why? <code>  private int counter = 0;// Inside button click I have:timer = new Timer();timer.Tick += new EventHandler(timer_Tick);timer.Start();Result result = new Result();result = new GeneticAlgorithms().TabuSearch(parametersTabu, functia);timer.Stop(); private void timer_Tick(object sender, EventArgs e){ counter++; btnTabuSearch.Text = counter.ToString();}",How do I measure how long a function is running?
COM object that has been separated from its underlying RCW cannot be used," I've a class in my .NET 3.5 C# WinForms application which has five methods.Each method uses different sets of C++ COM interfaces.Am using Marshal.FinalReleaseCOMObject for cleaning up these COM objects. This code works fine on this .NET platform without any issues.But when I move this application to .NET 4.0, I start getting this error in one of these methods at a line where I cast a variable from ICOMInterface1 to ICOMInterface2, i.e.: COM object that has been separated from its underlying RCW cannot be used.And if I remove the line where am using Marshal.FinalReleaseCOMObject, I don't get this error.What am I missing here? And how do I clean up these unmanaged COM objects from the memory on .NET 4.0 platform? <code>  ICOMInterface1 myVar= obj as ICOMInterface2; ","""COM object that has been separated from its underlying RCW cannot be used"" with .NET 4.0"
Converting from DateTime to SQLDateTime is inacurate," I have a method that gets a date property from a source (either a DataRow or a SqlDataReader): but the conversion appears to be changing the date slightly so that my test always fails.Does anyone know why this method would be converting wrongly? At the end of the method, it looks like the conversion to SqlDateTime does some rounding: <code>  protected SqlDateTime GetSqlDateTimePropertyValue(string propertyName, object source){ var objValue = GetPropertyValue(propertyName, source); var value = objValue == DBNull.Value ? null : (DateTime?)objValue; var sqlValue = new SqlDateTime(); if (value.HasValue) sqlValue = value.Value; return sqlValue;} value.Value.Ticks: 634698391707468296sqlValue.Value.Ticks: 634698391707470000",Converting from DateTime to SqlDateTime is inaccurate
Why throwing exception in constructor results in a null object?," Why throwing exception in constructor results in a null reference?For example, if we run the codes below the value of teacher is null, while st.teacher is not (a Teacher object is created). Why? <code>  using System;namespace ConsoleApplication1{ class Program { static void Main( string[] args ) { Test(); } private static void Test() { Teacher teacher = null; Student st = new Student(); try { teacher = new Teacher( """", st ); } catch ( Exception e ) { Console.WriteLine( e.Message ); } Console.WriteLine( ( teacher == null ) ); // output True Console.WriteLine( ( st.teacher == null ) ); // output False } } class Teacher { public string name; public Teacher( string name, Student student ) { student.teacher = this; if ( name.Length < 5 ) throw new ArgumentException( ""Name must be at least 5 characters long."" ); } } class Student { public Teacher teacher; }}",Why throwing exception in constructor results in a null reference?
C# Datetimepicker only Month and Year, How can I set the Datetimepicker-Format to MM/YYYY? <code> ,How to set Datetimepicker to Month and Year only format?
Using WebApi as a standalone project in one solution, If i want to use WebAPI as a service to connect to multiple databases on different servers and retrieve the data that my MVC application will use what is the best way to do it? I don't want do have ApiController(s) in the same project as my MVC project so do i need to add a new WebApi project (delete all except controllers and stuff that the template adds to have a clean project) that my MVC application will reference?Here's the list of tutorials/blog posts i used to learn about WebAPI:ASP.NET Web API - Screencast series with downloadable sample codehttp://weblogs.asp.net/jgalloway/archive/2012/03/16/asp-net-web-api-screencast-series-with-downloadable-sample-code-part-1.aspxConsuming ASP.NET Web API Service using HttpClienthttp://debugmode.net/2012/03/03/creating-first-http-service-using-asp-net-web-api-part1-of-many/http://debugmode.net/2012/03/07/consuming-asp-net-web-api-service-using-httpclient-part2-of-many/CRUD operation using ASP.NET Web API and MVC4http://www.dotnetglobe.com/2012/03/crud-operation-using-aspnet-web-api-in.htmlhttp://www.dotnetglobe.com/2012/03/crud-operation-using-aspnet-web-api-in_28.htmlCreating a .Net queryable client for ASP.Net Web API oData serviceshttp://blog.petegoo.com/index.php/2012/03/11/creating-a-net-queryable-client-for-asp-net-web-api-odata-services/Using HttpClient to Consume ASP.NET Web API REST Serviceshttp://www.johnnycode.com/blog/2012/02/23/consuming-your-own-asp-net-web-api-rest-service/Client side support with the ASP.NET Web APIhttps://msmvps.com/blogs/theproblemsolver/archive/2012/03/13/client-side-support-with-the-asp-net-web-api.aspxCreate and Consume ASP.Net Web API REST Services - MVC4http://www.askamoeba.com/Opensource/Opensourcedetail/144/Create-and-Consume-ASP-Net-Web-API-REST-Services-MVC4Building and consuming REST services with ASP.NET Web API using MediaTypeFormatter and OData supporthttp://robbincremers.me/2012/02/16/building-and-consuming-rest-services-with-asp-net-web-api-and-odata-support/Using JSON.NET with ASP.NET Web APIhttp://blogs.msdn.com/b/henrikn/archive/2012/02/18/using-json-net-with-asp-net-web-api.aspxCreating Custom CSVMediaTypeFormatter In ASP.NET Web API for Comma-Separated Values (CSV) Formathttp://www.tugberkugurlu.com/archive/creating-custom-csvmediatypeformatter-in-asp-net-web-api-for-comma-separated-values-csv-formatImplementing CORS support in ASP.NET Web APIshttp://blogs.msdn.com/b/carlosfigueira/archive/2012/02/20/implementing-cors-support-in-asp-net-web-apis.aspxHow I see Web APIhttp://thedatafarm.com/blog/asp-net/how-i-see-web-api/ <code> ,ASP.NET Web Api as a standalone project in one solution
"Read, replace and write very large files in C#"," Possible Duplicate: How to read a large (1 GB) txt file in .NET? What is the optimal way in C# to read an file, replace some strings and write in another new file? I need to do this with very large files like 8GB or 25GB. <code> ","How can I read, replace and write very large files?"
Protobuf-net serialization/deserialization to/from byte[] without stream," I checked but seem to be unable to see how to directly serialize a class to a byte array and subsequently deserialize from a byte array using Marc Gravell's protobuf-net implementation. Edit: I changed the question and provided code because the original question of how to serialize into byte[] without having to go through stream was admittedly trivial. My apologies.Updated Question: Is there any way to not have to deal with generics and instead infer the type of the property ""MessageBody"" through reflection when it is passed through the constructor? I assume I cannot serialize object type, correct? The current solution looks very cumbersome in that I need to pass in the type of the MessageBody each time I instantiate a new Message. Is there a sleeker solution to this? I came up with the following: What I like to get to is something such as: Message newMsg = new Message(""Producer"", ""Consumer"", Foo);byte[] byteArray = newMsg.Serialize();andMessage msg = Message.Deserialize(byteArray);(where Deserialize is a static method and it always deserializes into an object of type Message and only needs to know what type to deserialize the message body into). <code>  class Program{ static void Main(string[] args) { Message<string> msg = new Message<string>(""Producer"", ""Consumer"", ""Test Message""); byte[] byteArray = msg.Serialize(); Message<string> message = Message<string>.Deserialize(byteArray); Console.WriteLine(""Output""); Console.WriteLine(message.From); Console.WriteLine(message.To); Console.WriteLine(message.MessageBody); Console.ReadLine(); }}[ProtoContract]public class Message<T>{ [ProtoMember(1)] public string From { get; private set; } [ProtoMember(2)] public string To { get; private set; } [ProtoMember(3)] public T MessageBody { get; private set; } public Message() { } public Message(string from, string to, T messageBody) { this.From = from; this.To = to; this.MessageBody = messageBody; } public byte[] Serialize() { byte[] msgOut; using (var stream = new MemoryStream()) { Serializer.Serialize(stream, this); msgOut = stream.GetBuffer(); } return msgOut; } public static Message<T> Deserialize(byte[] message) { Message<T> msgOut; using (var stream = new MemoryStream(message)) { msgOut = Serializer.Deserialize<Message<T>>(stream); } return msgOut; } }",Protobuf-net serialization/deserialization
How do i edit the MainWindow constructor of a WPF application?," My mainWindow needs to subscribe to some events from an object. The object is initialized before the MainWindow is created. I would like to pass this object to the mainWindow via its constructor.However I can't figure out from where the MainWindow constructor is called. Alternatively I tried to pass the object via a member function of the MainWindow, but the app.MainWindow is null before app.Run() is called. After app.Run() is called the code doesn't return until the program terminates.Another posibility would be storing the object in a static class and have the MainWindow access that, but this seems unnecessarily complicated.I realize I can just create the object in the MainWindow constructor, but that would mean having to put a lot of other code there as well, pretty much the entire Main function.How can I pass this object to my MainWindow? Or is the MainWindow constructor intended to function as the 'Main' for the entire program? <code> ",How do I edit the MainWindow constructor of a WPF application?
c# delete inside foreach with linq where," I can see why this is not allowed: but how about this? I don't understand why this fails. The ""Where()"" method obviously isn't returning the original collection, so I am not enumerating round the original collection when I try to remove something from it. <code>  foreach (Thing t in myCollection) { if (shouldDelete(t) { myCollection.Delete(t); }} foreach (Thing t in myCollection.Where(o=>shouldDelete(o)) { myCollection.Delete(t);}",Delete inside foreach with linq where
Dinamycally set Func<> types," is there any way to set Func<> type arguments dynamically, so i don't have to use endless if statements?Something like: Instead of: UPDATE:Here's a snippet from my code: pd.Polje is string - name of a property inside ""StavkaDokumenta"" class.pd.Expression is string expression that must evaluate to type of Polje.stavka is an instance of StavkaDokumenta. <code>  Type t = Type.GetType(""System.Decimal"");Func<t> foo = new Func<t>(some_function); Func<Decimal> foo = new Func<Decimal>(some_function); Type t = typeof(StavkaDokumenta).GetProperty(pd.Polje).PropertyType;ParameterExpression pe = Expression.Parameter(typeof(StavkaDokumenta), ""stavka"");Expression expr = Expressions.ResolveCompleteExpression(pe, pd.Expression);Expression final = Expression.Convert(expr, t);if (t == typeof(decimal)){ var lambda = Expression.Lambda<Func<StavkaDokumenta, decimal>>(final, pe); o = lambda.Compile().Invoke(stavka);}if (t == typeof(decimal?)){ var lambda = Expression.Lambda<Func<StavkaDokumenta, decimal?>>(final, pe); o = lambda.Compile().Invoke(stavka);}else if (t == typeof(int)){ var lambda = Expression.Lambda<Func<StavkaDokumenta, int>>(final, pe); o = lambda.Compile().Invoke(stavka);}else if (t == typeof(int?)){ var lambda = Expression.Lambda<Func<StavkaDokumenta, int?>>(final, pe); o = lambda.Compile().Invoke(stavka);}else if (t == typeof(string)){ var lambda = Expression.Lambda<Func<string>>(final, null); o = lambda.Compile().Invoke();}",Dynamically set Func<> types
why do I have to reference assemblies referenced by the assembly I reference? (sometimes)," I have an assembly A that defines an interface with some overloads: ...and an assembly B that references A (the binary, not the project) and calls one of the overloads: To be precise, it calls the System.Windows.Point overload of the InverseTransform method, because that is the type of the property Location in e. But when I build B in the IDE I get: error CS0012: The type 'System.Drawing.Point' is defined in an assembly that is not referenced. You must add a reference to assembly 'System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'.even though that's not even the overload I am calling. When I comment out the line where the overloaded method InverseTransform is called, it builds fine even though I'm still instantiating an object of type ITransform. Why? And is there a way to fix this without having to add a reference to System.Drawing everywhere? <code>  public interface ITransform{ Point InverseTransform(Point point); Rect InverseTransform(Rect value); System.Drawing.Point InverseTransform(System.Drawing.Point point);} var transform = (other.Source.TransformToDisplay != null && other.Source.TransformToDisplay.Valid) ? other.Source.TransformToDisplay : null;if (transform != null){ e.Location = transform.InverseTransform(e.Location);}",Why do I (sometimes) have to reference assemblies referenced by the assembly I reference?
C# Forms - Changing the sizemode of a background image in picturebox," My aim was to change the background image and set it's SizeMode as Stretch.Tried a lot so far, any ideas?EDIT: I am working in C# forms application. Tried simply setting size mode of bg picture: tried to move around it... no success... <code>  picturebox1.BackgroundImage = Properties.Resources.Image;picturebox1.SizeMode = PictureBoxSizeMode.StretchImage;",Changing the sizemode of a background image in picturebox
c# need a blocking FIFO queue similar with java's LinkedBlockingQueue," need something similiar with java's LinkedBlockingQueue.method of interest: messageQueue.poll(120000, TimeUnit.MILLISECONDS);meaning ..try to get item..and if in X unit of time you still have no item..return nullthat + i must be FIFOafter some googling (but havent yet tested): i found ConcurrentQueue (has FIFO behaviour), BlockingCollection (FiFO OR no FIFO??) <code> ",C#: need a blocking FIFO queue similar to Java's LinkedBlockingQueue
c# set focus on winform after start," I found a few topics about this but none of these could help me with my problem, i want to set the focus on a new created winform window after it started.I'm starting the form in a own new thread with: and the form appears, but the focus is still set on the last selected window from windows. this form has no titlebar and is not in the taskpanel to see, it also has a TransparencyKey set: now i tried a few methods but none of these got me focus on the form or could set the form on the foreground / of top of all other windows: is there a way to fire programmly a click / focus event to the form so that it sets himself with this event on focus ? <code>  application.Run(new InvisibleForm()); this.AutoScaleDimensions = new SizeF(6F, 13F);this.AutoScaleMode = AutoScaleMode.Font;this.BackColor = SystemColors.AppWorkspace;this.ClientSize = new Size(992, 992);this.ControlBox = false;this.MaximizeBox = false;this.MinimizeBox = false;this.Name = ""InvisibleForm"";this.Opacity = 0.5;this.ShowInTaskbar = false;this.TransparencyKey = SystemColors.AppWorkspace;this.Load += new EventHandler(this.InvisibleForm_Load); this.TopMost = true;this.Focus();this.BringToFront();this.Activate();",Set focus on winform after start
Press Enter Key in Selenium," How to press Enter using Selenium RC using C#?I am working with a SearchBox using Selenium. In which I have to type some name and I have to press Enter to search.There is no Submit button. So, I must use Enter.I tried something like this But doesn't work.Please Help. Note: I made a collection of possible ways to do this. See here: press enter key in selenium <code>  selenium.KeyPress(""quicksearchtextcriteria"", ""13"");",Press Enter Key in Selenium RC with C#
search a user login id by first name and last name," I found How can I get a list of users from active directory? It is helpful when I only have a few users, but I have so many users in AD, so when I run my query it took too long to finish.What can I do to search one particular user logon id by first name and last name?  <code>  if ((String)(entry.Properties[""sn""].Value) == ""lname"" && (String)(entry.Properties[""givenName""].Value) == ""fname""){ return entry.Properties[""samAccountName""].Value.ToString();}",Search a user login id by first name and last name
Ho can I take only entries from even positions in List, How I can select using Linq only entries from even positions in a list ? <code> ,How can I take only entries from even positions in List
Visual C# Event for Textbox Focus?," I want to add an even to the TextBox for when it has focus. I know I could do this with a simple textbox1.Focus and check the bool value... but I don't want to do it that way. Here is how I would like to do it: I'm not sure if EventHandler is the correct way to do this, but I do know that this does not work.  <code>  this.tGID.Focus += new System.EventHandler(this.tGID_Focus);",WinForms event for TextBox focus?
Winforms Event for Textbox Focus?," I want to add an even to the TextBox for when it has focus. I know I could do this with a simple textbox1.Focus and check the bool value... but I don't want to do it that way. Here is how I would like to do it: I'm not sure if EventHandler is the correct way to do this, but I do know that this does not work.  <code>  this.tGID.Focus += new System.EventHandler(this.tGID_Focus);",WinForms event for TextBox focus?
MSSQL insert row C#," Afternoon, So I have been at this one issue for hours and can't really get past this last hump. Below is the code for this program that I am writing: The Code compiles fine without error or warning but when i go to run it, as soon as it gets to cmd.InsertCommand.ExecuteNonQuery(); I get the following error: ExecuteNonQuery: Connection property has not been initialized. Any ideas on what I missed? <code>  using System; using System.Collections.Generic; using System.Linq; using System.Text; using System.Diagnostics; using System.Data; using System.Data.SqlClient; using System.Configuration; namespace Test { class Program { static void Main() { EventLog alog = new EventLog(); alog.Log = ""Application""; alog.MachineName = "".""; foreach (EventLogEntry entry in alog.Entries) { SqlConnection connection1 = new SqlConnection(@""Data Source=.\sqlexpress;Initial Catalog=syslog2;Integrated Security=True""); SqlDataAdapter cmd = new SqlDataAdapter(); cmd.InsertCommand = new SqlCommand(""INSERT INTO Application VALUES (@EventLog, @TimeGenerated, @EventType, @SourceName, @ComputerName, @InstanceId, @Message) ""); cmd.InsertCommand.Parameters.Add(""@EventLog"",SqlDbType.VarChar).Value = alog.Log; cmd.InsertCommand.Parameters.Add(""@TimeGenerated"", SqlDbType.DateTime).Value = entry.TimeGenerated; cmd.InsertCommand.Parameters.Add(""@EventType"", SqlDbType.VarChar).Value = entry.EntryType; cmd.InsertCommand.Parameters.Add(""@SourceName"", SqlDbType.VarChar).Value = entry.Source; cmd.InsertCommand.Parameters.Add(""@ComputerName"", SqlDbType.VarChar).Value = entry.MachineName; cmd.InsertCommand.Parameters.Add(""@InstanceId"", SqlDbType.VarChar).Value = entry.InstanceId; cmd.InsertCommand.Parameters.Add(""@Message"", SqlDbType.VarChar).Value = entry.Message; connection1.Open(); cmd.InsertCommand.ExecuteNonQuery(); connection1.Close(); } } } } ",ExecuteNonQuery: Connection property has not been initialized. 
serialize object of multiple classes in a single Json string using James.Newton-King," I want to join objects of several classes together into a single JSON response, using Json.NET. I want to build the following into a single JSON response: I am creating JSON responses in the following way: <code>  { ""data"": [ { ""from"": { ""name"": ""Pawan Shrestha"", ""id"": ""100001187416487"" }, ""created_time"": ""2012-04-22T10:21:22+0000"", ""unread"": true, ""to"": { ""name"": ""Shashwat Tripathi"", ""id"": ""100000559654730"" } } ], ""summary"": { ""unread_count"": 1, ""total_count"": 1, ""updated_time"": ""2012-04-22T10:21:22+0000"" } ""response_generated_on"" : ""2012-04-12 14:23:33""} Customer cs = new Customer(2011); //2011 is Customer A/c No.string j = JsonConvert.SerializeObject(cs);",Serialize object of multiple classes into a single JSON using Json.NET
"How to get child by type, in WPF container"," How can I get the child controls of type ComboBox in MyContainer Grid in WPF? This line gives me an error: <code>  <Grid x:Name=""MyContainer""> <Label Content=""Name"" Name=""label1"" /> <Label Content=""State"" Name=""label2"" /> <ComboBox Height=""23"" HorizontalAlignment=""Left"" Name=""comboBox1""/> <ComboBox Height=""23"" HorizontalAlignment=""Left"" Name=""comboBox3"" /> <ComboBox Height=""23"" HorizontalAlignment=""Left"" Name=""comboBox4"" /></Grid> var myCombobox = this.MyContainer.Children.GetType(ComboBox);",How to get children of a WPF container by type?
How merge two Task results in a third task?," How can I execute a System.Threading.Task as the continuation of two or more other Task results? This works, but the double ContinueWith seems inefficient. Is there a better way to do this, perhaps with a TaskCompletionSource? (I don't want to use locks or Task.WaitAll.) <code>  public Task<FinalResult> RunStepsAsync(){ Task<Step1Result> task1 = Task<Step1Result>.Factory.StartNew(Step1); // Use the result of step 1 in steps 2A and 2B Task<Step2AResult> task2A = task1.ContinueWith(t1 => Step2A(t1.Result)); Task<Step2BResult> task2B = task1.ContinueWith(t1 => Step2B(t1.Result)); // Now merge the results of steps 2A and 2B in step 3 Task<FinalResult> task3 = task2A .ContinueWith( t2A => task2B.ContinueWith( t2B => Step3(t2A.Result, t2B.Result))) .Unwrap(); return task3;}",How to merge two Task results in a third task?
Do I need this field to be volatile (.NET)?, I have a thread that spins until an int changed by another thread is a certain value. Does this.m_cur need to be declared volatile for this to work? Is it possible that this will spin forever due to compiler optimization? <code>  int cur = this.m_cur;while (cur > this.Max){ // spin until cur is <= max cur = this.m_cur; },Do I need this field to be volatile?
Disply Unocode characters in converting Html to Pdf," I am using itextsharp dll to convert HTML to PDF.The HTML has some Unicode characters like , ... when I try to convert HTML to PDF, Unicode characters are not shown in PDF.My function: <code>  Document doc = new Document(PageSize.LETTER);using (FileStream fs = new FileStream(Path.Combine(""Test.pdf""), FileMode.Create, FileAccess.Write, FileShare.Read)){ PdfWriter.GetInstance(doc, fs); doc.Open(); doc.NewPage(); string arialuniTff = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Fonts), ""ARIALUNI.TTF""); BaseFont bf = BaseFont.CreateFont(arialuniTff, BaseFont.IDENTITY_H, BaseFont.EMBEDDED); Font fontNormal = new Font(bf, 12, Font.NORMAL); List<IElement> list = HTMLWorker.ParseToList(new StringReader(stringBuilder.ToString()), new StyleSheet()); Paragraph p = new Paragraph {Font = fontNormal}; foreach (var element in list) { p.Add(element); doc.Add(p); } doc.Close();}",Display Unicode characters in converting Html to Pdf
error in Converting byte array to int array in c#," I am trying to convert a byte array to an int array ad then convert the byte array back to an int array.For converting from byte array to int array I used this code: But when converting from the byte array to in int array, the values in the iArray2 array becomes false when the value in the iArray array is larger than 256 (may be it is overflow, I do not know.) How can I convert from byte array to int array correctly? <code>  int[] iArray = new int[someSize];byte[] bArray = new byte[iArray.Length * sizeof(int)];Buffer.BlockCopy(iArray, 0,bArray, 0, bArray.Length); // This code works correctly. // What is the error in this code?.int iArray2 = new int[someSize];Buffer.BlockCopy(bArray, 0, iArray2, 0, iArray2.Length);",Error in converting byte array to int array in C#
Treview flickering?," I came to know that by adding TreeView.BeginUpdate will prevent flickering of treeview, but when i added it in to my project all nodes of my treeview disappears, Can any body tell me why it happens, here is the code snippet where i used TreeView.BeginUpdate and TreeView.EndUpdate <code>  TreeNode treeNode = new TreeNode(""Windows""); treeView1.Nodes.Add(treeNode); // // Another node following the first node. // treeNode = new TreeNode(""Linux""); treeView1.Nodes.Add(treeNode); // // Create two child nodes and put them in an array. // ... Add the third node, and specify these as its children. // TreeNode node2 = new TreeNode(""C#""); TreeNode node3 = new TreeNode(""VB.NET""); TreeNode[] array = new TreeNode[] { node2, node3 }; // // Final node. // treeNode = new TreeNode(""Dot Net Perls"", array); treeView1.Nodes.Add(treeNode);",Treeview flickering?
C#: OLE DB vs OPEN XML SDK vs Excel.interop," I need to read XLSX files and extract a maximum amount of content from it. Which of the API's should I use? OLE DB, open XML SDK, or Excel Interop?Which is the easiest to use?Can you retrieve all the information using one or the other? i.e, date, times, merged cells, tables, pivottables, etc. <code> ",OLE DB vs OPEN XML SDK vs Excel.interop
"SqlConnection error: SqlConnection conn = new SqlConnection(""DataSource=a;InitialCatalog=b;User ID=c;Password=d""); And I get error:"," My code: And I get error: What to do? <code>  SqlConnection conn = new SqlConnection(""DataSource=a;InitialCatalog=b;User ID=c;Password=d""); Keyword not supported: 'datasource'.","DataSource parameter in connection string yields ""Keyword not supported"""
How to connect to an access database using C#," I am currently in the process of making an application that runs 24/7 and constantly collects information from an OPC-sever. What I need to do now is to send this information to a database (.accdb-file). This need to happen very, very quickly. I fetch a new value from the server every millisecond and I need to send that value to the database at the same speed. Lastly I'm compressing the database to a .zip-file at 00:00 every day.I have been searching the web like a maniac but I can't seem to find an ""Up-to-date"" tutorial. Every one I have found so far uses ""Microsoft.Jet.OLEDB.4.0"" as provider but it doesn't exsist on my Windows 7 PC.I have made a small application to test connections with and I'll attach my current code bellow to give you a hint of what I have tried so far, none of this seems to work, though. This is the first approach I tried, here I use a homemade class that is used for creating and writing to files. It didn't work for .accdb-files, unfotunately. (The comments on the first lines include providers that I have tried. There has to be a simple solution to this, I can't be the only one using Access without the ""Microsoft.Jet.OLEDB.4.0"" provider. (I haven't started the code for zipping the file and if you have an idea on how to do that I'm happy to hear it, but the main focus here is the database issue.)UPDATE: The problem might not lie on the provider as I initially though, Microsoft.ACE.OLEDB.12.0 allows me to create a .accdb-file but it is just an empty txt-file with a fancy extension basically and it cannot be opened or used with MS Access. How do I make a working .accdb-file? <code>  private void button1_Click(object sender, EventArgs e){ System.Reflection.Assembly oAssembly = System.Reflection.Assembly.GetExecutingAssembly(); System.IO.Stream oStream = oAssembly.GetManifestResourceStream(""RSLogixDB.accdb""); System.IO.FileStream fileStream = new System.IO.FileStream(""C:\\Users\\sezettersth\\Documents\\RSLogixDB.accdb"", System.IO.FileMode.Create); byte[] abyt = new byte[oStream.Length]; oStream.Read(abyt, 0, (int)oStream.Length); fileStream.Write(abyt, 0, (int)oStream.Length); fileStream.Close(); if (fileStream != null) { fileStream.Close(); fileStream = null; } if (oStream != null) { oStream = null; }} private void button1_Click(object sender, EventArgs e){ //sFileDia.ShowDialog(); //Provider=Microsoft.ACE.OLEDB.12.0 //Povider=.NET Framework Data Provider for OLE DB //Povider=Microsoft.Jet.OLEDB.4.0 //Driver={Microsoft Access Driver (*.mdb, *.accdb)}; //Data Source=C:\\Users\\sezettersth\\Documents\\RSLogixDB.accdb; //Persist Security Info=False; //Provider=Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\Users\\sezettersth\\Documents\\RSLogixDB.accdb;Persist Security Info=False string RSLogixDB = ""Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\Users\\sezettersth\\Documents\\RSLogixDB.accdb;Persist Security Info=False""; string RSLogixDBPath = ""C:\\Users\\sezettersth\\Documents\\RSLogixDB.accdb""; OleDbConnection connection = new OleDbConnection(RSLogixDB); string connectionStr = connection.ConnectionString; //OleDbDataReader dataReader = new OleDbDataReader(RSLogixDB); ImportExport textwriter = new ImportExport(); textwriter.setExportPath(RSLogixDBPath); textwriter.endExport();}",How to create an Access database using C# and continuously save real-time data to it
c# - how to plug method parameters into custom attribute," I have a custom Attribute called AuthoriseAttribute whose constructor looks like this: This is used with a method called GetUserDetails() like this: At runtime, the presence of the Authorise attribute causes some authorisation code to execute which requires the ID of the user. Obviously, this can be extracted from the parameter of the GetUserDetails() method, but this means that the authorisation code depends on the method's parameter being given a particular name.I would like to be able to pass in the actual value of the userId parameter into the attribute, so that the authorisation code works with the value passed in to the attribute (i.e. not the method parameter), whose name is known.Something like this (which doesn't work): Is such a thing possible? <code>  public AuthoriseAttribute(int userId){ .. blah} [Authorise(????????)]public UserDetailsDto GetUserDetails(int userId){ .. blah} [Authorise(userId)]public UserDetailsDto GetUserDetails(int userId){ .. blah}",How to plug method parameters into custom attribute
c# check is dictionary contains value," I have dictionary which holds my books: Book definiton: I have added some books to the dictionary. How can I check if there is a book in the Dictionary that matches the title provided by the user? <code>  Dictionary<string, book> books class book{ string author { get; set; } string title { get; set; }} ",check if value already exists
C# - Prevent multiple instance of a service - best approach?," So what do you think is the best way to prevent multiple threads of a C# Windows service running simultaneously (the service is using a timer with the OnElapsed event) ?Using lock() or mutex ?I can't seem to grasp the concept of the mutex, but using lock() seems to work fine for my case.Should I spend the time learning how to use the mutex anyways? <code> ",Prevent multiple instance of a service - best approach?
Event called after windows maximized c#," I'm looking for an event from a form that called after a window is maximized or minimized.As far as I know there is such event as SizeChanged or WndProc that can handle maximized window, but it's called right away after user try to maximize the window, and it's not called after the window is fully maximized.I'm looking for event like ResizeEnd, but maybe this one is called MaximizedEnd or MinimizedEndIs there anyway to do that? <code> ",Event called after windows maximized
ListBox autosizes by item height," I use TableLayoutPanel for all my elements in a form. I use Dock Fill to autosize a TextBox and a ListBox. TextBox fits perfectly in a cell of the TableLayoutPanel but not a ListBox. It autosizes by item height.How to delete this gap between the bottom of the ListBox and the bottom of the form? I know I can set the height of the ListBox by a certain value (e.g. item height in the ListBox is 16, 16 * 10 elements= 160, 160 will fit correctly), but is there any other solutions?I'm using C#. <code> ",ListBox AutoSizes by item height
C# - Regex 'Ignore Case' option doesn't work when the 'Compiled' option is specified," I have the following very simple regex, which matches HTML tags in a string. I have the case insensitive option set, so that capitalisation of the tags doesn't matter. However, when the 'compiled' option is set, then the 'IgnoreCase' option seems to be ignored.Sample code: Has anybody got an idea what is going on here? <code>  string text = ""<SPAN>blah</SPAN><span>blah</span>"";Regex expr1 = new Regex(""</*span>"", RegexOptions.IgnoreCase);Regex expr2 = new Regex(""</*span>"", RegexOptions.IgnoreCase & RegexOptions.Compiled);MatchCollection result1 = expr1 .Matches(text); //gives 4 matches- <SPAN>,</SPAN>,<span> & </span>MatchCollection result2 = expr2 .Matches(text);//only gives 2 matches- <span> & </span>",Regex 'Ignore Case' option doesn't work when the 'Compiled' option is specified
.NET console app not parsing correctly args with white spaces in WS 2008," I've created a .NET console application that gets some command line arguments.When I pass args with white spaces, I use quotes to embrace these arguments so that they are not splitted by cmd: If I execute the app in Windows XP it works fine: it gets 3 arguments:argument1argument 2the third argumentHowever, if i execute it in Windows Server 2008 it seems to ignore quotes: it gets 6 arguments:argument1""argument2""""thethirdargument""Any ideas why?NOTE: I printed arguments just when Main starts execution using this code: <code>  C:\MyAppDir> MyApp argument1 ""argument 2"" ""the third argument"" Console.WriteLine(""Command line arguments:"");foreach (string arg in args){ Console.WriteLine(""# "" + arg);}",Console app not parsing correctly args with white spaces
Console app not parsing correctly args with white spaces," I've created a .NET console application that gets some command line arguments.When I pass args with white spaces, I use quotes to embrace these arguments so that they are not splitted by cmd: If I execute the app in Windows XP it works fine: it gets 3 arguments:argument1argument 2the third argumentHowever, if i execute it in Windows Server 2008 it seems to ignore quotes: it gets 6 arguments:argument1""argument2""""thethirdargument""Any ideas why?NOTE: I printed arguments just when Main starts execution using this code: <code>  C:\MyAppDir> MyApp argument1 ""argument 2"" ""the third argument"" Console.WriteLine(""Command line arguments:"");foreach (string arg in args){ Console.WriteLine(""# "" + arg);}",Console app not parsing correctly args with white spaces
"The property KeyValuePair<TKey, Tvalue>>.Value has no setter"," I'm using a Dictionary<int, KeyValuePair<bool, int>> to hold data. From time to time I need to increment the int in the KeyValuePair, but it won't let me, because it has no setter. Is there a way to increment it? Code sample:  <code>  Dictionary<int, KeyValuePair<bool, int>> mDictionary = new Dictionary<int, KeyValuePair<bool, int>>();mDictionary[trapType].Value++;//Error: The property KeyValuePair<TKey, Tvalue>>.Value has no setter","The property KeyValuePair<TKey, Tvalue>.Value has no setter"
C# - Own WinForms Control Flickers and Has Bad Performance," I have two problems with an own user control which uses bitmaps:It flickers if it's redrawn via .NET's 'Refresh' method.It has a bad performance.The control consists of three bitmaps:A static background image.A rotating rotor.Another image depending on rotor angle.All used bitmaps have a resolution of 500x500 pixels. The control works like this:https://www.dropbox.com/s/t92gucestwdkx8z/StatorAndRotor.gif (it's a gif animation)The user control should draw itself everytime it gets a new rotor angle. Therefore, it has a public property 'RotorAngle' which looks like this: Refresh raises the Paint event. The OnPaint event handler looks like this: But when I use this code - which works well in other own user controls - the user control is not drawn at all if control is double buffered via SetStyle(ControlStyles.OptimizedDoubleBuffer, true). If I don't set this flag to true, the control flickers when being redrawn.In control constructor I set: First, I thought it flickers because the background is cleared everytime the control is drawn. Therefore, I set SetStyle(ControlStyles.AllPaintingInWmPaint, true). But it didn't help.So, why does it flicker? Other controls work very well with this setup. And why is the controly not drawn if SetStyle(ControlStyles.OptimizedDoubleBuffer, true).I found out that the control does not flicker if I invoke my Draw method directly after changing the property RotorAngle: But this results in a very bad performance, especially in full screen mode. It's not possible to update the control every 20 milliseconds. You can try it yourself. I will attach the complete Visual Studio 2008 solution below.So, why it is such a bad performance? It's no problem to update other (own) controls every 20 milliseconds. Is it really just due to the bitmaps?I created a simple visual Visual Studio 2008 solution to demonstrate the two problems:https://www.dropbox.com/s/mckmgysjxm0o9e0/WinFormsControlsTest.zip (289,3 KB)There is an executable in directory bin\Debug.Thanks for your help. <code>  public double RotorAngle{ get { return mRotorAngle; } set { mRotorAngle = value; Refresh(); }} private void StatorAndRotor2_Paint(object sender, PaintEventArgs e){ // Draw the three bitmaps using a rotation matrix to rotate the rotor bitmap. Draw((float)mRotorAngle);} SetStyle(ControlStyles.AllPaintingInWmPaint, true);SetStyle(ControlStyles.ContainerControl, false);// User control is not drawn if ""OptimizedDoubleBuffer"" is true.// SetStyle(ControlStyles.OptimizedDoubleBuffer, true);SetStyle(ControlStyles.ResizeRedraw, true);SetStyle(ControlStyles.SupportsTransparentBackColor, true); public float RotorAngle{ get { return mRotorAngle; } set { mRotorAngle = value; Draw(mRotorAngle); }}",Own WinForms Control Flickers and Has Bad Performance
Illegal characters in path when loading a string into XDocument using LINQ to XML," I have very simple XML in a string that I'm trying to load via XDocument so that I can use LINQ to XML: I get an Illegal characters in path. error thrown when I try to load the XML; could someone please explain why this is happening? Thanks. <code>  var xmlString = @""<?xml version=""""1.0"""" encoding=""""utf-8"""" standalone=""""yes""""?> <person>Test Person</person>""; var doc = XDocument.Load(xmlString); //'Illegal characters in path' error thrown here",Illegal characters in path when loading a string with XDocument
Using Moq to verify stream written to in the correct order," I need to test the following method: I've created a Moq'd IWriter and I want to ensure that the Write() methods are called in the right order.I have the following test code: However, the second call to Write() in CreateOutput() (to write the id value) throws a MockException with the message ""IWriter.Write() invocation failed with mock behavior Strict. All invocations on the mock must have a corresponding setup."".I'm also finding it hard to find any definitive, up-to-date documentation/examples of Moq sequences.Am I doing something wrong, or can I not set up a sequence using the same method?If not, is there an alternative I can use (preferably using Moq/NUnit)? <code>  CreateOutput(IWriter writer){ writer.Write(type); writer.Write(id); writer.Write(sender); // many more Write()s...} var mockWriter = new Mock<IWriter>(MockBehavior.Strict);var sequence = new MockSequence();mockWriter.InSequence(sequence).Setup(x => x.Write(expectedType));mockWriter.InSequence(sequence).Setup(x => x.Write(expectedId));mockWriter.InSequence(sequence).Setup(x => x.Write(expectedSender));",Using Moq to verify calls are made in the correct order
Accessing Constants Sealed Class That References App Settings Config File," I have a class called LocalConstants.... When trying to access this class in my main program I am getting a null reference exception. Anything from ConfigurationManager.AppSettings[ is always null. But if I write this compiles fine but is always null and throws a NullRefexception The exception isThe type initializer for 'TestCodeOutOnSide.LocalConstants' threw an exception.The innerException is the basicObject reference not set to an instance of an object.Even if I change the PROJECT_PATH to I get the same exceptionAny ideas? <code>  public static class LocalConstants { public static string DM_PATH = ConfigurationManager.AppSettings[""DMQueue""]; public static string PROJECT_PATH = ConfigurationManager.AppSettings[""MSQueue""]; } //The value is returned fine string bo=ConfigurationManager.AppSettings[""MSQueue""]; string moomoo = LocalConstants.PROJECT_PATH; public static readonly string PROJECT_PATH = @""FORMATNAME:DIRECT=OS:serus-nickl\RMQDEV"";",Accessing Constants Static Class That References App Settings Config File
Convert picturebox image into bitmap in c#.net, I have used the following code to convert the image in a PictureBox into a Bitmap: But I am getting the result as bmp = null. Can anyone tell me how I do this? <code>  bmp = (Bitmap)pictureBox2.Image;,Convert the image in a PictureBox into a bitmap
what is the difference between string and StringBuilder?," I know that string is immutable and StringBuilder is mutable. But can anybody explain following code output? Since both are reference types, why do they have different results? <code>  String s1 = ""hello"";String s2 = ""hello"";Console.WriteLine(s1 == s2); //trueConsole.WriteLine(Object.ReferenceEquals(s1, s2)); //trueStringBuilder sb1 = new StringBuilder(""hello"");StringBuilder sb2 = new StringBuilder(""hello"");Console.WriteLine(sb1 == sb2); //falseConsole.WriteLine(Object.ReferenceEquals(sb1, sb2)); //false",What is the difference between string and StringBuilder?
C# Recursion Limit when returning JSON," I ran into an annoying issue recently. I'm going to simplify my datamodel here, but the principle is just the same. I have a class ""User"". In that class I have a property that is a list of objects the user owns. I also have this class ""object"". Because every ""object"" has an owner, it has a property of type ""User"", which links to its owner. Now, what I'm trying to do is basically this When I load the page, it takes like 30 seconds and then I get the error ""RecursionLimit exceeded"".I guess this is because the objects are linking to each other. Now my question is, how can I tell ""Json"" that it shouldn't go deeper then 1 level of objects to avoid this? <code>  return Json(myUser,JsonRequestBehavior.AllowGet);",C# recursion limit when returning JSON
What is the location of Public key and Private Key container in Windows?," I am trying to store my public and private keys in a container using following code: What I'd like to know is the location of the container. Is the location of the container in the file system? <code>  CspParameters cp = new CspParameters();cp.KeyContainerName = ""Test"";RSACryptoServiceProvider rsa = new RSACryptoServiceProvider(cp);",Location of container for public and private keys in Windows?
Windows 8 Metro App to enumerate files," I am working on a Metro app that shows the content of a given folder in a ListView control.MS decided that developers don't need the System.IO.Directory class and removed it entirely from the framework. I am looking for a replacement to enumerate files in C# in a metro style app. I have checked all the enumeration samples provided by MS and they all seem to only enumerate the Windows Libraries using the KnownFolders class, something like: and calling the GetFilesAsync() or GetFoldersAsync() methods depending on your needs. These are all gold if I wanted to enumerate only inside the pictures or music library. However I am looking to enumerate files on directories that are not included in a library.Anyone knows how this is possible in WinRT??? <code>  StorageFolder picturesFolder = KnownFolders.PicturesLibrary;",WinRT: App to enumerate files outside libraries and known folders
How can i lock by cache key?," I am trying to implement a generic thread-safe Cache method, and I wonder how I should implement the lock in it.It should look something like this: <code>  //private static readonly lockObject = new Object();public T GetCache<T>(string key, Func<T> valueFactory...){ // try to pull from cache here lock (lockObject) // I don't want to use static object lock here because then every time a lock is performed, all cached objects in my site have to wait, regarding of the cache key. { // cache was empty before we got the lock, check again inside the lock // cache is still empty, so retreive the value here // store the value in the cache here } // return the cached value here}",How can I lock by cache key?
"Mystical behavior of Dictionary<TKey, TSource>"," I'm working on a huge system based on Asp.net MVC 3.0 and working on Mono-2.10.8 (Windows 7).Everything was fine until a moment couple of days ago.Inside my API I have several utility classes using dictionaries. For example, like this one: And randomly I get exceptions like this: Most of the time everything is fine and KeyUtility works correct, but on rare occasions I get such an exception.Despite it looks like thread safety issue, the dictionary ReverseAlphabet is always accessed for reading only and never for writing. Once it's created in static constructor it's only accessed with TryGetValue. As I understand from MSDN article it should be thread safe in this case.Moreover, I haven't seen this problem before.What should I look at? I even can't create a reproduction as I have completely no idea what is wrong.Mono-2.10.8 and older versions proved to be stable with dictionaries. I've been using it for a couple of years intensively and have never seen this sort of exception before.How to fix this?UPD:I've remembered that near the time of the begining of troubles what i've done is statically linked mono with my executable (i'm embedding mono into my application). I simply downloaded sources of mono. Compilled it without any changes except i set up libmono's output to static library. I've also linked with libeay32 and sqlite3. All multithread (MT). Maybe this change could affect an application? Unfortunately i can't check this under standalone mono. Before this i was linking all libraries dynamically and everything was fine.UPD2:Here is the link to the complete sources: http://pastebin.com/RU4RNCki <code>  public static class KeyUtility { static KeyUtility() { Alphabet = new[] { 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'J', 'K', 'L', 'M', 'N', 'P', 'R', 'S', 'T', 'U', 'V', 'X', 'Y', 'Z', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9' }; ReverseAlphabet = Alphabet .Select((c, i) => new { Char = c, Value = i }) .ToDictionary(k => k.Char, v => (byte) v.Value); } internal static char[] Alphabet; private static IDictionary<char, byte> ReverseAlphabet; public static string ToKey(byte[] key, int groupSize) { //Accessing Alphabet to generate string key from bytes } public static byte[] FromKey(string key) { //Accessing ReverseAlphabet to get bytes from string key }} System.IndexOutOfRangeException: Array index is out of range.at System.Collections.Generic.Dictionary`2<char, byte>.TryGetValue (char,byte&) <0x000a1>at MyAPI.KeyUtility.FromKey (string) <0x0009a>at MyApp.Controllers.AboutController.Index () <0x002df>at (wrapper dynamic-method) object.lambda_method (System.Runtime.CompilerServices.Closure,System.Web.Mvc.ControllerBase,object[]) <0x0002f>at System.Web.Mvc.ActionMethodDispatcher.Execute (System.Web.Mvc.ControllerBase,object[]) <0x0001b>at System.Web.Mvc.ReflectedActionDescriptor.Execute (System.Web.Mvc.ControllerContext,System.Collections.Generic.IDictionary`2<string, object>) <0x000ff>at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod (System.Web.Mvc.ControllerContext,System.Web.Mvc.ActionDescriptor,System.Collections.Generic.IDictionary`2<string, object>) <0x00019>at System.Web.Mvc.ControllerActionInvoker/<>c__DisplayClass15.<InvokeActionMethodWithFilters>b__12 () <0x00066>at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter (System.Web.Mvc.IActionFilter,System.Web.Mvc.ActionExecutingContext,System.Func`1<System.Web.Mvc.ActionExecutedContext>) <0x000b8>","Mysterious behavior of Dictionary<TKey, TSource>"
What is the Most Efficient way to compare large List of integers to List integers?," At the moment I have a list of 1million integers, and I check each integer against a blacklist of 2000 integers. This is taking about 2 minutes. This makes 2,000,000,000 iterations(loops) altogether. Is there a better way Im not seeing? thanks <code>  for(int i = 0; i< MillionIntegerList.Length ; i++){ for(int blacklisted = 0; blacklisted < TwoThousandIntegerList.Length ; blacklisted++) if(i==blacklisted) i = 0; //Zero is a sentinel value }",What is the Most Efficient way to compare large List of integers to smaller List of integers?
MVC Razor custom MapRoute," I am attempting to create some custom map routes but can't get it working quite right.My ultimate aim is to be able to specify something like the following. Where by I essentially have my URL constructed with value pairs of ""id"" and ""name"". The name is irrelevant and solely for user pleasantries, I will require the ID in my controller though. /dashboards/5-My-Estate-name/89-My-subgroup-name/133-Maybe-even-another-subgroupFor starters I'm working on the first section and having troubles.Browsing to ""http://localhost:53933/dashboards/109-building-xyz"" whilst using the following route generates the error A public action method '109-building-xyz' was not found on controller 'MyInterfaceInterface.Controllers.DashboardsController'. Obviously I wanted this to be routed to the Index function with parameters.What am I doing wrong? Am I even structuring this correctly? I come from a web-PHP background and using htaccess to achieve such things.Thanks <code>  routes.MapRoute( ""Dashboard"", ""dashboards/{id}-{name}"", // URL pattern new { controller = ""Dashboards"", action = ""Index"" }, new { id = @""\d+"", name = UrlParameter.Optional });",Custom MapRoute
Updating a progress bar in a C# GUI from another thread," Possible Duplicate: Updating a Progress Bar from Another Thread In my program, I wanted to separate non-GUI functions to another class, and leave things related to the GUI in the main class. However, I am having issues with updating a progress bar while one of the worker methods in the worker class is doing its job. I know that I will have to work with multithreading here, but I do not understand how. I may just be missing simple things, but when I look for information about it, it seems that most tutorials talk about the minutia, but do not explain the big picture very well. I partially understand what invoke and delegate commands are, but I don't really understand how they interact.Below is stripped down version of what I want to do. How do I modify this to update the progress bar, but keep the window responsive and repainting?Main form class: Separate worker class: class time_waster { public time_waster() { } <code>  public partial class Form1 : Form{ time_waster thing = new time_waster(); public Form1() { InitializeComponent(); progressBar1.Minimum = 0; progressBar1.Maximum = 100; } private void button1_Click(object sender, EventArgs e) { thing.something_that_takes_a_while(); }} public void something_that_takes_a_while() { int delay = 200; for (int i = 0; i < 100; i++) { Thread.Sleep(delay); //appropriate code to update the progress bar for each iteration of the for loop. } }}",Updating a progress bar in a C# GUI from another thread and class
It's able to use Activator.CreateInstance with Interface?," I have an example: There I'm creating an instance of a class, but how can I create an instance of a class which implements some interface? i.e. UserControl1 implements ILoad interface.U: I can cast object to interface later, but I don't know which type in the assemblies implements the interface. <code>  Assembly asm = Assembly.Load(""ClassLibrary1""); Type ob = asm.GetType(""ClassLibrary1.UserControl1""); UserControl uc = (UserControl)Activator.CreateInstance(ob); grd.Children.Add(uc);",Can I use Activator.CreateInstance with an Interface?
DateTime.Now.ToBinary() returns wrong value," This is what I've tried: This is the output: The timeA and timeB should essentially be the same thing, but they are converted to a totally different (negative) binary.Why does this happen? Why does directly calling ToBinary() on DateTime.Now produce different results?EDIT: Since my issue was misunderstood (and thus downvoted) I have corrected my post to better represent the real question. The problem was in DateTime.Kind and that was the real issue, not the small difference in two consecutive DateTime.Now calls. <code>  DateTime now = DateTime.Now;long timeA = now.ToBinary();long timeB = new DateTime(now.Year, now.Month, now.Day, now.Hour, now.Minute, now.Second, now.Millisecond).ToBinary();Debug.WriteLine(""{0} {1}"", timeA, timeB); -8588637543837682554 634734565017110000",Why does DateTime.Now.ToBinary() returns different value than when created by constructor
Can I Set aspnet:MaxHttpCollectionKeys Programmatically," In a bit of admin functionality for a particular site, I'm doing a particularly horrific post that necessitates a large amount of data to be posted. In order to make that happen, I had to add the Web.config appSetting: However, I only want this large post to be possible under a particular set of circumstances. Is there any way to programmatically set this value? <code>  <add key=""aspnet:MaxHttpCollectionKeys"" value=""2000"" />",Set aspnet:MaxHttpCollectionKeys Programmatically
How to get good coverage of floating-point logic with Pex," I am hand-crafting new code. I'd like to make sure I leave no stone unturned.Is there anything specific I can do beyond specifying Code Contracts to guide Pex so it produces good coverage in numerically-intensive code?Try searching http://research.microsoft.com/en-us/projects/pex/pexconcepts.pdf for keyword 'float' for some background information. Arithmetic constraints over floating point numbers are approximated by a translation to rational numbers, and heuristic search techniques are used outside of Z3 to find approximate solutions for floating point constraints....and also... Symbolic Reasoning. Pex uses an automatic constraint solver to determine which values are relevant for the test and the code-under-test. However, the abilities of the constraint solver are, and always will be, limited. In particular, Z3 cannot reason precisely about floating point arithmetic.Alternatively, do you know a tool under .NET that is better suited for the task of finding numerical anomalies under .NET? I am aware of http://fscheck.codeplex.com/ but it does not perform symbolic reasoning. <code> ",How to generate good code coverage of floating-point logic?
[c# GDI+]Bitmap.Lockbits confusion," MSDN reference: [1] http://msdn.microsoft.com/en-us/library/5ey6h79d.aspx#Y1178From the link it says that the first argument will ""specifies the portion of the Bitmap to lock"" which I set to be a smaller part of the Bitmap (Bitmap is 500x500, my rectangle is (0,0,50,50)) however the returned BitmapData has stride of 1500 (=500*3) so basically every scan will still scan through the whole picture horizontally. However, what I want is only the top left 50x50 part of the bitmap.How does this work out? <code> ",Bitmap.Lockbits confusion
Convertion in .net: Native Utf-8 <-> Managed String," I created those two methods to convert Native utf-8 strings (char*) into managed string and vice versa. The following code does the job: While NativeUtf8FromString is ok, StringFromNativeUtf8 is a mess but the only safe code I could get to run. Using unsafe code I could use an byte* but I do not want unsafe code. Is there another way someone can think of where I do not have to copy the string for every contained byte to find the 0 termination.I just add the unsave code here: As you see its not ugly just needs unsafe. <code>  public IntPtr NativeUtf8FromString(string managedString){ byte[] buffer = Encoding.UTF8.GetBytes(managedString); // not null terminated Array.Resize(ref buffer, buffer.Length + 1); buffer[buffer.Length - 1] = 0; // terminating 0 IntPtr nativeUtf8 = Marshal.AllocHGlobal(buffer.Length); Marshal.Copy(buffer, 0, nativeUtf8, buffer.Length); return nativeUtf8;}string StringFromNativeUtf8(IntPtr nativeUtf8){ int size = 0; byte[] buffer = {}; do { ++size; Array.Resize(ref buffer, size); Marshal.Copy(nativeUtf8, buffer, 0, size); } while (buffer[size - 1] != 0); // till 0 termination found if (1 == size) { return """"; // empty string } Array.Resize(ref buffer, size - 1); // remove terminating 0 return Encoding.UTF8.GetString(buffer);} public unsafe string StringFromNativeUtf8(IntPtr nativeUtf8){ byte* bytes = (byte*)nativeUtf8.ToPointer(); int size = 0; while (bytes[size] != 0) { ++size; } byte[] buffer = new byte[size]; Marshal.Copy((IntPtr)nativeUtf8, buffer, 0, size); return Encoding.UTF8.GetString(buffer);}",Conversion in .net: Native Utf-8 <-> Managed String
C#: how to modify previous line of console text?," I'd like to achieve something like this: I displayed 3 line of text, each one related with a thread which can end sooner or later. But if the second one complete later than the third one, I'll get something like this: Which is of course unacceptable. I know how to go back in current line, but is there a way to go UP? I'd swear I've seen it somewhere, though it could be a Linux console :)Forget it. See Far File Manager! It works in Windows console, it works even in PowerShell! How to make something like this? And the coolest part is it restores console state after exiting. So maybe I should ask - how to access console buffer directly? I assume I'll need some native code to do the trick, but maybe there's another way? I thought of clearing console with each update, but this seems like overkill. Or maybe it isn't? Will it blink? <code>  Time consuming operation...OKAnother time consuming operation...And another one, but it completed, so...OK Time consuming operation...OKAnother time consuming operation...And another one, but it completed, so...OKOK",How to modify the previous line of console text?
Why is this valid C# code?," This is valid C# code This is not valid C# code Why is the first statement valid? <code>  var bob = ""abc"" + null + null + null + ""123""; // abc123 var wtf = null.ToString(); // compiler error","Why is it Valid to Concatenate Null Strings but not to Call ""null.ToString()""?"
ASP.NET MVC3 ActionDescriptor from ControllerContext," Given I have access only to ControllerContext and not Action____Contexts what is the optimal way to get the current executing ActionDescriptor?So far the only method I've found is: Is this the optimal method? The fact that class is named ReflectedControllerDescriptor leads me to wonder if there is a heavy cost to this operation as it will be executed on every page request? Related to that is does this class internally cache or should I actually be caching ReflectedControllerDescriptors explicitly? <code>  new ReflectedControllerDescriptor(context.Controller.GetType()) .FindAction(context, context.RouteData.GetRequiredString(""action""));",ActionDescriptor from ControllerContext
mvc4 rc webapi binding with ninject," I have just installed the mvc4 rc update and I am trying to build an api application with little luck.I am using ninject but cant get my controllers to load. I keep getting an error Type 'Api.Controllers.ConsumerController' does not have a default constructorI am very new to mvc and using injection so please bear with me.I havent done anything special to the default binding that is created via nuget My controller looks like What do I need to do to get the api controllers to work with ninject?Sorry if this is simple stuffI tried your suggestion Michael however after changing the the webcommon.cs to this I get an error when is called Method 'GetFilters' in type 'Ninject.Web.WebApi.Filter.DefaultFilterProvider' from assembly 'Ninject.Web.WebApi, Version=3.0.0.0, Culture=neutral, PublicKeyToken=c7192dc5380945e7' does not have an implementation.What am I missing? <code>  public static class NinjectWebCommon { private static readonly Bootstrapper bootstrapper = new Bootstrapper(); /// <summary> /// Starts the application /// </summary> public static void Start() { DynamicModuleUtility.RegisterModule(typeof(OnePerRequestHttpModule)); DynamicModuleUtility.RegisterModule(typeof(NinjectHttpModule)); bootstrapper.Initialize(CreateKernel); } /// <summary> /// Stops the application. /// </summary> public static void Stop() { bootstrapper.ShutDown(); } /// <summary> /// Creates the kernel that will manage your application. /// </summary> /// <returns>The created kernel.</returns> private static IKernel CreateKernel() { var kernel = new StandardKernel(); kernel.Bind<Func<IKernel>>().ToMethod(ctx => () => new Bootstrapper().Kernel); kernel.Bind<IHttpModule>().To<HttpApplicationInitializationHttpModule>(); RegisterServices(kernel); return kernel; } /// <summary> /// Load your modules or register your services here! /// </summary> /// <param name=""kernel"">The kernel.</param> private static void RegisterServices(IKernel kernel) { kernel.Bind<IConsumerRepository>().To<ConsumerRepository>(); } } private readonly IConsumerRepository _repository; public ConsumerController(IConsumerRepository repository) { _repository = repository; } [HttpGet] public IQueryable<Consumer> Get(Guid id) { return _repository.Get(id).AsQueryable(); } private static IKernel CreateKernel() { var kernel = new StandardKernel(); kernel.Bind<Func<IKernel>>().ToMethod(ctx => () => new Bootstrapper().Kernel); kernel.Bind<IHttpModule>().To<HttpApplicationInitializationHttpModule>(); RegisterServices(kernel); GlobalConfiguration.Configuration.DependencyResolver = new NinjectDependencyResolver(kernel); return kernel; } /// <summary> /// Load your modules or register your services here! /// </summary> /// <param name=""kernel"">The kernel.</param> private static void RegisterServices(IKernel kernel) { kernel.Bind<IConsumerRepository>().To<ConsumerRepository>(); } var kernel = new StandardKernel();",ASP.NET Web API binding with ninject
.NET C # Enterprise Library - Setting parameter to DBNull.Value using ternary syntax gives error?," I have the following bit of code to set a parameter that will be used in an INSERT statement to set a VARCHAR column in a SQL Server database. My value object (named ilo) has a property called Description that gets initialized to String.Empty, and then either gets set to some value read from XML, or if that XML element is empty it just stays as String.Empty.So when inserting into the database, if the property is still set to String.Empty, I'd like to have it insert a null value. So basically I'm saying, if ilo.Description equals string.empty, set the parameter to DBNull.Value, otherwise set it to ilo.Description.This gives the following error in Visual Studio...Error 141 Type of conditional expression cannot be determined because there is no implicit conversion between 'System.DBNull' and 'string'Why?The curious part is that I can do the following with no error, which should be exactly the same thing as using inline conditional syntax like above!?! I searched other posts, and found the one below, but it doesn't really answer my question.EntLib Way to Bind ""Null"" Value to ParameterI'm more interested in WHY, because the obvious workaround is to just use an if/else statement instead of the inline (ternary) syntax?There's sort of an answer at this link, but I'd like a better explanation because it seems to be BS to me that this doesn't work; I'd call it a bug!http://msdn.microsoft.com/en-us/library/ty67wk28.aspxEDIT: 3/30/2021, it's been 9 years since I wrote this question. Finally as of C# 9, this issue is fixed. Ternary expressions now support mixed types so long as they can be implicitly converted. <code>  database.AddInParameter(cmd, ""@description"", DbType.String, (ilo.Description.Equals(string.Empty)) ? DBNull.Value : ilo.Description); if(ilo.Description.Equals(string.Empty)){ database.AddInParameter(cmd, ""@description"", DbType.String, DBNull.Value);}else{ database.AddInParameter(cmd, ""@description"", DbType.String, ilo.Description);}",Setting parameter to DBNull.Value using ternary syntax gives error?
Insert a new field into an existing collection (many documents) in MOngo using C# driver, How can I insert a new field into a MongoDB collection using the C# Update API?What I am trying to do: I have a HomePhoneId field that I need to insert into every document in my People collection. Any ideas? <code> ,Insert a new field into an existing collection (many documents) in MongoDB using C# driver
protobuf-net support for serializing dictionary of object values?," i'm new to protocol buffers and I am using protobuf-net for VS2010. from what i'm reading here Dictionary in protocol buffers, it doesn't seem that protobuf can serialize a dictionary with object types as values. but here on his site i read this: Notes on types supported: custom classes that: are marked as data-contract have a parameterless constructor for Silverlight: are public many common primitives etc single dimension arrays: T[] List / IList Dictionary / IDictionary any type which implements IEnumerable and has an Add(T) method The code assumes that types will be mutable around the elected members. Accordingly, custom structs are not supported, since they should be immutable.which seems like it is supported.I can successfully compile a List of objects like so: This works fine for a List<SomeClass>. Why cannot I serialize using protobuf-net a Dictionary<int, SomeClass>? What would the message look like to serialize a Dictionary<int, SomeClass>? <code>  message ValuesObject { optional int32 SomeVal = 1; repeated SomeClass ListOfSomeClassTypes = 2;}",C# .net protocol buffers - protobuf-net support for serializing dictionary of object values?
What mean the 'At' sign in cshtml?, Could you explain me what is meant by '@' sign before each variable in cshtml? <code> ,What is the meaning of '@' sign in cshtml?
"Json and Xml serialization, what is better perfomance?"," I have to store some config info in file. In C# code config data represents by class and in file I am going to save this class in json or xml format. So, what is the best performance of serialization json or xml? <code> ","Json and Xml serialization, what is better performance?"
EF: Multiple tables with same POCO class," I have an existing database where I have four identical and unrelated tables.I want to use the same POCO class to describe all four without having to create duplicates of the same class.This is what my context looks like so far: My problem is that the existing tables are named ""map_ratings_vsh"" and ""map_ratings_jump"", and I cannot use the data annotations TableAttribute because it can only be used on the class.Is there some other way--maybe the fluent api--to describe my schema? <code>  class StatsContext : DbContext{ // [MagicTableAttribute( ""map_ratings_vsh"" )] -- does something like this exist? public DbSet<MapRatings> MapRatingsVSH { get; set; } public DbSet<MapRatings> MapRatingsJump { get; set; } // 2 more tables using same class}class MapRatings{ public string SteamID { get; set; } public string Map { get; set; } public int Rating { get; set; } [Column( ""rated"" )] public DateTime Time { get; set; }}",Multiple tables with same POCO class
Jobs in Azure Web Role," It is possible to run a thread from the WebRole.cs OnStart() method in such a way that we are able to access it through aspx page to perform background work?I know that the correct way to do it would be to use a Worker Role but i wish to maintain the running costs as low as possible.The idea would be to create a thread that would be always running and waiting for a job, for instance if i want to make a blocking operation like sending an email i would use the thread giving the SendEmail method, is it possible to do? If so, can you provide me some examples that could point me in the right direction? <code> ",Background thread in Azure Web Role
How can someone handle default datetime in .Net," I have DAL where I convert database null value to their equivalent representation in C#. For example: The problem, for date, lies in the presentation layer, especially in GridViews. You cannot show 1/1/01 to users. What I used to do is check if myDate.Year=1 or myDate.Year < AcceptedDate and display empty string, but seems to be extra effort unlike other typesPlease am open to better approach. Thanks. <code>  NULL for Numeric = 0NULL for String = String.EmptyNULL for DateTime = ""1/1/0001"" (i.e. DateTime.MinValue)",How can someone handle default datetime
Passing prompt box value - PostBack to c#," I'll try to do the best I can to articulate what I'm trying to do.Let me preface by saying that I am very new to C# and ASP.NET and have minimal experience with javascript.I have a javascript function that invokes a prompt box. The overall picture is - if input is entered - it will be saved to a column in the database. I'm drawing a blank on passing the value from the prompt box to the PostBack in c#. This is what I have in C#: I'm trying to figure out how to make that call for the input from the javascript function.I've spent the last few hours looking online and in books. Been overwhelmed.EDITi did a little tweeking to fit what I'm trying to do.... trying to figure out how to insert the string into the table now.....  <code>  function newName(){ var nName = prompt(""New Name"", "" ""); if (nName != null) { if (nName == "" "") { alert(""You have to specify the new name.""); return false; } else { // i think i need to getElementByID here??? //document.forms[0].submit(); } }} protected void Page_Load(object sender, EventArgs e){ if (!IsPostBack) { //I have other code that works here } else { //I'm totally lost here }} <asp:HiddenField ID=""txtAction"" runat=""server"" Value="""" /> document.forms(0).txtAction.Value = ""saveevent""; document.forms(0).submit(); string nEvent = Request.Form[""event""]; if (txtAction.Value == ""saveevent"") { nName.Insert(); //am i on the right track? }",Passing prompt box value from javascript function- PostBack to c#
Secure hashing in .NET," The password leak of LinkedIn proved how important it is to securely hash your passwords. However, even hashing passwords with a salt is not secure with the 'normal' hashing algorithms (such as MD5 and the SHA family), since they are optimized for speed, which allows hackers compute 2300 million hashes per second (brute force).There are hashing algoritms that are safer to use because they are much more computational intensive, such as PBKDF2, Bcrypt, PBMAC, and scrypt. These hashing algorithms however, don't seem to be included in the .NET framework.So, which performance intensive hashing algorithms are included in the .NET framework?ANSWER: PBKDF2 is included in the framework and this site shows how to use it properly. <code> ",Which of the .NET included hashing algorithms are suitable for password hashing?
Which of the .NET included hashing algoritms are secure enough for pasword hashing?," The password leak of LinkedIn proved how important it is to securely hash your passwords. However, even hashing passwords with a salt is not secure with the 'normal' hashing algorithms (such as MD5 and the SHA family), since they are optimized for speed, which allows hackers compute 2300 million hashes per second (brute force).There are hashing algoritms that are safer to use because they are much more computational intensive, such as PBKDF2, Bcrypt, PBMAC, and scrypt. These hashing algorithms however, don't seem to be included in the .NET framework.So, which performance intensive hashing algorithms are included in the .NET framework?ANSWER: PBKDF2 is included in the framework and this site shows how to use it properly. <code> ",Which of the .NET included hashing algorithms are suitable for password hashing?
Which of the .NET included hashing algorithms are secure enough for password hashing?," The password leak of LinkedIn proved how important it is to securely hash your passwords. However, even hashing passwords with a salt is not secure with the 'normal' hashing algorithms (such as MD5 and the SHA family), since they are optimized for speed, which allows hackers compute 2300 million hashes per second (brute force).There are hashing algoritms that are safer to use because they are much more computational intensive, such as PBKDF2, Bcrypt, PBMAC, and scrypt. These hashing algorithms however, don't seem to be included in the .NET framework.So, which performance intensive hashing algorithms are included in the .NET framework?ANSWER: PBKDF2 is included in the framework and this site shows how to use it properly. <code> ",Which of the .NET included hashing algorithms are suitable for password hashing?
C# How to block an operation until a condition is met?, I am running this code and it is using a fair amount of CPU even though it is doing absolutely nothing most of the time. What is the best way to block until a condition is met? <code>  while (this.IsListening){ while (this.RecievedMessageBuffer.Count > 0) { lock (this.RecievedMessageBuffer) { this.RecievedMessageBuffer[0].Reconstruct(); this.RecievedMessageBuffer[0].HandleMessage(messageHandler); this.RecievedMessageBuffer.RemoveAt(0); } }},How to block an operation until a condition is met?
Mef load plugin from directory," I work with MEF and I am looking how to change the url of the location of plugins by another means that MEF find the plugins, I want to change this line I want to delete this url because I need to deploy my application in another machineThis is my function : Can you please help me?Thanks <code>  Assembly.LoadFrom(@""C:\julia\project\project.Plugin.Nav\bin\Debug\NavPlugin.dll""))); public void AssembleCalculatorComponents(){ try { //var catalog = new AssemblyCatalog(Assembly.GetExecutingAssembly()); //var container = new CompositionContainer(catalog); //container.ComposeParts(this); var catalog = new AggregateCatalog(); catalog.Catalogs.Add(new AssemblyCatalog(Assembly.LoadFrom(@""C:\yosra\project\project.Plugin.Nav\bin\Debug\NavPlugin.dll""))); var container = new CompositionContainer(catalog); container.ComposeParts(this); } catch (Exception ex) { throw ex; } }",MEF load plugin from directory
Adding values to a dictionary via inline constructor initialization (C#)," I have the following City class. Each city object contains a dictionary which keys are language tags (let's say: ""EN"", ""DE"", ""FR""...) and which values are the city names in the corresponding languages (ex: Rome / Rom etc.). Most of the cities have the same names whatever the language so the City constructor does actually creates the English mapping: Here comes the question: is there a way to add the other values via inline initialization? I tried different variations of the following without semantic success (does not compile): I also tried creating a new Dictionary, but this obviously overwrites the ""EN"" parameter: Anybody know if this is possible? <code>  public class City:{ private IDictionary<string, string> localizedNames = new Dictionary<string, string>(0); public virtual IDictionary<string, string> Names { get { return localizedNames ; } set { localizedNames = value; } }} public City(string cityName) { this.LocalizedNames.Add(""EN"", cityName); } AllCities.Add(new City(""Rome"") { Names[""DE""] = ""Rom"" }; AllCities.Add(new City(""Rome"") { Names = new Dictionary<string, string>() { { ""DE"", ""Rom"" } } };",Adding values to a dictionary via inline initialization of its container
Adding values to a dictionary via inline constructor initialization," I have the following City class. Each city object contains a dictionary which keys are language tags (let's say: ""EN"", ""DE"", ""FR""...) and which values are the city names in the corresponding languages (ex: Rome / Rom etc.). Most of the cities have the same names whatever the language so the City constructor does actually creates the English mapping: Here comes the question: is there a way to add the other values via inline initialization? I tried different variations of the following without semantic success (does not compile): I also tried creating a new Dictionary, but this obviously overwrites the ""EN"" parameter: Anybody know if this is possible? <code>  public class City:{ private IDictionary<string, string> localizedNames = new Dictionary<string, string>(0); public virtual IDictionary<string, string> Names { get { return localizedNames ; } set { localizedNames = value; } }} public City(string cityName) { this.LocalizedNames.Add(""EN"", cityName); } AllCities.Add(new City(""Rome"") { Names[""DE""] = ""Rom"" }; AllCities.Add(new City(""Rome"") { Names = new Dictionary<string, string>() { { ""DE"", ""Rom"" } } };",Adding values to a dictionary via inline initialization of its container
C# type arguments can't be inferred from the usage for higher-order function," I have the following higher-order function: And trying to call it like that: Compiler gives me ""type arguments cannot be inferred from the usage"" error.But the following works: I wonder what the difference is?string.IsNullOrWhiteSpace is already a non-overloaded function with the exactly same signature.As mentioned in comments, the following also works and still doesn't explain why type inference fails in this case: <code>  public static Func<T, bool> Not<T>(Func<T, bool> otherFunc){ return arg => !otherFunc(arg);} var isValidStr = LinqUtils.Not(string.IsNullOrWhiteSpace); var isValidStr = LinqUtils.Not((string s) => string.IsNullOrWhiteSpace(s)); var isValidStr = LinqUtils.Not<string>(string.IsNullOrWhiteSpace);",type arguments can't be inferred from the usage for higher-order function
Want to compare string to any item in a listBox - C#," I'm creating an application that allows the user to store information about their classes. There is a button in my application that allows the user to enter information and if it matches any item in the listBox then it should display information about it.I can only get it to work if I specify a particular item by position (e.g. Items[0]) of the listBox and then convert it to a string. My aim is to compare all items in the listBox. <code>  private void button3_Click(object sender, EventArgs e){ if (listBox2.Items[0].ToString() == ""PersonalInfo"") { label.Text = ""test""; }}",How do I compare a string to all items in a listbox?
Want to compare string to any item in a listBox," I'm creating an application that allows the user to store information about their classes. There is a button in my application that allows the user to enter information and if it matches any item in the listBox then it should display information about it.I can only get it to work if I specify a particular item by position (e.g. Items[0]) of the listBox and then convert it to a string. My aim is to compare all items in the listBox. <code>  private void button3_Click(object sender, EventArgs e){ if (listBox2.Items[0].ToString() == ""PersonalInfo"") { label.Text = ""test""; }}",How do I compare a string to all items in a listbox?
Dictionaries in C#: Changing the Key of a Dictionary," I am very new to dictionaries. Very new meaning that I started using them about 6 hours ago :p. Anyways, I want to know if there is a way to change the key of a dictionary. Here is my dictionary: Here is how I am adding to the dictionary (this is fired every time the user enters info and hits a button: The user needs to be able to edit both fields as well as remove the whole record. So pretty much the application needs to add txtNumber and txtComments where txtNumber = txtObjectNumberThank you for your help.  <code>  Dictionary<string, string> Information = new Dictionary<string, string>(); Information.Add(txtObjectNumber.Text, addressCombined);",Changing the Key of a Dictionary
How to change the value of attribute in appSettings section with Web.Config transformation," Is it possible to transform the following Web.config appSettings file: into something like this: So, I need to remove the key developmentModeUserId, and I need to replace the value for the key developmentMode. <code>  <appSettings> <add key=""developmentModeUserId"" value=""00297022"" /> <add key=""developmentMode"" value=""true"" /> /* other settings here that should stay */</appSettings> <appSettings> <add key=""developmentMode"" value=""false"" /> /* other settings here that should stay */</appSettings>",How to change the value of attribute in appSettings section with Web.config transformation
Iterating over class properties by Linq In C#," There is a ParsedTemplate class that it has over 300 property (typed Details and BlockDetails). The parsedTemplate object will be fill by a function. After filling this object I need a LINQ (or other way) to find is there any property like ""body"" or ""img"" where IsExist=false and Priority=""high"". <code>  public class Details{ public bool IsExist { get; set; } public string Priority { get; set; }}public class BlockDetails : Details{ public string Block { get; set; }}public class ParsedTemplate{ public BlockDetails body { get; set; } public BlockDetails a { get; set; } public Details img { get; set; } ...}",Iterating over class properties using LINQ
How to OCR serially with MODI in C#," I have documents scanned as .jpg pictures in a folder and I would like to do OCR in C# serially for each of my documents in that folder.so far ive done this : but MODI gives the OCR running! or Cant reach file.File is in use. errors.. Depending on the situation:How can I avoid these error?Is there anyways to stop OCR action and deplete all objects in use?If anyone can answer any of the questions above it would be appreciated. <code>  public string CheckFilesAndDoOCR(string directoryPath){ directoryPath = Environment.SpecialFolder.MyPictures + ""\\OCRTempPictures\\""; IEnumerator files = Directory.GetFiles(directoryPath).GetEnumerator(); string TheTxt = """"; while (files.MoveNext()) { // FileInfo FileInfo nfo = new FileInfo(Convert.ToString(files.Current)); // Get new file name string fileName = AlltoJPG(nfo); // FileInfo (New File) FileInfo foo = new FileInfo(fileName); // Check for JPG File Format if (foo.Extension == "".jpg"" || foo.Extension == "".JPG"") // or // ImageFormat.Jpeg.ToString() { try { // OCR Operations... MODI.Document md = new MODI.Document(); md.Create(foo.FullName); md.OCR(MODI.MiLANGUAGES.miLANG_ENGLISH, false, false); // OCR(); MODI.Image image = (MODI.Image)md.Images[0]; TheTxt = image.Layout.Text; md.Close(false); // Create text file with the same Image file name FileStream createFile = new FileStream(foo.DirectoryName + ""\\"" + foo.Name.Replace(foo.Extension,string.Empty) + "".txt"", FileMode.CreateNew); // Save the image text in the text file StreamWriter writeFile = new StreamWriter(createFile); writeFile.Write(TheTxt); writeFile.Close(); } catch (Exception ex) { // Expected errors string LogPath = System.Environment.SpecialFolder.MyPictures + ""\\OCRTempPictures\\OCRInfo.txt""; Logger(LogPath, ""| Exception: Source["" + ex.Source + ""] Message["" + ex.Message + ""] InnerException["" + ex.InnerException + ""] StackTrace["" + ex.StackTrace + ""] | ""); // MessageBox.Show(ex.Message, ""OCR Exception"", MessageBoxButtons.OK, MessageBoxIcon.Information); } } } return TheTxt;}",How to OCR serially with MODI (Microsoft Office Document Imaging) in C#
Inheritance: What is the use case for this?," When inheriting an inherited class, the new / override behaviour is not what I would expect: As class C overrides the sayHi() method I would expect the output to be From C. Why does the B class's new modifier take precedence here? What is the use case for that? Especially as it breaks the obvious use case of having C really override A.Note that the above code was run on Mono 2.10 running on a Debian-derived distro. But I have confirmed the same behaviour using the C# compiler in MS Visual Studio. <code>  $ cat Program.csusing System;class A { public virtual void SayHi() { Console.WriteLine(""From A""); }}class B : A { public new virtual void SayHi() { Console.WriteLine(""From B""); }}class C : B { public override void SayHi() { Console.WriteLine(""From C""); }}public class Program { public static void Main() { A p = new C(); p.SayHi(); }}$ ./Program.exe From A",What is the use case for this inheritance idiosyncrasy?
Inserting data into Custom MembershipUser," I'm attempting to fill in data to my NCCMembershipUser with the following code: I am getting an error ""An object reference is required for the non-static field, method, or property 'System.Web.Security.MembershipProvider.GetUser(string, bool)'""If I instead use Membership.GetUser() (without the name string) to access the current user, it gives me a casting error, and GetUser() appears it cannot be overridden.Edit:The casting error I get is ""[A]NCC.App_Code.NCCMembershipProvider cannot be cast to [B]NCC.App_Code.NCCMembershipProvider."" <code>  string name = User.Identity.Name;NCCMembershipUser currentUser = (NCCMembershipUser)NCCMembershipProvider.GetUser(name, true);currentUser.Salutation = GenderSelect.SelectedValue;currentUser.FirstName = TextBoxFirstName.Text;currentUser.LastName = TextBoxLastName.Text;currentUser.Position = TextBoxPosition.Text;...try{ NCCMembershipProvider u = (NCCMembershipProvider)Membership.Provider; u.UpdateUser(currentUser);}",Casting Error: Inserting data into Custom MembershipUser
What is Difference between string and string[] in C#, How to convert string type to string[] type in C#? <code> ,How to convert string to string[]?
How to convert string type to string[] type in c#, How to convert string type to string[] type in C#? <code> ,How to convert string to string[]?
asp.net asmx web service retruning xml instead of json," Why does this simple web service refuse to return JSON to the client?Here is my client code: And the service: web.config: And the response: No matter what I do, the response always comes back as XML. How do I get the web service to return Json?EDIT:Here is the Fiddler HTTP trace: I have lost count of how many articles I have read now trying to fix this. The instructions are either incomplete or do not solve my issue for some reason.Some of the more relevant ones include (all without success):ASP.NET web service erroneously returns XML instead of JSONasmx web service returning xml instead of json in .net 4.0http://williamsportwebdeveloper.com/cgi/wp/?p=494http://encosia.com/using-jquery-to-consume-aspnet-json-web-services/http://forums.asp.net/t/1054378.aspxhttp://jqueryplugins.info/2012/02/asp-net-web-service-returning-xml-instead-of-json/Plus several other general articles. <code>  var params = { }; $.ajax({ url: ""/Services/SessionServices.asmx/HelloWorld"", type: ""POST"", contentType: ""application/json; charset=utf-8"", dataType: ""json"", timeout: 10000, data: JSON.stringify(params), success: function (response) { console.log(response); } }); namespace myproject.frontend.Services{ [WebService(Namespace = ""http://tempuri.org/"")] [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)] [System.ComponentModel.ToolboxItem(false)] [ScriptService] public class SessionServices : System.Web.Services.WebService { [WebMethod] [ScriptMethod(ResponseFormat = ResponseFormat.Json)] public string HelloWorld() { return ""Hello World""; } }} <configuration> <system.web> <compilation debug=""true"" targetFramework=""4.0"" /> </system.web></configuration> <?xml version=""1.0"" encoding=""utf-8""?><string xmlns=""http://tempuri.org/"">Hello World</string> REQUEST-------POST http://myproject.local/Services/SessionServices.asmx/HelloWorld HTTP/1.1Host: myproject.localUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:13.0) Gecko/20100101 Firefox/13.0.1Accept: application/json, text/javascript, */*; q=0.01Accept-Language: en-gb,en;q=0.5Accept-Encoding: gzip, deflateConnection: keep-aliveContent-Type: application/json; charset=utf-8X-Requested-With: XMLHttpRequestReferer: http://myproject.local/Pages/Test.aspxContent-Length: 2Cookie: ASP.NET_SessionId=5tvpx1ph1uiie2o1c5wzx0bzPragma: no-cacheCache-Control: no-cache{}RESPONSE-------HTTP/1.1 200 OKCache-Control: private, max-age=0Content-Type: text/xml; charset=utf-8Server: Microsoft-IIS/7.5X-AspNet-Version: 4.0.30319X-Powered-By: ASP.NETDate: Tue, 19 Jun 2012 16:33:40 GMTContent-Length: 96<?xml version=""1.0"" encoding=""utf-8""?><string xmlns=""http://tempuri.org/"">Hello World</string>",asp.net asmx web service returning xml instead of json
XElement Parse - Setting the namespace during a parse," Hi I am currently having a problem with parsing an Xml string without any namespace, and added to an existing XElement with a namespace.my code: the result: my problem is the xmlns="""" I cannot figure out how to create the node using a parse method and give it a default namespace to use.Is there any way of doing this? <code>  XElement elem = root.Element(xs + ""methodCall"");if (elem != null){ XElement e = XElement.Parse(this.MethodCallXML); elem.Add(e);} <methodCall> <methodCall service=""activity"" method=""activityDeleteComment"" xmlns=""""> <espSessionState>espSessionState1</espSessionState> <traceFlowCode>true</traceFlowCode> <params> <commentID>http://uri1</commentID> <isPermanentDelete>false</isPermanentDelete> </params> </methodCall></methodCall>",Setting the namespace during a parse
C# wait for third party application window to load," I'm trying to create a C#.NET 2.0 script to automate a workflow in a third party application written in Java.Im using the user32.dll functions to be able to interact with the Java app windows.My problem is that the Java app windows are slow to completely load and my action sent through IntPtr SendMessage(IntPtr hWnd, UInt32 Msg, UInt32 wParam, IntPtr lParam) sometimes are lost. Example: during the load of the main window, if I try to open a menu (at this moment I actually have a handle on the main window), my message just is lost and the menu never opens.I found some answers on Stack Overflow telling that we could use the Process.WaitForInputIdle() method for that purpose but I discovered that this only works if the app is mono threaded which is not the case of my Java app. ( C# SendKeys Wait for Program to Load before sending )I'm looking for something working the same idea but that supports multithread or any other idea you could have?!: )Following the Mari9' idea I finally used the System.Diagnostic.PerformanceCounter() to watch the third party app process activity. Then it commes to 0, it means the process has done what it had to do and is able to execute the message I send it. <code>  PerformanceCounter PC = new PerformanceCounter();PC.CategoryName = ""Process"";PC.CounterName = ""% Processor Time"";PC.InstanceName = ""<process name>"";Console.WriteLine(PC.NextValue().ToString());",Wait for third party application window to load
c# Cancel form from loading," I have the following code :This call the second form This is the constructor This is the load My problem is, that when the function result is 2 or 3 the form show up for millisecond and then close (flashing). I want the form to not flash. Is it possible?I tried to use this.Hide(), this.Visible = False but nothing helped.EDIT: I put the original codeEDIT2: Put more code <code>  private void updateToolStripMenuItem_Click(object sender, EventArgs e) { Update fm = new Update(); fm.ShowDialog(); } public Update() { InitializeComponent(); } private void Update_Load(object sender, EventArgs e) { String ver = checkver(); if (ver == ""update"") { if (RemoteFileExists(dlUrl) == true) { WebClient webClient = new WebClient(); webClient.DownloadFileCompleted += new AsyncCompletedEventHandler(Completed); webClient.DownloadProgressChanged += new DownloadProgressChangedEventHandler(ProgressChanged); webClient.DownloadFileAsync(new Uri(dlUrl), """"); } else MessageBox.Show(""An error occurred. Please try later.""); } else if (ver == ""newest"") { MessageBox.Show(""You are currently using the newest version.""); this.Close(); } else { this.Close(); } }",Cancel form load
thread safe event calls," A common practice to avoid race conditions (in multi-threaded apps) when triggering events is this: The problem (according to the book) is that ""this code could be optimized by the compiler to remove the local temp variable entirely. If this happens, this version of the code is identical to the first version, so a NullReferenceException is still possible"" According to CLR via C#, here is a better way to force the compiler to copy the event pointer. Here, CompareExchange changes the NewMail reference to null if it is null and does not alter NewMail if it is not null. In other words, CompareExchange doesn't change the value in NewMail at all, but it does return the value inside NewMail in an atomic, thread-safe way. Richter, Jeffrey (2010-02-12). CLR via C# (p. 265). OReilly Media - A. Kindle Edition. I am on .Net 4.0 framework, and not sure how this can possibly work, because Interlocked.CompareExchange expects a reference to a location, not a reference to a event. Either there is an error in the book, or I misinterpreted it. Has anyone implemented this method? Or have a better way to prevent race conditions here? UPDATEit was my mistake, the iterlocked code works. i just had wrong casting specified, but according to Bradley (below) it is not necessary in .net 2.0 and up on windows.  <code>  EventHandler<EventArgs> temp = SomeEvent;if (temp != null) temp(e);""Remember that delegates are immutable and this is why this technique works in theory. However, what a lot of developers don't realize is that this code could be optimized by the compiler to remove the local temp variable entirely. If this happens, this version of the code is identical to the first version, so a NullReferenceException is still possible."" virtual void OnNewMail(NewMailEventArgs e){ EventHandler<NewMailEventArgs> temp = Interlocked.CompareExchange(ref NewMail, null, null); if (temp != null) temp(this, e);}",Thread Safe Event Calls
Access unvisible Columns in a Datagridview," I'm showing some data in a DataGridView using a list which I get from the Entity Framework. In this grid I set some database columns like the id to invisible.When the user clicks on the gridview I need to know which object was clicked for further steps, the problem I cannot get the id column, neither through: nor through: It seems that through setting some columns to invisible the objects attached have anonymous typesAny ideas?Thank you <code>  datagridview1.CurrentRow.Cells[0].Value // here I get only visible cells datagridview1.CurrentRow.DataBoundItem ",Access invisible columns in a Datagridview (WinForms)
Access invisible columns in a Datagridview," I'm showing some data in a DataGridView using a list which I get from the Entity Framework. In this grid I set some database columns like the id to invisible.When the user clicks on the gridview I need to know which object was clicked for further steps, the problem I cannot get the id column, neither through: nor through: It seems that through setting some columns to invisible the objects attached have anonymous typesAny ideas?Thank you <code>  datagridview1.CurrentRow.Cells[0].Value // here I get only visible cells datagridview1.CurrentRow.DataBoundItem ",Access invisible columns in a Datagridview (WinForms)
Is there a way too assign multiple Jsonproperties?," I am trying to make a single dataclass that holds information from both Facebook and Twitter. but in my JSON reply from twitter I need id_str and from FaceBook I get id.I need those two to be put into the id-string. Now I know I can use [JsonProperty(""id_str"")] if I want to deserialize Twitters id_str into my id-string. But what if I need both Facebook's id and Twitters id_str to be deserialized in the same id-string I have in my dataclass? <code> ",Assign Multiple JsonProperties?
Is there a way to assign multiple Jsonproperties?," I am trying to make a single dataclass that holds information from both Facebook and Twitter. but in my JSON reply from twitter I need id_str and from FaceBook I get id.I need those two to be put into the id-string. Now I know I can use [JsonProperty(""id_str"")] if I want to deserialize Twitters id_str into my id-string. But what if I need both Facebook's id and Twitters id_str to be deserialized in the same id-string I have in my dataclass? <code> ",Assign Multiple JsonProperties?
C#.NET calculating directory sizes," I'm trying to calculate directory sizes in a way that divides the load so that the user can see counting progress. I thought a logical way to do this would be to first create the directory tree then do an operation counting the length of all the files.The thing that comes to me as unexpected is that the bulk of time (disk I/O) comes from creating the directory tree, then going over the FileInfo[] comes nearly instantly with virtually no disk I/O.I've tried with both Directory.GetDirectories(), simply creating a tree of strings of the directory names, and using a DirectoryInfo object, and both methods still take the bulk of the I/O time (reading the MFT of course) compared to going over all the FileInfo.Length for the files in each directory.I guess there's no way to reduce the I/O to make the tree significantly, I guess I'm just wondering why this operation takes significantly more time compared to going over the more numerous files?Also, if anyone could recommend a non-recursive way to tally things up (since it seems I need to just split up the enumeration and balance it in order to make the size tallying more responsive). Making a thread for each subdirectory off the base and letting scheduler competition balance things out would probably not be very good, would it?EDIT: Repository for this code <code> ",Calculating directory sizes
Export excel macro-button with macro to excel document in C#," I am in the middle of simple method, that saves my DataGridView into an Excel document (1 sheet only) and also adds VBA code and a button to run the VBA code. I only implemented DataGridView export.EDIT: Thanks to Joel I could, with proper words, search again for the solution. I think that this may be helpful. Would you correct me or give a tip or two about what I should look for. <code>  public void SaveFile(string filePath) { Microsoft.Office.Interop.Excel.ApplicationClass ExcelApp = new Microsoft.Office.Interop.Excel.ApplicationClass(); ExcelApp.Application.Workbooks.Add(Type.Missing); //Change Workbook-properties. ExcelApp.Columns.ColumnWidth = 20; // Storing header part in Excel. for (int i = 1; i < gridData.Columns.Count + 1; i++) { ExcelApp.Cells[1, i] = gridData.Columns[i - 1].HeaderText; } //Storing Each row and column value to excel sheet for (int row = 0; row < gridData.Rows.Count; row++) { gridData.Rows[row].Cells[0].Value = ""Makro""; for (int column = 0; column < gridData.Columns.Count; column++) { ExcelApp.Cells[row + 2, column + 1] = gridData.Rows[row].Cells[column].Value.ToString(); } } ExcelApp.ActiveWorkbook.SaveCopyAs(filePath); ExcelApp.ActiveWorkbook.Saved = true; ExcelApp.Quit(); }",Create Excel VBA code and button programmatically from C#
Create an Excel Macro and Macro-butoon programmatically from C#," I am in the middle of simple method, that saves my DataGridView into an Excel document (1 sheet only) and also adds VBA code and a button to run the VBA code. I only implemented DataGridView export.EDIT: Thanks to Joel I could, with proper words, search again for the solution. I think that this may be helpful. Would you correct me or give a tip or two about what I should look for. <code>  public void SaveFile(string filePath) { Microsoft.Office.Interop.Excel.ApplicationClass ExcelApp = new Microsoft.Office.Interop.Excel.ApplicationClass(); ExcelApp.Application.Workbooks.Add(Type.Missing); //Change Workbook-properties. ExcelApp.Columns.ColumnWidth = 20; // Storing header part in Excel. for (int i = 1; i < gridData.Columns.Count + 1; i++) { ExcelApp.Cells[1, i] = gridData.Columns[i - 1].HeaderText; } //Storing Each row and column value to excel sheet for (int row = 0; row < gridData.Rows.Count; row++) { gridData.Rows[row].Cells[0].Value = ""Makro""; for (int column = 0; column < gridData.Columns.Count; column++) { ExcelApp.Cells[row + 2, column + 1] = gridData.Rows[row].Cells[column].Value.ToString(); } } ExcelApp.ActiveWorkbook.SaveCopyAs(filePath); ExcelApp.ActiveWorkbook.Saved = true; ExcelApp.Quit(); }",Create Excel VBA code and button programmatically from C#
Create an Excel Macro and Macro-button programmatically from C#," I am in the middle of simple method, that saves my DataGridView into an Excel document (1 sheet only) and also adds VBA code and a button to run the VBA code. I only implemented DataGridView export.EDIT: Thanks to Joel I could, with proper words, search again for the solution. I think that this may be helpful. Would you correct me or give a tip or two about what I should look for. <code>  public void SaveFile(string filePath) { Microsoft.Office.Interop.Excel.ApplicationClass ExcelApp = new Microsoft.Office.Interop.Excel.ApplicationClass(); ExcelApp.Application.Workbooks.Add(Type.Missing); //Change Workbook-properties. ExcelApp.Columns.ColumnWidth = 20; // Storing header part in Excel. for (int i = 1; i < gridData.Columns.Count + 1; i++) { ExcelApp.Cells[1, i] = gridData.Columns[i - 1].HeaderText; } //Storing Each row and column value to excel sheet for (int row = 0; row < gridData.Rows.Count; row++) { gridData.Rows[row].Cells[0].Value = ""Makro""; for (int column = 0; column < gridData.Columns.Count; column++) { ExcelApp.Cells[row + 2, column + 1] = gridData.Rows[row].Cells[column].Value.ToString(); } } ExcelApp.ActiveWorkbook.SaveCopyAs(filePath); ExcelApp.ActiveWorkbook.Saved = true; ExcelApp.Quit(); }",Create Excel VBA code and button programmatically from C#
iOS4 and iOS5 auto-refresh web application," I have an ASP.Net web page that currently works on the iOS4 but not on the iOS5. On the parent web page I have a button that opens a child window. And I do a setTimeout refresh thing in the parent window right after the open window call.I noticed on the iPhone iOS5 that when it opens the child window, the setTimeout function in the parent page is not called until I go back to the parent window and then back to the child window to see the update. Here's a snippet of my code in the parent page and where I think is the problem this runs on iOS4 but not on iOS5. Any ideas? <code>  WindowManager.OpenWindow('...')t = setTimeout(function() { handles[0].testfx(); }, 1000);",JavaScript setTimeout not firing after Window.Open
C# - Faster than String.Replace()," Is there any other method that is faster than doing like this? -- Edited (Add explanation) -- Q1: Is there a reason why you need to speed it up? Is it causing a huge problem? This part is used in this project: http://mysqlbackuprestore.codeplex.com/ I'm going to loop lots of various length of strings into this function repeatly. The whole process takes around 6-15 seconds to finished for millions of rows. There are other part get involve too. I'm trying to speed up every part.Q2: How slow is it now? OK, I'll capture the exact time used and post it here. I'll come back later. (will post the result tomorrow)Update 29-06-2012I have run test. This is the result:Speed Test: String.Replace() - measured in milisecondsTest 1: 26749.7531 msTest 2: 27063.438 msTest 3: 27753.8884 msAverage: 27189.0265 msSpeed: 100%Speed Test: Foreach Char and Append - measured in milisecondsTest 1: 8468.4547 msTest 2: 8348.8527 msTest 3: 8353.6476 msAverage: 8390.3183 msSpeed: 224% < faster===================================Update - Next Test (Another round)===================================------Test Replace String Speed.Test 1: 26535.6466Test 2: 26379.6464Test 3: 26379.6463Average: 26431.6464333333Speed: 100%------Test Foreach Char String Append.Test 1: 8502.015Test 2: 8517.6149Test 3: 8595.6151Average: 8538.415Speed: 309.56%------Test Foreach Char String Append (Fix StringBuilder Length).Test 1: 8314.8146Test 2: 8330.4147Test 3: 8346.0146Average: 8330.41463333333Speed: 317.29%Conclusion:Using Foreach Char Loop and Append is faster than String.Replace().Thanks you very much guys.--------Below are the codes that I used to run the test: (edited) <code>  private void EscapeStringSequence(ref string data){ data = data.Replace(""\\"", ""\\\\""); // Backslash data = data.Replace(""\r"", ""\\r""); // Carriage return data = data.Replace(""\n"", ""\\n""); // New Line data = data.Replace(""\a"", ""\\a""); // Vertical tab data = data.Replace(""\b"", ""\\b""); // Backspace data = data.Replace(""\f"", ""\\f""); // Formfeed data = data.Replace(""\t"", ""\\t""); // Horizontal tab data = data.Replace(""\v"", ""\\v""); // Vertical tab data = data.Replace(""\"""", ""\\\""""); // Double quotation mark data = data.Replace(""'"", ""\\'""); // Single quotation mark} using System;using System.Collections.Generic;using System.Linq;using System.Text;namespace ConsoleApplication1{ class Program { static void Main(string[] args) { Console.Write(""Press any key to continue...""); Console.ReadKey(); Console.Write(""\r\nProcess started.""); Test(); Console.WriteLine(""Done.""); Console.Read(); } public static Random random = new Random((int)DateTime.Now.Ticks); public static string RandomString(int size) { StringBuilder sb = new StringBuilder(); char ch; for (int i = 0; i < size; i++) { ch = Convert.ToChar(Convert.ToInt32(Math.Floor(26 * random.NextDouble() + 65))); sb.Append(ch); } return sb.ToString(); } public static void Test() { string text = ""\\_\r\n\a\b\f\t\v\""'"" + RandomString(2000) + ""\\_\r\n\a\b\f\t\v\""'"" + RandomString(2000); List<TimeSpan> lstTimeUsed = new List<TimeSpan>(); int target = 100000; for (int i = 0; i < 3; i++) { DateTime startTime = DateTime.Now; for (int j = 0; j < target; j++) { if (j.ToString().EndsWith(""000"")) { Console.Clear(); Console.WriteLine(""Test "" + i.ToString()); Console.WriteLine(j.ToString() + "" of "" + target.ToString()); } string data = text; data = data.Replace(""\\"", ""\\\\""); // Backslash data = data.Replace(""\r"", ""\\r""); // Carriage return data = data.Replace(""\n"", ""\\n""); // New Line data = data.Replace(""\a"", ""\\a""); // Vertical tab data = data.Replace(""\b"", ""\\b""); // Backspace data = data.Replace(""\f"", ""\\f""); // Formfeed data = data.Replace(""\t"", ""\\t""); // Horizontal tab data = data.Replace(""\v"", ""\\v""); // Vertical tab data = data.Replace(""\"""", ""\\\""""); // Double quotation mark data = data.Replace(""'"", ""\\'""); // Single quotation mark } DateTime endTime = DateTime.Now; TimeSpan ts = endTime - startTime; lstTimeUsed.Add(ts); } double t1 = lstTimeUsed[0].TotalMilliseconds; double t2 = lstTimeUsed[1].TotalMilliseconds; double t3 = lstTimeUsed[2].TotalMilliseconds; double tOri = (t1 + t2 + t3) / 3; System.IO.TextWriter tw = new System.IO.StreamWriter(""D:\\test.txt"", true); tw.WriteLine(""------""); tw.WriteLine(""Test Replace String Speed. Test Time: "" + DateTime.Now.ToString()); tw.WriteLine(""Test 1: "" + t1.ToString()); tw.WriteLine(""Test 2: "" + t2.ToString()); tw.WriteLine(""Test 3: "" + t3.ToString()); tw.WriteLine(""Average: "" + tOri.ToString()); tw.WriteLine(""Speed: 100%""); tw.Close(); lstTimeUsed = new List<TimeSpan>(); for (int i = 0; i < 3; i++) { DateTime startTime = DateTime.Now; for (int j = 0; j < target; j++) { if (j.ToString().EndsWith(""000"")) { Console.Clear(); Console.WriteLine(""Test "" + i.ToString()); Console.WriteLine(j.ToString() + "" of "" + target.ToString()); } string data = text; var builder = new StringBuilder(); foreach (var ch in data) { switch (ch) { case '\\': case '\r': case '\n': case '\a': case '\b': case '\f': case '\t': case '\v': case '\""': case '\'': builder.Append('\\'); break; default: break; } builder.Append(ch); } } DateTime endTime = DateTime.Now; TimeSpan ts = endTime - startTime; lstTimeUsed.Add(ts); } t1 = lstTimeUsed[0].TotalMilliseconds; t2 = lstTimeUsed[1].TotalMilliseconds; t3 = lstTimeUsed[2].TotalMilliseconds; tw = new System.IO.StreamWriter(""D:\\test.txt"", true); tw.WriteLine(""------""); tw.WriteLine(""Test Foreach Char String Append. Test Time: "" + DateTime.Now.ToString()); tw.WriteLine(""Test 1: "" + t1.ToString()); tw.WriteLine(""Test 2: "" + t2.ToString()); tw.WriteLine(""Test 3: "" + t3.ToString()); tw.WriteLine(""Average: "" + ((t1 + t2 + t3) / 3).ToString()); tw.WriteLine(""Speed: "" + ((tOri) / ((t1 + t2 + t3) / 3) * 100).ToString(""0.00"") + ""%""); tw.Close(); lstTimeUsed = new List<TimeSpan>(); for (int i = 0; i < 3; i++) { DateTime startTime = DateTime.Now; for (int j = 0; j < target; j++) { if (j.ToString().EndsWith(""000"")) { Console.Clear(); Console.WriteLine(""Test "" + i.ToString()); Console.WriteLine(j.ToString() + "" of "" + target.ToString()); } string data = text; var builder = new StringBuilder(data.Length + 20); foreach (var ch in data) { switch (ch) { case '\\': case '\r': case '\n': case '\a': case '\b': case '\f': case '\t': case '\v': case '\""': case '\'': builder.Append('\\'); break; default: break; } builder.Append(ch); } } DateTime endTime = DateTime.Now; TimeSpan ts = endTime - startTime; lstTimeUsed.Add(ts); } t1 = lstTimeUsed[0].TotalMilliseconds; t2 = lstTimeUsed[1].TotalMilliseconds; t3 = lstTimeUsed[2].TotalMilliseconds; tw = new System.IO.StreamWriter(""D:\\test.txt"", true); tw.WriteLine(""------""); tw.WriteLine(""Test Foreach Char String Append (Fix StringBuilder Length). Test Time: "" + DateTime.Now.ToString()); tw.WriteLine(""Test 1: "" + t1.ToString()); tw.WriteLine(""Test 2: "" + t2.ToString()); tw.WriteLine(""Test 3: "" + t3.ToString()); tw.WriteLine(""Average: "" + ((t1 + t2 + t3) / 3).ToString()); tw.WriteLine(""Speed: "" + ((tOri) / ((t1 + t2 + t3) / 3) * 100).ToString(""0.00"") + ""%""); tw.Close(); } }}",Faster than String.Replace()
WM_QUERYENDSESSION IS DRIVING ME INSANE," Making a simple application, so when the user logs out of Windows, it of course shuts the application down. We are making a simple USB Alert application which STOPS shutdown if a USB is detected when the user is logging offThis is the code so far. What is happening is that the Windows Force Programs to Quit screen is being displayed, I read somewhere if you return 0 to WM_QUERYENDSESSION it does not display this, but it is still displaying this...Any ideas?EDIT:We used the code that someone responded with, but we are still getting this screen. <code>  public Form1() { InitializeComponent(); } private static int WM_QUERYENDSESSION = 0x11; private static bool systemShutdown = false; protected override void WndProc(ref System.Windows.Forms.Message m) { if (m.Msg == WM_QUERYENDSESSION) { //MessageBox.Show(""queryendsession: this is a logoff, shutdown, or reboot""); systemShutdown = true; m.Result = (IntPtr)0; } // If this is WM_QUERYENDSESSION, the closing event should be // raised in the base WndProc. m.Result = (IntPtr)0; base.WndProc(ref m); } //WndProc private void Form1_FormClosing(object sender, FormClosingEventArgs e) { if (systemShutdown) { systemShutdown = false; bool hasUSB = false; foreach (DriveInfo Drive in DriveInfo.GetDrives()) { if (Drive.DriveType == DriveType.Removable) { hasUSB = true; } } if (hasUSB) { e.Cancel = true; MessageBox.Show(""You still have USB device plugged in, please unplug it and log off again""); } else { e.Cancel = false; } } }",WM_QUERYENDSESSION is causing me problems
C# and XML - deserialize XML to object (need to return a list of objects)," Started practicing with XML and C# and I have an error message of ""There is an error in XML document (3,2)"". After looking at the file, I can't see anything wrong with it (Mind you, I probably missed something since I'm a noob). I'm using a Console Application for C# right now. I'm trying to return a list of Adventurers and just a side note, the GEAR element is optional. Here is what I have so far:XML File - Test1 C# Classes Serialize Function - Where the Problem Occurs at Line 5 <code>  <?xml version=""1.0"" encoding=""utf-8""?><Catalog> <Adventurer> <ID>001</ID> <Name>John Smith</Name> <Address>123 Fake Street</Address> <Phone>123-456-7890</Phone> <Gear> <Attack> <Item> <IName>Sword</IName> <IPrice>15.00</IPrice> </Item> <Item> <IName>Wand</IName> <IPrice>20.00</IPrice> </Item> </Attack> <Defense> <Item> <IName>Shield</IName> <IPrice>5.00</IPrice> </Item> </Defense> </Gear> </Adventurer> <Adventurer> <ID>002</ID> <Name>Guy noone likes</Name> <Address>Some Big House</Address> <Phone>666-666-6666</Phone> <Gear></Gear> </Adventurer></Catalog> public class Catalog{ List<Adventurer> Adventurers { get; set; }}public class Adventurer{ public int ID { get; set; } public string Name { get; set; } public string Address { get; set; } public string Phone { get; set; } public Gear Gear { get; set; }}public class Gear{ public List<Item> Attack { get; set; } public List<Item> Defense { get; set; }}public class Item{ public string IName { get; set; } public decimal IPrice { get; set; }} Catalog obj = null;string path = @""C:\Users\Blah\Desktop\test1.xml"";XmlSerializer serializer = new XmlSerializer(typeof(Catalog));StreamReader reader = new StreamReader(path);obj = (Catalog)serializer.Deserialize(reader);reader.Close();Console.ReadLine();",Deserialize XML to object (need to return a list of objects)
"C# Regular Expression to allow alphanumeric, only one space and then alpahnumeric"," I've searched and searched and tried many different ways, but I can't seem to figure this out. I'm looking for a way to only allow alphanumeric characters, then only one space, then alphanumeric characters. I'm sure it's easy, but I don't know it.Examples of what I want: I'd then like to remove the invalid characters from the string.Please let me know if you need more information. Thanks a lot! <code>  First Last Allowed First La-st Not Allowed FirstLast Not Allowed First Last Not Allowed First La'st Not allowed","Regular expression to allow alphanumeric, only one space and then alpahnumeric"
Getting the CurrentUserID from Websecurity directly after login," I have this website (C#/ASP.NET) with a form where the user can register for an account (it is the default template of VS11) and after everything is filled in and the user clicks to register, it creates the account and logs in the user (which works great). After this step I want to get the UserID which he was assigned, but it doesn't work. I've put a breakpoint there to see the values of both ""currentuserid"" and ""WebSecurity.CurrentUserId"" but they only have a -1 value. Next step is the user gets redirected to the next page, and on that page these functions work. I thought I would be able to get the UserID as the user has already gotten logged in in the first line of the code I provided here.So my question is, why doesn't it work here? I am very noobish with this, so I am obviously missing something. Thanks! <code>  WebSecurity.Login(username, password);int currentuserid = WebSecurity.CurrentUserId; // This doesn't work, only returns -1<here I wish to update other tables but I need the user ID>Response.Redirect(""~/Welcome.cshtml"");",Getting the CurrentUserID from Websecurity directly after login (C#/ASP.NET)
Programatically get a diff between two versions of a file in TFS," I'm trying to write a code which, given a path to an item in the TFS repository and two revisions, would compute a difference between the contents file had at these two moments. For now the code might look like this: But once this code is executed, the variable diff is an empty string even though I know for sure the file has been modified between minRevision and maxRevision. This code will also throw an exception if the file didn't exist at minRevision or was deleted in maxRevision, but this seems to be a problem to solve later, once I get this thing working with files which were only edited. EDITHaving checked temp files, I'm sure both versions of the file are downloaded correctly. Something is wrong with the computation of the diff or with writing the diff to a stream or with copying the diff to a string. <code>  using (var projectCollection = new TfsTeamProjectCollection(new Uri(repositoryUrl))){ projectCollection.EnsureAuthenticated(); var versionControlServer = (VersionControlServer)projectCollection.GetService(typeof(VersionControlServer)); string path = ""$/MyProject/path/to/file.xml"" var before = new DiffItemVersionedFile(versionControlServer, path, VersionSpec.ParseSingleSpec(minRevision.ToString(), null)); var after = new DiffItemVersionedFile(versionControlServer, path, VersionSpec.ParseSingleSpec(maxRevision.ToString(), null)); using (var stream = new MemoryStream()) using (var writer = new StreamWriter(stream)) { var options = new DiffOptions(); options.Flags = DiffOptionFlags.EnablePreambleHandling; options.OutputType = DiffOutputType.Unified; options.TargetEncoding = Encoding.UTF8; options.SourceEncoding = Encoding.UTF8; options.StreamWriter = writer; Difference.DiffFiles(versionControlServer, before, after, options, path, true); writer.Flush(); var reader = new StreamReader(stream); var diff = reader.ReadToEnd(); }}",Programmatically get a diff between two versions of a file in TFS
Parse data time from string," I am kind of stuck with an issue where I am unable to to parse the date and time from a string, which I am reading from a text file. The string I am getting is in following format:05SEP1998 2400and I am trying to parse the string through the following code: But while parsing, the above code throws a FormatException: String was not recognized as a valid DateTime.Could anybody please help me fixing this issue? <code>  string dateTimeStr = ""05SEP1998 2400""var provider = CultureInfo.InvariantCulture;const string Format = ""ddMMMyyyy hhmm"";var dateTime = DateTime.ParseExact(dateTimeStr, Format, provider);",Parse date time from string of format ddMMMyyyy hhmm (with Month-Name)
Parse date time from string," I am kind of stuck with an issue where I am unable to to parse the date and time from a string, which I am reading from a text file. The string I am getting is in following format:05SEP1998 2400and I am trying to parse the string through the following code: But while parsing, the above code throws a FormatException: String was not recognized as a valid DateTime.Could anybody please help me fixing this issue? <code>  string dateTimeStr = ""05SEP1998 2400""var provider = CultureInfo.InvariantCulture;const string Format = ""ddMMMyyyy hhmm"";var dateTime = DateTime.ParseExact(dateTimeStr, Format, provider);",Parse date time from string of format ddMMMyyyy hhmm (with Month-Name)
Parse date time from string of format ddMMMyyyy hhmm," I am kind of stuck with an issue where I am unable to to parse the date and time from a string, which I am reading from a text file. The string I am getting is in following format:05SEP1998 2400and I am trying to parse the string through the following code: But while parsing, the above code throws a FormatException: String was not recognized as a valid DateTime.Could anybody please help me fixing this issue? <code>  string dateTimeStr = ""05SEP1998 2400""var provider = CultureInfo.InvariantCulture;const string Format = ""ddMMMyyyy hhmm"";var dateTime = DateTime.ParseExact(dateTimeStr, Format, provider);",Parse date time from string of format ddMMMyyyy hhmm (with Month-Name)
C# : How to check whether a base class object or derived object?," I have a BankAccount class. FixedBankAccount and SavingsBankAccount are derived from it.I need to throw an exception if the recieved object is not a derived object. I have the following code. Is there any better code than this? <code>  IEnumerable<DBML_Project.BankAccount> accounts = AccountRepository.GetAllAccountsForUser(userId);foreach (DBML_Project.BankAccount acc in accounts){ string typeResult = Convert.ToString(acc.GetType()); string baseValue = Convert.ToString(typeof(DBML_Project.BankAccount)); if (String.Equals(typeResult, baseValue)) { throw new Exception(""Not correct derived type""); }}namespace DBML_Project{public partial class BankAccount{ // Define the domain behaviors public virtual void Freeze() { // Do nothing }}public class FixedBankAccount : BankAccount{ public override void Freeze() { this.Status = ""FrozenFA""; }}public class SavingsBankAccount : BankAccount{ public override void Freeze() { this.Status = ""FrozenSB""; }}} // namespace DBML_Project",How to check whether a base class object or derived object?
"Prevent a user from Deleting, Moving, or Renaming a file in C#"," What I am trying to do is while my program is using a file, I want to keep the user from renaming, deleting, or moving the file (well... a move is a delete and a create at a different location according to Windows FileSystemWatcher, but I digress).It has been suggested that I use FileStream.Lock or use a Mutex. However, FileStream.Lock seems only to prevent the file from being modified which I am trying to allow. Also, I am very unsure as to if a mutex can lock a file, although I am still reading on it with in the .Net 4.0 library.Does anyone have any advice on utilizing either one and if there is a code based solution to this problem? <code> ","Prevent a user from deleting, moving or renaming a file"
How to append int to int in c#," I have two integers, ex. 15 and 6 and I want to get 156.What I do: Any better way of doing this?UPDATE:Thanks for all of your nice answers. I run a quick Stopwatch test to see what are the performance implications:This is a code tested on my machine: And here's the timing: Guffa provided a very nice and smart solution and Chris Gessler provided a very nice extension method for that solution. <code>  int i = 15;int j = 6;Convert.ToInt32(i.ToString() + j.ToString()); static void Main() { const int LOOP = 10000000; int a = 16; int b = 5; int result = 0; Stopwatch sw = Stopwatch.StartNew(); for (int i = 0; i < LOOP; i++) { result = AppendIntegers3(a, b); } sw.Stop(); Console.WriteLine(""{0}ms, LastResult({1})"", sw.ElapsedMilliseconds,result); } My original attempt: ~3700ms Guffa 1st answer: ~105ms Guffa 2nd answer: ~110ms Pent Ploompuu answer: ~990ms shenhengbin answer: ~3830ms dasblinkenlight answer: ~3800msChris Gessler answer: ~105ms","Good way to ""append"" integers in C#?"
Must I explicitly bind normal classes using AppFabric?," I seem to be doing this a fair bit in my code: Where the 'actions' class is a class I require to be injected into my controller, and has various other sub-dependencies.Seems a bit rubbish. Why can't autofac resolve that the class has a constructor with dependencies that are already satisfied and manufacture an instance automatically?I mean, if class A requires class B to be injected and class B requires C, D, E, etc. fair enough, I guess you dont want to walk the entire dependency chain to see if you can make a class at run time. ...but if class A directly depends on C and D which are explicitly bound, surely that's a trivial case?Am I missing something? Can't seem to see any documentation for this... <code>  public class ActionsModule : Module { protected override void Load(ContainerBuilder builder) { base.Load(builder); builder.Register(c => LogManager.GetCurrentClassLogger()).As<ILog>().InstancePerDependency(); // Autofac doesn't seem to be able to inject things without explicit binding builder.RegisterType<ComboActions>().As<ComboActions>().InstancePerHttpRequest(); builder.RegisterType<AppActions>().As<AppActions>().InstancePerHttpRequest(); } }}",Must I explicitly bind normal classes using Autofac?
const vs. readonly [NOT duplicate]," Today I found an article where a const field is called compile-time constant while a readonly field is called runtime constant. The two phrases come from Effective C#. I searched in MSDN and the language spec, find nothing about runtime constant.No offensive but I don't think runtime constant is a proper phrase. creates a variable named ""foo"", whose value is ""bar"", and the value is readonly, here it is a variable, no business on constant. A readonly variable is still a variable, it can't be a constant. Variable and constant are mutually exclusive.Maybe this question goes overboard, still I want to listen to others' opinions. What do you think? <code>  private readonly string foo = ""bar"";",const vs. readonly
generic of type T where T has an specific Attribute," Is it possible to create a generic method of type T where T has a specific attribute? E.g.: and I want to serialize only a classes with a Serializable and/or DataContract attribute: <code>  public static XmlDocument SerializeObjectToXml<T>(T obj){ //...} [Serializable][DataContract(Name = ""viewModel"", Namespace = ""ns"")]internal class ViewModel{ //...}",Generic of type T where T has a specific attribute
Resizeing a 3D array in C#," I am attempting to resize a 3D array in C#.The VB6 code reads: Since I cannot use Array.Resize for a 3D array, is there another way for me to do this function in C#?I have already declared the array as a 3D array: But I am having trouble resizing it. Any ideas? <code>  ReDim Combos(ProductNum, 4, 3) int[ , , ] Combos;",Resizing a 3D array
C# is power of function," I have the next function: I inserted the print function for analysis.If I call the function: It return true since 5^2 equals 25.But, if I call 16807, which is 7^5, the next way: In this case, it prints '7' but a == (int)a return false.Can you help? Thanks! <code>  static bool isPowerOf(int num, int power){ double b = 1.0 / power; double a = Math.Pow(num, b); Console.WriteLine(a); return a == (int)a;} isPowerOf(25, 2) isPowerOf(16807, 5)",C# isPowerOf function
How to find FULL name of calling method C#," How can I find the full name of a calling method in C#? I have seen solutions:How I can get the calling methods in C#How can I find the method that called the current method?Get Calling function name from Called functionBut they only give me the top level. Consider the example: This simply outputs 'Main'. How can I get it to print 'Sandbox.Program.Main'?It's for a simple logging framework that I am working on.Adding onto Matzi's Answer:Here is the solution: It produces 'Sandbox.Program.Main' like it should. <code>  namespace Sandbox{ class Program { static void Main(string[] args) { test(); } static void test() { var stackTrace = new StackTrace(); var methodBase = stackTrace.GetFrame(1).GetMethod(); Console.WriteLine(methodBase.Name); } }} namespace Sandbox{ class Program { static void Main(string[] args) { test(); } static void test() { var stackTrace = new StackTrace(); var methodBase = stackTrace.GetFrame(1).GetMethod(); var Class = methodBase.ReflectedType; var Namespace = Class.Namespace; // Added finding the namespace Console.WriteLine(Namespace + ""."" + Class.Name + ""."" + methodBase.Name); } }}",How to find the FULL name of the calling method in C#
How to depricate [RequireHttps] for all methods during debugging?, I have some MVC2 website that has a lot of [RequireHttps].But when I debug it I have to comment many of them in different places (controllers). And when code is ready I have to delete all comments. So it takes time and sometimes I forgot to uncomment [RequireHttps] :)My question is which is best practices to resolve this problem?Thank you! <code> ,How to disable [RequireHttps] for all methods during debugging?
Multi Targetting in C#.NET for 32 bit and 64 bit, Supposing I have a windows app developed based on C#. I want to ensure that it works on 32 bit and 64 bit both. But I don't want to change the config settings or application settings time and again. Is there a way to test both variants? <code> ,Multi Targeting in C#.NET for 32 bit and 64 bit
Select text in a disabled textbox c#, How do I select the text in a disabled textbox? <code> ,Select text in a disabled textbox in C#
Accessing array elements of a List<object[]> in foreach loop (C#)," This is what I have: Is there a way to make this work without losing code readability, or should I try using a class instead of object array? <code>  List<object[]> markers = new List<object[]>();object[] marker = new object[2];marker[0] = new Vector2(1, 2);marker[1] = new Vector4(1, 2, 3, 4);markers.Add(marker);foreach (var item in markers){ int x = (Vector2)item[0].X; // Error: 'object' does not contain a definition // for 'X' and no extension method 'X' accepting // a first argument of type 'object' could be // found (are you missing a using directive or // an assembly reference?) // other stuff}",Accessing array elements of a List<object[]> in foreach loop
C# compiler generated sealed class for delegate keyword contains virtual methods," When delegate keyword is used in C#, the C# compiler automatically generates a class derived from System.MulticastDelegate class.This compiler generated class contains 3 methods as well: Invoke, BeginInvoke and EndInvoke.All these three methods are marked public virtual extern but interestingly the class itself is marked sealed.Virtual methods defined in a sealed class not only strikes as counter-intuitive but are actually illegal in C#.So my question is, is there a specific reason for this or is it just one of those harmless things done keeping in mind some hypothetical future enhancement?Edit 1:Can the reason be to force use of 'callVirt' IL opcode as opposed to 'call' so that delegate object is always checked for null by the CLR before trying to execute any of the three methods? Though I fail to see why a delegate should be a special case in this respect.Also isn't it a performance hit to force use of callvirt (though it may be minuscule)Edit 2:Added CIL tag, as it turns out that the C# way of defining delegates is in fact mandated by the CIL standard. Standard states that (following is not full text) Delegates shall have a base type of System.Delegate. Delegates shall be declared sealed, and the only members a delegate shall have are either the first two or all four methods as specified here. These methods shall be declared runtime and managed. They shall not have a body, since that body shall be created automatically by the VES. Other methods available on delegates are inherited from the class System.Delegate in the Base Class Library. The delegate methods are: The instance constructor The Invoke method shall be virtual The BeginInvoke method, if present, shall be virtual The EndInvoke method shall be virtual So this is definitely not a side effect of compiler process or is similar to other interesting compiler outputs.If standard emphasizes something, it must be for some good reason and rationale. So the question now is why does CIL standard for delegates emphasizes on sealed and virtual at the same time?Does the catch lie here?: They shall not have a body, since that body shall be created automatically by the VES.Are they marked virtual so that the VES/CLR generated body can be executed on invocation of these methods? <code> ",Compiler generated sealed class for delegate keyword contains virtual methods
"How I can obtine client hostname, local computer name and user name in c# and asp.net"," I have the IP address, but for some reason I can get the name resolve correctly to show local computer name. I try few things and all of them is showing the server hostname? For user name I am tring to use I switched authentication and no results <code>  ipadd = HttpContext.Current.Request.ServerVariables[""REMOTE_ADDR""]; IPAddress myIP = IPAddress.Parse(ipadd); IPHostEntry GetIPHost = Dns.GetHostEntry(myIP); //userhostname = System.Environment.MachineName; //userhostname = Dns.GetHostName(); //Resolve ServerHostName not computer //userhostname = HttpContext.Current.Request.UserHostName; //userhostname = HttpContext.Current.Request.UserAgent; userhostname = GetIPHost.HostName; nametext = WindowsIdentity.GetCurrent().Name;//Shows server name when deployed on server //when debuging and running localy shows correctly current user logged in//nametext = HttpContext.Current.Request.ServerVariables[""LOGON_USER""]; // not returning anything <authentication mode=""Forms""><authentication mode=""Windows"">","How I can obtain client hostname, local computer name and user name in c# and asp.net"
Convert.ToInt32 rounds to the nearest even number?," Looking at the msdn documentation for Convert.ToInt32() it states: If value is halfway between two whole numbers, the even number is returned; that is, 4.5 is converted to 4, and 5.5 is converted to 6.http://msdn.microsoft.com/en-us/library/ffdk7eyz.aspxWhy is this? Surely it would be more logical to round to the nearest whole number, wouldn't it? If so, 4.5 would become 5, and 5.5 would become 6, which seems to be more intuitive. <code> ","Why does Convert.ToInt32() round to the nearest even number, instead of nearest whole number?"
Where to convert model to view model?," In my ASP.NET MVC application, I am using unit of work and repository patterns for data access. Using the unit of work class and the repository defined inside it I am fetching the related set of entities in my controller. With my beginner knowledge, I can think of two ways to fetch the business model and convert it to view model.Repository returns the business model to controller, this model than mapped to view model, orRepository itself converts business model to view model and then it is returned to controller. Currently I am using first approach, but my controller code started to look ugly and long for view models with lots of properties.On the other hand, I am thinking, since my repository is called UserRepository (for example), it should be returning the business model directly, instead of some model that is useful only for single view. Which one of these do you think is better practice for large projects ? Is there an alternative way ? <code> ",Where to convert business model to view model?
C# equivalent of Java FileChannel?," I want to stream bytes directly from a TCP socket to a file on disk. In Java, it's possible to use NIO Channels, specifically SocketChannel and FileChannel. Quoting FileChannel#transferFrom(...): This method is potentially much more efficient than a simple loop that reads from the source channel and writes to this channel. Many operating systems can transfer bytes directly from the source channel into the filesystem cache without actually copying them.Obviously I can just write the standard ""copy loop"" to read and write the bytes, and even take advantage of asynchronous I/O to minimize waiting. Will that be comparable to the platform native functionality that Java is taking advantage of, or is there another approach? <code> ",.NET equivalent of Java FileChannel?
C# - One Constructor for a Class and its Nested Classes," For the sake of this example, suppose we're making a dumbed-down game of Clue. We have a class for each Room in the mansion, and subclasses for the Suspect and Weapon in each Room. Something like: Before adding the Suspect and Weapon classes, the Room constructor looked something like: Initializing a room used to be as simple as: Room[i] = new Room(""Conservatory"", 7, 3); - but after the nested classes were introduced, can their initialization be handled through a shared constructor with the main class? Something like: I can't seem to find any examples of a similar setup. How can I accomplish this? <code>  class Room{ public string Name; public int Width; public int Height; // and so on... public class Suspect { public string Name; public bool isPurple; } public class Weapon { public string Name; public bool IsMetal; }} public Room(string Name, int Width, int Height){ this.Name = Name; this.Width = Width; this.Height = Height;} Room[i] = new Room(""Library"", 8, 5, ""Professor Plum"", true, ""Candlestick"", true);",One Constructor for a Class and its Nested Classes
Difference between abstract and protected in my scenario - C#," What is the difference between a public abstract class with a public constructor, and a public class with a protected constructor. We don't have any functions that are abstract in our abstract class, but we want programmers to only be capable of creating objects that extend that class.Both scenarios compile and work, however I don't understand which would be better to use in what scenario. I have been brought up to understand that although you cannot instantiate an abstract class directly (only through a non abstract child class), the abstract class should normally contain abstract functions that are required to be implemented by the children of that class.Wouldn't having a protected constructor in a public class signify that instantiation of this class is not possible (this is the only constructor we have). <code> ",Whats the difference between abstract and protected in my scenario - C#
Sharing Violation On path Error C#," Here is my code: It throws this error: IOException: Sharing violation on path C:\Users\Water Simulation\file_no.txtWhat i'm trying to do is just open a file with log_x.txt name and take the ""x"" from file_no.txt file.If file_no.txt file is empty make log file's name log_1.txt and write ""fileNo + 1"" to file_no.txt.After a new program starts the new log file name must be log_2.txt.But i'm getting this error and i couldn't understand what am i doing wrong.Thanks for help. <code>  public static TextWriter twLog = null;private int fileNo = 1;private string line = null;TextReader tr = new StreamReader(""file_no.txt"");TextWriter tw = new StreamWriter(""file_no.txt"");line = tr.ReadLine();if(line != null){ fileNo = int.Parse(line); twLog = new StreamWriter(""log_"" + line + "".txt"");}else{ twLog = new StreamWriter(""log_"" + fileNo.toString() + "".txt""); }System.IO.File.WriteAllText(""file_no.txt"",string.Empty);tw.WriteLine((fileNo++).ToString());tr.Close();tw.Close();twLog.Close();",Sharing violation IOException while reading and writing to file C#
Sharing Violation on Path Error C#," Here is my code: It throws this error: IOException: Sharing violation on path C:\Users\Water Simulation\file_no.txtWhat i'm trying to do is just open a file with log_x.txt name and take the ""x"" from file_no.txt file.If file_no.txt file is empty make log file's name log_1.txt and write ""fileNo + 1"" to file_no.txt.After a new program starts the new log file name must be log_2.txt.But i'm getting this error and i couldn't understand what am i doing wrong.Thanks for help. <code>  public static TextWriter twLog = null;private int fileNo = 1;private string line = null;TextReader tr = new StreamReader(""file_no.txt"");TextWriter tw = new StreamWriter(""file_no.txt"");line = tr.ReadLine();if(line != null){ fileNo = int.Parse(line); twLog = new StreamWriter(""log_"" + line + "".txt"");}else{ twLog = new StreamWriter(""log_"" + fileNo.toString() + "".txt""); }System.IO.File.WriteAllText(""file_no.txt"",string.Empty);tw.WriteLine((fileNo++).ToString());tr.Close();tw.Close();twLog.Close();",Sharing violation IOException while reading and writing to file C#
Error while reading and writing to file C#," Here is my code: It throws this error: IOException: Sharing violation on path C:\Users\Water Simulation\file_no.txtWhat i'm trying to do is just open a file with log_x.txt name and take the ""x"" from file_no.txt file.If file_no.txt file is empty make log file's name log_1.txt and write ""fileNo + 1"" to file_no.txt.After a new program starts the new log file name must be log_2.txt.But i'm getting this error and i couldn't understand what am i doing wrong.Thanks for help. <code>  public static TextWriter twLog = null;private int fileNo = 1;private string line = null;TextReader tr = new StreamReader(""file_no.txt"");TextWriter tw = new StreamWriter(""file_no.txt"");line = tr.ReadLine();if(line != null){ fileNo = int.Parse(line); twLog = new StreamWriter(""log_"" + line + "".txt"");}else{ twLog = new StreamWriter(""log_"" + fileNo.toString() + "".txt""); }System.IO.File.WriteAllText(""file_no.txt"",string.Empty);tw.WriteLine((fileNo++).ToString());tr.Close();tw.Close();twLog.Close();",Sharing violation IOException while reading and writing to file C#
Does simple windows forms work on windows 8 and windows 8 tablets?," I'm developing a C# .NET business application that needs to work on Windows 7, Windows 8 and Windows 8 Tablet.Do ""simple"" Windows Forms applications work on both Windows 8 desktop and tablet?Is there a Windows 8 Tablet emulator?Are there any alternatives? <code> ",Do simple Windows Forms/WPF apps work on Windows 8 for tablets?
WPF- Timer in wpf," I am a newbie in timer in wpf and I need a code that every 5mins there is a message box will pop up. .can anyone help me for the simple code of timer. That's what I tried so far: <code>  System.Windows.Threading.DispatcherTimer dispatcherTimer = new System.Windows.Threading.DispatcherTimer(); private void test() { dispatcherTimer.Tick += new EventHandler(dispatcherTimer_Tick); dispatcherTimer.Interval = new TimeSpan(0, 0, 1); dispatcherTimer.Start(); } private void dispatcherTimer_Tick(object sender, EventArgs e){ // code goes here } private void button1_Click(object sender, RoutedEventArgs e){ test(); } ",How do I create a timer in WPF?
Check if a table contains duplicate records," I have a datatable with two columns FromDate and ToDate , which are in string format.I want to check if there are any duplicate records in my table.i.e The table contains duplicate records as their date range is mapping for It should return false. <code>  From Date To Date---------------------- 9/01/2012 9/16/2012 8/23/2012 8/24/2012 8/25/2012 8/25/2012 8/5/2012 8/6/2012 8/26/2012 8/27/2012 9/15/2012 9/23/2012 From Date To Date ---------------------- 9/01/2012 9/16/2012 9/15/2012 9/23/2012",Check if a table contains overlapping timespans
What is the best way to store timezones in my DB?," I have a asp.net-mvc web site that i took over and there is a page page where people enter information and times (including local timezone). The database is persisting a start time, an end time and a timezone as it feels a bit flaky to me. here is the code to get the list to choose from: So its simply storing the full string that is returned from TimeZoneInfo.GetSystemTimeZones()Are there any flaws with this approach? I am a bit concerned reading here that this comes locally from the machine as what if different machines have different settings. Also, trying to figure out if everything is listed as UTC or GMT, etc . . Any better suggestions? For example, should i do the conversion to UTC on the website and normalize all of the times in the database? <code>  static private IEnumerable<SelectListItem> GetTimeZones(string selected) { var timeZoneNames = TimeZoneInfo.GetSystemTimeZones() .Where(tz => tz.DisplayName.Contains(""London"") || tz.DisplayName.Contains(""Hong Kong"") || tz.DisplayName.Contains(""Mumbai"") || tz.DisplayName.Contains(""Eastern Time"")) .ConvertAll(tz => tz.DisplayName).ToList(); var items = new List<SelectListItem>(); foreach (var item in timeZoneNames) { var slItem = new SelectListItem(); slItem.Text = item; slItem.Value = item; slItem.Selected = item == selected; items.Add(slItem); } return items; }",What is the best way to store timezone information in my DB?
Opening a File in C# using FIleStream," I am trying to open a Binary file that I plan on converting to hex but I am running into issues with reading the file via FileStream, I am receiving an error saying that the access to the path is denied, any ideas?Now that I have gotten that error taken care of I have ran into another Issue, I can read the binary file, but I want to display it as a Hex file, I'm not sure what I am doing wrong but I'm not getting an output in HEX, it seems to be Int values... <code>  private void button1_Click(object sender, EventArgs e){ openFD.Title = ""Insert a BIN file""; openFD.InitialDirectory = ""C:""; // Chooses the default location to open the file openFD.FileName = "" ""; // Iniitalizes the File name openFD.Filter = ""Binary File|*.bin|Text File|*.txt""; // FIlters the types of files allowed to by chosen if (openFD.ShowDialog() != DialogResult.Cancel) { chosenFile = openFD.FileName; string directoryPath = Path.GetDirectoryName(chosenFile); // Returns the directory and the file name to reference the file string dirName = System.IO.Path.GetDirectoryName(openFD.FileName); // Returns the proper directory with which to refernce the file richTextBox1.Text += dirName; richTextBox1.Text += chosenFile; FileStream InputBin = new FileStream( directoryPath, FileMode.Open, FileAccess.Read, FileShare.None); }} if (openFD.ShowDialog() != DialogResult.Cancel) { chosenFile = openFD.FileName; string directoryPath = Path.GetDirectoryName(chosenFile); string dirName = System.IO.Path.GetDirectoryName(openFD.FileName); using (FileStream stream = new FileStream(chosenFile, FileMode.Open, FileAccess.Read)) { size = (int)stream.Length; data = new byte[size]; stream.Read(data, 0, size); } while (printCount < size) { richTextBox1.Text += data[printCount]; printCount++; }",Opening a File in C# using FileStream
"C# Database DataSource Erorr: ""Cannot Bind to property or Column"""," I'm working on a database in C# when I hit the display button I get an error: Error: Cannot bind to the property or column LastName on the DataSource. Parameter name: dataMemberCode: Not sure what it means can anyone help, if I comment out the last two lines it will display properly. <code>  private void Display_Click(object sender, EventArgs e){ Program.da2.SelectCommand = new SqlCommand(""Select * From Customer"", Program.cs); Program.ds2.Clear(); Program.da2.Fill(Program.ds2); customerDG.DataSource = Program.ds2.Tables[0]; Program.tblNamesBS2.DataSource = Program.ds.Tables[0]; customerfirstname.DataBindings.Add(new Binding(""Text"", Program.tblNamesBS2, ""FirstName"")); customerlastname.DataBindings.Add(new Binding(""Text"", Program.tblNamesBS2, ""LastName"")); //Line Error occurs on.}","DataSource error: ""Cannot Bind to property or Column"""
How to use DataContext.ExecuteCommand and get the executed stored proc return value," In a c# project, I call a stored procedure as follows: However, ExecuteCommand returns the number of rows affected, and not my stored procedure return value. What would be the easiest way to get this value. I need this because the SP returns 0 on success and a positive int value if an error occurred.For now, the stored proc uses RETURN to output its return value. However, I could change this for a SELECT or I could also use an output parameter if required. <code>  System.Data.Linq.DataContext dataContext = MembershipContext.GetContext(connectionString);int returnValue = dataContext.ExecuteCommand(""EXEC usp_SomeProcedure {0}, {1}, {2}"", param1, param2, param3);",How to use DataContext.ExecuteCommand and get the executed stored proc return value?
C# add array to key in web.config," I was wondering if its possible to put an array as a value in a key...example Would that syntax work? <code>  <add key=""email"" value=""emails[""email1@email.com, email2@email.com""] />",Add array to key in web.config
Replace all occurance of a string from a string array," I have a string array like: I would like to replace all ones with zero at once.Then items should be:{""zero"",""two"",""three"",""zero"",""two"",""zero""};I found one solution How do I replace an item in a string array?.But it will replace the first occurrence only. Which is the best method/approach to replace all occurrences? <code>  string [] items = {""one"",""two"",""three"",""one"",""two"",""one""};",Replace all occurences of a string from a string array
How to use C# to find usages?," In Visual Studio, I can right-click a class or method and choose ""Find usages"". That gives me a list of places in my solution where that piece of code is used. How can I do the same from my code? <code> ",How to use C# to find usages of a class or method?
How to use C# to find usages of classes with reflection?," In Visual Studio, I can right-click a class or method and choose ""Find usages"". That gives me a list of places in my solution where that piece of code is used. How can I do the same from my code? <code> ",How to use C# to find usages of a class or method?
C# - How to retreive IP v6 subnet mask length," I'm coding an application that has to get the network adapters configuration on a Windows 7 machine just like it's done in the Windows network adapters configuration panel:So far I can get pretty much all the information I need from NetworkInterface.GetAllNetworkInterfaces() EXCEPT the subnet prefix length.I'm aware that it can be retrieved from the C++ struc PMIB_UNICASTIPADDRESS_TABLE via OnLinkPrefixLength but I'm trying to stay in .net.I also took a look at the Win32_NetworkAdapterConfiguration WMI class but it only seems to return the IP v4 subnet mask.I also know that some information (not the prefix length, as far as I know) are in the registry: I also used SysInternals ProcessMon to try to get anything usefull when saving the network adapter settings but found nothing...So, is there any clean .NET way to get this value? (getting it from the registry wouldn't be a problem)EDIT: GatewaysThis doesn't concern the actual question, but for those who need to retrieve the entire network adapter IPv6 configuration, the IPInterfaceProperties.GatewayAdresses property only supports the IPv4 gateways. As mentionned in the answer comments below, the only way to get the entire info until .NET framework 4.5 is to call WMI. <code>  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\TCPIP6\Parameters\Interfaces\{CLSID}",how to retrieve IP v6 subnet mask length
C# - how to retrieve IP v6 subnet mask length," I'm coding an application that has to get the network adapters configuration on a Windows 7 machine just like it's done in the Windows network adapters configuration panel:So far I can get pretty much all the information I need from NetworkInterface.GetAllNetworkInterfaces() EXCEPT the subnet prefix length.I'm aware that it can be retrieved from the C++ struc PMIB_UNICASTIPADDRESS_TABLE via OnLinkPrefixLength but I'm trying to stay in .net.I also took a look at the Win32_NetworkAdapterConfiguration WMI class but it only seems to return the IP v4 subnet mask.I also know that some information (not the prefix length, as far as I know) are in the registry: I also used SysInternals ProcessMon to try to get anything usefull when saving the network adapter settings but found nothing...So, is there any clean .NET way to get this value? (getting it from the registry wouldn't be a problem)EDIT: GatewaysThis doesn't concern the actual question, but for those who need to retrieve the entire network adapter IPv6 configuration, the IPInterfaceProperties.GatewayAdresses property only supports the IPv4 gateways. As mentionned in the answer comments below, the only way to get the entire info until .NET framework 4.5 is to call WMI. <code>  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\TCPIP6\Parameters\Interfaces\{CLSID}",how to retrieve IP v6 subnet mask length
C# Await operator can only be used within an Async method," I'm trying to make a simple program to test the new .NET async functionality within Visual Studio 2012. I generally use BackgroundWorkers to run time-consuming code asynchronously, but sometimes it seems like a hassle for a relatively simple (but expensive) operation. The new async modifier looks like it would be great to use, but unfortunately I just can't seem to get a simple test going.Here's my code, in a C# console application: I checked out some examples on MSDN and it looks to me like this code should be working, but instead I'm getting a build error on the line containing ""await QueryRover();"" Am I going crazy or is something fishy happening? <code>  static void Main(string[] args){ string MarsResponse = await QueryRover(); Console.WriteLine(""Waiting for response from Mars...""); Console.WriteLine(MarsResponse); Console.Read();}public static async Task<string> QueryRover(){ await Task.Delay(5000); return ""Doin' good!"";}",Await operator can only be used within an Async method
C# Format String to Datetime with Timezone," I have a string s = ""May 16, 2010 7:20:12 AM CDT that i want to convert into a DateTime object. In the code below i get a Date format cannot be converted error when attempting to parse the text with a known format. The timezone comes in as CDT UTC... and i think is whats causing the problem or my format? <code>  timeStamp = matches[0].Groups[1].Value;dt = DateTime.ParseExact(timeStamp, ""MMM dd, yyyy H:mm:ss tt"", null);",Format String to Datetime with Timezone
Adding placeholder text to wpf textbox," I am looking for a way to add placeholder text to a textbox like you can with a textbox in html5. I.e. if the textbox has no text, then it adds the text Enter some text here, when the user clicks on it the placeholder text disappears and allows the user to enter their own text, and if the textbox loses focus and there is still no text then the placeholder is added back to the textbox. <code> ",Adding placeholder text to textbox
Count values in Dictionary using Linq and Linq extensions," I have a dictionary that looks something like this: How can I get a count of all the values using LINQ and LINQ extensions? <code>  Dictionary<String, List<String>>test1 : 1,3,4,5test2 : 2,3,6,7test3 : 2,8",Count values in Dictionary using LINQ and LINQ extensions
c# cannot implement interface member because it does not have the matching return type of List<IInterface>'," I have interfaces IChild and IParent. IParent has a member that is a List<IChild>.I wish to have classes that implement IParent where each class has a member that implements IChild: But, this code will not compile. The error is: <code>  public interface IChild{ } public interface IParent{ List<IChild> a { get; set; }} public class ChildA : IChild{ } public class ChildB : IChild{ } public class ParentA : IParent{ public List<ChildA> a { get; set; }}public class ParentB : IParent{ public List<ChildB> a { get; set; }} `MyApp.Data.ParentA` does not implement interface member `MyApp.Data.IParent.a`.`MyApp.Data.ParentA.a` cannot implement `MyApp.Data.IParent.a` because it does not havethe matching return type of `System.Collections.Generic.List<MyApp.Data.IChild>`.",Cannot implement interface member because it does not have the matching return type of List<IInterface>
cannot implement interface member because it does not have the matching return type of List<IInterface>'," I have interfaces IChild and IParent. IParent has a member that is a List<IChild>.I wish to have classes that implement IParent where each class has a member that implements IChild: But, this code will not compile. The error is: <code>  public interface IChild{ } public interface IParent{ List<IChild> a { get; set; }} public class ChildA : IChild{ } public class ChildB : IChild{ } public class ParentA : IParent{ public List<ChildA> a { get; set; }}public class ParentB : IParent{ public List<ChildB> a { get; set; }} `MyApp.Data.ParentA` does not implement interface member `MyApp.Data.IParent.a`.`MyApp.Data.ParentA.a` cannot implement `MyApp.Data.IParent.a` because it does not havethe matching return type of `System.Collections.Generic.List<MyApp.Data.IChild>`.",Cannot implement interface member because it does not have the matching return type of List<IInterface>
WPF how to detect unresponsive UI updates?," Suppose I have a WPF application where I have the following architecture:[Worker Thread] -> [Queue 1] -> [Queue Manager Thread] -> [Queue 2] -> [UI Thread]The Worker is listening to data from some service and receives that data at indeterminate times (could be multiple times per second or a few times every few seconds) then queues it to Queue 1, then the Queue Manager, depending on the ""health"" of the UI thread may decide to throttle up / down the rate that data items are queued to Queue 2, which the UI thread uses to update the UI, maybe dropping a few items, so as not to overwhelm the UI thread in the event it is receiving too many messages (eg it might decide that it will check the timestamp of each data message and only enqueue it to Queue 2 if the difference between messages is at least 5 seconds older than the last data item the UI updated itself with)The UI thread will have a timer that fires a set-interval to update the UI with new data from Queue 2. What I'd like to be able to do is determine how fast the UI is updating itself to measure it's ""responsiveness"" in order to throttle eg increase / decrease the timer-interval as to how often to update the UISuppose my UI had lots of controls (grids, charts etc) all bound to different filtered / grouped subsets of the data on Queue 2 in my UI shell and the UI starts becoming unresponsive and freeze between updates when updating those controls, how could I detect this from code in order to know how / when to increase / decrease the interval for UI updates? Basically, how do I measure how long it takes to rebind the entire UI across all controls bound to the data?BTW is this a good design or could it be improved? Are there any other strategies I could consider? <code> ",How to detect unresponsive UI updates?
C# NumericUpDown Allows User To Type A Number Greater Than Maximum, I have a NumericUpDown variable in my class. The minimum and maximum values are set as follows: This prevents the spin box from exceeding 9999 or going below 0.The problem I am having is when the user types inside the text box they can type any arbitrary number greater than Maximum or less than Minimum.Is there a property in the NumericUpDown class that controls the minimum and maximum values for the text box? Or do I have to write a callback procedure that checks for this condition? <code>  myNumericUpDown.Maximum = 9999;myNumericUpDown.Minimum = 0;,NumericUpDown allows user to type a number greater than maximum
NumericUpDown Allows User To Type A Number Greater Than Maximum, I have a NumericUpDown variable in my class. The minimum and maximum values are set as follows: This prevents the spin box from exceeding 9999 or going below 0.The problem I am having is when the user types inside the text box they can type any arbitrary number greater than Maximum or less than Minimum.Is there a property in the NumericUpDown class that controls the minimum and maximum values for the text box? Or do I have to write a callback procedure that checks for this condition? <code>  myNumericUpDown.Maximum = 9999;myNumericUpDown.Minimum = 0;,NumericUpDown allows user to type a number greater than maximum
C# simple way to copy or clone a DataRow?," I'm looking for a simple way to make a clone of a DataRow. Kind of like taking a snapshot of that Row and saving it. The values of original Row are then free to change but we still have another saved copy which doesn't change. Is this the correct way to do it? Will this just set Snapshot's ItemArray reference to point to the one in Source or does it actually make a separate copy? Should I do this instead? EDIT: I don't think the second code snippet actually compiles. <code>  DataRow Source, Destination;// Assume we create some columns and fill them with valuesDestination.ItemArray = Source.ItemArray; Destination.ItemArray = Source.ItemArray.Clone();",Simple way to copy or clone a DataRow?
Consuming ColdFusion webservice from C#?," I'm trying to use a webservice with the endpoint https://services.example.com/ASP_SecureWebServices.cfc?wsdl.In the documentation I have this:Request Authenticated Response Ive never used ColdFusion before, so I dont understand how to make the request. Can anyone assist?Ive added a service reference like this:But I dont get this method: <code>  <authorise> <site>xxx</site> <login>xxx</login> <password>xxx</password> <partnerid>xxx</partnerid> <wstype>xpt_exhibitors</wstype></authorise> <authorisation> <service>getAuthToken</service> <authorised>OK</authorised> <authtoken>255461</authtoken></authorisation>",How do I consume a ColdFusion webservice from C#?
C#: Selecting an item from AutoComplete suggestion list raises KeyDown-event with ENTER key," In Winforms I have a textbox with AutoCompleteMode set to SuggestAppend and a AutoCompleteCustomSource set. When the user types some letters the suggestion list is shown. If an item of this list is selected by clicking it with the mouse, the KeyDown-event of the form containing the textbox is raised for the ENTER key.Is there any possibility to NOT raise this event when selecting a suggested item with the mouse? <code> ",Selecting an item from AutoComplete suggestion list raises KeyDown-event with ENTER key
left outer join in lambda syntax Linq," Possible Duplicate: How do you perform a left outer join using linq extension methods I can't find a left outer join example of Linq lambda (with extension methods), at least, not a clear one.Let's say I have the following table: I want to join Parent with Child, and for every child missing, I want the default value for Text to be ""[[Empty]]"". How can I do this with linq lambda syntax?I currently have the following: <code>  Parent{ PID // PK}Child{ CID // PK PID // FK Text} var source = lParent.GroupJoin( lChild, p => p.PID, c => c.PID, (p, g) => new // ParentChildJoined { PID = p.PID; // How do I add child values here? });",left outer join in lambda/method syntax in Linq
I Can't find the control - ASP.Net," I have two methods. The first creates one table dynamically, and I add that table into a PlaceHolder. If I do .FindControl(""..."") inside this method I can find the control using: It's OK, but not what I pretend.In the second method, I want to check whether the user checked checkBox and did something, but I can't find the control (it always returns null). Also, if I try to find the control ""table1"", I get null.Why does this happen? <code>  private void generateData(){ Table tbl = new Table(); tbl.ID = ""table1""; holder_info.Controls.Add(tbl); // ...adding tr's and td's.... // ...adding CheckBox in tds....} CheckBox check = (CheckBox)holder_info.FindControl(""checkbox1""); protected void saveInfo_Click(object sender, ImageClickEventArgs e){ CheckBox check = (CheckBox)holder_info.FindControl(""checkbox1""); if(check.checked){ ... }}",.FindControl always returns null
C# Sort files by name," I have files in directory like that ....when i loading files: They getting in wrong order (they should go like above): How to fix that?I was trying to sort them but no way: <code>  0-0.jpeg0-1.jpeg0-5.jpeg0-9.jpeg0-10.jpeg0-12.jpeg FileInfo[] files = di.GetFiles(); 0-0.jpeg0-1.jpeg0-10.jpeg0-12.jpeg0-5.jpeg0-9.jpeg 1) Array.Sort(files, (f1, f2) => f1.Name.CompareTo(f2.Name));2) Array.Sort(files, (x, y) => StringComparer.OrdinalIgnoreCase.Compare(x.Name, y.Name)); ",C# Sort files by natural number ordering in the name?
Do Code First classes need foreign object references?," I have some domain classes that look something like this, that I want to model with Code First (in EF 4.3). In every example I see though, foreign object references are added in the Foo class. Can my Foo class be agnostic of the Bar and Baz class, or do I really need to do something like this? According to this answer, classes do need to have navigation properties. I'm new at Code First, so can anyone explain why this might be the case? Is there a way I can avoid polluting my Foo class like this by using the Fluent API?It seems weird to me that Foo would need to know about every class that uses it. Is my design simply fundamentally flawed in some way? <code>  public class Foo { // ...}public class Bar { // ... public Foo Foo { get; set; }}public class Baz { // ... public Foo Foo { get; set; }} public class Foo { // ... public virtual Bar { get; set; } public virtual Baz { get; set; }}",Why do Code First classes need navigation properties?
C# Convert Struct to JSON," I have a struct, I want to convert it to JSON and save it as local file.I couldn't find any source that explain how to convert a C# struct into a JSON.I am using a console application for that, not a webservice/web, etc. <code> ",Convert Struct to JSON
How to validate formate for string.Format method," string.Format has following method signature I want to pass custom format each time like I want to validate the value in custFormat before passing to ProcessMessage to avoid exception. <code>  string.Format(format, params, .., .. , ..); string custFormat = ""Hi {0} ... {n} ""; // I only care about numbers here, and want avoid {abdb}string name = ""Foo"";string message = ProcessMessage(custFormat, name);public string ProcessMessage(custFormat, name){ return string.Format(custFormat, name);}",How to validate format for string.Format method
"LINQ to Entities does not recognize the method 'Int32 Parse(System.String)' method, and this method cannot be translated into a store expression"," I have the following LINQ expression. I want calculate the sum of numeric values in an nvarchar field. I'm using following code to do this, but I get an error when I try to run this. Error Description: LINQ to Entities does not recognize the method 'Int32 Parse(System.String)' method, and this method cannot be translated into a store expression How can I solve this problem and write this code better than this?I changed the code to this: but got this error: <code>  var m = new MaterialModelContainer();var list = (from x in ( from inv in m.INVs join l in m.LIBs on inv.MESC equals l.MESC join o in m.OUTs on inv.MESC equals o.MESC join t in m.TRANs on inv.MESC equals t.MESC where t.TYPE == ""60"" select new { l.MESC, l.LINE_NO, l.UNIT_LINE, Description = l.DES + "" "" + l.PART_NO, inv.NEW_QTY, o.PJ, o.DATE, o.QTY, o.QTY_REC, TranQty = t.QTY, tranDate = t.DATE } ) group x by new { x.MESC, x.LINE_NO, x.UNIT_LINE, x.Description, x.NEW_QTY, x.PJ, x.DATE, x.QTY, x.QTY_REC } into g select new { QTY_Consum_1 = g.Where(c => int.Parse(c.tranDate) >= cuDate && int.Parse(c.tranDate) <= endDate).Sum(d => int.Parse(d.TranQty)) } ).ToList(); select new{ QTY_Consum_1 = g.Where(c => SqlFunctions.StringConvert(c.tranDate) >= cuDate && SqlFunctions.StringConvert(c.tranDate) <= endDate).Sum(d => SqlFunctions.StringConvert(d.TranQty)), g.Key.MESC}).ToList();",Int.Parse in Linq Expression
How to read text files with ANSI encoding and non english letters," I have a file that contains non-English chars and was saved in ANSI encoding using a non-English codepage. How can I read this file in C# and see the file content correctly?Not working Working but I need to know what is the code page in advance, which is not possible. <code>  StreamReader sr=new StreamReader(@""C:\APPLICATIONS.xml"",Encoding.ASCII);var ags = sr.ReadToEnd();sr=new StreamReader(@""C:\APPLICATIONS.xml"",Encoding.UTF8);ags = sr.ReadToEnd();sr=new StreamReader(@""C:\APPLICATIONS.xml"",Encoding.Unicode);ags = sr.ReadToEnd(); sr=new StreamReader(@""C:\APPLICATIONS.xml"",Encoding.GetEncoding(1252));ags = sr.ReadToEnd();",How to read text files with ANSI encoding and non-English letters?
ORA-03135 when inserting large file," I'm trying to do an insert with a potentially large amount of binary data into a remote Oracle (11g) database using Entity Framework (ODP.Net). It works fine for really small files (<5 KB), but for larger ones (e.g. 44 KB) I get an error: ""ORA-03135: connection lost contact"".I don't think it's timing out, as the exception occurs within a second of executing the command.I tried setting both of the following in my connection string, but to no avail:Validate Connection=truePooling=falseI also looked in the listener.log file on the remote machine. It shows the connections being made, but no sign of exceptions or terminated connections.I'm up for suggested fixes or troubleshooting methods.Edit:The same SQL operations work when accessing an Oracle instance on the local network. <code> ","""ORA-03135: connection lost contact"" when inserting large file"
Windows 8 Metro ListView - can't eliminate padding/margin between Tiles (C#/XAML)," I'm trying to build two ListView objects within a StackPanel and have all of the ItemTemplate Tiles ""touch"" each other (meaning no margin or padding within the ListViews). It seems that Windows 8 Metro has some sort of built-in padding/margin. My question: How do I remove these or set them to 0?Here is my code: My ItemTemplate is: ...and it renders the following: <code>  <StackPanel x:Name=""teesSP"" HorizontalAlignment=""Left"" Orientation=""Horizontal"" VerticalAlignment=""Top"" > <ListView x:Name=""timesLV1"" SelectionMode=""Multiple"" SelectionChanged=""timesLV_Click"" ItemTemplate=""{StaticResource TimeTileTemplate}""> <ListView.ItemContainerStyle> <Style TargetType=""ListViewItem""> <Setter Property=""Padding"" Value=""0""/> <Setter Property=""Margin"" Value=""0""/> </Style> </ListView.ItemContainerStyle> </ListView> <ListView x:Name=""timesLV2"" SelectionMode=""Multiple"" SelectionChanged=""timesLV_Click"" ItemTemplate=""{StaticResource TimeTileTemplate}""> <ListView.ItemContainerStyle> <Style TargetType=""ListViewItem""> <Setter Property=""Padding"" Value=""0""/> <Setter Property=""Margin"" Value=""0""/> </Style> </ListView.ItemContainerStyle> </ListView></StackPanel> <DataTemplate x:Key=""TimeTileTemplate""> <Grid HorizontalAlignment=""Center"" Background=""White"" > <Border BorderBrush=""Black"" BorderThickness=""2"" > <StackPanel Margin=""0,0,0,0"" Orientation=""Horizontal"" Width=""130"" Height=""60"" VerticalAlignment=""Center"" > <TextBlock Margin=""2,0,0,0"" TextWrapping=""Wrap"" Style=""{StaticResource ItemSubtitleStyle}"" VerticalAlignment=""Center"" HorizontalAlignment=""Left"" Text=""{Binding startTime}"" Width=""70"" /> <TextBlock TextWrapping=""Wrap"" Style=""{StaticResource ItemTitleStyle}"" VerticalAlignment=""Center"" HorizontalAlignment=""Right"" Text=""{Binding startHole}"" Width=""40"" /> </StackPanel> </Border> </Grid></DataTemplate>",Can't eliminate padding/margin between Tiles in Windows 8 Metro 'ListView'
Windows 8 Metro ListView - can't eliminate padding/margin between Tiles," I'm trying to build two ListView objects within a StackPanel and have all of the ItemTemplate Tiles ""touch"" each other (meaning no margin or padding within the ListViews). It seems that Windows 8 Metro has some sort of built-in padding/margin. My question: How do I remove these or set them to 0?Here is my code: My ItemTemplate is: ...and it renders the following: <code>  <StackPanel x:Name=""teesSP"" HorizontalAlignment=""Left"" Orientation=""Horizontal"" VerticalAlignment=""Top"" > <ListView x:Name=""timesLV1"" SelectionMode=""Multiple"" SelectionChanged=""timesLV_Click"" ItemTemplate=""{StaticResource TimeTileTemplate}""> <ListView.ItemContainerStyle> <Style TargetType=""ListViewItem""> <Setter Property=""Padding"" Value=""0""/> <Setter Property=""Margin"" Value=""0""/> </Style> </ListView.ItemContainerStyle> </ListView> <ListView x:Name=""timesLV2"" SelectionMode=""Multiple"" SelectionChanged=""timesLV_Click"" ItemTemplate=""{StaticResource TimeTileTemplate}""> <ListView.ItemContainerStyle> <Style TargetType=""ListViewItem""> <Setter Property=""Padding"" Value=""0""/> <Setter Property=""Margin"" Value=""0""/> </Style> </ListView.ItemContainerStyle> </ListView></StackPanel> <DataTemplate x:Key=""TimeTileTemplate""> <Grid HorizontalAlignment=""Center"" Background=""White"" > <Border BorderBrush=""Black"" BorderThickness=""2"" > <StackPanel Margin=""0,0,0,0"" Orientation=""Horizontal"" Width=""130"" Height=""60"" VerticalAlignment=""Center"" > <TextBlock Margin=""2,0,0,0"" TextWrapping=""Wrap"" Style=""{StaticResource ItemSubtitleStyle}"" VerticalAlignment=""Center"" HorizontalAlignment=""Left"" Text=""{Binding startTime}"" Width=""70"" /> <TextBlock TextWrapping=""Wrap"" Style=""{StaticResource ItemTitleStyle}"" VerticalAlignment=""Center"" HorizontalAlignment=""Right"" Text=""{Binding startHole}"" Width=""40"" /> </StackPanel> </Border> </Grid></DataTemplate>",Can't eliminate padding/margin between Tiles in Windows 8 Metro 'ListView'
Place holder in TextBox window 8," I want to show a placeholder text in TextBox when user hasn't typed anything and TextBox is idle.In Andriod it can be done using android:hint=""some Text""In iPhone it can be done as textFild.placeholder = ""some text"";How can I do it in windows 8 metro apps?Thanks <code> ",Place holder or watermark in TextBox windows 8
"In WPF, is there a way to make a StackPanel with aligned columns like a Grid?"," For example I could do something like this: Or I could do something like this: Except that I want to be able to easily manipulate the rows (add new rows, move rows around, etc.) just like in the StackPanel, while keeping the columns aligned properly just like in the Grid. <code>  <Grid> <Grid.ColumnDefinitions> <ColumnDefinition Width=""*"" /> <ColumnDefinition Width=""Auto"" /> <ColumnDefinition Width=""Auto"" /> <ColumnDefinition Width=""Auto"" /> </Grid.ColumnDefinitions> <Grid.RowDefinitions> <RowDefinition Width=""Auto""> <RowDefinition Width=""Auto""> <RowDefinition Width=""Auto""> </Grid.RowDefinitions> <TextBlock Grid.Row=""0"" Grid.Column=""0"">Header 1</TextBlock> <TextBox Grid.Row=""0"" Grid.Column=""1"" MaxLines=""1"" /> <Button Grid.Row=""0"" Grid.Column=""2"">Send</Button> <Button Grid.Row=""0"" Grid.Column=""3"">Save</Button> <TextBlock Grid.Row=""1"" Grid.Column=""0"">Header 2</TextBlock> <TextBox Grid.Row=""1"" Grid.Column=""1"" MaxLines=""1"" /> <Button Grid.Row=""1"" Grid.Column=""2"">Send</Button> <Button Grid.Row=""1"" Grid.Column=""3"">Save</Button> <TextBlock Grid.Row=""2"" Grid.Column=""0"">Header 3</TextBlock> <TextBox Grid.Row=""2"" Grid.Column=""1"" MaxLines=""1"" /> <Button Grid.Row=""2"" Grid.Column=""2"">Send</Button> <Button Grid.Row=""2"" Grid.Column=""3"">Save</Button></Grid> <StackPanel> <StackPanel Orientation=""Horizontal""> <TextBlock>Header 1</TextBlock> <TextBox MaxLines=""1"" /> <Button>Send</Button> <Button>Save</Button> </StackPanel> <StackPanel Orientation=""Horizontal""> <TextBlock>Header 2</TextBlock> <TextBox MaxLines=""1"" /> <Button>Send</Button> <Button>Save</Button> </StackPanel> <StackPanel Orientation=""Horizontal""> <TextBlock>Header 3</TextBlock> <TextBox MaxLines=""1"" /> <Button>Send</Button> <Button>Save</Button> </StackPanel><StackPanel>",Is there a way to make a StackPanel with aligned columns like a Grid?
Curly braces auto complete in Visual Studio 2012, Just migrated from vs10 to vs12 and it seems like the curly braces is completely broken along side with some other features like indentation in C# (?)for example type: In visual studio 10 it would automatically add the closing curly brace for it.Is there some power tool or something that can fix this and give the same behavior? the Brace Completer requires to hit Enter after the function for it to add the closing braces.Also in tools->options->text-editor->c#->formatting-> automatically format completed block on }is turned on by default.. <code>  public static void myFunc() {,Curly braces autocomplete in Visual Studio 2012
Curly braces autocomplete in Visual Studio 2012, Just migrated from vs10 to vs12 and it seems like the curly braces is completely broken along side with some other features like indentation in C# (?)for example type: In visual studio 10 it would automatically add the closing curly brace for it.Is there some power tool or something that can fix this and give the same behavior? the Brace Completer requires to hit Enter after the function for it to add the closing braces.Also in tools->options->text-editor->c#->formatting-> automatically format completed block on }is turned on by default.. <code>  public static void myFunc() {,Curly braces autocomplete in Visual Studio 2012
"How do I ""go to definition"" for the overloaded bracket operator in Visual Studio"," I work with a codebase where several classes implement an indexer: When I stumble over code like foo[1,2] = 3 in visual Studio 2008, I frequently want toright-click / ""go to definition"", i.e. show the above definition in the visual studio editor window.For normal properties or methods this works without problems:foo.bar = 3, right-click / ""go to definition"" takes me to the source code for foo.bar.For overloaded + or == this works as well.However with the indexer this does not seem to work. Is there any way to accomplish this?(I cannot even search for the string ""this["" in the appropriate source file, since the same syntax may be used throughout the class to access the indexer. I always have to scroll trough all the methods and properties in the dropdown list for this file) <code>  public double this[int i, int j]{ get { return ...; } set { ...; }}","How do I ""go to definition"" for the indexer `this[]` in Visual Studio"
"How do I ""go to definition"" for the indexer this[] in Visual Studio"," I work with a codebase where several classes implement an indexer: When I stumble over code like foo[1,2] = 3 in visual Studio 2008, I frequently want toright-click / ""go to definition"", i.e. show the above definition in the visual studio editor window.For normal properties or methods this works without problems:foo.bar = 3, right-click / ""go to definition"" takes me to the source code for foo.bar.For overloaded + or == this works as well.However with the indexer this does not seem to work. Is there any way to accomplish this?(I cannot even search for the string ""this["" in the appropriate source file, since the same syntax may be used throughout the class to access the indexer. I always have to scroll trough all the methods and properties in the dropdown list for this file) <code>  public double this[int i, int j]{ get { return ...; } set { ...; }}","How do I ""go to definition"" for the indexer `this[]` in Visual Studio"
How should I write the .i file to wrap callbacks in java or C#," My C program uses callback functions which are periodically called. I want to be able to handle the callback functions in a Java or C# program. How should I write the .i file to achieve this? The C callback looks so: <code>  static void on_incoming_call(pjsua_acc_id acc_id, pjsua_call_id call_id, pjsip_rx_data *rdata)",How should I write the .i file to wrap callbacks in Java or C#
Can two different Controll  access a single View in mvc?, I have two different controllers and I want both of them to use a Common View.Is that possible?Thanks in advance!!!! <code> ,Can two different controllers access a single view in mvc?
Cannot insert data into MS SQL," What the problem on my coding? I cannot insert data to ms sql.. I'm using C# as front end and MS SQL as databases... <code>  name = tbName.Text;userId = tbStaffId.Text;idDepart = int.Parse(cbDepart.SelectedValue.ToString());string saveStaff = ""INSERT into tbl_staff (staffName,userID,idDepartment) "" + "" VALUES ('"" + name + ""', '"" + userId +""', '"" + idDepart + ""');"";SqlCommand querySaveStaff = new SqlCommand(saveStaff);try{querySaveStaff.ExecuteNonQuery();}catch{//Error when save dataMessageBox.Show(""Error to save on database"");openCon.Close();Cursor = Cursors.Arrow;}",How to insert data into SQL Server
Cannot insert data into SQL Server," What the problem on my coding? I cannot insert data to ms sql.. I'm using C# as front end and MS SQL as databases... <code>  name = tbName.Text;userId = tbStaffId.Text;idDepart = int.Parse(cbDepart.SelectedValue.ToString());string saveStaff = ""INSERT into tbl_staff (staffName,userID,idDepartment) "" + "" VALUES ('"" + name + ""', '"" + userId +""', '"" + idDepart + ""');"";SqlCommand querySaveStaff = new SqlCommand(saveStaff);try{querySaveStaff.ExecuteNonQuery();}catch{//Error when save dataMessageBox.Show(""Error to save on database"");openCon.Close();Cursor = Cursors.Arrow;}",How to insert data into SQL Server
Visual c# and excel deleting rows," I want to write from my form (in C#) to an excel spread sheet and delete certain rows if blank.I can write perfectly fine to a speadsheet and save it, but lets say the user entered data into row a1, a2, a3, and a4, I now want to delete all the rows in between a4 and a29. All I need is to find out how to delete a certain range of cells. Thanks <code> ",C# and excel deleting rows
c# selecting a drop down option from webbrowser," My goal I need to select the second option.I've tried following approach and can't set selected value. No error shows up, the selection just doesn't happen. Being very familiar with HTML myself, I know that ""selected"" and 'selected=""selected""' work but not sure why it's not working with my C# code. What could be wrong? The HTML is <code>  webBrowser1.Document.GetElementById(""field_gender1""). Children[1].SetAttribute(""selected"", ""selected""); <select name=""gender1"" id=""field_gender1"" class=""select""> <option selected=""selected"" value=""1"">val1</option> <option value=""2"">val2</option></select>",Selecting a dropdown option from webbrowser
Make MediaElement Support More Video Codecs," Is there a way to make MediaElement support more video codecs like mkv, flv, mov etc.? If not, is there any other control that supports more video codecs? <code> ",Make MediaElement support more video codecs
Make MediaElement to support more video codecs," Is there a way to make MediaElement support more video codecs like mkv, flv, mov etc.? If not, is there any other control that supports more video codecs? <code> ",Make MediaElement support more video codecs
"how to resolve ""Input string was not in a correct format."" error?"," What I tried:MarkUP: Code Behind: After running the page on a browser, I get the System.FormatException: Input string was not in a correct format. <code>  <asp:TextBox ID=""TextBox2"" runat=""server""></asp:TextBox> <asp:Label ID=""Label1"" runat=""server"" AssociatedControlID=""TextBox2"" Text=""Label""></asp:Label> <asp:SliderExtender ID=""SliderExtender1"" TargetControlID=""TextBox2"" BoundControlID=""Label1"" Maximum=""200"" Minimum=""100"" runat=""server""> </asp:SliderExtender> protected void setImageWidth(){ int imageWidth; if (Label1.Text != null) { imageWidth = 1 * Convert.ToInt32(Label1.Text); Image1.Width = imageWidth; }}","How to resolve ""Input string was not in a correct format."" error?"
Fastest way to access attributes C# .net," I am working on a framework that uses some Attribute markup. This will be used in an MVC project and will occur roughly every time I view a specific record in a view (eg /Details/5)I was wondering if there is a better/more efficient way to do this or a good best practices example.At any rate, I have an a couple of attributes e.g: What is the most efficient way/best practice to look for these attributes/Act on their values?I am currently doing something like this: And in my method where I act on these attributes(simplified example!):  <code>  [Foo(""someValueHere"")]String Name {get;set;}[Bar(""SomeOtherValue""]String Address {get;set;} [System.AttributeUsage(AttributeTargets.Property)]class FooAttribute : Attribute{ public string Target { get; set; } public FooAttribute(string target) { Target = target; }} public static void DoSomething(object source){ //is it faster if I make this a generic function and get the tpe from T? Type sourceType = source.GetType(); //get all of the properties marked up with a foo attribute var fooProperties = sourceType .GetProperties() .Where(p => p.GetCustomAttributes(typeof(FooAttribute), true) .Any()) .ToList(); //go through each fooproperty and try to get the value set foreach (var prop in fooProperties) { object value = prop.GetValue(source, null); // do something with the value prop.SetValue(source, my-modified-value, null); } }",Best way to access attributes
Fastest way to access attributes," I am working on a framework that uses some Attribute markup. This will be used in an MVC project and will occur roughly every time I view a specific record in a view (eg /Details/5)I was wondering if there is a better/more efficient way to do this or a good best practices example.At any rate, I have an a couple of attributes e.g: What is the most efficient way/best practice to look for these attributes/Act on their values?I am currently doing something like this: And in my method where I act on these attributes(simplified example!):  <code>  [Foo(""someValueHere"")]String Name {get;set;}[Bar(""SomeOtherValue""]String Address {get;set;} [System.AttributeUsage(AttributeTargets.Property)]class FooAttribute : Attribute{ public string Target { get; set; } public FooAttribute(string target) { Target = target; }} public static void DoSomething(object source){ //is it faster if I make this a generic function and get the tpe from T? Type sourceType = source.GetType(); //get all of the properties marked up with a foo attribute var fooProperties = sourceType .GetProperties() .Where(p => p.GetCustomAttributes(typeof(FooAttribute), true) .Any()) .ToList(); //go through each fooproperty and try to get the value set foreach (var prop in fooProperties) { object value = prop.GetValue(source, null); // do something with the value prop.SetValue(source, my-modified-value, null); } }",Best way to access attributes
LINQ - nestled where clause," I have a problem with a project. Im trying to get a list of companies, but only filter those companies that are located in Stockholm.Table structure Now what I first do is a query: Which gets the full list of companies and having their Corresponding Addresses (which can be multiple), so the results looks like this:So my question is: how can I filter depending on what one of the nestled elements under CorrespondingAddress is? City for example?So far I tried But none of them works. Thanks! <code>  **Company**:CompanyIDCompanyNameetc**CompanyAddressDetails** (relation table):Company_CompanyIDCorrespondingAddress_AddressID**CorrespondingAddress**:AddressIDStreetNameCityetc var companyModel = from c in db.Company select c; companyModel = companyModel.Where(s => s.CorrespondingAddress.Where(x => x.City.Equals(""Stockholm"")));companyModel = companyModel.Where(s => s.CorrespondingAddress.ToList().First().Address.Equals(""Stockholm""));",LINQ - nested where clause
C# Double.TryParse thousand seperator returns unexpected result," I just ran into something very strange, and was just wondering if I was missing something.I was trying to parse a string (with thousand separators) into a double, and found the below issue. Now the reason why I didnt just want to use Convert.ToDouble is due to scientific notation which has given me some problems before.Does anybody know why this might be?EDIT:I have update my current culture info. <code>  CultureInfo ci = CultureInfo.CurrentCulture; // en-ZAstring numberGroupSeparator = CultureInfo.CurrentCulture.NumberFormat.NumberGroupSeparator; //numberGroupSeparator = ,string numberDecimalSeparator = CultureInfo.CurrentCulture.NumberFormat.NumberDecimalSeparator;//numberDecimalSeparator = .string strValue = ""242,445.24"";double try1;double try2;bool btry1 = Double.TryParse(strValue, out try1); //try1 = 242445.24 : btry1 = truebool btry2 = Double.TryParse(strValue, NumberStyles.Any, null, out try2); //try2 = 0.0 : btry2 = false <- STRANGEdouble try3 = Convert.ToDouble(strValue); //try3 = 242445.24",Double.TryParse thousand separator returns unexpected result
Double.TryParse thousand seperator returns unexpected result," I just ran into something very strange, and was just wondering if I was missing something.I was trying to parse a string (with thousand separators) into a double, and found the below issue. Now the reason why I didnt just want to use Convert.ToDouble is due to scientific notation which has given me some problems before.Does anybody know why this might be?EDIT:I have update my current culture info. <code>  CultureInfo ci = CultureInfo.CurrentCulture; // en-ZAstring numberGroupSeparator = CultureInfo.CurrentCulture.NumberFormat.NumberGroupSeparator; //numberGroupSeparator = ,string numberDecimalSeparator = CultureInfo.CurrentCulture.NumberFormat.NumberDecimalSeparator;//numberDecimalSeparator = .string strValue = ""242,445.24"";double try1;double try2;bool btry1 = Double.TryParse(strValue, out try1); //try1 = 242445.24 : btry1 = truebool btry2 = Double.TryParse(strValue, NumberStyles.Any, null, out try2); //try2 = 0.0 : btry2 = false <- STRANGEdouble try3 = Convert.ToDouble(strValue); //try3 = 242445.24",Double.TryParse thousand separator returns unexpected result
ASP.NET MVC ActionLink : why a # character is added to the url?," I have a simple page displaying thumbnail list ,I want to to add a pager , i have added two action links when i click on the link i'm redirected to instead of does anyone know why the '#' character is added to the URL ?Route copnfig : <code>  <li class=""ui-pagination-next"">@Html.ActionLink(""Next"", ""Paginate"", ""Home"", new { nbSkip = ViewBag.nextSkip }, null)</li> http://localhost:41626/#/Home/Paginate?nbSkip=60 http://localhost:41626/Home/Paginate?nbSkip=60 , public class RouteConfig{ public static void RegisterRoutes(RouteCollection routes) { routes.IgnoreRoute(""{resource}.axd/{*pathInfo}""); routes.MapRoute( name: ""Default"", url: ""{controller}/{action}/{id}"", defaults: new { controller = ""Home"", action = ""Index"", id = UrlParameter.Optional } ); }}", why a # character is added to the url?
Entity Framwork with Oracle ODP generates Number(5) as short instead of int, We are using Entity Framework database-first for our Oracle database.For some reason Number(5) becomes Int16 - shortMax Number(5) value is 99999Max Int16 value is 32767Problem... is there a way to instruct the mapper to translate Number(5) to int32? <code> ,Entity Framework generates short instead of int
Entity Framwork generates short instead of int, We are using Entity Framework database-first for our Oracle database.For some reason Number(5) becomes Int16 - shortMax Number(5) value is 99999Max Int16 value is 32767Problem... is there a way to instruct the mapper to translate Number(5) to int32? <code> ,Entity Framework generates short instead of int
Relaod page in metro app C#," I'm developing metro app using Windows 8 RTM and C#(VS 2012 RTM), I'm stuck with page reload,Can any one explains me how to reload page with out navigating to same page again.Brief: I'm developing metro app with multilingual support. When user selects the language I'm overriding primary language by below code and reload the page by using this code Language changed to ""de"",But when i press ""Back"" on page its navigating same page instead of navigating to previous page.Did i miss something, Can someone please explains me how to do this. Thanks in advance <code>  Windows.Globalization.ApplicationLanguages.PrimaryLanguageOverride = ""de""; this.Frame.Navigate(this.GetType());",Reload page in metro app C#
Reload page in metro app C#," I'm developing metro app using Windows 8 RTM and C#(VS 2012 RTM), I'm stuck with page reload,Can any one explains me how to reload page with out navigating to same page again.Brief: I'm developing metro app with multilingual support. When user selects the language I'm overriding primary language by below code and reload the page by using this code Language changed to ""de"",But when i press ""Back"" on page its navigating same page instead of navigating to previous page.Did i miss something, Can someone please explains me how to do this. Thanks in advance <code>  Windows.Globalization.ApplicationLanguages.PrimaryLanguageOverride = ""de""; this.Frame.Navigate(this.GetType());",Reload page in metro app C#
WPF MVVM: Bind button in DataTemplate to command in the form's ViewModel," My problem is similar to the one described in this question:WPF MVVM Button Control Binding in DataTemplateHere is my XAML: It's just a ListBox, bound to an ObservableCollection<string> named CommandSets (which is in the ViewModel).This binding works (it displays a button for each item in the collection).Now I want to bind the button to a command (FireCommand), which is also in the ViewModel.Here's the relevant part of the ViewModel: The binding of this button does NOT work.From what I've understood from the question I linked above, the binding doesn't work because:(correct me if I'm wrong)The button is inside the ListBox, so it only ""knows"" the binding of the ListBox (the ObservableCollection, in this case), but not the binding of the main windowI'm trying to bind to a command in the main ViewModel of the main window (which the button doesn't ""know"")The command itself is definitely correct, because when I put the button outside the ListBox (see the XAML above for an example), the binding works and the command is executed. Apparently, I ""just"" need to tell the button to bind to the main ViewModel of the form.But I'm not able to figure out the right XAML syntax.I tried several approaches that I found after some googling, but none of them worked for me: Could someone please:give me the proper XAML to bind the button inside the ListBox to a command in the form's MainViewModel?point me to a link where this advanced binding stuff is explained in a way that a WPF/MVVM beginner can understand?I'm feeling like I'm just copying and pasting arcane XAML incantations, and so far I don't have any clue (and can't find any good documentation) how I would figure out by myself in which cases I'd need RelativeSource or StaticResource or whatever instead of a ""normal"" binding. <code>  <Window x:Class=""MissileSharp.Launcher.MainWindow"" xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" Title=""MissileSharp Launcher"" Height=""350"" Width=""525""> <Grid> <!-- when I put the button here (outside the list), the binding works --> <!--<Button Content=""test"" Command=""{Binding Path=FireCommand}"" />--> <ListBox ItemsSource=""{Binding CommandSets}""> <ListBox.ItemTemplate> <DataTemplate> <!-- I need the button here (inside the list), and here the binding does NOT work --> <Button Content=""{Binding}"" Command=""{Binding Path=FireCommand}"" /> </DataTemplate> </ListBox.ItemTemplate> </ListBox> </Grid></Window> public class MainWindowViewModel : INotifyPropertyChanged{ public ICommand FireCommand { get; set; } public ObservableCollection<string> CommandSets { get; set; } public MainWindowViewModel() { this.FireCommand = new RelayCommand(new Action<object>(this.FireMissile)); } private void FireMissile(Object obj) { System.Windows.MessageBox.Show(""fire""); }} <Button Content=""{Binding}"" Command=""{Binding RelativeSource={RelativeSource Window}, Path=DataContext.FireCommand}"" /><Button Content=""{Binding}"" Command=""{Binding Path=FireCommand, Source={StaticResource MainWindow}}"" /><Button Content=""{Binding}"" Command=""{Binding Path=FireCommand, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"" />",Bind button in DataTemplate to command in the form's ViewModel
dfference between ConfigurationManager and ConfigurationSettings?," What is the main difference between System.Configuration.ConfigurationManager.AppSettings[""key""] and System.Configuration.ConfigurationSettings.AppSettings[""key""] ? <code> ",Difference between ConfigurationManager and ConfigurationSettings
Socket Progarmming on a single computer?, I am building a client-server chat application.It has both a server and a client part.Is it possible to test the application on the same machine or do i need really need two different computer to run the application. <code> ,Socket Programming on a single computer?
Prevent closing a window," How can I prevent window closing by showing a MessageBox? (Technology:WinForms with C#)When the close event occurs I want the following code to be run: <code>  private void addFile_FormClosing( object sender, FormClosingEventArgs e ) { var closeMsg = MessageBox.Show( ""Do you really want to close?"", ""Warning"", MessageBoxButtons.YesNo, MessageBoxIcon.Question ); if (closeMsg == DialogResult.Yes) { //close addFile form } else { //ignore closing event }}",How to prevent or block closing a WinForms window?
Prevent closing a WinForms window?," How can I prevent window closing by showing a MessageBox? (Technology:WinForms with C#)When the close event occurs I want the following code to be run: <code>  private void addFile_FormClosing( object sender, FormClosingEventArgs e ) { var closeMsg = MessageBox.Show( ""Do you really want to close?"", ""Warning"", MessageBoxButtons.YesNo, MessageBoxIcon.Question ); if (closeMsg == DialogResult.Yes) { //close addFile form } else { //ignore closing event }}",How to prevent or block closing a WinForms window?
Custom Control Property Doesn't Update in Designer," I'm creating a custom control that lays out radio buttons (No it doesn't have to be radio buttons. I'm just trying to learn how to do this so I can make some more complex stuff down the road that may contain multiple lists of controls) which are added through the Items property (similar to some other controls).I can build the project, drag this onto a form from the component panel and add radio buttons via the Items property. Unfortunately this is not updated in designer unless you either:Rebuild the project 2-3 timesClose and reopen the form in designerAt first I had the logic that puts these on the form contained in the constructor after Initialize but that wasn't working so I moved to to Form_Load.What am I missing? The above options are just short term workarounds, not solutions.RBLTest.cs RBLTest.Designer.cs <code>  using System;using System.Collections.Generic;using System.ComponentModel;using System.Drawing;using System.Data;using System.Linq;using System.Text;using System.Windows.Forms;namespace WFCL_Library{ public partial class RBLTest : UserControl { private List<RadioButton> _items; private int leftSpacing = 100; private int topSpacing = 25; public RBLTest() { _items = new List<RadioButton>(); InitializeComponent(); } private void RadioButtonList_Load(object sender, EventArgs e) { int curLeftPos = 0; int curTopPos = 0; foreach (RadioButton rb in _items) { rb.Location = new Point(curLeftPos, curTopPos); rb.Size = new Size(85, 17); curLeftPos += leftSpacing; if (curLeftPos > this.Width) { curLeftPos = 0; curTopPos += topSpacing; } this.Controls.Add(rb); } } [DesignerSerializationVisibility(DesignerSerializationVisibility.Content)] public List<RadioButton> Items { get { return _items; } set { _items = value; } } } } namespace WFCL_Library{ partial class RBLTest { /// <summary> /// Required designer variable. /// </summary> private System.ComponentModel.IContainer components = null; /// <summary> /// Clean up any resources being used. /// </summary> /// <param name=""disposing"">true if managed resources should be disposed; otherwise, false.</param> protected override void Dispose(bool disposing) { if (disposing && (components != null)) { components.Dispose(); } base.Dispose(disposing); } #region Component Designer generated code /// <summary> /// Required method for Designer support - do not modify /// the contents of this method with the code editor. /// </summary> private void InitializeComponent() { this.SuspendLayout(); // // RBLTest // this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F); this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font; this.Name = ""RBLTest""; this.Size = new System.Drawing.Size(407, 44); this.Load += new System.EventHandler(this.RadioButtonList_Load); this.ResumeLayout(false); } #endregion }}",Custom Control Doesn't Update in Visual Studio Designer
"C# Folder Browser Dialog, Selected Path Issue"," So I have a folder browser dialog and am having issues with the selected path.So I want the previous folder that was opened to be selected, and I want it to be scrolled down so that the previous folder is visible.Now the strange thing is that this works fine, but only sometimes. It's completely random. The path is always highlighted, but it doesn't always scroll down. Sometimes when I start debugging and click browse, it will open up and be scrolled down to where I want. Then I click ok, click browse again and it's completely random whether or not it's scrolled down to where it should be. Any thoughts?Edit: I searched around a lot and found this. It seems to be quite similar to my problem. ""I have tried the test app on Vista 32, XP 32, Win 7 32 & 64. It works fine on everything except Windows 7. Both 32 and 64 appear to have the same issue.""They're saying it's a glitch with Windows 7...? <code> ",FolderBrowserDialog showing SelectedPath issue
How can I add a trigger to my WPF Button control template's content?," I'm attempting to create a simple button template in which the button normally looks like a single horizontal line, but when moused over, the button will display a ""rectangle"" color fill behind it. This is the code I have, but I can't seem to get the triggers to fire. Does anyone know why my trigger won't work, or perhaps a better way to do this? I'm sort of new to WPF and would like to refactor this out (so as to use it in many buttons), but am unsure how.Update: Ok, so I guess it appears to be because the button is within the caption bar of the window. Is there a good way around this? Maybe a way to set click/hover priority to the button? <code>  <Window x:Class=""TestStylingWPF.MainWindow"" xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml""> <WindowChrome.WindowChrome> <WindowChrome CaptionHeight=""36"" GlassFrameThickness=""0 0 0 1"" ResizeBorderThickness=""5"" /> </WindowChrome.WindowChrome> <Grid> <Grid.RowDefinitions> <RowDefinition Height=""36"" /> <RowDefinition Height=""*"" /> </Grid.RowDefinitions> <Button Height=""36"" Width=""36"" HorizontalAlignment=""Center"" VerticalAlignment=""Center"" Grid.Row=""0""> <Button.Template> <ControlTemplate> <Grid> <Rectangle x:Name=""PART_ButtonBackgroundRectangle"" Fill=""LightGray"" Width=""36"" Height=""36"" Opacity=""0"" /> <Path x:Name=""PART_ButtonPath"" Data=""M10,26 L26,26"" Stroke=""DarkGray"" StrokeThickness=""1.5"" /> </Grid> <ControlTemplate.Triggers> <Trigger SourceName=""PART_ButtonBackgroundRectangle"" Property=""IsMouseOver"" Value=""True""> <Setter TargetName=""PART_ButtonBackgroundRectangle"" Property=""Opacity"" Value=""1"" /> </Trigger> </ControlTemplate.Triggers> </ControlTemplate> </Button.Template> </Button> </Grid></Window>",How can I add a button to the WPF caption bar while using custom window chrome?
What does [System.SerializableAttribute()] do," I am looking at somebody elses C# code and before a public enum there are the following lines: Can somebody explain in plain english what the SerializableAttribute line are does?I already came across this page - it didn't make much sense to me - I'm new at C#. <code>  [System.CodeDom.Compiler.GeneratedCodeAttribute(""xsd"", ""4.0.30319.1"")][System.SerializableAttribute()][System.Xml.Serialization.XmlTypeAttribute(AnonymousType=true)][System.Xml.Serialization.XmlRootAttribute(Namespace="""", IsNullable=false)]",What does [System.SerializableAttribute()] do?
Why does the Ternary\Conditional operator seem significantly faster," EDITIf I use Stopwatch correctly and up the number of iterations by two orders of magnitude I getTernary took 22404msNormal took 21403msThese results are closer to what I was expecting and make me feel all is right with the world (if not with my code.)The Ternary/Conditional operator is in fact marginally slower.Following on from this question, which I have partially answered.I compile this console app in x64 Release Mode, with optimizations on, and run it from the command line without a debugger attached. I don't get any exceptions and the output to the console is somthing close to,Ternary took 107msNormal took 230msWhen I break down the CIL for the two logical functions I get this, Whilst the Ternary CIL is a little shorter, it seems to me that the execution path through the CIL for either function takes 3 loads and 1 or 2 jumps and a return. Why does the Ternary function appear to be twice as fast.I underdtand that, in practice, they are both very quick and indeed, quich enough but, I would like to understand the discrepancy. <code>  using System; using System.Diagnostics;class Program{ static void Main() { var stopwatch = new Stopwatch(); var ternary = Looper(10, Ternary); var normal = Looper(10, Normal); if (ternary != normal) { throw new Exception(); } stopwatch.Start(); ternary = Looper(10000000, Ternary); stopWatch.Stop(); Console.WriteLine( ""Ternary took {0}ms"", stopwatch.ElapsedMilliseconds); stopwatch.Start(); normal = Looper(10000000, Normal); stopWatch.Stop(); Console.WriteLine( ""Normal took {0}ms"", stopwatch.ElapsedMilliseconds); if (ternary != normal) { throw new Exception(); } Console.ReadKey(); } static int Looper(int iterations, Func<bool, int, int> operation) { var result = 0; for (int i = 0; i < iterations; i++) { var condition = result % 11 == 4; var value = ((i * 11) / 3) % 5; result = operation(condition, value); } return result; } static int Ternary(bool condition, in value) { return value + (condition ? 2 : 1); } static int Normal(int iterations) { if (condition) { return = 2 + value; } return = 1 + value; }} ... Ternary ...{ : ldarg.1 // push second arg : ldarg.0 // push first arg : brtrue.s T // if first arg is true jump to T : ldc.i4.1 // push int32(1) : br.s F // jump to F T: ldc.i4.2 // push int32(2) F: add // add either 1 or 2 to second arg : ret // return result}... Normal ...{ : ldarg.0 // push first arg : brfalse.s F // if first arg is false jump to F : ldc.i4.2 // push int32(2) : ldarg.1 // push second arg : add // add second arg to 2 : ret // return result F: ldc.i4.1 // push int32(1) : ldarg.1 // push second arg : add // add second arg to 1 : ret // return result}",Why does the conditional (ternary) operator seem significantly faster?
C#  Passing an *Awaitable* Anonymous Function as a Parameter," Code first. This is what I'm trying to do. I'm close, but I think I just need to fix the way I've defined my parameter in the UpdateButton method. Unfortunately, the !await post() doesn't work because, ""Type 'void' is not awaitable."" So the question is, how do I define my parameter in this method to support an awaitable parameter?Here's how the TwitterAction().Post() is defined...public virtual async Task<bool> Post(string messageId){...} <code>  private async void UpdateButton(Action<bool> post){ if (!await post()) ErrorBox.Text = ""Error posting message."";}private void PostToTwitter(){ UpdateButton(async () => await new TwitterAction().Post(""Hello, world!""));}private void PostToFacebook(){ UpdateButton(async () => await new FacebookAction().Post(""Hello, world!""));}",Passing an *Awaitable* Anonymous Function as a Parameter
How to get All static property and it's values of a class using reflection," I hava a class like this: I want to write some statement that returns a Dictionary<string, string> that has these values: I have this code for getting one property value: How I can get all properties and their values? <code>  public class tbl050701_1391_Fields{ public static readonly string StateName = ""State Name""; public static readonly string StateCode = ""State Code""; public static readonly string AreaName = ""Area Name""; public static readonly string AreaCode = ""Area Code""; public static readonly string Dore = ""Period""; public static readonly string Year = ""Year"";} Key Value--------------------------------------------""StateName"" ""State Name""""StateCode"" ""State Code""""AreaName"" ""Area Name""""Dore"" ""Period""""Year"" ""Year"" public static string GetValueUsingReflection(object obj, string propertyName){ var field = obj.GetType().GetField(propertyName, BindingFlags.Public | BindingFlags.Static); var fieldValue = field != null ? (string)field.GetValue(null) : string.Empty; return fieldValue;}",How to get all static properties and its values of a class using reflection
short and sbyte GetHashCode implementation, We have the following code: This make sense and the same happen whit all integral types in C# except sbyte and short.That is: Why is this? <code>  int i = 1;Console.WriteLine(i.GetHashCode()); // outputs => 1 sbyte i = 1;Console.WriteLine(i.GetHashCode()); // outputs => 257,"Why do ""int"" and ""sbyte"" GetHashCode functions generate different values?"
how to avoid ctrl M characters when transferring files from window to unix using Tectia?," In a C# module, I want to transfer files from Windows to Unix using Tectia. But the problem is when these files are transferred(Ascii or Binary mode both) and opened using VI editor we get ^M characters.I searched about this but the solutions are to remove these ^M characters after the files are transferred using utilites. Is there any way that these ^M characters do not appear in the first place.Is there any option to have a workaround in code before sending these files? <code> ",C# - how to remove ctrl M characters when transferring files from windows to unix using Tectia?
how to remove ctrl M characters when transferring files from window to unix using Tectia?," In a C# module, I want to transfer files from Windows to Unix using Tectia. But the problem is when these files are transferred(Ascii or Binary mode both) and opened using VI editor we get ^M characters.I searched about this but the solutions are to remove these ^M characters after the files are transferred using utilites. Is there any way that these ^M characters do not appear in the first place.Is there any option to have a workaround in code before sending these files? <code> ",C# - how to remove ctrl M characters when transferring files from windows to unix using Tectia?
c# application which is elevated needs to get non-elevated mapped drives list," I know that a .NET application which is run as elevated cannot see the mapped drives of the user. I also know there is a registry hack to fix this (which involves a reboot). I would like to create a different solution to this problem. Our application must run elevated and it relies heavily on the mapped drives that the user has created. I'd like to detect the mapped drives the user has, and map a similar bunch from the elevated application.So the question is: how do I detect the mapped drives of the 'normal' user from an elevated application? <code> ",application which is elevated needs to get non-elevated mapped drives list
C# Oracle.DataAccess version could not load," I am having trouble with Oracle.DataAccess in WPF. I used Oracle.DataAccess v4.0without any problems. But now it updated to version 4.112 and when I add reference to this version in WPF the designer could not be loaded. It gives me the following error: Please note that program runs without any problem. I read that it can be due to ""target cpu"" in properties. I tested both x64 and x86 but nothing changes. How can I solve this problem. Thanks in advance <code>  System.BadImageFormatExceptionCould not load file or assembly 'Oracle.DataAccess, Version=4.112.3.0, Culture=neutral, PublicKeyToken=89b483f429c47342' or one of its dependencies. An attempt was made to load a program with an incorrect format.",Oracle.DataAccess version could not load
How to draw Chart base on DataTable from console application?, How to use System.Windows.Forms.DataVisualization.Charting.Chart inside console application to draw an graph and save it to file? <code> ,How to draw Chart based on DataTable from console application?
Multi-Targeting .Net Framework 4 and Visual Studio 2012," I have installed Visual Studio 2012 Professional on my machine. I don't have Visual Studio 2010 installed, but I want to keep developing my applications using .NET Framework 4, but I don't have this option on my VisualStudio2012. Look at the image:I don't know what can I do to fix this problem, because I click on ""More Frameworks..."" link and try to install the Multi-Targeting for .NET 4.0.3 (installed on my machine), but it does not work. It says that this version of framework is still installed. What can I do to fix this problem?Obs: I have lots of projects in C# and VB.NET with .NET 4.0, and I need to keep these projects with new projects on .NET 4.0. <code> ",Multi-targeting .NET Framework 4 and Visual Studio 2012
"Marshal.SizeOf on a struct containing guid gives extra bytes, c sharp"," I have several structs that have sequential layout: Calling Marshal.SizeOf on above struct types,I got: My question is that why the size of S2 is 20 but not 18. And this problem only comes up when Guid is in the struct. Sorry can't find any useful info from msdn. I know Marshal.SizeOf gives the size of space the type will occupy in the memory, but I want to know why it deserves 2 extra bytes to make the size a multiple of 4.And how can I avoid this ""problem""?Thanks a lot! <code>  struct S1{ Guid id;}struct S2 { Guid id; short s;}struct S3 { Guid id; short s; short t;} Size:S1 = 16, as expected.S2 = 20, copied an instance to a byte array, it only occupies first 18 bytes.S3 = 20.",Marshal.SizeOf on a struct containing guid gives extra bytes
Write in stacktrace C# WPF," Can I throw some text in the stack trace?My application already has a grip on the exceptions thrown. But would like to have some more information on some methods (parameters).The idea was to do something like I know this is not cool, but is it possible? <code>  StackTrace.Insert (0, ""argument:"" + test);",Write in stacktrace
Write in stacktrace C#," Can I throw some text in the stack trace?My application already has a grip on the exceptions thrown. But would like to have some more information on some methods (parameters).The idea was to do something like I know this is not cool, but is it possible? <code>  StackTrace.Insert (0, ""argument:"" + test);",Write in stacktrace
TagBuilder.MergeAttributes does not work," I am trying to make a HtmlHelper and I need to allow users to add their own custom attributes to the html tag.I tried to do this using the TagBuilder class, but it seems that instead of merging the attributes, it just replaces them.This is what I did in C#: This is my view: What am I doing wrong? <code>  public static MvcHtmlString List(HtmlHelper helper, object htmlAttributes){ var attributes = HtmlHelper.AnonymousObjectToHtmlAttributes(htmlAttributes); var tag = new TagBuilder(""div""); tag.AddCssClass(""myClass""); tag.MergeAttributes(attributes, false); // tag class property has value ""myClass"", not ""myClass testClass"" return new MvcHtmlString(""<div>"");} @Html.List(new { @class = ""testClass"" })",TagBuilder.MergeAttributes does not work as expected
C# image Scaling," i got a problem with image scaling in C#.I have a picture Box with given Size : e.g. width = 800px height = 600pxI am loading different images into that picture box, small ones ( 400x400) and big ones (800+ x 600+)My images are getting resized if they do not fit into box. But they are always resized to MAX width and height of PictureBox. So the aspect ratio is destroyed.Can anybody help to identify / fix the problem?Classes:Form1.csImageHandling.cs (commented out)ImageUtilities.csExamples:Problem 1:My Version vs Original Source Problem 2:My Versionvs Original SourceHow i want it:Solution <code> ",image Scaling of picture box
Is async and await exclusively for GUI-based (Winforms/WPF) asynchronous programming?," I've been reading about the new async and await operators in C# and tried to figure out in which circumstances they would possibly be useful to me. I studied several MSDN articles and here's what I read between the lines:You can use async for Windows Forms and WPF event handlers, so they can perform lengthy tasks without blocking the UI thread while the bulk of the operation is being executed. A method using await must be async, which means that the usage of any async function somewhere in your code ultimately forces all methods in the calling sequence from the UI event handlers up until the lowest-level async method to be async as well.In other words, if you create a thread with an ordinary good old ThreadStart entry point (or a Console application with good old static int Main(string[] args)), then you cannot use async and await because at one point you would have to use await, and make the method that uses it async, and hence in the calling method you also have to use await and make that one async and so on. But once you reach the thread entry point (or Main()), there's no caller to which an await would yield control to.So basically you cannot use async and await without having a GUI that uses the standard WinForms and WPF message loop. I guess all that makes indeed sense, since MSDN states that async programming does not mean multithreading, but using the UI thread's spare time instead; when using a console application or a thread with a user defined entry point, multithreading would be necessary to perform asynchronous operations (if not using a compatible message loop).My question is, are these assumptions accurate? <code>  async void button1_Click(object sender, EventArgs e){ // even though this call takes a while, the UI thread will not block // while it is executing, therefore allowing further event handlers to // be invoked. await SomeLengthyOperationAsync();}",Is async and await exclusively for GUI-based asynchronous programming?
Get caller class from extension method," I've a little problem with getting the caller for my extension method.Searched the internet but couldn't find anything simular to my problem.This question was a close call... I've a extension method : This is used for some automated tests to validate if the nextfield has focus and the tab order is correct. But for the error that should be logged i would like to get the Class name of the caller to get a accurate report that we can directly see where the error is in our application.Since all the controls are using AutomationId the controls are easy to identify..So the question is: How can i get the caller method from this extension method? <code>  public static void TabToNextField(this FrameworkElement i, FrameworkElement nextField){ i.KeyPress(Keys.Tab); var isNextFieldFocused = nextField.GetProperty<bool>(""IsFocused""); if (!isNextFieldFocused) { //Taborder is incorrect. Next field wasn't focused! //This wont work since 'this' can't be used in a static context. var currentProcedure = this.GetType().Name; var fromField = i.AutomationId; var toField = nextField.AutomationId; //Log to file.. }}",Get caller method from extension method
"Algorith for ""smooth"" random numbers"," Could anyone give me a hint on how to generate ""smooth"" random numbers?Here's what I mean by smooth:The random numbers shall be used in a game, e.g. for wind direction and strength (does anyone remember goood old ""Worms""?). Of course setting random numbers for those values every second or so would look awfully choppy.I would rather have some kind of smooth oscillation in a given value range. Sort of like a sine wave but much more random.Does anyone get what I'm after? ;-)Any ideas on how to achieve this kind of behavior would be appreciated. <code> ","Algorithm for ""smooth"" random numbers"
Can Anyone Explain in a simple way this C# codes to me," Can anyone explain in a simple way the codes below: Note: the above code uses unsafe functionFor the above code, I'm having hard time because I don't understand what's the difference between its return value compare to the return value below: Is it necessary to use unsafe function if your returning *(float*)(&result)? <code>  public unsafe static float sample(){ int result = 154 + (153 << 8) + (25 << 16) + (64 << 24); return *(float*)(&result); //don't know what for... please explain} return (float)(result);",C# 'unsafe' function  *(float*)(&result) vs. (float)(result)
Can Anyone Explain in a simple way this code to me," Can anyone explain in a simple way the codes below: Note: the above code uses unsafe functionFor the above code, I'm having hard time because I don't understand what's the difference between its return value compare to the return value below: Is it necessary to use unsafe function if your returning *(float*)(&result)? <code>  public unsafe static float sample(){ int result = 154 + (153 << 8) + (25 << 16) + (64 << 24); return *(float*)(&result); //don't know what for... please explain} return (float)(result);",C# 'unsafe' function  *(float*)(&result) vs. (float)(result)
Cofe-First Entity Framework inserting data with custom ID," I am using code-first EF in my project and face issue when the data with custom id is being inserted. When I am trying to insert data with custom ID (for instance 999), EF ignores it and inserts incremented ID into table.My model: How to solve this probleb?EDIT:1) How to begin incrementing from N, but not from 0?2) If I don't specify custom ID, DB must increment and inserts own. If I specify custom ID, DB must insert it. Is it possible? <code>  public class Address{ [Key] public int Id { get; set; } public string FirstName { get; set; }...}",Code-First Entity Framework inserting data with custom ID
extract nodes from xmlnodelist - c#," I am trying to extract those subnodes, but I had got just headache so far... with the code I can get them, but I do not know how to select each one according to their tag name to insert them into a database. I need some direction, please. <code>  <soapenv:Envelope xmlns:soapenv=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""><soapenv:Body> <supplyCrew xmlns=""http://site.ddf.com""> <login> <login>XXXX</login> <password>XXXX</password> </login> <flightInformation> <flights> <item> <arrivalDateTime>2010-11-08T22:48:00.000Z</arrivalDateTime> <arrivingCity>ORD</arrivingCity> <crewMembers> <item> <employeeId>020040</employeeId> <isDepositor>Y</isDepositor> <isTransmitter>N</isTransmitter> </item> <item> <employeeId>09000</employeeId> <isDepositor>N</isDepositor> <isTransmitter>Y</isTransmitter> </item> </crewMembers> </item> <item> <arrivalDateTime>2010-11-08T20:29:00.000Z</arrivalDateTime> <arrivingCity>JFK</arrivingCity> <crewMembers> <item> <employeeId>0538</employeeId> <isDepositor>Y</isDepositor> <isTransmitter>N</isTransmitter> </item> <item> <employeeId>097790</employeeId> <isDepositor>N</isDepositor> <isTransmitter>Y</isTransmitter> </item> XmlDocument xmlDoc = new XmlDocument();xmlDoc.Load(""C:/Crew_Request_Sample.xml""); XmlNodeList elemList = xmlDoc.GetElementsByTagName(""item"");foreach (XmlNode node in elemList){ Debug.WriteLine(node.InnerText);}","Extract nodes from XmlNodeList, with namespace, and where same child appears at multiple levels"
extract nodes from xmlnodelist - c# [SOLVED]," I am trying to extract those subnodes, but I had got just headache so far... with the code I can get them, but I do not know how to select each one according to their tag name to insert them into a database. I need some direction, please. <code>  <soapenv:Envelope xmlns:soapenv=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""><soapenv:Body> <supplyCrew xmlns=""http://site.ddf.com""> <login> <login>XXXX</login> <password>XXXX</password> </login> <flightInformation> <flights> <item> <arrivalDateTime>2010-11-08T22:48:00.000Z</arrivalDateTime> <arrivingCity>ORD</arrivingCity> <crewMembers> <item> <employeeId>020040</employeeId> <isDepositor>Y</isDepositor> <isTransmitter>N</isTransmitter> </item> <item> <employeeId>09000</employeeId> <isDepositor>N</isDepositor> <isTransmitter>Y</isTransmitter> </item> </crewMembers> </item> <item> <arrivalDateTime>2010-11-08T20:29:00.000Z</arrivalDateTime> <arrivingCity>JFK</arrivingCity> <crewMembers> <item> <employeeId>0538</employeeId> <isDepositor>Y</isDepositor> <isTransmitter>N</isTransmitter> </item> <item> <employeeId>097790</employeeId> <isDepositor>N</isDepositor> <isTransmitter>Y</isTransmitter> </item> XmlDocument xmlDoc = new XmlDocument();xmlDoc.Load(""C:/Crew_Request_Sample.xml""); XmlNodeList elemList = xmlDoc.GetElementsByTagName(""item"");foreach (XmlNode node in elemList){ Debug.WriteLine(node.InnerText);}","Extract nodes from XmlNodeList, with namespace, and where same child appears at multiple levels"
extract nodes from xmlnodelist," I am trying to extract those subnodes, but I had got just headache so far... with the code I can get them, but I do not know how to select each one according to their tag name to insert them into a database. I need some direction, please. <code>  <soapenv:Envelope xmlns:soapenv=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""><soapenv:Body> <supplyCrew xmlns=""http://site.ddf.com""> <login> <login>XXXX</login> <password>XXXX</password> </login> <flightInformation> <flights> <item> <arrivalDateTime>2010-11-08T22:48:00.000Z</arrivalDateTime> <arrivingCity>ORD</arrivingCity> <crewMembers> <item> <employeeId>020040</employeeId> <isDepositor>Y</isDepositor> <isTransmitter>N</isTransmitter> </item> <item> <employeeId>09000</employeeId> <isDepositor>N</isDepositor> <isTransmitter>Y</isTransmitter> </item> </crewMembers> </item> <item> <arrivalDateTime>2010-11-08T20:29:00.000Z</arrivalDateTime> <arrivingCity>JFK</arrivingCity> <crewMembers> <item> <employeeId>0538</employeeId> <isDepositor>Y</isDepositor> <isTransmitter>N</isTransmitter> </item> <item> <employeeId>097790</employeeId> <isDepositor>N</isDepositor> <isTransmitter>Y</isTransmitter> </item> XmlDocument xmlDoc = new XmlDocument();xmlDoc.Load(""C:/Crew_Request_Sample.xml""); XmlNodeList elemList = xmlDoc.GetElementsByTagName(""item"");foreach (XmlNode node in elemList){ Debug.WriteLine(node.InnerText);}","Extract nodes from XmlNodeList, with namespace, and where same child appears at multiple levels"
how to send an email from windows 8?, I am developing a Windows Store Application (Windows 8). I have a need to send emails based on data and address stored in the application data and without the need of the user to type it the data or the address.What would be the right/easy way to implement it?EitanB <code> ,How do I send an email from a WinRT/Windows Store application?
Two way databinding using EF in winforms, I am very new at coding. Now I am going to tell you about my current situation and where I wanna go. Hope you will help.I am using EF5.0 database first approach and I want to be able to use gridviews for listing and updating the database values.Currently I am binding my data like this: This code lists my data perfectly. However it is wrong or not enough for my needs. Because I want to be able to edit my data right on the gridview. Please tell me what is wrong and what should I do. At least links of some documents that will reach me to the destination point I desire would be great. Thx. <code>  pehlivan_kabametrajEntities ctx = new pehlivan_kabametrajEntities(); var result = from k in ctx.Kolons select k; dataGridView1.DataSource = result.ToList();,How to make two way-databinding using EF in winforms?
How to make wo way databinding using EF in winforms?, I am very new at coding. Now I am going to tell you about my current situation and where I wanna go. Hope you will help.I am using EF5.0 database first approach and I want to be able to use gridviews for listing and updating the database values.Currently I am binding my data like this: This code lists my data perfectly. However it is wrong or not enough for my needs. Because I want to be able to edit my data right on the gridview. Please tell me what is wrong and what should I do. At least links of some documents that will reach me to the destination point I desire would be great. Thx. <code>  pehlivan_kabametrajEntities ctx = new pehlivan_kabametrajEntities(); var result = from k in ctx.Kolons select k; dataGridView1.DataSource = result.ToList();,How to make two way-databinding using EF in winforms?
How to make two way databinding using EF in winforms?, I am very new at coding. Now I am going to tell you about my current situation and where I wanna go. Hope you will help.I am using EF5.0 database first approach and I want to be able to use gridviews for listing and updating the database values.Currently I am binding my data like this: This code lists my data perfectly. However it is wrong or not enough for my needs. Because I want to be able to edit my data right on the gridview. Please tell me what is wrong and what should I do. At least links of some documents that will reach me to the destination point I desire would be great. Thx. <code>  pehlivan_kabametrajEntities ctx = new pehlivan_kabametrajEntities(); var result = from k in ctx.Kolons select k; dataGridView1.DataSource = result.ToList();,How to make two way-databinding using EF in winforms?
Json.Net - Serialize Dictionary as Array (of Key Value Pairs)," Json.Net typically serializes a Dictionary<k,v> into a collection; Which is great. And from looking around on SO it seems to be what most people want. However, in this particular case, I want to serialize between my Dictionary<k,v> and the Array format instead; Is there an easy way to do this with my existing field type? Is there an attribute I can annotate for instance? <code>  ""MyDict"": { ""Apples"": { ""Taste"": 1341181398, ""Title"": ""Granny Smith"", }, ""Oranges"": { ""Taste"": 9999999999, ""Title"": ""Coxes Pippin"", }, } ""MyDict"": [ ""k"": ""Apples"", ""v"": { ""Taste"": 1341181398, ""Title"": ""Granny Smith"", } }, ""k:"": ""Oranges"", ""v:"": { ""Taste"": 9999999999, ""Title"": ""Coxes Pippin"", } },]",Serialize dictionary as array (of key value pairs)
The requested resource does not support http method 'GET'," My route is correctly configured, and my methods have the decorated tag. I still get ""The requested resource does not support HTTP method 'GET'"" message? Here are my routes: <code>  [System.Web.Mvc.AcceptVerbs(""GET"", ""POST"")][System.Web.Mvc.HttpGet]public string Auth(string username, string password){ // Dcoder les paramtres reue. string decodedUsername = username.DecodeFromBase64(); string decodedPassword = password.DecodeFromBase64(); return ""value"";} config.Routes.MapHttpRoute( name: ""AuthentificateRoute"", routeTemplate: ""api/game/authentificate;{username};{password}"", defaults: new { controller = ""Game"", action = ""Auth"", username = RouteParameter.Optional, password = RouteParameter.Optional }, constraints: new { httpMethod = new HttpMethodConstraint(HttpMethod.Get) });config.Routes.MapHttpRoute( name: ""DefaultApi"", routeTemplate: ""api/{controller}/{id}"", defaults: new { controller = ""Home"", id = RouteParameter.Optional });",The requested resource does not support HTTP method 'GET'
Web Api Routing for multiple Get methods in ASP.NET MVC 4," I am using Web Api with ASP.NET MVC, and I am very new to it. I have gone through some demo on asp.net website and I am trying to do the following.I have 4 get methods, with the following signatures For all the methods above I would like to have my web api somewhat like as shown belowList Get() = api/customers/Customer GetCustomerById(string Id) = api/customers/13List GetCustomerByCurrentMonth() = /customers/currentMonthCustomer GetCustomerByUsername(string username) = /customers/customerByUsername/yasserI tried making changes to routing, but as I am new to it, could'nt understand much.So, please can some one help me understand and guide me on how this should be done. Thanks <code>  public List<Customer> Get(){ // gets all customer}public List<Customer> GetCustomerByCurrentMonth(){ // gets some customer on some logic}public Customer GetCustomerById(string id){ // gets a single customer using id}public Customer GetCustomerByUsername(string username){ // gets a single customer using username}",Routing with multiple Get methods in ASP.NET Web API
C# WPF How to set BindingExpression.Status to Active programmatically?," I am transfering FrameworkElement from StackPanel on WPF Page to programmatically created StackPanel. At a certain point I need to refresh bindings and get property values.At this point FrameworkElement.DataContext has correct value and BindingExpression.Status==BindingStatus.Unattached for all binding expressions. I execute BindingExpression.UpdateTarget, but property values are empty.I found source code for BindingExpression.UpdateTarget(): Worker gets instance in internal override void BindingExpression.Activate(). Also inside Activate() BindingExpression.Status set to BindingStatus.Active.How can I programmatically initiate execution for BindingExpression.Activate() and make UpdateTarget after that?UpdateSolution here (thanks, Olli): where getting all bindings for object: <code>  public override void UpdateTarget() { if (Status == BindingStatus.Detached) throw new InvalidOperationException(SR.Get(SRID.BindingExpressionIsDetached)); if (Worker != null) { Worker.RefreshValue(); // calls TransferValue } } public void UpdateAllBindingTargets( DependencyObject obj) { FrameworkElement visualBlock = obj as FrameworkElement; if (visualBlock==null) return; if (visualBlock.DataContext==null) return; Object objDataContext = visualBlock.DataContext; IEnumerable<KeyValuePair<DependencyProperty, BindingExpression>> allElementBinding = GetAllBindings(obj); foreach (KeyValuePair<DependencyProperty, BindingExpression> bindingInfo in allElementBinding) { BindingOperations.ClearBinding(obj, bindingInfo.Key); Binding myBinding = new Binding(bindingInfo.Value.ParentBinding.Path.Path); myBinding.Source = objDataContext; visualBlock.SetBinding(bindingInfo.Key, myBinding); BindingOperations.GetBindingExpression(visualBlock, bindingInfo.Key).UpdateTarget(); } } public IEnumerable<KeyValuePair<DependencyProperty, BindingExpression>> GetAllBindings( DependencyObject obj) { var stack = new Stack<DependencyObject>(); stack.Push(obj); while (stack.Count > 0) { var cur = stack.Pop(); var lve = cur.GetLocalValueEnumerator(); while (lve.MoveNext()) if (BindingOperations.IsDataBound(cur, lve.Current.Property)) { KeyValuePair<DependencyProperty,BindingExpression> result=new KeyValuePair<DependencyProperty, BindingExpression>(lve.Current.Property,lve.Current.Value as BindingExpression); yield return result; } int count = VisualTreeHelper.GetChildrenCount(cur); for (int i = 0; i < count; ++i) { var child = VisualTreeHelper.GetChild(cur, i); if (child is FrameworkElement) stack.Push(child); } } }",How to set BindingExpression.Status to Active programmatically?
Using base and this in constructor chaining C# .NET 4.0," Say there is a base class called Employee that looks like the following And a class Manager which inherits from Employee with a constructor like To the best my understanding, the this keyword is just like the base keyword only it applies to constructors in the same class. My biggest question is, while reading a reference book, it says if you don't use the chaining the construction of a Manager object will include seven 'hits'. Since Manager inherits from Employees, does this mean that every Manager object is 'born' as an Employee and then becomes a Manager later? And after it is a manager you only have two fields to add instead of seven? <code>  public Employee(string name, int id, float pay) : this(name, 0, id, pay, """") { }public Employee(string name, int age, int id, float pay, string ssn){ // Better! Use properties when setting class data. // This reduces the amount of duplicate error checks. Name = name; Age = age; ID = id; Pay = pay; SocialSecurityNumber = ssn;} public Manager(string fullName, int age, int empID, float currPay, string ssn, int numbOfOpts) : base(fullName, age, empID, currPay, ssn){ . StockOptions = numbOfOpts;}",Using base and this in constructor chaining
Add simple text to panel control - C#," I have a panel in C#: I have added Attributes and buttons and all kinds of cool dynamic stuff. But I want to just add simple text and so far am unsuccessful.I'm looking for how to add text behind the button. In the end the HTML code would render something like: Can someone point me in the right direction? <code>  Panel aspPanel = new Panel(); Button aspbutton = new Button(); aspbutton.Text = ""Download PDF""; aspbutton.Click += initDownload; aspPanel.Controls.Add(aspbutton);` <input type=""button""/> Hello, this is a button, please click",Add simple text to panel control
including another razor page," I'd like to know how to include another razor page in running razor view just as PHP's ""include"" term. It can be considered as partial classes. Half of work is done at a.cshtml and the other half of works are done at b.cshtml. But in reality two of them are built as one razor page. Any ideas will be appreciated... <code> ",How to include a razor page to another razor page?
One Instance Application over Multiplie Windows Users Accounds in VB or C# .net," I have used solution of Mutex to disallow opening more than one instance of my application at the same timebut, when i use Switch User in windows and open another user, and try to open the application, it opened normally and can't detect that it's running on other accounthow could i solve something like this and disallow opening the application among Logged in Windows User Accountsi am using code like this <code>  Dim onlyInstance As Boolean = False_mutex = New Mutex(True, ""Application Name"", onlyInstance)If Not onlyInstance Then MessageBox.Show(""Application is already running."", ""Error."") System.Diagnostics.Process.GetCurrentProcess.Kill() System.Diagnostics.Process.GetCurrentProcess.WaitForExit()End If",One instance application over multiple Windows user accounts
Portable class library:recommended replacement for [Serializable]," I am porting a .NET Framework C# class library to a Portable Class Library. One recurring problem is how to deal with classes decorated with the [Serializable] attribute, since this attribute is not part of the Portable Class Library subset. Serialization functionality in the Portable Class Library subset instead appears to be covered by DataContractAttribute.To preserve as much of functionality as possible in the Portable Class Library, is it sufficient to replace [Serializable] with the [DataContract] attribute (with the implication that all fields and properties subject to serialization would need to be decorated with [DataMember] as well)? What (if anything) will I not be able to do with this approach that I can do with [Serializable] applied? Is there a less intrusive approach?Given that [DataContract] and [DataMember] are used, I am considering to change the code along the following lines. Are there any obvious flaws with this approach? Is there any way to formulate the same thing less verbose? <code>  #if PORTABLE [DataContract]#else [Serializable]#endif public class SerializableClass : SerializableBaseClass { ...#if !PORTABLE protected SerializableClass(SerializationInfo info, StreamingContext context) : base(info, context) { }#endif ...#if PORTABLE [DataMember]#endif private Type1 _serializableField;#if PORTABLE [DataMember]#endif private Type2 SerializableProperty { get; set; } ... }",Portable class library: recommended replacement for [Serializable]
"how can i return the sum , average of an int array"," I need to define two methods for returning the sum and average of an int array. The method defining is as follow:- Another question is, how can I return the average of these int values? <code>  public int Sum(params int[] customerssalary){ // I tried the following but it fails return customerssalary.sum();}",How can I return the sum and average of an int array?
How to determine the current input language c#?," I am designing an on screen keyboard,I need to determine which language been set by the user and which language he is using now in the other threads,i.e. I need to know the language selected in the taskbar language switcher:P.S. current culture returns the language used in the on screen keyboard application, which is not the case I am looking for.. <code> ",How to determine the current input language?
C# web service passing comma delimited data," We are about to start GPS tracking development using C# and web services to communicate with a third party java'ish receptor on the hardware units.We have a contract for the handling of the vehicle GPS unit to cloud exchange. We need to integrate the cloud to consumer integration for our current real time tracking view portion of our software.I've been given the task to create a method of using web services to relay the data in to our application. The data will consist, initially, of few and basic elements; lat, long, vehicleid, etc. Given the nature of GPS 'real-time' viewing this needs to be as fast as possible with small bandwidth consumption.It has been suggested to me to use a web service that simply passes comma delimited data. I've been unable to find anything along these lines.I'm open to any suggestions as I'm new to C# since our application is in VB currently. These are the requirements given to me so far:Fast!Low bandwidth consumptionConsumable by the following technologies; ASP.NET, IOS, VB, and VB.NET <code> ",web service passing comma delimited data
OuterGlowBitmapEffect Alternative for WinRT," WinRT doesn't have OuterGlowBitmapEffect. So, is there any way to display the outer glow effect for a TextBlock in WinRT? <code> ",Outer Glow Effect for TextBlock in WinRT
OuterGlowBitmapEffect Alternative for TextBlock in WinRT," WinRT doesn't have OuterGlowBitmapEffect. So, is there any way to display the outer glow effect for a TextBlock in WinRT? <code> ",Outer Glow Effect for TextBlock in WinRT
set value of private variable," Why is the following code not working: I am trying to set the value of a private field.Here is the exeption I get: <code>  class Program{ static void Main ( string[ ] args ) { SomeClass s = new SomeClass( ); s.GetType( ).GetField( ""id"" , System.Reflection.BindingFlags.NonPublic ) // sorry reasently updated to GetField from GetProperty... .SetValue( s , ""new value"" ); }}class SomeClass{ object id; public object Id { get { return id; } } } System.NullReferenceException was unhandled Message=Object reference not set to an instance of an object. Source=ConsoleApplication7 StackTrace: at Program.Main(String[] args) in C:\Users\Antonio\Desktop\ConsoleApplication7\ConsoleApplication7\Program.cs:line 18 at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args) at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args) at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly() at System.Threading.ThreadHelper.ThreadStart_Context(Object state) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state) at System.Threading.ThreadHelper.ThreadStart() InnerException:",Set value of private field
How to work out if a file has been modified - C#," I'm writing a back up solution (of sorts). Simply it copies a file from location C:\ and pastes it to location Z:\To ensure the speed is fast, before copying and pasting it checks to see if the original file exists. If it does, it performs a few 'calculations' to work out if the copy should continue or if the backup file is up to date. It is these calculations I'm finding difficult.Originally, I compared the file size but this is not good enough because it would be very possible to change a file and it to be the same size (for example saving the character C in notepad is the same size as if I saved the Character T). So, I need to find out if the modified date differs. At the moment, I get the file info using the FileInfo class but after reviewing all the fields there is nothing which appears to be suitable. How can I check to ensure that I'm copying files which have been modified?EDIT I have seen suggestions on SO to use MD5 checksums, but I'm concerned this may be a problem as some of the files I'm comparing will be up to 10GB <code> ",How to work out if a file has been modified?
convertin absolute path to relative path Csharp," Possible Duplicate: Getting path relative to the current working directory? I have code in C# that includes some images from an absolute path to a relative so the image can be found no matter where the application fold is located. For example the path in my code (and in my laptop for the image) is and I want the path in my code to be So it can run wherever the folder is put, whatever the name of the C: partition is etc. I want to have a path in my code which is independant of the application folder location or if it is in another partition, as long as it is in the same folder as the the rest of the solution.I have this code: This code only runs if the file and folder are in that certain path, (which is also the location of the code) I wish for that path to be relative so wherever I put the whole folder (code, files etc) the program will still work as long as the code (which is under project folder) is at the same location with the folder images... what should I do? <code>  C:/something/res/images/image1.jpeg ..../images/image1.jpeg try { File.Delete(""C:/JPD/SCRAT/Desktop/Project/Resources/images/image1.jpeg""); } catch (Exception) { MessageBox.Show(""File not found:C:/Users/JPD/Desktop/Project/images/image1.jpeg""); } ",Converting absolute path to relative path C#
Insert variable values in the middle of an string," In C#: If I want to create a message like this:""Hi We have these flights for you: Flight A,B,C,D. Which one do you want""where just the section in bold is dynamic and I pass its value at run time, but its left and right parts are fixed. I can create something like LeftMessage + those variables + RightMessage to create this.But I was wondering if there is a way of doing it all at once without the need to create two separate left and right messages?For translation purposes I am putting those left and right messages inside string resources so now I have two separate string resources. Is there a way to do it all at once?  <code> ",Insert variable values in the middle of a string
Interlocked.CompareExchange<Int> using GreaterThan or LessThan?," The System.Threading.Interlocked object allows for Addition (subtraction) and comparison as an atomic operation. It seems that a CompareExchange that just doesn't do equality but also GreaterThan/LessThan as an atomic comparison would be quite valuable.Would a hypothetical Interlocked.GreaterThan a feature of the IL or is it a CPU-level feature? Both?Lacking any other option, is it possible to create such a feature in C++ or direct IL code and expose that functionality to C#? <code> ",Interlocked.CompareExchange<Int> using GreaterThan or LessThan instead of equality
How to use Except method in list in c#.net," I had create a two int type list and assign the items that are only in list1 to list1 using except method. for eg Please give me suggestion. What is the right way to do it. <code>  List<int> list1 = new List<int>();List<int> list2 = new List<int>();list1 = {1,2,3,4,5,6} // get items from the databaselist2 = {3,5,6,7,8} // get items from the databaselist1 = list1.Except(list2); // gives me an error.",How to use Except method in list in c#
Convert System Color To WdColor C#," I'm rather new to C# and find it almost unspeakable that there isn't a simple way for converting an RGB color or system.color to a WdColor!VB is simple, C# - is it really that hard to do?I do not want to reference VB in my project.I'm using this in some word automation project to color a font, e.g. But this above line isn't possible, it needs to be a WdColor. <code>  tmpRange.Find.Replacement.Font.Color = Color.FromArgb(100, 150, 75); ",Convert System.Color To Microsoft Word WdColor
Convert System Color To WdColor," I'm rather new to C# and find it almost unspeakable that there isn't a simple way for converting an RGB color or system.color to a WdColor!VB is simple, C# - is it really that hard to do?I do not want to reference VB in my project.I'm using this in some word automation project to color a font, e.g. But this above line isn't possible, it needs to be a WdColor. <code>  tmpRange.Find.Replacement.Font.Color = Color.FromArgb(100, 150, 75); ",Convert System.Color To Microsoft Word WdColor
WCF with visual studio 2012 help required," I am new WCF programming, I did followed series of Getting Started tutorials from following linkhttp://msdn.microsoft.com/en-us/library/ms734712.aspxI have hosted service in console application but when I tried to create a client and tried to add service reference I got the following exceptions. There was an error downloading 'http: localhost:8000/GettingStarted/mex/_vti_bin/ListData.svc/$metadata'. The request failed with HTTP status 405: Method Not Allowed. Metadata contains a reference that cannot be resolved: 'http: localhost:8000/GettingStarted/mex'. There was no endpoint listening at http: localhost:8000/GettingStarted/mex that could accept the message. This is often caused by an incorrect address or SOAP action. See InnerException, if present, for more details. The remote server returned an error: (404) Not Found. If the service is defined in the current solution, try building the solution and adding the service reference again.code of hosting application Now I am unable to figure out what the problem is. I am using visual studio 2012 and .net platform 4.5.  <code>  class Program{ static void Main(string[] args) { // Step 1 Create a URI to serve as the base address. Uri baseAddress = new Uri(""http://localhost:8000/GettingStarted/""); // Step 2 Create a ServiceHost instance ServiceHost selfHost = new ServiceHost(typeof(CalculatorService), baseAddress); try { // Step 3 Add a service endpoint. selfHost.AddServiceEndpoint(typeof(ICalculator), new WSHttpBinding(), ""CalculatorService""); // Step 4 Enable metadata exchange. var smb = new ServiceMetadataBehavior(); smb.HttpGetEnabled = true; selfHost.Description.Behaviors.Add(smb); // Step 5 Start the service. selfHost.Open(); Console.WriteLine(""The service is ready.""); Console.WriteLine(""Press <ENTER> to terminate.""); Console.WriteLine(); Console.ReadLine(); // Close the ServiceHostBase to shutdown. selfHost.Close(); } catch (CommunicationException ce) { Console.WriteLine(""exception: {0}"", ce.Message); selfHost.Abort(); } }}",WCF with visual studio 2012
WCF with visual studio 2012," I am new WCF programming, I did followed series of Getting Started tutorials from following linkhttp://msdn.microsoft.com/en-us/library/ms734712.aspxI have hosted service in console application but when I tried to create a client and tried to add service reference I got the following exceptions. There was an error downloading 'http: localhost:8000/GettingStarted/mex/_vti_bin/ListData.svc/$metadata'. The request failed with HTTP status 405: Method Not Allowed. Metadata contains a reference that cannot be resolved: 'http: localhost:8000/GettingStarted/mex'. There was no endpoint listening at http: localhost:8000/GettingStarted/mex that could accept the message. This is often caused by an incorrect address or SOAP action. See InnerException, if present, for more details. The remote server returned an error: (404) Not Found. If the service is defined in the current solution, try building the solution and adding the service reference again.code of hosting application Now I am unable to figure out what the problem is. I am using visual studio 2012 and .net platform 4.5.  <code>  class Program{ static void Main(string[] args) { // Step 1 Create a URI to serve as the base address. Uri baseAddress = new Uri(""http://localhost:8000/GettingStarted/""); // Step 2 Create a ServiceHost instance ServiceHost selfHost = new ServiceHost(typeof(CalculatorService), baseAddress); try { // Step 3 Add a service endpoint. selfHost.AddServiceEndpoint(typeof(ICalculator), new WSHttpBinding(), ""CalculatorService""); // Step 4 Enable metadata exchange. var smb = new ServiceMetadataBehavior(); smb.HttpGetEnabled = true; selfHost.Description.Behaviors.Add(smb); // Step 5 Start the service. selfHost.Open(); Console.WriteLine(""The service is ready.""); Console.WriteLine(""Press <ENTER> to terminate.""); Console.WriteLine(); Console.ReadLine(); // Close the ServiceHostBase to shutdown. selfHost.Close(); } catch (CommunicationException ce) { Console.WriteLine(""exception: {0}"", ce.Message); selfHost.Abort(); } }}",WCF with visual studio 2012
Synchronization of async reading from stdout of child process," I have application that launches sub process and processes its stdout asynchronously. The problem is that the async operation takes some time and I want method responsible for process execution to end after all async IO operations are done.I have code like this: Now I'm looking for a way how to tell the program to wait until all IO (OnRecvStdOut) operations are done.I though about using one of System.Threading classes, but I'm not sure which class is the best for this and how to do this after all, the best way would probably be: And in main function: Note: I'd like to allow both StdErr and StdOut to be processed in parallel. Something can't rely that Wait will be called as much as Signal, because Increase() and DecreaseAndSignal() pairs will be called many times before Wait occurs.The second thing that came to mind was something that would be able to signal many times (without requirement to process signals) and use loop in main function like: Edit: Current working solution:I came up with this what seems to be working: But I'd appreciate any notes how to do this ""good practice way"" or what are possible risks of implementation I though of. <code>  using System.Diagnostics;Process process = new Process();// ...process.OutputDataReceived += new DataReceivedEventHandler(this.OnRecvStdOut);process.ErrorDataReceived += new DataReceivedEventHandler(this.OnRecvStdErr);// ...process.Start();process.BeginOutputReadLine();process.BeginErrorReadLine();// ...process.WaitForExit(); public void OnRecvStdOut(...){ something.Increase(); // the stuff that takes so long something.DecreaseAndSignal();} something.WaitUntilZero(); while( ioOperations > 0){ something.WaitForSignal(500);} using System.Threading;protected int IOCount = 0;protected AutoResetEvent _IOSyncEvent = new AutoResetEvent(false);public void OnRecvStdOut(...){ Interlocked.Increase( ref IOCount); // the stuff that takes so long Interlocked.Decrease( ref IOCount); IOSyncEvent.Set();}// After process.WaitForExit()while( IOCount > 0){ // 250 for a case that signal occurs after condition and before wait IOSyncEvent.WaitOne(250); }",Synchronization of asynchronous reading from stdout of child process
.net C# use WebClient with socks proxy," Is there any way to use a socks proxy with WebClient? Specifically with the DownloadString method that it provides? I don't want to use any third party stuff like privoxy, freecap whatever and I can't use commercial libraries like those from Chilkat. I tried using stuff from http://www.mentalis.org/ in fact I used their WebRequest implementation but they don't seem to have something similar for WebClient. <code> ",Use WebClient with socks proxy
Why adding suspendLayout and resumeLayout reducing performance?," I need to add a lot of controls to a parent control.But I find if I add ParentControl.SuspendLayout and ParentControl.ResumeLayout before and after I add those controls to the parent, I use stopwatch to measure the ticks:If I remove the code ParentControl.SuspendLayout and ParentControl.ResumeLayout, it will be faster. Why does it happen?So SuspendLayout and ResumeLayout are not supposed to reduce the time to add sub controls, right? So what's the benefit to use SuspendLayout and ResumeLayout or in other words, if I don't use SuspendLayout and ResumeLayout but add the sub controls directly to parents, what's the bad? <code> ",Why is adding SuspendLayout and ResumeLayout reducing performance?
"In C#, if my interface must return Task; What is the best way to have a no-operation implementation?"," In the code below, due to the interface, the class LazyBar must return a task from its method (and for argument's sake can't be changed). If LazyBars implementation is unusual in that it happens to run quickly and synchronously - what is the best way to return a No-Operation task from the method?I have gone with Task.Delay(0) below, however I would like to know if this has any performance side-effects if the function is called a lot (for argument's sake, say hundreds of times a second):Does this syntactic sugar un-wind to something big?Does it start clogging up my application's thread pool?Is the compiler cleaver enough to deal with Delay(0) differently?Would return Task.Run(() => { }); be any different?Is there a better way? <code>  using System.Threading.Tasks;namespace MyAsyncTest{ internal interface IFooFace { Task WillBeLongRunningAsyncInTheMajorityOfImplementations(); } /// <summary> /// An implementation, that unlike most cases, will not have a long-running /// operation in 'WillBeLongRunningAsyncInTheMajorityOfImplementations' /// </summary> internal class LazyBar : IFooFace { #region IFooFace Members public Task WillBeLongRunningAsyncInTheMajorityOfImplementations() { // First, do something really quick var x = 1; // Can't return 'null' here! Does 'Task.Delay(0)' have any performance considerations? // Is it a real no-op, or if I call this a lot, will it adversely affect the // underlying thread-pool? Better way? return Task.Delay(0); // Any different? // return Task.Run(() => { }); // If my task returned something, I would do: // return Task.FromResult<int>(12345); } #endregion } internal class Program { private static void Main(string[] args) { Test(); } private static async void Test() { IFooFace foo = FactoryCreate(); await foo.WillBeLongRunningAsyncInTheMajorityOfImplementations(); return; } private static IFooFace FactoryCreate() { return new LazyBar(); } }}",If my interface must return Task what is the best way to have a no-operation implementation?
Optimizing time it takes for an empty method to run in C#?," Ive been working on a C# maze generator for a while which can generate mazes of like 128000x128000 pixels. All memory usage is optimized already so Im currently looking at speeding the generation up.A problem (well more off an interest point) I found was the following (just some example code to illustrate the problem):This code runs in about 1.4 seconds on my machine when pixelChanged is null: Where the following code runs actually 0.4 seconds faster It seems that when just calling an empty method takes about 20% of the cpu this algorithm uses. Isnt this strange? Ive tried to compile the solution in debug and release mode but havent found any noticeable differences.What this means is that every method call I have in this loop will slow my code down by about 0.4 seconds. Since the maze generator code currently consist of a lot of seperate method calls that excecute different actions this starts to get a substantial ammount.I've also checked google and other posts on Stack Overflow but haven't really found a solution yet.Is it possible to automatically optimize code like this? (Maybe with things like project Roslyn???) or should I place everything together in one big method?Edit:I'm also interested in maybe some analysis on the JIT/CLR code differences in these 2 cases. (So where this problem actually comes from)Edit2:All code was compiled in release mode <code>  public void Go(){ for (int i = 0; i < bitjes.Length; i++) { BitArray curArray = bitjes[i]; for (int y = 0; y < curArray.Length; y++) { curArray[y] = !curArray[y]; GoDrawPixel(i, y, false); } }}public void GoDrawPixel(int i, int y, Boolean enabled){ if (pixelChanged != null) { pixelChanged.Invoke(new PixelChangedEventArgs(i, y, enabled)); }} public void Go(){ for (int i = 0; i < bitjes.Length; i++) { BitArray curArray = bitjes[i]; for (int y = 0; y < curArray.Length; y++) { curArray[y] = !curArray[y]; if (pixelChanged != null) { pixelChanged.Invoke(new PixelChangedEventArgs(i, y, false)); } } }}",What is the overhead for a method call in a loop?
Delete selected items from listbox c#," I want to do that but, the listbox changes on every deletion, so it throws runtime exception even if I tried to do a new object.I tried like this: <code>  ListBox.SelectedObjectCollection selectedItems = new ListBox.SelectedObjectCollection(lstClientes); selectedItems = lstClientes.SelectedItems;if (lstClientes.SelectedIndex != -1){ foreach (string s in selectedItems) lstClientes.Items.Remove(s);}else MessageBox.Show(""Debe seleccionar un email"");",Delete selected items from listbox
Difference b/w Static and Non-Static members?," Possible Duplicate: Whats a static method in c#? I found it difficult to clear my mind about the actual concept of static and non-static(instance) members, after researching from so many forums i decided to put my question here:What is the difference between static and non static members? <code> ",Difference between static and non static members?
How to set the IP (UserHostAddress) on a new HttpRequest?," I'm trying to create a dummy BaseHttpContext to do some (mock) testing without having to do an actual request. I like to add an IP address to my dummy context. The IP should be reflected in the BaseHttpContext.Request.UserHostAddress. Adding an IP like this: request.ServerVariables.Add(""REMOTE_ADDR"", ip);, results in the following exception: Specified method is not supported. <code>  string url = ""http://www.google.com"";//wrap in uriUri uri = new Uri(url);//create requestvar request = new HttpRequest("""", uri.GetLeftPart(UriPartial.Path), uri.Query);request.ServerVariables.Add(""REMOTE_ADDR"", ip);//dummy contextHttpContext context = new HttpContext( new HttpRequest("""", uri.GetLeftPart(UriPartial.Path), uri.Query), new HttpResponse(new StringWriter(System.Text.Encoding.UTF8)));//wrap contextvar contextWrapper = new HttpContextWrapper(context);","How to set the IP (UserHostAddress) on a ""mocked' BaseHttpContext?"
IEnumerable vs ICollection vs IList," I need to design my own custom GenericCollection class. Now i have plenty of options to derive it using IEnumerable, ICollection, and IList, where later offers some added functionalities.I am little confused that if i go with IEnumerable<T> i might require declaring the object to actually hold the collection like in this case _list. But if i go with ICollection<T> or IList<T>, i do not require to declare the List object as it is implicitly available. What is the difference between these two approaches with respect to performance?In which scenario each one is preferred especially when it comes to designing your own collection. I am interested in the light weight collection with good performance. I think this can be achieved using IEnumerable<T> but how exactly along with some strong reasons to go with it?I have reviewed some existing posts but none is giving required information.Returning 'IList' vs 'ICollection' vs 'Collection' <code>  public class GenericCollection<T> : IEnumerable<T>{ private List<T> _list; //...} public class GenericCollection<T> : IList<T>{ // no need for List object //private List<T> _list; //...}",Custom Collection using IEnumerable vs ICollection vs IList
Allow only numbers and negetive values, I have a textbox which needs only accept numbers (can be decimal values) and negative values.Currently I have something like this in KeyPress event What else I should do in order to allow negative values?Thanks <code>  if (!char.IsControl(e.KeyChar) && !char.IsDigit(e.KeyChar) && e.KeyChar != '.') { e.Handled = true; },Allow only numbers and negative values
Why is List<T>.ForEach extension missing from .NET Core?," I was porting some code over to work with a Windows Store App and noticed that the List<T>.ForEach method isn't included in the .NET Core framework (the framework referenced by Windows Store Apps).MSDN confirms that it is not supported for Store Apps.I can easily get around the missing method, but at this point I'm just curious why it's missing. <code> ",Why is List<T>.ForEach missing from .NET Core?
C# send excel file by email," I have an excel file (Excel 2003 / xls format) and I want to send it by email with c#.My code send it successfully, but when I try to open the response file, it seems to encoded wrongly.For example here is the response filename: =_utf-8_B_RWxzesOhbW9sw6FzXzIwMTJfMTBfMTZf.datAnd here is the response file itself: =?utf-8?B?VEdWdmJIWmhjMkZ1Wk1Pelh6UXlYekZmPz0NCiA9P3V0Zi04P0I/VGtW?=\ \ =?utf-8?B?TlgwZFRXaTU0YkhNPT89?="" Content-Transfer-Encoding: base64 Content-Disposition: attachment 0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAA AQAAAAAAAAAAEAAAIwAAAAEAAAD+////AAAAAAAAAAD///////////////////// //////////////////////////////////////////////////////////////// ////////////////////////////// ....Here is my code fragment: How can I set the attachment encoding type, and which encoding should I use with Excel files?Please help me solve this problem.Thanks in advance. <code>  ...var attachment = new Attachment(WriteFileToMemory(""fileFullPath""), ""fileName.xls"");attachment.ContentType = new ContentType(""application/vnd.ms-excel"");attachmentCollection.Add(attachment);...private Stream WriteFileToMemory(string filePath){ var memoryStream = new MemoryStream(); _openedStreams.Add(memoryStream); using (var file = new FileStream(filePath, FileMode.Open, FileAccess.Read)) { var bytes = new byte[file.Length]; file.Read(bytes, 0, (int) file.Length); memoryStream.Write(bytes, 0, (int) file.Length); file.Close(); } memoryStream.Position = 0; return memoryStream;}",How can I send an Excel file by email?
C# - WCF error : 405 Method Not Allowed," Going nuts with this issue. I have a solution with 2 projects, one of them is a plain old html with jquery ajax call while the other is a WCF service. The html page will issue a ajax call to the WCF service to get a json string and use it for display purpose.Now the issue is whenever i run in debug mode, both the html page and the WCF will be started with different port. And this has created a cross-origin issue for me when i perform testing (i.e. getting a 405 Method Not Allowed error with the calling type = OPTIONS in Firefox). I'd triple check the call method on my ajax script and the WCF service is the same (GET).I'd search google but found that either i have to install a extension or perform some configuration on IIS, which i found cumbersome since what i'm doing is something simple. Following one example, I'd add in the following configuration in my web.config but it didn't work: Any one has any idea to get rid of this annoying issue?EDIT: Just to add, I'm running the debug with IIS Express that comes together with the VS Studio 2012Add in WCF Code and Updated web.config My Script: <code>  <system.serviceModel> <bindings> <webHttpBinding> <binding name=""crossDomain"" crossDomainScriptAccessEnabled=""true"" /> </webHttpBinding> </bindings> <behaviors> <endpointBehaviors> <behavior name=""MobileService.webHttpBehavior""> <webHttp /> </behavior> </endpointBehaviors> <serviceBehaviors> <behavior name=""MyServiceBehavior""> <serviceMetadata httpGetEnabled=""true"" /> <serviceDebug includeExceptionDetailInFaults=""true""/> </behavior> </serviceBehaviors> </behaviors> <serviceHostingEnvironment aspNetCompatibilityEnabled=""true"" multipleSiteBindingsEnabled=""true"" /> <services> <service name=""MobileService.SimpleMemberInfo"" behaviorConfiguration=""MyServiceBehavior""> <endpoint address="""" binding=""webHttpBinding"" contract=""MobileService.IMemberInfo"" bindingConfiguration=""crossDomain"" behaviorConfiguration=""MobileService.webHttpBehavior""> </endpoint> </service> </services> </system.serviceModel> <system.webServer> <httpProtocol> <customHeaders> <add name=""Access-Control-Allow-Origin"" value=""*"" /> <add name=""Access-Control-Allow-Methods"" value=""GET"" /> <add name=""Access-Control-Allow-Headers"" value=""Content-Type, Accept"" /> </customHeaders> </httpProtocol> <modules runAllManagedModulesForAllRequests=""true""/> <directoryBrowse enabled=""true""/> </system.webServer> [ServiceContract]public interface IMemberInfo{ [WebInvoke(Method = ""GET"", BodyStyle = WebMessageBodyStyle.Wrapped, ResponseFormat = WebMessageFormat.Json )] [OperationContract] string GetMemberInfoById(); // TODO: Add your service operations here} $(document).ready(function () { $.ajax(""http://localhost:32972/SimpleMemberInfo.svc/GetMemberInfoById"", { cache: false, beforeSend: function (xhr) { $.mobile.showPageLoadingMsg(); }, complete: function () { $.mobile.hidePageLoadingMsg(); }, contentType: 'application/json', dataType: 'json', type: 'GET', error: function () { alert('Something awful happened'); }, success: function (data) { var s = """"; s += ""<li>"" + data + ""</li>""; $(""#myList"").html(s); } });});",WCF error : 405 Method Not Allowed
How to display different object in gridview?," A table in my database has stored pictures, documents, dll halyards and so on. How do I implement the mapping of all this for a user?I bind these data to a data table, and want to have hyperlinks in each cell, which when clicked, invokes/opens the corresponding item from the database. In DB next atributes: i_id(number), i_objecttype_id(number), s_code(nvarchar), s_name(nvarchar), m_content(blob), m_description(nvarchar)On client I see next: i_id(number), i_objecttype_id(number), s_code(nvarchar), s_name(nvarchar), m_description(nvarchar).Without atribute m_content. <code>  OracleCommand oracleCom = new OracleCommand();oracleCom.Connection = oraConnect;oracleCom.CommandText = ""Select * From "" + Session[""tableNameIns""];OracleDataAdapter adapter = new Oraenter code herecleDataAdapter();DataTable tableD = new DataTable();tableD.Locale = System.Globalization.CultureInfo.InvariantCulture;adapter.SelectCommand = oracleCom;adapter.Fill(tableD);changeTableAtributs(tableD);tableResults.DataSource = tableD.AsDataView();tableResults.DataBind();",How to display different objects in gridview?
how to use .NET Action to execute a method with unknown number of parameters?," I want to execute some operations on a worker thread while displaying a progress bar to the user. I've created a class I found out that I can send any method to the StartAsyncTask in the following way: First of all, I can't seem to understand what is and how is lambda expression - () => - translated and how is the Action object passed a delegate with an unknown number of parameters. I would like to use a BackgroundWorker with my ProgressBar but in this case I would need to invoke the action. So something like this: How is it possible in the first example to execute the action without knowing the parameters in StartAsyncTask(Action action) method?Why do I need to know the parameters when invoking the action in this case? Everything about how/why/when to use ""Action"" is pretty unclear to me even if I read MSDN documentation and some other threads here. Any information on this will help me. <code>  public class ProgressBar{ public void StartAsyncTask(Action action) { Task t = new Task(action); t.start(); }} ProgressBar pb = new ProgressBar(); pb.StartAsyncTask( () => DoSomething(15, ""something"")); public void DoSomething(int i, string s) { //do something } void m_backgroundWorker_DoWork(object sender, DoWorkEventArgs e){ Action action = e.Argument as Action; //same action here passed through EventArgs //but already in a worker thread so no need for the Task object //and now i need to somehow invoke the action object but i don't know what the parameters are. action.Invoke( ? ); }",How to use .NET Action to execute a method with unknown number of parameters?
C# wpf: Thumbs on line corner points do not relocate points," I am developing a drawing application in which one can draw various types of lines. On the line corner points I have placed a thumb using an itemsControl. The thumbs should move that corner point when the user left mouse clicks on it and drags the mouse. What's happening now is that when I do this the point and thumb move a little bit, but then it loses mouse capture right away and doesn't move anymore. When I debug the first dragdelta event that gets fired correctly has a full visual tree traced up from the sending thumb to the itemscontrol and beyond, but sometimes when it fires the next time, the thumb's location has not been updated, and the containing content presenter has null parents in the visual tree. This is the portion of the xaml related to the line thumb points: The code for PointRelocateThumb: }Tooline is the line class. What undo binding does is that it makes it so that toolLine has Canvas.Left and Canvas.Top set to 0, but scales the points so that they are still located at the same point - i.e. by adding the old Canvas.Left and Canvas.Top values of the toolLine to each point in the line.The code for regenerate Bounding item is below: The template for PointRelocateThumb is an ellipse of width and height 7 - which explains why I have to offset all the thumb locations by 3.5. <code>  <ItemsControl x:Name=""PART_LineRelocate"" ItemsSource=""{Binding pointsObservableCollection}"" Visibility=""Collapsed"" > <ItemsControl.ItemTemplate> <DataTemplate DataType=""{x:Type s:LineCornerPoint}"" > <Grid> <c:PointRelocateThumb VerticalAlignment=""Center"" HorizontalAlignment=""Center"" Focusable=""True"" x:Name=""PART_PointRelocateThumb"" Cursor=""Hand""/> </Grid> </DataTemplate> </ItemsControl.ItemTemplate> <ItemsControl.ItemsPanel> <ItemsPanelTemplate> <Canvas IsItemsHost=""True"" /> </ItemsPanelTemplate> </ItemsControl.ItemsPanel> <ItemsControl.ItemContainerStyle > <Style > <Style.Triggers> <DataTrigger Value=""BrokenLinkLine"" Binding=""{Binding RelativeSource={RelativeSource AncestorType={x:Type s:ToolLine}}, Path=indicator}"" > <Setter Property=""Canvas.Left"" Value=""{Binding Corner.X}"" /> <Setter Property=""Canvas.Top"" Value=""{Binding Corner.Y}"" /> </DataTrigger> ....More of these datatriggers for the different types of lines </Style.Triggers> </Style> </ItemsControl.ItemContainerStyle> public PointRelocateThumb() { base.DragDelta += new DragDeltaEventHandler(this.PointRelocateThumb_DragDelta); } void PointRelocateThumb_DragDelta(object sender, System.Windows.Controls.Primitives.DragDeltaEventArgs e) { PointRelocateThumb prt = (PointRelocateThumb)sender; LineCornerPoint lcp = (LineCornerPoint)prt.DataContext; Point thumbPoint = new Point(Canvas.GetLeft((ContentPresenter)prt.TemplatedParent), Canvas.GetTop((ContentPresenter)prt.TemplatedParent)); ToolLine toolLine = null; DrawingCanvas designer = null; ItemsControl itemsControl = ItemsControl.ItemsControlFromItemContainer(prt.TemplatedParent); if (itemsControl != null) toolLine = itemsControl.DataContext as ToolLine; if (toolLine != null) designer = VisualTreeHelper.GetParent(toolLine) as DrawingCanvas; if (toolLine != null && designer != null && toolLine.IsSelected) { thumbPoint = new Point(thumbPoint.X + Canvas.GetLeft(toolLine) + 3.5, thumbPoint.Y + Canvas.GetTop(toolLine) + 3.5); toolLine.undoBounding(); if (System.String.Compare(toolLine.indicator, ""BrokenLinkLine"") == 0 || System.String.Compare(toolLine.indicator, ""LinkLine"") == 0 || System.String.Compare(toolLine.indicator, ""OrthogonalLinkLine"") == 0 || System.String.Compare(toolLine.indicator, ""BrokenLine"") == 0 || System.String.Compare(toolLine.indicator, ""Line"") == 0 || System.String.Compare(toolLine.indicator, ""Polygon"") == 0) { if (toolLine.pathFigure.StartPoint.Equals(thumbPoint)) { toolLine.pathFigure.StartPoint = new Point(modifyingToolLine.pathFigure.StartPoint.X + e.HorizontalChange, modifyingToolLine.pathFigure.StartPoint.Y + e.VerticalChange); } else { foreach (LineSegment ls in toolLine.pathSegmentCollection) { if (ls.Point.Equals(thumbPoint)) { ls.Point = new Point(ls.Point.X + e.HorizontalChange, ls.Point.Y + e.VerticalChange); break; } } } } toolLine.regenerateBoundingItem(); } e.Handled = true; } } public void regenerateBoundingItem(){ //Following line of code just regenerates the underlying path for the toolLine from the //new pathsegmentCollection and pathFigure start point. regenerateThisLine(); double leftMostPoint = double.MaxValue, topMostPoint = double.MaxValue, bottomMostPoint = double.MinValue, rightMostPoint = double.MinValue; getBoundingPoints(ref leftMostPoint, ref topMostPoint, ref bottomMostPoint, ref rightMostPoint); //subtracts leftMost point and topMostPoint from each point in the line scaleLinePoints(leftMostPoint, topMostPoint); Canvas.SetLeft(this, leftMostPoint); Canvas.SetTop(this, topMostPoint); this.Width = rightMostPoint - leftMostPoint; this.Height = bottomMostPoint-topMostPoint; regenerateObservableCollection(); regenerateThisLine();}private void regenerateObservableCollection(){ if (this.pointsObservableCollection == null) this.pointsObservableCollection = new ObservableCollection<LineCornerPoint>(); this.pointsObservableCollection.Clear(); LineCornerPoint startPt = new LineCornerPoint(new Point(this.pathFigure.StartPoint.X - 3.5, this.pathFigure.StartPoint.Y - 3.5)); this.pointsObservableCollection.Add(startPt); if (System.String.Compare(indicator, ""BrokenLine"") == 0 || System.String.Compare(indicator, ""BrokenLinkLine"") == 0 || System.String.Compare(indicator, ""LinkLine"") == 0 || System.String.Compare(indicator, ""Polygon"") == 0 || System.String.Compare(indicator, ""Line"") == 0) { foreach (LineSegment ls in pathSegmentCollection) { LineCornerPoint pt = new LineCornerPoint(new Point(ls.Point.X - 3.5, ls.Point.Y - 3.5)); this.pointsObservableCollection.Add(pt); } }}",Thumbs on line corner points do not relocate points
C# string replace does not work," I am trying to replace a part of string with another another string. To be more preciseI have C:\Users\Desktop\Project\bin\Debugand I am trying to replace \bin\Debug with \Resources\PeopleI have tried the following:path.Replace(@""\bin\Debug"", @""\Resource\People\VisitingFaculty.txt"");path.Replace(""\\bin\\Debug"", ""\\Resource\\People\\VisitingFaculty.txt"");None of the above two seems to work, as the string remains the same and nothing is replaced. Am I doing something wrong?  <code> ",C# string replace does not actually replace the value in the string
what is the php equivalent of this c# enocding code?," I want to turn the following C# code into PHP.The C# is: Which I've turned into this: Then I have: Which I think should be: Or But not certain, notice this second encoding uses Encoding.UTF8, not UTF8Encoding.UTF8.What should the PHP code look like? <code>  byte[] operation = UTF8Encoding.UTF8.GetBytes(""getfaqs"");byte[] secret = UTF8Encoding.UTF8.GetBytes(""Password"");var hmac = newHMACSHA256(secret);byte[] hash = hmac.ComputeHash(operation); $hash = hash_hmac( ""sha256"", utf8_encode(""getfaqs""), utf8_encode(""Password"")); var apiKey = ""ABC-DEF1234"";var authInfo = apiKey + "":"" + hash//base64 encode the authorisation infovar authorisationHeader = Convert.ToBase64String(Encoding.UTF8.GetBytes(authInfo)); $authInfo = base64_encode($apiKey . "":"" . $hash); $authInfo = base64_encode(utf8_encode($apiKey . "":"" . $hash));",What is the PHP equivalent of this C# encoding code?
what is the php equivalent of this c# encoding code?," I want to turn the following C# code into PHP.The C# is: Which I've turned into this: Then I have: Which I think should be: Or But not certain, notice this second encoding uses Encoding.UTF8, not UTF8Encoding.UTF8.What should the PHP code look like? <code>  byte[] operation = UTF8Encoding.UTF8.GetBytes(""getfaqs"");byte[] secret = UTF8Encoding.UTF8.GetBytes(""Password"");var hmac = newHMACSHA256(secret);byte[] hash = hmac.ComputeHash(operation); $hash = hash_hmac( ""sha256"", utf8_encode(""getfaqs""), utf8_encode(""Password"")); var apiKey = ""ABC-DEF1234"";var authInfo = apiKey + "":"" + hash//base64 encode the authorisation infovar authorisationHeader = Convert.ToBase64String(Encoding.UTF8.GetBytes(authInfo)); $authInfo = base64_encode($apiKey . "":"" . $hash); $authInfo = base64_encode(utf8_encode($apiKey . "":"" . $hash));",What is the PHP equivalent of this C# encoding code?
Best way to imit WCF Service to specific User Accounts," I will be hosting a basic HTTP WCF service using Window Service / Service Host.I would like to limit the service to 2 specific window active directory users and these accounts will vary between PRD and DEV environments so they will be set in a config file.I was wondering what is the best way to do this, I know normally if I was hosting the service using IIS then I could limit it in the Web.config:http://www.rickgaribay.net/archive/2007/04/04/recipe-wcf-basichttpbinding-with-windows-authentication.aspxHowever since i'm hosting using ServiceHost then I don't believe this is an option.From what I read it seems possible to do this using PrincipalPermission Declarative attribute at the service class level:http://msdn.microsoft.com/en-us/library/vstudio/ms731200(v=vs.100).aspxHowever I'm not too clear whether this will pass the window account of window service or the account which made the HTTP request. What I need is to pass the HTTP request account.Also, with declartive attributes, is it possible to use a config file attribute rather than a hard coded one?Any suggestions, if you need any more info then let me know. <code> ",Best way to limit WCF Service to specific User Accounts
Does AvalonEdit :TextEditor has quick search/replace functionality?, I use AvalonEdit:TextEditor. Can i enable quick search dialog (on Ctrl-F for example) for this control? Or maybe someone has code for search words into AvalonEdit:TextEditor text? <code> ,Does AvalonEdit :TextEditor have quick search/replace functionality?
c# when i set toolstripmenuitem's enabled value to false and brought cursor over the menu item a blue border is appearing. How do i prevent this?," Yes, exactly same as the title, in my project some of toolstripmenuitems were disabled. But when i bring the cursor over the menu item, a blue border is appearing like this:But i don't want this. I want it like this: Could you help me, how do i prevent this blue border? <code> ",How can I prevent a disabled ToolStripMenuItem from showing a border on mouse over?
How can I prevent a disabled ToolStripMenuItem from showing a border on mouse over?," Yes, exactly same as the title, in my project some of toolstripmenuitems were disabled. But when i bring the cursor over the menu item, a blue border is appearing like this:But i don't want this. I want it like this: Could you help me, how do i prevent this blue border? <code> ",How can I prevent a disabled ToolStripMenuItem from showing a border on mouse over?
C# Format decimal as currency based on currency code," I have a table of charges with the amount, and the currency code (USD, JPY, CAD, EUR etc.), and am looking for the easiest way to properly format the currency. Using my local culture code (USA) and taking my decimal.ToString(""c"") gets me $0.00 output, but I'd like the correct currency sign and number of decimals based on the code.Do any libraries exist for this? I can of course write up a switch statement and custom rules for each one, but thought this must have been done before.Update:I've modified Jon B's sample code as follows This allows me to simply go Amount.ToString(Currency[""JPY""]), and the format will output the comma separator in my local context, but put the correct currency symbol and decimal places in automatically.Let me know if anyone has a cleaner way of doing this, or I will mark Jon's answer as correct shortly. <code>  static IDictionary<string, string> GetCurrencyFormatStrings(){ var result = new Dictionary<string, string>(); foreach (var ci in CultureInfo.GetCultures(CultureTypes.AllCultures)) { try { var ri = new RegionInfo(ci.Name); result[ri.ISOCurrencySymbol] = string.Format(""{0}#,#0.{1};({0}#,#0.{1})"", ri.CurrencySymbol, new string('0', i.NumberFormat.CurrencyDecimalDigits)); } catch { } } return result;}",Format decimal as currency based on currency code
c# Notification Icon," I'm trying to use the below code to show a Balloon notification. I've verified that it's being executed by using breakpoints. It's also showing no errors.What should I do to debug this since it's not throwing errors and not showing the balloon? <code>  private void showBalloon(string title, string body){ NotifyIcon notifyIcon = new NotifyIcon(); notifyIcon.Visible = true; if (title != null) { notifyIcon.BalloonTipTitle = title; } if (body != null) { notifyIcon.BalloonTipText = body; } notifyIcon.ShowBalloonTip(30000);}",Show a Balloon notification
Prevent your winform from getting maximized," I want to prevent my desktop application from being maximized. It should not become maximized by any means - by double clicking on title bar, or by clicking Windows + Up arrow on the keyboard, etc.-> I disable both the MaximizeBox and MinimizeBox.-> I also set the MaximumSize and MinimumSize for my WinFormStill when I press Windows + Up arrow, my win form Shifts to top left of the screen, I mean it gets maximized.So please tell me any way to prevent this thing happening... <code> ",Preventing Winform from being maximized?
log4net creates log file but does not write to it (windows service in C#)," I am trying to use basic logging for a windows service. I added the reference to log4net.I added the following in AssemblyInfo.cs: I added the following to my App.config: I have the following code in my service: The file c:\CGSD\log\logfile.txt is created but nothing is ever written to it.I've been through the forums all day trying to track this one down, but if I overlooked an already posted solution I apologize. <code>  [assembly: log4net.Config.XmlConfigurator(Watch = true)] <?xml version=""1.0"" encoding=""utf-8"" ?><configuration> <configSections> <section name=""log4net"" type=""log4net.Config.Log4NetConfigurationSectionHandler,log4net, Version=1.2.10.0, Culture=neutral, PublicKeyToken=1b44e1d426115821"" requirePermission=""false"" /> </configSections> <!-- Log4net Logging Setup --> <log4net> <appender name=""RollingFileAppender"" type=""log4net.Appender.RollingFileAppender,log4net""> <file value=""c:\\CGSD\\log\\logfile.txt"" /> <appendToFile value=""true"" /> <lockingModel type=""log4net.Appender.FileAppender+MinimalLock"" /> <layout type=""log4net.Layout.PatternLayout""> <conversionPattern value=""%date [%thread] %level %logger - %message%newline"" /> </layout> <filter type=""log4net.Filter.LevelRangeFilter""> <levelMin value=""INFO"" /> <levelMax value=""FATAL"" /> </filter> </appender> <root> <level value=""ALL""/> <appender-ref ref=""RollingFileAppender""/> </root> </log4net></configuration> log4net.Config.XmlConfigurator.Configure(); log4net.ILog log = log4net.LogManager.GetLogger(typeof(Program)); log.Debug(""test"");",log4net creates log file but does not write to it
WPF: How to change Resource Dictionary Color in the runtime," In XAML: In C#: How to change those Color elements in the runtime in C#. The LinearGradientBrush should get changed dynamically?I wish to do something like this: but I failed. <code>  <ResourceDictionary> <Color x:Key=""BrushColor1"">Red</Color> <Color x:Key=""BrushColor2"">Black</Color> <LinearGradientBrush x:Key=""GradientBrush1"" StartPoint=""0,0.5"" EndPoint=""1,0.5""> <GradientStop Color=""{DynamicResource BrushColor2}"" Offset=""0"" /> <GradientStop Color=""{DynamicResource BrushColor1}"" Offset=""1"" /> </LinearGradientBrush></ResourceDictionary> public void CreateTestRect() { Rectangle exampleRectangle = new Rectangle(); exampleRectangle.Width = 150; exampleRectangle.Height = 150; exampleRectangle.StrokeThickness = 4; exampleRectangle.Margin = new Thickness(350); ResourceDictionary resources = this.Resources; resources[""BrushColor1""] = Colors.Pink; resources[""BrushColor2""] = Colors.RoyalBlue; Brush brush =(Brush)this.FindResource(""GradientBrush1""); exampleRectangle.Fill = brush; canvas.Children.Insert(0, exampleRectangle); } (Color)(this.FindResource(""BrushColor1"")) = Colors.Pink;",How to change Resource Dictionary Color in the runtime
grouping dictionary," I have a dictionary: Dictionary<int,int>. I want to get new dictionary where keys of original dictionary represent as List<int>. This is what I mean: The prices contain the following data: I want to get the IList<Dictionary<int,List<int>>>: How can I do this?  <code>  var prices = new Dictionary<int,int>(); 1 1002 2003 1004 300 int List<int>100 1,3200 2300 4","""Grouping"" dictionary by value"
"""grouping"" dictionary"," I have a dictionary: Dictionary<int,int>. I want to get new dictionary where keys of original dictionary represent as List<int>. This is what I mean: The prices contain the following data: I want to get the IList<Dictionary<int,List<int>>>: How can I do this?  <code>  var prices = new Dictionary<int,int>(); 1 1002 2003 1004 300 int List<int>100 1,3200 2300 4","""Grouping"" dictionary by value"
How to remove or hide particular column datatable in C+#," I am using C#. I want to hide or remove the column from DataTable or DataSet . I attach my partial code: <code>  DataTable dt = new DataTable();DataView dv = new DataView();dv = (DataView)Session[""map_hi""];dt = dv.ToTable();dt.Columns[0].ColumnMapping = MappingType.Hidden;dt.AcceptChanges();",How to remove or hide particular column in a datatable?
how to display context menu for treeview item in a hierarchial data template in wpf," How to display context menu for tree view item in wpf using the hierarchical data template? How to display context menu only for CountryTemplate: <code>  <HierarchicalDataTemplate x:Key=""DispTemplate""> <StackPanel Orientation=""Horizontal""> <TextBlock Text=""{Binding Path=Label}"" Style=""{StaticResource TreeTextStyle}"" ToolTip=""{Binding Path=Description}"" Tag=""{Binding Path=Tag}""> </TextBlock> </StackPanel> </HierarchicalDataTemplate> <HierarchicalDataTemplate x:Key=""BuildingTemplate"" ItemsSource=""{Binding Path=Building}"" ItemTemplate=""{StaticResource BuildingTemplate}""> <StackPanel Orientation=""Horizontal""> <TextBlock Text=""{Binding Path=Label}"" Style=""{StaticResource TreeTextStyle}"" ToolTip=""{Binding Path=Description}""/> </StackPanel> </HierarchicalDataTemplate> <HierarchicalDataTemplate x:Key=""CityTemplate"" ItemsSource=""{Binding Path=City}"" ItemTemplate=""{StaticResource CityTemplate}""> <StackPanel Orientation=""Horizontal""> <TextBlock Text=""{Binding Path=Label}"" Style=""{StaticResource TreeTextStyle}"" ToolTip=""{Binding Path=Description}""/> </StackPanel> </HierarchicalDataTemplate> <HierarchicalDataTemplate x:Key=""CountryTemplate"" ItemsSource=""{Binding Path=Country}"" ItemTemplate=""{StaticResource CountryTemplate}""> <StackPanel Orientation=""Horizontal""> <TextBlock Text=""{Binding Path=RootName}"" Style=""{StaticResource TreeTextStyle}"" ToolTip=""{Binding Path=Description}""/> </StackPanel> </HierarchicalDataTemplate>",How to display context menu for treeview item in a hierarchial data template in wpf
Task vs Therad diffrences," I'm new to parallel programming. There are two classes available in .NET: Task and Thread.So, my questions are:What is the difference between those classes?When is it better to use Thread over Task (and vice-versa)? <code> ",Task vs Thread differences
Task vs Thread diffrences," I'm new to parallel programming. There are two classes available in .NET: Task and Thread.So, my questions are:What is the difference between those classes?When is it better to use Thread over Task (and vice-versa)? <code> ",Task vs Thread differences
ASP.NET MVC 4 Areas Routing," I created MVC Application that have 3 different Area. (Admin, User, News)This is my RouteConfig.cs File in App_Start directory: And This is my AdminAreaRegisteration.cs file: And finally this is my Global.asax.cs file content: Home page of my website fully loaded and it's works. but Homepage of Admin or other areas are not detect by route and I gave this error message: How can I solve this problem?Thanks. <code>  public class RouteConfig{ public static void RegisterRoutes(RouteCollection routes) { routes.IgnoreRoute(""{resource}.axd/{*pathInfo}""); routes.MapRoute( name: ""Default"", url: ""{controller}/{action}/{id}"", defaults: new { controller = ""Home"", action = ""Index"", id = UrlParameter.Optional }, namespaces: new[] { ""TestMvcApplication.Controllers"" } ); }} namespace TestMvcApplication.Areas.Admin{ public class AdminAreaRegistration : AreaRegistration { public override string AreaName { get { return ""Admin""; } } public override void RegisterArea(AreaRegistrationContext context) { context.MapRoute( ""Admin_default"", ""Admin/{controller}/{action}/{id}"", new { controller = ""Home"", action = ""Index"", id = UrlParameter.Optional }, namespaces: new[] { ""TestMvcApplication.Areas.Admin.Controllers"" } ); } }} namespace TestMvcApplication{ // Note: For instructions on enabling IIS6 or IIS7 classic mode, // visit http://go.microsoft.com/?LinkId=9394801 public class MvcApplication : System.Web.HttpApplication { protected void Application_Start() { AreaRegistration.RegisterAllAreas(); WebApiConfig.Register(GlobalConfiguration.Configuration); FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters); RouteConfig.RegisterRoutes(RouteTable.Routes); BundleConfig.RegisterBundles(BundleTable.Bundles); AuthConfig.RegisterAuth(); } }} Server Error in '/' Application.The resource cannot be found.Description: HTTP 404. The resource you are looking for (or one of its dependencies) could have been removed, had its name changed, or is temporarily unavailable. Please review the following URL and make sure that it is spelled correctly.Requested URL: /Admin/Home",How to register areas for routing
"After updating entityframework model, visualstudio does not see changes"," If I do any changes to my EF 5.0 model, VS does not seem to see the changes. I have tried adding a new table, which shows up fine in the model, but then if I try to use it somewhere the table does not show up in intellisense and I can't use it.I have also tried changing datatypes of a column, which again shows up fine if I look at the .edmx model file, but visual studio will still give me compiler errors on that field because I am trying to assign the incorrect datatype.If I delete the EDMX completely, and recreate it, then the changes work fine. but it is tiresome to regenerate from database each time when I should be able to just ""update model from database"" and rebuild.I have never had these problems with EF before. Does anyone know the cause or the fix to this problem?Thanks. <code> ","After updating Entity Framework model, Visual Studio does not see changes"
Best practice to call ConfigureAwait(false) for all server-side code (using ASP.NET Web API)," When you have server-side code (i.e. some ApiController) and your functions are asynchronous - so they return Task<SomeObject> - is it considered best practice that any time you await functions that you call ConfigureAwait(false)?I had read that it is more performant since it doesn't have to switch thread contexts back to the original thread context. However, with ASP.NET Web Api, if your request is coming in on one thread, and you await some function and call ConfigureAwait(false) that could potentially put you on a different thread when you are returning the final result of your ApiController function.I've typed up an example of what I am talking about below: <code>  public class CustomerController : ApiController{ public async Task<Customer> Get(int id) { // you are on a particular thread here var customer = await GetCustomerAsync(id).ConfigureAwait(false); // now you are on a different thread! will that cause problems? return customer; }}",Best practice to call ConfigureAwait for all server-side code
how can i split a list in parts with LINQ," I would like to split a list in parts, without knowing how much items I will have in that list. The question is different from those of you who wants to split a list into chunk of fixed size. I would like the values to be splitted vertically.Splitted in 2 : Splitted in 3: Splitted in 4: I've found a few c# extensions that can do that but it doesn't distribute the value the way I want. Here's what I've found: the result is this but my problem is that the value are distributed horizontally: or any idea how I can distribute my values vertically and have the possibility to choose the number of parts that i want?In real lifeFor those of you who want to know in which situation I would like to split a list vertically, here's a screenshot of a section of my website: <code>  int[] a = new int[] { 1, 2, 3, 4, 5, 6, 7, 8, 9 }; -------------------| item 1 | item 6 || item 2 | item 7 || item 3 | item 8 || item 4 | item 9 || item 5 | | | item 1 | item 4 | item 7 || item 2 | item 5 | item 8 || item 3 | item 6 | item 9 | | item 1 | item 4 | item 6 | item 8 || item 2 | item 5 | item 7 | item 9 || item 3 | | | | // this technic is an horizontal distributionpublic static IEnumerable<IEnumerable<T>> Split<T>(this IEnumerable<T> list, int parts){ int i = 0; var splits = from item in list group item by i++ % parts into part select part.AsEnumerable(); return splits;} | item 1 | item 2 || item 3 | item 4 || item 5 | item 6 || item 7 | item 8 || item 9 | | | item 1 | item 2 | item 3 || item 4 | item 5 | item 6 || item 7 | item 8 | item 9 |",How can I split a list vertically in n parts with LINQ
how can i split a list in (n) parts with LINQ," I would like to split a list in parts, without knowing how much items I will have in that list. The question is different from those of you who wants to split a list into chunk of fixed size. I would like the values to be splitted vertically.Splitted in 2 : Splitted in 3: Splitted in 4: I've found a few c# extensions that can do that but it doesn't distribute the value the way I want. Here's what I've found: the result is this but my problem is that the value are distributed horizontally: or any idea how I can distribute my values vertically and have the possibility to choose the number of parts that i want?In real lifeFor those of you who want to know in which situation I would like to split a list vertically, here's a screenshot of a section of my website: <code>  int[] a = new int[] { 1, 2, 3, 4, 5, 6, 7, 8, 9 }; -------------------| item 1 | item 6 || item 2 | item 7 || item 3 | item 8 || item 4 | item 9 || item 5 | | | item 1 | item 4 | item 7 || item 2 | item 5 | item 8 || item 3 | item 6 | item 9 | | item 1 | item 4 | item 6 | item 8 || item 2 | item 5 | item 7 | item 9 || item 3 | | | | // this technic is an horizontal distributionpublic static IEnumerable<IEnumerable<T>> Split<T>(this IEnumerable<T> list, int parts){ int i = 0; var splits = from item in list group item by i++ % parts into part select part.AsEnumerable(); return splits;} | item 1 | item 2 || item 3 | item 4 || item 5 | item 6 || item 7 | item 8 || item 9 | | | item 1 | item 2 | item 3 || item 4 | item 5 | item 6 || item 7 | item 8 | item 9 |",How can I split a list vertically in n parts with LINQ
How can I split a list in n parts with LINQ," I would like to split a list in parts, without knowing how much items I will have in that list. The question is different from those of you who wants to split a list into chunk of fixed size. I would like the values to be splitted vertically.Splitted in 2 : Splitted in 3: Splitted in 4: I've found a few c# extensions that can do that but it doesn't distribute the value the way I want. Here's what I've found: the result is this but my problem is that the value are distributed horizontally: or any idea how I can distribute my values vertically and have the possibility to choose the number of parts that i want?In real lifeFor those of you who want to know in which situation I would like to split a list vertically, here's a screenshot of a section of my website: <code>  int[] a = new int[] { 1, 2, 3, 4, 5, 6, 7, 8, 9 }; -------------------| item 1 | item 6 || item 2 | item 7 || item 3 | item 8 || item 4 | item 9 || item 5 | | | item 1 | item 4 | item 7 || item 2 | item 5 | item 8 || item 3 | item 6 | item 9 | | item 1 | item 4 | item 6 | item 8 || item 2 | item 5 | item 7 | item 9 || item 3 | | | | // this technic is an horizontal distributionpublic static IEnumerable<IEnumerable<T>> Split<T>(this IEnumerable<T> list, int parts){ int i = 0; var splits = from item in list group item by i++ % parts into part select part.AsEnumerable(); return splits;} | item 1 | item 2 || item 3 | item 4 || item 5 | item 6 || item 7 | item 8 || item 9 | | | item 1 | item 2 | item 3 || item 4 | item 5 | item 6 || item 7 | item 8 | item 9 |",How can I split a list vertically in n parts with LINQ
Regular Expression for Integer greater than 1 and less than 11," I am trying to modify this Regex so that you get numbers greater or equals 1 or less than or equals to 10. This Regex allows >= 0 or <= 10.I have a text field on a form that takes numbers equals or greater than 0 and less than 11. I could use IF's and logical operators, TryParse but I kinda like the Regex. <code>  @""^\d$|^[1][0]$""",Regular Expression for Integer greater than 0 and less than 11
Entity Framework Count() vs Any() Performances," I am working with Entity Framework 4.1 and C#.Which one is the most suitable for best performance?If so - why? (any links for additional readings) ? OR <code>  bool isBoarding = invoice.Allocations.Where(a => a.Service.Key == ""boarding"").Count() > 0; bool isBoarding = invoice.Allocations.Any(a => a.Service.Key == ""boarding"");",Comparing performance of generated queries for Any() vs Count() in Entity Framework 4.1
Comparing performance of generated quries for Any() vs Count() in Entity Framework 4.1," I am working with Entity Framework 4.1 and C#.Which one is the most suitable for best performance?If so - why? (any links for additional readings) ? OR <code>  bool isBoarding = invoice.Allocations.Where(a => a.Service.Key == ""boarding"").Count() > 0; bool isBoarding = invoice.Allocations.Any(a => a.Service.Key == ""boarding"");",Comparing performance of generated queries for Any() vs Count() in Entity Framework 4.1
"signalR get number of listeners, clients connected to hub"," Is there a way to find out the number of listeners (clients connected to a hub?)I'm trying to run/start a task if at least one client is connected, otherwise do not start it: thanks <code>  [HubName(""taskActionStatus"")]public class TaskActionStatus : Hub, IDisconnect{ static CancellationTokenSource tokenSource; public void GetTasksStatus(int? siteId) { tokenSource = new CancellationTokenSource(); CancellationToken ct = tokenSource.Token; ITaskRepository taskRepository = UnityContainerSetup.Container.Resolve<ITaskRepository>(); // init task for checking task statuses var tasksItem = new DownloadTaskItem(); taskRepository.GetTasksStatusAsync(siteId, tasksItem, ct); // subscribe to event [ listener ] tasksItem.Changed += new EventHandler<TaskEventArgs>(UpdateTasksStatus); } public void UpdateTasksStatus(object sender, TaskEventArgs e) { Clients.updateMessages(e.Tasks); } // when browsing away from page public Task Disconnect() { try { tokenSource.Cancel(); } catch (Exception) { // } return null; }}","Get number of listeners, clients connected to SignalR hub"
"If i = 0, why is i += i++ 0?"," Take the following code (usable as a Console Application): The result of i is 0. I expected 2 (as some of my colleagues did). Probably the compiler creates some sort of structure that results in i being zero.The reason I expected 2 is that, in my line of thought, the right hand statement would be evaluated first, incrementing i with 1. Than it is added to i. Since i is already 1, it is adding 1 to 1. So 1 + 1 = 2. Obviously this is not what's happening.Can you explain what the compiler does or what happens at runtime? Why is the result zero?Some-sort-of-disclaimer: I'm absolutely aware you won't (and probably shouldn't) use this code. I know I never will. Nevertheless, I find it is interesting to know why it acts in such a way and what is happening exactly. <code>  static void Main(string[] args){ int i = 0; i += i++; Console.WriteLine(i); Console.ReadLine();}","For i = 0, why is (i += i++) equal to 0?"
"If i = 0, why is i += i++ 0 in C#?"," Take the following code (usable as a Console Application): The result of i is 0. I expected 2 (as some of my colleagues did). Probably the compiler creates some sort of structure that results in i being zero.The reason I expected 2 is that, in my line of thought, the right hand statement would be evaluated first, incrementing i with 1. Than it is added to i. Since i is already 1, it is adding 1 to 1. So 1 + 1 = 2. Obviously this is not what's happening.Can you explain what the compiler does or what happens at runtime? Why is the result zero?Some-sort-of-disclaimer: I'm absolutely aware you won't (and probably shouldn't) use this code. I know I never will. Nevertheless, I find it is interesting to know why it acts in such a way and what is happening exactly. <code>  static void Main(string[] args){ int i = 0; i += i++; Console.WriteLine(i); Console.ReadLine();}","For i = 0, why is (i += i++) equal to 0?"
"If i == 0, why is (i += i++) == 0 in C#?"," Take the following code (usable as a Console Application): The result of i is 0. I expected 2 (as some of my colleagues did). Probably the compiler creates some sort of structure that results in i being zero.The reason I expected 2 is that, in my line of thought, the right hand statement would be evaluated first, incrementing i with 1. Than it is added to i. Since i is already 1, it is adding 1 to 1. So 1 + 1 = 2. Obviously this is not what's happening.Can you explain what the compiler does or what happens at runtime? Why is the result zero?Some-sort-of-disclaimer: I'm absolutely aware you won't (and probably shouldn't) use this code. I know I never will. Nevertheless, I find it is interesting to know why it acts in such a way and what is happening exactly. <code>  static void Main(string[] args){ int i = 0; i += i++; Console.WriteLine(i); Console.ReadLine();}","For i = 0, why is (i += i++) equal to 0?"
"Let i = 0, then (i += i++) = 0 in C#. Why?"," Take the following code (usable as a Console Application): The result of i is 0. I expected 2 (as some of my colleagues did). Probably the compiler creates some sort of structure that results in i being zero.The reason I expected 2 is that, in my line of thought, the right hand statement would be evaluated first, incrementing i with 1. Than it is added to i. Since i is already 1, it is adding 1 to 1. So 1 + 1 = 2. Obviously this is not what's happening.Can you explain what the compiler does or what happens at runtime? Why is the result zero?Some-sort-of-disclaimer: I'm absolutely aware you won't (and probably shouldn't) use this code. I know I never will. Nevertheless, I find it is interesting to know why it acts in such a way and what is happening exactly. <code>  static void Main(string[] args){ int i = 0; i += i++; Console.WriteLine(i); Console.ReadLine();}","For i = 0, why is (i += i++) equal to 0?"
How to run a testtools unittest in visual studio?," I have some tests that use the built in Microsoft.VisualStudio.TestTools.UnitTesting, but can not get them to run.I am using visual studio 2012 ultimate.I have a solution of two projects; One has tests, using Microsoft.VisualStudio.TestTools.UnitTesting, [TestClass] before the class, [TestMethod] before the test methods and reference Microsoft.VisualStudio.QualityTools.UnitTestFramework (version 10.0.0.0, runtime version v2.0.50727). I have tried dot-net framework 3.5, 4 and 4.5 others give a re-targeting error.I have tried to build the solution and project. Test explorer has the message `Build your solution to discover all available tests. Click ""run all"" to build, discover, and run all tests in your solution.So the question is: How to I get visual studio to find the tests?Have also tried to follow this: http://msdn.microsoft.com/en-US/library/ms379625%28v=VS.80%29.aspx but with no success: I get stuck in section getting started, when asked to right click and select create tests. There is no create tests.I have this test(it compiles, but does not show up in test explorer): I have now discovered (see deleted answer below) that it is because it is on a shared drive, but I don't as yet know how to get around it. (something about the security setting maybe). <code>  using Microsoft.VisualStudio.TestTools.UnitTesting;namespace tests { [TestClass] public class SimpleTest { [TestMethod] public void Test() { Assert.AreEqual(""a"",""a"", ""same""); } }}",Why does visual studio 2012 not find my tests?
How to start running unittests in visual studio?," I have some tests that use the built in Microsoft.VisualStudio.TestTools.UnitTesting, but can not get them to run.I am using visual studio 2012 ultimate.I have a solution of two projects; One has tests, using Microsoft.VisualStudio.TestTools.UnitTesting, [TestClass] before the class, [TestMethod] before the test methods and reference Microsoft.VisualStudio.QualityTools.UnitTestFramework (version 10.0.0.0, runtime version v2.0.50727). I have tried dot-net framework 3.5, 4 and 4.5 others give a re-targeting error.I have tried to build the solution and project. Test explorer has the message `Build your solution to discover all available tests. Click ""run all"" to build, discover, and run all tests in your solution.So the question is: How to I get visual studio to find the tests?Have also tried to follow this: http://msdn.microsoft.com/en-US/library/ms379625%28v=VS.80%29.aspx but with no success: I get stuck in section getting started, when asked to right click and select create tests. There is no create tests.I have this test(it compiles, but does not show up in test explorer): I have now discovered (see deleted answer below) that it is because it is on a shared drive, but I don't as yet know how to get around it. (something about the security setting maybe). <code>  using Microsoft.VisualStudio.TestTools.UnitTesting;namespace tests { [TestClass] public class SimpleTest { [TestMethod] public void Test() { Assert.AreEqual(""a"",""a"", ""same""); } }}",Why does visual studio 2012 not find my tests?
Who does visual studio 2012 not find my tests?," I have some tests that use the built in Microsoft.VisualStudio.TestTools.UnitTesting, but can not get them to run.I am using visual studio 2012 ultimate.I have a solution of two projects; One has tests, using Microsoft.VisualStudio.TestTools.UnitTesting, [TestClass] before the class, [TestMethod] before the test methods and reference Microsoft.VisualStudio.QualityTools.UnitTestFramework (version 10.0.0.0, runtime version v2.0.50727). I have tried dot-net framework 3.5, 4 and 4.5 others give a re-targeting error.I have tried to build the solution and project. Test explorer has the message `Build your solution to discover all available tests. Click ""run all"" to build, discover, and run all tests in your solution.So the question is: How to I get visual studio to find the tests?Have also tried to follow this: http://msdn.microsoft.com/en-US/library/ms379625%28v=VS.80%29.aspx but with no success: I get stuck in section getting started, when asked to right click and select create tests. There is no create tests.I have this test(it compiles, but does not show up in test explorer): I have now discovered (see deleted answer below) that it is because it is on a shared drive, but I don't as yet know how to get around it. (something about the security setting maybe). <code>  using Microsoft.VisualStudio.TestTools.UnitTesting;namespace tests { [TestClass] public class SimpleTest { [TestMethod] public void Test() { Assert.AreEqual(""a"",""a"", ""same""); } }}",Why does visual studio 2012 not find my tests?
C# Constructor parameters and inheritance," New to OOP and I'm confused by how derived-class constructors work when inheriting from a base class in C#.First the base class: Here is the derived class: Finally, the main part of the program: What I don't get is why, when calling the constructor for the derived class, I have to also pass the parameter that the base class needs. Shouldn't the BaseOutput field in the derived class just stay set to null if no value is assigned to it? Why can't something like this work: Furthermore, when calling the constructor in this derived class, the first parameter has to be named the same as the one in the base class or else it throws an error. If I were to define a new string variable called AnotherString in the derived class, why wouldn't this work: Lastly, when you do this the right way and type out this... ...what is the first parameter in the SubClass constructor used for? It's not being assigned or used in any methods for my derived class. Why do I have to even put it there at all? <code>  class BaseClass{ private string BaseOutput = null; public BaseClass(string BaseString) { BaseOutput = BaseString; } public virtual void PrintLine() { Console.WriteLine(BaseOutput); }} class SubClass : BaseClass{ private string SubOutput = null; public SubClass(string BaseString, string SubString) : base(BaseString) { SubOutput = SubString; } public override void PrintLine() { Console.WriteLine(SubOutput); }} class Program{ static void Main(string[] args) { BaseClass theBase = new BaseClass(""Text for BaseClass""); SubClass theSub = new SubClass(""2nd param"", ""Text for SubClass""); theBase.PrintLine(); theSub.PrintLine(); Console.ReadKey(); }} public SubClass(string SubString) : base(BaseString) public SubClass(string AnotherString, string SubString) : base(BaseString) public SubClass(string BaseString, string SubString) : base(BaseString)",Constructor Parameters and Inheritance
Creat Cron Expression using Quartz .NET, Is it possible using the Quartz .NET assembly to generate a cron expression? I saw that the CronScheduleBuilder class has a private member cronExpression which is essentially what I am looking for. Is there any other way to get the cron expression itself? <code> ,Create Cron Expression using Quartz .NET
Single thread appartment issue C#," From my mainform I call the following to open a new form Everything works great however this form has a combobox that, when I switch its AutoCompleteMode to suggest and append, I got this exception while showing the form:Current thread must be set to single thread apartment (STA) mode before OLE calls can be made. Ensure that your Main function has STAThreadAttribute marked on it.I have set this attribute on my main function as requested by the exception: Can I please get some help as to understand what might be wrong.Sample code: Designer: Setting data source <code>  MyForm sth = new MyForm();sth.show(); [STAThread]static void Main(string[] args){ ... private void mainFormButtonCLick (object sender, EventArgs e){ // System.Threading.Thread.CurrentThread.SetApartmentState(ApartmentState.STA); ? MyForm form = new MyForm(); form.show();} this.myCombo.AutoCompleteMode = System.Windows.Forms.AutoCompleteMode.Suggest;this.myCombo.AutoCompleteSource = System.Windows.Forms.AutoCompleteSource.ListItems;this.myCombo.FormattingEnabled = true;this.myCombo.Location = new System.Drawing.Point(20, 12);this.myCombo.Margin = new System.Windows.Forms.Padding(4, 5, 4, 5);this.myCombo.Name = ""myCombo"";this.myCombo.Size = new System.Drawing.Size(430, 28);this.myCombo.Sorted = true;this.myCombo.TabIndex = 0; phrase""; public MyForm(List<string> elem){ InitializeComponent(); populateColorsComboBox(); PopulateComboBox(elem);}public void PopulateComboBox(List<string> list ){ this.myCombo.DataSource = null; this.myCombo.DisplayMember = ""text""; this.myCombo.DataSource = list;}",Single thread apartment issue
Has my appplication been started by hand?," I am developing a Forms application that is either supposed to start on Windows boot (by registering a key in the registry) or by the actual user.In case the user starts it by hand (i.e. clicking the executable file), I want the form to show up. In case Windows triggered the event, I want the application to be hidden (into the tray bar).Is there a way to programmatically determine which of those cases occured? <code> ",Has my application been started by hand?
C# Quartz.NET setting MisfireInstruction," I'm working in C# using Quartz.NET and am having problems setting the misfire instruction on a CronTrigger. I'm running an SQL backend with the Quartz DB installed. I have the following code which works fine for creating a job and running a scheduler. The only misfireinstruction I can access is trig.MisfireInstruction which is an int, and I can't set it.There are also some functions beginning WithMisfireHandlingInstruction in CronScheduleBuilder. <code>  IScheduler _scheduler;IJobDetail job;ISchedulerFactory sFactory;ICronTrigger trig;sFactory = new StdSchedulerFactory();_scheduler = sFactory.GetScheduler();_scheduler.Start();job = JobBuilder.Create<Test>().WithIdentity(""testJob"", ""testGroup"").Build();trig = (ICronTrigger) TriggerBuilder.Create().WithIdentity(""testTrigger"", ""testGroup"").WithCronSchedule(""0/10 * * * * ?"").Build(); int i = trig.MisfireInstruction;_scheduler.ScheduleJob(job, trig);",Quartz.NET setting MisfireInstruction
Entity class to Datatable c# 4.0," I'm trying to make a generic class to save logHere we use entity framework so imagine we have tablemng_users(string usr_name, int usr_id)creating the respective class for itentity)is there a way to implement the toDataTable method converting the entity into a datatable(not a list, having 1 row only) so i can do something like this:having mng_users1 and mng_users2 as mng_users entity class(both with the same id but diff name)call method ""savelog(mng_users1, mng_users2);""and do the following code: <code>  private DataTable toDataTable(Object T) { DataTable vDataTable = new DataTable(); //AddColums here //AddRow with the respective values here return vDataTable; } public void savelog(Object newObject, Object oldObject) { DataTable newvalue, oldvalue; newvalue = toDataTable(newObject); oldvalue = toDataTable(oldObject); string FieldNames = string.Empty, FieldValuesFrom = string.Empty, FieldValuesTo = string.Empty; foreach (DataColumn item in newvalue.Columns) { if (newvalue.Rows[0][item].ToString() != oldvalue.Rows[0][item].ToString()) { FieldNames += (FieldNames.Length > 0 ? "" | "" : string.Empty) + item.ColumnName; FieldValuesFrom += (FieldValuesFrom.Length > 0 ? "" | "" : string.Empty) + newvalue.Rows[0][item].ToString(); FieldValuesTo += (FieldValuesTo.Length > 0 ? "" | "" : string.Empty) + oldvalue.Rows[0][item].ToString(); } } // Save log to sql code here }",Entity class to Datatable
Console App : Only one <configSections> element allowed per config file and if present must be the first child of the root <configuration> element," I am developing the console application and when I run the .exe file, I get the following error: system.Configuration.ConfigurationErrorsException: Only one <configSections> element allowed per config file and if present must be the first child of the root <configuration> element.Here's my App.config file: However, if I remove the following startup section, then it works fine <code>  <configuration> <startup useLegacyV2RuntimeActivationPolicy=""true""> <supportedRuntime version=""v4.0""/> </startup> <configSections> <section name=""Reva.Properties.Settings"" type=""System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" requirePermission=""false"" /> <section name=""log4net"" type=""log4net.Config.Log4NetConfigurationSectionHandler, log4net"" /> </configSections> <!-- ... --> <startup useLegacyV2RuntimeActivationPolicy=""true""> <supportedRuntime version=""v4.0""/></startup>",Only one configSections element allowed per config file and if present must be the first child of the root configuration element
Only one <configSections> element allowed per config file and if present must be the first child of the root <configuration> element," I am developing the console application and when I run the .exe file, I get the following error: system.Configuration.ConfigurationErrorsException: Only one <configSections> element allowed per config file and if present must be the first child of the root <configuration> element.Here's my App.config file: However, if I remove the following startup section, then it works fine <code>  <configuration> <startup useLegacyV2RuntimeActivationPolicy=""true""> <supportedRuntime version=""v4.0""/> </startup> <configSections> <section name=""Reva.Properties.Settings"" type=""System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" requirePermission=""false"" /> <section name=""log4net"" type=""log4net.Config.Log4NetConfigurationSectionHandler, log4net"" /> </configSections> <!-- ... --> <startup useLegacyV2RuntimeActivationPolicy=""true""> <supportedRuntime version=""v4.0""/></startup>",Only one configSections element allowed per config file and if present must be the first child of the root configuration element
Maintaining and Deploying Two Versions of an Application Simulataneously," I have a C# WinForms application in Visual Studio 2010 that is used by two different customers. The basic functionality of the application is the same for each customer, but certain lines of code (names of stored procedures, resources, certain behaviors) are different between versions. So far, I have kept the application in the same project, and used preprocessor directives when building/publishing to switch between which deployment to use. However, the scope of the project has grown to a point where this is no longer feasible. Since so much of the code is shared, I'm trying to avoid duplicating source code files. I'm wondering what the best approach is to maintaining an application that requires different versions to be deployed simultaneously.  <code> ",Maintaining and Deploying Two Versions of an Application Simultaneously
C# - Passing 3 paramters vs passing object with 30 properties -," I was wondering, which way is better in terms of performance and memory usage?Passing only the needed parameters for a specific function or its the same to pass an object with 30 properties but the function will use 3 of them? <code> ",C# - Passing 3 parameters vs passing object with 30 properties -
helper class for peformance tests using StopWatch() class," In this example code i am using a simple StopWatch to test time that it takes to complete a given task/action i would like to have a class that i will instantiate to use with tests though when instantiating the class and trying to use SW1 is not letting me use its methods. What am i doing wrong ? UpdateFor rest of answers, don't copy the code from me, as I miss capitalized stopwatch. Instead of instantiating the Stopwatch class i accidentally didn't pay attention Visual Studio asking if i want to create a class for my so called stopwatch instead of .NET's real Stopwatch.So my advice, pay attention to the suggested actions of Visual Studio intellisense even though it should be same all the time . Just make sure till you're really experienced and know all the classes by heart. <code>  StopWatch SW1 = new StopWatch();SW1.Start();SomeAction();SW1.Stop();sting results = SW1.Elapsed.ToString();MessageBox.Show(resutls); public Class PerformanceTests{ public StopWatch SW1 = new StopWatch(); public StopWatch SW2 = new StopWatch(); public string results1 = """", results2 = """"; .... .... //some other variables to use } PerformanceTests Ptst = new PerformanceTests();Ptst.SW1. ... Start() is not accessible",Helper class for performance tests using StopWatch class
Helper class for peformance tests using StopWatch class," In this example code i am using a simple StopWatch to test time that it takes to complete a given task/action i would like to have a class that i will instantiate to use with tests though when instantiating the class and trying to use SW1 is not letting me use its methods. What am i doing wrong ? UpdateFor rest of answers, don't copy the code from me, as I miss capitalized stopwatch. Instead of instantiating the Stopwatch class i accidentally didn't pay attention Visual Studio asking if i want to create a class for my so called stopwatch instead of .NET's real Stopwatch.So my advice, pay attention to the suggested actions of Visual Studio intellisense even though it should be same all the time . Just make sure till you're really experienced and know all the classes by heart. <code>  StopWatch SW1 = new StopWatch();SW1.Start();SomeAction();SW1.Stop();sting results = SW1.Elapsed.ToString();MessageBox.Show(resutls); public Class PerformanceTests{ public StopWatch SW1 = new StopWatch(); public StopWatch SW2 = new StopWatch(); public string results1 = """", results2 = """"; .... .... //some other variables to use } PerformanceTests Ptst = new PerformanceTests();Ptst.SW1. ... Start() is not accessible",Helper class for performance tests using StopWatch class
"C# Building a HttpContext for testing, how can I specify the HttpRequest is a POST?"," I'm writing some unit tests for a method that takes an HttpContext as a parameter. I want to test that the behavior is as expected when the request is a POST.When creating a System.Net.HttpWebRequest it's easy to set the method, but I can't see a way to specify the method when creating a System.Web.HttpRequest which is what's used in HttpContext.Any ideas?For context the method is called by an httphandler and it is supposed to throw a 405 if the request is not a POST. I know that I can filter the allowable methods with the Verbs property in the web.config, and I will, however there's nothing stopping somebody in the future from changing the verbs property to allow other methods in which case I want the handler to take care of it itself.Helper method currently in use: <code>  private HttpContext GetHttpContext(string requestUrl) { var httpRequest = new HttpRequest("""", requestUrl, """"); var stringWriter = new StringWriter(); var httpResponce = new HttpResponse(stringWriter); return new HttpContext(httpRequest, httpResponce); }","Building a HttpContext for testing, how can I specify the HttpRequest is a POST?"
Enum VS Static Class," I have been developing for windows mobile and android for sometime. And I'm confused about these two concepts.Let's say I want to make decision based on some the user's device Screen Size. So I'll expect so predefined values. I could use a switch statement for handling my logic.But I'm not sure whether I should use Enum of a Static Class for this purpose. Which one is a better approach. I can do my logic in these two different ways. Which one is the correct approach? I'm confused. And is it possible for me to use String values also? Because currently I'm sticking with classes, I need to update to use all enums. So How about changing my Class to String Enum? Any way. Thanks.Using Enum Using Class <code>  //My predefined valuespublic enum ScreenSizeEnum{ Small, Medium, Large, XLarge,}//Handling Logicprivate void SetScreenSize(ScreenSizeEnum Screen){ switch (Screen) { case ScreenSizeEnum.Large: //Do Logic break; case ScreenSizeEnum.Small: //Do Logic break; }} //My predefined valuespublic class ScreenSizeClass{ public const int Small = 0; public const int Medium = 1; public const int Large = 2; public const int XLarge = 3;}//Handling Logicprivate void SetScreenSize(int Screen){ switch (Screen) { case ScreenSizeClass.Large: //Do Logic break; case ScreenSizeClass.Small: //Do Logic break; }}",Enum VS Static Class (Normal and With String Values)
How I can filter my DataTable to Column Value?," I have a question about DataTable. I retrieve a DataTable from the database, and one of these columns contains either a 1 or a 0. Now I want to retrieve only the rows with a 1 value of 1 in that column.The name of the column is ACTIVATE.Here is my DataTable:  <code>  DataTable table = new DataTable(TABLE);//How can I filter here so ACTIVATE == 1?adapter.Fill(table);connection.Open();selectcommand.ExecuteReader();return table;",How I can filter my DataTable by Column Value?
Winforms - Wrong font displayed at runtime," I am using the Calibri font in some labels (winforms) and when I run my program, this label are displayed with a different font.I had seen this problem when testing on computers without Office (hence no Calibri installed) but now I see it everywhere, even on my computer where Calibri is well installed (and I see the labels with Calibri in the designer ; then when I run in debug mode, I see another font).The labels used to be displayed well, I've seen this problem only today (but could have been unnoticed for a few days, I'm not sure, but not long, that I'm sure).There were a few windows updates yesterday, and some were for Office, but I'm not sure if it's relevant.Bottomline is I have calibri, calibri is displayed in designer, and some other font is displayed at runtime..And I seem to have the same problem with Segoe UI, but only when using the SemiBold style..Here is an image of the result, on the left is runtime and on the right is the VS designer:It is even more obvious when I try to use Calibri bold ; this time runtime is on the right and designer view on the left : <code> ",Wrong font displayed at runtime
Best practive to create data access objects," I have a method in MyWebpage.aspx.cs lik so: In the DataAccessLayer class, I have a methoud that talks to the DB and does the DAL stuff and returns the title.What's the best practice on accessing the DAL from MyWebPage.aspx.cs class (as in do I need to create a new DataAccessLayer() object each time? Where should I create it in my PageBase class or everytime I call it in a code behind? <code>  public partial class MyWebpage : PageBase{ private readonly DataAccessLayer dataAccessLayer; protected string GetMyTitle(string myVar, string myId) { if (string.IsNullOrEmpty(myVar)) { return string.Empty; } return dataAccessLayer.GetMyTitle(Convert.ToInt32(myId), myVar); }}",What is the best approach when creating data access objects?
use AForge.net to Recognition special pattern pattern," I want to use AForge.net to recognize patterns like in the picture below.I used filters to extract yellow-orange-red colors so I can now find the colored blobs but :I want to find blobs that are surrounded with a big blue circle ( as shown in the picture )I want to filter objects that have an oval shapeI don't want the exact code , just show me the basic outline and functions that I should use. <code> ",use AForge.net to Recognition special pattern
xml serialization list with attributes c#," I have a list inside another list (a product with variants). I would like the parent list to have attributes set on it (just an id and a name).Desired Output Current Code Current Output  <code>  <embellishments> <type id=""1"" name=""bar bar foo""> <row> <id>1</id> <name>foo bar</name> <cost>10</cost> </row> </type> </embellishments> [XmlRoot( ElementName = ""embellishments"", IsNullable = false )]public class EmbellishmentGroup{ [XmlArray(ElementName=""type"")] [XmlArrayItem(""row"", Type=typeof(Product))] public List<Product> List { get; set; } public EmbellishmentGroup() { List = new List<Product>(); List.Add( new Product() { Id = 1, Name = ""foo bar"", Cost = 10m } ); }}public class Product{ [XmlElement( ""id"" )] public int Id { get; set; } [XmlElement( ""name"" )] public string Name { get; set; } [XmlElement( ""cost"" )] public decimal Cost { get; set; }} <embellishments> <type> <row> <id>1</id> <name>foo bar</name> <cost>10</cost> </row> </type></embellishments>",XML serialization of a list with attributes
xml serialization list with attributes," I have a list inside another list (a product with variants). I would like the parent list to have attributes set on it (just an id and a name).Desired Output Current Code Current Output  <code>  <embellishments> <type id=""1"" name=""bar bar foo""> <row> <id>1</id> <name>foo bar</name> <cost>10</cost> </row> </type> </embellishments> [XmlRoot( ElementName = ""embellishments"", IsNullable = false )]public class EmbellishmentGroup{ [XmlArray(ElementName=""type"")] [XmlArrayItem(""row"", Type=typeof(Product))] public List<Product> List { get; set; } public EmbellishmentGroup() { List = new List<Product>(); List.Add( new Product() { Id = 1, Name = ""foo bar"", Cost = 10m } ); }}public class Product{ [XmlElement( ""id"" )] public int Id { get; set; } [XmlElement( ""name"" )] public string Name { get; set; } [XmlElement( ""cost"" )] public decimal Cost { get; set; }} <embellishments> <type> <row> <id>1</id> <name>foo bar</name> <cost>10</cost> </row> </type></embellishments>",XML serialization of a list with attributes
C# read user input of double type," I have found this answered in other places using loops, but I wasn't sure if there is actually a function that I'm not finding that makes this easier, or if this is a possible (in my opinion) negative side to C#.I'm trying to read in a double from user input like this: I've found a couple other posts on this, and they all have different answers, and the questions asked aren't exactly the same either. If i just want the user input read in, what is the best way to do that? <code>  Console.WriteLine(""Please input your total salary: "") // i input 100double totalSalary = Console.Read(); //reads in the 1, changes to 49.",read user input of double type
.NET FileStream WriteAsync and await confusion," I'm looking at the new async and await keywords in C# and just trying to get a feel for them.I'm looking at the MSDN FileStream.WriteAsync() example, and I wasn't sure I understood something.The example is as follows: What I don't get is the placement of the await. It seems that you can't take the Task item that is returned by WriteAsync() because this always gives me a syntax error. So the only way I could get this to compile is by leaving the await with the call.But if you do this, does it not wait for the call to finish? This makes it not very asynchronous... <code>  using System;using System.Text;using System.Threading.Tasks;using System.Windows;using System.Windows.Controls;using System.IO;namespace WpfApplication1{ public partial class MainWindow : Window { public MainWindow() { InitializeComponent(); } private async void Button_Click(object sender, RoutedEventArgs e) { UnicodeEncoding uniencoding = new UnicodeEncoding(); string filename = @""c:\Users\exampleuser\Documents\userinputlog.txt""; byte[] result = uniencoding.GetBytes(UserInput.Text); using (FileStream SourceStream = File.Open(filename, FileMode.OpenOrCreate)) { SourceStream.Seek(0, SeekOrigin.End); await SourceStream.WriteAsync(result, 0, result.Length); } } }}",FileStream WriteAsync and await confusion
C# regex get a match," How can i get |ADT^A05| out of ""MSH|^~\&|PHTADT09|ABC|DADIST00|ABC|20120425152829|rcalini1|ADT^A05|20429208851634|P|2.1|560""I have tried this but not working  <code>  ""|([A-Z]{3})^([A-Z]{1})([0-9]{2})|""",regex get a match
StreamWriter: double flush required?," Is it necessary to flush a Stream after flushing a StreamWriter? <code>  public static async Task WriteStringAsync(this Stream stream, string messageString){ var encoding = new UTF8Encoding(false); //no BOM using (var streamWriter = new StreamWriter(stream, encoding)) { await streamWriter.WriteAsync(messageString); await streamWriter.FlushAsync(); } await stream.FlushAsync(); //is this necessary?}",Double flush required?
double flush required?," Is it necessary to flush a Stream after flushing a StreamWriter? <code>  public static async Task WriteStringAsync(this Stream stream, string messageString){ var encoding = new UTF8Encoding(false); //no BOM using (var streamWriter = new StreamWriter(stream, encoding)) { await streamWriter.WriteAsync(messageString); await streamWriter.FlushAsync(); } await stream.FlushAsync(); //is this necessary?}",Double flush required?
C# and working with ComponentModel," I am having a bit of difficulty in understanding how the Container/Component model interacts with each other in C#. I get how the Component contains a Site object which has information about Container and Component. But, suppose I had the following code: This works without issue, it defines a Container (Entity) and a Component (Position) that is contained inside it.However, if I invoke p.Site.Container, it will return Entity, but as IContainer. That is, I would have to explicitly do something like (Console.WriteLine(p.Site.Container as Entity).Foo); if I wanted to access Foo. This seems quite cumbersome. Am I missing something, or is there a better way to do what I want? <code>  using System;using System.ComponentModel;public class Entity : Container { public string Foo = ""Bar"";}public class Position : Component { public int X, Y, Z; public Position(int X, int Y, int Z){ this.X = X; this.Y = Y; this.Z = Z; }}public class Program { public static void Main(string[] args) { Entity e = new Entity(); Position p = new Position(10, 20, 30); e.Add(p, ""Position""); } }",Working with System.ComponentModel
Convert a text fraction to a decimal (C#)," Similar to this question just in C# instead of JavaScript. I couldn't find anything for C# while searchingI have a text box that will take a quantity, which is later stored as a double in a database. However it is possible that some quantities will be entered as string fractions e.g 1/2 for 0.5.I want to be able to convert these to decimal before storing them to the database (being able to also convert back would be nice but not necessary). I want to be able to handle both fractions and mixed numbers e.g. 2 1/2 is saved as 2.5Anybody know a way of doing this? <code> ",Convert a text fraction to a decimal
ObservableCollection Transform Wrapper," When creating ViewModels in WPF it's sometimes necessary to transform data that is available in an ObservableCollection (the source collection) into a collection of wrapper elements that extend/restrict/project the original elements (the target collection), while the number and order of the elements always mirror the original collection.Just like the Select extension method, except that it is continuously updated and can therefore be used for WPF bindings.If an element is added to the source at index x, the Wrapper of the same element is added at the same index x in the target collection. If the element at index y is removed in the source collection, the element at index y is removed in the target collection.Say there is an ObservableCollection<ClassA>, but what I need to bind to is an ReadOnlyObservableCollection<ClassB> (or equivalent), where ClassB -> ClassA as follows: I can write my own TemplatedTransformCollectionWrapper, where I can write this: TemplatedTransformCollectionWrapper ideally wraps all collections that implement INotifyCollectionChanged and correctly handles all possible add, remove, replace operations of the original, wrapped, collection.It's not trivial to write TemplatedTransformCollectionWrapper correctly and it seems to be the kind of thing that someone else has already done, maybe it's even part of the core framework. But I can't find it. <code>  class ClassB : INotifyPropertyChanged, IDisposable{ public ClassB(ClassA a) { Wrapped = a; (Wrapped as INotifyPropertyChanged).PropertyChanged+=WrappedChanged; } public ClassA Wrapped { get; private set; } public int SomeOtherProperty { get { return SomeFunction(Wrapped); } WrappedChanged(object s, NotifyPropertyChangedArgs a) { ... } ...} ObservableCollection<ClassA> source;TemplatedTransformCollectionWrapper theCollectionThatWillBeUsedInABinding = TemplatedTransformCollectionWrapper(source, classA => new ClassB(classA));",ObservableCollection element-wise Transform/Projection Wrapper
The maximum array length quota (16384) has been exceeded while reading XML data," I know this has been asked quite a few times, and trust me I've been looking at and trying many of them for half the afternoon, but still cannot get past this.I'm trying to submit some form contents (which can also include an attachment) over a web service, but keep getting the following error when I try to attach anything other than a tiny file.My Full Error is: The formatter threw an exception while trying to deserialize the message: There was an error while trying to deserialize parameter http://tempuri.org/:scChildForm. The InnerException message was 'There was an error deserializing the object of type MashForms.Models.SCChildrenForm. The maximum array length quota (16384) has been exceeded while reading XML data. This quota may be increased by changing the MaxArrayLength property on the XmlDictionaryReaderQuotas object used when creating the XML reader. Line 1, position 41713.'. Please see InnerException for more details.No matter how much I try to override that value in the web.config of the WCF Service and the Web Client also, it still reports that as the maximum and subsequently errors.WCF Web.Config My Web Client Web.Config My WCF Service will accept very small files, but not larger, not even 28k.As an additional note, when I initially add the Service Reference into the WebClient, it doesn't default to the larger values, it creates it like this: Default Web Client Web.config Update 1: Response to Eugene Update 2: Added Service Endpoint as suggested But still I have the same error. <code>  <?xml version=""1.0"" encoding=""utf-8""?><configuration> <system.web> <compilation debug=""true"" targetFramework=""4.0"" /> <!--<httpRuntime maxRequestLength=""409600"" executionTimeout=""300"" />--> </system.web> <connectionStrings> <add name=""MashFormsContext"" connectionString=""Data Source=ServerName;Initial Catalog=MashFormsDev;Persist Security Info=True;User ID=UserName;Password=Password"" providerName=""System.Data.SqlClient"" /> </connectionStrings> <system.serviceModel> <behaviors> <serviceBehaviors> <behavior> <dataContractSerializer maxItemsInObjectGraph=""2147483647"" /> <serviceTimeouts transactionTimeout=""05:05:00"" /> <serviceThrottling maxConcurrentCalls=""500"" maxConcurrentSessions=""500"" maxConcurrentInstances=""2147483647"" /> <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment --> <serviceMetadata httpGetEnabled=""true""/> <!--<serviceMetadata httpsGetEnabled=""true""/>--> <!-- To receive exception details in faults for debugging purposes, set the value below to true. Set to false before deployment to avoid disclosing exception information --> <serviceDebug includeExceptionDetailInFaults=""true"" /> <!--<StructureMapServiceBehavior />--> </behavior> </serviceBehaviors> </behaviors> <serviceHostingEnvironment multipleSiteBindingsEnabled=""true"" aspNetCompatibilityEnabled=""false"" /> <extensions> <behaviorExtensions> </behaviorExtensions> </extensions> <bindings> <basicHttpBinding> <binding name=""BasicHttpBinding_IInsertNewForm"" closeTimeout=""00:01:00"" openTimeout=""00:01:00"" receiveTimeout=""00:10:00"" sendTimeout=""00:01:00"" allowCookies=""false"" bypassProxyOnLocal=""false"" hostNameComparisonMode=""StrongWildcard"" maxBufferSize=""2147483647"" maxBufferPoolSize=""524288"" maxReceivedMessageSize=""2147483647"" messageEncoding=""Text"" textEncoding=""utf-8"" transferMode=""Streamed"" useDefaultWebProxy=""true""> <readerQuotas maxDepth=""2147483647"" maxStringContentLength=""2147483647"" maxArrayLength=""2147483647"" maxBytesPerRead=""2147483647"" maxNameTableCharCount=""2147483647""/> <security mode=""None""> <transport clientCredentialType=""None"" proxyCredentialType=""None"" realm="""" /> <message clientCredentialType=""UserName"" algorithmSuite=""Default"" /> </security> </binding> </basicHttpBinding> </bindings> </system.serviceModel> <system.webServer> <modules runAllManagedModulesForAllRequests=""true"" /> <validation validateIntegratedModeConfiguration=""false"" /> </system.webServer> <runtime> <assemblyBinding xmlns=""urn:schemas-microsoft-com:asm.v1""> <dependentAssembly> <assemblyIdentity name=""System.Web.Mvc"" publicKeyToken=""31bf3856ad364e35"" culture=""neutral"" /> <bindingRedirect oldVersion=""0.0.0.0-4.0.0.0"" newVersion=""4.0.0.0"" /> </dependentAssembly> </assemblyBinding> </runtime></configuration> <?xml version=""1.0"" encoding=""utf-8""?><!-- For more information on how to configure your ASP.NET application, please visit http://go.microsoft.com/fwlink/?LinkId=152368 --><configuration> <configSections> <!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 --> <section name=""entityFramework"" type=""System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=4.4.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" requirePermission=""false"" /> </configSections> <connectionStrings> <add name=""DefaultConnection"" providerName=""System.Data.SqlClient"" connectionString=""Data Source=.\SQLEXPRESS;Initial Catalog=aspnet-PublicForms-20121112151426;Integrated Security=SSPI"" /> </connectionStrings> <appSettings> <add key=""webpages:Version"" value=""2.0.0.0"" /> <add key=""webpages:Enabled"" value=""false"" /> <add key=""PreserveLoginUrl"" value=""true"" /> <add key=""ClientValidationEnabled"" value=""true"" /> <add key=""UnobtrusiveJavaScriptEnabled"" value=""true"" /> </appSettings> <system.web> <compilation debug=""true"" targetFramework=""4.0"" /> <authentication mode=""Forms""> <forms loginUrl=""~/Account/Login"" timeout=""2880"" /> </authentication> <pages> <namespaces> <add namespace=""System.Web.Helpers"" /> <add namespace=""System.Web.Mvc"" /> <add namespace=""System.Web.Mvc.Ajax"" /> <add namespace=""System.Web.Mvc.Html"" /> <add namespace=""System.Web.Optimization"" /> <add namespace=""System.Web.Routing"" /> <add namespace=""System.Web.WebPages"" /> </namespaces> </pages> <sessionState mode=""InProc"" customProvider=""DefaultSessionProvider""> <providers> <add name=""DefaultSessionProvider"" type=""System.Web.Providers.DefaultSessionStateProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"" connectionStringName=""DefaultConnection"" /> </providers> </sessionState> </system.web> <system.webServer> <validation validateIntegratedModeConfiguration=""false"" /> <modules runAllManagedModulesForAllRequests=""true"" /> <handlers> <remove name=""ExtensionlessUrlHandler-ISAPI-4.0_32bit"" /> <remove name=""ExtensionlessUrlHandler-ISAPI-4.0_64bit"" /> <remove name=""ExtensionlessUrlHandler-Integrated-4.0"" /> <add name=""ExtensionlessUrlHandler-ISAPI-4.0_32bit"" path=""*."" verb=""GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS"" modules=""IsapiModule"" scriptProcessor=""%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll"" preCondition=""classicMode,runtimeVersionv4.0,bitness32"" responseBufferLimit=""0"" /> <add name=""ExtensionlessUrlHandler-ISAPI-4.0_64bit"" path=""*."" verb=""GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS"" modules=""IsapiModule"" scriptProcessor=""%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll"" preCondition=""classicMode,runtimeVersionv4.0,bitness64"" responseBufferLimit=""0"" /> <add name=""ExtensionlessUrlHandler-Integrated-4.0"" path=""*."" verb=""GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS"" type=""System.Web.Handlers.TransferRequestHandler"" preCondition=""integratedMode,runtimeVersionv4.0"" /> </handlers> </system.webServer> <runtime> <assemblyBinding xmlns=""urn:schemas-microsoft-com:asm.v1""> <dependentAssembly> <assemblyIdentity name=""System.Web.Helpers"" publicKeyToken=""31bf3856ad364e35"" /> <bindingRedirect oldVersion=""1.0.0.0-2.0.0.0"" newVersion=""2.0.0.0"" /> </dependentAssembly> <dependentAssembly> <assemblyIdentity name=""System.Web.Mvc"" publicKeyToken=""31bf3856ad364e35"" /> <bindingRedirect oldVersion=""0.0.0.0-4.0.0.0"" newVersion=""4.0.0.0"" /> </dependentAssembly> <dependentAssembly> <assemblyIdentity name=""System.Web.WebPages"" publicKeyToken=""31bf3856ad364e35"" /> <bindingRedirect oldVersion=""1.0.0.0-2.0.0.0"" newVersion=""2.0.0.0"" /> </dependentAssembly> <dependentAssembly> <assemblyIdentity name=""System.Data"" publicKeyToken=""b77a5c561934e089"" culture=""neutral"" /> <bindingRedirect oldVersion=""0.0.0.0-4.0.0.0"" newVersion=""4.0.0.0"" /> </dependentAssembly> </assemblyBinding> </runtime> <entityFramework> <defaultConnectionFactory type=""System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework""> <parameters> <parameter value=""v11.0"" /> </parameters> </defaultConnectionFactory> </entityFramework> <system.serviceModel> <bindings> <basicHttpBinding> <binding name=""BasicHttpBinding_IInsertNewForm"" closeTimeout=""00:01:00"" openTimeout=""00:01:00"" receiveTimeout=""00:10:00"" sendTimeout=""00:01:00"" allowCookies=""false"" bypassProxyOnLocal=""false"" hostNameComparisonMode=""StrongWildcard"" maxBufferSize=""2147483647"" maxBufferPoolSize=""2147483647"" maxReceivedMessageSize=""2147483647"" messageEncoding=""Text"" textEncoding=""utf-8"" transferMode=""Buffered"" useDefaultWebProxy=""true""> <readerQuotas maxDepth=""32"" maxStringContentLength=""2147483647"" maxArrayLength=""2147483647"" maxBytesPerRead=""2147483647"" maxNameTableCharCount=""2147483647"" /> <security mode=""None""> <transport clientCredentialType=""None"" proxyCredentialType=""None"" realm="""" /> <message clientCredentialType=""UserName"" algorithmSuite=""Default"" /> </security> </binding> </basicHttpBinding> </bindings> <client> <endpoint address=""http://localhost:54070/MashPortalService/InsertNewForm.svc"" binding=""basicHttpBinding"" bindingConfiguration=""BasicHttpBinding_IInsertNewForm"" contract=""InsertNewForm.IInsertNewForm"" name=""BasicHttpBinding_IInsertNewForm"" /> </client> </system.serviceModel></configuration> <system.serviceModel> <bindings> <basicHttpBinding> <binding name=""BasicHttpBinding_IInsertNewForm"" closeTimeout=""00:01:00"" openTimeout=""00:01:00"" receiveTimeout=""00:10:00"" sendTimeout=""00:01:00"" allowCookies=""false"" bypassProxyOnLocal=""false"" hostNameComparisonMode=""StrongWildcard"" maxBufferSize=""65536"" maxBufferPoolSize=""524288"" maxReceivedMessageSize=""65536"" messageEncoding=""Text"" textEncoding=""utf-8"" transferMode=""Buffered"" useDefaultWebProxy=""true""> <readerQuotas maxDepth=""32"" maxStringContentLength=""8192"" maxArrayLength=""16384"" maxBytesPerRead=""4096"" maxNameTableCharCount=""16384"" /> <security mode=""None""> <transport clientCredentialType=""None"" proxyCredentialType=""None"" realm="""" /> <message clientCredentialType=""UserName"" algorithmSuite=""Default"" /> </security> </binding> </basicHttpBinding> </bindings> <client> <endpoint address=""http://localhost:54070/MashPortalService/InsertNewForm.svc"" binding=""basicHttpBinding"" bindingConfiguration=""BasicHttpBinding_IInsertNewForm"" contract=""InsertNewForm.IInsertNewForm"" name=""BasicHttpBinding_IInsertNewForm"" /> </client> </system.serviceModel> using System.ServiceModel;using MashForms.Models;namespace MashPortalService{ [ServiceContract] public interface IInsertNewForm { //Testing operations [OperationContract] string TestReturnInput(string s); [OperationContract] bool Ping(); //Child [OperationContract] int InsertFormChildGettingIdBack(SCChildrenForm scChildForm); }} </bindings> <services> <service name=""MashPortalService""> <endpoint address=""http://localhost:54070/MashPortalService/InsertNewForm.svc"" binding=""basicHttpBinding"" bindingConfiguration=""BasicHttpBinding_IInsertNewForm"" contract=""InsertNewForm.IInsertNewForm"" /> </service> </services>",WCF: The maximum array length quota (16384) has been exceeded while reading XML data
How to achive a search for certain year & amount C#," Here is a small demo of a SQL database, where one can add, update delete members from a SQL server. There are two tables in a single SQL Server DB, one is members second is overview. In members there is distinct ID column and members personal info like name, address telephone etc. In overview there are only three columns which are dID, year & amount.There is one single windows form, language is c# and project is built in Visual Studio 2010, and of course data base in SQL Server 2010. The windows form has a reset, insert, update & delete buttons. There is one more button besides the dID text box where a distinct ID can be inserted and after clicking Search button the last entry made about the member shows by filling all the text boxes where name address telephone appear. This serves the function that member full info can be seen and changes can be made or can be removed from dB. There are two text boxes in particular, which are Year & Amount, which shows that the member has paid a certain amount for the certain year. But as I mentioned in the text boxes you can only see the last entry made. What function I want to achieve is that after inserting dID of person x I could only in the year text box able to insert lets say any previous year and the press search which should like normally fill all the text boxes with info, and in the amount text box should show me the entry from the dB that according to the year I entered how much amount is there or there is nothing which means that may be member has not paid for a certain year. I need help in achieving this logic programmatically therefore I would like to request assistance.The present program is as follows : <code>  using System; using System.Collections.Generic; using System.ComponentModel; using System.Data; using System.Data.SqlClient;using System.Drawing; using System.Linq; using System.Text; using System.Windows.Forms;namespace SQLDatabase { public partial class SQLDBDisplay : Form { SqlConnection con = new SqlConnection(""Data Source=JG-PC\\SQLEXPRESS;Initial Catalog=TEST;Integrated Security=True""); public SQLDBDisplay() { InitializeComponent(); } SqlDataAdapter da; DataSet ds = new DataSet(); private void btnSearch_Click(object sender, EventArgs e) { SqlDataReader reader; SqlCommand cmd = new SqlCommand(); try { string sql = ""SELECT * FROM members where dID = '"" + txtdID.Text + ""' ""; txtYear.Text = sql; cmd.Connection = con; cmd.CommandText = sql; con.Open(); reader = cmd.ExecuteReader(); while (reader.Read()) { txtID.Text = reader[""ID""].ToString(); txtName.Text = reader[""Name""].ToString(); txtAddress.Text = reader[""Address""].ToString(); txtMobile.Text = reader[""Mobile""].ToString(); txtEmail.Text = reader[""Email""].ToString(); txtdID.Text = reader[""dID""].ToString(); } con.Close(); sql = ""SELECT * FROM Overview where dID = '"" + txtdID.Text + ""' ""; txtYear.Text = txtYear.Text + "" : "" + sql; cmd.Connection = con; cmd.CommandText = sql; con.Open(); reader = cmd.ExecuteReader(); while (reader.Read()) { txtYear.Text = reader[""Year""].ToString(); txtAmount.Text = reader[""Amount""].ToString(); txtdID.Text = reader[""dID""].ToString(); } con.Close(); } catch (Exception ex) { MessageBox.Show(ex.Message.ToString()); } } private void btnReset_Click(object sender, EventArgs e) { txtdID.Text = """"; txtName.Text = """"; txtAddress.Text = """"; txtMobile.Text = """"; txtEmail.Text = """"; txtYear.Text = """"; txtAmount.Text = """"; } private void btnInsert_Click(object sender, EventArgs e) { SqlCommand cmd = new SqlCommand(); string Sql = ""INSERT INTO members (dID, Name, Address, Email, Mobile) VALUES ( '"" + txtdID.Text+ ""','"" + txtName.Text + ""','""+ txtAddress.Text + ""', '"" + txtEmail.Text + ""', '"" + txtMobile.Text + ""')""; cmd.CommandText = Sql; cmd.Connection = con; con.Open(); cmd.ExecuteNonQuery(); con.Close(); Sql = ""INSERT INTO Overview (dID, Year, Amount) VALUES ('""+ txtdID.Text +""' ,'"" + txtYear.Text + ""','"" + txtAmount.Text +""')""; cmd.CommandText = Sql; cmd.Connection = con; con.Open(); cmd.ExecuteNonQuery(); con.Close(); MessageBox.Show(""Record Inserted Scuessfully!!!""); for (int i = 0; i < this.Controls.Count; i++) { if (this.Controls[i] is TextBox) { this.Controls[i].Text = """"; } } } private void btnUpdate_Click(object sender, EventArgs e) { try { SqlCommand cmd = new SqlCommand(); string Sql = ""Update members set Name = '"" + txtName.Text + ""', Address = '"" + txtAddress.Text + ""', Email = '"" +txtEmail.Text + ""', Mobile = '"" + txtMobile.Text + ""' WHERE dID = '""+ txtdID.Text + ""'""; cmd.CommandText = Sql; cmd.Connection = con; con.Open(); cmd.ExecuteNonQuery(); con.Close(); Sql = ""Update overview set Year = '"" + txtYear.Text + ""', Amount = '"" + txtAmount.Text + ""' WHERE dID = '""+ txtdID.Text+""'""; cmd.CommandText = Sql; cmd.Connection = con; con.Open(); cmd.ExecuteNonQuery(); MessageBox.Show(""Data Scuessfully Updated""); con.Close(); } catch (Exception error) { MessageBox.Show(error.ToString()); } for (int i = 0; i < this.Controls.Count; i++) { if (this.Controls[i] is TextBox) { this.Controls[i].Text = """"; } } } private void btnDelete_Click(object sender, EventArgs e) { SqlCommand cmd = con.CreateCommand(); cmd.CommandType = CommandType.Text; cmd.CommandText = ""DELETE FROM members WHERE dID = '""+ txtdID.Text +""'""; con.Open(); cmd.ExecuteNonQuery(); cmd.CommandText = ""DELETE FROM overview WHERE dID = '"" + txtdID.Text + ""'""; cmd.ExecuteNonQuery(); da = new SqlDataAdapter(cmd); MessageBox.Show(""Record Scuessfully Deleted !""); con.Close(); for (int i = 0; i < this.Controls.Count; i++) { if (this.Controls[i] is TextBox) { this.Controls[i].Text = """"; } } } private void btnClose_Click(object sender, EventArgs e) { Application.Exit(); } } }",How to achieve a search for a certain year & amount using C#
how handle UnauthorizedAccessException when try to add files from location without permissions," I am trying to get all files from folder this way: If my root folder contains a folder for which the user doesn't have permission to access, the UnauthorizedAccessException is caught and my array is empty and all the recursion failed.How can I handle this case and insure that my code ignore locations without permission but add the files from location with permissions? <code>  try{ string[] files = Directory.GetFiles(folderBrowserDialog1.SelectedPath, ""*.*"", SearchOption.AllDirectories);}catch (UnauthorizedAccessException){ throw;}",How to handle UnauthorizedAccessException when attempting to add files from location without permissions
WPF Capute key press in whole application," Is it possible, to capture (somewhere in app.xaml.cs i guess) any key and if it pressed open window?Thanks for help! <code> ",Capture key press in whole application
Variable initialazation issue in switch statement," What I have is simple switch statement In this situation compiler tells me that local variable myControl might not be initialized before accessingSo, what is the best way to avoid this situation? One option is to initialize myControl before switch statement. But in this case I do one more unnecessary initalization.CASE 1: Next option is to change second case with default. After that compiler will ""understand"" that myControl will be anyway initialized and will not throw exception.CASE 2: But this case doesn't look so good, because after adding some new properties to my enum it will do default for all other types(developer can easily forget to change code here or it can be not necessary to initialize myControl for other enum types).What is best approach in such situations? <code>  Control myControl;switch(x){ case TabType.Edit: { myControl= ...; } case TabType.View: { myControl= ...; } } myPageView.Controls.Add(myControl); Control myControl = null;switch(x){ case TabType.Edit: { myControl= ...; } case TabType.View: { myControl= ...; } } myPageView.Controls.Add(myControl); Control myControl;switch(x){ case TabType.Edit: { myControl= ...; } default: { myControl= ...; } } myPageView.Controls.Add(myControl);",Variable initialization issue in switch statement
List references in c#, I have a list that gets filled in with some data from an operation and I am storing it in the memory cache. Now I want another list which contains some sub data from the list based on some condition. As can be seen in the below code I am doing some operation on the target list. The problem is that whatever changes I am doing to the target list is also being done to the mainList. I think its because of the reference is same or something.All I need is that operation on the target list not affect data inside the main list. <code>  List<Item> target = mainList;SomeOperationFunction(target); void List<Item> SomeOperationFunction(List<Item> target){ target.removeat(3); return target;},How do I change my new list without changing the original list?
Execute multiple commands in same environment," I'm developing a small C# GUI tool which is supposed to fetch some C++ code and compile it after going through some wizard. This works all nice if I run it from a command prompt after running the famous vcvarsall.bat. Now I would like the user not to go to a command prompt first but have the program call vcvars followed by nmake and other tools I need. For that to work the environment variables set by vcvars should obviously be kept.How can I do that?The best solution I could find yet was to create a temporary cmd/bat script which will call the other tools, but I wonder if there is a better way.Update: I meanwhile experimented with batch files and cmd. When using batch files vcvars will terminate the complete batch execution so my second command (i.e. nmake) won't be executed. My current workaround is like this (shortened): This works, but the output from the cmd call is not captured. Still looking for something better <code>  string command = ""nmake"";string args = """";string vcvars = ""...vcvarsall.bat"";ProcessStartInfo info = new ProcessStartInfo();info.WorkingDirectory = workingdir;info.FileName = ""cmd"";info.Arguments = ""/c \"""" + vcvars + "" x86 && "" + command + "" "" + args + ""\"""";info.CreateNoWindow = true;info.UseShellExecute = false;info.RedirectStandardOutput = true;Process p = Process.Start(info);",Execute multiple commands in same environment from C#
How create a new hard copy (clone) of a List<T>?," In the following piece of code, I use a Book object type to create a List<T> and I populate it with a few items giving them a unique title (from 'one' to 'five').Then I create List<Book> books_2 = new List<Book>(books_1). From this point, I know it's a clone of the list object, BUT the book objects from book_2 are still a reference from the book objects in books_1. It's proven by making changes on the two first elements of books_2, and then checking those same elements of book_1 in a TextBox.books_1[0].title and books_2[1].title have indeed been changed to the new values of books_2[0].title and books_2[1].title.NOW THE QUESTIONHow do we create a new hard copy of a List<T>? The idea is that books_1 and books_2 become completely independent of each other.I'm disappointed Microsoft didn't offer a neat, fast and easy solution like Ruby are doing with the clone() method.What would be really awesome from helpers is to use my code and alter it with a workable solution so it can be compiled and work. I think it will truly help newbies trying to understand offered solutions for this issue.EDIT: Note that the Book class could be more complex and have more properties. I tried to keep things simple. <code>  using System;using System.Collections.Generic;using System.Drawing;using System.Windows.Forms;namespace clone_test_01{ public partial class MainForm : Form { public class Book { public string title = """"; public Book(string title) { this.title = title; } } public MainForm() { InitializeComponent(); List<Book> books_1 = new List<Book>(); books_1.Add( new Book(""One"") ); books_1.Add( new Book(""Two"") ); books_1.Add( new Book(""Three"") ); books_1.Add( new Book(""Four"") ); List<Book> books_2 = new List<Book>(books_1); books_2[0].title = ""Five""; books_2[1].title = ""Six""; textBox1.Text = books_1[0].title; textBox2.Text = books_1[1].title; } }}",How create a new deep copy (clone) of a List<T>?
How create a new deep copy (clone) of a List<T>?," In the following piece of code, I use a Book object type to create a List<T> and I populate it with a few items giving them a unique title (from 'one' to 'five').Then I create List<Book> books_2 = new List<Book>(books_1). From this point, I know it's a clone of the list object, BUT the book objects from book_2 are still a reference from the book objects in books_1. It's proven by making changes on the two first elements of books_2, and then checking those same elements of book_1 in a TextBox.books_1[0].title and books_2[1].title have indeed been changed to the new values of books_2[0].title and books_2[1].title.NOW THE QUESTIONHow do we create a new hard copy of a List<T>? The idea is that books_1 and books_2 become completely independent of each other.I'm disappointed Microsoft didn't offer a neat, fast and easy solution like Ruby are doing with the clone() method.What would be really awesome from helpers is to use my code and alter it with a workable solution so it can be compiled and work. I think it will truly help newbies trying to understand offered solutions for this issue.EDIT: Note that the Book class could be more complex and have more properties. I tried to keep things simple. <code>  using System;using System.Collections.Generic;using System.Drawing;using System.Windows.Forms;namespace clone_test_01{ public partial class MainForm : Form { public class Book { public string title = """"; public Book(string title) { this.title = title; } } public MainForm() { InitializeComponent(); List<Book> books_1 = new List<Book>(); books_1.Add( new Book(""One"") ); books_1.Add( new Book(""Two"") ); books_1.Add( new Book(""Three"") ); books_1.Add( new Book(""Four"") ); List<Book> books_2 = new List<Book>(books_1); books_2[0].title = ""Five""; books_2[1].title = ""Six""; textBox1.Text = books_1[0].title; textBox2.Text = books_1[1].title; } }}",How create a new deep copy (clone) of a List<T>?
how to enable special charaters in MVC routing?," I'm using asp.net MVC 4.These are my routes: My current controller responds to the following request correctly:http://localhost:2020/PrivacyUrls/Details/ct14524How can I validate urls like these?http://localhost:2020/PrivacyUrls/Details/*ct14524http://localhost:2020/PrivacyUrls/Details/&ct14524which now returns 404.A potentially dangerous Request.Path value was detected from the client (*).A potentially dangerous Request.Path value was detected from the client (&).I thought adding this route, but it didn't help: <code>  routes.MapRoute( name: ""Default"", url: ""{controller}/{action}/{id}"" ); routes.MapRoute( ""PivacyUrl/Details"", ""PrivacyUrls/Details/{*ctid}"",// URL with parameters new { controller = ""PrivacyUrls"", action = ""Details"" } );",How do I enable special characters in MVC routing?
resource cannot be found in Area," I have an MVC4 project with language selection:ennlfrde1 main part with:AboutCommon (for the menu)ContactFaqHomeAnd 3 areas:AdminCustomersShopIn each area I have at least one controller, for example in Admin I have the controller overview with the corresponding view folder overview which contains an index.aspx page.The home page and all the main pages (about, faq, etc.) work and can be visited).However, when I follow the url: localhost:xxxx/en/admin/overviewI get the error: The controller for path '/en/admin/overview' was not found or does not implement IController.Even though the route is correct (I can see this with Route Debugger), the error page also shows that the error was thrown when I wanted to load my main menu items: -- Code removed because irrelevant --Everything seems to be in order, but MVC doesn't seem to be able to load the menu, which is located in the main part.So, the root of the problem is:Can I grant an area (e.g. Admin) access to the controllers in the main part (home, common, about, etc.) of my project? <code>  <nav id=""site-navigation"" class=""eightcol""> @Html.Action(""MenuItems"", ""Common"")</nav>",The controller for path was not found or does not implement IController
"How to loop through a list, getting both the key and the value"," The following code loops through a list and gets the values, but how would I write a similar statement that gets both the keys and the values e.g something like this code for the list is: <code>  foreach (string value in list.Values){ Console.WriteLine(value);} foreach (string value in list.Values){ Console.WriteLine(value); Console.WriteLine(list.key);} SortedList<string, string> list = new SortedList<string, string>();","How to loop through a SortedList, getting both the key and the value"
C# - Regex - match multiple patterns," I have 3 groups : time, date and pin. And i can have this line to match this lines : 26/06/2012 33:06:12a_user_logged_in,3412234,2,3,512,3 33:06:12a_user_logged_in,3412234,2,3,512,3,26/06/2012 26/06/2012 a_user_logged_in_at,33:06:12,3412234,2,3,512,3I want to match 26/06/2012 as the date group, 33:06:12 as the time and 3412234 as the pin group.I've succeeded in doing so but only the line must be in a certain pattern like the first one But when i apply this pattern to the other two lines forms, it didn't match.My question is, how to match time, date and pin groups no matter what was the line form ? <code>  (?<date>[\d]+/[\d]+/[\d]+) (?<time>[\d]+:[\d]+:[\d]+)([ |,][a-zA-z]*)+,(?<pin>[\d]{4,10}).+ ",Match multiple patterns with a Regex
Any tool to see where variables or stored while .NET program getting executed ? is it on stack or heap?," From long time back I wanted to know where exactly a variable (be it value type or reference type) will get stored. Will it be on stack or heap?I have read Eric Lipperts article on the same.Out of curiosity, what I wanted is to cross validate what I understood by the same. Any tool exists for the same? OR in any way will I come to know, while a .NET program is getting executed, which variables get stored on stack? and which is stored on heap?Thanks <code> ",Any tool to see where variables are stored while a .NET program is executing? Is it on the stack or heap?
Update Window Synchronously," What I am trying to do is to cause a control (in the same process, but which I have no control of) to redraw itself, and for my code to block until it finished redrawing.I tried using UpdateWindow but that doesn't seem to wait for the redraw to finish.The reason I need to wait for it to finish redrawing is that I would like to grab the screen afterwards.The control is not a dotNet control, it's a regular windows control.I've confirmed that:The handle is correct.UpdateWindow returns true.Tried sending InvalidateRect(hWnd, IntPtr.Zero, true) just before the call to UpdateWindow to make sure the window needs invalidating.Tried doing the same thing on the parent window of the control.Code used: <code>  [DllImport(""user32.dll"")][return: MarshalAs(UnmanagedType.Bool)]private static extern bool InvalidateRect(IntPtr hWnd, IntPtr rect, bool bErase);[DllImport(""user32.dll"")][return: MarshalAs(UnmanagedType.Bool)]private static extern bool UpdateWindow(IntPtr hWnd);public bool PaintWindow(IntPtr hWnd){ InvalidateRect(hWnd, IntPtr.Zero, true); return UpdateWindow(hWnd);}//returns true",Redraw Window Control Synchronously (with blocking method)
.net WebApi - Model always null on POST," I'm currently working on an integration between systems and I've decided to use WebApi for it, but I'm running into an issue...Let's say I have a model: and the POST method is: I create a request from Fiddler with the header: and body: The model parameter in the method Post is always null and I have no idea why.Does anyone have a clue? <code>  public class TestModel{ public string Output { get; set; }} public string Post(TestModel model){ return model.Output;} User-Agent: FiddlerContent-Type: ""application/xml""Accept: ""application/xml""Host: localhost:8616Content-Length: 57 <TestModel><Output>Sito</Output></TestModel>",Model always null on XML POST
.net WebApi - Model always null on XML POST," I'm currently working on an integration between systems and I've decided to use WebApi for it, but I'm running into an issue...Let's say I have a model: and the POST method is: I create a request from Fiddler with the header: and body: The model parameter in the method Post is always null and I have no idea why.Does anyone have a clue? <code>  public class TestModel{ public string Output { get; set; }} public string Post(TestModel model){ return model.Output;} User-Agent: FiddlerContent-Type: ""application/xml""Accept: ""application/xml""Host: localhost:8616Content-Length: 57 <TestModel><Output>Sito</Output></TestModel>",Model always null on XML POST
System.Drawing - Parameter is not valid. (C#)," After some more testing I've found that this problem may be due to the images somehow not being loaded in time to be cloned into bitmaps and displayed. Is this possible or no?NOTE: Yes, there are other questions with this error in the title, but from a bit of a research it seems to be an ambiguous error with many possible causes. I haven't found any questions with the same scenario as mine.I'm getting the following error. It arises from this code. seemingly at random (i.e., sometimes it works and sometimes it doesn't. The more times it's run in a row without restarting VS and rebuilding the project, the more likely it is to fail): Specifically, the fourth line: The simplified objective of the code is to return a bitmap containing a sprite from a spriteset based on a spriteset index and a sprite index. This bitmap is displayed in a PictureBox until it is changed to a different image. I know for a fact that the logic works; that's not the issue here. The .png I'm using to test is 384*256.All the parameters are set properly, all the referenced files are there, everything seems to be in order. Strangest thing of all is that sometimes it works, sometimes it doesn't. This has led me to believe that it may be a memory leak within System.Drawing itself but I can't seem to track it down.EDIT: Updated the code and added the StackTrace. Still having the same issue despite disposing the Bitmaps when they are no longer used (see code below for example of how Bitmap is disposed). StackTrace: <code>  System.ArgumentException was unhandledHResult=-2147024809Message=Parameter is not valid.Source=System.Drawing private Bitmap GetSprite(bool anim, int tsIndex, int tileIdx) { System.Drawing.Rectangle cloneRect; string prefix = (anim) ? ""A"" : ""S""; using (Bitmap b = new Bitmap(prefix + tsIndex.ToString() + "".png"")) { if (anim) { cloneRect = new System.Drawing.Rectangle(BaseObjects.A_AnimSpriteSets[tsIndex].StaticRecs[tileIdx].X, BaseObjects.A_AnimSpriteSets[tsIndex].StaticRecs[tileIdx].Y, BaseObjects.A_AnimSpriteSets[tsIndex].RecWidth, BaseObjects.A_AnimSpriteSets[tsIndex].RecHeight); } else { cloneRect = new System.Drawing.Rectangle(BaseObjects.A_StaticSpriteSets[tsIndex].StaticRecs[tileIdx].X, BaseObjects.A_StaticSpriteSets[tsIndex].StaticRecs[tileIdx].Y, BaseObjects.A_StaticSpriteSets[tsIndex].RecWidth, BaseObjects.A_StaticSpriteSets[tsIndex].RecHeight); } return b.Clone(cloneRect, b.PixelFormat); }} using (Bitmap b = new Bitmap(prefix + tsIndex.ToString() + "".png"")) if (Sprite.Image != null) { Sprite.Image.Dispose(); } Sprite.Image = GetSprite(true, tsIdx, tileIdx); System.ArgumentException was unhandled HResult=-2147024809 Message=Parameter is not valid. Source=System.Drawing StackTrace: at System.Drawing.Bitmap..ctor(String filename) at CreationTool.Main.GetSprite(Boolean anim, Int32 tsIndex, Int32 tileIdx) in F:\~\~\CreationTool\Main.cs:line 420 at CreationTool.Main.Input_EnemySprite_SelectedIndexChanged(Object sender, EventArgs e) in F:\~\~\CreationTool\Main.cs:line 107 at System.Windows.Forms.ComboBox.OnSelectedIndexChanged(EventArgs e) at System.Windows.Forms.ComboBox.set_SelectedIndex(Int32 value) at CreationTool.States.State_Enemy.populateForm() in F:\~\~\CreationTool\States\State_Enemy.cs:line 28 at CreationTool.States.State_Enemy.Load(String name) in F:\~\~\CreationTool\States\State_Enemy.cs:line 22 at CreationTool.Main.btnLoad_Click(Object sender, EventArgs e) in F:\~\~\CreationTool\Main.cs:line 174 at System.Windows.Forms.Control.OnClick(EventArgs e) at System.Windows.Forms.Button.OnClick(EventArgs e) at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent) at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks) at System.Windows.Forms.Control.WndProc(Message& m) at System.Windows.Forms.ButtonBase.WndProc(Message& m) at System.Windows.Forms.Button.WndProc(Message& m) at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m) at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m) at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam) at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG& msg) at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(IntPtr dwComponentID, Int32 reason, Int32 pvLoopData) at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context) at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context) at System.Windows.Forms.Application.Run(Form mainForm) at CreationTool.Program.Main() in F:\~\~\CreationTool\Program.cs:line 15 at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args) at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args) at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly() at System.Threading.ThreadHelper.ThreadStart_Context(Object state) at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state) at System.Threading.ThreadHelper.ThreadStart()",System.Drawing - Parameter is not valid
Using Entity Framework 5 Enums and Code First Migrations," I'm having a little difficulty getting Entity Framework 5 Enums to map to an integer column in a migration. Here's what the code looks like: The migration looks like this: However when I save changes it doesn't reflect them in the database. Database: <code>  [Table(""UserProfile"")]public class UserProfile{ public enum StudentStatusType { Student = 1, Graduate = 2 } [Key] public int UserId { get; set; } public string UserName { get; set; } public string FullName { get; set; } public StudentStatusType Status { get; set; }} public partial class EnumTest : DbMigration{ public override void Up() { AddColumn(""UserProfile"", ""Status"", c => c.Int(nullable: false, defaultValue:1)); } public override void Down() { DropColumn(""UserProfile"", ""Status""); }} var user = new UserProfile();user.Status = UserProfile.StudentStatusType.Graduate;user.FullName = ""new"";user.UserName = ""new"";users.UserProfiles.Add(user);users.SaveChanges(); ----------------------------------------------------|UserId | UserName | FullName | Status |----------------------------------------------------|1 | new | new | 1 |----------------------------------------------------",Incorrect value when saving enum
Why is my SecurityCriticalAttribute ignored?," I have an assembly marked with the AllowPartiallyTrustedCallersAttribute which contains a custom exception class. I want to make it serializable by overriding GetObjectData.With .NET 4, GetObjectDatahas become a SecurityCritical method. This means that overrides also need to be SecurityCritical. Since my assembly is marked with the AllowPartiallyTrustedCallersAttribute, all code within is automatically SecurityTransparent unless specified otherwise. Therefore, I apply the SecurityCriticalAttribute to the GetObjectData override: This works fine in full trust scenarios, e.g., when I run code linking this assembly from my desktop.However, when I use this class from a security sandbox (see below), I'm getting a TypeLoadException: Inheritance security rules violated while overriding member: 'Library.MyException.GetObjectData(System.Runtime.Serialization.SerializationInfo, System.Runtime.Serialization.StreamingContext)'. Security accessibility of the overriding method must match the security accessibility of the method being overriden.My questions:Why am I getting this exception? I did mark the override to be SecurityCritical, so where's the problem?Since the SecurityCriticalAttribute is ignored in my sandbox, how will this class behave in other partial trust hosts, such as IIS/ASP.NET or SQL Server?How do I implement a serializable exception class in .NET 4?Sandboxing Code: <code>  using System;using System.Runtime.Serialization;using System.Security;[assembly:AllowPartiallyTrustedCallers]namespace Library{ [Serializable] public class MyException : Exception { public string String; public MyException () { } protected MyException (SerializationInfo info, StreamingContext context) : base(info, context) { String = info.GetString (""String""); } [SecurityCritical] public override void GetObjectData (System.Runtime.Serialization.SerializationInfo info, System.Runtime.Serialization.StreamingContext context) { info.AddValue (""String"", String); base.GetObjectData (info, context); } }} var evidence = new Evidence();evidence.AddHostEvidence (new Zone (SecurityZone.Internet));var setupInfo = AppDomain.CurrentDomain.SetupInformation;var permissionSet = SecurityManager.GetStandardSandbox (evidence);permissionSet.AddPermission (new ReflectionPermission (ReflectionPermissionFlag.MemberAccess));permissionSet.AddPermission (new SecurityPermission (SecurityPermissionFlag.ControlEvidence));var sandbox = AppDomain.CreateDomain (""Sandbox"", evidence, setupInfo, permissionSet);",How do I implement Exception.GetObjectData in .NET 4 in a library assembly that has the AllowPartiallyTrustedCallersAttribute?
"Finding entities with same key in a graph for preventing ""An object with the same key already exists in the ObjectStateManager"" Error"," I'm using EF code first for developing my 3 layer WinForm Application, I used disconnected POCOs as my model entities. All my entities inherited from BaseEntity class. I used disconnected POCOs, so I handle entity's State on client side, and in ApplyChanges() method, I attach my entity graph(e.g An Order with it's OrderLines and Products) to my DbContext and then synch each entity's State with it's client side State. So, when I want to save a graph of related entities, I used following methods: But if my graph contains 2 or more entities with the same key i give this error : How can i detect entities with the same keys in my graph(root) and make them unique in my ApplyChanges() method? <code>  public class BaseEntity{ int _dataBaseId = -1; public virtual int DataBaseId // DataBaseId override in each entity to return it's key { get { return _dataBaseId; } } public States State { get; set; } public enum States { Unchanged, Added, Modified, Deleted }} public static EntityState ConvertState(BaseEntity.States state) { switch (state) { case BaseEntity.States.Added: return EntityState.Added; case BaseEntity.States.Modified: return EntityState.Modified; case BaseEntity.States.Deleted: return EntityState.Deleted; default: return EntityState.Unchanged; } } public void ApplyChanges<TEntity>(TEntity root) where TEntity : BaseEntity { _dbContext.Set<TEntity>().Add(root); foreach (var entry in _dbContext.ChangeTracker .Entries<BaseEntity>()) { BaseEntity stateInfo = entry.Entity; entry.State = ConvertState(stateInfo.State); } } An object with the same key already exists in the ObjectStateManager...","Finding entities with same key in an object graph for preventing ""An object with the same key already exists in the ObjectStateManager"" Error"
"Insert Query times out in C# web app, runs fine from MS SQL Server Management Studio"," I'm attempting to get an insert query to run from my C# web application. When I run the query from SQL Server Management Studio, the insert query takes around five minutes to complete. When run from the application, it times out after thirty minutes (yes minutes, not seconds).I've grabbed the actual SQL statement from the VS debugger and run it from Mgmt Studio and it works fine.All this is running from my development environment, not a production environment. There is no other SQL Server activity while the query is in progress. I'm using SQL Server 2008 R2 for development. MS VS 2010 Express, Asp.Net 4.0. SQL Server Mgmt Studio 10.There is a similar question to this that was never answered: SQL server timeout 2000 from C# .NETHere's the SET options from: dbcc useroptions Only textsize and arithabort are different.Any ideas why there is such a difference in query execution time and what I may be able to do to narrow that difference?I'm not sure how useful including the query will be, especially since it would be too much to include the schema. Anyway, here it is: <code>  Option MgtStudio Application----------------------- -------------- --------------textsize 2147483647 -1language us_english us_englishdateformat mdy mdydatefirst 7 7lock_timeout -1 -1quoted_identifier SET SETarithabort SET NOT SETansi_null_dflt_on SET SETansi_warnings SET SETansi_padding SET SETansi_nulls SET SETconcat_null_yields_null SET SETisolation level read committed read committed INSERT INTO GeocacherPoints (CacherID, RegionID, Board, Control, Points)SELECT z.CacherID, z.RegionID, z.Board, 21, z.PointsFROM (SELECT CacherID, gp.RegionID, Board=gp.Board + 10, ( CASE WHEN (SELECT COUNT(*) FROM Geocache g JOIN GeocacheRegions r ON ( r.CacheID = g.ID ) WHERE r.RegionID = gp.RegionID AND g.FinderPoints >= 5) < 20 THEN NULL ELSE (SELECT SUM(y.FinderPoints) / 20 FROM (SELECT x.FinderPoints, ROW_NUMBER() OVER (ORDER BY x.FinderPoints DESC, x.ID) AS Row FROM (SELECT g.FinderPoints, g.ID FROM Geocache g JOIN Log l ON ( l.CacheID = g.ID ) JOIN Geocacher c ON ( c.ID = l.CacherID ) JOIN GeocacheRegions r ON ( r.CacheID = g.ID ) WHERE YEAR(l.LogDate) = @Year AND g.FinderPoints >= 5 AND c.ID = gp.CacherID AND r.RegionID = gp.RegionID) x) y WHERE y.Row <= 20) END ) Points FROM GeocacherPoints gp JOIN Region r ON r.RegionID = gp.RegionID WHERE gp.Control = 21 AND r.RegionType IN ( 'All', 'State' ) AND gp.Board = @Board - 10) zWHERE z.Points IS NOT NULL AND z.Points >= 1 ","Insert query times out in C# web app, runs fine from SQL Server Management Studio"
MVCMailer smtp mailsettings set configuration settings programatically," MVCMailer uses the smtp settings from the web.config file as follows: Controller: Is there anyway to set the SMTP settings in code? I want to avoid saving the password in the web.config file.  <code>  <system.net><mailSettings> <smtp from=""some-email@gmail.com""> <network enableSsl=""true"" host=""smtp.gmail.com"" port=""587"" userName=""some-email@gmail.com"" password=""valid-password"" /> </smtp></mailSettings></system.net> public virtual MvcMailMessage Welcome(){ //ViewBag.Data = someObject; return Populate(x => { x.ViewName = ""Welcome""; x.To.Add(""some-email@example.com""); x.Subject = ""Welcome""; });}",MVCMailer smtp mailsettings set configuration settings programmatically
How to check if System.IO.File.Delete deleted a file sucessfully," After removing a file using the system.io.file class: I need to run some code if the file was sucessfully deleted.As long as the method does not return any value, I am checking if the file exist after the delete method. If it still exist I supposed the operation had failed.The problem is, the deletion method works fine, but there is a couple of seconds to the file to be deleted. The Exist function return true because at the time it is checking the file is there.How can I verify for sure if the System.IO.File.Delete(openedPdfs.path); completed successfully?Code: <code>  System.IO.File.Delete(openedPdfs.path); FileInfo file = new FileInfo(openedPdfs.path); System.IO.File.Delete(openedPdfs.path);if (file.Exists == false){ ... }else { ... }",How to check if System.IO.File.Delete deleted a file successfully
How to concatenate two System.Collections.Generic.IEnumerable<T> into a new System.Collections.Generic.IEnumerable<T>?, I have two instances of IEnumerable<T> (with the same T). I want a new instance of IEnumerable<T> which is the concatenation of both.Is there a built-in method in .NET to do that or do I have to write it myself? <code> ,How to concatenate two IEnumerable<T> into a new IEnumerable<T>?
How can I fix my ListBox templates?," I have a Silverlight application that displays a list of items in a ListBox. Each item represents a different 'page' of my application so I have a style that is applied to the ItemContainerStyle property that looks like this: The style is very simple. It simply displays the Border when the ListBoxItem's visual state is equal to 'Selected'. Notice that the content is hosted by a ContentControl as I want to be able to change the Foreground property when the item is in the 'Selected' state. This works brilliantly as can be seen by the screenshot below:Now I want the selected item to invoke navigation so the idea I had was to create a DataTemplate that sets the content of each item to a HyperLinkButton: Now this doesn't work as the ItemTemplate hosts it's content in a ContentControl rather than a ContentPresenter so I have had to update the ListBoxItem template to use a ContentPresenter instead. I now get the following result:When I click on the HyperLinkButton the ListBoxItem is now no longer selected (I can click just outside the HyperLinkButton and the ListBoxItem becomes selected). What I really want is for the ListBoxItem to become selected when the HyperLinkButton is clicked. The HyperLinkButton has no concept of selection so I cannot bind to the ListBoxItem's IsSelected property.Note: The actual navigation works perfectly, the problem is purely with the appearance of the ListBoxItems.So my questions are:Can I make it so that when the HyperLinkButton is clicked, the ListBoxItem becomes selected like the first image?I will also need some way of changing the foreground of the HyperLinkButton when it is selected as this is no longer done in the items template due to me swapping the ContentControl fro a ContentPresenter.Note: I could probably solve this problem by binding the SelectedItem property of the ListBox to my viewModel and handling the navigation there negating the requirement to have a HyperLinkButton hosted by each ListBoxItem but I am interested in knowing if it is possible using styles and templates to achieve my desired result.UpdateI have tried a couple of things to try and resolve this but so far have been unsuccessful. The first thing I tried was applying a new style to the HyperLinkButton control in my DataTemplate which essentially removes all of the default look and feel from the control but my application still behaves in the way described above.The second thing I tried was setting the IsHitTestVisible property to false. This allows me to click 'through' the HyperLinkbutton and select the ListBoxItem but this means that the navigation is now no longer invoked. <code>  <Style x:Key=""navigationItemContainerStyle"" TargetType=""ListBoxItem""> <Setter Property=""Margin"" Value=""5,3""/> <Setter Property=""FontSize"" Value=""16""/> <Setter Property=""Template""> <Setter.Value> <ControlTemplate> <Grid Cursor=""Hand""> <VisualStateManager.VisualStateGroups> <!-- code omitted --!> </VisualStateManager.VisualStateGroups> <Border x:Name=""contentBorder"" Background=""{StaticResource navigationHighlightBrush}"" CornerRadius=""3"" Opacity=""0""/> <ContentControl x:Name=""content"" Margin=""10,5"" Content=""{Binding}"" Foreground=""DarkGray""/> </Grid> </ControlTemplate> </Setter.Value> </Setter></Style> <DataTemplate x:Key=""navigationListBoxItemTemplate""> <HyperlinkButton Content=""{Binding}"" Background=""Transparent""/></DataTemplate> <ContentPresenter x:Name=""content"" Margin=""10,5""/>",How to correctly use a button in a listbox itemtemplate / datatemplate?
Is there an equivalent of DependencyObjectCollection<T> for WPF .NET40?," The class allows the propagations of data context from the collection to its members. But it is only for SilverLight. More info for DepedencyObjectCollection can be found from this post.If the equivalent doesn't exist, what's the necessary steps required to create one? I observe the desire behavior from the RowDefinitionCollection class. But I couldn't figure out its implementation.thanks <code> ",Is there an equivalent of DependencyObjectCollection<T> for WPF .NET4.0?
windows form listview minimum column width," I have the application look like it stops the width at 50, but if the mouse is dragged further on and then let up, the width will be below: I cannot work out how to force the ColumnWidthChanged width to 50 if the changed width = < 50. I don't need to fix the column widths, as information will vary in length, but force a minimum width. Any suggestions? <code>  private void ListView1_ColumnWidthChanging(object sender, ColumnWidthChangingEventArgs e){ if (e.ColumnIndex ==0 & e.NewWidth <50) { e.Cancel = true; }}",Windows Form listview minimum column width
Is it possible to use optional parameters in a lambda expression in c#?," Is there a way to use optional arguments (default parameters) with lambda expressions in c#? I have read through the documentation but can find nothing to say one way or the other.To illustrate, I can define simple method that uses an optional argument to supply a default value like so: What I want to know is if I am able to do the same thing using a lambda expression. I can work in an optional parameter with a default value using a delegate, but this seems a bit clumsy. Alternatively I could check the parameter in the lambda body, something like... But again this seems a bit clumsy.Is it possible to use optional parameters to set a default value in a lambda expression in c#? <code>  void MyMethod(string arg = ""default-value""){ Console.WriteLine(arg);} // gives a syntax errorAction<string> MyMethod = (arg = ""default"") => Console.WriteLine(arg); delegate void MyDelegate(string arg = ""default"");MyDelegate MyMethod = arg => Console.WriteLine(arg); Action<string> MyMethod = (arg) => Console.WriteLine(string.IsNullOrEmpty(arg) ? ""default"" : arg);",Is it possible to use optional/default parameters in a lambda expression in c#?
How can i use enum types in XAML?," I'm learning WPF and I encountered the following problem:I have an enum type in another namespace than my XAML: in my XAML I'd like to trigger an image with an integer Is there a way to get an integer value and compare it with an enum type directly in XAML code?My enum is in namespace AnotherNamespace.Types <code>  public enum NodeType { Type_SYSTEM = 1, // System Type_DB = 2, // Database Type_ROOT = 512, // Root folder Type_FOLDER = 1024, // Folder } <Image.Style> <Style TargetType=""{x:Type Image}""> <Style.Triggers> <DataTrigger Binding=""{Binding Type}"" Value=""{NodeType: }""> <Setter Property=""Source"" Value=""/Images/DB.PNG""/> </DataTrigger> <DataTrigger Binding=""{Binding Type}"" Value=""128""> <Setter Property=""Source"" Value=""/Images/SERVER.PNG""/> </DataTrigger> </Style.Triggers> </Style></Image.Style> <DataTrigger Binding=""{Binding IntegerType}"" Value=""MyEnumType.Type_DB""> <Setter Property=""Source"" Value=""/Images/SERVER.PNG""/> </DataTrigger>",How can I use enum types in XAML?
Casting DataSource to List<T> in C#," I have the following method that load products on a DataGridView And now I'm trying to give me back to save them as shows below. But I get an InvalidCastException on this line: So how can I cast the DataSource to an List? <code>  private void LoadProducts(List<Product> products){ Source.DataSource = products; // Source is BindingSource ProductsDataGrid.DataSource = Source;} private void SaveAll(){ Repository repository = Repository.Instance; List<object> products = (List<object>)Source.DataSource; Console.WriteLine(""Este es el nmero {0}"", products.Count); repository.SaveAll<Product>(products); notificacionLbl.Visible = false;} List<object> products = (List<object>)Source.DataSource;",How to Casting DataSource to List<T>?
Casting DataSource to List<T>," I have the following method that load products on a DataGridView And now I'm trying to give me back to save them as shows below. But I get an InvalidCastException on this line: So how can I cast the DataSource to an List? <code>  private void LoadProducts(List<Product> products){ Source.DataSource = products; // Source is BindingSource ProductsDataGrid.DataSource = Source;} private void SaveAll(){ Repository repository = Repository.Instance; List<object> products = (List<object>)Source.DataSource; Console.WriteLine(""Este es el nmero {0}"", products.Count); repository.SaveAll<Product>(products); notificacionLbl.Visible = false;} List<object> products = (List<object>)Source.DataSource;",How to Casting DataSource to List<T>?
Custom control in DataGridView cell," I have a custom control in a DataGridView cell. Its a combobox that contains checkbox items (CheckBoxComboBox). Here's the issue :1. Enter one of the CheckBoxComboBoxes and select off some checkbox items. The Text of the CheckboxComboBox is a csv string of the checked items.2. Click a different CheckboxComboBox cell that is emtpy (no checked items)Result : The text of the new cell contains the text of the old cell. If I click a CheckBoxComboBox cell, then a non-CheckBoxComboBox cell and then a CheckBoxComboBox cell, it works correctly.I have read and implemented the custom DataGridViewCell based on this document :How to: Host Controls in Windows Forms DataGridView CellsWhen I debug through my custom DataGridViewEditingControl, it appears that the EditingControl.Tag isn't updated.So I am assuming that I have an issue with the EditingControl is being reused. Things I have tried : 1. Override DataGridViewCell.Clone() 2. Override DataGridViewCell.DetachEditingControl() Any idea how to resolve this issue ? Thanks.EDIT 1Here is the DataGridViewCheckBoxComboBoxColumn class EDIT 2My DataGridViewCheckBoxComboBoxCell overrides Paint(). When I put a breakpoint on this method, it gets called twice when I click the cell. The first time its called, the formattedValue is empty. However, the second time, the formattedValue contains the incorrect string of the previous checkboxcombobox cell. Why does it get called twice and why on the second call does it contain the wrong formatted value for the correct cell? <code>  public override object Clone() { DataGridViewCheckBoxComboBoxCell checkBoxComboBoxCell = base.Clone() as DataGridViewCheckBoxComboBoxCell; if (checkBoxComboBoxCell != null) { checkBoxComboBoxCell.Tag = this.Tag; checkBoxComboBoxCell.Values = this.Values; } return checkBoxComboBoxCell; } public override void DetachEditingControl() { DataGridView dataGridView = this.DataGridView; if (dataGridView == null || dataGridView.EditingControl == null) { throw new InvalidOperationException(""Cell is detached or its grid has no editing control.""); } DataGridViewCheckBoxComboBoxCellEditingControl ctl = DataGridView.EditingControl as DataGridViewCheckBoxComboBoxCellEditingControl; if (ctl != null) { //Just trying different things ctl.EditingControlFormattedValue = String.Empty; ctl.Text = string.Empty; ctl.Tag = null; ctl.Items.Clear(); } base.DetachEditingControl(); } class DataGridViewCheckBoxComboBoxColumn : DataGridViewColumn{ public override object Clone() { DataGridViewCheckBoxComboBoxColumn that = (DataGridViewCheckBoxComboBoxColumn)base.Clone(); return that; } private DataGridViewCheckBoxComboBoxCell _cell = null; public DataGridViewCheckBoxComboBoxColumn() { _cell = new DataGridViewCheckBoxComboBoxCell(); base.CellTemplate = _cell; } public override DataGridViewCell CellTemplate { get { return base.CellTemplate; } set { // Ensure that the cell used for the template is a DateCell. if (value != null && !value.GetType().IsAssignableFrom(typeof(DataGridViewCheckBoxComboBoxCell))) { throw new InvalidCastException(""Must be a DataGridViewCheckBoxComboBoxColumn""); } base.CellTemplate = value; } } public string Values { set { _cell.Tag = value; this.Tag = value; } get { return _cell.Tag.ToString(); } }} protected override void Paint(Graphics graphics, Rectangle clipBounds, Rectangle cellBounds, int rowIndex, DataGridViewElementStates cellState, object value, object formattedValue, string errorText, DataGridViewCellStyle cellStyle, DataGridViewAdvancedBorderStyle advancedBorderStyle, DataGridViewPaintParts paintParts) {}",Custom control cell
Basic implemantation of AOP like attribute using standard NET Framework," Possible Duplicate: C# wrap method via attributes I'd like to achieve such functionality: Where [Atomic] attribute is an attribute, which wraps function logic within a transaction scope: How to write such an attribute? I've asked before basically the same question, I know this can be done using AOP, but I didn't mention I'm searching for some simplest proof of concept implementation or helpful articles which can help me to write this using pure .NET Framework (I suppose using RealProxy and MarshalByRefObject types, about which I've read browsing related questions). I need to solve exactly this shown example. It seems like a basic thing so I want to learn how to do it starting from scratch. It doesn't need to be safe and flexible for now. <code>  [Atomic]public void Foo(){ /* foo logic */} using(var scope = new TransactionScope()){ /* foo logic */ scope.Complete();}",Basic implementation of AOP like attribute using standard .NET Framework
delayed NUnit Assert message evaluation," I have this assert in my test code that asserts some condition after a period of time and on failure produces a message. it fails to run because the message string is constructed when the assert starts and not when the assert ends. therefore the eventData collection is still empty (as it is initially) and the attempt to get the Description of the last item in the collection fails. is there a workaround or decent alternative to this in NUnit or do I have to revert to using Thread.Sleep in my tests?PS: I'm using NUnit 2.5.10. <code>  Assert.That(() => eventData.Count == 0,Is.True.After(notificationPollingDelay),""Received unexpected event with last event data"" + eventData.Last().Description());",Delayed NUnit Assert message evaluation
C# - How to get the NEW text in TextChanged?," In a TextBox I'm monitoring the text changes. I need to check the text before doing some stuff. But I can only check the old text in the moment. How can I get the new Text ? I know .NET Framework 4.5 has the new TextChangedEventArgs class but I have to use .NET Framework 2.0. <code>  private void textChanged(object sender, EventArgs e){ // need to check the new text}",How to get the NEW text in TextChanged?
WinForm CEF(Chromium Embedded Framework) browser doesn't show up," Solution:This issue is caused by not loading the CefRuntime in the Program.cs. Simply copying all code in the sample file to your Program.cs.And then if your CefWebBrowser is stuck and having ""a spinning wait mouse cursor"" then set the SingleProcess = true.The reason is if the browser is called from a recognized secondary process, the whole process will be blocked until the process is ended. Question:Anyone has experience using CEF (Chromium Embedded Framework) in WinForm?This component has tortured me a whole day. I cannot make it work.It just simply doesn't show up.So my question is: how to use CEF in a WinForm application?I did check the forum, but surprisingly no one asked this question.It seems like I am the only dumb person who doesn't know how to use it. Update:I am trying to use Xilium.CefGlue.After I copied right version of the release dlls (991) I get an exception: Source:Xilium.CefGlueStack Trace: Can anyone help me please?Update 2: <code>  public partial class Form1 : Form{ private CefWebBrowser cefwbShell = null; //private readonly SynchronizationContext _pUIThread; private void Form1_Load(object sender, EventArgs e) { cefwbShell.Visible = true; cefwbShell = new CefWebBrowser { StartUrl = ""http://example.com"" }; cefwbShell.Parent = this; cefwbShell.Dock = DockStyle.Fill; cefwbShell.BringToFront(); cefwbShell.Show(); }} InvalidOperationException was unhandlled by user code Failed to create browser. at Xilium.CefGlue.CefBrowserHost.CreateBrowser(CefWindowInfo windowInfo, CefClient client, CefBrowserSettings settings, String url) in C:\Winston\Knowledge\Projects\xilium-xilium.cefglue-61551ec98ad8\xilium-xilium.cefglue-61551ec98ad8\CefGlue\Classes.Proxies\CefBrowserHost.cs:line 37 at Xilium.CefGlue.WindowsForms.CefWebBrowser.OnHandleCreated(EventArgs e) in C:\Winston\Knowledge\Projects\xilium-xilium.cefglue-61551ec98ad8\xilium-xilium.cefglue-61551ec98ad8\CefGlue.WindowsForms\CefWebBrowser.cs:line 71 at System.Windows.Forms.Control.WmCreate(Message& m) at System.Windows.Forms.Control.WndProc(Message& m) at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m) at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m) at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam) at System.Windows.Forms.UnsafeNativeMethods.IntCreateWindowEx(Int32 dwExStyle, String lpszClassName, String lpszWindowName, Int32 style, Int32 x, Int32 y, Int32 width, Int32 height, HandleRef hWndParent, HandleRef hMenu, HandleRef hInst, Object pvParam) at System.Windows.Forms.UnsafeNativeMethods.CreateWindowEx(Int32 dwExStyle, String lpszClassName, String lpszWindowName, Int32 style, Int32 x, Int32 y, Int32 width, Int32 height, HandleRef hWndParent, HandleRef hMenu, HandleRef hInst, Object pvParam) at System.Windows.Forms.NativeWindow.CreateHandle(CreateParams cp) at System.Windows.Forms.Control.CreateHandle() at System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible) at System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible) at System.Windows.Forms.Control.CreateControl() at System.Windows.Forms.Control.SetVisibleCore(Boolean value) private void Create() { var page = new TabPage(""New Tab""); page.Padding = new Padding(0, 0, 0, 0); var browser = new CefWebBrowser(); browser.StartUrl = startUrl; browser.Dock = DockStyle.Fill; browser.TitleChanged += (s, e) => { BeginInvoke(new Action(() => { var title = browser.Title; if (tabControl.SelectedTab == page) { Text = browser.Title + "" - "" + _mainTitle; } page.ToolTipText = title; if (title.Length > 18) { title = title.Substring(0, 18) + ""...""; } page.Text = title; })); }; browser.AddressChanged += (s, e) => { BeginInvoke(new Action(() => { addressTextBox.Text = browser.Address; })); }; browser.StatusMessage += (s, e) => { BeginInvoke(new Action(() => { statusLabel.Text = e.Value; })); }; page.Controls.Add(browser); tabControl.TabPages.Add(page); tabControl.SelectedTab = page; }",CefWebBrowser doesn't show up
WinForm CEF (Chromium Embedded Framework) browser doesn't show up," Solution:This issue is caused by not loading the CefRuntime in the Program.cs. Simply copying all code in the sample file to your Program.cs.And then if your CefWebBrowser is stuck and having ""a spinning wait mouse cursor"" then set the SingleProcess = true.The reason is if the browser is called from a recognized secondary process, the whole process will be blocked until the process is ended. Question:Anyone has experience using CEF (Chromium Embedded Framework) in WinForm?This component has tortured me a whole day. I cannot make it work.It just simply doesn't show up.So my question is: how to use CEF in a WinForm application?I did check the forum, but surprisingly no one asked this question.It seems like I am the only dumb person who doesn't know how to use it. Update:I am trying to use Xilium.CefGlue.After I copied right version of the release dlls (991) I get an exception: Source:Xilium.CefGlueStack Trace: Can anyone help me please?Update 2: <code>  public partial class Form1 : Form{ private CefWebBrowser cefwbShell = null; //private readonly SynchronizationContext _pUIThread; private void Form1_Load(object sender, EventArgs e) { cefwbShell.Visible = true; cefwbShell = new CefWebBrowser { StartUrl = ""http://example.com"" }; cefwbShell.Parent = this; cefwbShell.Dock = DockStyle.Fill; cefwbShell.BringToFront(); cefwbShell.Show(); }} InvalidOperationException was unhandlled by user code Failed to create browser. at Xilium.CefGlue.CefBrowserHost.CreateBrowser(CefWindowInfo windowInfo, CefClient client, CefBrowserSettings settings, String url) in C:\Winston\Knowledge\Projects\xilium-xilium.cefglue-61551ec98ad8\xilium-xilium.cefglue-61551ec98ad8\CefGlue\Classes.Proxies\CefBrowserHost.cs:line 37 at Xilium.CefGlue.WindowsForms.CefWebBrowser.OnHandleCreated(EventArgs e) in C:\Winston\Knowledge\Projects\xilium-xilium.cefglue-61551ec98ad8\xilium-xilium.cefglue-61551ec98ad8\CefGlue.WindowsForms\CefWebBrowser.cs:line 71 at System.Windows.Forms.Control.WmCreate(Message& m) at System.Windows.Forms.Control.WndProc(Message& m) at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m) at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m) at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam) at System.Windows.Forms.UnsafeNativeMethods.IntCreateWindowEx(Int32 dwExStyle, String lpszClassName, String lpszWindowName, Int32 style, Int32 x, Int32 y, Int32 width, Int32 height, HandleRef hWndParent, HandleRef hMenu, HandleRef hInst, Object pvParam) at System.Windows.Forms.UnsafeNativeMethods.CreateWindowEx(Int32 dwExStyle, String lpszClassName, String lpszWindowName, Int32 style, Int32 x, Int32 y, Int32 width, Int32 height, HandleRef hWndParent, HandleRef hMenu, HandleRef hInst, Object pvParam) at System.Windows.Forms.NativeWindow.CreateHandle(CreateParams cp) at System.Windows.Forms.Control.CreateHandle() at System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible) at System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible) at System.Windows.Forms.Control.CreateControl() at System.Windows.Forms.Control.SetVisibleCore(Boolean value) private void Create() { var page = new TabPage(""New Tab""); page.Padding = new Padding(0, 0, 0, 0); var browser = new CefWebBrowser(); browser.StartUrl = startUrl; browser.Dock = DockStyle.Fill; browser.TitleChanged += (s, e) => { BeginInvoke(new Action(() => { var title = browser.Title; if (tabControl.SelectedTab == page) { Text = browser.Title + "" - "" + _mainTitle; } page.ToolTipText = title; if (title.Length > 18) { title = title.Substring(0, 18) + ""...""; } page.Text = title; })); }; browser.AddressChanged += (s, e) => { BeginInvoke(new Action(() => { addressTextBox.Text = browser.Address; })); }; browser.StatusMessage += (s, e) => { BeginInvoke(new Action(() => { statusLabel.Text = e.Value; })); }; page.Controls.Add(browser); tabControl.TabPages.Add(page); tabControl.SelectedTab = page; }",CefWebBrowser doesn't show up
browser doesn't show up," Solution:This issue is caused by not loading the CefRuntime in the Program.cs. Simply copying all code in the sample file to your Program.cs.And then if your CefWebBrowser is stuck and having ""a spinning wait mouse cursor"" then set the SingleProcess = true.The reason is if the browser is called from a recognized secondary process, the whole process will be blocked until the process is ended. Question:Anyone has experience using CEF (Chromium Embedded Framework) in WinForm?This component has tortured me a whole day. I cannot make it work.It just simply doesn't show up.So my question is: how to use CEF in a WinForm application?I did check the forum, but surprisingly no one asked this question.It seems like I am the only dumb person who doesn't know how to use it. Update:I am trying to use Xilium.CefGlue.After I copied right version of the release dlls (991) I get an exception: Source:Xilium.CefGlueStack Trace: Can anyone help me please?Update 2: <code>  public partial class Form1 : Form{ private CefWebBrowser cefwbShell = null; //private readonly SynchronizationContext _pUIThread; private void Form1_Load(object sender, EventArgs e) { cefwbShell.Visible = true; cefwbShell = new CefWebBrowser { StartUrl = ""http://example.com"" }; cefwbShell.Parent = this; cefwbShell.Dock = DockStyle.Fill; cefwbShell.BringToFront(); cefwbShell.Show(); }} InvalidOperationException was unhandlled by user code Failed to create browser. at Xilium.CefGlue.CefBrowserHost.CreateBrowser(CefWindowInfo windowInfo, CefClient client, CefBrowserSettings settings, String url) in C:\Winston\Knowledge\Projects\xilium-xilium.cefglue-61551ec98ad8\xilium-xilium.cefglue-61551ec98ad8\CefGlue\Classes.Proxies\CefBrowserHost.cs:line 37 at Xilium.CefGlue.WindowsForms.CefWebBrowser.OnHandleCreated(EventArgs e) in C:\Winston\Knowledge\Projects\xilium-xilium.cefglue-61551ec98ad8\xilium-xilium.cefglue-61551ec98ad8\CefGlue.WindowsForms\CefWebBrowser.cs:line 71 at System.Windows.Forms.Control.WmCreate(Message& m) at System.Windows.Forms.Control.WndProc(Message& m) at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m) at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m) at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam) at System.Windows.Forms.UnsafeNativeMethods.IntCreateWindowEx(Int32 dwExStyle, String lpszClassName, String lpszWindowName, Int32 style, Int32 x, Int32 y, Int32 width, Int32 height, HandleRef hWndParent, HandleRef hMenu, HandleRef hInst, Object pvParam) at System.Windows.Forms.UnsafeNativeMethods.CreateWindowEx(Int32 dwExStyle, String lpszClassName, String lpszWindowName, Int32 style, Int32 x, Int32 y, Int32 width, Int32 height, HandleRef hWndParent, HandleRef hMenu, HandleRef hInst, Object pvParam) at System.Windows.Forms.NativeWindow.CreateHandle(CreateParams cp) at System.Windows.Forms.Control.CreateHandle() at System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible) at System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible) at System.Windows.Forms.Control.CreateControl() at System.Windows.Forms.Control.SetVisibleCore(Boolean value) private void Create() { var page = new TabPage(""New Tab""); page.Padding = new Padding(0, 0, 0, 0); var browser = new CefWebBrowser(); browser.StartUrl = startUrl; browser.Dock = DockStyle.Fill; browser.TitleChanged += (s, e) => { BeginInvoke(new Action(() => { var title = browser.Title; if (tabControl.SelectedTab == page) { Text = browser.Title + "" - "" + _mainTitle; } page.ToolTipText = title; if (title.Length > 18) { title = title.Substring(0, 18) + ""...""; } page.Text = title; })); }; browser.AddressChanged += (s, e) => { BeginInvoke(new Action(() => { addressTextBox.Text = browser.Address; })); }; browser.StatusMessage += (s, e) => { BeginInvoke(new Action(() => { statusLabel.Text = e.Value; })); }; page.Controls.Add(browser); tabControl.TabPages.Add(page); tabControl.SelectedTab = page; }",CefWebBrowser doesn't show up
C#: How to pin an 'unmanaged' pointer?," I have an external method that receives some parameters, allocates memory and returns a pointer. I'm well aware that it is bad practice to allocate unmanaged memory in a managed application but in this case I have no choice as the dll is 3rd party.There is an equivalent function that releases the memory and I do know what is the size of the allocated array.How do I pin the returned pointer so the GC does not move it (without going unsafe)? 'fixed' won't do it as this pointer is widely used throughout the class?Is there a better methodology for this p/Invoke? <code>  [DllImport(""some.dll"", CallingConvention = CvInvoke.CvCallingConvention)]public static extern IntPtr cvCreateHeader( Size size, int a, int b);",How to pin an 'unmanaged' pointer?
c# check if indexing operator exists," I want to be able to:Check if an object has an indexing operator defined.If it is defined, I want to be able to use it.I want to implement this in the following code.The code contains an object (MyObject) that offers a way to traverse through a multidimensional array or linked set of hash tables. Also it should prevent giving errors if a node in the requested path doesn't exist.The part that I can't figure out is the commented part in the code: This is what I wish to accomplish: <code>  public class MyObject{ private object myObject = null; public MyObject() { } public MyObject(object value) { myObject = value; } public void setValue(object value) { myObject = value; } public object getValue() { return myObject; } public object this[string key] { get { if (myObject == null) { return new MyObject(null); } else { // determine what of type/class myObject is and if it has indexing operators defined // if defined, access them and return the result // else return null. } } set { if (myObject == null) { // do nothing (or throw an exception); } else{ // determine what of type/class myObject is // determine if that type/class has indexing operators defined // if defined, access them and set the result there // else do nothing (or throw an exception). } } }} // given these variables: string loremIpsumString = ""lorem ipsum dolor sit amet""; int[] digits = new int[10]; for (int i = 0; i <= 3; i++) digits[i] = i; Hashtable outerHashtable = new Hashtable(); Hashtable innerHashtable = new Hashtable(); innerHashtable.Add(""contents"", ""this is inside""); outerHashtable.Add(""outside"", ""this is outside""); outerHashtable.Add(""inside"", innerHashtable); // I can already print this: Response.Write( loremIpsumString ); // prints ""lorem ipsum dolor sit amet"" Response.Write( digits[0] ); // prints ""0"" Response.Write( digits[1] ); // prints ""1"" Response.Write( digits[2] ); // prints ""2"" Response.Write( outerHashtable[""outside""] ); // prints ""this is outside"" Response.Write( ((Hashtable)outerHashtable[""inside""])[""contents""] ); // prints ""this is outside"" // But I want to be to do it this way: MyObject myObject; myObject = new MyObject(loremIpsumString); Response.Write( myObject.getValue() ); // prints ""lorem ipsum dolor sit amet"" Response.Write( myObject[""unexistant""].getValue() ); // prints nothing/null myObject = new MyObject(digits); Response.Write( myObject[0].getValue() ); // prints ""0"" Response.Write( myObject[1].getValue() ); // prints ""1"" Response.Write( myObject[2].getValue() ); // prints ""2"" myObject = new MyObject(outerHashtable); Response.Write( myObject[""outside""].getValue() ); // prints ""this is outside"" Response.Write( myObject[""inside""][""contents""].getValue() ); // prints ""this is inside"" Response.Write( myObject[""unexistant""].getValue() ); // prints nothing/null Response.Write( myObject[""unexistant""][""unexistant""][""unexistant""].getValue() ); // prints nothing/null",Check if indexing operator exists
EMGU: Access Violation Exception mystery," I've been working with EMGU+OpenCV for quite some time and ran into this AccessViolationException mystery.First thing first, the code: The code is simple. Allocate an array of images. Generate a random image and populate it with random numbers. Execute bilateral filter over the image. That's it.If I execute this program in a single thread, (Threads=1) everything seems to work normally with no problem.But, if I raise the number of concurrent threads to 5 I get an AccessViolationException very quickly.I've went over OpenCV code and verified that there are no allocations on the OpenCV side and also went over the EMGU code searching for un-pinned objects or other problems and everything seems correct.Some notes:If you remove the GC.Collect() you will get the AccessViolationException less often but it will eventually happen.This happens only when executed in Release mode. In Debug mode I didn't experience any exceptions.Although each Image is 675MB there is no problem with allocation (I have ALLOT of memory) and a 'OutOfMemoryException' is thrown in case the system ran out of memory.I used bilateral filter but I get this exception with other filters/functions as well. Any help would be appreciated. I've been trying to fix this for more than a week.i7 (no overclock), Win7 64bit, 32GB RAM, VS 2010, Framework 4.0, OpenCV 2.4.3Stack: <code>  class AVE_Simulation { public static int Width = 7500; public static int Height = 7500; public static Emgu.CV.Image<Rgb, float>[] Images; static void Main(string[] args) { int N = 50; int Threads = 5; Images = new Emgu.CV.Image<Rgb, float>[N]; Console.WriteLine(""Start""); ParallelOptions po = new ParallelOptions(); po.MaxDegreeOfParallelism = Threads; System.Threading.Tasks.Parallel.For(0, N, po, new Action<int>((i) => { Images[i] = GetRandomImage(); Console.WriteLine(""Prossing image: "" + i); Images[i].SmoothBilatral(15, 50, 50); GC.Collect(); })); Console.WriteLine(""End""); } public static Emgu.CV.Image<Rgb, float> GetRandomImage() { Emgu.CV.Image<Rgb, float> im = new Emgu.CV.Image<Rgb, float>(Width, Height); float[, ,] d = im.Data; Random r = new Random((int)DateTime.Now.Ticks); for (int y = 0; y < Height; y++) { for (int x = 0; x < Width; x++) { d[y, x, 0] = (float)r.Next(255); d[y, x, 1] = (float)r.Next(255); d[y, x, 2] = (float)r.Next(255); } } return im; } } StartProssing image: 20Prossing image: 30Prossing image: 40Prossing image: 0Prossing image: 10Prossing image: 21Unhandled Exception: System.AccessViolationException: Attempted to read or write protected memory. This is often an indication that other memory is corrupt. at Emgu.CV.CvInvoke.cvSmooth(IntPtr src, IntPtr dst, SMOOTH_TYPE type, Int32 param1, Int32 param2, Double param3, Double param4) at TestMemoryViolationCrash.AVE_Simulation.<Main>b__0(Int32 i) in C:\branches\1.1\TestMemoryViolationCrash\Program.cs:line 32 at System.Threading.Tasks.Parallel.<>c__DisplayClassf`1.<ForWorker>b__c() at System.Threading.Tasks.Task.InnerInvokeWithArg(Task childTask) at System.Threading.Tasks.Task.<>c__DisplayClass10.<ExecuteSelfReplicating>b__f(Object param0) at System.Threading.Tasks.Task.Execute() at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx) at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot) at System.Threading.Tasks.Task.ExecuteEntry(Boolean bPreventDoubleExecution) at System.Threading.Tasks.ThreadPoolTaskScheduler.TryExecuteTaskInline(Task task, Boolean taskWasPreviouslyQueued) at System.Threading.Tasks.TaskScheduler.TryRunInline(Task task, Boolean taskWasPreviouslyQueued) at System.Threading.Tasks.Task.InternalRunSynchronously(TaskScheduler scheduler, Boolean waitForCompletion) at System.Threading.Tasks.Parallel.ForWorker[TLocal](Int32 fromInclusive, Int32 toExclusive, ParallelOptions parallelOptions, Action`1 body, Action`2 bodyWithState, Func`4 bodyWithLocal, Func`1 localInit, Action`1 localFinally) at System.Threading.Tasks.Parallel.For(Int32 fromInclusive, Int32 toExclusive, ParallelOptions parallelOptions, Action`1 body) at TestMemoryViolationCrash.AVE_Simulation.Main(String[] args) in C:\branches\1.1\TestMemoryViolationCrash\Program.cs:line 35Unhandled Exception: System.AccessViolationException: Attempted to read or write protected memory. This is often an indication that other memory is corrupt. at Emgu.CV.CvInvoke.cvSmooth(IntPtr src, IntPtr dst, SMOOTH_TYPE type, Int32 param1, Int32 param2, Double param3, Double param4) at TestMemoryViolationCrash.AVE_Simulation.<Main>b__0(Int32 i) in C:\branches\1.1\TestMemoryViolationCrash\Program.cs:line 32 at System.Threading.Tasks.Parallel.<>c__DisplayClassf`1.<ForWorker>b__c() at System.Threading.Tasks.Task.InnerInvokeWithArg(Task childTask) at System.Threading.Tasks.Task.<>c__DisplayClass10.<ExecuteSelfReplicating>b__f(Object param0) at System.Threading.Tasks.Task.Execute() at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx) at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot) at System.Threading.Tasks.Task.ExecuteEntry(Boolean bPreventDoubleExecution) at System.Threading.ThreadPoolWorkQueue.Dispatch()Unhandled Exception: System.AccessViolationException: Attempted to read or write protected memory. This is often an indication that other memory is corrupt. at Emgu.CV.CvInvoke.cvSmooth(IntPtr src, IntPtr dst, SMOOTH_TYPE type, Int32 param1, Int32 param2, Double param3, Double param4) at TestMemoryViolationCrash.AVE_Simulation.<Main>b__0(Int32 i) in C:\branches\1.1\TestMemoryViolationCrash\Program.cs:line 32 at System.Threading.Tasks.Parallel.<>c__DisplayClassf`1.<ForWorker>b__c() at System.Threading.Tasks.Task.InnerInvokeWithArg(Task childTask) at System.Threading.Tasks.Task.<>c__DisplayClass10.<ExecuteSelfReplicating>b__f(Object param0) at System.Threading.Tasks.Task.Execute() at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx) at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot) at System.Threading.Tasks.Task.ExecuteEntry(Boolean bPreventDoubleExecution) at System.Threading.ThreadPoolWorkQueue.Dispatch()Press any key to continue . . .",Access Violation Exception mystery
"What use (object sender, EventArgs e) parameters give"," In case of Page_Load, Init and other page events, what is the use of these (object sender, EventArgs e) parameters?Examples would be more helpful. <code> ","What is the use of ""object sender"" and ""EventArgs e"" parameters?"
"C# service - ServiceControlHandler used for device notifications, OnStop() not called"," I'd like to write a service that listens for device notifications (USB media plugged in, removed). The problem of listening for device notifications in a C# service is, that System.Windows.Forms.Control.WndProc isn't available because a windows service doesn't have any windows.I found this HowTo on how to write such a service. The author of that article found a workaround which lets the service listen for device notifications instead of service control messages and therefore, the service doesn't support OnStop() anymore.(Update 26.01.13:)Sadly, I don't really understand the service control manager and the windows API. I'm wondering if it is possible to register to both, service control messages AND usb device notifications or if this is really the only option for a service to listen to device notifications. I haven't yet found any (understandable for me) information which solves my problem.Might it be possible to use the System.Windows.Forms.Control.WndProc without generating windows (I'd just have to add the System.Windows.Forms assembly, right?).(Update 27.01.13:)I just found this question: Cannot start desktop application from Windows service on Windows 7The second answer there says, that Windows services received a security-centric makeover in Windows Vista and GUI elements are now created in Session 0 even if the ""Allow service to interact with desktop"" is checked. Does that mean, that I CAN create a Windows Form which then receives the USB device events (and therefore, I don't need to mess with the ServiceControlHandler? Are there any caveats or problems doing this?In short, I need a solution that does one of the following:Make OnStop available again, orprovide another method of listening for usb device notifications in a Windows C# serviceMy source code is currently the following. It is almost identical to the source code offered by the HowTo I linked in the first paragraph. The only difference I made is removing the FileSystemWatcher private field and all usages of the same because I don't need the FileSystemWatcher.USBBackup.cs (the service itself - using statements excluded but complete in my source code): Win32.cs: <code>  namespace USBBackup{ public partial class USBBackup : ServiceBase { private IntPtr deviceNotifyHandle; private IntPtr deviceEventHandle; private IntPtr directoryHandle; private Win32.ServiceControlHandlerEx myCallback; private int ServiceControlHandler(int control, int eventType, IntPtr eventData, IntPtr context) { if (control == Win32.SERVICE_CONTROL_STOP || control == Win32.SERVICE_CONTROL_SHUTDOWN) { UnregisterHandles(); Win32.UnregisterDeviceNotification(deviceEventHandle); base.Stop(); } else if (control == Win32.SERVICE_CONTROL_DEVICEEVENT) { switch (eventType) { case Win32.DBT_DEVICEARRIVAL: Win32.DEV_BROADCAST_HDR hdr; hdr = (Win32.DEV_BROADCAST_HDR)Marshal.PtrToStructure(eventData, typeof(Win32.DEV_BROADCAST_HDR)); if (hdr.dbcc_devicetype == Win32.DBT_DEVTYP_DEVICEINTERFACE) { Win32.DEV_BROADCAST_DEVICEINTERFACE deviceInterface; deviceInterface = (Win32.DEV_BROADCAST_DEVICEINTERFACE)Marshal.PtrToStructure(eventData, typeof(Win32.DEV_BROADCAST_DEVICEINTERFACE)); string name = new string(deviceInterface.dbcc_name); name = name.Substring(0, name.IndexOf('\0')) + ""\\""; StringBuilder stringBuilder = new StringBuilder(); Win32.GetVolumeNameForVolumeMountPoint(name, stringBuilder, 100); uint stringReturnLength = 0; string driveLetter = """"; Win32.GetVolumePathNamesForVolumeNameW(stringBuilder.ToString(), driveLetter, (uint)driveLetter.Length, ref stringReturnLength); if (stringReturnLength == 0) { // TODO handle error } driveLetter = new string(new char[stringReturnLength]); if (!Win32.GetVolumePathNamesForVolumeNameW(stringBuilder.ToString(), driveLetter, stringReturnLength, ref stringReturnLength)) { // TODO handle error } RegisterForHandle(driveLetter[0]); } break; case Win32.DBT_DEVICEQUERYREMOVE: UnregisterHandles(); break; } } return 0; } private void UnregisterHandles() { if (directoryHandle != IntPtr.Zero) { Win32.CloseHandle(directoryHandle); directoryHandle = IntPtr.Zero; } if (deviceNotifyHandle != IntPtr.Zero) { Win32.UnregisterDeviceNotification(deviceNotifyHandle); deviceNotifyHandle = IntPtr.Zero; } } private void RegisterForHandle(char c) { Win32.DEV_BROADCAST_HANDLE deviceHandle = new Win32.DEV_BROADCAST_HANDLE(); int size = Marshal.SizeOf(deviceHandle); deviceHandle.dbch_size = size; deviceHandle.dbch_devicetype = Win32.DBT_DEVTYP_HANDLE; directoryHandle = CreateFileHandle(c + "":\\""); deviceHandle.dbch_handle = directoryHandle; IntPtr buffer = Marshal.AllocHGlobal(size); Marshal.StructureToPtr(deviceHandle, buffer, true); deviceNotifyHandle = Win32.RegisterDeviceNotification(this.ServiceHandle, buffer, Win32.DEVICE_NOTIFY_SERVICE_HANDLE); if (deviceNotifyHandle == IntPtr.Zero) { // TODO handle error } } private void RegisterDeviceNotification() { myCallback = new Win32.ServiceControlHandlerEx(ServiceControlHandler); Win32.RegisterServiceCtrlHandlerEx(this.ServiceName, myCallback, IntPtr.Zero); if (this.ServiceHandle == IntPtr.Zero) { // TODO handle error } Win32.DEV_BROADCAST_DEVICEINTERFACE deviceInterface = new Win32.DEV_BROADCAST_DEVICEINTERFACE(); int size = Marshal.SizeOf(deviceInterface); deviceInterface.dbcc_size = size; deviceInterface.dbcc_devicetype = Win32.DBT_DEVTYP_DEVICEINTERFACE; IntPtr buffer = default(IntPtr); buffer = Marshal.AllocHGlobal(size); Marshal.StructureToPtr(deviceInterface, buffer, true); deviceEventHandle = Win32.RegisterDeviceNotification(this.ServiceHandle, buffer, Win32.DEVICE_NOTIFY_SERVICE_HANDLE | Win32.DEVICE_NOTIFY_ALL_INTERFACE_CLASSES); if (deviceEventHandle == IntPtr.Zero) { // TODO handle error } } public USBBackup() { InitializeComponent(); } public static IntPtr CreateFileHandle(string driveLetter) { // open the existing file for reading IntPtr handle = Win32.CreateFile( driveLetter, Win32.GENERIC_READ, Win32.FILE_SHARE_READ | Win32.FILE_SHARE_WRITE, 0, Win32.OPEN_EXISTING, Win32.FILE_FLAG_BACKUP_SEMANTICS | Win32.FILE_ATTRIBUTE_NORMAL, 0); if (handle == Win32.INVALID_HANDLE_VALUE) { return IntPtr.Zero; } else { return handle; } } protected override void OnStart(string[] args) { base.OnStart(args); RegisterDeviceNotification(); } }} namespace USBBackup{ public class Win32 { public const int DEVICE_NOTIFY_SERVICE_HANDLE = 1; public const int DEVICE_NOTIFY_ALL_INTERFACE_CLASSES = 4; public const int SERVICE_CONTROL_STOP = 1; public const int SERVICE_CONTROL_DEVICEEVENT = 11; public const int SERVICE_CONTROL_SHUTDOWN = 5; public const uint GENERIC_READ = 0x80000000; public const uint OPEN_EXISTING = 3; public const uint FILE_SHARE_READ = 1; public const uint FILE_SHARE_WRITE = 2; public const uint FILE_SHARE_DELETE = 4; public const uint FILE_ATTRIBUTE_NORMAL = 128; public const uint FILE_FLAG_BACKUP_SEMANTICS = 0x02000000; public static readonly IntPtr INVALID_HANDLE_VALUE = new IntPtr(-1); public const int DBT_DEVTYP_DEVICEINTERFACE = 5; public const int DBT_DEVTYP_HANDLE = 6; public const int DBT_DEVICEARRIVAL = 0x8000; public const int DBT_DEVICEQUERYREMOVE = 0x8001; public const int DBT_DEVICEREMOVECOMPLETE = 0x8004; public const int WM_DEVICECHANGE = 0x219; public delegate int ServiceControlHandlerEx(int control, int eventType, IntPtr eventData, IntPtr context); [DllImport(""advapi32.dll"", SetLastError = true)] public static extern IntPtr RegisterServiceCtrlHandlerEx(string lpServiceName, ServiceControlHandlerEx cbex, IntPtr context); [DllImport(""kernel32.dll"", SetLastError = true)] [return: MarshalAs(UnmanagedType.Bool)] public static extern bool GetVolumePathNamesForVolumeNameW( [MarshalAs(UnmanagedType.LPWStr)] string lpszVolumeName, [MarshalAs(UnmanagedType.LPWStr)] string lpszVolumePathNames, uint cchBuferLength, ref UInt32 lpcchReturnLength); [DllImport(""kernel32.dll"")] public static extern bool GetVolumeNameForVolumeMountPoint(string lpszVolumeMountPoint, [Out] StringBuilder lpszVolumeName, uint cchBufferLength); [DllImport(""user32.dll"", SetLastError = true)] public static extern IntPtr RegisterDeviceNotification(IntPtr IntPtr, IntPtr NotificationFilter, Int32 Flags); [DllImport(""user32.dll"", CharSet = CharSet.Auto)] public static extern uint UnregisterDeviceNotification(IntPtr hHandle); [DllImport(""kernel32.dll"", SetLastError = true)] public static extern IntPtr CreateFile( string FileName, // file name uint DesiredAccess, // access mode uint ShareMode, // share mode uint SecurityAttributes, // Security Attributes uint CreationDisposition, // how to create uint FlagsAndAttributes, // file attributes int hTemplateFile // handle to template file ); [DllImport(""kernel32.dll"", SetLastError = true)] public static extern bool CloseHandle(IntPtr hObject); [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)] public struct DEV_BROADCAST_DEVICEINTERFACE { public int dbcc_size; public int dbcc_devicetype; public int dbcc_reserved; [MarshalAs(UnmanagedType.ByValArray, ArraySubType = UnmanagedType.U1, SizeConst = 16)] public byte[] dbcc_classguid; [MarshalAs(UnmanagedType.ByValArray, SizeConst = 128)] public char[] dbcc_name; } [StructLayout(LayoutKind.Sequential)] public struct DEV_BROADCAST_HDR { public int dbcc_size; public int dbcc_devicetype; public int dbcc_reserved; } [StructLayout(LayoutKind.Sequential)] public struct DEV_BROADCAST_HANDLE { public int dbch_size; public int dbch_devicetype; public int dbch_reserved; public IntPtr dbch_handle; public IntPtr dbch_hdevnotify; public Guid dbch_eventguid; public long dbch_nameoffset; public byte dbch_data; public byte dbch_data1; } }}","ServiceControlHandler used for usb device notifications, OnStop() not implementable"
"ServiceControlHandler used for device notifications, OnStop() not called"," I'd like to write a service that listens for device notifications (USB media plugged in, removed). The problem of listening for device notifications in a C# service is, that System.Windows.Forms.Control.WndProc isn't available because a windows service doesn't have any windows.I found this HowTo on how to write such a service. The author of that article found a workaround which lets the service listen for device notifications instead of service control messages and therefore, the service doesn't support OnStop() anymore.(Update 26.01.13:)Sadly, I don't really understand the service control manager and the windows API. I'm wondering if it is possible to register to both, service control messages AND usb device notifications or if this is really the only option for a service to listen to device notifications. I haven't yet found any (understandable for me) information which solves my problem.Might it be possible to use the System.Windows.Forms.Control.WndProc without generating windows (I'd just have to add the System.Windows.Forms assembly, right?).(Update 27.01.13:)I just found this question: Cannot start desktop application from Windows service on Windows 7The second answer there says, that Windows services received a security-centric makeover in Windows Vista and GUI elements are now created in Session 0 even if the ""Allow service to interact with desktop"" is checked. Does that mean, that I CAN create a Windows Form which then receives the USB device events (and therefore, I don't need to mess with the ServiceControlHandler? Are there any caveats or problems doing this?In short, I need a solution that does one of the following:Make OnStop available again, orprovide another method of listening for usb device notifications in a Windows C# serviceMy source code is currently the following. It is almost identical to the source code offered by the HowTo I linked in the first paragraph. The only difference I made is removing the FileSystemWatcher private field and all usages of the same because I don't need the FileSystemWatcher.USBBackup.cs (the service itself - using statements excluded but complete in my source code): Win32.cs: <code>  namespace USBBackup{ public partial class USBBackup : ServiceBase { private IntPtr deviceNotifyHandle; private IntPtr deviceEventHandle; private IntPtr directoryHandle; private Win32.ServiceControlHandlerEx myCallback; private int ServiceControlHandler(int control, int eventType, IntPtr eventData, IntPtr context) { if (control == Win32.SERVICE_CONTROL_STOP || control == Win32.SERVICE_CONTROL_SHUTDOWN) { UnregisterHandles(); Win32.UnregisterDeviceNotification(deviceEventHandle); base.Stop(); } else if (control == Win32.SERVICE_CONTROL_DEVICEEVENT) { switch (eventType) { case Win32.DBT_DEVICEARRIVAL: Win32.DEV_BROADCAST_HDR hdr; hdr = (Win32.DEV_BROADCAST_HDR)Marshal.PtrToStructure(eventData, typeof(Win32.DEV_BROADCAST_HDR)); if (hdr.dbcc_devicetype == Win32.DBT_DEVTYP_DEVICEINTERFACE) { Win32.DEV_BROADCAST_DEVICEINTERFACE deviceInterface; deviceInterface = (Win32.DEV_BROADCAST_DEVICEINTERFACE)Marshal.PtrToStructure(eventData, typeof(Win32.DEV_BROADCAST_DEVICEINTERFACE)); string name = new string(deviceInterface.dbcc_name); name = name.Substring(0, name.IndexOf('\0')) + ""\\""; StringBuilder stringBuilder = new StringBuilder(); Win32.GetVolumeNameForVolumeMountPoint(name, stringBuilder, 100); uint stringReturnLength = 0; string driveLetter = """"; Win32.GetVolumePathNamesForVolumeNameW(stringBuilder.ToString(), driveLetter, (uint)driveLetter.Length, ref stringReturnLength); if (stringReturnLength == 0) { // TODO handle error } driveLetter = new string(new char[stringReturnLength]); if (!Win32.GetVolumePathNamesForVolumeNameW(stringBuilder.ToString(), driveLetter, stringReturnLength, ref stringReturnLength)) { // TODO handle error } RegisterForHandle(driveLetter[0]); } break; case Win32.DBT_DEVICEQUERYREMOVE: UnregisterHandles(); break; } } return 0; } private void UnregisterHandles() { if (directoryHandle != IntPtr.Zero) { Win32.CloseHandle(directoryHandle); directoryHandle = IntPtr.Zero; } if (deviceNotifyHandle != IntPtr.Zero) { Win32.UnregisterDeviceNotification(deviceNotifyHandle); deviceNotifyHandle = IntPtr.Zero; } } private void RegisterForHandle(char c) { Win32.DEV_BROADCAST_HANDLE deviceHandle = new Win32.DEV_BROADCAST_HANDLE(); int size = Marshal.SizeOf(deviceHandle); deviceHandle.dbch_size = size; deviceHandle.dbch_devicetype = Win32.DBT_DEVTYP_HANDLE; directoryHandle = CreateFileHandle(c + "":\\""); deviceHandle.dbch_handle = directoryHandle; IntPtr buffer = Marshal.AllocHGlobal(size); Marshal.StructureToPtr(deviceHandle, buffer, true); deviceNotifyHandle = Win32.RegisterDeviceNotification(this.ServiceHandle, buffer, Win32.DEVICE_NOTIFY_SERVICE_HANDLE); if (deviceNotifyHandle == IntPtr.Zero) { // TODO handle error } } private void RegisterDeviceNotification() { myCallback = new Win32.ServiceControlHandlerEx(ServiceControlHandler); Win32.RegisterServiceCtrlHandlerEx(this.ServiceName, myCallback, IntPtr.Zero); if (this.ServiceHandle == IntPtr.Zero) { // TODO handle error } Win32.DEV_BROADCAST_DEVICEINTERFACE deviceInterface = new Win32.DEV_BROADCAST_DEVICEINTERFACE(); int size = Marshal.SizeOf(deviceInterface); deviceInterface.dbcc_size = size; deviceInterface.dbcc_devicetype = Win32.DBT_DEVTYP_DEVICEINTERFACE; IntPtr buffer = default(IntPtr); buffer = Marshal.AllocHGlobal(size); Marshal.StructureToPtr(deviceInterface, buffer, true); deviceEventHandle = Win32.RegisterDeviceNotification(this.ServiceHandle, buffer, Win32.DEVICE_NOTIFY_SERVICE_HANDLE | Win32.DEVICE_NOTIFY_ALL_INTERFACE_CLASSES); if (deviceEventHandle == IntPtr.Zero) { // TODO handle error } } public USBBackup() { InitializeComponent(); } public static IntPtr CreateFileHandle(string driveLetter) { // open the existing file for reading IntPtr handle = Win32.CreateFile( driveLetter, Win32.GENERIC_READ, Win32.FILE_SHARE_READ | Win32.FILE_SHARE_WRITE, 0, Win32.OPEN_EXISTING, Win32.FILE_FLAG_BACKUP_SEMANTICS | Win32.FILE_ATTRIBUTE_NORMAL, 0); if (handle == Win32.INVALID_HANDLE_VALUE) { return IntPtr.Zero; } else { return handle; } } protected override void OnStart(string[] args) { base.OnStart(args); RegisterDeviceNotification(); } }} namespace USBBackup{ public class Win32 { public const int DEVICE_NOTIFY_SERVICE_HANDLE = 1; public const int DEVICE_NOTIFY_ALL_INTERFACE_CLASSES = 4; public const int SERVICE_CONTROL_STOP = 1; public const int SERVICE_CONTROL_DEVICEEVENT = 11; public const int SERVICE_CONTROL_SHUTDOWN = 5; public const uint GENERIC_READ = 0x80000000; public const uint OPEN_EXISTING = 3; public const uint FILE_SHARE_READ = 1; public const uint FILE_SHARE_WRITE = 2; public const uint FILE_SHARE_DELETE = 4; public const uint FILE_ATTRIBUTE_NORMAL = 128; public const uint FILE_FLAG_BACKUP_SEMANTICS = 0x02000000; public static readonly IntPtr INVALID_HANDLE_VALUE = new IntPtr(-1); public const int DBT_DEVTYP_DEVICEINTERFACE = 5; public const int DBT_DEVTYP_HANDLE = 6; public const int DBT_DEVICEARRIVAL = 0x8000; public const int DBT_DEVICEQUERYREMOVE = 0x8001; public const int DBT_DEVICEREMOVECOMPLETE = 0x8004; public const int WM_DEVICECHANGE = 0x219; public delegate int ServiceControlHandlerEx(int control, int eventType, IntPtr eventData, IntPtr context); [DllImport(""advapi32.dll"", SetLastError = true)] public static extern IntPtr RegisterServiceCtrlHandlerEx(string lpServiceName, ServiceControlHandlerEx cbex, IntPtr context); [DllImport(""kernel32.dll"", SetLastError = true)] [return: MarshalAs(UnmanagedType.Bool)] public static extern bool GetVolumePathNamesForVolumeNameW( [MarshalAs(UnmanagedType.LPWStr)] string lpszVolumeName, [MarshalAs(UnmanagedType.LPWStr)] string lpszVolumePathNames, uint cchBuferLength, ref UInt32 lpcchReturnLength); [DllImport(""kernel32.dll"")] public static extern bool GetVolumeNameForVolumeMountPoint(string lpszVolumeMountPoint, [Out] StringBuilder lpszVolumeName, uint cchBufferLength); [DllImport(""user32.dll"", SetLastError = true)] public static extern IntPtr RegisterDeviceNotification(IntPtr IntPtr, IntPtr NotificationFilter, Int32 Flags); [DllImport(""user32.dll"", CharSet = CharSet.Auto)] public static extern uint UnregisterDeviceNotification(IntPtr hHandle); [DllImport(""kernel32.dll"", SetLastError = true)] public static extern IntPtr CreateFile( string FileName, // file name uint DesiredAccess, // access mode uint ShareMode, // share mode uint SecurityAttributes, // Security Attributes uint CreationDisposition, // how to create uint FlagsAndAttributes, // file attributes int hTemplateFile // handle to template file ); [DllImport(""kernel32.dll"", SetLastError = true)] public static extern bool CloseHandle(IntPtr hObject); [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)] public struct DEV_BROADCAST_DEVICEINTERFACE { public int dbcc_size; public int dbcc_devicetype; public int dbcc_reserved; [MarshalAs(UnmanagedType.ByValArray, ArraySubType = UnmanagedType.U1, SizeConst = 16)] public byte[] dbcc_classguid; [MarshalAs(UnmanagedType.ByValArray, SizeConst = 128)] public char[] dbcc_name; } [StructLayout(LayoutKind.Sequential)] public struct DEV_BROADCAST_HDR { public int dbcc_size; public int dbcc_devicetype; public int dbcc_reserved; } [StructLayout(LayoutKind.Sequential)] public struct DEV_BROADCAST_HANDLE { public int dbch_size; public int dbch_devicetype; public int dbch_reserved; public IntPtr dbch_handle; public IntPtr dbch_hdevnotify; public Guid dbch_eventguid; public long dbch_nameoffset; public byte dbch_data; public byte dbch_data1; } }}","ServiceControlHandler used for usb device notifications, OnStop() not implementable"
"ServiceControlHandler used for usb device notifications, OnStop() not called"," I'd like to write a service that listens for device notifications (USB media plugged in, removed). The problem of listening for device notifications in a C# service is, that System.Windows.Forms.Control.WndProc isn't available because a windows service doesn't have any windows.I found this HowTo on how to write such a service. The author of that article found a workaround which lets the service listen for device notifications instead of service control messages and therefore, the service doesn't support OnStop() anymore.(Update 26.01.13:)Sadly, I don't really understand the service control manager and the windows API. I'm wondering if it is possible to register to both, service control messages AND usb device notifications or if this is really the only option for a service to listen to device notifications. I haven't yet found any (understandable for me) information which solves my problem.Might it be possible to use the System.Windows.Forms.Control.WndProc without generating windows (I'd just have to add the System.Windows.Forms assembly, right?).(Update 27.01.13:)I just found this question: Cannot start desktop application from Windows service on Windows 7The second answer there says, that Windows services received a security-centric makeover in Windows Vista and GUI elements are now created in Session 0 even if the ""Allow service to interact with desktop"" is checked. Does that mean, that I CAN create a Windows Form which then receives the USB device events (and therefore, I don't need to mess with the ServiceControlHandler? Are there any caveats or problems doing this?In short, I need a solution that does one of the following:Make OnStop available again, orprovide another method of listening for usb device notifications in a Windows C# serviceMy source code is currently the following. It is almost identical to the source code offered by the HowTo I linked in the first paragraph. The only difference I made is removing the FileSystemWatcher private field and all usages of the same because I don't need the FileSystemWatcher.USBBackup.cs (the service itself - using statements excluded but complete in my source code): Win32.cs: <code>  namespace USBBackup{ public partial class USBBackup : ServiceBase { private IntPtr deviceNotifyHandle; private IntPtr deviceEventHandle; private IntPtr directoryHandle; private Win32.ServiceControlHandlerEx myCallback; private int ServiceControlHandler(int control, int eventType, IntPtr eventData, IntPtr context) { if (control == Win32.SERVICE_CONTROL_STOP || control == Win32.SERVICE_CONTROL_SHUTDOWN) { UnregisterHandles(); Win32.UnregisterDeviceNotification(deviceEventHandle); base.Stop(); } else if (control == Win32.SERVICE_CONTROL_DEVICEEVENT) { switch (eventType) { case Win32.DBT_DEVICEARRIVAL: Win32.DEV_BROADCAST_HDR hdr; hdr = (Win32.DEV_BROADCAST_HDR)Marshal.PtrToStructure(eventData, typeof(Win32.DEV_BROADCAST_HDR)); if (hdr.dbcc_devicetype == Win32.DBT_DEVTYP_DEVICEINTERFACE) { Win32.DEV_BROADCAST_DEVICEINTERFACE deviceInterface; deviceInterface = (Win32.DEV_BROADCAST_DEVICEINTERFACE)Marshal.PtrToStructure(eventData, typeof(Win32.DEV_BROADCAST_DEVICEINTERFACE)); string name = new string(deviceInterface.dbcc_name); name = name.Substring(0, name.IndexOf('\0')) + ""\\""; StringBuilder stringBuilder = new StringBuilder(); Win32.GetVolumeNameForVolumeMountPoint(name, stringBuilder, 100); uint stringReturnLength = 0; string driveLetter = """"; Win32.GetVolumePathNamesForVolumeNameW(stringBuilder.ToString(), driveLetter, (uint)driveLetter.Length, ref stringReturnLength); if (stringReturnLength == 0) { // TODO handle error } driveLetter = new string(new char[stringReturnLength]); if (!Win32.GetVolumePathNamesForVolumeNameW(stringBuilder.ToString(), driveLetter, stringReturnLength, ref stringReturnLength)) { // TODO handle error } RegisterForHandle(driveLetter[0]); } break; case Win32.DBT_DEVICEQUERYREMOVE: UnregisterHandles(); break; } } return 0; } private void UnregisterHandles() { if (directoryHandle != IntPtr.Zero) { Win32.CloseHandle(directoryHandle); directoryHandle = IntPtr.Zero; } if (deviceNotifyHandle != IntPtr.Zero) { Win32.UnregisterDeviceNotification(deviceNotifyHandle); deviceNotifyHandle = IntPtr.Zero; } } private void RegisterForHandle(char c) { Win32.DEV_BROADCAST_HANDLE deviceHandle = new Win32.DEV_BROADCAST_HANDLE(); int size = Marshal.SizeOf(deviceHandle); deviceHandle.dbch_size = size; deviceHandle.dbch_devicetype = Win32.DBT_DEVTYP_HANDLE; directoryHandle = CreateFileHandle(c + "":\\""); deviceHandle.dbch_handle = directoryHandle; IntPtr buffer = Marshal.AllocHGlobal(size); Marshal.StructureToPtr(deviceHandle, buffer, true); deviceNotifyHandle = Win32.RegisterDeviceNotification(this.ServiceHandle, buffer, Win32.DEVICE_NOTIFY_SERVICE_HANDLE); if (deviceNotifyHandle == IntPtr.Zero) { // TODO handle error } } private void RegisterDeviceNotification() { myCallback = new Win32.ServiceControlHandlerEx(ServiceControlHandler); Win32.RegisterServiceCtrlHandlerEx(this.ServiceName, myCallback, IntPtr.Zero); if (this.ServiceHandle == IntPtr.Zero) { // TODO handle error } Win32.DEV_BROADCAST_DEVICEINTERFACE deviceInterface = new Win32.DEV_BROADCAST_DEVICEINTERFACE(); int size = Marshal.SizeOf(deviceInterface); deviceInterface.dbcc_size = size; deviceInterface.dbcc_devicetype = Win32.DBT_DEVTYP_DEVICEINTERFACE; IntPtr buffer = default(IntPtr); buffer = Marshal.AllocHGlobal(size); Marshal.StructureToPtr(deviceInterface, buffer, true); deviceEventHandle = Win32.RegisterDeviceNotification(this.ServiceHandle, buffer, Win32.DEVICE_NOTIFY_SERVICE_HANDLE | Win32.DEVICE_NOTIFY_ALL_INTERFACE_CLASSES); if (deviceEventHandle == IntPtr.Zero) { // TODO handle error } } public USBBackup() { InitializeComponent(); } public static IntPtr CreateFileHandle(string driveLetter) { // open the existing file for reading IntPtr handle = Win32.CreateFile( driveLetter, Win32.GENERIC_READ, Win32.FILE_SHARE_READ | Win32.FILE_SHARE_WRITE, 0, Win32.OPEN_EXISTING, Win32.FILE_FLAG_BACKUP_SEMANTICS | Win32.FILE_ATTRIBUTE_NORMAL, 0); if (handle == Win32.INVALID_HANDLE_VALUE) { return IntPtr.Zero; } else { return handle; } } protected override void OnStart(string[] args) { base.OnStart(args); RegisterDeviceNotification(); } }} namespace USBBackup{ public class Win32 { public const int DEVICE_NOTIFY_SERVICE_HANDLE = 1; public const int DEVICE_NOTIFY_ALL_INTERFACE_CLASSES = 4; public const int SERVICE_CONTROL_STOP = 1; public const int SERVICE_CONTROL_DEVICEEVENT = 11; public const int SERVICE_CONTROL_SHUTDOWN = 5; public const uint GENERIC_READ = 0x80000000; public const uint OPEN_EXISTING = 3; public const uint FILE_SHARE_READ = 1; public const uint FILE_SHARE_WRITE = 2; public const uint FILE_SHARE_DELETE = 4; public const uint FILE_ATTRIBUTE_NORMAL = 128; public const uint FILE_FLAG_BACKUP_SEMANTICS = 0x02000000; public static readonly IntPtr INVALID_HANDLE_VALUE = new IntPtr(-1); public const int DBT_DEVTYP_DEVICEINTERFACE = 5; public const int DBT_DEVTYP_HANDLE = 6; public const int DBT_DEVICEARRIVAL = 0x8000; public const int DBT_DEVICEQUERYREMOVE = 0x8001; public const int DBT_DEVICEREMOVECOMPLETE = 0x8004; public const int WM_DEVICECHANGE = 0x219; public delegate int ServiceControlHandlerEx(int control, int eventType, IntPtr eventData, IntPtr context); [DllImport(""advapi32.dll"", SetLastError = true)] public static extern IntPtr RegisterServiceCtrlHandlerEx(string lpServiceName, ServiceControlHandlerEx cbex, IntPtr context); [DllImport(""kernel32.dll"", SetLastError = true)] [return: MarshalAs(UnmanagedType.Bool)] public static extern bool GetVolumePathNamesForVolumeNameW( [MarshalAs(UnmanagedType.LPWStr)] string lpszVolumeName, [MarshalAs(UnmanagedType.LPWStr)] string lpszVolumePathNames, uint cchBuferLength, ref UInt32 lpcchReturnLength); [DllImport(""kernel32.dll"")] public static extern bool GetVolumeNameForVolumeMountPoint(string lpszVolumeMountPoint, [Out] StringBuilder lpszVolumeName, uint cchBufferLength); [DllImport(""user32.dll"", SetLastError = true)] public static extern IntPtr RegisterDeviceNotification(IntPtr IntPtr, IntPtr NotificationFilter, Int32 Flags); [DllImport(""user32.dll"", CharSet = CharSet.Auto)] public static extern uint UnregisterDeviceNotification(IntPtr hHandle); [DllImport(""kernel32.dll"", SetLastError = true)] public static extern IntPtr CreateFile( string FileName, // file name uint DesiredAccess, // access mode uint ShareMode, // share mode uint SecurityAttributes, // Security Attributes uint CreationDisposition, // how to create uint FlagsAndAttributes, // file attributes int hTemplateFile // handle to template file ); [DllImport(""kernel32.dll"", SetLastError = true)] public static extern bool CloseHandle(IntPtr hObject); [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)] public struct DEV_BROADCAST_DEVICEINTERFACE { public int dbcc_size; public int dbcc_devicetype; public int dbcc_reserved; [MarshalAs(UnmanagedType.ByValArray, ArraySubType = UnmanagedType.U1, SizeConst = 16)] public byte[] dbcc_classguid; [MarshalAs(UnmanagedType.ByValArray, SizeConst = 128)] public char[] dbcc_name; } [StructLayout(LayoutKind.Sequential)] public struct DEV_BROADCAST_HDR { public int dbcc_size; public int dbcc_devicetype; public int dbcc_reserved; } [StructLayout(LayoutKind.Sequential)] public struct DEV_BROADCAST_HANDLE { public int dbch_size; public int dbch_devicetype; public int dbch_reserved; public IntPtr dbch_handle; public IntPtr dbch_hdevnotify; public Guid dbch_eventguid; public long dbch_nameoffset; public byte dbch_data; public byte dbch_data1; } }}","ServiceControlHandler used for usb device notifications, OnStop() not implementable"
Mocking a funcion that takes a delegate in RhinoMocks," I have the following classes: I want to test MainClass only. I a using RhinoMocks to mock HelperClass in my tests.The problem is, while I am not interested in testing the HandleFunction() method I am interested in checking Action1, Action2 and other actions that were sent to HandleFunction() when called..How can I mock the HandleFunction() method and while avoiding it's inner logic, invoke the code that was sent to it as a parameter? <code>  public class HelperClass { HandleFunction<T>(Func<T> func) { // Custom logic here func.Invoke(); // Custom logic here }// The class i want to test public class MainClass{ public readonly HelperClass _helper; // Ctor MainClass(HelperClass helper) { _helper = helper; } public void Foo() { // Use the handle method _helper.HandleFunction(() => { // Foo logic here: Action1(); Action2(); //etc.. } }}",Mocking a method that takes a delegate in RhinoMocks
Constructor injection with quartz.net and simple injector, Currently I am writing a service using Quartz.NET to schedule the running of it.I was wondering if anyone has any experience of using constructor injection with Quartz.NET and Simple Injector.Below is essentially what I wish to achieve <code>  public class JobImplementation: IJob{ private readonly IInjectedClass injectedClass; public JobImplementation(IInjectedClass _injectedClass) { injectedClass = _injectedClass } public void Execute(IJobExecutionContext _context) { //Job code },Constructor injection with Quartz.NET and Simple Injector
C# Strings: Verbatim string literals v escape sequences," Is there any difference in how the C# compiler or .NET run-time handles verbatim string literals versus using escape sequences (i.e. performance) or is it just a matter of design time style? E.G.: I would imagine they are compiled the same and it doesn't matter, but was just curious. <code>  var pathA = ""c:\\somewhere"";var pathB = @""c:\somewhere"";",Verbatim string literals v escape sequences
c# check if string is a valid AD group," Using the following code I can easily see if the supplied user exists in a supplied group. However, given a list of strings like the following:- Is there any way in c# by looping this list of strings, to check to see if each entry is an AD group or not ?For example, User3 is actually a group name, but from looking at the list you would think it's a normal AD user.Is there any way of parsing the name to see if it exists as a group on my AD domain.I basically want to be able to run through a list of names and groups, and see if a given user name (for example 'Bob') is in the list, or exists in one of the groups in this list, therefore if an entry in the list above is an AD group I want to run a function similar to above to see if the user exists within the group or not. <code>  public static bool IsInGroup(string user, string group){ using (var identity = new WindowsIdentity(user)) { var principal = new WindowsPrincipal(identity); return principal.IsInRole(group); }} User1User2User3Group1Group2Group3",check if string is a valid AD group
check if decimal value is null c#," I would like to check if the decimal number is NULL or it has some value, since the value is assigned from database in class object: and then I have I am trying: But I am getting this: the result of the expression is always 'true' since a value of type 'decimal' is never equal to nullHow can I check if that decimal number has some value? <code>  public decimal myDecimal{ get; set; } myDecimal = Convert.ToDecimal(rdrSelect[23].ToString()); if (rdrSelect[23] != DBNull.Value) { myDecimal = Convert.ToDecimal(rdrSelect[23].ToString()); }",Check if decimal value is null
How to throw Asp.net Web API exception," How can I throw a exception to in ASP.net Web Api?Below is my code: I don't think I am doing the right thing, How do my client know it is a HTTP 404 error? <code>  public Test GetTestId(string id){ Test test = _test.GetTest(id); if (test == null) { throw new HttpResponseException(HttpStatusCode.NotFound); } return test;}",How to throw exception in Web API?
"C# Web password erroring out when ""&"" is in the password"," I have an ASP.NET MVC3 C# .NET Application running on IIS 7.5. We have a Windows NT service account we Impersonate in our code in order to read/write documents to a file share. The user id is compiled in the code and the service account password is stored in the web.config file. The password contains an ampersand character (i.e.: p&ssword). This broke the site. When accessing the site we received this error :""Sorry, an error occurred while processing your request"". Here is the code that uses the password: Why would this cause the site to break? <code>  var password = ConfigurationManager.AppSettings.Get(Common.SVC_PWD); bool isSuccess = LogonUser( @""my_svc_acct"", ""my.domain.net"", password, LOGON32_LOGON_NEW_CREDENTIALS, LOGON32_PROVIDER_DEFAULT, ref token );","The ""&"" character breaks passwords that are stored in the web.config"
"The client and server cannot communicate, because they do not possess a common algorithm"," A bit of background I am developing a webpage that connects to a web service using SOAP. I get this error when I am call a method on the web service:The request was aborted: Could not create SSL/TLS secure channel.There fore i Added the line of code. I have there cert stored on my server as trust as well as they have my cert stored and white listed to let through. When I try to authenticate i get the follow message. I have set up the Trace and here is what the trace file looks like. I have hit a point where i am not sure where to go from here. Any help would be greatly appreciated. <code>  ServicePointManager.Expect100Continue = true;ServicePointManager.SecurityProtocol = SecurityProtocolType.Ssl3; System.Net.WebException: The underlying connection was closed: An unexpected error occurred on a receive. ---> System.ComponentModel.Win32Exception: The client and server cannot communicate, because they do not possess a common algorithm [Public Key] Algorithm: RSA Length: 2048 Key Blob: 30 82 01 0a 02 82 01 01 00 ce 08 11 55 52 0c 94 64 dc fe 1b e6 37 2e 1c 7a f1 3c 5d 24 67 d7 8e 76 58 78 64 30 d8 7d a3 e7 f2 0a c1 6b 33 91 7f 21 e6 a3 46 32 91 95 05 c6 46 05 43 ac 84 79 32 d5 ab 0f 0b 38 d1 9f 18 ab c3 82 dd 9d 98 ab 00 17 17 60 c0 c6 df 98 32 66 22 39 7b f5 fb e2 ed e2 a5 20 a7 48 0e 1b c6 43 2c 5b 81 85 69 2b 02 1e 40 77 9c 90 ea 25 81 f1 49 4d ed dd .... ProcessId=3704 DateTime=2013-01-30T20:51:25.2747506ZSystem.Net Information: 0 : [6072] SecureChannel#42430754 - Certificate is of type X509Certificate2 and contains the private key. ProcessId=3704 DateTime=2013-01-30T20:51:25.2747506ZSystem.Net Information: 0 : [6072] AcquireCredentialsHandle(package = Microsoft Unified Security Protocol Provider, intent = Outbound, scc = System.Net.SecureCredential) ProcessId=3704 DateTime=2013-01-30T20:51:25.2747506ZSystem.Net Error: 0 : [6072] AcquireCredentialsHandle() failed with error 0X80090331. ProcessId=3704 DateTime=2013-01-30T20:51:25.2747506ZSystem.Net Information: 0 : [6072] AcquireCredentialsHandle(package = Microsoft Unified Security Protocol Provider, intent = Outbound, scc = System.Net.SecureCredential) ProcessId=3704 DateTime=2013-01-30T20:51:25.2747506ZSystem.Net Error: 0 : [6072] AcquireCredentialsHandle() failed with error 0X80090331. ProcessId=3704 DateTime=2013-01-30T20:51:25.2747506ZSystem.Net.Sockets Verbose: 0 : [6072] Socket#14502061::Dispose() ProcessId=3704 DateTime=2013-01-30T20:51:25.2747506ZSystem.Net Error: 0 : [6072] Exception in the HttpWebRequest#11181865:: - The underlying connection was closed: An unexpected error occurred on a receive. ProcessId=3704 DateTime=2013-01-30T20:51:25.2747506ZSystem.Net Error: 0 : [6072] Exception in the HttpWebRequest#11181865::GetResponse - The underlying connection was closed: An unexpected error occurred on a receive. ProcessId=3704 DateTime=2013-01-30T20:51:25.2747506ZSystem.Net Information: 0 : [6072] Enumerating security packages: ProcessId=3704 DateTime=2013-01-30T20:51:25.6335529ZSystem.Net Information: 0 : [6072] Negotiate ProcessId=3704 DateTime=2013-01-30T20:51:25.6335529ZSystem.Net Information: 0 : [6072] NegoExtender ProcessId=3704 DateTime=2013-01-30T20:51:25.6335529ZSystem.Net Information: 0 : [6072] Kerberos ProcessId=3704 DateTime=2013-01-30T20:51:25.6491530ZSystem.Net Information: 0 : [6072] NTLM ProcessId=3704 DateTime=2013-01-30T20:51:25.6491530ZSystem.Net Information: 0 : [6072] Schannel ProcessId=3704 DateTime=2013-01-30T20:51:25.6491530ZSystem.Net Information: 0 : [6072] Microsoft Unified Security Protocol Provider ProcessId=3704 DateTime=2013-01-30T20:51:25.6491530ZSystem.Net Information: 0 : [6072] WDigest ProcessId=3704 DateTime=2013-01-30T20:51:25.6491530ZSystem.Net Information: 0 : [6072] TSSSP ProcessId=3704 DateTime=2013-01-30T20:51:25.6491530ZSystem.Net Information: 0 : [6072] pku2u ProcessId=3704 DateTime=2013-01-30T20:51:25.6491530ZSystem.Net Information: 0 : [6072] CREDSSP ProcessId=3704 DateTime=2013-01-30T20:51:25.6491530ZSystem.Net Information: 0 : [6072] AcquireDefaultCredential(package = Negotiate, intent = Outbound) ProcessId=3704 DateTime=2013-01-30T20:51:25.6491530ZSystem.Net Information: 0 : [6072] InitializeSecurityContext(credential = System.Net.SafeFreeCredential_SECURITY, context = (null), targetName = host/localhost, inFlags = MutualAuth, Confidentiality, Connection, AcceptIntegrity) ProcessId=3704 DateTime=2013-01-30T20:51:25.6491530ZSystem.Net Information: 0 : [6072] InitializeSecurityContext(In-Buffers count=0, Out-Buffer length=125, returned code=ContinueNeeded). ProcessId=3704 DateTime=2013-01-30T20:51:25.6491530ZSystem.Net Information: 0 : [6072] InitializeSecurityContext(credential = System.Net.SafeFreeCredential_SECURITY, context = 23570c30:235e9b58, targetName = host/localhost, inFlags = MutualAuth, Confidentiality, Connection, AcceptIntegrity) ProcessId=3704 DateTime=2013-01-30T20:51:25.6491530ZSystem.Net Information: 0 : [6072] InitializeSecurityContext(In-Buffers count=1, Out-Buffer length=121, returned code=ContinueNeeded). ProcessId=3704 DateTime=2013-01-30T20:51:25.6491530ZSystem.Net Information: 0 : [6072] InitializeSecurityContext(credential = System.Net.SafeFreeCredential_SECURITY, context = 23570c30:235e9b58, targetName = host/localhost, inFlags = MutualAuth, Confidentiality, Connection, AcceptIntegrity) ProcessId=3704 DateTime=2013-01-30T20:51:25.6491530ZSystem.Net Information: 0 : [6072] InitializeSecurityContext(In-Buffers count=1, Out-Buffer length=0, returned code=OK). ProcessId=3704 DateTime=2013-01-30T20:51:25.6491530Z","Could not create SSL/TLS secure channel. The client and server cannot communicate, because they do not possess a common algorithm"
What's the easiest way to save an object to a file without serialization?, I have different kinds of objects in c# that I would like to save to a file (XML is preferred) but I can't use serialization since the class are not written by me but are from a DLL.What is the best solution for this ? <code> ,What's the easiest way to save an object to a file without serialization attributes?
Roslyn CTP3 - LiteralExpression - ArgumentOutOfRangeException," For the life of me, I cannot figure out why this line of code: throws an ArgumentOutOfRangeException under Roslyn CTP3. <code>  var literalExpressionSyntax = Syntax.LiteralExpression(SyntaxKind.CharacterLiteralExpression);",LiteralExpression - ArgumentOutOfRangeException
C# Net.Mail causing exchange server issues," I've recently designed a program in C# that will pull information from SQL databases, write an HTML page with the results, and auto-email it out. I've got everything working [sporadically], the problem I'm having is that I seem to be crashing our company's exchange server. After the first few successful runs of the program, I'll start getting this exception: Base exception: System.Net.Mail.SmtpException: Insufficient system storage. The server response was: 4.3.1 Insufficient system resourcesI'm wondering if I should be calling some sort of Dispose()-like method in my mailing? Or if there is any other apparent reason that I would be causing the mail system to stop responding? This affects all clients in our company, not just my code.This is Exchange 2010, and my code is compiled against .NET 3.5. My attachments are typically 27kb. If I log into the exchange server, it seems that messages just stick in a queue indefinitely. Clearing out the queue (remove without sending NDR) and rebooting the server will get it going again.The mailing portions look like this (username, password, and address changed): <code>  public void doFinalEmail(){ List<string> distList = new List<string>(); string distListPath = Environment.CurrentDirectory + ""\\DistList.txt""; string aLine; logThat(""Attempting email distribution of the generated report.""); if (File.Exists(distListPath)) { FileInfo distFile = new FileInfo(distListPath); StreamReader distReader = distFile.OpenText(); while (!String.IsNullOrEmpty(aLine = distReader.ReadLine())) { distList.Add(aLine); } } else { logThat(""[[ERROR]]: Distribution List DOES NOT EXIST! Path: "" + distListPath); } MailMessage msg = new MailMessage(); MailAddress fromAddress = new MailAddress(""emailaddresshere""); msg.From = fromAddress; logThat(""Recipients: ""); foreach (string anAddr in distList) { msg.To.Add(anAddr); logThat(""\t"" + anAddr); } if (File.Exists(Program.fullExportPath)) { logThat(""Attachment: "" + Program.fullExportPath); Attachment mailAttachment = new Attachment(Program.fullExportPath); msg.Attachments.Add(mailAttachment); string subj = ""Company: "" + Program.yestFileName; msg.Subject = subj; msg.IsBodyHtml = true; msg.BodyEncoding = System.Text.Encoding.UTF8; sendMail(msg); } else { logThat(""[[ERROR]]: ATTACHMENT DOES NOT EXIST! Path: "" + Program.fullExportPath); } } public void sendMail(MailMessage msg) { try { string username = ""user""; //domain user string password = ""pass""; // password SmtpClient mClient = new SmtpClient(); mClient.Host = ""192.168.254.11""; mClient.Credentials = new NetworkCredential(username, password); mClient.DeliveryMethod = SmtpDeliveryMethod.Network; mClient.Send(msg); } catch (Exception oops) { string whatHappened = String.Format(""Company: \r\nFailure in {0}! \r\n\r\nError message: {1} \r\nError data: {2} \r\n\r\nStack trace: {3} \r\n\r\nBase exception: {4} \r\nOccuring in method: {5} with a type of {6}\r\n"", oops.Source, oops.Message, oops.Data, oops.StackTrace, oops.GetBaseException(), oops.TargetSite, oops.GetType()); logThat(whatHappened); Environment.Exit(1); } }",System.Net.Mail.SmtpException: Insufficient system storage. The server response was: 4.3.1 Insufficient system resources
What is the equivilent of MVC's DefaultModelBinder in ASP.net Web API?," I want to create a custom model binder in ASP.Net Web API. There are plenty of resources on how to do this from scratch, but I want to leverage existing functionality.I have looked around in the source on codeplex and can see plenty of modelbinders in there but most are sealed... and even then I can't work out which one would be used in which situations.Here is my api method header: What I want to do is basically intercept the modelbinder after it has populated all the basic properties, and then set some extra values based on http request headers that I'll be setting on the client side.As I say, I am comfortable with creating custom modelbinders and modelbinderproviders and wiring them in, the bit I'm having a problem with is trying to re-use the existing functionality provided.Thanks, Pete <code>  public async Task<HttpResponseMessage> Post(long appId, [FromBody]Field field)",What is the equivalent of MVC's DefaultModelBinder in ASP.net Web API?
Is it safe (pun intended) to copy bitmaps using lockbits this way?," I think I've found a MUCH faster way to copy bitmaps in c#. (If it's valid, I'm sure I wasn't the first but I haven't seen it anywhere yet.)The simplest way I can think to ask this is to assert what I based my idea on and if no one shoots holes in it, assume the idea is sound: 1) LockBits simply copies a block of pixel data out of a bitmap to fixed memory to be edited and copied back in using UnlockBits2) Using LockBits does not affect the copied memory block so it should have no effect on the image copied from.3) Since you never enter unsafe code, there should be no risk of corrupting memory.Possible holes I see:1) If the PixelFormats of the two bitmaps are different, this method may not always copy correctly. However, since LockBits requires specifying a pixelformat, it seems this is handled. (If so, hooray for that overhead the other 99.9% of the time we're not switching pixelformats! /EndSarcasm)2) If the stride of the two bitmaps doesn't match, there could be a problem (because stride is the outer for loop's incrementor in the copy operation.) This problem would limit copying to bitmaps with equal stride.Edit: I think assertion #2 must be wrong... I just found an error when trying to later access the bitmap passed through CopyMe. Workaround below, but I'm not sure if it leaves a block of fixed memory lying around. (memory leak alert!) <code>  void FastCopyRegion(Bitmap CopyMe, ref Bitmap IntoMe, Rectangle CopyArea) { //`IntoMe` need not be declared `ref` but it brings // attention to the fact it will be modified Debug.Assert(CopyMe.PixelFormat == IntoMe.PixelFormat, ""PixelFormat mismatch, we could have a problem""); Debug.Assert(CopyMe.Width == IntoMe.Width, //This check does not verify ""Stride mismatch, we could have a problem"");// sign of `stride` match BitmapData copyData = CopyMe.LockBits(CopyArea, ImageLockMode.ReadWrite, CopyMe.PixelFormat); IntoMe.UnlockBits(copyData); } void FastCopyRegion(Bitmap CopyMe, ref Bitmap IntoMe, Rectangle CopyArea) { //`IntoMe` need not be declared `ref` but it brings attention to the fact it will be modified Debug.Assert(CopyMe.PixelFormat == IntoMe.PixelFormat, ""PixelFormat mismatch, we could have a problem""); Debug.Assert(CopyMe.Width == IntoMe.Width, ""Width mismatch, we could have a problem""); BitmapData copyD = IntoMe.LockBits(CopyArea, ImageLockMode.ReadWrite, CopyMe.PixelFormat); BitmapData copyData = CopyMe.LockBits(CopyArea, ImageLockMode.ReadWrite, CopyMe.PixelFormat); CopyMe.UnlockBits(copyData); IntoMe.UnlockBits(copyData); }",Is it safe (pun intended) to copy bitmap regions using lockbits this way?
Web.API and jQuery JSON Post- null value?," I can't seem to get this to work... I have some jQuery like this on the client: And in my Web.API controller I have a method like this: I'm just checking to see if a file lives on the server, and to return a bool as to whether it does or not. The report string I am sending is a UNC path, so reportpath looks like '\\some\path\'.I can fire the script okay, and hit a breakpoint in my ReportExists method, but the report variable is always null.What am I doing wrong?I also see a way to post with .post and postJSON. Maybe I should be using one of those? If so, what would my format be?Update: An additional clue maybe- if I remove [FromBody] then my breakpoint doesnt get hit at all- 'No http resource was found that matches the request'. Examples I am looking at show that [FromBody] isn't needed...? <code>  $.ajax({ type: ""POST"", url: ""api/report/reportexists/"", data: JSON.stringify({ ""report"":reportpath }), success: function(exists) { if (exists) { fileExists = true; } else { fileExists = false; } }}); [HttpPost]public bool ReportExists( [FromBody]string report ){ bool exists = File.Exists(report); return exists;}",jQuery posts null instead of JSON to ASP.NET Web API
Code First and Fluent API one to one relationship," I'm having trouble with reverse navigation on one of my entities. I have the following two objects: Now my foreign key navigation on the CandidateData object works fine. I am having trouble getting the reverse navigation for the candidate object to work (if that's even possible).This is my OnModelCreating function: It's close to working except in the database I get two columns that link to the CandidateId. I get the one I from the POCO object the I get another column Candidate_CandidateId I assume was created by the modelBuilder. I am quiet lost at the moment. Can someone please shed some light on what's going on?  <code>  public class Candidate{ [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)] public long CandidateId { get; set; } .... // Reverse navigation public virtual CandidateData Data { get; set; } ... // Foreign keys ....}public class CandidateData{ [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)] public long CandidateDataId { get; set; } [Required] public long CandidateId { get; set; } // Foreign keys [ForeignKey(""CandidateId"")] public virtual Candidate Candidate { get; set; }} protected override void OnModelCreating(DbModelBuilder modelBuilder){ modelBuilder.Conventions.Remove<PluralizingTableNameConvention>(); modelBuilder.Entity<Candidate>() .HasOptional(obj => obj.Data) .WithOptionalPrincipal(); base.OnModelCreating(modelBuilder);}",One to one relationship with Entity Framework Fluent API
Object Null Immediately After Instantiation," Edit: I just tried this with VS 2010, and the problem didn't occur. The issue only happens with VS 2012. Could this really be a bug? This is also happening on two separate laptops of mine, and even on a friend's laptop (that just got the latest code).First, a screenshot of the problem. This method is all new code.The debugger is skipping code from my recent check-in. The comments, in the code below, explain what is happening when I debug this method. So there really isn't a need to try and understand the code; just notice that lines of code are being skipped. If you're thinking that the code doesn't match the assembly being debugged, please bear with me. You'll see where the debugger recognizes new code, but not existing code. And this behavior is occurring on two different laptops, after deleting the code on disk and getting the latest again. Each comment tells you if the debugger hits a line. The disassembly shows only the lines of code that actually get hit.Now, check this out. If I add a new line of code, the debugger recognizes it, and the other lines of code change, as far as being recognized by the debugger. Just the second line of code, within the method, is new. And here's a partial snapshot of the disassembly, showing the new line of code:How can this be happening?Adding to the weirdness, at one point this even returned: Things I've tried:- Delete source code from hard drive and force a get latest- Repair VS 2012- Do some VS clean-up- Use VS 2010, change code, check in, get latest with VS 2012- Reboot- Other (can't remember all of them) <code>  [TestMethod()][DeploymentItem(""PrestoCommon.dll"")]public void ApplicationShouldBeInstalledTest_UseCase9(){ // Debugger hits this line ApplicationServer appServerAccessor = new ApplicationServer(); // Debugger does not hit these next two lines PrivateObject privateObject = new PrivateObject(appServerAccessor); ApplicationServer appServer = ApplicationServerLogic.GetByName(""server10""); // Debugger hits this line. Weirdness: both objects are null, and after this line runs, // appServerAccessor is no longer null. appServerAccessor.Id = appServer.Id; // Skips this line ApplicationWithOverrideVariableGroup appWithValidGroup = appServer.ApplicationsWithOverrideGroup[0]; // Debugger hits this line, but F11 doesn't take me into the method. appWithValidGroup.CustomVariableGroup = CustomVariableGroupLogic.GetById(""CustomVariableGroups/4""); // Skips this line Assert.AreEqual(true, true);} [TestMethod()][DeploymentItem(""PrestoCommon.dll"")]public void ApplicationShouldBeInstalledTest_UseCase9(){ // Debugger hits this line ApplicationServer appServerAccessor = new ApplicationServer(); // New line. It's recognized by the debugger, and it shows up in the disassembly. if (DateTime.Now > DateTime.Now.AddHours(1)) { return; } // Debugger does not hit these next two lines PrivateObject privateObject = new PrivateObject(appServerAccessor); ApplicationServer appServer = ApplicationServerLogic.GetByName(""server10""); // Gets hit now. // Debugger hits this line. Weirdness: both objects are null, and after this line runs, // appServerAccessor is no longer null. appServerAccessor.Id = appServer.Id; // No longer gets hit. // Skips this line (now it's getting hit) ApplicationWithOverrideVariableGroup appWithValidGroup = appServer.ApplicationsWithOverrideGroup[0]; // Debugger hits this line, but F11 doesn't take me into the method. Now this gets skipped. appWithValidGroup.CustomVariableGroup = CustomVariableGroupLogic.GetById(""CustomVariableGroups/4""); // Skips this line. Still skipped. Assert.AreEqual(true, true);} if (DateTime.Now > DateTime.Now.AddDays(1)) { return; }",Debugger Skipping Latest Checked-in Code in VS 2012 - Works with VS 2010
Debugger Skipping Code When Running Unit Tests," Edit: I just tried this with VS 2010, and the problem didn't occur. The issue only happens with VS 2012. Could this really be a bug? This is also happening on two separate laptops of mine, and even on a friend's laptop (that just got the latest code).First, a screenshot of the problem. This method is all new code.The debugger is skipping code from my recent check-in. The comments, in the code below, explain what is happening when I debug this method. So there really isn't a need to try and understand the code; just notice that lines of code are being skipped. If you're thinking that the code doesn't match the assembly being debugged, please bear with me. You'll see where the debugger recognizes new code, but not existing code. And this behavior is occurring on two different laptops, after deleting the code on disk and getting the latest again. Each comment tells you if the debugger hits a line. The disassembly shows only the lines of code that actually get hit.Now, check this out. If I add a new line of code, the debugger recognizes it, and the other lines of code change, as far as being recognized by the debugger. Just the second line of code, within the method, is new. And here's a partial snapshot of the disassembly, showing the new line of code:How can this be happening?Adding to the weirdness, at one point this even returned: Things I've tried:- Delete source code from hard drive and force a get latest- Repair VS 2012- Do some VS clean-up- Use VS 2010, change code, check in, get latest with VS 2012- Reboot- Other (can't remember all of them) <code>  [TestMethod()][DeploymentItem(""PrestoCommon.dll"")]public void ApplicationShouldBeInstalledTest_UseCase9(){ // Debugger hits this line ApplicationServer appServerAccessor = new ApplicationServer(); // Debugger does not hit these next two lines PrivateObject privateObject = new PrivateObject(appServerAccessor); ApplicationServer appServer = ApplicationServerLogic.GetByName(""server10""); // Debugger hits this line. Weirdness: both objects are null, and after this line runs, // appServerAccessor is no longer null. appServerAccessor.Id = appServer.Id; // Skips this line ApplicationWithOverrideVariableGroup appWithValidGroup = appServer.ApplicationsWithOverrideGroup[0]; // Debugger hits this line, but F11 doesn't take me into the method. appWithValidGroup.CustomVariableGroup = CustomVariableGroupLogic.GetById(""CustomVariableGroups/4""); // Skips this line Assert.AreEqual(true, true);} [TestMethod()][DeploymentItem(""PrestoCommon.dll"")]public void ApplicationShouldBeInstalledTest_UseCase9(){ // Debugger hits this line ApplicationServer appServerAccessor = new ApplicationServer(); // New line. It's recognized by the debugger, and it shows up in the disassembly. if (DateTime.Now > DateTime.Now.AddHours(1)) { return; } // Debugger does not hit these next two lines PrivateObject privateObject = new PrivateObject(appServerAccessor); ApplicationServer appServer = ApplicationServerLogic.GetByName(""server10""); // Gets hit now. // Debugger hits this line. Weirdness: both objects are null, and after this line runs, // appServerAccessor is no longer null. appServerAccessor.Id = appServer.Id; // No longer gets hit. // Skips this line (now it's getting hit) ApplicationWithOverrideVariableGroup appWithValidGroup = appServer.ApplicationsWithOverrideGroup[0]; // Debugger hits this line, but F11 doesn't take me into the method. Now this gets skipped. appWithValidGroup.CustomVariableGroup = CustomVariableGroupLogic.GetById(""CustomVariableGroups/4""); // Skips this line. Still skipped. Assert.AreEqual(true, true);} if (DateTime.Now > DateTime.Now.AddDays(1)) { return; }",Debugger Skipping Latest Checked-in Code in VS 2012 - Works with VS 2010
Debugger Skipping Code When Running Unit Tests - Bug?," Edit: I just tried this with VS 2010, and the problem didn't occur. The issue only happens with VS 2012. Could this really be a bug? This is also happening on two separate laptops of mine, and even on a friend's laptop (that just got the latest code).First, a screenshot of the problem. This method is all new code.The debugger is skipping code from my recent check-in. The comments, in the code below, explain what is happening when I debug this method. So there really isn't a need to try and understand the code; just notice that lines of code are being skipped. If you're thinking that the code doesn't match the assembly being debugged, please bear with me. You'll see where the debugger recognizes new code, but not existing code. And this behavior is occurring on two different laptops, after deleting the code on disk and getting the latest again. Each comment tells you if the debugger hits a line. The disassembly shows only the lines of code that actually get hit.Now, check this out. If I add a new line of code, the debugger recognizes it, and the other lines of code change, as far as being recognized by the debugger. Just the second line of code, within the method, is new. And here's a partial snapshot of the disassembly, showing the new line of code:How can this be happening?Adding to the weirdness, at one point this even returned: Things I've tried:- Delete source code from hard drive and force a get latest- Repair VS 2012- Do some VS clean-up- Use VS 2010, change code, check in, get latest with VS 2012- Reboot- Other (can't remember all of them) <code>  [TestMethod()][DeploymentItem(""PrestoCommon.dll"")]public void ApplicationShouldBeInstalledTest_UseCase9(){ // Debugger hits this line ApplicationServer appServerAccessor = new ApplicationServer(); // Debugger does not hit these next two lines PrivateObject privateObject = new PrivateObject(appServerAccessor); ApplicationServer appServer = ApplicationServerLogic.GetByName(""server10""); // Debugger hits this line. Weirdness: both objects are null, and after this line runs, // appServerAccessor is no longer null. appServerAccessor.Id = appServer.Id; // Skips this line ApplicationWithOverrideVariableGroup appWithValidGroup = appServer.ApplicationsWithOverrideGroup[0]; // Debugger hits this line, but F11 doesn't take me into the method. appWithValidGroup.CustomVariableGroup = CustomVariableGroupLogic.GetById(""CustomVariableGroups/4""); // Skips this line Assert.AreEqual(true, true);} [TestMethod()][DeploymentItem(""PrestoCommon.dll"")]public void ApplicationShouldBeInstalledTest_UseCase9(){ // Debugger hits this line ApplicationServer appServerAccessor = new ApplicationServer(); // New line. It's recognized by the debugger, and it shows up in the disassembly. if (DateTime.Now > DateTime.Now.AddHours(1)) { return; } // Debugger does not hit these next two lines PrivateObject privateObject = new PrivateObject(appServerAccessor); ApplicationServer appServer = ApplicationServerLogic.GetByName(""server10""); // Gets hit now. // Debugger hits this line. Weirdness: both objects are null, and after this line runs, // appServerAccessor is no longer null. appServerAccessor.Id = appServer.Id; // No longer gets hit. // Skips this line (now it's getting hit) ApplicationWithOverrideVariableGroup appWithValidGroup = appServer.ApplicationsWithOverrideGroup[0]; // Debugger hits this line, but F11 doesn't take me into the method. Now this gets skipped. appWithValidGroup.CustomVariableGroup = CustomVariableGroupLogic.GetById(""CustomVariableGroups/4""); // Skips this line. Still skipped. Assert.AreEqual(true, true);} if (DateTime.Now > DateTime.Now.AddDays(1)) { return; }",Debugger Skipping Latest Checked-in Code in VS 2012 - Works with VS 2010
Debugger Skipping Latest Checked-in Code - Bug?," Edit: I just tried this with VS 2010, and the problem didn't occur. The issue only happens with VS 2012. Could this really be a bug? This is also happening on two separate laptops of mine, and even on a friend's laptop (that just got the latest code).First, a screenshot of the problem. This method is all new code.The debugger is skipping code from my recent check-in. The comments, in the code below, explain what is happening when I debug this method. So there really isn't a need to try and understand the code; just notice that lines of code are being skipped. If you're thinking that the code doesn't match the assembly being debugged, please bear with me. You'll see where the debugger recognizes new code, but not existing code. And this behavior is occurring on two different laptops, after deleting the code on disk and getting the latest again. Each comment tells you if the debugger hits a line. The disassembly shows only the lines of code that actually get hit.Now, check this out. If I add a new line of code, the debugger recognizes it, and the other lines of code change, as far as being recognized by the debugger. Just the second line of code, within the method, is new. And here's a partial snapshot of the disassembly, showing the new line of code:How can this be happening?Adding to the weirdness, at one point this even returned: Things I've tried:- Delete source code from hard drive and force a get latest- Repair VS 2012- Do some VS clean-up- Use VS 2010, change code, check in, get latest with VS 2012- Reboot- Other (can't remember all of them) <code>  [TestMethod()][DeploymentItem(""PrestoCommon.dll"")]public void ApplicationShouldBeInstalledTest_UseCase9(){ // Debugger hits this line ApplicationServer appServerAccessor = new ApplicationServer(); // Debugger does not hit these next two lines PrivateObject privateObject = new PrivateObject(appServerAccessor); ApplicationServer appServer = ApplicationServerLogic.GetByName(""server10""); // Debugger hits this line. Weirdness: both objects are null, and after this line runs, // appServerAccessor is no longer null. appServerAccessor.Id = appServer.Id; // Skips this line ApplicationWithOverrideVariableGroup appWithValidGroup = appServer.ApplicationsWithOverrideGroup[0]; // Debugger hits this line, but F11 doesn't take me into the method. appWithValidGroup.CustomVariableGroup = CustomVariableGroupLogic.GetById(""CustomVariableGroups/4""); // Skips this line Assert.AreEqual(true, true);} [TestMethod()][DeploymentItem(""PrestoCommon.dll"")]public void ApplicationShouldBeInstalledTest_UseCase9(){ // Debugger hits this line ApplicationServer appServerAccessor = new ApplicationServer(); // New line. It's recognized by the debugger, and it shows up in the disassembly. if (DateTime.Now > DateTime.Now.AddHours(1)) { return; } // Debugger does not hit these next two lines PrivateObject privateObject = new PrivateObject(appServerAccessor); ApplicationServer appServer = ApplicationServerLogic.GetByName(""server10""); // Gets hit now. // Debugger hits this line. Weirdness: both objects are null, and after this line runs, // appServerAccessor is no longer null. appServerAccessor.Id = appServer.Id; // No longer gets hit. // Skips this line (now it's getting hit) ApplicationWithOverrideVariableGroup appWithValidGroup = appServer.ApplicationsWithOverrideGroup[0]; // Debugger hits this line, but F11 doesn't take me into the method. Now this gets skipped. appWithValidGroup.CustomVariableGroup = CustomVariableGroupLogic.GetById(""CustomVariableGroups/4""); // Skips this line. Still skipped. Assert.AreEqual(true, true);} if (DateTime.Now > DateTime.Now.AddDays(1)) { return; }",Debugger Skipping Latest Checked-in Code in VS 2012 - Works with VS 2010
what's the difference between DbContext and ObjectContext, From MSDN: Represents a combination of the Unit-Of-Work and Repository patterns and enables you to query a database and group together changes that will then be written back to the store as a unit. DbContext is conceptually similar to ObjectContext.I though DbContext only handle the connection to the DB and the number of threads working against the DB. Now I understand it contains the tracking mechanism? I thought this was in the ObjectContext.So what is (in plain English) the difference between them? <code> ,What's the difference between DbContext and ObjectContext
How to programatically train the SpeechRecognitionEngine and convert audio file to text," Is it possible to programmatically train the recognizer giving .wavs instead of talking to a microphone?If so, How to do it?, currently I have the code that performs recognition on the audio in a 0.wav file and writes the recognized text to the console. EDITI understand using the Training wizard is useful to do this accomplished by Opening Speech Recognition,clicking Start button->Control Panel->Ease of Access->Speech Recognition.How to custom train the speech recognition with custom wav or even mp3 files?When using Training wizard (Control Panel training UI) training files are stored in {AppData}\Local\Microsoft\Speech\Files\TrainingAudio.How can I use or make a custom training instead of using Training wizard?The Speech Control Panel creates registry entries for the training audio files in the key HKCU\Software\Microsoft\Speech\RecoProfiles\Tokens{ProfileGUID}{00000000-0000-0000-0000-0000000000000000}\FilesDo the registry entries created by code have to be placed in there?The reason to do this is I want to custom train with my own wav files and list of words and phrases, then transfer all to other systems. <code>  Imports System.IOImports System.Speech.RecognitionImports System.Speech.AudioFormatNamespace SampleRecognition Class Program Shared completed As Boolean Public Shared Sub Main(ByVal args As String()) Using recognizer As New SpeechRecognitionEngine() Dim dictation As Grammar = New DictationGrammar() dictation.Name = ""Dictation Grammar"" recognizer.LoadGrammar(dictation) ' Configure the input to the recognizer. recognizer.SetInputToWaveFile(""C:\Users\ME\v02\0.wav"") ' Attach event handlers for the results of recognition. AddHandler recognizer.SpeechRecognized, AddressOf recognizer_SpeechRecognized AddHandler recognizer.RecognizeCompleted, AddressOf recognizer_RecognizeCompleted ' Perform recognition on the entire file. Console.WriteLine(""Starting asynchronous recognition..."") completed = False recognizer.RecognizeAsync() ' Keep the console window open. While Not completed Console.ReadLine() End While Console.WriteLine(""Done."") End Using Console.WriteLine() Console.WriteLine(""Press any key to exit..."") Console.ReadKey() End Sub ' Handle the SpeechRecognized event. Private Shared Sub recognizer_SpeechRecognized(ByVal sender As Object, ByVal e As SpeechRecognizedEventArgs) If e.Result IsNot Nothing AndAlso e.Result.Text IsNot Nothing Then Console.WriteLine("" Recognized text = {0}"", e.Result.Text) Else Console.WriteLine("" Recognized text not available."") End If End Sub ' Handle the RecognizeCompleted event. Private Shared Sub recognizer_RecognizeCompleted(ByVal sender As Object, ByVal e As RecognizeCompletedEventArgs) If e.[Error] IsNot Nothing Then Console.WriteLine("" Error encountered, {0}: {1}"", e.[Error].[GetType]().Name, e.[Error].Message) End If If e.Cancelled Then Console.WriteLine("" Operation cancelled."") End If If e.InputStreamEnded Then Console.WriteLine("" End of stream encountered."") End If completed = True End Sub End ClassEnd Namespace",How to programmatically train the SpeechRecognitionEngine and convert audio file to text in C# or vb.net
How to programatically train the SpeechRecognitionEngine and convert audio file to text in c# or vb.net," Is it possible to programmatically train the recognizer giving .wavs instead of talking to a microphone?If so, How to do it?, currently I have the code that performs recognition on the audio in a 0.wav file and writes the recognized text to the console. EDITI understand using the Training wizard is useful to do this accomplished by Opening Speech Recognition,clicking Start button->Control Panel->Ease of Access->Speech Recognition.How to custom train the speech recognition with custom wav or even mp3 files?When using Training wizard (Control Panel training UI) training files are stored in {AppData}\Local\Microsoft\Speech\Files\TrainingAudio.How can I use or make a custom training instead of using Training wizard?The Speech Control Panel creates registry entries for the training audio files in the key HKCU\Software\Microsoft\Speech\RecoProfiles\Tokens{ProfileGUID}{00000000-0000-0000-0000-0000000000000000}\FilesDo the registry entries created by code have to be placed in there?The reason to do this is I want to custom train with my own wav files and list of words and phrases, then transfer all to other systems. <code>  Imports System.IOImports System.Speech.RecognitionImports System.Speech.AudioFormatNamespace SampleRecognition Class Program Shared completed As Boolean Public Shared Sub Main(ByVal args As String()) Using recognizer As New SpeechRecognitionEngine() Dim dictation As Grammar = New DictationGrammar() dictation.Name = ""Dictation Grammar"" recognizer.LoadGrammar(dictation) ' Configure the input to the recognizer. recognizer.SetInputToWaveFile(""C:\Users\ME\v02\0.wav"") ' Attach event handlers for the results of recognition. AddHandler recognizer.SpeechRecognized, AddressOf recognizer_SpeechRecognized AddHandler recognizer.RecognizeCompleted, AddressOf recognizer_RecognizeCompleted ' Perform recognition on the entire file. Console.WriteLine(""Starting asynchronous recognition..."") completed = False recognizer.RecognizeAsync() ' Keep the console window open. While Not completed Console.ReadLine() End While Console.WriteLine(""Done."") End Using Console.WriteLine() Console.WriteLine(""Press any key to exit..."") Console.ReadKey() End Sub ' Handle the SpeechRecognized event. Private Shared Sub recognizer_SpeechRecognized(ByVal sender As Object, ByVal e As SpeechRecognizedEventArgs) If e.Result IsNot Nothing AndAlso e.Result.Text IsNot Nothing Then Console.WriteLine("" Recognized text = {0}"", e.Result.Text) Else Console.WriteLine("" Recognized text not available."") End If End Sub ' Handle the RecognizeCompleted event. Private Shared Sub recognizer_RecognizeCompleted(ByVal sender As Object, ByVal e As RecognizeCompletedEventArgs) If e.[Error] IsNot Nothing Then Console.WriteLine("" Error encountered, {0}: {1}"", e.[Error].[GetType]().Name, e.[Error].Message) End If If e.Cancelled Then Console.WriteLine("" Operation cancelled."") End If If e.InputStreamEnded Then Console.WriteLine("" End of stream encountered."") End If completed = True End Sub End ClassEnd Namespace",How to programmatically train the SpeechRecognitionEngine and convert audio file to text in C# or vb.net
LINQ query  Data aggregation," Let's take a class called Cls: Now, let's populate some collection with following elements: What I need to do, is to enumerate over Sequence Numbers and check if the next element has the same value. If yes, values are aggregated and so, desired output is as following: How can I perform this operation using LINQ query? <code>  public class Cls{ public int SequenceNumber { get; set; } public int Value { get; set; }} SequenceNumber Value======== =====1 92 93 154 155 156 307 9 Sequence SequenceNumber NumberFrom To Value======== ======== =====1 2 93 5 156 6 307 7 9",LINQ query  Data aggregation (Group Adjacent)
What's the difference between WebRequest.DefaultWebProxy() and WebRequest.GetSystemWebProxy()?," I am wondering what the main differences are between DefaultWebProxy and GetSystemWebProxy(). There're some descriptions on MSDN, but I still feel I need a bit more details to have a better understanding.Also, let's say I have following options for proxy configuration on my C# winform applicationAuto-detect proxy settingsUse system default settingsNo proxyThen which method goes to which option? Is it right to say that Auto-detect proxy somewhat equals Use system default settings? <code> ",What's the difference between WebRequest.DefaultWebProxy and WebRequest.GetSystemWebProxy()?
Json.NET serialize Dictionary as part of parent object," I'm using Json.Net for serialization.I have a class with a Dictionary: Can I somehow serialize this object to get the following JSON where ""key1"", ""key2"" are keys in the Dictionary?  <code>  public class Test{ public string X { get; set; } public Dictionary<string, string> Y { get; set; }} { ""X"" : ""value"", ""key1"": ""value1"", ""key2"": ""value2""}",How to serialize a Dictionary as part of its parent object using Json.Net
How to freeze a part of code against formatting in .NET [C#]?," Is there a way to lock or freeze a part of code against formatting in Visual Studio?I want to protect the following code : to be formatted as: but still be able to format the rest of the document. <code>  Method(""This is a long text"", 12 , true );Method(""Hi"", 558, true );Method(""Short text"", 1 , false ); Method(""This is a long text"", 12, true);Method(""Hi"", 558, true);Method(""Short text"", 1, false);",Freeze part of code against formatting
How to freeze a part of code against formatting in Visual Studio," Is there a way to lock or freeze a part of code against formatting in Visual Studio?I want to protect the following code : to be formatted as: but still be able to format the rest of the document. <code>  Method(""This is a long text"", 12 , true );Method(""Hi"", 558, true );Method(""Short text"", 1 , false ); Method(""This is a long text"", 12, true);Method(""Hi"", 558, true);Method(""Short text"", 1, false);",Freeze part of code against formatting
Which the internal implementation of dynamic memory allocation in List<T>?," Now I have an algorithm for dynamically allocating memory on an array:If array is full I create a new array of twice the size, and copy items.If array is one-quarter full I create a new array of half the size, and copy items.This is fairly fast algorithm for dynamic memory allocation despite the extra over-head of copying the elements to the newly allocated array.What is the faster, List<T> or such an algorithm based on an array? What would you recommend to use?does List<T> use simple array as internal data structure? <code> ",Which algorithm is used in List<T> to dynamically allocate memory?
Converting Java code in C# for uint," I am converting code that works in Java but not in C# This generates a compile time error ""Constant value '-128' cannot be converted to a 'byte'."" How can I store a negative number for a byte? <code>  byte[] buffer = new byte[64];this.buffer[((int)this.count & 0x3F)] = -128;",Why can I not store a negative value in a byte variable?
"HttpListener ""access denied"" for non-admins"," I have written a C# application that uses HttpListener to listen for HTTP requests -obviously! The namespace prefix I use is also registered using netsh for the current user (as suggested by everyone on SO).The problem is despite using netsh my application still throws an ""access is denied"" exception for non-admin users. The OS is Windows 7.Update: It appears as though my application is not executing the netsh command when I run it with a non-admin user. Is there any problems with my code? There are no exceptions thrown. <code>  AddAddress(""http://localhost:8400/"", Environment.UserDomainName, Environment.UserName); HttpListener _listener = new HttpListener(); _listener.Prefixes.Add(""http://localhost:8400/""); _listener.Start(); ... /** method stolen from an SO thread. sorry can't remember the author **/ static void AddAddress(string address, string domain, string user) { string args = string.Format(@""http add urlacl url={0}"", address) + "" user=\"""" + domain + ""\\"" + user + ""\""""; ProcessStartInfo psi = new ProcessStartInfo(""netsh"", args); psi.Verb = ""runas""; psi.CreateNoWindow = true; psi.WindowStyle = ProcessWindowStyle.Hidden; psi.UseShellExecute = true; Process.Start(psi).WaitForExit(); }","HttpListenerException ""access denied"" for non-admins"
Implementing IComparer with using standard Linq Sorting Functions," My problem is that I always want to order a collection of objects in a certain fashion.For example: ... The issue I have is its quite longwinded tacking-on the sort order all the time. A neat solution appears to just create a class that implements IComparer<foo>, meaning I can do: .The problem is, the order method this implements is as follows... Meaning it compares on a very granular basis.The currently implementation (which will probably work, although im writing pseudocode) This is not exactly efficient, can another offer a neater solution? Ideally without a Compare(x,y) method altogether? <code>  class foo{public string name {get;set;}public DateTime date {get;set;}public int counter {get;set;}} IEnumerable<foo> dosomething(foo[] bar){ return bar.OrderBy(a=>a.name).ThenBy(a=>a.date).ThenBy(a=>a.counter);} IEnumerable<foo> dosomething(foo[] bar){ return bar.OrderBy(a=>a, new fooIComparer())} public int Compare(foo x, foo y){ } public int Compare(foo x, foo y){if (x==y) return 0;var order = new []{x,y}.OrderBy(a=>a.name).ThenBy(a=>a.date).ThenBy(a=>a.counter); return (order[0] == x) ? -1 : -1;//if x is first in array it is less than y, else it is greater}",Implementing IComparer combining multiple Linq OrderBy's
How to implement a Key multiple values dictionary in C#," I often need one key to multiple vaules dictionary, but in C# most of them are two dimensions like Dictionary and Hashtable.I want something like this: dt inside<> means data type. Anybody has ideas about this? <code>  var d = new Dictionary<key-dt,value1-dt,value2-dt,value3-dt,value4-dt>();",One Key to multiple values dictionary in C#?
How to implement an one Key to multiple values dictionary in C#," I often need one key to multiple vaules dictionary, but in C# most of them are two dimensions like Dictionary and Hashtable.I want something like this: dt inside<> means data type. Anybody has ideas about this? <code>  var d = new Dictionary<key-dt,value1-dt,value2-dt,value3-dt,value4-dt>();",One Key to multiple values dictionary in C#?
C# 3D graphics library .NET," I would like to learn to make simple 3D applications for Windows 7 / desktop. By that, I mean spheres, triangles or pixels moving around in 3D space. It does not have to be very complicated as of yet.For this, I would like to use C# language with .NET (Java/C++ is my second priority).I know this has been asked many times around the internet, but I feel like many of the questions are outdated, many APIs deprecated and tutorials too old.I was thinking about learning XNA, but then I learned that Microsoft does not plan to develop and support it anymore. SharpDX also seemed like a good way to go, but that seems to be aimed for Windows Store and Phone apps.While looking on the internet, Managed DirectX seemed exactly what I was looking for (the syntax, the complexity), but again, that is way too deprecated for me to use. Can you please guide me what I should learn to create simple yet solid 3D applications? <code> ",3D graphics library for .NET
How to handle exceptions in Tasks with TPL?," I studied this article on MSDN, as well as some questions/answers on SO regarding this topic, but cannot figure why below code does not work (in a sample console app).AggregateException is expected to be thrown, according to MSDN, which would contain one inner exception with hello message. Instead, this hello exception is unhandled. It happens when inside a debugger.If you press continue or run standalone, it works as expected. Is there any way to avoid pressing continue all the time in VS? After all, whatever is within a Try...Catch block is considered handled in a single threaded programming model. Otherwise, debugging could be a nightmare.VB.NET C# Is there something obvious I am missing here? <code>  Sub Main() Try Task.Factory.StartNew(AddressOf TaskThatThrowsException).Wait() Catch ex As AggregateException Console.WriteLine(ex.ToString) 'does not get here until you hit Continue End TryEnd SubPrivate Sub TaskThatThrowsException() Throw New Exception(""hello"") 'exception was unhandledEnd Sub namespace ConsoleApplication1 { class Program { static void Main(string[] args) { try { Task.Factory.StartNew(TaskThatThrowsException).Wait(); } catch (AggregateException ex) { Console.WriteLine(ex.ToString()); //never gets here } } static void TaskThatThrowsException() { throw new Exception(""hello""); //exception was unhandled } }}",How to handle exceptions in Tasks with debugger?
Powershell keep text formatting when reading in a file," I believe this is a simple question, but I can't wrap my head around it. I want to do diagnostic commands in command shell on Windows. Like this: Then I want to be able to read the file and keep the formatting and lastly publish it to pastebin via their API. I've tried, but I seem to lose the formatting no matter what I do. Is this possible to do? <code>  $cmd = ""ipconfig >> c:\test.txt"" $message = Invoke-Expression($cmd) [String]$message = Get-Content c:\topsecret\testme.txt",PowerShell keep text formatting when reading in a file
DataSet Update Operation," I have an application which uses DataSet.WriteXML to export data and DataSet.ReadXML to import data. During the import process I need to change certain primary keys as part of the application logic. When there are over 500K records, it writes to XML and read from XML successfully. Once I change the primary key it waits some time and throws an OutOfMemory exception. The reason as I believe is, it has to do a lot of cascade updates. I tried BeginEdit and EndEdit during primary key change, but still failing in EndEdit in that case.As I have understood, DataSets keeps some of previous data also in memory. Is there any way to optimize DataSet update operations in a way it consumes minimum memeory? <code> ",DataSet Cascade and Memory consumption
How to pass multiples arguments in processStartInfo?," I want to run some cmd command from c#code. I followed some blogs and tutorial and got the answer, but I am in little bit confused i.e how should I pass multiple arguments?I use follow code: What will be the startInfo.Arguments value for the following command line code?makecert -sk server -sky exchange -pe -n CN=localhost -ir LocalMachine -is Root -ic MyCA.cer -sr LocalMachine -ss My MyAdHocTestCert.cernetsh http add sslcert ipport=127.0.0.1:8085 certhash=0000000000003ed9cd0c315bbb6dc1c08da5e6 appid={00112233-4455-6677-8899-AABBCCDDEEFF} clientcertnegotiation=enable <code>  System.Diagnostics.Process process = new System.Diagnostics.Process();System.Diagnostics.ProcessStartInfo startInfo = new System.Diagnostics.ProcessStartInfo();startInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Normal;startInfo.FileName = ""cmd.exe"";startInfo.Arguments = ...",How to pass multiple arguments in processStartInfo?
Convert List Type to IEnum Interface Type, I have a How can I convert to Person Implements IPerson interface <code>  List<Person> personlist; IEnumerable<IPerson> iPersonList,Convert List Type to IEnumerable Interface Type
I'm having trouble sending a string containing special characters through a TcpClient (byte[]) (C#)," I'm trying to send a string containing special characters through a TcpClient (byte[]). Here's an example:Client enters ""am"" in a textboxClient converts string to byte[] using a certain encoding (I've tried all the predefined ones plus some like ""iso-8859-1"")Client sends byte[] through TCPServer receives and outputs the string reconverted with the same encoding (to a listbox)Edit :I forgot to mention that the resulting string was ""am?"".Edit-2 (as requested, here's some code):@DJKRAZE here's a bit of code : On the server side: The string that appears in the listbox is ""am?""=== Solution === Update:Simply using Encoding.Utf8.GetBytes(""""); works like a charm. <code>  byte[] buffer = Encoding.ASCII.GetBytes(""am"");(TcpClient)server.Client.Send(buffer); byte[] buffer = new byte[1024];Client.Recieve(buffer);string message = Encoding.ASCII.GetString(buffer);ListBox1.Items.Add(message); Encoding encoding = Encoding.GetEncoding(""iso-8859-1"");byte[] message = encoding.GetBytes(""bab"");",Sending a string containing special characters through a TcpClient (byte[])
I'm having trouble sending a string containing special characters through a TcpClient (byte[])," I'm trying to send a string containing special characters through a TcpClient (byte[]). Here's an example:Client enters ""am"" in a textboxClient converts string to byte[] using a certain encoding (I've tried all the predefined ones plus some like ""iso-8859-1"")Client sends byte[] through TCPServer receives and outputs the string reconverted with the same encoding (to a listbox)Edit :I forgot to mention that the resulting string was ""am?"".Edit-2 (as requested, here's some code):@DJKRAZE here's a bit of code : On the server side: The string that appears in the listbox is ""am?""=== Solution === Update:Simply using Encoding.Utf8.GetBytes(""""); works like a charm. <code>  byte[] buffer = Encoding.ASCII.GetBytes(""am"");(TcpClient)server.Client.Send(buffer); byte[] buffer = new byte[1024];Client.Recieve(buffer);string message = Encoding.ASCII.GetString(buffer);ListBox1.Items.Add(message); Encoding encoding = Encoding.GetEncoding(""iso-8859-1"");byte[] message = encoding.GetBytes(""bab"");",Sending a string containing special characters through a TcpClient (byte[])
Send mutilple content type in single call?," I have created a service which accept 2 things :1) A body parameter called ""type"".2) A csv file to be uploaded.i am reading this two things in server side like this: how can i test this, i am using Fiddler to test this but i can send only one thing at a time(either type or file), because both things are of different content type, how can i use content type multipart/form-data and application/x-www-form-urlencoded at same time.Even i use this code This also not sending any file to server. <code>  //Read body params string type = HttpContext.Current.Request.Form[""type""]; //read uploaded csv file Stream csvStream = HttpContext.Current.Request.Files[0].InputStream; public static void PostDataCSV() { //open the sample csv file byte[] fileToSend = File.ReadAllBytes(@""C:\SampleData.csv""); string url = ""http://localhost/upload.xml""; HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url); request.Method = ""POST""; request.ContentType = ""multipart/form-data""; request.ContentLength = fileToSend.Length; using (Stream requestStream = request.GetRequestStream()) { // Send the file as body request. requestStream.Write(fileToSend, 0, fileToSend.Length); requestStream.Close(); } HttpWebResponse response = (HttpWebResponse)request.GetResponse(); //read the response string result; using (StreamReader reader = new StreamReader(response.GetResponseStream())) { result = reader.ReadToEnd(); } Console.WriteLine(result); }",Upload multiple files in a single HTTPWebRequest
Bind an ObservableCollection to a wpf datagrid : Gris stay empty," I would like to bind an ObservableCollection to wpf datagrid.My ObservableCollection is not empty, but, my datagrid stay empty : Here is my xaml: I repeat : I looked in debug, and my ObservableCollection is not empty.Anyone know why ma datagrid stay empty? <code>  public partial class Fenetre_EvtCode : Window{ ObservableCollection<EvtCode> glb_ObservableEvtCode; public Fenetre_EvtCode() { InitializeComponent(); EvtCode myEvt = new EvtCode(); glb_ObservableEvtCode = myEvt.GetAllEvtCode(); }} <DataGrid Foreground=""Aqua"" Name=""myDataGridEvtCode"" AutoGenerateColumns=""True"" HorizontalAlignment=""Stretch"" Margin=""0,0,0,0"" VerticalAlignment=""Stretch"" Height=""453"" ItemsSource=""{Binding glb_ObservableEvtCode}"" />",Bind an ObservableCollection to a wpf datagrid : Grid stays empty
How can I Hide a specific Column form a DataGridView in WinForms in C#?, How can I hide a specific Column in DataGridview along with its header while being able to use its value ? ( just doesn't get shown ) . The following code doesn't work. <code>  gridview.Rows[e.RowIndex].Cells[11].Visible = false;,How can I hide a specific column form a dataGridView?
How is reflection in C# implemented?," I got curious as to where Type.GetType() is implemented, so I took a peek at the assembly and noticed Type.GetType() calls base.GetType() and since Type inherits from MemberInfo I took a look and it is defined as _MemberInfo.GetType() which returns this.GetType(). Since I cannot find the actual code that shows how C# can get type information I would like to know:How does the CLR get Type and MemberInfo from objects at Runtime? <code> ",How is Reflection implemented in C#?
How is reflection implemented in C#?," I got curious as to where Type.GetType() is implemented, so I took a peek at the assembly and noticed Type.GetType() calls base.GetType() and since Type inherits from MemberInfo I took a look and it is defined as _MemberInfo.GetType() which returns this.GetType(). Since I cannot find the actual code that shows how C# can get type information I would like to know:How does the CLR get Type and MemberInfo from objects at Runtime? <code> ",How is Reflection implemented in C#?
Different between private EventHandler and private event EventHandler?," Basically what the title says.Whats the difference between those two (I am currently using the first one) and I have a method The doDownload method would call the It works fine, so far. But I feel I am doing something horribly wrong. <code>  private EventHandler _progressEvent; private event EventHandler _progressEvent; void Download(string url, EventHandler progressEvent) { doDownload(url) this._progressEvent = progressEvent;} _progressEvent(this, new EventArgs());",Difference between private EventHandler and private event EventHandler?
Disable text wrap in asp.net gridview c#," The output is like this: What I want is to display it in only one line My Aspx gridview code is: I disabled all the wrap property to false in gridview. but the text still wraps. <code>  MyNameIsJohnSmithAndImaperson MyNameIsJohnSmithAndImaperson <asp:GridView ID=""GridView1"" runat=""server"" BackColor=""LightGoldenrodYellow"" BorderColor=""Tan"" BorderWidth=""1px"" CellPadding=""5"" Font-Names=""Calibri"" Font-Size=""Medium"" Font-Underline=""False"" ForeColor=""Black""> <RowStyle Wrap=""False""/> <EmptyDataRowStyle Wrap=""False""/> <FooterStyle BackColor=""Tan"" BorderColor=""Black"" BorderStyle=""Solid"" Wrap=""False""/> <PagerStyle BackColor=""PaleGoldenrod"" ForeColor=""DarkSlateBlue"" HorizontalAlign=""Center"" Wrap=""False"" /> <SelectedRowStyle BackColor=""DarkSlateBlue"" ForeColor=""GhostWhite"" Wrap=""False""/> <HeaderStyle BackColor=""Tan"" BorderStyle=""Solid"" Font-Bold=""True"" Wrap=""False""/> <EditRowStyle Wrap=""False""/> <AlternatingRowStyle BackColor=""PaleGoldenrod"" Wrap=""False""/></asp:GridView>",Disable text wrap in asp.net gridview
"Cannot load file or assembly 'crystal decisions.windows.forms,version=13.0.2000.0' .The system cannot find the file specified"," I'm working on windows application. In this I designed Report module.I get error whenever I wanted to view report in Windows 7, Windows XP & Windows Vista, but it works in Windows 8.Following steps I took before deploying setupI installed .NET Framework 4 in Windows XP & .NET Framework 4.5 in Windows 7I installed CRforVS_13_0_2 but its through error message like You must already have Visual Studio 2010 installed to proceed with this installation. and SAP Crystal Reports version for Visual studio 2010 installation ended prematurely because of an error.Then I installed my project setup (while creating setup manually I included all crystal report assemblies), logged in and went to Report Menu, on click to open preview of Crystal Report its through error message like Cannot load file or assembly 'crystal decisions.windows.forms,version=13.0.2000.0,culture=neutral,Public keytoken=692fbea5521e1304' or one of its dependencies. The system cannot find the file specified.Please guide me the how to resolve this issue. <code> ","Cannot load file or assembly 'crystal decisions.windows.forms,version=13.0.2000.0'"
TextBox cursor position, I have a Windows Forms textbox with background thread updating its value every second.If I place cursor inside textbox it will loose its current position at next update. Same thing with text selection.I tried to solve it like that It works good most of the time. Here is situation when it does not work: 1) I place cursor at the end of the text in textbox2) press SHIFT and move cursor to the left using <- arrow keySelection won't work properly. It looks like combination SelectionStart=10 and SelectionLength=1 automatically moves cursor to position 11 (not 10 as I want it to be).Please let me know if there is anything I can do about it! I am using Framework.NET 2.0.There must be a way to set cursor position in textbox other then SelectionStart+SelectionLength. <code>  protected void SetTextProgrammatically(string value) { // save current cursor position and selection int start = textBox.SelectionStart; int length = textBox.SelectionLength; // update text textBox.Text = value; // restore cursor position and selection textBox.SelectionStart = start; textBox.SelectionLength = length; },How to set TextBox cursor position without SelectionStart
Bidirectional TextBox cursor position, I have a Windows Forms textbox with background thread updating its value every second.If I place cursor inside textbox it will loose its current position at next update. Same thing with text selection.I tried to solve it like that It works good most of the time. Here is situation when it does not work: 1) I place cursor at the end of the text in textbox2) press SHIFT and move cursor to the left using <- arrow keySelection won't work properly. It looks like combination SelectionStart=10 and SelectionLength=1 automatically moves cursor to position 11 (not 10 as I want it to be).Please let me know if there is anything I can do about it! I am using Framework.NET 2.0.There must be a way to set cursor position in textbox other then SelectionStart+SelectionLength. <code>  protected void SetTextProgrammatically(string value) { // save current cursor position and selection int start = textBox.SelectionStart; int length = textBox.SelectionLength; // update text textBox.Text = value; // restore cursor position and selection textBox.SelectionStart = start; textBox.SelectionLength = length; },How to set TextBox cursor position without SelectionStart
Instantiating enums in C#. Does it has any use?, C#'s compiler doesn't complain when you instantiate an enum using new: x will then be a Foo with value Bar. Does new Foo() have any use I'm not aware of? Or am I just boxing and immediately unboxing an enum value? <code>  enum Foo{ Bar}Foo x = new Foo();,Is there any use to instantiating an enum with new?
Url.Content threw NullReferenceException," I have an MVC3 application, which is suddenly giving me some strange behavior. First some background (although I'll try to make this as brief as possible).In my controller action, I have this code: This controller action hides a fair amount of complex logic, because ListViewResult is a custom result ActionResult designed specifically for formatting JSON lists. Now, it seems that occasionally a NullReferenceException's being thrown at the line vm => Url.Content(...) and vm => Url.Action(...). This does not always happen, but if I refresh a few times, I can reliably reproduce it.UpdateAfter digging around in the source code for a while, I believe I've uncovered the offending code. The issue seems to be with the UrlRewriterHelper.WasThisRequestRewritten method which calls ServerVariables.Get(""IIS_WasUrlRewritten""). It seems that method makes use of a private field named _request which is null at this point in the code (for some reason). My best guess is that some time between the action returning and the result executing, the ServerVariables collection either looses it's internal reference to _request - OR - the ServerVariables collection is being recreated without a valid reference to _request.I've also realized that this may be an issue with IIS Express. When running under the Visual Studio Development Server, I haven't been able to duplicate the issue. I've updated the tags to reflect what think is are the most likely causes. <code>  public ActionResult Grid(ApplicationViewModel search = null){ return this.ListView( this.Find<Entity>(), this.CreateViewModel, mixins: new Dictionary<string, Func<EntityViewModel, object>>() { { ""Icon"", vm => Url.Content(""~\Images\entityType.png"") }, { ""Link"", vm => Url.Action(""Details"", vm.ControllerId) } });}EntityViewModel CreateViewModel(Entity entity);// Inherited base class methodsprotected IQueryable<T> Find<T>(); // Find T entities in DBprotected ListViewResult<TModel, TViewModel> ListView<TModel, TViewModel>( IQueriable<TModel> entityQuery, Func<TModel, TViewModel> materializeViewModel, IDictionary<string, Func<TViewModel, object>> mixins); public class ListViewResult<TModel, TViewModel> : ActionResult{ public IQueryable<TModel> ViewData { get; set; } public Func<TModel, TViewModel> Materialize { get; set; } public Dictionary<string, Func<TViewModel, object>> Mixins { get; private set; } ... public override void ExecuteResult(ControllerContext context) { // Perform sorting / paging / formatting on IQueryable ... var viewModels = this.ViewData.Select(this.Materialize); try { // another custom ActionResult for formatting JSON responses new JsonNetResult() { Data = viewModels.ToArray(), SerializerSettings = new JsonSerializerSettings() { ContractResolver = new MixinContractResolver() { Mixins = this.Mixins } } }.ExecuteResult(context); } catch (Exception e) { context.HttpContext.Response.StatusCode = 500; context.HttpContext.Response.StatusDescription = e.Message; } } private class MixinContractResolver : CamelCasePropertyNamesContractResolver { public Dictionary<string, Func<TViewModel, object>> Mixins { get; set; } private List<JsonProperty> CreateProperties(Type type, MemberSerialization memberSerialization) { List<JsonProperty> props = // get base properties foreach (var pair in this.Mixins) { props.Add(new JsonProperty() { Ignored = false, NullValueHandling = NullValueHandling.Include, Readable = true, PropertyName = Inflector.Camelize(pair.Key), PropertyType = typeof(object), ValueProvider = new DelegateValueProvider<TViewModel, object>(pair.Value), Writable = false, }); } } } private class DelegateValueProvider<T, R> : Newtonsoft.Json.Serialization.IValueProvider { private readonly Func<T, R> func; public DelegateValueProvider(Func<T, R> func) { this.func = func; } public object GetValue(object target) { return (R)this.func((T)target); } public void SetValue(object target, object value) { throw new NotSupportedException(); } }}",Request.ServerVariables throws NullReferenceException
Url.Content / Url.Action threw NullReferenceException," I have an MVC3 application, which is suddenly giving me some strange behavior. First some background (although I'll try to make this as brief as possible).In my controller action, I have this code: This controller action hides a fair amount of complex logic, because ListViewResult is a custom result ActionResult designed specifically for formatting JSON lists. Now, it seems that occasionally a NullReferenceException's being thrown at the line vm => Url.Content(...) and vm => Url.Action(...). This does not always happen, but if I refresh a few times, I can reliably reproduce it.UpdateAfter digging around in the source code for a while, I believe I've uncovered the offending code. The issue seems to be with the UrlRewriterHelper.WasThisRequestRewritten method which calls ServerVariables.Get(""IIS_WasUrlRewritten""). It seems that method makes use of a private field named _request which is null at this point in the code (for some reason). My best guess is that some time between the action returning and the result executing, the ServerVariables collection either looses it's internal reference to _request - OR - the ServerVariables collection is being recreated without a valid reference to _request.I've also realized that this may be an issue with IIS Express. When running under the Visual Studio Development Server, I haven't been able to duplicate the issue. I've updated the tags to reflect what think is are the most likely causes. <code>  public ActionResult Grid(ApplicationViewModel search = null){ return this.ListView( this.Find<Entity>(), this.CreateViewModel, mixins: new Dictionary<string, Func<EntityViewModel, object>>() { { ""Icon"", vm => Url.Content(""~\Images\entityType.png"") }, { ""Link"", vm => Url.Action(""Details"", vm.ControllerId) } });}EntityViewModel CreateViewModel(Entity entity);// Inherited base class methodsprotected IQueryable<T> Find<T>(); // Find T entities in DBprotected ListViewResult<TModel, TViewModel> ListView<TModel, TViewModel>( IQueriable<TModel> entityQuery, Func<TModel, TViewModel> materializeViewModel, IDictionary<string, Func<TViewModel, object>> mixins); public class ListViewResult<TModel, TViewModel> : ActionResult{ public IQueryable<TModel> ViewData { get; set; } public Func<TModel, TViewModel> Materialize { get; set; } public Dictionary<string, Func<TViewModel, object>> Mixins { get; private set; } ... public override void ExecuteResult(ControllerContext context) { // Perform sorting / paging / formatting on IQueryable ... var viewModels = this.ViewData.Select(this.Materialize); try { // another custom ActionResult for formatting JSON responses new JsonNetResult() { Data = viewModels.ToArray(), SerializerSettings = new JsonSerializerSettings() { ContractResolver = new MixinContractResolver() { Mixins = this.Mixins } } }.ExecuteResult(context); } catch (Exception e) { context.HttpContext.Response.StatusCode = 500; context.HttpContext.Response.StatusDescription = e.Message; } } private class MixinContractResolver : CamelCasePropertyNamesContractResolver { public Dictionary<string, Func<TViewModel, object>> Mixins { get; set; } private List<JsonProperty> CreateProperties(Type type, MemberSerialization memberSerialization) { List<JsonProperty> props = // get base properties foreach (var pair in this.Mixins) { props.Add(new JsonProperty() { Ignored = false, NullValueHandling = NullValueHandling.Include, Readable = true, PropertyName = Inflector.Camelize(pair.Key), PropertyType = typeof(object), ValueProvider = new DelegateValueProvider<TViewModel, object>(pair.Value), Writable = false, }); } } } private class DelegateValueProvider<T, R> : Newtonsoft.Json.Serialization.IValueProvider { private readonly Func<T, R> func; public DelegateValueProvider(Func<T, R> func) { this.func = func; } public object GetValue(object target) { return (R)this.func((T)target); } public void SetValue(object target, object value) { throw new NotSupportedException(); } }}",Request.ServerVariables throws NullReferenceException
Make trusted programs run without UAC prompt using task schedular programatically," There are dozens of posts questions/answers on stack and other forums about disabling/bypassing/suppressing UAC. There are solutions as well. But progmatically perhaps not. I could see only one solution Disabling UAC programmatically but perhaps there is not real programmatic solution given there.Can there be a programatic solution for saving user to be prompted everytime he/she runs a program like wamp and they always have to click yes, So it would be better to tell windows that their choice is always yes. I am sure there would be asI have found Here that windows provides this facility in Task Scheduler through GUI so it must be possible through code as well.Update : I have prepared a pure programmatic solution which is working. See my answer. <code> ",Selectively disabling UAC for specific programs on Windows Programatically
Make WAMP run without UAC prompt programatically," There are dozens of posts questions/answers on stack and other forums about disabling/bypassing/suppressing UAC. There are solutions as well. But progmatically perhaps not. I could see only one solution Disabling UAC programmatically but perhaps there is not real programmatic solution given there.Can there be a programatic solution for saving user to be prompted everytime he/she runs a program like wamp and they always have to click yes, So it would be better to tell windows that their choice is always yes. I am sure there would be asI have found Here that windows provides this facility in Task Scheduler through GUI so it must be possible through code as well.Update : I have prepared a pure programmatic solution which is working. See my answer. <code> ",Selectively disabling UAC for specific programs on Windows Programatically
Make WAMP run without UAC prompt programmatically," There are dozens of posts questions/answers on stack and other forums about disabling/bypassing/suppressing UAC. There are solutions as well. But progmatically perhaps not. I could see only one solution Disabling UAC programmatically but perhaps there is not real programmatic solution given there.Can there be a programatic solution for saving user to be prompted everytime he/she runs a program like wamp and they always have to click yes, So it would be better to tell windows that their choice is always yes. I am sure there would be asI have found Here that windows provides this facility in Task Scheduler through GUI so it must be possible through code as well.Update : I have prepared a pure programmatic solution which is working. See my answer. <code> ",Selectively disabling UAC for specific programs on Windows Programatically
(C#) How do I pass a generic type parameter to a method called from a constructor?," Here is the constructor: On the last line, where it calls ProvisionRelationship on _SecondRole, it's giving me the run-time error: Type or namespace 'T' could not be found...How do I either (a) properly assign T, or (b) pass a generic type with the constructor? I've been looking through quite a few posts, but may have missed something due to a lack of understanding. Anyone's help on this would be greatly appreciated. <code>  public PartyRoleRelationship(PartyRole firstRole, PartyRole secondRole) { if (firstRole == secondRole) throw new Exception(""PartyRoleRelationship cannot relate a single role to itself.""); if (firstRole.OccupiedBy == null || secondRole.OccupiedBy == null) throw new Exception(""One or both of the PartyRole parameters is not occupied by a party.""); // Connect this relationship with the two roles. _FirstRole = firstRole; _SecondRole = secondRole; T = _FirstRole.GetType().MakeGenericType(); _SecondRole.ProvisionRelationship<T>(_FirstRole); // Connect second role to this relationship. }",How do I pass a generic type parameter to a method called from a constructor?
XAML: specify datacontext type on listbox ItemContainer in style," In a ListBox I have a ItemContainer's IsSelected property bound to my ViewModel's IsSelected property using <ListBox.ItemContainerStyle> syntax. It works fine, but I get a Resharper warning: Cannot resolve property 'IsSelected' in data context of type ""FooSolution.BarViewModel"".How do I specify specify DataContext type on ListBox ItemContainer to get rid of this warning?Here is the code. I have a BarViewModel class: BarViewModel is assigned to DataContext in the Control which contains the ListBoxand FooViewModel as follows: and XAML like this: UpdateI've tried setting d:DataContext using a setter, as suggested by HighCore, but unfortunatelly, it doesn't help and even breaks the build: (Throws: Error 1 The tag 'DesignInstance' does not exist in XML namespace 'schemas.microsoft.com/expression/blend/2008';. Line 31 Position 50. )Update 2Finaly, the solution is to set d:DataContext on the style element itself (see my answer bellow):  <code>  public ObservableCollection<FooViewModel> FooItems { get;set; } public bool IsSelected{ get { return isSelected; } set { if (isSelected == value) { return; } isSelected = value; RaisePropertyChanged(() => IsSelected); }} <ListBox ItemsSource=""{Binding FooItems}"" SelectionMode=""Multiple""> <ListBox.ItemContainerStyle> <Style TargetType=""{x:Type ListBoxItem}""> <Setter Property=""IsSelected"" Value=""{Binding IsSelected}"" /> </Style> </ListBox.ItemContainerStyle></ListBox> <Setter Property=""d:DataContext"" Value=""{d:DesignInstance yourxmlns:yourItemViewModelClass}""/> <ListBox.ItemContainerStyle> <Style TargetType=""{x:Type ListBoxItem}"" d:DataContext=""{d:DesignInstance local:FooViewModel }""> <Setter Property=""IsSelected"" Value=""{Binding IsSelected}"" /> </Style>",Specify datacontext type on listbox ItemContainer in style
interpolate/create point between 2 points," I have been trying to figure this out for sometime now..The problem to solve..Say I have 3 Points.. What is the formula to calculate so that P3 is interpolated onto the line between P1 and P2?I need a formula that calculates new X,Y coordinates for P3 that falls on the line between P1 and P2..My code as of so far.. And my reference..http://en.wikipedia.org/wiki/Linear_interpolationThe above code gets it close, but its slightly off...Here is the converted javascript code from Corey Ogburn <code>  P1 ---------- P2, and P3 can be anywhere around P1 and P2 public Point lerp(Point P0, Point P1, Point P) { double y1 = P0.Y + (P1.Y - P0.Y) * ((P.X - P0.X) / (P1.X - P0.X)); double x1 = P.X; double y2 = P.Y; double x2 = P0.X + (P1.X - P0.X) * ((P.Y - P0.Y) / (P1.Y - P0.Y)); return new Point((x1 + x2) / 2, (y1 + y2) / 2); } public Point _pointOnLine(Point pt1, Point pt2, Point pt) { bool isValid = false; var r = new Point(0, 0); if (pt1.Y == pt2.Y && pt1.X == pt2.X) { pt1.Y -= 0.00001; } var U = ((pt.Y - pt1.Y) * (pt2.Y - pt1.Y)) + ((pt.X - pt1.X) * (pt2.X - pt1.X)); var Udenom = Math.Pow(pt2.Y - pt1.Y, 2) + Math.Pow(pt2.X - pt1.X, 2); U /= Udenom; r.Y = pt1.Y + (U * (pt2.Y - pt1.Y)); r.X = pt1.X + (U * (pt2.X - pt1.X)); double minx, maxx, miny, maxy; minx = Math.Min(pt1.X, pt2.X); maxx = Math.Max(pt1.X, pt2.X); miny = Math.Min(pt1.Y, pt2.Y); maxy = Math.Max(pt1.Y, pt2.Y); isValid = (r.X >= minx && r.X <= maxx) && (r.Y >= miny && r.Y <= maxy); return isValid ? r : new Point(); }",Projection of a point on line defined by 2 points
.NET HttpClient request header customisation," Is it possible to set the request ACCEPT header of the HttpClient in .Net/Web Api to include ""application/json;odata=verbose""?I know how to set the request media type But how do I set the odata=verbose part? I cannot seem to find any solutions online to do that.Do I have to use HttpWebRequest instead? Basically I need to call sharepoint 2013 rest api, and that odata=verbose part is required. <code>  HttpClient client = new HttpClient(handler); client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue(""application/json""));",HttpClient request header customisation
Why do we need static contructor," First of all, I got an answer in What is the use of static constructors?, but I want an answer in this context.Here is my C# static class: Inside this I have a static variable i which is initialized to 10 when it is first called. So basically it may be the purpose of a static constructor but the same thing can be achieved without declaring a static constructor by initializing the static int i = 10 which serves the same purpose that is gets initialized only once.Then why do we need a static constructor? Or am I completely wrong in understanding the concept or use of static constructors? <code>  public static class BasicClass{ static int i = 0; static BasicClass() { i = 10; } public static void Temp() { //some code } public static void Temp1() { //some code }}",Why do we need static constructors?
Using Nunit without creating seperate project," I am creating one web application which has structure as shown in following image:I have all entities and datastore files in the App_Code folder. i.e no separate project layer is created. I want to use Nunit for unit testing. But as for NUnit testing I need projectname.dll and my web application will not create dll I don't know how to test my methods.If I create a separate project for unit tests, I can not reference datastore and other files in that project. Kindly suggest how can I use Nunit in this case.  <code> ",Using Nunit without creating separate project
itextsharp table.SpacingBefore not working C#," I have a table which I'm trying to space down about 20/30 floating points (f) from the top margin of a pdf document. The reason I want to space down a bit is because I have a rectangle border running around the margin of my pdf document. table.SpacingAfter works perfectly well but table.SpacingBefore will not, my table just sits at the top margin and will not space/pad down at all. <code>  PdfPTable table = new PdfPTable(1);table.SpacingBefore = 20f;table.SpacingAfter = 20f;table.TotalWidth = 700f;table.LockedWidth = true;",iTextSharp table.SpacingBefore not working
mvc 4 Ienumeration checking if its null," I've looked about on stackoverflow for this but can't find the answer I'm looking for, its simple really. Basically I want to know how to check if my IEnumerable variable is null, my if statement just laughs at me and lets the variables pass. Here's the scenario, I have a list of data pulled from the database, this little bit is a filter function (so no [HttpPost]) that filters the content based on user input. The first thing it checks is the review list in the review database, if this returns empty I want it to check the user list in the review database.here's the code: I've messed about with it a bit, the if statement used to check if it was null, then .any(), then != null and now both, the variable just walks on by, laughing as it goes. I ran debugger and put it on a few spots. When I input a value that I know will not return results this is what the debugger says the review value is:""IEnumerable did not yield any results"" In a pathetic attempt to prevent this I even chucked that sentence in the if statement. the variable laughed so hard I swear I could hear it through my speakers.Anyways guys, if I could get the best way to do this, and why. There will be cookies. <code>  var review = from m in _db.Reviews select m; if (!String.IsNullOrEmpty(searchString)) { review = review.Where(s => s.review.Contains(searchString)); if (review != null && review.Any()) { return View(review); } else { review = review.Where(s => s.user.Contains(searchString)); return View(review); }",mvc 4 IEnumerable checking if its null
c# | what is default value of a member in an array?," I instantiate an array like this: What are the default values for those four members? Is it null, 0 or not exists? <code>  int array[] = new int[4];",What is the default value of a member in an array?
What is default value of a member in an array?," I instantiate an array like this: What are the default values for those four members? Is it null, 0 or not exists? <code>  int array[] = new int[4];",What is the default value of a member in an array?
C# Copy variable to buffer without creating garbage?," Is it possible in C# .Net (3.5 and above) to copy a variable into a byte[] buffer without creating any garbage in the process?For instance: creates the byte[] bytes intermediary object which becomes garbage (presuming a ref is no longer held to it)...I wonder if using bitwise operators the variable can be copied directly into the buffer without creating the intermediary byte[]? <code>  int variableToCopy = 9861;byte[] buffer = new byte[1024];byte[] bytes = BitConverter.GetBytes(variableToCopy);Buffer.BlockCopy(bytes, 0, buffer, 0, 4);float anotherVariableToCopy = 6743897.6377f;bytes = BitConverter.GetBytes(anotherVariableToCopy);Buffer.BlockCopy(bytes, 0, buffer, 4, sizeof(float));...",C# Copy variables into buffer without creating garbage?
c# - XPath Windows Metro App, Is there an easy way to perform XPath query's on XML in a Windows 8 metro app? System.Xml.XPath does not exist in the .NET framework used to create metro apps and after trying to use the HTMLAgilityPack I haven't been able to make any progress either.Are there an easy way to perform these query's? <code> ,Missing XPath in Windows Metro App
Ignoring a route in asp.net mvc," I am just learning to work with routing in ASP.NET MVC and am trying to understand the IgnoreRoute method.I am trying to prevent users from accessing ""Content/{filename}.html"". I have placed this as the first call in my RegisterRoutes method. Here is my code: If I try to access a link like localhost:53907/Content/Static.html, it should not allow me to display the file from what I understand so far, but it does display it.What am I doing wrong? <code>  public static void RegisterRoutes(RouteCollection routes){ routes.IgnoreRoute(""Content/{filename}.html""); routes.IgnoreRoute(""{resource}.axd/{*pathInfo}""); routes.MapRoute(""MyRoute"", ""{controller}/{action}/{id}/{*catchall}"", new { controller = ""Home"", action = ""Index"", id = UrlParameter.Optional }, new { controller = ""^.*"", action = ""^Index$|^About$"" }, new[] { ""UrlsAndRoutes.AditionalControllers"" }); routes.MapRoute(""MyRoute2"", ""{controller}/{action}/{id}/{*catchall}"", new { controller = ""Home"", action = ""Index"", id = UrlParameter.Optional }, new { controller = ""^.*"", action = ""^Index$|^About$"" }, new[] { ""UrlsAndRoutes.Controllers"" }); routes.MapRoute(""ShopSchema2"", ""Shop/OldAction"", new { controller = ""Home"", action = ""Index"" }); routes.MapRoute(""ShopSchema"", ""Shop/{action}"", new { controller = ""Home"" }); routes.MapRoute("""", ""X{controller}/{action}""); routes.MapRoute( name: """", url: ""{controller}/{action}"", defaults: new { controller = ""Home"", action = ""Index"" } );}",Ignoring a route in ASP.NET MVC
how to generate List instead of Array in C# with xsd.exe," I have an XML schema .xsd file and generate my file with all the C# classes with the xsd.exe tool. If I have a sequence of elements within an XML tag, that would be represented in C# with an array. The fail is obvious. How can I generate Lists instead of arrays?Instead of fixed size arrays in a class, I would like to use Lists. I have seen some older (very old) questions about this, but none of them provided a satisfied solution :/This is the latest useful hint: http://www.stefanbader.ch/xsdcsarr2l-exe-refactor-xsd-array-to-list/ <code>  Book [] books = new Book[someFixSize];List<Book> books = new List<Book>();",How to generate a List instead of an array in C# with xsd.exe
saving in entity framework," I have read this article and still misunderstanding key moments. Don't we need call in every Delete/Update/... operations?If I change property of any entity does SaveChanges() submitted result to database or I must manually set EntityState.Modifyed?Here is my code: <code>  _context.SaveChanges() public class Repository<T> : IRepository<T> where T : class{ private IDbContext _context; public Repository(IDbContext context) { _context = context; } private IDbSet<T> DbSet { get { return _context.Set<T>(); } } #region IRepository<T> Members public void Insert(T entity) { DbSet.Add(entity); } public void Delete(T entity) { DbSet.Remove(entity); } public IQueryable<T> SearchFor(Expression<Func<T, bool>> predicate) { return DbSet.Where(predicate); } public IQueryable<T> GetAll() { return DbSet; } public T GetById(int id) { return DbSet.Find(id); } #endregion}public interface IDbContext{ IDbSet<T> Set<T>() where T : class; int SaveChanges(); void Dispose();}",Saving in entity framework
Saving in entity framework," I have read this article and still misunderstanding key moments. Don't we need call in every Delete/Update/... operations?If I change property of any entity does SaveChanges() submitted result to database or I must manually set EntityState.Modifyed?Here is my code: <code>  _context.SaveChanges() public class Repository<T> : IRepository<T> where T : class{ private IDbContext _context; public Repository(IDbContext context) { _context = context; } private IDbSet<T> DbSet { get { return _context.Set<T>(); } } #region IRepository<T> Members public void Insert(T entity) { DbSet.Add(entity); } public void Delete(T entity) { DbSet.Remove(entity); } public IQueryable<T> SearchFor(Expression<Func<T, bool>> predicate) { return DbSet.Where(predicate); } public IQueryable<T> GetAll() { return DbSet; } public T GetById(int id) { return DbSet.Find(id); } #endregion}public interface IDbContext{ IDbSet<T> Set<T>() where T : class; int SaveChanges(); void Dispose();}",Saving in entity framework
string to char to int," I'm totally puzzled I would expect: 7*3=21But then I receive: 55*51=2805 <code>  string temp = ""73"";int tempc0 = Convert.ToInt32(temp[0]);int tempc1 = Convert.ToInt32(temp[1]);MessageBox.Show(tempc0 + ""*"" + tempc1 + ""="" + tempc0*tempc1);",Converting string or char to int
How do I solve this StackOverflowException?," I am currently writing a program to help write Lore. Every Book Object can be a parent and have children. Which means that every child can have children etc. into infinity. I was working on a ToString() method that could account for this using recursion, but I keep getting a StackOverflowException.I know what it means, but I am in doubt as to how I fix it. I am fairly new to C# but have quite a lot of Java experience, so if you know a trick or something that I've missed then please let me know!So my question is: How do I avoid a StackOverflow Exception? The problem is in GetAllChildren()EDIT:After running a test, I should get something like this: With the code from @lc. I get the following output: Here is the class: <code>  Name: aChildren:bc de Name: aChildren: No Children bce bce bce class Book{ private String name; private Book[] children; private StringBuilder text; private Boolean isParent; public Book(String name, Book[] children, StringBuilder text, Boolean isParent) { this.name = name; this.children = children; this.text = text; this.isParent = isParent; } /** * Most likely all possible Constructors * */ public Book(String name, Book[] children) : this(name, children, new StringBuilder(""No Text""), true) { } public Book(String name, String text) : this(name, new Book[0], new StringBuilder(text), false) { } public Book(String name, StringBuilder text) : this(name, new Book[0], text, false) { } public Book(String name) : this(name, new Book[0], new StringBuilder(""No Text""), false) { } public Book(Book[] children, String text) : this(""Unnamed Book"", children, new StringBuilder(text), true) { } public Book(Book[] children, StringBuilder text) : this(""Unnamed Book"", children, text, true) { } public Book(Book[] children) : this(""Unnamed Book"", children, new StringBuilder(""No Text""), true) { } public Book(StringBuilder text) : this(""Unnamed Book"", new Book[0], text, false) { } public Book() : this(""Unnamed Book"", new Book[0], new StringBuilder(""No Text""), false) { } public String Name { get { return name; } set { name = value; } } public Book[] Children { get { return children; } set { children = value; } } /** * Will Return the StringBuilder Object of this Text * */ public StringBuilder Text { get { return text; } set { text = value; } } public Boolean IsParent { get { return isParent; } set { isParent = value; } } private void GetAllChildren(Book book, StringBuilder sb) { if (book.isParent) { GetAllChildren(book, sb); } else { sb.Append(""\t""); foreach (Book b in children) { sb.Append(b.Name + ""\n""); } } } public override String ToString() { StringBuilder sChildren = new StringBuilder(""No Children""); if (children.Length != 0) { GetAllChildren(this, sChildren); } return ""Name: "" + name + ""\n"" + ""Children: "" + sChildren.ToString(); }}",StackOverflowException caused by Recursion
MongoDB: Help build query in C# driver," I stacked to build this Mongodb query in C# driver: Something next: Addition:The above query taken from my another question:MongoDB: Match multiple array elementsYou are welcome to take part in its solution. <code>  { Location: { ""$within"": { ""$center"": [ [1, 1], 5 ] } }, Properties: { $all: [ { $elemMatch: { Type: 1, Value: ""a"" } }, { $elemMatch: { Type: 2, Value: ""b"" } } ] }} var geoQuery = Query.WithinCircle(""Location"", x, y, radius);var propertiesQuery = **?**;var query = Query.And(geoQuery, propertiesQuery);",MongoDB: Build query in C# driver
Build query in C# driver," I stacked to build this Mongodb query in C# driver: Something next: Addition:The above query taken from my another question:MongoDB: Match multiple array elementsYou are welcome to take part in its solution. <code>  { Location: { ""$within"": { ""$center"": [ [1, 1], 5 ] } }, Properties: { $all: [ { $elemMatch: { Type: 1, Value: ""a"" } }, { $elemMatch: { Type: 2, Value: ""b"" } } ] }} var geoQuery = Query.WithinCircle(""Location"", x, y, radius);var propertiesQuery = **?**;var query = Query.And(geoQuery, propertiesQuery);",MongoDB: Build query in C# driver
Make chartArea take a custom percentage of chart control size," If I have a chart control with 2 chartAreas in it, the chart control by default puts the chartAreas on top of each other makes each area take 50% of the available size of the chart control.Is there a way to change the chartAreas' percent so that I could say, have the top chart take 75% of the area, and the bottom chart take 25%? <code> ",How to modify C# Chart control chartArea percentages
Windows Style don't apply in WPF," As I have multiple Windows in my application, I am looking for a solution that does not require me to set a binding on each Window.I created a ResourceDictionary which has a style for the Window Background: In my XAML, I set the ResourceDictionary: There is no error, but my Window color stays white.  <code>  <Style TargetType=""{x:Type Window}""> <Setter Property=""Background"" Value=""AliceBlue""/></Style> <Window.Resources> <ResourceDictionary> <ResourceDictionary.MergedDictionaries> <ResourceDictionary Source=""Templates.xaml"" /> </ResourceDictionary.MergedDictionaries> </ResourceDictionary></Window.Resources>",Windows Style from ResourceDictionary don't apply
What is the simplest way to write the contents of a StringBuilder to a text file on in .NET 1.1?," I have to use StringBuilder instead of a List of strings because of being stuck with .NET 1.1 for this project. I want to write a series of debug messages I've written to a file to study at my leisure, as there is too much to see on the screen (the MessageBox doesn't have scrollbars). Some of the easy ways to write a file don't seem to be available in .NET 1.1. I also don't have access to Environment.Newline to cleanly separate the lines I append (AppendLine is not available in this archaic version of StringBuilder, either).What is the easiest way in .NET 1.1 (C#) to write out the contents of the StringBuilder to a file? There is no ""C"" drive on the handheld device, so I reckon I will have to write it to ""\hereIAm.txt"" or something. <code> ",What is the simplest way to write the contents of a StringBuilder to a text file in .NET 1.1?
Should method that get Task and passes it after await it?, I have two following methods Should second method be marked with async/await keywords or not? <code>  public async Task<bool> DoSomething(CancellationToken.token) { //do something async}//overload with None token public /*async*/ Task<bool> DoSomething(){ return /*await*/ DoSomething(CancellationToken.None);},Should method that get Task and passes it away await it?
Cannot start an external process from mono app on mac," I'm successfully using System.Diagnostics.Process.Start() to start my external mono executable on windows. However it fails on mac. I'm not getting any error, simply nothing at all happens.I tried doing it the following way: Also I've tried opening terminal like the following (which also failed): The only thing I was able to do is launch the Terminal in the following way: Any ideas? I would really appreciate any help.Thanks! <code>  System.Diagnostics.Process.Start(""mono"", ""/path/program.exe""); System.Diagnostics.Process.Start(""Terminal""); System.Diagnostics.Process.Start(""open"", ""-a Terminal"");",Start an external process on mac with c#
Remove Signing from assembly," I have a project open in Visual Studio (it happens to be Enyim.Caching). This assembly wants to be delay-signed. In fact, it desires so strongly to be delay-signed, that I am unable to force Visual studio to compile it without delay signing.I have unchecked ""Delay sign only"" and ""Sign the assembly"" on the Visual Studio project properties box, and rebuilt. The assembly is still marked for delay sign (as shown by sn.exe -v).I have unloaded the project and verified that the signing is set to false. When reloading the project, the check boxes for ""Sign"" and ""Delay Sign"" are checked.I have verified that no attributes are present in the AssemblyInfo (or elsewhere) that would cause this.I have searched the Internet for a solution, but have found none.How can I do this? <code> ",Remove signing from an assembly
How to redirect the action to othere area with model as parmenter," I am on Admin area now want to send the values to Account Controller which is in default area how i can send this is my other action in Account Controller where i want to redirect my code  <code>  ChangePasswordModel mode = new ChangePasswordModel(); mode.ConfirmPassword = password; mode.NewPassword = password; mode.OldPassword = user.Password; return RedirectToAction(""ChangePassword"", ""Account"",new { area = '/' } , new {model = mode}); [Authorize] [HttpPost] public ActionResult ChangePassword(ChangePasswordModel model) { if (ModelState.IsValid) { // ChangePassword will throw an exception rather // than return false in certain failure scenarios. bool changePasswordSucceeded; try { MembershipUser currentUser = Membership.GetUser(User.Identity.Name, true /* userIsOnline */); changePasswordSucceeded = currentUser.ChangePassword(model.OldPassword, model.NewPassword); } catch (Exception) { changePasswordSucceeded = false; } if (changePasswordSucceeded) { return RedirectToAction(""ChangePasswordSuccess""); } else { ModelState.AddModelError("""", ""The current password is incorrect or the new password is invalid.""); } } // If we got this far, something failed, redisplay form return View(model); }",Redirect action to action in other area with model as parmenter
delete items from listview in c#," I need to delete items from a ListView, the code I am looking for will show a MessageBox to confirm and if no item is selected it will show an error MessageBoxThis is my code and it is not working :( The error is not in delete but, in MessageBox's I have two MessageBox's, error must be shown first before confirmation. <code>  private void button2_Click(object sender, EventArgs e){ if (listView1.SelectedItems != null) { var confirmation = MessageBox.Show( ""Voulez vous vraiment supprimer les stagiaires slctionns?"", ""Suppression"", MessageBoxButtons.YesNo, MessageBoxIcon.Question ); if (confirmation == DialogResult.Yes) { for (int i = 0; i < listView1.Items.Count; i++) { if (listView1.Items[i].Selected) { listView1.Items[i].Remove(); i--; } } } } else { MessageBox.Show(""aucin stagiaire selectionnes"", ""erreur"", MessageBoxButtons.OK, MessageBoxIcon.Error); }}",Delete Items from ListView in C#
Lamba Expression Not in?," I have a detailcollection collection in which every detail has And a string with some codes I know I can get an array using string.Split() But how can I get products not in codes? I would like something like: <code>  code, price, name string codes = ""1,2,3""; string[] codesarray = codes.Split(','); // the idea I have, but I would not like to have a loopfor (int i = 0; i < codesarray.Length; i++){ detailcollection.Where(x => x.ope_idsku == codesarray[i])} detailcollection.Where(x => x.ope_idsku not in (codesarray))","Lambda Expression for ""not in""?"
How to count of substirng occurences in C#?," Suppose I have a string like: then I want to know how many time of occurrences of sub-string ""OU="" in this string. With single char, maybe there is something like: but Split only works for char, not string.Also how to find the position of n occurrences? For example, the position of 2nd ""OU="" in the string?How to resolve this issue? <code>  MyString = ""OU=Level3,OU=Level2,OU=Level1,DC=domain,DC=com""; int count = MyString.Split(""OU="").Length - 1;",How to count of sub-string occurrences?
How to count of sub-string occurrences in C#?," Suppose I have a string like: then I want to know how many time of occurrences of sub-string ""OU="" in this string. With single char, maybe there is something like: but Split only works for char, not string.Also how to find the position of n occurrences? For example, the position of 2nd ""OU="" in the string?How to resolve this issue? <code>  MyString = ""OU=Level3,OU=Level2,OU=Level1,DC=domain,DC=com""; int count = MyString.Split(""OU="").Length - 1;",How to count of sub-string occurrences?
C# Template Functions," Seeking some help on C# generics. I am working in Unity3D and am rolling a BiLerp function as Unity3D doesn't have one. However, I would like to make this function a little more robust.I would like to make it generic so that it takes in any type which can be multiplied by a floatI am unsure as to whether or not I should make this static. I am assuming that as it does not use any member variable then yes. Should the class that this is stored in also be static, the class will just be for math helpers omitted by unity (Matrix2x2) etc.How does C# const work in this instance?In C++ I would pass the parameters by reference. I I correct in assuming that C# is already doing this? and that the ref keyword is some other dark magic tool?If there is any other suggestions then please feel free. I have only been working in C# for 6 weeks now and could use any suggestions. <code>  public Vector3 BiLerp(Vector2 _uv, Vector3 _00, Vector3 _01, Vector3 _10, Vector3 _11){ return _00 * (1 - _uv.x) * (1 - _uv.y) + _10 * _uv.x * (1 - _uv.y) + _01 * _uv.y * (1 - _uv.x) + _11 * _uv.x * _uv.y;}",C# Generic Functions
How To Put delay before doing an operation in wpf," I tried to use the below code to make a 2 second delay before navigating to the next window. But the thread is invoking first and the textblock gets displayed for a microsecond and landed into the next page. I heard a dispatcher would do that. Here is my snippet: <code>  tbkLabel.Text = ""two mins delay"";Thread.Sleep(2000);Page2 _page2 = new Page2();_page2.Show();",How to put delay before doing an operation in WPF
"WebRequest.Create throws ""The specified registry key does not exist."""," I am calling this line of code to get to the azure server: and receive this exception.Does anybody know how to manage with it? <code>  var request = (HttpWebRequest)WebRequest.Create(uri); mscorlib.dll!Microsoft.Win32.RegistryKey.Win32Error(int errorCode, string str) + 0x189 bytes mscorlib.dll!Microsoft.Win32.RegistryKey.GetValueKind(string name) + 0x7f bytes System.dll!System.Net.HybridWebProxyFinder.InitializeFallbackSettings() + 0xb8 bytes System.dll!System.Net.HybridWebProxyFinder.HybridWebProxyFinder() + 0x1e bytes [Native to Managed Transition] [Managed to Native Transition] System.dll!System.Net.HybridWebProxyFinder.HybridWebProxyFinder(System.Net.AutoWebProxyScriptEngine engine) + 0x37 bytes System.dll!System.Net.AutoWebProxyScriptEngine.AutoWebProxyScriptEngine(System.Net.WebProxy proxy, bool useRegistry) + 0x190 bytes System.dll!System.Net.WebProxy.UnsafeUpdateFromRegistry() + 0x67 bytes System.dll!System.Net.WebProxy.WebProxy(bool enableAutoproxy) + 0x44 bytes System.dll!System.Net.Configuration.DefaultProxySectionInternal.DefaultProxySectionInternal(System.Net.Configuration.DefaultProxySection section) + 0x3d9 bytes System.dll!System.Net.Configuration.DefaultProxySectionInternal.GetSection() + 0xbe bytes System.dll!System.Net.WebRequest.InternalDefaultWebProxy.get() + 0x7e bytes System.dll!System.Net.HttpWebRequest.HttpWebRequest(System.Uri uri, System.Net.ServicePoint servicePoint) + 0x18d bytes System.dll!System.Net.HttpRequestCreator.Create(System.Uri Uri) + 0x50 bytes System.dll!System.Net.WebRequest.Create(System.Uri requestUri, bool useUriBase) + 0x2ec bytes System.dll!System.Net.WebRequest.Create(string requestUriString) + 0xa3 bytes ","WebRequest.Create throws IOException ""The specified registry key does not exist."""
Finding the intersection of a line," So I've been banging my head over this relatively simple algorithm. I'm not sure what's wrong in my code yet I'm not getting the intersection point where they are actually intersecting.I'm using Unity3D and I'm trying to find the point where two lines intersect, in the x,z plane though not in the x, y plane. I am assuming that the algorithm which works for x,y should work for x,z;My code: Can anyone help into pointing out what I'm doing wrong? thisCar.forward and threateningCar.forward are usually either [0,0,1], [0,0,-1] or [1,0,0], [-1,0,0] <code>  Vector3 thisPoint1 = thisCar.position + (2 * thisCar.forward);Vector3 thisPoint2 = thisCar.position + (20 * thisCar.forward);Debug.DrawLine(thisPoint1, thisPoint2, Color.white, 2);Vector3 otherPoint1 = threateningCar.position + (2 * threateningCar.forward);Vector3 otherPoint2 = threateningCar.position + (20 * threateningCar.forward);Debug.DrawLine(otherPoint1, otherPoint2, Color.white, 2);float A1 = thisPoint2.z - thisPoint1.z;float B1 = thisPoint1.x - thisPoint2.x;float C1 = A1 * thisPoint1.x + B1 * thisPoint1.z;float A2 = otherPoint2.z - otherPoint1.z;float B2 = otherPoint1.x - otherPoint2.x;float C2 = A2 * otherPoint1.z + B2 * otherPoint1.z;float det = A1 * B2 - A2 * B1;float x = (B2 * C1 - B1 * C2) / det;float z = (A1 * C2 - A2 * C1) / det;return new Vector3(x, this.transform.position.y, z);",Finding the intersection between two lines
Hiding default gray clumn in datagrid winform," Is there any way to remove or hide winform's datagrid gray area when data is not avaiable?Second this how to remove/hide the default gray column? I'm hiding useless columns like this but unable to find way to hide these. <code>  dataGridView1.DataSource = oresult; dataGridView1.Columns[""Id""].Visible = false; dataGridView1.Columns[""AddedBy""].Visible = false; dataGridView1.Columns[""AddmissionInClass""].Visible = false; dataGridView1.Columns[""IsDeleted""].Visible = false; dataGridView1.Enabled = false;",Hiding default gray column in datagridview winform
Hiding default gray column in datagrid winform," Is there any way to remove or hide winform's datagrid gray area when data is not avaiable?Second this how to remove/hide the default gray column? I'm hiding useless columns like this but unable to find way to hide these. <code>  dataGridView1.DataSource = oresult; dataGridView1.Columns[""Id""].Visible = false; dataGridView1.Columns[""AddedBy""].Visible = false; dataGridView1.Columns[""AddmissionInClass""].Visible = false; dataGridView1.Columns[""IsDeleted""].Visible = false; dataGridView1.Enabled = false;",Hiding default gray column in datagridview winform
aps.net mvc and generating controller method types that are compilable," Is there a way to create a strongly typed controller action? For example:In a Controller I use: I would like to use: I do not want to re-invent the wheel. I am sure someone has some clever solution. This would allow me to add compile time checking to controller methods. <code>  aClientLink = Url.Action(""MethodName"", ""ControllerName"", new { Params... }); aClientLink = Url.Action(Controller.MethodName,ControllerName);",Compile-time checking for action links to controller methods
Ggenerating controller method types that are compilable," Is there a way to create a strongly typed controller action? For example:In a Controller I use: I would like to use: I do not want to re-invent the wheel. I am sure someone has some clever solution. This would allow me to add compile time checking to controller methods. <code>  aClientLink = Url.Action(""MethodName"", ""ControllerName"", new { Params... }); aClientLink = Url.Action(Controller.MethodName,ControllerName);",Compile-time checking for action links to controller methods
Issue with Version Class in C#," I am getting the value versionNo = 2.1, but I want it as 2.01.Any suggestions, please? <code>  var versionNo = new System.Version(""2.01"");",How can I prevent System.Version from removing leading zeroes?
is not marked as serializable.," The error I'm getting is: here is my code:I have a gridview, that uses the following DataSource: I set the session variable in my page load like so: My user class looks like this: I can't understand why it's breaking, can I use it without making it serializable?I tried to debug, and the session variable sets just fine, it then goes into the GetOrgList and returned correct results, but the page does not load and I get the error above.Here is a snippet of my GetOrgList function: <code>  Type 'OrgPermission' in Assembly 'App_Code.ptjvczom, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null' is not marked as serializable. <asp:ObjectDataSource ID=""ObjectDataSource1"" runat=""server"" SelectMethod=""GetOrgList"" TypeName=""Org""> <SelectParameters> <asp:SessionParameter Name=""orgCodes"" SessionField=""UserOrgs"" Type=""Object"" /> <asp:Parameter DefaultValue=""Y"" Name=""active"" Type=""String"" /> </SelectParameters> </asp:ObjectDataSource> User cUser = new User(userid);//make sure the user is an AdminList<OrgPermission> orgs = new List<OrgPermission>();foreach(OrgPermission org in cUser.orgs) { if (org.type=='admin') { orgs.Add(org); } }Session[""UserOrgs""] = orgs; public class OrgPermission{ public string Org { get; set; } public List<string> type { get; set; } public OrgPermission() { } }public class cUser{ public string userid { get; set; } public List<OrgPermission> orgs { get; set; } public clsUser(string username) { //i set everything here }} public DataTable GetOrgList(List<OrgPermission> orgCodes, string active) { string orgList = null; //code to set OrgList using the parameter is here. DataSet ds = new DataSet(); SqlConnection conn = new SqlConnection(cCon.getConn()); SqlCommand cmd = new SqlCommand(""sp_GetOrgList"", conn); cmd.CommandType = CommandType.StoredProcedure; cmd.Parameters.Add(new SqlParameter(""@orgList"", orgList)); cmd.Parameters.Add(new SqlParameter(""@active"", active)); conn.Open(); SqlDataAdapter sqlDA = new SqlDataAdapter(); sqlDA.SelectCommand = cmd; sqlDA.Fill(ds); conn.Close(); return ds.Tables[0]; }",Error - is not marked as serializable
It's not marked as serializable," The error I'm getting is: here is my code:I have a gridview, that uses the following DataSource: I set the session variable in my page load like so: My user class looks like this: I can't understand why it's breaking, can I use it without making it serializable?I tried to debug, and the session variable sets just fine, it then goes into the GetOrgList and returned correct results, but the page does not load and I get the error above.Here is a snippet of my GetOrgList function: <code>  Type 'OrgPermission' in Assembly 'App_Code.ptjvczom, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null' is not marked as serializable. <asp:ObjectDataSource ID=""ObjectDataSource1"" runat=""server"" SelectMethod=""GetOrgList"" TypeName=""Org""> <SelectParameters> <asp:SessionParameter Name=""orgCodes"" SessionField=""UserOrgs"" Type=""Object"" /> <asp:Parameter DefaultValue=""Y"" Name=""active"" Type=""String"" /> </SelectParameters> </asp:ObjectDataSource> User cUser = new User(userid);//make sure the user is an AdminList<OrgPermission> orgs = new List<OrgPermission>();foreach(OrgPermission org in cUser.orgs) { if (org.type=='admin') { orgs.Add(org); } }Session[""UserOrgs""] = orgs; public class OrgPermission{ public string Org { get; set; } public List<string> type { get; set; } public OrgPermission() { } }public class cUser{ public string userid { get; set; } public List<OrgPermission> orgs { get; set; } public clsUser(string username) { //i set everything here }} public DataTable GetOrgList(List<OrgPermission> orgCodes, string active) { string orgList = null; //code to set OrgList using the parameter is here. DataSet ds = new DataSet(); SqlConnection conn = new SqlConnection(cCon.getConn()); SqlCommand cmd = new SqlCommand(""sp_GetOrgList"", conn); cmd.CommandType = CommandType.StoredProcedure; cmd.Parameters.Add(new SqlParameter(""@orgList"", orgList)); cmd.Parameters.Add(new SqlParameter(""@active"", active)); conn.Open(); SqlDataAdapter sqlDA = new SqlDataAdapter(); sqlDA.SelectCommand = cmd; sqlDA.Fill(ds); conn.Close(); return ds.Tables[0]; }",Error - is not marked as serializable
thread.sleap in asp.net," I'm simulating the comet live feed protocol for my site, so in my controller I'm adding: But I noticed the whole website got slow after I added this feature. After debugging I concluded that when I call Thread.Sleep all the threads, even in other requests, are being blocked.Why does Thread.Sleep block all threads, not just the current thread, and how should I deal with an issue like this? <code>  while(nothing_new && before_timeout){ Thread.Sleep(1000);}",thread.sleep in asp.net
Binding a property that hides another in WinRT XAML," right up front i want to say: please don't suggest alternative solutions, unless you can accomplish it without modifying the Types that are of the pattern BaseXXXXXXthat said, this behavior goes way beyond perplexing as far as I am concerned, it would seem that using the new keyword in order to hide a property in C# means that WinRT XAML (Windows8, Metro, Windows Store App) binding no longer functions correctly. I have no idea why this is.Here is an example:C#: WinRT XAML: The all-too-incorrect result looks something like:basically, every one of those blank lines should be filled do any of you XAML hotshots have any idea why these bindings are failing and is there anything that can be done to work around what I can only assume is a heinous bug? Any help or insight would be greatly appreciated, thank you in advance... -ckupdate: the output dump i forgot Update:Bug filed with Microsoft: https://connect.microsoft.com/VisualStudio/feedback/details/782993/binding-a-property-that-hides-another-in-winrt-xaml so we'll see how that goes <code>  namespace WinRtSandbox{ public class BaseClass { public string Property1 { get; set; } public int[] Property2 { get; set; } public object Property3 { get; set; } } public class ModifiedClass : BaseClass { public new string Property1 { get; set; } public new long[] Property2 { get; set; } public new string Property3 { get; set; } } public sealed partial class MainPage : Page { public BaseClass Normal { get; set; } public ModifiedClass Modified { get; set; } public MainPage() { this.Normal = new BaseClass { Property1 = ""WTF"", Property2 = new[] { 2, 3, 4 }, Property3 = ""Work?"" }; this.Modified = new ModifiedClass { Property1 = ""WTF"", Property2 = new[] { 2L, 3L, 4L }, Property3 = ""Work?"" }; this.InitializeComponent(); } }} <Page x:Class=""WinRtSandbox.MainPage"" xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" xmlns:local=""using:WinRtSandbox"" xmlns:d=""http://schemas.microsoft.com/expression/blend/2008"" xmlns:mc=""http://schemas.openxmlformats.org/markup-compatibility/2006"" DataContext=""{Binding RelativeSource={RelativeSource Self}}"" mc:Ignorable=""d""> <Grid Background=""{StaticResource ApplicationPageBackgroundThemeBrush}""> <Border Background=""#22000000"" Padding=""40"" Width=""400"" Height=""500""> <Grid> <Grid.Resources> <Style TargetType=""Rectangle""> <Setter Property=""Height"" Value=""1""/> <Setter Property=""HorizontalAlignment"" Value=""Stretch""/> <Setter Property=""Margin"" Value=""0,15,0,15""/> <Setter Property=""Fill"" Value=""{StaticResource ApplicationForegroundThemeBrush}""/> </Style> </Grid.Resources> <Grid.ColumnDefinitions> <ColumnDefinition/> <ColumnDefinition/> </Grid.ColumnDefinitions> <StackPanel Grid.Column=""0""> <ItemsControl> <TextBlock Text=""this.Normal""/> <Rectangle/> <TextBlock Text=""this.Normal.Property1""/> <Rectangle/> <TextBlock Text=""this.Normal.Property2""/> <Rectangle/> <TextBlock Text=""this.Normal.Property3""/> </ItemsControl> <Rectangle Fill=""Red""/> <ItemsControl> <TextBlock Text=""this.Modified""/> <Rectangle/> <TextBlock Text=""this.Modified.Property1""/> <Rectangle/> <TextBlock Text=""this.Modified.Property2""/> <Rectangle/> <TextBlock Text=""this.Modified.Property3""/> </ItemsControl> </StackPanel> <StackPanel Grid.Column=""1""> <ItemsControl DataContext=""{Binding Normal}""> <TextBlock Text=""{Binding}""/> <Rectangle/> <TextBlock Text=""{Binding Property1}""/> <Rectangle/> <TextBlock Text=""{Binding Property2}""/> <Rectangle/> <TextBlock Text=""{Binding Property3}""/> </ItemsControl> <Rectangle Fill=""Red""/> <ItemsControl DataContext=""{Binding Modified}""> <TextBlock Text=""{Binding}""/> <Rectangle/> <TextBlock Text=""{Binding Property1}""/> <Rectangle/> <TextBlock Text=""{Binding Property2}""/> <Rectangle/> <TextBlock Text=""{Binding Property3}""/> </ItemsControl> </StackPanel> </Grid> </Border> </Grid></Page> Error: BindingExpression path error: 'Property2' property not found on 'WinRtSandbox.ModifiedClass'. BindingExpression: Path='Property2' DataItem='WinRtSandbox.ModifiedClass'; target element is 'Windows.UI.Xaml.Controls.TextBlock' (Name='null'); target property is 'Text' (type 'String')Error: BindingExpression path error: 'Property3' property not found on 'WinRtSandbox.ModifiedClass'. BindingExpression: Path='Property3' DataItem='WinRtSandbox.ModifiedClass'; target element is 'Windows.UI.Xaml.Controls.TextBlock' (Name='null'); target property is 'Text' (type 'String')","Binding a property that hides another in WinRT XAML (Windows8, Metro, Windows Store App)"
Convert Json string to List of obejcts," I am getting a string with json objects from an external webapi. I have a code that gets the objects into a ExpandoObject list, but there must be another solution without using dynamic object.Here is the code: Here is a sample of the json string: <code>  System.Net.HttpWebRequest request = (System.Net.HttpWebRequest)System.Net.WebRequest.Create(""https://example.com/api/users.json"");request.Credentials = System.Net.CredentialCache.DefaultCredentials;request.Headers[""Authorization""] = ""API key=""+somekey;// Ignore Certificate validation failures (aka untrusted certificate + certificate chains)System.Net.ServicePointManager.ServerCertificateValidationCallback = ((sender, certificate, chain, sslPolicyErrors) => true);System.Net.HttpWebResponse response = (System.Net.HttpWebResponse)request.GetResponse();Stream resStream = response.GetResponseStream();StreamReader reader = new StreamReader(resStream);//response from the apistring responseFromServer = reader.ReadToEnd();//serialize the datavar jss = new System.Web.Script.Serialization.JavaScriptSerializer();System.Collections.IList users = (System.Collections.IList)((IDictionary<string, object>)((IDictionary<string, object>)jss.DeserializeObject(responseFromServer))[""data""])[""users""];List<System.Dynamic.ExpandoObject> api_users = new List<System.Dynamic.ExpandoObject>();//putting the expandable objects in listforeach (var u in users){ var user = ((Dictionary<string, object>)((IDictionary<string, object>)u)[""User""]); dynamic data = new System.Dynamic.ExpandoObject(); //putting the user attributes into dynamic object foreach (var prop in user) { ((IDictionary<String, Object>)data).Add(prop.Key, prop.Value); } api_users.Add(data);} ""data"": { ""users"": [ { ""User"": { ""user_id"": ""6741"", ""email"": ""mail@mail.com"", ""first_name"": ""Mark"", ""last_name"": ""Plas"", ""street_address"": """", ""post_code"": """", ""city"": """" }, ""CreatedBy"": { ""id"": null, ""name"": null }, ""ModifiedBy"": { ""id"": null, ""name"": null } },...(can have more users here)",Convert Json string to List of objects
how to detect if a device is USB 3.0," Does anyone know a way to detect if a USB device connected to a USB 3.0 host port is running at 3.0 or 2.0 using C#? We are manufacturing USB 3.0 extension cables and we need to verify that all the pins have been soldered correctly. We would like to do this in software. We would like to connect a 3.0 thumb drive to the cable and check if the device is operating in USB 3.0 mode. If it is in 2.0 mode, we know their is a problem with 1 or more of the USB 3.0 lines. <code> ",Detect if device is using USB 3.0
What is the best way of automating Windows Service(Created using C# in Visual Studio 2010) Deployment using TFS?," I have created a windows service using C# in Visual Studio 2010. I did a lot of research about automating the installation process. Got lots of advice but none did work for me. The windows service i have created has lots of dependencies and i would like client to have no UI interaction during the installation. I have created a setup project for this which includes all my dependencies within the installer. Process involved:Create a build for windows servicePush the setup file (.msi) to remote locationCall the .msi and install the service silently without user interaction.What i did so far:Created a powershell script to push files to remote locationExecute powershell script and install the servicePlease keep in mind that powershell script is used for installing service from a project directory not for installing .msi file created using Setup Project these are two vast different things. If you don't understand this don't answer please.Possible solutions:Use (http://www.msbuildextensionpack.com/help/4.0.5.0/html/258a18b7-2cf7-330b-e6fe-8bc45db381b9.htm) msbuild extension pack.Use buildarguments to call msbuild extension pack to install windows service. Use (http://msdn.microsoft.com/en-us/library/x8zx72cd.aspx) Exec TaskUse WIX(Windows Installer Xml)Now my question is. How can i push windows service installer to remote location? And how can create custom build arguments and use either msbuild extension pack or Exec Task and install the service?I know this sounds stupid and irritating question for someone who hasn't installed the service using (.MSI) created by the Setup Project. But its my requirements which i am trying to solve since weeks in the enterprise environment. <code>  sc create ""servicename"" binpath=""somepath""",What is the best way of automating Windows Service deployment?
Is it possible to have a REST querystring with an ampersand?," Using the System.ServiceModel libraries for routing, I have a REST service with a simple template that looks like ""{searchTerm}?opt={someSearchOpt}So the call would look like: http://myhost.contoso.com/searchapi/river%20expeditionsto search for the phrase ""river expeditions"" with no options.This simply accepts a search phrase and returns results. It works just fine. However, if searching for a phrase that contains a literal ampersand, such as ""Lewis&Clark"", i tried the obvious of url encoding the ampersand Lewis%26Clarkbut even so the request is never even routed, but the server immediately returns a 400 Bad Request. It is clear that it is being interpreted as a query string delimiter, and makes the request invalid since this particular template is expecting a url parameter and has no preceeding '?' delimiter. Since these search phrases may have other restricted characters, they are expected to by url encoded by the client, and when they are successfully routed, the REST api calls HttpUtility.UrlDecode on the parameter. So my question is really if there is some technique to getting a url encoded ampersand correctly routed as a rest url parameter and not pre-emptively interpreted and rejected as a query string delimiter?Update: For the record, if the search term were expected as a query string parameter (not a url parameter), sending Lewis%26Clark works fine. For example http://myhost.contoso.com/searchapi?searchTerm=lewis%26clarkSo to clarify, I am looking to get the same result when using a url parameter in a REST template. <code> ",Is it possible to have a REST url parameter with an ampersand?
Entity Framework Issue," I am new to Entity Framework.I have get to some values in my database using EF. It returns perfectly, and the values are shown in labels. But When I delete all values in my table (without using EF), the EF query is returning my old values. I know the EF stores the values in cache and returns the cached data for subsequent runs. Is this correct? So how can I solve the problem when I have deleted all values in my database, but EF returns the old values?Edit:Now i used datamodel.SaveChanges(). But now also it's returning the same old values.My sample query is look like below: <code>  SchoolBriefcaseEntities datamodel = new SchoolBriefcaseEntities();datamodel.SaveChanges();List<Compliance> compliance=new List<Compliance>();IList<ComplianceModel> complianceModel;if (HttpContext.Current.User.IsInRole(""SuperAdmin"")){ compliance = datamodel.Compliances.Where(c => c.School.DistrictId == districtId).ToList();}",Entity Framework Caching Issue
how to make DataMember to accept null," When I deserialize my jsonstring ,I am getting error message This is my JsonString Data contracts This is the Deserializer I use When I deserialize the bove jsonstring ,I am getting error message Any suggestions to resolve this error? <code>  There was an error deserializing the object of type RecordInfo. End element 'Warning' from namespace '' expected. Found element 'item' from namespace ''. public const string jsonString = @"" { """"RequestId"""":514106, """"Warning"""":[], """"CustomerData"""": { """"Email"""":""""abc@abc.com"""", """"FullName"""":""""OrTguOfE"""", """"OrderData"""":[] } }""; [DataContract] public class RecordInfo { [DataMember(Name = ""RequestId"")] public string RequestId { get; set; } [DataMember(Name = ""Warning"")] public string Warning { get; set; } [DataMember(Name = ""CustomerData"")] public CustomerData CustomerData { get; set; } } [DataContract] public class CustomerData { [DataMember(Name = ""Email"")] public string RequestId { get; set; } [DataMember(Name = ""FullName"")] public string FullName { get; set; } [DataMember(Name = ""OrderData"")] public OrderData[] OrderData { get; set; } }[DataContract] public class OrderData { [DataMember(Name = ""OrderId"")] public string OrderId { get; set; } [DataMember(Name = ""SourceId"")] public string SourceId { get; set; } [DataMember(Name = ""SourceData"")] public SourceData[] SourceData { get; set; } } [DataContract] public class SourceData { [DataMember(Name = ""SourceDescription"")] public string SourceDescription { get; set; } [DataMember(Name = ""ProductName"")] public string ProductName { get; set; } }} private static T Deserialize<T>(string jsonString) { using (var ms = new MemoryStream(Encoding.Unicode.GetBytes(jsonString))) { var serializer = new DataContractJsonSerializer(typeof(T)); return (T)serializer.ReadObject(ms); } } There was an error deserializing the object of type RecordInfo. End element 'Warning' from namespace '' expected. Found element 'item' from namespace ''.",error deserializing the object of type .... End element '......' from namespace '' expected. Found element 'item' from namespace ''
"In C#, why can't I do a .distinct() but still return the parent class?"," I have a number of classes that derive from a class BaseClass where BaseClass just has an `Id property.I now need to do distinct on a collections of some of these objects. I have the following code over and over for each of the child classes: Given the logic is just based on Id, I wanted to created a single comparer to reduce duplication: But this doesn't seem to compile: ...as it says it can't convert from BaseClass to Position. Why does the comparer force the return value of this Distinct() call? <code>  public class PositionComparer : IEqualityComparer<Position>{ public bool Equals(Position x, Position y) { return (x.Id == y.Id); } public int GetHashCode(Position obj) { return obj.Id.GetHashCode(); }} public class BaseClassComparer : IEqualityComparer<BaseClass>{ public bool Equals(BaseClass x, BaseClass y) { return (x.Id == y.Id); } public int GetHashCode(BaseClass obj) { return obj.Id.GetHashCode(); }} IEnumerable<Position> positions = GetAllPositions(); positions = allPositions.Distinct(new BaseClassComparer())","Doing Distinct() using base class IEqualityComparer, and still return the child class type?"
Why can't I do a .distinct() but still return the parent class?," I have a number of classes that derive from a class BaseClass where BaseClass just has an `Id property.I now need to do distinct on a collections of some of these objects. I have the following code over and over for each of the child classes: Given the logic is just based on Id, I wanted to created a single comparer to reduce duplication: But this doesn't seem to compile: ...as it says it can't convert from BaseClass to Position. Why does the comparer force the return value of this Distinct() call? <code>  public class PositionComparer : IEqualityComparer<Position>{ public bool Equals(Position x, Position y) { return (x.Id == y.Id); } public int GetHashCode(Position obj) { return obj.Id.GetHashCode(); }} public class BaseClassComparer : IEqualityComparer<BaseClass>{ public bool Equals(BaseClass x, BaseClass y) { return (x.Id == y.Id); } public int GetHashCode(BaseClass obj) { return obj.Id.GetHashCode(); }} IEnumerable<Position> positions = GetAllPositions(); positions = allPositions.Distinct(new BaseClassComparer())","Doing Distinct() using base class IEqualityComparer, and still return the child class type?"
"Why can't I do a .distinct() using IEqualityComparer() on a baseclass, but still return the parent class?"," I have a number of classes that derive from a class BaseClass where BaseClass just has an `Id property.I now need to do distinct on a collections of some of these objects. I have the following code over and over for each of the child classes: Given the logic is just based on Id, I wanted to created a single comparer to reduce duplication: But this doesn't seem to compile: ...as it says it can't convert from BaseClass to Position. Why does the comparer force the return value of this Distinct() call? <code>  public class PositionComparer : IEqualityComparer<Position>{ public bool Equals(Position x, Position y) { return (x.Id == y.Id); } public int GetHashCode(Position obj) { return obj.Id.GetHashCode(); }} public class BaseClassComparer : IEqualityComparer<BaseClass>{ public bool Equals(BaseClass x, BaseClass y) { return (x.Id == y.Id); } public int GetHashCode(BaseClass obj) { return obj.Id.GetHashCode(); }} IEnumerable<Position> positions = GetAllPositions(); positions = allPositions.Distinct(new BaseClassComparer())","Doing Distinct() using base class IEqualityComparer, and still return the child class type?"
"Why can't I do a .distinct() using IEqualityComparer() on a base class, but still return the child class?"," I have a number of classes that derive from a class BaseClass where BaseClass just has an `Id property.I now need to do distinct on a collections of some of these objects. I have the following code over and over for each of the child classes: Given the logic is just based on Id, I wanted to created a single comparer to reduce duplication: But this doesn't seem to compile: ...as it says it can't convert from BaseClass to Position. Why does the comparer force the return value of this Distinct() call? <code>  public class PositionComparer : IEqualityComparer<Position>{ public bool Equals(Position x, Position y) { return (x.Id == y.Id); } public int GetHashCode(Position obj) { return obj.Id.GetHashCode(); }} public class BaseClassComparer : IEqualityComparer<BaseClass>{ public bool Equals(BaseClass x, BaseClass y) { return (x.Id == y.Id); } public int GetHashCode(BaseClass obj) { return obj.Id.GetHashCode(); }} IEnumerable<Position> positions = GetAllPositions(); positions = allPositions.Distinct(new BaseClassComparer())","Doing Distinct() using base class IEqualityComparer, and still return the child class type?"
How can i bind a xaml property to a static variable in another class?," I have this xaml file in which I try to bind a Text-block Background to a static variable in another class, how can I achieve this ?I know this might be silly but I just moved from Win-forms and feeling a little bit lost.here is what I mean: <code>  <TextBlock Text=""some text"" TextWrapping=""WrapWithOverflow"" Background=""{Binding Path=SomeVariable}"" />",How can I bind a xaml property to a static variable in another class?
How can I bind a xaml property to a static variable in another class?," I have this xaml file in which I try to bind a Text-block Background to a static variable in another class, how can I achieve this ?I know this might be silly but I just moved from Win-forms and feeling a little bit lost.here is what I mean: <code>  <TextBlock Text=""some text"" TextWrapping=""WrapWithOverflow"" Background=""{Binding Path=SomeVariable}"" />",How can I bind a xaml property to a static variable in another class?
Build Tree Type List By Recursively checking Parent Child Relaitonship C#," I have One class that has a list of itself so it can be represented in a tree structure.I am pulling a flat list of these classes and want to unflatten it. I want to be able to do the following The ParentID related to the ID property on its parent group if that wasnt obvious.EDITThere is some confusion as to why I am returning a list and not a single object.I am building a UI element that has a list of items, each of why has a child. So the initial list DOES NOT have a root node. It seems all of the solutions so far do not work.What this means is I essentially need a list of tree type structures using Group class. <code>  public class Group{ public int ID {get;set;} public int? ParentID {get;set;} public List<Group> Children {get;set;}} List<Group> flatList = GetFlatList() //I CAN ALREADY DO THISList<Group> tree = BuildTree(flatList);",Build tree type list by recursively checking parent-child relationship C#
how to execute command on cmd from c#," I want to run commands on the cmd from my C# app.I tried: result: the cmd window pop but the command didn't do nothing.why? <code>  string strCmdText = ""ipconfig""; System.Diagnostics.Process.Start(""CMD.exe"", strCmdText); ",How to execute command on cmd from C#
MxNx3 RGB matrix into MWarray," I have an MxNx3 matrix and i want to transfer it into matlab using MWArray.Here is my code, however there is no CTOR for that.Is there any way to do it? <code>  RGBImage image = _currentImage as RGBImage;int height = image.Height;int width = image.Width;//transform the 1D array of byte into MxNx3 matrix byte[, ,] rgbByteImage = new byte[3, height, width];if (image[0].Bpp > 16){ for (int i = 0; i < height; i++) { for (int j = 0, k = 0; k < width; j = j + 3, k++) { rgbByteImage[0, i, k] = image[0].Data[i * width + j]; rgbByteImage[1, i, k] = image[0].Data[i * width + j + 1]; rgbByteImage[2, i, k] = image[0].Data[i * width + j + 2 ]; } }}MWNumericArray tempArr = new MWNumericArray(rgbByteImage);",C# array into MWarray Matlab
C# 3D array - MxNx3 imatrix into MWarray Matlab," I have an MxNx3 matrix and i want to transfer it into matlab using MWArray.Here is my code, however there is no CTOR for that.Is there any way to do it? <code>  RGBImage image = _currentImage as RGBImage;int height = image.Height;int width = image.Width;//transform the 1D array of byte into MxNx3 matrix byte[, ,] rgbByteImage = new byte[3, height, width];if (image[0].Bpp > 16){ for (int i = 0; i < height; i++) { for (int j = 0, k = 0; k < width; j = j + 3, k++) { rgbByteImage[0, i, k] = image[0].Data[i * width + j]; rgbByteImage[1, i, k] = image[0].Data[i * width + j + 1]; rgbByteImage[2, i, k] = image[0].Data[i * width + j + 2 ]; } }}MWNumericArray tempArr = new MWNumericArray(rgbByteImage);",C# array into MWarray Matlab
C# 3D array - MxNx3 matrix into MWarray Matlab," I have an MxNx3 matrix and i want to transfer it into matlab using MWArray.Here is my code, however there is no CTOR for that.Is there any way to do it? <code>  RGBImage image = _currentImage as RGBImage;int height = image.Height;int width = image.Width;//transform the 1D array of byte into MxNx3 matrix byte[, ,] rgbByteImage = new byte[3, height, width];if (image[0].Bpp > 16){ for (int i = 0; i < height; i++) { for (int j = 0, k = 0; k < width; j = j + 3, k++) { rgbByteImage[0, i, k] = image[0].Data[i * width + j]; rgbByteImage[1, i, k] = image[0].Data[i * width + j + 1]; rgbByteImage[2, i, k] = image[0].Data[i * width + j + 2 ]; } }}MWNumericArray tempArr = new MWNumericArray(rgbByteImage);",C# array into MWarray Matlab
"Differents between HttpResponse: SetCookie, AppendCookie, Cookies.Add"," there are some different ways to create multi value cookies in ASP.NET: When should I use which way? I've read that SetCookie method updates the cookie, if it already exits. Doesn't the other ways update the existing cookie as well?And is the following code best practice for writing single value cookies?Response.Cookies[""MyCookie""].Value = ""value""; <code>  var cookie = new HttpCookie(""MyCookie"");cookie[""Information 1""] = ""value 1"";cookie[""Information 2""] = ""value 2"";// first wayResponse.Cookies.Add(cookie);// second wayResponse.AppendCookie(cookie);// third wayResponse.SetCookie(cookie);","Difference between HttpResponse: SetCookie, AppendCookie, Cookies.Add"
Get item created date in sitecore, Is there anyway we can get an item's created date programmatically under the Statistics section?Thanks. <code> ,Get item created date in Sitecore
creating story board in code behind in WPF," The following code is working fine. But in this From and To values are static. I need to pass the values dynamically based system resolution. So i need it to be created in code behind. Is it possible to do ?How to convert it to codebehind? <code>  <Window.Triggers> <EventTrigger RoutedEvent=""Window.Loaded""> <BeginStoryboard> <Storyboard> <DoubleAnimation Duration=""0:0:.8"" Storyboard.TargetProperty=""Left"" From=""1920"" To=""0"" AccelerationRatio="".1""/> </Storyboard> </BeginStoryboard> </EventTrigger></Window.Triggers>",Creating Storyboard in code behind in WPF
Icon exist in systray?," I want to check if an icon exists in the systray; as in, if ""X"" application has displayed their systray icon in the systray area.I've Googled for information about how to do this but I didn't find anything. UPDATE :This what I've tried in VB.NET translating the C# examples of the url gived by Robert comment, but I don't know how to continue it. <code>  Imports System.Runtime.InteropServicesPublic Class Form1 Public Declare Function FindWindow Lib ""user32.dll"" Alias ""FindWindowA"" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long Public Declare Function FindWindowEx Lib ""user32.dll"" Alias ""FindWindowExA"" (ByVal hWndParent As IntPtr, ByVal hWndChildAfter As IntPtr, ByVal lpClassName As String, ByVal lpWindowName As String) As IntPtr Public Shared Function WindowHandle(sTitle As String) As Long Return FindWindow(vbNullString, sTitle) End Function Private Shared Function GetSystemTrayHandle() As IntPtr Dim hWndTray As IntPtr = FindWindow(""Shell_TrayWnd"", Nothing) If hWndTray <> IntPtr.Zero Then hWndTray = FindWindowEx(hWndTray, IntPtr.Zero, ""TrayNotifyWnd"", Nothing) If hWndTray <> IntPtr.Zero Then hWndTray = FindWindowEx(hWndTray, IntPtr.Zero, ""SysPager"", Nothing) If hWndTray <> IntPtr.Zero Then hWndTray = FindWindowEx(hWndTray, IntPtr.Zero, ""ToolbarWindow32"", Nothing) Return hWndTray End If End If End If Return IntPtr.Zero End Function Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click MsgBox(WindowHandle(""Steam"")) ' 6687230 MsgBox(GetSystemTrayHandle()) ' 62789 End SubEnd Class",Icon exists in systray?
Setting HTTP cache control headers in WebAPI," What's the best way to set cache control headers for public caching servers in WebAPI? I'm not interested in OutputCache control on my server, I'm looking to control caching at the CDN side and beyond (I have individual API calls where the response can be indefinitely cached for the given URL) but everything I've read thus far either references pre-release versions of WebAPI (and thus references things that seem to no longer exist, like System.Web.HttpContext.Current.Reponse.Headers.CacheControl) or seems massively complicated for just setting a couple of http headers.Is there a simple way to do this? <code> ",Setting HTTP cache control headers in Web API
how i can remove characters between < and > using regex in c#?," I have a string str=""<u>rag</u>"". Now, i want to get the string ""rag"" only. How can I get it using regex?My code is here..I got the output=""""Thanks in advance..C# code: <code>  string input=""<u>ragu</u>"";string regex = ""(\\<.*\\>)"";string output = Regex.Replace(input, regex, """");",How I can remove characters between < and > using regex in c#?
Javascript Method Invocation List," I want to simulate C#'s events in JavaScript: what i want to do is something like this:Let's say i have the following code: What i want to do is when i call my_class_obj.Event, all the subscribed functions get called.Could this be achieved purely in JavaScript or i need to find my way around through DOM events? <code>  function addToInvocationList(method, listener) { *Some code to add listener to the invocation list of method*}function MyClass() {}MyClass.prototype.Event = function() {}var my_class_obj = new MyClass();function subscriberFunction1() {}function subscriberFunction2() {}function subscriberFunction3() {}addToInvocationList(my_class_obj.Event, subscriberFunction1);addToInvocationList(my_class_obj.Event, subscriberFunction2);addToInvocationList(my_class_obj.Event, subscriberFunction3);my_class_obj.Event();",Simulate C# like events in javascript
What are the correct use of IDatabaseInitializer in EF?," I have a custom DatabaseInitialiser which is below something about the above code is more than just hacky (Feel free to chip in with help)I then added migrations and got the migration script to work correctly as well. the migrations work as expected.Now, the questions is in my application startup what should I do ? Something like this and some forums suggested this as well in the constructor which seems a little odd because I don't want to check if the db and schema are correct everytime I use the Context. So, what could be the possible use of this technique or did I get the context of the suggestion as wrong ? To summarise, what is the correct use-case for the different techniques available ?what would be the ideal strategy so that the migrations work in all conditions and when we move databases from one environment to another ? <code>  /// <summary>/// Implements the IDatabaseInitializer to provide a custom database initialisation for the context./// </summary>/// <typeparam name=""TContext"">TContext is the DbContext</typeparam>public class ParikshaDataBaseInitializer<TContext> : IDatabaseInitializer<TContext> where TContext : DbContext{ /// <summary> /// The method to Initialise the database. /// Takes care of the database cannot be dropped since it is in use problem while dropping and recreating the database. /// </summary> /// <param name=""context"">The DbContext on which to run the initialiser</param> public void InitializeDatabase(TContext context) { var exists = context.Database.Exists(); try { if (exists && context.Database.CompatibleWithModel(true)) { // everything is good , we are done return; } if (!exists) { context.Database.Create(); } } catch (Exception) { //Something is wrong , either we could not locate the metadata or the model is not compatible. if (exists) { context.Database.ExecuteSqlCommand(""ALTER DATABASE Pariksha SET SINGLE_USER WITH ROLLBACK IMMEDIATE""); context.Database.ExecuteSqlCommand(""USE Master DROP DATABASE Pariksha""); context.SaveChanges(); } context.Database.Create(); } } } internal sealed class Configuration : DbMigrationsConfiguration<ParikshaContext> { public Configuration() { AutomaticMigrationsEnabled = false; ContextKey = ""EFRepository.Context.ParikshaContext""; } protected override void Seed(ParikshaContext context) { } } var config = new Configuration(); var migrator = new DbMigrator(config); migrator.Update(); public ParikshaContext() : base(""Pariksha"") { Database.SetInitializer(new ParikshaDataBaseInitializer<ParikshaContext>()); }",What is the correct use of IDatabaseInitializer in EF?
how to modify dijkstra algorithm to find all possible paths? (C#)," I know that could be asked before already but I cannot find it.I need to modify below dijkstra algorithm which works good for findingshortest path between 2 nodes but I need to find all possible paths also.I know it should be relatively easy to do this but so far I don't have ideahow to do this simplest way. I'm using directed weighted graph. <code>  class Dijkstra { private List<Node> _nodes; private List<Edge> _edges; private List<Node> _basis; private Dictionary<string, double> _dist; private Dictionary<string, Node> _previous; public Dijkstra(List<Edge> edges, List<Node> nodes) { Edges = edges; Nodes = nodes; Basis = new List<Node>(); Dist = new Dictionary<string, double>(); Previous = new Dictionary<string, Node>(); // record node foreach (Node n in Nodes) { Previous.Add(n.Name, null); Basis.Add(n); Dist.Add(n.Name, double.MaxValue); } } /// Calculates the shortest path from the start /// to all other nodes public void calculateDistance(Node start) { Dist[start.Name] = 0; while (Basis.Count > 0) { Node u = getNodeWithSmallestDistance(); if (u == null) { Basis.Clear(); } else { foreach (Node v in getNeighbors(u)) { double alt = Dist[u.Name] + getDistanceBetween(u, v); if (alt < Dist[v.Name]) { Dist[v.Name] = alt; Previous[v.Name] = u; } } Basis.Remove(u); } } } public List<Node> getPathTo(Node d) { List<Node> path = new List<Node>(); path.Insert(0, d); while (Previous[d.Name] != null) { d = Previous[d.Name]; path.Insert(0, d); } return path; } public Node getNodeWithSmallestDistance() { double distance = double.MaxValue; Node smallest = null; foreach (Node n in Basis) { if (Dist[n.Name] < distance) { distance = Dist[n.Name]; smallest = n; } } return smallest; } public List<Node> getNeighbors(Node n) { List<Node> neighbors = new List<Node>(); foreach (Edge e in Edges) { if (e.Origin.Equals(n) && Basis.Contains(n)) { neighbors.Add(e.Destination); } } return neighbors; } public double getDistanceBetween(Node o, Node d) { foreach (Edge e in Edges) { if (e.Origin.Equals(o) && e.Destination.Equals(d)) { return e.Distance; } } return 0; } public List<Node> Nodes { get { return _nodes; } set { _nodes = value; } } public List<Edge> Edges { get { return _edges; } set { _edges = value; } } public List<Node> Basis { get { return _basis; } set { _basis = value; } } public Dictionary<string, double> Dist { get { return _dist; } set { _dist = value; } } public Dictionary<string, Node> Previous { get { return _previous; } set { _previous = value; } } }}static void Main(string[] args) {//Nodes initialisation goes hereDijkstra d = new Dijkstra(_edges, _nodes);d.calculateDistance(_dictNodes[""A""]); List<Node> path = d.getPathTo(_dictNodes[""C""]);}",How to modify dijkstra algorithm to find all possible paths?
Can't find the memory leak in code. Assistance would be great," Ok, I've been trying to do something specific with video feed from a webcam. I have a Lumenera Infinity 2 microscope that I am trying to pull feed from, and want to be able to modify the feed as it comes in. Since I couldn't find a way to do that using Video Source Player, I decided to instead pull each frame (max of 15fps for the camera) as a bitmap so I can do my modifications there.The problem is: I have a HUGE memory leak. When I run the video just using the videoSourcePlayer, it hovers at using around 30 megs. When I run pulling the frames as bitmaps, it breaks 1 gig of memory in a matter of seconds.What am I missing, here? I figured auto-garbage collection would scoop up the old frames as they became inaccessible. Should I try to force garbage collection on bitmap? Or is it something else entirely and I am noobishly missing it. <code>  FilterInfoCollection captureDevices;VideoCaptureDevice cam;Bitmap bitmap;public Form1(){ InitializeComponent();}private void Form1_Load(object sender, EventArgs e){ try { captureDevices = new FilterInfoCollection(FilterCategory.VideoInputDevice); if (captureDevices.Count == 0) throw new ApplicationException(); CameraSelectComboBox.Items.Clear(); foreach (FilterInfo device in captureDevices) { CameraSelectComboBox.Items.Add(device.Name); } CameraSelectComboBox.SelectedIndex = 0; CameraSelectComboBox.Enabled = true; } catch (ApplicationException) { CameraSelectComboBox.Enabled = false; }}private void connectButton_Click(object sender, EventArgs e){ cam = new VideoCaptureDevice(captureDevices[CameraSelectComboBox.SelectedIndex].MonikerString); cam.NewFrame -= Handle_New_Frame; //Just to avoid the possibility of a second event handler being put on cam.NewFrame += new AForge.Video.NewFrameEventHandler(Handle_New_Frame); videoSourcePlayer1.Visible = false; cam.Start(); //videoPictureBox1.Visible = false; //videoSourcePlayer1.VideoSource = new VideoCaptureDevice(captureDevices[CameraSelectComboBox.SelectedIndex].MonikerString); //videoSourcePlayer1.Start();}private void Handle_New_Frame(object sender, NewFrameEventArgs eventArgs){ bitmap = (Bitmap)eventArgs.Frame.Clone(); videoPictureBox1.Image = bitmap;}",Memory leak in webcam code
Ninject Contextual Binding w/ Generics," I have a generic interface IRepository<T> and two implementations xrmRepository<T> and efRepository<T>I want to change the binding based on T, more specifically use xrmRepository when T derives from Entity. How can I accomplish that?I currently have: But when I try to resolve IRepository<Contact> it goes to efRepository, even though Contact inherits Entity.I don't want to use Named Bindings otherwise I will have to add the names everywhere. <code>  kernel.Bind(typeof(IRepository<>)).To(typeof(efRepository<>)).InRequestScope();kernel.Bind(typeof(IRepository<>)).To(typeof(xrmRepository<>)).When(request => request.Service.GetGenericArguments()[0].GetType().IsSubclassOf(typeof(Entity))).InRequestScope();",Ninject Contextual Binding w/ Open Generics
How to use properly SortedDictionary in c#?," I'm trying to do something very simple but it seems that I don't understand SortedDictionary. What I'm trying to do is the following:Create a sorted dictionary that sorts my items by some floating number, so I create a dictionary that looks like this And now after I add items, I want to remove them one by one (every removal should be at a complexity of O(log(n)) from the smallest to the largest.How do I do it? I thought that simply allNodes[0] will give me the the smallest, but it doesn't.More over, it seems like the dictionary can't handle duplicate keys. I feel like I'm using the wrong data structure...Should I use something else if I have bunch of nodes that I want to be sorted by their distance (floating point)? <code>  SortedDictionary<float, Node<T>> allNodes = new SortedDictionary<float, Node<T>>();",How to properly use SortedDictionary in c#?
How to make a POST request and send JSON via Fiddler to WebAPI," Revised entire post.I'm trying to post the following JSON POST request via Fiddler: However I'm getting this error: Though if I manually send a random Id along with the request then all is good. Like so: Why does Entity Framework not generate and auto increment the Id's? My POCO class is as follows: Here is the controller method. When in debug mode and I send the request via Fiddler it breaks at db.SaveChanges(); and gives the error seen a bit above. What's wrong? SolutionChange string Id to int instead and remove Data annotations. Renamed the Id to UserId, still following convention, and made changes where necessary in other POCO's to match up with the changes. <code>  {Username:""Bob"", FirstName:""Foo"", LastName:""Bar"", Password:""123"", Headline:""Tuna""} Message ""Cannot insert the value NULL into column 'Id', table 'xxx_f8dc97e46f8b49c2b825439607e89b59.dbo.User'; column does not allow nulls. INSERT fails.\r\nThe statement has been terminated."" string {Id:""1"", Username:""Bob"", FirstName:""Foo"", LastName:""Bar"", Password:""123"", Headline:""Tuna""} public class User{ [Key] [DatabaseGenerated(DatabaseGeneratedOption.Identity)] public string Id { get; set; } public string Username { get; set; } public string FirstName { get; set; } public string LastName { get; set; } public string Password { get; set; } public string Headline { get; set; } public virtual ICollection<Connection> Connections { get; set; } public virtual ICollection<Address> Addresses { get; set; } public virtual ICollection<Phonenumber> Phonenumbers { get; set; } public virtual ICollection<Email> Emails { get; set; } public virtual ICollection<Position> Positions { get; set; }}public class Connection{ public string ConnectionId { get; set; } public int UserId { get; set; } public virtual User User { get; set; }}public class Phonenumber{ public string Id { get; set; } public string Number { get; set; } public int Cycle { get; set; } public int UserId { get; set; } public User User { get; set; }} // POST api/xxx/create [ActionName(""create"")] public HttpResponseMessage PostUser(User user) { if (ModelState.IsValid) { db.Users.Add(user); db.SaveChanges(); HttpResponseMessage response = Request.CreateResponse(HttpStatusCode.Created, user); response.Headers.Location = new Uri(Url.Link(""DefaultApi"", new { id = user.Id })); return response; } else { return Request.CreateErrorResponse(HttpStatusCode.BadRequest, ModelState); } }",How to generate and auto increment Id with Entity Framework
Get the content of a div using Web Browser control?," I have a form with webBrowser1 control that is used to load a page that contains in its HTML part the following line: I need to get the innerText of the div element. I tried the following: But the code above doesn't seem to work, and according to Solution 1 for a similar question on another website, it is stated that First thing which caught my eye is: <div class=""thin""> does not define the name of the div element, it defines its CSS style class. Instead, use the attribute name (or both), for example: <div class=""thin"" name=""thin"">.How can I get the innerText of the div element, if there is a class attribute only?Any help would be highly appreciated. <code>  ... <div class=""cls""> Hello World ! </div> string result = """"; foreach (HtmlElement el in webBrowser1.Document.GetElementsByTagName(""div"")) if (el.GetAttribute(""class"") == ""cls"") { result = el.InnerText; }",Get the content of a div by class name using Web Browser control?
`A referential integrity constraint violation occurred," I'm trying to update an existing entity.I have the following code: But the Attach methods throws an exception: A referential integrity constraint violation occurred: The property values that define the referential constraints are not consistent between principal and dependent objects in the relationship.How can I fix this? <code>  public MamConfiguration_V1 Save(MamConfiguration_V1 item){ mMaMDBEntities.MamConfiguration_V1.Attach(item); mMaMDBEntities.ObjectStateManager.ChangeObjectState(item, System.Data.EntityState.Modified); mMaMDBEntities.SaveChanges(); return item;}",A referential integrity constraint violation occurred
"Which pattern is more preferable: test-create, try-create, create-catch?"," Let's assume there is an operation that creates a user. This operation may fail if specified email or username exists. If it has failed, it is required to know exactly why. There are three approaches of doing this as I see it and I'm wondering whether there is a clear winner.So, here's a class user: And there are 3 ways of accomplishing create operation:Test-Create UserExists and UsernameExists make request to db server to do a validation. These calls are again repeated in CreateUser to ensure API is used correctly. In case validation has failed, I throw ArgumentOutOfRangeException in both cases. So there is a performance hit.Try-Create This pattern does the validation only once, but we resort to using the so called error codes which isn't considered a good practice.Create-Catch I don't use error codes here, but I now have to create a separate exception class for every case. It's more or less how exceptions are supposed to be used, but I wonder if creating a separate exception instead of enum entry is worthwhile.So, do we have a clear winner or it's more a matter of taste? <code>  class User{ public string Email { get; set; } public string UserName { get; set; }} if (UserExists(user)) act on user exists error;if (UsernameExists(user)) act on username exists error;CreateUser(user); enum CreateUserResultCode{ Success, UserAlreadyExists, UsernameAlreadyExists}if (!TryCreate(user, out resultCode)){ switch(resultCode) { case UserAlreadyExists: act on user exists error; case UsernameAlreadyExists: act on username exists error; }} try{ CreateUser(user);}catch(UserExistsException){ act on user exists error;}catch(UsernameExistsException){ act on username exists error;}","Which design is most preferable: test-create, try-create, create-catch?"
How to upload large files using MVC 4 / plupload ?," I had it working.. but I noticed once the files I was uploading get bigger (around 4000k) the controller would not be called..So I added in chunking which fixed that problem.. but now when I open the file its full of garbage characters... So what is the correct way to upload large files with plupload/MVC 4 ? Here is my current code and the controller <code>  $(document).ready(function () { var uploader = new plupload.Uploader({ runtimes: 'html5', browse_button: 'pickfiles', container: 'container', // max_file_size: '20000mb', url: '@Url.Action(""Upload"", ""Home"")', chunk_size: '4mb', //filters: [ // { title: ""Excel files"", extensions: ""xls,xlsx"" }, // { title: ""Text files"", extensions: ""txt"" } //], multiple_queues: true, multipart: true, multipart_params: { taskId: '' } }); [HttpPost] public ActionResult Upload(int? chunk, string name, string taskId) { string filePath = """"; var fileUpload = Request.Files[0]; var uploadPath = Server.MapPath(""~/App_Data/Uploads""); chunk = chunk ?? 0; string uploadedFilePath = Path.Combine(uploadPath, name); var fileName = Path.GetFileName(uploadedFilePath); try { using (var fs = new FileStream(filePath, chunk == 0 ? FileMode.Create : FileMode.Append)) { var buffer = new byte[fileUpload.InputStream.Length]; fileUpload.InputStream.Read(buffer, 0, buffer.Length); fs.Write(buffer, 0, buffer.Length); } //Log to DB for future processing InstanceExpert.AddProcessStart(filePath, Int32.Parse(taskId)); }",How to upload large files using MVC 4?
Treat control as either ComboBox or TextBox in C#," What is the best way to solve the following problem? You see it's complicated enough to get the AutoCompleteMode-property. You can assume that it is guaranteed that I have either a ComboBox or a TextBox.My first idea was to use generic with multiple types for T, but it seems that this is not possible in .NET: Sadly the both Controls don't have a common base class.Note: This is meant to be a more general question used with a minimized example. In my case, I also want to access / manipulate other the AutoComplete*-proprties (which also both Controls have in common).Thanks for ideas! <code>  foreach (Control control in this.Controls){ if (control is ComboBox || control is TextBox) { ComboBox controlCombobox = control as ComboBox; TextBox controlTextbox = control as TextBox; AutoCompleteMode value = AutoCompleteMode.None; if (controlCombobox != null) { value = controlCombobox.AutoCompleteMode; } else if (controlTextbox != null) { value = controlTextbox.AutoCompleteMode; } // ... }} public string GetAutoCompleteModeProperty<T>(T control) where T: ComboBox, TextBox // this does not work, of course",Treat control as either ComboBox or TextBox
DateTime.ToString() to output the same DateTime string as Xml serialization?, Is there a standard DateTime format for use in C# that can be used with the ToString method that will produce the same format that is produced when you serialize a DateTime to XML?For example: 2013-03-20T13:32:45.5316112Z <code> ,Getting 'DateTime.ToString()' to output the same string as an XML serialization of a 'DateTime'
MVC4 - The conversion of a datetime2 data type to a datetime data type Error, I have a controller: A model: And a view: When I try to run it I receive the error: The conversion of a datetime2 data type to a datetime data type resulted in an out-of-range value.The model-controller-view is from a book copied one-to-one.What is the format that I need to enter to the EndTime field so I won't have this error? <code>  [HttpPost]public ActionResult Create(Auction auction){ var db = new EbuyDataContext(); db.Auctions.Add(auction); db.SaveChanges(); return View(auction);} public class Auction{ public long Id { get; set; } public string Title { get; set; } public string Description { get; set; } public decimal StartPrice { get; set; } public decimal CurrentPrice { get; set; } public DateTime StartTime { get; set; } public DateTime EndTime { get; set; }}} @model Ebuy.Website.Models.Auction@using (Html.BeginForm()){ <p> //All the information fields... @Html.LabelFor(model => model.EndTime) @Html.EditorFor(model => model.EndTime) </p>},The conversion of a datetime2 data type to a datetime data type Error
Is there any way to give optimization hints to the JIT?," I've already profiled, and am now looking to squeeze every possible bit of performance possible out of my hot-spot.I know about [MethodImplOptions.AggressiveInlining] and the ProfileOptimization class. Are there any others?[Edit] I just discovered [TargetedPatchingOptOut] as well. Nevermind, apparently that one is not needed. <code> ",What optimization hints can I give to the compiler/JIT?
What optimization hints can I give to the JIT?," I've already profiled, and am now looking to squeeze every possible bit of performance possible out of my hot-spot.I know about [MethodImplOptions.AggressiveInlining] and the ProfileOptimization class. Are there any others?[Edit] I just discovered [TargetedPatchingOptOut] as well. Nevermind, apparently that one is not needed. <code> ",What optimization hints can I give to the compiler/JIT?
Visual Studio 2012 Unit Tests don't run," I used to be able to run unit tests in VS 2012. Now, all of a sudden, whether I try to ""Run"" or ""Debug"" any unit tests, the Unit Test Sessions window puts the test into ""Pending"" status, but never actually executes it. I've tried restarting my dev environment, even rebooting the computer. No change.So where is the secret setting that says ""Make unit tests freeze at 'Pending'""? <code> ",Visual Studio 2012 / Resharper Unit Tests don't run
TimeZone.ConvertTimeToUtc issue," We had an issue where one developer creates the below code and it works on his DEV environment. But when it's checked into QA, the code breaks with the below error message: The conversion could not be completed because the supplied DateTime did not have the Kind property set correctly. For example, when the Kind property is DateTimeKind.Local, the source time zone must be TimeZoneInfo.Local.On my DEV environment, the above code generates the same error as the QA server. I applied the below change to fix the problem: Why does the first code example work on DEV1's environment but break on my DEV environment and on our QA server? <code>  myRecord.UTCStartTime = TimeZoneInfo.ConvertTimeToUtc(myRecord.StartTime, myTimeZone); DateTime utcStart = DateTime.SpecifyKind(myRecord.StartTime, DateTimeKind.Unspecified);myRecord.UTCStartTime = TimeZoneInfo.ConvertTimeToUtc(utcStart, myTimeZone);",TimeZoneInfo.ConvertTimeToUtc issue
How to make DataReader start reading again from the beginning at a condition?, How to make dr.Read(); start reading again from the beginning if a condition is satisfied?Something like: <code>  SqlDataReader dr = command.ExecuteReader();for(int i=0; dr.Read() ; i++){ if(condition ){ //let dr.Read() start reading from the beginning }},Make DbDataReader start reading again from the beginning of the result set
Find specific control on selected index in flipview," I have this flipview: I want to find img1 of currently selected index. While searching for it I found this method on some post here: It returns me the Image on the first index of flipview but I need the one present on the currently selected index.. I tried to edit this method but I am unable to find the required control. Can anyone help me? <code>  <FlipView x:Name=""models_list"" SelectionChanged=""selectionChanged""> <FlipView.ItemTemplate> <DataTemplate> <Grid x:Name=""cv""> <Image x:Name=""img1"" Source = ""{Binding ModelImage}"" Stretch=""Fill"" Tag=""{Binding ModelTag}""/> </Grid> </DataTemplate> </FlipView.ItemTemplate> private DependencyObject FindChildControl<T>(DependencyObject control, string ctrlName) { int childNumber = VisualTreeHelper.GetChildrenCount(control); for (int i = 0; i < childNumber; i++) { DependencyObject child = VisualTreeHelper.GetChild(control, i); FrameworkElement fe = child as FrameworkElement; // Not a framework element or is null if (fe == null) return null; if (child is T && fe.Name== ctrlName) { // Found the control so return return child; } else { // Not found it - search children DependencyObject nextLevel = FindChildControl<T>(child, ctrlName); if (nextLevel != null) return nextLevel; } } return null; }",How do I access a control inside a XAML DataTemplate?
Convert generic parameter with where type constraint," I have a base class: And a class which stores the DomainEventSubscriber references: Even though the Subscribe method type is constrained, I cannot convert from DomainEventSubscriber<T> subscriber where T : DomainEvent to DomainEventSubscriber<DomainEvent>: How would I go about performing this conversion, or am I setting myself up for a nasty code smell? <code>  public abstract class DomainEventSubscriber<T> where T : DomainEvent{ public abstract void HandleEvent(T domainEvent); public Type SubscribedToEventType() { return typeof(T); }} public class DomainEventPublisher{ private List<DomainEventSubscriber<DomainEvent>> subscribers; public void Subscribe<T>(DomainEventSubscriber<T> subscriber) where T : DomainEvent { DomainEventSubscriber<DomainEvent> eventSubscriber; eventSubscriber = (DomainEventSubscriber<DomainEvent>)subscriber; if (!this.Publishing) { this.subscribers.Add(eventSubscriber); } }} eventSubscriber = (DomainEventSubscriber<DomainEvent>)subscriber;",Convert generic parameter with 'where' type constraint not possible?
Why C# behave differently on two int array syntaxes," Array in C# is co-variant implicitly on reference type: But not on value type, so if you change string to int, you will get compiled error: Now, the concern is when you declare int array like two syntaxes below which do not explicitly declare the type int, just only differentiate on new[], compiler will treat differently: You will get object[] list1 = { 0, 1 }; compiled successfully, but object[] list2= new[] {0, 1}; compiled error.It seems the C# compiler treats as but as Why C# compiler behaves in the different way on this case? <code>  object[] listString = new string[] { ""string1"", ""string2"" }; object[] listInt = new int[] {0, 1}; // compile error object[] list1 = { 0, 1 }; //compile successfullyobject[] list2 = new[] {0, 1}; //compile error object[] list1 = { 0, 1 }; object[] list1 = new object[]{ 0, 1 }; object[] list2 = new[] { 0, 1 }; object[] list2 = new int[]{ 0, 1 }; //error because of co-variant",Why C# behaves differently on two int array syntaxes
MS SQL Invalid column name," I'm new to SQL Server I've created my table like this: and I've created a web service to insert data to that table, like this: All that stuff is hosted to a free hosting server.When I test the web service from VS2010, and when I pass numbers to all parameters, a new row is successfully added to the table. But when I pass at least one string to the service, for example ""a"", I get this result: and the row is not added. I wonder why he considered ""a"" as a column name? Anyone can help? <code>  CREATE TABLE Accidents ( Id INT NOT NULL PRIMARY KEY IDENTITY, GUID VARCHAR(100), Latitude VARCHAR(100), Longitude VARCHAR(100), PhotoName VARCHAR(100) ) SqlConnection con = new SqlConnection(@""workstation id=DatabaseSample.mssql.somee.com;packet size=4096;user id=???;pwd=???;data source=DatabaseSample.mssql.somee.com;persist security info=False;initial catalog=DatabaseSample""); public string addAccidentToDatabase(string GUID, string imageBase64String, string latitude, string longitude, string photoName) { SqlCommand cmd = new SqlCommand(""INSERT INTO Accidents (GUID,Latitude,Longitude,PhotoName) VALUES ("" + GUID + "","" + latitude + "","" + longitude + "","" + photoName + "")"", con); try { con.Open(); cmd.ExecuteNonQuery(); } catch (Exception e) { return e.Message; } finally { con.Close(); } return ""succeeded""; } <string xmlns=""http://tempuri.org/"">Invalid column name 'a'.</string>",SQL Server Invalid column name when adding string value
C# - Dynamically evaluating a property string with Expressions," How do I build an expression that will fulfill the following goal:public object Eval(object rootObj, string propertyString)eg: Eval(person, ""Address.ZipCode"") => return person.Address.ZipCodeExpression.PropertyOrField doesn't work because I don't have the type of each intermediate property. I'd like to avoid creating a dependency on a scripting library.I want to try to use expressions because it would allow me to store a cache of these expression trees as they would be executed several times. I'm aware that it's possible to do this iteratively or recursively with reflection. <code> ",Dynamically evaluating a property string with Expressions
How to use async with Visual Studio 2010?," I want to add async support to current VS 2010 .NET 4.0 C# projectI have found:Visual Studio Async CTP - http://www.microsoft.com/en-us/download/details.aspx?id=9983Microsoft.Bcl.Async - https://nuget.org/packages/Microsoft.Bcl.AsyncI don't even get real difference between them.I installed both. Visual Studio Async CTP (Version 3), Microsoft.Bcl and Microsoft.Bcl.Async. (also used to run tools\portable-net40+sl4+win8+wp71\install.ps1 in Microsoft.Bcl)And still can't see any effect. Same error for -> So is it real how should I use this stuff? <code>  public async Task<CommResponse> Error 37 The type or namespace name 'async' could not be found (are you missing a using directive or an assembly reference?)",How to use async with Visual Studio 2010 and .NET 4.0?
Deprecation behavior using the [Obsolete] keyword in C#," While removing some obsolete code I came across an unexpected scenario, recreated below: Based in the output it seems that functions deprecated with a warning are permitted to call functions deprecated with an error and the code will execute. My expectation was that I would see a compiler error complaining that the call to HardDeprecatedMethod() from SoftDeprecatedMethod() is not permitted.The observed behavior seems odd to me. Does anyone know if this is the desired behavior (and if so, why), or could this be a flaw in the implementation of the [Obsolete] attribute? <code>  class Program{ static void Main(string[] args) { ViableMethod(); Console.WriteLine(""""); SoftDeprecatedMethod();//Compiler warning //HardDeprecatedMethod();//Can't call that from here, compiler error Console.ReadKey(true); } public static void ViableMethod () { Console.WriteLine(""ViableMethod, calls SoftDeprecatedMethod""); SoftDeprecatedMethod();//Compiler warning //HardDeprecatedMethod();//Can't call that from here, compiler error } [Obsolete(""soft"", false)] public static void SoftDeprecatedMethod() { Console.WriteLine(""SoftDeprecatedMethod, calls HardDeprecatedMethod""); HardDeprecatedMethod(); } [Obsolete(""hard"", true)] public static void HardDeprecatedMethod() { Console.WriteLine(""HardDeprecatedMethod""); }}",Deprecation behavior using the [Obsolete] attribute
What is the difference between a class having private contructor and a sealed class having private constructor?, Is there any difference between A and B?Class A has private constructor: Class B is sealed and has a private constructor: <code>  class A{ private A() { }} sealed class B{ private B() { }},What is the difference between a class having private constructor and a sealed class having private constructor?
Twain or WIA ? A bit lost between this two interface, I need to write a c# assembly (DLL) in order to scan documents.I don't know if I need to use TWAIN or WIA.Anyone could help me please ?What are the diffrences?What are your advices ?Is there a c# Library ? <code> ,Twain or WIA? A bit lost between this two interface
Why recursive constructor calls make invalid C# code compile?," After watching webinar Jon Skeet Inspects ReSharper, I've started to play a little withrecursive constructor calls and found, that the following code is valid C# code (by valid I mean it compiles). As we all probably know, field initialization is moved into constructor by the compiler. So if you have a field like int a = 42;, you will have a = 42 in all constructors. But if you have constructor calling another constructor, you will have initialization code only in called one.For example if you have constructor with parameters calling default constructor, you will have assignment a = 42 only in the default constructor.To illustrate second case, next code: Compiles into: So the main issue, is that my code, given at the start of this question, is compiled into: As you can see, the compiler can't decide where to put field initialization and, as result, doesn't put it anywhere. Also note, there are no base constructor calls. Of course, no objects can be created, and you will always end up with StackOverflowException if you will try to create an instance of Foo.I have two questions:Why does compiler allow recursive constructor calls at all?Why we observe such behavior of the compiler for fields, initialized within such class?Some notes: ReSharper warns you with Possible cyclic constructor calls. Moreover, in Java such constructor calls won't event compile, so the Java compiler is more restrictive in this scenario (Jon mentioned this information at the webinar).This makes these questions more interesting, because with all respect to Java community, the C# compiler is at least more modern.This was compiled using C# 4.0 and C# 5.0 compilers and decompiled using dotPeek. <code>  class Foo{ int a = null; int b = AppDomain.CurrentDomain; int c = ""string to int""; int d = NonExistingMethod(); int e = Invalid<Method>Name<<Indeeed(); Foo() :this(0) { } Foo(int v) :this() { }} class Foo{ int a = 42; Foo() :this(60) { } Foo(int v) { }} internal class Foo{ private int a; private Foo() { this.ctor(60); } private Foo(int v) { this.a = 42; base.ctor(); }} internal class Foo{ private int a; private int b; private int c; private int d; private int e; private Foo() { this.ctor(0); } private Foo(int v) { this.ctor(); }}",Why does a recursive constructor call make invalid C# code compile?
Why won't my $.ajax call return a json object?," I have this jquery that uses ajax in an attempt to return a json object, but I am no pro at ajax, though I have used it before with json, only I was loading a json file and not trying to return a string from a cshtml page that queries a database for information (as I am doing here).Here is the jQuery: (Also I have tried ""application/json; charset=UTF-8"" as the contentType, but it changes no behavior).Here is the cshtml page that I point AJAX to: It is very important to note a couple of things:I get no server-side error or error code.I have written the output to a simple .txt file to test the contents, and by pasting it into jsonLint (found here: http://jsonlint.com/) I was easily able to determine that this is, indeed, valid json syntax.I am still always getting the alert message that runs only under the ""error: function()"" option of the $.ajax call.I am getting no white space either before or after the entire jsonString (not that that probably matters).I am in a WebMatrix, C#, asp.net-webpages environment.My only two suspicions are 1) The dataType and/or contentType is not set correctly, or 2) The last time I had to use ajax for json (targeting an actual .json file) I had to change a setting in ""IIS Express"" to allow it to receive data from json files, however, I thought that this was only needed if actually using ajax to parse a json ""file"" and not just json data. Also, no matter where I look, I can't seem to find this resource anymore.The textStatus and error parameter values are: textStatus: parsererror error: SyntaxError: Unexpected token & but this doesn't seem to throw any red flags in my mind, because I know that the json syntax by itself checks out okay.Thanks to everyone for all of your help. I believe I have found the issue (the unexpected ampersand token finally made a light bulb go on in my head). I have added the answer to this page, in the event that it may help someone else in the future. <code>  $.ajax({ url: ""/AJAX Pages/Compute_Calendar_Events.cshtml"", async: true, type: ""GET"", dataType: ""json"", contentType: ""application/json"", success: function (jsonObj) { console.log(""AJAX SUCCESS!""); }, error: function (jqXHR, textStatus, error) { alert(""NO AJAX!""); }}); @{ Layout = """"; if(IsAjax || 1==1) { string jsonString = ""{\""events\"":[""; string selectQueryString = ""SELECT title, summary, eventDate FROM CalendarEvents ORDER BY eventDate ASC""; var db = Database.Open(""Content""); foreach (var row in db.Query(selectQueryString)) { jsonString += ""{""; jsonString += ""\""title\"":"" + Json.Encode(row.title) + "",""; jsonString += ""\""dateNumber\"":"" + Json.Encode(row.eventDate.ToString().Substring(0, row.eventDate.ToString().IndexOf(""/""))) + "",""; jsonString += ""\""dateMonth\"":"" + Json.Encode(row.eventDate.ToString().Substring(row.eventDate.ToString().IndexOf(""/"") + 1, row.eventDate.ToString().LastIndexOf(""/"") - (row.eventDate.ToString().IndexOf(""/"") + 1))) + "",""; jsonString += ""\""dateYear\"":"" + Json.Encode(row.eventDate.ToString().Substring(row.eventDate.ToString().LastIndexOf(""/"") + 1, 4)) + "",""; jsonString += ""\""summary\"":"" + Json.Encode(row.summary); jsonString += ""},""; } jsonString = jsonString.TrimEnd(','); jsonString += ""]}""; /*System.IO.File.Delete(Server.MapPath(""~/TEST.txt"")); var outputFile = System.IO.File.AppendText(Server.MapPath(""~/TEST.txt"")); outputFile.Write(jsonString); outputFile.Close();*/@* *@@jsonString } else { Response.Redirect(""~/""); }}",Why won't my $.ajax call return a json object from a cshtml file?
How to compare tow object that has string value?," I use this code And get true result: But when i try to lower:object text2 = ""test"".ToLower();i get false result? <code>  object text1 = ""test""; object text2 = ""test""; Console.WriteLine(""text1 == text2 : "" + (text1 == text2)); //return:true object text1 = ""test"".ToLower(); object text2 = ""test"".ToLower(); Console.WriteLine(""text1 == text2 : "" + (text1 == text2)); //return:false",How to compare two object which have string values?
Scope_Identity() or is there other way, I am trying to get the Id of newly inserted record in Sqlserver. I have checked the Scope_Identity() but this is said to return the value of the autoincrement column. The column I am using for Id is Guid. I want this Guid column value after the insert. How should this be achieved? Or I must have to write a custom tedious function to get the Id of newly inserted record. <code> ,How can I get the GUID value of a new row after inserting it?
How to find an average date/time in the array of DateTime values with C#," If I have an array of DateTime values: What's the way to find the average DateTime among them?For instance, if I have: the average should be: <code>  List<DateTime> arrayDateTimes; 2003-May-21 15:00:002003-May-21 19:00:002003-May-21 20:00:00 2003-May-21 18:00:00",How to find an average date/time in the array of DateTime values
Is this what boxing is?, In my mind this is what I think of as boxing and unboxing. Nothing more. Can someone confirm that this is correct? <code> ,Is a boxed value just a pointer to a copy of the value stored in the managed heap?
Updating UI with BackgroundWorker in WPF C#," I am currently writing a simple WPF 3.5 application that utilizes the SharePoint COM to make calls to SharePoint sites and generate Group and User information. Since this process takes awhile I want to show a ProgressBar while the groups are being generated. The desired process is as follows:User enters url and clicks button to fetch site data.ProgressBar begins animationGroups are generated and names are added to a ListViewUpon completion ProgressBar animation endsThe problem I am running into is that the UI is never updated. Neither the ProgressBar or the ListView makes any changes. If anyone has any ideas to help with the code below it would be greatly appreciated. <code>  private void GetGroupsAndUsersButton_Click(object sender, RoutedEventArgs e){ siteUrl = """"; if (SiteURLTextBox.Text.Length > 0) { FetchDataProgressBar.IsIndeterminate = true; mWorker = new BackgroundWorker(); mWorker.DoWork += new DoWorkEventHandler(worker_DoWork); mWorker.WorkerSupportsCancellation = true; mWorker.RunWorkerCompleted += new RunWorkerCompletedEventHandler(worker_RunWorkerCompleted); mWorker.RunWorkerAsync(); } else { System.Windows.MessageBox.Show(""Please enter a URL for the SharePoint site you wish to retrieve data""); }}private void worker_DoWork(object sender, System.ComponentModel.DoWorkEventArgs e){ siteUrl = SiteURLTextBox.Text; GroupListView.ItemsSource = null; try { using (SPSite site = new SPSite(siteUrl)) { SPWeb web = site.OpenWeb(); SPGroupCollection collGroups = web.SiteGroups; if (GroupNames == null) GroupNames = new List<string>(); foreach (SPGroup oGroup in collGroups) { GroupListView.Items.Add(new ListViewItem() { Content = oGroup.Name }); } foreach (ListViewItem item in GroupListView.Items) { item.MouseLeftButtonUp += item_MouseLeftButtonUp; } } } catch (Exception ex) { System.Windows.MessageBox.Show(""Unable to locate a SharePoint site at: "" + siteUrl); }}private void worker_RunWorkerCompleted(object sender, System.ComponentModel.RunWorkerCompletedEventArgs e){ FetchDataProgressBar.Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal, new Action( delegate() { FetchDataProgressBar.IsIndeterminate = false; } ));}",Updating UI with BackgroundWorker in WPF
Why do we need interfaces when abstract classes are existing?, One interviewer has asked me the below question and I couldn't answer:Why do we need Interfaces when abstract classes exist?Whatever the methods we are writing in interface those we can write in Abstract class also. Then why do we need interfaces separately?Can anybody please tell what is the reason?Advance thanks... <code> ,Why do we need interfaces when abstract classes exist?
How to I convert a string[] to a char[]?," What is the best way to separate the individual characters in an array of strings strArr into an array of those characters charArr, as depicted below? This is what I am currently doing, but I do not think that it is very elegant: <code>  string[] strArr = { ""123"", ""456"", ""789"" };char[] chrArr = { '1', '2', '3', '4', '5', '6', '7', '8', '9' }; int characterCount = 0;for (int i = 0; i < strArr.Length; i++){ characterCount += strArr[i].Length;}int indexCount = 0;char[] chrArr = new char[characterCount];for (int i = 0; i < strArr.Length; i++){ for (int j = 0; j < strArr[i].Length; j++) { chrArr[indexCount] = strArr[i][j]; indexCount++; }}",How can I divide a set of strings into their constituent characters in C#?
How do divide a set of strings into their constituent characters in C#?," What is the best way to separate the individual characters in an array of strings strArr into an array of those characters charArr, as depicted below? This is what I am currently doing, but I do not think that it is very elegant: <code>  string[] strArr = { ""123"", ""456"", ""789"" };char[] chrArr = { '1', '2', '3', '4', '5', '6', '7', '8', '9' }; int characterCount = 0;for (int i = 0; i < strArr.Length; i++){ characterCount += strArr[i].Length;}int indexCount = 0;char[] chrArr = new char[characterCount];for (int i = 0; i < strArr.Length; i++){ for (int j = 0; j < strArr[i].Length; j++) { chrArr[indexCount] = strArr[i][j]; indexCount++; }}",How can I divide a set of strings into their constituent characters in C#?
SaveFileDialog not continueing after ShowDialog," For some reason after my SaveFileDialog, my app will never show the MessageBox. Is there something I'm missing? Or is this a threading issue?I run the application as a Windows Form application using VS 2010 Express.I do not get any exceptions.To add: When I step through the code, all seems to go well. Which is weird, so I believe it is a timing issue.Pointed out by LarsTech and others, the MessageBoxes do show up, however the focus is gone; in other words the MessageBox is pushed behind other windows or minimized. This is a problem. <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Windows.Forms;using System.Globalization;using System.IO;namespace SpeedDating{ class Program { [STAThread] static void Main(string[] args) { string filename = ""test.test""; // args[0]; string ext = filename.Substring(filename.LastIndexOf('.')); SaveFileDialog dialog = new SaveFileDialog(); dialog.Title = ""SpeedDating App""; dialog.RestoreDirectory = true; dialog.CheckFileExists = false; dialog.CheckPathExists = false; dialog.FileName = DateTime.Now.ToString(""yyyyMMdd"") + ext; DialogResult result = dialog.ShowDialog(); if (result == DialogResult.OK && dialog.FileName != """") { try { FileStream outfs = File.Create(dialog.FileName); FileStream infs = File.Open(filename, FileMode.Open); infs.CopyTo(outfs); infs.Close(); outfs.Close(); } catch (NotSupportedException ex) { MessageBox.Show(""Probably removed the original file.""); } } else { MessageBox.Show(""No path found to write to.""); } MessageBox.Show(""I came here and all I got was this louzy printline""); } }}",MessageBox not showing (focused) after SaveFileDialog
SaveFileDialog not continuing after ShowDialog," For some reason after my SaveFileDialog, my app will never show the MessageBox. Is there something I'm missing? Or is this a threading issue?I run the application as a Windows Form application using VS 2010 Express.I do not get any exceptions.To add: When I step through the code, all seems to go well. Which is weird, so I believe it is a timing issue.Pointed out by LarsTech and others, the MessageBoxes do show up, however the focus is gone; in other words the MessageBox is pushed behind other windows or minimized. This is a problem. <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Windows.Forms;using System.Globalization;using System.IO;namespace SpeedDating{ class Program { [STAThread] static void Main(string[] args) { string filename = ""test.test""; // args[0]; string ext = filename.Substring(filename.LastIndexOf('.')); SaveFileDialog dialog = new SaveFileDialog(); dialog.Title = ""SpeedDating App""; dialog.RestoreDirectory = true; dialog.CheckFileExists = false; dialog.CheckPathExists = false; dialog.FileName = DateTime.Now.ToString(""yyyyMMdd"") + ext; DialogResult result = dialog.ShowDialog(); if (result == DialogResult.OK && dialog.FileName != """") { try { FileStream outfs = File.Create(dialog.FileName); FileStream infs = File.Open(filename, FileMode.Open); infs.CopyTo(outfs); infs.Close(); outfs.Close(); } catch (NotSupportedException ex) { MessageBox.Show(""Probably removed the original file.""); } } else { MessageBox.Show(""No path found to write to.""); } MessageBox.Show(""I came here and all I got was this louzy printline""); } }}",MessageBox not showing (focused) after SaveFileDialog
MVC Custom Routing Issue," I am trying to set up custom routing with the following mapped routeedit: my full route config And my controller code This is coming up with the exception, even though I have specified the parameter as optional. The parameters dictionary contains a null entry for parameter 'fixtureId' The strange thing is, if I change the parameter of the Add action to just 'Id' then the following URL will work Result/Add/1. I'm confused, is there some default routing that is overriding my custom one? Why would changing the parameter to just 'Id' work?EditJust to test, I added another parameter to the action I then edited the route accordingly and now it works, so I reckon it is an issue with default routing. <code>  routes.IgnoreRoute(""{resource}.axd/{*pathInfo}""); routes.MapRoute( name: ""Default"", url: ""{controller}/{action}/{id}"", defaults: new { controller = ""Home"", action = ""Index"", id = UrlParameter.Optional } ); #region FixtureAdmin routes.MapRoute( name: ""FixtureEdit"", url: ""{controller}/{action}/{id}"", defaults: new { controller = ""FixtureAdmin"", action = ""Edit"", id = UrlParameter.Optional } ); #endregion #region Results routes.MapRoute( name: ""ResultAdd"", url: ""{controller}/{action}/{fixtureId}"", defaults: new { controller = ""Result"", action = ""Add"", fixtureId = UrlParameter.Optional } ); #endregion public ActionResult Add(int fixtureId) { // return model to view etc.. } public ActionResult Add(int? fixtureId, int? testId)",asp.net-mvc routing issue : parameters dictionary contains a null entry for parameter
How can I register a Namespace with an empty TagPrefix?," Though I can successfully do this at the top of a page: and then use a class like this later: I really would like to do this: so that I can use it like this later: but that gives me the error: The 'tagprefix' attribute cannot be an empty string.Isn't there a way to register an empty TagPrefix so it can be used globally without that prefix?The same concept, if I can get it right, would then apply to the Usercontrol prefix too hopefully. <code>  <%@ Register TagPrefix=""me"" Namespace=""MyNamespace"" %> <Usercontrol:DataRowTextBox ...> <Regexes> <me:RegularExpressionValidatorItem Type=""USPhoneNumber"" /> <me:RegularExpressionValidatorItem Type=""InternationalPhoneNumber"" /> </Regexes></Usercontrol:DataRowTextBox> <%@ Register TagPrefix="""" Namespace=""MyNamespace"" %> <Usercontrol:DataRowTextBox ...> <Regexes> <RegularExpressionValidatorItem Type=""USPhoneNumber"" /> <RegularExpressionValidatorItem Type=""InternationalPhoneNumber"" /> </Regexes></Usercontrol:DataRowTextBox>",Use an empty TagPrefix with a <%@ Register %>
Regex in SQL C# statement?," I'm writing a short C# to parse a given XML file. But 1 of the tag values can change, but always includes words ""Fast Start up"" (disregarding case and spaces, but needs to be in the same order) in the where clause. I'm not sure how I would do this in a sql like statement in C#. <code>  var selected = from cli in doc.Descendants(xmlns+ ""Result"") where cli.Element(xmlns + ""ResultsLocation"").Value == ""Assessments-Fast-Startup"" select cli;",Regex in Linq statement?
Challenge from a book I'm reading on C#," I'm doing a challenge from a book and it's asking me to create a loop that counts down from 20 to 0 and has me print a message for each number. However, it's asking me to print out a special message for each number divisible by 5. I have seen certain examples including this one: I get what the modulo is doing, but why does this code have ==0 after it? For example, why not just code it like this: <code>  if (number%5==0){ //your code here} if (number%5){ //your code here}",Why can't the result of a modulo operation be used in an if statement directly?
mvc sort list before showing it in view by name," I am trying to sort my list in alphabetical order before viewing all the details on my page.This is my code to get a clearer image of what I'm trying to say: I need to sort my list in alphabetical order before showing it.Thanks. <code>  <div id= ""teamMain"" style=""margin-left: 45px"";> <% foreach (var item in Model.getTeams) { %> <a href=""Statistics?id=<%: encrypted %>"" class=""teamImage""> <img src=""../../<%: item.image %>"" alt=""<%: item.name %>"" /> </a> <% } %></div>",MVC sort list before showing it in view by name
What are balancing groups?," I was just reading a question about how to get data inside double curly braces (this question), and then someone brought up balancing groups. I'm still not quite sure what they are and how to use them.I read through Balancing Group Definition, but the explanation is hard to follow, and I'm still quite confused on the questions that I mentioned.Could someone simply explain what balancing groups are and how they are useful? <code> ",What are regular expression Balancing Groups?
Modify array with Array.Foreach and lambda expresion," I'm trying to modify the values of the array but it doesn't get modified: It's like I'm doing a string.Replace without setting the resultant value to thevariable:s.replace("","", """"); instead of s=s.replace("","", """");Is it possible to accomplish inside a lambda expression?. <code>  string buzones = File.ReadAllText(""c:\\Buzones"");string[] buzoneslist = buzones.Split(',');Array.ForEach(buzoneslist, x =>{ x = x.Replace("","", """");});",Modify array with Array.Foreach and lambda expression
not able to upload file using Ajax.BeginForm()," I'm trying to upload a file using Ajax.BeginForm(), but it's not working out.My view contains: and the corresponding Controller is: The problem is that it's uploading the file, but no longer doing any asynchronous posts when I remove jquery.unobtrusive-ajax.js. Instead, it does a full post-back.When I add jquery.unobtrusive-ajax.js in my view, it's doing it asynchronously, but it is not sending an upload file in the form data. No file is being sent to the server in Request.Files[]. <code>  @using (Ajax.BeginForm(""UploadFile"", null, new AjaxOptions { HttpMethod=""POST"", UpdateTargetId = ""result"" }, new { enctype = ""multipart/form-data"" })){ <label id=""lblUploadNewFile"" for=""fileUploadControl"">Upload New File&lt;/label> <input type=""file"" name=""fileToUpload"" id=""fileUploadControl""/> <input id=""btnFileUpload"" type=""submit"" value=""Upload"" /> <span id=""result"" />} [HttpPost]public string UploadFile(FormCollection formData){ HttpPostedFileBase file=null; try { file = Request.Files[0]; } catch { } if ( file!=null &amp;&amp; file.ContentLength &gt; 0) { file.SaveAs(string.Concat( AppDomain.CurrentDomain.BaseDirectory, Path.GetFileName(file.FileName))); return &quot;Successfully Uploaded&quot;; } else { return &quot;Upload Failed, please try again.&quot;; }}",Not able to upload file using Ajax.BeginForm() asynchronously
not able to upload file using Ajax.BeginForm() asynchronously," I'm trying to upload a file using Ajax.BeginForm(), but it's not working out.My view contains: and the corresponding Controller is: The problem is that it's uploading the file, but no longer doing any asynchronous posts when I remove jquery.unobtrusive-ajax.js. Instead, it does a full post-back.When I add jquery.unobtrusive-ajax.js in my view, it's doing it asynchronously, but it is not sending an upload file in the form data. No file is being sent to the server in Request.Files[]. <code>  @using (Ajax.BeginForm(""UploadFile"", null, new AjaxOptions { HttpMethod=""POST"", UpdateTargetId = ""result"" }, new { enctype = ""multipart/form-data"" })){ <label id=""lblUploadNewFile"" for=""fileUploadControl"">Upload New File&lt;/label> <input type=""file"" name=""fileToUpload"" id=""fileUploadControl""/> <input id=""btnFileUpload"" type=""submit"" value=""Upload"" /> <span id=""result"" />} [HttpPost]public string UploadFile(FormCollection formData){ HttpPostedFileBase file=null; try { file = Request.Files[0]; } catch { } if ( file!=null &amp;&amp; file.ContentLength &gt; 0) { file.SaveAs(string.Concat( AppDomain.CurrentDomain.BaseDirectory, Path.GetFileName(file.FileName))); return &quot;Successfully Uploaded&quot;; } else { return &quot;Upload Failed, please try again.&quot;; }}",Not able to upload file using Ajax.BeginForm() asynchronously
String parsing error with Dapper," I have the following table, abridged: When I try the following Dapper code - and I'm a complete Dapper novice, found it yesterday - I get an error: The error is: Error parsing column 3 (TERM_SLA=01010B01 - String)I can see no reason why anything should even have to 'parse' a string, never mind experience an error while doing so. What could be causing this> <code>  CREATE TABLE [dbo].[TERMINAL] ( [TERM_CODEID] SMALLINT NOT NULL, [TERM_ACTIVE] SMALLINT NOT NULL, [TERM_NAME] VARCHAR (30) NOT NULL, [TERM_SLA] CHAR (8) NOT NULL, [TERM_SERIAL] VARCHAR (8) NULL, [TERM_VERSION] VARCHAR (8) NULL, [TERM_STATUS] INT NULL,) using (var conn = new SqlConnection(""data source=ourServer; initial catalog=ourDb;user id=sa;password=ourPassword;"")){ conn.Open(); var terms = conn.Query<Terminal>(""select * from TERMINAL"");}",Mapping char(8) to string property with Dapper
How to give custom page size in iTextSharp in C#.NET," I want to create a custom page size which is (5""X2"") PDF using iTextSharp in C#. Is there any way to do this? <code>  Document doc = new Document(iTextSharp.text.PageSize.A4, 15, 15, 0, 0);",Custom page size in iTextSharp in C#.NET
Can a C# Multithreaded Application use seprate WorkingDirectories per thread?," In C# (.NET), can two threads running in the same application have DIFFERENT ""WorkingFolders""??As best I can tell, the answer would be ""NO"". I think the WORKING DIR is set by the PROCESS in Win32.. Am I wrong here? According to the following test code, (as well the Win32 SetCurrentDirectory API call), this is NOT possible, but has anyone figured out a way to MAKE it possible? I know SOMEONE out there has to have ran across this before! <code>  using System;using System.Threading;public class TestClass { public ManualResetEvent _ThreadDone = new ManualResetEvent(false); public static void Main() { Console.WriteLine(Environment.CurrentDirectory); Thread _Thread = new Thread(new ParameterizedThreadStart(Go)); TestClass test = new TestClass(); _Thread.Start(test); if(test._ThreadDone.WaitOne()) { Console.WriteLine(""Thread done. Checking Working Dir...""); Console.WriteLine(Environment.CurrentDirectory); } } public static void Go(object instance) { TestClass m_Test = instance as TestClass; Console.WriteLine(Environment.CurrentDirectory); System.IO.Directory.SetCurrentDirectory(""L:\\Projects\\""); Console.WriteLine(Environment.CurrentDirectory); m_Test._ThreadDone.Set(); }}",Can a C# Multithreaded Application use separate WorkingDirectories per thread?
How does Visual Studio know if the source file matches the original version? C#," I figured out how a .NET assembly .dll file maps to a .pdb using a GUID (blog). When I debug into an assembly and it asks for the source code, if I navigate to a file, it may tell me that the source code is different from the original. How does it know this? I was expecting the .pdb file to contain a checksum for each file, but it doesn't appear to. The best tool I found to dump the debug information is dia2dump. The C++ .pdb files had MD5 entries, but the C# .pdb files did not. C++ dumpdia2dump -f dia2dump.pdb > dia2dump.pdb.files.txt C# dumpdia2dump -f Autofac.pdb > Autofac.pdb.files.txtdia2dump -all Autofac.pdb > Autofac.pdb.all.txt Is there something I missed in the ""all"" dump? It has got to be using a checksum. If I change a single character in Module.cs, I get:Where do I find the checksum for a source file referenced in a .pdb? <code> ",How does Visual Studio know if the source file matches the original version?
Deleting users in CRM Dynamics," I'm fully aware that deleting users (SystemUser Entity) in CRM Dynamics 2011 is not supported by Microsoft.However, we're currently developing a tool to support our User Provisioning needs. In order to be able to write integration tests for this tool, it seems necessary to be able to remove users afterwards, so that we can rollback our test environment to the original state.Currently, we're doing this by restoring organizations from SQL backups, but this is too time consuming to do for each test run.UpdateSo far, the best solution we have is to create a user in the integration test, assert everything we need to assert, and afterwards ""clean it up"" by disabling the user and removing its AD credentials, so that we can re-use those credentials for the next run of the test. However, as we're only looking for a solution for a test environment, I would really like to have a solution that cleans everything up properly: deleting the records in SQL seems like the way to go. Due to the complex DB structure, however, I was hoping that someone could provide scripts for this.Update2We've created the script to manually delete the user from SQL (see accepted answer). This is not supported, so only use it in test environments, if you know what you're doing. <code> ",Deleting users in CRM Dynamics 2011
When to use try in method name c#," We were discussing with our coworkers on what it means if the method name starts with ""Try"".There were the following opinions:Use ""Try"" when the method can return a null value.Use ""Try"" when the method will not throw an exception.What is the official definition? What does ""Try"" say in the method name? Is there some official guideline about this? <code> ","When is ""Try"" supposed to be used in C# method names?"
When to use try in method name?," We were discussing with our coworkers on what it means if the method name starts with ""Try"".There were the following opinions:Use ""Try"" when the method can return a null value.Use ""Try"" when the method will not throw an exception.What is the official definition? What does ""Try"" say in the method name? Is there some official guideline about this? <code> ","When is ""Try"" supposed to be used in C# method names?"
"When to use ""try"" in method name?"," We were discussing with our coworkers on what it means if the method name starts with ""Try"".There were the following opinions:Use ""Try"" when the method can return a null value.Use ""Try"" when the method will not throw an exception.What is the official definition? What does ""Try"" say in the method name? Is there some official guideline about this? <code> ","When is ""Try"" supposed to be used in C# method names?"
"When to use ""Try"" in a method name?"," We were discussing with our coworkers on what it means if the method name starts with ""Try"".There were the following opinions:Use ""Try"" when the method can return a null value.Use ""Try"" when the method will not throw an exception.What is the official definition? What does ""Try"" say in the method name? Is there some official guideline about this? <code> ","When is ""Try"" supposed to be used in C# method names?"
Design patter for dynamic c# object," I have a queue that processes objects in a while loop. They are added asynchronously somewhere.. like this: And they are processed like this: Now, the thing is that I'd like to modify this to support a TTL-like (time to live) flag, so the file path would be added o more than n times.How could I do this, while keeping the bool process(String path) function signature? I don't want to modify that. I thought about holding a map, or a list that counts how many times the process function returned false for a path and drop the path from the list at the n-th return of false. I wonder how can this be done more dynamically, and preferably I'd like the TTL to automatically decrement itself at each new addition to the process. I hope I am not talking trash. Maybe using something like this <code>  myqueue.pushback(String value); while(true){ String path = queue.pop(); if(process(path)) { Console.WriteLine(""Good!""); } else { queue.pushback(path); }} class JobData{ public string path; public short ttl; public static implicit operator String(JobData jobData) {jobData.ttl--; return jobData.path;}}",Design pattern for dynamic C# object
throw List<string> as part of InvalidOperationException, I am constructing a list of strings and then want to throw an exception and let the UI handle the list and create the error message for the user.Is there a way to do that? <code> ,Pass object (List<string>) as part of Exception
Using Roslyn how do I update the class using statements?," Just discovering Roslyn, so please be patient.I would like to update the using directives at the top of my class to include an additional statment, for example: Should become: I see that I can override SyntaxRewriter and I have done this to address method level code, but I can't see an override that might give me access to these using directives?Thanks.Edit:I have found this property, but I don't know how to modify it. Unfortunately UsingDirectiveSyntax is internal so how can I add one! :D <code>  using System;public class Foo {} using System;using Custom.Bar;public class Foo {} var tree = document.GetSyntaxTree().GetRoot() as SyntaxNode;var compilationUnitSyntax = (CompilationUnitSyntax) (tree);if (compilationUnitSyntax != null) compilationUnitSyntax.Usings.Add();",Using Roslyn how do I update the class using directives?
Lucene numeric range search is not working," The string i passed to search is (Experience:[1 TO 5]) where it searches all the numbers like 15, 25, 21, 51, etc. I need to search between the number 1 and 5,  <code>  using Lucene.Net.Store;var results = new List<SearchResults>();// Specify the location where the index files are storedstring indexFileLocation = @""G:\Lucene.Net\Data\Document"";var dir = Lucene.Net.Store.FSDirectory.GetDirectory(indexFileLocation);var reader = IndexReader.Open(dir);var searcher = new IndexSearcher(reader);var analyzer = new StandardAnalyzer();var queryParser = new QueryParser(""Prof_ID"", analyzer);// <default field> is the field that QueryParser will search if you don't string special = """";if (!txtkeyword.Text.Equals("""")){ special = special + ""(Experience:[1 TO 5])"";}var hits = searcher.Search(queryParser.Parse(special));// Getting result to the listfor (int i = 0; i < hits.Length(); i++){ SearchResults result = new SearchResults(); result.Skillsummarry = hits.Doc(i).GetField(""JS_Skill_Summary"").StringValue(); result.Experience = hits.Doc(i).GetField(""Experience"").StringValue(); result.Profile_Id = hits.Doc(i).GetField(""Prof_ID"").StringValue(); results.Add(result);}GridView1.DataSource = results;GridView1.DataBind();",Why is Lucene numeric range search not working?
Prevent same child window multiple times in MDI form - c# application," I am working on c# desktop application, In MDI form the same child window getting opened when you click on menu, while first instance of that window is present.How can I prevent these multiple instances of child windows in MDI form? <code> ",Prevent same child window multiple times in MDI form
C# - Fastes Way To Sort Array Of Primitives In My Own Code?," I need a float[] to be sorted. And I need to know where the old indices are in new array. That's why I can't use Array.Sort(); or whatever. So I would like to write a function that sorts the array for me and remembers from what index it took each value: Size of arrays would be around 500. How should I approach this ? What sorting algorithm etc.After solved: It always surprises me how powerful C# is. I didn't even though of it being able to do that task on it's own. And since I already heard that Array.Sort() is very fast I'll take it. <code>  float[] input = new float[] {1.5, 2, 0, 0.4, -1, 96, -56, 8, -45};// sortfloat[] output; // {-56, -45, -1, 0, 0.4, 1.5, 2, 8, 96};int[] indices; // {6, 8, 4, 2, 3, 0, 1, 7, 5};",C# - Fastest Way To Sort Array Of Primitives And Track Their Indices
C# - Fastest Way To Sort Array Of Primitives In My Own Code?," I need a float[] to be sorted. And I need to know where the old indices are in new array. That's why I can't use Array.Sort(); or whatever. So I would like to write a function that sorts the array for me and remembers from what index it took each value: Size of arrays would be around 500. How should I approach this ? What sorting algorithm etc.After solved: It always surprises me how powerful C# is. I didn't even though of it being able to do that task on it's own. And since I already heard that Array.Sort() is very fast I'll take it. <code>  float[] input = new float[] {1.5, 2, 0, 0.4, -1, 96, -56, 8, -45};// sortfloat[] output; // {-56, -45, -1, 0, 0.4, 1.5, 2, 8, 96};int[] indices; // {6, 8, 4, 2, 3, 0, 1, 7, 5};",C# - Fastest Way To Sort Array Of Primitives And Track Their Indices
C# Linq IQueryable.Distinct() vs List<T>.Distinct()," I have a linq query that I am using Distinct() on. If I just call Distinct() without converting to a List then it does not return a distinct list - it still contains duplicates.However if I convert to a List and then call Distinct() - it works as expected and I only get unique objects.I'm using Telerik ORM and the objects being returned are the class representing one of the tables in the database. The code above does not produce distinct results, however when I convert to a list and call distinct - it does: I suspect this has to do with the collection before being converted to a list, comparing references to objects rather than the object data itself but I do not fully understand what is going on - why does the fist code example not produce unique results and what happens to the collection when using .ToList() that makes it work?[EDIT] I've simplified the above queries, in the real world the query has several joins which generates non-unique results, however I am returning just the User objects.I tried overriding the Equals and GetHashCode methods but this did not make any difference. [UPDATE]Having run the same query in LinqPad, it works as expected providing a list of distinct entries. However running the same query in LinqPad when using the Telerik ORM dll I get multiple entries. So it appears to be a peculiarity with Telerik. When I have time I will investigate further and raise it with Telerik support. <code>  var uniqueUsers = (from u in Database.Users select u).Distinct(); var uniqueUsers = (from u in Database.Users select u).ToList().Distinct(); public override bool Equals(object obj){ User comparingObject = obj as User ; if (comparingObject == null) { return false; } else { return comparingObject.UserID.Equals(this.UserID); }}public override int GetHashCode(){ return this.UserID.GetHashCode();}",IQueryable.Distinct() vs List.Distinct()
IQueryable.Distinct() vs List<T>.Distinct()," I have a linq query that I am using Distinct() on. If I just call Distinct() without converting to a List then it does not return a distinct list - it still contains duplicates.However if I convert to a List and then call Distinct() - it works as expected and I only get unique objects.I'm using Telerik ORM and the objects being returned are the class representing one of the tables in the database. The code above does not produce distinct results, however when I convert to a list and call distinct - it does: I suspect this has to do with the collection before being converted to a list, comparing references to objects rather than the object data itself but I do not fully understand what is going on - why does the fist code example not produce unique results and what happens to the collection when using .ToList() that makes it work?[EDIT] I've simplified the above queries, in the real world the query has several joins which generates non-unique results, however I am returning just the User objects.I tried overriding the Equals and GetHashCode methods but this did not make any difference. [UPDATE]Having run the same query in LinqPad, it works as expected providing a list of distinct entries. However running the same query in LinqPad when using the Telerik ORM dll I get multiple entries. So it appears to be a peculiarity with Telerik. When I have time I will investigate further and raise it with Telerik support. <code>  var uniqueUsers = (from u in Database.Users select u).Distinct(); var uniqueUsers = (from u in Database.Users select u).ToList().Distinct(); public override bool Equals(object obj){ User comparingObject = obj as User ; if (comparingObject == null) { return false; } else { return comparingObject.UserID.Equals(this.UserID); }}public override int GetHashCode(){ return this.UserID.GetHashCode();}",IQueryable.Distinct() vs List.Distinct()
List traversal c#," I've recently started a project that involves using data from a London Ungerground dataset, in order to find routes that are n amount of minutes from a given station. So far I have been able to parse in the data from the dataset, and create possible routes between each station. I have now a list of route objects which have the following properties: The data I currently have, using VICTORIA as a starting station is:i've formatted my output to make it easier to read, but each line is a representation of a route object. So you have the starting station, the time, the next station, and the line. What would be the best method to gather all the possible routes, from VICTORIA?For example: <code>  Parent - the first stationChild - the next linked stationLine - whichever line the station is onTime - the time between the two stations VICTORIA => 1 <= PIMLICO : VictoriaVICTORIA => 2 <= GREEN PARK : VictoriaVICTORIA => 2 <= ST JAMES PARK : CircleVICTORIA => 2 <= SLOANE SQUARE : CirclePIMLICO => 2 <= VAUXHALL : VictoriaGREEN PARK => 2 <= OXFORD CIRCUS : VictoriaGREEN PARK => 1 <= WESTMINSTER : JubileeGREEN PARK => 2 <= BOND STREET : JubileeGREEN PARK => 1 <= PICCADILLY CIRCUS : PiccadillyGREEN PARK => 1 <= HYDE PARK CORNER : PiccadillyST JAMES PARK => 1 <= WESTMINSTER : CircleSLOANE SQUARE => 1 <= SOUTH KENSINGTON : CircleVAUXHALL => 2 <= STOCKWELL : VictoriaVAUXHALL => 2 <= PIMLICO : VictoriaOXFORD CIRCUS => 1 <= PICCADILLY CIRCUS : BakerlooOXFORD CIRCUS => 2 <= REGENTS PARK : BakerlooOXFORD CIRCUS => 2 <= TOTTENHAM COURT ROAD : CentralOXFORD CIRCUS => 1 <= BOND STREET : CentralOXFORD CIRCUS => 2 <= GREEN PARK : VictoriaOXFORD CIRCUS => 1 <= WARREN STREET : Victoria VICTORIA > GREEN PARK > WESTMINSTERVICTORIA > GREEN PARK > BOND STREETVICTORIA > PIMLICO > VAUXHALL",How do I do list traversal?
Is there any benefit of call ing .Any() before .ForEach() when using linq?," I have many methods like the one below: As you can see, I check if nodesWithRules has any items and exit the method before conducting the foreach statement, but is this unecessary code? <code>  void ValidateBuyerRules() { var nodesWithRules = ActiveNodes.Where(x => x.RuleClass.IsNotNullOrEmpty()); **if (!nodesWithRules.Any()) return;** foreach (var ruleClass in nodesWithRules) { // Do something here } }",Is there any benefit to calling .Any() before .ForEach() when using linq?
How to handle no matches case in List.Find in c#?," In IEnumerable.First function, how do I handle the case if there are no matches? Currently it just crashes... Error Message: Sequence contains no matching element Stacktrace: at System.Linq.Enumerable.First[TSource](IEnumerable1 source, Func2 predicate) <code>  MySPListItem firstItem = itemCollection.First(item => !item.isFolder);if (firstItem != null){ TreeNode firstNode = GetNodeByListItem(my_treeview.Nodes, firstItem, ReportObject); if (firstNode != null) { ReportObject.log(""Selecting the first PDF""); selectPDF(my_treeview, firstNode, queryStr_param); }}",How to handle no matches case in List.First in c#?
c#  cant Copy c:\windows\regedit.exe. How can i disable redirection on win64," I want to copy c:\Windows\regedit.exe to same directory with regedit2.exe name But when I try to copy it,I take an error which say regedit.exe file not found"" or sometimes copy it to under windows\SysWOW64 directory. And actually I know win64 is redirecting it But how can I disable redirecting and copy windows/regedit.exe to windows/regedit2.exe. My sample code is s there any one who can help me <code>  if(File.Exists(@""c:\Windows\regedit.exe""))try{File.Copy(@""c:\Windows\regedit.exe"", @""c:\Windows\regedit2.exe"", true);}catch (Exception ex){}",How can disable redirection on win64
Only one concurrent login per user," Is it possible to allow only one concurrent login per user in ASP.NET web application? I am working on a web application in which I want to make sure that the website allows only one login per user at a time. How to check that the current user already logged in or not? Please suggest proper login method by which we can handle this problem. I think we should use SQL Server session state to handle this problem. What do you suggest?I thought of one solution for it. We can do something like:When the user logs into the system then we insert session id in user column. (We will use database session so that we can get all session related data like isexpired, expiredatetime etc easily).When the same user tries to login a second time then we will check for that session id column and check that session is already expired or not. If session is not expired then we will not allow user to login. Update user session ID every time when user logs out.Please suggest whether this is the proper way or not. <code> ",Allow only one concurrent login per user in ASP.NET
Only one concurrent login per user in Asp.net," Is it possible to allow only one concurrent login per user in ASP.NET web application? I am working on a web application in which I want to make sure that the website allows only one login per user at a time. How to check that the current user already logged in or not? Please suggest proper login method by which we can handle this problem. I think we should use SQL Server session state to handle this problem. What do you suggest?I thought of one solution for it. We can do something like:When the user logs into the system then we insert session id in user column. (We will use database session so that we can get all session related data like isexpired, expiredatetime etc easily).When the same user tries to login a second time then we will check for that session id column and check that session is already expired or not. If session is not expired then we will not allow user to login. Update user session ID every time when user logs out.Please suggest whether this is the proper way or not. <code> ",Allow only one concurrent login per user in ASP.NET
"special symbols in .net and IndexOf, maybe bug in .net?"," I found an interesting bug, maybe even in .net (haven't try this in mono yet).IndexOf() method of string instance is returning signed values (-1 or lower) for certain special symbols,for example I had a string which contained some special unicode characters and somewhere inside of this string was colon which I was looking for. Calling IndexOf("" :"") for a line that surely contains "" :"" returned signed valueI will try to paste this string here, but given the special symbols it may be hard:hitchcock.freenode.net 322 petan #hobbiton 5 : > Good luck axa!Is there a way to work around this? <code> ",special symbols in .net and IndexOf
C# System.Threading.Tasks.task does not contain a definition for Run," I got this program that gives me syntax error ""System.Threading.Tasks.task does not contain a definition for Run.""I am using VB 2010 .NET 4.0Any ideas? any replacements for Run in .net 4.0? <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading;using System.Threading.Tasks;namespace ChatApp{class ChatProg{ static void Main(string[] args) { Task<int> wakeUp = DoWorkAsync(2000,""Waking up""); Task.WaitAll(wakeUp); } static Task<int> DoWorkAsync(int milliseconds, string name) { //error appears below on word Run return Task.Run(() => { Console.WriteLine(""* starting {0} work"", name); Thread.Sleep(milliseconds); Console.WriteLine(""* {0} work one"", name); return 1; }); }}}",What is a replacement method for Task.Run in .NET 4.0 using C#?
C# 'System.Threading.Tasks.Task' does not contain a definition for 'Run'," I got this program that gives me syntax error ""System.Threading.Tasks.task does not contain a definition for Run.""I am using VB 2010 .NET 4.0Any ideas? any replacements for Run in .net 4.0? <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading;using System.Threading.Tasks;namespace ChatApp{class ChatProg{ static void Main(string[] args) { Task<int> wakeUp = DoWorkAsync(2000,""Waking up""); Task.WaitAll(wakeUp); } static Task<int> DoWorkAsync(int milliseconds, string name) { //error appears below on word Run return Task.Run(() => { Console.WriteLine(""* starting {0} work"", name); Thread.Sleep(milliseconds); Console.WriteLine(""* {0} work one"", name); return 1; }); }}}",What is a replacement method for Task.Run in .NET 4.0 using C#?
'System.Threading.Tasks.Task' does not contain a definition for 'Run' in C#," I got this program that gives me syntax error ""System.Threading.Tasks.task does not contain a definition for Run.""I am using VB 2010 .NET 4.0Any ideas? any replacements for Run in .net 4.0? <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading;using System.Threading.Tasks;namespace ChatApp{class ChatProg{ static void Main(string[] args) { Task<int> wakeUp = DoWorkAsync(2000,""Waking up""); Task.WaitAll(wakeUp); } static Task<int> DoWorkAsync(int milliseconds, string name) { //error appears below on word Run return Task.Run(() => { Console.WriteLine(""* starting {0} work"", name); Thread.Sleep(milliseconds); Console.WriteLine(""* {0} work one"", name); return 1; }); }}}",What is a replacement method for Task.Run in .NET 4.0 using C#?
Syntax error serializing Model to JSON," This line is giving me a syntax error in Visual Studio 2012 (literally just 'Syntax Error'): Model in this case is the instance of @model MyApp.ViewModels.MyViewModel declared at the top of my cshtml.My model is serialized properly into the data var, and the application works correctly. Cosmetically it's just annoying to have the error permanently in my error list.How should I modify the line so that the compiler is happy?edit: As requested, more context. Here's the entire $(document).ready(): <code>  var data = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model)); <script type=""text/javascript""> $(document).ready(function () { $('#ReportDate').datepicker(); $('#DispositionDate').datepicker(); var data = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model)); var vm = new NonconformingProductViewModel(data); ko.applyBindingsWithValidation(vm); // validate on page load so all reqd fields are highlighted. var valid = ko.validation.group(vm, {deep: true}); valid.showAllMessages(true); }); // end document.ready</script>",Razor syntax error serializing ASP.NET Model to JSON with Html.Raw
Razor syntax error serializing ASP.NET Model to JSON," This line is giving me a syntax error in Visual Studio 2012 (literally just 'Syntax Error'): Model in this case is the instance of @model MyApp.ViewModels.MyViewModel declared at the top of my cshtml.My model is serialized properly into the data var, and the application works correctly. Cosmetically it's just annoying to have the error permanently in my error list.How should I modify the line so that the compiler is happy?edit: As requested, more context. Here's the entire $(document).ready(): <code>  var data = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model)); <script type=""text/javascript""> $(document).ready(function () { $('#ReportDate').datepicker(); $('#DispositionDate').datepicker(); var data = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model)); var vm = new NonconformingProductViewModel(data); ko.applyBindingsWithValidation(vm); // validate on page load so all reqd fields are highlighted. var valid = ko.validation.group(vm, {deep: true}); valid.showAllMessages(true); }); // end document.ready</script>",Razor syntax error serializing ASP.NET Model to JSON with Html.Raw
c# addition with nullable decimals and precedence of ?? operator," Assume a C# program with two nullable decimal properties A and B. The following addition returns the value of A only:var result = A ?? 0 + B ?? 0;The correct usage is:var result = (A ?? 0) + (B ?? 0);Sample console program: My question is what happens during the calculation with result1. How is the precedence of the + and ?? operators? <code>  class Program{ static void Main(string[] args) { A = (decimal)0.11; B = (decimal)0.69; NullableDecimalAddition(); Console.ReadLine(); } public static decimal? A { get; set; } public static decimal? B { get; set; } private static void NullableDecimalAddition() { decimal result1 = A ?? 0 + B ?? 0; decimal result2 = (A ?? 0) + (B ?? 0); Console.WriteLine(""result1: "" + result1); // = 0.11 Console.WriteLine(""result2: "" + result2); // = 0.80 }}",C# addition with nullable decimals and precedence of ?? operator
Comparing dates uf unspecified/UTC kind formats," I have 2 DateTime values:date1 <- {15-07-13 20:45:10} with Kind = Unspecifieddate2 <- {15-07-13 20:45:10} with Kind = UTCWhen comparing these 2 dates, the 2 dates are equal. Can someone can explain why?A little bit more strange to me: when converting the date1 (which is Unspecified kind) to UTC, I clearly see that the date is different:date1.ToUniversalTime() --> {15-07-13 18:45:10} with Kind = UTC <code>  if (DateTime.Compare(date1, date2)!=0) ...",Comparing DateTimes with Unspecified and UTC kinds
Comparing DateTimes with Unspecified or UTC kinds," I have 2 DateTime values:date1 <- {15-07-13 20:45:10} with Kind = Unspecifieddate2 <- {15-07-13 20:45:10} with Kind = UTCWhen comparing these 2 dates, the 2 dates are equal. Can someone can explain why?A little bit more strange to me: when converting the date1 (which is Unspecified kind) to UTC, I clearly see that the date is different:date1.ToUniversalTime() --> {15-07-13 18:45:10} with Kind = UTC <code>  if (DateTime.Compare(date1, date2)!=0) ...",Comparing DateTimes with Unspecified and UTC kinds
Can I populate a list of my own class dicretly in LINQ?," This is the example: but it says acnnot convert Anonymous type #1 to FotoLiveLove. <code>  public class FotoLiveLove{ public string Tipologia { get; set; } public string URL { get; set; }}IList<FotoLiveLove> fotoLiveLove = xDoc[""statuses""].Select(x => new{ Tipologia = ""twitter"", URL = (string)x[""URLJSON""]}).ToList(); ",Can I populate a list of my own class directly in LINQ?
Automapper resolver calling database?," Is there another way to handle calling the database when needing to lookup values for mapping? It just seems ugly to have database calls within mapping logic. How else is this handled?For example, a table stores a SEXID so using the resolver below I can do something like this DataAccess: <code>  CreateMap<StagingPerson, Person>() .ForMember( dest => dest.SEXID, m => m.ResolveUsing<SexLookupResolver>().FromMember( src => src.Gender ) ); public class SexLookupResolver : ValueResolver<string, int>{protected override int ResolveCore( string source ){ int id = -1; if (source == ""Male"") id = dataAccess.GetGenderByString(""M""); else if(source == ""Female"") id = dataAccess.GetGenderByString(""F""); else if(source == ""?"") id = dataAccess.GetGenderByString(""?""); else id = dataAccess.GetGenderByString(""?""); return id;}} public int GetGenderByString(string gender){ string sql = ""select sexid from Sexes where sex = '"" + gender ""'""; int sexid = ..... ...... return sexid;}",Automapper database lookups?
Does Try Catch outside of: await Task.Run(() => make sense or just use them only inside of await?, Does try catch outside of: await Task.Run(() => make sense or just use them only inside of await? <code>  private async void Test(){ try { await Task.Run(() => { try { DoingSomething(); } catch (Exception ex) { log.Error(ex.Message); } }); } catch (Exception ex) { log.Error(ex.Message); }},Try Catch outside of: await Task.Run(()
how to check if a column exist in a datatable, I have a datable generated with the content of a csv file. I use other information to map some column of the csv (now in the datatable) to information the user is required to fill.In the best world the mapping would be alway possible. But this is not reality... So before I try to map the datatable column value I would need to check if that column even exist. If I don't do this check I have an ArgumentException.Of course I can check this with some code like this : but I have for now 3 columns to map and some or all might be existing/missingIs there a good way to check if a column exist in a datatable? <code>  try{ //try to map here.}catch (ArgumentException){ },How to check if a column exists in a datatable
WPF : Fill the outside of a rectangle," I would like to draw a rectangle in WPF (by code) and to fill the outside of it.Here is an example :The outside of the rectangle is grey (with low opacity), and the fill of the rectangle is trasparent. <code> ",Fill the outside of a rectangle
RestSharp - Authorization Header not coming across to WcfRestContrib service," I am trying to call a locally hosted WCF REST service over HTTPS with basic auth.This works and the Authorization header comes thru just fine and all is happy: When I try to use RestSharp however, the Authorization header never comes thru on the request: What am i doing wrong with the RestSharp method?I know that the AddHeader method works because this: will come thru, only ""Authorization"" seems stripped out/missing. <code>  ServicePointManager.ServerCertificateValidationCallback = ValidateServerCertficate;var request = (HttpWebRequest)WebRequest.Create(""https://localhost/MyService/MyService.svc/"");request.Method = ""GET"";request.ContentType = ""application/json"";request.Headers.Add( System.Net.HttpRequestHeader.Authorization, ""Basic "" + this.EncodeBasicAuthenticationCredentials(""UserA"", ""123""));WebResponse webResponse = request.GetResponse();using (Stream webStream = webResponse.GetResponseStream()){ if (webStream != null) { using (StreamReader responseReader = new StreamReader(webStream)) { string response = responseReader.ReadToEnd(); } }} ServicePointManager.ServerCertificateValidationCallback = ValidateServerCertficate;var credentials = this.EncodeBasicAuthenticationCredentials(""UserA"", ""123"");var client = new RestSharp.RestClient(""https://localhost/MyService/MyService.svc/""); var restRq = new RestSharp.RestRequest(""/"");restRq.Method = Method.GET;restRq.RootElement = ""/"";restRq.AddHeader(""Authorization"", ""Basic "" + credentials);var restRs = client.Execute(restRq); restRq.AddHeader(""Rum"", ""And Coke"");",RestSharp - Authorization Header not coming across to WCF REST service
C#: adding (BezierSegment to a) Path to Canvas," I'm currently trying to add a BezierSegment to my canvas for my WPF. I'm getting a compile time error of an improper cast: Argument 1: cannot convert from 'System.Windows.Media.PathGeometry' to 'System.Windows.UIElement'This is what I have so far... Any help would be greatly appreciated!  <code>  //bezier curve it BezierSegment curve = new BezierSegment(startPoint, endPoint,controlPoint,false);// Set up the Path to insert the segmentsPathGeometry path = new PathGeometry();PathFigure pathFigure = new PathFigure();pathFigure.StartPoint = hs.LeStartingPoint;pathFigure.IsClosed = true;path.Figures.Add(pathFigure);pathFigure.Segments.Add(curve);System.Windows.Shapes.Path p = new Path();p.Data = path;this.mainWindow.MyCanvas.Children.Add(path);",Adding (BezierSegment to a) Path to Canvas
Refresh a asp.net page on button click, I need to refresh a page on button click without increasing the hit counter. <code> ,Refresh an asp.net page on button click
"What does C#'s double[,,] represent?"," In answering a question about double[,], I added a screenshot of LINQPad's output for that data structure:However, I got to wondering what a double[,,] looks like, and LINQPad won't visualize it for me. Additionally, I don't understand the format of the data which goes into it: Can anyone visualize this for me? <code>  int[,,] foo = new int[,,] { { { 2, 3}, { 3, 4} }, { { 3, 4}, { 1, 5} } };","What does double[,,] represent?"
Converting Stream to String and Back...what are we missing?," I want to serialize objects to strings, and back.We use protobuf-net to turn an object into a Stream and back, successfully.However, Stream to string and back... not so successful. After going through StreamToString and StringToStream, the new Streamisn'tdeserialized by protobuf-net; it raises an Arithmetic Operation resulted in an Overflow exception. If we deserialize the original stream, it works.Our methods: Our example code using these two: <code>  public static string StreamToString(Stream stream){ stream.Position = 0; using (StreamReader reader = new StreamReader(stream, Encoding.UTF8)) { return reader.ReadToEnd(); }}public static Stream StringToStream(string src){ byte[] byteArray = Encoding.UTF8.GetBytes(src); return new MemoryStream(byteArray);} MemoryStream stream = new MemoryStream();Serializer.Serialize<SuperExample>(stream, test);stream.Position = 0;string strout = StreamToString(stream);MemoryStream result = (MemoryStream)StringToStream(strout);var other = Serializer.Deserialize<SuperExample>(result);",Converting Stream to String and back...what are we missing?
How to combine operator in condition statement," Instead of I like to combine them similar to the following (which doesn't work): Is that possible? <code>  if (foo == ""1"" || foo == ""5"" || foo == ""9"" ... ) if (foo == (""1"" || ""5"" || ""9"" ... ))",How to combine || operators in condition statement
The server is not operational -- C#," This is the code I'm using to connecting to LDAP I get ""The server is not operational"" error message when I run the code.Can someone please tell me where I'm doing it wrong.And is there anyway to replace the above code with direct LDAP query. <code>  using (DirEntry = new DirectoryEntry(string.Format(""LDAP://{0}/{1}"", this.Host, ServerName))) { DirEntry.RefreshCache(); if (!string.IsNullOrEmpty(UserName)) { DirEntry.Username = UserName; DirEntry.Password = PassWord; } if (DirEntry.Properties.Contains(""objectGUID"")) { byte[] guiddatet = (byte[])DirEntry.Properties[""objectGUID""].Value; return new Guid(guiddatet); }",The server is not operational
Auto generated help pages and custom status codes," I would appreciate some clarification about web api auto generated help pages.As far as I could understand, if I return a Type it will auto generate the help page for that action with an example. But if I use HttpResponseMessage than it's understandable that it cannot guess what the response will be and can only make assumptions on the request parameters.The reason I was using the HttpResponseMessage was because it was recommended to indicate the status code you wish to return when it may be different than 200.So what's the best practice approach to be able to return your desired status codes, but still have the help pages working out the types you are returning? <code> ",Auto generated help pages with return type HttpResponseMessage
Constantly monitor something?," I am designing a program that depends on monitoring the battery level of the computer.This is the C# code I am using: My failed attempt of the while statement, it uses all the CPU which is undesirable. How do I monitor this constantly with an infinite loop so that when it reaches 75% it will execute some code. <code>  PowerStatus pw = SystemInformation.PowerStatus; if (pw.BatteryLifeRemaining >= 75) { //Do stuff here } int i = 1; while (i == 1) { if (pw.BatteryLifeRemaining >= 75) { //Do stuff here } }","C#, Constantly monitor battery level"
Can I insert a large text value into MSSQL from ASP.net without having the whole file in memory on the webserver?," As it says in the question, given a large text file, how can I get its contents into a nvarchar(max) column in sql server without loading the entire file contents into memory (either to build a dynamic sql statement or as a SP parameter)?My best solution so far is to insert a row with an empty value and then in a loop run updates appending chunks of the data each time in a transaction. Is there a better way other than copying the file to the database server and using BCP? Some way to stream the data over? <code> ",Can I insert a large text value into SQL Server from ASP.net without having the whole file in memory on the webserver?
Why did Marshal.SizeOf() lie to me?," Consider this code: it throws the exception: An unhandled exception of type 'System.ArgumentException' occurred in TestConsole.exe Additional information: Type 'TestConsole.Program+MyEnum' cannot be marshaled as an unmanaged structure; no meaningful size or offset can be computed.While this code doesn't throw an exception and size contains 4: Can anyone explain why the .NET framework can't figure out that the enum is 4 bytes in the first sample code?UPDATEMarshal.Sizeof() failed on me in this generic method: And the compiler didn't complain about enum not being a struct.SOLUTIONI could refactor my generic method to make it work for both struct and enum: <code>  public enum MyEnum { V1, V2, V3 }int size = Marshal.SizeOf(typeof(MyEnum)); public enum MyEnum { V1, V2, V3 }public struct MyStruct{ public MyEnum en;}int size = Marshal.SizeOf(typeof(MyStruct)); public bool IoControlReadExact<T>(uint ioControlCode, out T output) where T : struct{ output = new T(); int outBufferSize = Marshal.SizeOf(typeof(T)); IntPtr outBuffer = Marshal.AllocHGlobal(outBufferSize); if (outBuffer == IntPtr.Zero) return false; try { uint bytesReturned; return IoControlRead(ioControlCode, outBuffer, (uint)outBufferSize, out bytesReturned) && ((uint)outBufferSize == bytesReturned); } finally { output = (T)Marshal.PtrToStructure(outBuffer, typeof(T)); Marshal.FreeHGlobal(outBuffer); }} // determine the correct output type:Type outputType = typeof(T).IsEnum ? Enum.GetUnderlyingType(typeof(T)) : typeof(T);//...int outBufferSize = Marshal.SizeOf(outputType);//...output = (T)Marshal.PtrToStructure(outBuffer, outputType);",Marshal.SizeOf throws ArgumentException on enums
Why does Marshal.SizeOf throw ArgumentException on enums?," Consider this code: it throws the exception: An unhandled exception of type 'System.ArgumentException' occurred in TestConsole.exe Additional information: Type 'TestConsole.Program+MyEnum' cannot be marshaled as an unmanaged structure; no meaningful size or offset can be computed.While this code doesn't throw an exception and size contains 4: Can anyone explain why the .NET framework can't figure out that the enum is 4 bytes in the first sample code?UPDATEMarshal.Sizeof() failed on me in this generic method: And the compiler didn't complain about enum not being a struct.SOLUTIONI could refactor my generic method to make it work for both struct and enum: <code>  public enum MyEnum { V1, V2, V3 }int size = Marshal.SizeOf(typeof(MyEnum)); public enum MyEnum { V1, V2, V3 }public struct MyStruct{ public MyEnum en;}int size = Marshal.SizeOf(typeof(MyStruct)); public bool IoControlReadExact<T>(uint ioControlCode, out T output) where T : struct{ output = new T(); int outBufferSize = Marshal.SizeOf(typeof(T)); IntPtr outBuffer = Marshal.AllocHGlobal(outBufferSize); if (outBuffer == IntPtr.Zero) return false; try { uint bytesReturned; return IoControlRead(ioControlCode, outBuffer, (uint)outBufferSize, out bytesReturned) && ((uint)outBufferSize == bytesReturned); } finally { output = (T)Marshal.PtrToStructure(outBuffer, typeof(T)); Marshal.FreeHGlobal(outBuffer); }} // determine the correct output type:Type outputType = typeof(T).IsEnum ? Enum.GetUnderlyingType(typeof(T)) : typeof(T);//...int outBufferSize = Marshal.SizeOf(outputType);//...output = (T)Marshal.PtrToStructure(outBuffer, outputType);",Marshal.SizeOf throws ArgumentException on enums
Make a StackPanell Orientation Horizontal in WPF," I have this xaml code in a View The ItemSource of the ListView is bound to a List in my ViewModel (as shown in the code)When I run the application all my TextBlocks are shown vertically even though I have set the Orientation of the inner StackPanel to Horizontal. <code>  <StackPanel> <Button Content=""I am IRON"" /> <ListView ItemsSource=""{Binding Path=MeasuringDeviceCommunicators}""> <ListView.ItemTemplate> <DataTemplate> <StackPanel Orientation=""Horizontal""> <TextBlock Text=""{Binding Path=Name}""/> </StackPanel> </DataTemplate> </ListView.ItemTemplate> </ListView></StackPanel>",Make a StackPanel Orientation Horizontal in WPF
How to filter dynamically using c# xelement linq," I have done my searching and was not able to find a solution to problem that I have.I'm a bit new to c#.net. Here is my problem. I am trying to dynamically filter xelement.The number of attribute and the value of the attributes are not known, and will depend on some other routine/process.these my attribute name to filter, can be one or more attribute to filter. my xml file is in this form: I can filter succesfully if i hardcoded something like this However, this is not what I want, because I will not know which attribute do I exactly want to filter. It will be generated dynamically.For example, at run time, attribute that I want to filters are techcode and productgroup only. Would any kind soul help me to provide suggestion. <code>  string[] param = new string[] { ""techcode"", ""productgroup"", ""photolayer"" } <?xml version=""1.0"" encoding=""utf-8""?><threads> <thread techcode=""sometech"" productgroup=""pgroup"" photolayer=""player"" biasewma=""-0.05"" /></threads> IEnumerable<XElement> singlethread = (from el in apcxmlstate.Elements(""thread"") where (string)el.Attribute(""techcode"") == somevalue && (string)el.Attribute(""productgroup"") == somevalue && (string)el.Attribute(""photolayer"") == somevalue select el);",How to filter dynamically using c# xelement?
Cast listview to list<string>, How can I cast ListView.Items to a List<string>?This is what I tried: but I received this error: Unable to cast object of type 'System.Windows.Forms.ListViewItem' to type 'System.String'. <code>  List<string> list = lvFiles.Items.Cast<string>().ToList();,Cast ListView Items to List<string>?
Tied/linked objects/classes in C#," Maybe it's a newbie question, but could anyone explain me how the tied/linked classes (I don't know their true names) are made? The example can be LINQ TO XML.When I have the beneath code: I change only element variable (I don't need to update it in doc because its referenced). How to create such classes?[edit]I tried @animaonline's code and it works But tell what's the difference with the code above and below? <code>  XDocument doc = XDocument.Load(""..."");XElement element = doc.Element(""root"");element.SetAttribute(""NewAttribute"", ""BlahBlah"");doc.Save(""...""); A a = new A();B b = a.B(0);b.Name = ""asd"";Console.WriteLine(a.Bs[0].Name); // output ""asd"" List<string> list = new List<string>();list.Add(""test1"");list.Add(""test2"");var test = list.FirstOrDefault();test = ""asdasda"";Console.WriteLine(list[0]); // output ""test1"" - why not ""asdasda"" if the above example works???",Tied/linked objects/classes in C# like LINQ
How to create a service that checks if a USB Stick is plugged or not?," I build a little script that checks if a USB Stick with a given Name ist plugged into the Computer, but now I want to build a service around this Script to watch if the Stick plugged in or not. At first I try to do this with the filewatcher and create a file on the Stick but if remove the stick from the pc and replugged the filewatcher dosent realize it. The following script check one time if the Stick is plugged in or not, but I need a script to loop this DriveInfo.GetDrive function. I dont know if the best way is to buil a 10 second timer loop around this function or if there is any watcher class for removeable devices in the .NET Framework. Here comes the Script: <code>  public static void Main(){ Run();}public static void Run(){ var drives = DriveInfo.GetDrives() .Where(drive => drive.IsReady && drive.DriveType == DriveType.Removable); if (drives.Count() > 0) { foreach (var drive in drives) { if (drive.VolumeLabel == ""TESTLABEL"") Console.WriteLine(""USB Stick is plugged in""); } }}",How to create a watcherprocess to detect a removeable USB Device?
c# objects modification: a strange behaviour...," I'm developing a WPF C# application and I have a strange behaviour in modification of objects. I try to explain it in general way.Suppose that you have an object of a class described as follows: where B is: I pass an instance of A class and an instance of B class from a window to another, only defining two variables of type A and B in the second window and passing them before the Show() method, with the following code, executed into an instance of window FirstWindow: If I have to repeat this code twice(that is, opening twice the window), in the first execution everything works as expected, infact if I modify values in instanceOfB variable, I see the modification also in instanceOfA variable. But, in the second execution, the modification in instanceOfB does not affect instanceOfA...The modifications are done in newWindow. For example: Imagine that you are in the FirstWindow. Click on a button and SecondWindow opens, passing both variables as described above. In SecondWindow, do some modifications, click on OK and SecondWindow closes, returning control to FirstWindow. If I reclick on the same button, I reopen SecondWindow. If I do modifications now, they do not affect both variables.I try to have a look (in VS2012) at both variables in the console with control expression and I see that, in the first pass of code, both variables changes when code above is executed but, in the second pass of code, only instanceOfB changes...EDIT:Following the code that I use to pass parameters to SecondWindow...types are explaind below Consider that obj is given by a button selection into a datagrid, in which each row represents an IntermediatePosition object. In the datagrid, there is a column button and, clicking by buttons, IntermediatePositionsSettingsWindow is opened with the proper dataEDIT:I've performed the folloqing check: where i is the index of related IntermediatePosition object. At first usage of IntermediatePositionsSettingsWindow the objects result equals, but in second usage they are different Why this thing happens? If it is needed any other clarification, I will edit the questionThanks <code>  public class A{ int one; bool two; List<B> listofBObjects;} public class B{ int three; int four;} SecondWindow newWindow = new SecondWindow();newWindow.instanceOfA = this.instanceOfA; //instanceOfA is of type AnewWindow.instanceOfB = this.instanceOfA.listOfBObjects[0]; //instanceOfB is of type BnewWindow.Show(); this.instanceOfB.three++;this.instanceOfB.four--; IntermediatePosition obj = ((FrameworkElement)sender).DataContext as IntermediatePosition; //IntermediatePosition is Class B IntermediatePositionsSettingsWindow ips = new IntermediatePositionsSettingsWindow(); ips.currentIntermediatePosition = obj;//this is the instanceOfB ips.idxOfIpToModify = obj.index; ips.currentSingleProperty = this.currentPropertyToShow; //this is the instanceOfA object ips.sideIndex = this.sideIndex; ips.ShowDialog(); this.currentPropertyToShow.sides[this.sideIndex].intermediatePositionList[i].GetHashCode() == obj.GetHashCode()",c# objects modification: a strange behaviour
When to cleanup static variables?," When can i cleanup objects stored in static variables in C#?I have a static variable that is lazily initialized: Note: That i've just changed Foo to be a static class. It doesn't change the question in any way if Foo is static or not. But some people are convinced that there is no way that an instance of Sqm could be constructed without first constructing an instance of Foo. Even if i did create a Foo object; even if i created 100 of them, it wouldn't help me solve the problem (of when to ""cleanup"" a static member).Sample usage Now, my Sqm class implements a method that must be called when the object is no longer needed, and needs to clean itself up (save state to filing system, release locks, etc). This method must be called before the garbage collectors runs (i.e. before my object's finalizer is called): When, and where, can i call my Shutdown() method? Note: I don't want the developer who uses the Sqm class to have to worry about calling Shutdown. That's not his job. In other language environments he would not have to. The Lazy<T> class does not seem to call Dispose on the Value it lazily owns. So i cannot hook the IDisposable pattern - and use that as the time to call Shutdown. I need to call Shutdown myself.But when?It's a static variable, it exists once for the life of the application/domain/appdomain/apartment.Yes, the finalizer is the wrong timeSome people do understand, and some people don't, that trying to upload my data during a finalizer is wrong. Why is it wrong? Because values might not be there anymore. You don't control what objects are finalized in what order. It is entirely possible that values was finalized before the containing Sqm.What about dispose?The IDisposable interface, and the Dispose() method is a convention. There is nothing that dictates that if my object implements a Dispose() method that it will ever be called. In fact, i could go ahead and implement it: To the person actually reading the question, you might notice that i didn't actually change anything. The only thing i did was to change the name of a method from Shutdown to Dispose. The Dispose pattern is simply a convention. i still have the problem: when can i call Dispose?Well you should call dispose from your finalizerCalling Dispose from my finalizer is just as incorrect as calling Shutdown from my finalizer (they are identically wrong): Because, again, values might not be there anymore. For completeness, we can return to the full original correct code: i've come full circle. i have an object which i need to ""cleanup"" before the application domain shuts down. Something inside my object needs to be notified when it can call Cleanup.Make the developer call itNo.i'm migrating existing concepts from another language into C#. If a developer happens to use the global singleton instance: then the Sqm class is lazy initialized. In a (native) application, the reference to the object is held. During (native) application shutdown, the variable holding the interface pointer is set to null, and the singleton object's destructor is called, and it can clean itself up.Nobody should ever have to call anything. Not Cleanup, not Shutdown, not Dispose. Shutdown should happen automatically by the infrastructure.What is the C# equivalent of i see myself going away, clean myself up?It's complicated by the fact that if you let the garbage collector collect the object: it's too late. The internal state objects i want to persist are likely already finalized.It would be easy if from ASP.netIf i could guarantee that my class were being used from ASP.net, i could ask the HostingEnvironment to notify before the domain shuts down by registering my object with it: And implement the the Stop method: Except my class doesn't know if i'll be called from ASP.net, or from WinForms, or from WPF, or a console application, or shell extension. Edit: People seem to be confused by what the IDisposable pattern exists for. Removed references to Dispose in order to remove the confusion.Edit 2: People seem to be demanding full, detailed, example code before they will answer the question. Personally i think the question already contains too much example code, as it doesn't serve to help ask the question. And now that i've added sooo much code, the question has been lost. People refuse to answer a question until the question has been justified. Now that it's been justified, nobody will read it.It's like diagnosticsIt's like the System.Diagnostics.Trace class. People call it when they want: and never have to think of it again.And then desperation sets ini was even desperate enough, that i considered hiding my object behind an COM IUnknown interface, which is reference counted And then hopefully i could trick the CLR into decrementing the reference count on my interface. When my reference count becomes zero, i know everything is shutting down.The downside of that is that i cannot make it work. <code>  public class Sqm{ private static Lazy<Sqm> _default = new Lazy<Sqm>(); public static Sqm Default { get { return _default.Value; } }} Foo.Default.TimerStart(""SaveQuestion"");//...snip...Foo.Default.TimerStop(""SaveQuestion""); public class Sqm{ var values = new List<String>(); Boolean shutdown = false; protected void Cleanup(ICollection stuff) { WebRequest http = new HttpWebRequest(); http.Open(""POST"", ""https://stackoverflow.com/SubmitUsageTelemetry""); http.PostBody = stuff; http.Send(); } public void Shutdown() { if (!alreadyShutdown) { Cleanup(values); alreadyShutdown = true; } }} ///WRONG: Don't do this!~Sqm{ Shutdown(_values); //<-- BAD! _values might already have been finalized by the GC!} public class Sqm : IDisposable{ var values = new List<String>(); Boolean alreadyDiposed = false; protected void Cleanup(ICollection stuff) { WebRequest http = new HttpWebRequest(); http.Open(""POST"", ""https://stackoverflow.com/SubmitUsageTelemetry""); http.PostBody = stuff; http.Send(); } public void Dispose() { if (!alreadyDiposed) { Cleanup(values); alreadyDiposed = true; } }} public class Sqm : IDisposable{ var values = new List<String>(); Boolean alreadyDiposed = false; protected void Cleanup(ICollection stuff) { WebRequest http = new HttpWebRequest(); http.Open(""POST"", ""https://stackoverflow.com/SubmitUsageTelemetry""); http.PostBody = stuff; http.Send(); } public void Dispose() { if (!alreadyDiposed) { Cleanup(_values); // <--BUG: _values might already have been finalized by the GC! alreadyDiposed = true; } } ~Sqm { Dispose(); }} public class Sqm : IDisposable{ var values = new List<String>(); Boolean alreadyDiposed = false; protected void Cleanup(ICollection stuff) { WebRequest http = new HttpWebRequest(); http.Open(""POST"", ""https://stackoverflow.com/SubmitUsageTelemetry""); http.PostBody = stuff; http.Send(); } protected void Dispose(Boolean itIsSafeToAlsoAccessManagedResources) { if (!alreadyDiposed) { if (itIsSafeToAlsoAccessManagedResources) Cleanup(values); alreadyDiposed = true; } } public void Dispose() { this.Dispose(true); GC.SuppressFinalize(this); } ~Sqm { Dispose(false); //false ==> it is not safe to access values }} Foo.Sqm.TimerStart(); System.Web.Hosting.HostingEnvironment.RegisterObject(this); public class Sqm : IDisposable, IRegisteredObject{ var values = new List<String>(); Boolean alreadyDiposed = false; protected void Cleanup(ICollection stuff) { WebRequest http = new HttpWebRequest(); http.Open(""POST"", ""https://stackoverflow.com/SubmitUsageTelemetry""); http.PostBody = stuff; http.Send(); } protected void Dispose(Boolean itIsSafeToAlsoAccessManagedResources) { if (!alreadyDiposed) { if (itIsSafeToAlsoAccessManagedResources) Cleanup(values); alreadyDiposed = true; } } public void Dispose() { this.Dispose(true); GC.SuppressFinalize(this); } Sqm { //Register ourself with the ASP.net hosting environment, //so we can be notified with the application is shutting down HostingEnvironment.RegisterObject(this); //asp.net will call Stop() when it's time to cleanup } ~Sqm { Dispose(false); //false ==> it is not safe to access values } // IRegisteredObject protected void Stop(Boolean immediate) { if (immediate) { //i took too long to shut down; the rug is being pulled out from under me. //i had my chance. Oh well. return; } Cleanup(); //or Dispose(), both good }} Trace.WriteLine(""Column sort: {0} ms"", sortTimeInMs); public class Sqm : IUnknown{ IUnknown _default = new Lazy<Sqm>();}",How to get notified before static variables are finalized
Detect Recursive call with Resharper," I want to find all recursive calls in my code.If I open file in Visual Studio, I get ""Recursive call"" icon on left side of Editor. I want to inspect whole solution for such calls.I used Resharper Command Line tools and VS's add-in Resharper - Code Inspection with no luck, this rule is not applied in their ruleset.Is there any way that i could inspect whole solution - i really don't want to open each file and check for that blue-ish ""Recursive call"" icon :)Edit: I am interested in single-level recursion <code> ",Detect Recursive calls in C# code
How to remove a view from region that was added using RequestNavigate?," I am using Prism for navigation in my WPF MVVM application. I register my view as follows. I display this view as follows. Elsewhere in the application, I need to remove this view in an event handler; however, the following code returns an ArgumentNullException. This indicates that the RequestNavigate method does not add MyView to MyRegion using the name ""MyView"". I know that if I were to use the _regionManager.Add(MyView, ""MyView"") method, the GetView method would not return null. Unfortunately, RequestNavigate does not seem to handle the view name in the same way. Is there any way to remove a view (by name) from a region when the view was added using the RequestNavigate method? <code>  // MyView is the data type of the view I want to register and ""MyView""// is the name by which I want the data type to be identified within// the IoC container._container.RegisterType<object, MyView>(""MyView""); _regionManager.RequestNavigate( ""MyRegion"", // This is the name of the Region where the view should be displayed. ""MyView"" // This is the registered name of the view in the IoC container.); _regionManager.Regions[""MyRegion""].Remove( _regionManager.Regions[""MyRegion""].GetView(""MyView""));",Is there any way to remove a view (by name) from a Prism region when the view was added using the RegionManager.RequestNavigate method?
How to find a view by name within a Prism region when that view was added using the RequestNavigate method?," I am using Prism for navigation in my WPF MVVM application. I register my view as follows. I display this view as follows. Elsewhere in the application, I need to remove this view in an event handler; however, the following code returns an ArgumentNullException. This indicates that the RequestNavigate method does not add MyView to MyRegion using the name ""MyView"". I know that if I were to use the _regionManager.Add(MyView, ""MyView"") method, the GetView method would not return null. Unfortunately, RequestNavigate does not seem to handle the view name in the same way. Is there any way to remove a view (by name) from a region when the view was added using the RequestNavigate method? <code>  // MyView is the data type of the view I want to register and ""MyView""// is the name by which I want the data type to be identified within// the IoC container._container.RegisterType<object, MyView>(""MyView""); _regionManager.RequestNavigate( ""MyRegion"", // This is the name of the Region where the view should be displayed. ""MyView"" // This is the registered name of the view in the IoC container.); _regionManager.Regions[""MyRegion""].Remove( _regionManager.Regions[""MyRegion""].GetView(""MyView""));",Is there any way to remove a view (by name) from a Prism region when the view was added using the RegionManager.RequestNavigate method?
How to convert a list into data tabel, I have a data list with some property. I want to convert that list data into data table. How to convert a list into datable.  <code> ,How to convert a list into data table
Random Word Generator Help C#," So I made a pretty simple word generator program in c# that works relatively well. It generates a word based on the length defined by the user. The algorithm adds a consonant and then a vowel for each consecutive letter in the sequence, which isn't ideal, but works well enough for basic words. My only issue is that I told it to add a ""u"" to the letter sequence if a ""q"" shows up right before it, but no matter what I've done it makes the word at least 1 letter too long.I have marked my problem area with a star in the comment above it. Here is the code: <code>  public void WordFinder(){ string word = null; int cons; int vow; //counter int i = 0; bool isword = false; Random rnd = new Random(); //set a new string array of consonants string[] consonant = new string[]{""b"",""c"",""d"",""f"",""g"",""h"",""j"",""k"",""l"",""m"",""n"",""p"",""q"",""r"",""s"",""t"",""v"",""w"",""x"",""y"",""z""}; //set a new string array of vowels string[] vowel = new string[]{""a"",""e"",""i"",""o"",""u""}; while (isword == false) { word = null; Console.WriteLine(""Pick the length of a word""); int num = Convert.ToInt32(Console.ReadLine()); //set the counter ""i"" to 1 i = 1; if (num%2 == 0) { while (i <= num) { if (num != 1) { // current consonant = random consonant cons = rnd.Next(0, 20); // get the consonant from the string array ""consonant"" and add it to word word = word + consonant[cons]; // add 1 to counter i ++; //* if the consonant is ""q"" if (cons == 12) { // add ""u"" right after it word = word + vowel[4]; // add 1 to counter i++; } } vow = rnd.Next(0, 4); word = word + vowel[vow]; i ++; } } if (num % 2 != 0) { while (i <= num - 1) { //repeat same code as done to even length if (num != 1) { cons = rnd.Next(0, 20); word = word + consonant[cons]; i ++; if (cons == 12) { word = word + vowel[4]; i ++; } } vow = rnd.Next(0, 4); word = word + vowel[vow]; i ++; } // if the length is not equal to 1 if (num != 1) { // add a consonant to the end of the word cons = rnd.Next(0, 20); word = word + consonant[cons]; } //if the length is 1 else if (num == 1) { // pick a vowel vow = rnd.Next(0, 4); word = word + vowel[vow]; } } i = 1; Console.WriteLine(word); Console.WriteLine(""Is this a word? (y/n)""); string q = Console.ReadLine(); q = q.ToLower(); //if the answer is yes, then it is a word and end the loop if (q == ""y"" || q == ""yes"") { isword = true; } //if the answer is no try the loop again else if (q == ""n"" || q == ""no"") { isword = false; } }}// main methodstatic void Main(string[] args){ Program prog = new Program(); prog.WordFinder(); //wait for user input Console.ReadLine();}}",Random Word Generator #2
Get a error list after validate xml against a schema file C#," Im validating a XML file against a schema xsd. So far so good, the code generates a exception in case of failure. But I need that the code build a list of all errors found in the validate before send it to my log, instead of always show only the first one found.Any thoughts? <code>  bool isValid = true; List<string> errorList = new List<string>(); try { XmlReaderSettings settings = new XmlReaderSettings(); settings.Schemas.Add(null, schemaFilePath); settings.ValidationType = ValidationType.Schema; XmlDocument document = new XmlDocument(); document.LoadXml(xml); XmlReader rdr = XmlReader.Create(new StringReader(document.InnerXml), settings); while (rdr.Read()) { } } catch (Exception ex) { errorList.Add(ex.Message); isValid = false; } LogErrors(errorList); return isValid;",Get a error list after validate xml against a schema file
"In C#, how to satisfy the compiler when only partially implementing an interface with an abstract class?"," I have an interface here named IFish. I want to derive it with an abstract class (WalkingFishCommon) which provides an incomplete implementation, so that classes derived from WalkingFishCommon do not have to implement the CanWalk property: I've not yet discovered how to make the compiler happy, while still achieving the goal of forcing classes derived from WalkingFishCommon to implement the Swim() method. Particularly baffling is the delta between (1) and (2), where the compiler alternates between complaining that Swim() isn't marked abstract, and in the next breath complains that it can't be marked abstract. Interesting error!Any help? <code>  interface IFish{ bool Swim(); bool CanWalk { get; }}abstract class WalkingFishCommon : IFish{ bool IFish.CanWalk { get { return true; } } // (1) Error: must declare a body, because it is not marked // abstract, extern, or partial // bool IFish.Swim(); // (2) Error: the modifier 'abstract' is not valid for this item // abstract bool IFish.Swim(); // (3): If no declaration is provided, compiler says // ""WalkingFishCommon does not implement member IFish.Swim()"" // {no declaration} // (4) Error: the modifier 'virtual' is not valid for this item // virtual bool IFish.Swim(); // (5) Compiles, but fails to force derived class to implement Swim() bool IFish.Swim() { return true; }}",How to satisfy the compiler when only partially implementing an interface with an abstract class?
Wait for many pulse," How can I wait for n number of pulses? I want the above thread to wait until being notified n times (by n different threads or n times by the same thread).I believe there is a type of counter to do this, but I can't find it. <code>  // do somethingwaiter.WaitForNotifications();",Let a thread wait for n number of pulses
Wait for N amount of pulses," How can I wait for n number of pulses? I want the above thread to wait until being notified n times (by n different threads or n times by the same thread).I believe there is a type of counter to do this, but I can't find it. <code>  // do somethingwaiter.WaitForNotifications();",Let a thread wait for n number of pulses
Prevent connection string from being commited to repository," I'm using GIT repository for my project. In my web.config I have a debug connection string to my local SQL server database. It won't work for anyone else. I cannot just put entire Web.config in .gitignore - the project wouldn't even compile.A perfect solution would be to put the connection string in a separate file and make Web.config load it. Is it possible?If not, is there any other solution? (using sql server CE won't work, because it breaks code first migrations) <code> ",Prevent connection string from being committed to repository
null value in a parameter varbinary datatype," How can I add a null value in a parameter varbinary datatype?When I execute the following code: I get the following System.Data.SqlClient.SqlException: Implicit conversion from data type nvarchar to varbinary(max) is not allowed. Use the CONVERT function to run this query. <code>  using (SqlConnection myDatabaseConnection1 = new SqlConnection(myConnectionString.ConnectionString)){ using (SqlCommand mySqlCommand = new SqlCommand(""INSERT INTO Employee(EmpName, Image) Values(@EmpName, @Image)"", myDatabaseConnection1)) { mySqlCommand.Parameters.AddWithValue(""@EmpName"", textBoxEmpName.Text); mySqlCommand.Parameters.AddWithValue(""@Image"", DBNull.Value); myDatabaseConnection1.Open(); mySqlCommand.ExecuteNonQuery(); }}",Null value in a parameter varbinary datatype
Have model contain attribute without adding it to the database?, In my Asp.NET MVC4 application I want to add a field to my model without adding it to the database.Sort of a field that only lives in c# instances of the model but not in the database itself.Is there any annotation or other way to exclude the field from the database itself?I mean an object I can read and write in runtime which the database has no knowledge of. <code> ,Have model contain field without adding it to the database?
"Syntax error in INSERT INTO statement (ASP.NET, C#)"," Good day. I am trying to make a registration page and have the information stored in a database. I made the database using Microsoft Access. I get: Syntax error in INSERT INTO statementevery time I press the 'Register' button. I have already tried searching on the net with similar problems and found some things like ""Reserved Words"" and ""It must be your spacing"". I did those and it still gives me the error. Am I missing something? Here is the code: <code>  public void InsertRecord(){ OleDbCommand cmd = new OleDbCommand(""INSERT INTO ElemData(StudentID, [Password], [Name], Age, Birthday, Address, FatherName, MotherName, "" + ""GuardianName, Class, Section, Email, PhoneNumber, MobileNumber) "" + ""VALUES (@studentid, @password, @name, @age, @birth, @address, @father, @mother, @guardian, @classs, @section, @email, @phone, @mobile)"", DBConnection.myCon); cmd.Parameters.Add(""@studentid"", OleDbType.VarChar).Value = Studentid; cmd.Parameters.Add(""@password"", OleDbType.VarChar).Value = Password; cmd.Parameters.Add(""@name"", OleDbType.VarChar).Value = Name; cmd.Parameters.Add(""@age"", OleDbType.VarChar).Value = Age; cmd.Parameters.Add(""@birth"", OleDbType.VarChar).Value = Birth; cmd.Parameters.Add(""@address"", OleDbType.VarChar).Value = Address; cmd.Parameters.Add(""@father"", OleDbType.VarChar).Value = Father; cmd.Parameters.Add(""@mother"", OleDbType.VarChar).Value = Mother; cmd.Parameters.Add(""@guardian"", OleDbType.VarChar).Value = Guardian; cmd.Parameters.Add(""@classs"", OleDbType.VarChar).Value = Classs; cmd.Parameters.Add(""@section"", OleDbType.VarChar).Value = Section; cmd.Parameters.Add(""@email"", OleDbType.VarChar).Value = Email; cmd.Parameters.Add(""@phone"", OleDbType.VarChar).Value = Phone; cmd.Parameters.Add(""@mobile"", OleDbType.VarChar).Value = Mobile; if (cmd.Connection.State == ConnectionState.Open) { cmd.Connection.Close(); } DBConnection.myCon.Open(); cmd.ExecuteNonQuery(); DBConnection.myCon.Close();}",Syntax error in INSERT INTO statement using OleDb
Syntax error in INSERT INTO statement using OleDb," Good day. I am trying to make a registration page and have the information stored in a database. I made the database using Microsoft Access. I get: Syntax error in INSERT INTO statementevery time I press the 'Register' button. I have already tried searching on the net with similar problems and found some things like ""Reserved Words"" and ""It must be your spacing"". I did those and it still gives me the error. Am I missing something? Here is the code: <code>  public void InsertRecord(){ OleDbCommand cmd = new OleDbCommand(""INSERT INTO ElemData(StudentID, [Password], [Name], Age, Birthday, Address, FatherName, MotherName, "" + ""GuardianName, Class, Section, Email, PhoneNumber, MobileNumber) "" + ""VALUES (@studentid, @password, @name, @age, @birth, @address, @father, @mother, @guardian, @classs, @section, @email, @phone, @mobile)"", DBConnection.myCon); cmd.Parameters.Add(""@studentid"", OleDbType.VarChar).Value = Studentid; cmd.Parameters.Add(""@password"", OleDbType.VarChar).Value = Password; cmd.Parameters.Add(""@name"", OleDbType.VarChar).Value = Name; cmd.Parameters.Add(""@age"", OleDbType.VarChar).Value = Age; cmd.Parameters.Add(""@birth"", OleDbType.VarChar).Value = Birth; cmd.Parameters.Add(""@address"", OleDbType.VarChar).Value = Address; cmd.Parameters.Add(""@father"", OleDbType.VarChar).Value = Father; cmd.Parameters.Add(""@mother"", OleDbType.VarChar).Value = Mother; cmd.Parameters.Add(""@guardian"", OleDbType.VarChar).Value = Guardian; cmd.Parameters.Add(""@classs"", OleDbType.VarChar).Value = Classs; cmd.Parameters.Add(""@section"", OleDbType.VarChar).Value = Section; cmd.Parameters.Add(""@email"", OleDbType.VarChar).Value = Email; cmd.Parameters.Add(""@phone"", OleDbType.VarChar).Value = Phone; cmd.Parameters.Add(""@mobile"", OleDbType.VarChar).Value = Mobile; if (cmd.Connection.State == ConnectionState.Open) { cmd.Connection.Close(); } DBConnection.myCon.Open(); cmd.ExecuteNonQuery(); DBConnection.myCon.Close();}",Syntax error in INSERT INTO statement using OleDb
(SOLVED) Syntax error in INSERT INTO statement using OleDb," Good day. I am trying to make a registration page and have the information stored in a database. I made the database using Microsoft Access. I get: Syntax error in INSERT INTO statementevery time I press the 'Register' button. I have already tried searching on the net with similar problems and found some things like ""Reserved Words"" and ""It must be your spacing"". I did those and it still gives me the error. Am I missing something? Here is the code: <code>  public void InsertRecord(){ OleDbCommand cmd = new OleDbCommand(""INSERT INTO ElemData(StudentID, [Password], [Name], Age, Birthday, Address, FatherName, MotherName, "" + ""GuardianName, Class, Section, Email, PhoneNumber, MobileNumber) "" + ""VALUES (@studentid, @password, @name, @age, @birth, @address, @father, @mother, @guardian, @classs, @section, @email, @phone, @mobile)"", DBConnection.myCon); cmd.Parameters.Add(""@studentid"", OleDbType.VarChar).Value = Studentid; cmd.Parameters.Add(""@password"", OleDbType.VarChar).Value = Password; cmd.Parameters.Add(""@name"", OleDbType.VarChar).Value = Name; cmd.Parameters.Add(""@age"", OleDbType.VarChar).Value = Age; cmd.Parameters.Add(""@birth"", OleDbType.VarChar).Value = Birth; cmd.Parameters.Add(""@address"", OleDbType.VarChar).Value = Address; cmd.Parameters.Add(""@father"", OleDbType.VarChar).Value = Father; cmd.Parameters.Add(""@mother"", OleDbType.VarChar).Value = Mother; cmd.Parameters.Add(""@guardian"", OleDbType.VarChar).Value = Guardian; cmd.Parameters.Add(""@classs"", OleDbType.VarChar).Value = Classs; cmd.Parameters.Add(""@section"", OleDbType.VarChar).Value = Section; cmd.Parameters.Add(""@email"", OleDbType.VarChar).Value = Email; cmd.Parameters.Add(""@phone"", OleDbType.VarChar).Value = Phone; cmd.Parameters.Add(""@mobile"", OleDbType.VarChar).Value = Mobile; if (cmd.Connection.State == ConnectionState.Open) { cmd.Connection.Close(); } DBConnection.myCon.Open(); cmd.ExecuteNonQuery(); DBConnection.myCon.Close();}",Syntax error in INSERT INTO statement using OleDb
"c# Reactive Extensions / Reactive UI Observe collection, group it, and display it"," I have a specific data set that requires storing data that is both grouped and ordered. Each row then needs to be able to recalculate it's sums whenever any individual item changes.This is the basic look of the end result:The object structure is as such: The view needs to bind to MyObject, then group the Objects property by it's Type property.Now, I've already accomplished this without using reactive extensions, but it feels hackish...I would like to accomplish this by converting the Objects property of MyObject to an observable which should, in theory, allow me to update the sums whenever the Value property of MySubObject changes.I already have the view side of things built, so that's not the issue...it's getting the RX part completed.NOTE:I can alternatively expose my data like this: This would take care of the grouping issue, but I still cannot get it to work <code>  public class MyObject : INotifyPropertyChanged{ public ObservableCollection<MySubObject> Objects { get; set; } public Decimal TotalOfAll { get; set; } /* Ommited INPC and other properties for brevity */}public class MySubObject : INotifyPropertyChanged{ public Decimal Value { get; set; } public String RowType { get; set; } /* Ommited INPC and other properties for brevity */} public class MyObject : INotifyPropertyChanged{ public ObservableCollection<MyRowObject> Objects { get; set; } public Decimal TotalOfAll { get; set; } /* Ommited INPC and other properties for brevity */}public class MyRowObject : INotifyPropertyChanged{ public ObservableCollection<MySubObject> Objects { get; set; } public String RowType { get; set; } public Decimal RowTotal { get; set; } /* Ommited INPC and other properties for brevity */}public class MySubObject : INotifyPropertyChanged{ public Decimal Value { get; set; } /* Ommited INPC and other properties for brevity */}","Reactive Extensions / Reactive UI Observe collection, group it, and display it"
Entity Framework Looking for Column that does not exist," I am getting the message ... *Invalid column name 'PartLot_Id'*I suppose that it is referring to the ID field of the PART_LOT in the databse. Clearly this table, and no others (not as clear but trust me) possess a field ""PartLot_Id"" so on the surface this makes sense.When I wrote the corresponding entity for this table I wanted to make it a little more friendly so I changed the case of the tables and fields, and in some cases rename the fields completely (trying to distinguish business concerns from data). I did, however decorate the class and properties with the approriate attributes which is supposed to signal to EF what the actual names are in the DataStore. This has worked on all my entities up until now. It appears that EF is ignoring these attributes and implementing it's convention whichis, as I understand it, to assume that the Key field name is the Entity Name plus ""Id"".Can anyone shed any light why it seems that these attributes are being ignored?UPDATE@kirtsen g- Thanks for your response. I feel like we might be on the right track or somewhere closer than where Iam now anyway. I am updating the OP with some additional informationm that I originally excluded in an attempt to keep the post clean and as uncluttered as possible. The PartLot IS being references by a navigation property on another entity model, but it is also annotated correctly(?) The ""Lot"" property of the StrategicPart model returns a ""PartLot"" entity (I changed the name to simply ""Lot"" as StrategicPart.PartLot seemed redundant), but I did assign the ForeignKeyAttribute to the ""PartLotId"" in an attempt to override any CodeFirst assumptions/conventions (one of my problems with the convention over configuration model).Ya' know, it just occured to me, and I am not sure if this is potentially important or not, but the StrategicPart entity, and thusly the STRATEGIC_PART table in the database, is actually a join for a many-to-many relationship between Products and PartLots.Thanks again!UPDATE@kirsten_g - Thanks for hanging in there with me!! I have added the Product class as requested. UPDATE : SOLUTIONI figured out the problem thanks to kirsten_g. By asking to see the Product class it occured to me that I had not added a reference to the STRATEGIC_PART (StrategicPart) entity in it. When I added it, it did not help but then I remembered ... STRATEGIC_PART's only purpose is to facilitate a many-to-many join. If I had left EF to create the models itself, it would not bother with Nav Properties to the joining entity. So I manually did the same. Ignoring the StrategicPart entity I added Nav Properties from the two entities directly to each other and removed any Nav Property referencing StrategicPart. So the updated Product and PartLot classes look like ... Now my entities reference each other properly and my error has gone away! I have marked Kirsten_g's answer as the answer with the above extension!Thanks for everybody'd help. I hope that this helps someone else as well.  <code>  [Table(""PART_LOT"")]public partial class PartLot : ModelBase{ [Key] [Column(""ID"")] public Int32 Id { get; set; } [Column(""LOT_IDENT"")] public String LotIdentity { get; set; } [Column(""PART_ID"")] public Guid? PartId { get; set; } [Column(""COMPANYSITE_ID"")] public Guid? CompanySiteId { get; set; } #region Navigation Properties [ForeignKey(""PartId"")] public virtual Part Part { get; set; } [ForeignKey(""CompanySiteId"")] public virtual Company Company { get; set; } public virtual ICollection<StrategicPart> StrategicParts { get; set; } public virtual ICollection<Product> Products{ get; set; } #endregion} [Table(""STRATEGIC_PART"")]public partial class StrategicPart : ModelBase{ [Key] [Column(""ID"")] public Int64 Id { get; set; } [Column(""PRODUCT_ID"")] public Guid ProductId { get; set; } [Column(""PART_LOT_ID"")] public Int32 PartLotId { get; set; } #region Navigation Properties [ForeignKey(""ProductId"")] public virtual Product Product { get; set; } [ForeignKey(""PartLotId"")] public virtual PartLot Lot { get; set; } #endregion} [Table(""PRODUCT"")]public partial class Product : ModelBase{ [Key] [Column(""ID"")] public Guid Id { get; set; } [Column(""MFG_INFO_ID"")] public Guid? ManufacturerInfoId { get; set; } [Column(""MODEL_ID"")] public Guid ModelId { get; set; } [Column(""MODEL_CODE"")] public String ModelCode { get; set; } [Column(""CONFIG_CODE"")] public String ConfigCode { get; set; } [Column(""SERIAL_NUMBER"")] public String SerialNumber { get; set; } [Column(""FULL_SN"")] public String FullSerialNumber { get; set; } [Column(""SW_VERSION"")] public String SoftwareVersion { get; set; } [Column(""REWORKED"")] public Boolean IsReworked { get; set; } [Column(""DATAFILE_ID"")] public Int32 DatafileId { get; set; } [Column(""SILICON_ID"")] public Guid? SiliconId { get; set; } [Column(""IS_PART_EXCEPTION_CALCULATED"")] public Boolean? IsPartExceptionCalculated { get; set; } [Column(""STATUS"")] public String Status { get; set; } [Column(""STATUS_CHANGED_DT"")] public DateTime StatusChangeDate { get; set; } #region Navigation Properties [ForeignKey(""ModelId"")] public virtual ProductModel Model { get; set; } #endregion} [Table(""PRODUCT"")]public partial class Product : ModelBase{ [Key] [Column(""ID"")] public Guid Id { get; set; } // Removed properties for clarity. Still contatins all the properties defined above. #region Navigation Properties [ForeignKey(""ModelId"")] public virtual ProductModel Model { get; set; } // Added Nav Property to PartLots public virtual ICollection<PartLot> PartLots{ get; set; } #endregion}[Table(""PART_LOT"")]public partial class PartLot : ModelBase{ [Key] [Column(""ID"")] public Int32 Id { get; set; } // Removed properties for clarity. Still contatins all the properties defined above. #region Navigation Properties [ForeignKey(""PartId"")] public virtual Part Part { get; set; } [ForeignKey(""CompanySiteId"")] public virtual Company Company { get; set; } // Remove Nav Property to StrategicPart // public virtual ICollection<StrategicPart> StrategicParts { get; set; } public virtual ICollection<Product> Products{ get; set; } #endregion}",Looking for Column that does not exist
"await should throw AggregateException, not just the first Exception"," When awaiting a faulted task (one that has an exception set), await will rethrow the stored exception. If the stored exception is an AggregateException it will rethrow the first and discard the rest.How can we use await and at the same time throw the original AggregateException so that we do not accidentally lose error information?Note, that it is of course possible to think of hacky solutions for this (e.g. try-catch around the await, then call Task.Wait). I really wish to find a clean solution. What is the best-practice here?I thought of using a custom awaiter but the built-in TaskAwaiter contains lots of magic that I'm not sure how to fully reproduce. It calls internal APIs on TPL types. I also do not want to reproduce all of that.Here is a short repro if you want to play with it: Only one of the two exceptions is thrown in Run.Note, that other questions on Stack Overflow do not address this specific problem. Please be careful when suggesting duplicates. <code>  static void Main(){ Run().Wait();}static async Task Run(){ Task[] tasks = new[] { CreateTask(""ex1""), CreateTask(""ex2"") }; await Task.WhenAll(tasks);}static Task CreateTask(string message){ return Task.Factory.StartNew(() => { throw new Exception(message); });}","I want await to throw AggregateException, not just the first Exception"
"Using ? operator: ""only assignment, call, increment..."""," I have action dictionary defined as: I put there actions like: I'm using this code to run it: It works just fine, but I wanted to use '?' notation to make it shorter: This code shows me error: Error 1 Only assignment, call, increment, decrement, and new object expressions can be used as a statementactions[pair.Key](pair.Value, pair.Key) isn't it a call? Am I missing something? Is it possible to use '?' notation with action dictionaries? I was trying to find something about that but it's hard to find anything about '?' operator and this error because '?' is ignored by google. <code>  var actions = new Dictionary<string, Action<string, string>>(); actions.Add(""default"", (value, key) => result.Compare(value, properties[key], Comparers.SomeComparer, key));... if (actions.ContainsKey(pair.Key)){ actions[pair.Key](pair.Value, pair.Key);}else{ actions[""""](pair.Value, pair.Key);} actions.ContainsKey(pair.Key) ? actions[pair.Key](pair.Value, pair.Key) : actions[""""](pair.Value, pair.Key);","Using ternary operator: ""only assignment, call, increment..."""
What this is: pooling=false;?," What does pooling=false in a .NET connection-string for a MySQL database mean?This is the complete connection string: <code>  return new MySqlConnection(""SERVER=localhost;DATABASE=myDataBase;USER=###;PASSWORD=***;POOLING=FALSE;"");","What does ""pooling=false"" in a MySQL connection string mean?"
Example of how to use AutoFixture with NSubstitue," I use NSubstitute a lot. And I love it.I am just looking into AutoFixture. It seems great!I have seen AutoFixture for NSubstitute and seen a few examples in Moq on how to use this feature.But I can't seem to translate it into NSubstitute.I tried this: Using: And I get an object, but none of the properties are populated (kind of the point of AutoFixture).I also tried: That also gave me an object with no populated properties. (Note if I do the above with a PersonEntity class, then the properties are all populated.)I am sure that there is a way to make this work, but I can't seem to find it.So, given my IPersonEntity interface above, does anyone know how to use AutoFixture and NSubstitute to give me a populated IPersonEntity object? <code>  var fixture = new Fixture().Customize(new AutoNSubstituteCustomization()); var addDest = Substitute.For<IPerson>(); public interface IPersonEntity{ int ID { get; set; } string FirstName { get; set;} string LastName { get; set;} DateTime DateOfBirth { get; set; } char Gender { get; set; } } var fixture = new Fixture().Customize(new AutoNSubstituteCustomization());var result = fixture.Create<IPersonEntity>();",Example of how to use AutoFixture with NSubstitute
Why is HttpContext.Current null?," I have the following test WebAPI code, I don't use WebAPI in production but I made this because of a discussion I had on this question: WebAPI Async questionAnyways, here's the offending WebAPI method: I had hereto believed that the second exception is expected because when the await completes, it will likely be on a different thread where HttpContext.Current as a thread-static variable will no longer resolve to the appropriate value. Now, based on the synchronization context, it could actually be forced to go back to the same thread after the await but I'm not doing anything fancy in my test. This is just a plain, naive use of await.In comments in another question I was told that HttpContext.Current should resolve after an await. There's even another comment on this question indicating the same. So what's true? Should it resolve? I think no, but I want an authoritative answer on this because async and await is new enough that I can't find anything definitive.TL;DR: Is HttpContext.Current potentially null after an await? <code>  public async Task<string> Get(int id){ var x = HttpContext.Current; if (x == null) { // not thrown throw new ArgumentException(""HttpContext.Current is null""); } await Task.Run(() => { Task.Delay(500); id = 3; }); x = HttpContext.Current; if (x == null) { // thrown throw new ArgumentException(""HttpContext.Current is null""); } return ""value"";}",Why is HttpContext.Current null after await?
Xamarin - Collaps text," just got Xamarin Studio installed. Looks really cool and looks like it could replace my VS.However, I really enjoyed collapsing my code when some dirty parts began to grow.I used to introduce the code- part with #region and finished it with #endregion. VS would allow me to hide the content.Would be awesome if someone leads me into the right direction! :) <code> ",Xamarin - Collapse text
wpf how to prevent double thickness borders at overlap?," If you have: and put a border of thickness 1 into each grid, you will get double thickness on the border between the grid rows. Is the only way to deal with this to specify the thickness on each edge of the border or is there some control that will create borders around the grid for each column without having double thickness?Currently attempting it with this: However, I started making changes to the old code so this isn'ta really good example of the double borders. However, I am also getting double borders from this template. as each item ends up with a double thickness border where it touches the next item.edit 2: After reading the comments I realized I probably should not have a border defined on the datatemplate for the control and instead just set the border through the control and change the template on the controltemplate. May be getting double borders from that. <code>  <Grid > <Grid.RowDefinitions> <RowDefinition Height=""*""/> <RowDefinition Height=""2*""/> <RowDefinition Height=""*""/> </Grid.RowDefinitions></Grid> <Border BorderBrush=""Black"" BorderThickness=""1"" Margin=""19,0,0,0"" Background=""LightGray"" > <Viewbox VerticalAlignment=""Stretch"" HorizontalAlignment=""Stretch""> <Grid> <Grid.RowDefinitions> <RowDefinition Height=""*""/> <RowDefinition Height=""2*""/> <RowDefinition Height=""*""/> </Grid.RowDefinitions> <Grid.ColumnDefinitions> <ColumnDefinition Width=""*""/> <ColumnDefinition Width=""Auto""/> <ColumnDefinition Width=""Auto""/> </Grid.ColumnDefinitions> <TextBlock Grid.Row=""1"" Grid.Column=""0"" x:Name=""TreeViewHeaderTextBox"" VerticalAlignment=""Center"" HorizontalAlignment=""Center"" Text=""Time"" Foreground=""Black"" /> <TextBlock Grid.Row=""1"" Grid.Column=""1"" Text=""X"" TextAlignment=""Center"" HorizontalAlignment=""Stretch"" VerticalAlignment=""Center"" /> <TextBlock Grid.Row=""1"" Grid.Column=""2"" Text=""O"" TextAlignment=""Center"" HorizontalAlignment=""Stretch"" VerticalAlignment=""Center"" /> </Grid> </Viewbox> </Border> <Border Name=""Bd"" Grid.Column=""1"" Background=""{TemplateBinding Background}"" BorderBrush=""{TemplateBinding BorderBrush}"" BorderThickness=""{TemplateBinding BorderThickness}"" Padding=""{TemplateBinding Padding}"" SnapsToDevicePixels=""true""> <ContentPresenter x:Name=""PART_Header"" ContentSource=""Header"" HorizontalAlignment=""{TemplateBinding HorizontalContentAlignment}"" SnapsToDevicePixels=""{TemplateBinding SnapsToDevicePixels}""/> </Border>",How to prevent double thickness borders at overlap?
How to use User class in MVC5?," How can I get the id of the currently logged in user in MVC 5? I tried the StackOverflow suggestions, but they seem to be not for MVC 5. Also, what is the MVC 5 best practice of assigning stuff to the users? (e.g. a User should have Items. Should I store the User's Id in Item? Can I extend the User class with an List<Item> navigation property?I'm using ""Individual User Accounts"" from the MVC template.Tried these:How do I get the current user in an MVC Application?How to get the current user in ASP.NET MVCGet logged in user's id - this throws the following: 'Membership.GetUser()' is null. <code> ","How to get current user, and how to use User class in MVC5?"
ASP.net File Download from Server," After a user clicks a button, I want a file to be downloaded. I've tried the following which seems to work, but not without throwing an exception (ThreadAbort) which is not acceptable. <code>  System.Web.HttpResponse response = System.Web.HttpContext.Current.Response; response.ClearContent(); response.Clear(); response.ContentType = ""text/plain""; response.AddHeader(""Content-Disposition"", ""attachment; filename="" + fileName + "";""); response.TransmitFile(Server.MapPath(""FileDownload.csv"")); response.Flush(); response.End(); ",ASP.NET file download from server
why compiler dose not give error when we try to divide a variable with zero, If we try to run this code: We get a compiler error. So we cannot divide by zero.Now consider this code: d can have anything and dividing anything by zero is not okWe don't get a compiler error. The variable has anything we cannot divide by zero. Why does the compiler not give an error when we try to divide a variable by zero? <code>  int d = 10/0; int d = 10; int o = d / 0;,Why does the compiler not show an error when we try to divide a variable by zero
Convert a ushort value into 2 byte values in c#," How do I split a ushort into two byte variables in C#?I tried the following (package.FrameID is ushort):When I try to calculate this with paper&pencil I get the right result. Also, if FrameID is larger than a byte (so the second byte isn't zero), it works. In my case package.FrameID is 56 and the result in array[0] is 16 instead of 56.How can I fix this? <code>  array[0] = (byte)(0x0000000011111111 & package.FrameID);array[1] = (byte)(package.FrameID >> 8);",Convert a ushort value into two byte values in C#
Monotouch UIDatePicker Date 1 Hour Wrong," I'm having an issue with the Monotouch UIDatePicker being 1 hour behind. I think this is to do with Time Zones or something similar. I've tried explicitly setting the TimeZone and Locale of my UIDatePicker but this doesn't seem to be helping. In the ValueChanged handler the following line returns a value 1 hour earlier than the time selected in the user interface: In the ValueChanged Handler I've double checked that the Locale and TimeZone is the same as what was set. The TimeZone is Europe/Dublin and Locale en_US.This information was retrieved by: Is there another step I'm missing?Thanks! <code>  datePicker.Locale = NSLocale.CurrentLocale;datePicker.TimeZone = NSTimeZone.LocalTimeZone; var date = DateTime.SpecifyKind((s as UIDatePicker).Date, DateTimeKind.Local).ToLocalTime(); datePicker.Locale.LocaleIdentifier;datePicker.DatePicker.TimeZone;",Timezone issue with UIDatePicker Date: 1 Hour Wrong
disable images in selenium google chrome driver," How does one disable images in Google chrome when using it through Selenium and c#?I've attempted 6 ways and none worked. I've even tried the answer on this StackOverflow question, however I think the info in it is out of date.Chrome driver: V2.2Chrome version: V29.0.1547.66 mSelenium: V2.35All the attempts I've made don't cause exceptions, they run normally but still display images:Attempt 1: Attempt 2: Attempt 3: Attempt 4: Attempt 5: Attempt 6: <code>  ChromeOptions co = new ChromeOptions();co.AddArgument(""--disable-images"");IWebDriver driver = new ChromeDriver(co); DesiredCapabilities capabilities = DesiredCapabilities.Chrome();capabilities.SetCapability(""chrome.switches"", new string[1] { ""disable-images"" }); ChromeOptions co = new ChromeOptions();co.AddAdditionalCapability(""chrome.switches"", new string[1] { ""disable-images"" }); var imageSetting = new Dictionary<string, object>();imageSetting.Add(""images"", 2);Dictionary<string, object> content = new Dictionary<string, object>();content.Add(""profile.default_content_settings"", imageSetting);var prefs = new Dictionary<string, object>();prefs.Add(""prefs"", content);var options = new ChromeOptions();var field = options.GetType().GetField(""additionalCapabilities"", BindingFlags.Instance | BindingFlags.NonPublic);if (field != null){ var dict = field.GetValue(options) as IDictionary<string, object>; if (dict != null) dict.Add(ChromeOptions.Capability, prefs);} ChromeOptions options = new ChromeOptions();options.AddAdditionalCapability(""profile.default_content_settings"", 2); Dictionary<String, Object> contentSettings = new Dictionary<String, Object>();contentSettings.Add(""images"", 2);Dictionary<String, Object> preferences = new Dictionary<String, Object>();preferences.Add(""profile.default_content_settings"", contentSettings);DesiredCapabilities caps = DesiredCapabilities.Chrome();caps.SetCapability(""chrome.prefs"", preferences);",Disable images in Selenium Google ChromeDriver
"How to ""sleep"" until timeout or cancellation is requested in C#4.0"," What's the best way to sleep a certain amount of time, but be able to be interrupted by a IsCancellationRequested from a CancellationToken?I'm looking for a solution which works in .NET 4.0.I'd like to write <code>  void MyFunc (CancellationToken ct){ //... // simulate some long lasting operation that should be cancelable Thread.Sleep(TimeSpan.FromMilliseconds(10000), ct); }","How to ""sleep"" until timeout or cancellation is requested in .NET 4.0"
Nested indexed Select with ImmutableArray<> behaves differently than with Array<>," I am encountering what seems to be a very weird bug in ImmutableArray<> (with BCL Immutable collections v1.0.12.0, runtime .NET 4.5):I have the following two identical structs exactly in the same source file under the same namespace: The following will throw an exception: If I project elements1 into ToArray() on the first line instead of ToImmutableArray(), everything works fine.The only difference between the two structs is that WeightedComponent is used extensively by the code before, while WeightedComponent2 is never used before (this is why it may not be obvious to reproduce the bug).Iterating on elements1 twice in the same expression seem to be related to the issue, as if I remove it the Select works fine, but there is no such problem with elements2. It really seems to be related to the way the code behind ImmutableArray<> is considering both structs (maybe there is a caching mechanism?)Do you have any idea what could be causing this? <code>  public struct WeightedComponent { public readonly IComponent Component; public readonly decimal Weight; public WeightedComponent(IComponent component, decimal weight) { this.Component = component; this.Weight = weight; }}public struct WeightedComponent2 { public readonly IComponent Component; public readonly decimal Weight; public WeightedComponent2(IComponent component, decimal weight) { this.Component = component; this.Weight = weight; }} var elements1 = new[] { 1, 2, 3 }.Select(wc => new WeightedComponent(null, 0)).ToImmutableArray();var foo = elements1.Select((e1, i1) => elements1.Select((e2, i2) => 0).ToArray()).ToArray();if (foo.Length != 3) throw new Exception(""Error: "" + foo.Length); //Error: 1var elements2 = new[] { 1, 2, 3 }.Select(wc => new WeightedComponent2(null, 0)).ToImmutableArray();var foo2 = elements2.Select((e1, i1) => elements2.Select((e2, i2) => 0).ToArray()).ToArray();if (foo2.Length != 3) throw new Exception(""Error: "" + foo.Length);",ImmutableArray<> behaves differently than Array<> for nested Select with index
C# int to string without conversion?," I have a kind a simple question but I'm surprised.This code works: Why don't I have to do itemID.ToString() in this case ? <code>  int itemID = 1;string dirPath = @""C:\"" + itemID + @""\abc"";",int to string without explicit conversion?
Query for only the first N rows for each unique ID," Say I have an IQueryable that will return a datatype with an ID property (column).I want to further filter my query (I don't want to evaluate the query) as follows:For each unique ID from the main query, I want to Take(n), where n is some arbitrary number. That is, I want to only keep the first n rows for each unique ID.I can get the distinct ID's... and I can Take(n) with the rest of them, but I'm stumped on connecting the two: The accepted answer works, but is slow for a large table. I wrote this question as a follow-up. <code>  var ids = query.Select(q => q.ID).Distinct(); query = query.<FOR EACH DISTINCT ID>.Take(n);",Linq query for only the first N rows for each unique ID
Change FontSixe to fit TextBlock," I'm developing Windows 8 Store Application, we know that display sizes are very different, so all the elements have stretchable settings, so that if display is small elements (pictures, charts etc. ) are smaller, if display is big - bigger.All works perfectly except TextBlocks (labels):TextBlock element itself also is being stretched, but the FontSize remains the same, how i noticed there is no property to change font size to fit TextBlock.Is there a way to change FontSize of the TextBlock to fit the container? Examples are wery appreciated <code> ",Change FontSize to fit TextBlock
How to populate a dataGridView with an array of user generated integers c#," With this: It produces the data correctly, But it produces all the rows in the array with extra data that will not be useful, empty data.img http://s21.postimg.org/t3f34aa43/list_Result.jpg?noCache=1379353500Would like to remove unnecessary rows of data <code>  dataGridView.DataSource = theData.Select((x, index) => new { CreatureRoll = x, CreatureLabel = index}).OrderByDescending(x => x.CreatureRoll).ToList();",How to populate a dataGridView with an array of user generated integers
Accuracy of MS System.Speech.Recogniter and the SpeechRecognitionEngine," I am currently testing the SpeechRecognitionEngine by loading from an xml file a pretty simple rule. In fact it is a simple between (""decrypt the email"", ""remove encryption"") or (""encrypt the email"", ""add encryption"").I have trained my Windows 7 PC and additionally added the words encrypt and decrypt as I realize they are very similar. The recognizer already has a problem with making a difference between these two.The issue I am having is that it recognizes things too often. I have set the confidence to 0.93 because with my voice in a quiet room when saying the exact words sometimes only gets to 0.93. But then if I turn on the radio the voice of the announcer or a song can mean that this recognizer thinks it has heard with over 0.93 confidence with words ""decrpyt the email"".Maybe Lady Gaga is backmasking Applause to secretly decrypt emails :-)Can anyone help in working out how to do something to make this recognizer workable.In fact the recognizer is also picking up keyboard noise as ""decrypt the email"". I don't understand how this is possible.Further to my editing buddy there are at least two managed namespaces for MS Speech Microsoft.Speech and System.Speech - It is important for this question that it be know that it is System.Speech. <code> ",Accuracy of MS System.Speech.Recognizer and the SpeechRecognitionEngine
Rejection of external speech in Microsoft SpeechRecognitionEngine," I am currently testing the SpeechRecognitionEngine by loading from an xml file a pretty simple rule. In fact it is a simple between (""decrypt the email"", ""remove encryption"") or (""encrypt the email"", ""add encryption"").I have trained my Windows 7 PC and additionally added the words encrypt and decrypt as I realize they are very similar. The recognizer already has a problem with making a difference between these two.The issue I am having is that it recognizes things too often. I have set the confidence to 0.93 because with my voice in a quiet room when saying the exact words sometimes only gets to 0.93. But then if I turn on the radio the voice of the announcer or a song can mean that this recognizer thinks it has heard with over 0.93 confidence with words ""decrpyt the email"".Maybe Lady Gaga is backmasking Applause to secretly decrypt emails :-)Can anyone help in working out how to do something to make this recognizer workable.In fact the recognizer is also picking up keyboard noise as ""decrypt the email"". I don't understand how this is possible.Further to my editing buddy there are at least two managed namespaces for MS Speech Microsoft.Speech and System.Speech - It is important for this question that it be know that it is System.Speech. <code> ",Accuracy of MS System.Speech.Recognizer and the SpeechRecognitionEngine
Xamarin Basics. Build Failed. See the build log for detail," I create a new project, click compile, and get this error: Build Failed. See the build log for details.In the build log there is only this: Here is what I see:What causes this error and how do I fix it? <code>  Building: FirstProgram (Debug|x86)---------------------- Done ----------------------Build failed.Build: 1 error, 0 warnings",Build Failed. See the build log for detail
HTML ASP.NET MVC 4 Razor: Get textbox input value," I have a textbox input and some radio buttons. For example my textbox input HTML looks like that: Once user clicks a button on a web page I want to pass data to my controller: Maybe it is trivial but my problem is that I do not know how to get textbox value and pass it through to the controller. How can I read the textbox value and pass it to the controller through ipValue=@[ValueOfTextBox]? <code>  <input type=""text"" name=""IP"" id=""IP"" /> <input type=""button"" name=""Add"" value=""@Resource.ButtonTitleAdd"" onclick=""location.href='@Url.Action(""Add"", ""Configure"", new { ipValue =@[ValueOfTextBox], TypeId = 1 })'""/>",ASP.NET MVC get textbox input value
ASP.NET MVC 4 Razor: Get textbox input value," I have a textbox input and some radio buttons. For example my textbox input HTML looks like that: Once user clicks a button on a web page I want to pass data to my controller: Maybe it is trivial but my problem is that I do not know how to get textbox value and pass it through to the controller. How can I read the textbox value and pass it to the controller through ipValue=@[ValueOfTextBox]? <code>  <input type=""text"" name=""IP"" id=""IP"" /> <input type=""button"" name=""Add"" value=""@Resource.ButtonTitleAdd"" onclick=""location.href='@Url.Action(""Add"", ""Configure"", new { ipValue =@[ValueOfTextBox], TypeId = 1 })'""/>",ASP.NET MVC get textbox input value
ASP.NET MVC Razor: Get textbox input value," I have a textbox input and some radio buttons. For example my textbox input HTML looks like that: Once user clicks a button on a web page I want to pass data to my controller: Maybe it is trivial but my problem is that I do not know how to get textbox value and pass it through to the controller. How can I read the textbox value and pass it to the controller through ipValue=@[ValueOfTextBox]? <code>  <input type=""text"" name=""IP"" id=""IP"" /> <input type=""button"" name=""Add"" value=""@Resource.ButtonTitleAdd"" onclick=""location.href='@Url.Action(""Add"", ""Configure"", new { ipValue =@[ValueOfTextBox], TypeId = 1 })'""/>",ASP.NET MVC get textbox input value
Get textbox input value," I have a textbox input and some radio buttons. For example my textbox input HTML looks like that: Once user clicks a button on a web page I want to pass data to my controller: Maybe it is trivial but my problem is that I do not know how to get textbox value and pass it through to the controller. How can I read the textbox value and pass it to the controller through ipValue=@[ValueOfTextBox]? <code>  <input type=""text"" name=""IP"" id=""IP"" /> <input type=""button"" name=""Add"" value=""@Resource.ButtonTitleAdd"" onclick=""location.href='@Url.Action(""Add"", ""Configure"", new { ipValue =@[ValueOfTextBox], TypeId = 1 })'""/>",ASP.NET MVC get textbox input value
How can I get RestSharp to use RC4 or a different cipher suite?," I'm trying to use RestSharp in Visual Studio 2012 Express on a fresh install of Windows 8.1. The API I'm trying to use supports only RC4-SHA for SSL. The certificate is valid. I keep getting an error from the client: The request was aborted: Could not create SSL/TLS secure channel. I thought there were certificate problems, until I finally took a packet capture and discovered there were no cipher suites in common. RC4-SHA is not available on the client end. After installing Windows 7 and running the exact same code, the problem goes away.Why is RC4-SHA unavailable in RestSharp on Windows 8.1? <code>  var client = new RestClient();client.BaseUrl = ""https://teststore.mybigcommerce.com/api/v2/"";client.Authenticator = new HttpBasicAuthenticator(""username"", ""key"");var request = new RestRequest();request.Resource = ""time.json"";IRestResponse response = client.Execute(bcrequest);",RestSharp: Could not create SSL/TLS secure channel
Entity Framework: LINQ to Entities only supports casting EDM primitive or enumeration types with IEntity interface," I have the following generic extension method: Unfortunately Entity Framework doesn't know how to handle the predicate since C# converted the predicate to the following: Entity Framework throws the following exception: Unable to cast the type 'IEntity' to type 'SomeEntity'. LINQ to Entities only supports casting EDM primitive or enumeration types.How can we make Entity Framework work with our IEntity interface? <code>  public static T GetById<T>(this IQueryable<T> collection, Guid id) where T : IEntity{ Expression<Func<T, bool>> predicate = e => e.Id == id; T entity; // Allow reporting more descriptive error messages. try { entity = collection.SingleOrDefault(predicate); } catch (Exception ex) { throw new InvalidOperationException(string.Format( ""There was an error retrieving an {0} with id {1}. {2}"", typeof(T).Name, id, ex.Message), ex); } if (entity == null) { throw new KeyNotFoundException(string.Format( ""{0} with id {1} was not found."", typeof(T).Name, id)); } return entity;} e => ((IEntity)e).Id == id",LINQ to Entities only supports casting EDM primitive or enumeration types with IEntity interface
Difference between WPF DataGrid's EnableRowVirtualization and VirtualizingStackPanel.IsVirtualizing p[roperties," There is almost no information out there about the impact of setting; and Can someone clarify what the difference is?Also, as an added bonus, can anyone clarify if EnableRowVirtualization and EnableColumnVirtualization actually do anything on the 3.5 grid as the MSDN documentation only lists these properties back to 4.0, but they definitely exist in 3.5?Thanks. <code>  VirtualizingStackPanel.IsVirtualizing=""True"" EnableRowVirtualization=""True"" EnableColumnVirtualization=""True"". ",Difference between WPF DataGrid's EnableRowVirtualization and VirtualizingStackPanel.IsVirtualizing properties
How can i segment a list or byte array," I have a list of bytes and I want to split this list into smaller parts. This list has 6 cells. For example, I want to split it into 3 parts containing each 2 bytes.I have tried to write some for loops and used 2D arrays to achieve my purpose but I don't know it is a correct approach. <code>  var array = new List<byte> {10, 20, 30, 40, 50, 60}; byte[,] array2D = new byte[window, lst.Count / window];var current = 0;for (int i = 0; i < rows; i++){ for (int j = 0; j < cols; j++) { array2D[i, j] = lst[current++]; }}",How can I split an array into n parts?
C#: Splitting an array into n parts," I have a list of bytes and I want to split this list into smaller parts. This list has 6 cells. For example, I want to split it into 3 parts containing each 2 bytes.I have tried to write some for loops and used 2D arrays to achieve my purpose but I don't know it is a correct approach. <code>  var array = new List<byte> {10, 20, 30, 40, 50, 60}; byte[,] array2D = new byte[window, lst.Count / window];var current = 0;for (int i = 0; i < rows; i++){ for (int j = 0; j < cols; j++) { array2D[i, j] = lst[current++]; }}",How can I split an array into n parts?
Does XmlSerializer support property name changes," I have That I want to change to: I want to have backward compatibility. I'd like to only have IsIncluded defined in code but being able to read old xml where the property would be ""Included"".Does XmlSerializer support it and how ?Note: I tried without success... (does not deserialize it) Update I just want to add that I prefer my solution because I wanted that my xml become IsIncluded which, to me, is more appropriate. Doing as I did (solution below), would enable me to change the xml but keeping previous version working fine. In long term, I would probably be able to remove code to support old version.Update 2018-02-01 Please take a look at Greg Petersen comment below solution and proposed solution. He propose a great solution in order to encapsulate the correction at the place (the class) where it should be done. WOW!!! <code>  public bool Included { get; set; } public bool IsIncluded { get; set; } public bool IsIncluded { get; set; } [Obsolete] public bool Included { set { IsIncluded = value; } get { return IsIncluded; } }",Does XmlSerializer support property name changes (version tolerant)
Round to 1 decimal places in C#," I would like to round my answer 1 decimal place. for example: 6.7, 7.3, etc.But when I use Math.round, the answer always come up with no decimal places. For example: 6, 7Here is the code that I used: <code>  int [] nbOfNumber = new int[ratingListBox.Items.Count];int sumInt = 0;double averagesDoubles;for (int g = 0; g < nbOfNumber.Length; g++){ nbOfNumber[g] = int.Parse(ratingListBox.Items[g].Text);}for (int h = 0; h < nbOfNumber.Length; h++){ sumInt += nbOfNumber[h];}averagesDoubles = (sumInt / ratingListBox.Items.Count);averagesDoubles = Math.Round(averagesDoubles, 2);averageRatingTextBox.Text = averagesDoubles.ToString();",Round to 1 decimal place in C#
why compiler cast automatically without going further in the inheritance," While I try to run following code snippet, its executing wrong overload method. I'm confused why it does that? [testB.TestMethod(testValue) method execute the public double TestMethod(double value) method] Do you have any idea about this ?Is there are any way to call TestA class method via the TestB instance without cast as TestA.?But it is not happen in JAVA and C++ <code>  public class TestA{ public int TestMethod(int value) { return value; }}public class TestB : TestA{ public double TestMethod(double value) { return value; }}static void Main( string[] args ){ TestB testB = new TestB(); int testValue = 3; testB.TestMethod(testValue);}",Why does the compiler cast automatically without going further in the inheritance?
How can I reuse a Dropdownlist in several views witn .NET MVC," Several views from my project have the same dropdownlist... So, in the ViewModel from that view I have : And in the controller I have : So far so good... But Im doing the same code in every view/controller that have that ddl...Is that the best way to do that? Thanks <code>  public IEnumerable<SelectListItem> FooDdl { get; set; } var MyVM = new MyVM() { FooDdl = fooRepository.GetAll().ToSelectList(x => x.Id, x => x.Name)}",How can I reuse a DropDownList in several views with .NET MVC
How can I reuse a Dropdownlist in several views with .NET MVC," Several views from my project have the same dropdownlist... So, in the ViewModel from that view I have : And in the controller I have : So far so good... But Im doing the same code in every view/controller that have that ddl...Is that the best way to do that? Thanks <code>  public IEnumerable<SelectListItem> FooDdl { get; set; } var MyVM = new MyVM() { FooDdl = fooRepository.GetAll().ToSelectList(x => x.Id, x => x.Name)}",How can I reuse a DropDownList in several views with .NET MVC
.NET async/await exception handling pattern, I have the following reoccurring try/catch pattern in my code. Using a try/catch block to handle any exceptions thrown when calling a method in orionProxy. What I would like to write is something like the following. Any pointers/suggestions? I've tried various forms of Actions/Tasks/Lambdas but nothing will properly trap the exception in orionProxy.CheckForException(?) so ShowContacts doesn't run. <code>  async private void doGetContacts(){ try { currentContacts = await orionProxy.GetContacts (); // call method in orionProxy ShowContacts (); // do something after task is complete } catch (Exception e) { orionProxy.HandleException (e); // handle thrown exception }} async private void doGetContacts(){ currentContacts = await orionProxy.CheckForException(orionProxy.GetContacts ()); ShowContacts (); // do something after task is complete but shouldn't run on exception},async/await exception handling pattern
C#: Is it possible to use Console.ReadLine(); more than once," Is there any way that I can make this program display both text by using Console.ReadLine(); twice? I provided my code below and whenever I debug I only get the ones provided above the first one, but when I remove the first Console.ReadLine(); everything gets displayed.  <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading.Tasks;namespace MyFirstProject { class Program { static void Main(string[] args) { String name= ""John Berr""; String country = ""USA""; String city = ""Unknown""; String age = ""15""; Console.WriteLine(""My name is "" + name); Console.WriteLine(""The Country I reside in is "" + country); Console.WriteLine(""The city I reside in is "" + city); Console.WriteLine(""I am "" + age +"" years old""); Console.ReadLine(); { Console.WriteLine(""Hello""); Console.ReadLine(); } } }}",Is it possible to use Console.ReadLine() more than once?
Why it is impossible to create an object instance of class with internal constructor using Reflection?," Example: Exception: System.MissingMethodException No parameterless constructor defined for this object.Solution: I cannot understand, why I cannot create an instance inside the assembly with internal constructor. This constructor should be available inside the execution assembly. It should work like public for this assembly. <code>  class Program{ static void Main(string[] args) { var myClass = Activator.CreateInstance(typeof(MyClass)); }}public class MyClass{ internal MyClass() { }} var myClass = Activator.CreateInstance(typeof(MyClass), nonPublic:true);",How to create an object instance of class with internal constructor via reflection?
Java thread creation performance vs C# thread creation performance vs C++?," I'm interesting what are actual costs of threads creation in Java, C# and C++? I know that when thread is creating a bunch of operations must be done: allocate thread stack, initialize descriptors, etc.But I'm interesting in actual costs. C# and Java use different VM's and different JITs and C++ executes native code. So thread creation time is different in all of these languages. I also heard that thread creation in Java is much slower that in C#. Can someone give authorative answers and explanations on this issue? <code> ",Java thread creation performance vs C# thread creation performance vs C++ (native threads)?
Wix - How to run exe files after installation from installed directory," I'm using a program which is being installed using wix. (Don't know if it's relevant but it's a C# program)I want to run an exe file which was installed by the msi file, but the location of the installation is unknown to me since the user chooses the installation path.I wanted to ask for example of how to run an exe file from the location the user chooses.Even though it's not a part of the question, I would also be glad to see some example of running an exe file from an absolute location since I'm a beginner to wix and doing it all for the first time. <code> ",Wix - How to run exe files after installation from installed directory?
How to run exe files after installation from installed directory?," I'm using a program which is being installed using wix. (Don't know if it's relevant but it's a C# program)I want to run an exe file which was installed by the msi file, but the location of the installation is unknown to me since the user chooses the installation path.I wanted to ask for example of how to run an exe file from the location the user chooses.Even though it's not a part of the question, I would also be glad to see some example of running an exe file from an absolute location since I'm a beginner to wix and doing it all for the first time. <code> ",Wix - How to run exe files after installation from installed directory?
How run some threads at a same time without running twice or failing one of them," How can I run some threads at the same time without ""running twice"" or ""failing"" one of them? I will explain my question with an example: and my_method() is implemented as: after running this code I figured out some pages (1-10) don't run and some pages run twice.so the while() never ends because of those duplicates and fails. How can I fix those duplicates and failures? My meaning of fail is not ""Error"", I mean for example my_method(4) never runs and my meaning of duplicate is for example my_method(3) runs twice. I know there are other ways such as Parallel.ForEach, but I want to learn how to use the Thread Class.  <code>  private int count = 0;private HashSet<int> hs_pages = new HashSet<int>(); for (int page = 1; page <= 10; page++){ Thread thread = new Thread(unused => my_method(page)); thread.Name = ""Thread - "" + page.ToString(); thread.Start();}while(count < 10){} public void my_method(int page){ if (hs_pages.Add(page)) { count++; //My Codes } else { MessageBox.Show(""this is duplicate of page : "" + page.ToString()); }}",Run multiple threads at the same time without any running twice or failing
Write file to project folder on any computer (c#)," I'm working on a project for a class. What I have to do is export parsed instructions to a file. Microsoft has this example which explains how to write to a file: I'm fine with that part, but is there a way to write the file to the current project's environment/location? I'd like to do that instead of hard coding a specific path (i.e. ""C:\\test.txt"").  <code>  // Compose a string that consists of three lines.string lines = ""First line.\r\nSecond line.\r\nThird line."";// Write the string to a file.System.IO.StreamWriter file = new System.IO.StreamWriter(""c:\\test.txt"");file.WriteLine(lines);file.Close();",Write file to project folder on any computer
"Multi threading on dictionary with fixed keys, .NET C#"," I have a dictionary with a fixed collection of keys, which I create at the beginning of the program. Later, I have some threads updating the dictionary with values.No pairs are added or removed once the threads started.Each thread has its own key. meaning, only one thread will access a certain key.the thread might update the value.The question is, should I lock the dictionary?UPDATE:Thanks all for the answers,I tried to simplify the situation when i asked this question, just to understand the behaviour of the dictionary.To make myself clear, here is the full version: I have a dictionary with ~3000 entries (fixed keys), and I have more than one thread accessing the key (shared resourse), but I know for a fact that only one thread is accessing a key entry at a time.so, should I lock the dictionary? and - when you have the full version now, is a dictionary the right choise at all?Thanks! <code> ",Multi threading on dictionary with fixed keys
Creating a excel file with Microsoft.Office.Interop.Excel without Excel installed in c#," I've created a method to generate a excel file in C#, and it works great. But after all the development, we begin to question ourselves on the possibility to create these files on machines that do not have Office installed. I've made a few searches, and nothing has been found.So, does anybody know of a way to generate excel files without Excel installed on a machine, but using the Interop DLL and OFFICE.dll?If there isn't a way do it, is there any library that can make this work? <code> ",Creating a excel file with Microsoft.Office.Interop.Excel without Excel installed
Get notified when internet is conected or disconected .NET 4.0 (Desktop app)," I have a desktop application in WPF and C# developed under the .Net 4.0 Client Framework that has to show or hide some data according to if internet is available or not on the PC.This means I have to be able to detect as soon as possible if the internet is disconnected or connected in order to react. (Example could be disconnect from a wireless network or unplugging the network cable)As I researched a bit I found that an event exists in the class NetworkChange called NetworkAvailabilityChanged that fires every time the connection changes (link to docs).I'm developing in a Windows 8 machine and when I try it there the event is not fired but when I run the app on Windows 7 the event is fired. As in the docs says with the framework 4.0 compatibility for that event is until Windows 7, but looking at the same event in the docs for framework 4.5 compatibility says windows 8 also.The problem is that even if I switch the target framework of the project to 4.5 (which is not the idea) the event won't fire on Windows 8.Are there any incompatibilities issues that I'm not realizing? Is there a better way to get notified when the connection changes?I need if possible a solution for the Framework 4.0 client that works on Windows Vista, 7 and 8 <code> ",Get notified when internet is connected or disconnected
Get notified when internet is conected or disconected," I have a desktop application in WPF and C# developed under the .Net 4.0 Client Framework that has to show or hide some data according to if internet is available or not on the PC.This means I have to be able to detect as soon as possible if the internet is disconnected or connected in order to react. (Example could be disconnect from a wireless network or unplugging the network cable)As I researched a bit I found that an event exists in the class NetworkChange called NetworkAvailabilityChanged that fires every time the connection changes (link to docs).I'm developing in a Windows 8 machine and when I try it there the event is not fired but when I run the app on Windows 7 the event is fired. As in the docs says with the framework 4.0 compatibility for that event is until Windows 7, but looking at the same event in the docs for framework 4.5 compatibility says windows 8 also.The problem is that even if I switch the target framework of the project to 4.5 (which is not the idea) the event won't fire on Windows 8.Are there any incompatibilities issues that I'm not realizing? Is there a better way to get notified when the connection changes?I need if possible a solution for the Framework 4.0 client that works on Windows Vista, 7 and 8 <code> ",Get notified when internet is connected or disconnected
what happened with object if exception occurred in finalizer," I'm curious, what really happens inside .NET, if exception happened in finalizer method during garbage collection procedure. Did the logic different for heap and LOH? Could anyone provide detailed description? <code> ",what happened in .NET if exception occurred in finalizer method (~Method)
Why HttpContext.Current be null?," I have a value that I use in all the application; I set this in application_start and in SmsSchedule I want to get this value in a class.(smsjob) but my problem is : HttpContext.Current is null, why is HttpContext.Current null?Edit:When i use this code in another class of a page it works, but in this class I get the error. <code>  void Application_Start(object sender, EventArgs e) { Dictionary<int, IList<string>> Panels = new Dictionary<int, IList<string>>(); List<clsPanelSetting> setting = clsPanelSettingFactory.GetAll(); foreach (clsPanelSetting panel in setting) { Panels.Add(panel.AdminId, new List<string>() { panel.Phone,panel.UserName,panel.Password}); } Application[""Setting""] = Panels; SmsSchedule we = new SmsSchedule(); we.Run(); } public class SmsSchedule : ISchedule{ public void Run() { DateTimeOffset startTime = DateBuilder.FutureDate(2, IntervalUnit.Second); IJobDetail job = JobBuilder.Create<SmsJob>() .WithIdentity(""job1"") .Build(); ITrigger trigger = TriggerBuilder.Create() .WithIdentity(""trigger1"") .StartAt(startTime) .WithSimpleSchedule(x => x.WithIntervalInSeconds(60).RepeatForever()) .Build(); ISchedulerFactory sf = new StdSchedulerFactory(); IScheduler sc = sf.GetScheduler(); sc.ScheduleJob(job, trigger); sc.Start(); }} public class SmsJob : IJob { public virtual void Execute(IJobExecutionContext context) { HttpContext.Current.Application[""Setting""]; } }",Why is HttpContext.Current null?
Registering a custom JsonConverter in Json.Net," Using Json.Net, I have properties in my objects which need special care in order to serialize / deserialize them. Making a descendant of JsonConverter, I managed to accomplish this successfully. This is the common way of doing this: My problem with this code is that I need to introduce my custom converter in every serialization / deserialization. In my project there are many cases that I cannot do that. For instance, I'm using other external projects which make use of Json.Net as well and they will be working on my SomeClass instances. But since I don't want to or can't make change in their code, I have no way to introduce my converter.Is there any way I can register my converter, using some static member perhaps, in Json.Net so no matter where serialization / deserialization happens, my converter is always present? <code>  public class SomeConverter : JsonConverter{ public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer) { ... } public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer) { ... } public override bool CanConvert(Type objectType) { ... }}class SomeClass{ [JsonProperty, JsonConverter(typeof(SomeConverter))] public SomeType SomeProperty;}//Later on, in code somewhereSomeClass SomeObject = new SomeClass();string json = JsonConvert.SerializeObject(SomeObject, new SomeConverter());",Registering a custom JsonConverter globally in Json.Net
"c#, How to check whether a given date is DST date or not?"," I have a date as string. There is no time info.For eg. ""20131031"" ie) 31 oktober 2013.I want to verify whether it is the date on which DST happens or not ?w.r.t. WesternEurope.ie) Does c# have an API, to say it is a DST date or not ?I want simply a boolean as return, for the last sunday of October and last sunday of March.which are the dates on which clocks are adjusted. <code> ",How to check whether a given date is DST date or not?
System.Data.Entity.Internal.InternalContext.SaveChanges() & System.Data.Entity.Internal.LazyInternalContext.SaveChanges()," I have the following Action method inside my Asp.net mvc web application:- which calls the following method:- My model class is as follow:- but if i call the Create action method i will get the following exception:- Can anyone advice what is wrong, as i double check my code and every thing should work fine ?Thanks <code>  [HttpPost][ValidateAntiForgeryToken]public ActionResult Create(SDJoin sdj, FormCollection formValues){ Try { //code goes here repository.InsertOrUpdateSD(sdj.StorageDevice, User.Identity.Name, assetid); repository.Save(); } catch (Exception ex) { //code goes here } PopulateViewBagData(); return View(sdj);} public void InsertOrUpdateSD(TMSStorageDevice sd, string username, long assetid){ var resource = entities.Resources.AsNoTracking().SingleOrDefault(a => a.RESOURCEID == assetid); if (sd.TMSStorageDeviceID == default(int)) { // New entity int technologyypeID = GetTechnologyTypeID(""Storage Device""); Technology technology = new Technology { IsDeleted = true, IsCompleted = false, TypeID = technologyypeID, Tag = ""SD"" + GetTagMaximumeNumber2(technologyypeID).ToString(), StartDate = DateTime.Now, IT360ID = assetid }; InsertOrUpdateTechnology(technology); Save(); sd.TMSStorageDeviceID = technology.TechnologyID; tms.TMSStorageDevices.Add(sd); }} public partial class TMSStorageDevice{ public int TMSStorageDeviceID { get; set; } public string Name { get; set; } public Nullable<decimal> size { get; set; } public int RackID { get; set; } public string CustomerName { get; set; } public string Comment { get; set; } public byte[] timestamp { get; set; } public virtual Technology Technology { get; set; } public virtual TMSRack TMSRack { get; set; }} System.Data.Entity.Validation.DbEntityValidationException was caught HResult=-2146232032 Message=Validation failed for one or more entities. See 'EntityValidationErrors' property for more details. Source=EntityFramework StackTrace: at System.Data.Entity.Internal.InternalContext.SaveChanges() at System.Data.Entity.Internal.LazyInternalContext.SaveChanges() at System.Data.Entity.DbContext.SaveChanges() at TMS.Models.Repository.Save() in c:\Users\Administrator\Documents\Visual Studio 2012\Projects\TMS\TMS\Models\Repository.cs:line 1926 at TMS.Controllers.StorageDeviceController.Create(SDJoin sdj, FormCollection formValues) in c:\Users\Administrator\Documents\Visual Studio 2012\Projects\TMS\TMS\Controllers\StorageDeviceController.cs:line 160 InnerException:",Validation Error on SaveChanges()
ASP.NET Web API 2 Attribute routing controller name," In WebApiConfig.cs i have the following then in the MyApiControllerSelector.cs i want to get the controller Pretty simple and it worked great but now using attribute routing i think it needs a different approach? - as i can't seem to find a simple wayI've tried which doesn't work.Then reading the source with debugging lead me to request.GetRouteData().Values[""MS_SubRoutes""]So now I have which works but it has to be a simpler way?UPDATE@KiranChalla asked what's my use case so i'm posting the remaining code. Basically i'm parsing version media type Accept: application/vnd.app.{resource}.v{version}+json from request and returning a HttpControllerDescriptor depending on the version. <code>  public static void Register(HttpConfiguration config){ config.MapHttpAttributeRoutes(); config.Services.Replace(typeof(IHttpControllerSelector), new MyApiControllerSelector(config)); //code omitted for brevity} public override HttpControllerDescriptor SelectController(HttpRequestMessage request) { var routeData = request.GetRouteData(); var controllerName = (string)routeData.Values[""controller""]; //code omitted for brevity } var controllerName = request.GetActionDescriptor().ControllerDescriptor.ControllerName; string subRoutesKey = ""MS_SubRoutes"";var attributedRoutesData = routeData.Values[subRoutesKey] as IEnumerable<IHttpRouteData>; var subRouteData = attributedRoutesData.FirstOrDefault();var actions = (ReflectedHttpActionDescriptor[])subRouteData.Route.DataTokens[""actions""];var controllerName = actions[0].ControllerDescriptor.ControllerName; HttpControllerDescriptor oldControllerDescriptor; if (controllers.TryGetValue(controllerName, out oldControllerDescriptor)) { var apiVersion = GetVersionFromMediaType(request); var newControllerName = String.Concat(controllerName, ""V"", apiVersion); HttpControllerDescriptor newControllerDescriptor; if (controllers.TryGetValue(newControllerName, out newControllerDescriptor)) { return newControllerDescriptor; } return oldControllerDescriptor; } return null;",Get controller name
What is the best buffer size when using BinaryReader," I'm reading binary files and here is a sample: Obviously the buffer size (16*1024) has a great role in performance. I've read that it depends on the I/O technology (SATA, SSD, SCSI, etc.) and also the fragment size of the partition which file exists on it (we can define during the formatting the partition).But here is the question:Is there any formula or best practice to define the buffer size? Right now, I'm defining based on trial-and-error.Edit:I've tested the application on my server with different buffer sizes, and I get the best performance with 4095*256*16 (16MB)!!! 4096 is 4 seconds slower.Here are some older posts which are very helpful but I can't still get the reason:Faster (unsafe) BinaryReader in .NETOptimum file buffer read size?File I/O with streams - best memory buffer sizeHow do you determine the ideal buffer size when using FileInputStream? <code>  public static byte[] ReadFully(Stream input){ byte[] buffer = new byte[16*1024]; int read; while ((read = input.Read(buffer, 0, buffer.Length)) > 0) { ...... }}",What is the best buffer size when using BinaryReader to read big files (>1 GB)?
What is the best buffer size when using BinaryReader to read big files (>1GB)?," I'm reading binary files and here is a sample: Obviously the buffer size (16*1024) has a great role in performance. I've read that it depends on the I/O technology (SATA, SSD, SCSI, etc.) and also the fragment size of the partition which file exists on it (we can define during the formatting the partition).But here is the question:Is there any formula or best practice to define the buffer size? Right now, I'm defining based on trial-and-error.Edit:I've tested the application on my server with different buffer sizes, and I get the best performance with 4095*256*16 (16MB)!!! 4096 is 4 seconds slower.Here are some older posts which are very helpful but I can't still get the reason:Faster (unsafe) BinaryReader in .NETOptimum file buffer read size?File I/O with streams - best memory buffer sizeHow do you determine the ideal buffer size when using FileInputStream? <code>  public static byte[] ReadFully(Stream input){ byte[] buffer = new byte[16*1024]; int read; while ((read = input.Read(buffer, 0, buffer.Length)) > 0) { ...... }}",What is the best buffer size when using BinaryReader to read big files (>1 GB)?
RangeFileContentResult not working as expected," I have an application which intended to stream videos back from our local DB. I spent a lot of time yesterday attempting to return the data a either a RangeFileContentResult or RangeFileStreamResult without success.In short, when I return the file as either of these two results I cannot seem to get a video to stream correctly (or play at all).The request from the browser gets sent with the following headers: And the response comes provided gives these headers as an example: In terms of network traffic, I get a series of 206's for partial results, then a 200 at the end (according to fiddler) which seems correct. Chrome's network tab disagrees with this and see's an initial request (always 13 bytes which I assume is a handshake) then a couple more requests which have a status of either cancelled or pending. As far as I understand, this is more or less correct, 206 - cancel, 206 - cancel etc. But the video never plays.If I switch the result from my controller to a FileResult, the video plays and Chrome, IE10 and Firefox and appears to begin playing before the end of the download is completed (which feels a little like it's streaming! although I suspect it's not)But with the range result I get nothing in chrome or IE and the entire video downloads in one drop in firefox.As far as I understood, the RangeFileContentResult should handle responding to the client with a range of bytes to download (which mine doesn't seem to do, it just tells it to get the whole file (illustrated by the response above)). And the client should respond to that, which it doesn't seem to do.Does anyone have any thoughts in this area? Specifically:a) Should RangeFileContentResult be sending a range of bytes back to the client?b) Is there any way I can explicitly control the range of bytes requested from the client side?c) Is there any reason or anything I'm doing wrong here which would cause browsers not to load the video at all, when requesting a RangeFileContentResult?EDIT: Added a diagram to help describe what I'm seeing:EDIT2: Ok, so the plot thickens. Whilst playing around with the RangedFile gubbins we needed to push another system test version out and I left the 'RangeFileContentResult' on my controller action as below: Rather oddly, this now seems to work as expected on our Azure system test environment but still not on my local machine. I wonder if there's something IIS based which works happily on Azures IIS8, but not on my local 7.5 instance? <code>  Range: bytes=0- Accept-Ranges: bytesContent-Range: bytes 0-5103295/5103296 private ActionResult RetrieveVideo(MediaItem media){ return new RangeFileContentResult( media.Content, media.MimeType, media.Id.ToString(), DateTime.Now); }",RangeFileContentResult and Video streaming with Ranged Requests
Cannon implicitly convert type 'double' to 'float'," I'm doing a simple program for converting temperatures with Kelvin, Celsius and Fahrenheit, but I'm getting this error when doing anything with kelvin: The line the error occurs: The button click: And the test method I'm trying to make: <code>  Cannon implicitly convert type 'double' to 'float' public static float FahrenheitToKelvin(float fahrenheit){ return ((fahrenheit - 32) * 5) / 9 + 273.15;} private void button1_Click(object sender, EventArgs e){ var input = float.Parse(textBox1.Text); float FahrenResult = FahrenheitToCelsius(input); textBox2.Text = FahrenResult.ToString(); float KelvinResult = FahrenheitToKelvin(input); textBox3.Text = KelvinResult.ToString();} [TestMethod]public void fahrenheitToKelvinBoiling(){ float fahrenheit = 212F; float expected = 373.15F; // TODO: Initialize to an appropriate value float actual; actual = Form1.FahrenheitToKelvin(fahrenheit); Assert.AreEqual(Math.Round(expected, 2), Math.Round(actual, 2)); // Assert.Inconclusive(""Verify the correctness of this test method."");}",Cannot implicitly convert type 'double' to 'float'
Making binding property internal instead of public in ViewModel," I am trying some different things using MVVM. In our ViewModel properties which are bind to View are public. I am taking example of a button binding. Here is a simple sample.View.xaml: ViewModel.cs Here my question is that can we make TestButtonCommand internal instead of public? Internal means it is accessible to current project so their should not be any problem doing that? But when I tried to do that it didn't worked. Adding a breakpoint in getter was not hit. So why we cannot make it internal?Here is the link from msdn.http://msdn.microsoft.com/en-us/library/ms743643.aspx The properties you use as binding source properties for a binding must be public properties of your class. Explicitly defined interface properties cannot be accessed for binding purposes, nor can protected, private, internal, or virtual properties that have no base implementation.Why we cannot do this? In case of access internal is same as public if working in the same project. Then why we cannot use internal here? There must be a reason that these should be public, and I am looking for that reason. <code>  <Button Content=""Test Button"" Command=""{Binding TestButtonCommand}"" /> private ICommand _testButtonCommand;public ICommand TestButtonCommand{ get { return _testButtonCommand?? (_testButtonCommand= new RelayCommand(SomeMethod)); }} internal ICommand TestButtonCommand { ...... }",Binding to an internal property?
Deep linq select in C# dictionary," I have next dictionary in C# Is it possible to get all ""valueTitle"" with help of LINQ select?UPDATE:Sorry, i should write it first - i need to get result from exitDictionary, not from subList <code>  Dictionary<string, object> subDictioanry = new Dictionary<string, object>();List<Dictionary<string, string>> subList = new List<Dictionary<string, string>>();subList.Add(new Dictionary<string, string>(){ {""valueLink"", ""link1""}, {""valueTitle"",""title1""}});subList.Add(new Dictionary<string, string>(){ {""valueLink"", ""link2""}, {""valueTitle"",""title2""}});subList.Add(new Dictionary<string, string>(){ {""valueLink"", ""link3""}, {""valueTitle"",""title3""}});subDictioanry.Add(""title"", ""title"");subDictioanry.Add(""name"", ""name"");subDictioanry.Add(""fieldname1"", subList);Dictionary<string, object> exitDictionary = new Dictionary<string, object>();exitDictionary.Add(""first"", subDictioanry);exitDictionary.Add(""second"", subDictioanry);",LINQ select in C# dictionary
Why does C# let me overflow without any error or warning when casting an Int64 to an Int and how does it do the cast?," This question stems from a bug where I iterated over a collection of Int64 and accidentally did foreach (int i in myCollection). I was trying to debug the baffling problem of how when I did a linq query, i was not part of the myCollection.Here's some code that surprised me: I expected the compiler to give me an error. The usual one is that an implicit cast does not exist. But no, it didn't mind this at all. Not even a warning!The outputted value of (int)a incidentally is 1942903641.I'm curious to know why the cast is permitted without any warnings and also how it comes up with that value. Any ideas? <code>  Int64 a = 12345678912345;Console.Write((int)a);",Why does C# let me overflow without any error or warning when casting an Int64 to an Int32 and how does it do the cast?
"""No component for supporting the service Controllers.HomeController was found"" Error in Castle Windsor"," I'm trying to setup Castle Windsor for the first time and I'm having some problems with it. I have three projects in my solution:DomainDALWebThe services are located in DAL. They all inherit from IService. (UserService implements IUserService, IUserService implements IService). The web application is an MVC 5 application. All Controllers inherit from BaseController.I used this post to help me setup Windsor but I keep getting the exception:An exception of type 'Castle.MicroKernel.ComponentNotFoundException' occurred in Castle.Windsor.dll but was not handled in user codeAdditional information: No component for supporting the service Solution.Web.Controllers.HomeController was foundThe strange thing is that the path for the controller is correct.Below is my code for the configuration: And in the Global.asax: Any help or guidance in the right direction is greatly appreciated! <code>  public class WindsorControllerFactory : DefaultControllerFactory{ private readonly IKernel kernel; public WindsorControllerFactory(IKernel kernel) { this.kernel = kernel; } public override void ReleaseController(IController controller) { kernel.ReleaseComponent(controller); } protected override IController GetControllerInstance(RequestContext requestContext, Type controllerType) { if (controllerType == null) { throw new HttpException(404, string.Format(""The controller for path '{0}' could not be found."", requestContext.HttpContext.Request.Path)); } return (IController)kernel.Resolve(controllerType); }}public class ControllersInstaller : IWindsorInstaller{ public void Install(IWindsorContainer container, IConfigurationStore store) { container.Register( Classes.FromThisAssembly() .BasedOn(typeof(BaseController)) .LifestyleTransient()); }}public class ServiceInstaller : IWindsorInstaller{ public void Install(IWindsorContainer container, IConfigurationStore store) { container.Register(Types.FromAssemblyContaining(typeof(IService).GetType()) .BasedOn<IService>().WithService.FromInterface() .LifestyleTransient() ); }} public class MvcApplication : System.Web.HttpApplication{ private static IWindsorContainer container; protected void Application_Start() { AreaRegistration.RegisterAllAreas(); FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters); RouteConfig.RegisterRoutes(RouteTable.Routes); BundleConfig.RegisterBundles(BundleTable.Bundles); // Setup Castle.Windsor IOC MvcApplication.BootstrapContainer(); } protected void Application_End() { container.Dispose(); } private static void BootstrapContainer() { container = new WindsorContainer().Install(FromAssembly.This()); container.Install(FromAssembly.Containing(typeof(IService).GetType())); var controllerFactory = new WindsorControllerFactory(container.Kernel); ControllerBuilder.Current.SetControllerFactory(controllerFactory); }}",Setup Castle Windsor in MVC
C# SecureString into PasswordBox," I have an existing SecureString that I would like to put into a PasswordBox without revealing the .Password. Can this be done? For example: In this case DecryptString produces a SecureString. However, SecurePassword is a read-only property so I can't assign a value to it. <code>  tbPassword.SecurePassword = DecryptString(Properties.Settings.Default.proxyPassword);",Put SecureString into PasswordBox
"If the database of MSSQL exceeds the disk limit (10GB), how to check it?"," I am developing a web site, it uses SQL Server 2008 R2 Express for its database. And in testing, there is a lot of data and images stored into this database.According to wiki, the SQL Server Express edition has a 10 GB size limit. When I insert data and reach the limit, what exception will be thrown? Or, how do I detect the approaching limit problem by codes ?I use EF 5 with code-first approach to insert large data set. <code> ",How to check if my SQL Server Express database exceeds the 10 GB size limit?
`T[].Contains` for struct and class behaving differently," This is a followup question to this: List<T>.Contains and T[].Contains behaving differentlyT[].Contains is behaving differently when T is class and struct. Suppose I have this struct: Here, generic Equals is rightly called as I expected. But in case of a class: The non generic Equals is called, taking away the benefit of implementing `IEquatable. Why is array calling Equals differently for struct[] and class[], even though both the collections seem to look generic?The array weirdness is so frustrating that I'm thinking of avoiding it totally...Note: The generic version of Equals is called only when the struct implements IEquatable<T>. If the type doesn't implement IEquatable<T>, non-generic overload of Equals is called irrespective of whether it is class or struct. <code>  public struct Animal : IEquatable<Animal>{ public string Name { get; set; } public bool Equals(Animal other) //<- he is the man { return Name == other.Name; } public override bool Equals(object obj) { return Equals((Animal)obj); } public override int GetHashCode() { return Name == null ? 0 : Name.GetHashCode(); }}var animals = new[] { new Animal { Name = ""Fred"" } };animals.Contains(new Animal { Name = ""Fred"" }); // calls Equals(Animal) public class Animal : IEquatable<Animal>{ public string Name { get; set; } public bool Equals(Animal other) { return Name == other.Name; } public override bool Equals(object obj) //<- he is the man { return Equals((Animal)obj); } public override int GetHashCode() { return Name == null ? 0 : Name.GetHashCode(); }}var animals = new[] { new Animal { Name = ""Fred"" } };animals.Contains(new Animal { Name = ""Fred"" }); // calls Equals(object)",T[].Contains for struct and class behaving differently
Hhow to load HTML Table in MVC using ViewData?," I have the following table in my View: In my controller I create a body for this table and add to the DataView. I'm getting to this controller by redirect from another and passing my DataTable. In real I have a little bit different, but here I wrote as simple as possible to show the Problem: But as a result I got page with Column Headers but no content inside... Source page tells me that nothing is inside of tbody... <code>  <table id=""tblHelpRow""> <thead> <tr class=""title""> <th> 1 </th> <th> 2 </th> <th> 3 </th> <th> 4 </th> </tr> </thead> <tbody id=""helpRowBody""> @{ ViewData[""MattersTable""].ToString(); } </tbody></table> public ActionResult Matters(DataTable source){ string result = """"; foreach(DataRow dr in source.Rows) { result += ""<tr>"" + ""<td>"" + dr[""1""] + ""</td>"" + ""<td>"" + dr[""2""] + ""</td>"" + ""<td>"" + dr[""3""] + ""</td>"" + ""<td>"" + dr[""4""] + ""</td>"" + ""</tr>""; } ViewData[""MattersTable""] = result; return View();}",How to load HTML Table in MVC using ViewData?
Derived JsonConverter call to ReadJson results in infinite loop," UPDATE: for the tl;dr version skip to the bottomI have a pretty simple subclass of JsonConverter that I'm using with Web API: The problem is, after ReadJson returns the application never returns a bound object to the action method as it appears to be stuck in an infinite validation loop.Here's the top of the call stack when I pause execution: System.Web.Http.dll!System.Web.Http.Metadata.Providers.AssociatedMetadataProvider.GetMetadataForPropertiesImpl.AnonymousMethod__0() Line 40 C# System.Web.Http.dll!System.Web.Http.Metadata.ModelMetadata.Model.get() Line 85 C# System.Web.Http.dll!System.Web.Http.Validation.DefaultBodyModelValidator.ValidateNodeAndChildren(System.Web.Http.Metadata.ModelMetadata metadata, System.Web.Http.Validation.DefaultBodyModelValidator.ValidationContext validationContext, object container) Line 94 C# System.Web.Http.dll!System.Web.Http.Validation.DefaultBodyModelValidator.ValidateProperties(System.Web.Http.Metadata.ModelMetadata metadata, System.Web.Http.Validation.DefaultBodyModelValidator.ValidationContext validationContext) Line 156 C# System.Web.Http.dll!System.Web.Http.Validation.DefaultBodyModelValidator.ValidateNodeAndChildren(System.Web.Http.Metadata.ModelMetadata metadata, System.Web.Http.Validation.DefaultBodyModelValidator.ValidationContext validationContext, object container) Line 130 C# System.Web.Http.dll!System.Web.Http.Validation.DefaultBodyModelValidator.ValidateElements(System.Collections.IEnumerable model, System.Web.Http.Validation.DefaultBodyModelValidator.ValidationContext validationContext) Line 176 C#After that, the DefaultBodyModelValidator.Validation* pattern of calls repeats over and over and over again. Everytime I pause execution, it appears to be at about the same depth, so it doesn't appear to be getting recursively deeper.If I force the JsonConverter to return null, control returns to the API controller action method, I'm assuming because there's nothing to validate. I don't have the brain juices left to figure this one out. What am I doing wrong?UPDATE: With brain juices somewhat replenished, I've stepped through most of the code and it appears that when validating the model the DefaultBodyModelValidator is drilling way down into the SqlTypesAssembly and getting stuck in a loop reading attributes somewhere. I don't really care to find out exactly where because I don't want the DefaultBodyModelValidator drilling into DbGeography type instances to start with.There's no reason for model validation to drill down into the DbGeography class. I need to figure out how to get the MediaTypeFormatterCollection.IsTypeExcludedFromValidation method to return true for typeof(DbGeography), which will cause the DefaultBodyModelValidator to perform shallow validation on any DbGeography instances. So now the question at hand is- how do I exclude a type from model validation? The ShouldValidateType method of DefaultBodyModelValidator is marked virtual, but is there not a simple way to add an excluded type at startup? <code>  public class DbGeographyJsonConverter : JsonConverter{ public override bool CanConvert(Type type) { return typeof(DbGeography).IsAssignableFrom(type); } public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer) { var value = (string)reader.Value; if (value.StartsWith(""POINT"", StringComparison.OrdinalIgnoreCase)) { return DbGeography.PointFromText(value, DbGeography.DefaultCoordinateSystemId); } else if (value.StartsWith(""POLYGON"", StringComparison.OrdinalIgnoreCase)) { return DbGeography.FromText(value, DbGeography.DefaultCoordinateSystemId); } else //We don't want to support anything else right now. { throw new ArgumentException(); } } public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer) { serializer.Serialize(writer, ((DbGeography)value).AsText()); }}",Exclude a type from model validation (example DbGeography) to avoid InsufficientExecutionStackException
Exclude a type from model validation," UPDATE: for the tl;dr version skip to the bottomI have a pretty simple subclass of JsonConverter that I'm using with Web API: The problem is, after ReadJson returns the application never returns a bound object to the action method as it appears to be stuck in an infinite validation loop.Here's the top of the call stack when I pause execution: System.Web.Http.dll!System.Web.Http.Metadata.Providers.AssociatedMetadataProvider.GetMetadataForPropertiesImpl.AnonymousMethod__0() Line 40 C# System.Web.Http.dll!System.Web.Http.Metadata.ModelMetadata.Model.get() Line 85 C# System.Web.Http.dll!System.Web.Http.Validation.DefaultBodyModelValidator.ValidateNodeAndChildren(System.Web.Http.Metadata.ModelMetadata metadata, System.Web.Http.Validation.DefaultBodyModelValidator.ValidationContext validationContext, object container) Line 94 C# System.Web.Http.dll!System.Web.Http.Validation.DefaultBodyModelValidator.ValidateProperties(System.Web.Http.Metadata.ModelMetadata metadata, System.Web.Http.Validation.DefaultBodyModelValidator.ValidationContext validationContext) Line 156 C# System.Web.Http.dll!System.Web.Http.Validation.DefaultBodyModelValidator.ValidateNodeAndChildren(System.Web.Http.Metadata.ModelMetadata metadata, System.Web.Http.Validation.DefaultBodyModelValidator.ValidationContext validationContext, object container) Line 130 C# System.Web.Http.dll!System.Web.Http.Validation.DefaultBodyModelValidator.ValidateElements(System.Collections.IEnumerable model, System.Web.Http.Validation.DefaultBodyModelValidator.ValidationContext validationContext) Line 176 C#After that, the DefaultBodyModelValidator.Validation* pattern of calls repeats over and over and over again. Everytime I pause execution, it appears to be at about the same depth, so it doesn't appear to be getting recursively deeper.If I force the JsonConverter to return null, control returns to the API controller action method, I'm assuming because there's nothing to validate. I don't have the brain juices left to figure this one out. What am I doing wrong?UPDATE: With brain juices somewhat replenished, I've stepped through most of the code and it appears that when validating the model the DefaultBodyModelValidator is drilling way down into the SqlTypesAssembly and getting stuck in a loop reading attributes somewhere. I don't really care to find out exactly where because I don't want the DefaultBodyModelValidator drilling into DbGeography type instances to start with.There's no reason for model validation to drill down into the DbGeography class. I need to figure out how to get the MediaTypeFormatterCollection.IsTypeExcludedFromValidation method to return true for typeof(DbGeography), which will cause the DefaultBodyModelValidator to perform shallow validation on any DbGeography instances. So now the question at hand is- how do I exclude a type from model validation? The ShouldValidateType method of DefaultBodyModelValidator is marked virtual, but is there not a simple way to add an excluded type at startup? <code>  public class DbGeographyJsonConverter : JsonConverter{ public override bool CanConvert(Type type) { return typeof(DbGeography).IsAssignableFrom(type); } public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer) { var value = (string)reader.Value; if (value.StartsWith(""POINT"", StringComparison.OrdinalIgnoreCase)) { return DbGeography.PointFromText(value, DbGeography.DefaultCoordinateSystemId); } else if (value.StartsWith(""POLYGON"", StringComparison.OrdinalIgnoreCase)) { return DbGeography.FromText(value, DbGeography.DefaultCoordinateSystemId); } else //We don't want to support anything else right now. { throw new ArgumentException(); } } public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer) { serializer.Serialize(writer, ((DbGeography)value).AsText()); }}",Exclude a type from model validation (example DbGeography) to avoid InsufficientExecutionStackException
Simple Injector:Factory classes that need to create classes with dependencies," I have a factory class that creates a couple of different types of class. The factory is registered with the container. What is the recommended way of creating the classes inside the factory, given that they also have dependencies. I clearly want to avoid a dependency on the container but if I new those classes then they won't be using the container.e.g. So the question is where do I get those dependencies from.One option could be to make them dependencies of the factory.e.g. Another could be to register the worker types and make those dependencies of the factorye.g. With the first option I feel like I am leeching the dependencies of the workers into the factory. With the second option the workers are created when the factory is created. <code>  public class MyFactory{ public IMyWorker CreateInstance(WorkerType workerType) { if (workerType == WorkerType.A) return new WorkerA(dependency1, dependency2); return new WorkerB(dependency1); }} public class MyFactory{ private Dependency1 dependency1; private Dependency2 dependency2; public MyFactory(Dependency1 dependency1, Dependency2, dependency2) { this.dependency1 = dependency1; this.dependency2 = dependency2; } public IMyWorker CreateInstance(WorkerType workerType) { if (workerType == WorkerType.A) return new WorkerA(dependency1, dependency2); return new WorkerB(dependency1); }} public class MyFactory{ private IWorkerA workerA; private IWorkerB workerB; public MyFactory(IWorkerA workerA, IWorkerB, workerB) { this.workerA = workerA; this.workerB = workerB; } public IMyWorker CreateInstance(WorkerType workerType) { if (workerType == WorkerType.A) return workerA; return workerB; }}",Simple Injector: Factory classes that need to create classes with dependencies
Java Iterator in C# var.iterator," I've noticed that Java's Iterator (interface) is similar to C#'s IEnumerable, but is there any way to use it like this: In Java I could just do: What's the C# equivalent of Java's Iterator interface? <code>  private IEnumerable<Label> it; it = labels.iterator(); private Iterator<JLabel> it;it = labels.iterator();",Java Iterator vs C# IEnumerable
""" Value does not fall within the expected range."" OracleParameter C# Entity Framework"," In order to prevent SQLinjection. I need to change my code from simple String to OracleParameter. Also I need to bypass LINQ because of its limitation in my WHERE CLAUSE as you can see below and last for better performance. By the way this code is working before I use OracleParameter.I got this error message ""Value does not fall within the expected range"".What's wrong or missing on my code, specially on OracleParameter and ExecuteStoreQuery part?I'm using the following:VS 2010Oracle 11gR2C#EntityFramework 4.3.1Code(.cs) SQL (qry) <code>  public List<ProgramAssetCodeViewModel> GetAssetToList(long _channelID, DateTime _startDate, DateTime _endDate, DateTime _startTime, DateTime _endTime, string _programName, bool isActualAiring){ List<ProgramAssetCodeViewModel> assetList = new List<ProgramAssetCodeViewModel>(); try { string qry = @""SELECT D.CHANNEL_NAME CHANNEL_NAME, TO_DATE(TO_CHAR(FN_TR_CONVERT_UTC_TIME ('TO_LOCAL', B.PROG_AIR_DT),'MM/DD/YYYY'),'MM/DD/YYYY') AIRING_DT, A.PROG_NAME, C.PROG_BODY_ASSET_CD, FN_TR_CONVERT_UTC_TIME ('TO_LOCAL', TO_DATE('01/01/2001' || TO_CHAR(B.START_TIME,'HH24:MI'),'MM/DD/YYYY HH24:MI')) START_TIME, FN_TR_CONVERT_UTC_TIME ('TO_LOCAL',TO_DATE('01/01/2001' || TO_CHAR( B.END_TIME,'HH24:MI'),'MM/DD/YYYY HH24:MI')) END_TIME, ASCII(UPPER(SUBSTR(C.PROG_BODY_ASSET_CD, -1)))-64 PROG_BODY_NO FROM PROGRAM_MSTR A, PROG_SKED_DTL B, PROG_BODY_MSTR C, CHANNEL_MSTR D WHERE B.CHANNEL_ID = D.CHANNEL_ID AND A.PROGRAM_ID = B.PROGRAM_ID AND B.PROG_SKED_ID = C.PROG_SKED_ID(+) AND B.CHANNEL_ID = :CHANNEL_ID AND A.PROG_NAME LIKE ('%' || :PROG_NAME ||'%') AND A.PROG_NAME NOT LIKE 'BS%' AND A.PROG_NAME NOT LIKE 'B/S%' AND (TO_DATE(TO_CHAR(FN_TR_CONVERT_UTC_TIME('TO_LOCAL', B.PROG_AIR_DT),'MM/DD/YYYY'),'MM/DD/YYYY') >= TO_DATE(:START_DATE,'MM/DD/YYYY') AND FN_TR_CONVERT_UTC_TIME ('TO_LOCAL', TO_DATE('01/01/2001' || TO_CHAR(B.START_TIME,'HH24:MI'),'MM/DD/YYYY HH24:MI')) >= TO_DATE ('01/01/2001 ' || :START_TIME, 'MM/DD/YYYY HH24:MI')) AND (TO_DATE(TO_CHAR(FN_TR_CONVERT_UTC_TIME('TO_LOCAL', B.PROG_AIR_DT),'MM/DD/YYYY'),'MM/DD/YYYY') <= TO_DATE(:END_DATE,'MM/DD/YYYY') AND ((TO_DATE ('01/01/2001 ' || :START_TIME, 'MM/DD/YYYY HH24:MI') < TO_DATE ('01/01/2001 ' || :END_TIME, 'MM/DD/YYYY HH24:MI') AND FN_TR_CONVERT_UTC_TIME ('TO_LOCAL', TO_DATE('01/01/2001' || TO_CHAR( B.END_TIME,'HH24:MI'),'MM/DD/YYYY HH24:MI')) <= TO_DATE ('01/01/2001 ' || :END_TIME, 'MM/DD/YYYY HH24:MI')) OR (TO_DATE ('01/01/2001 ' || :START_TIME, 'MM/DD/YYYY HH24:MI') >= TO_DATE ('01/01/2001 ' || :END_TIME, 'MM/DD/YYYY HH24:MI') AND FN_TR_CONVERT_UTC_TIME ('TO_LOCAL', TO_DATE('01/01/2001' || TO_CHAR( B.END_TIME,'HH24:MI'),'MM/DD/YYYY HH24:MI')) <= TO_DATE ('01/02/2001 ' || :END_TIME, 'MM/DD/YYYY HH24:MI')))) ORDER BY CHANNEL_NAME, AIRING_DT, START_TIME, END_TIME, PROG_BODY_NO""; string qryActual = @""SELECT D.CHANNEL_NAME CHANNEL_NAME, TO_DATE(TO_CHAR(FN_TR_CONVERT_UTC_TIME ('TO_LOCAL', B.PROG_AIR_DT),'MM/DD/YYYY'),'MM/DD/YYYY') AIRING_DT, A.PROG_NAME, C.PROG_BODY_ASSET_CD, FN_TR_CONVERT_UTC_TIME ('TO_LOCAL', TO_DATE('01/01/2001' || TO_CHAR(B2.ACTUAL_START_TIME,'HH24:MI'),'MM/DD/YYYY HH24:MI')) START_TIME, FN_TR_CONVERT_UTC_TIME ('TO_LOCAL',TO_DATE('01/01/2001' || TO_CHAR( B2.ACTUAL_END_TIME,'HH24:MI'),'MM/DD/YYYY HH24:MI')) END_TIME, ASCII(UPPER(SUBSTR(C.PROG_BODY_ASSET_CD, -1)))-64 PROG_BODY_NO FROM PROGRAM_MSTR A, PROG_SKED_DTL B, PROG_SKED_ACTUAL B2, PROG_BODY_MSTR C, CHANNEL_MSTR D WHERE B.CHANNEL_ID = D.CHANNEL_ID AND B.CHANNEL_ID = B2.CHANNEL_ID(+) AND B.PROGRAM_ID = B2.PROGRAM_ID(+) AND B.START_DT = B2.START_DT(+) AND B.START_TIME = B2.START_TIME(+) AND B.PROG_AIR_DT = B2.PROG_AIR_DT(+) AND A.PROGRAM_ID = B.PROGRAM_ID AND B.PROG_SKED_ID = C.PROG_SKED_ID(+) AND B.CHANNEL_ID = :CHANNEL_ID AND (TO_DATE(TO_CHAR(FN_TR_CONVERT_UTC_TIME('TO_LOCAL', B.PROG_AIR_DT),'MM/DD/YYYY'),'MM/DD/YYYY') >= TO_DATE(:START_DATE,'MM/DD/YYYY') AND FN_TR_CONVERT_UTC_TIME ('TO_LOCAL', TO_DATE('01/01/2001' || TO_CHAR(B2.ACTUAL_START_TIME,'HH24:MI'),'MM/DD/YYYY HH24:MI')) >= TO_DATE ('01/01/2001 ' || :START_TIME, 'MM/DD/YYYY HH24:MI')) AND (TO_DATE(TO_CHAR(FN_TR_CONVERT_UTC_TIME('TO_LOCAL', B.PROG_AIR_DT),'MM/DD/YYYY'),'MM/DD/YYYY') <= TO_DATE(:END_DATE,'MM/DD/YYYY') AND ((TO_DATE ('01/01/2001 ' || :ACTUAL_START_TIME, 'MM/DD/YYYY HH24:MI') < TO_DATE ('01/01/2001 ' || :ACTUAL_END_TIME, 'MM/DD/YYYY HH24:MI') AND FN_TR_CONVERT_UTC_TIME ('TO_LOCAL', TO_DATE('01/01/2001' || TO_CHAR( B2.ACTUAL_END_TIME,'HH24:MI'),'MM/DD/YYYY HH24:MI')) <= TO_DATE ('01/01/2001 ' || :END_TIME, 'MM/DD/YYYY HH24:MI')) OR (TO_DATE ('01/01/2001 ' || :ACTUAL_START_TIME, 'MM/DD/YYYY HH24:MI') >= TO_DATE ('01/01/2001 ' || :ACTUAL_END_TIME, 'MM/DD/YYYY HH24:MI') AND FN_TR_CONVERT_UTC_TIME ('TO_LOCAL', TO_DATE('01/01/2001' || TO_CHAR( B2.ACTUAL_END_TIME,'HH24:MI'),'MM/DD/YYYY HH24:MI')) <= TO_DATE ('01/02/2001 ' || :END_TIME, 'MM/DD/YYYY HH24:MI')))) AND A.PROG_NAME LIKE ('%' || :PROG_NAME ||'%') AND A.PROG_NAME NOT LIKE 'BS%' AND A.PROG_NAME NOT LIKE 'B/S%' ORDER BY CHANNEL_NAME, AIRING_DT, START_TIME, END_TIME, PROG_BODY_NO""; StringBuilder sb = isActualAiring ? sb = new StringBuilder(qryActual) : sb = new StringBuilder(qry); OracleParameter paramChannel = new OracleParameter() { ParameterName = ""CHANNEL_ID"", Value = _channelID.ToString(), OracleDbType = OracleDbType.Decimal, Size = 15, Direction = System.Data.ParameterDirection.Input }; //sb.Replace("":CHANNEL_ID"", _channelID.ToString()); sb.Replace("":START_DATE"", String.Format(""'{0:MM/dd/yyyy}'"", _startDate)); sb.Replace("":END_DATE"", String.Format(""'{0:MM/dd/yyyy}'"", _endDate)); sb.Replace("":START_TIME"", String.Format(""'{0:HH:mm}'"", _startTime)); sb.Replace("":END_TIME"", String.Format(""'{0:HH:mm}'"", _endTime)); sb.Replace("":PROG_NAME"", String.Format(""'{0}'"", _programName)); using (var ctx = new FITSEntities()) { foreach (var obj in ctx.GetObjectContext().ExecuteStoreQuery<ProgramAssetCodeWrapper>(sb.ToString(), new { paramChannel })) { assetList.Add(new ProgramAssetCodeViewModel { IsChecked = false, ChannelName = obj.CHANNEL_NAME, AirDate = obj.AIRING_DT.Value, ProgramName = obj.PROG_NAME, AssetCode = obj.PROG_BODY_ASSET_CD, StartTime = obj.START_TIME, EndTime = obj.END_TIME, ProgramBodyNo = obj.PROG_BODY_NO.HasValue ? (Int32)obj.PROG_BODY_NO.Value : 0 }); } } } catch { } return assetList;} SELECT D.CHANNEL_NAME CHANNEL_NAME, TO_DATE(TO_CHAR(FN_TR_CONVERT_UTC_TIME ('TO_LOCAL', B.PROG_AIR_DT),'MM/DD/YYYY'),'MM/DD/YYYY') AIRING_DT, A.PROG_NAME, C.PROG_BODY_ASSET_CD, FN_TR_CONVERT_UTC_TIME ('TO_LOCAL', TO_DATE('01/01/2001' || TO_CHAR(B.START_TIME,'HH24:MI'),'MM/DD/YYYY HH24:MI')) START_TIME, FN_TR_CONVERT_UTC_TIME ('TO_LOCAL',TO_DATE('01/01/2001' || TO_CHAR( B.END_TIME,'HH24:MI'),'MM/DD/YYYY HH24:MI')) END_TIME, ASCII(UPPER(SUBSTR(C.PROG_BODY_ASSET_CD, -1)))-64 PROG_BODY_NOFROM PROGRAM_MSTR A, PROG_SKED_DTL B, PROG_BODY_MSTR C, CHANNEL_MSTR DWHERE B.CHANNEL_ID = D.CHANNEL_IDAND A.PROGRAM_ID = B.PROGRAM_IDAND B.PROG_SKED_ID = C.PROG_SKED_ID(+)AND B.CHANNEL_ID = :CHANNEL_IDAND A.PROG_NAME LIKE ('%' || :PROG_NAME ||'%')AND A.PROG_NAME NOT LIKE 'BS%'AND A.PROG_NAME NOT LIKE 'B/S%'AND (TO_DATE(TO_CHAR(FN_TR_CONVERT_UTC_TIME('TO_LOCAL', B.PROG_AIR_DT),'MM/DD/YYYY'),'MM/DD/YYYY') >= TO_DATE(:START_DATE,'MM/DD/YYYY')AND FN_TR_CONVERT_UTC_TIME ('TO_LOCAL', TO_DATE('01/01/2001' || TO_CHAR(B.START_TIME,'HH24:MI'),'MM/DD/YYYY HH24:MI')) >= TO_DATE ('01/01/2001 ' || :START_TIME, 'MM/DD/YYYY HH24:MI'))AND (TO_DATE(TO_CHAR(FN_TR_CONVERT_UTC_TIME('TO_LOCAL', B.PROG_AIR_DT),'MM/DD/YYYY'),'MM/DD/YYYY') <= TO_DATE(:END_DATE,'MM/DD/YYYY')AND ((TO_DATE ('01/01/2001 ' || :START_TIME, 'MM/DD/YYYY HH24:MI') < TO_DATE ('01/01/2001 ' || :END_TIME, 'MM/DD/YYYY HH24:MI')AND FN_TR_CONVERT_UTC_TIME ('TO_LOCAL', TO_DATE('01/01/2001' || TO_CHAR( B.END_TIME,'HH24:MI'),'MM/DD/YYYY HH24:MI')) <= TO_DATE ('01/01/2001 ' || :END_TIME, 'MM/DD/YYYY HH24:MI'))OR (TO_DATE ('01/01/2001 ' || :START_TIME, 'MM/DD/YYYY HH24:MI') >= TO_DATE ('01/01/2001 ' || :END_TIME, 'MM/DD/YYYY HH24:MI')AND FN_TR_CONVERT_UTC_TIME ('TO_LOCAL', TO_DATE('01/01/2001' || TO_CHAR( B.END_TIME,'HH24:MI'),'MM/DD/YYYY HH24:MI')) <= TO_DATE ('01/02/2001 ' || :END_TIME, 'MM/DD/YYYY HH24:MI'))))ORDER BY CHANNEL_NAME, AIRING_DT, START_TIME, END_TIME, PROG_BODY_NO","Using OracleParameter in ExecuteStoreQuery Error Msg : "" Value does not fall within the expected range."""
C#: Streamwriter: File being used by another process," My program was practice for me, however, when I try to write all the directories it found, it crashes.I tried the following: Having it write to a file stream instead of the file itselfusing File.Writealllines using a list<> (this worked, only it did the first five and no more)FileStream.Write(subdir.ToCharArray())I cannot see why this wouldn't work, what have I done wrong? <code>  static void Main(string[] args){ Method(@""C:\"");}static void Method(string dir){ //crash happens here v StreamWriter sw = new StreamWriter(@""C:\users\""+Environment.UserName+""\desktop\log.txt"",true); foreach (string subdir in Directory.GetDirectories(dir)) { try { Console.WriteLine(subdir); sw.Write(subdir); Method(subdir); } catch (UnauthorizedAccessException) { Console.WriteLine(""Error""); } } sw.Close(); }",File being used by another process using StreamWriter
Relation between DLLs and Namespaces in C# / C++," High-level question here:I have spent a lot of time today educating myself on basic high-level concepts such as APIs, static and dynamic libraries, DLLs and marshaling in C#. Gaining all of this knowledge led me to what seems like a pretty basic question, and probably demonstrates a hole in my understanding of these concepts:What I know:DLLs may contain classes which in turn contains various class-members such as methods and fields, several of which I might want to utilize in my programIn C# we use the keyword ""using"" at the top of the code, to define a namespace wewant to include in our programWhat I do not get:I was under the impression that the actual methods were defined in the DLLs. How does my program find the actual functions that are defined in the DLLs, when all i give them is a namespace? It seems more intuitive to me to have ""using XYZ.dll"" at top, rather than ""using XYZ_namespace"".Thanks a lot for helping me fill in the gaps here.EDIT: Modified post to be specific to C#.EDIT 2: For other people that wonder how their C# application actually gets a hold of the types made available through ""using namespaceX"", this is a good resource (in addition to the helpful posts below): http://broadcast.oreilly.com/2010/07/understanding-c-namespaces-and.html.Basically the type you would like to use resides in libraries and you have to set Visual Studio to reference these libraries in order to make it possible to ""use"" its namespace in your code. <code> ",Relation between DLLs and Namespaces in C#
C# sort string[] by element length," Having an array of strings how can I update it so its elements are sorted by its length.I was trying So, I would get a,aa,ss,abc, but it says cannot implicitly convert type 'system.linq.iorderedenumerable to string[]'So, I was doing Is there other way to do this? <code>  string[] arr = {""aa"",""ss"",""a"",""abc""};arr = arr.OrderBy(aux => aux.Length); foreach (string s in arr.OrderBy(str => str.Length)){ //}",Sort string array by element length
Object assignement in C#," This is something I encountered while using the C# IList collections As far as I know, in C# (on the contrary of C++) when we create an object with this syntax, the object type get the right side (assignment) and not the left one (declaration).Do I miss something here !EDITI still don't get it, even after your answers, foo and bar have the same type ! <code>  IList<MyClass> foo = new List<MyClass>();var bar = new List<MyClass>();foo.AddRange() // doesn't compilebar.AddRange() // compile",Object assignment in C#
"Comparison between List, IList and IEnumerable", I have a C# application in which I handle some collection types. I need to know what the differences between these types are:ListIListIEnumerableWhat are the differences for each one in comparison with the others?  <code> ,"Comparison between List, IList, and IEnumerable"
Getting IDs of properties in entity framework," in my project I use Entity Framework 6.I have these entities: and When I insert a person object with filled in PersonRights it looks like this in the database:table for Person entity: table for PersonRights entity when I load a person from a database it hasnt filled PersonRights property because of the virtual keyword which is enabeling the lazy loading feature - and its okay.Then I get the PersonRights for the person object and it also works fine.The thing is, since there is no navigation property in PersonRight entity, the entity framework must know by which columns in the database are those two properties bounded.In database ther is a foreign key connecting PersonRights and People tables: The question is : Is there any way how to get the column name by which are those two properties connected?Any way how to get the string ""Person_Id"" in code?There is a way how to find out to which table is an entity bounded in database :http://www.codeproject.com/Articles/350135/Entity-Framework-Get-mapped-table-name-from-an-entthanks a lot for your answers :)EDIT:Well I found out that the column name propety is here: but I still cant reach it, the problem is weird, when I get first item from this collection it shows me that its type is System.Data.Entity.Core.Mapping.StorageEntityContainerMappingbut when I go through it by foreach suddenly the type is System.Data.Entity.Metadata.Edm.GlobalItem ...How can I access the System.Data.Entity.Core.Mapping.StorageEntityContainerMapping item where is also the collection I need to get the column named - AssociationSetMappings ?? <code>  public class Person { [Key] public int Id { get; set; } public string Name { get; set; } public virtual ICollection<PersonRight> PersonRights { get; set; } } public class PersonRight { [Key] public int Id { get; set; } public string Name { get; set; } } dbo.People with columns Id, Name dbo.PersonRights with columns Id, Name, Person_Id FK_dbo.PersonRights_dbo.People_Person_Id var items = ((IObjectContextAdapter)dbContext).ObjectContext.MetadataWorkspace.GetItems(DataSpace.CSSpace);",Getting mapped column names of properties in entity framework
Howto specify table name with Entity Framework Code First Fluen API," I have an Entity and I am to configure Entity Framework to map it to a database table with different name.I can easily do this with Code First DataAnnotations (DataAnnotations.Schema.TableAttribute).But due to limitations now I have to use Code First Fluent API (my domain objects will be used by external clients, so they shouldn't be technology-specific - e.g. have any references to DataAnnotations)I've searched on MSDN but found nothing. So is it possible and how?Thank you. <code> ",How to specify table name with Entity Framework Code First Fluent API
Howto specify table name with Entity Framework Code First Fluent API," I have an Entity and I am to configure Entity Framework to map it to a database table with different name.I can easily do this with Code First DataAnnotations (DataAnnotations.Schema.TableAttribute).But due to limitations now I have to use Code First Fluent API (my domain objects will be used by external clients, so they shouldn't be technology-specific - e.g. have any references to DataAnnotations)I've searched on MSDN but found nothing. So is it possible and how?Thank you. <code> ",How to specify table name with Entity Framework Code First Fluent API
"Empty Interface vs Attrtibute, what about generic constraints?"," I have a class, which uses an empty interface as a ""marker interface"", like this: I read in some other posts, but also on MSDN (http://msdn.microsoft.com/en-us/library/ms182128.aspx) that this should be avoided, and you should use custom attributes instead of this empty interface. So, I could refactor my code like this: Everything works fine, but the main question is:When I have a generic method elsewhere in my program, for instance: In the above function, I do need to add some generic type constraints on T, so only IMessages are allowed. How could I accomplish this when using a custom attribute instead of an empty interface?And does this justify the use of an empty interface? Or should I use an empty abstract class Message (instead of interface IMessage, since MyMessage is actually a Message).Very curious about what you think about this. <code>  namespace MyNameSpace{ public interface IMessage { //nothing in common here... } public class MyMessage : IMessage { public void SendMyMessage() { //Do something here } }} namespace MyNameSpace{ public class MessageAttribute : Attribute { //nothing in common here... } [MessageAttribute] public class MyMessage { public void SendMyMessage() { //Do something here } }} public IEnumerable<T> GetAll<T>() where T : IMessage{ //Return all IMessage things here}","Empty Interface vs Attribute, what about generic constraints?"
C# Read Private Key from PFX-file," I know, there are many posts about this, but still I cannot find a solution to get this to work. I have generated a PFX-file with openssl on my machine like this: In my C# app, I access the private key like this: This works perfectly fine (on my machine), but when I run the same code on another machine, it throws: ""Key set not found"", even though HasPrivateKey returns true! Shouldn't the private key be included in the *.pfx-file? Can you tell me:Was the certificate/private key somehow automatically installed on my machine by openssl when I created it?How can I read the private key from the *.PFX-file (or alternatively from the *.PEM-file)?StackTrace of Exception: Update:I've found out, that the following does work: However, to me, this is only a workaround, I would like to do it an a more conventional/standard compliant way! <code>  openssl x509 -req -days 365 -in ""myReqest.csr"" -signkey ""myPrivateKey.pem"" -out ""myCertificate.crt""openssl pkcs12 -export -out ""myCertificate.pfx"" -inkey ""myPrivateKey.pem"" -in ""myCertificate.crt"" -certfile ""myCertificate.crt"" var cert = new X509Certificate2(""myCertificate.pfx"", ""myPassword"");cert.HasPrivateKey; // This is always true!cert.PrivateKey; // Works on my machine (only) at System.Security.Cryptography.Utils.CreateProvHandle(CspParameters parameters, Boolean randomKeyContaier)at System.Security.Cryptography.Utils.GetKeyPairHelper(CspAlgorithmType keyType, CspParameters parameters, Boolean randomKeyContaier, Int32 dwKeySize, SafeProvHandle& safeProvHandle, SafeKeyHandle& safeKeyHandle)at System.Security.Cryptography.RSACryptoServiceProvider.GetKeyPair()at System.Security.Cryptography.RSACryptoServiceProvider..ctor(Int32 dwKeySize, CspParameters parameters, Boolean useDefaultKeySize)at System.Security.Cryptography.RSACryptoServiceProvider..ctor(CspParameters parameter)at System.Security.Cryptography.X509Certificates.X509Certificate2.get_PrivateKey() // on my machine// read certificate from file (exportable!)X509Certificate2 cert = new X509Certificate2(""filename.pfx"", ""password"", X509KeyStorageFlags.Exportable)// sign data etc.((RSACryptoServiceProvider)cert.PrivateKey).SignData(...// export private key to XML-fileFile.WriteAllText(""filename.xml"", cert.PrivateKey.ToXmlString(true));// on the other machine// create new RSA objectRSACryptoServiceProvider rsa = new RSACryptoServiceProvider();// import private key from xmlrsa.FromXmlString(File.ReadAllText(""filename.xml""));// verify data etc.rsa.VerifyData(...",Read Private Key from PFX-file
ESRI.ArcGIS.DataSourcesGDB.FileGDBWorkspaceFactoryClass' cannot be embedded," I made an add in application for arcmap in C# and I tried to connect with my File Geodatabase. So when I tried to run it I got this error: and then the path of the add inI have never seen this error before and I was wondering what is going wrong.This is the main code it's all about: So the error is at this line: I hope someone can provide me an explanation of this error and also a possible fix in my case.What is going wrong? <code>  Error 1 Interop type 'ESRI.ArcGIS.DataSourcesGDB.FileGDBWorkspaceFactoryClass' cannot be embedded. Use the applicable interface instead. public IWorkspace FileGdbWorkspaceFromPropertySet(string database) { IPropertySet propertySet = new PropertySetClass(); propertySet.SetProperty(""DATABASE"", database); IWorkspaceFactory workspaceFactory = new FileGDBWorkspaceFactoryClass(); return workspaceFactory.Open(propertySet, 0); } IWorkspaceFactory workspaceFactory = new FileGDBWorkspaceFactoryClass();","""ESRI.ArcGIS.DataSourcesGDB.FileGDBWorkspaceFactoryClass"" cannot be embedded"
cannot be embedded," I made an add in application for arcmap in C# and I tried to connect with my File Geodatabase. So when I tried to run it I got this error: and then the path of the add inI have never seen this error before and I was wondering what is going wrong.This is the main code it's all about: So the error is at this line: I hope someone can provide me an explanation of this error and also a possible fix in my case.What is going wrong? <code>  Error 1 Interop type 'ESRI.ArcGIS.DataSourcesGDB.FileGDBWorkspaceFactoryClass' cannot be embedded. Use the applicable interface instead. public IWorkspace FileGdbWorkspaceFromPropertySet(string database) { IPropertySet propertySet = new PropertySetClass(); propertySet.SetProperty(""DATABASE"", database); IWorkspaceFactory workspaceFactory = new FileGDBWorkspaceFactoryClass(); return workspaceFactory.Open(propertySet, 0); } IWorkspaceFactory workspaceFactory = new FileGDBWorkspaceFactoryClass();","""ESRI.ArcGIS.DataSourcesGDB.FileGDBWorkspaceFactoryClass"" cannot be embedded"
how to make gridview column visible true or flase dynamically?," I am using GridView in asp.net like this: my grid view code is as follows Here I am not able to set visible=false.I tried with the following answerHow do I make several gridview columns invisible dynamically?I am not finding datarow event in Visual Studio 2010. Can anyone help me to set the column visible property?my Column structure of data table iscolumn[0] is Value column then 4 other columns are there.my Column structure of Grid view iscolumn[0] is link fieldcolumn1 is Value field from Dtable4 other columns  <code>  mygrid.DataSource = dTable; mygrid.DataBind(); if (mygrid.Columns.Count > 1) { mygrid.Columns[2].Visible = false; } <asp:GridView ID=""mygrid"" runat=""server"" AllowPaging=""True"" onpageindexchanging=""mygrid_PageIndexChanging"" PageSize=""15"" PersistedSelection=""true"" ondatabound=""mygrid_DataBound""> <Columns> <asp:TemplateField> <ItemTemplate> <asp:HyperLink ID=""Edit"" runat=""server"" Text=""Edit"" NavigateUrl='<%# Eval(""Value"", ""~/myweppage.aspx?Id=M{0}"") %>' /> </ItemTemplate> </asp:TemplateField> </Columns> <PagerSettings PageButtonCount=""4"" /> </asp:GridView>",How to make gridview column visible true or false dynamically?
IIS Express - increse memory limit, I have a VS project in .NET MVC5 which loads an external dll file that uses a lot of memory. In average it uses from 500-1000MB memory.Now when I try to debug my project with default IIS Express server I almost always get OutOfMemory exception.I know that there is a /3gb flag for normal IIS but what about IIS Express. Are there any settings so I can enable this or is there any other solution to this problem except of installing a full IIS on development PC? PS: Developer PC has Windows 8.1 64x and Visual Studio 2013. <code> ,IIS Express - increase memory limit
How to use View Models in ASP.net MVC," I just started learning about ViewModels in ASP.NET MVC. So, I thought of implementing a sample example as below:Business Entity Add ViewModel Controller View Implementation The problem here is that I am unable to retrieve the values entered into the text boxes whenever the Add button is clicked; the corresponding AJAX action is being it.When I try to access the values of a and b, I get nulls instead of the values entered into the text boxes.I am not sure where I am going wrong. Please help. <code>  public class AddModel{ public int a { get; set; } public int b { get; set; } public int Add() { return (this.a + this.b); }} public class AddViewModel{ public AddModel addModel; public int Total { get; set; }} public class AddController : Controller{ [HttpPost] public JsonResult Add(AddViewModel model) { int iSum = model.addModel.a + model.addModel.b; model.Total = iSum; return Json(model); } public ActionResult Index() { return View(); }} @model ViewModelApplication.AddViewModel<script type=""text/javascript"" src=""../../Scripts/MicrosoftAjax.js""></script><script src=""../../Scripts/MicrosoftMvcAjax.debug.js"" type=""text/javascript""></script><script type=""text/javascript""> function Callback(data) { alert(""I am sucess call""); } function Failed() { alert(""I am a failure call""); }</script>@using (Ajax.BeginForm(""Add"", ""Add"", new AjaxOptions { OnSuccess = ""Callback"", OnFailure = ""Failed"" })){ <table align=""center""> <tr> <td class=""tdCol1Align""> <label> Number1</label> </td> <td class=""tdCol2Align""> @Html.TextBoxFor(Model => Model.addModel.a) </td> </tr> <tr> <td class=""tdCol1Align""> <label> Number2</label> </td> <td class=""tdCol2Align""> @Html.TextBoxFor(Model => Model.addModel.b) </td> </tr> <tr> <td colspan=""2"" align=""center""> <input type=""submit"" value=""Add"" class=""button"" /> </td> </tr> </table>}",How to use ViewModels in ASP.NET MVC?
Authorization failure in USPS Address verification API using c#?," Just i have a Registered with USPS which provides the US Address Validation API. I am using the following code to get the XML Response. But, unfortunately the Response says: Authorization Failure User 'xxxxxxxxx' is not authorized to use API Verify.USPSCOM::DoAuth.Do i missing something?Code: Please see: How to Validate Address on USPSNote: the User ID is my personal User ID that is issued by USPS Service Provider. <code>  void IsValidAddress(){ string USPS = ""http://production.shippingapis.com/ShippingAPITest.dll?API=Verify&XML=<AddressValidateRequest%20USERID='xxxxxxx'><Address ID='1'><Address1></Address1><Address2>8 Wildwood Drive</Address2><City>Old Lyme</City><State>CT</State><Zip5>06371</Zip5><Zip4></Zip4></Address></AddressValidateRequest>""; WebClient wsClient = new WebClient(); byte[] responseData = wsClient.DownloadData(USPS); string response = string.Empty; foreach (byte item in responseData) { //this will return the xml response response += (char)item; } string result = response; Response.Write(result);}",Authorization failure in USPS Address verification API
String.Format an integer to use a thousands separator with decimal value and in danish culture," I have a string totalPRice which holds a value like this 1147,5 I want two things.1)round the value so that there is always two digits after ,2)Implement thousands separator in this string, So that final out put will be some thing like this 1.147,50I have tried some thing like this It does my first requirement correctly by producing an output 1147,50.But I am way behind in my second requirement. Can any one tell me how I can achieve this?Note: In danish culture . stands for , and , stands for . <code>  String.Format(""{0:0.00}"", totalPRice)",String.Format an integer to use a thousands separator with decimal value in danish culture
"Can I define C# aliases for my own classes like int, string, object?"," Its not about using foo = MyPackage.Foo;I realize this has more to do with the IDE (Visual Studio 2010) that shows me special types in blue. And I want the same for some of my classes. I want it blue (presented as special) and be accessible in the whole project.The reason is that I want to give them meaning/importance so that everyone in my team knows this class is a key class of the whole project. Is that possible ? If there would be a file in the installation of my IDE and there would be the above keywords inside and I could add some keywords to it and save it and restart the IDE ?To have 2 classes do the very same I could do this. It would be 2 names for the same class. I know I would need to cast between those. <code>  // ""foo"" and ""Foo"" shall be just the same type:foo: MyPackage.Fooobject: System.Objectstring: System.Stringbool: System.Booleanbyte: System.Bytesbyte: System.SByteshort: System.Int16ushort: System.UInt16int: System.Int32uint: System.UInt32long: System.Int64ulong: System.UInt64float: System.Singledouble: System.Doubledecimal: System.Decimalchar: System.Char public class foo : Foo{ }","Can I define C# aliases/keywords for my own classes like int, string, object?"
C# unexcpected behaviour after returning from await," I know there are a lot of questions about async/await, but I couldn't find any answer to this.I've encountered something I don't understand, consider the following code: Obviously, on the await operator, the control returns to the caller, while the method being awaited, is running on the background. (assume an IO operation)But after the control comes back to the await operator, the execution becomes parallel, instead of (my expectation) remaining single-threaded.I'd expect that after ""Delay"" has been finished the thread will be forced back into the Poetry method, continues from where it left.Which it does. The weird thing for me, is why the ""Main"" method keeps running? is that one thread jumping from one to the other? or are there two parallel threads?Isn't it a thread-safety problem, once again?I find this confusing. I'm not an expert. Thanks. <code>  void Main(){ Poetry(); while (true) { Console.WriteLine(""Outside, within Main.""); Thread.Sleep(200); }}async void Poetry(){ //.. stuff happens before await await Task.Delay(10); for (int i = 0; i < 10; i++) { Console.WriteLine(""Inside, after await.""); Thread.Sleep(200); }}",Unexpected behaviour after returning from await
Unexcpected behaviour after returning from await," I know there are a lot of questions about async/await, but I couldn't find any answer to this.I've encountered something I don't understand, consider the following code: Obviously, on the await operator, the control returns to the caller, while the method being awaited, is running on the background. (assume an IO operation)But after the control comes back to the await operator, the execution becomes parallel, instead of (my expectation) remaining single-threaded.I'd expect that after ""Delay"" has been finished the thread will be forced back into the Poetry method, continues from where it left.Which it does. The weird thing for me, is why the ""Main"" method keeps running? is that one thread jumping from one to the other? or are there two parallel threads?Isn't it a thread-safety problem, once again?I find this confusing. I'm not an expert. Thanks. <code>  void Main(){ Poetry(); while (true) { Console.WriteLine(""Outside, within Main.""); Thread.Sleep(200); }}async void Poetry(){ //.. stuff happens before await await Task.Delay(10); for (int i = 0; i < 10; i++) { Console.WriteLine(""Inside, after await.""); Thread.Sleep(200); }}",Unexpected behaviour after returning from await
Post-increment by x," So, if I execute the following code... ... I get 0, 5, and 5, respectively. What I'd like to get, however is 0, 1, and 5. Is there any way to do a post-increment by n in C#? Or do I have to write out the += as its own statement?Just for context, what I'm actually doing is a bunch of BitConverter operations on a buffer, and it'd be really nice to have each one as a self-sufficient statement where the offset is incremented by the size of the data type being converted to. That way, if the buffer format is later changed, I can just add or remove the one line without having to worry about any of the surrounding code. <code>  int x = 0;Debug.WriteLine(x++);Debug.WriteLine(x += 4);Debug.WriteLine(x);",Post-increment x by n (n != 1)
Try to get files in directory in descending order of creation date using c#, I want to get a list of files in a folder sorted by their creation date using C#.I am using the following code: This will give the ascending order of the creation time. I actually want get the most recently created file in the first position of my array (descending order). <code>  if(Directory.Exists(folderpath)) { DirectoryInfo dir=new DirectoryInfo (folderpath); FileInfo[] files = dir.GetFiles().OrderBy(p=>p.CreationTime).ToArray(); foreach (FileInfo file in files) { ...... } },Get a list of files in a directory in descending order by creation date using C#
Calculated MD5 does not match existing property," I'm trying to pass an Azure Storage blob through an ashx. On the blockBlob.DownloadToStream(memoryStream) it's throwing the following Exception: Microsoft.WindowsAzure.Storage.StorageException: Calculated MD5 does not match existing propertyI know it's finding the correct blob. If I put in a container and path that don't exist then it gives me a 404 exception instead.I've Googled for hints on what might be causing this error but nothing useful is coming up. Does anyone have any thoughts on what might be causing this? I've rewritten this code a couple different ways over the last couple days but it always dies on DownloadToStream. <code>  using Microsoft.WindowsAzure;using Microsoft.WindowsAzure.Storage;using Microsoft.WindowsAzure.Storage.Auth;using Microsoft.WindowsAzure.Storage.Blob;public void ProcessRequest(HttpContext context) { // Retrieve storage account from connection string. Microsoft.WindowsAzure.Storage.CloudStorageAccount storageAccount = Microsoft.WindowsAzure.Storage.CloudStorageAccount.Parse(Microsoft.WindowsAzure.CloudConfigurationManager.GetSetting(""StorageConnectionString"")); // Create the blob client. CloudBlobClient blobClient = storageAccount.CreateCloudBlobClient(); // Retrieve reference to a previously created container. CloudBlobContainer container = blobClient.GetContainerReference(""gmt""); // Retrieve reference to blob named ""articles/142/222.jpg"". CloudBlockBlob blockBlob = container.GetBlockBlobReference(""articles/142/222.jpg""); using (var memoryStream = new MemoryStream()) { blockBlob.DownloadToStream(memoryStream); byte[] photoByte = ReadFully(memoryStream); context.Response.Clear(); context.Response.ContentType = ""image/jpeg""; context.Response.OutputStream.Write(photoByte, 0, photoByte.Length); }}public static byte[] ReadFully(Stream input) { input.Position = 0; using (MemoryStream ms = new MemoryStream()) { input.CopyTo(ms); return ms.ToArray(); }}",Azure Storage Calculated MD5 does not match existing property
c#: The 'await' operator can only be used within an async lambda expression," I've got a c# Windows Store app. I'm trying to launch a MessageDialog when one of the command buttons inside another MessageDialog is clicked. The point of this is to warn the user that their content is unsaved, and if they click cancel, it will prompt them to save using a separate save dialog. Here's my ""showCloseDialog"" function: In VS I get a compiler error: The 'await' operator can only be used within an async lambda expression. Consider marking this lambda expression with the 'async' modifier`The method is marked with await. If I remove await from before showSaveDialog, it compiles (and works) but I get a warning that I really should use awaitHow do I use await in this context?  <code>  private async Task showCloseDialog(){ if (b_editedSinceSave) { var messageDialog = new MessageDialog(""Unsaved work detected. Close anyway?"", ""Confirmation Message""); messageDialog.Commands.Add(new UICommand(""Yes"", (command) => { // close document editor.Document.SetText(TextSetOptions.None, """"); })); messageDialog.Commands.Add(new UICommand(""No"", (command) => { // save document await showSaveDialog(); })); messageDialog.DefaultCommandIndex = 1; await messageDialog.ShowAsync(); }}",The 'await' operator can only be used within an async lambda expression
webRequest.Headers has too many characters in character literal? (And another error)," When trying to upload something to Imgur, I have to put an Authorization in. I do it with WebRequest.Headers but it gives me three errors.2 times CS1012 error Too many characters in character literal and 1 time CS0019 error: Operator '+' cannot be applied to operands of type 'char' and 'method group'This is the code: What have I done wrong, how can I fix it, and how does it work?This is uploading with Imgur, I don't know if the 'GetToken' thing is right but it's to get the AccessToken, which should work correctly if I'm right. <code>  webRequest.Headers['Authorization'] = 'Bearer ' + GetToken;","Why I'm getting CS1012: ""Too many characters in character literal"" and CS0019?"
"ASP.NET Identity default Password Hasher, how does it work and is it secure?"," I am wondering wether the Password Hasher that is default implemented in the UserManager that comes with MVC 5 and ASP.NET Identity Framework, is secure enough? And if so, if you could explain to me how it works?IPasswordHasher interface looks like this: As you can see, it doesn't take a salt, but it is mentioned in this thread: ""Asp.net Identity password hashing"" that it does infact salt it behind the scenes. So I am wondering how does it do this? And where does this salt come from?My concern is that the salt is static, rendering it quite insecure. <code>  public interface IPasswordHasher{ string HashPassword(string password); PasswordVerificationResult VerifyHashedPassword(string hashedPassword, string providedPassword);}",ASP.NET Identity's default Password Hasher - How does it work and is it secure?
ASP.Net Identity's default Password Hasher and how does it work and is it secure?," I am wondering wether the Password Hasher that is default implemented in the UserManager that comes with MVC 5 and ASP.NET Identity Framework, is secure enough? And if so, if you could explain to me how it works?IPasswordHasher interface looks like this: As you can see, it doesn't take a salt, but it is mentioned in this thread: ""Asp.net Identity password hashing"" that it does infact salt it behind the scenes. So I am wondering how does it do this? And where does this salt come from?My concern is that the salt is static, rendering it quite insecure. <code>  public interface IPasswordHasher{ string HashPassword(string password); PasswordVerificationResult VerifyHashedPassword(string hashedPassword, string providedPassword);}",ASP.NET Identity's default Password Hasher - How does it work and is it secure?
"WaitHandle blocks the owner Thread of my CollectionView, kind of deadlock"," I've written a WPF WizardFramework which performs some actions in the background using some BackgroundWorker. While processing it can happen that I have to update an ObservableCollection which is bound to my UI. For this case I've written a ThreadableObservableCollection, which provides threadsafe methods for Insert, Remove and RemoveAt. Though I'm using .NET 4.5 I was not able to get BindingOperations.EnableCollectionSynchronization working without many other invalid access exceptions. My Collection looks like: This is working as expected, while I am using the wizard in my application. Now I'm using NUnit to write some integrationtests for the application. There's a listener which waits for the WizardViewModel to finish it's work and looking for some pages which are injected in the Steps-Collection. After the asyncrone work is done I can use Validate to check the viewmodel state. Unfortunately I'm using a ManualResetEvent to wait for the wizard to close. This looks like following: Now there's a problem:While the Application is running the UI Thread is not blocked, the Collection can be updated without any problems. But in my testcases the ""main"" Thread where I initialize the ViewModel (and because of that the Collections) is an AppDomainThread which is blocked by the testcode. Now my ThreadsafeInsert wants to update the collection but cannot use the AppDomain Thread. But I have to wait for the wizard to finish, how can I solve this kind of deadlock? Or is there a more elegant solution for this one?edit:I worked around this problem with a check if there's a user interface, and only then I invoke on the Application-Thread, otherwise I change the collection intentionally on another thread. This does not prevent the exception, but it is not recognized from the test... the items are inserted nevertheless, only the NotifyCollectionChanged-Handler is not called (which is only used in the UI anyway). This is an ugly workaround and I am still interested in a clean solution. Is there a way to use an alternate Dispatcher to create (e.g.) the whole ViewModel and use this to change my collection? <code>  public class ThreadableObservableCollection<T> : ObservableCollection<T> { private readonly Dispatcher _dispatcher; public ThreadableObservableCollection() { _dispatcher = Dispatcher.CurrentDispatcher; } public void ThreadsafeInsert(int pos, T item, Action callback) { if (_dispatcher.CheckAccess()) { Insert(pos, item); callback(); } else { _dispatcher.Invoke(() => { Insert(pos, item); callback(); }); } } [..] } public class WizardValidator : IValidator, IDisposable { private WizardViewModel _dialog; private readonly ManualResetEvent _dialogClosed = new ManualResetEvent(false); [..] public void ListenTo(WizardViewModel dialog) { _dialog = dialog; dialog.RequestClose += (sender, args) => _dialogClosed.Set(); dialog.StepsDefaultView.CurrentChanged += StepsDefaultViewOnCurrentChanged; _dialogClosed.WaitOne(); } [..] } if (Application.Current != null) { Application.Current.Dispatcher.Invoke(() => { Steps.Insert(pos, step); stepsView.MoveCurrentTo(step); }); } else { new Action(() => Steps.Insert(pos, step)).BeginInvoke(ar => stepsView.MoveCurrentToPosition(pos), null); }",ManualResetEvent WaitOne blocks the owner Thread of my CollectionView
Regex - Allow irish fada in string," I have a regular expression: Now, some of the customers have a fada over a vowel in their surname or firstname like the following: Brendn Note the fada over the a which you can get by holding down alt, ctrl and then pressing a.I have tried adding these characters into the regular expression but I get an error when the program tries to compile.The only way I can allow the user to enter such a character with a a fada is to remove the regular expression completely which means the user can enter anything they want.Is there any way to use the above expression and somehow allow the following characters? <code>  return Regex.IsMatch(_customer.FirstName, @""^[A-Za-z][A-Za-z0-9@#%&\'\-\s\.\,*]*$""); ",Unicode characters in Regex
Does exist Object Expression in C# like in F#?," There is one interesting concept in F# language:Object Expressions (F#)http://msdn.microsoft.com/en-us/library/dd233237.aspxDefinition: An object expression is an expression that creates a new instance of a dynamically created, anonymous object type that is based on an existing base type, interface, or set of interfaces.I wonder, does something similar exist in C#?Or this stuff is only available in F# programming language? <code> ","Does ""Object Expression"" exist in C# like in F#?"
how to 'Esc' key press in Selenium Webdriver using C#," I have a situation where I have to press on the 'ESC' key to stop the page from loading..This is definitely needed as otherwise the page will keep on loading for a minute.How do I make selenium webdriver to press the 'Esc' key. This has to be done using C#.Also, kindly mention the class that has to be imported <code> ",How to press 'Esc' key in Selenium WebDriver using C#
How to 'Esc' key press in Selenium Webdriver," I have a situation where I have to press on the 'ESC' key to stop the page from loading..This is definitely needed as otherwise the page will keep on loading for a minute.How do I make selenium webdriver to press the 'Esc' key. This has to be done using C#.Also, kindly mention the class that has to be imported <code> ",How to press 'Esc' key in Selenium WebDriver using C#
How to execute shell script in C#," I have one file which contains a Unix shell script. So now I wanted to run the same in .NET. But I am unable to execute the same.So my point is, is it possible to run the Unix program in .NET? Is there any API like NSTask in Objective-C for running Unix shell scripts so any similar API in .NET? <code> ",How do I execute a shell script in C#?
Missing first pixel column after a Graphics Transform Scale," I have noticed that the half of the first pixel column of the image is not drawn after a Graphics Transform Scale on the OnPaint event.All the code needed to reproduce it is at the end of the post. Basically I've created a Class derived from PictureBox called PictureBox2 and it overrides the OnPaint method to perform the Scale transformation. It also changes the InterpolationMode to NearestNeighbor to prevent Graphics from changing the pixels look.The PictureBox control was added to a Form called Form6_GraphicsTest. The control is anchored in all sides. The PictureBox2 back color was changed to blue and the Form back color to dark grey.As you can see on the image below, only 1/2 of the first pixel column of the image is drawn. Why?? Am I missing something here??Here is the original 10x10 8bpp image:EDIT - SolutionFor some ODD reason PixelOffsetMode.Default eats up 0.5 pixel. Solution: PixelOffsetMode.Half or HighQuality!Code PictureBox2.cs Code Form6_GraphicsTest.cs: <code>  using System.Drawing;using System.Drawing.Drawing2D;using System.Windows.Forms;namespace GraphicsTest{ public class PictureBox2 : PictureBox { public PointF Zoom = new PointF(20, 20); private InterpolationMode interpolationMode = InterpolationMode.NearestNeighbor; /// <summary> /// Paint the image /// </summary> /// <param name=""e"">The paint event</param> protected override void OnPaint(PaintEventArgs e) { if (IsDisposed) return; if (Image != null) { if (e.Graphics.InterpolationMode != interpolationMode) e.Graphics.InterpolationMode = interpolationMode; using (Matrix transform = e.Graphics.Transform) { //e.Graphics.ResetTransform(); if (Zoom.X != 1.0 || Zoom.Y != 1.0) transform.Scale(Zoom.X, Zoom.Y, MatrixOrder.Append); //if (ImageDisplayLocation.X != 0 || ImageDisplayLocation.Y != 0) //Convert translation back to display pixel unit. // transform.Translate(ImageDisplayLocation.X / Zoom.X, ImageDisplayLocation.Y / Zoom.Y); e.Graphics.Transform = transform; } } base.OnPaint(e); //If you want to draw something over the control in control coordinate, you must first reset the transformation! :D //e.Graphics.ResetTransform(); //Draw your stuff } }} using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Windows.Forms;namespace GraphicsTest{ public class Form6_GraphicsTest : Form { public Form6_GraphicsTest() { InitializeComponent(); Bitmap bmp = new Bitmap(@""D:\Test 10x10.8bpp.png""); this.pictureBox21.Image = bmp; this.pictureBox21.Zoom = new PointF(20,20); this.ClientSize = new Size(Convert.ToInt32(this.pictureBox21.Zoom.X * bmp.Width) + 30, Convert.ToInt32(this.pictureBox21.Zoom.Y * bmp.Height) + 30); } /// <summary> /// Required designer variable. /// </summary> private System.ComponentModel.IContainer components = null; /// <summary> /// Clean up any resources being used. /// </summary> /// <param name=""disposing"">true if managed resources should be disposed; otherwise, false.</param> protected override void Dispose(bool disposing) { if (disposing && (components != null)) { components.Dispose(); } base.Dispose(disposing); } #region Windows Form Designer generated code /// <summary> /// Required method for Designer support - do not modify /// the contents of this method with the code editor. /// </summary> private void InitializeComponent() { this.pictureBox21 = new GraphicsTest.PictureBox2(); ((System.ComponentModel.ISupportInitialize)(this.pictureBox21)).BeginInit(); this.SuspendLayout(); // // pictureBox21 // this.pictureBox21.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom) | System.Windows.Forms.AnchorStyles.Left) | System.Windows.Forms.AnchorStyles.Right))); this.pictureBox21.BackColor = System.Drawing.SystemColors.Highlight; this.pictureBox21.Location = new System.Drawing.Point(12, 12); this.pictureBox21.Name = ""pictureBox21""; this.pictureBox21.Size = new System.Drawing.Size(260, 238); this.pictureBox21.TabIndex = 0; this.pictureBox21.TabStop = false; // // Form6_GraphicsTest // this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F); this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font; this.BackColor = System.Drawing.SystemColors.ControlDarkDark; this.ClientSize = new System.Drawing.Size(284, 262); this.Controls.Add(this.pictureBox21); this.Name = ""Form6_GraphicsTest""; this.Text = ""Form6_GraphicsTest""; ((System.ComponentModel.ISupportInitialize)(this.pictureBox21)).EndInit(); this.ResumeLayout(false); } #endregion private PictureBox2 pictureBox21; }}",Missing half of first pixel column after a Graphics Transform Scale
Specifying property values when instantiating immutable objects with AutoFixture," My test requires that I set the Response property on an immutable Rsvp object (see below) to a specific value. I initially tried to do this using Build<Rsvp>().With(x => x.Rsvp, ""Attending""), but realized this only supports writable properties.I replaced that with Build<Rsvp>().FromFactory(new Rsvp(""Attending"")). This works, but is cumbersome for more complex objects where it doesn't matter what some of the properties are. For instance, if the Rsvp object had a CreatedDate property, this method of instantiating the object would force me to write Build<Rsvp>().FromFactory(new Rsvp(""Attending"", fixture.Create<DateTime>())). Is there a way to only specify values for meaning properties for an immutable object? <code>  public class Rsvp{ public string Response { get; private set; } public Rsvp(string response) { Response = response; }}",Specifying [readonly] property values [via ctor args] when instantiating [immutable] objects with AutoFixture
c# show dialog on first start of application," Is there an easy way to show an dialog when the program is started for the first time (and only the first time), for some kind of instruction or specifying settings? <code> ",Show dialog on first start of application
How propagate change and notify object about it properly," Lets say I have classes like this If a user has two views open, one displaying instances of R and another allowing users to modify an instance of A, I need the view of R to change when the user changes any instance of A.If the user changes a property of an instance of A, what is the best way to propagate that change (through instances of S) so that all instances of R display the new state of A? <code>  public class R{ protected string name; protected List<S> listOfObjectS;}public class S{ private string name, ID; private A objectA;}public class A{ private string name; private int count;}",How to propagate property change notifications of objects within collections
C# Parse date of ISO 8601 value 24:00:00 fails," I'm trying to parse incoming date from data source (which cannot be changed). It gives me time in ISO 8601 format example: 2007-04-05T24:00.How ever in .Net it fails to parse this as valid time.The wikipedia states that it should be valid format. Wikipedia ISO 8601Example from https://stackoverflow.com/a/3556188/645410How can I do this without a nasty string check hack?Example (fiddle: http://dotnetfiddle.net/oB7EZx): Throws: The DateTime represented by the string is not supported in calendar System.Globalization.GregorianCalendar. <code>  var strDate = ""2007-04-05T24:00""; Console.WriteLine(DateTime.Parse(strDate, null, DateTimeStyles.RoundtripKind));",Parse date of ISO 8601 value 24:00:00 fails
Getting error 2147220472 (Could not start Quickbooks)," I am getting error -2147220472 when I try to connect to Quickbooks. The application is executed by a windows service. The log file is as follows: This actually works at times, but I can't see a pattern. What might be causing this?In a nutshell, the code being used to connect is as follows: <code>  I 8788 RequestProcessor ========= Started Connection =========I 8788 RequestProcessor Request Processor, QBXMLRP2 v12.0I 8788 RequestProcessor Connection opened by app named 'QBWatcher'I 8788 RequestProcessor OS: Microsoft Professional (build 9200), 64-bitI 8788 RequestProcessor Current Process is elevatedI 8788 RequestProcessor Current User is in AdminGroupI 8788 RequestProcessor Current Process is ran as AdminI 8788 RequestProcessor Current Process Integrity Level : 3000I 8788 RequestProcessor Previous instance of QB is going down..! Wait and retry to get a new instance.I 8788 RequestProcessor Previous instance of QB is going down..! Wait and retry to get a new instance.I 8788 RequestProcessor Previous instance of QB is going down..! Wait and retry to get a new instance.I 8788 RequestProcessor Previous instance of QB is going down..! Wait and retry to get a new instance.I 8788 RequestProcessor Previous instance of QB is going down..! Wait and retry to get a new instance.E 8788 RequestProcessor Could not find or create an instance of QuickBooks using InstanceFinderI 8788 RequestProcessor Connection closed by app named 'QBWatcher'I 8788 RequestProcessor ========== Ended Connection ==========I 8788 CertVerifier The file does not contain an Authenticode signature. qbxmlConn.OpenConnection2(filename, ""QBWatcher"", QBXMLRP2Lib.QBXMLRPConnectionType.localQBD);QBXMLRP2Lib.IAuthPreferences qbAuthPrefs = qbxmlConn.AuthPreferences; qbAuthPrefs.PutPersonalDataPref(QBXMLRP2Lib.QBXMLRPPersonalDataPrefType.pdpNotNeeded);qbAuthPrefs.PutUnattendedModePref(QBXMLRP2Lib.QBXMLRPUnattendedModePrefType.umpOptional);ticket = qbxmlConn.BeginSession(filename, QBXMLRP2Lib.QBFileMode.qbFileOpenDoNotCare);",Getting error -2147220472 (Could not start Quickbooks)
how to manually load related entities in a N:N relationship?," I am using EF5 and when the the relationship is 1:N, if I want to load related entities I do the following:With T-SQL I load from database the main entities with a T-SQL like that: with T-SQL I load the related entities At this point EF populate the property navigation of the main entities with the related entities. Also, in the local property of the type of each entity in the dbContext I have all the entities of each type.However, if i do the same with a N:N relationship, I don't have the entity of the middle table of the relation, and when I execute the queries I have in the local of the dbContext the entities of each type, but the property navigation is not populated.I would like to know why and if it exists some alternative.I use this way because I want to use T-SQL for create dynamic queries. If I use eager loading I don't have the same flexibility to dynamic queries than when I use TSQL, and it is less efficient. If I use explicit loading I to do N additional queries, one of each record in the results of the main entity With my way, I only one additional query, because I get all the related entities at once. If I use lazy loading I have the same problem, N additional queries.Why EF does not populate the related properties when the relation is N:N?Thanks. <code>  select * from MainEntities where ... select * from RelatedEntities where IDMainEntity IN (---)",How to manually load related entities in a N:N relationship?
c# params overload apparent ambiguity - still compiles and works?," We just found these in our code: As you can see, these have the same signature except for the params.And they're being used in several ways, one of them: which, strangely enough to me, resolves to the first overload.Q1: Why doesn't this produce a compile error?Q2: Why does the C# compiler resolve the above call to the first method?Edit: Just to clarify, this is C# 4.0, .Net 4.0, Visual Studio 2010. <code>  public static class ObjectContextExtensions{ public static T Find<T>(this ObjectSet<T> set, int id, params Expression<Func<T, object>>[] includes) where T : class { ... } public static T Find<T>(this ObjectSet<T> set, int id, params string[] includes) where T : class { ... }} DBContext.Users.Find(userid.Value); //userid being an int? (Nullable<int>)",params overload apparent ambiguity - still compiles and works?
How to use CultureInfo to format depricated currencies?," In dotnet, the recommended way of formatting currencies in a culture-specific way, is (as far as I can find): This returns: However. No specific currency is given here. So if Great Britain ever converts to Euro, the same method would suddenly return something like: This has just happened to Latvia. This year, it converted to the euro. Various systems contain both amounts in letvian lats and euros. I need to be able to still print and format old currencies. And I need to be sure new currencies can also be handled. This formatting is not just about the symbol, but also about the placement (before, after, with or without space) and the local number format (decimal separator and thousands separator).Every amount in our database has a currency (e.g. EUR) and a corresponding culture (e.g. nl-NL). Euro amounts are formatting differently depending on if they originate from our German or our Dutch office. (they both use euros, but format the amounts differently)Does dotnet provide access to older currencies?What is a future-proof way of writing the formatting amounts?Right now, the only way I can think of, is to copy the culture-database to my database. <code>  using System.Globalizationvar info = CultureInfo.GetCultureInfo(""en-GB"")return string.Format(info, ""{0:c}"", 1234.5678) 1,234.57 1,234.57",How to use CultureInfo to format deprecated currencies?
"Equivalent of `ContinueWith(delegate, CancellationToken)` with `await` continuation"," I have that situation: In particular, the behavior that interests me here is detailed in MSDN's page about Continuation Tasks in the following terms: A continuation goes into the Canceled state in these scenarios: [...] When the continuation was passed a System.Threading.CancellationToken as an argument and the IsCancellationRequested property of the token is true before the continuation runs. In such a case, the continuation does not start and it transitions to the Canceled state. The code above works. However, I am in the process of converting as many as possible of my continuations to using the await keyword. Is there an equivalent using await that would allow the continuation to be canceled before the awaited task completes? <code>  private Task LongRunningTask = /* Something */;private void DoSomethingMore(Task previousTask) { }public Task IndependentlyCancelableSuccessorTask(CancellationToken cancellationToken){ return LongRunningTask.ContinueWith(DoSomethingMore, cancellationToken);}","Equivalent of ContinueWith(delegate, CancellationToken) with await continuation"
Asp.net Mvc data annotations attribute Range set from another property value," Hi I have following in my Asp.net MVc ModelTestModel.cs Now from my controller ""OpeningAmount "" is assign .Finaly when I submit form I want to check that ""amount"" must be greater than ""OpeningAmonut"" . so want to set Range dynamically like I do not want to use only Jquery or javascript because it will check only client side so possible I can set Range attribute minimum dynamically than it would be great for. <code>  public class TestModel{ public double OpeningAmount { get; set; }[Required(ErrorMessage=""Required"")][Display(Name = ""amount"")][Range(0 , double.MaxValue, ErrorMessage = ""The value must be greater than 0"")]public string amount { get; set; }} [Range(minimum = OpeningAmount , double.MaxValue, ErrorMessage = ""The value must be greater than 0"")]",ASP.NET MVC data annotations attribute Range set from another property value
ThreadAbortException handling in asp.net while executing Response.End method," While executing Response.End(); method in asp.net it throws ThreadAbortException which I handled in catch block, after end of inner catch block I want to execute some further code but it directly jump to outer catch block. Is This happening because of response has ended and .net framework do not execute any further code? <code>  protected void btn_click(object sender, EventArgs e){ try { string fileToDownload = MapPath(@""~\Sample.txt""); string fileToRead = MapPath(@""~\FileNotExist.txt""); try { //Section 1 try { // try to read the file which does not exist to raise the exception StreamReader ss = new StreamReader(fileToRead); } catch (IOException IoEx) { // Just for sample exception } // Section 2 code block still execute because exception handled by upper try catch block //Section 2 Response.Clear(); Response.ClearHeaders(); Response.AddHeader(""Content-Disposition"", ""attachment;filename=SampleTemplate.txt""); Response.ContentType = ""text""; Response.WriteFile(fileToDownload); Response.Flush(); Response.End(); } catch (System.Threading.ThreadAbortException abrtEx) { // do not treat this exception as Exception } //Section 3 Code block not executing even after exception handeled by ThreadAbortException //Section 3 string test = ""Do futher process after sample downloaded""; } catch (Exception ex) // Outer Catch Block { throw ex; }}",ThreadAbortException handling in asp.net while executing Response.End() method
`using` with commas can cause a memory leak?," C# lets me do the following (example from MSDN): What happens if font4 = new Font throws? From what I understand font3 will leak resources and won't be disposed of.Is this true? (font4 won't be disposed of)Does this mean using(... , ...) should be avoided altogether in favor of nested using? <code>  using (Font font3 = new Font(""Arial"", 10.0f), font4 = new Font(""Arial"", 10.0f)){ // Use font3 and font4.}","Can ""using"" with more than one resource cause a resource leak?"
`using` with commas can cause a resource leak?," C# lets me do the following (example from MSDN): What happens if font4 = new Font throws? From what I understand font3 will leak resources and won't be disposed of.Is this true? (font4 won't be disposed of)Does this mean using(... , ...) should be avoided altogether in favor of nested using? <code>  using (Font font3 = new Font(""Arial"", 10.0f), font4 = new Font(""Arial"", 10.0f)){ // Use font3 and font4.}","Can ""using"" with more than one resource cause a resource leak?"
OnFileActivated event not working," I'm working on this Windows Store App, I want it to support Open With when the end user wants to open a file using this app, I added the supported format to the declarations section in the app manifest file as this picture shows :And I overrode the OnFileActivated event in the App.xaml.cs file as follows : This event seems to not be firing when I perform OpenWith on a .MP4 file, the application lunches but can't quit the splash screen, I tried to debug the event like this threadexplains but the debugger doesn't stop at any breakpoint marked in the OnFileActivated method, I appreciate your help.Update 1 : When OpenWith on a file , and after that the app can't quite the Splash Screen , I'm having now this message box error Update 2:I changed my OnFileActivated event handler to be like this : where OpenedFile is a : That I pass as a parameter through the navigation in the OnLaunched event: And PlayerPageView is the page that will consume the video in a MediaElementAll this update also doesn't work , I don't understand what I should do, I would be happy if you clarify things to me. <code>  protected override void OnFileActivated(FileActivatedEventArgs args) { if (args.Files.Count > 1) { MessageDialog messageDialog1 = new MessageDialog(""DirectTouchPlayer can't open many files, the first file will be opened.""); messageDialog1.ShowAsync(); } OpenedMediaFile = (StorageFile)args.Files.First(); MessageDialog messageDialog2 = new MessageDialog(OpenedMediaFile.Path + "" "" + "" : Opened !""); messageDialog2.ShowAsync(); } protected override async void OnFileActivated(FileActivatedEventArgs args) { var loadMediaFileTask = new Task<IStorageItem>(() => { return args.Files.First(); }); OpenedFile = await loadMediaFileTask; } public static IStorageItem OpenedFile { get; set; } if (rootFrame.Content == null) { // When the navigation stack isn't restored navigate to the first page, // configuring the new page by passing required information as a navigation // parameter rootFrame.Navigate(typeof(PlayerPageView), OpenedFile); }",How to override OnFileActivated event in App.cs to make OpenWith works right
"C# How to modify type parameter of Expression<Func<???, bool>>?"," I have an instance of the following: I wish to convert it to an instance of the following, so it can be used to run a query in Entity Framework: This will allow me to utilize a generic filtering query to any Model which implements IRequiredDate, eg.: I understand that they are different types and cannot be cast. However I am wondering if there is a way to create a new Expression<Func<TModel, bool>>, then rebuild it based on the contents of the Expression<Func<IRequiredDate, bool>> provided, switching any type references from IRequiredDate to TModel in the process.Can this be done? <code>  Expression<Func<IRequiredDate, bool>> Expression<Func<TModel, bool>> // In some repository function:var query = DbContext.Set<Order>() .FilterByDateRange(DateTime.Today, DateTime.Today);var query = DbContext.Set<Note>() .FilterByDateRange(DateTime.Today, DateTime.Today);var query = DbContext.Set<Complaint>() .FilterByDateRange(DateTime.Today, DateTime.Today);// The general purpose function, can filter for any model implementing IRequiredDatepublic static IQueryable<TModel> FilterByDate<TModel>(IQueryable<TModel> query, DateTime startDate, DateTime endDate) where TModel : IRequiredDate{ // This will NOT WORK, as E/F won't accept an expression of type IRequiredDate, even though TModel implements IRequiredDate // Expression<Func<IRequiredDate, bool>> dateRangeFilter = x => x.Date >= startDate && x.Date <= endDate; // query = query.Where(dateRangeFilter); // This also WON'T WORK, x.Date is compiled into the expression as a member of IRequiredDate instead of TModel, so E/F knocks it back for the same reason: // Expression<Func<TModel, bool>> dateRangeFilter = x => x.Date >= startDate && x.Date <= endDate; // query = query.Where(dateRangeFilter); // All you need is lov.... uh... something like this: Expression<Func<IRequiredDate, bool>> dateRangeFilter = x => x.Date >= startDate && x.Date <= endDate; Expression<Func<TModel, bool>> dateRangeFilterForType = ConvertExpressionType<IRequiredDate, TModel>(dateRangeFilter); // Must convert the expression from one type to another query = query.Where(dateRangeFilterForType) // Ahhhh. this will work. return query;}public static ConvertExpressionType<TInterface, TModel>(Expression<Func<TInterface, bool>> expression)where TModel : TInterface // It must implement the interface, since we're about to translate them{ Expression<Func<TModel, bool>> newExpression = null; // TODO: How to convert the contents of expression into newExpression, modifying the // generic type parameter along the way?? return newExpression;}","How to modify type parameter of Expression<Func<???, bool>>?"
c# HttpClient PostAsync turns 204 into 404," Given this WebApi service: And this HttpClient PostAsync call: I would expect response.EnsureSuccessStatusCode(); to succede but it throws a 404 instead.The funny thing is that fiddler tells med that the webapi service is returning 204 as expected and when I debug it the KillPerson runs without issue.Update:I Have determined that this only happens when the client code is within a PCL or Silverlight 5 project. The exact same code will give the expected 204 if I duplicate it in a Windows forms application. If i point the Windows Forms app to client code contained in a PCL it gives me the 404 Again.Update2:This resolves the issue (though it bothers me no end that I should need to do it): This reintroduces the 404 (fiddler still says 204 and non-silverlight client runs fine) Update 3 (resolved):Finally figured this out. Seems you get a choice of using either browser or client HTTP handling in Silverlight. When using browser HTTP handling a lot of stuff is unsupported - including various response codes and headers.Adding these lines before calling HttpClient fixed it: <code>  [ActionName(""KillPerson"")][HttpPost]public void KillPerson([FromBody] long id){ // Kill} var httpClient = new HttpClient { BaseAddress = new Uri(ClientConfiguration.ApiUrl) };httpClient.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue(""application/json""));var serializerSettings = new JsonSerializerSettings{ PreserveReferencesHandling = PreserveReferencesHandling.Objects, Formatting = Formatting.Indented, ReferenceLoopHandling = ReferenceLoopHandling.Serialize};var serializedParameter = JsonConvert.SerializeObject(parameter, serializerSettings);var httpContent = new StringContent(serializedParameter, Encoding.UTF8, ""application/json"");var response = await httpClient.PostAsync(serviceUrl, httpContent).ConfigureAwait(false);response.EnsureSuccessStatusCode(); [ActionName(""KillPerson"")][HttpPost]public HttpResponseMessage KillPerson([FromBody] long id){ return this.Request.CreateResponse(HttpStatusCode.OK);} [ActionName(""KillPerson"")][HttpPost]public HttpResponseMessage KillPerson([FromBody] long id){ return this.Request.CreateResponse(HttpStatusCode.NoContent);} WebRequest.RegisterPrefix(""http://"", WebRequestCreator.ClientHttp);WebRequest.RegisterPrefix(""https://"", WebRequestCreator.ClientHttp);",C# HttpClient PostAsync turns 204 into 404
Should I implement IEquatable or IComparable?," I have a class. The thing that this class is meant to represent is such that we may speak about such things being equal to each other, and we may also come up with a scheme to rank them for purposes of comparison.However, it so happens that it is rare that one feels the need to rank these things, but one often needs to check if two such things are equal.So, I can implement both IEquatable for my class as well as IComparable. While IComparable provides some extra functionality, it is very unlikely that anyone will care about this extra functionality. Neither one seemingly provides a clear advantage, either logically or functionality-wise.Which interface should I implement, IEquatable, IComparable, or both? Why? (I am specifically wondering about framework-wide implications either interface)This question is similar, but the answers only state the obvious, which doesn't help me.In case you are wondering, the class is meant to represent a nucleotide. Nucleotides can readily be equated, but they can also be compared (eg. alphabetically). <code> ","Should I implement IEquatable, or IComparable?"
Decimal precision when serializing doubles to JSON," Consider the following JSON object: Now suppose I'm mapping this to a .NET type Foo: The type of Foo.Value is double, because Value isn't always an integer value.Using JSON.NET, this works beautifully: However, observe what happens when I try to convert the object back to its JSON representation: Output: Notice the trailing zero? How do I get rid of it?EDITI suspect that the answer will be write your own converter. If it is, then that's fine and I guess I'll accept that as the answer. I'm just wondering if perhaps there exists an attribute that I don't know of that lets you specify the output format (or similar). <code>  { ""value"": 0 } class Foo{ public double Value { get; set; }} Foo deserialized = JsonConvert.DeserializeObject<Foo>(json); string serialized = JsonConvert.SerializeObject(deserialized, Formatting.Indented); { ""Value"": 0.0}",Decimal precision of zero when serializing doubles to JSON
Located assembly's manifest definition does not match," I am trying to upgrade Unity to version (2.1.505.2), but when I run the application I get the following FileLoadException Could not load file or assembly 'Microsoft.Practices.Unity, Version=2.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies.We are upgrading from Unity 2.0.414.0 to 2.1.505.2.All project references in the solution that refer to Unity refer to the correct version of the dllThere is no Unity dll referenced in the Gac. (double checked by checking gacutil -l)I removed all Unity dlls from the archive. Double checked with powershell How can I find out what / who still refers to the Unity 2.0.414.0?FusionLogVw doesn't tell me which DLL is causing the problem. Any help is much appreciated! <code>  PS C:\> ls -rec -inc Microsoft.Practices.Unity.dll | foreach-object { ""{0}`t{1}"" -f $_.FullName, [System.Diagnostics.FileVersionInfo]::GetVersionInfo($_).FileVersion }",Could not load file or assembly 'Microsoft.Practices.Unity'
ASP.NET - Text of TextBox does not change in code behind," I have a textbox on my website: On page load I fill that textbox with something from a databse: When I want to update my databse with a new value in that textbox, it still updated the database with the one put in on page load: How can I make sure that setCoordinates() retrieves the new value from the textbox and not the initial value from the database from Latitude.Text = thisPlace.Latitude;? <code>  <asp:TextBox ID=""Latitude"" runat=""server"" ClientIDMode=""Static"" ></asp:TextBox> protected void Page_Load(object sender, EventArgs e){ Latitude.Text = thisPlace.Latitude;} protected void Save_Click(object sender, EventArgs e){ setCoordinates(Latitude.Text);}",Why does my save use the initial value of my TextBox and not the entered value?
Text of TextBox does not change in code behind," I have a textbox on my website: On page load I fill that textbox with something from a databse: When I want to update my databse with a new value in that textbox, it still updated the database with the one put in on page load: How can I make sure that setCoordinates() retrieves the new value from the textbox and not the initial value from the database from Latitude.Text = thisPlace.Latitude;? <code>  <asp:TextBox ID=""Latitude"" runat=""server"" ClientIDMode=""Static"" ></asp:TextBox> protected void Page_Load(object sender, EventArgs e){ Latitude.Text = thisPlace.Latitude;} protected void Save_Click(object sender, EventArgs e){ setCoordinates(Latitude.Text);}",Why does my save use the initial value of my TextBox and not the entered value?
How to call PoweShell cmdlets from C# in Visual Studio," I'm creating a PowerShell cmdlets from Visual Studio and I can't find out how to call cmdlets from within my C# file, or if this is even possible? I have no trouble running my cmdlets one by one, but I want to set up a cmdlet to run multiple cmdlets in a sequel.  <code> ",How to call PowerShell cmdlets from C# in Visual Studio
How to change a WPF SolidColorBrush resource's colour at runtime?," How can I change a colour in a resource dictionary being used in another resource dictionary at runtime?Here's my setup:Colours.xaml: Styles.xaml: Window.xaml Code behind: When the code runs the colour of the grid doesn't change. I don't think Application.Current.Resources[""themeColour""] is referring to my solidcolorbrush resource as when if I try to access it before assigning it a new colour, I get a null object reference exception. So, how should I access the resource ""themeColour""? <code>  <SolidColorBrush x:Key=""themeColour"" Color=""#16A8EC""/> <Style x:Key=""titleBar"" TargetType=""Grid""> <Setter Property=""Background"" Value=""{DynamicResource themeColour}""/></Style> .....<ResourceDictionary.MergedDictionaries> <ResourceDictionary Source=""res/Styles.xaml""/> <ResourceDictionary Source=""res/Colours.xaml""/></ResourceDictionary.MergedDictionaries>.....<Grid Style=""{DynamicResource titleBar}""></Grid> Application.Current.Resources[""themeColour""] = new SolidColorBrush(newColour);",How to change a SolidColorBrush resource's colour at runtime?
EF6 - Value cannot be null. Parameter name: extent," I'm using EF6 code first to create my db. Everything was working well last night, now when i run update-database command, I get the following exception: Here is the Context Class And here is the Configuration: I've searched internet and found that I should only have properties in my context class. And I checked thrice, it only has dbset properties. I'm unable to figure out what has happened. Any help would be greatly appreciated. Thanks. <code>  PM> update-databaseSpecify the '-Verbose' flag to view the SQL statements being applied to the target database.System.ArgumentNullException: Value cannot be null.Parameter name: extent at System.Data.Entity.Utilities.Check.NotNull[T](T value, String parameterName) at System.Data.Entity.Core.Mapping.StorageEntitySetMapping..ctor(EntitySet extent, StorageEntityContainerMapping entityContainerMapping) at System.Data.Entity.ModelConfiguration.Edm.DbDatabaseMappingExtensions.AddEntitySetMapping(DbDatabaseMapping databaseMapping, EntitySet entitySet) at System.Data.Entity.ModelConfiguration.Edm.Services.TableMappingGenerator.Generate(EntityType entityType, DbDatabaseMapping databaseMapping) at System.Data.Entity.ModelConfiguration.Edm.Services.DatabaseMappingGenerator.GenerateEntityTypes(DbDatabaseMapping databaseMapping) at System.Data.Entity.ModelConfiguration.Edm.Services.DatabaseMappingGenerator.Generate(EdmModel conceptualModel) at System.Data.Entity.DbModelBuilder.Build(DbProviderManifest providerManifest, DbProviderInfo providerInfo) at System.Data.Entity.DbModelBuilder.Build(DbConnection providerConnection) at System.Data.Entity.Internal.LazyInternalContext.CreateModel(LazyInternalContext internalContext) at System.Data.Entity.Internal.RetryLazy`2.GetValue(TInput input) at System.Data.Entity.Internal.LazyInternalContext.InitializeContext() at System.Data.Entity.Internal.LazyInternalContext.get_CodeFirstModel() at System.Data.Entity.Infrastructure.EdmxWriter.WriteEdmx(DbContext context, XmlWriter writer) at System.Data.Entity.Utilities.DbContextExtensions.<>c__DisplayClass1.<GetModel>b__0(XmlWriter w) at System.Data.Entity.Utilities.DbContextExtensions.GetModel(Action`1 writeXml) at System.Data.Entity.Utilities.DbContextExtensions.GetModel(DbContext context) at System.Data.Entity.Migrations.DbMigrator..ctor(DbMigrationsConfiguration configuration, DbContext usersContext) at System.Data.Entity.Migrations.DbMigrator..ctor(DbMigrationsConfiguration configuration) at System.Data.Entity.Migrations.Design.ToolingFacade.BaseRunner.GetMigrator() at System.Data.Entity.Migrations.Design.ToolingFacade.UpdateRunner.Run() at System.AppDomain.DoCallBack(CrossAppDomainDelegate callBackDelegate) at System.AppDomain.DoCallBack(CrossAppDomainDelegate callBackDelegate) at System.Data.Entity.Migrations.Design.ToolingFacade.Run(BaseRunner runner) at System.Data.Entity.Migrations.Design.ToolingFacade.Update(String targetMigration, Boolean force) at System.Data.Entity.Migrations.UpdateDatabaseCommand.<>c__DisplayClass2.<.ctor>b__0() at System.Data.Entity.Migrations.MigrationsDomainCommand.Execute(Action command)Value cannot be null.Parameter name: extent public class WheelTrackDb : DbContext{ public WheelTrackDb(): base(""DefaultConnection""){ } protected override void OnModelCreating(DbModelBuilder modelBuilder) { modelBuilder.Entity<Driver>() .HasRequired(d => d.Vehicle) .WithOptional(v => v.Driver) .Map(m => m.MapKey(""VehicleId"")); modelBuilder.Entity<TransactionLog>() .HasRequired(t => t.Acceptor) .WithMany() .HasForeignKey(t => t.AcceptorId) .WillCascadeOnDelete(false); modelBuilder.Entity<TransactionLog>() .HasRequired(t => t.Donor) .WithMany() .HasForeignKey(t => t.DonorId) .WillCascadeOnDelete(false); modelBuilder.Entity<Violation>() .HasRequired(v => v.GSMDeviceLog) .WithMany(g => g.Violations) .HasForeignKey(v => v.GSMDeviceLogId); modelBuilder.Entity<RouteFence>().Ignore(r => r.PolygonVertices); modelBuilder.Entity<Vehicle>() .HasRequired(v => v.License) .WithRequiredPrincipal(); modelBuilder.Entity<MessageCounter>() .HasRequired(m => m.License) .WithOptional(l => l.MessageCounter) .Map(m => m.MapKey(""LicenseId"")); modelBuilder.Entity<GSMDeviceLog>() .HasRequired(g => g.Vehicle) .WithMany(t => t.GsmDeviceLogs); } public DbSet<UserInfo> UserInfos{ get; set; } public DbSet<TransactionLog> TransactionLogs{ get; set; } public DbSet<Driver> Drivers { get; set; } public DbSet<Vehicle> Vehicles{ get; set; } public DbSet<VehicleGroup> VehicleGroups { get; set; } public DbSet<License> Licenses { get; set; } public DbSet<Policy> Policys { get; set; } public DbSet<GSMDeviceLog> GSMDeviceLogs { get; set; } public DbSet<MessageCounter> MessageCounters { get; set; } public DbSet<Violation> Violations { get; set; } public DbSet<OwnershipPaper> OwnershipPapers { get; set; } public DbSet<Subscriber> Subscribers { get; set; }} internal sealed class Configuration : DbMigrationsConfiguration<WheelTrack.Models.WheelTrackDb>{ public Configuration() { AutomaticMigrationsEnabled = true; } protected override void Seed(WheelTrack.Models.WheelTrackDb context) { }}",Value cannot be null. Parameter name: extent
Java and C# Different output in same scenario," Ok! I have same code written in Java and C# but the output is different! Output: Class A. It is in C#.But when same code was ran in Java, the output was Class B. Here is the Java Code: So, why this is showing different results? I do know that, in Java, all methods are virtual by default that's why Java outputs Class B.Another thing is that, both languages claim that they are emerged or inspired by C++ then why they are showing different results while both have same base language(Say). And what does this line A a = new B(); actually doing? Isn't a holding object of class B? If it is so, then why C# displays Class A and Java shows Class B?NOTE This question was asked in interview with the same code provided above. And I answered with output Class B (with respect to Java) but he said Class A will be right output.Thank you! <code>  class A{ public void print() { Console.WriteLine(""Class A""); }}class B : A { public void print() { Console.WriteLine(""Class B""); }}class Program{ static void Main(string[] args) { A a = new B(); a.print(); Console.Read(); }} class A{ public void print() { System.out.println(""Class A""); }}class B extends A { public void print() { System.out.println(""Class B""); }}public class Program{ public static void main(String []args){ A a = new B(); a.print(); }}",Java Vs C#: Java and C# subclasses with method overrides output different results in same scenario
Java and C# subclasses with method overrides output different results in same scenario," Ok! I have same code written in Java and C# but the output is different! Output: Class A. It is in C#.But when same code was ran in Java, the output was Class B. Here is the Java Code: So, why this is showing different results? I do know that, in Java, all methods are virtual by default that's why Java outputs Class B.Another thing is that, both languages claim that they are emerged or inspired by C++ then why they are showing different results while both have same base language(Say). And what does this line A a = new B(); actually doing? Isn't a holding object of class B? If it is so, then why C# displays Class A and Java shows Class B?NOTE This question was asked in interview with the same code provided above. And I answered with output Class B (with respect to Java) but he said Class A will be right output.Thank you! <code>  class A{ public void print() { Console.WriteLine(""Class A""); }}class B : A { public void print() { Console.WriteLine(""Class B""); }}class Program{ static void Main(string[] args) { A a = new B(); a.print(); Console.Read(); }} class A{ public void print() { System.out.println(""Class A""); }}class B extends A { public void print() { System.out.println(""Class B""); }}public class Program{ public static void main(String []args){ A a = new B(); a.print(); }}",Java Vs C#: Java and C# subclasses with method overrides output different results in same scenario
C# implicitly updates parameter passed to method with no return type and no out or ref usage," This is so funky to me, obviously the developer should have used the keyword out but I can't believe this is even working: My coworker said this is called ""deep reference"", I can't believe this works in C#. I would refactor to use out aka private void ProcessResult(out BusinessResponse<MyResultType> result) but I would still like to know why this code works.UPDATESo it looks like I am incorrect and this code is just fine. Seems the sentiment is, that as a C# developer I should immediately know, since the argument passed into processResult is a reference type on the heap being passed in by value that a copy of the reference itself is made and that copied reference still points to the same object. <code>  public BusinessResponse<MyResultType> MyMethod(){ BusinessResponse<MyResultType> res = new BusinessResponse<MyResultType>(); ProcessResult(res); return res; //this has the values set by ProcessResult!!! How?}private void ProcessResult(BusinessResponse<MyResultType> result){ result.State = BusinessResponseState.Success; //set some other stuff in the result argument}",Implicitly updates parameter passed to method with no return type and no out or ref usage
"check if record exist in database C#, Windows Form Application"," I am using these lines of code to check if the record exists or not. But I am getting an error: I want to do: <code>  SqlCommand check_User_Name = new SqlCommand(""SELECT * FROM Table WHERE ([user] = '"" + txtBox_UserName.Text + ""') "", conn);int UserExist = (int)check_User_Name.ExecuteScalar(); Object reference not set to an instance of an object. if (UserExist > 0) // Update recordelse // Insert record",Check if a record exists in the database
Check if record exist in database," I am using these lines of code to check if the record exists or not. But I am getting an error: I want to do: <code>  SqlCommand check_User_Name = new SqlCommand(""SELECT * FROM Table WHERE ([user] = '"" + txtBox_UserName.Text + ""') "", conn);int UserExist = (int)check_User_Name.ExecuteScalar(); Object reference not set to an instance of an object. if (UserExist > 0) // Update recordelse // Insert record",Check if a record exists in the database
Check if record exists in database," I am using these lines of code to check if the record exists or not. But I am getting an error: I want to do: <code>  SqlCommand check_User_Name = new SqlCommand(""SELECT * FROM Table WHERE ([user] = '"" + txtBox_UserName.Text + ""') "", conn);int UserExist = (int)check_User_Name.ExecuteScalar(); Object reference not set to an instance of an object. if (UserExist > 0) // Update recordelse // Insert record",Check if a record exists in the database
Convert image path to base64 string," How do you convert an image from a path on the user's computer to a base64 string in C#?For example, I have the path to the image (in the format C:/image/1.gif) and would like to have a data URI like data:image/gif;base64,/9j/4AAQSkZJRgABAgEAYABgAAD.. representing the 1.gif image returned. <code> ",Convert an image (selected by path) to base64 string
How secure the user name and password in the connection string?," when developing windows applications:How I secure the user name and password in the connection string?Organizations like banks, would they give out the user name and password of their DB to application developers? if not typically how those applications developers write the DB Connections?What is the industry standard to secure user and password in the connection string?thanks <code> ",How secure the user name and password in the connection string?
How secure the user name and password in the connection string? {continues...}," when developing windows applications:How I secure the user name and password in the connection string?Organizations like banks, would they give out the user name and password of their DB to application developers? if not typically how those applications developers write the DB Connections?What is the industry standard to secure user and password in the connection string?thanks <code> ",How secure the user name and password in the connection string?
Unity3D C# - get component," What is the simplest way to getcomponent in Unity3D C#?My case: Another C# script FlipMech.cs, which I need to check from MainGameLogic.cs if(backfacedisplayed == TRUE), I will call BackfaceDisplay()from MainGameLogic.cs. How can I do it in C#?In js is rather straight forward. In FlipMech.js: Then wherever I need: But it seems like C# is way more complicated that this. <code>  GameObject gamemaster. //C# script MainGameLogic.cs(attached to gamemaster). A boolean backfacedisplayed(in MainGameLogic.cs).A function BackfaceDisplay()(in MainGameLogic.cs). //declare gamemastervar gamemaster:GameObject; if(gamemaster.GetComponent(MainGameLogic).backfacedisplayed==true){ gamemaster.GetComponent(MainGameLogic).BackfaceDisplay();}",Unity3D - get component
"C# - why does the compiler treat the return type of Func<dynamic, int> as strongly typed?"," Why does the following compile? It sure seems like the compiler has enough info to know that the attempted assignment is invalid, since the return type of the Func<> is not dynamic. <code>  Func<dynamic, int> parseLength = whatever => whatever.Length;dynamic dynamicString = ""String with a length"";DateTime wrongType = parseLength(dynamicString);","Why does the compiler treat the return type of Func<dynamic, int> as strongly typed?"
How to fiz the size of a C# Windows Form Application from resizing," I have a C# Windows Form application that I am working on and when I build the form on the development PC it looks fine but when I move the exe onto another machine everything resizes. This then through's out the picturebox and button controls. I have specified the size of the controls in VS but it seems to ignore these. I have also fixed the minimum and maximum sizes to be the same but this has not resolved the issue.Can anyone point me the direction of something that I have missed as I need to fix the size of the controls.Thanks in advance.New PCDevelopment PC <code>  this.interviewPb.Image = ((System.Drawing.Image(resources.GetObject(""interviewPb.Image"")));this.interviewPb.Location = new System.Drawing.Point(771, 366);this.interviewPb.Margin = new System.Windows.Forms.Padding(3, 2, 3, 2);this.interviewPb.Name = ""interviewPb"";this.interviewPb.Size = new System.Drawing.Size(393, 492);this.interviewPb.TabIndex = 9;this.interviewPb.TabStop = false;",How to fix the size of a C# Windows Form Application from resizing
Moq and DbFunctions," I'm currently attempting to run some unit tests on a query that is running through the Entity Framework. The query itself runs without any issues on the live version, but the unit tests are always failing.I've narrowed this down to my usage of DbFunctions.TruncateTime, but I don't know of a way around this to get the unit tests to reflect what is happening on the live server.Here is the method that I am using: If I comment out the lines with DbFunctions in, the tests all pass (except for the ones that are checking that only valid results for a given date are run).Is there a way I can provide a mocked version of DbFunctions.TruncateTime to use in these tests? Essentially it should just be returning Datetime.Date, but that isn't available in EF queries.Edit: Here's the test that's failing that uses the date check: Edit 2: This is the message and debug trace from the test in question: From what I've read, this is because there isn't a LINQ to Entities implementation of this method that could be used in this place for the Unit Test, although there is on the live version (as it's querying an SQL server). <code>  public System.Data.DataTable GetLinkedUsers(int parentUserId) { var today = DateTime.Now.Date; var query = from up in DB.par_UserPlacement where up.MentorId == mentorUserId && DbFunctions.TruncateTime(today) >= DbFunctions.TruncateTime(up.StartDate) && DbFunctions.TruncateTime(today) <= DbFunctions.TruncateTime(up.EndDate) select new { up.UserPlacementId, up.Users.UserId, up.Users.FirstName, up.Users.LastName, up.Placements.PlacementId, up.Placements.PlacementName, up.StartDate, up.EndDate, }; query = query.OrderBy(up => up.EndDate); return this.RunQueryToDataTable(query); } [TestMethod] public void CanOnlyGetCurrentLinkedUsers() { var up = new List<par_UserPlacement> { this.UserPlacementFactory(1, 2, 1), // Create a user placement that is current this.UserPlacementFactory(1, 3, 2, false) // Create a user placement that is not current }.AsQueryable(); var set = DLTestHelper.GetMockSet<par_UserPlacement>(up); var context = DLTestHelper.Context; context.Setup(c => c.par_UserPlacement).Returns(set.Object); var getter = DLTestHelper.New<LinqUserGetLinkedUsersForParentUser>(context.Object); var output = getter.GetLinkedUsers(1); var users = new List<User>(); output.ProcessDataTable((DataRow row) => students.Add(new UserStudent(row))); Assert.AreEqual(1, users.Count); Assert.AreEqual(2, users[0].UserId); } Test Result: FailedMessage: Assert.AreEqual failed. Expected:<1>. Actual:<0>Debug Trace: This function can only be invoked from LINQ to Entities",How do I use Moq and DbFunctions in unit tests to prevent a NotSupportedException?
Is it possible to call T-SQL function in LINQ?," I tried this one: And I declared the function like this: In edmx file I have this: But Entity Framework throws the exception that the query cannot be constructed. This error I receive: The specified method 'System.String GetProvinceCodeByLatLong(Double, Double)' on the type 'Infrastructure.CustomRepositories.AssetDataRepository' cannot be translated into a LINQ to Entities store expression <code>  GetProvinceCodeByLatLong(a.Latitude, a.Longitude) [DbFunction(""Core.Models"", ""fn_GetProvinceCodeByLatLong"")]public static string GetProvinceCodeByLatLong(double latitude, double longitude){ throw new NotSupportedException(""Direct calls are not supported."");} <Function Name=""fn_GetProvinceCodeByLatLong"" ReturnType=""varchar"" Aggregate=""false"" BuiltIn=""false"" NiladicFunction=""false"" IsComposable=""true"" ParameterTypeSemantics=""AllowImplicitConversion"" Schema=""dbo""> <Parameter Name=""latitude"" Type=""float"" Mode=""In"" /> <Parameter Name=""longitude"" Type=""float"" Mode=""In"" /></Function>",Is it possible to call T-SQL function in Entity Framework and LINQ?
how to merger two case in one at switch statement," Is there any way to merge the two ""case"" statements together? <code>  switch(code){ case 'A': case 'a': // to do default: // to do }",How to merge two case statements in one switch statement
How do i capture lost focus on a Textbox?," I have a texbox tbx1, when I have the cursor blinking on the textbox, when I click the mouse on some other control I want to display a message, But the issue is I have to use an event of the textbox tbx1 to capture that focus change. <code> ",How do I capture lost focus on a Textbox?
Doing a postback without AutoPostBack," I've got a WebForm with two drop down lists, where the contents of the second one depend on the first.So if the user changes the category, the second dropdown needs to be filled with the list of subcategories.This sounds like a typical job for AutoPostBack.However, there's a bit of a problem with AutoPostBack: if the list isn't dropped open, and the user uses the keyboard to make the choice, the postback happens right after the first keystroke. This prevents the user from scrolling down the list with the down arrow, or typing the name of the category.This happens in Chrome and IE and Opera, but not in Firefox. Firefox fires the onchange event only when leaving the control (tabbing to the next control), just like it would when the list was dropped open, and that's what I want the other browsers to do too.Any solutions how I can achieve this?I tried to remove the AutoPostBack attribute and use onblur, but apparently the page works differently with AutoPostBack than without, because the browsers start complaining about Javascript errors.Now since we're all so fond of jsFiddle, here's one. It doesn't actually do anything, but it can demonstrate the problem. Click on the first dropdown, then click again to close the list. (This is what happens when you navigate through the form with the tab key: dropdown lists don't open up.) Now type a letter or the down arrow. Firefox changes the current selection and waits for you to do anything else, but Chrome and IE and Opera all attempt to submit the form immediately, with drastic results.So how can I avoid that? And note that simply changing the fiddle may not be enough, it must be translatable back to an ASP.NET solution. <code> ",Doing a postback without AutoPostBack
Doing a postback without AutoPostBack - Ajax cascade dropdown," I've got a WebForm with two drop down lists, where the contents of the second one depend on the first.So if the user changes the category, the second dropdown needs to be filled with the list of subcategories.This sounds like a typical job for AutoPostBack.However, there's a bit of a problem with AutoPostBack: if the list isn't dropped open, and the user uses the keyboard to make the choice, the postback happens right after the first keystroke. This prevents the user from scrolling down the list with the down arrow, or typing the name of the category.This happens in Chrome and IE and Opera, but not in Firefox. Firefox fires the onchange event only when leaving the control (tabbing to the next control), just like it would when the list was dropped open, and that's what I want the other browsers to do too.Any solutions how I can achieve this?I tried to remove the AutoPostBack attribute and use onblur, but apparently the page works differently with AutoPostBack than without, because the browsers start complaining about Javascript errors.Now since we're all so fond of jsFiddle, here's one. It doesn't actually do anything, but it can demonstrate the problem. Click on the first dropdown, then click again to close the list. (This is what happens when you navigate through the form with the tab key: dropdown lists don't open up.) Now type a letter or the down arrow. Firefox changes the current selection and waits for you to do anything else, but Chrome and IE and Opera all attempt to submit the form immediately, with drastic results.So how can I avoid that? And note that simply changing the fiddle may not be enough, it must be translatable back to an ASP.NET solution. <code> ",Doing a postback without AutoPostBack
Dispose method call in using block in exception," In C#, if an exception occurs inside a ""using"" block, does the Dispose method get called? <code> ","If an exception occurs inside a ""using"" block, is the Dispose method called?"
Entity Framework retrieve data from table with forign key," I have 3 tables in my SQL Server database Role, Permission and RolePermission. RolePermission consists of two columns qRole and qPermission which are the foreign keys for the other two tables.Therefore when Entity Framework creates the model for it, it just create two classes and add virtual property for RolePermission into each role and permission classes. Now I need to select columns from RolePermission so what I did I wrote this piece of code: Doing this I can access rolePermission table however I need to retrieve some column from role table and some column from rolePermission in a single query like what we do in a join statement in SQL. In other words, I need a linq query to access some column from role table and some from rolePermission but I need to do it in just one linq query like a join statement in SQL.Thanks <code>  var rolePermission = PREntitiy.Roles.Where(r => r.qRole == TxtRole.Text) .Select(p => p.Permissions);",Entity Framework retrieve data from table with foreign key
Issue with MultipartFormDataContent and boundary," I have the following code: When I run it, I see the Content-Type header in Fiddler: Because the boundary value is in quotes, the server ignores the request body. If I remove the quotes and run the request in Fiddler Composer, the request is being processed correctly.I tried adding the content headers: ... but it didn't work, the error messages were: ""Cannot add value because header 'Content-Type' does not support multiple values."" and ""The format of value 'multipart/form-data, boundary=----CustomBoundary8d0f024297b32d5' is invalid."", correspondingly.How can I add the proper Content-Type header to the request so that the boundary value would not be enclosed in quotes? <code>  private static string boundary = ""----CustomBoundary"" + DateTime.Now.Ticks.ToString(""x"");private static async Task<string> PostTest(){ string servResp = """"; using (var content = new MultipartFormDataContent(boundary)) { content.Add(new StringContent(""105212""), ""case-id""); content.Add(new StringContent(""1/14/2014""), ""dateFrom""); content.Add(new StringContent(""1/15/2014""), ""dateTo""); HttpClientHandler handler = new HttpClientHandler(); cookieContainer = new CookieContainer(); handler.CookieContainer = cookieContainer; HttpRequestMessage request = new HttpRequestMessage(HttpMethod.Post, ""http://somewebsite.com/form""); request.Headers.ExpectContinue = false; request.Content = content; httpClient = new HttpClient(handler); HttpResponseMessage response = await httpClient.SendAsync(request); response.EnsureSuccessStatusCode(); servResp = await response.Content.ReadAsStringAsync(); } return servResp;} Content-Type: multipart/form-data; boundary=""----CustomBoundary8d0f01e6b3b5daf"" //request.Content.Headers.Add(""Content-Type"", ""multipart/form-data; boundary="" + boundary);//request.Content.Headers.ContentType = new System.Net.Http.Headers.MediaTypeHeaderValue(""multipart/form-data; boundary="" + boundary); Content-Type: multipart/form-data; boundary=----CustomBoundary8d0f01e6b3b5daf",Wrong Content-Type header generated using MultipartFormDataContent
How to auto-generate a C# class file from a JSON object string," Given the following JSON object, what is a tool to auto-generate the following C# class? We have already looked at these questions: Generate C# classes from JSON Schema Is asking about JSON Schemas which may be an approach to use down the road.Benefits and drawbacks of generated C# classes for Json objects <code>  form = { ""name"": """", ""address"": { ""street"": """", ""city"": """", ""province"": """", ""postalCode"": """", ""country"": """" }, ""phoneDay"": """", ""phoneCell"": """", ""businessName"": """", ""website"": """", ""email"": """"} public class ContactInfo{ public string Name { get; set; } public Address Address { get; set; } public string PhoneDay { get; set; } public string PhoneCell { get; set; } public string BusinessName { get; set; } public string Website { get; set; } public string Email { get; set; }}public class Address{ public string Street { get; set; } public string City { get; set; } public string Province { get; set; } public string PostalCode { get; set; } public string Country { get; set; }}",How to auto-generate a C# class file from a JSON string
where to put automapper code," I'm using Automapper in Asp.net mvc application.I have a question regard to the usage of automapperfrom lots of sample code, I saw people use mapper Mapper.Map<Target>(source) directly in action, I'm not sure if this is good prctice, in my point of view, I would like to wrap the Mapper code in the proxy object instead of let it talk with controller directly in this example, controller know nothing about Class Bankflow, all it know is the dto BankflowData.I would like to know if this is a good practice for an application using AutoMapper? <code>  public BankflowData CreateBankflowAdjustments(BankflowData addedBankFlow) { var bankflow = Mapper.Map<Bankflow>(addedBankFlow); var newBankflow = Underlying.CreateBankFlowAdjustments(bankflow); return Mapper.Map<BankflowData>(newBankflow); }",Where should I put automapper code?
Task unhandled exceptions c#," I'm trying to understand what is going on with exceptions that are thrown within a task object and never handled.On MSDN it said that: If you do not wait on a task that propagates an exception, or access its Exception property, the exception is escalated according to the .NET exception policy when the task is garbage-collected.So I don't quite understand in what way those exceptions affect program flow. I thought that those exceptions should interrupt execution as soon as they are garbage-collected. But I can not design this behaviour. Within the following snippet the thrown exception doesn't show up. Please, can anyone explain how unhandled task exception are dealt with and how they affect program flow. <code>  // Do something ...Task.Run (()=> {throw new Exception(""Exception in the task!"");});// Do something else",Task unhandled exceptions
What's the difference between the System.Net.Http and System.Web.Http namespaces?," Just a simple question as I'm studying the various class libraries available in .NET. I noticed that there's a System.Net.Http namespace and a System.Web.Http namespace.What purpose(s) do both namespaces serve?What were the motivations for creating two seemingly ambiguous namespaces?Is there any history I should know about or is one of the namespaces ""deprecated""?System.Net.Http, System.Web.Http <code> ",Why is there both a System.Net.Http and System.Web.Http namespace?
Find a Ninject And Singleton Better Approach," I have a class (MyFacade) that I injected parameter(s) with Ninject: Of course, I have to setup the Ninject to inject the appropiate implementation of my parameter (IDemoInterface)I know, I can instantiate MyFacade object by doing kernel.Get<MyFacade>(); without setting anything else. Currently my facade doesn't have an interface (because it is my only implementation, maybe I will add its interface for standard proposes)if I want to make this facade singlenton, I know two ways: create a empty constructor and pass a parameter by doing this kernel.Get<IDemoInterface>(); or by setup Ninject like: kernel.Bind<MyFacade>().To<MyFacade>().InSingletonScope();The second one look a better approach, but do you know any other way to setup it in a singleton way? <code>  class MyFacade{ IDemoInterface demo; public MyFacade(IDemoInterface demo) { this.demo = demo; } public void MyMethod() { Console.WriteLine(demo.GetInfo()); }} ",Ways to setup a Ninject singleton
MonoDevelop-Unity (Mac) - Change default column width?," I'm trying to change the default column ruler width from 120 to 80. I've come close to it by changing it in Preferences/Source Code/Code Formatting/Text File/Desired file width:; but it warns that ""Changes made in this section will only be applied to new projects. Settings for existing projects can be modified in the project (or solution) options dialog"".The problem is, I do not have a Project or Solution; I am just editing some loose scripts I created in a Unity3D project: The whole ""Project"" menu (which contains both ""Project Options"" and ""Solution Options"" submenues)is grayed out, and hence unselectable.Any way out?EDIT Upon restart, my setting of 80 characters seems to have been applied... I will still accept any answer that elucidates the preference dynamics...ADDENDUM This applies to MonoDevelop-Unity version 4.0.1 as shipped with Unity version 4.3.3f1. <code> ",Change default column width / show column ruler in MonoDevelop?
Change default column width in MonoDevelop?," I'm trying to change the default column ruler width from 120 to 80. I've come close to it by changing it in Preferences/Source Code/Code Formatting/Text File/Desired file width:; but it warns that ""Changes made in this section will only be applied to new projects. Settings for existing projects can be modified in the project (or solution) options dialog"".The problem is, I do not have a Project or Solution; I am just editing some loose scripts I created in a Unity3D project: The whole ""Project"" menu (which contains both ""Project Options"" and ""Solution Options"" submenues)is grayed out, and hence unselectable.Any way out?EDIT Upon restart, my setting of 80 characters seems to have been applied... I will still accept any answer that elucidates the preference dynamics...ADDENDUM This applies to MonoDevelop-Unity version 4.0.1 as shipped with Unity version 4.3.3f1. <code> ",Change default column width / show column ruler in MonoDevelop?
C# Error equivalent of value error," Is there a C# error exception for a value error? the equivalent of the python ""value error"" below? <code>  except ValueError as e:","C# equivalent of ""value error"" in Python"
Invalid setup on a non-virtual (overridable in VB) member," I have a unit test where I have to mock a non-virtual method that returns a bool type So I have a mock object of XmlCupboardAccess class and I am trying to setup mock for this method in my test case as shown below But this line throws exception Any suggestion how to get around this exception? <code>  public class XmlCupboardAccess{ public bool IsDataEntityInXmlCupboard(string dataId, out string nameInCupboard, out string refTypeInCupboard, string nameTemplate = null) { return IsDataEntityInXmlCupboard(_theDb, dataId, out nameInCupboard, out refTypeInCupboard, nameTemplate); }} [TestMethod]Public void Test(){ private string temp1; private string temp2; private Mock<XmlCupboardAccess> _xmlCupboardAccess = new Mock<XmlCupboardAccess>(); _xmlCupboardAccess.Setup(x => x.IsDataEntityInXmlCupboard(It.IsAny<string>(), out temp1, out temp2, It.IsAny<string>())).Returns(false); //exception is thrown by this line of code} Invalid setup on a non-virtual (overridable in VB) member: x => x.IsDataEntityInXmlCupboard(It.IsAny<String>(), .temp1, .temp2, It.IsAny<String>())","Why am I getting an Exception with the message ""Invalid setup on a non-virtual (overridable in VB) member...""?"
"What am I getting an Exception with the message ""Invalid setup on a non-virtual (overridable in VB) member...""?"," I have a unit test where I have to mock a non-virtual method that returns a bool type So I have a mock object of XmlCupboardAccess class and I am trying to setup mock for this method in my test case as shown below But this line throws exception Any suggestion how to get around this exception? <code>  public class XmlCupboardAccess{ public bool IsDataEntityInXmlCupboard(string dataId, out string nameInCupboard, out string refTypeInCupboard, string nameTemplate = null) { return IsDataEntityInXmlCupboard(_theDb, dataId, out nameInCupboard, out refTypeInCupboard, nameTemplate); }} [TestMethod]Public void Test(){ private string temp1; private string temp2; private Mock<XmlCupboardAccess> _xmlCupboardAccess = new Mock<XmlCupboardAccess>(); _xmlCupboardAccess.Setup(x => x.IsDataEntityInXmlCupboard(It.IsAny<string>(), out temp1, out temp2, It.IsAny<string>())).Returns(false); //exception is thrown by this line of code} Invalid setup on a non-virtual (overridable in VB) member: x => x.IsDataEntityInXmlCupboard(It.IsAny<String>(), .temp1, .temp2, It.IsAny<String>())","Why am I getting an Exception with the message ""Invalid setup on a non-virtual (overridable in VB) member...""?"
Mxing unit tests and integration in the same assembly," My teammates have now understood(!?) the difference between integration testing and unit testing. Now in our project a test assembly is established for each assembly.Integration tests are currently written without a special framework like SpecFlow or Cucumber. They are plain (and long) NUnit test methods where several classes from different assemblies are tested together.The plan is now to categorize the tests by Attributes (C #) using ""Unit Test"" and ""integration test"", so that NUnit can filter the appropriate tests when necessary. Is it opportune to mix integration tests and unit tests in the same assembly or should they always be separeted in different assemblies? <code> ",Mixing unit tests and integration tests in the same assembly
Mxing unit tests and integration tests in the same assembly," My teammates have now understood(!?) the difference between integration testing and unit testing. Now in our project a test assembly is established for each assembly.Integration tests are currently written without a special framework like SpecFlow or Cucumber. They are plain (and long) NUnit test methods where several classes from different assemblies are tested together.The plan is now to categorize the tests by Attributes (C #) using ""Unit Test"" and ""integration test"", so that NUnit can filter the appropriate tests when necessary. Is it opportune to mix integration tests and unit tests in the same assembly or should they always be separeted in different assemblies? <code> ",Mixing unit tests and integration tests in the same assembly
No FindByAsync() method on IDbSet<T>," Is there a reason that the FindAsync() method is omitted from the IDbSet<T> interface? Find is part of the interface, it seems odd the async version isn't available. I'm needing to cast to DbSet<T> to access it, which is a bit cumbersome: <code>  User user = await ((DbSet<User>)db.Users) .FindAsync(""de7d5d4a-9d0f-48ff-9478-d240cd5eb035"");",No FindAsync() method on IDbSet<T>
the syntax when using open text summarizer API," I'm currently building a system, which will summarize a article from a webpage like Wikipedia.I'm able to extract texts from web pages, and I know that the Open Text Summarizer API can help me to do summarization, but the problem is I don't know how to use it properly.Please anyone who happen to know how to use this library? Can you provide a simple example for me? Currently I'm doing my project in C#. <code> ",How to use Open Text Summarizer API?
"dangerous loops in JavaScript that crush , hangs the browser or Application"," I am creating a live editor in Windows 8.1 App using JavaScript. Almost done with that, but the problem is whenever I run such bad loops or functions then it automatically hangs or exits.I test it with a loop such as:( It just a example-user may write its loop in its own way..) I know that this is a worst condition for any app or browser to handle that kind of loop. So here I want that if user uses such a loop then how I handle it, to produce their output? Or if its not possible to protect my app for that kind of loop, if it is dangerous to my app so I alert the user that: Running this snippet may crash the app!I have an idea to check the code by using regular expressions if code have something like for(i=0;i<=5000;i++) then the above alert will show, how to do a Regex for that?Also able to include C# as back-end . <code>  for(i=0;i<=50000;i++){ for(j=0;j<5000;j++){ $('body').append('hey I am a bug<br>'); }}",How to prevent loops in JavaScript that crash the browser or Apps?
Dangerous loops in JavaScript that crash the browser or application," I am creating a live editor in Windows 8.1 App using JavaScript. Almost done with that, but the problem is whenever I run such bad loops or functions then it automatically hangs or exits.I test it with a loop such as:( It just a example-user may write its loop in its own way..) I know that this is a worst condition for any app or browser to handle that kind of loop. So here I want that if user uses such a loop then how I handle it, to produce their output? Or if its not possible to protect my app for that kind of loop, if it is dangerous to my app so I alert the user that: Running this snippet may crash the app!I have an idea to check the code by using regular expressions if code have something like for(i=0;i<=5000;i++) then the above alert will show, how to do a Regex for that?Also able to include C# as back-end . <code>  for(i=0;i<=50000;i++){ for(j=0;j<5000;j++){ $('body').append('hey I am a bug<br>'); }}",How to prevent loops in JavaScript that crash the browser or Apps?
How to prevent loops in JavaScript that crash the browser?," I am creating a live editor in Windows 8.1 App using JavaScript. Almost done with that, but the problem is whenever I run such bad loops or functions then it automatically hangs or exits.I test it with a loop such as:( It just a example-user may write its loop in its own way..) I know that this is a worst condition for any app or browser to handle that kind of loop. So here I want that if user uses such a loop then how I handle it, to produce their output? Or if its not possible to protect my app for that kind of loop, if it is dangerous to my app so I alert the user that: Running this snippet may crash the app!I have an idea to check the code by using regular expressions if code have something like for(i=0;i<=5000;i++) then the above alert will show, how to do a Regex for that?Also able to include C# as back-end . <code>  for(i=0;i<=50000;i++){ for(j=0;j<5000;j++){ $('body').append('hey I am a bug<br>'); }}",How to prevent loops in JavaScript that crash the browser or Apps?
C#: Abstract classes need to define interfaces?," When an abstract class implements an interface, it is required to also either define or declare the methods (as asked before): What is the design rationale of the c# language to require the definition of abstract methods of abstract classes that implement interfaces? It seems completely redundant for an abstract class to be required to define a method that it does not implement (and to make it even worse, for the class that actually implements the method to have to mark the method as override). I see no reason why an abstract class could not behave like MyInterface2, which inherits from MyInterface but does not need to declare MyInterface's methods.  <code>  public interface MyInterface{ void Method();}public abstract class MyAbstractClass : MyInterface{ public abstract void Method(); // required, even though MyAbstractClass does not implement}public class MyClass : MyAbstractClass{ public override void Method() { }}public interface MyInterface2 : MyInterface{ // no need to declare Method() -- why can't abstract classes do the same for unimplemented methods?}",Why do abstract classes need to define abstract methods from interfaces they implement?
Abstract classes need to define interfaces?," When an abstract class implements an interface, it is required to also either define or declare the methods (as asked before): What is the design rationale of the c# language to require the definition of abstract methods of abstract classes that implement interfaces? It seems completely redundant for an abstract class to be required to define a method that it does not implement (and to make it even worse, for the class that actually implements the method to have to mark the method as override). I see no reason why an abstract class could not behave like MyInterface2, which inherits from MyInterface but does not need to declare MyInterface's methods.  <code>  public interface MyInterface{ void Method();}public abstract class MyAbstractClass : MyInterface{ public abstract void Method(); // required, even though MyAbstractClass does not implement}public class MyClass : MyAbstractClass{ public override void Method() { }}public interface MyInterface2 : MyInterface{ // no need to declare Method() -- why can't abstract classes do the same for unimplemented methods?}",Why do abstract classes need to define abstract methods from interfaces they implement?
Unexpected behavior when sorting strings with letters and dashes in C#?," If I have some list of strings contain all numbers and dashes they will sort ascending like so: 66-0616280-00066-0616280-10066-0616280100066-06162801040 This is as expected.However, if the strings contain letters, the sort is somewhat unexpected. For example, here is the same list of string with trailing A's replacing the 0s, and yes, it is sorted:66-0616280-00A66-0616280100A66-0616280104A66-0616280-10A I would have expected them to sort like so:66-0616280-00A66-0616280-10A66-0616280100A66-0616280104A Why does the sort behave differently on the string when it contains letters vs. when it contains only numbers? Thanks in advance. <code>  s = s.OrderBy(t => t).ToList();",Unexpected behavior when sorting strings with letters and dashes
Unexpected behavior when sorting strings with letters and dashes," If I have some list of strings contain all numbers and dashes they will sort ascending like so: 66-0616280-00066-0616280-10066-0616280100066-06162801040 This is as expected.However, if the strings contain letters, the sort is somewhat unexpected. For example, here is the same list of string with trailing A's replacing the 0s, and yes, it is sorted:66-0616280-00A66-0616280100A66-0616280104A66-0616280-10A I would have expected them to sort like so:66-0616280-00A66-0616280-10A66-0616280100A66-0616280104A Why does the sort behave differently on the string when it contains letters vs. when it contains only numbers? Thanks in advance. <code>  s = s.OrderBy(t => t).ToList();",Unexpected behavior when sorting strings with letters and dashes
De Bruijn algorithm binary digit count 64bits C#," Im using the ""De Bruijn"" Algorithm to discover the number of digits in binary that a big number (up to 64bits) has.For example:1022 has 10 digits in binary.130 has 8 digits in binary.I found that using a table lookup based on De Bruijn give me the power to calculate this x100 times faster than conventional ways (power, square, ...).According to this website, 2^6 has the table to calculate the 64 bits numbers. this would be the table exposed in c# (I dont know if i brought the table from that website correctly)Then, based on the R.. comment here. I should use this to use the table with the input uint64 number. But the c# compiler doesnt allow me to use ""0x022fdd63cc95386dull"" because it overflows 64bits. And i have to use ""0x022fdd63cc95386d"" instead.Using those codes. The problem is that i am not getting the correct result for the input given.For example, doing 1.000.000 calculations of the number:17012389719861204799 (64bits used) This is the result:Using pow2 method i get the result 64 1 Million times in 1380ms.Using DeBruijn method i get the result 40 1 Million times in 32ms. (Dont know why 40)Im trying to understand how ""De Bruijn"" works, and how can i fix this and create a final code for c# to calculate up to 64bits numbers.UDPATE and benchmarks of different solutionsI was looking for the fastest algorithm to get the number of digits in binary that a unsigned given number of 64bits has in c# (known as ulong).For example:1024 has 11 binary digits. (2^10+1) or (log2[1024]+1)9223372036854775808 has 64 binary digits. (2^63+1) or (log2[2^63]+1)The conventional power of 2 and square is extremely slow. and just for 10000 calculations it needs 1500ms to get the answer. (100M calculations needs hours).Here, Niklas B., Jim Mischel, and Spender brought differents methods to make this faster.SIMD and SWAR Techniques //Provided by Spender (Answer here)De_Bruijn Splited 32bits //Provided by Jim Mischel (Answer here)De_Bruijn 64bits version //Provided by Niklas B. (Answer here)De_Bruijn 128bits version //Also provided by Niklas B. (Answer here)Testing this Methods with a CPU Q6600 overclocked to 3Ghz using Windows 7 (64bits) Gives the following results.As you can see, it takes just a few seconds to find correctly 100,000,000 of request given, being De_Bruijn 128bits version the fastest.Thanks a lot to all of you, you help me a lot with this. I hope this helps you too. <code>  static readonly int[] MultiplyDeBruijnBitPosition2 = new int[64]{ 0,1,2,4,8,17,34,5,11,23,47,31,63,62,61,59, 55,46,29,58,53,43,22,44,24,49,35,7,15,30,60,57, 51,38,12,25,50,36,9,18,37,10,21,42,20,41,19,39, 14,28,56,48,33,3,6,13,27,54,45,26,52,40,16,32}; public static int GetLog2_DeBruijn(ulong v){return MultiplyDeBruijnBitPosition2[(ulong)(v * 0x022fdd63cc95386dull) >> 58];}",De Bruijn algorithm binary digit count 64bits C#
De Bruijn algorithm binary digit count 64bits C# [Solved]," Im using the ""De Bruijn"" Algorithm to discover the number of digits in binary that a big number (up to 64bits) has.For example:1022 has 10 digits in binary.130 has 8 digits in binary.I found that using a table lookup based on De Bruijn give me the power to calculate this x100 times faster than conventional ways (power, square, ...).According to this website, 2^6 has the table to calculate the 64 bits numbers. this would be the table exposed in c# (I dont know if i brought the table from that website correctly)Then, based on the R.. comment here. I should use this to use the table with the input uint64 number. But the c# compiler doesnt allow me to use ""0x022fdd63cc95386dull"" because it overflows 64bits. And i have to use ""0x022fdd63cc95386d"" instead.Using those codes. The problem is that i am not getting the correct result for the input given.For example, doing 1.000.000 calculations of the number:17012389719861204799 (64bits used) This is the result:Using pow2 method i get the result 64 1 Million times in 1380ms.Using DeBruijn method i get the result 40 1 Million times in 32ms. (Dont know why 40)Im trying to understand how ""De Bruijn"" works, and how can i fix this and create a final code for c# to calculate up to 64bits numbers.UDPATE and benchmarks of different solutionsI was looking for the fastest algorithm to get the number of digits in binary that a unsigned given number of 64bits has in c# (known as ulong).For example:1024 has 11 binary digits. (2^10+1) or (log2[1024]+1)9223372036854775808 has 64 binary digits. (2^63+1) or (log2[2^63]+1)The conventional power of 2 and square is extremely slow. and just for 10000 calculations it needs 1500ms to get the answer. (100M calculations needs hours).Here, Niklas B., Jim Mischel, and Spender brought differents methods to make this faster.SIMD and SWAR Techniques //Provided by Spender (Answer here)De_Bruijn Splited 32bits //Provided by Jim Mischel (Answer here)De_Bruijn 64bits version //Provided by Niklas B. (Answer here)De_Bruijn 128bits version //Also provided by Niklas B. (Answer here)Testing this Methods with a CPU Q6600 overclocked to 3Ghz using Windows 7 (64bits) Gives the following results.As you can see, it takes just a few seconds to find correctly 100,000,000 of request given, being De_Bruijn 128bits version the fastest.Thanks a lot to all of you, you help me a lot with this. I hope this helps you too. <code>  static readonly int[] MultiplyDeBruijnBitPosition2 = new int[64]{ 0,1,2,4,8,17,34,5,11,23,47,31,63,62,61,59, 55,46,29,58,53,43,22,44,24,49,35,7,15,30,60,57, 51,38,12,25,50,36,9,18,37,10,21,42,20,41,19,39, 14,28,56,48,33,3,6,13,27,54,45,26,52,40,16,32}; public static int GetLog2_DeBruijn(ulong v){return MultiplyDeBruijnBitPosition2[(ulong)(v * 0x022fdd63cc95386dull) >> 58];}",De Bruijn algorithm binary digit count 64bits C#
JSon.net And ActionResult," Im building a JObject myself and want to return it as ActionResult. I dont want to create and then serialize a data objectFor example <code>  public ActionResult Test(string id){ var res = new JObject(); JArray array = new JArray(); array.Add(""Manual text""); array.Add(new DateTime(2000, 5, 23)); res[""id""] = 1; res[""result""] = array; return Json(res); //???????}",Json.Net And ActionResult
How to pass a JNI C# class into Java?," I'm trying to call a Java method from C#, it's called like this from java: The first two parameters are ok, but how do I pass the EgamePayListner through in C#? Simply creating a C# class with the same functions won't work...Here's what I'm doing currently: Obviously that's wrong, how can I handle this situation so that I can get notified back in C# land when those functions are fired? <code>  EgamePay.pay(thisActivity, payAlias, new EgamePayListener() { @Override public void paySuccess(String alias) { } @Override public void payFailed(String alias, int errorInt) { } @Override public void payCancel(String alias) { } }); using (AndroidJavaClass jc = new AndroidJavaClass(""cn.egame.terminal.smspay.EgamePay"")) { System.IntPtr cls_Activity = AndroidJNI.FindClass(""com/unity3d/player/UnityPlayer""); System.IntPtr fid_Activity = AndroidJNI.GetStaticFieldID(cls_Activity, ""currentActivity"", ""Landroid/app/Activity;""); object[] p = { fid_Activity, ""payAlias"", new EgamePayListener() }; jc.CallStatic(""pay"", p); }.. class EgamePayListener { public void paySucess(string alias) { } public void payFailed(string alians, int errorInt) { } public void payCancel(string alias) { } }",How to pass a JNI C# class into Java or handle this situation?
How to get date from day of year in csharp?," How can I get date from day of year in C#?I have this code : I need to get the value 22.2.2014. But this doesn't work, what should I do? Thanks in advance. <code>  int a = 53; // This is the day of year value, that I got previouslystring b = Convert.ToDateTime(a).ToString(); // Trying to get the date",How to get date from day of year
How to get date from day of year in C#?," How can I get date from day of year in C#?I have this code : I need to get the value 22.2.2014. But this doesn't work, what should I do? Thanks in advance. <code>  int a = 53; // This is the day of year value, that I got previouslystring b = Convert.ToDateTime(a).ToString(); // Trying to get the date",How to get date from day of year
C#: Converting Brush to Color," I have a Brush object that I want to lighten using the Windows Forms ControlPaint.Light() method.I want to convert a System.Windows.Media.Brush object to System.Drawing.Color so that I can change any XAML button background color to its ""light color"" on button click, because System.Windows.Forms.ControlPaint.Light() takes only color as argument.Since my Brush object is not a SolidColorBrush and so does not have a Color property, is there some alternative to achieve this? <code> ",Call Winforms ControlPaint.Light() in WPF project
Converting Brush to Color," I have a Brush object that I want to lighten using the Windows Forms ControlPaint.Light() method.I want to convert a System.Windows.Media.Brush object to System.Drawing.Color so that I can change any XAML button background color to its ""light color"" on button click, because System.Windows.Forms.ControlPaint.Light() takes only color as argument.Since my Brush object is not a SolidColorBrush and so does not have a Color property, is there some alternative to achieve this? <code> ",Call Winforms ControlPaint.Light() in WPF project
Paralell execution of async methods," Using the async/await model, I have a method which makes 3 different calls to a web service and then returns the union of the results. Using typical await, these 3 calls will execute synchronously wrt each other. How would I go about letting them execute concurrently and join the results as they complete? <code>  var result1 = await myService.GetData(source1);var result2 = await myService.GetData(source2);var result3 = await myService.GetData(source3);allResults = Union(result1, result2, result3);",Concurrent execution of async methods
Parallel execution of async methods," Using the async/await model, I have a method which makes 3 different calls to a web service and then returns the union of the results. Using typical await, these 3 calls will execute synchronously wrt each other. How would I go about letting them execute concurrently and join the results as they complete? <code>  var result1 = await myService.GetData(source1);var result2 = await myService.GetData(source2);var result3 = await myService.GetData(source3);allResults = Union(result1, result2, result3);",Concurrent execution of async methods
C# get total number of non-blank lines from text file?," I am using... ...to find the total number of lines in the file. How can I do this, but ignore all blank lines? <code>  File.ReadLines(@""file.txt"").Count();",Get total number of non-blank lines from text file?
get total number of non-blank lines from text file?," I am using... ...to find the total number of lines in the file. How can I do this, but ignore all blank lines? <code>  File.ReadLines(@""file.txt"").Count();",Get total number of non-blank lines from text file?
Resharper does not navigate to external sources despide pdb files present," My solution uses classes from .dlls generated by my other solutions.dll where generated in debug mode on the same machine, pdb files are presentsteeping into those external sources during debugging works, so I am assuming pdb files are correctpdp files are in the same directory as .dllsIn R# settings I have ""Navigation to Sources"" selected and ""Use debug information for navigation checked""VS2012 Pro and R# 8.02 FullIt drives me crazy, how come such crucial thing, that is provided out-of-the-box in every common free IDE for Java, is impossible to get to work in C# using tools for hundreds of bucks... <code> ",Resharper does not navigate to external sources despite pdb files present
How to wrap and enum in C," I need to create a wrapper between C++ and C#. I have a function very similar to this: The enum is declared like this: How do I wrap that ATTRIBUTE_TYPE enum? <code>  virtual SOMEINTERFACE* MethodName(ATTRIBUTE_TYPE attribType = ATTRIBUTE_TYPE::ATTRIB_STANDARD) = 0; enum class ATTRIBUTE_TYPE { ATTRIB_STANDARD, ATTRIB_LENGTH };",How to marshal a C++ enum in C#
Confused as to why this C# code does not compile," Let's take the following extension method: I'm curious as to why this code compiles and runs: Within In, values is an Object[], as if the List<int> gets converted on the fly to an array. To me, it seems that params T[] does not match IEnumerable<int>, which is why I'm surprised this even runs.Now this code: Does not run and generates the compiler error: Error 2 Argument 2: cannot convert from 'System.Collections.Generic.IEnumerable' to 'int[]'This is what I'd expect from the first one actually. Can someone explain what's going on here? Thanks! <code>  static class Extensions{ public static bool In<T>(this T t, params T[] values) { return false; }} var x = new Object();IEnumerable<int> p = new List<int> { 1, 2, 3 };var t2 = x.In(p); var x = 5;IEnumerable<int> p = new List<int> { 1, 2, 3 };var t2 = x.In(p);","Confused as to why this C# code compiles, while similar code does not"
Linq change the order of List items," i'm getting a list of items with following LINQ expression, i'm getting the list as, ordered by Codenow, my expected result is as below, i know that i can get the expected result either by modifying the sql table containing these values or by adding an extra numeric column to the table specifying the sequence order.is it possible to get the results with the help of LINQ without modifying the table? <code>  var list = (from p in listData orderby p.Code ascending select new KeyValuePair<int, string>(p.Code, p.DESC) ).Distinct<KeyValuePair<int, string>>().ToList<KeyValuePair<int, string>>(); 2,MEDICAL5,RETAIL6,OTHER7,GOVT 2,MEDICAL5,RETAIL7,GOVT6,OTHER",Change the order of List items conditionally with LINQ
Dual batteries status vb.net / c#, or (I would prefer a vb answer as that is what the application is written in but can convert so c# is fine if you dont know vb)I understand that the above will give me the battery percentage remaining - BUT I have a tablet that is 'hot swappable' (it has a main battery then a small 5 minute battery that runs the tablet while you swap batteries on it) - how would I find the status of the second battery?I am looking for something like SystemInformation.PowerStatus(0) but I have NO idea what I am actually trying to find and I must be having a Google block as I cannot find anything. <code>  Dim power As PowerStatus = SystemInformation.PowerStatus Dim percent As Single = power.BatteryLifePercent PowerStatus power = SystemInformation.PowerStatus;float percent = power.BatteryLifePercent;,How to retrieve dual batteries status?
Dual batteries status, or (I would prefer a vb answer as that is what the application is written in but can convert so c# is fine if you dont know vb)I understand that the above will give me the battery percentage remaining - BUT I have a tablet that is 'hot swappable' (it has a main battery then a small 5 minute battery that runs the tablet while you swap batteries on it) - how would I find the status of the second battery?I am looking for something like SystemInformation.PowerStatus(0) but I have NO idea what I am actually trying to find and I must be having a Google block as I cannot find anything. <code>  Dim power As PowerStatus = SystemInformation.PowerStatus Dim percent As Single = power.BatteryLifePercent PowerStatus power = SystemInformation.PowerStatus;float percent = power.BatteryLifePercent;,How to retrieve dual batteries status?
How can one achieve the effect of overriding a base member with more specific type in C#?," I'm trying to figure out a way for a derived class to be made up of members that have more specific types than those specified in the abstract base class. Here is some code that works which does what I want, but does not follow the stipulations I mention. As a result, the client code (in Main) must use a cast on the ""BarProperty"" which is what I'm trying to avoid, I guess. What I'd like instead would be to do something like the code below, which of course doesn't compile because ConcreteFoo is trying to override BarProperty using a more specific type than AbstractFoo declared. You may be thinking ""rethink your design"" but it's tricky because I'm trying to incorporate some third party code (without changing that code) which doesn't contain some much needed abstract/interface classes to give interchangeable facades to two very similar halves of the code base. As a result, I've basically had to write my entire program twice, with only minor changes in what types are being used. I need some way to handle either of two very similar types which unfortunately don't have an interface to demonstrate their similarity to the compiler. <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;namespace Stackoverflow{ class Program { static void Main(string[] args) { ConcreteFoo myFoo = new ConcreteFoo(); myFoo.BarProperty = new ConcreteBar(); ((ConcreteBar)myFoo.BarProperty).ConcreteBarPrint(); Console.ReadKey(); } } abstract class AbstractFoo { protected void FooMethod() { Console.WriteLine(""The Foo method!""); } public abstract AbstractBar BarProperty { get; set; } } class ConcreteFoo : AbstractFoo { private ConcreteBar _concreteBar; public override AbstractBar BarProperty { get { return _concreteBar; } set { _concreteBar = (ConcreteBar)value; } } } abstract class AbstractBar { protected void BarMethod() { Console.WriteLine(""The Bar method!""); } } class ConcreteBar : AbstractBar { public List<int> concreteBarIntList; public ConcreteBar() { concreteBarIntList = new List<int>(); concreteBarIntList.Add(1); concreteBarIntList.Add(2); concreteBarIntList.Add(3); } public void ConcreteBarPrint() { foreach (int item in concreteBarIntList) { Console.WriteLine(item); } } }} using System;using System.Collections.Generic;using System.Linq;using System.Text;namespace Stackoverflow{ class Program { static void Main(string[] args) { ConcreteFoo myFoo = new ConcreteFoo(); myFoo.BarProperty = new ConcreteBar(); myFoo.BarProperty.ConcreteBarPrint(); Console.ReadKey(); } } abstract class AbstractFoo { protected void FooMethod() { Console.WriteLine(""The Foo method!""); } public abstract AbstractBar BarProperty { get; set; } } class ConcreteFoo : AbstractFoo { private ConcreteBar _concreteBar; public override ConcreteBar BarProperty { get { return _concreteBar; } set { _concreteBar = (ConcreteBar)value; } } } abstract class AbstractBar { protected void BarMethod() { Console.WriteLine(""The Bar method!""); } } class ConcreteBar : AbstractBar { public List<int> concreteBarIntList; public ConcreteBar() { concreteBarIntList = new List<int>(); concreteBarIntList.Add(1); concreteBarIntList.Add(2); concreteBarIntList.Add(3); } public void ConcreteBarPrint() { foreach (int item in concreteBarIntList) { Console.WriteLine(item); } } }}",How can one achieve the effect of overriding a base member with more specific type?
C# - CSV Text file parser with TextFieldParser - MalformedLineException," I am working on a CSV parser using C# TextFieldParser class.My CSV data is deliminated by , and the string is enclosed by a "" character.However, sometimes the data row cell can also have a "" which appears to be making the parser throw an exception.This is my C# code so far: This is the content of my test.csv file: What is the best way to deal with "" in my row cell data?UPDATEBased on Tim Schmelter's answer, I have modified my code to the following: Which appears to produce the following (correctly):Is this is the best way to deal with string enclosed by quotes, having quotes? <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.IO;using Microsoft.VisualBasic.FileIO;namespace CSV_Parser{ class Program { static void Main(string[] args) { // Init string CSV_File = ""test.csv""; // Proceed If File Is Found if (File.Exists(CSV_File)) { // Test Parse_CSV(CSV_File); } // Finished Console.WriteLine(""Press any to exit ...""); Console.ReadKey(); } static void Parse_CSV(String Filename) { using (TextFieldParser parser = new TextFieldParser(Filename)) { parser.TextFieldType = FieldType.Delimited; parser.SetDelimiters("",""); parser.TrimWhiteSpace = true; while (!parser.EndOfData) { string[] fieldRow = parser.ReadFields(); foreach (string fieldRowCell in fieldRow) { // todo } } } } }} "" dummy test""s data"", b , c d,e,fgh,ij static void Parse_CSV(String Filename){ using (TextFieldParser parser = new TextFieldParser(Filename)) { parser.TextFieldType = FieldType.Delimited; parser.SetDelimiters("",""); parser.HasFieldsEnclosedInQuotes = false; parser.TrimWhiteSpace = true; while (parser.PeekChars(1) != null) { var cleanFieldRowCells = parser.ReadFields().Select( f => f.Trim(new[] { ' ', '""' })); Console.WriteLine(String.Join("" | "", cleanFieldRowCells)); } }}",CSV Text file parser with TextFieldParser - MalformedLineException
C# serialize two type list in a single json string," I have two types of classes: and then I have two list items. I can serialize a single list with: or I want to serialize these two lists in a single json string.How can do this? <code>  public class HolidayClass{ public int ID { get; set; } public string Name { get; set; } public DateTime StartDate { get; set; } public DateTime EndDate { get; set; } public bool Active { get; set; } public HolidayClass(int ID, string Name, DateTime StartDate, DateTime EndDate, bool Active) { this.ID = ID; this.Name = Name; this.StartDate = StartDate; this.EndDate = EndDate; this.Active = Active; } public HolidayClass() { }}public class ProjectClass{ public int ID { get; set; } public string NetsisID { get; set; } public string Name { get; set; } public string Address { get; set; } public bool Active { get; set; } public ProjectClass(int ID, string NetsisID, string Name, string Address, bool Active) { this.ID = ID; this.NetsisID = NetsisID; this.Name = Name; this.Address = Address; this.Active = Active; } public ProjectClass() { }} List<ProjectClass> pc;List<HolidayClass> hc; myJson = new JavaScriptSerializer().Serialize(pc).ToString(); myJson = new JavaScriptSerializer().Serialize(hc).ToString();",serialize two different instances in a list to a single json string
Calling asynchronous methods in Xunit asserts," I have some test code asserting duplicate Users cannot be created through my UserRepository.User.cs: UserRepository.cs: UserRepositoryTests.cs: When I run this unit test, Xunit.Sdk.ThrowsException is thrown (i.e. my InvalidOperationException was not thrown): Assert.Throws() Failure Expected: System.InvalidOperationException Actual: (No exception was thrown)From the debugger, GetDuplicateAsync() was evaluated but when the LINQ query was executed, the result was never returned and thus no exception was thrown. Can anyone help? <code>  public class User{ public int Id { get; set; } public string AccountAlias { get; set; } public string DisplayName { get; set; } public string Email { get; set; } public bool IsActive { get; set; }} public class UserRepository{ public virtual async Task<User> CreateAsync(User entity) { if (entity == null) { throw new ArgumentNullException(""entity""); } if (await GetDuplicateAsync(entity) != null) { throw new InvalidOperationException(""This user already exists""); } return Create(entity); } public async Task<User> GetDuplicateAsync(User user) { if (user == null) { throw new ArgumentNullException(""user""); } return await (from u in Users where u.AccountAlias == user.AccountAlias && u.Id != user.Id && u.IsActive select u).FirstOrDefaultAsync(); }} public sealed class UserRepositoryTests : IDisposable{ public UserRepositoryTests() { UserRepository = new UserRepository(new FooEntities()); // DbContext // from EF } private UserRepository UserRepository { get; set; } [Fact] public void DuplicateUserCannotBeCreated() { var testUser = new User // This test user already exists in database { Id = 0, AccountAlias = ""domain\\foo"", DisplayName = ""Foo"", Email = ""foo@bar.com"", IsActive = true }; Assert.Throws<InvalidOperationException>(async () => await UserRepository.CreateAsync(testUser)); } public void Dispose() { if (UserRepository != null) { UserRepository.Dispose(); } }}",Async lambda expressions in Xunit Assert.Throws
How to write a code to design Windwos 8 style Progress Ring?," I want to show progress in my Desktop apps like Windows 8 ProgressRing. This type of progress is shown at times of installation or when Windows Start, but this control can be used in many applications as its very clean and modern, but I don't know how to achieve that. The progress ring image is here. Please see the image:May I know how do I code for it may be in XAML or in Code? I have seen that in WPF ProgressRing control is not present, so I have to go to some custom control. Idea link or suggestions please how can I proceed.  <code> ",How to create a Progress Ring like Windows 8 Style in WPF?
How to write a code to design Windows 8 style Progress Ring?," I want to show progress in my Desktop apps like Windows 8 ProgressRing. This type of progress is shown at times of installation or when Windows Start, but this control can be used in many applications as its very clean and modern, but I don't know how to achieve that. The progress ring image is here. Please see the image:May I know how do I code for it may be in XAML or in Code? I have seen that in WPF ProgressRing control is not present, so I have to go to some custom control. Idea link or suggestions please how can I proceed.  <code> ",How to create a Progress Ring like Windows 8 Style in WPF?
Pass parameters to PrivateObject method in C#," I am trying to unit test private method.I saw example below on this question My private method has 2 ref params.How to pass them? <code>  Class target = new Class();PrivateObject obj = new PrivateObject(target);var retVal = obj.Invoke(""PrivateMethod"");Assert.AreEqual(retVal);",Pass parameters to PrivateObject method
C# using statement loop," Say I'm having a Windows Form application which connected to n databases, with n connections opened simultaneously.What I'm looking for is to do a transaction with all of those databases in one go.For example if I were to have 2 database connections : Writing all that is fine at first, but things get kind of redundant when I wanted to query here and there, and not to mention the possibility to adding a new connection.What I wanted is to loop all of the registered session and wrap it up in a service, probably something like this : If I were to use using in the foreach loop, it would mean that if connection A successful but connection B wasn't, then only connection B would be rolled back. <code>  using (ITransaction tx1 = session1.OpenTransaction()){ using (ITransaction tx2 = session2.OpenTransaction()) { // Do the query thingy here }} class TransactionManager{ private ISession[] _sessions; public TransactionManager(string[] connectionStrings) { // Initialize the sessions here } public function DoTransaction(string query) { foreach (ISession session in _sessions) { // What to do here? Using? Try-catch? } }}",C# controlling a transaction across multiple databases
Ticked method names in C#," In the F# language it is possible to name functions using ``Ticked function name notation``. It is extremely convenient for unit tests naming.Is there any possibility to do this in the C# language? We can always use Underscored_method_names or PascalMethodNames, but it isn't as easy to read. <code> ",Can I use F#'s Ticked Function name notation for C# Methods?
Generic method where T inherits from Interface<T>," I'm trying to create a generic data retrieval process. What I have currently works, but there is a part of it that doesn't seem right and I'm hoping there is a better way to accomplish it.So the idea is that I have classes for each table in the database, here is an example of a class: You'll notice that the class implements an interface of its own type. The interface simply defines a method called ToObject, which is used to convert a datatable to a class of that particular type: Now, here is the method that I am using to execute a query: So the main question is:How can the generic method know that T should implement IFacetsObject<T>? That way I don't have to pass IFacetsObject<T> as a parameter. Ideally, I could change the return line to be something like this: And call it like this: Instead of like this: I'll admit that I'm not terribly familiar with generics yet so there may be something within the implementation that isn't right. <code>  public class CMCGRGRGROUP : IFacetsObject<CMCGRGRGROUP>{ public int GRGR_CK { get; set; } public string GRGR_NAME { get; set; } public string GRGR_ADDR1 { get; set; } public IEnumerable<CMCGRGRGROUP> ToObject(DataTable table) { return table.AsEnumerable().Select(row => { return new CMCGRGRGROUP { GRGR_CK = Convert.ToInt32(row[""GRGR_CK""]), GRGR_NAME = row[""GRGR_NAME""].ToString(), GRGR_ADDR1 = row[""GRGR_ADDR1""].ToString() }; }); }} public interface IFacetsObject<T>{ IEnumerable<T> ToObject(DataTable obj);} public IEnumerable<T> ExecuteQuery<T>(string sql, IFacetsObject<T> obj) where T : new(){ using (var conn = new AseConnection(_conn)) { conn.Open(); var cmd = new AseCommand(sql, conn); var dt = new DataTable(); var da = new AseDataAdapter(sql, conn); da.Fill(dt); return obj.ToObject(dt); //this is the interface method }} return T.ToObject(dt); var result = ExecuteQuery<CMCGRGRGROUP>(sql).Take(5); var result = ExecuteQuery<CMCGRGRGROUP>(sql, new CMCGRGRGROUP()).Take(5);",Generic method where T implements Interface<T>
How works under the hood enum.toString() in c#, I am an iOS developer and I regret that in Objective-C there is no the amazing method toString for enum like in C#So I am very curious to know how the toString method works for enum in C#.Maybe with your answers I will understand why Objective-C has not this method implemented.Thanks <code> ,How does enum.toString() work under the hood?
How does enum.toString() in c# work under the hood?, I am an iOS developer and I regret that in Objective-C there is no the amazing method toString for enum like in C#So I am very curious to know how the toString method works for enum in C#.Maybe with your answers I will understand why Objective-C has not this method implemented.Thanks <code> ,How does enum.toString() work under the hood?
How to Set Document Orientation (for All Pages) in pdfsharp / MigraDoc Library?," I'm using MigraDoc to programatically generate a PDF file with text, images and tables.I need to set Document Orientation (for all pages) in the document object to Landscape.So I tried the following. But I get the following debug assertion error. If I click Ignore, it goes through and the Orientation is indeed Landscape.However, I want to make sure I am doing this the right way.So the question is, how do I set the document orientation for all pages in a Document using the MigraDoc library?Here's the rest of the code (so it helps you get the context) Many thanks!-ShivaUPDATE:SOLUTION: Here's the working code, based on Thomas' answer below (for the benefit of others who maybe looking for this solution). <code>  document.DefaultPageSetup.Orientation = Orientation.Landscape; ---------------------------Assertion Failed: Abort=Quit, Retry=Debug, Ignore=Continue---------------------------DefaultPageSetup must not be modified using System.Runtime.Remoting.Messaging;using MigraDoc.DocumentObjectModel;namespace MyNamespace.PdfReports{ class Documents { public static Document CreateDocument() { // Create a new MigraDoc document Document document = new Document(); document.Info.Title = ""The Title""; document.Info.Subject = ""The Subject""; document.Info.Author = ""Shiva""; document.DefaultPageSetup.Orientation = Orientation.Landscape; // Create a new MigraDoc documentDocument document = new Document();//...//......PageSetup pageSetup = document.DefaultPageSetup.Clone();// set orientationpageSetup.Orientation = Orientation.Landscape;// ... set other page setting you want here...",How to Set Document Orientation (for All Pages) in MigraDoc Library?
"In Entity Frameowk 6.1, how can I define a clustered index?"," Entity Framework 6.1 (code-first) has added the possibility of adding indexes via the IndexAttribute. The attribute takes a parameter for specifying whether the index should be clustered or non-clustered.At the same time, AFAIK, Entity Framework requires every entity to have a primary key (annotated with the KeyAttribute), and that primary key is always created as a clustered key.Therefore, as soon as I apply the IndexAttribute with IsClustered = true, I get an error because, due to the key, there already is a clustered index.So, how can I create a clustered index that is not the primary key using the IndexAttribute? Is the IsClustered property of the IndexAttribute usable at all? (For a little more context: I'm mapping a table that is only used for reading via LINQ queries. I do not need to actually insert, update, or delete entities from that table. Therefore, I don't need a primary key at all. Ideally, I'd like a table without a primary key, but with a non-unique, clustered index optimized for reading.)Edit (2014-04-11): See also https://entityframework.codeplex.com/workitem/2212. <code> ","In Entity Framework 6.1 (not Core), how can I use the IndexAttribute to define a clustered index?"
"In Entity Frameowk 6.1, how can I use the IndexAttribute to define a clustered index?"," Entity Framework 6.1 (code-first) has added the possibility of adding indexes via the IndexAttribute. The attribute takes a parameter for specifying whether the index should be clustered or non-clustered.At the same time, AFAIK, Entity Framework requires every entity to have a primary key (annotated with the KeyAttribute), and that primary key is always created as a clustered key.Therefore, as soon as I apply the IndexAttribute with IsClustered = true, I get an error because, due to the key, there already is a clustered index.So, how can I create a clustered index that is not the primary key using the IndexAttribute? Is the IsClustered property of the IndexAttribute usable at all? (For a little more context: I'm mapping a table that is only used for reading via LINQ queries. I do not need to actually insert, update, or delete entities from that table. Therefore, I don't need a primary key at all. Ideally, I'd like a table without a primary key, but with a non-unique, clustered index optimized for reading.)Edit (2014-04-11): See also https://entityframework.codeplex.com/workitem/2212. <code> ","In Entity Framework 6.1 (not Core), how can I use the IndexAttribute to define a clustered index?"
"In Entity Framework 6.1, how can I use the IndexAttribute to define a clustered index?"," Entity Framework 6.1 (code-first) has added the possibility of adding indexes via the IndexAttribute. The attribute takes a parameter for specifying whether the index should be clustered or non-clustered.At the same time, AFAIK, Entity Framework requires every entity to have a primary key (annotated with the KeyAttribute), and that primary key is always created as a clustered key.Therefore, as soon as I apply the IndexAttribute with IsClustered = true, I get an error because, due to the key, there already is a clustered index.So, how can I create a clustered index that is not the primary key using the IndexAttribute? Is the IsClustered property of the IndexAttribute usable at all? (For a little more context: I'm mapping a table that is only used for reading via LINQ queries. I do not need to actually insert, update, or delete entities from that table. Therefore, I don't need a primary key at all. Ideally, I'd like a table without a primary key, but with a non-unique, clustered index optimized for reading.)Edit (2014-04-11): See also https://entityframework.codeplex.com/workitem/2212. <code> ","In Entity Framework 6.1 (not Core), how can I use the IndexAttribute to define a clustered index?"
How can C# List<T>.Item Property be O(1)? Typo?, I'm implementing a priority queue and want to iterate through the list to insert at the right spot. In the documentation it states that C# List<T>.Item Property is O(1):List<T>.Item Propertye.g. How is this possible since add also is O(1)? It's like eating the cookie and still have it. Normal lists in my head have O(n) for accessing an element. <code>  int retrivedValue = myIntList[5];,How can List<T>.Item Property be O(1)? Typo?
Create XSD from XML C#," I am using this piece of code from MSDN to create an XSD from an XML I want to output the .xsd based on my xml file. When I generate the .xsd file, the only content I get inside it is: System.Xml.Schema.XmlSchemaWhen I generate the XSD using Visual Studio option to create Schema, it comes out properly. However, I have over 150 xml docs that I need to create XSD for hence need a programmatic option. Can anyone help? <code>  XmlReader reader = XmlReader.Create(""contosoBooks.xml"");XmlSchemaSet schemaSet = new XmlSchemaSet();XmlSchemaInference schema = new XmlSchemaInference();schemaSet = schema.InferSchema(reader);foreach (XmlSchema s in schemaSet.Schemas()){ textbox.text = s.ToString();}",Create XSD from XML in Code
c# how to read data table from sql stored procedure," I have this SQL Server stored procedure: When I execute it in SQL Server Management Studio, I got this result:My questionI need to read the data from the table.My problemThis data is not in output parameters. That is why I couldn't read them.What I have tried Is this correct? If not what should I do please?I couldn't test my code on a real database because I don't have the database yet. <code>  SET NOCOUNT ON EXECUTE sp_configure 'Show Advanced Options', 1 RECONFIGURE EXECUTE sp_configure 'Ad Hoc Distributed Queries', 1 RECONFIGURE SELECT UserName, LoggedState, InteractionId, InteractionType --<-- The columns required. FROM OPENROWSET('SQLNCLI' ,'Server=USER-PC\SQLEXPRESS;Trusted_Connection=yes;database=XXX' ,'EXECUTE dbo.[XXX]') string vmpgraph = ConfigurationManager.ConnectionStrings[""connectionstring""].ConnectionString;SqlConnection Graphsqlcon = new SqlConnection(vmpgraph);SqlCommand GraphCmd = new SqlCommand(""storedProcedureName"", Graphsqlcon);SqlParameter tdate = new SqlParameter();GraphCmd.CommandType = CommandType.StoredProcedure; ;SqlDataAdapter DAGraph = new SqlDataAdapter(GraphCmd);DataSet DSGraph = new DataSet();DSGraph.Clear();DAGraph.Fill(DSGraph);DataTable DTgraph = new DataTable();DTgraph = DSGraph.Tables[0];",How to read data table from SQL Server stored procedure
how to read data table from sql stored procedure," I have this SQL Server stored procedure: When I execute it in SQL Server Management Studio, I got this result:My questionI need to read the data from the table.My problemThis data is not in output parameters. That is why I couldn't read them.What I have tried Is this correct? If not what should I do please?I couldn't test my code on a real database because I don't have the database yet. <code>  SET NOCOUNT ON EXECUTE sp_configure 'Show Advanced Options', 1 RECONFIGURE EXECUTE sp_configure 'Ad Hoc Distributed Queries', 1 RECONFIGURE SELECT UserName, LoggedState, InteractionId, InteractionType --<-- The columns required. FROM OPENROWSET('SQLNCLI' ,'Server=USER-PC\SQLEXPRESS;Trusted_Connection=yes;database=XXX' ,'EXECUTE dbo.[XXX]') string vmpgraph = ConfigurationManager.ConnectionStrings[""connectionstring""].ConnectionString;SqlConnection Graphsqlcon = new SqlConnection(vmpgraph);SqlCommand GraphCmd = new SqlCommand(""storedProcedureName"", Graphsqlcon);SqlParameter tdate = new SqlParameter();GraphCmd.CommandType = CommandType.StoredProcedure; ;SqlDataAdapter DAGraph = new SqlDataAdapter(GraphCmd);DataSet DSGraph = new DataSet();DSGraph.Clear();DAGraph.Fill(DSGraph);DataTable DTgraph = new DataTable();DTgraph = DSGraph.Tables[0];",How to read data table from SQL Server stored procedure
"Basic C# ""Hello World!"" Program, Malwarebytes gives Trojan warning"," Basically, I just ran a scan of my computer with Malwarebytes (updated the definitions before running), and it said my ""helloworld"" program written in C# has a trojan.I know for a fact this is a false positive, as I only wrote the program 2-3 days ago and followed a small tutorial website to make the program that I trust. I am new to C#, but I can't see anything that would give a trojan warning at all.The program flags the executable, but not the source file. This is the code, written in Notepad++, and it is run from the command-line (Cygwin, actually). Why does it flags this? Is it something that, as a budding C# programmer, I should know about? <code>  using System;namespace HelloWorldApplication{ class HelloWorld { static void Main(string[] args) { Console.WriteLine(""\n\tHello World!""); Console.WriteLine(""This is my first C# program.\nI'm so proud of myself!""); Console.WriteLine(""\tTeehee!""); } }}","Malwarebytes gives trojan warning for basic C# ""Hello World!"" program"
"Malwarebytes gives Trojan warning for basic C# ""Hello World!"" Program"," Basically, I just ran a scan of my computer with Malwarebytes (updated the definitions before running), and it said my ""helloworld"" program written in C# has a trojan.I know for a fact this is a false positive, as I only wrote the program 2-3 days ago and followed a small tutorial website to make the program that I trust. I am new to C#, but I can't see anything that would give a trojan warning at all.The program flags the executable, but not the source file. This is the code, written in Notepad++, and it is run from the command-line (Cygwin, actually). Why does it flags this? Is it something that, as a budding C# programmer, I should know about? <code>  using System;namespace HelloWorldApplication{ class HelloWorld { static void Main(string[] args) { Console.WriteLine(""\n\tHello World!""); Console.WriteLine(""This is my first C# program.\nI'm so proud of myself!""); Console.WriteLine(""\tTeehee!""); } }}","Malwarebytes gives trojan warning for basic C# ""Hello World!"" program"
verifying ios in app purchase receipt with C#," I am verifying my ios in app purchase receipt on my server using C# web serviceI got receipt as string by doing below in Xcode: and I am sending that string(receipt) to my C# web service as parameter.Here is my web service method: It always return {""status"":21002}.I have been searching for two days , but still can't find out the solution. Can someone help me, what am i wrong ? **I am testing on sandbox that is why i use sandbox URL. I can verify the transaction receipt within my app. <code>  - (void) completeTransaction: (SKPaymentTransaction *)transaction{ NSString* receiptString = [[NSString alloc] initWithString:transaction.payment.productIdentifier]; NSLog(@""%@"",receiptString); NSURL *receiptURL = [[NSBundle mainBundle] appStoreReceiptURL]; NSData *receipt = [NSData dataWithContentsOfURL:receiptURL]; NSString *jsonObjectString = [receipt base64EncodedStringWithOptions:0];} [WebMethod(Description = ""Purchase Item Verify"")]public string PurchaseItem(string receiptData) { string returnmessage = """"; try { var json = ""{ 'receipt-data': '"" + receiptData + ""'}""; ASCIIEncoding ascii = new ASCIIEncoding(); byte[] postBytes = Encoding.UTF8.GetBytes(json); HttpWebRequest request; request = WebRequest.Create(""https://sandbox.itunes.apple.com/verifyReceipt"") as HttpWebRequest; request.Method = ""POST""; request.ContentType = ""application/json""; request.ContentLength = postBytes.Length; Stream postStream = request.GetRequestStream(); postStream.Write(postBytes, 0, postBytes.Length); postStream.Close(); var sendresponse = (HttpWebResponse)request.GetResponse(); string sendresponsetext = """"; using (var streamReader = new StreamReader(sendresponse.GetResponseStream())) { sendresponsetext = streamReader.ReadToEnd(); } returnmessage = sendresponsetext; } catch (Exception ex) { ex.Message.ToString(); } return returnmessage;}",verifying iOS in app purchase receipt with C#
Make a navigation property with EF 6.1 code first in a sql view," Let's make a case to explain my problem. MyTable1+id+myTable2IdMyTable2+idMyView1+id+myTable2IdMyView1 exists in the case, from data from the MyTable1. Now i want to create a Navigation property from my EF6.1 Code first approach in my View to MyTable2. I know that it was possible from the database first approach, but is it also possible from the code-first approach and how?EDIT:I search some on internet, but due many meanings of the word View, it's very hard to find information on it. Also with the approaches in codes that i tried, i always get an error that the migration can't be completed. Because the Migration tries to add an foreign key to the view, which isn't possible.EDIT2: To elaborate a bit more on my explanation. I want to be able to approach it in code the following way: EDIT3:I will eleborate a bit more, to see if i can get my problem better explained. When i added the following to my view Entity: EF will automaticly generate the following migration: Which on running update-database gives the following error :""Cannot create index on view 'MyView1' because the view is not schema bound""EDIT4: With help of the comment that the migration aren't of stone.. and are changeable i made it. I used the following fluentAPI: And changing my tables to this: (The FK to the MyTable2 and removed from the view)MyTable1+idMyTable2+id+myTable1MyView1+idWhich in the end is better because this way i have less Null values in my model. <code>  Guid table2Id = context.MyView1.FirstOrDefault().MyTable2.id; public virtual MyTable2 Table2 { get; set;} public override void Up() { CreateIndex(""MyView1"", ""MyTable2Id""); AddForeignKey(""MyView1"", ""MyTable2Id"", ""MyTable2"", ""id"")} // Map one-to-zero or one relationship modelBuilder.Entity<MyTable2>() .HasRequired(t => t.MyTable1) .WithOptional(t => t.MyTable2); modelBuilder.Entity<MyTable1>() .HasOptional(t => t.MyTable2);",How can you add a navigation property on a view in EF 6.1 CodeFirst
"Why doesn't Stack, Queue and List halve the internal array after removing an item?"," In .NET, Stack, Queue and List (as well as their generic implementations) use an array internally to hold the items.When adding new element, the size of the internal array doubles on Push(), Enqueue() or Add() if it is full.The question is, why doesn't these data structures halve an internal array when item is being removed? It would be a good idea to halve the size of the array on Pop(), Dequeue() or Remove() if it is less than one-quarter full to prevent the waste of memory.I used the following code to check this behavior: <code>  var s = new Stack<int>();for (int i = 0; i <= 512; i++) s.Push(i); // Increases the array capacity to 1024.for (int i = 0; i <= 512; i++) s.Pop(); // Doesn't decrease array capacity.// Stack is empty, but internal array capacity is still 1024:var fieldInfo = typeof(Stack<int>).GetField(""_array"", BindingFlags.NonPublic | BindingFlags.Instance);Console.WriteLine((fieldInfo.GetValue(s) as int[]).Length);","Why doesn't Stack, Queue and List shrink the internal array after removing an item?"
multiple controller types with same route prefix asp.net web api," Is it possible to separate GETs and POSTs into separate API Controller types and accessing them using the same Route Prefix?Here are my controllers: <code>  [RoutePrefix(""api/Books"")]public class BooksWriteController : EventStoreApiController{ [Route("""")] public void Post([FromBody] CommandWrapper commandWrapper){...}}[RoutePrefix(""api/Books"")]public class BooksReadController : MongoDbApiController{ [Route("""")] public Book[] Get() {...} [Route(""{id:int}"")] public Book Get(int id) {...}}",Multiple Controller Types with same Route prefix ASP.NET Web Api
Asyncronous Streaming in WCF," I am working with Streaming with WCF and I have a question about what the paragraph on ""Enabling Asynchronous Streaming"" means from the MSDN article on Large Data and Streaming in WCF. To enable asynchronous streaming, add the DispatcherSynchronizationBehavior endpoint behavior to the service host and set its AsynchronousSendEnabled property to true. We have also added the capability of true asynchronous streaming on the send side. This improves scalability of the service in scenarios where it is streaming messages to multiple clients some of which are slow in reading possibly due to network congestion or are not reading at all. In these scenarios we now do not block individual threads on the service per client. This ensures that the service is able to process many more clients thereby improving the scalability of the service.I understand that the above means I add To my web.config file and referencing the AsyncStreaming behavior in my endpoint, however I don't understand what doing those steps accomplishes for me. Do I need to modify my code at all to take advantage of this asynchronousness?Also on a similar topic (but if it is too different I will move it to a new question), how does using async/await effect using Streams in WCF? Can I do Task<Stream> Foo() in my service contract? I make some database calls whose results I eventually wrap in to a custom stream that I will be returning from the WCF service. Being able to use things like ExecuteDataReaderAsync() is very useful, can I still use it when dealing with streamed instead of buffered messages? I have tested it and I know it ""works"" using Tasks but I don't know if doing it causes the function to fall back to ""Buffered"" mode like when you provide more than one parameter to the function (See the 3rd paragraph of ""Programming Model for Streamed Transfers"" on the same MSDN page) and I don't know how to check to see if that is happening. <code>  <behaviors> <endpointBehaviors> <behavior name=""AsyncStreaming""> <dispatcherSynchronization asynchronousSendEnabled=""true"" /> </behavior> </endpointBehaviors> ...",Asynchronous Streaming in WCF
hwo to get C# File Created Date and Modified Date, I have an .NET EXE file .I want to find the file created date and modified date in C# application. Can do it through reflection or with IO stream? <code> ,How to get File Created Date and Modified Date
How to get C# File Created Date and Modified Date, I have an .NET EXE file .I want to find the file created date and modified date in C# application. Can do it through reflection or with IO stream? <code> ,How to get File Created Date and Modified Date
How to use new ASP.NET Identiy 2.0 Roles and Authorize Attribute?," I am using the new ASP.NET Identity 2.0 system. I know I can check if a user is in a role like this: I guess this code can be written to check before certain code is run but what about the [Authorize] attribute. I used to be able say: This doesn't work anymore because I am not using the old membership or Role Management anymore. How can I put the two together? Or how do I guard against certain parts of the application not being available to members of the right role?Edit1: I don't believe that it's working. I put the following Authorize attribute on an Admin page and I am able to execute the code as a ""Customer Account User"" Also, I would like to block that page from being seen by unauthorized users. We have code to block the menu but I can still type the URL to the Admin page and it can be seen by unauthorized users EDIT2: We created the roles manually in the ASpNetRoles table and mapped users to roles in the ASPNetUsersToRoles table. There is a mapping from users to roles like ""Customer Service Admin."" We add users to roles with the following but I don't believe it works: When a regular user logs in they don't get an Admin menu to the Admin page by typing into the address bar: How do I stop that?Edit3: I tried to block all users to the Admin page per your example Eric but once again, I can log in as a Customer User and still type the above in the address bar and get to the page. What's wrong with this: Edit4: Switching to path=""Admin/default.aspx"" gives the following config file error: <code>  bool isAdmin = UserManager.IsInRole(User.Identity.GetUserId(), ""Customer Account Admin""); [Authorize(Role=""Customer Account Admin"")] [Authorize(Roles = ""Customer Service Admin, Savitas Admin"")] public partial class _default : System.Web.UI.Page if (HttpContext.Current.User.IsInRole(""Customer Account Admin"")) // { } else { mi = radmenu1.Items.FindItemByText(""Admin""); radmenu1.Items.Remove(mi); } if (manager.AddToRole(manager.FindByName(UserName.Text).Id, ""Customer Account Admin"").Succeeded) { c.logActivity(""Register.aspx.cs"", ""REG_USER_ROLE"", ""Setting user to Admin role succeeded""); } http://localhost:53620/Admin/default <configuration> <configSections> <section name=""entityFramework"" type=""System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" requirePermission=""false"" /> <!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 --></configSections> <connectionStrings> ... </connectionStrings> <location path=""~/Admin/default.aspx""> <system.web> <authorization> <allow roles=""Customer Service Admin"" /> <deny users=""*""/> </authorization> Configuration Error Description: An error occurred during the processing of a configuration file required to service this request. Please review the specific error details below and modify your configuration file appropriately. Parser Error Message: It is an error to use a section registered as allowDefinition='MachineToApplication' beyond application level. This error can be caused by a virtual directory not being configured as an application in IIS.Source Error: Line 66: </controls>Line 67: </pages>Line 68: <membership>Line 69: <providers>Line 70: <!-- ASP.NET Membership is disabled in this template. Please visit the following link http://go.microsoft.com/fwlink/?LinkId=301889 to learn about the ASP.NET Membership support in this template",How to use new ASP.NET Identity 2.0 Roles and Authorize Attribute?
JSON body is not seralized by NancyModule," I have a route in my module that is supposed to accept a JSON body representing blog post. Problem is that the request body is not seralized. If I debug I see the following values on the request: The route The HTTP-request <code>  this.Request.Body.Length: 93x.Keys.Count: 0 Post[""/Blog""] = x => { var post = this.Bind<Post>(); //Breakpoint PostService.Save(post); return post; }; POST /Blog HTTP/1.1Host: localhost:57888Content-Type: application/jsonCache-Control: no-cache{ ""Post"": { ""Title"":""Hello"", ""Content"":""World"", ""Created"":""2014-04-26"" } }",JSON body is not deseralized by NancyModule
Binding List ItemChanging Event, I am using Binding List in my application along with ItemChanged event. Is there any way I could know the previous values of properties in ItemChanged event. Currently I am adding a separate property named 'OldValue' to achieve this.Is there any way to know about the deleted item in item changed event. I am not able to find any way to know which item has been deleted from the list. <code> ,Get Deleted Item in ItemChanging event of BindingList
ItemChanging Event in BindingList, I am using Binding List in my application along with ItemChanged event. Is there any way I could know the previous values of properties in ItemChanged event. Currently I am adding a separate property named 'OldValue' to achieve this.Is there any way to know about the deleted item in item changed event. I am not able to find any way to know which item has been deleted from the list. <code> ,Get Deleted Item in ItemChanging event of BindingList
deserialize array of enum c# json.net," I have a JSON like this: and a class like this: AgencyType is an enumeration, and deserializiation and serialization for AgencyId works.ChangeType is another enumeration, but deserializiation and serialization for ChangeTypes doesn't work.I assume the reason is that ChangeTypes is an array of enumeration values.The question is: how can I deserialize/serialize ChangeTypes field, or in general an array of enumeration values?I tried by defining my own field converter, called ChangeTypeConverter, and changing StrinEnumConverter to ChangeTypeConverter for ChangeTypes field, but in the ReadJson function the value of reader is null. <code>  [{ ""agencyId"": ""myCity"", ""road"": { ""note"": """", ""lat"": ""45.321"", ""lon"": ""12.21"", ""streetCode"": ""290"", ""street"": ""street1"", ""fromNumber"": """", ""toNumber"": """", ""fromIntersection"": """", ""toIntersection"": """" }, ""changeTypes"": [""PARKING_BLOCK"", ""ROAD_BLOCK""],},] public class AlertRoad : BaseAlert{ [JsonProperty(""agencyId"")] [JsonConverter(typeof(StringEnumConverter))] public AgencyType AgencyId { get; set; } [JsonProperty(""changeTypes"")] [JsonConverter(typeof(StringEnumConverter))] public ChangeType[] ChangeTypes { get; set; } [JsonProperty(""road"")] public Road RoadInfo { get; set; }} public class ChangeTypeConverter : JsonConverter{ public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer) { } public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer) { var val = reader.Value; //val is null?!? return val; } public override bool CanConvert(Type objectType) { return objectType == typeof(ChangeType); }}",How do I deserialize an array of enum using Json.Net?
C# - Conversion from milliseconds to DateTime format," I got a string which is representend like this : What I want to do is to convert this string (which are milliseconds) to a DateTime variable. This is what I'm doing : The result is almost good : I've got a weird date but time is okay (30/04/0045 18:00:00).Is there any reason to this? <code>  string startdatetime = ""13988110600000"" double ticks = double.Parse(startdatetime);TimeSpan time = TimeSpan.FromMilliseconds(ticks);DateTime startdate = new DateTime(time.Ticks);",Conversion from milliseconds to DateTime format
error RijndaelManaged Padding is invalid and cannot be removed," I have error from CryptoStream:Padding is invalid and cannot be removed.Code <code>  public MemoryStream EncrypteBytes(Stream inputStream, string passPhrase, string saltValue){ RijndaelManaged RijndaelCipher = new RijndaelManaged(); RijndaelCipher.Padding = PaddingMode.PKCS7; RijndaelCipher.Mode = CipherMode.CBC; byte[] salt = Encoding.ASCII.GetBytes(saltValue); PasswordDeriveBytes password = new PasswordDeriveBytes(passPhrase, salt, ""SHA1"", 2); ICryptoTransform Encryptor = RijndaelCipher.CreateEncryptor(password.GetBytes(32), password.GetBytes(16)); MemoryStream memoryStream = new MemoryStream(); CryptoStream cryptoStream = new CryptoStream(memoryStream, Encryptor, CryptoStreamMode.Write); var buffer = new byte[1024]; var read = inputStream.Read(buffer, 0, buffer.Length); while (read > 0) { cryptoStream.Write(buffer, 0, read); read = inputStream.Read(buffer, 0, buffer.Length); } cryptoStream.FlushFinalBlock(); memoryStream.Position = 0; return memoryStream;}// Example usage: DecryptBytes(encryptedBytes, ""SensitivePhrase"", ""SodiumChloride"");public byte[] DecrypteBytes(MemoryStream memoryStream, string passPhrase, string saltValue){ RijndaelManaged RijndaelCipher = new RijndaelManaged(); RijndaelCipher.Padding = PaddingMode.PKCS7; RijndaelCipher.Mode = CipherMode.CBC; byte[] salt = Encoding.ASCII.GetBytes(saltValue); PasswordDeriveBytes password = new PasswordDeriveBytes(passPhrase, salt, ""SHA1"", 2); ICryptoTransform Decryptor = RijndaelCipher.CreateDecryptor(password.GetBytes(32), password.GetBytes(16)); CryptoStream cryptoStream = new CryptoStream(memoryStream, Decryptor, CryptoStreamMode.Read); byte[] plainBytes = new byte[memoryStream.Length]; int DecryptedCount = cryptoStream.Read(plainBytes, 0, plainBytes.Length); return plainBytes;}","Error RijndaelManaged, ""Padding is invalid and cannot be removed"""
TFS Build Issues With Multiple Versions of the Same Assembly in different Projects," I keep running into an issue with our TFS build server. I've got 2 projects (both in the same solution), 1 is a WebForms project, running .Net 4.0. The second is an ASP .Net MVC5 project running .Net 4.5. There is also a Silverlight project, but the problem is reproducible with just the first two.Both of these projects use NuGet packages for various libraries. Sometimes there are different assemblies within a package for their respective environments. A .Net 4.0, 4.5, SL assembly, etc.The build server seems to dump all of the libraries required into a single folder, then pulls from that to build the solution. This causes problems in many cases, with the wrong project getting the wrong assembly version. This does not occur locally, only on the build server. I can't figure out what I need to do to keep this from happening. Any ideas? <code> ",TFS Build Issues With Multiple Versions of the Same Assembly in Different Projects
Is C# List<xyz> passed by reference or as a copy," Taking my first steps in C# world from C/C++, so a bit hazy in details. Classes, as far as I understood, are passed by reference by default, but what about eg. List<string> like in: and elsewhere Is sl in this case passed by reference or is a copy made so that I'd need to redefine the worker function like to actually act on sl itself and not a copy? <code>  void DoStuff(List<string> strs){ //do stuff with the list of strings} List<string> sl = new List<string>();//next fill list in a loop etc. and then do stuff with it:DoStuff(sl); void DoStuff(ref List<string> strs)",Does C# pass a List<T> to a method by reference or as a copy?
using already computed element in LINQ," I find myself repeating calculations within a linq statements and I was wondering whether I can access already computed elements somehow. This is what I m doing: Which works fine.This is what I would like to be doing: where the price is the price I computed just after rundate. Can I access this somehow? <code>  var result = testdata.GroupBy(a => new { a.reportinggroup, a.commodity, a.timestep.Year }) .Select(g => new EndResult { rundate = rundate.ToShortDateString(), price = g.Sum(a => (a.timestep.ispeak()) ? a.price : 0) / g.Sum(a => (a.timestep.ispeak()) ? 1 : 0), valueposition = g.Sum(a => (a.timestep.ispeak()) ? a.position * a.price : 0) / (g.Sum(a => (a.timestep.ispeak()) ? a.price : 0) / g.Sum(a => (a.timestep.ispeak()) ? 1 : 0)), }).ToList(); var result = testdata.GroupBy(a => new { a.reportinggroup, a.commodity, a.timestep.Year }) .Select(g => new EndResult { rundate = rundate.ToShortDateString(), price = g.Sum(a => (a.timestep.ispeak()) ? a.price : 0) / g.Sum(a => (a.timestep.ispeak()) ? 1 : 0), valueposition = g.Sum(a => (a.timestep.ispeak()) ? a.position * a.price : 0) / price, }).ToList();",Using already computed element
casting from Float to Int," I was roaming around in different sites for casting techniques and I constructed the following code to cast to from float to int as shown below But above code throws an InvalidCastException. Why is this? I thought it is supposed to print 3,3 and 4. <code>  var floatList = new float[] { 2.7f, 3.1f, 4.5f };var intList = from int test1 in floatList select test1;foreach (var v in intList) Console.Write(""{0} "", v.ToString());",LINQ query throws an InvalidCastException?
Why does a cast from float to int in a LINQ query throw an InvalidCastException?," I was roaming around in different sites for casting techniques and I constructed the following code to cast to from float to int as shown below But above code throws an InvalidCastException. Why is this? I thought it is supposed to print 3,3 and 4. <code>  var floatList = new float[] { 2.7f, 3.1f, 4.5f };var intList = from int test1 in floatList select test1;foreach (var v in intList) Console.Write(""{0} "", v.ToString());",LINQ query throws an InvalidCastException?
Require Authentication for all request to an OWIN application," I am working with a self-hosted OWIN application and am trying to figure out how to require authentication/authorization for all requests (or arbitrary requests).Some of the individual components in the pipeline have their own Authorization facilities (ex. WebAPI, SignalR, Nancy) but that seems somewhat redundant when I want to restrict everything. Additionally, some middle-ware does not have authorization support (ex. Microsoft.Owin.StaticFiles).If my OWIN Startup looks something like this: How do I require the user have authenticated (redirecting if necessary) before serving the directory browser? (The directory browser could arbitrarily be other OWIN components.) <code>  public class Startup{ public void Configuration(IAppBuilder app) { app.RequireSsl(); app.UseCookieAuthentication(new CookieAuthenticationOptions()); //... app.UseGoogleAuthentication(); // ** Need to add something that restricts access ** app.UseDirectoryBrowser(); }} ",Require Authentication for all requests to an OWIN application
Roslyn: How to get all visible local variable names within a scope, (Please note: This is not about run-time reflection/metainfo)I am writing a concrete implementation of Roslyn CSharpSyntaxVisitorWhen implementing the VisitIdentifierName <code>  public override SyntaxNode VisitIdentifierName(IdentifierNameSyntax name){ var symbolInfo = _semanticModel.GetSymbolInfo(name); var fieldSymbol = symbolInfo.Symbol as IFieldSymbol; if (fieldSymbol != null) { // Here I would like to get all the local variable names what are visible // in the very same scope where this field IdentifierNameSyntax under visiting resides // We can suppose that _semanticNodel for the Document is available. }},How to get all visible local variable names within a scope with Roslyn (Microsoft CodeAnalysis)
How to get all visible local variable names within a scope, (Please note: This is not about run-time reflection/metainfo)I am writing a concrete implementation of Roslyn CSharpSyntaxVisitorWhen implementing the VisitIdentifierName <code>  public override SyntaxNode VisitIdentifierName(IdentifierNameSyntax name){ var symbolInfo = _semanticModel.GetSymbolInfo(name); var fieldSymbol = symbolInfo.Symbol as IFieldSymbol; if (fieldSymbol != null) { // Here I would like to get all the local variable names what are visible // in the very same scope where this field IdentifierNameSyntax under visiting resides // We can suppose that _semanticNodel for the Document is available. }},How to get all visible local variable names within a scope with Roslyn (Microsoft CodeAnalysis)
How to get all visible local variable names within a scope with Roslin (Microsoft CodeAnalysis), (Please note: This is not about run-time reflection/metainfo)I am writing a concrete implementation of Roslyn CSharpSyntaxVisitorWhen implementing the VisitIdentifierName <code>  public override SyntaxNode VisitIdentifierName(IdentifierNameSyntax name){ var symbolInfo = _semanticModel.GetSymbolInfo(name); var fieldSymbol = symbolInfo.Symbol as IFieldSymbol; if (fieldSymbol != null) { // Here I would like to get all the local variable names what are visible // in the very same scope where this field IdentifierNameSyntax under visiting resides // We can suppose that _semanticNodel for the Document is available. }},How to get all visible local variable names within a scope with Roslyn (Microsoft CodeAnalysis)
How to add multiple values to Dictionary in C#," What is the best way to add multiple values to a Dictionary if I don't want to call "".Add()"" multiple times.Edit: I want to fill it after initiation! there are already some values in the Dictionary!So instead of I want to do something like this Is there a way to do so? <code>  myDictionary.Add(""a"", ""b""); myDictionary.Add(""f"", ""v""); myDictionary.Add(""s"", ""d""); myDictionary.Add(""r"", ""m""); ... myDictionary.Add([""a"",""b""], [""f"",""v""],[""s"",""d""]);",How to add multiple values to Dictionary in C#?
C# priorities of multiple constraints on a generic type parameter," In the following example, I have two constraints, Foobar and IFoobar<T>, on type T in generic class FoobarList<T>. But the compiler gives an error: Cannot implicitly convert type 'Foobar' to 'T'. An explicit conversion exists (are you missing a cast?) It seems the compiler considers CreateFoobar as a method in Foobar, but not the one in IFoobar. I can fix the compile by dividing Foobar into a base class FoobarBase, and implementing the interface IFoobar in its derived class, as follows: It is cumbersome to divide Foobar into two classes. Is there a better way to fix this? <code>  interface IFoobar<T>{ T CreateFoobar();}class Foobar : IFoobar<Foobar>{ //some foobar stuffs public Foobar CreateFoobar() { return new Foobar(); }}class FoobarList<T> where T : Foobar, IFoobar<T>{ void Test(T rFoobar) { T foobar = rFoobar.CreateFoobar(); //error: cannot convert Foobar to T }} interface IFoobar<T>{ T CreateFoobar();}abstract class FoobarBase{ //some foobar stuffs}class Foobar : FoobarBase, IFoobar<Foobar>{ public Foobar CreateFoobar() { return new Foobar(); }}class FoobarList<T> where T : FoobarBase, IFoobar<T>{ void Test(T rFoobar) { T foobar = rFoobar.CreateFoobar(); }}",Priorities of multiple constraints on a generic type parameter
Why are declarations necessary in c#," I am currently teaching a colleague .Net and he asked me a question that stumped me.Why do we have to declare?if var is implicit typing, why do we have to even declare? becomes could become The implicit typing would still mean that this is a statically typed variable.If two different types are assigned to the variable, if they do not share a base class, (other than object), that could be a compiler error.Is there a technical reason this could not be done or is it stylistically we like havein <code>  Animal animal = new Animal(); var animal = new Animal(); animal = new Animal();",Why are declarations necessary
Is there a Tab Cosed kind of event in ASP.net MVC," I need to sign out a user when the user closed the tab or browser, how do I do that in ASP.NET MVC? <code> ",How do I log a user out when they close their browser or tab in ASP.NET MVC?
Is there a Tab Closed kind of event in ASP.net MVC," I need to sign out a user when the user closed the tab or browser, how do I do that in ASP.NET MVC? <code> ",How do I log a user out when they close their browser or tab in ASP.NET MVC?
How do I log a user out when they close their browser in ASP.NET MVC?," I need to sign out a user when the user closed the tab or browser, how do I do that in ASP.NET MVC? <code> ",How do I log a user out when they close their browser or tab in ASP.NET MVC?
Font Awesome with metro ui," I am using Metro UI project with my layout. I also added the font awesome into my project but when I use the metro and font awesome together, there have some issues: I want to set the fa icon into Metro UI title but when I run the code, I cannot see the icon from the title:If i only add following: Everything is fine... Somebody that can help me? <code>  <div class=""tile-content icon""> <span> <i class=""fa fa-ticket fa-fw""></i> </span></div> <i class=""fa fa-ticket fa-fw""></i>",Font Awesome with Metro UI CSS
"Client is reconnected after Owin restart, but message is not published"," Setup: SignalRServer console app: Microsoft.AspNet.SignalR.SelfHost v2.0.3 SignalRClient console app: Microsoft.AspNet.SignalR.Client v2.0.3 .NET 4.5.1 I do the following: Hit enter on client, a message is received at server and on client again Dispose the server by hitting any key in the server console Restart the server by hitting any key in the server console Client is reconnected Hit enter on client, message is received at server, but never reaches the client again I expect the message to be received at the client again. I suspect it has something to do with the self-hosting, since I've tried to run the client against same hub in a web application running IIS with success.Any ideas?Update: if the server console process is killed and restarted, it is able to reconnect AND retrieve messages again.Server code Client code <code>  using System;using System.Threading.Tasks;using Microsoft.AspNet.SignalR;using Microsoft.Owin.Hosting;using Owin;namespace SignalRServer{ internal class Program { private static void Main(string[] args) { const string url = ""http://localhost:8081""; while (true) { using (WebApp.Start<Startup>(url)) { Console.WriteLine(""Server running on {0}. Hit any key to stop."", url); Console.ReadLine(); } Console.WriteLine(""Server stopped""); Console.WriteLine(""Hit any key to restart, Esc to exit""); ConsoleKeyInfo ki = Console.ReadKey(true); if (ki.Key == ConsoleKey.Escape) return; } } } public class Startup { public void Configuration(IAppBuilder app) { app.MapSignalR(); } } public class AuthenticationHub : Hub { public void BroadcastMessageToAll(string message) { Clients.All.sendMessageToClient(message); Console.WriteLine(""sendMessageToClient: "" + message); } public override Task OnConnected() { Console.WriteLine(""OnConnected "" + Context.ConnectionId); return base.OnConnected(); } public override Task OnReconnected() { Console.WriteLine(""OnReconnected "" + Context.ConnectionId); return base.OnReconnected(); } public override Task OnDisconnected() { Console.WriteLine(""OnDisconnected "" + Context.ConnectionId); return base.OnReconnected(); } }} using System;using Microsoft.AspNet.SignalR.Client;namespace SignalRClient{ class Program { static void Main(string[] args) { while (true) { var hubConnection = new HubConnection(""http://localhost:8081/signalr/hubs""); hubConnection.Closed += () => Console.WriteLine(""Closed""); hubConnection.StateChanged += e => Console.WriteLine(""StateChanged: "" + e.OldState + "" "" + e.NewState); var hubProxy = hubConnection.CreateHubProxy(""AuthenticationHub""); hubProxy.On<string>(""sendMessageToClient"", info => Console.WriteLine(""sendMessageToClient received: "" + info)); hubConnection.Start(); Console.WriteLine(""Client started - hit Enter to send a message - ESC to stop""); Console.ReadKey(); while (true) { var keyInfo = Console.ReadKey(true); if (keyInfo.Key == ConsoleKey.Escape) break; var message = ""Console client : "" + DateTime.Now.ToString(""HH:mm:ss-fff""); hubProxy.Invoke(""BroadcastMessageToAll"", message); Console.WriteLine(""Client sent BroadcastMessageToAll: "" + message); } Console.WriteLine(""Client stopping""); hubConnection.Stop(); Console.WriteLine(""Client stopped - enter any key start again""); Console.ReadLine(); } } }}","SignalR client is reconnected after Owin restart, but message is not published"
EF Code First - same table name different schema," I have the following tables in my database, all with the same table name but different schema's.dbo.Versions bpm.Versions wf.Version...All x.Versions have a FK to the Version table. I've created the POCO classes from it (this gave me classes like Version, Version1, .... - - I've renamed the classNames to Version and BPMVersion, .... but the mapping still exists to the right table. This is an example of my mapping of BPMVersion that maps to bpm.Versions When creating the Migration script, I've got the following exception: The entity types 'BPMVersion' and 'Version' cannot share table 'Versions' because they are not in the same type hierarchy or do not have a valid one to one foreign key relationship with matching primary keys between them.I found the following blogs on the internet, it seams that EF has a problem with tables with the same name but different schema (https://entityframework.codeplex.com/workitem/1641 and http://geekswithblogs.net/tonyt/archive/2013/07/02/153327.aspx )Is there anyway to avoid this problem without renaming the table names?  <code>  // Primary Keythis.HasKey(t => t.Id);// Properties// Table & Column Mappingsthis.ToTable(""Version"", ""bpm"");this.Property(t => t.Id).HasColumnName(""Id"");this.Property(t => t.VersionId).HasColumnName(""VersionId"");this.Property(t => t.BPMId).HasColumnName(""BPMId"");// Relationshipsthis.HasRequired(t => t.BPM) .WithMany(t => t.BPMVersions) .HasForeignKey(d => d.BPMId);this.HasRequired(t => t.Version) .WithMany(t => t.BPMVersions) .HasForeignKey(d => d.VersionId);",Same table name different schema
Decimal to binary plus zero bits," I need to convert int to bin and with extra bits. it returns 11, but I need 0011, or 00000011.How is it done? <code>  string aaa = Convert.ToString(3, 2);",Convert an integer to a binary string with leading zeros
New Methods: Implementing INFINITE LOOP which can be STOPPED when requested," What is the correct method to implement a infinitely running task which executes an Async BigJob()? and can be stopped upon requestHint: I am trying to learn [a] new method(s) to update my existing strategy.I have this simple program (a tester) which has an Start and Stop button. When Start pressed, I am starting the tester which is going to find and test available devices in range and test the hell our of them in infinite amount of rounds until the user presses the Stop button. The important point is, the main process/action/bigJob() is and awaitble asynchronous process.So I would pseudo code the whole thing as So I am using BackgroundWorker to implement the infinite loop and Async/Await for the Connect, read, write and disconnect that I have written in C# under .Net 4.5Since my sub-tasks such as Connect and .etc are async then my main task is async and pressing the Stop button stops my process since it eliminates the infinite while loop that I have with having but it doesn't fire the BackgroundWorker_RunWorkerCompleted event, which doesn't do me any harm HOWEVER it's killing me since the background worker doesn't work as it's supposed to and I just keep thinking ""there should be a better way!"".So, I have been reading about so many new ideas, like why to use BackgroundWorker at all now that we have Async/await. Some were saying use Task.Run() it's magical. I even read recommendations and blogs about this godsend TPL Dataflow that I have never heard of. And so far I haven't found a method which is as structured, documented and layed-out as a BackgroundWorker. (unless it's such simple or a one liner which doesn't even need documentation or .etc) So, guys, what is the solution for this. Or better way to ask:What is the correct method to implement a infinitely running task which executes an Async BigJob()? and can be stopped upon request <code>  Start Round 1 starts Async Main job starts Async connect Async Read Async Write Async disconnect Nobody cancelled me yet Round 1 finishes Round 2 starts . . . Round 2 finishes Round 3 starts . Stop pressed, hence break out. Stop while (!bw.CancellationPending){ await MainTask(); ...}",New Methods: Implementing INFINITE LOOP which can be STOPPED upon request
how to step inside an overloaded operator while debugging c# visualstudio 2013, Take for example the following code: I'm trying to debug what happened when the - (minus operation) is called but when I try to debug by pressing F11 (step into) it just goes inside the constructor and toString()...How can I debug inside the overloaded - operator? <code>  public static void Main() { Console.WriteLine(Integer.zero - new Integer(5)); },How to step inside an overloaded operator while debugging?
how to step inside an overloaded operator while debugging, Take for example the following code: I'm trying to debug what happened when the - (minus operation) is called but when I try to debug by pressing F11 (step into) it just goes inside the constructor and toString()...How can I debug inside the overloaded - operator? <code>  public static void Main() { Console.WriteLine(Integer.zero - new Integer(5)); },How to step inside an overloaded operator while debugging?
"C#, Set the instance to null not the variable referencing it"," I created an object, and I assigned it to two variables found in separate classes.If in one class I set the variable to null, it only breaks that reference to the object but the object itself still persists due to the other reference.How do I set the object to null, so that both references point to null? Without finding every reference.this is pseudocode. The idea is to lose the reference in both ClassA (ref1) and ClassB (ref2). <code>  public class ClassA{ public ClassC ref1 = new ClassC (); static void Main(string[] args) { ref1 = null; }}public class ClassB{ public static ClassC ref2; public static AssignC (ClassC c) { ref2 = c; }}public class ClassC{ public ClassC () { ClassB.AssignC (this); }}",Set the instance to null not the variable referencing it
Suspending event not raising on Windows Phone 8.1 using WinRT," I'm having a problem with suspending event on Windows Phone 8.1 using WinRT, it does not fire. I don't know why. This is my code: I set a breakpoint on the line var deferral = e.SuspendingOperation.GetDeferral(); and debugged it with Visual Studio. Then I pressed the start button on my phone and ran another app and waited about 10 seconds. OnSuspending is not running. Any ideas? <code>  /// <summary>/// Initializes the singleton application object. This is the first line of authored code/// executed, and as such is the logical equivalent of main() or WinMain()./// </summary>public App(){ InitializeComponent(); Suspending += OnSuspending;#if DEBUG this.displayRequest = new DisplayRequest();#endif}/// <summary>/// Invoked when application execution is being suspended. Application state is saved/// without knowing whether the application will be terminated or resumed with the contents/// of memory still intact./// </summary>/// <param name=""sender"">/// The source of the suspend request./// </param>/// <param name=""e"">/// Details about the suspend request./// </param>private void OnSuspending(object sender, SuspendingEventArgs e){ var deferral = e.SuspendingOperation.GetDeferral(); deferral.Complete();}",Suspending event not raising using WinRT
convert file to binary c sharp," I am trying to write a program that transfers a file through sound (kind of like a fax). I broke up my program into several steps:convert file to binaryconvert 1 to a certain tone and 0 to anotherplay the tones to another computerother computer listens to tonesother computer converts tones into binaryother computer converts binary into file.However, I can't seem to find a way to convert a file to binary. I found a way to convert a string to binary using From http://www.fluxbytes.com/csharp/convert-string-to-binary-and-binary-to-string-in-c/ .But I can't find out how to convert a file to binary (the file could be of any extension).So, how can I convert a file to binary? Is there a better way for me to write my program? <code>  public static string StringToBinary(string data){ StringBuilder sb = new StringBuilder(); foreach (char c in data.ToCharArray()) { sb.Append(Convert.ToString(c, 2).PadLeft(8,'0')); } return sb.ToString();}",Convert file to binary in C#
Disabled DropDownnList razor mvc," In my razor view, I use a drop down list. I want to have this control disabled (not selectable). My code is: But it doesn't work, my control is always enabled. Html page code is: without the ""disabled"" attribute.My real goal is to enable/disable dropdown conditionally, something like this: but it doesn't work. I tried both with and but nothing, disabled attribute is not rendering on html page.Anyone has an idea? <code>  <div class=""field-list"">@Html.DropDownListFor(model => model.LinguaCodiceMadre, Model.LinguaMadreList, new{ @disabled = ""disabled"" })</div> <select name=""LinguaCodiceMadre"" id=""LinguaCodiceMadre"" data-val-length-max=""10"" data-val-length=""The field LinguaCodiceMadre must be a string with a maximum length of 10."" data-val=""true""> <option></option> <option value=""sq"">Albanian</option> <option value=""de"">German</option> <option value=""en"">English</option> <option value=""fr"">French</option> <option value=""it"">Italian</option> <option value=""pt"">Portuguese</option> <option value=""ru"">Russian</option> <option value=""es"">Spanish</option></select> <div class=""field-list"">@Html.DropDownListFor(model => model.LinguaCodiceMadre, Model.LinguaMadreList, new{@disabled=Model.IsDisabled ? ""disabled"" : ""false""})</div> new{@disabled=Model.IsDisabled ? ""disabled"" : ""false""} new{disabled=Model.IsDisabled ? ""disabled"" : ""false""}",Disabled DropDownList razor mvc
json readasasync with task pattern," I'm trying to deserialize the JSON returned from http://api.usa.gov/jobs/search.json?query=nursing+jobs using the .NET 4.0 Task pattern. It returns this JSON ('Load JSON data' @ http://jsonviewer.stack.hu/). Index Action: Jobs and Job class: When I set a breakpoint on jsonTask.Wait(); and examine jsonTask the status isFaulted. The InnerException is ""Type ProjectName.Jobs is not a collection.""I started with the Jobs type without the JsonArray attribute and Jobs as an array (Job[]) and got this error. How would I process this site's JSON with the .NET 4.0 Task pattern? I would like to get this working before moving onto the await async pattern in .NET 4.5.ANSWER UPDATE:Here's an example using the .NET 4.5 async await pattern with brumScouse's answer. You will need to bring in the System.Threading.Tasks namespace.Note: there is no .ReadAsString method available on .Content which is why I used the .ReadAsStringAsync method. <code>  [ { ""id"": ""usajobs:353400300"", ""position_title"": ""Nurse"", ""organization_name"": ""Indian Health Service"", ""rate_interval_code"": ""PA"", ""minimum"": 42492, ""maximum"": 61171, ""start_date"": ""2013-10-01"", ""end_date"": ""2014-09-30"", ""locations"": [ ""Gallup, NM"" ], ""url"": ""https://www.usajobs.gov/GetJob/ViewDetails/353400300"" }, { ""id"": ""usajobs:359509200"", ""position_title"": ""Nurse"", ""organization_name"": ""Indian Health Service"", ""rate_interval_code"": ""PA"", ""minimum"": 42913, ""maximum"": 61775, ""start_date"": ""2014-01-16"", ""end_date"": ""2014-12-31"", ""locations"": [ ""Gallup, NM"" ], ""url"": ""https://www.usajobs.gov/GetJob/ViewDetails/359509200"" }, ...] public class HomeController : Controller { public ActionResult Index() { Jobs model = null; var client = new HttpClient(); var task = client.GetAsync(""http://api.usa.gov/jobs/search.json?query=nursing+jobs"") .ContinueWith((taskwithresponse) => { var response = taskwithresponse.Result; var jsonTask = response.Content.ReadAsAsync<Jobs>(); jsonTask.Wait(); model = jsonTask.Result; }); task.Wait(); ... } [JsonArray] public class Jobs { public List<Job> JSON; } public class Job { [JsonProperty(""organization_name"")] public string Organization { get; set; } [JsonProperty(""position_title"")] public string Title { get; set; } } public class Jobs { public Job[] JSON; } + InnerException {""Cannot deserialize the current JSON array (e.g. [1,2,3]) into type 'ProjectName.Models.Jobs' because the type requires a JSON object (e.g. {\""name\"":\""value\""}) to deserialize correctly.\r\n To fix this error either change the JSON to a JSON object (e.g. {\""name\"":\""value\""}) or change the deserialized type to an array or a type that implements a collection interface (e.g. ICollection, IList) like List<T> that can be deserialized from a JSON array. JsonArrayAttribute can also be added to the type to force it to deserialize from a JSON array.\r\nPath '', line 1, position 1.""} System.Exception {Newtonsoft.Json.JsonSerializationException} public async Task<ActionResult>Index() { List<Job> model = null; var client = newHttpClient(); // .NET 4.5 async await pattern var task = await client.GetAsync(http://api.usa.gov/jobs/search.json?query=nursing+jobs); var jsonString = await task.Content.ReadAsStringAsync(); model = JsonConvert.DeserializeObject<List<Job>>(jsonString); returnView(model); }",Deserialize JSON to Array or List with HTTPClient .ReadAsAsync using .NET 4.0 Task pattern
"Is possible to place Edit , Delete button in jQuery DataTables"," I am a beginner using jQuery DataTable, and I am trying to place Edit and Delete buttons in a jQuery DataTable with dynamic databinding in bootstrap like in the below image:But I get an error message:Controller Action HTML Script <code>  public class PhoneNumber { public string Number { get; set; } public string Description { get; set; } public string Action { get; set; } } public ActionResult LoadPhoneNumbers() { var phoneNumbers = new List<PhoneNumber>(new[] { new PhoneNumber { Number = ""555 123 4567"", Description = ""George"",Action="""" }, new PhoneNumber { Number = ""555 765 4321"", Description = ""Kevin"" ,Action="""" }, new PhoneNumber { Number = ""555 555 4781"", Description = ""Sam"",Action="""" } }); return Json(new { aaData = phoneNumbers.Select(x => new[] { x.Number, x.Description }) }, JsonRequestBehavior.AllowGet); } <table id=""tblAdminUsers"" class=""table table-striped table-bordered table-hover table-highlight table-checkable"" data-info=""true"" data-search=""true"" data-paginate=""true""> <thead> <tr> <th>Number</th> <th>Description</th> <th>Action</th> </tr> </thead> <tbody> </tbody> </table> $(function () { $(""#tblAdminUsers"").dataTable({ bProcessing: true, sAjaxSource: '@Url.Action(""LoadPhoneNumbers"", ""Admin"")', aoColumns: [ { mData: ""Number"" }, { mData: ""Description"" }, { mData: ""Action"", bSortable: false, mRender: function (o) { return '<i class=""ui-tooltip fa fa-pencil"" style=""font-size: 22px;"" data-original-title=""Edit""></i><i class=""ui-tooltip fa fa-trash-o"" style=""font-size: 22px;"" data-original-title=""Delete""></i>'; } } ] });});",Is it possible to place Edit and Delete buttons in jQuery DataTables?
c# Thread.Sleep() without freeze the UI," First off, I am a beginner in C# and I would like to make this: But this solution freezes the UI, how could I make the second event occur 250ms after the first etc without freezing the UI? <code>  class2.method_79(null, RoomItem_0, num, num2, 0, false, true, true);System.Threading.Thread.Sleep(250);class2.method_79(null, RoomItem_0, num, num4, 0, false, true, true);System.Threading.Thread.Sleep(300);class2.method_79(null, RoomItem_0, num, num6, 0, false, true, true);",Thread.Sleep() without freezing the UI
Thread.Sleep() without freeze the UI," First off, I am a beginner in C# and I would like to make this: But this solution freezes the UI, how could I make the second event occur 250ms after the first etc without freezing the UI? <code>  class2.method_79(null, RoomItem_0, num, num2, 0, false, true, true);System.Threading.Thread.Sleep(250);class2.method_79(null, RoomItem_0, num, num4, 0, false, true, true);System.Threading.Thread.Sleep(300);class2.method_79(null, RoomItem_0, num, num6, 0, false, true, true);",Thread.Sleep() without freezing the UI
C# web service - insufficient winsock resources," We have a c# web service and client, both created in Visual Studio 2008 (new project -> ASP.Net web service application). Service is hosted on Windows server 2012 R2, IIS 8.5.When the client sends the data to our service, we forward it to a 3rd party service, save the result to a database and return it to the client.The problem is that, in some rare occasions, when our service is under heavy load (many requests per second), it starts throwing 'Insufficient winsock resources available to complete socket connection initiation'. We found that our web service is opening many TCP connections to 3rd party services, and leaving them in TIME_WAIT state. When the number of such connections reaches a high number (around 17000), the entire server loses ability to make any new connections. Everything from remote desktop to the internet browser stops working. This lasts for a few minutes, and then, when Windows begins closing those connections, it resumes normally.For communication with the 3rd party service, our service is using only one SoapClient instance through its entire life time. It is created on initialization, and is never closed or destroyed; new instances are never created. When sending the data to the 3rd party service we simply call its web method, and leave it like that without closing, disposing or doing any clean-up: Is there anything we can do to avoid this build-up of time_wait connections?Is there a better way to manage SoapClient(s)? Should we open a new soap client for every request and close them manually?If it is relevant, here is how our binding is set up: Thank you! <code>  BLIND.BLINDSoapClient client = new BLIND.BLINDSoapClient(base.binding, base.address); BLIND.Answer answer = client.Search(...);..save to databasereturn answer; binding = new BasicHttpBinding(); binding.Name = ""SLTDSoap""; binding.CloseTimeout = TimeSpan.FromSeconds(Timeout); binding.OpenTimeout = TimeSpan.FromSeconds(Timeout); binding.ReceiveTimeout = TimeSpan.FromSeconds(Timeout); binding.SendTimeout = TimeSpan.FromSeconds(Timeout); binding.AllowCookies = false; binding.BypassProxyOnLocal = false; binding.HostNameComparisonMode = HostNameComparisonMode.StrongWildcard; binding.MaxBufferSize = 65536; binding.MaxBufferPoolSize = 524288; binding.MessageEncoding = WSMessageEncoding.Text; binding.TextEncoding = System.Text.Encoding.UTF8; binding.TransferMode = TransferMode.Buffered; binding.UseDefaultWebProxy = true; binding.ReaderQuotas.MaxDepth = 32; binding.ReaderQuotas.MaxStringContentLength = 8192; binding.ReaderQuotas.MaxArrayLength = 16384; binding.ReaderQuotas.MaxBytesPerRead = 4096; binding.ReaderQuotas.MaxNameTableCharCount = 16384; binding.Security.Mode = (_url.StartsWith(""https:"")) ? BasicHttpSecurityMode.Transport : BasicHttpSecurityMode.None; binding.Security.Transport.ClientCredentialType = HttpClientCredentialType.None; binding.Security.Transport.ProxyCredentialType = HttpProxyCredentialType.None; binding.Security.Transport.Realm = """"; binding.Security.Message.ClientCredentialType = BasicHttpMessageCredentialType.UserName; binding.Security.Message.AlgorithmSuite = System.ServiceModel.Security.SecurityAlgorithmSuite.Default;System.Net.ServicePointManager.DefaultConnectionLimit = 500;",Insufficient winsock resources
Create custom DataType Validation C# MVC," I want to make my own validation class (i have a lot of validation methods in JS that i want to translate into C# to use with MVC models) that works exactly like data annotations do, validating in client and server side: [DataType(MyDataType)] or like a Validation DataAnnotation Attribute like this: [MyDataTypeValidation]i don't know wich option is better to make my validation ""library""In example i have my class FigurasDA and i want to make my custom validation to the attribute nombre. so in this case, i want to validate that the string matches the regexp @""^[\w\s\.\-_]+$"" and shows a error message like this ""Solo se permite letras, numeros y puntuaciones(- _ .)"" if don't. (this is my ""Alfanumerico"" datatype).Can you give me an example where to put my validation class and what code write inside?. <code>  namespace MonitoreoIntegrado.Models{ [MetadataType(typeof(FigurasDA))] public partial class Figuras{}public class FigurasDA{ [DataType(MyDataType)] //or [MyDataTypeValidation] public string nombre { get; set; }}}",Create custom DataType Validation
Hidden field value changed event doesn't trigger when changed from code behind," UPDATEI moved the Javascript to the ASPX site instead, and added a postback function for it. Now it works. Thanks to @orgtigger and especially @lucidgold for spending their time helping me!Here is the update code that works! Code: Code-behind: The links (only part of code that makes links): Old PostI need to update a GridView based on the value of a HiddenField. I am currently using a button to populate the GridView, but would like to do it automaticaly as soon as the value in the HiddenField changes.But when I change the value with a javascript, then event doesn't fire.(Same thing also happens in case of a TextBox and its OnTextChanged event.)Not sure if this is way it's meant to work. <code>  <script type=""text/javascript""> function changevalue(katoid) { $('#<%=txtboxchosenkat.ClientID%>').val(katoid); __doPostBack('<%= updpnlgridview.ClientID %>', ''); }</script> <asp:UpdatePanel ID=""updpnlgridview"" runat=""server"" UpdateMode=""Conditional""> <ContentTemplate> <asp:TextBox ID=""txtboxchosenkat"" style=""display:none;"" runat=""server"" OnTextChanged=""txtboxchosenkat_TextChanged"" AutoPostBack=""true""></asp:TextBox> <asp:GridView ID=""gridview"" runat=""server""></asp:GridView> </ContentTemplate></asp:UpdatePane protected void hidfldchosenkat_ValueChanged(object sender, EventArgs e){ SqlConnection cn2 = new SqlConnection(""Server=**,***,***,**;Database=******; User Id=******;Password=******;""); SqlCommand cmd2 = new SqlCommand(""SELECT * FROM tblProducts where KatID='"" + txtboxchosenkat.Text + ""'"", cn2); SqlDataAdapter da2 = new SqlDataAdapter(cmd2); da2.SelectCommand.CommandText = cmd2.CommandText.ToString(); DataTable dt = new DataTable(); da2.Fill(dt); gridview.DataSource = dt.DefaultView; gridview.DataBind();} string line = String.Format(""<li><a href='#' onclick='changevalue("" + pid + "");'>{0}"", menuText + ""</a>"");",HiddenField.ValueChanged Event not firing when changed from Javascript
HiddenField.ValueChanged Event not firing," UPDATEI moved the Javascript to the ASPX site instead, and added a postback function for it. Now it works. Thanks to @orgtigger and especially @lucidgold for spending their time helping me!Here is the update code that works! Code: Code-behind: The links (only part of code that makes links): Old PostI need to update a GridView based on the value of a HiddenField. I am currently using a button to populate the GridView, but would like to do it automaticaly as soon as the value in the HiddenField changes.But when I change the value with a javascript, then event doesn't fire.(Same thing also happens in case of a TextBox and its OnTextChanged event.)Not sure if this is way it's meant to work. <code>  <script type=""text/javascript""> function changevalue(katoid) { $('#<%=txtboxchosenkat.ClientID%>').val(katoid); __doPostBack('<%= updpnlgridview.ClientID %>', ''); }</script> <asp:UpdatePanel ID=""updpnlgridview"" runat=""server"" UpdateMode=""Conditional""> <ContentTemplate> <asp:TextBox ID=""txtboxchosenkat"" style=""display:none;"" runat=""server"" OnTextChanged=""txtboxchosenkat_TextChanged"" AutoPostBack=""true""></asp:TextBox> <asp:GridView ID=""gridview"" runat=""server""></asp:GridView> </ContentTemplate></asp:UpdatePane protected void hidfldchosenkat_ValueChanged(object sender, EventArgs e){ SqlConnection cn2 = new SqlConnection(""Server=**,***,***,**;Database=******; User Id=******;Password=******;""); SqlCommand cmd2 = new SqlCommand(""SELECT * FROM tblProducts where KatID='"" + txtboxchosenkat.Text + ""'"", cn2); SqlDataAdapter da2 = new SqlDataAdapter(cmd2); da2.SelectCommand.CommandText = cmd2.CommandText.ToString(); DataTable dt = new DataTable(); da2.Fill(dt); gridview.DataSource = dt.DefaultView; gridview.DataBind();} string line = String.Format(""<li><a href='#' onclick='changevalue("" + pid + "");'>{0}"", menuText + ""</a>"");",HiddenField.ValueChanged Event not firing when changed from Javascript
Parent-Child one-to-one Relation same Table - EntityFramework," I have a question about how to realize a Table relationship in Microsoft SQL-Server 2012.I have a Table (MyTable) which should hold a Parent/Child structure.One Parent may have one Child and one Child only has one Parent. This is a classical one-to-one relation. The topmost entry obviously may not have a parent. (This is modelled via a nullable property)When I try to model this in MS-SQL I receive a table as follows.Here is my Code: The UNIQE Constraint should assure that there is at most one parent for one child.BUT Entity Framework won't let me change the properties to be a one-to-one relation. It always generates a one-to-many relation.EDIT:The code is DB-First.Do you have any idea on how to model this properly in MS-SQL and EntityFramework? <code>  CREATE TABLE [dbo].[MyTable]( [Id] [uniqueidentifier] PRIMARY KEY NOT NULL, [Name] [nvarchar](200) NOT NULL, [ParentObjectId] [uniqueidentifier] NULL)GOALTER TABLE [dbo].[MyTable] WITH CHECK ADD CONSTRAINT [FK_MyTable_ParentObject] FOREIGN KEY([ParentObjectId])REFERENCES [dbo].[MyTable] ([Id])GOALTER TABLE [dbo].[MyTable] WITH CHECK ADD CONSTRAINT [Unique_ParentId] UNIQUE(ParentObjectId)GOALTER TABLE [dbo].[MyTable] CHECK CONSTRAINT [FK_MyTable_ParentObject]GO",Parent-Child one-to-one Relation same Table
do not understand the reason for ThreadAbortException rethrowing itself," I have the current code: Now I know the method ResetAbort is supposed to prevent the ThreadAbortException from continue to re-throw itself even when a catch statement is catching it, but my question is this:If anyone can use the ResetAbort method, then what's the point of the exception specially re-throw itself? the user can just do <code>  class Program{ private static void Main() { while (true) { try { Thread.CurrentThread.Abort(); } catch (ThreadAbortException) { Console.WriteLine(""Abort!""); Thread.ResetAbort(); } Console.WriteLine(""now waiting""); Console.ReadKey(); } }} catch (ThreadAbortException ex) { Console.WriteLine(""Abort!""); throw ex; }",C# - Thread Abort Exception (Thread Abort Exception) rethrowing itself
C# - Is it possible to bind a List<Object> which contains List<String> to DataGrid in WPF," My question is how to bind a List<Object> ( Which contains a List<String> ) to a DataGrid in WPFLets say the Class looks like this Lets say i have List<Student> but how would i bind this to a Data Grid in the Data Source.I am sure this, DataGrid.DataSource=List<Student> wouldn't work as expected.This is how i want <code>  Class Student{ String Name; List<String> Marks;}",Is it possible to bind a List<Object> which contains List<String> to DataGrid
returning an object from pscmdlet," I'm trying to create my own set of cmdlets for a PowerShell snapin. The problem I'm having is that I've created my own object that I create and populate within the ProcessRecord method but I'm not able to change the return type to allow me to return the object that I created. This is my ProcessRecord method but as it's overriding the one from PSCmdlet I cannot change the return type from void.Can anyone help with the best way to return the rptFileSettings object so as I can then use it with its values in other cmdlets? <code>  protected override void ProcessRecord() { ReportFileSettings rptFileSettings = new ReportFileSettings(); rptFileSettings.Enabled = string.Equals((reader.GetAttribute(""Enabled"").ToString().ToLower()), ""yes""); rptFileSettings.FileLocation = reader.GetAttribute(""FileLocation"").ToString(); rptFileSettings.OverwriteExisting = string.Equals(reader.GetAttribute(""OverwriteExistingFile"").ToString().ToLower(), ""yes""); rptFileSettings.NoOfDaysToKeep = int.Parse(reader.GetAttribute(""NumberOfDaysToKeep"").ToString()); rptFileSettings.ArchiveFileLocation = reader.GetAttribute(""ArchiveFileLocation"").ToString(); return rptFileSettings; }",Returning an object from PowerShell cmdlet
Dynamical text underlined by braces," I want to underline a word with a round brace. This should be part of a C# Text but if it is easier in CSS, no problem. My problem is that the length of the Word can vary, so the bow must by calculated for each word.My first idea was using CSS box-shadow:CSS: HTML: Unfortunately due to the dynamic Text sizes I can't calculate them.Is there a smarter approach to this problem? <code>  #test { font-size: 50px; background: transparent; border-radius: 70px; height: 65px; width: 90px; box-shadow: 0px 6px 0px -2px #00F; font-family: sans-serif;} <div id=""test"">Hey</div>",Dynamic text underlined by braces
WPF TextBlock Binding," I try bind Text property of TextBlock to my property but text does not update.XAML C# <code>  <Window x:Name=""window"" x:Class=""Press.MainWindow"" xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" xmlns:d=""http://schemas.microsoft.com/expression/blend/2008"" xmlns:mc=""http://schemas.openxmlformats.org/markup-compatibility/2006"" mc:Ignorable=""d"" Title=""Press analyzer"" Height=""350"" Width=""525"" ContentRendered=""Window_ContentRendered"" d:DataContext=""{d:DesignData MainWindow}"">... <StatusBar Name=""StatusBar"" Grid.Row=""2"" > <TextBlock Name=""StatusBarLabel"" Text=""{Binding Message}""/> </StatusBar></Window> public partial class MainWindow : Window, INotifyPropertyChanged { private string _message; public string Message { private set { _message = value; OnPropertyChanged(""Message""); } get { return _message; } }public event PropertyChangedEventHandler PropertyChanged; [NotifyPropertyChangedInvocator] protected virtual void OnPropertyChanged([CallerMemberName] string propertyName = null) { PropertyChangedEventHandler handler = PropertyChanged; if (handler != null) handler(this, new PropertyChangedEventArgs(propertyName)); }}",WPF TextBlock Binding doesn't work
Unable to create a new web project in Visual studion 2013," Background:I am trying to use my office machine, where I have some limited rights, from home. All products are installed through when I was connected with my network drives, where my profile exists. Now, I am at home where I don't have an access to these network drives.Problem: Whenever I am trying to create a project in visual studio I am getting the following errors: Finding: After doing some research I found that it is due to IISExpress. I have ensured that from Tools > options > Web project that IIS express is not enabled for all new web project.I also got an error as: Then I realized that may be it is not able to instantiate with IIS. Then I have tried to run an IIS express from the command prompt and I got this error: C:\Program Files\IIS Express>iisexpress.exe An error occurred while reading configuration information. Make sure that the configuration file \NAUNSW001\MalhAm\IISExpress\config\applicationhost.config exi sts, it is accessible, and contains valid configuration information.I don't have an access to the registry where this path might be picked by the IISexpress. I have tried to execute the IISexpress /path: c:\vs\ it worked. However, even then also when I am trying to create a new project I got an error as:  <code>  ---------------------------Microsoft Visual Studio---------------------------Package 'ProviderPackage' failed to load.--------------------------- ---------------------------Microsoft Visual Studio---------------------------Configuring IIS Express failed with the following error:Filename: redirection.configError: Cannot read configuration file--------------------------- ---------------------------Microsoft Visual Studio---------------------------Configuring IIS Express failed with the following error:Filename: redirection.configError: Cannot read configuration file",Unable to create a new web project in Visual Studio 2013
Why the internal implementation of dependency injection appears to be a Hack?, I am learning about Dependency Injection. I understand the basic reason why it is vital when developing large applications.It seems Dependency Injection uses reflection to achieve some of its goals. To me it seems that reflection is a kind of reverse engineering.Why and how is Reflection used and is it optional? <code> ,Why reflection in dependency injection?
C# Passing array to a SQL Stored Procedure," How can I pass an array variable to a SQL Server stored procedure using C# and insert array values into a whole row?Thanks in advance.SQL Server table: C# array: SQL Server stored procedure: <code>  ID | Product | Description-------------------------------8A3H | Soda | 600ml bottle string[] info = new string[] {""7J9P"", ""Soda"", ""2000ml bottle""}; ALTER PROC INSERT (@INFO_ARRAY ARRAY)ASBEGIN INSERT INTO Products VALUES (@INFO_ARRAY)END",Passing array to a SQL Server Stored Procedure
Passing array to a SQL Stored Procedure," How can I pass an array variable to a SQL Server stored procedure using C# and insert array values into a whole row?Thanks in advance.SQL Server table: C# array: SQL Server stored procedure: <code>  ID | Product | Description-------------------------------8A3H | Soda | 600ml bottle string[] info = new string[] {""7J9P"", ""Soda"", ""2000ml bottle""}; ALTER PROC INSERT (@INFO_ARRAY ARRAY)ASBEGIN INSERT INTO Products VALUES (@INFO_ARRAY)END",Passing array to a SQL Server Stored Procedure
Json.NET - Type is an interface or abstract class and cannot be instantiated," I will preface this by saying that I know what the problem is, I just don't know how to solve it. I am communicating with a .NET SOA data layer that returns data as JSON. One such method returns an object that has several collections within it. The object basically looks like this: My class that represents this object looks like this: This constructor worked fine until the cogCollection added a child collection, and now I am getting the above error. A concrete cog class looks like this: I don't want to change the collection to a concrete type because I am using IoC. Because I am using IoC I would really like to get away from the need to have the JsonConstructors that take concrete parameters, but I haven't figured out a way to do that. Any advice would be greatly appreciated!Update:Yuval Itzchakov's suggestion that this question is probably a duplicate is somewhat true (it seems). In the post referenced, one of the answers down the page provides same solution that was provided here. I didn't notice that answer, since the OP's question was different then the one I had here. My mistake. -------my solution--------As I said: Matt's solution took a little bit of work but I got something setup that works for me. The one thing I didn't like about his initial solution, were lines like these: Following this pattern you would need to have a JsonConverter for every abstract type that you receive over the wire. This is less than ideal in my situation, so I created a generic JsonConverter as such: Then just before I deserialize my data, I do something like this: Protip: If you use Resharper, (JsonConverter) will give you a suspicious cast warning in this scenario. Hopefully someone else finds this useful down the road! <code>  { ""Name"":""foo"", ""widgetCollection"":[{""name"",""foo""}, {""name"",""foo""},], ""cogCollection"": [{""name"",""foo""}, {""childCogs"",<<new collection>>},],} public class SuperWidget : IWidget{ public string Name { get; set; } public ICollection<IWidget> WidgetCollection { get; set; } public ICollection<ICog> CogCollection { get; set; } public SuperWidget() { } [JsonConstructor] public SuperWidget(IEnumerable<Widget> widgets, IEnumerable<Cog> cogs) { WidgetCollection = new Collection<IWidget>(); CogCollection = new Collection<ICog>(); foreach (var w in widgets) { WidgetCollection.Add(w); } foreach (var c in cogs) { CogCollection.Add(c); } }} [Serializable]public class Cog : ICog{ public string name { get; set; } public ICollection<ICog> childCogs { get; set; } } return objectType == typeof(ICog); public class GenericJsonConverter<T>: JsonConverter, IBaseJsonConverter<T>{ private readonly IUnityContainer Container; public GenericJsonConverter(IUnityContainer container) { Container = container; } public override bool CanConvert(Type objectType) { return objectType == typeof(T); } public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer) { var target = serializer.Deserialize<Newtonsoft.Json.Linq.JObject>(reader); var result = Container.Resolve<T>(); serializer.Populate(target.CreateReader(), result); return result; } public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer) { serializer.Serialize(writer, value); }} var settings = new JsonSerializerSettings { TypeNameHandling = TypeNameHandling.All }; settings.Converters.Add((JsonConverter)Container.Resolve<IBaseJsonConverter<ICog>>());",Type is an interface or abstract class and cannot be instantiated
C# | WPF - Custom Title Bar - Drag window from top when maximized doesnt work," I have a custom title bar and with the window style set to none. On the click of the title bar I check to see if it is a double click (that does window maximize and restore) if it is not double clicked I do Window.DragMove. This works great for the snapping to the side and top. But when I try to drag the window when it is maximized (which would normally restore the window down), it doesn't do anything. Here is my code: Modern UI and MahApps.Metro does it somehow and I looked at their source code briefly but could not find how they do it.Thanks in advance. <code>  static Window Window { get { return Application.Current.MainWindow; } } /// <summary> /// TitleBar_MouseDown - Drag if single-click, resize if double-click /// </summary> private static void TitleBar_MouseDown(object sender, MouseButtonEventArgs e) { if (e.ChangedButton == MouseButton.Left) { if (e.ClickCount == 2) { AdjustWindowSize(); } else { Window.DragMove();//Here is where I do the drag move } } } /// <summary> /// Adjusts the WindowSize to correct parameters when Maximize button is clicked /// </summary> internal static void AdjustWindowSize() { if (Window.WindowState == WindowState.Maximized) { SystemCommands.RestoreWindow(Window); } else { SystemCommands.MaximizeWindow(Window); } } #region Button Events /// <summary> /// CloseButton_Clicked /// </summary> public static void Close() { SystemCommands.CloseWindow(Window); } /// <summary> /// MaximizedButton_Clicked /// </summary> public static void Maximize() { AdjustWindowSize(); } /// <summary> /// Minimized Button_Clicked /// </summary> public static void Minimize() { SystemCommands.MinimizeWindow(Window); } #endregion",Dragging custom window title bar from top when maximized does not work
Dragging window from top when maximized doesn't work with custom title bar," I have a custom title bar and with the window style set to none. On the click of the title bar I check to see if it is a double click (that does window maximize and restore) if it is not double clicked I do Window.DragMove. This works great for the snapping to the side and top. But when I try to drag the window when it is maximized (which would normally restore the window down), it doesn't do anything. Here is my code: Modern UI and MahApps.Metro does it somehow and I looked at their source code briefly but could not find how they do it.Thanks in advance. <code>  static Window Window { get { return Application.Current.MainWindow; } } /// <summary> /// TitleBar_MouseDown - Drag if single-click, resize if double-click /// </summary> private static void TitleBar_MouseDown(object sender, MouseButtonEventArgs e) { if (e.ChangedButton == MouseButton.Left) { if (e.ClickCount == 2) { AdjustWindowSize(); } else { Window.DragMove();//Here is where I do the drag move } } } /// <summary> /// Adjusts the WindowSize to correct parameters when Maximize button is clicked /// </summary> internal static void AdjustWindowSize() { if (Window.WindowState == WindowState.Maximized) { SystemCommands.RestoreWindow(Window); } else { SystemCommands.MaximizeWindow(Window); } } #region Button Events /// <summary> /// CloseButton_Clicked /// </summary> public static void Close() { SystemCommands.CloseWindow(Window); } /// <summary> /// MaximizedButton_Clicked /// </summary> public static void Maximize() { AdjustWindowSize(); } /// <summary> /// Minimized Button_Clicked /// </summary> public static void Minimize() { SystemCommands.MinimizeWindow(Window); } #endregion",Dragging custom window title bar from top when maximized does not work
What's wrong with my JWT signature?," I'm trying to implement the OpenID Connect specification for my organisation. I'm using Microsoft's OWIN implementation of OpenID Connect in a test relying party application to verify my implementation of the protocol.I've exposed the following metadata document: The signing key is exposed as this document: The identity token is being generated using the JwtSecurityToken class and its associated handler, using the X509SigningCredentials class. This code is representative of how the token is constructed and returned to the calling system as a parameter of the response data. When I attempt to pass the signed token back to the relying party application, the OWIN middleware accepts the POST and attempts to verify the signature of the token. In doing so, the following exception is thrown: SecurityTokenSignatureKeyNotFoundException: IDX10500: Signature validation failed. Unable to resolve SecurityKeyIdentifier: 'SecurityKeyIdentifier ( IsReadOnly = False, Count = 1, Clause[0] = X509ThumbprintKeyIdentifierClause(Hash = 0xF8A59280B3D13777CC7541B3218480984F421450) ) ', token: '{""typ"":""JWT"",""alg"":""RS256"",""x5t"":""-KWSgLPRN3fMdUGzIYSAmE9CFFA""}.{""iss"":""https://test.accesscontrol.net/"",""aud"":""test"",""nbf"":1404917162,""exp"":1404917462,""sub"":""60eb55ec-0699-4068-bfa6-41666fc2b2e9"",""iat"":""1404917162""} RawData: eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ii1LV1NnTFBSTjNmTWRVR3pJWVNBbUU5Q0ZGQSJ9.eyJpc3MiOiJodHRwczovL2Fjcy5zdXJlY2xvdWQuY29tLyIsImF1ZCI6InRlc3QiLCJuYmYiOjE0MDQ5MTcxNjIsImV4cCI6MTQwNDkxNzQ2Miwic3ViIjoiNjBlYjU1ZWMtMDY5OS00MDY4LWJmYTYtNDE2NjZmYzJiMmU5IiwiaWF0IjoiMTQwNDkxNzE2MiJ9.xkP0RwlX3CYfU0KhFsVvLJC94WK22DTqNTm71cfjiJ8VUHv3b2YhDqfq70N8mQEyiR8vTR6OQqnO6UqXqX4RXUs6ZkfK9Liv3n9NhCs97wJhP2jfefJYeScYtRmWcNNWSSL7vkm2JXQfwKOQTnOGp-ba04TtI6jVrjhOQXH43eCJ9vNuBUzdD-t8CAdmnbvH0nWpIB8kWbw5v8Sa0aQuxMjJYbLC_2Iw3X13dqnyVjp4fA7eSB8N7c1it0KEB-VKfUqiGD3VecyEZGGZbaGE8rvVet5QrY1lJ3V4yM8j6-xDc5Yndc4swOun0L3D6TYk-8gdVXUJDRjbv1ZuhZltsw'.The component is still pre-release, so this may be a flaw in the implementation, however I want to assume it's my error until all possibilities have been ruled out.Is there anything I'm doing which is obviously wrong, or is there something I should do to understand exactly why the signature is failing to be validated? <code>  { ""issuer"": ""https://acs.contoso.com/"", ""authorization_endpoint"": ""http://localhost:53615/oauth2/auth"", ""token_endpoint"": ""http://localhost:53615/oauth2/token"", ""userinfo_endpoint"": ""http://localhost:53615/connect/userinfo"", ""jwks_uri"": ""http://localhost:53615/connect/keys"", ""ui_locales_supported"": [ ""en-GB"" ]} { ""keys"": [ { ""n"": ""xpXxl3M-YkZlzQJdArO1TfOGT2no-UL4dbZ7WuSCNIsSfyGDaqUXjMMHNyq9yD3vp-NCyk8kmn7d5XqHufnceXJM8q4xTrhN3lvywdBSbR-dwXsA-B-MJVgfiK0d_z-mxP9ew2Hj9-KkWbWCzsswlWp3gZ4mB4RGutB1IRSzXVIbvZ-MtKUb6XUDU4LDb_c1xCEXWZxhR-o1a1dLfObH2hHJ-w5y6odGlKtOFx4i4h0u7-Oj5R6k5b2YXEHM0IuYeN0u0sQvrTecokntGzPrvhnKy69I7Z_az5rC5kgloh25D9lTbe4vcRU7FXlYCFYDZsT0_IkGIXRi7brOS4f1ow"", ""e"": ""AQAB"", ""kty"": ""RSA"", ""use"": ""sig"", ""alg"": ""RS256"", ""kid"": ""F8A59280B3D13777CC7541B3218480984F421450"" } ]} var credentials = new X509SigningCredentials(cert); // My certificate.var issuedTime = DateTime.UtcNow;var expiresTime = issuedTime.AddMinutes(5);var epoch = new DateTime(1970, 01, 01, 0, 0, 0);var claims = new[]{ new Claim(""sub"", Guid.NewGuid().ToString()), new Claim(""iat"" Math.Floor((issuedTime - epoch).TotalSeconds).ToString()), new Claim(""nonce"", nonce), // Value from client}var token = new JwtSecurityToken( ""https://acs.contoso.com"", client_id, // Value from client claims, new Lifetime(issuedTime, expiresTime), credentials);var handler = new JwtSecurityTokenHandler();parameters.Add(""id_token"", handler.WriteToken(token)); // Outgoing parameters.",SecurityTokenSignatureKeyNotFoundException when validating JWT signature
How do I initialize log4net for a UnitTest project?," I have a Visual Studio unit test project for testing an ASP.NET MVC project.Adding the assembly-level log4net.Config.XmlConfigurator attribute to AssemblyInfo.cs doesn't work and other people on SO have found they have to use a direct call to log4net.Config.XmlConfigurator.Configure();The question is, how can this be done for a unit test? The answer to use Microsoft.VisualStudio.TestTools.UnitTesting.AssemblyInitialize attribute on a class method doesn't work.For me, this code results in an InvalidOperationException logged in the output window and the test session bombs early. Reading the documentation, MSDN says not to use AssemblyInitialize on test projects for ASP.NET since they may be called more than once.So how can this be done so that log4net is configured before any tests are run? <code>  [TestClass]public sealed class Startup{ [AssemblyInitialize] public void Configure() { System.Diagnostics.Debug.Write(""Microsoft.VisualStudio.TestTools.UnitTesting.AssemblyInitialize""); }}",MSTest - How do I initialize log4net for a UnitTest project?
What is the need of Tostring() in C sharp?, I'm using the below code in c sharp. But both the WriteLine statements are giving the same result 25. Then what is the need for converting Tostring in c sharp? Is there any special purpose?  <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading.Tasks;namespace sample{ class Program { static void Main(string[] args) { int value = 25; Console.WriteLine(value.ToString()); Console.WriteLine(value); Console.ReadLine(); } }},What is the need of ToString() in C#?
Interface naming convention for async method," Consider the following interface and implementations. According to the Microsoft naming conventions, should the interface method be named GetAnswer or GetAnswerAsync? By convention, you append ""Async"" to the names of methods that have an Async or async modifier.The problem is that the first implementation uses the async modifier, indicating it should receive the ""Async"" method name suffix, but the second implementation does not use the async modifier, indicating it should not receive the ""Async"" method name suffix. The two method names in the implementations are forced to be the same by the interface, so I am forced to violate the naming conventions for one of the two classes.Note I'm not looking for opinionated answers. Consider it multiple choice. :)You should use the ""Async"" suffix because the naming conventions say so. (With reference.)You should not use the ""Async"" suffix because the naming conventions say so. (With reference.)The naming conventions don't say. (This will need to come from someone well-versed in them.) <code>  interface IService{ Task<string> GetAnswer(string question);}class SomeService : IService{ async Task<string> IService.GetAnswer(string question) { ... code using awaits ... }}class AnotherService : IService{ Task<string> IService.GetAnswer(string question) { return Task.FromResult(""I have no idea.""); }}",Interface naming convention for method returning Task
Fastest way to trim whitespace from the end of a StringBuilder, What is an efficient way to trim whitespace from the end of a StringBuilder without calling ToString().Trim() and back to a new SB new StringBuilder(sb.ToString().Trim()).  <code> ,Trim whitespace from the end of a StringBuilder without calling ToString().Trim() and back to a new SB
Most performant way to trim whitespace from the end of a StringBuilder, What is an efficient way to trim whitespace from the end of a StringBuilder without calling ToString().Trim() and back to a new SB new StringBuilder(sb.ToString().Trim()).  <code> ,Trim whitespace from the end of a StringBuilder without calling ToString().Trim() and back to a new SB
Should I migrate to Entity?," I've been using the SqlCommand class and writing my own T-SQL queries for a very long time. I've stuck with it because I'm comfortable with it, and it probably stemmed from me starting as a windows developer in the days before we had many other great options. I've been doing web development now for about 10 years, and still using it and writing my own query strings. I've written a dynamic class for all my database needs on the fly, all I have to do is write the T-SQL, which I can do quickly and use in any project.Other developers have got big eyed when they see my code, and encourage me to learn LINQ which I do not like at all.I'm starting a new project now in ASP.NET MVC and now feel like I should get out of the dinosaur days and move to Entity Framework to handle my data.I know that the SqlCommand class is the nuts and bolts of the Entity Framework behind the scenes, so I feel like why should I go through the middle man (entity) to achieve the same results and spend time learning something new.Can someone please explain to me why I need to move on, or if I should stick with what I know? <code> ",Should I migrate to Entity Framework?
"Is there a linq ""like"" operator in C#?"," I am rewriting a vb.net app and I can't claim to be great with vb. I need to write this equivilent in C#: I have so far: As you can see I am not sure what the equivalent of the like operator is. I ran this through a couple code converters and they constantly threw errors. <code>  Dim bigList = (From gme In dtx.gmc_message_elements Where gme.element_key_name Like ""*email"" _ Or gme.element_key_name Like ""*web"" Or gme.element_key_name Like ""*both"" _ Select gme.element_key_name Distinct).ToList() var bigList = (from gme in dtx.gmc_message_elements where gme.element_key_name Like ""*email"" || gme.element_key_name Like ""*web"" || gme.element_key_name Like ""*both"" select gme.element_key_name).FirstOrDefault().ToList();",Is there a VB.NET-Like operator in C#?
How to cancel C# winform button click event?," I have a custom button class inherited from System.Windows.Forms.Button.I want to use this button in my winform project.This class is called ""ConfirmButton"", and it shows confirm message with Yes or No.But the problem is that I do not know how to stop click event when user selected No with confirm message.Here is my class source. If user select No from confirm message, then the button click event should not fire anymore. <code>  using System;using System.ComponentModel;using System.Windows.Forms;namespace ConfirmControlTest{ public partial class ConfirmButton : System.Windows.Forms.Button { public Button() { InitializeComponent(); this.Click += Button_Click; } void Button_Click(object sender, EventArgs e) { DialogResult res = MessageBox.Show(""Would you like to run the command?"" , ""Confirm"" , MessageBoxButtons.YesNo ); if (res == System.Windows.Forms.DialogResult.No) { // I have to cancel button click event here } } }}",How to cancel winform button click event?
Always Running Threads with TPL on Windows Service," I'm writing a Windows Service that will kick off multiple worker threads that will listen to Amazon SQS queues and process messages. There will be about 20 threads listening to 10 queues.The threads will have to be always running and that's why I'm leaning towards to actually using actual threads for the worker loops rather than threadpool threads.Here is a top level implementation. Windows service will kick off multiple worker threads and each will listen to it's queue and process messages. Here is the implementation of the work I know I can perform the same operation with Task.Run and execute it on the threadpool thread rather than starting individual thread, but I don't see a reason for that since each thread will always be running.Do you see any problems with this implementation? How reliable would it be to leave threads always running in this fashion and what can I do to make sure that each thread is always running?  <code>  protected override void OnStart(string[] args){ for (int i = 0; i < _workers; i++) { new Thread(RunWorker).Start(); }} public async void RunWorker(){ while(true) { // .. get message from amazon sqs sync.. about 20ms var message = sqsClient.ReceiveMessage(); try { await PerformWebRequestAsync(message); await InsertIntoDbAsync(message); } catch(SomeExeception) { // ... log //continue to retry continue; } sqsClient.DeleteMessage(); }}",Always Running Threads on Windows Service
Is this cpp to C# translation correct?," I've the given condition from a cpp source. I want to translate this into C#.When I understand this right, this means as much as if activeFace is *not* in faces then... - not?So what would be the equivalent in C#?Note: I can't use faces.HasFlag(activeFace)Well it should be Am I right?For the completeness here the actual Flag enum Well It's the same in cpp, you just need to add a [Flags] attribute in C# <code>  if (!(faces & activeFace) || [...]) { ... } if ((faces & activeFace) == 0 || [...]) { ... } [Flags]enum Face { North = 1, East = 2, South = 4, West = 8, Top = 16, Bottom = 32};",Translating bitwise comparison from C++ to C#
optional parameters of reference types," I have this function that returns a reference type. Now, this function has two optional parameters both of which are instances of the DateTime class. The function is something like this: The error from VS is: Default parameter value for 'start' must be a compile-time constantOf course, the error applies to the second parameter and I perfectly understand what is happening.What I really want is to know if there is a way to go about this, that is, having optional parameters in the method. Right now, what I have done is to create an overload; I mean, I have created a parameterless function GetDate() and a two-parameter overload of it.This is not really a problem but I just want to know if there is a way to do it. <code>  public DateTime GetDate(DateTime start = DateTime.MinValue, DateTime end = DateTime.MinValue){ // Method body...}",How can I create an optional DateTime parameter?
How are claims persisted accross requests?," Both claim1 and claim2 are persisted across requests only for the time ClaimsIdentity user is logged in. In other words, when user logs out by calling SignOut(), the two claims are also removed and as such the next time this user logs in, it is no longer a member of these two claims ( I assume the two claims don't exist anymore )The fact that claim2 is persisted across requests ( even though authentication cookie was already created when claim2 was added to the user ) suggests that claims don't get persisted across requests via authentication cookie, but via some other means.So how are claims persisted across requests?EDIT:1) As far as I can tell, claims of type IdentityUserClaim are never persisted in a cookie? If my assumption is correct, is the reason why IdentityUserClaim instances aren't persisted in a cookie because it is assumed that these claims should be stored in a DB and as such could in subsequent requests be retrieved from a DB, while claims of type Claim usually aren't stored in a DB and hence why they need to be persisted in a cookie?2) If you'd like to have a deeper look how it all works, check out the source code of Katana ProjectI thought Asp.net Identity 2 was not part of the Katana project ( namely, I've seen people asking when will Microsoft release the source code for Asp.Net Identity, even though Katana source code is already available )?!thank you <code>  var user = UserManager.Find(...);ClaimsIdentity identity = UserManager.CreateIdentity( user, DefaultAuthenticationTypes.ApplicationCookie );var claim1 = new Claim( ClaimType = ClaimTypes.Country, ClaimValue = ""Arctica"", UserId = user.Id );identity.AddClaim(claim1);AuthenticationManager.SignIn( new AuthenticationProperties { IsPersistent = true }, identity );var claim2 = new Claim( ClaimType = ClaimTypes.Country, ClaimValue = ""Antartica"", UserId = user.Id );identity.AddClaim(claim2); var user = UserManager.Find(...);/* claim1 won't get persisted in a cookie */var claim1 = new IdentityUserClaim { ClaimType = ClaimTypes.Country, ClaimValue = ""Arctica"", UserId = user.Id };user.Claims.Add(claim1);ClaimsIdentity identity = UserManager.CreateIdentity( user, DefaultAuthenticationTypes.ApplicationCookie );AuthenticationManager.SignIn( new AuthenticationProperties { IsPersistent = true }, identity );",Persisting claims across requests
Disabling the Close-Button temorarily, I need to disable just the close button (minimize and maximize should be allowed) temporarily.Every solution I've tried disables all the buttons or just disables the close button permanently. Is there a way to do it temporarily? <code> ,Disabling the Close-Button temporarily
parsing integer value as datetime using c# mvc 4," I have date represented as integer like 20140820 and I want to parsing it as datetime, like 2014.08.20.Do I need to parse each integer value (2014)(08)(02) using index or is there simpler way? <code> ",Parsing Integer Value As Datetime
Rollbcak transaction with 2 dbcontexts in entityframework.use transactionScope or transactionbegin?," I have a 2 DbContext's that I call both of them in one form as you can see here: So I have a question: if some problems happen and my record saved by DbContext1 but not in DbContext2, I need to rollback my transaction.I searched and I found two methods: using BeginTransaction and TransactionScope. I am confused about which one I should use and what the differences between them are?I found something like this but i don;'t know how can i roll back this : Best regards <code>  dbcontext1.add(object); dbcontext1.save(); dbcontext2.add(object); dbcontext2.save(); using (TransactionScope scope = new TransactionScope()) { using (EFEntities1 dc = new EFEntities1()) { dc.USERS.Add(user); dc.SaveChanges(); } using (EFEntities2 dc = new EFEntities2()) { dc.USERS.Add(user); dc.SaveChanges(); } scope.complete();}",Rollback transaction with 2 DbContexts in Entity Framework. Use TransactionScope or TransactionBegin?
HttpClient does not serialize correctly," When calling HttpClient's extension method PostAsXmlAsync, it ignores the XmlRootAttribute on the class. Is this behaviour a bug?Test <code>  [Serializable][XmlRoot(""record"")]class Account { [XmlElement(""account-id"")] public int ID { get; set }}var client = new HttpClient();await client.PostAsXmlAsync(url, new Account())",HttpClient does not serialize XML correctly
Building C# Solution in Release mode using MsBuild.exe," I am able to build a solution using MSBuild.exe, but my issue is I can only manage to get it to build in DEBUG mode. I need to build my solution in Release mode using MSBUILD.Here is what I've tried and <code>  Process msbuild = Process.Start(""C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\MsBuild.exe"", solutionfilepath + "" /P:Config=Release""); Process msbuild = Process.Start(""C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\MsBuild.exe"", solutionfilepath + "" /P:Configuration=Release"");",Building C# Solution in Release mode using MSBuild.exe
Why CLR Exception FatalExecutionEngineError happens? (eazy to reproduce)," We are using a struct that encapsulates numeric values and I found out when the nullable version of this struct is used in an expression, a FatalExecutionEngineError happens: Additional information: The runtime has encountered a fatal error. The address of the error was at 0x729c1e04, on thread 0x52d8. The error code is 0xc0000005. This error may be a bug in the CLR or in the unsafe or non-verifiable portions of user code. Common sources of this bug include user marshaling errors for COM-interop or PInvoke, which may corrupt the stack.I am using Visual Studio Premium 2013 Update 3Here is the source code (C#, target .NET Framework 4.5): Note, adding this solves the issue, so it is not urgent, however I am very interested why this issue is actually happening. <code>  using System;using System.Globalization;namespace ConsoleApplication4{ public struct Number { ValueType _val; private Number(double val) { this._val = val; } public static implicit operator double(Number val) { return Convert.ToDouble(val._val, CultureInfo.InvariantCulture); } public static implicit operator Number(double val) { return new Number(val); } } class Program { static void Main(string[] args) { Number? b = 1.2; var c = b - 1.2; Number b1 = 1.2; var c1 = b1 - 1.2; } }} public static implicit operator double(Number? val){ return Convert.ToDouble(val.GetValueOrDefault()._val, CultureInfo.InvariantCulture);}",Why CLR Exception FatalExecutionEngineError happens?
Why CLR Exception FatalExecutionEngineError happens? (easy to reproduce)," We are using a struct that encapsulates numeric values and I found out when the nullable version of this struct is used in an expression, a FatalExecutionEngineError happens: Additional information: The runtime has encountered a fatal error. The address of the error was at 0x729c1e04, on thread 0x52d8. The error code is 0xc0000005. This error may be a bug in the CLR or in the unsafe or non-verifiable portions of user code. Common sources of this bug include user marshaling errors for COM-interop or PInvoke, which may corrupt the stack.I am using Visual Studio Premium 2013 Update 3Here is the source code (C#, target .NET Framework 4.5): Note, adding this solves the issue, so it is not urgent, however I am very interested why this issue is actually happening. <code>  using System;using System.Globalization;namespace ConsoleApplication4{ public struct Number { ValueType _val; private Number(double val) { this._val = val; } public static implicit operator double(Number val) { return Convert.ToDouble(val._val, CultureInfo.InvariantCulture); } public static implicit operator Number(double val) { return new Number(val); } } class Program { static void Main(string[] args) { Number? b = 1.2; var c = b - 1.2; Number b1 = 1.2; var c1 = b1 - 1.2; } }} public static implicit operator double(Number? val){ return Convert.ToDouble(val.GetValueOrDefault()._val, CultureInfo.InvariantCulture);}",Why CLR Exception FatalExecutionEngineError happens?
"C# How to pass object[] to Activator.CreateInstance(type, params object[])"," I have a class which contains an empty constructor and one that accepts an array of objects as its only parameter. Something like... This is the CreateInstance() method call that I use it throws System.MissingMethodException with an added message that reads""Constructor on type 'myClass' not found""The bit of research that I have done has always shown the method as being called Where arg1 and arg2 are types (string, int, bool) and not generic objects.How would I call this method with only the array of objects as its parameter list?Note: I have tried adding another variable to the method signature. Something like... and with this the code executed fine.I have also seen methods using reflection which were appropriate but I am particularly interested in this specific case. Why is this exception raised if the method signature does in fact match the passed parameters? <code>  public myClass(){ return; }public myClass(object[] aObj){ return; } object[] objectArray = new object[5];// Populate objectArray variableActivator.CreateInstance(typeof(myClass), objectArray); Activator.CreateInstance(typeof(myClass), arg1, arg2); public myClass(object[] aObj, bool notUsed){ return; }","How to pass object[] to Activator.CreateInstance(type, params object[])"
"How to pass object[] to Activator.CreateInstance(type, params object[])"," I have a class which contains an empty constructor and one that accepts an array of objects as its only parameter. Something like... This is the CreateInstance() method call that I use it throws System.MissingMethodException with an added message that reads""Constructor on type 'myClass' not found""The bit of research that I have done has always shown the method as being called Where arg1 and arg2 are types (string, int, bool) and not generic objects.How would I call this method with only the array of objects as its parameter list?Note: I have tried adding another variable to the method signature. Something like... and with this the code executed fine.I have also seen methods using reflection which were appropriate but I am particularly interested in this specific case. Why is this exception raised if the method signature does in fact match the passed parameters? <code>  public myClass(){ return; }public myClass(object[] aObj){ return; } object[] objectArray = new object[5];// Populate objectArray variableActivator.CreateInstance(typeof(myClass), objectArray); Activator.CreateInstance(typeof(myClass), arg1, arg2); public myClass(object[] aObj, bool notUsed){ return; }","How to pass object[] to Activator.CreateInstance(type, params object[])"
Windows Workflow Framewor AOP," Does Windows Workflow Foundation offer a way to intercept or decorate activities for purposes such as logging? For example to create logs for every activity entry and exit point (ideally including the activity name) without modifying all the existing project code. For example, I have a workflow with a single activity that prints ""Hello world"". Without making modification to the XAML file I would like to capture the entry and exit of the activity. I would like to print ""Entering Hello World Activity"" before entering the activity and after the activity has printed ""Hello World"", I would like to print ""Completed Hello World Activity"".Does Windows Workflow offer a mechanism for hooking into entry and exit of an activity?@Richard210363 has already added to the comments that this feature is supported by Windows Workflow Foundation - please can the users who chose to close this question consider reversing their decision as the question clearly has a very specific answer using the framework in question? <code> ",Intercepting/Decorating Activities in Windows Workflow
Windows Workflow Framework AOP," Does Windows Workflow Foundation offer a way to intercept or decorate activities for purposes such as logging? For example to create logs for every activity entry and exit point (ideally including the activity name) without modifying all the existing project code. For example, I have a workflow with a single activity that prints ""Hello world"". Without making modification to the XAML file I would like to capture the entry and exit of the activity. I would like to print ""Entering Hello World Activity"" before entering the activity and after the activity has printed ""Hello World"", I would like to print ""Completed Hello World Activity"".Does Windows Workflow offer a mechanism for hooking into entry and exit of an activity?@Richard210363 has already added to the comments that this feature is supported by Windows Workflow Foundation - please can the users who chose to close this question consider reversing their decision as the question clearly has a very specific answer using the framework in question? <code> ",Intercepting/Decorating Activities in Windows Workflow
Windows Workflow Framework and Interception/AOP," Does Windows Workflow Foundation offer a way to intercept or decorate activities for purposes such as logging? For example to create logs for every activity entry and exit point (ideally including the activity name) without modifying all the existing project code. For example, I have a workflow with a single activity that prints ""Hello world"". Without making modification to the XAML file I would like to capture the entry and exit of the activity. I would like to print ""Entering Hello World Activity"" before entering the activity and after the activity has printed ""Hello World"", I would like to print ""Completed Hello World Activity"".Does Windows Workflow offer a mechanism for hooking into entry and exit of an activity?@Richard210363 has already added to the comments that this feature is supported by Windows Workflow Foundation - please can the users who chose to close this question consider reversing their decision as the question clearly has a very specific answer using the framework in question? <code> ",Intercepting/Decorating Activities in Windows Workflow
cancellation token on Dapper," I'm using Dapper 1.31 from Nuget. I have this very simple code snippet, When I press F12 on QueryAsync, it points me to There is no CancellationToken on its signature. Questions: Why is the snippet completely buildable assuming that there is no compiler error on the whole solution?Forgive me that I cannot test if calling tokenSource.Cancel() would really cancel the method because I don't know how to generate a long running sql query. Will the .Cancel() really cancel the method and throw OperationCancelledException?Thank you! <code>  string connString = """";string query = """";int val = 0;CancellationTokenSource tokenSource = new CancellationTokenSource();using (IDbConnection conn = new SqlConnection(connString)){ conn.Open(); val = (await conn.QueryAsync<int>(query, tokenSource.Token)).FirstOrDefault();} public static Task<IEnumerable<T>> QueryAsync<T> ( this IDbConnection cnn, string sql, dynamic param = null, IDbTransaction transaction = null, int? commandTimeout = null, CommandType? commandType = null );",CancellationToken with async Dapper methods?
C# typedef of a function pointer," I'm converting code from C++ to C#. I have this line: Can I do that in C#? <code>  typedef bool (*proc)(int*, ...);","How to create a ""typedef to a function pointer"" in C#?"
What is it called when you edit an interface (C# example)," I am going through a LitJSON library. In the code there are lots of segments like For a method I know how overriding/overloading works but in the example above the code reads: int ICollection.CountI'm not familiar with that format for a method signature. Is the coder trying to explicitly state its the ICollection.Count interface? Could you explain what this is ""called"" (is it overriding still?).  <code>  public class JsonData : IJsonWrapper, IEquatable<JsonData> #region ICollection Properties int ICollection.Count { get { return Count; } } #end region",What is it called when you edit an interface?
"How to get Application Pool name through code (C3, ASP.net)", I want to recycle the application pool through my application.Previously I was storing the application pool name in my database and using that to recycle.But It happened in the past that we moved apps from one app pool to another and sometimes we forget to update the app pool name in the database.So I am thinking to get the app pool name through the application and use that for recycling. <code> ,"How to get Application Pool name through code (C#, ASP.net)"
Why Nullable cast doesn't fail but mine does," How can I implement a struct so that the following cast can be performed? My implementation should behave similarly to Nullable<T>, which works fine. However, this code fails with System.InvalidCastException: Result: Unable to cast object of type 'StatusedValue`1[System.Double]' to type 'StatusedValue`1[System.Int32]'. <code>  var a = new StatusedValue<double>(1, false);var b = (StatusedValue<int>)a; public struct StatusedValue<T> where T : struct{ public StatusedValue(T value) : this(value, true) { } public StatusedValue(T value, bool isValid) { this.value = value; this.isValid = isValid; } private T value; private bool isValid; public static implicit operator StatusedValue<T>(T value) { return new StatusedValue<T>(value); } public static explicit operator T(StatusedValue<T> value) { return value.value; }}",Why can't I cast one instantiation of a generic type to another?
C# Thread Detach / Joinable, Where are the C# Thread Detach / Joinable functions?In C++ 11 these functions are available: But they can't be found in .NET - where are they? <code>  thread::joinable()thread::detach(),Thread Detach / Joinable Methods
Why SignalR uses IList in it's contract everywhere instead of IEnumerable," I'm sending messages to individual users depending on their roles, to accomplish that I have the following piece of code: I'm not sure why do I have to invoke .ToList() each time I need to send something, my backing store is HashSet<String> and I want SignalR to work with that type of store instead of converting it to List each time since it would obviously consume processing power and memory.Since in the backstage SignalR is doing simple iteration over the argument users or connectionIds, wouldn't it be more wise to use IEnumerable instead of IList, I've looked into the SignalR sources, shouldn't be to hard to achieve? Is there a particular reason for using the IList?EditCreated an issue on SignalR github page, will have to wait for one of the actual devs in order to clear things out... <code>  public static void Add(Guid userId, IEnumerable<SnapshotItem> snapshot){ var hub = GlobalHost.ConnectionManager.GetHubContext<FeedbackHub>(); var items = ApplicationDbContext.Instance.InsertSnapshot(userId, Guid.NewGuid(), snapshot); foreach (var sendOperation in ConnectedUsers.Instance.EnumerateSendOperations(items)) { hub.Clients.Users(sendOperation.Groups.SelectMany(x => x.Users).Select(x => x.Id).ToList()).OnDataFeedback(sendOperation.Items); }}",Why does SignalR use IList in its contracts and everywhere in its internals instead of IEnumerable?
Why SignalR uses IList in it's contracts and everywhere in it's internals instead of IEnumerable?," I'm sending messages to individual users depending on their roles, to accomplish that I have the following piece of code: I'm not sure why do I have to invoke .ToList() each time I need to send something, my backing store is HashSet<String> and I want SignalR to work with that type of store instead of converting it to List each time since it would obviously consume processing power and memory.Since in the backstage SignalR is doing simple iteration over the argument users or connectionIds, wouldn't it be more wise to use IEnumerable instead of IList, I've looked into the SignalR sources, shouldn't be to hard to achieve? Is there a particular reason for using the IList?EditCreated an issue on SignalR github page, will have to wait for one of the actual devs in order to clear things out... <code>  public static void Add(Guid userId, IEnumerable<SnapshotItem> snapshot){ var hub = GlobalHost.ConnectionManager.GetHubContext<FeedbackHub>(); var items = ApplicationDbContext.Instance.InsertSnapshot(userId, Guid.NewGuid(), snapshot); foreach (var sendOperation in ConnectedUsers.Instance.EnumerateSendOperations(items)) { hub.Clients.Users(sendOperation.Groups.SelectMany(x => x.Users).Select(x => x.Id).ToList()).OnDataFeedback(sendOperation.Items); }}",Why does SignalR use IList in its contracts and everywhere in its internals instead of IEnumerable?
OpenGL Frustum Culling Clipping Too Soon," I just recently added frustum culling to my voxel game; it worked pretty well at first glance. However, I immediately noticed that the frustum seems to be a little offbeing that some voxels near the edge of the window are prematurely cut-off, before completely falling out of visual scope. Here is an image that illustrates my endeavor:And Here are three classes which will likely be needed to solve this problem.My FrustumWidget Class: My FirstPersonCameraWidget class: And Lastly, my GameClient class: Anyone know what the deal is here? Because I am stumped.EDIT:I just noticed that if I use a different detecting method (SphereInFrustum) everything seems to work perfectly; nothing is clipped prematurely. Here is my new renderloop: As you can see I am passing in a sphere radius of 1.5f, and basically pretending all my Voxels are spheres. It works, and there is no premature clipping, however I want to use my VoxelWithinFrustum method. Can anyone spot if I did something wrong with that method? Or if I am using the parameters incorrectly? <code>  using System;using OpenTK;namespace GameProject.Game.Client.Widgets { public class FrustumWidget { private float[] _clipMatrix = new float[ 16 ]; private float[ , ] _frustum = new float[ 6 , 4 ]; const int RIGHT = 0 , LEFT = 1 , BOTTOM = 2 , TOP = 3 , BACK = 4 , FRONT = 5; private void NormalizePlane( float[ , ] frustum , int side ) { float magnitude = ( float )Math.Sqrt( ( frustum[ side , 0 ] * frustum[ side , 0 ] ) + ( frustum[ side , 1 ] * frustum[ side , 1 ] ) + ( frustum[ side , 2 ] * frustum[ side , 2 ] ) ); frustum[ side , 0 ] /= magnitude; frustum[ side , 1 ] /= magnitude; frustum[ side , 2 ] /= magnitude; frustum[ side , 3 ] /= magnitude; } public bool SphereInFrustum( float x , float y , float z , float radius ) { float d = 0; for( int p = 0; p < 6; p++ ) { d = _frustum[ p , 0 ] * x + _frustum[ p , 1 ] * y + _frustum[ p , 2 ] * z + _frustum[ p , 3 ]; if( d <= -radius ) { return false; } } return true; } public bool VoxelWithinFrustum( float x1 , float y1 , float z1 , float x2 , float y2 , float z2 ) { for( int i = 0; i < 6; i++ ) { if( ( this._frustum[ i , 0 ] * x1 + this._frustum[ i , 1 ] * y1 + this._frustum[ i , 2 ] * z1 + this._frustum[ i, 3 ] <= 0.0F ) && ( this._frustum[ i , 0 ] * x2 + this._frustum[ i , 1 ] * y1 + this._frustum[ i , 2 ] * z1 + this._frustum[ i , 3 ] <= 0.0F ) && ( this._frustum[ i , 0 ] * x1 + this._frustum[ i , 1 ] * y2 + this._frustum[ i , 2 ] * z1 + this._frustum[ i , 3 ] <= 0.0F ) && ( this._frustum[ i , 0 ] * x2 + this._frustum[ i , 1 ] * y2 + this._frustum[ i , 2 ] * z1 + this._frustum[ i , 3 ] <= 0.0F ) && ( this._frustum[ i , 0 ] * x1 + this._frustum[ i , 1 ] * y1 + this._frustum[ i , 2 ] * z2 + this._frustum[ i , 3 ] <= 0.0F ) && ( this._frustum[ i , 0 ] * x2 + this._frustum[ i , 1 ] * y1 + this._frustum[ i , 2 ] * z2 + this._frustum[ i , 3 ] <= 0.0F ) && ( this._frustum[ i , 0 ] * x1 + this._frustum[ i , 1 ] * y2 + this._frustum[ i , 2 ] * z2 + this._frustum[ i , 3 ] <= 0.0F ) && ( this._frustum[ i , 0 ] * x2 + this._frustum[ i , 1 ] * y2 + this._frustum[ i , 2 ] * z2 + this._frustum[ i , 3 ] <= 0.0F ) ) { return false; } } return true; } public void CalculateFrustum( Matrix4 projectionMatrix , Matrix4 modelViewMatrix ) { _clipMatrix[ 0 ] = ( modelViewMatrix.M11 * projectionMatrix.M11 ) + ( modelViewMatrix.M12 * projectionMatrix.M21 ) + ( modelViewMatrix.M13 * projectionMatrix.M31 ) + ( modelViewMatrix.M14 * projectionMatrix.M41 ); _clipMatrix[ 1 ] = ( modelViewMatrix.M11 * projectionMatrix.M12 ) + ( modelViewMatrix.M12 * projectionMatrix.M22 ) + ( modelViewMatrix.M13 * projectionMatrix.M32 ) + ( modelViewMatrix.M14 * projectionMatrix.M42 ); _clipMatrix[ 2 ] = ( modelViewMatrix.M11 * projectionMatrix.M13 ) + ( modelViewMatrix.M12 * projectionMatrix.M23 ) + ( modelViewMatrix.M13 * projectionMatrix.M33 ) + ( modelViewMatrix.M14 * projectionMatrix.M43 ); _clipMatrix[ 3 ] = ( modelViewMatrix.M11 * projectionMatrix.M14 ) + ( modelViewMatrix.M12 * projectionMatrix.M24 ) + ( modelViewMatrix.M13 * projectionMatrix.M34 ) + ( modelViewMatrix.M14 * projectionMatrix.M44 ); _clipMatrix[ 4 ] = ( modelViewMatrix.M21 * projectionMatrix.M11 ) + ( modelViewMatrix.M22 * projectionMatrix.M21 ) + ( modelViewMatrix.M23 * projectionMatrix.M31 ) + ( modelViewMatrix.M24 * projectionMatrix.M41 ); _clipMatrix[ 5 ] = ( modelViewMatrix.M21 * projectionMatrix.M12 ) + ( modelViewMatrix.M22 * projectionMatrix.M22 ) + ( modelViewMatrix.M23 * projectionMatrix.M32 ) + ( modelViewMatrix.M24 * projectionMatrix.M42 ); _clipMatrix[ 6 ] = ( modelViewMatrix.M21 * projectionMatrix.M13 ) + ( modelViewMatrix.M22 * projectionMatrix.M23 ) + ( modelViewMatrix.M23 * projectionMatrix.M33 ) + ( modelViewMatrix.M24 * projectionMatrix.M43 ); _clipMatrix[ 7 ] = ( modelViewMatrix.M21 * projectionMatrix.M14 ) + ( modelViewMatrix.M22 * projectionMatrix.M24 ) + ( modelViewMatrix.M23 * projectionMatrix.M34 ) + ( modelViewMatrix.M24 * projectionMatrix.M44 ); _clipMatrix[ 8 ] = ( modelViewMatrix.M31 * projectionMatrix.M11 ) + ( modelViewMatrix.M32 * projectionMatrix.M21 ) + ( modelViewMatrix.M33 * projectionMatrix.M31 ) + ( modelViewMatrix.M34 * projectionMatrix.M41 ); _clipMatrix[ 9 ] = ( modelViewMatrix.M31 * projectionMatrix.M12 ) + ( modelViewMatrix.M32 * projectionMatrix.M22 ) + ( modelViewMatrix.M33 * projectionMatrix.M32 ) + ( modelViewMatrix.M34 * projectionMatrix.M42 ); _clipMatrix[ 10 ] = ( modelViewMatrix.M31 * projectionMatrix.M13 ) + ( modelViewMatrix.M32 * projectionMatrix.M23 ) + ( modelViewMatrix.M33 * projectionMatrix.M33 ) + ( modelViewMatrix.M34 * projectionMatrix.M43 ); _clipMatrix[ 11 ] = ( modelViewMatrix.M31 * projectionMatrix.M14 ) + ( modelViewMatrix.M32 * projectionMatrix.M24 ) + ( modelViewMatrix.M33 * projectionMatrix.M34 ) + ( modelViewMatrix.M34 * projectionMatrix.M44 ); _clipMatrix[ 12 ] = ( modelViewMatrix.M41 * projectionMatrix.M11 ) + ( modelViewMatrix.M42 * projectionMatrix.M21 ) + ( modelViewMatrix.M43 * projectionMatrix.M31 ) + ( modelViewMatrix.M44 * projectionMatrix.M41 ); _clipMatrix[ 13 ] = ( modelViewMatrix.M41 * projectionMatrix.M12 ) + ( modelViewMatrix.M42 * projectionMatrix.M22 ) + ( modelViewMatrix.M43 * projectionMatrix.M32 ) + ( modelViewMatrix.M44 * projectionMatrix.M42 ); _clipMatrix[ 14 ] = ( modelViewMatrix.M41 * projectionMatrix.M13 ) + ( modelViewMatrix.M42 * projectionMatrix.M23 ) + ( modelViewMatrix.M43 * projectionMatrix.M33 ) + ( modelViewMatrix.M44 * projectionMatrix.M43 ); _clipMatrix[ 15 ] = ( modelViewMatrix.M41 * projectionMatrix.M14 ) + ( modelViewMatrix.M42 * projectionMatrix.M24 ) + ( modelViewMatrix.M43 * projectionMatrix.M34 ) + ( modelViewMatrix.M44 * projectionMatrix.M44 ); _frustum[ RIGHT , 0 ] = _clipMatrix[ 3 ] - _clipMatrix[ 0 ]; _frustum[ RIGHT , 1 ] = _clipMatrix[ 7 ] - _clipMatrix[ 4 ]; _frustum[ RIGHT , 2 ] = _clipMatrix[ 11 ] - _clipMatrix[ 8 ]; _frustum[ RIGHT , 3 ] = _clipMatrix[ 15 ] - _clipMatrix[ 12 ]; NormalizePlane( _frustum , RIGHT ); _frustum[ LEFT , 0 ] = _clipMatrix[ 3 ] + _clipMatrix[ 0 ]; _frustum[ LEFT , 1 ] = _clipMatrix[ 7 ] + _clipMatrix[ 4 ]; _frustum[ LEFT , 2 ] = _clipMatrix[ 11 ] + _clipMatrix[ 8 ]; _frustum[ LEFT , 3 ] = _clipMatrix[ 15 ] + _clipMatrix[ 12 ]; NormalizePlane( _frustum , LEFT ); _frustum[ BOTTOM , 0 ] = _clipMatrix[ 3 ] + _clipMatrix[ 1 ]; _frustum[ BOTTOM , 1 ] = _clipMatrix[ 7 ] + _clipMatrix[ 5 ]; _frustum[ BOTTOM , 2 ] = _clipMatrix[ 11 ] + _clipMatrix[ 9 ]; _frustum[ BOTTOM , 3 ] = _clipMatrix[ 15 ] + _clipMatrix[ 13 ]; NormalizePlane( _frustum , BOTTOM ); _frustum[ TOP , 0 ] = _clipMatrix[ 3 ] - _clipMatrix[ 1 ]; _frustum[ TOP , 1 ] = _clipMatrix[ 7 ] - _clipMatrix[ 5 ]; _frustum[ TOP , 2 ] = _clipMatrix[ 11 ] - _clipMatrix[ 9 ]; _frustum[ TOP , 3 ] = _clipMatrix[ 15 ] - _clipMatrix[ 13 ]; NormalizePlane( _frustum , TOP ); _frustum[ BACK , 0 ] = _clipMatrix[ 3 ] - _clipMatrix[ 2 ]; _frustum[ BACK , 1 ] = _clipMatrix[ 7 ] - _clipMatrix[ 6 ]; _frustum[ BACK , 2 ] = _clipMatrix[ 11 ] - _clipMatrix[ 10 ]; _frustum[ BACK , 3 ] = _clipMatrix[ 15 ] - _clipMatrix[ 14 ]; NormalizePlane( _frustum , BACK ); _frustum[ FRONT , 0 ] = _clipMatrix[ 3 ] + _clipMatrix[ 2 ]; _frustum[ FRONT , 1 ] = _clipMatrix[ 7 ] + _clipMatrix[ 6 ]; _frustum[ FRONT , 2 ] = _clipMatrix[ 11 ] + _clipMatrix[ 10 ]; _frustum[ FRONT , 3 ] = _clipMatrix[ 15 ] + _clipMatrix[ 14 ]; NormalizePlane( _frustum , FRONT ); } }} using System;using System.Drawing;using OpenTK;using GameProject.Game.Framework.OpenTKExtensions;using OpenTK.Graphics.OpenGL;using OpenTK.Input;namespace GameProject.Game.Client.Widgets { public class FirstPersonCameraWidget { public Matrix4 CameraMatrix; public Vector3 Location; public FrustumWidget Frustum; public float Pitch; public float Yaw; public float MoveSpeed; public float LookSpeed; public Vector2 MouseSpeed; public bool IsLooking; public float NearZ; public float FarZ; public FirstPersonCameraWidget(Vector3 cameraOrigin , float pitch , float yaw , float movementSpeed , float lookSpeed ) { CameraMatrix = Matrix4.Identity; this.Location = cameraOrigin; this.Pitch = pitch; this.Yaw = yaw; this.LookSpeed = lookSpeed; this.MoveSpeed = movementSpeed; Frustum = new FrustumWidget(); } public void Update() { if( IsLooking ) { // Possible redundant method? } } public void ProcessMovement( KeyboardState keyboardState , FrameEventArgs e ) { if( keyboardState[ Key.W ] ) { MoveForward( e ); } if( keyboardState[ Key.S ] ) { MoveBackward( e ); } if( keyboardState[ Key.A ] ) { StrafeLeft( e ); } if( keyboardState[ Key.D ] ) { StrafeRight( e ); } if( keyboardState[ Key.Space ] ) { FlyUp( e ); } if( keyboardState[ Key.LShift ] || keyboardState[ Key.RShift ] ) { FlyDown( e ); } } public void MoveForward( FrameEventArgs e ) { Location.X += ( float )Math.Cos( Yaw ) * MoveSpeed * ( float )e.Time; //CameraPosition.Y += ( float )Math.Tan( Pitch ) * MoveSpeed * ( float )e.Time; Location.Z += ( float )Math.Sin( Yaw ) * MoveSpeed * ( float )e.Time; } public void MoveBackward( FrameEventArgs e ) { Location.X -= ( float )Math.Cos( Yaw ) * MoveSpeed * ( float )e.Time; //CameraPosition.Y -= ( float )Math.Tan( Pitch ) * MoveSpeed * ( float )e.Time; Location.Z -= ( float )Math.Sin( Yaw ) * MoveSpeed * ( float )e.Time; } public void StrafeLeft( FrameEventArgs e ) { Location.X -= ( float )Math.Cos( Yaw + Math.PI / 2 ) * MoveSpeed * ( float )e.Time; Location.Z -= ( float )Math.Sin( Yaw + Math.PI / 2 ) * MoveSpeed * ( float )e.Time; } public void StrafeRight( FrameEventArgs e ) { Location.X += ( float )Math.Cos( Yaw + Math.PI / 2 ) * MoveSpeed * ( float )e.Time; Location.Z += ( float )Math.Sin( Yaw + Math.PI / 2 ) * MoveSpeed * ( float )e.Time; } public void FlyUp( FrameEventArgs e ) { Location.Y += MoveSpeed * ( float )e.Time; } public void FlyDown( FrameEventArgs e ) { Location.Y -= MoveSpeed * ( float )e.Time; } public void LookThrough( GameWindow window , Point mouseLocation , FrameEventArgs e ) { if( IsLooking ) { Point windowCenter = new Point( window.Bounds.Left + window.Bounds.Width / 2 , window.Bounds.Top + window.Bounds.Height / 2 ); Vector2 MouseDelta = new Vector2( mouseLocation.X - window.PointToClient( windowCenter ).X , mouseLocation.Y - window.PointToClient( windowCenter ).Y ); System.Windows.Forms.Cursor.Position = windowCenter; MouseSpeed.X *= LookSpeed; MouseSpeed.Y *= LookSpeed; MouseSpeed.X += MouseDelta.X / 40.0f * ( float )e.Time; MouseSpeed.Y += MouseDelta.Y / 40.0f * ( float )e.Time; Yaw += MouseSpeed.X; Pitch -= MouseSpeed.Y; if( Pitch <= -( ( OpenTKExtensions.HalfPI * 2 ) * 0.5f ) + 0.01f ) { Pitch = -( ( OpenTKExtensions.HalfPI * 2 ) * 0.5f ) + 0.01f; } if( Pitch >= ( ( OpenTKExtensions.HalfPI * 2 ) * 0.5f ) - 0.01f ) { Pitch = ( ( OpenTKExtensions.HalfPI * 2 ) * 0.5f ) - 0.01f; } } Vector3 LookAtPoint = new Vector3( ( float )Math.Cos( Yaw ) , ( float )Math.Tan( Pitch ) , ( float )Math.Sin( Yaw ) ); CameraMatrix = Matrix4.LookAt( Location , Location + LookAtPoint , Vector3.UnitY ); /** * Recalculate the Viewport Frustum */ Matrix4 projection = new Matrix4(); GL.GetFloat(GetPName.ProjectionMatrix, out projection); Matrix4 modelview = new Matrix4(); GL.GetFloat(GetPName.ModelviewMatrix, out modelview); Frustum.CalculateFrustum(projection,modelview); } }} using System;using System.Collections.Generic;using System.Drawing;using System.Threading.Tasks;using GameProject.Game.Framework.DataStructure;using GameProject.Game.Framework.Generators;using GameProject.Game.Framework.Geometry;using System.Diagnostics;using GameProject.Game.Framework.OpenGLExtensions;using OpenTK;using OpenTK.Graphics;using OpenTK.Graphics.OpenGL;using OpenTK.Input;using GameProject.Game.Client.Widgets;using QuickFont;namespace GameProject.Game.Client { public class GameClient : GameWindow { /** * Client Variables */ public const String CLIENT_VERSION = ""v0.0.1""; public const String GAME_NAME = ""Voxelbyte""; public FirstPersonCameraWidget GameCamera; private Point _mousePosition; private Point _lastMousePosition; private bool _centerCursorAfterRelease = false; /** * Game Variables */ public VoxelWorld World; public List<GameSelection> SelectionMemory; public QFont DeveloperText; public GameClient() : base( 800 , 600 , GraphicsMode.Default , GAME_NAME ) { GL.Enable( EnableCap.DepthTest ); GL.ClearColor( 0.3f , 0.3f , 0.3f , 0.0f ); } protected override void OnLoad( EventArgs e ) { base.OnLoad( e ); DeveloperText = new QFont( ""Resources/Fonts/times.ttf"" , 14 , FontStyle.Regular ); //TestFont.Options.UseDefaultBlendFunction = false; //this.VSync = VSyncMode.On; SelectionMemory = new List<GameSelection>(); GameCamera = new FirstPersonCameraWidget( new Vector3( 30.0f , 8.0f , 30.0f ) , 0.0f , 0.0f , 15.0f , 0.4f ); //this.WindowState = WindowState.Fullscreen; GL.CullFace( CullFaceMode.Back ); GL.Enable( EnableCap.CullFace ); GL.BlendFunc( BlendingFactorSrc.SrcAlpha , BlendingFactorDest.OneMinusSrcAlpha ); GL.Enable( EnableCap.Blend ); // Generate Map And Log the Time World = BattleWorldReader.ReadFromImage( ""ColoredPyramid.png"" ); Stopwatch sw = new Stopwatch(); sw.Start(); World.Rebuild(); sw.Stop(); Console.WriteLine( ""World Generation+Optimization took: {0}ms"" , sw.ElapsedMilliseconds ); //GLExtensions.EnableWireframe(); } protected override void OnMouseMove( MouseMoveEventArgs e ) { base.OnMouseMove( e ); _mousePosition = new Point( e.X , e.Y ); if( e.Mouse.IsButtonDown( MouseButton.Right ) ) { } } protected override void OnMouseDown( MouseButtonEventArgs e ) { base.OnMouseDown( e ); if( e.Mouse.IsButtonDown( MouseButton.Right ) ) { Point nativeMouse = System.Windows.Forms.Cursor.Position; _lastMousePosition = nativeMouse; Point windowCenter = new Point( Bounds.Left + Bounds.Width / 2 , Bounds.Top + Bounds.Height / 2 ); System.Windows.Forms.Cursor.Position = windowCenter; GameCamera.IsLooking = true; this.CursorVisible = false; } } protected override void OnMouseUp( MouseButtonEventArgs e ) { base.OnMouseUp( e ); if( e.Button == MouseButton.Right ) { GameCamera.IsLooking = false; if( !_centerCursorAfterRelease ) { System.Windows.Forms.Cursor.Position = _lastMousePosition; } this.CursorVisible = true; } } protected override void OnRenderFrame( FrameEventArgs e ) { base.OnRenderFrame( e ); GameCamera.LookThrough( this , _mousePosition , e ); GL.MatrixMode( MatrixMode.Modelview ); GL.Clear( ClearBufferMask.ColorBufferBit | ClearBufferMask.DepthBufferBit ); GL.LoadMatrix( ref GameCamera.CameraMatrix ); // // GL.EnableClientState( ArrayCap.VertexArray ); GL.EnableClientState( ArrayCap.TextureCoordArray ); GL.DisableClientState( ArrayCap.ColorArray ); int numberOfVoxelsRendered = 0; foreach( Voxel voxel in World.Voxels ) { if( GameCamera.Frustum.VoxelWithinFrustum( voxel.Location.X, voxel.Location.Y, voxel.Location.Z, 1.0f,1.0f,1.0f ) ) { voxel.Render( GameCamera ); numberOfVoxelsRendered++; } } GL.DisableClientState( ArrayCap.VertexArray ); GL.DisableClientState( ArrayCap.TextureCoordArray ); GL.DisableClientState( ArrayCap.ColorArray ); // Render Dev Hud RenderDeveloperHud(); // SwapBuffers(); this.Title = GAME_NAME + "" FPS: "" + ( int )this.RenderFrequency + "" Voxels: "" + numberOfVoxelsRendered; } private void RenderDeveloperHud() { QFont.Begin(); GL.PushMatrix(); GL.Translate( 0.0f , 5 , 0f ); DeveloperText.Print( ""Voxelbyte"" ); GL.Translate( 0f , 30 , 0f ); DeveloperText.Print( ""X: "" + ( int )GameCamera.Location.X ); GL.Translate( 0f , 24 , 0f ); DeveloperText.Print( ""Y: "" + ( int )GameCamera.Location.Y ); GL.Translate( 0.0f , 24 , 0f ); DeveloperText.Print( ""Z: "" + ( int )GameCamera.Location.Z ); GL.PopMatrix(); QFont.End(); } private void CheckKeyboardInput( FrameEventArgs eventArgs ) { KeyboardState keyboardState = OpenTK.Input.Keyboard.GetState(); GameCamera.ProcessMovement( keyboardState , eventArgs ); if( keyboardState[ Key.Escape ] ) { Exit(); } } protected override void OnUpdateFrame( FrameEventArgs e ) { CheckKeyboardInput( e ); } protected override void OnResize( EventArgs e ) { base.OnResize( e ); GL.Viewport( ClientRectangle.X , ClientRectangle.Y , ClientRectangle.Width , ClientRectangle.Height ); Matrix4 projection = Matrix4.CreatePerspectiveFieldOfView( ( float )Math.PI / 4 , Width / ( float )Height , 0.1f , 1000.0f ); GL.MatrixMode( MatrixMode.Projection ); GL.LoadMatrix( ref projection ); } }} foreach( Voxel voxel in World.Voxels ) { if( voxel.IsVisible() ) { if( GameCamera.Frustum.SphereInFrustum( voxel.Location.X , voxel.Location.Y , voxel.Location.Z , 1.5f ) ) { voxel.Render( GameCamera ); numberOfVoxelsRendered++; } } }",OpenTK/OpenGL Frustum Culling Clipping Too Soon
TopShelf Lambda Issues," I recently discovered TopShelf. From everything I have read, it looks very cool. The only problem is that I have not been able to use it. I have to have missed something. Below is my code. You can see that it is a bit incomplete. When I am trying to set properties of the 's' object for ConstructUsing, WhenStarted, and WhenStopped Visual Studio is not inferring the correct type. I am new to lambda expressions and even newer to TopShelf, so I am not sure what I am doing. I am using this page in the TopShelf documentation to get me started. It looks pretty straight forward, so I am not sure what I have missed.updated code <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading.Tasks;using Topshelf;namespace TestTopShelf {public class FooBar { public FooBar() { } public void Start() { } public void Stop() { }}public class Program { public static void Main() { HostFactory.Run(x => { x.Service<FooBar>( s => { }); }); }}} using Autofac;using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading.Tasks;using Topshelf;namespace KeithLink.Svc.Windows.OrderService2 {class FooBar { public FooBar() { } public void Start() { } public void Stop() { }}class Program { static void Main(string[] args) { HostFactory.Run(x => { x.Service<FooBar>(s => { s.ConstructUsing(name => new OrderService()); s.WhenStarted(os => os.Start()); s.WhenStopped(os => os.Stop()); }); x.RunAsLocalSystem(); x.SetDescription(""some service description""); x.SetServiceName(""ServiceName""); x.SetDisplayName(""Service Display Name""); }); }}}",How to get started with TopShelf
Why returning dataset or data table from WCF service is not a good practice?What is the Alternative," I am working on University Management System on which I am using a WCF service and in the service I am using DataTables and DataSets for getting data from database and database is sql server.My questions are Is using DataTables and Datasets ""Good Practice"" or ""Bad Practice"" ?If it is bad, what is the alternative of DataTable/DataSet ?If it is bad, what are the main reasons ? <code> ",Why returning dataset or data table from WCF service is not a good practice? What are the Alternatives?
AddOrUpdate not retrieving existing data for update," This might be a simple question, however I'm new to Code First and Migrations so bear with me. I'll keep sample code to a minimum to show the problem:I have a BaseAuditableEntity which includes this (among other things, but let's simplify): Now a (for example) User POCO inherits from it: I have this on my context's SaveChanges method, to fill in the CreatedOn and LastModified dates (simplified): And now I have a migration in place that seeds some users, like this: Now I have a problem on seeding with AddOrUpdate after the migration. When the entity is new (it's being added), CreatedOn gets filled correctly and everything works as expected. However when the entity is modified (it already exists on the database and UserName matches), it tries to update it with the new entity I'm creating... this fails because CreatedOn has an invalid DateTime (in this case, DateTime.MinValue).Is there any way to use the AddOrUpdate method so that it actually retrieves the matching entity from the database and just update the non-default fields? Or maybe some way to tell it which fields NOT to update? For this specific case, I'd like the CreatedOn field to be unchanged, but a generic solution would be appreciated.Maybe I should do my own AddOrUpdate method which includes a predicate with the fields I want to change, instead of passing it a completely new entity?This is EF 6.1UpdateI know I can easily solve this for the CreatedOn date, this is what I'm currently doing for this specific case: I am looking for a more generic solution though <code>  public abstract class BaseAuditableEntity : BaseEntity, IAuditableEntity{ public DateTime CreatedOn { get; set; } public DateTime LastModified { get; set; }} public class User : BaseAuditableEntity{ public string UserName { get; set; } public string PasswordHash { get; set; } public string FullName { get; set; } public string Email { get; set; } public bool Active { get; set; } public DateTime? LastLogin { get; set; }} public override int SaveChanges(){ var changeSet = ChangeTracker.Entries<IAuditableEntity>(); if (changeSet != null) { foreach (var entry in changeSet.Where(p => p.State != EntityState.Unchanged)) { var now = DateTime.UtcNow; if (entry.State == EntityState.Added) entry.Entity.CreatedOn = now; entry.Entity.LastModified = now; } } return base.SaveChanges();} protected override void Seed(MyContext context){ context.Users.AddOrUpdate( p => p.UserName, new User { Active = true, FullName = ""My user name"", UserName = ""ThisUser"", PasswordHash = """", Email = ""my@email"", LastLogin = null, } // etc. );} foreach (var entry in changeSet.Where(c => c.State != EntityState.Unchanged)){ var now = DateTime.UtcNow; if (entry.State == EntityState.Added) { entry.Entity.CreatedOn = now; } else { if (entry.Property(p => p.CreatedOn).CurrentValue == DateTime.MinValue) { var original = entry.Property(p => p.CreatedOn).OriginalValue; entry.Property(p => p.CreatedOn).CurrentValue = original != SqlDateTime.MinValue ? original : now; entry.Property(p => p.CreatedOn).IsModified = true; } } entry.Entity.LastModified = now;}",Making AddOrUpdate change only some properties
Check if string is valid represantion of HEX number," I am total noob regarding regex.My goal is to check whether a string is a valid representation of a hex number.Currently my implementation (which I find really inefficient) is having a List with all hex digits (0-9, A-F) and checking whether my string contains characters not contained in given List.I bet this can be easily done using regular expressions but I have no idea how to implement it. <code>  private bool ISValidHEX(string s){ List<string> ToCheck = new List<string>(); for (int i = 0; i < 10; i++) { ToCheck.Add(i.ToString()); } ToCheck.Add(""A""); ToCheck.Add(""B""); ToCheck.Add(""C""); ToCheck.Add(""D""); ToCheck.Add(""E""); ToCheck.Add(""F""); for (int i = 0; i < s.Length; i++) { if( !ToCheck.Contains(s.Substring(i,1))) { return false; } } return true;}",Check if string is valid representation of hex number
Generate c# model class from csv file," The goal here is that after inputing csv file, a magic tool would output c# class with the fields from csv. Let's look at example.Input myFile.csv: Output myFile.cs So, the only thing I would need to fix is the types of properties. After that I would use this class with FileHelpers to read csv file. Later it would be mapped to EntityFramework class (using AutoMapper) and saved to database.Actually, https://csv2entity.codeplex.com/ looks like is doing what I need, but it just doesn't work - I installed it and nothing changed in my Visual studio, no new template appeared. The project is totally dead. Opened source code and ... decided maybe I'll just ask this question in stackoverflow :)FileHelpers has only a simple wizard, which allows you to manually add fields. But I have 50 fields and this is not the last time I will need to do it, so automated solution is preferred here.I believe this problem is solved many times before, any help? <code>  Year,Make,Model1997,Ford,E3502000,Mercury,Cougar public class myFile{ public string Year; public string Make; public string Model;}",Generate c# model class from csv file structure
How to write array of doubles to a file very fast in C#?," I want to write something like this to a file: And unfortunately this code's process last very long!(in this example about 10 seconds!)The file format is binary.How can I make that faster? <code>  FileStream output = new FileStream(""test.bin"", FileMode.Create, FileAccess.ReadWrite);BinaryWriter binWtr = new BinaryWriter(output);double [] a = new double [1000000]; //this array fill completefor(int i = 0; i < 1000000; i++){ binWtr.Write(a[i]);}",How to write an array of doubles to a file very fast in C#?
How to write an array of doubles to a file very fast in C#?," I want to write something like this to a file: And unfortunately this code's process last very long!(in this example about 10 seconds!)The file format is binary.How can I make that faster? <code>  FileStream output = new FileStream(""test.bin"", FileMode.Create, FileAccess.ReadWrite);BinaryWriter binWtr = new BinaryWriter(output);double [] a = new double [1000000]; //this array fill completefor(int i = 0; i < 1000000; i++){ binWtr.Write(a[i]);}",How to write an array of doubles to a file very fast in C#?
Program keep timing out," I have a C# program which runs a stored procedure. If I run the stored procedure from Microsoft sql server management studio, it works fine. It does take about 30 seconds to execute. However, if I try to run the same stored procedure from a C# program, it times out, even though I have set the timeout in the connection string to 10 minutes. It seem to time out after about 30 seconds, even though I have set it to allow 10 minutes (for testing purposes). <code>  using (connection1 = new SqlConnection(""user id=user_id_goes_here;password=password_goes_here;initial catalog=database_name_goes_here;data source=server_name_goes_here;connection timeout=600))",How do I prevent a timeout error when executing a store procedure using a SqlCommand?
"Best Practice for binding to a ""selected object"" in WPF / C#"," Let's say that you have an observable collection of object type Foo, and you have a custom ListView that the user will select from.Your bound data object: In XAML: Is it more appropriate to bind to the SelectedIndex in XAML and create the following in your data object: Or to create this and bind to the SelectedItem in XAML: And why? <code>  // property with getter / setter / INotifyPropertyChangedObservableCollection<Foo> MyCollection; <ListView ItemsSource={Binding MyCollection} /> int SelectedIndex { get; set; } // also raising property changed notificationsFoo SelectedObject{ get { return MyCollection[SelectedIndex]; }} Foo SelectedObject { get; set; } // also raising property changed notifications",Binding SelectedItem vs SelectedIndex - When should I choose one over the other?
How to return FileContentResult in ASP.NET WebAPI," In a regular MVC controller, we can output pdf with a FileContentResult. But how can we change it into an ApiController? Here is what I've tried but it doesn't seem to work. The returned result displayed in the browser is: And there is a similar post on SO: Returning binary file from controller in ASP.NET Web API. It talks about output an existing file. But I could not make it work with a stream.Any suggestions? <code>  public FileContentResult Test(TestViewModel vm){ var stream = new MemoryStream(); //... add content to the stream. return File(stream.GetBuffer(), ""application/pdf"", ""test.pdf"");} [HttpPost]public IHttpActionResult Test(TestViewModel vm){ //... return Ok(pdfOutput);} [HttpGet]public IHttpActionResult Test(){ var stream = new MemoryStream(); //... var content = new StreamContent(stream); content.Headers.ContentType = new MediaTypeHeaderValue(""application/pdf""); content.Headers.ContentLength = stream.GetBuffer().Length; return Ok(content); } {""Headers"":[{""Key"":""Content-Type"",""Value"":[""application/pdf""]},{""Key"":""Content-Length"",""Value"":[""152844""]}]}",How to return a file (FileContentResult) in ASP.NET WebAPI
Getting Current HttpContext in JAX-RS," I have classes auto-generated in NetBeans with RESTful template from entities, with CRUD functions (annotated with POST, GET, PUT, DELETE). I have a problem with create method, which after inserting an entity from the frontend, I would like create to update a response so that my view will automatically (or asynchronously, if that's the right term) reflect the added entity.I came across this (example) line of code but written in C# (of which I know nothing about): Using JAX-RS in Java, is there anyway to get the current HttpContext just like in C# and to manipulate the header?The closest I came about is and this one certainly is not working. It seems I need to get the current HttpContext before building the Response. Thanks for your help. <code>  HttpContext.Current.Response.AddHeader(""Location"", ""api/tasks"" +value.Id); Response.ok(entity).header(""Location"", ""api/tasks"" + value.Id);",Create Response with Location header in JAX-RS
How can i realize pattern promise/deffered?, I want to write a pattern Promise/Deffered.Perfect variant in end is: I've found this implementation https://bitbucket.org/mattkotsenas/c-promises/overview and https://gist.github.com/cuppster/3612000. But how can I use it to solve my task??? <code>  MyObject().CallMethodReturningPromise() .done( result => { ...something doing; } ) .fail( error => { ...error handle; } ) .always( () => { ...some code; } ),How can I realize pattern promise/defered?
how to convert text to hour in excel using epplus object," I need my excel output to have a column with time in format HH:mm.My code is the following: But when I open the file in excel, the cell displays ""10:10:00"".When I insert text in the formula bar and click enter, the cell text is changed to ""10:10"", which is what I want.I've also tried using: I get ""10:10"" displayed in the cell but the formula bar displays today's full date with the hour 10:10.Additionally, I tried: Which shows ""10:10"" in the cell but the formula bar displays the whole date and time as ""22/08/2014 10:10:00"". <code>  ws.Cells[rowNumber, 11].Style.Numberformat.Format = ""hh:mm"";string start = row.R_HourStart.ToString(""HH:mm:ss"");ws.Cells[rowNumber, 11].Value = start; ws.Cells[rowNumber, 11].Style.Numberformat.Format = ""hh:mm"";string start = row.R_HourStart.ToString(""HH:mm:ss"");ws.Cells[rowNumber, 11].LoadFromText(start); ws.Cells[rowNumber, 12].Style.Numberformat.Format = ""hh:mm"";ws.Cells[rowNumber, 12].Value = row.R_HourEnd;",How do I convert a string based time to hh:mm format in excel using EPPlus?
PBKDF2 python keys vs .NET Rfc2898," I am trying to write a Python module that will encrypt text that our existing .NET classes can decrypt. As far as I can tell, my code lines, up but it isn't decrypting (I get an 'Invalid padding length' error on the C# side). My pkcs7 code looks good, but research indicates that invalid keys could cause this same problem.What's different between these two setups? Python: I thought that based_secret could get passed up to C# and decoded there. But it fails. The same encrypting c# code is: The Python pkcs7 implementation I'm using is:https://gist.github.com/chrix2/4171336 <code>  derived_key = PBKDF2(crm_key, salt, 256 / 8, iterations)iv = PBKDF2(crm_key, salt, 128 / 8, iterations)encoder = pkcs7.PKCS7Encoder()cipher = AES.new(derived_key, AES.MODE_CBC, iv)decoded = cipher.decrypt(encoded_secret)#encode - just stepped so i could debug. padded_secret = encoder.encode(secret) # 1encodedtext = cipher.encrypt(padded_secret) # 2based_secret = base64.b64encode(encodedtext) # 3 var rfc = new Rfc2898DeriveBytes(key, saltBytes); // create provider & encryptor using (var cryptoProvider = new AesManaged()) { // Set cryptoProvider parameters cryptoProvider.BlockSize = cryptoProvider.LegalBlockSizes[0].MaxSize; cryptoProvider.KeySize = cryptoProvider.LegalKeySizes[0].MaxSize; cryptoProvider.Key = rfc.GetBytes(cryptoProvider.KeySize / 8); cryptoProvider.IV = rfc.GetBytes(cryptoProvider.BlockSize / 8); using (var encryptor = cryptoProvider.CreateEncryptor()) { // Create a MemoryStream. using (var memoryStream = new MemoryStream()) { // Create a CryptoStream using the MemoryStream and the encryptor. using (var cryptoStream = new CryptoStream(memoryStream, encryptor, CryptoStreamMode.Write)) { // Convert the passed string to a byte array. var valueBytes = Encoding.UTF8.GetBytes(plainValue); // Write the byte array to the crypto stream and flush it. cryptoStream.Write(valueBytes, 0, valueBytes.Length); cryptoStream.FlushFinalBlock(); // Get an array of bytes from the // MemoryStream that holds the // encrypted data. var encryptBytes = memoryStream.ToArray(); // Close the streams. cryptoStream.Close(); memoryStream.Close(); // Return the encrypted buffer. return Convert.ToBase64String(encryptBytes); } } }",PBKDF2 Python keys vs .NET Rfc2898
Asp + Mvc .NET. URL Paramter encoding," I have a controller in an MVC 4 .NET application that receives a string as a parameter from an URL. This comes from an aspx page redirected to the controller in Route.config.If I send this value for the parameter in the client: fwdgerhb+bhrth+ftrgbhrtI get the following value at the server: fwdgerhb bhrth ftrgbhrtThe server is interpreting the URL parameter value as an encoded URL and replaces + by . But it has not been URL encoded. This will occur for other combinations of special chars if they appear in the parameter value.Is there a config parameter in IIS Server to configure the server to not try to URL-decode this value?Example Request: Route Config The controller: <code>  mypage.aspx?value=cat+dog (NOT ENCODED) static void RegisterRoutes(RouteCollection routes){ routes.MapRouteLowercase( name: ""MyRouter"", url: ""mypage.aspx"", defaults: new { controller = ""My"", action = ""DoLog"" } );} public class MyController : Controller{ [AllowAnonymous] public ActionResult DoLog(string value) { //Here value has ""cat dog"" }}",URL Parameter encoding in MVC .NET
"WP8.1 C# CookieAware WebClient with multiple Websites to load, also its async"," Using the silverlight Windows Phone 8.1 ProjectI'm trying to load data from a website. I have to authenticate at that site first however.So I do a post to the Website, using a lightly modified version of the CookieAwareWebClient from here. Now I make a WebClient send a POST with Username and Password and continue getting my sites async and processing the site data in my DownloadStringCompleted-EventHandler.So far so good.Now I want to expand on that and get multiple websites.I don't have to get them all at once, in fact it would be better to get them one after another.But I don't know how to go at this.My code so far: What I tryed / What I expected / What did block that:My first thought was to let everything happen async and use await on all the requests.So I did my research and found that WebClient has an new async/await implementation.WebClient.DownloadStringTaskAsync however I can't find this method in my WebClient, so I assume there isn't an impementation for WP8.1 atm.2nd idea was to use the HttpClient.GetStringAsync(URI) methode which I use already and which supports async/await.As I said, I need a Cookie to go with the request, so I did my research and found this.However I can't find a HttpClientHandler and also no HttpClient.CookieContainer or equal attributes.I also tried waiting for one site to complete and then going to the next, but tbo I blocked my GUI thread and didn't want to struggle with writing the whole eventhandlers in separate threads and I don't know how to do so efficiently <code>  class CookieAwareWebClient : WebClient{ public CookieContainer Cookies = new CookieContainer(); protected override WebRequest GetWebRequest(Uri address) { var request = base.GetWebRequest(address); if (request is HttpWebRequest) (request as HttpWebRequest).CookieContainer = Cookies; return request; }} using System;using System.Net;using System.Text.RegularExpressions;using System.Threading.Tasks;using System.Windows;using System.Windows.Controls;using Windows.Web.Http;using Microsoft.Phone.Shell;using StackOverflowApp.Resources;namespace StackOverflowApp{ public partial class MainPage { private const string URL_DATES = @""/subsite/dates""; private const string URL_RESULTS = @""/subsite/results""; private readonly ApplicationBarIconButton btn; private int runningOps = 0; //Regex's to parse websites private readonly Regex regexDates = new Regex(AppResources.regexDates); private readonly Regex regexResults = new Regex(AppResources.regexResults); private readonly CookieAwareWebClient client = new CookieAwareWebClient(); private int status; // Konstruktor public MainPage() { InitializeComponent(); btn = ((ApplicationBarIconButton)ApplicationBar.Buttons[0]); // = application/x-www-form-urlencoded client.Headers[HttpRequestHeader.ContentType] = AppResources.ContentType; client.UploadStringCompleted += UploadStringCompleted; client.DownloadStringCompleted += DownloadStringCompleted; } private void GetSite() { const string POST_STRING = ""name={0}&password={1}""; var settings = new AppSettings(); if (settings.UsernameSetting.Length < 3 || settings.PasswordSetting.Length < 3) { MessageBox.Show( (settings.UsernameSetting.Length < 3 ? ""Bitte geben Sie in den Einstellungen einen Benutzernamen ein\r\n"" : string.Empty) + (settings.PasswordSetting.Length < 3 ? ""Bitte geben Sie in den Einstellungen ein Kennwort ein\r\n"" : string.Empty) ); return; } LoadingBar.IsEnabled = true; LoadingBar.Visibility = Visibility.Visible; client.UploadStringAsync( new Uri(AppResources.BaseAddress + ""subsite/login""), ""POST"", string.Format(POST_STRING, settings.UsernameSetting, settings.PasswordSetting)); } private void LoadDates() { status = 0; //Termine runningOps++; client.DownloadStringAsync(new Uri(AppResources.BaseAddress + URL_DATES)); } private void LoadResults() { status = 1; //Ergebnisse runningOps++; client.DownloadStringAsync(new Uri(AppResources.BaseAddress + URL_RESULTS)); } private void DownloadStringCompleted(object sender, DownloadStringCompletedEventArgs e) { runningOps--; if (runningOps == 0) { //alle Operationen sind fertig LoadingBar.IsEnabled = false; LoadingBar.Visibility = Visibility.Collapsed; btn.IsEnabled = true; } if (e.Cancelled || e.Error != null) return; //Antwort erhalten var source = e.Result.Replace(""\r"", """").Replace(""\n"", """"); switch (status) { case 0: //Termine geladen foreach (Match match in regexDates.Matches(source)) { var tb = new TextBlock(); var g = match.Groups; tb.Text = string.Format( ""{1} {2} {3}{0}{4} {5}{0}{6}"", Environment.NewLine, g[1].Value, g[2].Captures.Count > 0 ? g[2].Value : string.Empty, g[3].Captures.Count > 0 ? ""- "" + g[3].Value : string.Empty, g[5].Value, g[6].Captures.Count > 0 ? ""bei "" + g[6].Value : string.Empty, ( g[7].Captures.Count > 0 ? g[7].Value : string.Empty ) + ( g[8].Captures.Count > 0 ? g[8].Value != g[4].Value ? g[8].Value + "" != "" + g[4].Value : g[8].Value : g[4].Captures.Count > 0 ? g[4].Value : string.Empty ) ); DatesPanel.Children.Add(tb); } break; case 1: //Ergebnisse geladen foreach (Match match in regexResults.Matches(source)) { var tb = new TextBlock(); var g = match.Groups; tb.Text = string.Format( ""{1} {2} {3}{0}{4} {5}{0}{6}"", Environment.NewLine, g[1].Value, g[2].Captures.Count > 0 ? g[2].Value : string.Empty, g[3].Captures.Count > 0 ? ""- "" + g[3].Value : string.Empty, g[5].Value, g[6].Captures.Count > 0 ? ""bei "" + g[6].Value : string.Empty, ( g[7].Captures.Count > 0 ? g[7].Value : string.Empty ) + ( g[8].Captures.Count > 0 ? g[8].Value != g[4].Value ? g[8].Value + "" != "" + g[4].Value : g[8].Value : g[4].Captures.Count > 0 ? g[4].Value : string.Empty ) ); ResultsPanel.Children.Add(tb); } break; default: return; } } void UploadStringCompleted(object sender, UploadStringCompletedEventArgs e) { //Login completed LoadDates(); //THIS WOULD YIELD AN ERROR FROM THE WEBCLIENT SAYING IT ISNT SUPPORTING MULTIPLE ASYNC ACTIONS //LoadResults(); } private async void ClickOnRefresh(object sender, EventArgs e) { var isUp = await IsUp(); if (isUp) GetSite(); else MessageBox.Show(""Die Seite ist down! :(""); } private void ClickOnSettings(object sender, EventArgs e) { NavigationService.Navigate(new Uri(""/Settings.xaml"", UriKind.Relative)); } private async Task<bool> IsUp() { btn.IsEnabled = false; const string ISUPMELINK = ""http://www.isup.me/{0}""; var data = await RequestData(string.Format(ISUPMELINK, AppResources.BaseAddress.Replace(""https://"", string.Empty))); var isUp = !data.Contains(""It's not just you!""); btn.IsEnabled = true; return isUp; } private async void ClickOnTestConnection(object sender, EventArgs e) { var isUp = await IsUp(); MessageBox.Show(string.Format(""Die Seite ist {0}! :{1}"", isUp ? ""up"" : ""down"", isUp ? "")"" : ""("")); } private static async Task<string> RequestData(string url) { using (var httpClient = new HttpClient()) return await httpClient.GetStringAsync(new Uri(url)); } }}",How can I retrieve multiple websites asynchronously?
How to get returned value of async Task<string> methdoName()?," I'm trying to get the return string of my method but the problem is I don't know how can I get the return value from public async Task<string> Login(string username, string password, string site).This is my codes from Program.cs This is my codes from Saba Controller.cs <code>  static void Main(string[] args){ var username = ""Leonel.Sarmiento""; var password = ""welcome""; var site = ""QADBSite""; var url = ""na1.sabacloud.com""; ConsoleCustomizer.Spinner Spinner = new ConsoleCustomizer.Spinner(""+"", ""x"", ""+"", ""x""); ConsoleCustomizer.TypeWriter TypeWriter = new ConsoleCustomizer.TypeWriter(15, 150); ConsoleCustomizer.Alerts Alerts = new ConsoleCustomizer.Alerts(); Alerts.Write(""Information"", ""HOST URL:"", null); TypeWriter.WriteLine(@""http:\\""+url); Alerts.Write(""Information"", ""USERNAME:"", null); TypeWriter.WriteLine(username); Alerts.Write(""Information"", ""PASSWORD:"", null); for (var i = 0; i < password.Length; i++) { TypeWriter.Write(""*""); } Console.WriteLine(""""); SabaController saba = new SabaController(url); //var certificate = saba.Login(username, password, site).Wait(); saba.Login(username, password, site).Wait(); Console.Read();} public async Task<string> Login(string username, string password, string site){ using(var client = new HttpClient()) { client.BaseAddress = new Uri(""https://"" + HostURL + ""/""); client.DefaultRequestHeaders.Accept.Clear(); client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue(""application/json"")); client.DefaultRequestHeaders.Add(""user"", username); client.DefaultRequestHeaders.Add(""password"", password); client.DefaultRequestHeaders.Add(""site"", site); //HTTP GET: saba/api/login HttpResponseMessage response = await client.GetAsync(""Saba/api/login""); if (response.IsSuccessStatusCode) { SabaModel saba = await response.Content.ReadAsAsync<SabaModel>(); SabaCertificate = saba.Certificate; } } return SabaCertificate;}",How to get returned value of async Task<string> method name()?
How to get returned value of async Task<string> methodname()?," I'm trying to get the return string of my method but the problem is I don't know how can I get the return value from public async Task<string> Login(string username, string password, string site).This is my codes from Program.cs This is my codes from Saba Controller.cs <code>  static void Main(string[] args){ var username = ""Leonel.Sarmiento""; var password = ""welcome""; var site = ""QADBSite""; var url = ""na1.sabacloud.com""; ConsoleCustomizer.Spinner Spinner = new ConsoleCustomizer.Spinner(""+"", ""x"", ""+"", ""x""); ConsoleCustomizer.TypeWriter TypeWriter = new ConsoleCustomizer.TypeWriter(15, 150); ConsoleCustomizer.Alerts Alerts = new ConsoleCustomizer.Alerts(); Alerts.Write(""Information"", ""HOST URL:"", null); TypeWriter.WriteLine(@""http:\\""+url); Alerts.Write(""Information"", ""USERNAME:"", null); TypeWriter.WriteLine(username); Alerts.Write(""Information"", ""PASSWORD:"", null); for (var i = 0; i < password.Length; i++) { TypeWriter.Write(""*""); } Console.WriteLine(""""); SabaController saba = new SabaController(url); //var certificate = saba.Login(username, password, site).Wait(); saba.Login(username, password, site).Wait(); Console.Read();} public async Task<string> Login(string username, string password, string site){ using(var client = new HttpClient()) { client.BaseAddress = new Uri(""https://"" + HostURL + ""/""); client.DefaultRequestHeaders.Accept.Clear(); client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue(""application/json"")); client.DefaultRequestHeaders.Add(""user"", username); client.DefaultRequestHeaders.Add(""password"", password); client.DefaultRequestHeaders.Add(""site"", site); //HTTP GET: saba/api/login HttpResponseMessage response = await client.GetAsync(""Saba/api/login""); if (response.IsSuccessStatusCode) { SabaModel saba = await response.Content.ReadAsAsync<SabaModel>(); SabaCertificate = saba.Certificate; } } return SabaCertificate;}",How to get returned value of async Task<string> method name()?
Get Windows power plans/schemes in C# (using C++ ??)," I'm interested in getting all power plans that you have in your computer using C#. I was thinking you might be able to use the API PowerEnumerate function in some way: But I have no idea on how to as I really don't know C. So.. How can I like, enumerate through all available power plans and create a a list of them. I then want to be able to access each power plans GUID and their ""user friendly name"".So.. Perhaps if someone who is good at using the WinAPI from C# who would like to help, that would be great - or if someone has a better solution. I've really tried to find a good answer to this but there doesn't seem to be any. I think this would help a lot of people.Can anyone help with this? <code>  DWORD WINAPI PowerEnumerate( _In_opt_ HKEY RootPowerKey, _In_opt_ const GUID *SchemeGuid, _In_opt_ const GUID *SubGroupOfPowerSettingsGuid, _In_ POWER_DATA_ACCESSOR AccessFlags, _In_ ULONG Index, _Out_opt_ UCHAR *Buffer, _Inout_ DWORD *BufferSize);",Get Windows power plans/schemes in C# (using WinAPI)
"After updating Mvvm Light to Version 5, what changes do I need to maket for RelayCommand CanExecute() to work?"," I updated Mvvm Light to version 5 and noticed that RelayCommand stopped working. The problem seems to be that the CanExecute() is not being called to validate. It only validates one time, like when the window is loaded. Could this be a bug from the recent update or is there something I need to change in the XAML?Everything was working correctly before the update. I'm working with WPF. <code> ","After updating Mvvm Light to Version 5, what changes do I need to make RelayCommand CanExecute() work?"
Different timeout for different requests for the same service," I have a WCF service with https bindings and a callback. The service is referenced in the client as a service reference. The timeouts are defined in the config files for both the service and the client. I need a function in the service to be called with smaller time-out values than the default value used for the other functions.The code for my client looks like following How can I change my code in the client/server to use smaller timeout values for requests to specific functions? Can I specify and change the timeouts in the code according to the function which I am calling? <code>  MyService.MyServiceClient myServiceClient = new MyService.MyServiceClient(context);myServiceClient.GenericSendData(""Save Req"", serializedString, ServerIdentifier, null);",Different timeouts for different requests to the same WCF service
Difference between greedy and non-greedy dataflow block with boundedcapacity defined," I have a BatchBlock with BoundedCapacity defined on it So if the queue capacity reaches a 100 the block postpones every message received until a spot becomes available.In this case is the batch queue considered greedy or non-greedy ? <code>  var _batchBlock = new BatchBlock<int>(2, new GroupingDataflowBlockOptions {BoundedCapacity = 100 });",Difference between a greedy and a non-greedy dataflow block with boundedcapacity defined
Best and efficient way to test equality of two IEnumerable<T>," Ok, I need to test if two IEnumerable<T> are equal. The order of the elements is important, which means that: I've seen a few answers on this site explaining how to do this with linq: for example, hereThe problem is that I have to repeatedly test for equality of pretty big collections (thousands of elements) that have a high probability of not being equal, so performance is a factor to bear in mind. The way I see it, all the linq methods shown in the referred answer (Count or Except) need to, if I'm not mistaken, iterate through the whole collection which in the general case is not necessary.I came up with this code, which works reasonably well (I think) and is fast enough. I was wondering if I'm missing some obvious built in way of doing this (I don't want to reinvent the wheel here if possible.) <code>  {1, 2, 4, 1, 3} and {1, 2, 1, 3, 4} should not be equal. public static bool IsEqualTo<T>(this IEnumerable<T> inner, IEnumerable<T> other) where T: IEquatable<T> { if (inner == null) throw new ArgumentNullException(); if (object.ReferenceEquals(inner, other)) return true; if (object.ReferenceEquals(other, null)) return false; using (var innerEnumerator = inner.GetEnumerator()) using (var otherEnumerator = other.GetEnumerator()) { while (innerEnumerator.MoveNext()) { if (!otherEnumerator.MoveNext() || !innerEnumerator.Current.Equals(otherEnumerator.Current)) return false; } return !otherEnumerator.MoveNext(); } }",Algorithm for testing inequality of ordered large collections
Visual Studio 2013: ASP.NET Web API Login method," I'm wanting to build a RESTful web service using ASP.NET Web API that third-party developers will use to access my application's data. In Visual Studio I decided to create a new ASP.NET project. I followed this tutorial but I choose a different template: Web API template. I use a MySQL database with the standard user role tables as explained in the tutorial.The template come with many very interesting methods to register a new user but there is no default Login request. I wrote this without understanding what I'm doing: I've read quite a lot about security without finding a good sample with documentation explaining how it works. It seems to be incredibly difficult to implement a simple login method in Web API.Could you explain me why there is no login method in this template. Do you have an sample of login method. And what should I sent back to the client application to authenticate the request. Is this working with a token ? <code>  // POST api/Account/Login [Route(""Login"")] public IHttpActionResult Login(LoginBindingModel model) { ClaimsIdentity ci = new ClaimsIdentity(); // ... // ... Authentication.SignIn(ci); return Ok(); }",ASP.NET Web API Login method
"How get Event ""item choosed"" in AutoComplete C#?"," I have code using an AutoCompleteStringCollection: How can I get the event for ""item selected"" after user selects an AutoComplete suggestion? And value of field? <code>  private void txtS_TextChanged(object sender, EventArgs e) { TextBox t = sender as TextBox; string[] arr = this.dbService.GetAll(); if (t != null) { if (t.Text.Length >= 3) { AutoCompleteStringCollection collection = new AutoCompleteStringCollection(); collection.AddRange(arr); this.txtSerial.AutoCompleteCustomSource = collection; } } }","How get Event ""item Selected"" with AutoComplete in C#?"
c# async when returning lambdas, I've just realised that this code: ...will not work as async methods cannot await LINQ expressions. I've did some searches but only managed to find some overcomplicated solutions. How should functions which return LINQ expressions be converted to async versions? <code>  public async Task<List<Review>> GetTitleReviews(int titleID) { using (var context = new exampleEntities()) { return await context.Reviews.Where(x => x.Title_Id == titleID).ToList(); } },c# async when returning LINQ
Struggling to get started on C# assignment," For this assignment I need to do some stuff with a BankAccount program, but first I need to copy the get the example running. I've copied the code from the assignment sheet exactly as shown in the screenshots below, but I'm getting the errors shown below. I have no idea what's causing these errors as I don't think I've used a double once, and a very quick Google of the errors didn't help me. . <code>  Error 2 Argument 1: cannot convert from 'double' to 'decimal' Line 13 Column 51Error 1 The best overloaded method match for 'BankAccount.BankAccount.BankAccount(decimal)' has some invalid arguments Line 13 Column 35 Error 4 Argument 1: cannot convert from 'double' to 'decimal' Line 13 Column 30 Error 3 The best overloaded method match for 'BankAccount.BankAccount.Withdraw(decimal)' has some invalid arguments Line 18 Column 13 using System;using System.Collections.Generic;using System.Linq;using System.Text;namespace BankAccount{ class Program { static void Main(string[] args) { // Create Bank Account & Print Balance BankAccount account = new BankAccount(142.50); Console.WriteLine(""Account Balance is: "" + account.ToString()); // Withdraw 30.25 Console.WriteLine(""Withdrawing 30.25""); account.Withdraw(30.25); // Print balance again Console.WriteLine(""Account Balance is: "" + account.ToString()); } } using System;using System.Collections.Generic;using System.Linq;using System.Text;namespace BankAccount{ public class BankAccount { private decimal _balance; public decimal Balance { get { return _balance; } private set { _balance = value; } } //Constructor: Constructs a new Bank Account with 0 balance public BankAccount() { Balance = 0; } //Constructor: Constructs a new Bank Account with the specified balance public BankAccount(decimal balance) { Balance = balance; } //Deposits the specified amount into the Bank Account public void Deposit(decimal amount) { Balance += amount; } //Withdraws the specified amount from the Bank Account public void Withdraw(decimal amount) { Balance -= amount; } //ToString Override public override string ToString() { return string.Format(""{0}: Balance = {1}"", ""BankAccount"", Balance); } }}",Cannot convert from double to decimal error
"PayTrace Poodle The client and server cannot communicate, because they do not possess a common algorithm"," I have an issue with a C# PayTrace Gateway. The below code was working fine until yesterday when I believe they turned off SSL3 due to the Poodle Exploit. When running the code below we got the following message. The remote server has forcefully closed the connection. After doing some research on the problem we determined that because our IIS Server 7.5 was configured to still use SSL3, C# defaulted to SSL3, which PayTrace would forcibly close the connection. We then removed SSL3 from the server. Which then lead to the following error: The client and server cannot communicate, because they do not possess a common algorithm. My guess is that there are additional SSL algorithm we need to install on the server now that SSL 3 is removed. Our IT staff claims that TLS 1.1 and TLS 1.2 are working and that ASP.NET should be now defaulting to those. But I feel like there still must be something else we need to install on the server, I have no knowledge of SSL Algorithms so I have no idea where to begin. Also, just an FYI, this issue is also happening when we connect to First Data E4 gateway so it's not just a PayTrace thing. My guess is that as more gateways turn off access to SSL3 we'll continue to run into issues with other gateways until this can be resolved on the server. Also, I did find a few suggestions online, some suggested placing the following code right before making the outbound request: Unfortunately that did not work either, same error. Which is why I'm thinking something additional needs to be installed on the IIS7.5 server. I'm just not sure what.  <code>  var postUrl = new StringBuilder();//Initialize url with configuration and parameter values...postUrl.AppendFormat(""UN~{0}|"", this.MerchantLoginID);postUrl.AppendFormat(""PSWD~{0}|"", this.MerchantTransactionKey);postUrl.Append(""TERMS~Y|METHOD~ProcessTranx|TRANXTYPE~Sale|""); postUrl.AppendFormat(""CC~{0}|"", cardNumber);postUrl.AppendFormat(""EXPMNTH~{0}|"", expirationMonth.PadLeft(2, '0'));postUrl.AppendFormat(""EXPYR~{0}|"", expirationYear);postUrl.AppendFormat(""AMOUNT~{0}|"", transactionAmount);postUrl.AppendFormat(""BADDRESS~{0}|"", this.AddressLine1);postUrl.AppendFormat(""BADDRESS2~{0}|"", this.AddressLine2);postUrl.AppendFormat(""BCITY~{0}|"", this.City);postUrl.AppendFormat(""BSTATE~{0}|"", this.State);postUrl.AppendFormat(""BZIP~{0}|"", this.Zip);postUrl.AppendFormat(""SADDRESS~{0}|"", this.AddressLine1);postUrl.AppendFormat(""SADDRESS2~{0}|"", this.AddressLine2);postUrl.AppendFormat(""SCITY~{0}|"", this.City);postUrl.AppendFormat(""SSTATE~{0}|"", this.State);postUrl.AppendFormat(""SZIP~{0}|"", this.Zip);if (!String.IsNullOrEmpty(this.Country)){ postUrl.AppendFormat(""BCOUNTRY~{0}|"", this.Country);}if (!String.IsNullOrEmpty(this.Description)){ postUrl.AppendFormat(""DESCRIPTION~{0}|"", this.Description);}if (!String.IsNullOrEmpty(this.InvoiceNumber)){ postUrl.AppendFormat(""INVOICE~{0}|"", this.InvoiceNumber);}if (this.IsTestMode){ postUrl.AppendFormat(""TEST~Y|"");}//postUrl.Append();WebClient wClient = new WebClient();ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls;String sRequest = ""PARMLIST="" + Url.Encode(postUrl.ToString());wClient.Headers.Add(""Content-Type"", ""application/x-www-form-urlencoded"");string sResponse = """";sResponse = wClient.UploadString(PayTraceUrl, sRequest); ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls;","The client and server cannot communicate, because they do not possess a common algorithm - ASP.NET C# IIS TLS 1.0 / 1.1 / 1.2 - Win32Exception"
"The client and server cannot communicate, because they do not possess a common algorithm"," I have an issue with a C# PayTrace Gateway. The below code was working fine until yesterday when I believe they turned off SSL3 due to the Poodle Exploit. When running the code below we got the following message. The remote server has forcefully closed the connection. After doing some research on the problem we determined that because our IIS Server 7.5 was configured to still use SSL3, C# defaulted to SSL3, which PayTrace would forcibly close the connection. We then removed SSL3 from the server. Which then lead to the following error: The client and server cannot communicate, because they do not possess a common algorithm. My guess is that there are additional SSL algorithm we need to install on the server now that SSL 3 is removed. Our IT staff claims that TLS 1.1 and TLS 1.2 are working and that ASP.NET should be now defaulting to those. But I feel like there still must be something else we need to install on the server, I have no knowledge of SSL Algorithms so I have no idea where to begin. Also, just an FYI, this issue is also happening when we connect to First Data E4 gateway so it's not just a PayTrace thing. My guess is that as more gateways turn off access to SSL3 we'll continue to run into issues with other gateways until this can be resolved on the server. Also, I did find a few suggestions online, some suggested placing the following code right before making the outbound request: Unfortunately that did not work either, same error. Which is why I'm thinking something additional needs to be installed on the IIS7.5 server. I'm just not sure what.  <code>  var postUrl = new StringBuilder();//Initialize url with configuration and parameter values...postUrl.AppendFormat(""UN~{0}|"", this.MerchantLoginID);postUrl.AppendFormat(""PSWD~{0}|"", this.MerchantTransactionKey);postUrl.Append(""TERMS~Y|METHOD~ProcessTranx|TRANXTYPE~Sale|""); postUrl.AppendFormat(""CC~{0}|"", cardNumber);postUrl.AppendFormat(""EXPMNTH~{0}|"", expirationMonth.PadLeft(2, '0'));postUrl.AppendFormat(""EXPYR~{0}|"", expirationYear);postUrl.AppendFormat(""AMOUNT~{0}|"", transactionAmount);postUrl.AppendFormat(""BADDRESS~{0}|"", this.AddressLine1);postUrl.AppendFormat(""BADDRESS2~{0}|"", this.AddressLine2);postUrl.AppendFormat(""BCITY~{0}|"", this.City);postUrl.AppendFormat(""BSTATE~{0}|"", this.State);postUrl.AppendFormat(""BZIP~{0}|"", this.Zip);postUrl.AppendFormat(""SADDRESS~{0}|"", this.AddressLine1);postUrl.AppendFormat(""SADDRESS2~{0}|"", this.AddressLine2);postUrl.AppendFormat(""SCITY~{0}|"", this.City);postUrl.AppendFormat(""SSTATE~{0}|"", this.State);postUrl.AppendFormat(""SZIP~{0}|"", this.Zip);if (!String.IsNullOrEmpty(this.Country)){ postUrl.AppendFormat(""BCOUNTRY~{0}|"", this.Country);}if (!String.IsNullOrEmpty(this.Description)){ postUrl.AppendFormat(""DESCRIPTION~{0}|"", this.Description);}if (!String.IsNullOrEmpty(this.InvoiceNumber)){ postUrl.AppendFormat(""INVOICE~{0}|"", this.InvoiceNumber);}if (this.IsTestMode){ postUrl.AppendFormat(""TEST~Y|"");}//postUrl.Append();WebClient wClient = new WebClient();ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls;String sRequest = ""PARMLIST="" + Url.Encode(postUrl.ToString());wClient.Headers.Add(""Content-Type"", ""application/x-www-form-urlencoded"");string sResponse = """";sResponse = wClient.UploadString(PayTraceUrl, sRequest); ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls;","The client and server cannot communicate, because they do not possess a common algorithm - ASP.NET C# IIS TLS 1.0 / 1.1 / 1.2 - Win32Exception"
"The client and server cannot communicate, because they do not possess a common algorithm ASP.NET C# IIS"," I have an issue with a C# PayTrace Gateway. The below code was working fine until yesterday when I believe they turned off SSL3 due to the Poodle Exploit. When running the code below we got the following message. The remote server has forcefully closed the connection. After doing some research on the problem we determined that because our IIS Server 7.5 was configured to still use SSL3, C# defaulted to SSL3, which PayTrace would forcibly close the connection. We then removed SSL3 from the server. Which then lead to the following error: The client and server cannot communicate, because they do not possess a common algorithm. My guess is that there are additional SSL algorithm we need to install on the server now that SSL 3 is removed. Our IT staff claims that TLS 1.1 and TLS 1.2 are working and that ASP.NET should be now defaulting to those. But I feel like there still must be something else we need to install on the server, I have no knowledge of SSL Algorithms so I have no idea where to begin. Also, just an FYI, this issue is also happening when we connect to First Data E4 gateway so it's not just a PayTrace thing. My guess is that as more gateways turn off access to SSL3 we'll continue to run into issues with other gateways until this can be resolved on the server. Also, I did find a few suggestions online, some suggested placing the following code right before making the outbound request: Unfortunately that did not work either, same error. Which is why I'm thinking something additional needs to be installed on the IIS7.5 server. I'm just not sure what.  <code>  var postUrl = new StringBuilder();//Initialize url with configuration and parameter values...postUrl.AppendFormat(""UN~{0}|"", this.MerchantLoginID);postUrl.AppendFormat(""PSWD~{0}|"", this.MerchantTransactionKey);postUrl.Append(""TERMS~Y|METHOD~ProcessTranx|TRANXTYPE~Sale|""); postUrl.AppendFormat(""CC~{0}|"", cardNumber);postUrl.AppendFormat(""EXPMNTH~{0}|"", expirationMonth.PadLeft(2, '0'));postUrl.AppendFormat(""EXPYR~{0}|"", expirationYear);postUrl.AppendFormat(""AMOUNT~{0}|"", transactionAmount);postUrl.AppendFormat(""BADDRESS~{0}|"", this.AddressLine1);postUrl.AppendFormat(""BADDRESS2~{0}|"", this.AddressLine2);postUrl.AppendFormat(""BCITY~{0}|"", this.City);postUrl.AppendFormat(""BSTATE~{0}|"", this.State);postUrl.AppendFormat(""BZIP~{0}|"", this.Zip);postUrl.AppendFormat(""SADDRESS~{0}|"", this.AddressLine1);postUrl.AppendFormat(""SADDRESS2~{0}|"", this.AddressLine2);postUrl.AppendFormat(""SCITY~{0}|"", this.City);postUrl.AppendFormat(""SSTATE~{0}|"", this.State);postUrl.AppendFormat(""SZIP~{0}|"", this.Zip);if (!String.IsNullOrEmpty(this.Country)){ postUrl.AppendFormat(""BCOUNTRY~{0}|"", this.Country);}if (!String.IsNullOrEmpty(this.Description)){ postUrl.AppendFormat(""DESCRIPTION~{0}|"", this.Description);}if (!String.IsNullOrEmpty(this.InvoiceNumber)){ postUrl.AppendFormat(""INVOICE~{0}|"", this.InvoiceNumber);}if (this.IsTestMode){ postUrl.AppendFormat(""TEST~Y|"");}//postUrl.Append();WebClient wClient = new WebClient();ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls;String sRequest = ""PARMLIST="" + Url.Encode(postUrl.ToString());wClient.Headers.Add(""Content-Type"", ""application/x-www-form-urlencoded"");string sResponse = """";sResponse = wClient.UploadString(PayTraceUrl, sRequest); ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls;","The client and server cannot communicate, because they do not possess a common algorithm - ASP.NET C# IIS TLS 1.0 / 1.1 / 1.2 - Win32Exception"
"The client and server cannot communicate, because they do not possess a common algorithm - ASP.NET C# IIS TLS - System.ComponentModel.Win32Exception"," I have an issue with a C# PayTrace Gateway. The below code was working fine until yesterday when I believe they turned off SSL3 due to the Poodle Exploit. When running the code below we got the following message. The remote server has forcefully closed the connection. After doing some research on the problem we determined that because our IIS Server 7.5 was configured to still use SSL3, C# defaulted to SSL3, which PayTrace would forcibly close the connection. We then removed SSL3 from the server. Which then lead to the following error: The client and server cannot communicate, because they do not possess a common algorithm. My guess is that there are additional SSL algorithm we need to install on the server now that SSL 3 is removed. Our IT staff claims that TLS 1.1 and TLS 1.2 are working and that ASP.NET should be now defaulting to those. But I feel like there still must be something else we need to install on the server, I have no knowledge of SSL Algorithms so I have no idea where to begin. Also, just an FYI, this issue is also happening when we connect to First Data E4 gateway so it's not just a PayTrace thing. My guess is that as more gateways turn off access to SSL3 we'll continue to run into issues with other gateways until this can be resolved on the server. Also, I did find a few suggestions online, some suggested placing the following code right before making the outbound request: Unfortunately that did not work either, same error. Which is why I'm thinking something additional needs to be installed on the IIS7.5 server. I'm just not sure what.  <code>  var postUrl = new StringBuilder();//Initialize url with configuration and parameter values...postUrl.AppendFormat(""UN~{0}|"", this.MerchantLoginID);postUrl.AppendFormat(""PSWD~{0}|"", this.MerchantTransactionKey);postUrl.Append(""TERMS~Y|METHOD~ProcessTranx|TRANXTYPE~Sale|""); postUrl.AppendFormat(""CC~{0}|"", cardNumber);postUrl.AppendFormat(""EXPMNTH~{0}|"", expirationMonth.PadLeft(2, '0'));postUrl.AppendFormat(""EXPYR~{0}|"", expirationYear);postUrl.AppendFormat(""AMOUNT~{0}|"", transactionAmount);postUrl.AppendFormat(""BADDRESS~{0}|"", this.AddressLine1);postUrl.AppendFormat(""BADDRESS2~{0}|"", this.AddressLine2);postUrl.AppendFormat(""BCITY~{0}|"", this.City);postUrl.AppendFormat(""BSTATE~{0}|"", this.State);postUrl.AppendFormat(""BZIP~{0}|"", this.Zip);postUrl.AppendFormat(""SADDRESS~{0}|"", this.AddressLine1);postUrl.AppendFormat(""SADDRESS2~{0}|"", this.AddressLine2);postUrl.AppendFormat(""SCITY~{0}|"", this.City);postUrl.AppendFormat(""SSTATE~{0}|"", this.State);postUrl.AppendFormat(""SZIP~{0}|"", this.Zip);if (!String.IsNullOrEmpty(this.Country)){ postUrl.AppendFormat(""BCOUNTRY~{0}|"", this.Country);}if (!String.IsNullOrEmpty(this.Description)){ postUrl.AppendFormat(""DESCRIPTION~{0}|"", this.Description);}if (!String.IsNullOrEmpty(this.InvoiceNumber)){ postUrl.AppendFormat(""INVOICE~{0}|"", this.InvoiceNumber);}if (this.IsTestMode){ postUrl.AppendFormat(""TEST~Y|"");}//postUrl.Append();WebClient wClient = new WebClient();ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls;String sRequest = ""PARMLIST="" + Url.Encode(postUrl.ToString());wClient.Headers.Add(""Content-Type"", ""application/x-www-form-urlencoded"");string sResponse = """";sResponse = wClient.UploadString(PayTraceUrl, sRequest); ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls;","The client and server cannot communicate, because they do not possess a common algorithm - ASP.NET C# IIS TLS 1.0 / 1.1 / 1.2 - Win32Exception"
ASP.NET issue with IIS deployment due to temp folder," my application that I have created using ASP.NET and C# uses a temporary path to store a document whilst it is read, and then deletes it after: Thankyou for any help. The StockControl document is an example and could be imported from multiple computers on a network. based on the error message it looks like my file is not being uploaded and saved into the temp directory...local path when debugging (WORKS): the application is successfully deployed however when i attach the file and press ""Import"", i get displayed an error message:Access to the path 'C:\inetpub\wwwroot\StockControl\temp\Book1.xls' is denied. Exception Details: System.UnauthorizedAccessException: Access to the path 'C:\inetpub\wwwroot\StockControl\temp\Book1.xls' is denied. ASP.NET is not authorized to access the requested resource. Consider granting access rights to the resource to the ASP.NET request identity. ASP.NET has a base process identity (typically {MACHINE}\ASPNET on IIS 5 or Network Service on IIS 6 and IIS 7, and the configured application pool identity on IIS 7.5) that is used if the application is not impersonating. If the application is impersonating via , the identity will be the anonymous user (typically IUSR_MACHINENAME) or the authenticated request user. To grant ASP.NET access to a file, right-click the file in File Explorer, choose ""Properties"" and select the Security tab. Click ""Add"" to add the appropriate user or group. Highlight the ASP.NET account, and check the boxes for the desired access. Source Error: An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below. <code>  string path = string.Concat((Server.MapPath(""~/temp/"" + FileUpload1.FileName)));Array.ForEach(Directory.GetFiles((Server.MapPath(""~/temp/""))), File.Delete); C:\Users\USER\Documents\Visual Studio 2013\Projects\WebApplication5\WebApplication5\temp Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. ",ASP.NET is not authorized to access the requested resource when accessing temp folder
Run ASP.NET MVC 5 project on vNext," I have a working ASP.NET MVC 5 application and I need to run it under vNext. I assume there is no simple import possibility, so I'll need to do it manually. So basically I have a blank vNext project and a ready MVC5 project. I'll try to copy files and rewrite all dependencies in JSON config files. Maybe anyone tried to do something similar and can recommend best way and key points to achieve this task?  <code> ",Migrating ASP.NET MVC 5 project to ASP.NET 5
Can't read CSV file with Field Hedaer that contain two\three words separated with spaces using CsvHelper library," I have a CSV file with field headers and some of them contain two or three words separated by spaces:You can see in the above picture the field headers that contain spaces: ""Time of Day"", ""Process Name"", and ""Image Path"".When I tried to read the CSV by calling reader.GetRecords<DataRecord>(); (where DataRecord is a class I have defined), I get the error: Fields 'TimeOfDay' do not exist in the CSV file.""*This is because my DataRecord class can't contain members with spaces.How can I use CsvHelper to parse the CSV file? <code> ",Parse CSV where headers contain spaces with CsvHelper
Can't read CSV file with Field Header that contain two\three words separated with spaces using CsvHelper library," I have a CSV file with field headers and some of them contain two or three words separated by spaces:You can see in the above picture the field headers that contain spaces: ""Time of Day"", ""Process Name"", and ""Image Path"".When I tried to read the CSV by calling reader.GetRecords<DataRecord>(); (where DataRecord is a class I have defined), I get the error: Fields 'TimeOfDay' do not exist in the CSV file.""*This is because my DataRecord class can't contain members with spaces.How can I use CsvHelper to parse the CSV file? <code> ",Parse CSV where headers contain spaces with CsvHelper
Inserting a preexisting AutoCAD drawing into a current drawing with C#," I'm trying to programmatically insert a block from a pre-existing drawing into the current drawing a plugin is running on. To do that, I have a button on my C#.NET form call the following method The code fully executes but the block in my DOOR.dwg file does not appear at location (0, 0, 0) and I do not know why it doesn't <code>  public void MakeAndInsertObject() //Method to add all windows and doors templates to drawing database for use later{ Document doc = Autodesk.AutoCAD.ApplicationServices.Application.DocumentManager.MdiActiveDocument; //Stores the active document Editor ed = doc.Editor; //Stores the document's editor Database dtb = ed.Document.Database; //Stores the database from the editor Transaction tr = dtb.TransactionManager.StartTransaction(); //Start a transaction with the document's database DocumentLock docLock = doc.LockDocument(); using (tr) using (docLock) { BlockTableRecord btr = (BlockTableRecord)tr.GetObject(dtb.CurrentSpaceId, OpenMode.ForWrite); //Opens the block table record so you can write to it BlockTableRecord newBlockDef = new BlockTableRecord(); //Creates a new record in the block table BlockTable blockTable = (BlockTable)tr.GetObject(dtb.BlockTableId, OpenMode.ForWrite); //Opens the block table so it can be written to //Pointing new block to correct drawing file newBlockDef.Name = ""Door""; newBlockDef.PathName = ""C:/Users/Administrator/Documents/All Code/clearspan-autocad-tools-development/Templates/locks/DOOR.dwg""; blockTable.Add(newBlockDef); //Adds the block table record to the block table BlockReference newBlock = new BlockReference(new Point3d(0, 0, 0), newBlockDef.ObjectId); //Insert a block reference with the newly created block btr.AppendEntity(newBlock); //Inserts the block into the current space (Model or Paper) via the block table record //Updates the Transaction with all new database objects tr.AddNewlyCreatedDBObject(newBlockDef, true); tr.AddNewlyCreatedDBObject(newBlock, true); tr.Commit(); //Applies all changes made as part of the current transaction tr.Dispose(); }}",Inserting a preexisting AutoCAD drawing into a current drawing
What is the proper way to construct a Biginteger from an implied unsigned hexedicimal string in C#?," I'm running into a problem where as I have an implied unsigned hexadecimal number as a string, provided from user input, that needs to be converted into a BigInteger.Thanks to the signed nature of a BigInteger any input where the highest order bit is set (0x8 / 1000b) the resulting number is treated as negative. This issue however can't be resolved by simply checking the sign bit and multiplying by -1 or getting the absolute value due to ones's complement which will not respect the underlying notation e.g. treating all values 0xF* as a -1.As follows are some example input/output What is the proper way to construct a BigInteger from an implied unsigned hexadecimal string? <code>  var style = NumberStyles.HexNumber | NumberStyles.AllowHexSpecifier;BigInteger.TryParse(""6"", style) == 6 // 0110 binBigInteger.TryParse(""8"", style) == -8 // 1000 binBigInteger.TryParse(""9"", style) == -7 // 1001 binBigInteger.TryParse(""A"", style) == -6 // 1010 bin...BigInteger.TryParse(""F"", style) == -1 // 1111 bin...BigInteger.TryParse(""FA"", style) == -6 // 1111 1010 binBigInteger.TryParse(""FF"", style) == -1 // 1111 1111 bin...BigInteger.TryParse(""FFFF"", style) == -1 // 1111 1111 1111 1111 bin",What is the proper way to construct a BigInteger from an implied unsigned hexadecimal string?
how to ignore a property in automapper?," I'm using Automapper to copy one object properties to other and later will update in database using EF.Question is how to tell Automapper copy every property but ignore a particular property (in this case it will be Id). I'm new to AutoMapper and just have done this code. I don't have other configurations or use of AutoMap in project. I have downloaded AutoMapper form here https://github.com/AutoMapper/AutoMapper <code>  Mapper.Map(lead, existingLead);",Ignore a property in AutoMapper?
What is difference when we return IList vs List or IEnumerable vs List<Class>. I want know which is better to return," What is the difference between returning IList vs List, or IEnumerable vs List. I want to know which is better to return.When we need to use one, what effect will it have on performance? <code> ","What is the difference between returning IList vs List, or IEnumerable vs List<Class>. I want to know which is better to return"
Depricated classes in Azure SDK 2.5, We are currently working on uppgrading our Azure SDK version from 2.2 to 2.5 that is the latest at the moment.When I do this I notice that the following classes is marked as deprecated:DeploymentDiagnosticManagerDiagnosticMonitorConfigurationDiagnosticMonitorWhen I go into the MSDN page about these classes it stands nothing out of the ordinary.http://msdn.microsoft.com/en-us/library/azure/microsoft.windowsazure.diagnostics.diagnosticmonitorconfiguration.aspxDoes anyone know what I am supposed to use for diagnostics now when these classes are deprecated? <code> ,Deprecated classes in Azure SDK 2.5
.net 4.0 project referencing 4.5, I am working on a project targeting .NET 4.0 and now I need to reference a third party dll which was built targeting .NET 4.5. It seems that visual studio does not accept that? Why? VS shows me that dll name does not exist in current context. <code> ,Why cant a .net 4.0 project reference a 4.5 assembly?
Why can a .net 4.0 project not reference a 4.5 assembly?, I am working on a project targeting .NET 4.0 and now I need to reference a third party dll which was built targeting .NET 4.5. It seems that visual studio does not accept that? Why? VS shows me that dll name does not exist in current context. <code> ,Why cant a .net 4.0 project reference a 4.5 assembly?
Mono mkbundle throws weird error," I've been trying to compile or bundle my application using mkbundle.This is the script I'm executing: I had to add MonoPosixHelper.dll because I got a EntryPoint not found error. Now I got this weird error: My .exe is succesfully running on Windows and Ubuntu but I'm trying to bundle it so that users don't have to download mono. <code>  set -o errexitset -o nounsetmono_version=""3.2.3""export MONO=/cygdrive/c/progra~2/Mono-$mono_versionmachineconfig=$PROGRAMFILES\\Mono-$mono_version\\etc\\mono\\4.0\\machine.configexport PATH=$PATH:$MONO/binexport PKG_CONFIG_PATH=$MONO/lib/pkgconfigicon_name='""icon.ico""'echo ""1 ICON $icon_name"" > icon.rcexport CC=""i686-pc-mingw32-gcc icon.o -U _WIN32""output_name=Output.exemkbundle JiraTempoApp.exe MonoPosixHelper.dll gtk-sharp.dll glib-sharp.dll atk-sharp.dll gdk-sharp.dll glade-sharp.dll glib-sharp.dll pango-sharp.dll RestSharp.dll JiraRestLib.dll --deps --machine-config ""$machineconfig"" -o $output_name -zrm icon.rc rm icon.ocp $MONO/bin/mono-2.0.dll .cp $MONO/bin/zlib1.dll ../$output_name $ ./mkbundle_cygwin.shOS is: WindowsWARNING: Check that the machine.config file you are bundling doesn't contain sensitive information specific to this machine.Sources: 11 Auto-dependencies: TrueUnhandled Exception:IKVM.Reflection.BadImageFormatException: Exception of type 'IKVM.Reflection.BadImageFormatException' was thrown. at IKVM.Reflection.Reader.PEReader.RvaToFileOffset (UInt32 rva) [0x00000] in <filename unknown>:0 at IKVM.Reflection.Reader.ModuleReader.Read (System.IO.Stream stream) [0x00000] in <filename unknown>:0 at IKVM.Reflection.Reader.ModuleReader..ctor (IKVM.Reflection.Reader.AssemblyReader assembly, IKVM.Reflection.Universe universe, System.IO.Stream stream, System.String location) [0x00000] in <filename unknown>:0 at IKVM.Reflection.Universe.OpenRawModule (System.IO.Stream stream, System.String location) [0x00000] in <filename unknown>:0 at IKVM.Reflection.Universe.OpenRawModule (System.String path) [0x00000] in <filename unknown>:0 at IKVM.Reflection.Universe.LoadFile (System.String path) [0x00000] in <filename unknown>:0 at MakeBundle.LoadAssembly (System.String assembly) [0x00000] in <filename unknown>:0 at MakeBundle.LoadAssemblies (System.Collections.Generic.List`1 sources) [0x00000] in <filename unknown>:0 at MakeBundle.Main (System.String[] args) [0x00000] in <filename unknown>:0[ERROR] FATAL UNHANDLED EXCEPTION: IKVM.Reflection.BadImageFormatException: Exception of type 'IKVM.Reflection.BadImageFormatException' was thrown. at IKVM.Reflection.Reader.PEReader.RvaToFileOffset (UInt32 rva) [0x00000] in <filename unknown>:0 at IKVM.Reflection.Reader.ModuleReader.Read (System.IO.Stream stream) [0x00000] in <filename unknown>:0 at IKVM.Reflection.Reader.ModuleReader..ctor (IKVM.Reflection.Reader.AssemblyReader assembly, IKVM.Reflection.Universe universe, System.IO.Stream stream, System.String location) [0x00000] in <filename unknown>:0 at IKVM.Reflection.Universe.OpenRawModule (System.IO.Stream stream, System.String location) [0x00000] in <filename unknown>:0 at IKVM.Reflection.Universe.OpenRawModule (System.String path) [0x00000] in <filename unknown>:0 at IKVM.Reflection.Universe.LoadFile (System.String path) [0x00000] in <filename unknown>:0 at MakeBundle.LoadAssembly (System.String assembly) [0x00000] in <filename unknown>:0 at MakeBundle.LoadAssemblies (System.Collections.Generic.List`1 sources) [0x00000] in <filename unknown>:0 at MakeBundle.Main (System.String[] args) [0x00000] in <filename unknown>:0",Mono mkbundle throws 'IKVM.Reflection.BadImageFormatException'
C# does String.Replace() create a new string if there's nothing to replace?," For example: If I were to call ""ReplaceXYZ"" even for strings that do not contain ""X"", ""Y"", or ""Z"", would 3 new strings be created each time?I spotted code similar to this in one of our projects. It's called repeatedly as it loops through a large collection of strings. <code>  public string ReplaceXYZ(string text){ string replacedText = text; replacedText = replacedText.Replace(""X"", String.Empty); replacedText = replacedText.Replace(""Y"", String.Empty); replacedText = replacedText.Replace(""Z"", String.Empty); return replacedText;}",Does String.Replace() create a new string if there's nothing to replace?
How do I return the view with an API controller?," I'm implementing a REST Web API. I'm using the examples from Adam Freeman's Pro ASP.NET MVC5 as a starting point but adapting it into the Web API way of doing it.The below is my code: In the book, AdminController implemented Controller not ApiController, but if I do that then I get errors about there being no parameterless constructor. I need the constructor to take parameters so that I can inject the dependencies. So that's why I changed to ApiController but now it won't recognise View.What do I need to use instead of View for an ApiController? I did find this question but the answer was basically ""you don't need to use an ApiController here, just use Controller"" so that didn't help me. <code>  public class AdminController : ApiController{ private IUserRepository _repository; public AdminController(IUserRepository repository) { _repository = repository; } public ActionResult Index() { return View(_repository.Users); }}",Problems trying to return the view with an API controller
Howto check a type for parameterless constructor?," Because I want to avoid an exception, I want to check whether a type has a parameterless constructor. How can I achieve this?I need something like this: EDIT:I want to create an object of same type as source and if it hasn't a default constructor I want to use default(TT) instead.What I have right now is: But the check gives me true and CreateInstance throws exception No parameterless constructorSolution: There were many recursive functions and iterations involved and somewhere down this way, the wrong generic function HasDefaultConstructor (with type object) has been called. Using a non generic function did the trick.Thank you all for your constructive help. <code>  bool HasDefaultConstructor<TT>(TT source){ return ???;} static TT CreateObject<TT>(TT source) { try { if(!HasDefaultConstructor<TT>(source)) { return default(TT); } return (TT)Activator.CreateInstance(source.GetType()); } catch(Exception ex) { Trace.WriteLine(""Exception catched!\r\n"" + ex); } return default(TT); } static bool HasDefaultConstructor<TT>(TT source) { ConstructorInfo c = typeof(TT).GetConstructor(new Type[] { }); return c != null; } bool HasDefaultConstructor(Type t){ return t.GetConstructor(Type.EmptyTypes) != null;}",How to check a type for parameterless constructor?
Mixing TPH and TPT in Entity Framework 6 results in Error 3032," Initial situationI have an application that uses an existing database, currently using NHibernate as O/R-Mapper.Now I need to migrate to Entity Framework 6.1.1 using Code First and Fluent API Configuration.But now I have a problem with a part of the data model because it uses different types of inheritance strategies (TPT and TPH)StructureNote: Posting the complete data model here seemed a bit too enormous to me so I reproduced the problem I face in a small POC program. The column used as discrimator in the table is called TypeBased on this answer I added an abstract class Intermediate_TPH as intermediate layer:Some sample data: Entry with ID=3 is of type Inherited_TPTCodeThese are my entity classes and my context class: Running the following code will give me an error. OutputThe program produces the following output: 1: Simpson 2: Johnson 3: Smith (More details about SMITH) 4: Miller (More details about MILLER) An error occurred while preparing the command definition. See the inner exception for details. (26,10) : error 3032: Problem in mapping fragments starting at lines 14, 26:EntityTypes PoC.Inherited_TPH, PoC.Inherited_TPT are being mapped to the same rows in table BaseEntity. Mapping conditions can be used to distinguish the rows that these types are mapped to.QuestionAs you can see, the mapping seems to work because I can load all data from Inherited_TPT and Inherited_TPH. But when accessing another entity, I get an exception.How do I need to configure the mapping to get rid of this error and be able to access the existing database structure? <code>  CLASS | TABLE | TYPE-----------------------+--------------------+------BaseEntity (abstract) | BaseTable |Inherited_TPH | BaseTable | 1Inherited_TPT | Inherited_TPT | 2 class MyContext : DbContext{ public MyContext ( string connectionString ) : base ( connectionString ) { } public DbSet<Inherited_TPH> TPH_Set { get; set; } public DbSet<Inherited_TPT> TPT_Set { get; set; } public DbSet<SomethingElse> Another_Set { get; set; } protected override void OnModelCreating ( DbModelBuilder modelBuilder ) { modelBuilder .Entity<BaseEntity> () .ToTable ( ""BaseTable"" ); modelBuilder .Entity<Inherited_TPH> () .Map ( t => t.Requires ( ""Type"" ).HasValue ( 1 ) ); modelBuilder .Entity<Intermediate_TPT> () .Map ( t => t.Requires ( ""Type"" ).HasValue ( 2 ) ); modelBuilder .Entity<Intermediate_TPT> () .Map<Inherited_TPT> ( t => t.ToTable ( ""Inherited_TPT"" ) ); modelBuilder .Entity<SomethingElse> () .ToTable ( ""SomethingElse"" ) .HasKey ( t => t.Id ); }}public abstract class BaseEntity{ public virtual int Id { get; set; } public virtual string Title { get; set; }}public class Inherited_TPH : BaseEntity{}public abstract class Intermediate_TPT : BaseEntity{}public class Inherited_TPT : Intermediate_TPT{ public virtual string Comment { get; set; }}public class SomethingElse{ public virtual string Description { get; set; } public virtual int Id { get; set; }} static void Main ( string[] args ) { Database.SetInitializer<MyContext> ( null ); var ctx = new MyContext ( @""Data Source=(local);Initial Catalog=nh_ef;Integrated Security=true"" ); try { // Accessing Inherited_TPH works just fine foreach ( var item in ctx.TPH_Set ) Console.WriteLine ( ""{0}: {1}"", item.Id, item.Title ); // Accessing Inherited_TPT works just fine foreach ( var item in ctx.TPT_Set ) Console.WriteLine ( ""{0}: {1} ({2})"", item.Id, item.Title, item.Comment ); // The rror occurs when accessing ANOTHER entity: foreach ( var item in ctx.Another_Set ) Console.WriteLine ( ""{0}: {1}"", item.Id, item.Description ); } catch ( Exception ex ) { Console.WriteLine ( ex.Message ); if( ex.InnerException != null ) { Console.WriteLine ( ex.InnerException.Message ); } } }",How can I mix TPH and TPT in Entity Framework 6?
C# 6.0 New Feature Dictionary Initializers," In a recent past there has been a lot of talk about whats new in C# 6.0One of the most talked about feature is using Dictionary initializers in C# 6.0But wait we have been using collection initializers to initialize the collections and can very well initialize a Dictionary also in .NET 4.0 and .NET 4.5 (Don't know about old version) like So what is there new in C# 6.0, What Dictionary Initializer they are talking about in C# 6.0 <code>  Dictionary<int, string> myDict = new Dictionary<int, string>() { { 1,""Pankaj""}, { 2,""Pankaj""}, { 3,""Pankaj""}};",What benefits does dictionary initializers add over collection initializers?
why do we need CIL (a.k.a IL)?," CIL is an object-oriented assembly language, and is entirely stack-based. Its bytecode is translated into native code or most commonly executed by a virtual machine.Why do we need CIL? Is it not possible to translate C# into native code instead of CIL?If all .Net languages compile to CIL, why isn't C# used instead of IL? Is CIL more expressive than C# or VB? <code> ",Why doesn't C# compile directly to machine code?
C# getting 250 ips on machine only retrieves 50," I have a linux (ubuntu server 14.04) machine with 250 ips. When I run my c# code in mono, it only retrieves 50 ips.All ips are configured correctly, I have the same code in java, and all 250 ips are found, and can be bound to.I have tried: and both return 50 ips?So, my question, is there a limit in c# on how many ips can be discovered? or any other reason anyone knows of why this would be happening? <code>  Dns.GetHostByName(Dns.GetHostName()).AddressList; Dns.GetHostAddresses(string.Empty);","C# - Machine has 250 ips, I can only retrieve 50 from code"
Join tables in LINQ and xamarin," i have stuck in a join and i cant figure out where the problem is, i have those tables And i want to join MusicItems with MusicInThemes in order to get all the music file details that belongs on a theme. So far i have try these that crash my app: And this is the code where i get the Playlist: (I have 2 buttons. The btnTheme1 display some info for the theme and save som theme variables and then the loadTheme button tries to extract the songs from the selected theme) Please advice <code>  public class Themes{ [PrimaryKey, AutoIncrement] public int Id { get; set; } public String ThemeName { get; set; } public String ThemeDesc { get; set; } public int ThemeImg { get; set; } public String ThemeCategory { get; set; } public String ThemeSubcategory { get; set; }}public class MusicItems{ [PrimaryKey, AutoIncrement] public int Id { get; set; } public String Name { get; set; } public String Tension { get; set; } public String Category { get; set; } public String Subcategory { get; set; } public int ResId { get; set; } public int LoopStart { get; set; }}public class Playlist{ public String Name { get; set; } public int ResId { get; set; } public int LoopStart { get; set; }}public class MusicInThemes{ [PrimaryKey, AutoIncrement] public int Id { get; set; } public int ResId { get; set; } public int ThemeId { get; set; }} var query = from MusicItem in database.Table<MusicItems>() join Theme in database.Table<MusicInThemes>() on MusicItem.ResId equals Theme.ResId where Theme.ThemeId == ThemeID select new Playlist{Name = MusicItem.Name, ResId = MusicItem.ResId ,LoopStart = 0}; return query.ToList(); // andreturn database.Table<MusicItems>() .Join(database.Table<MusicInThemes>().Where(t => t.ThemeId == ThemeID) ,m => m.ResId ,t => t.ResId ,(m,t) => new Playlist{Name = m.Name, ResId = m.ResId ,LoopStart = m.LoopStart}) .ToList(); ThemeImage = view.FindViewById<ImageView> (Resource.Id.imgThemeImage); ThemeDesc = view.FindViewById<TextView> (Resource.Id.txtDesc); Button btnTheme1 = view.FindViewById<Button> (Resource.Id.btnTheme1); //Button btnTheme2 = view.FindViewById<Button> (Resource.Id.btnTheme2); Button btnLoadTheme = view.FindViewById<Button> (Resource.Id.btnLoadTheme); musicFiles.AllThemes = mydata.GetAllThemes (); Console.WriteLine(""Themes Count:""+musicFiles.AllThemes.Count); var ListSEbuttons = new List<Button> { { btnTheme1 }, }; for (i=0;i<ListSEbuttons.Count();i++){ var button = ListSEbuttons[i]; button.Text = SelectedThemeName = musicFiles.AllThemes [i].ThemeName; SelectedThemeImageId = musicFiles.AllThemes [i].ThemeImg; button.Tag = i; SelectedThemeId = musicFiles.AllThemes [i].Id; button.Click += ButtonOnClick; } btnTheme1.PerformClick (); btnLoadTheme.Click += (sender, e) => { Low = mydata.GetPlaylist(SelectedThemeId,""low""); // this is where the crash happens ... } private void ButtonOnClick(object sender, EventArgs eventArgs) { var button = sender as Button; if (button != null) { var index = (int)button.Tag; Console.WriteLine(""List pos for sound effect: ""+musicFiles.AllThemes [index].ThemeImg); button.RequestFocus(); ThemeDesc.Text = musicFiles.AllThemes [index].ThemeDesc; //ThemeImage.SetImageResource (musicFiles.AllThemes [index].ThemeImg); } }//ignore the ""low"" parameter i never use it for now Debug Log:...[Mono] Assembly Ref addref Music[0xb95c8210] -> Newtonsoft.Json[0xb95ca100]: 2[Mono] The request to load the retargetable assembly mscorlib v2.0.5.0 was remapped to mscorlib v2.0.5.0[Mono] Assembly Ref addref Newtonsoft.Json[0xb95ca100] -> mscorlib[0xb9406208]: 7[Mono] Assembly Ref addref System.Core[0xb960c248] -> System[0xb972dd18]: 4[MediaPlayer-JNI] MediaPlayer finalized without being released[MediaPlayer-JNI] MediaPlayer finalized without being released[MediaPlayer-JNI] MediaPlayer finalized without being released[MediaPlayer-JNI] MediaPlayer finalized without being released[Mono] GC_OLD_BRIDGE num-objects 44 num_hash_entries 47 sccs size 47 init 0.00ms df1 0.19ms sort 0.30ms dfs2 1.39ms setup-cb 0.01ms free-data 0.12ms links 3/3/3/1 dfs passes 94/50[Mono] GC_MINOR: (Nursery full) pause 19.83ms, total 19.96ms, bridge 11.96ms promoted 784K major 1072K los 8K[Mono] GC_OLD_BRIDGE num-objects 44 num_hash_entries 47 sccs size 47 init 0.00ms df1 0.19ms sort 0.30ms dfs2 1.39ms setup-cb 0.01ms free-data 0.12ms links 0/0/0/0 dfs passes 0/0[Mono] GC_MINOR: (Nursery full) pause 11.56ms, total 11.67ms, bridge 0.17ms promoted 368K major 1440K los 8K[] * Assertion at /Users/builder/data/lanes/monodroid-mlion-monodroid-4.20-series/ba9bbbdd/source/mono/mono/metadata/sgen-stw.c:68, condition `info->stack_start >= info->stack_start_limit && info->stack_start < info->stack_end' not met[mono-rt] Stacktrace:[mono-rt] [mono-rt] at <unknown> <0xffffffff>[mono-rt] at (wrapper managed-to-native) object.__icall_wrapper_mono_array_new_specific (intptr,int) <IL 0x00022, 0xffffffff>[mono-rt] at System.Collections.Concurrent.SplitOrderedList`2<string, System.Collections.Generic.KeyValuePair`2<string, SQLite.PreparedSqlLiteInsertCommand>>..ctor (System.Collections.Generic.IEqualityComparer`1<string>) <IL 0x00006, 0x0004b>[mono-rt] at System.Collections.Concurrent.ConcurrentDictionary`2..ctor (System.Collections.Generic.IEqualityComparer`1<TKey>) <IL 0x0000f, 0x000a6>[mono-rt] at System.Collections.Concurrent.ConcurrentDictionary`2..ctor () <IL 0x00006, 0x0006b>[mono-rt] at SQLite.TableMapping..ctor (System.Type,SQLite.CreateFlags) [0x0019d] in c:\Users\Exoskeletor\Documents\Projects\Music\Music\Helpers\SQLite.cs:1755[mono-rt] at SQLite.SQLiteConnection.GetMapping (System.Type,SQLite.CreateFlags) [0x00036] in c:\Users\Exoskeletor\Documents\Projects\Music\Music\Helpers\SQLite.cs:304[mono-rt] at SQLite.TableQuery`1..ctor (SQLite.SQLiteConnection) [0x00010] in c:\Users\Exoskeletor\Documents\Projects\Music\Music\Helpers\SQLite.cs:2473[mono-rt] at SQLite.SQLiteConnection.Table<T> () [0x00001] in c:\Users\Exoskeletor\Documents\Projects\Music\Music\Helpers\SQLite.cs:768[mono-rt] at Music.DataManager.DatabaseUpdates.GetPlaylist (int,string) [0x00027] in c:\Users\Exoskeletor\Documents\Projects\Music\Music\Helpers\DataManagerHelper.cs:288[mono-rt] at Music.Music_SelectTheme/<>c__DisplayClass2.<OnCreateView>b__1 (object,System.EventArgs) [0x00001] in c:\Users\Exoskeletor\Documents\Projects\Music\Music\Music_SelectTheme.cs:77[mono-rt] at Android.Views.View/IOnClickListenerImplementor.OnClick (Android.Views.View) [0x0000d] in /Users/builder/data/lanes/monodroid-mlion-monodroid-4.20-series/ba9bbbdd/source/monodroid/src/Mono.Android/platforms/android-15/src/generated/Android.Views.View.cs:1615[mono-rt] at Android.Views.View/IOnClickListenerInvoker.n_OnClick_Landroid_view_View_ (intptr,intptr,intptr) [0x00011] in /Users/builder/data/lanes/monodroid-mlion-monodroid-4.20-series/ba9bbbdd/source/monodroid/src/Mono.Android/platforms/android-15/src/generated/Android.Views.View.cs:1582[mono-rt] at (wrapper dynamic-method) object.a2a00f7c-dc24-4757-ba0d-9fa6ea56b30a (intptr,intptr,intptr) <IL 0x00017, 0x0001f>[mono-rt] at (wrapper native-to-managed) object.a2a00f7c-dc24-4757-ba0d-9fa6ea56b30a (intptr,intptr,intptr) <IL 0x00023, 0xffffffff>[mono-rt] [mono-rt] =================================================================[mono-rt] Got a SIGSEGV while executing native code. This usually indicates[mono-rt] a fatal error in the mono runtime or one of the native libraries [mono-rt] used by your application.[mono-rt] =================================================================[mono-rt] [libc] Fatal signal 11 (SIGSEGV) at 0xdeadbaad (code=1), thread 1385 (Music.Music)",Join tables in SQLite.Net with LINQ on xamarin.android is not supported
Join tables in SQLite.Net with LINQ on xamarin.android," i have stuck in a join and i cant figure out where the problem is, i have those tables And i want to join MusicItems with MusicInThemes in order to get all the music file details that belongs on a theme. So far i have try these that crash my app: And this is the code where i get the Playlist: (I have 2 buttons. The btnTheme1 display some info for the theme and save som theme variables and then the loadTheme button tries to extract the songs from the selected theme) Please advice <code>  public class Themes{ [PrimaryKey, AutoIncrement] public int Id { get; set; } public String ThemeName { get; set; } public String ThemeDesc { get; set; } public int ThemeImg { get; set; } public String ThemeCategory { get; set; } public String ThemeSubcategory { get; set; }}public class MusicItems{ [PrimaryKey, AutoIncrement] public int Id { get; set; } public String Name { get; set; } public String Tension { get; set; } public String Category { get; set; } public String Subcategory { get; set; } public int ResId { get; set; } public int LoopStart { get; set; }}public class Playlist{ public String Name { get; set; } public int ResId { get; set; } public int LoopStart { get; set; }}public class MusicInThemes{ [PrimaryKey, AutoIncrement] public int Id { get; set; } public int ResId { get; set; } public int ThemeId { get; set; }} var query = from MusicItem in database.Table<MusicItems>() join Theme in database.Table<MusicInThemes>() on MusicItem.ResId equals Theme.ResId where Theme.ThemeId == ThemeID select new Playlist{Name = MusicItem.Name, ResId = MusicItem.ResId ,LoopStart = 0}; return query.ToList(); // andreturn database.Table<MusicItems>() .Join(database.Table<MusicInThemes>().Where(t => t.ThemeId == ThemeID) ,m => m.ResId ,t => t.ResId ,(m,t) => new Playlist{Name = m.Name, ResId = m.ResId ,LoopStart = m.LoopStart}) .ToList(); ThemeImage = view.FindViewById<ImageView> (Resource.Id.imgThemeImage); ThemeDesc = view.FindViewById<TextView> (Resource.Id.txtDesc); Button btnTheme1 = view.FindViewById<Button> (Resource.Id.btnTheme1); //Button btnTheme2 = view.FindViewById<Button> (Resource.Id.btnTheme2); Button btnLoadTheme = view.FindViewById<Button> (Resource.Id.btnLoadTheme); musicFiles.AllThemes = mydata.GetAllThemes (); Console.WriteLine(""Themes Count:""+musicFiles.AllThemes.Count); var ListSEbuttons = new List<Button> { { btnTheme1 }, }; for (i=0;i<ListSEbuttons.Count();i++){ var button = ListSEbuttons[i]; button.Text = SelectedThemeName = musicFiles.AllThemes [i].ThemeName; SelectedThemeImageId = musicFiles.AllThemes [i].ThemeImg; button.Tag = i; SelectedThemeId = musicFiles.AllThemes [i].Id; button.Click += ButtonOnClick; } btnTheme1.PerformClick (); btnLoadTheme.Click += (sender, e) => { Low = mydata.GetPlaylist(SelectedThemeId,""low""); // this is where the crash happens ... } private void ButtonOnClick(object sender, EventArgs eventArgs) { var button = sender as Button; if (button != null) { var index = (int)button.Tag; Console.WriteLine(""List pos for sound effect: ""+musicFiles.AllThemes [index].ThemeImg); button.RequestFocus(); ThemeDesc.Text = musicFiles.AllThemes [index].ThemeDesc; //ThemeImage.SetImageResource (musicFiles.AllThemes [index].ThemeImg); } }//ignore the ""low"" parameter i never use it for now Debug Log:...[Mono] Assembly Ref addref Music[0xb95c8210] -> Newtonsoft.Json[0xb95ca100]: 2[Mono] The request to load the retargetable assembly mscorlib v2.0.5.0 was remapped to mscorlib v2.0.5.0[Mono] Assembly Ref addref Newtonsoft.Json[0xb95ca100] -> mscorlib[0xb9406208]: 7[Mono] Assembly Ref addref System.Core[0xb960c248] -> System[0xb972dd18]: 4[MediaPlayer-JNI] MediaPlayer finalized without being released[MediaPlayer-JNI] MediaPlayer finalized without being released[MediaPlayer-JNI] MediaPlayer finalized without being released[MediaPlayer-JNI] MediaPlayer finalized without being released[Mono] GC_OLD_BRIDGE num-objects 44 num_hash_entries 47 sccs size 47 init 0.00ms df1 0.19ms sort 0.30ms dfs2 1.39ms setup-cb 0.01ms free-data 0.12ms links 3/3/3/1 dfs passes 94/50[Mono] GC_MINOR: (Nursery full) pause 19.83ms, total 19.96ms, bridge 11.96ms promoted 784K major 1072K los 8K[Mono] GC_OLD_BRIDGE num-objects 44 num_hash_entries 47 sccs size 47 init 0.00ms df1 0.19ms sort 0.30ms dfs2 1.39ms setup-cb 0.01ms free-data 0.12ms links 0/0/0/0 dfs passes 0/0[Mono] GC_MINOR: (Nursery full) pause 11.56ms, total 11.67ms, bridge 0.17ms promoted 368K major 1440K los 8K[] * Assertion at /Users/builder/data/lanes/monodroid-mlion-monodroid-4.20-series/ba9bbbdd/source/mono/mono/metadata/sgen-stw.c:68, condition `info->stack_start >= info->stack_start_limit && info->stack_start < info->stack_end' not met[mono-rt] Stacktrace:[mono-rt] [mono-rt] at <unknown> <0xffffffff>[mono-rt] at (wrapper managed-to-native) object.__icall_wrapper_mono_array_new_specific (intptr,int) <IL 0x00022, 0xffffffff>[mono-rt] at System.Collections.Concurrent.SplitOrderedList`2<string, System.Collections.Generic.KeyValuePair`2<string, SQLite.PreparedSqlLiteInsertCommand>>..ctor (System.Collections.Generic.IEqualityComparer`1<string>) <IL 0x00006, 0x0004b>[mono-rt] at System.Collections.Concurrent.ConcurrentDictionary`2..ctor (System.Collections.Generic.IEqualityComparer`1<TKey>) <IL 0x0000f, 0x000a6>[mono-rt] at System.Collections.Concurrent.ConcurrentDictionary`2..ctor () <IL 0x00006, 0x0006b>[mono-rt] at SQLite.TableMapping..ctor (System.Type,SQLite.CreateFlags) [0x0019d] in c:\Users\Exoskeletor\Documents\Projects\Music\Music\Helpers\SQLite.cs:1755[mono-rt] at SQLite.SQLiteConnection.GetMapping (System.Type,SQLite.CreateFlags) [0x00036] in c:\Users\Exoskeletor\Documents\Projects\Music\Music\Helpers\SQLite.cs:304[mono-rt] at SQLite.TableQuery`1..ctor (SQLite.SQLiteConnection) [0x00010] in c:\Users\Exoskeletor\Documents\Projects\Music\Music\Helpers\SQLite.cs:2473[mono-rt] at SQLite.SQLiteConnection.Table<T> () [0x00001] in c:\Users\Exoskeletor\Documents\Projects\Music\Music\Helpers\SQLite.cs:768[mono-rt] at Music.DataManager.DatabaseUpdates.GetPlaylist (int,string) [0x00027] in c:\Users\Exoskeletor\Documents\Projects\Music\Music\Helpers\DataManagerHelper.cs:288[mono-rt] at Music.Music_SelectTheme/<>c__DisplayClass2.<OnCreateView>b__1 (object,System.EventArgs) [0x00001] in c:\Users\Exoskeletor\Documents\Projects\Music\Music\Music_SelectTheme.cs:77[mono-rt] at Android.Views.View/IOnClickListenerImplementor.OnClick (Android.Views.View) [0x0000d] in /Users/builder/data/lanes/monodroid-mlion-monodroid-4.20-series/ba9bbbdd/source/monodroid/src/Mono.Android/platforms/android-15/src/generated/Android.Views.View.cs:1615[mono-rt] at Android.Views.View/IOnClickListenerInvoker.n_OnClick_Landroid_view_View_ (intptr,intptr,intptr) [0x00011] in /Users/builder/data/lanes/monodroid-mlion-monodroid-4.20-series/ba9bbbdd/source/monodroid/src/Mono.Android/platforms/android-15/src/generated/Android.Views.View.cs:1582[mono-rt] at (wrapper dynamic-method) object.a2a00f7c-dc24-4757-ba0d-9fa6ea56b30a (intptr,intptr,intptr) <IL 0x00017, 0x0001f>[mono-rt] at (wrapper native-to-managed) object.a2a00f7c-dc24-4757-ba0d-9fa6ea56b30a (intptr,intptr,intptr) <IL 0x00023, 0xffffffff>[mono-rt] [mono-rt] =================================================================[mono-rt] Got a SIGSEGV while executing native code. This usually indicates[mono-rt] a fatal error in the mono runtime or one of the native libraries [mono-rt] used by your application.[mono-rt] =================================================================[mono-rt] [libc] Fatal signal 11 (SIGSEGV) at 0xdeadbaad (code=1), thread 1385 (Music.Music)",Join tables in SQLite.Net with LINQ on xamarin.android is not supported
"Creating Func<IQueryable<TEntity>, IOrderedQueryable<TEntity>> dynamically, c#?"," I wanna create Func<IQueryable<TEntity>, IOrderedQueryable<TEntity>> from list of SortingItems dynamically.I mean I wanna create the following expression:entity => entity.OrderBy(c => c.Id).ThenBy(c => c.Name).ThenByDescending(c => c.LastName)The following is my code : It's OK to create {f.OrderBy(entity => entity.Id)} or {f.ThenBy(entity => entity.Name)} seperately, but I get exception at the following line How should I use Expression.Call to combine {f.OrderBy(entity => entity.Id)} with {f.ThenBy(entity => entity.Name)} , .... ? <code>  [DataContract]public class SortingItem{ [DataMember] public string PropertySelectorString { get; set; } [DataMember] public SortingDirectionsEnum SortingDirections { get; set; }}[DataContract]public enum SortingDirectionsEnum{ [EnumMember] Descending = 0, [EnumMember] Ascending = 1}public Func<IQueryable<TEntity>, IOrderedQueryable<TEntity>> GetSortingFunc<TEntity>(){ _entityType = typeof(TEntity); _parameterExpression = Expression.Parameter(_entityType, ""entity""); _iQueryableParameterExpression = Expression.Parameter(typeof(IQueryable<TEntity>), ""f""); MethodInfo orderByMethodInfo = null; Expression resultExpression = null; foreach (SortingItem sortingItem in SortingItems) { MemberExpression memberExpression = GetLeftSide(sortingItem.PropertySelectorString, _entityType, _parameterExpression); // I'm dead sure about working this line switch (sortingItem.SortingDirections) { case SortingDirectionsEnum.Descending: orderByMethodInfo = typeof(Queryable).GetMethods().First(method => method.Name == ""OrderBy"" && method.GetParameters().Length == 2).MakeGenericMethod(_entityType, memberExpression.Type); if (resultExpression != null) orderByMethodInfo = typeof(Queryable).GetMethods().First(method => method.Name == ""ThenBy"" && method.GetParameters().Length == 2).MakeGenericMethod(_entityType, memberExpression.Type); break; case SortingDirectionsEnum.Ascending: orderByMethodInfo = typeof(Queryable).GetMethods().First(method => method.Name == ""OrderByDescending"" && method.GetParameters().Length == 2).MakeGenericMethod(_entityType, memberExpression.Type); if (resultExpression != null) orderByMethodInfo = typeof(Queryable).GetMethods().First(method => method.Name == ""ThenByDescending"" && method.GetParameters().Length == 2).MakeGenericMethod(_entityType, memberExpression.Type); break; } MethodCallExpression methodCallExpression; if (resultExpression != null) // Exception // An unhandled exception of type 'System.ArgumentException' occurred in System.Core.dll // Additional information: Incorrect number of arguments supplied for call to method 'System.Linq.IOrderedQueryable`1[ConsoleApplication1.User] ThenBy[User,Int32](System.Linq.IOrderedQueryable`1[ConsoleApplication1.User], System.Linq.Expressions.Expression`1[System.Func`2[ConsoleApplication1.User,System.Int32]])' methodCallExpression = Expression.Call(orderByMethodInfo, _iQueryableParameterExpression, resultExpression, Expression.Lambda(memberExpression, _parameterExpression)); else methodCallExpression = Expression.Call(orderByMethodInfo, _iQueryableParameterExpression, Expression.Lambda(memberExpression, _parameterExpression)); resultExpression = Expression.Lambda(methodCallExpression, _iQueryableParameterExpression); } Expression<Func<IQueryable<TEntity>, IOrderedQueryable<TEntity>>> lambdaExpression = Expression.Lambda<Func<IQueryable<TEntity>, IOrderedQueryable<TEntity>>>(resultExpression, _parameterExpression); return lambdaExpression.Compile();} methodCallExpression = Expression.Call(orderByMethodInfo, _iQueryableParameterExpression, resultExpression, Expression.Lambda(memberExpression, _parameterExpression)); ","Creating Func<IQueryable<TEntity>, IOrderedQueryable<TEntity>> dynamically?"
C# string constants embedded twice?," Say I have a simple (the simplest?) C# program: If, I compile that code and look at the resultant .exe, I see the ""Hello, world"" string in the exe image as expected.If I refactor the code to: If I compile that code and look at the resultant .exe, I see the ""Hello, world"" string literal in the exe image twice. This was surprising to me. I was under the impression that string literals were shared, and that it would therefor only show up in the image one time. Can anyone explain this? Perhaps this second copy of the string is needed for reflection metadata? <code>  class Program { static void Main() { System.Console.WriteLine(""Hello, world""); }} class Program { const string Greeting = ""Hello, world""; static void Main() { System.Console.WriteLine(Greeting); }}",String constants embedded twice in .Net?
Keyword not supported: 'provider'. ASP.NET," I don't know why this error, I tried everything. I want to connect my webForm to the Database .accdband when I use using(){} I got this error ""Keyword not supported: 'provider""Here is the code:web.config WebForm1 <code>  <connectionStrings> <add name=""ConnectionString"" connectionString=""Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\Users\Manuel_2\Documents\Login.accdb"" providerName=""System.Data.OleDb"" /></connectionStrings> private static string conDB = ConfigurationManager.ConnectionStrings[""ConnectionString""].ConnectionString; protected void Page_Load(object sender, EventArgs e){ using (SqlConnection con = new SqlConnection(connDB)) //here is the error { // ..... } }",Keyword not supported: 'provider'. Opening SqlConnection
Create file html5 qt ubuntu app, How do I access public Documents folder on an Android phone's internal storage? I need to read and write publicly-accessible files into the Documents folder. <code> ,How do I access/read from/write to Documents folder in Internal Storage on Android devices?
Find product with maximum price," I have a products table like this:- I want to find the products who have maximum price for each productId.Sample Output:- I have tried this query:- This query is working fine, but my question is should i use OrderByDescending twice? I mean since i just want single item based on 1 property and suppose there are multiple other properties, so do i need to use same logic again and again?Edit:Pardon me forgot to mention, Please Assume ProductName can be different, Please check updated tables. <code>  ProductID ProductName Price 1 Milk 10 2 Banana 20 3 Apple 15 1 Grapes 12 2 Banana 25 1 Milk 8 ProductID ProductName Price 1 Grapes 12 2 Banana 25 3 Apple 15 List<Product> groups = products .GroupBy(p => p.ProductId) .Select(p => new Product { ProductId = p.Key, Name = p.OrderByDescending(o => o.Price).First().Name, Price = p.OrderByDescending(o => o.Price).First().Price, }) .ToList();",Should I use OrderByDescending twice in LINQ?
Design F# module to be called by C# (Console/MVC/WPF)," I have been trying to use Deedle F# Library to write an F# batch program. It has worked perfectly. However, I am not sure about the best design for the following 2 tasks:Combine the F# module into a existing ASP.net MVC/Web Api systemCreate a WPF interface to serve as a control panel and visual dependency controller for the various F# modules.The type of tasks the F# modules are doing are processing time series and applying statistical processes to derive new time series.I have been trying to create a class wrapper for the existing module so it can be called from C# code. I read from the C# Deep Dive that this is a better way to expose F# modules to C# callers.The following is a sample wrapper: The following is a sample module where most of the logic should reside: I have been trying to use NUnit to serve as a C# caller. I found myself putting most of the logic in the class do/let binding. The member methods are serving as passing the results to the caller. I don't think my approach is correct.Can someone point me to the right direction? (I attempted to learn the F# WPF Framework on GitHub, but I am not yet up to the task)I am aware Deedle is also avalable for C#. But, I really want to use F#. The sample code actually has too many side effects. <code>  type TimeSeriesDataProcessor(fileName:string) = let mutable _fileName = fileName let _rawInputData = loadCsvFile _fileName let _pivotedData = _rawInputData |> pivotRawData |> fillPivotedRawData |> calculateExpandingZscore //read and write member this.FileName with get () = _fileName and set (value) = _fileName <- value member this.RawInputData with get () = _rawInputData member this.PivotedData with get () = _pivotedData member this.rawInputDataCount with get () = _rawInputData.RowCount member this.pivotedDataCount with get () = _pivotedData.RowCount module Common = let loadCsvFile (fileName:string ) : Frame<int,string> = let inputData = Frame.ReadCsv(fileName) inputData let pivotRawData inputData:Frame<DateTime,string> = let pivotedData = inputData |> Frame.pivotTable (fun k r -> r.GetAs<DateTime>(""Date"")) (fun k r -> r.GetAs<string>(""Indicator"")) (fun f -> let maxVal = f?Value |> Stats.max match maxVal with | Some mv -> mv | _ -> Double.NaN ) pivotedData let fillPivotedRawData inputData:Frame<DateTime,string> = let filledA = inputData?A |> Series.fillMissing Direction.Forward inputData?A<-filledA let filledB = inputData?B |> Series.fillMissing Direction.Forward inputData?B<-filledB inputData let calculateExpandingZscore inputData:Frame<DateTime,string> = let expandingMeanColA = inputData?A |> Stats.expandingMean let expandingMeanColB = inputData?B |> Stats.expandingMean let expandingStdevColA = inputData?A |> Stats.expandingStdDev let expandingStdevColB = inputData?B |> Stats.expandingStdDev let expandingZscoreColA = (inputData?A - expandingMeanColA)/expandingStdevColA let expandingZscoreColB = (inputData?B - expandingMeanColB)/expandingStdevColB inputData?ExpdingMeanA <- expandingMeanColA inputData?ExpdingMeanB <- expandingMeanColB inputData?ExpdingStdevA <- expandingStdevColA inputData?ExpdingStdevB <- expandingStdevColB inputData?ExpdingZscoreA <- expandingZscoreColA inputData?ExpdingZscoreB <- expandingZscoreColB inputData",Designing an F# module to be called by C# (Console/MVC/WPF)
Create file to onedrive programmatically from c#?," I want to create a doc, docx, pptx or excel file from C# direct to my Onedrive account.I have try this but it's not working for me. Anybody have any idea what I did wrong ? Thanks EDITED:The error that I get is this one:""The header 'Content-Type' is missing the required parameter: 'boundary'.Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. Exception Details: Microsoft.Live.LiveConnectException: The header 'Content-Type' is missing the required parameter: 'boundary'."" <code>  public async Task<ActionResult> CreateWordFile(){ LiveLoginResult loginStatus = await authClient.InitializeWebSessionAsync(HttpContext); if (loginStatus.Status == LiveConnectSessionStatus.Connected) { var fileData = new Dictionary<string, object>(); fileData.Add(""name"", ""Document.docx""); fileData.Add(""Content-Type"", ""multipart/form-data; boundary=A300x""); fileData.Add(""type"", ""file""); LiveOperationResult getResult = await connectedClient.PostAsync(""me/skydrive/files"", fileData); } return View();}",Create file to Onedrive programmatically from C#?
Visual Studio Community 2013 and MVC 5, I am trying to start an MVC 5 project after installing a fresh installation of Visual Studio Community 2013 but when I go to New Project > Templates > Visual C# > Web > Version2012all I see in the middle pane is ASP.NET MVC 4 Web Application. Does anyone have any ideas why I do not have ASP.NET MVC 5 Web Application?I have .NET Framework 4.5.1 selected. <code> ,How to create ASP.NET MVC 5 Web Application in Visual Studio Community 2013?
Redirect Direct2D rendering to a WPF Controls," I'm developing a drawing application in Visual C++ by means of Direct2D.I have a demo application where: And when I receive the WM_PAINT message I draw my shapes.Now I need to develop a WPF control (a kind of Panel) that represents my new render target (therefore it would replace the main window m_hwnd), so that I can create a new (C#) WPF project with the main window that has as children my custom panel, while the rendering part remains in the native C++/CLI DLL project.How can I do that? What I have to set as my new render target?I thought to use the handle of my WPF window: But I need to draw on my panel and not on my window.Please note that I don't want to use any WPF classes for the rendering part (Shapes, DrawingVisuals...) <code>  // create the ID2D1FactoryD2D1CreateFactory(D2D1_FACTORY_TYPE_SINGLE_THREADED, &m_pDirect2dFactory);// create the main windowHWND m_hwnd = CreateWindow(...);// set the render target of type ID2D1HwndRenderTargetm_pDirect2dFactory->CreateHwndRenderTarget( D2D1::RenderTargetProperties(), D2D1::HwndRenderTargetProperties(m_hwnd, size), &m_pRenderTarget ); IntPtr windowHandle = new WindowInteropHelper(MyMainWindow).Handle;",Redirect Direct2D rendering to a WPF Control
C#6's Dictionary initialization - Clarification?," I've read that : The team have generally been busy implementing other variations on initializers. For example you can now initialize a Dictionary objectBut looking at : vs. I don't see where the benefit is. It looks the same. Both are nothing more than a name-value collection.They swapped pairs of curly braces for pairs of square brackets and some commasQuestion:What is the added value for using the new syntax ? A real world example would be much appreciated. <code>  var Dic = new Dictionary<string,int>{ {""x"",3}, {""y"",7} }; var Dic = new Dictionary<string,int>{ [""x""]=3, [""y""]=7 };",C# 6.0's new Dictionary Initializer - Clarification
C#6's new Collection Initializer - Clarification?," I've read that : The team have generally been busy implementing other variations on initializers. For example you can now initialize a Dictionary objectBut looking at : vs. I don't see where the benefit is. It looks the same. Both are nothing more than a name-value collection.They swapped pairs of curly braces for pairs of square brackets and some commasQuestion:What is the added value for using the new syntax ? A real world example would be much appreciated. <code>  var Dic = new Dictionary<string,int>{ {""x"",3}, {""y"",7} }; var Dic = new Dictionary<string,int>{ [""x""]=3, [""y""]=7 };",C# 6.0's new Dictionary Initializer - Clarification
how to set http protocol version in system.net.http.httpclient?," I need to make a request to a webservice that uses HTTP version 1.0. Im using HttpClient , But I cant see any option to set HTTP version.Where can i set the request version? <code> ",Set HTTP protocol version in HttpClient
The type x has multiple constructors of length 1. Unable to disambiguate," I'm working at a ASP.NET Webforms project and is using Unity for DI.This project also use DevExpress ASP.NET Ajax Controls.Now we have run into problem and it seems to be a conflict between DevExpress and Unity.This is the Unity configuration Any of this Unity configuration has nothing to do with the DevExpress controls, but i think it hooks up the HttpContext object.And this error appears only when i use the TabControl from DevExpress, all other controls works well.See the attached image that describe the error message more in detail. <code>  [assembly: WebActivator.PostApplicationStartMethod(typeof(Sales.Web.App_Start.UnityWebFormsStart), ""PostStart"")]namespace Sales.Web.App_Start{ /// <summary> /// Startup class for the Unity.WebForms NuGet package. /// </summary> internal static class UnityWebFormsStart { /// <summary> /// Initializes the unity container when the application starts up. /// </summary> /// <remarks> /// Do not edit this method. Perform any modifications in the /// <see cref=""RegisterDependencies"" /> method. /// </remarks> internal static void PostStart() { IUnityContainer container = new UnityContainer(); HttpContext.Current.Application.SetContainer(container); RegisterDependencies(container); } /// <summary> /// Registers dependencies in the supplied container. /// </summary> /// <param name=""container"">Instance of the container to populate.</param> private static void RegisterDependencies(IUnityContainer container) { // TODO: Add any dependencies needed here container .RegisterType<IDbFactory, DbFactory>(new HierarchicalLifetimeManager()) .RegisterType(typeof(IDbProxy<>), typeof(DbProxy<>)) .RegisterType<IErpData, ErpData>(new HierarchicalLifetimeManager()) .RegisterType<ICaseData, CaseData>(new HierarchicalLifetimeManager()) .RegisterType<ICaseCauseData, CaseCauseData>(new HierarchicalLifetimeManager()) .RegisterType<ICaseHandler, CaseHandler>(new HierarchicalLifetimeManager()); } }}",The type X has multiple constructors of length 1. Unable to disambiguate
What's the most efficient way to do a double loop that searches class lists?," Codewise, what it the cleanest way to do this using linq? Below, I have a crude example where I want to find a matching class instance based on name.  <code>  class item{ string name {get;set;} int identifier {get;set;}}void DoSomething(){ List<item> List1 = GetSampleItems(); List<item> List2 = GetOtherSampleItems(); for(int a=0;a<List1.count;a++) { for(int b=0;b<List2.count;b++) { if(List1[a].identifier == List2[b].identifier) { List1[a].name = List2[b].name; } } }}","How to replace nested loops with LINQ - in a clean, manageable manner"
How to replace nested loops with LINQ - in a more efficient manner," Codewise, what it the cleanest way to do this using linq? Below, I have a crude example where I want to find a matching class instance based on name.  <code>  class item{ string name {get;set;} int identifier {get;set;}}void DoSomething(){ List<item> List1 = GetSampleItems(); List<item> List2 = GetOtherSampleItems(); for(int a=0;a<List1.count;a++) { for(int b=0;b<List2.count;b++) { if(List1[a].identifier == List2[b].identifier) { List1[a].name = List2[b].name; } } }}","How to replace nested loops with LINQ - in a clean, manageable manner"
How to add a simple user roles - Asp.net MVC C#," I'm pretty new to ASP.NET MVC, and I've been looking at a lot of different ways of adding User Rolesfor my ASP.NET MVC site. I want to use the users' database(s) that are automatically made for you when you make a new ASP.NET MVC project.That contain the tables:AspNetRolesAspNetUserClaimsAspNetUserLoginsAspNetUserRolesAspNetUsersI've been looking at a few tutorials and it's a bit of a minefield for beginners I think.All I want to be able to do is something like this: So users with the role administrator can access the index page. <code>  [Authorize(Roles = ""admin"")]public ActionResult Index(){ Return View();}",How to add a simple user roles - ASP.NET MVC C#
How to pass a value to razor variable from jquery variable?," How to pass a value to razor variable from javascript variable, is it possible asp.net mvc razor view engine? <code>  @{ int a = 0;}<script> var b = ... @a = b;</script>",How to pass a value to razor variable from javascript variable?
Tell json .net to write a single-quote rather than a double quote when serializing objects," When calling Newtonsoft.Json.JsonConvert.SerializeObject(myObject) I'm getting keys and values enclosed in double quotes like this:{""key"" : ""value""}I would like them to be enclosed in single-quotes like this:{'key' : 'value'}Is it possible to do using Json.Net? <code> ",Tell Json.Net to write a single-quote rather than a double quote when serializing objects
keep getting A second operation started on this context before a previous asynchronous operation completed," I am trying following code, it has two parts, one is navigation via prism.When navigation is allowed I am starting a deep load asynchronously but each time with a new context. In later code I would want to cancel pending navigations that are not finished this loading but the below code does not even work so cancellation is a matter for later ;-)navigation logic : no problems here deep loading logic: I keep getting exceptions as if I forgot to await, but this is never the case.I also use configureawait(true) properly whenever I want continuation on the GUI thread. But I keep getting this error in the deeploading logic. The unit of work and repository classes also use the async await mechanism but also there I am awaiting properly.A second operation started on this context before a previous asynchronous operation completed. Use 'await' to ensure that any asynchronous operations have completed before calling another method on this context. Any instance members are not guaranteed to be thread safe.Edit (removed logger code to reduce the code size)  <code>  public void OnNavigatedTo(NavigationContext navigationContext){ int relatieId = (int)navigationContext.Parameters[""RelatieId""]; if (_relatie != null && _relatie.RelatieId == relatieId) return; loadRelatieAsync(relatieId);}public void ConfirmNavigationRequest(NavigationContext navigationContext, Action<bool> continuationCallback){ bool navigationAllowed = true; continuationCallback(navigationAllowed);} private async Task loadRelatieAsync(int relatieId){ try { await Task.Run(async () => { _unitOfWork = _UnitOfWorkFactory.createUnitOfWorkAsync(); IEnumerable<Relatie> relaties = await getRelatieAsync(_unitOfWork, relatieId).ConfigureAwait(true); _relatieTypeTypes = await getRelatieTypeTypesAsync(_unitOfWork, relatieId).ConfigureAwait(true); _relatie = relaties.FirstOrDefault(); _unitOfWork.Dispose(); }).ConfigureAwait(true); processRelatie(_relatie); processRelatieTypes(_relatie, _relatieTypeTypes); } catch (Exception Ex) { MessageBox.Show(Ex.Message); throw; }}private async Task<IEnumerable<Relatie>> getRelatieAsync(IUnitOfWorkAsync unitOfWork, int relatieId){ IEnumerable<Relatie> relaties = null; try { IRepositoryAsync<Relatie> relatieRepository = unitOfWork.RepositoryAsync<Relatie>(); relaties = await relatieRepository .Query(r => r.RelatieId == relatieId) .Include(i => i.BegrafenisOndernemer) .SelectAsync() .ConfigureAwait(false); IRepositoryAsync<Adres> adresRepository = unitOfWork.RepositoryAsync<Adres>(); //exception is thrown after executing following line var adressen = await adresRepository .Query(r => r.RelatieId == relatieId) .Include(i => i.AdresType) .SelectAsync() .ConfigureAwait(false); _relatieTypeRepository = unitOfWork.RepositoryAsync<RelatieType>(); var relatieTypes = await _relatieTypeRepository .Query(r => r.RelatieId == relatieId) .SelectAsync() .ConfigureAwait(false); } catch (Exception Ex) { MessageBox.Show(Ex.Message);//exception is shown here throw; } return relaties;}private async Task<IEnumerable<RelatieTypeType>> getRelatieTypeTypesAsync(IUnitOfWorkAsync unitOfWork, int relatieId){ IEnumerable<RelatieTypeType> relatieTypeTypes = null; try { IRepositoryAsync<RelatieTypeType> relatieTypeTypeRepository = unitOfWork.RepositoryAsync<RelatieTypeType>(); relatieTypeTypes = await relatieTypeTypeRepository .Query() .SelectAsync() .ConfigureAwait(false); } catch (Exception Ex) { MessageBox.Show(Ex.Message); throw; } return relatieTypeTypes;}",UOW - A second operation started on this context before a previous asynchronous operation completed
DDD | Onion Architecture: should i abstract the validation framework from Domain layer?, I am using FluentValidation to validate my service operations. My code looks like: UserValidator implements FluentValidation.AbstractValidator.DDD says that domain layer have to be technology independent. What I am doing is using a validation framework instead of custom exceptions.It's a bad idea to put validation framework in the domain layer? <code>  using FluentValidation;IUserService{ void Add(User user);}UserService : IUserService{ public void Add(User user) { new UserValidator().ValidateAndThrow(user); userRepository.Save(user); }} ,Should I abstract the validation framework from Domain layer?
Should i abstract the validation framework from Domain layer?, I am using FluentValidation to validate my service operations. My code looks like: UserValidator implements FluentValidation.AbstractValidator.DDD says that domain layer have to be technology independent. What I am doing is using a validation framework instead of custom exceptions.It's a bad idea to put validation framework in the domain layer? <code>  using FluentValidation;IUserService{ void Add(User user);}UserService : IUserService{ public void Add(User user) { new UserValidator().ValidateAndThrow(user); userRepository.Save(user); }} ,Should I abstract the validation framework from Domain layer?
Expression-bodied function members performance in C# 6.0," In a new C# 6.0 we can define methods and properties using lambda expressions.For instance this property can be now defined as follows: The information about expression-boided function members you can find here: http://blogs.msdn.com/b/csharpfaq/archive/2014/11/20/new-features-in-c-6.aspxDoes anyone know if there's any overhead when using new syntax? Can it slow down (or improve efficiency of) the application or maybe it doesn't matter? <code>  public string Name { get { return First + "" "" + Last; } } public string Name => First + "" "" + Last; ",Expression-bodied function members efficiency and performance in C# 6.0
Navigation stack how clear, I have problem for Navigation in my app. I use xamarin.forms how can clean my navigation stack. No use Pop and push. Can I see my full navigation stack ? <code> ,How do I clear the Navigation stack?
How to get a reference to the parent object in a deserialized MongoDB document (C#)," I hope someone can help. I'm getting to grips with the C# driver for MongoDB and how it handles serialization. Consider the following example classes: Note that SubThing has a property that references its parent. So when creating objects I do so like this: The ParentThing property is set to BsonIgnore because otherwise it would cause a circular reference when serialising to MongoDB.When I do serialize to MongoDB it creates the document exactly how I expect it to be: Here is the problem: When I deserialize I loose SubThing's reference to its parent. Is there any way to configure deserialization so that the ParentThing property is always its parent document? <code>  class Thing{ [BsonId] public Guid Thing_ID { get; set; } public string ThingName {get; set; } public SubThing ST { get; set; } public Thing() { Thing_ID = Guid.NewGuid(); }}class SubThing{ [BsonId] public Guid SubThing_ID { get; set; } public string SubThingName { get; set; } [BsonIgnore] public Thing ParentThing { get; set; } public SubThing() { SubThing_ID = Guid.NewGuid(); }} Thing T = new Thing(); T.ThingName = ""My thing""; SubThing ST = new SubThing(); ST.SubThingName = ""My Subthing""; T.ST = ST; ST.ParentThing = T; {""_id"" : LUUID(""9d78bc5c-2abd-cb47-9478-012f9234e083""),""ThingName"" : ""My thing"",""ST"" : { ""_id"" : LUUID(""656f17ce-c066-854d-82fd-0b7249c80ef0""), ""SubThingName"" : ""My Subthing""}",How to get a reference to the parent object in a deserialized MongoDB document?
Return id after insert C# MSSQL," I know this question has been on this site many times, but I can't get my code working.I have an Insert statement, and I need the id from that statement on my asp.net page.I'm getting the return value 0. <code>  public int newid { get; set; }public void CreateAlbum(string _titel, string _name, string _thumb, int _userid){ objCMD = new SqlCommand(@""INSERT INTO tblFotoalbum (fldAlbumHead, fldAlbumName, fldAlbumThumb, fldUserID_FK) VALUES (@titel, @name, @thumb, @userid); SET @newid = SCOPE_IDENTITY()""); objCMD.Parameters.AddWithValue(""@titel"", _titel); objCMD.Parameters.AddWithValue(""@name"", _name); objCMD.Parameters.AddWithValue(""@thumb"", _thumb); objCMD.Parameters.AddWithValue(""@userid"", _userid); objCMD.Parameters.AddWithValue(""@newid"", newid); objData.ModifyData(objCMD); }",Return id after insert C# using SQL Server
Determine a number can be represented in float/double format precisly," How to determine if a number, for example 1.577, can be precisely represented in float or double format? It means it is real 1.577 not a 1.566999999999994324 etc.EDIT:I'm looking for a tool, where I can type a number and it will display double/float representation of it. So it's not only c# related question. <code> ",Determine if a number can be precisely represented in float/double format
C# event source vs original source," I'm reading C# WPF book and in routed events chapter, event has 2 same properties Source and OriginalSource. I did not see the difference between them:Xaml: Code behind: and flag property true here, can some one explain why 2 same property or in this case this properties has no effects? or where can we see use case for this properties? <code>  <Button Name=""Ok"" Click=""Ok_Click""/> private void Ok_Click(object sender, RoutedEventArgs e){ bool flag = false; var source = e.Source; var originalSource = e.OriginalSource; if (source == originalSource) { flag = true; }}",Event source vs original source
Checking if type or instance impliments IEnumerable regardless of type T," I'm doing a heavy bit of reflection in my current project, and I'm trying to provide a few helper methods just to keep everything tidy.I'd like to provide a pair of methods to determine if a type or instance implements IEnumerable regardless of the type T. Here is what I have at the moment: When I test them using I get this as the result: The type method doesn't appear to work at all I had expected a true for the direct System.Collections.IEnumerable match at least.I'm aware that string is technically enumerable, albeit with a few caveats. Ideally in this case, however, I'd need the helper method to return false for it. I just need the instances with a defined IEnumerable<T> type to return true.I've probably just missed something fairly obvious can anyone point me in the right direction? <code>  public static bool IsEnumerable(this Type type){ return (type is IEnumerable);}public static bool IsEnumerable(this object obj){ return (obj as IEnumerable != null);} Debug.WriteLine(""Type IEnumerable: "" + typeof(IEnumerable).IsEnumerable());Debug.WriteLine(""Type IEnumerable<>: "" + typeof(IEnumerable<string>).IsEnumerable());Debug.WriteLine(""Type List: "" + typeof(List<string>).IsEnumerable());Debug.WriteLine(""Type string: "" + typeof(string).IsEnumerable());Debug.WriteLine(""Type DateTime: "" + typeof(DateTime).IsEnumerable());Debug.WriteLine(""Instance List: "" + new List<string>().IsEnumerable());Debug.WriteLine(""Instance string: "" + """".IsEnumerable());Debug.WriteLine(""Instance DateTime: "" + new DateTime().IsEnumerable()); Type IEnumerable: FalseType IEnumerable<>: FalseType List: FalseType string: FalseType DateTime: FalseInstance List: TrueInstance string: TrueInstance DateTime: False",Checking if Type or instance implements IEnumerable regardless of Type T
c# remove duplicates from list based on multiple fields or columns," I have a list of type MyClass This list will have duplicates. I want to find and remove items from this list where prop1, prop2 and prop3 are duplicates. It doesnt matter if the other properties are duplicatesThis is what I have tried that is not working. I dont want to use any third party tools for this. Only pure linq. <code>  public class MyClass{ public string prop1 {} public int prop2 {} public string prop3 {} public int prop4 {} public string prop5 {} public string prop6 {} ....} List<MyClass> noDups = myClassList.GroupBy(d => new {d.prop1,d.prop2,d.prop3} ).Where(g => g.Count() > 1).Select(g=> g.Key);",Remove duplicates from list based on multiple fields or columns
Live Visual Tree / Live Properties, I downloaded the new Visual Studio 2015 CTP6 to test the new XAML debugging features - but I can't find them? I've read that those windows should open right after starting the debugging but they do not appear - anyone know what I'm doing wrong? <code> ,Debug XAML in Visual studio 2015. Where is Live Visual Tree and Live Properties
Where is Visual studio 2015 Live Visual Tree and Live Properties, I downloaded the new Visual Studio 2015 CTP6 to test the new XAML debugging features - but I can't find them? I've read that those windows should open right after starting the debugging but they do not appear - anyone know what I'm doing wrong? <code> ,Debug XAML in Visual studio 2015. Where is Live Visual Tree and Live Properties
Regex - capture optional surrounding characters," I'm not that savvy in regex, so I'm not sure how to achieve the following thing:I'd like to capture any arbitary string from an input that may or may not be surrounded by the '$' character. If a '$' character is present at the beginning of the string, the '$' character at the end must be present.Currently I have which roughly translates to:Arbitary word charactersBeginning of capture groupany character of '_', '.', '-'Before an optional \nSo valid matches would be: Now I'd like to make this possible But not... <code>  ^\w+([_.-]\w+)*$ testtest-5test.1.3test-alpha.2 $test$ $test (or test$)",capture optional surrounding characters
How does c# handle nested (sealed) (generic) types? How many types are actually generated?," I'm trying to understand how C# views types in the face of nesting.More specifically I'm trying to understand why some types are not considered assignment compatible or even castable, when there ""kind of"" only exist one definition of the nested class. Does the compiler / CLR actually generate different types for these, or what rules are at play exactly...Example code: So even though the nested instance is created as a Private2.Nested it can not be casted to that type. And... well... how do the different Nested types relate to each other given that Nested is in fact sealed? (They can't be inheriting from each other right? But on the other hand their implementation should be 100% identical... am I wrong?)Primary question: What exactly is the compiler doing when it ""compiles"" this nested class?? How many unique types (excluding valuetype-related) are actually generated, and if it is all the ""same"" type, is the restriction artificial (as in wouldn't an unsafe cast actually work)? (What I'm saying is that the IL for all these types comes from the same code definition - so at some level the compiler must know. Are instances of these types not bit-for-bit identical apart from their type-names?)Secondary question: not what I'm really asking here, mostly for brevity / context: is there some simple change that would make the above work? Am I missing something obvious? The type Foo<T> must never be directly referenced inside Private1<T2> - only use of T2 is allowed. Foo<T> is just my example stand in for nasty generic classes with 10~20 generic types. It's all just a ""workaround"" for not being able to alias a generic class with its types: Purpose: To avoid types of fields and method-parameters that are several screens wide and utterly unreadable! >:( ...As a side note I really wished this could be used as a type inside classes and interfaces, as in Private2 : Private1<this>. Well ok, that wouldn't work because it collides with extension syntax on methods, but something similar, perhaps <this>, <super>, <base> used like Method(<this> arg) or Private2 : Private1<<super>> ... kind of weird maybe. <code>  public class Foo<T>{ protected class Private2 : Private1<Foo<T>> { } protected class Private1<T2> where T2 : Foo<T> { public sealed class Nested { public void Test(T2 foo) { foo.Method2(this); //Nope! var nes = (Private2.Nested)this; //Nope! } } } public void Method1() { var nested = new Private2.Nested(); nested.Test(this); } private void Method2(Private2.Nested nested) { // something code... }} public class Bar<GoodName, OtherName, Readability, NopeMr, DontThinkSo, Suffering, Dispair>{ //If only this was real... using BarT = Bar<GoodName, OtherName, Readability, NopeMr, DontThinkSo, Suffering, Dispair>; public void Method1(BarT bar) { ... } //so good!! //goodbye readability... see you never... public void Method2(Bar<GoodName, OtherName, Readability, NopeMr, DontThinkSo, Suffering, Dispair> whatIsThisVariable) { ... }}",How does c# handle nested (generic) types?
"How does c# handle nested (generic) types? Doesn't these ""casts"" break spec?"," I'm trying to understand how C# views types in the face of nesting.More specifically I'm trying to understand why some types are not considered assignment compatible or even castable, when there ""kind of"" only exist one definition of the nested class. Does the compiler / CLR actually generate different types for these, or what rules are at play exactly...Example code: So even though the nested instance is created as a Private2.Nested it can not be casted to that type. And... well... how do the different Nested types relate to each other given that Nested is in fact sealed? (They can't be inheriting from each other right? But on the other hand their implementation should be 100% identical... am I wrong?)Primary question: What exactly is the compiler doing when it ""compiles"" this nested class?? How many unique types (excluding valuetype-related) are actually generated, and if it is all the ""same"" type, is the restriction artificial (as in wouldn't an unsafe cast actually work)? (What I'm saying is that the IL for all these types comes from the same code definition - so at some level the compiler must know. Are instances of these types not bit-for-bit identical apart from their type-names?)Secondary question: not what I'm really asking here, mostly for brevity / context: is there some simple change that would make the above work? Am I missing something obvious? The type Foo<T> must never be directly referenced inside Private1<T2> - only use of T2 is allowed. Foo<T> is just my example stand in for nasty generic classes with 10~20 generic types. It's all just a ""workaround"" for not being able to alias a generic class with its types: Purpose: To avoid types of fields and method-parameters that are several screens wide and utterly unreadable! >:( ...As a side note I really wished this could be used as a type inside classes and interfaces, as in Private2 : Private1<this>. Well ok, that wouldn't work because it collides with extension syntax on methods, but something similar, perhaps <this>, <super>, <base> used like Method(<this> arg) or Private2 : Private1<<super>> ... kind of weird maybe. <code>  public class Foo<T>{ protected class Private2 : Private1<Foo<T>> { } protected class Private1<T2> where T2 : Foo<T> { public sealed class Nested { public void Test(T2 foo) { foo.Method2(this); //Nope! var nes = (Private2.Nested)this; //Nope! } } } public void Method1() { var nested = new Private2.Nested(); nested.Test(this); } private void Method2(Private2.Nested nested) { // something code... }} public class Bar<GoodName, OtherName, Readability, NopeMr, DontThinkSo, Suffering, Dispair>{ //If only this was real... using BarT = Bar<GoodName, OtherName, Readability, NopeMr, DontThinkSo, Suffering, Dispair>; public void Method1(BarT bar) { ... } //so good!! //goodbye readability... see you never... public void Method2(Bar<GoodName, OtherName, Readability, NopeMr, DontThinkSo, Suffering, Dispair> whatIsThisVariable) { ... }}",How does c# handle nested (generic) types?
How to add an action to all event handler in a VS solution with multiple projects?," IntroductionI have a WPF application with code written in C#, developed in Visual Studio 2013. This is a GUI solution and has many interdependent projects, complete with buttons, fields, menus, checkboxes and text.Logging user actionsMy goal is to create a log file (a txt file will do) of all actions that an end user takes while using this application. Example actions could be a button-click, writing in a blank text field, (de)select a check-box, close an activity/tab, etc. I want to capture all such user interactions in the application UI, and have those actions stored as summarized one line descriptions of the action in a text log file.Possible solutionsBrute force methodOne way to do this could be to update the event handlers of all the aforementioned elements (button, textfield, ...) with the code to write a summary of the action to append to a txt log file. For example, in an accept button click handler: But this strategy will be very painful to accomplish, having to update each and every event handler (and even write event handlers for elements which don't have any currently).Better way(s)I am looking for a simpler way in which this could be achieved. Some ideas that I have are:One way is changing the event handler base class (that all other event handlers inherit from?) to contain the log file writing code. This way the log file code will need to be written only once, and it will be called whenever any event handler is called, which is what we want (There needs to be a distinction made between a user generated events and an app generated event, which can prove difficult in case of event chaining. So this could be a challenge).Another way is using some ""sniffer"" which works like a debugger and stores the stack trace of an application's methods, as the user moves through it. This would give us only a partial idea of the user's workflows. Adding a time stamp to the message would be useful... ... because, deleting the messages which have a time stamp difference from that of the previous message below a suitable threshold, would leave only the methods that were directly called by the user actions. Assuming that methods signatures are descriptive enough, this message list could work as the desired log file. However, this will only work for elements that have event handlers associated with them. Still, it's better than the brute force method.Suggestion(s)?I am having some difficulty in coming up with a way to implement these ideas. Can anyone elaborate on how they could be implemented? Or if you can come up with better ways to make the log file, please share your ideas and also how it can be developed. Thank you! <code>  private void buttonAccept_Click(object sender, EventArgs e) { // TODO: default button click handler code... // TODO: ...and the code to write the event to a txt log file } private void buttonAccept_Click(object sender, EventArgs e) private bool IsValidName(string userName) private void buttonCancel_Click(object sender, EventArgs e) private void Close() ... 3/1/2015 18:19 private void buttonAccept_Click(object sender, EventArgs e) 3/1/2015 18:19 private bool IsValidName(string userName) 3/1/2015 18:21 private void buttonCancel_Click(object sender, EventArgs e) 3/1/2015 18:21 private void Close() ... 3/1/2015 18:19 private void buttonAccept_Click(object sender, EventArgs e) 3/1/2015 18:21 private void buttonCancel_Click(object sender, EventArgs e) ...",How to capture all user actions in a WPF application to store them in a log file?
How to capture all user actions in a GUI application to store them in a log file?," IntroductionI have a WPF application with code written in C#, developed in Visual Studio 2013. This is a GUI solution and has many interdependent projects, complete with buttons, fields, menus, checkboxes and text.Logging user actionsMy goal is to create a log file (a txt file will do) of all actions that an end user takes while using this application. Example actions could be a button-click, writing in a blank text field, (de)select a check-box, close an activity/tab, etc. I want to capture all such user interactions in the application UI, and have those actions stored as summarized one line descriptions of the action in a text log file.Possible solutionsBrute force methodOne way to do this could be to update the event handlers of all the aforementioned elements (button, textfield, ...) with the code to write a summary of the action to append to a txt log file. For example, in an accept button click handler: But this strategy will be very painful to accomplish, having to update each and every event handler (and even write event handlers for elements which don't have any currently).Better way(s)I am looking for a simpler way in which this could be achieved. Some ideas that I have are:One way is changing the event handler base class (that all other event handlers inherit from?) to contain the log file writing code. This way the log file code will need to be written only once, and it will be called whenever any event handler is called, which is what we want (There needs to be a distinction made between a user generated events and an app generated event, which can prove difficult in case of event chaining. So this could be a challenge).Another way is using some ""sniffer"" which works like a debugger and stores the stack trace of an application's methods, as the user moves through it. This would give us only a partial idea of the user's workflows. Adding a time stamp to the message would be useful... ... because, deleting the messages which have a time stamp difference from that of the previous message below a suitable threshold, would leave only the methods that were directly called by the user actions. Assuming that methods signatures are descriptive enough, this message list could work as the desired log file. However, this will only work for elements that have event handlers associated with them. Still, it's better than the brute force method.Suggestion(s)?I am having some difficulty in coming up with a way to implement these ideas. Can anyone elaborate on how they could be implemented? Or if you can come up with better ways to make the log file, please share your ideas and also how it can be developed. Thank you! <code>  private void buttonAccept_Click(object sender, EventArgs e) { // TODO: default button click handler code... // TODO: ...and the code to write the event to a txt log file } private void buttonAccept_Click(object sender, EventArgs e) private bool IsValidName(string userName) private void buttonCancel_Click(object sender, EventArgs e) private void Close() ... 3/1/2015 18:19 private void buttonAccept_Click(object sender, EventArgs e) 3/1/2015 18:19 private bool IsValidName(string userName) 3/1/2015 18:21 private void buttonCancel_Click(object sender, EventArgs e) 3/1/2015 18:21 private void Close() ... 3/1/2015 18:19 private void buttonAccept_Click(object sender, EventArgs e) 3/1/2015 18:21 private void buttonCancel_Click(object sender, EventArgs e) ...",How to capture all user actions in a WPF application to store them in a log file?
Entity Framework 6. How to use transactions for different contexts?," In my application I have method looks like this: And each of the internal methods looks like this: For example, DoFirstSubOperation() and DoSecondSubOperation() complete successfully, but DoThirdSubOperation() fails.How do I rollback the changes made by the first two functions?This approach has not brought results: The only solution I see is to define the context like so: But is it acceptable to do so? Or is there another solution? <code>  public static bool DoLargeOperation(){ bool res = true; res = res && DoFirstSubOperation(); res = res && DoSecondSubOperation(); res = res && DoThirdSubOperation(); return res;} public static bool DoFirstSubOperation(){ using (var context = new EntityFrameworkContext()) { // data modification. context.SaveChanges(); }} using (var transaction = new TransactionScope()){ res = res && DoFirstSubOperation(); res = res && DoSecondSubOperation(); res = res && DoThirdSubOperation();} public static bool DoLargeOperation(){ bool res = true; using (var context = new EntityFrameworkContext()) { using (var transaction = context.Database.BeginTransaction()) { res = res && DoFirstSubOperation(context); res = res && DoSecondSubOperation(context); res = res && DoThirdSubOperation(context); if (res) { transaction.Commit(); } else { transaction.Rollback(); } } } return res;}",How to use transactions for different contexts?
Disable re-queue-ing of Failed Hangfire BackgroundJob, Is there a way to disable re-queueing of a failed Hangfire BackgroundJob?We do not want the failed jobs to be executed again as this might cause issues. <code> ,Disable re-queueing of failed Hangfire BackgroundJob
How to AutoMapper an string to a enum?," I have the following classes domain and Dto classes: I used the following method: Afterwards, I get the following error: Requested value 'Level Two' was not found.How do I map it correctly? <code>  public class Profile{ public string Name { get; set; } public string SchoolGrade { get; set; } }public class ProfileDTO{ public string Name { get; set; } public SchoolGradeDTO SchoolGrade { get; set; } }public enum SchoolGradeDTO { [Display(Name = ""Level One""] LevelOne, [Display(Name = ""Level Two""] LevelTwo,} Mapper.CreateMap<Profile, ProfileDTO>() .ForMember(d => d.SchoolGrade , op => op.MapFrom(o => o.SchoolGrade))",Using AutoMapper to map a string to an enum
StackOverflow Doing Boxing C#," I have these two chunks of code in C#:First Second They both do the same:Create a Stack (generic in <int> for the first example and a stack of object for the second one).Declare a method that calls itself recursively n times (n >= 0) and in every step push 1000 integers inside the created stack.When I run the first example with Foo(30000) no exception occurs, however the second example crashes with Foo(1000), just n = 1000.When I saw the CIL generated for both cases the only difference was the boxing part for every push:First Second My question is: Why, if there is not significant overload of CIL's stack for the second example, does it crash ""faster"" than the first one? <code>  class Program{ static Stack<int> S = new Stack<int>(); static int Foo(int n) { if (n == 0) return 0; S.Push(0); S.Push(1); ... S.Push(999); return Foo( n-1 ); }} class Program{ static Stack S = new Stack(); static int Foo(int n) { if (n == 0) return 0; S.Push(0); S.Push(1); ... S.Push(999); return Foo( n-1 ); }} IL_0030: ldsfld class [System]System.Collections.Generic.Stack`1<int32> Test.Program::SIL_0035: ldc.i4 0x3e7IL_003a: callvirt instance void class [System]System.Collections.Generic.Stack`1<int32>::Push(!0)IL_003f: nop IL_003a: ldsfld class [mscorlib]System.Collections.Stack Test.Program::SIL_003f: ldc.i4 0x3e7IL_0044: box [mscorlib]System.Int32IL_0049: callvirt instance void [mscorlib]System.Collections.Stack::Push(object)IL_004e: nop",Stackoverflow doing boxing in C#
Newtonsoft JSON.NET and Mono on Mac OSX fails in glorious manner," I've built a distributed systems application that makes heavy use of JSON. The app runs great natively on Windows (tested on 7, 8, 8.1, Server 2008, Server 2012) and Ubuntu 14.04 with MonoHowever, the app fails in a glorious manner when I attempt to run it on OSX Yosemite 10.10.2 (maybe others). I've isolated some of the calls to Newtonsoft JSON.NET and run them in a standalone sandboxed app and can never reproduce the issue. I've pasted the debug information below in hopes that someone sees something in the stack trace or otherwise that might point to an obvious problem. I removed a bunch of thread-related data for brevity. The full text can be seen here: https://gist.github.com/jchristn/677c53abc3c3028d804fThe serialize_json method is as follows (quite simple): And the Mono version: The JSON string in question looks like: And its definition: This is on an older Macbook Pro, but it has a Core 2 Duo and 8GB of RAM. There is nothing else running on the machine.Also tried updating Mono to 3.12.1 and it has the same issue. I've also tried running within Mono on Windows and the issue does not appear (v3.12.1).  <code>  Stacktrace: at <unknown> <0xffffffff> at (wrapper managed-to-native) object.__icall_wrapper_mono_gc_alloc_vector (intptr,intptr,intptr) <0xffffffff> at (wrapper alloc) object.AllocVector (intptr,intptr) <0xffffffff> at System.Reflection.Emit.DynamicMethod.AddRef (object) <0x00077> at System.Reflection.Emit.DynamicMethodTokenGenerator.GetToken (System.Reflection.MemberInfo,bool) <0x0001b> at System.Reflection.Emit.ILGenerator.Emit (System.Reflection.Emit.OpCode,System.Type) <0x000ee> at Newtonsoft.Json.Utilities.ILGeneratorExtensions.BoxIfNeeded (System.Reflection.Emit.ILGenerator,System.Type) <0x0007a> at Newtonsoft.Json.Utilities.DynamicReflectionDelegateFactory.GenerateCreateGetPropertyIL (System.Reflection.PropertyInfo,System.Reflection.Emit.ILGenerator) <0x0009b> at Newtonsoft.Json.Utilities.DynamicReflectionDelegateFactory.CreateGet<T> (System.Reflection.PropertyInfo) <0x000bf> at Newtonsoft.Json.Utilities.ReflectionDelegateFactory.CreateGet<T> (System.Reflection.MemberInfo) <0x0007d> at Newtonsoft.Json.Serialization.DynamicValueProvider.GetValue (object) <0x0003f> at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.CalculatePropertyValues (Newtonsoft.Json.JsonWriter,object,Newtonsoft.Json.Serialization.JsonContainerContract,Newtonsoft.Json.Serialization.JsonProperty,Newtonsoft.Json.Serialization.JsonProperty,Newtonsoft.Json.Serialization.JsonContract&,object&) <0x000fe> at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject (Newtonsoft.Json.JsonWriter,object,Newtonsoft.Json.Serialization.JsonObjectContract,Newtonsoft.Json.Serialization.JsonProperty,Newtonsoft.Json.Serialization.JsonContainerContract,Newtonsoft.Json.Serialization.JsonProperty) <0x00197> at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeValue (Newtonsoft.Json.JsonWriter,object,Newtonsoft.Json.Serialization.JsonContract,Newtonsoft.Json.Serialization.JsonProperty,Newtonsoft.Json.Serialization.JsonContainerContract,Newtonsoft.Json.Serialization.JsonProperty) <0x0015f> at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize (Newtonsoft.Json.JsonWriter,object,System.Type) <0x000bf> at Newtonsoft.Json.JsonSerializer.SerializeInternal (Newtonsoft.Json.JsonWriter,object,System.Type) <0x0053b> at Newtonsoft.Json.JsonSerializer.Serialize (Newtonsoft.Json.JsonWriter,object,System.Type) <0x00019> at Newtonsoft.Json.JsonConvert.SerializeObjectInternal (object,System.Type,Newtonsoft.Json.JsonSerializer) <0x000e7> at Newtonsoft.Json.JsonConvert.SerializeObject (object,System.Type,Newtonsoft.Json.Formatting,Newtonsoft.Json.JsonSerializerSettings) <0x0003f> at Newtonsoft.Json.JsonConvert.SerializeObject (object,Newtonsoft.Json.Formatting,Newtonsoft.Json.JsonSerializerSettings) <0x00017> at kvpbase.kvpserver.serialize_json (object) <0x000e7> at kvpbase.kvpserver.obj_write (System.Net.HttpListenerContext,kvpbase.request_metadata,kvpbase.obj) <0x01bd7> at kvpbase.kvpserver.put_handler (System.Net.HttpListenerContext,kvpbase.request_metadata) <0x00f4f> at kvpbase.kvpserver.user_api (System.Net.HttpListenerContext,kvpbase.request_metadata) <0x0062f> at kvpbase.kvpserver.processor (System.Net.HttpListenerContext,kvpbase.http_request) <0x0103b> at kvpbase.kvpserver.conn_handler (System.IAsyncResult) <0x005a7> at System.Net.ListenerAsyncResult.InvokeCallback (object) <0x00051> at (wrapper runtime-invoke) <Module>.runtime_invoke_void__this___object (object,intptr,intptr,intptr) <0xffffffff>Native stacktrace:Debug info from gdb:(lldb) command source -s 0 '/tmp/mono-gdb-commands.1s6ayI'Executing commands in '/private/tmp/mono-gdb-commands.1s6ayI'.(lldb) process attach --pid 4136Process 4136 stoppedExecutable module set to ""/usr/bin/mono"".Architecture set to: i386-apple-macosx.(lldb) thread listProcess 4136 stopped public static string serialize_json(object obj){ return JsonConvert.SerializeObject(obj, Newtonsoft.Json.Formatting.Indented, new JsonSerializerSettings { });} sh-3.2# mono --versionMono JIT compiler version 3.10.0 ((detached/e204655 Mon Oct 13 08:50:28 EDT 2014)Copyright (C) 2002-2014 Novell, Inc, Xamarin Inc and Contributors. www.mono-project.com TLS: normal SIGSEGV: altstack Notification: kqueue Architecture: x86 Disabled: none Misc: softdebug LLVM: yes(3.4svn-mono-(detached/e656cac) GC: sgen { ""url"": ""http://localhost/root/home/foo"", ""user_guid"": ""root"", ""container_name"": ""home"", ""size"": 3259, ""num_objects"": 1, ""container_path"": [], ""child_containers"": [ ""abcd"", ""foo"", ""large-dir"" ], ""obj_metadata"": [ { ""key"": ""foo"", ""size"": 3259, ""created"": ""2014-10-24T07:44:24.5773422Z"", ""last_update"": ""2014-10-24T07:44:24.5773422Z"", ""last_access"": ""2014-10-24T07:44:24.5773422Z"" } ]} public class dir_info{ public string url { get; set; } public string user_guid { get; set; } public string container_name { get; set; } public long size { get; set; } public int num_objects { get; set; } public List<string> container_path { get; set; } public List<string> child_containers { get; set; } public List<obj_info> obj_metadata { get; set; }} sh-3.2# which mono/usr/bin/monosh-3.2# mono --versionMono JIT compiler version 3.12.1 ((detached/b7764aa Fri Mar 6 15:32:47 EST 2015)Copyright (C) 2002-2014 Novell, Inc, Xamarin Inc and Contributors. www.mono-project.com TLS: normal SIGSEGV: altstack Notification: kqueue Architecture: x86 Disabled: none Misc: softdebug LLVM: yes(3.6.0svn-mono-(detached/5486eb2) GC: sgen",Newtonsoft JSON.NET 6.0.8 and Mono on Mac OSX fails in glorious manner
Why does adding a dependency to my Web API (ASP.NET v5) project work fully?," I'm using Visual Studio 2015 CTP 6 on Windows 8.1.I'm trying to write a Web API using ASP.NET v5, with its new project file format. I've added a reference to Noda Time v1.3.0 to my project.json file, and the editor in Visual Studio picks it up, but the build process fails.Repro recipe, right from scratch:Open VS 2015 CTP 6Create new project in a new solution:Select ASP.NET Web Application project templateSelect ""ASP.NET 5 Preview Web API"" in the template dialogBuild the project, just to confirm everything is correctOpen project.json, and in the (badly formatted) ""dependencies"" section, add an extra line at the start (to avoid having to add a comma to another line): Open Controllers\ValuesController.csEdit the parameterless Get() method so that the body is: DateTimeZoneProviders will have red squiggles, which is reasonable - we don't have a using directive yet.Put the cursor in DateTimeZoneProviders and hit Ctrl+. - you should be offered ""using NodaTime;"" as a potential fix... so Intellisense (and thus Roslyn) definitely knows about the dependency.Accept the fix. The squiggles will go away - all is well, right?Try to build the solution: you should get two errors, basically indicating that the dependency hasn't been resolved.In Explorer, if you look in the BugDemo solution directory, you'll find an artifacts\obj\BugDemo\Debug\ProjectRawReferences directory containing ""ASP.NET Core 5.0"" and ""ASP.NET 5.0"" directories, both of which have a lot of DLLs in... but not Noda Time.Right-clicking on the project and selecting ""Restore packages"" doesn't fix this.When I build the same project using Project K, a kpm restore does pick up Noda Time, and if you add a section to project.json as below, then k web works and visiting http://localhost:5001/api/values will show you all the TZDB time zone IDs: So, what am I doing wrong? Or is it just a bug? <code>  ""NodaTime"": ""1.3.0"", return DateTimeZoneProviders.Tzdb.Ids; ""commands"": { ""web"": ""Microsoft.AspNet.Hosting --server Microsoft.AspNet.Server.WebListener --server.urls http://localhost:5001""},",Why does adding a dependency in my Web API (ASP.NET v5) project not work fully?
ASP.NET vNext - Access to Configuration object from Startup," I would like to access to the Active Directory from my company in many controllers from my ASP.NET vNext project, and I inserted the domain name into my config.json file, so I can access it from the Configuration class. I find it heavy to always instantiate a new Configuration object at every time I want to access to my config.json, is there any way through the IConfiguration API to access to the Configuration class initialized into the Startup class ? <code> ",Access to Configuration object from Startup class
Access to Configuration object from Startup," I would like to access to the Active Directory from my company in many controllers from my ASP.NET vNext project, and I inserted the domain name into my config.json file, so I can access it from the Configuration class. I find it heavy to always instantiate a new Configuration object at every time I want to access to my config.json, is there any way through the IConfiguration API to access to the Configuration class initialized into the Startup class ? <code> ",Access to Configuration object from Startup class
Merging migration entries in EntityFramework," I have an Entity Framework 6 CF project that has a few migrations already in place.The model is now stable and there is no need to keep the migration history that already exists.Is there a way to reset the model and merge all migration commands into the initial migration?As an example, the first migration adds a column while the second migration adds a unique, non-clustered index. I now want to see all these changes directly in OnModelCreating rather than in separate migrations. <code> ",Merging migration entries in Entity Framework
C# async - Will every 'await' operator result in a state machine?," Please consider the following code: This code demonstrate a most basic functionality - nested async methods. Will every method get translate into a state machine? Or is the compiler sophisticated enough to generate a more efficient structure? In some of my projects, there are ~20 methods between the UI/WebAPI and the I/O call - does that affect the trade-off between the async-await overhead (such as the state machine) and the non-blocking thread benefits? I mean, if, for example, the overhead of 4 state machines (4 nested async methods) equals to 50ms of blocking I/O (in terms of trade-off), will 20 state machine be equal to longer I/O's delay (250ms)?  <code>  public async Task<string> GetString(){ //Some code here... var data = await A(); //Some more code... return data;}private async Task<string> A(){ //Some code here.. var data = await B(); //manipulating data... return data;}private async Task<string> B(){ //Some code here.. var data = await C(); //manipulating data... return data;}private async Task<string> C(){ //Some code here.. var data = await FetchFromDB(); //manipulating data... return data;}private async Task<string> FetchFromDB(){ return await SOME_HTTP_REQUEST;}",Will every 'await' operator result in a state machine?
"ASP.Net MVC Trying to remove Identity's ""Claims"" and ""Logins"" table from database"," Our application doesn't need the excessive ""Logins"" and ""Claims"" functionality that identity uses. It would be nice if these tables simlpy didn't get created in the database, but I don't want to have to reimplement all identity classes...I'd assume it's something like You would think this works according to the function descriptions, but it doesn't. The AspNetUserClaim and AspNetUserLogins tables still get created.What's the right way to do this? <code>  public ApplicationDbContext : IdentityDbContext{ [...] protected override void OnModelCreating(DbModelBuilder modelBuilder) { base.OnModelCreating(modelBuilder); modelBuilder.Ignore<IdentityUserClaim>(); modelBuilder.Ignore<IdentityUserLogin>(); }}",How to remove dbo.AspNetUserClaims and dbo.AspNetUserLogins tables (IdentityUserClaim and IdentityUserLogin entities)?
MS SQL: Return all rows in table and read their values," I have a table with 6 columns and 5 rows. I want to select all rows and read through them using the SqlDataReader (ASP.NET C#). I currently can access single columns using dataReader[""columnName""].ToString() and store that in a string variable. I want to read through the columns row by row. Thanks for helping.  <code> ",SQL Server: return all rows in table and read their values
Convert XPS to PDF for free using asp.net, I did a lot of digging to figure out an easy way to convert an XPS document into a PDF. There are many tools that can do this but they are not free. Is there a free alternative? <code> ,Is ther any open tool to convert XPS to PDF?
"If Statements - What is happening in an ""If(..||..)"" and ""If(...&&...)"" construct internally?"," I was just wondering what happens inside of an ""if OR"" and ""if AND"". I have a feeling that it's just syntactic sugar to use && and || and internally all cases are build as single if statements.Compact form ||: Potential internal form: Compact form &&: Potential internal form: Is there any difference in the performance of these two examples?*Edit: Added the else to the || case <code>  if(a || b || c){ DoSomething();} if(a){ DoSomething();} else if(b){ DoSomething();} else if(c){ DoSomething();} if(a && b && c){ DoSomething();} if(a){ if(b) { if(c) { DoSomething(); } }}","What is happening in an ""If(..||..)"" and ""If(...&&...)"" construct internally?"
C# - Is there an alternative library to MIcrosoft.Office.Interop.Excel?," I am using the Microsoft.Office.Interop.Excel reference in order to have some manipulations with excel files, like adding columns, locking cells, protecting with password etc...Now I have to use this code on a server that doesn't have office installed on it, so I don't really know for sure if the code using this reference will be able to run there.So is there a way of doing all these actions on excel files on a server that doesn't have office installed on it ?Should I use another library or is there a way that the Microsoft.Office.Interop.Excel reference to work with no office installed ? <code> ",Is there an alternative library to Microsoft.Office.Interop.Excel?
Is there an alternative library to MIcrosoft.Office.Interop.Excel?," I am using the Microsoft.Office.Interop.Excel reference in order to have some manipulations with excel files, like adding columns, locking cells, protecting with password etc...Now I have to use this code on a server that doesn't have office installed on it, so I don't really know for sure if the code using this reference will be able to run there.So is there a way of doing all these actions on excel files on a server that doesn't have office installed on it ?Should I use another library or is there a way that the Microsoft.Office.Interop.Excel reference to work with no office installed ? <code> ",Is there an alternative library to Microsoft.Office.Interop.Excel?
"Using EF6 Store Functions for EntityFramework CodeFirst, can I return a custom type?"," I have an entity class: using the EF6 Store Functions for Entity Framework code-first by Moozzyk, I see example code that maps a function to an entity type.However, when using a type that isn't already mapped as an entity, I receive an exception saying the type is not a valid entity type.Example: How can I output the call of that function to a specific type? <code>  public class SomeClass { public int Id { get; set; } public int Value { get; set; } public string Name { get; set; }} [DbFunction(""MyContext"", ""GetValueSum"")]public IQueryable<SomeClassSummary> GetValueSum(){ return ((IObjectContextAdapter)this).ObjectContext .CreateQuery<SomeClassSummary>(string.Format(""[{0}].{1}"", GetType().Name, ""[GetValueSum]()""));}","Using EF6 Store Functions for Entity Framework code-first, can I return a custom type?"
Compiling C# manualy while targetting .NET 3.5 with csc2," I'm using csc/csc2.exe to manually compile an application. I need to reference .NET 3.5 dlls, however it seems that the compiler automatically adds .NET 4.0 dlls as well (which is causing a conflict).I'm manually referencing the desired version of mscorlib, and other system dlls. Compilation from within Visual Studio succeeds, however compilation of the same response file manually from command prompt fails. I'm getting the following errors for every referenced assembly: What causes the compiler to include .NET 4.0 dlls, and what can I do to prevent it from including them?UPDATE:I cannot use MSBUILD, because I already have a response file (not a project file) from an application. The application used an outdated version of a compiler, and I'm trying to replace their compiler with a newer one that supports C#6.I've successfully done this task with Mono MCS compiler, but cannot get the same to work with Roslyn. I cannot use the MCS compiler, because it doesn't yet support all of C#6 features.The only way to use MSBUILD would be to parse the response file back into a C# project file. This seems like over-engineering to me. <code>  /nostdlib+/platform:AnyCPU/errorendlocation/highentropyva-/reference:""C:\Windows\Microsoft.NET\Framework\v2.0.50727\mscorlib.dll""/reference:""C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\v3.5\System.Core.dll""/reference:""C:\Windows\Microsoft.NET\Framework\v2.0.50727\System.dll""/debug+/debug:full/out:obj\Debug\Target.exe/ruleset:""C:\Program Files (x86)\Microsoft Visual Studio 14.0\Team Tools\Static Analysis Tools\\Rule Sets\MinimumRecommendedRules.ruleset""/target:exe/utf8outputProgram.cs Properties\AssemblyInfo.cs error CS1703: Multiple assemblies with equivalent identity have been imported: 'C:\Windows\Microsoft.NET\Framework64\v4.0.30319\System.dll' and 'C:\Windows\Microsoft.NET\Framework\v2.0.50727\System.dll'. Remove one of the duplicate references.",Compiling C# manually while targetting .NET 3.5 with Roslyn(csc.exe)
Compiling C# manualy while targetting .NET 3.5 with Roslyn(csc.exe)," I'm using csc/csc2.exe to manually compile an application. I need to reference .NET 3.5 dlls, however it seems that the compiler automatically adds .NET 4.0 dlls as well (which is causing a conflict).I'm manually referencing the desired version of mscorlib, and other system dlls. Compilation from within Visual Studio succeeds, however compilation of the same response file manually from command prompt fails. I'm getting the following errors for every referenced assembly: What causes the compiler to include .NET 4.0 dlls, and what can I do to prevent it from including them?UPDATE:I cannot use MSBUILD, because I already have a response file (not a project file) from an application. The application used an outdated version of a compiler, and I'm trying to replace their compiler with a newer one that supports C#6.I've successfully done this task with Mono MCS compiler, but cannot get the same to work with Roslyn. I cannot use the MCS compiler, because it doesn't yet support all of C#6 features.The only way to use MSBUILD would be to parse the response file back into a C# project file. This seems like over-engineering to me. <code>  /nostdlib+/platform:AnyCPU/errorendlocation/highentropyva-/reference:""C:\Windows\Microsoft.NET\Framework\v2.0.50727\mscorlib.dll""/reference:""C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\v3.5\System.Core.dll""/reference:""C:\Windows\Microsoft.NET\Framework\v2.0.50727\System.dll""/debug+/debug:full/out:obj\Debug\Target.exe/ruleset:""C:\Program Files (x86)\Microsoft Visual Studio 14.0\Team Tools\Static Analysis Tools\\Rule Sets\MinimumRecommendedRules.ruleset""/target:exe/utf8outputProgram.cs Properties\AssemblyInfo.cs error CS1703: Multiple assemblies with equivalent identity have been imported: 'C:\Windows\Microsoft.NET\Framework64\v4.0.30319\System.dll' and 'C:\Windows\Microsoft.NET\Framework\v2.0.50727\System.dll'. Remove one of the duplicate references.",Compiling C# manually while targetting .NET 3.5 with Roslyn(csc.exe)
Double.PositiveInfinity and max value," In Double.PositiveInfinity docs it's written that: This constant is returned when the result of an operation is greater than MaxValue.However, when I try to add a number to maximum value of double, it doesn't return infinity. I've tried running this: Why is it happening? Why isn't it showing maxVal as infinity?Here is a working fiddle. <code>  double maxVal = Double.MaxValue;maxVal = maxVal + 10000000000000000000;Console.WriteLine(maxVal + "" "" + Double.IsInfinity(maxVal)); //prints 1.79769313486232E+308 False",Why doesn't adding a number to Double.MaxValue makes it Double.PositiveInfinity?
How to contraint concurrency the right way in Rx.NET," Please, observe the following code snippet: The problem with this code is that getResultAsync runs concurrently in an unconstrained fashion. Which could be not what we want in certain cases. Suppose I want to restrict its concurrency to at most 10 concurrent invocations. What is the Rx.NET way to do it?I am enclosing a simple console application that demonstrates the subject and my lame solution of the described problem.There is a bit extra code, like the Stats class and the artificial random sleeps. They are there to ensure I truly get concurrent execution and can reliably compute the max concurrency reached during the process.The method RunUnconstrained demonstrates the naive, unconstrained run. The method RunConstrained shows my solution, which is not very elegant. Ideally, I would like to ease constraining the concurrency by simply applying a dedicated Rx operator to the Monad. Of course, without sacrificing the performance. <code>  var result = await GetSource(1000).SelectMany(s => getResultAsync(s).ToObservable()).ToList(); using System;using System.Collections.Generic;using System.Diagnostics;using System.Linq;using System.Reactive.Linq;using System.Reactive.Threading.Tasks;using System.Threading;using System.Threading.Tasks;namespace RxConstrainedConcurrency{ class Program { public class Stats { public int MaxConcurrentCount; public int CurConcurrentCount; public readonly object MaxConcurrentCountGuard = new object(); } static void Main() { RunUnconstrained().GetAwaiter().GetResult(); RunConstrained().GetAwaiter().GetResult(); } static async Task RunUnconstrained() { await Run(AsyncOp); } static async Task RunConstrained() { using (var sem = new SemaphoreSlim(10)) { await Run(async (s, pause, stats) => { // ReSharper disable AccessToDisposedClosure await sem.WaitAsync(); try { return await AsyncOp(s, pause, stats); } finally { sem.Release(); } // ReSharper restore AccessToDisposedClosure }); } } static async Task Run(Func<string, int, Stats, Task<int>> getResultAsync) { var stats = new Stats(); var rnd = new Random(0x1234); var result = await GetSource(1000).SelectMany(s => getResultAsync(s, rnd.Next(30), stats).ToObservable()).ToList(); Debug.Assert(stats.CurConcurrentCount == 0); Debug.Assert(result.Count == 1000); Debug.Assert(!result.Contains(0)); Debug.WriteLine(""Max concurrency = "" + stats.MaxConcurrentCount); } static IObservable<string> GetSource(int count) { return Enumerable.Range(1, count).Select(i => i.ToString()).ToObservable(); } static Task<int> AsyncOp(string s, int pause, Stats stats) { return Task.Run(() => { int cur = Interlocked.Increment(ref stats.CurConcurrentCount); if (stats.MaxConcurrentCount < cur) { lock (stats.MaxConcurrentCountGuard) { if (stats.MaxConcurrentCount < cur) { stats.MaxConcurrentCount = cur; } } } try { Thread.Sleep(pause); return int.Parse(s); } finally { Interlocked.Decrement(ref stats.CurConcurrentCount); } }); } }}",How to constraint concurrency the right way in Rx.NET
"How to focus a datatemplated TextBox in the first element of an ItemsControl in a Window, when the Window is opened? (C#)"," When the user clicks a button in the application, a window opens up. I want the TextBox belonging to the first item in the ItemsControl to be focused, so that the user can start typing as soon as the Window is opened, without needing to manually select the TextBox.How can this be done?For simplicity, we can say that the Window looks approximately like this: UPDATEAfter looking at propsed answers as well and this link:Window Loaded and WPFThe modified solution is as follows: In constructor: Loaded Method: Super-duper method: <code>  <Window> <Grid> <ItemsControl ItemsSource=""{Binding MyItems}""> <DataTemplate> <Grid> <StackPanel> <StackPanel> <customControls:ValidationControl> <TextBox Text="""" /> </customControls:ValidationControl> </StackPanel> </StackPanel> </Grid> </DataTemplate> </ItemsControl> </Grid></Window> <Window> <Grid> <ItemsControl x:Name=""myItemsControl"" ItemsSource=""{Binding MyItems}""> <DataTemplate> <Grid> <StackPanel> <StackPanel> <customControls:ValidationControl> <TextBox Text="""" /> </customControls:ValidationControl> </StackPanel> </StackPanel> </Grid> </DataTemplate> </ItemsControl> </Grid></Window> this.Loaded += new RoutedEventHandler(ThisWindowLoaded); private void ThisWindowLoaded(object sender, RoutedEventArgs e){ var textbox = FindVisualChild<TextBox>(myItemsControl.ItemContainerGenerator.ContainerFromIndex(0)); FocusManager.SetFocusedElement(myItemsControl, textbox);} public static T FindVisualChild<T>(DependencyObject depObj) where T : DependencyObject{ if (depObj != null) { for (int i = 0; i < VisualTreeHelper.GetChildrenCount(depObj); i++) { DependencyObject child = VisualTreeHelper.GetChild(depObj, i); if (child != null && child is T) { return (T)child; } T childItem = FindVisualChild<T>(child); if (childItem != null) return childItem; } } return null;}","How to focus a datatemplated TextBox in the first element of an ItemsControl in a Window, when the Window is opened? (C#, WPF)"
Datetime .tofiletime and .tofiletimeUtc are the same output," I opened a file and used ToUniversalTime() and ToLocalTime() and output different times. However, when I use ToFileTime() and ToFileTimeUtc(), I get the same number. Why is this? output utc time: 8/22/2013 2:46:17 PM file time: 8/22/2013 7:46:17 AM file: 130216563774628355 utc: 130216563774628355Shouldn't file and utc be different? <code>  DateTime creationTime = File.GetCreationTime(@""c:\windows\setupact.log"");Console.WriteLine(""utc time: "" + creationTime.ToUniversalTime());Console.WriteLine(""file time: "" + creationTime.ToLocalTime());Console.WriteLine(""file: "" + creationTime.ToFileTime());Console.WriteLine(""utc: "" + creationTime.ToFileTimeUtc());",DateTime ToFileTime and ToFileTimeUtc have same output
asp.net mvc 5 asychronous action method," I have the following action method with async and await keywords: In the above code, once the database operation is finished I want to immediately return Json() result and then call the SendMails() method which should execute in the background. What changes should I make to the above code? <code>  [HttpPost]public async Task<ActionResult> Save(ContactFormViewModel contactFormVM){ if (domain.SaveContactForm(contactFormVM) > 0)// saves data in database { bool result = await SendMails(contactFormVM);//need to execute this method asynchronously but it executes synchronously return Json(""success""); } return Json(""failure""); } public async Task<bool> SendMails(ContactFormViewModel contactFormVM) { await Task.Delay(0);//how to use await keyword in this function? domain.SendContactFormUserMail(contactFormVM); domain.SendContactFormAdminMail(contactFormVM); return true; }",asp.net mvc 5 asynchronous action method
"C# constructor why is it giving me a ""Mehtod must have a return type"""," I been trying to learn how to create a class in C#. I created a class and than I tried to create a constructor to go along with the class. But when I created the constructor in the class, the compiler keeps thinking I'm trying to create a method instead. Error 1 Method must have a return typeIn my form, I tried to instantiate a object to go along with it. But it's still giving me an error. Why isn't my compiler recognizing that I'm trying to create a constructor instead of a method? Is it because I don't have a accessor property to go along with it? Thank you.  <code>  public Product(string code, string description, decimal price){ this.Code = code; this.Description = description; this.Price = price;} ProductClass product1 = new Product(""CS10"", ""Murach's C# 2010"", 54.60m);","C# constructor gives ""Method must have a return type"""
How to align two paragraphs left and right in a same line in pdf, I want to display two pieces of content (it may a paragraph or text) to the left and right side on a single line. My output should be like How can I do this? <code>  Name:ABC date:2015-03-02,How to align two paragraphs to the left and right on the same line?
How to align two paragraphs or text in left and right in a same line in pdf, I want to display two pieces of content (it may a paragraph or text) to the left and right side on a single line. My output should be like How can I do this? <code>  Name:ABC date:2015-03-02,How to align two paragraphs to the left and right on the same line?
why DateTime.Now and DateTime.UtcNow Isnt My Current Local DateTime?," We use DateTime.Now, but the time is not equal with our server time!When I run my project, these are the DateTime property values: But my current local system time is: My time zone is Tehran (UTC+03:30). This is the first time I've see this behavior! Why doesn't DateTime.Now equal my computer's time? <code>  DateTime.Now = {15/14/04 05:20:18 AM}DateTime.UtcNow = {15/14/04 12:20:18 PM} 15/14/04 04:50:18 AM",Why DateTime.Now and DateTime.UtcNow Isn't My Current Local DateTime?
Why DateTime.Now and DateTime.UtcNow Isnt My Current Local DateTime?," We use DateTime.Now, but the time is not equal with our server time!When I run my project, these are the DateTime property values: But my current local system time is: My time zone is Tehran (UTC+03:30). This is the first time I've see this behavior! Why doesn't DateTime.Now equal my computer's time? <code>  DateTime.Now = {15/14/04 05:20:18 AM}DateTime.UtcNow = {15/14/04 12:20:18 PM} 15/14/04 04:50:18 AM",Why DateTime.Now and DateTime.UtcNow Isn't My Current Local DateTime?
C#: Enum in WPF ComboxBox with localized names," I have a ComboBox listing an Enum. I want to display localized names for the enum values in English but also in German (and other languages in the future) In my ViewModel using only gets me the names of the enum in the code and not the translated ones.I have general localization in place and can access them using i.e. which gets me the translation for the current language.How can I bind the localization automatically? <code>  enum StatusEnum { Open = 1, Closed = 2, InProgress = 3}<ComboBox ItemsSource=""{Binding StatusList}"" SelectedItem=""{Binding SelectedStatus}"" /> OpenClosedIn Progress OffenGeschlossenIn Arbeit public IEnumerable<StatusEnum> StatusList { get { return Enum.GetValues(typeof(StatusEnum)).Cast<StatusEnum>(); }} Resources.Strings.InProgress",Enum in WPF ComboxBox with localized names
LINQ Max with Group By from multiple fields," I am trying to get the latest contact with a given user, grouped by user: The user's contact info could either be in SentTo or SentFrom. would give me the latest message, but I need the last message per user.The closest solution I could find was LINQ Max Date with group by, but I cant seem to figure out the correct syntax. I would rather not create multiple List objects if I don't have to. If the user's info is in SentTo, my info will be in SentFrom, and vice-versa, so I do have some way of checking where the user's data is.Did I mention I was very new to LINQ? Any help would be greatly appreciated. <code>  public class ChatMessage{ public string SentTo { get; set; } public string SentFrom { get; set; } public string MessageBody { get; set; } public string SendDate { get; set; }} List<ChatMessage> ecml = new List<ChatMessage>();var q = ecml.OrderByDescending(m => m.SendDate).First();",How do I group on one of two possible fields using LINQ?
"In c#, how to find chain of circular dependency?"," This error usually occurs when one deployment project contains the project outputs of a second deployment project, and the second project contains the outputs of the first project.I have a method that check circular dependency. In input, we have a dictionary that contains, for example, <""A"", < ""B"", ""C"" >> and <""B"", < ""A"", ""D"" >>, this means that A depends on B and C and we have circular dependency with A->B.But usually we have a more complex situation, with a chain of dependency.How to modify this method to find a chain of dependency? For example, I want to have a variable that contains chain A->B->A, rather than class A has a conflict with class B. <code>  private void FindDependency(IDictionary<string, IEnumerable<string>> serviceDependence)","In C#, how to find chain of circular dependency?"
Linq to Entities query requiring Array.IndexOf and Grouping," I have the code sample below which queries a list of Products. This works exactly as expected and returns the 4 rows I want when using an in memory collection, but when running against the Oracle database: This throws an error saying I should use FirstOrDefault which is not supported in an Oracle database. The error oracle 11.2.0.3.0 does not support apply gets thrown. Googleing reveals this on CodePlex: https://entityframework.codeplex.com/workitem/910. This occurs when using the following binaries:EntityFramework 6.0.0.0Oracle.ManagedDataAccess 4.121.2.0Oracle.ManagedDataAccess.EntityFramework 6.121.2.0.Net Framework 4.5.1The database is an Oracle 11.2.0.3.0 Database.The sql generated uses OUTER APPLY (see image below) which is not supported by the 11.2.0.3.0 version of Oracle so why is EF/Oracle.ManagedDataAccess trying to use it? Is there a way to tell EF not to use the APPLY keyword?The page below says that APPLY support was added in Oracle 12c Release 1, but I can't update all my databases just to make a GROUP BY work.http://www.oracle.com/technetwork/database/windows/newfeatures-084113.htmlIt appears that this is a known issue (Known Issues in SqlClient for Entity Framework): The following are some typical scenarios that might lead to the presence of CROSS APPLY and/or OUTER APPLY operators in the output query: LINQ queries that use grouping methods that accept an element selector. Before I resort to creating a view (I would have to create the view on several databases), can anyone see another solution?For anyone interested, the SQL that would do what I want against this database version would look something like the following: The code will eventually be in a service class passed to and OData controller in Web API.The example below uses demo data, the real database has 700,000 records,so I would like to avoid executing the query and let OData handle page limits and further filtering. <code>  var productResults = Products.Where((p) => refFilterSequence.Contains(p.Ref)) .GroupBy(g => g.Code, (key, g) => g.OrderBy(whp => whp.Ref).First()).ToList(); .GroupBy(g => g.Code, (key, g) => g.OrderBy(whp => whp.Ref).First()) select *from ( select RANK() OVER (PARTITION BY sm.product ORDER BY refs.map) ranking, sm.* from schema.table sm, ( select 'R9' ref, 0 map from dual union all select 'R1' ref, 1 map from dual union all select 'R6' ref, 2 map from dual ) refs where sm.ref= refs.ref ) stockwhere ranking = 1 using System;using System.Collections.Generic;using System.Linq;namespace DemoApp{ class Program { public class Product { public string Ref { get; set; } public string Code { get; set; } public int Quantity { get; set; } } //demo data static readonly List<Product> Products = new List<Product> { new Product { Ref = ""B2"", Code = ""ITEM1"", Quantity = 1}, new Product { Ref = ""R1"", Code = ""ITEM1"", Quantity = 2}, new Product { Ref = ""R9"", Code = ""ITEM1"", Quantity = 3}, new Product { Ref = ""R9"", Code = ""ITEM2"", Quantity = 4}, new Product { Ref = ""R6"", Code = ""ITEM2"", Quantity = 5}, new Product { Ref = ""B2"", Code = ""ITEM3"", Quantity = 6}, new Product { Ref = ""R1"", Code = ""ITEM3"", Quantity = 7}, new Product { Ref = ""R9"", Code = ""ITEM3"", Quantity = 8}, new Product { Ref = ""B2"", Code = ""ITEM4"", Quantity = 9}, new Product { Ref = ""X3"", Code = ""ITEM4"", Quantity = 10}, new Product { Ref = ""B8"", Code = ""ITEM5"", Quantity = 10}, new Product { Ref = ""R6"", Code = ""ITEM5"", Quantity = 12}, new Product { Ref = ""M2"", Code = ""ITEM5"", Quantity = 13}, new Product { Ref = ""R1"", Code = ""ITEM5"", Quantity = 14}, }; static void Main(string[] args) { // this array is of variable length, and will not always contain 3 items. var refFilterSequence = new List<string> {""R9"", ""R1"", ""R6""}; var results = GetProductsForODataProcessing(refFilterSequence); // some further filtering may occur after the queryable is returned. // the actual implmentation is an OData Web API, so filters, expansions etc could be added. //results = results.Where(p => p.Quantity > 2); results.ToList().ForEach(p => Console.WriteLine(""RANK:{0}\tREF:{1}\tCode:{2}\tQty:{3}"", ""?"", p.Ref, p.Code, p.Quantity)); Console.ReadLine(); } static IQueryable<Product> GetProductsForODataProcessing(List<string> filterSequence ) { var productResults = Products.Where((p) => filterSequence.Contains(p.Ref)) .GroupBy(g => g.Code, (key, g) => g.OrderBy(whp => whp.Ref).First()).AsQueryable(); return productResults; }}// Example Output// .......................// REF:R1 Code:ITEM1 Qty:2// REF:R6 Code:ITEM2 Qty:3// REF:R1 Code:ITEM3 Qty:7// REF:R1 Code:ITEM5 Qty:14","Linq to Entities Group By (OUTER APPLY) ""oracle 11.2.0.3.0 does not support apply"""
Linq to Entities query Grouping (OUTER APPLY)," I have the code sample below which queries a list of Products. This works exactly as expected and returns the 4 rows I want when using an in memory collection, but when running against the Oracle database: This throws an error saying I should use FirstOrDefault which is not supported in an Oracle database. The error oracle 11.2.0.3.0 does not support apply gets thrown. Googleing reveals this on CodePlex: https://entityframework.codeplex.com/workitem/910. This occurs when using the following binaries:EntityFramework 6.0.0.0Oracle.ManagedDataAccess 4.121.2.0Oracle.ManagedDataAccess.EntityFramework 6.121.2.0.Net Framework 4.5.1The database is an Oracle 11.2.0.3.0 Database.The sql generated uses OUTER APPLY (see image below) which is not supported by the 11.2.0.3.0 version of Oracle so why is EF/Oracle.ManagedDataAccess trying to use it? Is there a way to tell EF not to use the APPLY keyword?The page below says that APPLY support was added in Oracle 12c Release 1, but I can't update all my databases just to make a GROUP BY work.http://www.oracle.com/technetwork/database/windows/newfeatures-084113.htmlIt appears that this is a known issue (Known Issues in SqlClient for Entity Framework): The following are some typical scenarios that might lead to the presence of CROSS APPLY and/or OUTER APPLY operators in the output query: LINQ queries that use grouping methods that accept an element selector. Before I resort to creating a view (I would have to create the view on several databases), can anyone see another solution?For anyone interested, the SQL that would do what I want against this database version would look something like the following: The code will eventually be in a service class passed to and OData controller in Web API.The example below uses demo data, the real database has 700,000 records,so I would like to avoid executing the query and let OData handle page limits and further filtering. <code>  var productResults = Products.Where((p) => refFilterSequence.Contains(p.Ref)) .GroupBy(g => g.Code, (key, g) => g.OrderBy(whp => whp.Ref).First()).ToList(); .GroupBy(g => g.Code, (key, g) => g.OrderBy(whp => whp.Ref).First()) select *from ( select RANK() OVER (PARTITION BY sm.product ORDER BY refs.map) ranking, sm.* from schema.table sm, ( select 'R9' ref, 0 map from dual union all select 'R1' ref, 1 map from dual union all select 'R6' ref, 2 map from dual ) refs where sm.ref= refs.ref ) stockwhere ranking = 1 using System;using System.Collections.Generic;using System.Linq;namespace DemoApp{ class Program { public class Product { public string Ref { get; set; } public string Code { get; set; } public int Quantity { get; set; } } //demo data static readonly List<Product> Products = new List<Product> { new Product { Ref = ""B2"", Code = ""ITEM1"", Quantity = 1}, new Product { Ref = ""R1"", Code = ""ITEM1"", Quantity = 2}, new Product { Ref = ""R9"", Code = ""ITEM1"", Quantity = 3}, new Product { Ref = ""R9"", Code = ""ITEM2"", Quantity = 4}, new Product { Ref = ""R6"", Code = ""ITEM2"", Quantity = 5}, new Product { Ref = ""B2"", Code = ""ITEM3"", Quantity = 6}, new Product { Ref = ""R1"", Code = ""ITEM3"", Quantity = 7}, new Product { Ref = ""R9"", Code = ""ITEM3"", Quantity = 8}, new Product { Ref = ""B2"", Code = ""ITEM4"", Quantity = 9}, new Product { Ref = ""X3"", Code = ""ITEM4"", Quantity = 10}, new Product { Ref = ""B8"", Code = ""ITEM5"", Quantity = 10}, new Product { Ref = ""R6"", Code = ""ITEM5"", Quantity = 12}, new Product { Ref = ""M2"", Code = ""ITEM5"", Quantity = 13}, new Product { Ref = ""R1"", Code = ""ITEM5"", Quantity = 14}, }; static void Main(string[] args) { // this array is of variable length, and will not always contain 3 items. var refFilterSequence = new List<string> {""R9"", ""R1"", ""R6""}; var results = GetProductsForODataProcessing(refFilterSequence); // some further filtering may occur after the queryable is returned. // the actual implmentation is an OData Web API, so filters, expansions etc could be added. //results = results.Where(p => p.Quantity > 2); results.ToList().ForEach(p => Console.WriteLine(""RANK:{0}\tREF:{1}\tCode:{2}\tQty:{3}"", ""?"", p.Ref, p.Code, p.Quantity)); Console.ReadLine(); } static IQueryable<Product> GetProductsForODataProcessing(List<string> filterSequence ) { var productResults = Products.Where((p) => filterSequence.Contains(p.Ref)) .GroupBy(g => g.Code, (key, g) => g.OrderBy(whp => whp.Ref).First()).AsQueryable(); return productResults; }}// Example Output// .......................// REF:R1 Code:ITEM1 Qty:2// REF:R6 Code:ITEM2 Qty:3// REF:R1 Code:ITEM3 Qty:7// REF:R1 Code:ITEM5 Qty:14","Linq to Entities Group By (OUTER APPLY) ""oracle 11.2.0.3.0 does not support apply"""
"Linq to Entities query Grouping (OUTER APPLY) ""oracle 11.2.0.3.0 does not support apply"""," I have the code sample below which queries a list of Products. This works exactly as expected and returns the 4 rows I want when using an in memory collection, but when running against the Oracle database: This throws an error saying I should use FirstOrDefault which is not supported in an Oracle database. The error oracle 11.2.0.3.0 does not support apply gets thrown. Googleing reveals this on CodePlex: https://entityframework.codeplex.com/workitem/910. This occurs when using the following binaries:EntityFramework 6.0.0.0Oracle.ManagedDataAccess 4.121.2.0Oracle.ManagedDataAccess.EntityFramework 6.121.2.0.Net Framework 4.5.1The database is an Oracle 11.2.0.3.0 Database.The sql generated uses OUTER APPLY (see image below) which is not supported by the 11.2.0.3.0 version of Oracle so why is EF/Oracle.ManagedDataAccess trying to use it? Is there a way to tell EF not to use the APPLY keyword?The page below says that APPLY support was added in Oracle 12c Release 1, but I can't update all my databases just to make a GROUP BY work.http://www.oracle.com/technetwork/database/windows/newfeatures-084113.htmlIt appears that this is a known issue (Known Issues in SqlClient for Entity Framework): The following are some typical scenarios that might lead to the presence of CROSS APPLY and/or OUTER APPLY operators in the output query: LINQ queries that use grouping methods that accept an element selector. Before I resort to creating a view (I would have to create the view on several databases), can anyone see another solution?For anyone interested, the SQL that would do what I want against this database version would look something like the following: The code will eventually be in a service class passed to and OData controller in Web API.The example below uses demo data, the real database has 700,000 records,so I would like to avoid executing the query and let OData handle page limits and further filtering. <code>  var productResults = Products.Where((p) => refFilterSequence.Contains(p.Ref)) .GroupBy(g => g.Code, (key, g) => g.OrderBy(whp => whp.Ref).First()).ToList(); .GroupBy(g => g.Code, (key, g) => g.OrderBy(whp => whp.Ref).First()) select *from ( select RANK() OVER (PARTITION BY sm.product ORDER BY refs.map) ranking, sm.* from schema.table sm, ( select 'R9' ref, 0 map from dual union all select 'R1' ref, 1 map from dual union all select 'R6' ref, 2 map from dual ) refs where sm.ref= refs.ref ) stockwhere ranking = 1 using System;using System.Collections.Generic;using System.Linq;namespace DemoApp{ class Program { public class Product { public string Ref { get; set; } public string Code { get; set; } public int Quantity { get; set; } } //demo data static readonly List<Product> Products = new List<Product> { new Product { Ref = ""B2"", Code = ""ITEM1"", Quantity = 1}, new Product { Ref = ""R1"", Code = ""ITEM1"", Quantity = 2}, new Product { Ref = ""R9"", Code = ""ITEM1"", Quantity = 3}, new Product { Ref = ""R9"", Code = ""ITEM2"", Quantity = 4}, new Product { Ref = ""R6"", Code = ""ITEM2"", Quantity = 5}, new Product { Ref = ""B2"", Code = ""ITEM3"", Quantity = 6}, new Product { Ref = ""R1"", Code = ""ITEM3"", Quantity = 7}, new Product { Ref = ""R9"", Code = ""ITEM3"", Quantity = 8}, new Product { Ref = ""B2"", Code = ""ITEM4"", Quantity = 9}, new Product { Ref = ""X3"", Code = ""ITEM4"", Quantity = 10}, new Product { Ref = ""B8"", Code = ""ITEM5"", Quantity = 10}, new Product { Ref = ""R6"", Code = ""ITEM5"", Quantity = 12}, new Product { Ref = ""M2"", Code = ""ITEM5"", Quantity = 13}, new Product { Ref = ""R1"", Code = ""ITEM5"", Quantity = 14}, }; static void Main(string[] args) { // this array is of variable length, and will not always contain 3 items. var refFilterSequence = new List<string> {""R9"", ""R1"", ""R6""}; var results = GetProductsForODataProcessing(refFilterSequence); // some further filtering may occur after the queryable is returned. // the actual implmentation is an OData Web API, so filters, expansions etc could be added. //results = results.Where(p => p.Quantity > 2); results.ToList().ForEach(p => Console.WriteLine(""RANK:{0}\tREF:{1}\tCode:{2}\tQty:{3}"", ""?"", p.Ref, p.Code, p.Quantity)); Console.ReadLine(); } static IQueryable<Product> GetProductsForODataProcessing(List<string> filterSequence ) { var productResults = Products.Where((p) => filterSequence.Contains(p.Ref)) .GroupBy(g => g.Code, (key, g) => g.OrderBy(whp => whp.Ref).First()).AsQueryable(); return productResults; }}// Example Output// .......................// REF:R1 Code:ITEM1 Qty:2// REF:R6 Code:ITEM2 Qty:3// REF:R1 Code:ITEM3 Qty:7// REF:R1 Code:ITEM5 Qty:14","Linq to Entities Group By (OUTER APPLY) ""oracle 11.2.0.3.0 does not support apply"""
Dynamic object properties can't reference each other?," Is it somehow possible for properties to reference each other during the creation of a dynamic object an anonymously-typed object (i.e. inside the object initializer)? My simplified example below needs to reuse the Age property without making a second heavy call to GetAgeFromSomewhere(). Of course it doesn't work. Any suggestion on how to accomplish this? Is something like this possible or not possible with dynamic objects anonymously-typed object initializers? <code>  var profile = new { Age = GetAgeFromSomewhere(id), IsLegal = (Age>18)};",Can properties inside an object initializer reference each other?
Anonymous Types - properties can't reference each other?," Is it somehow possible for properties to reference each other during the creation of a dynamic object an anonymously-typed object (i.e. inside the object initializer)? My simplified example below needs to reuse the Age property without making a second heavy call to GetAgeFromSomewhere(). Of course it doesn't work. Any suggestion on how to accomplish this? Is something like this possible or not possible with dynamic objects anonymously-typed object initializers? <code>  var profile = new { Age = GetAgeFromSomewhere(id), IsLegal = (Age>18)};",Can properties inside an object initializer reference each other?
lambda parameter conflicting with class field on accessing field in later scope," I've got a weak imagination when it comes to names, so I often find myself re-using identifiers in my code. This caused me to run into this specific problem.Here's some example code: Here are the compilation errors (output by ideone): Line 11 contains test++, line 9 contains the lambda.Incidentally, Visual Studio 2013 gives a different error: The error occurs at the increment on line 11 only.The code compiles successfully if I comment out either line 9 (the lambda) or line 11 (the increment).This issue is a surprise to me - I was sure that lambda parameter names can conflict only with local method variable names (which is sort of confirmed by the code compiling when I comment out the increment). Also, how can the lambda parameter possibly affect the increment, which is right outside the lambda's scope?I can't get my head around this... What exactly did I do wrong? And what do the cryptic error messages mean in this case?EDIT after all the great answers:So I think I finally understood the rule that I broke. It is not well-worded in the C# spec (7.6.2.1, see Jon Skeet's answer for the quote). What it was supposed to mean is something like:You can not use the same identifier to refer to different things (entities) in the same ""local variable declaration space"" if one of the offending uses is (directly) located in a scope which can be ""seen"" from the scope where the other is (directly) located.Not the standard's standard phrasing, but I hope you understood what I mean. This rule was supposed to allow this: because neither of the scopes of the two variables a can be ""seen"" from the other's scope;and disallow this: because the second variable declaration is ""seen"" from the first variable's scopeand disallow this: because the increment of the field can be ""seen"" from the block's scope (it not being a declaration doesn't matter).It seems that C#6 changed this rule, specifically making the last example (and my original code) legit, though I don't really understand how exactly.Please correct me if I made some mistakes in these examples. <code>  public delegate void TestDelegate(int test);public class Test{ private int test; private void method(int aaa) { TestDelegate del = test => aaa++; test++; } public static void Main() { }} prog.cs(11,3): error CS0135: `test' conflicts with a declaration in a child blockprog.cs(9,22): (Location of the symbol related to previous error)Compilation failed: 1 error(s), 0 warnings 'test' conflicts with the declaration 'Namespace.Test.test' { int a;}{ int a;} { int a;}int a; class Test{ int test; void method() { { int test; } test++; }}",Lambda parameter conflicting with class field on accessing field in later scope
ASP.NET 5 - Non-Azure Deployment through VS 2015 RC," I'm trying out ASP.NET 5 and all its new features on VS 2015 Enterprise RC. To ensure smooth end-to-end deployment, I then try to deploy the application to a non-Azure private server through VS Publish feature.However, I'm missing out a very important feature: the ability to publish to a non-Azure server.In earlier versions of Visual Studio (I'm using VS 2013), the Custom options is there.I've tried tinkering with the Project Properties but nothing on how to deploy my ASP.NET 5 app to a custom server. Any ideas?  <code> ",Non-Azure Deployment through VS 2015 RC
"How to show ""Set program associations"" window in Windows 8?"," I want to show Set program associations windows [edit: for my program] like Chrome do when it run first time after install, like this:            It have:Name of my programFile types I want to set default program (more than one)How to do it by c# (or win32 c++)?EditI read some articles about modify registry (by .reg file or by code work around modify registry) to set default program. It seem only work in Windows XP/7 or lower, not 8/8.1 as Microsoft use hash to protect these registry. <code> ","How to show ""Set program associations"" window in Windows 8/8.1?"
C# interactive window in VS 2015 CTP 6," How I can get the C# interactive window? I have Visual Studio 2015 CTP 6 installed. And I installed Roslyn, according to these instructions.According to blog post Using the C# Interactive Window that comes with Roslyn, now I should see C# interactive at View -> Other Windows -> C# Interactive Windowbut it's absent.Did I miss something? <code> ",C# interactive window in Visual Studio 2015 CTP 6
Set style of TextBlock programatically," I have this: In XAML, I can set a style like this: But how do I do that in C#?EDIT: When I tried (Style)this.FindResource(""ListViewItemTextBlockStyle""); and (Style)App.Current.FindResource(""ListViewItemTextBlockStyle"") I got these errors. <code>  var MyText = new TextBlock();MyText.Text = ""blah"";MyText.Style = /* ??? */; <TextBlock Text=""blah"" Style=""{ThemeResource ListViewItemTextBlockStyle}""/> Error 1 'Windows.UI.Xaml.Application' does not contain a definition for 'FindResource' and no extension method 'FindResource' accepting a first argument of type 'Windows.UI.Xaml.Application' could be found (are you missing a using directive or an assembly reference?)Error 1 'Geodropper.HubPage' does not contain a definition for 'FindResource' and no extension method 'FindResource' accepting a first argument of type 'Geodropper.HubPage' could be found (are you missing a using directive or an assembly reference?)",Set style of TextBlock programmatically
TargetInvocationException when retrieving list from SOAP web service," I have a SOAP web service which I am pulling various information from. Most functions are working correctly, but I need some functions to return a List.The WebMethod is defined like: The web service is referenced in the main project and is called by: client_GetAllMyTypesCompleted is defined as: It is here that the TargetInvocationException is thrown, specifically regarding Result. If you run the web service by itself the correct data is returned. For reference GLS_DataQuery is defined as: So why am I seeing this error? Or how should I be returning a list of objects in this instance?It might be of relevance that the web service is hosted in Azure.EDIT: Attaching the debugger to the instance of the web service running in Azure sees that it does return the correct data. The error is thrown in a Xamarin phone app that is calling the web service. The ""Message"" of the error is simply a null reference error and the stack trace is: at MyApp.MyService.Service1SoapClient.EndGetAllMyTypes(IAsyncResult result) at MyApp.MyService.Service1SoapClient.OnEndGetAllMyTypes(IAsyncResult result) at System.ServiceModel.ClientBase`1.OnAsyncCallCompleted(IAsyncResult result) <code>  List<MyType> myTypes = new List<MyTypes>();[WebMethod]public List<MyType> GetAllMyTypes(){ string sql = ""SELECT * FROM MyType""; DataTable dt = new DataTable(); dt = Globals.GLS_DataQuery(sql); List<MyType> myType = new List<MyType>(); foreach (DataRow row in dt.Rows) { MyType myType = new MyType() { ID = (int)row[""Id""] }; myTypes.Add(myType); } return myTypes;} client.GetAllMyTypesCompleted += client_GetAllMyTypesCompleted;client.GetAllMyTypesAsync(); private void client_GetAllMyTypesCompleted(object sender, GetAllMyTypesCompletedEventArgs e){ var collection = e.Result;} public static DataTable GLS_DataQuery(string sql){ DataTable dt = new DataTable SqlCommand command = new SqlCommand(sql, connection); SqlDataAdapter adapter = new SqlDataAdapter(command); adapter.Fill(dt); return dt;}",TargetInvocationException when retrieving list from SOAP web service in Azure
"What is, really, a ""Special Class""?"," After failing to get something like the following to compile: with the error A constraint cannot be special class `System.Array'I started wondering, what exactly is a ""special class""?People often seem to get the same kind of error when they specify System.Enum in a generic constraint. I got the same results with System.Object, System.Delegate, System.MulticastDelegate and System.ValueType too.Are there more of them? I cannot find any info on ""special classes"" in C#.Also, what is so special about those classes that we can't use them as a generic type constraint? <code>  public class Gen<T> where T : System.Array{}",A constraint cannot be special class?
"What exactly is a ""Special Class""?"," After failing to get something like the following to compile: with the error A constraint cannot be special class `System.Array'I started wondering, what exactly is a ""special class""?People often seem to get the same kind of error when they specify System.Enum in a generic constraint. I got the same results with System.Object, System.Delegate, System.MulticastDelegate and System.ValueType too.Are there more of them? I cannot find any info on ""special classes"" in C#.Also, what is so special about those classes that we can't use them as a generic type constraint? <code>  public class Gen<T> where T : System.Array{}",A constraint cannot be special class?
C# NewtonSoft Deserialize JSON object property to string," I have some JSON that has a variety of properties most of which are simple data types. However, I have one property in the JSON that when I deserialize it to a C# class I simply need it to be deserialized as a string.Example JSON: The ""json"" object has no set structure other than it will be a valid JSON object.So in the above example the value of ""json"" is a JSON object -- but when it gets deserialized, I need it as a string.So if my C# class is: And then if I use: I would like myClass.Json to just be a simple string.I have looked at creating a custom JsonConverter for this but that seems way too complex for something this simple. I must be be missing something here. Any direction would be greatly appreciated.I also saw this post -- but it really doesn't answer the question: JSON.Net - How to deserialize JSON to object but treating a property as a string instead of JSON? <code>  {""simpleProperty"": ""value1"", ""json"":{""a"":""a1"", ""b"":""b1""}} public class MyClass{ public string SimpleProperty { get; set; } public string Json { get; set; }} var myClass = JsonConvert.DeserializeObject<MyClass>(jsonStr);",Deserialize JSON object property to string
Is it possible to use C# 6.0 nameof expression in switch statement?," The new C# 6.0 nameof is great in the PropertyChanged pattern for propagating property changes using something like: When listening of property changes I use this (yes, even with ugly hardcoded strings): With the new nameof expressions would this code compile / work? <code>  private string _myProperty;public string MyProperty{ get { return _myProperty; } set { _myProperty= value; OnPropertyChanged(nameof(MyProperty)); }} private void OnMyObjectPropertyChanged(object sender, PropertyChangedEventArgs args) { switch (args.PropertyName) { case ""MyProperty"": DoSomething(); break; } } private void OnMyObjectPropertyChanged(object sender, PropertyChangedEventArgs args){ switch (args.PropertyName) { case nameof(MyObject.MyProperty): DoSomething(); break; }}",Is it possible to use an nameof expression in switch statement?
How to speed up huge view data reading in SQL Server and C#," I have a view in my database with around 200k entries. I'm reading it with the following code: The view has only 2 columns of GUID type. The ExecuteCommand() is very fast, but the while loop (even with no code, just the looping) takes ~150 seconds.Is there a better or fast way to do this? <code>  using (SqlConnection conn = new SqlConnection....){ conn.Open(); string query = ""SELECT * FROM SP3DPROJECT.dbo.XSystemHierarchy""; using (SqlCommand comm = new SqlCommand()) { comm.CommandText = query; comm.Connection = conn; using (SqlDataReader reader = comm.ExecuteReader()) { DateTime start = DateTime.Now; while (reader.Read()) { // Code goes here, but for performance // test I'm letting this empty } DateTime end = DateTime.Now; TimeSpan elapsed = (end- start).TotalSeconds; } }}",How to speed up reading large amounts of data in SQL Server and C#
How to store Multiple records in SQL using DataGridView," I'm trying to insert 5 records into a SQL Server database table from DataGridView using C#.From my code it takes input of several records but insert only first record in database. Can anybody help me to save 5 records in database by a single click of save button?Here is my code: <code>  DataSet ds = new DataSet(); SqlConnection cs = new SqlConnection(@""Data Source=DELL-PC;Initial Catalog=Image_DB;Integrated Security=True""); SqlDataAdapter da = new SqlDataAdapter(); SqlCommand cmd = new SqlCommand(); BindingSource Input = new BindingSource(); DataView dview = new DataView(); private void Form1_Load(object sender, EventArgs e) { //create a DataGridView Image Column DataGridViewImageColumn dgvImage = new DataGridViewImageColumn(); //set a header test to DataGridView Image Column dgvImage.HeaderText = ""Images""; dgvImage.ImageLayout = DataGridViewImageCellLayout.Stretch; DataGridViewTextBoxColumn dgvId = new DataGridViewTextBoxColumn(); dgvId.HeaderText = ""ID""; DataGridViewTextBoxColumn dgvName = new DataGridViewTextBoxColumn(); dgvName.HeaderText = ""Name""; dataGridView1.Columns.Add(dgvId); dataGridView1.Columns.Add(dgvName); dataGridView1.Columns.Add(dgvImage); dataGridView1.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.Fill; dataGridView1.RowTemplate.Height = 120; dataGridView1.AllowUserToAddRows = false; } // button add data to dataGridView // insert image from pictureBox to dataGridView private void btn_Add_Click(object sender, EventArgs e) { MemoryStream ms = new MemoryStream(); pictureBox1.Image.Save(ms, pictureBox1.Image.RawFormat); byte[] img = ms.ToArray(); dataGridView1.Rows.Add(txt_UserID.Text, txt_Name.Text, img); } // browse image in pictureBox1 Click private void pictureBox1_Click(object sender, EventArgs e) { OpenFileDialog opf = new OpenFileDialog(); opf.Filter = ""Choose Image(*.jpg; *.png; *.gif)|*.jpg; *.png; *.gif""; if (opf.ShowDialog() == DialogResult.OK) { pictureBox1.Image = Image.FromFile(opf.FileName); } } private void btn_Save_Click(object sender, EventArgs e) { for (int i = 5; i < dataGridView1.Rows.Count; i++) { string col1 = dataGridView1[0, dataGridView1.CurrentCell.RowIndex].Value.ToString(); string col2 = dataGridView1[1, dataGridView1.CurrentCell.RowIndex].Value.ToString(); string col3 = dataGridView1[2, dataGridView1.CurrentCell.RowIndex].Value.ToString(); string insert_sql = ""INSERT INTO Input(UserID, UserName, PassImage) VALUES ('"" + col1 + ""','"" + col2 + ""','"" + col3 + ""')""; this.getcom(insert_sql); } MessageBox.Show(""Record Added""); } public SqlConnection GetSqlConnection() //connection function { string str_sqlcon = ""Data Source=DELL-PC;Initial Catalog=Image_DB;Integrated Security=True""; SqlConnection mycon = new SqlConnection(str_sqlcon); mycon.Open(); return mycon; } public void getcom(string sqlstr) //function for adding rows { SqlConnection sqlcon = this.GetSqlConnection(); // Watch out same string type as GetSQLConnection function SqlCommand sqlcom = new SqlCommand(sqlstr, sqlcon); sqlcom.ExecuteNonQuery(); sqlcom.Dispose(); sqlcon.Close(); sqlcon.Dispose(); }",How to store multiple records in SQL Server using DataGridView
"C# Service Causes SCM Error ""reported invalid an current state 0"""," I wrote a small service, which acts as a local network server. To write the service, I followed a tutorial on MSDN, how to write a service using the ServiceBase class.But when I register and start the service, I get error messages as shown below. I get exactly two of these error messages at the start and at the service stop. (Example = name of service). The Example service has reported an invalid current state 0.Here a minimal sample of my service with all relevant parts. The code starts with an enum and struct definition which was provided in the MSDN tutorial: After this, the service code I wrote, reduced to the relevant parts: The main entry point is simple as this: As you can see, the number of error messages matches the number of SetServiceState calls. If I add additional such calls, the number of error messages increases accordingly.So I assume, the whole problem is somewhere in the way I call the SetServiceStatus API, but I currently can't see the problem.Can you spot the Problem?Anyway is this the correct way to build a Service using C# and .NET? <code>  public enum ServiceState{ SERVICE_STOPPED = 0x00000001, SERVICE_START_PENDING = 0x00000002, SERVICE_STOP_PENDING = 0x00000003, SERVICE_RUNNING = 0x00000004, SERVICE_CONTINUE_PENDING = 0x00000005, SERVICE_PAUSE_PENDING = 0x00000006, SERVICE_PAUSED = 0x00000007,}[StructLayout(LayoutKind.Sequential)]public struct ServiceStatus{ public long dwServiceType; public ServiceState dwCurrentState; public long dwControlsAccepted; public long dwWin32ExitCode; public long dwServiceSpecificExitCode; public long dwCheckPoint; public long dwWaitHint;}; namespace example{ public partial class Service : ServiceBase { public Service() : base() { this.ServiceName = ""ExampleService""; this.AutoLog = false; this.CanStop = true; this.CanShutdown = false; this.CanPauseAndContinue = false; this.CanHandlePowerEvent = false; this.CanHandleSessionChangeEvent = false; } protected override void OnStart(string[] args) { try { SetServiceState(ServiceState.SERVICE_START_PENDING, 100000); // ... initialise and start... SetServiceState(ServiceState.SERVICE_RUNNING); } catch (System.Exception ex) { SetServiceState(ServiceState.SERVICE_STOPPED); } } protected override void OnStop() { SetServiceState(ServiceState.SERVICE_STOP_PENDING, 100000); // ... stop service ... SetServiceState(ServiceState.SERVICE_STOPPED); } private void SetServiceState(ServiceState state, int waitHint = 0) { ServiceStatus serviceStatus = new ServiceStatus(); serviceStatus.dwCurrentState = state; serviceStatus.dwWaitHint = waitHint; SetServiceStatus(this.ServiceHandle, ref serviceStatus); } [DllImport(""advapi32.dll"", SetLastError=true)] private static extern bool SetServiceStatus(IntPtr handle, ref ServiceStatus serviceStatus); }} static void Main(string[] args){ ServiceBase.Run(new Service());}","Service Causes SCM Error ""reported an invalid current state 0"""
"C# Service Causes SCM Error ""reported an invalid current state 0"""," I wrote a small service, which acts as a local network server. To write the service, I followed a tutorial on MSDN, how to write a service using the ServiceBase class.But when I register and start the service, I get error messages as shown below. I get exactly two of these error messages at the start and at the service stop. (Example = name of service). The Example service has reported an invalid current state 0.Here a minimal sample of my service with all relevant parts. The code starts with an enum and struct definition which was provided in the MSDN tutorial: After this, the service code I wrote, reduced to the relevant parts: The main entry point is simple as this: As you can see, the number of error messages matches the number of SetServiceState calls. If I add additional such calls, the number of error messages increases accordingly.So I assume, the whole problem is somewhere in the way I call the SetServiceStatus API, but I currently can't see the problem.Can you spot the Problem?Anyway is this the correct way to build a Service using C# and .NET? <code>  public enum ServiceState{ SERVICE_STOPPED = 0x00000001, SERVICE_START_PENDING = 0x00000002, SERVICE_STOP_PENDING = 0x00000003, SERVICE_RUNNING = 0x00000004, SERVICE_CONTINUE_PENDING = 0x00000005, SERVICE_PAUSE_PENDING = 0x00000006, SERVICE_PAUSED = 0x00000007,}[StructLayout(LayoutKind.Sequential)]public struct ServiceStatus{ public long dwServiceType; public ServiceState dwCurrentState; public long dwControlsAccepted; public long dwWin32ExitCode; public long dwServiceSpecificExitCode; public long dwCheckPoint; public long dwWaitHint;}; namespace example{ public partial class Service : ServiceBase { public Service() : base() { this.ServiceName = ""ExampleService""; this.AutoLog = false; this.CanStop = true; this.CanShutdown = false; this.CanPauseAndContinue = false; this.CanHandlePowerEvent = false; this.CanHandleSessionChangeEvent = false; } protected override void OnStart(string[] args) { try { SetServiceState(ServiceState.SERVICE_START_PENDING, 100000); // ... initialise and start... SetServiceState(ServiceState.SERVICE_RUNNING); } catch (System.Exception ex) { SetServiceState(ServiceState.SERVICE_STOPPED); } } protected override void OnStop() { SetServiceState(ServiceState.SERVICE_STOP_PENDING, 100000); // ... stop service ... SetServiceState(ServiceState.SERVICE_STOPPED); } private void SetServiceState(ServiceState state, int waitHint = 0) { ServiceStatus serviceStatus = new ServiceStatus(); serviceStatus.dwCurrentState = state; serviceStatus.dwWaitHint = waitHint; SetServiceStatus(this.ServiceHandle, ref serviceStatus); } [DllImport(""advapi32.dll"", SetLastError=true)] private static extern bool SetServiceStatus(IntPtr handle, ref ServiceStatus serviceStatus); }} static void Main(string[] args){ ServiceBase.Run(new Service());}","Service Causes SCM Error ""reported an invalid current state 0"""
Dependency injection using Azure WebJobs SDK," The problem is that the Azure WebJobs SDK supports only public static methods as job entry-points which means there is no way of implementing constructor/property injection.I am unable to find anything about this topic in official WebJobs SDK documentation/resources. The only solution that I came across is based on service locator (anti) pattern described on this post here.Is there a good way to use ""proper"" dependency injection for projects based on Azure WebJobs SDK? <code> ",Dependency injection using Azure WebJobs SDK?
C#: use an array of Vector2f structs as an array of floats in-place," I have an array Vector2f structs that each contain two floats, and I want to pass it to a function that takes an array of floats. These structs represent 2d coordinates, and I want the end result to be [x0, y0, x1, y1, ... xn, yn]. Some code to demonstrate: This is easy by copying the contents into a new array of floats, but the data gets large and it would be nice not to duplicate it.This may not be possible due to memory layout. <code>  using System;using System.Runtime.InteropServices;public class Test{ [StructLayout(LayoutKind.Sequential)] public struct Vector2f { float x; float y; public Vector2f(float x, float y) { this.x = x; this.y = y; } } public static void Main() { Vector2f[] structs = new Vector2f[] { new Vector2f(1f, 2f), new Vector2f(3f, 4f) }; // I want this to contain 1f, 2f, 3f, 4f // But Syntax error, cannot convert type! float[] floats = (float[])structs; }}",Use an array of Vector2f structs as an array of floats in-place
use an array of Vector2f structs as an array of floats in-place," I have an array Vector2f structs that each contain two floats, and I want to pass it to a function that takes an array of floats. These structs represent 2d coordinates, and I want the end result to be [x0, y0, x1, y1, ... xn, yn]. Some code to demonstrate: This is easy by copying the contents into a new array of floats, but the data gets large and it would be nice not to duplicate it.This may not be possible due to memory layout. <code>  using System;using System.Runtime.InteropServices;public class Test{ [StructLayout(LayoutKind.Sequential)] public struct Vector2f { float x; float y; public Vector2f(float x, float y) { this.x = x; this.y = y; } } public static void Main() { Vector2f[] structs = new Vector2f[] { new Vector2f(1f, 2f), new Vector2f(3f, 4f) }; // I want this to contain 1f, 2f, 3f, 4f // But Syntax error, cannot convert type! float[] floats = (float[])structs; }}",Use an array of Vector2f structs as an array of floats in-place
NLog extensions add assembly programattically," I am using nlog v3 and I cannot figure out the way to do programatically what does. I found one answer on old Nlog forums, that could've helped, but it was for v1 and v2 and these classes are no longer there.Anybody knows how to do it in code? <code>  <nlog> <extensions> <add assembly=""NLog.MongoDB"" /> </extensions>...",NLog extensions add assembly programmatically
C# register event handler for specific subclass," Ok, code structure question:Let's say I have a class, FruitManager, that periodically receives Fruit objects from some data-source. I also have some other classes that need to get notified when these Fruit objects are received. However, each class is only interested in certain types of fruit, and each fruit has different logic for how it should be handled. Say for example the CitrusLogic class has methods OnFruitReceived(Orange o) and OnFruitReceived(Lemon l), which should be called when the respective subtype of fruit is received, but it doesn't need to be notified of other fruits.Is there a way to elegantly handle this in C# (presumably with events or delegates)? Obviously I could just add generic OnFruitReceived(Fruit f) event handlers, and use if statements to filter unwanted subclasses, but this seems inelegant. Does anyone have a better idea? Thanks!Edit: I just found generic delegates and they seem like they could be a good solution. Does that sound like a good direction to go? <code> ",Register event handler for specific subclass
Change Form color constantly C#," I want my program to constantly change the font background color, but I want it to go smoothly so I tried to modify a Color variable Color custom; and use it to for the background color of the form this.BackColor = custom; but it doesn't work and I don't know how to make it work, here is the complete code: <code>  private void Principal_Load(object sender, EventArgs e){ Color custom; int contr = 0, contg = 0, contb = 0; do { while (contr < 255 && contg == 0) { if (contb != 0) { contb--; } contr++; while (contg < 255 && contb == 0) { if (contr != 0) { contr--; } contg++; while (contb < 255 && contr == 0) { if (contg != 0) { contg--; } contb++; } } } custom = Color.FromArgb(contr, contg, contb); this.BackColor = custom; } while (true);}",Change Form color constantly
C# Properties and Auto-Implementations," I'm using .NET 4.5 in a VSTO addin for outlook 2013. I'm having some trouble fully grasping properties and accessors. Auto-implemented accessors which I assume are when you just write get; set; rather than get { //code }, etc. are also giving me trouble. I have a dictionary I use internally in my class. Here is my code: then later on: I am using the same names as the properties in the code later on, within the same class.I never actually write: to create the variables I just was using the property directly.I tried changing my code to do this, and I had some issues and realized my understanding of properties is a bit mixed up.Here are a few questions I need clarified that I can't seem to find the correct answer to.First, is there any reason to use a private property? My dictionaries are never accessed outside of the class or in any derived classes so is there a reason to even use properties? I don't use any special validation or anything in the setter or anything like that. Second, when I tried to change my code to use variables and then access them via the properties like your typical property example would, I ran into problems. I found an example where the getter was set to return _clientDict, but the setter was just set; It gave me the error: that I must give set a body because it's not abstract or partial. Why would it not auto-implement the setter for me in this instance?Last, when I call new on the properties in the same class that it is declared in, what is the difference between doing that with a property and a normal variable of the same type? Do properties differ at all from variables in that case? Is it bad practice to use properties this way when it should be accomplished with private variables? These may be some misguided questions but I can't find any other place that has the information to help me understand these distinctions. I've been playing around with properties to try and figure all of this out but I could use so me assistance. <code>  private Dictionary<string, string> clientDict { get; set; }private Dictionary<string, string> clientHistoryDict { get; set; } clientDict = new Dictionary<string, string>();clientHistoryDict = new Dictionary<string, string>(); private Dictionary<string, string> _clientDict; // etc.",Properties and auto-implementations
regex check decimal and total length of digit," Using regex, I can check if it is decimal or not But what I want to control is total length of those digit. But I still cannot control it.After 2 days later, my final solution is Debuggex Demo <code>  ^\d*\.?\d*$ (^\d*\.?\d*$){1,10} (?=^\d*\.?\d*$)^.{1,10}$",Check decimal and total length of number
C# -- IS vs. AS vs. IsAssignableFrom - What are the differences when checking for objectTypes and Interfaces?," I'm sort of new to C# and i was wondering if you could help me out.The scenario: The Goal: Determine wether the object o implements the given Interface-Definition IExampleInterface or not.The questions:Which implementation is best practice?Disregarding the first question, which one is technically the most correct?What are the specific differences in the operators? MSDNAA isn't truly detailed on them.Which call takes the longest / shortest? <code>  public bool ObjectImplementsSpecificInterface (object obj){ // 1. if (obj is IExampleInterface) { return true; } // 2. var tmp = obj as IExampleInterface; if (tmp != null) { return true; } // 3. if (typeof(IExampleInterface).IsAssignableFrom (obj.GetType ())) { return true; }}",IS vs. AS vs. IsAssignableFrom - What are the differences when checking for objectTypes and Interfaces?
Deserializing Json String into Objects," I have a Json String that I get from a web service; it has a list of collections, each collection represents an object, for example: My actual code (not working of course ): I use Json.net and C#. I can't find a solution, I've read that I should use JsonReader and set its SupportMultipleContent property to true but I don't know how to implement that solution. <code>  [ // Root List [ // First Collection : Team Object { ""id"": 1, ""team_name"": ""Equipe Saidi"", ""is_active"": true, ""last_localisation_date"": ""2015-05-06T13:33:15+02:00"" }, { ""id"": 3, ""team_name"": ""Equipe Kamal"", ""is_active"": true, ""last_localisation_date"": ""2015-05-06T09:22:15+02:00"" } ], [// Second Collection : user Object { ""id"": 1, ""login"": ""khalil"", ""mobile_password"": ""####"", ""first_name"": ""Abdelali"", ""last_name"": ""KHALIL"", ""email"": ""KHALIL@gmail.com"", ""role"": ""DR"", ""is_active"": true, ""charge"": false }, { ""id"": 2, ""login"": ""ilhami"", ""mobile_password"": ""####"", ""first_name"": ""Abdellah"", ""last_name"": ""ILHAMI"", ""email"": ""ILHAMI@gmail.com"", ""role"": ""DR"", ""is_active"": true, ""charge"": false } ] ] public async Task TeamsAndMobileUsers() { string data = """"; IList<User> MobileUsersList = new List<User>(); IList<Team> TeamsList = new List<Team>(); try { data = await GetResponse(PATH + TEAMS_USERS_URL); TeamsList = JsonConvert.DeserializeObject<List<Team>>(data); MobileUsersList = JsonConvert.DeserializeObject<List<User>>(data); // Inserting await SetAchievedActions(TeamsList); } catch (Exception e) { _errors.Add(e.Message); } }",Deserializing Json String into multiple Object types
Linq ForEach - Returning cannot assign 'void' to an implicitly-typed local variable.," I'm trying to use a linq query to save myself a few lines of code. I'm getting a compile error where I'm told: Returning cannot assign 'void' to an implicitly-typed local variable. I'm trying to understand the linq query better. I understand that it's got a ""void"" return type? If this is the case how am I able to then add to the list?  <code>  var GIANTLIST = new List<string>();var taskIds = Complaint.Tasks.Select(s => s.Task_ID).ToList().ForEach( s =>{ GIANTLIST.Add(""<Task_ID="" + s.ToString() + "">"");});",Linq ForEach - Returning cannot assign 'void' to an implicitly-typed local variable
Change name attribute value in razor view model," I have the following: As you can see this is creating an input element.The view model passed to the view contains the following: At the moment the input element contains a name attribute with the value of ""SearchPhrase"" but I would like the value to be just ""q"" without renaming the property.I would prefer an extension which allows me to call TextBoxFor but without the need of having to supply the Name property, so that the custom attribute somehow sets the value of the Name property automatically to the value specified in the custom attribute.The following is an example of what I mean: Combined with: Which would then produce something similar to the following: I would like this custom attribute to take effect whenever the SearchBoxViewModel is used regardless of what template is used to prevent errors, with the intention of being clear to programmers, while creating a user-friendly query string for the user.Is it possible to do this using a custom attribute on the SearchPhrase property in a similar fashion to how the display name is changed? <code>  @model Pharma.ViewModels.SearchBoxViewModel<div class=""smart-search""> @using (Html.BeginForm(""Index"", ""Search"", FormMethod.Get, new { @class = ""form-horizontal"", role = ""form"" })) { <div class=""form-group""> <div class=""hidden-xs- col-sm-1 col-md-1 col-lg-1 text-right""> @Html.LabelFor(m => m.SearchPhrase, new { @class = ""control-label"" }) </div> <div class=""col-xs-8 col-sm-8 col-md-9 col-lg-10""> @Html.TextBoxFor(m => m.SearchPhrase, new { @class = ""form-control"" }) </div> <div class=""col-xs-4 col-sm-3 col-md-2 col-lg-1""> <input type=""submit"" value=""Search"" class=""btn btn-default"" /> </div> </div> }</div> public class SearchBoxViewModel{ [Required] [Display(Name = ""Search"")] public string SearchPhrase { get; set; }} public class SearchBoxViewModel{ [Required] [Display(Name = ""Search"")] [Input(Name = ""q"")] public string SearchPhrase { get; set; }} @model Pharma.ViewModels.SearchBoxViewModel<div class=""smart-search""> @using (Html.BeginForm(""Index"", ""Search"", FormMethod.Get, new { @class = ""form-horizontal"", role = ""form"" })) { <div class=""form-group""> <div class=""hidden-xs- col-sm-1 col-md-1 col-lg-1 text-right""> @Html.LabelFor(m => m.SearchPhrase, new { @class = ""control-label"" }) </div> <div class=""col-xs-8 col-sm-8 col-md-9 col-lg-10""> @Html.TextBoxFor(m => m.SearchPhrase, new { @class = ""form-control"" }) </div> <div class=""col-xs-4 col-sm-3 col-md-2 col-lg-1""> <input type=""submit"" value=""Search"" class=""btn btn-default"" /> </div> </div> }</div> <div class=""smart-search""> <form action=""/Search/Index"" method=""get"" class=""form-horizontal"" role=""form""> <div class=""form-group""> <div class=""hidden-xs- col-sm-1 col-md-1 col-lg-1 text-right""> <label for=""Search"" class=""control-label"">Search</label> </div> <div class=""col-xs-8 col-sm-8 col-md-9 col-lg-10""> <input type=""text"" name=""q"" id=""Search"" value="""" class=""form-control"" /> </div> <div class=""col-xs-4 col-sm-3 col-md-2 col-lg-1""> <input type=""submit"" value=""Search"" class=""btn btn-default"" /> </div> </div> </form></div>",How can I change the input element name attribute value in a razor view model using a custom attribute in a model?
"""Failed to open a connection to the database"" While creating a Table Adapter in C#"," So, I'm mantaining a software an ex co-worker did. He uses an xsd to create TableAdapters for his reports and other stuff.The thing is, I need to add a new TableAdapter and I get the aforementioned error. It also says the dread ""A network-related or instance-specific error occurred while establishing a connection to SQL Server.""I am at loss here and I don't know what to do. Here are the facts:I have 2 connection strings, one for the production environment and one for the development environment (my computer).When I go to settings and then the edit window of the connection string, I hit ""test connection"" and it says it works fine.Both SQL Server 2008R2 and Visual Studio 2010 are on the same machine, my machine.I do not have a named instance. I right click on the xsd design view and click ""Add -> TableAdapter"" and use the local connection string (the one I already tested and worked)I click ""Use existing stored procedures"" and then hit [Next]. Then I am able to pick a stored procedure for the Select section and I can see the columns.I click finish, the system locks for a while and then I get the error.Named Pipes, TCP/IP are enabled in SQL Server configuration.I'm kinda lost and I already wasted 2 days on this. I have tried what little I know and nothings works. I hope I can find help within your wisdom.Sorry for the long post but I wanted to provide as much info as I could in one single shot. <code> ","Failed to open a connection to the database"" While creating a Table Adapter in C#"
"**SOLVED** Failed to open a connection to the database"" While creating a Table Adapter in C#"," So, I'm mantaining a software an ex co-worker did. He uses an xsd to create TableAdapters for his reports and other stuff.The thing is, I need to add a new TableAdapter and I get the aforementioned error. It also says the dread ""A network-related or instance-specific error occurred while establishing a connection to SQL Server.""I am at loss here and I don't know what to do. Here are the facts:I have 2 connection strings, one for the production environment and one for the development environment (my computer).When I go to settings and then the edit window of the connection string, I hit ""test connection"" and it says it works fine.Both SQL Server 2008R2 and Visual Studio 2010 are on the same machine, my machine.I do not have a named instance. I right click on the xsd design view and click ""Add -> TableAdapter"" and use the local connection string (the one I already tested and worked)I click ""Use existing stored procedures"" and then hit [Next]. Then I am able to pick a stored procedure for the Select section and I can see the columns.I click finish, the system locks for a while and then I get the error.Named Pipes, TCP/IP are enabled in SQL Server configuration.I'm kinda lost and I already wasted 2 days on this. I have tried what little I know and nothings works. I hope I can find help within your wisdom.Sorry for the long post but I wanted to provide as much info as I could in one single shot. <code> ","Failed to open a connection to the database"" While creating a Table Adapter in C#"
"**SOLVED** Failed to open a connection to the database"" While creating a Table Adapter in C#"," So, I'm mantaining a software an ex co-worker did. He uses an xsd to create TableAdapters for his reports and other stuff.The thing is, I need to add a new TableAdapter and I get the aforementioned error. It also says the dread ""A network-related or instance-specific error occurred while establishing a connection to SQL Server.""I am at loss here and I don't know what to do. Here are the facts:I have 2 connection strings, one for the production environment and one for the development environment (my computer).When I go to settings and then the edit window of the connection string, I hit ""test connection"" and it says it works fine.Both SQL Server 2008R2 and Visual Studio 2010 are on the same machine, my machine.I do not have a named instance. I right click on the xsd design view and click ""Add -> TableAdapter"" and use the local connection string (the one I already tested and worked)I click ""Use existing stored procedures"" and then hit [Next]. Then I am able to pick a stored procedure for the Select section and I can see the columns.I click finish, the system locks for a while and then I get the error.Named Pipes, TCP/IP are enabled in SQL Server configuration.I'm kinda lost and I already wasted 2 days on this. I have tried what little I know and nothings works. I hope I can find help within your wisdom.Sorry for the long post but I wanted to provide as much info as I could in one single shot. <code> ","Failed to open a connection to the database"" While creating a Table Adapter in C#"
ContinueWith default values," What values use ContinueWith(Action<Task> continuationAction) for CancellationToken, TaskContinuationOptions and TaskScheduler and where can I find this in the official documentation? <code> ",What are the ContinueWith default values
WPF CheckBox CheckChanged event," After Checkbox.IsChecked = true, the Checked event is fired. After Checkbox.IsChecked = false, the UnChecked event is fired.But what event is fired after IsChecked = null? <code> ",CheckBox CheckChanged event
Isolate exceptions in an AppDomain," TL;DR: How do you isolate add-in exceptions from killing the main process?I want to have a very stable .Net application that runs less stable code in an AppDomain. This would appear to be one of the prime purposes of the AppDomain in the first place (well, that and security sandboxing) but it doesn't appear to work.For instance in AddIn.exe: Called in my 'stable' code with: The exception thrown in the AppDomain gets passed straight to the application that created the domain. I can log these with domain.UnhandledException and catch them in the wrapper application.However, there are more problematic exceptions thrown, for instance: This will throw a stackoverflow exception that kills the entire application every time. It doesn't even fire domain.UnhandledException - it just goes straight to killing the entire application.In addition calling things like Environment.Exit() from inside the AppDomain also kill the parent application, do not pass GO, do not collect 200 and don't run any ~Finialiser or Dispose().It seems from this that AppDomain fundamentally doesn't do what it claims (or at lease what it appears to claim) to do, as it just passes all exceptions straight to the parent domain, making it useless for isolation and pretty weak for any kind of security (if I can take out the parent process I can probably compromise the machine). That would be a pretty fundamental failure in .Net, so I must be missing something in my code.Am I missing something? Is there some way to make AppDomain actually isolate the code that it's running and unload when something bad happens? Am I using the wrong thing and is there some other .Net feature that does provide exception isolation? <code>  public static class Program{ public static void Main(string[] args) { throw new Exception(""test"") }} var domain = AppDomain.CreateDomain(""sandbox"");domain.UnhandledException += (sender, e) => { Console.WriteLine(""\r\n ## Unhandled: "" + ((Exception) e.ExceptionObject).Message);};domain.ExecuteAssemblyByName(""AddIn.exe"", ""arg A"", ""arg B"") public static class Program{ public static void Main(string[] args) { Stackoverflow(1); } static int Stackoverflow(int x) { return Stackoverflow(++x); }}",Isolate exceptions thrown in an AppDomain to not Crash the Application
Kendo Databinding," I have designed a view using some of the Kendo Telerik controls. I am not sure how to bind their controls to data. This generated scaffolded method works : How do I bind the Kendo Textbox? <code>  @Html.EditorFor(model => model.surName, new { htmlAttributes = new { @class = ""form-control"" } }) @(Html.Kendo().TextBox() .Name(""fName"") .HtmlAttributes(new { placeholder = ""First Name"", required = ""required"", validationmessage=""Enter First Name"" }))",How do I bind the Kendo Textbox control to its data?
HTTP Post to Web API 2 - Options request recieved and handled no further request recieved," I have a web application using MVC and AngularJS, which connects to a Web API 2 api, that I have set up in a separate project. Currently I am able to retrieve information from the Api with no problems. However when I try to do a HTTP Post I am getting no response, originally I was getting a problem with the pre-flight request failing, I have now handled this in my controller, however it does not send the proper request after it has got an OK message back.I have included my code for the Angular Factory and the C# Controller in the API. Edit: I am still not having any joy with this, however I tested in Internet Explorer and it works with no problems at all. I have got it working in chrome by starting with web security disabled, however obviously this is not ideal as it will not work on a user PC with security enabled.  <code>  [EnableCors(origins: ""*"", headers: ""*"", methods: ""*"")]public class RegisterController : ApiController{ public string Post() { return ""success""; } public HttpResponseMessage Options() { return new HttpResponseMessage { StatusCode = HttpStatusCode.OK }; }}var RegistrationFactory = function($http, $q, ApiAddress) {return function(model) { // $http.post(ApiAddress.getApiAddress() + '/Register/Post', model.ToString()); $http({ method: ""POST"", url: ApiAddress.getApiAddress() + '/Register/Post', data: model, headers: { 'Content-Type': 'application/json; charset=utf-8' } }).success(function(data) { $location.path(""/""); });}};RegistrationFactory.$inject = ['$http', '$q', 'ApiAddress'];",HTTP Post to Web API 2 - Options request received and handled no further request received
Insert a child entity with many to many relation to an existing parent entity," Why do I get an DbUpdateException - there are no further details - when I try to insert a new pupil to an existing schoolclassCode?This is a many to many relation. Do I have to insert the pupil firstly in context.Pupils.add(pupil) ?I thought I can do the insert of the pupil and set into relation to a schoolclasscode in ONE go by doing and then set the schoolclassCode as modified.How is Insert an entity done in many to many relation WITH an existing principal/parent entity?UPDATE UPDATE 2 Actually the many to many relationship should work by convention but still I explicitly setup the configuration betweeen SchoolclassCode and Pupil due to the DbUpdateException behavior which I could not explain. LOG ERRORS happening on SaveChanges inside my Attach Pupil method THE REAL PROBLEMare the TransactionScope before and after each test which I commented out and THEN everything worked fine!Why do I get this Exception when I use this code - Other tests + TransactionScope work fine !!! - <code>  var schoolclassCode = await context.SchoolclassCodes.SingleAsync(s => s.Id == pupil.SchoolclassCodeId);schoolclassCode.Pupils.Add(pupil);context.Entry(schoolclassCode).State = EntityState.Modified;int count = await context.SaveChangesAsync(); schoolclassCode.Pupils.Add(pupil); System.Data.Entity.Infrastructure.DbUpdateException was unhandled by user code HResult=-2146233087 Message=An error occurred while updating the entries. See the inner exception for details. Source=mscorlib StackTrace: bei System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task) bei System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) bei System.Runtime.CompilerServices.TaskAwaiter`1.GetResult() bei TGB.Repository.PupilRepository.<AddPupil>d__8.MoveNext() in c:\Repository\TGB\TGB.Repository\PupilRepository.cs:Zeile 29. --- Ende der Stapelberwachung vom vorhergehenden Ort, an dem die Ausnahme ausgelst wurde --- bei System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task) bei System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) bei System.Runtime.CompilerServices.TaskAwaiter`1.GetResult() bei Business.IntegrationTests.PupilRepositoryTests.CreatePupil() in c:\TGB\IntegrationTests\PupilRepositoryTests.cs:Zeile 31. InnerException: System.Data.Entity.Core.UpdateException HResult=-2146233087 Message=An error occurred while updating the entries. See the inner exception for details. Source=EntityFramework StackTrace: bei System.Data.Entity.Core.Mapping.Update.Internal.UpdateTranslator.<UpdateAsync>d__0.MoveNext() --- Ende der Stapelberwachung vom vorhergehenden Ort, an dem die Ausnahme ausgelst wurde --- bei System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task) bei System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) bei System.Data.Entity.Core.Objects.ObjectContext.<ExecuteInTransactionAsync>d__3d`1.MoveNext() --- Ende der Stapelberwachung vom vorhergehenden Ort, an dem die Ausnahme ausgelst wurde --- bei System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task) bei System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) bei System.Data.Entity.Core.Objects.ObjectContext.<SaveChangesToStoreAsync>d__39.MoveNext() --- Ende der Stapelberwachung vom vorhergehenden Ort, an dem die Ausnahme ausgelst wurde --- bei System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task) bei System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) bei System.Data.Entity.SqlServer.DefaultSqlExecutionStrategy.<ExecuteAsyncImplementation>d__9`1.MoveNext() --- Ende der Stapelberwachung vom vorhergehenden Ort, an dem die Ausnahme ausgelst wurde --- bei System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task) bei System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) bei System.Data.Entity.Core.Objects.ObjectContext.<SaveChangesInternalAsync>d__31.MoveNext() InnerException: System.Data.SqlClient.SqlException HResult=-2146232060 Message=Timeout abgelaufen. Das Zeitlimit wurde vor dem Beenden des Vorgangs berschritten oder der Server reagiert nicht. Source=.Net SqlClient Data Provider ErrorCode=-2146232060 Class=11 LineNumber=0 Number=-2 Procedure="""" Server=MyAccount\SQLEXPRESS State=0 StackTrace: bei System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction) bei System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction) bei System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose) bei System.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult) bei System.Data.SqlClient.SqlCommand.EndExecuteNonQueryAsync(IAsyncResult asyncResult) bei System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization) --- Ende der Stapelberwachung vom vorhergehenden Ort, an dem die Ausnahme ausgelst wurde --- bei System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task) bei System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) bei System.Data.Entity.Utilities.TaskExtensions.CultureAwaiter`1.GetResult() bei System.Data.Entity.Core.Mapping.Update.Internal.DynamicUpdateCommand.<ExecuteAsync>d__0.MoveNext() --- Ende der Stapelberwachung vom vorhergehenden Ort, an dem die Ausnahme ausgelst wurde --- bei System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task) bei System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) bei System.Data.Entity.Core.Mapping.Update.Internal.UpdateTranslator.<UpdateAsync>d__0.MoveNext() InnerException: System.ComponentModel.Win32Exception HResult=-2147467259 Message=Der Wartevorgang wurde abgebrochen ErrorCode=-2147467259 NativeErrorCode=258 InnerException: public class SchoolclassCode{ public SchoolclassCode() { Pupils = new HashSet<Pupil>(); } public int Id { get; set; } public ISet<Pupil> Pupils { get; set; }}public class Pupil{ public Pupil() { SchoolclassCodes = new HashSet<SchoolclassCode>(); } public int Id { get; set; } public ISet<SchoolclassCode> SchoolclassCodes { get; set; } [NotMapped] public int SchoolclassCodeId { get; set; }} public class SchoolclassCodeConfiguration : EntityTypeConfiguration<SchoolclassCode>{ public SchoolclassCodeConfiguration() { base.Property(p => p.SchoolclassNumber).IsRequired().HasMaxLength(10); base.Property(p => p.SubjectName).IsRequired().HasMaxLength(10); base.Property(p => p.ClassIdentifier).IsOptional().HasMaxLength(2); base.HasMany(p => p.Pupils) .WithMany(p => p.SchoolclassCodes) .Map(x => { x.MapLeftKey(""SchoolclassCodeId""); x.MapRightKey(""PupilId""); x.ToTable(""SchoolclassCodePupil""); }); }} UPDATE [dbo].[SchoolclassCode]SET [SchoolclassNumber] = @0, [SubjectName] = @1, [Color] = @2, [ClassIdentifier] = @3, [SchoolyearId] = @4WHERE ([Id] = @5)-- @0: '7' (Type = String, Size = 10)-- @1: 'Math' (Type = String, Size = 10)-- @2: '5' (Type = Int32)-- @3: 'a' (Type = String, Size = 2)-- @4: '1' (Type = Int32)-- @5: '1' (Type = Int32)-- Executing asynchronously at 24.06.2015 16:57:57 +02:00-- Completed in 8 ms with result: 1INSERT [dbo].[Pupil]([FirstName], [LastName], [Postal], [City], [Street])VALUES (@0, @1, NULL, NULL, NULL)SELECT [Id]FROM [dbo].[Pupil]WHERE @@ROWCOUNT > 0 AND [Id] = scope_identity()-- @0: 'Max' (Type = String, Size = 25)-- @1: 'Mustermann' (Type = String, Size = 25)-- Executing asynchronously at 24.06.2015 16:49:30 +02:00-- Completed in 2 ms with result: SqlDataReaderINSERT [dbo].[SchoolclassCodePupil]([SchoolclassCodeId], [PupilId])VALUES (@0, @1)-- @0: '1' (Type = Int32)-- @1: '1' (Type = Int32)-- Executing asynchronously at 24.06.2015 16:49:30 +02:00-- Completed in 2 ms with result: 1Committed transaction at 24.06.2015 16:49:30 +02:00Closed connection at 24.06.2015 16:49:30 +02:00The thread 0x60 has exited with code 259 (0x103).The thread 0x1178 has exited with code 259 (0x103).The thread 0xdc0 has exited with code 259 (0x103).A first chance exception of type 'System.NullReferenceException' occurred in Business.IntegrationTests.dll public abstract class IntegrationTestsBase { protected TransactionScope TransactionScope; [TestInitialize] public void TestSetup() { TransactionScope = new TransactionScope(); } [TestCleanup] public void TestCleanup() { TransactionScope.Dispose(); } }",TransactionScope around Many to Many Insert with Entity Framework returns TimeoutException
C# DateTime AddDays Inaccurate / Unexpected Offset," I have a very simple DateTime object that is set to the date 01-01-0001. I am supplied a value to add to this DateTime, in days. I am seeing an unexpected offset in my results though, of two days. Let's pretend I print out the results of the AddDays() call, like so: With the value seen above (735768.0) I expect an output of ""6/18/2015 12:00:00 AM"". However, instead I get ""6/20/2015 12:00:00 AM"". When I go to the following website and calculate the duration in days between 01-01-0001-->06/18/2015 I get a value of 735,768 days, as expected:http://www.timeanddate.com/date/durationresult.html?m1=01&d1=01&y1=0001&m2=06&d2=18&y2=2015Am I doing something wrong, or is there something going on under the hood that I am not aware of?In case you are wondering, the 735,768 represents the first time value of the data that I am working with. The data is expected to start at 06/18/2015 00:00:00.Edit: I should note I merely provided that particular website as an example of a conflicting source. Other websites, including the government weather agency I get the data from all give me 06-18-2015. This doesn't mean C# is wrong. I am more so curious as to where this offset came from, and why. <code>  DateTime myDateTime = DateTime.Parse(""01-01-0001 00:00:00"");Console.WriteLine(myDateTime.AddDays(735768.0));",C# DateTime AddDays Unexpected Offset
TaskAwaiter cannot be inferred from the ussage," I get a red line under my await in my code saying:The type arguments for method 'TaskAwaiter<TResult> System.WindowsRuntimeSystemExtensions.GetAwaiter<TResult>(this Windows.Foundation.IAsyncOperation 1)' cannot be inferred from the usage. Try specifying the type arguments explicitlyThough the code compiles and seems to work fine, I just wonder what this means? (English is not my first language, so I might just not understand the message) <code>  private async void Init(){ var settings = new I2cConnectionSettings(I2CAddress); settings.BusSpeed = I2cBusSpeed.StandardMode; var aqs = I2cDevice.GetDeviceSelector(I2CControllerName); var dis = await DeviceInformation.FindAllAsync(aqs); _device = await I2cDevice.FromIdAsync(dis[0].Id, settings); _isInited = true;}",TaskAwaiter cannot be inferred from the usage
"C# How Would I Set Mouse Cursor at X,Y Coordinates, Click Left Mouse And Scroll Left,Right,Top,Bottom?"," As described in the title I've been trying to search for a way to set the mouse coordinates by using a Cursor.Position = new Point(58, 128); Then while holding the Left Mouse button (Down) I'm trying to scroll to another direction(random direction). For example, if I was to go onto Google Earth and set the cursor position at 0,0 the cursor would then scroll around the map. If anyone can help out I would surely appreciate it.ThanksSolution: floatas, thanks again for responding to this post. I spent yesterday and today trying to figure this out and I finally got it working. I will post my code in hopes this helps others out. <code> ","How Would I Set Mouse Cursor At X,Y Coordinates, Click Left Mouse And Scroll Left,Right,Top,Bottom"
"How to Set Mouse Cursor at X,Y Coordinates, Click Left Mouse And Scroll Left,Right,Top,Bottom?"," As described in the title I've been trying to search for a way to set the mouse coordinates by using a Cursor.Position = new Point(58, 128); Then while holding the Left Mouse button (Down) I'm trying to scroll to another direction(random direction). For example, if I was to go onto Google Earth and set the cursor position at 0,0 the cursor would then scroll around the map. If anyone can help out I would surely appreciate it.ThanksSolution: floatas, thanks again for responding to this post. I spent yesterday and today trying to figure this out and I finally got it working. I will post my code in hopes this helps others out. <code> ","How Would I Set Mouse Cursor At X,Y Coordinates, Click Left Mouse And Scroll Left,Right,Top,Bottom"
"How Would I Set Mouse Cursor At X,Y Coordinates, Click Left Mouse And Scroll Left,Right,Top,Bottom?"," As described in the title I've been trying to search for a way to set the mouse coordinates by using a Cursor.Position = new Point(58, 128); Then while holding the Left Mouse button (Down) I'm trying to scroll to another direction(random direction). For example, if I was to go onto Google Earth and set the cursor position at 0,0 the cursor would then scroll around the map. If anyone can help out I would surely appreciate it.ThanksSolution: floatas, thanks again for responding to this post. I spent yesterday and today trying to figure this out and I finally got it working. I will post my code in hopes this helps others out. <code> ","How Would I Set Mouse Cursor At X,Y Coordinates, Click Left Mouse And Scroll Left,Right,Top,Bottom"
"SOLVED - How to Set Mouse Cursor At X,Y Coordinates, Click Left Mouse And Scroll Left,Right,Top,Bottom"," As described in the title I've been trying to search for a way to set the mouse coordinates by using a Cursor.Position = new Point(58, 128); Then while holding the Left Mouse button (Down) I'm trying to scroll to another direction(random direction). For example, if I was to go onto Google Earth and set the cursor position at 0,0 the cursor would then scroll around the map. If anyone can help out I would surely appreciate it.ThanksSolution: floatas, thanks again for responding to this post. I spent yesterday and today trying to figure this out and I finally got it working. I will post my code in hopes this helps others out. <code> ","How Would I Set Mouse Cursor At X,Y Coordinates, Click Left Mouse And Scroll Left,Right,Top,Bottom"
"SOLVED - How Would I Set Mouse Cursor At X,Y Coordinates, Click Left Mouse And Scroll Left,Right,Top,Bottom"," As described in the title I've been trying to search for a way to set the mouse coordinates by using a Cursor.Position = new Point(58, 128); Then while holding the Left Mouse button (Down) I'm trying to scroll to another direction(random direction). For example, if I was to go onto Google Earth and set the cursor position at 0,0 the cursor would then scroll around the map. If anyone can help out I would surely appreciate it.ThanksSolution: floatas, thanks again for responding to this post. I spent yesterday and today trying to figure this out and I finally got it working. I will post my code in hopes this helps others out. <code> ","How Would I Set Mouse Cursor At X,Y Coordinates, Click Left Mouse And Scroll Left,Right,Top,Bottom"
Calling methods who ever extends the Parent Class," How would you create a Class that whichever class extends the Class, methods are automatically invoked/called. Just edit my question if it sounds misleading. I'll just showcase some samplesExample 1:In unity when you extend monobehavior your methods are automatically called. I don't know if I'm right. on libgdx As What I have Understand and Tried Implementing it my self I'm sorry, but I still really don't know how it works or what you call this technique.Especially in unity, when creating multiple controllers that extends Monobehavior, all that controllers method that been implemented are called. Who's calling this classes and methods? Some reference or books on this would be a great help. Note: Please edit my title for the right term to use on this. thanks <code>  public class MyController : MonoBehaviour { void Start() { //Being Called Once } void FixedUpdate() { //Being Called every update} Game implements ApplicationListener { @Override public void render () { //Called multiple times }} public abstract Test{ protected Test(){ onStart(); } public abstract void onStart();}public class Test2 extends Test{ public Test2(){ } @Override public void onStart(){ //Handle things here }}",Calling methods from a super class when a subclass is instantiated
SignalR: How to truly call a hub's method from C#," I'm trying to improve my application which will require calling a hub from C# instead of javascript. The current workflow for adding a task in my app is:make an API call to add the data to the databasereturn new record to AngularJS controllerinvoke hub's method from controllerhub broadcasts call to clients appropriatelyWhat I would like to do is bypass calling the hub's method from my AngularJS controller and call it directly from my API controller method. This is what my hub currently looks like: There are many SO threads out there on the topic, but everything I've read would have me adding the following code to my API controller: There are number of issues with this. First and foremost, I want the client broadcast calls to exist in a single class, not called directly from my API controller(s). Secondly, hubContext is an instance of IHubContext rather than IHubCallerConnectionContext. This means I only have access to all clients and couldn't broadcast different responses to the Caller and Others like I'm currently doing.Is there a way to truly call a hub's method from C# and, ideally, have access to the different caller options? Ideally, I'd be able to do something as easy as the following from my API controller (or better yet, a solution with DI): Thanks in advance.SOLUTIONFor posterity, I thought I'd include my full solution as per Wasp's suggestion. First, I modified my javascript (AngularJS) service to include the SignalR connection ID in a custom request header for the API call, in this case an INSERT: Then, I retrieved the connection ID from the request in my API controller after performing the applicable CRUD operation and then called my hub: My hub looks like this where I'm now only using static methods called from my API controller: As you can see, I have a conditional statement in my hub method to handle if the hub call wasn't initiated from the client side portion of my app. This would be if an external app/service called my API. In such a situation, a SignalR connection and of course ""ConnectionId"" header value would not exist. In my case, though, I still would want to call the onInsertTask method for all connected clients which informs them of the data change. This should never happen, but I just included it for completeness. <code>  public class TaskHub : Hub{ public void InsertTask(TaskViewModel task) { Clients.Caller.onInsertTask(task, false); Clients.Others.onInsertTask(task, true); }} var hubContext = GlobalHost.ConnectionManager.GetHubContext<TaskHub>();hubContext.Clients.All.onInsertTask(task); var taskHub = new TaskHub();taskHub.InsertTask(task); var addTask = function (task) { var config = { headers: { 'ConnectionId': connection.id } }; return $http.post('/api/tasks', task, config);}; public HttpResponseMessage Post(HttpRequestMessage request, [FromBody]TaskViewModel task){ var viewModel = taskAdapter.AddTask(task); var connectionId = request.Headers.GetValues(""ConnectionId"").FirstOrDefault(); TaskHub.InsertTask(viewModel, connectionId); return request.CreateResponse(HttpStatusCode.OK, viewModel);} public class TaskHub : Hub{ private static IHubContext context = GlobalHost.ConnectionManager.GetHubContext<TaskHub>(); public static void InsertTask(TaskViewModel task, string connectionId) { if (!String.IsNullOrEmpty(connectionId)) { context.Clients.Client(connectionId).onInsertTask(task, false); context.Clients.AllExcept(connectionId).onInsertTask(task, true); } else { context.Clients.All.onInsertTask(task, true); } }}",SignalR: How to truly call a hub's method from the server / C#
running samplejavaapp for javaaccessability in C# with 64bit java sdk and 64 bit windows," I have a sample Java app that I got when I downloaded javaaccessablity-2.0.2 that makes use of Java Accessibility (via the Java Access Bridge WindowsAccessBridge-32.dll). Although it calls the getAccessibleContextFromHWND successfully it returns false.Please note that I get the correct value for hWnd which I verified through Inspect tool.I have a 64-bit Java SDK installed in my windows 64-bit system. And the following is the code I tried. I have tried with WindowsAccessBridge-64.dll also but it gives the same behavior which is vmID and _acParent are returned as zero instead of non zero values. I have read a similar post but it didn't solve my issue. <code>  class Program{ [return: MarshalAs(UnmanagedType.Bool)] [DllImport(""WindowsAccessBridge-32.dll"", CallingConvention = CallingConvention.Cdecl)] public extern static bool getAccessibleContextFromHWND(IntPtr hwnd, out Int32 vmID, out Int64 acParent); [DllImport(""WindowsAccessBridge-32.dll"", CallingConvention = CallingConvention.Cdecl, ThrowOnUnmappableChar = true, CharSet = CharSet.Unicode)] private extern static void Windows_run(); [DllImport(""user32.dll"", SetLastError = true)] static extern IntPtr FindWindow(string lpClassName, string lpWindowName); static void Main(string[] args) { Int32 vmID = 0; Int64 _acParent =0; Windows_run(); IntPtr hWnd = (IntPtr)FindWindow(""SunAwtFrame"",""Standalone SwingApp""); bool retVal = getAccessibleContextFromHWND(hWnd, out vmID, out _acParent); }}",Running sample Java app for JavaAccessability in C# with 64-bit Java SDK and 64-bit windows
Testing a Web API method that uses HttpContext.Current.Request.Files," I am attempting to write a test for a Web API method that uses HttpContext.Current.Request.Files and after exhaustive searching and experimentation I cannot figure out how to mock for it. The method being tested looks like this: I realize that there are other questions similar to this, but they do not address this specific situation. If I attempt to mock the context, I run into issues with the Http* object hierarchy. Say I set up various mock objects (using Moq) like this: Attempting to assign it to the current context... ...results in a compiler error/redline because it Cannot convert source type 'System.Web.HttpContextBase' to target type 'System.Web.HttpContext'.I have also tried drilling into various context objects that come with the constructed controller object, but can't find one that a) is the return object of an HttpContext.Current call in the controller method body and b) provides access to standard HttpRequest properties, like Files. It is also important to note that I cannot change the controller that I'm testing at all, so I cannot change the constructor to allow the context to be injected.Is there any way to mock HttpContext.Current.Request.Files for unit testing in Web API?UpdateThough I'm not sure this will be accepted by the team, I am experimenting with changing the Post method to use Request.Content, as suggested by Martin Liversage. It currently looks something like this: My test looks similar to this: Now I'm getting an error on ReadAsMultipartAsync:System.IO.IOException: Error writing MIME multipart body part to output stream. ---> System.InvalidOperationException: The stream provider of type 'MultipartFormDataStreamProvider' threw an exception. ---> System.InvalidOperationException: Did not find required 'Content-Disposition' header field in MIME multipart body part. <code>  [HttpPost]public HttpResponseMessage Post(){ var requestFiles = HttpContext.Current.Request.Files; var file = requestFiles.Get(0); //do some other stuff...} var mockFiles = new Mock<HttpFileCollectionBase>();mockFiles.Setup(s => s.Count).Returns(1);var mockFile = new Mock<HttpPostedFileBase>();mockFile.Setup(s => s.InputStream).Returns(new MemoryStream());mockFiles.Setup(s => s.Get(It.IsAny<int>())).Returns(mockFile.Object);var mockRequest = new Mock<HttpRequestBase>();mockRequest.Setup(s => s.Files).Returns(mockFiles.Object);var mockContext = new Mock<HttpContextBase>();mockContext.Setup(s => s.Request).Returns(mockRequest.Object); HttpContext.Current = mockContext.Object; var requestMsg = controller.Request; //returns HttpRequestMessagevar context = controller.ControllerContext; //returns HttpControllerContextvar requestContext = controller.RequestContext; //read-only returns HttpRequestContext public async Task<HttpResponseMessage> Post(){ var uploadFileStream = new MultipartFormDataStreamProvider(@""C:\temp""); await Request.Content.ReadAsMultipartAsync(uploadFileStream); //do the stuff to get the file return ActionContext.Request.CreateResponse(HttpStatusCode.OK, ""it worked!"");} var byteContent = new byte[]{};var content = new MultipartContent { new ByteArrayContent(byteContent) };content.Headers.Add(""Content-Disposition"", ""form-data"");var controllerContext = new HttpControllerContext { Request = new HttpRequestMessage { Content = new MultipartContent { new ByteArrayContent(byteContent) } }};",Testing a Web API method that uses HttpContext.Current.Request.Files?
Testing a Web API method that uses HttpContext.Current.Request.Files--Code Smell?," I am attempting to write a test for a Web API method that uses HttpContext.Current.Request.Files and after exhaustive searching and experimentation I cannot figure out how to mock for it. The method being tested looks like this: I realize that there are other questions similar to this, but they do not address this specific situation. If I attempt to mock the context, I run into issues with the Http* object hierarchy. Say I set up various mock objects (using Moq) like this: Attempting to assign it to the current context... ...results in a compiler error/redline because it Cannot convert source type 'System.Web.HttpContextBase' to target type 'System.Web.HttpContext'.I have also tried drilling into various context objects that come with the constructed controller object, but can't find one that a) is the return object of an HttpContext.Current call in the controller method body and b) provides access to standard HttpRequest properties, like Files. It is also important to note that I cannot change the controller that I'm testing at all, so I cannot change the constructor to allow the context to be injected.Is there any way to mock HttpContext.Current.Request.Files for unit testing in Web API?UpdateThough I'm not sure this will be accepted by the team, I am experimenting with changing the Post method to use Request.Content, as suggested by Martin Liversage. It currently looks something like this: My test looks similar to this: Now I'm getting an error on ReadAsMultipartAsync:System.IO.IOException: Error writing MIME multipart body part to output stream. ---> System.InvalidOperationException: The stream provider of type 'MultipartFormDataStreamProvider' threw an exception. ---> System.InvalidOperationException: Did not find required 'Content-Disposition' header field in MIME multipart body part. <code>  [HttpPost]public HttpResponseMessage Post(){ var requestFiles = HttpContext.Current.Request.Files; var file = requestFiles.Get(0); //do some other stuff...} var mockFiles = new Mock<HttpFileCollectionBase>();mockFiles.Setup(s => s.Count).Returns(1);var mockFile = new Mock<HttpPostedFileBase>();mockFile.Setup(s => s.InputStream).Returns(new MemoryStream());mockFiles.Setup(s => s.Get(It.IsAny<int>())).Returns(mockFile.Object);var mockRequest = new Mock<HttpRequestBase>();mockRequest.Setup(s => s.Files).Returns(mockFiles.Object);var mockContext = new Mock<HttpContextBase>();mockContext.Setup(s => s.Request).Returns(mockRequest.Object); HttpContext.Current = mockContext.Object; var requestMsg = controller.Request; //returns HttpRequestMessagevar context = controller.ControllerContext; //returns HttpControllerContextvar requestContext = controller.RequestContext; //read-only returns HttpRequestContext public async Task<HttpResponseMessage> Post(){ var uploadFileStream = new MultipartFormDataStreamProvider(@""C:\temp""); await Request.Content.ReadAsMultipartAsync(uploadFileStream); //do the stuff to get the file return ActionContext.Request.CreateResponse(HttpStatusCode.OK, ""it worked!"");} var byteContent = new byte[]{};var content = new MultipartContent { new ByteArrayContent(byteContent) };content.Headers.Add(""Content-Disposition"", ""form-data"");var controllerContext = new HttpControllerContext { Request = new HttpRequestMessage { Content = new MultipartContent { new ByteArrayContent(byteContent) } }};",Testing a Web API method that uses HttpContext.Current.Request.Files?
ASP.NET Correct way to return a 401/unauthorised response," I have an MVC webapi site that uses OAuth/token authentication to authenticate requests. All the relevant controllers have the right attributes, and authentication is working ok. The problem is that not all of the request can be authorised in the scope of an attribute - some authorisation checks have to be performed in code that is called by controller methods - what is the correct way to return a 401 unauthorised response in this case?I have tried throw new HttpException(401, ""Unauthorized access"");, but when I do this the response status code is 500 and I get also get a stack trace. Even in our logging DelegatingHandler we can see that the response is 500, not 401.  <code> ",ASP.NET Web API : Correct way to return a 401/unauthorised response
Asp.net MVC EditorFor error," This line Line 32: @Html.EditorFor(model => model.Employees) gives the following Error I have used this similiar approach in another project which did not give this error. <code>  @using (Html.BeginForm(""Index"", ""Employees"", FormMethod.Post, new { encType = ""multipart/form-data"", name = ""EmployeeForm"" })){<table class=""table table-bordered table-condensed table-striped""> <tr> <th> Name </th> <th> Surname </th> <th> ID Number </th> <th> Email </th> <th> Birthdate </th> <th> Action </th> </tr> @Html.EditorFor(model => model.Employees)</table>} CS0012: The type 'System.Object' is defined in an assembly that is not referenced. You must add a reference to assembly 'System.Runtime, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'.","Asp.net MVC EditorFor ""The type 'System.Object' is defined in an assembly that is not referenced"" error"
Using QueryAsync to return a single object," Unfortunately, our DB is dated back to the 90s. Its legacy is so strong that we are still using SP in order to do most of the CRUD operations. However, it seems that Dapper suits pretty well and we have just started to play with it.However, I'm a bit concerned about how to handle a single data row. In this case, I'm using QueryAsync to call the SP passing an ID. As you can see, the object is returning outside of the async call(*).Am I going to be in trouble? If so, does anyone know how to handle it? Do I need to use a QuerySync instead? (*)The SchemePolicy object returned by FirstOfDefault() is not an async method. <code>  public class SchemePolicyRepository : ISchemePolicyRepository{ private readonly SqlConnection sql; protected SchemePolicyRepository(SqlConnection connection) { sql = connection; } ... public async Task<SchemePolicy> GetById(string id) { var schemePolicy = await sql.QueryAsync<SchemePolicy>(""risk.iE_GetSchemePolicyById"", new { Id = id }, commandType: CommandType.StoredProcedure); return schemePolicy != null ? schemePolicy.FirstOrDefault() : null; } ...}",Using Dapper QueryAsync to return a single object
bool type return rule in dapper," I use dapper ORM.So i use two rules Query<T> & QuerySingle<T>. Query return the list & QuerySingle return the single object.So,I want to get a bool type. (Actually I wanted to get a bool is true or false record).My Query<T>: So how can I write bool type return? <code>  public IEnumerable<T> Query<T>(string SqlString) where T : class{ return this.conn.Query<T>(SqlString);}",Bool type return rule
Entity framework throws exception while exceuting UPDATE statement," I have an EF6 powered program that crashes on an UPDATE statement, when running for the first time.I tried renaming the columns via data annotations (I didn't test fluid API, since it should result in the same database). I also looked at the class visibilities, but they didn't change since the last time the program worked and thus can be ruled out.I've looked at it for the better part of a day, but cannot find the error. The database looks sound to me and the code compiles without problem. Also any update-database statements are executed without an exception.Here is the stack-trace: Here is the method that throws the exception. The exception is thrown on at the include statement. I might add, that the class for the following two methods is internal sealed These are the classes that represent my data: And here are the SQL statements for the DB schema. As per suggestion of John Castleman I changed the Schema initialisation, which was previously done by FluidAPI to DataAnnotations. Then I added another migration and applied another update-database now I get an error when I run the command, not just when starting the program.Below is the error and my migrations:This is the stack trace with the -verbose switch enabled. I had to delete the old one, since I reached the character limit. Migrations: The funny thing is: Even though the second migration is empty the update-database command fails. The first migration runs just fine, but then I get an error when starting the program.As additional information here is the constructor of my repository and the configuration file for it. <code>  System.Data.DataException was unhandled by user code HResult=-2146233087 Message=An exception occurred while initializing the database. See the InnerException for details. Source=EntityFramework StackTrace: bei System.Data.Entity.Internal.InternalContext.PerformInitializationAction(Action action) bei System.Data.Entity.Internal.InternalContext.PerformDatabaseInitialization() bei System.Data.Entity.Internal.LazyInternalContext.<InitializeDatabase>b__4(InternalContext c) bei System.Data.Entity.Internal.RetryAction`1.PerformAction(TInput input) bei System.Data.Entity.Internal.LazyInternalContext.InitializeDatabaseAction(Action`1 action) bei System.Data.Entity.Internal.LazyInternalContext.InitializeDatabase() bei System.Data.Entity.Internal.InternalContext.Initialize() bei System.Data.Entity.Internal.InternalContext.GetEntitySetAndBaseTypeForType(Type entityType) bei System.Data.Entity.Internal.Linq.InternalSet`1.Initialize() bei System.Data.Entity.Internal.Linq.InternalSet`1.Include(String path) bei System.Data.Entity.Infrastructure.DbQuery`1.Include(String path) bei System.Data.Entity.QueryableExtensions.Include[T](IQueryable`1 source, String path) bei System.Data.Entity.QueryableExtensions.Include[T,TProperty](IQueryable`1 source, Expression`1 path) bei RpgTools.Characters.CharacterRepository.FindAll() in e:\Users\Robert\Documents\Visual Studio 2013\Projects\RpgTools\Modules\Characters\CharacterRepository.cs:Zeile 88. bei RpgTools.CharacterPresenter.ViewModels.CharactersViewModel.LoadCharacters() in e:\Users\Robert\Documents\Visual Studio 2013\Projects\RpgTools\Modules\CharacterPresenter\ViewModels\CharactersViewModel.cs:Zeile 169. InnerException: System.Data.Entity.Infrastructure.DbUpdateException HResult=-2146233087 Message=An error occurred while updating the entries. See the inner exception for details. Source=EntityFramework StackTrace: bei System.Data.Entity.Internal.InternalContext.SaveChanges() bei System.Data.Entity.Internal.LazyInternalContext.SaveChanges() bei System.Data.Entity.DbContext.SaveChanges() bei System.Data.Entity.Migrations.DbMigrator.SeedDatabase() bei System.Data.Entity.Migrations.Infrastructure.MigratorBase.SeedDatabase() bei System.Data.Entity.Migrations.DbMigrator.Upgrade(IEnumerable`1 pendingMigrations, String targetMigrationId, String lastMigrationId) bei System.Data.Entity.Migrations.Infrastructure.MigratorBase.Upgrade(IEnumerable`1 pendingMigrations, String targetMigrationId, String lastMigrationId) bei System.Data.Entity.Migrations.DbMigrator.UpdateInternal(String targetMigration) bei System.Data.Entity.Migrations.DbMigrator.<>c__DisplayClassc.<Update>b__b() bei System.Data.Entity.Migrations.DbMigrator.EnsureDatabaseExists(Action mustSucceedToKeepDatabase) bei System.Data.Entity.Migrations.Infrastructure.MigratorBase.EnsureDatabaseExists(Action mustSucceedToKeepDatabase) bei System.Data.Entity.Migrations.DbMigrator.Update(String targetMigration) bei System.Data.Entity.Migrations.Infrastructure.MigratorBase.Update() bei System.Data.Entity.MigrateDatabaseToLatestVersion`2.InitializeDatabase(TContext context) bei System.Data.Entity.Internal.InternalContext.<>c__DisplayClassf`1.<CreateInitializationAction>b__e() bei System.Data.Entity.Internal.InternalContext.PerformInitializationAction(Action action) InnerException: System.Data.Entity.Core.UpdateException HResult=-2146233087 Message=An error occurred while updating the entries. See the inner exception for details. Source=EntityFramework StackTrace: bei System.Data.Entity.Core.Mapping.Update.Internal.UpdateTranslator.Update() bei System.Data.Entity.Core.EntityClient.Internal.EntityAdapter.<Update>b__2(UpdateTranslator ut) bei System.Data.Entity.Core.EntityClient.Internal.EntityAdapter.Update[T](T noChangesResult, Func`2 updateFunction) bei System.Data.Entity.Core.EntityClient.Internal.EntityAdapter.Update() bei System.Data.Entity.Core.Objects.ObjectContext.<SaveChangesToStore>b__35() bei System.Data.Entity.Core.Objects.ObjectContext.ExecuteInTransaction[T](Func`1 func, IDbExecutionStrategy executionStrategy, Boolean startLocalTransaction, Boolean releaseConnectionOnSuccess) bei System.Data.Entity.Core.Objects.ObjectContext.SaveChangesToStore(SaveOptions options, IDbExecutionStrategy executionStrategy, Boolean startLocalTransaction) bei System.Data.Entity.Core.Objects.ObjectContext.<>c__DisplayClass2a.<SaveChangesInternal>b__27() bei System.Data.Entity.SqlServer.DefaultSqlExecutionStrategy.Execute[TResult](Func`1 operation) bei System.Data.Entity.Core.Objects.ObjectContext.SaveChangesInternal(SaveOptions options, Boolean executeInExistingTransaction) bei System.Data.Entity.Core.Objects.ObjectContext.SaveChanges(SaveOptions options) bei System.Data.Entity.Internal.InternalContext.SaveChanges() InnerException: System.Data.SqlClient.SqlException HResult=-2146232060 Message=The UPDATE statement conflicted with the FOREIGN KEY constraint ""FK_Characters.Characters_Characters.Appearances_AppearanceId"". The conflict occurred in database ""RpgTools"", table ""Characters.Appearances"", column 'Id'.The statement has been terminated. Source=.Net SqlClient Data Provider ErrorCode=-2146232060 Class=16 LineNumber=1 Number=547 Procedure="""" Server=(LocalDb)\mssqllocaldb State=0 StackTrace: bei System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction) bei System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction) bei System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose) bei System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady) bei System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString) bei System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds) bei System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite) bei System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite) bei System.Data.SqlClient.SqlCommand.ExecuteNonQuery() bei System.Data.Entity.Infrastructure.Interception.DbCommandDispatcher.<NonQuery>b__0(DbCommand t, DbCommandInterceptionContext`1 c) bei System.Data.Entity.Infrastructure.Interception.InternalDispatcher`1.Dispatch[TTarget,TInterceptionContext,TResult](TTarget target, Func`3 operation, TInterceptionContext interceptionContext, Action`3 executing, Action`3 executed) bei System.Data.Entity.Infrastructure.Interception.DbCommandDispatcher.NonQuery(DbCommand command, DbCommandInterceptionContext interceptionContext) bei System.Data.Entity.Internal.InterceptableDbCommand.ExecuteNonQuery() bei System.Data.Entity.Core.Mapping.Update.Internal.DynamicUpdateCommand.Execute(Dictionary`2 identifierValues, List`1 generatedValues) bei System.Data.Entity.Core.Mapping.Update.Internal.UpdateTranslator.Update() InnerException: /// <inheritdoc />public IDictionaryRange<Guid, Character> FindAll(){ IDataContainer<ICollection<CharacterItem>> data = this.CreateContainer<ICollection<CharacterItem>>( this.Characters.Include(c => c.Appearance).Include(c => c.Metadata).ToList(), this.Culture); return this.bulkReadConverter.Convert(data);}private IDataContainer<TData> CreateContainer<TData>(TData data, CultureInfo culture = null, DateTimeOffset? date = null){ return new DataContainer<TData> { Content = data, Culture = culture, Date = date };} [Table(""Character"")]internal class CharacterItem{ [Key] public Guid Id { get; set; } public string Name { get; set; } public string Nickname { get; set; } public string Title { get; set; } public string Description { get; set; } public string Biography { get; set; } public string Motto { get; set; } public int Age { get; set; } public Guid PortraitsId { get; set; } public PortraitItem Portrait { get; set; } public Guid MetadataId { get; set; } public CharacterMetadataItem Metadata { get; set; } public Guid AppearancesId { get; set; } public AppearanceItem Appearance { get; set; } public Guid OriginId { get; set; }}[Table(""Appearances"")]internal sealed class AppearanceItem{ [Key] public Guid Id { get; set; } public Genders Gender { get; set; } public int Height { get; set; } public int Weight { get; set; } public string SkinColour { get; set; } public string EyeColour { get; set; } public string SpecialFeatures { get; set; } public string HairColour { get; set; } public string LipColour { get; set; }} CREATE TABLE [Characters].[Character] ( [Id] UNIQUEIDENTIFIER NOT NULL, [Name] NVARCHAR (MAX) NULL, [Nickname] NVARCHAR (MAX) NULL, [Title] NVARCHAR (MAX) NULL, [Description] NVARCHAR (MAX) NULL, [Biography] NVARCHAR (MAX) NULL, [Motto] NVARCHAR (MAX) NULL, [Age] INT NOT NULL, [PortraitsId] UNIQUEIDENTIFIER NOT NULL, [MetadataId] UNIQUEIDENTIFIER NOT NULL, [AppearancesId] UNIQUEIDENTIFIER NOT NULL, [OriginId] UNIQUEIDENTIFIER NOT NULL, [Appearance_Id] UNIQUEIDENTIFIER NULL, [Portrait_Id] UNIQUEIDENTIFIER NULL, CONSTRAINT [PK_Characters.Character] PRIMARY KEY CLUSTERED ([Id] ASC), CONSTRAINT [FK_Characters.Character_Characters.Appearances_Appearance_Id] FOREIGN KEY ([Appearance_Id]) REFERENCES [Characters].[Appearances] ([Id]), CONSTRAINT [FK_Characters.Character_Characters.Metadata_MetadataId] FOREIGN KEY ([MetadataId]) REFERENCES [Characters].[Metadata] ([Id]) ON DELETE CASCADE, CONSTRAINT [FK_Characters.Character_Characters.Portraits_Portrait_Id] FOREIGN KEY ([Portrait_Id]) REFERENCES [Characters].[Portraits] ([Id]));GOCREATE NONCLUSTERED INDEX [IX_MetadataId] ON [Characters].[Character]([MetadataId] ASC);GOCREATE NONCLUSTERED INDEX [IX_Appearance_Id] ON [Characters].[Character]([Appearance_Id] ASC); GO CREATE NONCLUSTERED INDEX [IX_Portrait_Id] ON [Characters].[Character]([Portrait_Id] ASC);CREATE TABLE [Characters].[Appearances] ( [Id] UNIQUEIDENTIFIER NOT NULL, [Gender] INT NOT NULL, [Height] INT NOT NULL, [Weight] INT NOT NULL, [SkinColour] NVARCHAR (MAX) NULL, [EyeColour] NVARCHAR (MAX) NULL, [SpecialFeatures] NVARCHAR (MAX) NULL, [HairColour] NVARCHAR (MAX) NULL, [LipColour] NVARCHAR (MAX) NULL, CONSTRAINT [PK_Characters.Appearances] PRIMARY KEY CLUSTERED ([Id] ASC)); Using StartUp project 'Main'.Using NuGet project 'Characters'.Specify the '-Verbose' flag to view the SQL statements being applied to the target database.Target database is: 'RpgTools' (DataSource: (LocalDb)\mssqllocaldb, Provider: System.Data.SqlClient, Origin: Configuration).No pending explicit migrations.Running Seed method.System.Data.Entity.Infrastructure.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.Entity.Core.UpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: The UPDATE statement conflicted with the FOREIGN KEY constraint ""FK_Characters.Character_Characters.Metadata_MetadataId"". The conflict occurred in database ""RpgTools"", table ""Characters.Metadata"", column 'Id'.The statement has been terminated. at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction) at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction) at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose) at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady) at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString) at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds) at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite) at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite) at System.Data.SqlClient.SqlCommand.ExecuteNonQuery() at System.Data.Entity.Infrastructure.Interception.DbCommandDispatcher.<NonQuery>b__0(DbCommand t, DbCommandInterceptionContext`1 c) at System.Data.Entity.Infrastructure.Interception.InternalDispatcher`1.Dispatch[TTarget,TInterceptionContext,TResult](TTarget target, Func`3 operation, TInterceptionContext interceptionContext, Action`3 executing, Action`3 executed) at System.Data.Entity.Infrastructure.Interception.DbCommandDispatcher.NonQuery(DbCommand command, DbCommandInterceptionContext interceptionContext) at System.Data.Entity.Internal.InterceptableDbCommand.ExecuteNonQuery() at System.Data.Entity.Core.Mapping.Update.Internal.DynamicUpdateCommand.Execute(Dictionary`2 identifierValues, List`1 generatedValues) at System.Data.Entity.Core.Mapping.Update.Internal.UpdateTranslator.Update() --- End of inner exception stack trace --- at System.Data.Entity.Core.Mapping.Update.Internal.UpdateTranslator.Update() at System.Data.Entity.Core.EntityClient.Internal.EntityAdapter.<Update>b__2(UpdateTranslator ut) at System.Data.Entity.Core.EntityClient.Internal.EntityAdapter.Update[T](T noChangesResult, Func`2 updateFunction) at System.Data.Entity.Core.EntityClient.Internal.EntityAdapter.Update() at System.Data.Entity.Core.Objects.ObjectContext.<SaveChangesToStore>b__35() at System.Data.Entity.Core.Objects.ObjectContext.ExecuteInTransaction[T](Func`1 func, IDbExecutionStrategy executionStrategy, Boolean startLocalTransaction, Boolean releaseConnectionOnSuccess) at System.Data.Entity.Core.Objects.ObjectContext.SaveChangesToStore(SaveOptions options, IDbExecutionStrategy executionStrategy, Boolean startLocalTransaction) at System.Data.Entity.Core.Objects.ObjectContext.<>c__DisplayClass2a.<SaveChangesInternal>b__27() at System.Data.Entity.SqlServer.DefaultSqlExecutionStrategy.Execute[TResult](Func`1 operation) at System.Data.Entity.Core.Objects.ObjectContext.SaveChangesInternal(SaveOptions options, Boolean executeInExistingTransaction) at System.Data.Entity.Core.Objects.ObjectContext.SaveChanges(SaveOptions options) at System.Data.Entity.Internal.InternalContext.SaveChanges() --- End of inner exception stack trace --- at System.Data.Entity.Internal.InternalContext.SaveChanges() at System.Data.Entity.Internal.LazyInternalContext.SaveChanges() at System.Data.Entity.DbContext.SaveChanges() at System.Data.Entity.Migrations.DbMigrator.SeedDatabase() at System.Data.Entity.Migrations.Infrastructure.MigratorLoggingDecorator.SeedDatabase() at System.Data.Entity.Migrations.DbMigrator.Upgrade(IEnumerable`1 pendingMigrations, String targetMigrationId, String lastMigrationId) at System.Data.Entity.Migrations.Infrastructure.MigratorLoggingDecorator.Upgrade(IEnumerable`1 pendingMigrations, String targetMigrationId, String lastMigrationId) at System.Data.Entity.Migrations.DbMigrator.UpdateInternal(String targetMigration) at System.Data.Entity.Migrations.DbMigrator.<>c__DisplayClassc.<Update>b__b() at System.Data.Entity.Migrations.DbMigrator.EnsureDatabaseExists(Action mustSucceedToKeepDatabase) at System.Data.Entity.Migrations.Infrastructure.MigratorBase.EnsureDatabaseExists(Action mustSucceedToKeepDatabase) at System.Data.Entity.Migrations.DbMigrator.Update(String targetMigration) at System.Data.Entity.Migrations.Infrastructure.MigratorBase.Update(String targetMigration) at System.Data.Entity.Migrations.Design.ToolingFacade.UpdateRunner.Run() at System.AppDomain.DoCallBack(CrossAppDomainDelegate callBackDelegate) at System.AppDomain.DoCallBack(CrossAppDomainDelegate callBackDelegate) at System.Data.Entity.Migrations.Design.ToolingFacade.Run(BaseRunner runner) at System.Data.Entity.Migrations.Design.ToolingFacade.Update(String targetMigration, Boolean force) at System.Data.Entity.Migrations.UpdateDatabaseCommand.<>c__DisplayClass2.<.ctor>b__0() at System.Data.Entity.Migrations.MigrationsDomainCommand.Execute(Action command)An error occurred while updating the entries. See the inner exception for details. public partial class v0_1_0 : DbMigration{ public override void Up() { CreateTable( ""Characters.Character"", c => new { Id = c.Guid(nullable: false), Name = c.String(), Nickname = c.String(), Title = c.String(), Description = c.String(), Biography = c.String(), Motto = c.String(), Age = c.Int(nullable: false), PortraitsId = c.Guid(nullable: false), MetadataId = c.Guid(nullable: false), AppearancesId = c.Guid(nullable: false), OriginId = c.Guid(nullable: false), Appearance_Id = c.Guid(), Portrait_Id = c.Guid(), }) .PrimaryKey(t => t.Id) .ForeignKey(""Characters.Appearances"", t => t.Appearance_Id) .ForeignKey(""Characters.Metadata"", t => t.MetadataId, cascadeDelete: true) .ForeignKey(""Characters.Portraits"", t => t.Portrait_Id) .Index(t => t.MetadataId) .Index(t => t.Appearance_Id) .Index(t => t.Portrait_Id); CreateTable( ""Characters.Appearances"", c => new { Id = c.Guid(nullable: false), Gender = c.Int(nullable: false), Height = c.Int(nullable: false), Weight = c.Int(nullable: false), SkinColour = c.String(), EyeColour = c.String(), SpecialFeatures = c.String(), HairColour = c.String(), LipColour = c.String(), }) .PrimaryKey(t => t.Id); CreateTable( ""Characters.Metadata"", c => new { Id = c.Guid(nullable: false), Tags = c.String(), VoiceActor = c.String(), Occurrences = c.String(), }) .PrimaryKey(t => t.Id); CreateTable( ""Characters.Portraits"", c => new { Id = c.Guid(nullable: false), Data = c.Binary(), }) .PrimaryKey(t => t.Id); } public override void Down() { DropForeignKey(""Characters.Character"", ""Portrait_Id"", ""Characters.Portraits""); DropForeignKey(""Characters.Character"", ""MetadataId"", ""Characters.Metadata""); DropForeignKey(""Characters.Character"", ""Appearance_Id"", ""Characters.Appearances""); DropIndex(""Characters.Character"", new[] { ""Portrait_Id"" }); DropIndex(""Characters.Character"", new[] { ""Appearance_Id"" }); DropIndex(""Characters.Character"", new[] { ""MetadataId"" }); DropTable(""Characters.Portraits""); DropTable(""Characters.Metadata""); DropTable(""Characters.Appearances""); DropTable(""Characters.Character""); }}public partial class v0_1_1 : DbMigration{ public override void Up() { } public override void Down() { }} internal CharacterRepository(IConverter<CharacterItem, Character> characterReadConverter, IConverter<Character, CharacterItem> characterWriteConverter) : base(""name=RpgTools""){ Database.SetInitializer(new MigrateDatabaseToLatestVersion<CharacterRepository, Configuration>(true)); this.Characters = this.Set<CharacterItem>(); this.readConverter = new DataConverter<CharacterItem, Character>(characterReadConverter); this.bulkReadConverter = new DictionaryRangeConverter<CharacterItem, Guid, Character>(characterReadConverter, c => c.Id); this.writeConverter = new DataConverter<Character, CharacterItem>(characterWriteConverter);}internal sealed class Configuration : DbMigrationsConfiguration<CharacterRepository>{ public Configuration() { this.AutomaticMigrationsEnabled = false; } protected override void Seed(CharacterRepository context) { Guid[] ids = { new Guid(""13cbbdc8-d2e6-4a9a-9525-fa9043a53082""), new Guid(""3a34fd9b-a6e3-4567-af83-840ddf4417ba""), new Guid(""b1256f9f-8a35-416a-8f22-6be91ffb4041""), new Guid(""2e24283d-1ba0-4cc7-b49c-975937e8512c""), new Guid(""2f66d513-1839-4a26-be7e-39243d6807cf"") }; CharacterItem char1 = new CharacterItem { Age = 22, Appearance = new AppearanceItem { EyeColour = ""Green"", Gender = Genders.Female, HairColour = ""Red"", Height = 188, Id = ids[1], LipColour = ""red"", SkinColour = ""fair"", Weight = 76 }, Id = ids[0], Metadata = new CharacterMetadataItem { Id = ids[2], Occurrences = string.Empty, Tags = ""Female; Protagonist"" }, Motto = null, Name = ""Sarah Fenix"", Nickname = string.Empty, Portrait = null, Description = ""Ravia Hagen's spouse"", Title = string.Empty }; var char2 = new CharacterItem { Age = 22, Appearance = new AppearanceItem { EyeColour = ""Green"", Gender = Genders.Female, HairColour = ""Red"", Height = 188, Id = ids[4], LipColour = ""red"", SkinColour = ""fair"", Weight = 76 }, Id = ids[3], Metadata = new CharacterMetadataItem { Id = ids[5], Occurrences = string.Empty, Tags = ""Female; Protagonist"", VoiceActor = string.Empty }, Motto = null, Name = ""Ravia Hagen"", Nickname = string.Empty, Portrait = null, Description = ""Sarah Fenix's spouse"", Title = string.Empty }; context.Characters.AddOrUpdate(c => c.Id, char1, char2); }}",Entity framework throws exception while executing UPDATE statement
Is using ref keyword for string parameters in methods good for performance in C#?," As a programmer who don't have a good idea about the .NET pipeline, I was wondering if using ref strings as parameters are good for performance in C#?Let's say I have a method like this: When I use this method, the compiler creates a copy of the text for the method, right?But if I use the ref keyword: .. the compiler should only send the text's pointer address...So is it good for performance using ref like this? <code>  public int FindSomething(string text){ //Finds a char in the text and returns its index} public int FindSomething(ref string text){ //Finds a char in the text and returns its index}",Is using the 'ref' keyword for string parameters in methods good for performance in C#?
C# WebClient().DownloadString() returning old data," I am using this code to get the return string from URL the code.php looks like this The problem is when I change the contents of the code.txt file, the webClient.DownloadString() method returns the old contents of the code.txt file. When I open the URL http://somesite.com/code.php in a browser it works perfectly fine.Any solutions will be appreciated! My question seems to be duplicated but I don't really understand what is said here: C# WebClient disable cacheIf anyone could explain and provide some example code it would be great! <code>  webClient.Encoding = Encoding.UTF8;response = webClient.DownloadString(""http://somesite.com/code.php"");Console.Write(response); <?php$data = file_get_contents('code.txt');echo $data;?>",WebClient().DownloadString() returning old data
C# Entity Framework 6 create() vs new," What is the difference between adding an entity in these two ways? vs Do I still need to add ""me"" in the second example? If so, is there some sort of advantage, one way or the other?Many thanks! <code>  MyEntity me = new MyEntity();entities.myentities.Add(me); MyEntity me = entities.myentities.Create();",Entity Framework 6 Create() vs new
MVC 5 - How do I show Exception message in shared view Error.cshtml?," If I start with a new MVC 5 project, in web.config setting customErrors mode=""on"" allows the shared view 'Error.cshtml' to show when I force (raise) an exception, but it only shows the following text... Error. An error occurred while processing your request.How do I pass information to this view to display more relevant info, such as what error occurred? Can I use this view if I use the Global.asax method... ? <code>  protected void Application_Error()",How do I show Exception message in shared view Error.cshtml?
Skip causing exceptions," I'm using Simple.Data ORM. I'm trying to make a query from two joined tables. This query works fine: But when this line is added: I'm getting this exception: The multi-part identifier \""dbo.CandidateProfiles.CandidateId\"" could not be bound.I was trying explicitly pass 0, 1 and few other numbers to Skip but I always get the same exception.My test query should return 4 elements and I'm skipping 0 elements (it can be more in normal use).Additional info: CandidateProfiles has foreign key from Candidates and it's CandidateId can be null. Edit: We've done a workaround for this problem, but I'm really curious why this one won't work. Simple.Data looked fun at first, but now I'm not sure if I will use it in future <code>  dynamic alias;var candidatesRec = db.dbo.Candidates .FindAll(db.dbo.Candidates.CommonOfferId == commonOfferId && db.dbo.CandidateProfiles.CandidateId == null) .LeftJoin(db.dbo.CandidateProfiles, out alias) .On(db.dbo.Candidates.Id == alias.CandidateId) .Select( db.dbo.Candidates.Id, db.dbo.Candidates.Email ) .OrderByDescending(db.dbo.Candidates.ApplicationDate) .Skip((pageNumber - 1) * pageSize)",Simple.Data ORM. The multi-part identifier could not be bound
Why is !0 as a type in Microsoft intermediate language," In many MSIL listings, I have observed the following: or What's the meaning of !0 in these circumstances? <code>  System.Nullable`1<!0> etc ... class !0 etc ...",Why is !0 a type in Microsoft Intermediate Language (MSIL)?
Why is !0 as a type in Microsoft Intermediate Language?," In many MSIL listings, I have observed the following: or What's the meaning of !0 in these circumstances? <code>  System.Nullable`1<!0> etc ... class !0 etc ...",Why is !0 a type in Microsoft Intermediate Language (MSIL)?
Do I instantiated an object of void?," As you all know, in C# we could not do something like this: or or But this code compiles successfully and in debug mode I can see that type of the voidObject is System.Void: What is this? Is this real instance of void? <code>  var voidObject = new void(); var voidObject = new System.Void(); var voidObject = Activator.CreateInstance(typeof(void)); var voidObject = FormatterServices.GetUninitializedObject(typeof(void));",Did I instantiate an object of void?
Did I instantiated an object of void?," As you all know, in C# we could not do something like this: or or But this code compiles successfully and in debug mode I can see that type of the voidObject is System.Void: What is this? Is this real instance of void? <code>  var voidObject = new void(); var voidObject = new System.Void(); var voidObject = Activator.CreateInstance(typeof(void)); var voidObject = FormatterServices.GetUninitializedObject(typeof(void));",Did I instantiate an object of void?
Using UserManager.FindAsync with a custom UserStore," I have implemented a custom UserStore, it implements IUserStore<DatabaseLogin, int> and IUserPasswordStore<DatabaseLogin, int>.My Login action method is as below: In the custom authentication class that I wrote, Authentication, I have a Login method that works fine, also FindByName method returns an app user. But if I try to SignIn with that login, the user isn't recognized as authenticated and HttpContext.User.Identity is always null, so I imagine that I have to try UserManager.FindAsync. This method calls FindByNameAsync and GetPasswordHashAsync, and it always return null. And the Authentication.FindByName As you can see I'm using database users, I'm not sure how I can retrieve a hashed password for them. For now, I'm just storing the Base65 of the correct password!I have no idea where I'm going wrong, any guidance is welcome. <code>  if (ModelState.IsValid){ if (Authentication.Login(user.Username, user.Password)) { DatabaseLogin x = await UserManager.FindAsync(user.Username, user.Password); DatabaseLogin Login = Authentication.FindByName(user.Username); if (Login != null) { ClaimsIdentity ident = await UserManager.CreateIdentityAsync(Login, DefaultAuthenticationTypes.ApplicationCookie); AuthManager.SignOut(); AuthManager.SignIn(new AuthenticationProperties { IsPersistent = false }, ident); return RedirectToAction(""Index"", ""Home""); } } else { ModelState.AddModelError("""", ""Invalid Login""); }}return View(); public Task<DatabaseLogin> FindByNameAsync(string userName){ if (string.IsNullOrEmpty(userName)) throw new ArgumentNullException(""userName""); return Task.FromResult<DatabaseLogin>(Authentication.FindByName(userName));}public Task<string> GetPasswordHashAsync(DatabaseLogin user){ if (user == null) throw new ArgumentNullException(""user""); return Task.FromResult<string>(user.Password);} public static DatabaseLogin FindByName(string name){ string GetUserQuery = string.Format( ""USE db;SELECT principal_id AS id, name as userName, create_date AS CreateDate, modify_date AS modifyDate FROM sys.database_principals WHERE type='S' AND authentication_type = 1 AND name = '{0}'"" , name); DatabaseLogin user; using (var db = new EFDbContext()) { user = db.Database.SqlQuery<DatabaseLogin>(GetUserQuery).FirstOrDefault(); } user.Password = Convert.ToBase64String(Encoding.ASCII.GetBytes(""pass"")); return user;}",Using UserManager.FindAsync with a custom UserStore
C# - Dynamically create lambda search on IQueryable on nested objects," I'm trying to build a dynamic search on nested objects, which will later be sent to EF and SQL Server. So far, I'm able to search on all properties of the first object. Here's a very simplified version: When propName = ""Name"" everything is fine, but when propName = ""Address.City"", the propertyInfo is null, and I get this error on the member assignment line: System.ArgumentNullException: Value cannot be nullI was able to obtain the propertyInfo of the nested property using the solution from this answer: But then I get this error on member assignment: System.ArgumentException: Property 'System.String City' is not defined for type 'User'This should point to Address instead of User, but I don't know if I'm on right track here, I mean, should I change parameterExpression now?How can I make a dynamic search on nested objects, so that this can be turned into a lambda expression and later sent to SQL? <code>  public class User{ public string Name { get; set; } public Address Address { get; set; }}public class Address{ public string City { get; set; }}public class MyClass<TEntity> where TEntity : class { public IQueryable<TEntity> applySearch(IQueryable<TEntity> originalList, string propName, string valueToSearch) { ParameterExpression parameterExpression = Expression.Parameter(typeof(TEntity), ""p""); PropertyInfo propertyInfo = typeof(TEntity).GetProperty(propName); MemberExpression member = Expression.MakeMemberAccess(parameterExpression, propertyInfo); lambda = Expression.Lambda<Func<TEntity, bool>>(Expression.Equal(member, Expression.Constant(valueToSearch)), parameterExpression); return originalList.Where(expression); }} PropertyInfo propertyInfo = GetPropertyRecursive(typeof(TEntity), propName);...private PropertyInfo GetPropertyRecursive(Type baseType, string propertyName){ string[] parts = propertyName.Split('.'); return (parts.Length > 1) ? GetPropertyRecursive(baseType.GetProperty(parts[0]).PropertyType, parts.Skip(1).Aggregate((a, i) => a + ""."" + i)) : baseType.GetProperty(propertyName);}",Dynamically create lambda search on IQueryable on nested objects
C# - Dynamically create lambda search on IQueryable on nested objectsa," I'm trying to build a dynamic search on nested objects, which will later be sent to EF and SQL Server. So far, I'm able to search on all properties of the first object. Here's a very simplified version: When propName = ""Name"" everything is fine, but when propName = ""Address.City"", the propertyInfo is null, and I get this error on the member assignment line: System.ArgumentNullException: Value cannot be nullI was able to obtain the propertyInfo of the nested property using the solution from this answer: But then I get this error on member assignment: System.ArgumentException: Property 'System.String City' is not defined for type 'User'This should point to Address instead of User, but I don't know if I'm on right track here, I mean, should I change parameterExpression now?How can I make a dynamic search on nested objects, so that this can be turned into a lambda expression and later sent to SQL? <code>  public class User{ public string Name { get; set; } public Address Address { get; set; }}public class Address{ public string City { get; set; }}public class MyClass<TEntity> where TEntity : class { public IQueryable<TEntity> applySearch(IQueryable<TEntity> originalList, string propName, string valueToSearch) { ParameterExpression parameterExpression = Expression.Parameter(typeof(TEntity), ""p""); PropertyInfo propertyInfo = typeof(TEntity).GetProperty(propName); MemberExpression member = Expression.MakeMemberAccess(parameterExpression, propertyInfo); lambda = Expression.Lambda<Func<TEntity, bool>>(Expression.Equal(member, Expression.Constant(valueToSearch)), parameterExpression); return originalList.Where(expression); }} PropertyInfo propertyInfo = GetPropertyRecursive(typeof(TEntity), propName);...private PropertyInfo GetPropertyRecursive(Type baseType, string propertyName){ string[] parts = propertyName.Split('.'); return (parts.Length > 1) ? GetPropertyRecursive(baseType.GetProperty(parts[0]).PropertyType, parts.Skip(1).Aggregate((a, i) => a + ""."" + i)) : baseType.GetProperty(propertyName);}",Dynamically create lambda search on IQueryable on nested objects
Dynamically create lambda search on IQueryable on nested objects," I'm trying to build a dynamic search on nested objects, which will later be sent to EF and SQL Server. So far, I'm able to search on all properties of the first object. Here's a very simplified version: When propName = ""Name"" everything is fine, but when propName = ""Address.City"", the propertyInfo is null, and I get this error on the member assignment line: System.ArgumentNullException: Value cannot be nullI was able to obtain the propertyInfo of the nested property using the solution from this answer: But then I get this error on member assignment: System.ArgumentException: Property 'System.String City' is not defined for type 'User'This should point to Address instead of User, but I don't know if I'm on right track here, I mean, should I change parameterExpression now?How can I make a dynamic search on nested objects, so that this can be turned into a lambda expression and later sent to SQL? <code>  public class User{ public string Name { get; set; } public Address Address { get; set; }}public class Address{ public string City { get; set; }}public class MyClass<TEntity> where TEntity : class { public IQueryable<TEntity> applySearch(IQueryable<TEntity> originalList, string propName, string valueToSearch) { ParameterExpression parameterExpression = Expression.Parameter(typeof(TEntity), ""p""); PropertyInfo propertyInfo = typeof(TEntity).GetProperty(propName); MemberExpression member = Expression.MakeMemberAccess(parameterExpression, propertyInfo); lambda = Expression.Lambda<Func<TEntity, bool>>(Expression.Equal(member, Expression.Constant(valueToSearch)), parameterExpression); return originalList.Where(expression); }} PropertyInfo propertyInfo = GetPropertyRecursive(typeof(TEntity), propName);...private PropertyInfo GetPropertyRecursive(Type baseType, string propertyName){ string[] parts = propertyName.Split('.'); return (parts.Length > 1) ? GetPropertyRecursive(baseType.GetProperty(parts[0]).PropertyType, parts.Skip(1).Aggregate((a, i) => a + ""."" + i)) : baseType.GetProperty(propertyName);}",Dynamically create lambda search on IQueryable on nested objects
How do I Moq IFindFilter so this call to ToListAsync works?," I am unit testing a wrapper to the MongoDB C# driver. I have this line of code: Where Collection is of type IMongoCollection<T> and Find(predicate) returns an instance implementing IFindFluent<T, T>. ToListAsync() is an extension to turn the results into a list, I assume.I am attempting to write unit tests, and I am stumped on handling this. I can't make a wrapper class because that's what I'm working on. I would prefer to either make it so ToListAsync() returns a created list OR to mock the Find() to return something that can be made a list of. <code>  Collection.Find(predicate).ToListAsync();",How do I Moq IFindFluent so this call to ToListAsync works?
Find element by Xpath which contains text," This works fine if I search for a single string: But could I have an or statement like in the example below? <code>  var element = Driver.FindElement(By.XPath(""//a[contains(text(), 'About us')]"")); var element = Driver.FindElement(By.XPath(""//a[contains(text(), 'About us' or 'about us')]"")); ",Find an element by Xpath which contains text
What is the purpose of nameof in C# 6.0?," Version 6.0 got a new feature of nameof, but I can't understand the purpose of it, as it just takes the variable name and changes it to a string on compilation.I thought it might have some purpose when using <T> but when I try to nameof(T) it just prints me a T instead of the used type.Any idea on the purpose? <code> ",What is the purpose of nameof?
Ensure data deserialization," I have 3 ObservableCollections in my ViewModel and one Class which I load when you run an app.To ensure ObservableCollections are deserialized I just got. If there is no file, deserializationMethod will create new object with That works fine - no problem with that.And for class I have I added a property - if file is deserialized then it's true.It looks like it works but it is NOT. It happens very rarely but sometimes file is not deserialized and when you use an app this file is overwritten so every data are destroyed. I cannot find what is causing the problem. It is that you just run an app and it happens - like once per 100 runs.How to be very sure that if file exist then it will be deserialized for sure?Or maybe I should make List of these ObservableCollections + Class and serialize it to one file? Is there any good practice with that?EDIT:I used SemaphoreSlim to ensure that everything is used as it supposed to, but today it happened again.The thing is it happens when app is started and nothing else is even tapped. There is no way that something is writing at this moment. It looks like data is not deserialized or is not reading the file that exist. Because every changes are written with closing an app then everything is gone.Any other ideas what it might be or how to be sure that data are deserialized?EDIT FINAL - reproduced problem:I finally reproduced what is going on. So I've removed edits with code that wasn't necessary here.I have BackPressed event to handle when user is going back or want to exit an app (if on MainPage).This part of code apparently was causing the problem. What is going on exactly.First thing is that problem isn't possible to be reproduced using emulator.My BackPressed method contained await with serializing method that saved the data that were later gone (so as Ondrej Svejdar has written it was writing before reading). BUT I started to test it and there is strange behaviour and I still have some questions about it.How it happens.When I started an app (by accident e.g.) and loading screen occurs I start to tap back button few times -> app isn't running it is closing ASAP and I can't even see a UI (sometimes I am able to see AppBar for a moment). Then when I try to open app again (doesn't matter if immediately or later) it is ""resuming"" and after this exact moment my data are gone. But not all of the data. Only the last one saved with await within BackPressed method. Only this one. I tried to save One, Two and Three ObservableCollections with and without this Class and ALWAYS the last one was saved ""empty"". After this awaits I got Application.Current.Exit() method that might cause this, but I'm not sure if this should matter when serializing method is Task and only the last one is wrongly serialized.When I remove this awaits from BackPressed method I can't reproduce this issue so this is it.Questions I still have are: Is this behavior expected? Is there better method to close an app and ensure serializing data or I just should save it during using an app not while exiting it? <code>  if(SomeCollection.Count == 0) ThisCollection = await deserializationMethod<ObservableColletion<T>>(filename); return Activator.CreateInstance<T>(); if(ClassObject.Loaded != true) ThisObject = await deserializationMethod<T>(filename);",Ensure data deserialization / serialization
Store Procedure return -1 for all cases in entity framwork," I have created this Stored Procedure and tring to call this Stored Procedure using entity framework. Below is code in written in C#. spIsValidUser Stored Procedure return -1 in all case. Please let me know error.EDIT - According to given answer, Store procedure is not used return statement because Entity Framework cannot support Stored Procedure Return scalar values out of the box..Let me know how can I send scalar data from Stored Procedure? <code>  CREATE PROC spIsValidUser @UserName varchar(50), @Password varchar(50) AS IF Exists(SELECT * FROM Users where UserName=@UserName and Password=@Password) BEGIN return 0 END ELSE BEGIN return 1 END GO MyBusEntities db = new MyBusEntities();int empQuery = db.spIsValidUser(""abc"", ""abc@123"");",Stored Procedure return -1 for all cases in entity framework
Stored Procedure return -1 for all cases in entity framwork," I have created this Stored Procedure and tring to call this Stored Procedure using entity framework. Below is code in written in C#. spIsValidUser Stored Procedure return -1 in all case. Please let me know error.EDIT - According to given answer, Store procedure is not used return statement because Entity Framework cannot support Stored Procedure Return scalar values out of the box..Let me know how can I send scalar data from Stored Procedure? <code>  CREATE PROC spIsValidUser @UserName varchar(50), @Password varchar(50) AS IF Exists(SELECT * FROM Users where UserName=@UserName and Password=@Password) BEGIN return 0 END ELSE BEGIN return 1 END GO MyBusEntities db = new MyBusEntities();int empQuery = db.spIsValidUser(""abc"", ""abc@123"");",Stored Procedure return -1 for all cases in entity framework
Element not visible c# selenium," I get the button element by Xpath, but when try to click on it, getting element not visible exception. The parent div <code>  <div class=""modal-footer""> <button id=""btnRegister"" type=""button"" class=""btn btn-primary btn-block"">Register</button></div> <div class=""modal fade in"" id=""registration-window"" tabindex=""-1"" role=""dialog"" aria-labelledby=""register-title"" aria-hidden=""false"" style=""display: block;"">",Element not visible Selenium/C#
How to use the ternary operator inside interpolated string?," I'm confused as to why this code won't compile: If I split it up, it works fine: <code>  var result = $""{fieldName}{isDescending ? "" desc"" : string.Empty}""; var desc = isDescending ? "" desc"" : string.Empty;var result = $""{fieldName}{desc}"";",How to use the ternary operator inside an interpolated string?
using <a> </a>.value for strings in C#?, I had a project in vb.net that used XML Literals to process large blocks of SQL like so: But cant seem to find its equivalent for C#Any suggestions? <code>  Dim SQL As String = <a> Use testalter table BarFoo alter column CouponName nvarchar(328)alter table Foo alter column IngredientName nvarchar(328)alter table Bar alter column IngredientShortDescription nvarchar(328)alter table FooBar alter column ItemName nvarchar(328) </a>.Value,How to achieve multi-line strings in C#; an alternative to VB's XML Literals?
Naming conventions: ToSomething and AsSomething - when to use which?," As I was writing some extension methods for my business logic objects, I came to the question of renaming the conversion methods. someObject.ToAnotherObject() would go fine with the widely used object.ToString().However LINQ, for example, mixes up both variants and I can't find a difference between them. ToDictionary(), ToList(), AsParallel(), AsQueryable(), ...What are the differences between these two naming conventions and what should I know to decide whether to use for my own classes? <code> ",C# method naming conventions: ToSomething vs. AsSomething
c# passing password through database how to make it secure, I'm working on an application that has being run on several servers. One of the servers handles the input and the others execute it. As by company policy everything has to pass through the database and sockets between instances are disallowed. Now this works fine for everything but one thing that worries me is the password. I'm currently implementing something that requires a user password to arrive at one of these applications in plain text. Now I understand this will never be 100% secure but is how do I minimize the risk? Currently I plan on putting the pw in the database and wiping it from the db once it has arrived. Logs are deleted once a day. How can I further this security wise? <code> ,Passing password through database how to make it secure
Handling / receiving live stream from WebRTC or any browser based capturing mechanism to the server using ASP.NET MVC," We need to capture a live video stream from WebRTC (or any other capturing mechanism from the client webcam, even if it is not supported on all browsers, but as a PoC).This live video needs to be handled by a server component (ASP.Net MVC / Web API), I imagine that the code on the server will look like: Looking for any keyword or helpful link. We have already implemented a way to send individual frames using base64 jpg, but this is not useful at all, because there is a huge overhead of the base64 encoding and because we could use any video encoding to send the video more efficiently (send the difference between the frames using VPx -vp8- for example), the required solution needs to capture a video from the webcam of the client and send it live (not recorded) to the server (asp.net) as a stream -or chunks of data representing the new video data-. <code>  [HttpPost]public ActionResult HandleVideoStream(Stream videoStream){ //Handle the live stream}",Handling / receiving live video webcam stream from WebRTC or any browser based capturing mechanism to the server using ASP.NET MVC
generate EF orderby Expression by string," I want to generate expression by string parameter,some code like: then call it: But It can't compile! I change T to object. Then It can compile, but It doesn't work. System.NotSupportedException: Unable to cast the type 'System.Int32' to type 'System.Object'. LINQ to Entities only supports casting EDM primitive or enumeration types. <code>  private Expression<Func<Task, T>> Generate(string orderby){ switch (orderby) { case ""Time"": return t => t.Time; case ""Money"": return t => t.RewardMoney; default: return t => t.Id; }} _context.Items.OrderBy(Generate(""Money"")); private Expression<Func<Task, object>> Generate(string orderby)",Generate EF orderby expression by string
C#: Is it possible to pass interpolated strings as parameter to a method," I have started to use Interpolated Strings (new feature of C# 6) and it is really useful and gracefully. But according to my needs I have to pass format of string to a method as a parameter. Something like next: In the past, I used it in the next way: Now I tried this code: But this doesn't work, because i is created inside of the method and is out of scope in this context.Is it possible to use any trick for passing interpolated strings as a parameter to a method? <code>  MyMethod(string format) MyMethod(""AAA{0:00}"") MyMethod($""AAA{i:00}"")",Is it possible to pass interpolated strings as parameter to a method?
"C# Event KeyDown happens before KeyPress, But KeyPress' Messagebox will show first"," Pressing a key in a text box, the KeyDown event occurs before KeyPress.I used a count and message boxes to see what would happen. The following is my code: When a key is pressed, this will show first... ...followed by this: Shouldn't the KeyDown message box (with NCount 1) show before the KeyPress message box (with Ncount 2)? <code>  int Ncount = 0;private void Textbox_KeyDown(object sender, KeyEventArgs e){ Ncount += 1; MessageBox.Show(""KeyDown's Ncount : "" + Ncount.ToString());}private void Textbox_KeyPress(object sender, KeyPressEventArgs e){ Ncount += 1; MessageBox.Show(""KeyPress's Ncount : "" + Ncount.ToString());} KeyPress's Ncount : 2 KeyDown's Ncount : 1",Why does KeyPress's message box show before KeyDown's?
"Event KeyDown happens before KeyPress, But KeyPress' Messagebox will show first"," Pressing a key in a text box, the KeyDown event occurs before KeyPress.I used a count and message boxes to see what would happen. The following is my code: When a key is pressed, this will show first... ...followed by this: Shouldn't the KeyDown message box (with NCount 1) show before the KeyPress message box (with Ncount 2)? <code>  int Ncount = 0;private void Textbox_KeyDown(object sender, KeyEventArgs e){ Ncount += 1; MessageBox.Show(""KeyDown's Ncount : "" + Ncount.ToString());}private void Textbox_KeyPress(object sender, KeyPressEventArgs e){ Ncount += 1; MessageBox.Show(""KeyPress's Ncount : "" + Ncount.ToString());} KeyPress's Ncount : 2 KeyDown's Ncount : 1",Why does KeyPress's message box show before KeyDown's?
Generate two different strings with same hashcode," I want to do some tests which require some strings with the same hash code, but not the same strings. I couldn't find any examples, so I decided to write a simple program to do it for me.The code below generates two random strings over and over until they generate the same hash code. This code seems to be working (theoretically), but it may take centuries to complete. So I was thinking of doing vice versa and generate two strings from one hash code.I know it's not possible to retrieve a string from a hash code, but is it possible to generate possible strings from it?I'm using Visual Studio 2015 Community Edition. Version: 14.0.23107.0D14REL..NET Framework: 4.6.00081. <code>  static Random r = new Random(); static void Main(string[] args) { string str1, str2; do { str1 = GenerateString(); str2 = GenerateString(); } while (str1.GetHashCode() != str2.GetHashCode() && str1 != str2); Console.WriteLine(""{0}\n{1}"", str1, str2); } static string GenerateString() { string s = """"; while (s.Length < 6) { s += (char)r.Next(char.MaxValue); } return s; }",Generate two different strings with the same hashcode
How to do batch processing of CSV file using TPL/Dataflow for best peformance?," I wrote the following method to batch process a huge CSV file. The idea is to read a chunk of lines from the file into memory, then partition these chunk of lines into batches of fixed size. Once we get the partitions, send these partitions to a server (sync or async) which might take a while. This piece of code doesn't seem to be very efficient because of 2 reasons.The main thread that reads from the CSV file is blocked, till all the partitions are processed.The AsParallel blocks till all the tasks are finished. So if there are more threads available in the thread pool to do work, I'm not using them coz the no of tasks are bound by no of partitions. The batchSize is fixed so can't be changed but chunkSize is tuneable for performance. I can choose a large enough chunkSize, such that no of batches created are >> no of threads available in the system, but it still means that the Parallel.ForEach method blocks till all the tasks are finished.How can I change the code such that all available threads in the system are utilized to do the work w/o sitting idle. I'm thinking I could use a BlockingCollection to store the batches but not sure what capacity size to give it since no of batches are dynamic in each chunk. Any ideas on how to use TPL to maximize thread utilization so that most available threads on the system are always doing stuff?UPDATE:This is what I got so far using TPL dataflow. Is this correct? <code>  private static void BatchProcess(string filePath, int chunkSize, int batchSize){ List<string> chunk = new List<string>(chunkSize); foreach (var line in File.ReadLines(filePath)) { if (chunk.Count == chunk.Capacity) { // Partition each chunk into smaller chunks grouped on column 1 var partitions = chunk.GroupBy(c => c.Split(',')[0], (key, g) => g); // Further breakdown the chunks into batch size groups var groups = partitions.Select(x => x.Select((i, index) => new { i, index }).GroupBy(g => g.index / batchSize, e => e.i)); // Get batches from groups var batches = groups.SelectMany(x => x) .Select(y => y.Select(z => z)).ToList(); // Process all batches asynchronously batches.AsParallel().ForAll(async b => { WebClient client = new WebClient(); byte[] bytes = System.Text.Encoding.ASCII .GetBytes(b.SelectMany(x => x).ToString()); await client.UploadDataTaskAsync(""myserver.com"", bytes); }); // clear the chunk chunk.Clear(); } chunk.Add(line); }} private static void UploadData(string filePath, int chunkSize, int batchSize){ var buffer1 = new BatchBlock<string>(chunkSize); var buffer2 = new BufferBlock<IEnumerable<string>>(); var action1 = new ActionBlock<string[]>(t => { Console.WriteLine(""Got a chunk of lines "" + t.Count()); // Partition each chunk into smaller chunks grouped on column 1 var partitions = t.GroupBy(c => c.Split(',')[0], (key, g) => g); // Further breakdown the chunks into batch size groups var groups = partitions.Select(x => x.Select((i, index) => new { i, index }).GroupBy(g => g.index / batchSize, e => e.i)); // Get batches from groups var batches = groups.SelectMany(x => x).Select(y => y.Select(z => z)); foreach (var batch in batches) { buffer2.Post(batch); } }, new ExecutionDataflowBlockOptions { MaxDegreeOfParallelism = 1 }); buffer1.LinkTo(action1, new DataflowLinkOptions { PropagateCompletion = true }); var action2 = new TransformBlock<IEnumerable<string>, IEnumerable<string>>(async b => { await ExecuteBatch(b); return b; }, new ExecutionDataflowBlockOptions { MaxDegreeOfParallelism = DataflowBlockOptions.Unbounded }); buffer2.LinkTo(action2, new DataflowLinkOptions { PropagateCompletion = true }); var action3 = new ActionBlock<IEnumerable<string>>(b => { Console.WriteLine(""Finised executing a batch""); }, new ExecutionDataflowBlockOptions { MaxDegreeOfParallelism = 1 }); action2.LinkTo(action3, new DataflowLinkOptions { PropagateCompletion = true }); Task produceTask = Task.Factory.StartNew(() => { foreach (var line in File.ReadLines(filePath)) { buffer1.Post(line); } //Once marked complete your entire data flow will signal a stop for // all new items Console.WriteLine(""Finished producing""); buffer1.Complete(); }); Task.WaitAll(produceTask); Console.WriteLine(""Produced complete""); action1.Completion.Wait();//Will add all the items to buffer2 Console.WriteLine(""Action1 complete""); buffer2.Complete();//will not get any new items action2.Completion.Wait();//Process the batch of 5 and then complete Task.Wait(action3.Completion); Console.WriteLine(""Process complete""); Console.ReadLine();}",How to do async operations in a TPL Dataflow for best performance?
How to do async operations in a TPL Dataflow for best peformance?," I wrote the following method to batch process a huge CSV file. The idea is to read a chunk of lines from the file into memory, then partition these chunk of lines into batches of fixed size. Once we get the partitions, send these partitions to a server (sync or async) which might take a while. This piece of code doesn't seem to be very efficient because of 2 reasons.The main thread that reads from the CSV file is blocked, till all the partitions are processed.The AsParallel blocks till all the tasks are finished. So if there are more threads available in the thread pool to do work, I'm not using them coz the no of tasks are bound by no of partitions. The batchSize is fixed so can't be changed but chunkSize is tuneable for performance. I can choose a large enough chunkSize, such that no of batches created are >> no of threads available in the system, but it still means that the Parallel.ForEach method blocks till all the tasks are finished.How can I change the code such that all available threads in the system are utilized to do the work w/o sitting idle. I'm thinking I could use a BlockingCollection to store the batches but not sure what capacity size to give it since no of batches are dynamic in each chunk. Any ideas on how to use TPL to maximize thread utilization so that most available threads on the system are always doing stuff?UPDATE:This is what I got so far using TPL dataflow. Is this correct? <code>  private static void BatchProcess(string filePath, int chunkSize, int batchSize){ List<string> chunk = new List<string>(chunkSize); foreach (var line in File.ReadLines(filePath)) { if (chunk.Count == chunk.Capacity) { // Partition each chunk into smaller chunks grouped on column 1 var partitions = chunk.GroupBy(c => c.Split(',')[0], (key, g) => g); // Further breakdown the chunks into batch size groups var groups = partitions.Select(x => x.Select((i, index) => new { i, index }).GroupBy(g => g.index / batchSize, e => e.i)); // Get batches from groups var batches = groups.SelectMany(x => x) .Select(y => y.Select(z => z)).ToList(); // Process all batches asynchronously batches.AsParallel().ForAll(async b => { WebClient client = new WebClient(); byte[] bytes = System.Text.Encoding.ASCII .GetBytes(b.SelectMany(x => x).ToString()); await client.UploadDataTaskAsync(""myserver.com"", bytes); }); // clear the chunk chunk.Clear(); } chunk.Add(line); }} private static void UploadData(string filePath, int chunkSize, int batchSize){ var buffer1 = new BatchBlock<string>(chunkSize); var buffer2 = new BufferBlock<IEnumerable<string>>(); var action1 = new ActionBlock<string[]>(t => { Console.WriteLine(""Got a chunk of lines "" + t.Count()); // Partition each chunk into smaller chunks grouped on column 1 var partitions = t.GroupBy(c => c.Split(',')[0], (key, g) => g); // Further breakdown the chunks into batch size groups var groups = partitions.Select(x => x.Select((i, index) => new { i, index }).GroupBy(g => g.index / batchSize, e => e.i)); // Get batches from groups var batches = groups.SelectMany(x => x).Select(y => y.Select(z => z)); foreach (var batch in batches) { buffer2.Post(batch); } }, new ExecutionDataflowBlockOptions { MaxDegreeOfParallelism = 1 }); buffer1.LinkTo(action1, new DataflowLinkOptions { PropagateCompletion = true }); var action2 = new TransformBlock<IEnumerable<string>, IEnumerable<string>>(async b => { await ExecuteBatch(b); return b; }, new ExecutionDataflowBlockOptions { MaxDegreeOfParallelism = DataflowBlockOptions.Unbounded }); buffer2.LinkTo(action2, new DataflowLinkOptions { PropagateCompletion = true }); var action3 = new ActionBlock<IEnumerable<string>>(b => { Console.WriteLine(""Finised executing a batch""); }, new ExecutionDataflowBlockOptions { MaxDegreeOfParallelism = 1 }); action2.LinkTo(action3, new DataflowLinkOptions { PropagateCompletion = true }); Task produceTask = Task.Factory.StartNew(() => { foreach (var line in File.ReadLines(filePath)) { buffer1.Post(line); } //Once marked complete your entire data flow will signal a stop for // all new items Console.WriteLine(""Finished producing""); buffer1.Complete(); }); Task.WaitAll(produceTask); Console.WriteLine(""Produced complete""); action1.Completion.Wait();//Will add all the items to buffer2 Console.WriteLine(""Action1 complete""); buffer2.Complete();//will not get any new items action2.Completion.Wait();//Process the batch of 5 and then complete Task.Wait(action3.Completion); Console.WriteLine(""Process complete""); Console.ReadLine();}",How to do async operations in a TPL Dataflow for best performance?
C# Syncfusion - how to filter TreeViewAdv with RecordFilters, I am new to C# and SyncFusion and would really appreciate your help.I need to have the correct records shown in TreeViewPresenter(TreeViewAdv) after filtering gridGroupingControl. First I thought about to get the filters with: and to set these filters in the TreeViewPresenter but it seems that it doesn't work like that. Are there any easy methods to filter the tree with the same filtering criterias as gridGroupingControl? <code>  detailGroupingControl.TableDescriptor.RecordFilters,How to filter TreeViewAdv with RecordFilters
Why does the base type of an open generic type is not open?," Consider a piece of the code below: In such case: a has the value 0, which is not surprising. This, however, is somehow unexpected for me: where b has the value 1. So it is closed using a non-existing type of name ""T"" and only doing GetGenericTypeDefinition on it makes it open again. Why is that? <code>  public class A<T> { }public class B<T> : A<T> { } var a = typeof(A<>).GenericTypeArguments.Length; var b = typeof(B<>).BaseType.GenericTypeArguments.Length;",Why is the base type of an open generic type not open?
"What is meant by ""you need to know what the base class is to determine what the base class is""?"," I just read this interesting article by Eric Lippert, Top 10 Worst C# Features. Near the end he states: The rules for resolving names after the aforementioned colon are not well founded; you can end up in situations where you need to know what the base class is in order to determine what the base class is.By colon he is referring to the inheritance operator (e.g. Dog : Animal).What situation is Eric referring to? Can anyone provide a code sample? <code> ","What does Eric Lippert mean by ""you need to know what the base class is to determine what the base class is""?"
How to get list of all .NET 4.5 assemblies programmitically?," I have an application to write dynamic assembly in runtime, so I need to a list of all assemblies in my system like Visual Studio Reference Manager:My question is: How to fetch a list of all .NET Assemblies by self .NET languages and without searching a folder files?Note: I know I can find any assemblies from: C:\Windows\assembly\GAC\... or C:\Windows\Microsoft.NET\Frameworkbut I not sure to find that assemblies in all system by this way! Because I do not have access to these folders on all computers. So my app only through .NET code can fetch the names of these assemblies. And other problem is that the path to this folder on all the computers are not fixed and may vary. <code> ",How to get list of all .NET assemblies programmatically?
How to get list of all .NET assemblies programmitically?," I have an application to write dynamic assembly in runtime, so I need to a list of all assemblies in my system like Visual Studio Reference Manager:My question is: How to fetch a list of all .NET Assemblies by self .NET languages and without searching a folder files?Note: I know I can find any assemblies from: C:\Windows\assembly\GAC\... or C:\Windows\Microsoft.NET\Frameworkbut I not sure to find that assemblies in all system by this way! Because I do not have access to these folders on all computers. So my app only through .NET code can fetch the names of these assemblies. And other problem is that the path to this folder on all the computers are not fixed and may vary. <code> ",How to get list of all .NET assemblies programmatically?
How to get list of all .NET assemblies Programmatically?," I have an application to write dynamic assembly in runtime, so I need to a list of all assemblies in my system like Visual Studio Reference Manager:My question is: How to fetch a list of all .NET Assemblies by self .NET languages and without searching a folder files?Note: I know I can find any assemblies from: C:\Windows\assembly\GAC\... or C:\Windows\Microsoft.NET\Frameworkbut I not sure to find that assemblies in all system by this way! Because I do not have access to these folders on all computers. So my app only through .NET code can fetch the names of these assemblies. And other problem is that the path to this folder on all the computers are not fixed and may vary. <code> ",How to get list of all .NET assemblies programmatically?
C# Custom validation unique property - generic classes," I'm trying to make a custom validation [IsUnique]. That check if is property value is unique and return a proper message.This is my code, but this only work for a specified class, is possible to do a method that get the proper class by the metadata? And my custom validation: the idea would be to just use the annotation [isUnique] and the method take the class with annotation and search the corresponding entity. <code>  public class ArticleMetaData { [Required(AllowEmptyStrings = false)] [IsUnique(""Name"")] public String Name{ get; set; } } class IsUnique : ValidationAttribute { public IsUnique(string propertyNames) { this.PropertyNames = propertyNames; } public string PropertyNames { get; private set; } protected override ValidationResult IsValid(object value, ValidationContext validationContext) { var myproperty = validationContext.ObjectType.GetProperty(PropertyNames); var value = propiedad.GetValue(validationContext.ObjectInstance, null); IEnumerable<String> properties; List<string> propertiesList = new List<string>(); propertiesList.Add(myproperty.Name); var dba = new myContext(); if (dba.Articles.Any(article => article.Name == (string)value)) { return new ValidationResult(""The name already exist"", propertiesList); } return null; } }",Custom validation unique property - generic classes
"disable capturing context in all librabry code, ConfigureAwait(false)"," When using await, by default the SynchronizationContext (if one exists) is captured and the codeblocks after the await (continuation blocks) is executed using that context (which results in thread context switches). While this default might make sense in the context of the UI where you want to be back on the UI-thread after an asynchronous operation completes, it doesn't seem make sense as the default for most other scenarios. It certainly doesn't make sense for internal library code, becauseIt comes with the overhead of unnecessary thread context switches.It is very easy to accidentaly produce deadlocks (as documented here or here).It seems to me that Microsoft have decided for the wrong default.Now my question:Is there any other (preferably better) way to solve this than by cluttering all await calls in my code with .ConfigureAwait(false)? This is just so easy to forget and makes the code less readable. Update:Would it maybe suffice to call await Task.Yield().ConfigureAwait(false); at the beginning of each method? If this would guarantee me that I will be on a thread without a SynchronizationContext aferwards, all subsequent await calls would not capture any context.  <code>  public async Task DoSomethingAsync(){ // We are on a thread that has a SynchronizationContext here. await DoSomethingElseAsync(); // We are back on the same thread as before here //(well sometimes, depending on how the captured SynchronizationContext is implemented)}","disable capturing context in all library code, ConfigureAwait(false)"
How can I stop Device.StartTimer?," When I use System.Threading.Timer I can stop my timer and start it again: What is the best way to stop Device.StartTimer and start it again? <code>  protected override void OnScrollChanged(int l, int t, int oldl, int oldt){ if (timer == null) { System.Threading.TimerCallback tcb = OnScrollFinished; timer = new System.Threading.Timer(tcb, null, 700, System.Threading.Timeout.Infinite); } else { timer.Change(System.Threading.Timeout.Infinite, System.Threading.Timeout.Infinite); timer.Change(700, System.Threading.Timeout.Infinite); }}",How can I cancel from Device.StartTimer?
Storing requests in objects. Some trick needed," I have been working on a client - server project. The server side implemented on PHP. The client implemented on C#. The websocket is used for connection between them.So, here is the problem. Client will make a request. Json is in use for sending objects and validating against the schema. The request MUST HAVE it's name and MAY contain args. Args are like associative array (key => value).Server will give a response. Response MAY contain args, objects, array of objects. For example, client sends a request like: For this, server will reply with an AuthSuccess or AuthFailed response like: If response is AuthSuccess, client will send a requst of who is online. Server must send an array of users. And so on. So the problem is, how to store those responses on a client side. I mean, the way of creating a new object for each response type is insane. They will be hundreds of request types, and each of them requires it's own response. And any changing in structure of request will be very very hard...Need some kind of pattern or trick. I know it's kind of a noob way... But if anyone has a better idea of implementing request/response structure, please tell it.Best regards! <code>  { ""name"": ""AuthenticationRequest"", ""username"": ""root"", ""password"": ""password"", ""etc"": ""etc"" } { ""name"": ""AuthFailed"", ""args"": [ { ""reason"": ""Reason text"" }] }",Parsing (many) JSON different objects to C# classes. Is strongly typed better?
MVC Custom Model Binder for GET request," I've created a custom MVC Model Binder which gets called for every HttpPost that comes into the server. But does not get called for HttpGet requests.Should my custom model binder get called during a GET? If so, what did I miss?If not, How can I write custom code handling the QueryString from a GET Request?Here's my implementation... Global.asax I've looked into these solutions, but they don't quite work for what I'm looking for:Persisting complex types via TempDataUsing the default binder to build up complex types (?Name=John&Surname=Doe)Remark on answerThanks to @Felipe for the help. Just in case someone struggles with the same, I learnt:The custom model binder CAN be used for GET requestsYou CAN use DefaultModelBinder classMy snag was that the action method MUST have a parameter (otherwise the model binder is skipped for GET Requests, which makes sense when you think about it) <code>  public class CustomModelBinder : DefaultModelBinder{ public override object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext) { // This only gets called for POST requests. But I need this code for GET requests. }} protected void Application_Start(){ ModelBinders.Binders.DefaultBinder = new CustomModelBinder(); //...}",Custom Model Binder for ASP.NET MVC on GET request
sub object value linq lambda," Expected end results is to get an IEnumerable with 1.2, 2.3, 3.1, 4.2 which represents the SubTierId of each subTier. but what happens is I get this return type. What is the best way so that I just get a single IEnumerable of the SubSubTier? <code>  Top Tier Object SubTier Objects SubSubTier Objects 1.1,1.2,1.3 : SubTierId = 2 SubSubTier Objects 2.1,2.2,1.3 : SubTierId = 3 SubTier Objects SubSubTier Objects 3.1,3.2,3.3 : SubTierId = 1 SubSubTier Objects 4.1,4.2,4.3 : SubTierId = 2 SubSubTiers mySubSubTier = allTiers.Select(topTier => topTier.SubTiers.Where(sbTier => sbTier.Id == topTier.SubTierId)); IEnumerable<IEnumerable<SubSubTier>>",How to get Sub objects based on value using linq?
How to get Sub objects based on value using linq lambda?," Expected end results is to get an IEnumerable with 1.2, 2.3, 3.1, 4.2 which represents the SubTierId of each subTier. but what happens is I get this return type. What is the best way so that I just get a single IEnumerable of the SubSubTier? <code>  Top Tier Object SubTier Objects SubSubTier Objects 1.1,1.2,1.3 : SubTierId = 2 SubSubTier Objects 2.1,2.2,1.3 : SubTierId = 3 SubTier Objects SubSubTier Objects 3.1,3.2,3.3 : SubTierId = 1 SubSubTier Objects 4.1,4.2,4.3 : SubTierId = 2 SubSubTiers mySubSubTier = allTiers.Select(topTier => topTier.SubTiers.Where(sbTier => sbTier.Id == topTier.SubTierId)); IEnumerable<IEnumerable<SubSubTier>>",How to get Sub objects based on value using linq?
How to Force Visual Studio to Run Website in https://," A lot of my website requires https but when I launch my ASP.NET MVC website from Visual Studio, it loads in http.When I navigate to a page that requires https, on a controller that has the [RequireHttps] attribute it doesn't know that the https version of the site is running on port 44300, so it just attempts to redirect to https://localhost/login (default port).Am I missing some kind of configuration? I have SSL Enabled = true in the properties for the MVC project.I want to just be able to navigate my site as I would normally as if it were hosted on my serverIs this possible? <code> ",How to Force Visual Studio to Run Website in https
RaiseCanExecuteChanged COM Exception from cross thread operation?," UpdateUploaded sample project: https://github.com/subt13/BugSamplesI have reproduced an error that has been occurring in a Windows 10 UAP application that utilizes the MVVMLight framework. I receive the error below during navigation while the CPU is under heavy load (~20-25%) and the page is ""heavy"" (large images, lots of controls, etc., etc.) at System.Runtime.InteropServices.WindowsRuntime.ICommandAdapterHelpers.<>c__DisplayClass2.b__3(Object sender, EventArgs e) at System.EventHandler.Invoke(Object sender, EventArgs e) at GalaSoft.MvvmLight.Command.RelayCommand.RaiseCanExecuteChanged() at RaiseExecuteChangeRepo.ViewModel.MainViewModel.d__17.MoveNext()In the sample, the error occurs on RaiseCanExecuteChanged(); Nothing special is happening during navigation other than the command associated with ExecuteLoadDataCommandAsync() is getting called to load data. To reproduce, simply toggle from one page to the other rapidly for a few seconds and then just wait. After not too long the exception will be raised. <code>  private async void ExecuteLoadDataCommandAsync() { // cause the app to slow done. var data = await Task.Run(() => GetData()); if (data != null) { this.Data.Clear(); foreach (var item in data) { this.Data.Add(new AnotherVM(item)); } } // have the select job command rerun its condition this.SelectCommand.RaiseCanExecuteChanged(); } // slow down the page public List<DataItem> GetData() { var myList = new List<DataItem>(); for (int i = 0; i < 100000; ++i) { myList.Add(new DataItem(""Welcome to MVVM Light"")); } return myList; } <Core:EventTriggerBehavior EventName=""Loaded""> <Core:InvokeCommandAction Command=""{Binding LoadDataCommand}""> </Core:InvokeCommandAction></Core:EventTriggerBehavior>",RaiseCanExecuteChanged COM Exception during Navigation?
RaiseCanExecuteChanged COM Exception During Navigation?," UpdateUploaded sample project: https://github.com/subt13/BugSamplesI have reproduced an error that has been occurring in a Windows 10 UAP application that utilizes the MVVMLight framework. I receive the error below during navigation while the CPU is under heavy load (~20-25%) and the page is ""heavy"" (large images, lots of controls, etc., etc.) at System.Runtime.InteropServices.WindowsRuntime.ICommandAdapterHelpers.<>c__DisplayClass2.b__3(Object sender, EventArgs e) at System.EventHandler.Invoke(Object sender, EventArgs e) at GalaSoft.MvvmLight.Command.RelayCommand.RaiseCanExecuteChanged() at RaiseExecuteChangeRepo.ViewModel.MainViewModel.d__17.MoveNext()In the sample, the error occurs on RaiseCanExecuteChanged(); Nothing special is happening during navigation other than the command associated with ExecuteLoadDataCommandAsync() is getting called to load data. To reproduce, simply toggle from one page to the other rapidly for a few seconds and then just wait. After not too long the exception will be raised. <code>  private async void ExecuteLoadDataCommandAsync() { // cause the app to slow done. var data = await Task.Run(() => GetData()); if (data != null) { this.Data.Clear(); foreach (var item in data) { this.Data.Add(new AnotherVM(item)); } } // have the select job command rerun its condition this.SelectCommand.RaiseCanExecuteChanged(); } // slow down the page public List<DataItem> GetData() { var myList = new List<DataItem>(); for (int i = 0; i < 100000; ++i) { myList.Add(new DataItem(""Welcome to MVVM Light"")); } return myList; } <Core:EventTriggerBehavior EventName=""Loaded""> <Core:InvokeCommandAction Command=""{Binding LoadDataCommand}""> </Core:InvokeCommandAction></Core:EventTriggerBehavior>",RaiseCanExecuteChanged COM Exception during Navigation?
How to Access and Use Device Camera in Aforge.NET for Decoding QRCode in C#," I am trying to develop a WindowsForm Application which will use webcamera to detect QRCode and decode the message. For this I am using AForge.NET and ZXing.NET.So far, I have been able to figure out how to decode the QRCode from an URI, but I want to detect the QRCode from webcamera, and decode it.Below is the sample to my code. <code>  public String Decode(Uri uri){ Bitmap image; try { image = (Bitmap)Bitmap.FromFile(uri.LocalPath); } catch (Exception ex) { throw new FileNotFoundException(""Resource not found: "" + uri); } using (image) { String text = """"; LuminanceSource source = new BitmapLuminanceSource(image); BinaryBitmap bitmap = new BinaryBitmap(new HybridBinarizer(source)); Result result = new MultiFormatReader().decode(bitmap); if (result != null) { text = result.Text; return text; } text = ""Provided QR couldn't be read.""; return text; }}",How to Decode QRCode from WebCamera using Aforge.NET and ZXing.NET in C#
How to Access and Use WebCamera in Aforge.NET for Decoding QRCode in C#," I am trying to develop a WindowsForm Application which will use webcamera to detect QRCode and decode the message. For this I am using AForge.NET and ZXing.NET.So far, I have been able to figure out how to decode the QRCode from an URI, but I want to detect the QRCode from webcamera, and decode it.Below is the sample to my code. <code>  public String Decode(Uri uri){ Bitmap image; try { image = (Bitmap)Bitmap.FromFile(uri.LocalPath); } catch (Exception ex) { throw new FileNotFoundException(""Resource not found: "" + uri); } using (image) { String text = """"; LuminanceSource source = new BitmapLuminanceSource(image); BinaryBitmap bitmap = new BinaryBitmap(new HybridBinarizer(source)); Result result = new MultiFormatReader().decode(bitmap); if (result != null) { text = result.Text; return text; } text = ""Provided QR couldn't be read.""; return text; }}",How to Decode QRCode from WebCamera using Aforge.NET and ZXing.NET in C#
Code Formatting in Visual Studio CODE Not working on C# Code, This question already has an answer here: How do you format code in Visual Studio Code?All the answers provided in this question are not working with C# code. I just copied my controller file and opened it in Visual Studio Code. I tried to format code with Shift + Alt + F (both right and left shifts in windows)But it didn't work. Is there a solution for this?The same shortcut is working for HTML and JavaScript files. <code> ,Code formatting in Visual Studio Code is not working on C# code
Call and consume API in winform using C#.net," I am beginner and creating winform application. In which i have to use API for Simple CRUD operation. My client had shared API with me and asked to send data in form of JSON.API : http://blabla.com/blabla/api/login-validaKEY : ""HelloWorld""Value : { ""email"": ""user@gmail.com"",""password"": ""123456"",""time"": ""2015-09-22 10:15:20""}Response : Login_idHow can i convert data to JSON, call API using POST method and get response?EDITSomewhere on stackoverflow i found this solution I got exception that says ""The remote server returned an error: (404) Not Found."" <code>  public static void POST(string url, string jsonContent){ url=""blabla.com/api/blala"" + url; HttpWebRequest request = (HttpWebRequest)WebRequest.Create(baseURL); request.Method = ""POST""; System.Text.UTF8Encoding encoding = new System.Text.UTF8Encoding(); Byte[] byteArray = encoding.GetBytes(jsonContent); request.ContentLength = byteArray.Length; request.ContentType = @""application/json""; using (Stream dataStream = request.GetRequestStream()) { dataStream.Write(byteArray, 0, byteArray.Length); } long length = 0; try { using (HttpWebResponse response = (HttpWebResponse)request.GetResponse()) { length = response.ContentLength; } } catch { throw; }}//on my login button click private void btnLogin_Click(object sender, EventArgs e){ CallAPI.POST(""login-validate"", ""{ \""email\"":"" + txtUserName.Text + "" ,\""password\"":"" + txtPassword.Text + "",\""time\"": "" + DateTime.Now.ToString(""yyyy-MM-dd h:mm tt"") + ""}"");}",Call and consume Web API in winform using C#.net
Using same datatable for pagemethod and webmethod in asp.net?," I am trying to create a new webpage where i need to display almost 10 different gridviews and charts.Gridviews are binded on pageload event and charts are displayed using jquery-ajax method (using amcharts as well as highcharts) by calling WebMethod.Initially i implemented the page in a way that after executing same set of stored procedures for gridviews(for showing grid view data) and webmethods(for drawing charts).So same sps are executed twice for this page(one for grid and another for chart).There are 10 sps required to execute for fetching the data.So for improving the page performance i have created static datatable like this and binded the gridview like this. and inside the webmethod i have used the same datatable for drawing the chartlike this with this i am able to show both grid and charts.Now Please tell me that, is this a correct approach to deal with webmethods? i have read that webmethod have no relation to the page and all.Please Tell me the drawbacks of this method.If this is wrong,Please suggest a better way to improve the page performance? <code>  static DataTable Report1; private void gvbindReport1() { try { Report1 = new DataTable();//refreshed datatable DataSet ReportDS1 = objmvbl.GetReportGraph(ClientID, date_From, date_To); if (ReportDS1.Tables.Count > 0) { Report1 = ReportDS1.Tables[0];//bindinding data to static datatable } GdReport.DataSource = Report1; GdReport.DataBind(); } catch (Exception ex) { Log.Errlog(""Error Occured in gvbindReport1 : "" + ex.Message.ToString()); } } [System.Web.Services.WebMethod] public static string GetDataReport1() { System.Web.Script.Serialization.JavaScriptSerializer serializer = new System.Web.Script.Serialization.JavaScriptSerializer(); List<Dictionary<string, object>> rows = new List<Dictionary<string, object>>(); Dictionary<string, object> row; try { //processing for the data inside static datatable if (Report1.Rows.Count > 0) { foreach (DataRow dr in Report1.Rows) { row = new Dictionary<string, object>(); foreach (DataColumn col in Report1.Columns) { row.Add(col.ColumnName, dr[col]); } rows.Add(row); } } } catch (Exception ex) { Log.Errlog(""Error Occured in GetDataReport WebMethod of Report Page : "" + ex.Message.ToString()); } return serializer.Serialize(rows); }",Can we use same datatable for pagemethod and webmethod in ASP.NET?
Difference between Using same datatable for pagemethod and webmethod," I am trying to create a new webpage where i need to display almost 10 different gridviews and charts.Gridviews are binded on pageload event and charts are displayed using jquery-ajax method (using amcharts as well as highcharts) by calling WebMethod.Initially i implemented the page in a way that after executing same set of stored procedures for gridviews(for showing grid view data) and webmethods(for drawing charts).So same sps are executed twice for this page(one for grid and another for chart).There are 10 sps required to execute for fetching the data.So for improving the page performance i have created static datatable like this and binded the gridview like this. and inside the webmethod i have used the same datatable for drawing the chartlike this with this i am able to show both grid and charts.Now Please tell me that, is this a correct approach to deal with webmethods? i have read that webmethod have no relation to the page and all.Please Tell me the drawbacks of this method.If this is wrong,Please suggest a better way to improve the page performance? <code>  static DataTable Report1; private void gvbindReport1() { try { Report1 = new DataTable();//refreshed datatable DataSet ReportDS1 = objmvbl.GetReportGraph(ClientID, date_From, date_To); if (ReportDS1.Tables.Count > 0) { Report1 = ReportDS1.Tables[0];//bindinding data to static datatable } GdReport.DataSource = Report1; GdReport.DataBind(); } catch (Exception ex) { Log.Errlog(""Error Occured in gvbindReport1 : "" + ex.Message.ToString()); } } [System.Web.Services.WebMethod] public static string GetDataReport1() { System.Web.Script.Serialization.JavaScriptSerializer serializer = new System.Web.Script.Serialization.JavaScriptSerializer(); List<Dictionary<string, object>> rows = new List<Dictionary<string, object>>(); Dictionary<string, object> row; try { //processing for the data inside static datatable if (Report1.Rows.Count > 0) { foreach (DataRow dr in Report1.Rows) { row = new Dictionary<string, object>(); foreach (DataColumn col in Report1.Columns) { row.Add(col.ColumnName, dr[col]); } rows.Add(row); } } } catch (Exception ex) { Log.Errlog(""Error Occured in GetDataReport WebMethod of Report Page : "" + ex.Message.ToString()); } return serializer.Serialize(rows); }",Can we use same datatable for pagemethod and webmethod in ASP.NET?
"C# - DayOfWeek get the next DayOfWeek(Monday,Tuesday...Sunday)"," Is there a way to summarize this code into 1-2 lines?My goal is to return, for example, I have a DayOfWeek which is Monday, I want to get the day after that (Tuesday) or n days after that. <code>  switch (_RESETDAY) { case DayOfWeek.Monday: _STARTDAY = DayOfWeek.Tuesday; break; case DayOfWeek.Tuesday: _STARTDAY = DayOfWeek.Wednesday; break; case DayOfWeek.Wednesday: _STARTDAY = DayOfWeek.Thursday; break; case DayOfWeek.Thursday: _STARTDAY = DayOfWeek.Friday; break; case DayOfWeek.Friday: _STARTDAY = DayOfWeek.Saturday; break; case DayOfWeek.Saturday: _STARTDAY = DayOfWeek.Sunday; break; case DayOfWeek.Sunday: _STARTDAY = DayOfWeek.Monday; break; default: _STARTDAY = DayOfWeek.Tuesday; break; }","DayOfWeek get the next DayOfWeek(Monday,Tuesday...Sunday)"
"Cannot cast DBNull.Value to type 'System.DataTime', Please use nullable types"," getting error while date is null . error line- DateTime renewalDate = row.Field(""RenewalDate""); <code>  protected void GrdV_Projects_RowDataBound(object sender, GridViewRowEventArgs e){ if (e.Row.RowType == DataControlRowType.DataRow ) { if (e.Row.RowType == DataControlRowType.DataRow) { DataRow row = ((DataRowView)e.Row.DataItem).Row; DateTime renewalDate = row.Field<DateTime>(""RenewalDate""); if (renewalDate.Date > DateTime.Today) e.Row.Cells[7].BackColor = System.Drawing.ColorTranslator.FromHtml(""#669B1F""); else e.Row.Cells[7].BackColor = System.Drawing.ColorTranslator.FromHtml(""#FF8234""); } }}","Cannot cast DBNull.Value to type 'System.DateTime', Please use nullable types"
C# multiple enum descriptions," I have defined the following enum: I'm utilising the Description attribute to allow me to pull out a more user-readable version of the enum to display in the UI. I get the description using the following code: The above code will give me: description = ""Set Top Box"". If there is no Description attribute set, it will give me the string value of the enum.I now want to add a second/custom attribute to each of the enums (called 'Value' for examples sake). eg: I will need to pull out the new Value attribute much the same way I currently do with the Description attribute.Is it possible to extend the existing Description attribute to somehow include the new Value attribute, or is it best to create the new attribute separately? <code>  public enum DeviceType{ [Description(""Set Top Box"")] Stb = 1, Panel = 2, Monitor = 3, [Description(""Wireless Keyboard"")] WirelessKeyboard = 4} var fieldInfo = DeviceType.Stb.GetType().GetField(DeviceType.Stb.ToString());var attributes = (DescriptionAttribute[])fieldInfo.GetCustomAttributes(typeof(DescriptionAttribute), false);var description = (attributes.Length > 0 ? attributes[0].Description : DeviceType.Stb.ToString()); public enum DeviceType{ [Description(""Set Top Box"")] [Value(""19.95"")] Stb = 1, [Value(""99"")] Panel = 2, [Value(""199.99"")] Monitor = 3, [Description(""Wireless Keyboard"")] [Value(""20"")] WirelessKeyboard = 4}",Multiple enum descriptions
c# mongo 2.0 Find with reduced traffic," I have to get some minor data from each document I have in the database but I still want to reduce traffic to prevent ""Table-Scan"" (just the term, i know its not tables).I have a collection of lets say ""Books"" (just because everyone are using it to give examples with ), now, my issue is that I want only the books titles with given author. But, when I scan the entire collection result, I'm using big chunks of data, isn't it? lets assume those are not books but entire grid networks and each document is around 5-10 MB and I have thousands of them..how can I reduce the traffic here, without storing this data I need in another collection?EditI think its called ""Views"" in SQL database. <code>  var filter = Builders<Book>.Filter.Eq(n => n.Author, AuthorId); List<string> books = new List<string>(); using (var cursor = await BooksCollection.FindAsync(filter)) { while (await cursor.MoveNextAsync()) { var batch = cursor.Current; foreach (Book b in batch) books.Add(b.Title); } }",c# mongo 2.0 reduce traffic of FindAsync
My method should throw exception or .net method throw exception," Here is my code: Should I throw an exception myself (see the File.Exists check)? FileStream will already throw FileNotFoundException if the the file doesn't exist. What is good programming practice here? Code analysis says that we should validate our parameters. But if I am passing that parameter directly to another method (mine or someone else code) and that method will throw exception itself, then what is advantage of validating argument in my code? <code>  public void ReadSomeFile(string filePath){ if (!File.Exists(filePath)) throw new FileNotFoundException(); var stream = new FileStream(filePath, ....) .....}","Should my method throw its own exception, or let .NET throw if a file doesn't exist?"
How to run sql server DB based software on clients," I have designed an accounts software for my clients. I used SQL Server 2008 database with Stored Procedures. It is developed in Visual Studio 2010, .NET Framework 3.0. I have more than 500 clients using Windows 7. The major problem is:Is SQL Server runtime automatically installed with .NET Framework? As MS Access database does not required Office to be installed on client. I can not installed SQL Server 2008 on each client, it is a tough job. Also the clients are not having a good knowledge of installation process. How to run SQL Server database on clients without installing its setup on clients? Is there any runtime files or setup? <code> ",How to deploy application with sql server database on clients
Why is this regex hanging?," I have the following code using regex that hangs at the last line when I run it: It works fine if I remove one of the final backslashes in test, e.g. Can someone please help me figure out why it's hanging? I know I can set a timeout; that's not my question. <code>  const char PathSeparator = '\\';const string PathPrefix = ""\\\\"";var reg = new Regex(string.Format(""^{0}(([^{1}\r\n\v\f\u2028\u2029]+){1}?)+$"", Regex.Escape(PathPrefix), Regex.Escape(PathSeparator.ToString())));var test = @""\\Inbox\Test123\Intermediate\3322FB69-FE3F-407E-9E15-584382A407A2\\"";var matches = reg.Matches(test);var group = matches[0].Groups[2]; var test = @""\\Inbox\Test123\Intermediate\3322FB69-FE3F-407E-9E15-584382A407A2\"";",Why is this regex hanging with two trailing back-slashes but works fine with just one?
Single instance in windows form application," I have a sample WinForm application named ""Restoring.exe"". While minimizing its window, it will move to system tray and will be hidden in the taskbar. If I click on the notification icon in system tray, the window will come to the front. But my actual requirement is, while clicking the application 2nd time, need to restore the application from system tray. For this, I tried the below codeProgram.cs: Form1.cs: My actual issue is, if the application is already running, the 'Restore' method is hitting and all the actions listed in that is running and the window is appearing into front. But after completed those actions, the window again goes to the system tray. Not sitting in front. Could anyone please provide a solution for this?  <code>  public void notifyicon_MouseClick(object sender, System.EventArgs e){ notifyicon.Visible = false; Show(); Activate(); TopMost = true; BringToFront(); this.WindowState = FormWindowState.Normal;} static void Main(){ if (IsServiceManagerAlreadyRunning()) { Form1 form1 = new Form1(); form1.Restore(); } else { Application.EnableVisualStyles(); Application.SetCompatibleTextRenderingDefault(false); Application.Run(new Form1()); }} public void Restore(){ notifyicon.Visible = false; Show(); Activate(); TopMost = true; BringToFront(); this.WindowState = FormWindowState.Normal;} ",Single Instance Windows Forms Application with Minimize to Tray
Updating database call without page relaod," A list of images (treasures) are displayed to the user, here the user will choose a single image which will be stored in the Learner_treauser table: The function called when an image is chosen. In this function the image is sent over to a webservice method to be saved to the database, and the page is reload for an update to take place: However this is not very pleasant on the user's point of you. A better way would be to update without refreshing the page.Here is the Webservice method that receives the chosen image id and stores it in the Learner_Treasure table. Code to call Learner_Treasure table. This code will show the user all the images they have chosen, however in if I take away window.location.reload(); this code is only updated when the page reloads. Meaning that the user will not see their chosen image immediately after they have chosen it.What I want to do is update the code that calls the Learner_Table without refreshing the page. <code>  List<The_Factory_Chante.Models.Treasure> tresh;using (The_Factory_Chante.Models.The_FactoryDBContext db2 = new The_Factory_Chante.Models.The_FactoryDBContext()){ string imageSource = """"; tresh = db2.Treasures.ToList(); foreach (var item in tresh) { if (item.itemImage != null) { string imageBase = Convert.ToBase64String(item.itemImage); imageSource = string.Format(""data:image/gif;base64,{0}"", imageBase); } <img id=""@item.treasureID"" src=""@imageSource"" onclick=""return MakeSure(@item.treasureID)"" /> }} function MakeSure(treshID) { var id = treshID $.ajax({ url: ""../../WebService.asmx/MakeSure"", data: ""{ 'id': '"" + id + ""'}"", dataType: ""json"", type: ""POST"", contentType: ""application/json; charset=utf-8"", success: function (data) { }, error: function (XMLHttpRequest, textStatus, errorThrown) { } }); window.location.reload();}; public void MakeSure(int id){ using (The_FactoryDBContext db = new The_FactoryDBContext()) { Learner_Treasure learnTreasure = new Learner_Treasure(); learnTreasure.dateCompleted = DateTime.Today; learnTreasure.learnerID = UserInfo.ID; learnTreasure.treasureID = id; db.Learner_Treasure.Add(learnTreasure); db.SaveChanges(); } List<The_Factory_Chante.Models.Learner_Treasure> lern;using (The_Factory_Chante.Models.The_FactoryDBContext db2 = new The_Factory_Chante.Models.The_FactoryDBContext()){ string imageSource = """"; lern = db2.Learner_Treasure.ToList(); if (lern != null) { foreach (var item in lern) { if (item.learnerID == UserInfo.ID) { byte[] bytes = db2.Treasures.FirstOrDefault(au => au.treasureID == item.treasureID).itemImage; string imageBase = Convert.ToBase64String(bytes); imageSource = string.Format(""data:image/gif;base64,{0}"", imageBase); <img id=""@item.treasureID"" src=""@imageSource""/> } }",Updating database call without having to refresh page
Instantiate MonoBehaviour in unity3d unit test," I have the following open source project on Github (game project). I'm currently trying to unit test the code I wrote with the MSTest framework but all the tests return the same error message : ""Unhandled Exception: System.Security.SecurityException: ECall methods must be packaged into a system module."" This happened when I tried to unit test with the NUnit template. I've looked through the ECall methods post must be packagedto find some answers but I did not because the OP said that his solution work when inside the debugger region but not outside of it. The issue of the OP, as far as I'm concerned, when looking at the post, was not resolved.Afterwards, I imported the UnityTestTools framework inside my project. Thought it would be easy enough since it was based on the NUnit framework. Turns out that no. The test in itself is fairly basic. I have this base class, called BaseCharacterClass:MonoBehavior, which has, among other things, the property of type BaseCharacterStats. In the stats, there an object of type CharacterHealth which, well, takes care of the health of a player. Right now, I have the two following stack traces that I don't seem to get when I tried the following in my test. UNIT TESTS (NUNIT)Creating MonoBehavior Object using new keyword Stack Trace : Mock_Character_With_No_Health (0.047s) --- System.NullReferenceException : Object reference not set to an instance of an object --- at Assets.Scripts.CharactersUtil.CharacterHealth..ctor (Int32 sh) [0x0002f] in C:\Users\Kevin\Documents\AndroidPC_Prototype\PC_Augmented_Tactics_Demo\Assets\Scripts\CharactersUtil\CharacterHealth.cs:29 at UnityTest.MoqBaseCharacter..ctor () [0x00011] in C:\Users\Kevin\Documents\AndroidPC_Prototype\PC_Augmented_Tactics_Demo\Assets\UnityTestTools\Examples\UnitTestExamples\Editor\SampleTests.cs:14 at UnityTest.SampleTests.Mock_Character_With_No_Health () [0x00000] in C:\Users\Kevin\Documents\AndroidPC_Prototype\PC_Augmented_Tactics_Demo\Assets\UnityTestTools\Examples\UnitTestExamples\Editor\SampleTests.cs:32Using NSubstitute.For Stack trace Mock_Character_With_No_Health (0.137s) --- System.Reflection.TargetInvocationException : Exception has been thrown by the target of an invocation. ----> System.NullReferenceException : Object reference not set to an instance of an object --- at System.Reflection.MonoCMethod.Invoke (System.Object obj, BindingFlags invokeAttr, System.Reflection.Binder binder, System.Object[] parameters, System.Globalization.CultureInfo culture) [0x0012c] in /Users/builduser/buildslave/mono-runtime-and-classlibs/build/mcs/class/corlib/System.Reflection/MonoMethod.cs:519 at System.Reflection.MonoCMethod.Invoke (BindingFlags invokeAttr, System.Reflection.Binder binder, System.Object[] parameters, System.Globalization.CultureInfo culture) [0x00000] in /Users/builduser/buildslave/mono-runtime-and-classlibs/build/mcs/class/corlib/System.Reflection/MonoMethod.cs:528 at System.Activator.CreateInstance (System.Type type, BindingFlags bindingAttr, System.Reflection.Binder binder, System.Object[] args, System.Globalization.CultureInfo culture, System.Object[] activationAttributes) [0x001b8] in /Users/builduser/buildslave/mono-runtime-and-classlibs/build/mcs/class/corlib/System/Activator.cs:338 at System.Activator.CreateInstance (System.Type type, System.Object[] args, System.Object[] activationAttributes) [0x00000] in /Users/builduser/buildslave/mono-runtime-and-classlibs/build/mcs/class/corlib/System/Activator.cs:268 at System.Activator.CreateInstance (System.Type type, System.Object[] args) [0x00000] in /Users/builduser/buildslave/mono-runtime-and-classlibs/build/mcs/class/corlib/System/Activator.cs:263 at Castle.DynamicProxy.ProxyGenerator.CreateClassProxyInstance (System.Type proxyType, System.Collections.Generic.List`1 proxyArguments, System.Type classToProxy, System.Object[] constructorArguments) [0x00000] in :0 at Castle.DynamicProxy.ProxyGenerator.CreateClassProxy (System.Type classToProxy, System.Type[] additionalInterfacesToProxy, Castle.DynamicProxy.ProxyGenerationOptions options, System.Object[] constructorArguments, Castle.DynamicProxy.IInterceptor[] interceptors) [0x00000] in :0 at NSubstitute.Proxies.CastleDynamicProxy.CastleDynamicProxyFactory.CreateProxyUsingCastleProxyGenerator (System.Type typeToProxy, System.Type[] additionalInterfaces, System.Object[] constructorArguments, IInterceptor interceptor, Castle.DynamicProxy.ProxyGenerationOptions proxyGenerationOptions) [0x00000] in :0 at NSubstitute.Proxies.CastleDynamicProxy.CastleDynamicProxyFactory.GenerateProxy (ICallRouter callRouter, System.Type typeToProxy, System.Type[] additionalInterfaces, System.Object[] constructorArguments) [0x00000] in :0 at NSubstitute.Proxies.ProxyFactory.GenerateProxy (ICallRouter callRouter, System.Type typeToProxy, System.Type[] additionalInterfaces, System.Object[] constructorArguments) [0x00000] in :0 at NSubstitute.Core.SubstituteFactory.Create (System.Type[] typesToProxy, System.Object[] constructorArguments, SubstituteConfig config) [0x00000] in :0 at NSubstitute.Core.SubstituteFactory.Create (System.Type[] typesToProxy, System.Object[] constructorArguments) [0x00000] in :0 at NSubstitute.Substitute.For (System.Type[] typesToProxy, System.Object[] constructorArguments) [0x00000] in :0 at NSubstitute.Substitute.For[MoqBaseCharacter] (System.Object[] constructorArguments) [0x00000] in :0 at UnityTest.SampleTests.Mock_Character_With_No_Health () [0x00000] in C:\Users\Kevin\Documents\AndroidPC_Prototype\PC_Augmented_Tactics_Demo\Assets\UnityTestTools\Examples\UnitTestExamples\Editor\SampleTests.cs:32 --NullReferenceException at Assets.Scripts.CharactersUtil.CharacterHealth..ctor (Int32 sh) [0x0002f] in C:\Users\Kevin\Documents\AndroidPC_Prototype\PC_Augmented_Tactics_Demo\Assets\Scripts\CharactersUtil\CharacterHealth.cs:29 at UnityTest.MoqBaseCharacter..ctor () [0x00011] in C:\Users\Kevin\Documents\AndroidPC_Prototype\PC_Augmented_Tactics_Demo\Assets\UnityTestTools\Examples\UnitTestExamples\Editor\SampleTests.cs:14 at Castle.Proxies.MoqBaseCharacterProxy..ctor (ICallRouter , Castle.DynamicProxy.IInterceptor[] ) [0x00000] in :0 at (wrapper managed-to-native) System.Reflection.MonoCMethod:InternalInvoke (object,object[],System.Exception&) at System.Reflection.MonoCMethod.Invoke (System.Object obj, BindingFlags invokeAttr, System.Reflection.Binder binder, System.Object[] parameters, System.Globalization.CultureInfo culture) [0x00119] in /Users/builduser/buildslave/mono-runtime-and-classlibs/build/mcs/class/corlib/System.Reflection/MonoMethod.cs:513DisclaimerA quick reading on NSubstitute showed me that I should better use interfaces for subs... In my situation, I don't really see how an interface would be better for my code. If anyone has an idea for this instead of using the new keyword, I'm all up for it ! Finally, this is the source code for BaseCharacter, BaseStats and HealthBase Character implementation Base Stats Health <code>  [Test][Category(""Mock Character"")]public void Mock_Character_With_No_Health(){ var mock = new MoqBaseCharacter (); Assert.NotNull (mock.BaseStats); Assert.NotNull (mock.BaseStats.Health); Assert.LessOrEqual (0, mock.BaseStats.Health.CurrentHealth);}//This is not the full file//There ""2"" classes: 1 for holding tests and that Mock object public MoqBaseCharacter(){ this.BaseStats = new BaseCharacterStats (); this.BaseStats.Health = new CharacterHealth (0);} [Test][Category(""Mock Character"")]public void Mock_Character_With_No_Health(){ var mock = NSubstitute.Substitute.For<MoqBaseCharacter> (); Assert.NotNull (mock.BaseStats); Assert.NotNull (mock.BaseStats.Health); Assert.LessOrEqual (0, mock.BaseStats.Health.CurrentHealth);} using System;using UnityEngine;using System.Collections.Generic;using JetBrains.Annotations;using Random = System.Random;namespace Assets.Scripts.CharactersUtil{ public class BaseCharacterClass : MonoBehaviour { //int[] basicUDLRMovementArray = new int[4]; public List<BaseCharacterClass> CurrentEnnemies; public int StartingHealth = 500; public BaseCharacterStats BaseStats { get; set; } // Use this for initialization private void Start() { BaseStats = new BaseCharacterStats {Health = new CharacterHealth(StartingHealth)}; //Testing purposes BaseStats.ChanceForCriticalStrike = new Random().Next(0,BaseStats.CriticalStrikeCounter); } // Update is called once per frame private void Update() { //ExecuteBasicMovement(); } //During an attack with any kind of character //TODO: Make sure that people from the same team cannot attack themselves (friendly fire) private void OnTriggerEnter([NotNull] Collider other) { if (other == null) throw new ArgumentNullException(other.tag); Debug.Log(""I'm about to receive some damage""); var characterStats = other.gameObject.GetComponent<BaseCharacterClass>().BaseStats; var heathToAddOrRemove = other.gameObject.tag == ""Healer"" || other.gameObject.tag == ""AIHealer"" ? characterStats.Power : -1 * characterStats.Power; characterStats.Health.TakeDamageFromCharacter((int)heathToAddOrRemove); Debug.Log(""I should have received damage from a bastard""); if (characterStats.Health.CurrentHealth == 500) { Debug.Log(""This is a mistake, I believe I'm a god! INVICIBLE""); } } /* public void ExecuteBasicMovement() { var move = new Vector3(Input.GetAxis(""Horizontal""), Input.GetAxis(""Vertical""), 0); transform.position += move * BaseStats.Speed * Time.deltaTime; } //TODO: Make sure players moves correctly within the environment per cases public void ExecuteMovementPerCase() { } */ public bool CanDoExtraDamage() { if (BaseStats.ChanceForCriticalStrike*BaseStats.Luck < 50) return false; BaseStats.CriticalStrikeCounter--; BaseStats.ChanceForCriticalStrike = new Random().Next(0, BaseStats.CriticalStrikeCounter); BaseStats.AjustCriticalStrikeChances(); return true; } }} using System;using System.Collections.Generic;using System.Linq;using System.Text;using JetBrains.Annotations;namespace Assets.Scripts.CharactersUtil{ public class BaseCharacterStats { public float Power { get; set; } public float Defense { get; set; } public float Agility { get; set; } public float Speed { get; set; } public float MagicPower { get; set; } public float MagicResist { get; set; } public int ChanceForCriticalStrike; public int Luck { get; set; } public int CriticalStrikeCounter = 20; public int TemporaryDefenseBonusValue; private Random _randomValueGenerator; public BaseCharacterStats() { _randomValueGenerator= new Random(); } [NotNull] public CharacterHealth Health { get { return _health; } set { _health = value; } } private CharacterHealth _health; public void AjustCriticalStrikeChances() { if (CriticalStrikeCounter <= 5) { CriticalStrikeCounter = 5; } } public int DetermineDefenseBonusForTurn() { TemporaryDefenseBonusValue = _randomValueGenerator.Next(10,20); return TemporaryDefenseBonusValue; } }} using JetBrains.Annotations;using UnityEngine;using UnityEngine.UI;namespace Assets.Scripts.CharactersUtil{ public class CharacterHealth { public int StartingHealth { get; set; } public int CurrentHealth { get; set; } public Slider HealthSlider { get; set; } public bool isDead; public Color MaxHealthColor = Color.green; public Color MinHealthColor = Color.red; private int _counter; private const int MaxHealth = 200; public Image Fill; private void Awake() { //HealthSlider = GameObject.GetComponent<Slider>(); _counter = MaxHealth; // just for testing purposes } // Use this for initialization public CharacterHealth(int sh) { StartingHealth = sh; CurrentHealth = StartingHealth; HealthSlider.wholeNumbers = true; HealthSlider.minValue = 0f; HealthSlider.maxValue = StartingHealth; HealthSlider.value = CurrentHealth; } public void Start() { HealthSlider.wholeNumbers = true; HealthSlider.minValue = 0f; HealthSlider.maxValue = MaxHealth; HealthSlider.value = MaxHealth; } public void TakeDamageFromCharacter([NotNull] BaseCharacterClass baseCharacter) { CurrentHealth -= (int)baseCharacter.BaseStats.Power; HealthSlider.value = CurrentHealth; UpdateHealthBar (); if (CurrentHealth <= 0) isDead = true; } public void TakeDamageFromCharacter(int characterStrength) { CurrentHealth -= characterStrength; HealthSlider.value = CurrentHealth; UpdateHealthBar (); if (CurrentHealth <= 0) isDead = true; } public void RestoreHealth(BaseCharacterClass bs) { CurrentHealth += (int)bs.BaseStats.Power; HealthSlider.value = CurrentHealth; UpdateHealthBar (); } public void RestoreHealth(int characterStrength) { CurrentHealth += characterStrength; HealthSlider.value = CurrentHealth; UpdateHealthBar (); } public void UpdateHealthBar() { Fill.color = Color.Lerp(MinHealthColor, MaxHealthColor, (float)CurrentHealth / MaxHealth); } }}",How to instantiate MonoBehaviour objects in a unit test on Unity Game Engine platform
Why should I check for Null before I invoke the cosume event?," What is the difference between these two code samples for invoking an event?Sample 1 Sample 2 When should I use each method to invoke a custom event? And why sometimes I get a NullReferenceException when I try to invoke event using DataChanged.Invoke(this), but when I convert the event invocation to the method in Sample 1 the DataChanged never becomes null anymore? <code>  public void OnDataChanged(){ if (DataChanged != null) { DataChanged(this); }} DataChanged.Invoke(this);",Why should I check for null before I invoke the custom event?
"How do I ""Pause"" a C# console application when the user presses escape?"," I am creating a C# console application that will be performing an infinite process. How can I get the application to ""pause"" when the user presses the escape key? Once the user presses the escape key I want the option to either exit the application or continue the loop right where it left off. I don't want any discontinuity in the process. If I press Esc at step 100 I should be able to pick right back up at step 101. Here is my method so far: Is there any way to check for the user input key in a separate thread then pause the infinite loop when the other thread sees an Esc key-press?  <code>  // Runs the infinite loop application public static void runLoop() { int count = 0; while (Console.ReadKey().Key!= ConsoleKey.Escape) { WriteToConsole(""Doing stuff.... Loop#"" + count.ToString()); for (int step = 0; step <= int.MaxValue; step++ ) { WriteToConsole(""Performing step #"" + step.ToString()); if (step == int.MaxValue) { step = 0; // Re-set the loop counter } } count++; } WriteToConsole(""Do you want to exit? y/n""); exitApplication(ReadFromConsole()); }","How do I ""Pause"" a console application when the user presses escape?"
"Understanding RXJS's Flatmap, FlatmapLatest in C# terms"," I'm predominantly C# developer expanding my horizon in JavaScript and recently stumbled upon a library called RxJS.I would like to understand how Map, Flatmap, FlatmapLatest relate and are there any equivalents in C#.Net ? <code> ","Understanding RxJS's Flatmap, FlatmapLatest in C# terms"
How to execute LINQ and/or foreach in Immediate Window?," Immediate Window is fantastically useful tools when probing the current state during debugging process. I learned that by using the question mark, one can do a bit more in there as shown in this post.However, I still don't know how to execute LINQ queries there (including lambda expressions). I've also failed to execute a foreach statement.When executing the following statements: I'm getting these errors: Expression cannot contain lambda expressions Invalid expression term 'foreach'(How) can I execute these in the Immediate Window?There's also a tool in VS Gallery but it's said that it only works for VS05 and VS08, which most programmers have left behind looong time ago. I'm looking for something applicable to VS13 and/or VS15. <code>  ?(things.Select(thing=>thing.Id);)?(foreach(var thing in things);)",How to execute LINQ and/or foreach in Immediate Window in VS 2013?
Linq alternative to retrieving Lookup values by key," I am working on the following code to find a ""description"" based on a search phrase that the user will specify. Think of the Keys as important phrases and the Values as a description on where to go to find that phrase.Think of it as a store locator for example (best analogy I can think up). If you search ""Target"" (key), you'll get tons of cities (value) and some may have the same name. So there can be multiple Targets in the same city.A Dictionary will obviously not work, because I'll either have duplicate store names, or possibly duplicate city names. Which brings me to my actual situation:Basically, I'm starting from a List<KeyValuePair<string, string>> to allow for duplicates in both directions, then converting that to a Lookup<string, string> which I assumed would be less confusing than it is turning out to be. The above is simply fake test information, but I feel like there must be a cleaner way to get the results from the Lookup especially since it appears to be very Linq-friendly. Unfortunately, I am quite unfamiliar with Linq, and the syntax of Linq itself doesn't seem to lend itself to be very beginner-friendly. I get the results in this code (hard coded search term just for testing purposes): I don't have issues with the above code, but my question is: Is there a way to use Linq to achieve what I am trying to accomplish? I feel like what I have is not the best way this could be done...It may be worth noting that a partial searchTerm must also be able to find results where it occurs in the key (hence contains). Existing answers weren't quite able to answer my specific questions. I was not able to find one to help me get values by a partial key search. <code>  List<KeyValuePair<string, string>> kvpList = new List<KeyValuePair<string, string>>();Lookup<string, string> collection;kvpList.Add(new KeyValuePair<string, string>(""K1"", ""R1""));kvpList.Add(new KeyValuePair<string, string>(""K1"", ""R1""));kvpList.Add(new KeyValuePair<string, string>(""K1"", ""R2""));kvpList.Add(new KeyValuePair<string, string>(""K2"", ""R1""));kvpList.Add(new KeyValuePair<string, string>(""K2"", ""R2""));kvpList.Add(new KeyValuePair<string, string>(""K2"", ""R3""));kvpList.Add(new KeyValuePair<string, string>(""K2"", ""R1""));collection = (Lookup<string,string>)kvpList.ToLookup(k => k.Key, k => k.Value); string searchTerm = ""K2"";List<string> uniqueResults = new List<string>();foreach (var item in collection){ if (item.Key.Contains(searchTerm)) { foreach (var value in item) { if (!uniqueResults.Contains(value)) { uniqueResults.Add(value); Console.WriteLine(""Added: "" + value); } else { Console.WriteLine(""Skipped duplicate: "" + value); } } }} ",Linq alternative to retrieving Lookup values by key (or partial key)
get cpu and ram usage," I need to get the ram memory and CPU usage during execution of a process (the process can run sometimes and over 30 minutes). I am able to get the free RAM but the CPU usage it's not correct, compared with the value from task manager. Am I doing something wrong? Here is my code: But when I run the program, here is what it's printed to the console, compared with values from task manager:What am I doing wrong? <code>  class Program{ static List<float> AvailableCPU = new List<float>(); static List<float> AvailableRAM = new List<float>(); protected static PerformanceCounter cpuCounter; protected static PerformanceCounter ramCounter; static void Main(string[] args) { cpuCounter = new PerformanceCounter(); cpuCounter.CategoryName = ""Processor""; cpuCounter.CounterName = ""% Processor Time""; cpuCounter.InstanceName = ""_Total""; ramCounter = new PerformanceCounter(""Memory"", ""Available MBytes""); try { System.Timers.Timer t = new System.Timers.Timer(1200); t.Elapsed += new ElapsedEventHandler(TimerElapsed); t.Start(); Thread.Sleep(10000); } catch (Exception e) { Console.WriteLine(""catched exception""); } Console.ReadLine(); } public static void TimerElapsed(object source, ElapsedEventArgs e) { float cpu = cpuCounter.NextValue(); float ram = ramCounter.NextValue(); Console.WriteLine(string.Format(""CPU Value: {0}, ram value: {1}"", cpu, ram)); AvailableCPU.Add(cpu); AvailableRAM.Add(ram); }}",Get CPU and RAM usage
C# verbatim string with conditional-operator," I tried to use the conditional operator inside an interpolated string, but because it has a colon in it, the compiler thinks that after the colon comes a format string. How can I use this type of statement?The only thing that comes to my mind is something like this: <code>  $""test {foo ? ""foo is true"" : ""foo is false""}""; var fooString = foo ? ""foo is true"" : ""foo is false"";$""test {fooString}"";",C# interpolated string with conditional-operator
Detect if non DPI-aware application has been scaled," I'm trying to detect in a WinForms application if it has been launched in scaled/virtualized mode due to the OS having a high DPI. Currently, in a system running at 3840x2400 with 200% scaling, the application sees the resolution as 1920x1200, the DPI as 96, and the scale factor is 1. We are in the process of making the application DPI-aware, but until then, we need a ""quick fix"" that will allow us to detect if scaled. The reason for this is that it breaks a functionality in the application that takes a screenshot. We use the scaled dimensions in Graphics.CopyFromScreen, it takes a screenshot of the wrong size since it is expecting the non-scaled dimensions.I am aware of the DPI-awareness setting, but for the moment, we still want the application to be scaled, but be able to detect that we are scaled and get the non-scaled dimensions, if possible. <code> ",Detect if non DPI-aware application has been scaled/virtualized
Visual studio - when compiling WPF application language folders are copied to build folder," How can I cancel this option (I need only English).Is it some installation that should be removed? configuration?folders created are: de, en, es, fr, it, ja, ko, zh-Hans zh-HantWorking with Visual Studio 2015references: System.Windows.InteractivityMicrosoft.Expression.Interactions <code> ",When compiling WPF application language folders are copied to build folder
C#: Why does the following code compile without errors?," I was messing around with my C# project a little bit and I was surprised to see this code compiles: Flipping it the other way around, like Action<string> a = ref b => b = ""hello""; will give a syntactical error at 'ref'.Sure enough, copy-pasting the snippet into http://dotnetfiddle.net gives a compiler error: Have I encountered a bug in the compiler? (I'm using VS 2015 and C# 6.)EDIT: Just switched to the Roslyn compiler on .NET Fiddle, it still emits the same error. <code>  var a = new Action<string>(ref b => b = ""hello""); A ref or out argument must be an assignable variable",Why does the following code compile without errors?
Readonly fields becomes null when disposing," I've the following class. Now sometimes the lock statement is throwing an ArgumentNullException, and in that case I can then see in the debugger that disposelock object is really null. As I can see that disposing is false, I know that the method is triggered from Finalizer.But how can this happen ? It is defined as readonly and gets its value when the object is created.PS: I know that this isn't a good pattern, but its part of a given code, and I just can't explain why this becomes null <code>  public abstract class DisposableMarshalByRefObject : MarshalByRefObject, IDisposable{ private readonly object disposeLock = new object(); /// </summary> ~DisposableMarshalByRefObject() { Dispose(false); } /// <summary> /// Performs application-defined tasks associated with freeing, releasing, or resetting unmanaged resources. /// </summary> public void Dispose() { Dispose(true); GC.SuppressFinalize(this); } protected void Dispose(bool disposing) //disposing = false,=> finalizer { lock (disposeLock) //ArgumentNull Exception ! { .... } }} ",Readonly fields becomes null when disposing from finalizer
"Why is there a TypeDependencyAttribute(""System.SZArrayHelper"") for IList<T>, IEnumberable<T> and ICollection<T>?"," The comments provided in the source code for IList, IEnumerable and ICollection says Note that T[] : IList<T>, and we want to ensure that if you use IList<YourValueType>, we ensure a YourValueType[] can be used without jitting. Hence the TypeDependencyAttribute on SZArrayHelper. This is a special hack internally though - see VM\compile.cpp.Why does IList<T> contain a dependency on SZArrayHelper?. I understand that SZArrayHelper is a CLR wrapper around an array that implements the IList<T> interface but I do not get the full picture of why these two are tied together.And how does it ensure YourValueType[] can be used without jitting.? <code> ","Purpose of TypeDependencyAttribute(""System.SZArrayHelper"") for IList<T>, IEnumerable<T> and ICollection<T>?"
"Why is there a TypeDependencyAttribute(""System.SZArrayHelper"") for IList<T>, IEnumerable<T> and ICollection<T>?"," The comments provided in the source code for IList, IEnumerable and ICollection says Note that T[] : IList<T>, and we want to ensure that if you use IList<YourValueType>, we ensure a YourValueType[] can be used without jitting. Hence the TypeDependencyAttribute on SZArrayHelper. This is a special hack internally though - see VM\compile.cpp.Why does IList<T> contain a dependency on SZArrayHelper?. I understand that SZArrayHelper is a CLR wrapper around an array that implements the IList<T> interface but I do not get the full picture of why these two are tied together.And how does it ensure YourValueType[] can be used without jitting.? <code> ","Purpose of TypeDependencyAttribute(""System.SZArrayHelper"") for IList<T>, IEnumerable<T> and ICollection<T>?"
Stored Procedure not running correctly with dynamic sql text," For some reason my stored procedure is executed without any error from the code-behind in C# but it is not deleting anything at all that the stored procedure has written. I have all the correct parameters and everything. I ran the query from SQL Server with all the same parameters from the C# code and it works perfectly. I don't get why it works when I run from SQL Server but it doesn't work when I run it from my C# code in Visual Studio.Here is my C# code that is passing the data through to the stored procedure. Here is my stored procedure. It's executing with dynamic SQL text. Here is what the PRINT @SQLTEXT is running: When I actually go into SQL Server to run this query, it works perfectly. But why does it not work on when executed from the C# code. Any help? <code>  string reportType = ""PostClaim"";string GRNBRs = ""925','926','927"";string PUNBRs = ""100','100','100"";string beginningDates = ""20120401"";string endDates= ""20120430"";try{ conn = new SqlConnection(ConnectionInfo); conn.Open(); SqlDataAdapter da = new SqlDataAdapter(""RemoveReport"", conn); da.SelectCommand.CommandType = CommandType.StoredProcedure; da.SelectCommand.Parameters.AddWithValue(""@ReportType"", reportType); da.SelectCommand.Parameters.AddWithValue(""@GRNBR"", GRNBRs); da.SelectCommand.Parameters.AddWithValue(""@PUNBR"", PUNBRs); da.SelectCommand.Parameters.AddWithValue(""@DATE1"", beginningDates); da.SelectCommand.Parameters.AddWithValue(""@DATE2"", endDates); da.SelectCommand.CommandTimeout = 360;}catch (SqlException ex){ //something went wrong throw ex;}finally{ if (conn.State == ConnectionState.Open) conn.Close();} ALTER PROCEDURE [dbo].[RemoveReport] ( @ReportType NVARCHAR(20), @GRNBR VARCHAR(4000), @PUNBR VARCHAR(4000), @DATE1 DATETIME, @DATE2 DATETIME)ASDECLARE @SQLTEXT VARCHAR(4000)BEGINSET @SQLTEXT = 'DELETE FROM TestingTable WHERE Report='''+@ReportType+''' AND PUNBR IN ('''+@PUNBR+''') AND [Group] IN ('''+@GRNBR+''') AND StartedAt BETWEEN '''+CONVERT(VARCHAR(10),@DATE1,121)+''' AND '''+CONVERT(VARCHAR(10),@DATE2,121)+''''PRINT @SQLTEXT <---I'll print this out to show you what exactly it is executing.EXECUTE (@SQLTEXT)END DELETE FROM MonthlyReportScheduleWHERE Report='PostClaim' AND PUNBR IN ('100','100','100') AND [Group] IN ('925','926','927') AND StartedAt BETWEEN '2012-04-01' AND '2012-04-30'",Stored procedure not running correctly with dynamic sql text
is file readable (contains text rather is accessable )," i am working on a project that reads all files from local Hdd,i specify the extensions i would like to include in the search.all chosen file extentions are based on the fact that the file is of text content.so for my use i could specify which extensions to take into acount,such as .cs .html .htm .css .js etc'what if i want to add a feature that would let generic user to select extensions and let him choose from all available windows file extensions but to include in that list only those file in his system that are textual.for instance we know that exe, mp3. mpg, avi are not but he could have some other types of files (.extensions) that we did not take into account.is there a way to decide that based on system file property, if not what would be the way to filter only text content files? <code> ",is file readable (contains text rather is accessible )
Unique 4 digit random number in c#," I want to generate an unique 4 digit random number. This is the below code what I have tried:Code for generating random number The problem is I have received a random no with value 241 which is not a 4 digit number. Is there any problems with the code? <code>  //Generate RandomNopublic int GenerateRandomNo(){ int _min = 0000; int _max = 9999; Random _rdm = new Random(); return _rdm.Next(_min, _max);}",Unique 4 digit random number in C#
Why does this BigInteger value cause an overflow exception? C#," I am using BigInteger in C# in connection with the factorial function. The program has a lightning fast calculation of 5000!, but has an overflow error at 10000!. According to wolfram alpha, 10000! is approximately10000! = 2.8 x 10^35659From what I can tell from this post, a BigInteger is stored in an int[] array. If I interpret the int type correctly, it uses 4 bytes, meaning that 10000! uses about 4 x log10(2.8 x 10^35659) = 142636 bytes, where I use log10(n) (the log to base 10) as an approximation to the number of digits of n. This is only 143 MB, but I still get a stack overflow exception. Why does this happen? <code>  using System;using System.Numerics;class Program{ static void Main() { BigInteger hugeFactorial = Calculations.Factorial(5000); }}class Calculations{ public static BigInteger Factorial(int n) { if (n == 1) return n; else return n*Factorial(n - 1); }}",Why does this BigInteger value cause a stack overflow exception? C#
Why converting between string and float is wrong?," Please see my example below. <code>  float maxFloat = float.MaxValue;string s = maxFloat.ToString();float result = float.Parse(s); // same with Convert.ToSingle(s);bool mustEqual = (maxFloat == result);// It returns FALSE, why?",Why is converting between string and float wrong?
C# error class relationship between the same class," Have the class below, and try to look for records in the database returns error. Using C #, MVC 4, Entity Framework 4 and SQL Server 2012 database.Error Class DataBase FK <code>  Unable to determine the principal end of an association between the types 'FlexApp.Models.Model.Usuario' and 'FlexApp.Models.Model.Usuario'. The principal end of this association must be explicitly configured using either the relationship fluent API or data annotations. public class Usuario{ [Key] public int UsuarioID { get; set; } public string Nome { get; set; } public int UsuCad { get; set; } public int UsuAlt { get; set; } [ForeignKey(""UsuCad"")] public virtual Usuario UsuarioCad { get; set; } [ForeignKey(""UsuAlt"")] public virtual Usuario UsuarioAlt { get; set; }} alter table USUARIO add constraint USUARIO_fk01 foreign KEY(UsuCad) REFERENCES USUARIO(UsuarioID);alter table USUARIO add constraint USUARIO_fk02 foreign KEY(UsuAlt) REFERENCES USUARIO(UsuarioID);","Unable to determine the principal end of an association between the types - Entity Framework error, class relationship between the same class"
Flatstyle.System style on a button of a child form throws System.ObjectDisposedException on Close," System.ObjectDisposedException when the button style is set to FlatStyle.System in WinForms applicationI've a child form which shows up on clicking a button in parent. And the code goes like below. The child form has in turn a button that closes itself. Steps to get exception:In debug mode, put a break point on Me.Close() Then click close button of child. On hit of break point open notepad and Comeback to solution then continueException: Does anyone has any idea, this is explicitly coming when button style set to FlatStyle.System  <code>  Public Class Parent Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load End Sub Private Sub btnOpenChild_Click(sender As Object, e As EventArgs) Handles btnOpenChild.Click Child.Show() End SubEnd Class Public Class Child Private Sub btnCloseMe_Click(sender As Object, e As EventArgs) Handles btnCloseMe.Click Me.Close() End SubEnd Class System.ObjectDisposedException was unhandled HResult=-2146232798 Message=Cannot access a disposed object.Object name: 'Button'. Source=System.Windows.Forms ObjectName=Button StackTrace: at System.Windows.Forms.Control.CreateHandle() at System.Windows.Forms.Control.get_Handle() at System.Windows.Forms.Control.PointToScreen(Point p) at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent) at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks) at System.Windows.Forms.Control.WndProc(Message& m) at System.Windows.Forms.ButtonBase.WndProc(Message& m) at System.Windows.Forms.Button.WndProc(Message& m) at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m) at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m) at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam) at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG& msg) at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(IntPtr dwComponentID, Int32 reason, Int32 pvLoopData) at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context) at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context) at System.Windows.Forms.Application.Run(ApplicationContext context) at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.OnRun() at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.DoApplicationModel() at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Run(String[] commandLine) at WindowsApplication2.My.MyApplication.Main(String[] Args) in 17d14f5c-a337-4978-8281-53493378c1071.vb:line 81 at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args) at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args) at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly() at System.Threading.ThreadHelper.ThreadStart_Context(Object state) at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state) at System.Threading.ThreadHelper.ThreadStart() InnerException: ",System.ObjectDisposedException when the button style is set to FlatStyle.System in WinForms application
C# Add Day To DateTime At End Of Month," I'm creating a DateTime by adding a day to the current date (shown below). I need the specific time set as shown below as well. This code below works great until I get to the end of the month where I'm trying to add a day.Can you help me change my code so that it works when the current day is at the end of a month and I'm trying to add a day so that it switches to December 1st instead of November 31st (for example) and throws an error.  <code>  var ldUserEndTime = new DateTime(dateNow.Year, dateNow.Month, dateNow.Day + 1, 00, 45, 00);",How to add day to DateTime at end of month?
C# Const Objects," I've written the class SomeObject and I want to define a const instance of this object to keep/reuse in my TestCases. How should I rewrite the code below to achieve this behavior? I get the following error message: A const field of a reference type other than string can only be initialized with null. <code>  [TestFixture]public class SomeObjectTests{ private const SomeObject item0 = new SomeObject(0.0); // doesn't work [TestCase(item0, ExpectedResult = 0.0)] public double TestSomeObjectValue(SomeObject so) { return so.Value; } [TestCase(item0, ExpectedResult = ""0.0"")] public string TestSomeObjectValueString(SomeObject so) { return so.ValueString; }}",NUnit 3.0 TestCase const custom object arguments
NUnit 3.0 TestCase Custom Object Arguments," I've written the class SomeObject and I want to define a const instance of this object to keep/reuse in my TestCases. How should I rewrite the code below to achieve this behavior? I get the following error message: A const field of a reference type other than string can only be initialized with null. <code>  [TestFixture]public class SomeObjectTests{ private const SomeObject item0 = new SomeObject(0.0); // doesn't work [TestCase(item0, ExpectedResult = 0.0)] public double TestSomeObjectValue(SomeObject so) { return so.Value; } [TestCase(item0, ExpectedResult = ""0.0"")] public string TestSomeObjectValueString(SomeObject so) { return so.ValueString; }}",NUnit 3.0 TestCase const custom object arguments
NUnit 3.0 TestCase Const Custom Object Arguments," I've written the class SomeObject and I want to define a const instance of this object to keep/reuse in my TestCases. How should I rewrite the code below to achieve this behavior? I get the following error message: A const field of a reference type other than string can only be initialized with null. <code>  [TestFixture]public class SomeObjectTests{ private const SomeObject item0 = new SomeObject(0.0); // doesn't work [TestCase(item0, ExpectedResult = 0.0)] public double TestSomeObjectValue(SomeObject so) { return so.Value; } [TestCase(item0, ExpectedResult = ""0.0"")] public string TestSomeObjectValueString(SomeObject so) { return so.ValueString; }}",NUnit 3.0 TestCase const custom object arguments
c# lambda variable initialization, Today for the first time I seen something similar to this: using lambda to initialize a variable. Why doing it like this and what are the benefits? <code>  private string m => string.Empty;,C# lambda variable initialization
About async/await's Bad Effects," According to this link: When you are awaiting on a method with await keyword, compiler generates bunch of code in behalf of you. One of the purposes of this action is to handle synchronization with the UI thread. The key component of this feature is the SynchronizationContext.Current which gets the synchronization context for the current thread. SynchronizationContext.Current is populated depending on the environment you are in. The GetAwaiter method of Task looks up for SynchronizationContext.Current. If current synchronization context is not null, the continuation that gets passed to that awaiter will get posted back to that synchronization context. When consuming a method, which uses the new asynchronous language features, in a blocking fashion, you will end up with a deadlock if you have an available SynchronizationContext. When you are consuming such methods in a blocking fashion (waiting on the Task with Wait method or taking the result directly from the Result property of the Task), you will block the main thread at the same time. When eventually the Task completes inside that method in the threadpool, it is going to invoke the continuation to post back to the main thread because SynchronizationContext.Current is available and captured. But there is a problem here: the UI thread is blocked and you have a deadlock! I have trouble understanding the bolded part of the statement above, but when I test the code above, it deadlocks as expected.But I still can't understand why the UI thread is blocked?In this case, what is the available SynchronizationContext? Is it the UI thread? <code>  public class HomeController : Controller { public ViewResult CarsSync() { SampleAPIClient client = new SampleAPIClient(); var cars = client.GetCarsInAWrongWayAsync().Result; return View(""Index"", model: cars); } } public class SampleAPIClient { private const string ApiUri = ""http://localhost:17257/api/cars""; public async Task<IEnumerable<Car>> GetCarsInAWrongWayAsync() { using (var client = new HttpClient()) { var response = await client.GetAsync(ApiUri); // Not the best way to handle it but will do the work for demo purposes response.EnsureSuccessStatusCode(); return await response.Content.ReadAsAsync<IEnumerable<Car>>(); } } }",async/await deadlocking when using a SynchronizationContext
"Where is == operator defined in Class ""object ""?"," I searched the source code of FCL, and I got confused that string.Equals() uses Object.ReferenceEquals(), and Object.ReferenceEquals() uses == operator to jugde. And then I can't find how the == operator is defined.So where is the original operator defined? <code> ","Where is == operator defined in Class ""object""?"
If all elements in bool array = true?," I'm having difficulty using the array.All<> function. I'm wondering how I can achieve if (dead.All(dead[] == true))? <code>  private bool noBricksLeft() { bool[] dead = new bool[brick.Length]; for (int i = 0; i < brick.GetLength(0); i++) { if (brickLocation[i, 2] == 0) dead[i] = true; else continue; // move onto the next brick } if (dead.All(dead[] == true)) // IF ALL OF THE ELEMENTS ARE TRUE return true; else return false;}",If all elements in bool array are true?
work around passing parameter to static class," I have a static class with a static constructor. I need to pass a parameter somehow to this static class but I'm not sure how the best way is.What would you recommend? <code>  public static class MyClass { static MyClass() { DoStuff(""HardCodedParameter"") }}",How to pass parameter to static class constructor?
How to pass parameter to static class," I have a static class with a static constructor. I need to pass a parameter somehow to this static class but I'm not sure how the best way is.What would you recommend? <code>  public static class MyClass { static MyClass() { DoStuff(""HardCodedParameter"") }}",How to pass parameter to static class constructor?
Queue of async tasks with throttling, I need to implement a library to request vk.com API. The problem is that API supports only 3 requests per second. I would like to have API asynchronous. Important: API should support safe accessing from multiple threads.My idea is implement some class called throttler which allow no more than 3 request/second and delay other request.The interface is next: The usage is like How to implement throttler?Currently I implemented it as queue which is processed by background thread. This is shorten code of background thread loop which process the queue: Is it possible to implement this without background thread? <code>  public interface IThrottler : IDisposable{ Task<TResult> Throttle<TResult>(Func<Task<TResult>> task);} var audio = await throttler.Throttle(() => api.MyAudio());var messages = await throttler.Throttle(() => api.ReadMessages());var audioLyrics = await throttler.Throttle(() => api.AudioLyrics(audioId));/// Here should be delay because 3 requests executedvar photo = await throttler.Throttle(() => api.MyPhoto()); public Task<TResult> Throttle<TResult>(Func<Task<TResult>> task){ /// TaskRequest has method Run() to run task /// TaskRequest uses TaskCompletionSource to provide new task /// which is resolved when queue processed til this element. var request = new TaskRequest<TResult>(task); requestQueue.Enqueue(request); return request.ResultTask;} private void ProcessQueue(object state){ while (true) { IRequest request; while (requestQueue.TryDequeue(out request)) { /// Delay method calculates actual delay value and calls Thread.Sleep() Delay(); request.Run(); } }},Queue of async tasks with throttling which supports muti-threading
Using C# IndexOf with substring," Suppose you have a string (""haystack""), and a substring you want to search for (""needle""): I'm looking for a way to find the index or substring after the substring being sought.Calling IndexOf() returns the start position of the needle, such that index = 9 in this case: My initial thought was to use LastIndexOf(), but that returns the start index of the last occurrence of the needle in the haystack.As is answered in this similar question (and probably others), if you wanted to locate the character immediately following needle, it is required to increment index by the length of the needle like this: Is there a method (existing, or perhaps easy to extend) aside from typing index + needle.Length every time that allows you to determine the ending index of a substring?  <code>  string haystack = ""D0B11234 AM21ANP AM23AN1""; string needle = ""AM21AN""; int index = haystack.IndexOf(needle); int index = haystack.IndexOf(needle);int indexAfterNeedle = index + needle.Length;",Finding the index after a substring
Using LinQ leftjoin with multiple conditions and Subquery," I want to left join two tables and sum one field so I made this query: but when I debug I got this message : The type 'Reference.Inventory.SearchDetailRequester' appears in two structurally incompatible initializations within a single LINQ to Entities query. A type can be initialized in two places in the same query, but only if the same properties are set in both places and those properties are set in the same order.Is there anyone can help? <code>  IQueryable<Reference.Inventory.SearchDetailRequester> _qRequester = from a in dbErp.EPROC_TR_ER_DETAIL join b in dbErp.EPROC_TR_INVENTORY on new Reference.Inventory.SearchDetailRequester { ID_REQUEST = a.ID_REQUEST , ID_KATALOG = a.ID_KATALOG} equals new Reference.Inventory.SearchDetailRequester { ID_REQUEST = b.ID_REQUEST, ID_KATALOG = b.ID_KATALOG } into inv_join from c in inv_join.DefaultIfEmpty() where a.ID_REQUEST == ID_REQUEST && a.APROVE_BY_DS == 1 && a.APROVE_BY_GS == 1 select new Reference.Inventory.SearchDetailRequester { ID_KATALOG = a.ID_KATALOG, TYPE_OF_GGS = a.TYPE_OF_GGS, TRANSACTION_TYPE = ""OUT"", DATE = c.DATE ?? """", QTY = -1 * c.QTY ?? a.QTY, ID_INVENTORY = c.ID_INVENTORY, QTY_AVAILABLE = ((from d in dbErp.EPROC_TR_INVENTORY where d.ID_KATALOG == a.ID_KATALOG group d by new { d.ID_KATALOG } into e select new { qty_ava = (System.Int32)e.Sum(p => p.QTY ?? 0) }).FirstOrDefault().qty_ava) };",Using LINQ left join with multiple conditions and subquery
C# Pattern - Conditionally block method override," I have an application where the parent object has a method to perform validations and every child overrides the method to perform extra validations. Something like: I added a new ""IsDisabled"" property that when true the method will not perform any validations. I also want that for every child, if the ""IsDisabled"" property is true, the extra verifications aren't performed. What is the better pattern to use here? <code>  class Parent { virtual void DoValidations (Delegate addErrorMessage) { //do some validations }}class Child : Parent { override void DoValidations (Delegate addErrorMessage) { base.DoValidations(addErrorMessage); //the parent method is always called //do some extra validations }} class Parent { boolean IsDisabled; virtual void DoValidations (Delegate addErrorMessage) { if (IsDisabled) return; //do some validations }}",Conditionally block method override
Cant get icon from a file location in c# WPF," I have a button and an image named as image1 in my wpf app. I want add image source of the image1 from a file icon of a location or file path. Here is my code: And the error is saying Cannot implicitly convert type 'System.Drawing.Bitmap' to 'System.Windows.Media.ImageSource'How to solve this problem? <code>  using System.Windows;using System.Windows.Media.Imaging;using System.IO;using System.Drawing;namespace WpfApplication2{ public partial class MainWindow : Window { public MainWindow() { InitializeComponent(); } private void Button_Click_1(object sender, RoutedEventArgs e) { Icon ico = System.Drawing.Icon.ExtractAssociatedIcon(@""C:\WINDOWS\system32\notepad.exe""); image1.Source = ico.ToBitmap(); } }}",How to convert icon (Bitmap) to ImageSource?
C# MVC Post Model and additional data to controller," I am working with a custom workflow solution that I am creating. I would like to create a postback that has the model, and two integer values that represent the action and step that I have completed. I don't want to add them to the model because they are only used in this one place. The signature for this postback would be something like this. I would really like to do this through JS because that is currently how I am getting StepActionId and StepId. Is there a way to package up the model to send through JS? The model comes back as null in the controller. I have also tried the following code with the same result. <code>  [HttpPost]public void ProcessWorkflowAction(EditScreenModelValidation model, int stepActionId, int stepNumber){ //Some work on model and actions} var modelObj = CreateModelData(); var postObj = JSON.stringify(modelObj); $.ajax({ type: ""POST"", traditional: true, dataType: ""json"", url: ""url"", data: { model: modelObj, stepActionId: stepId, stepNumber: 3 } cache: false, complete: function (data) { }});CreateModelData = function () { var modelObj = {}; var modelArray = $('#frm').serializeArray() $.each(modelArray, function (index, value) { assign(modelObj, value.name, value.value); }) return modelObj;};function assign(obj, prop, value) { if (prop != undefined) { if (typeof prop === ""string"") prop = prop.split("".""); if (prop.length > 1) { var e = prop.shift(); assign(obj[e] = Object.prototype.toString.call(obj[e]) === ""[object Object]"" ? obj[e] : {}, prop, value); } else obj[prop[0]] = value; }} $.ajax({ type: ""POST"", traditional: true, dataType: ""json"", url: ""url"", data: { model: $('#frm').serializeArray(), stepActionId: stepId, stepNumber: 3 } cache: false, complete: function (data) { }});",C# MVC Post Model and additional data to controller from js
Is IL ldstr replaced with constant reference to the string.Intern during JIT/AOT compilation?," Say I have a code that needs to be optimized but easy to debug at the same time.I would thus assign a string to every value I use.Does the string inflict a major performance hit or is it turned into a constant reference obtained from string.Intern during JIT/AOT compilation, thus turning into a single simple instruction ?Example:In IL it would be ldstr ""gazilion lines"".Is it during JIT/AOT compilation turned into something like ldsflda string.InternCache.ID_0000647516166and const string ID_0000647516166 = ""gazilion lines"";is added to string.InternCache ?Yes, I could theoretically look into https://github.com/mono/mono but I have no idea how to find it.Yes, I am mixing CIL, C# and whatever CIL is compiled into, but you get the idea.Is ldstr guaranteed to be O(1)?Yes it's ""implementation detail"" of the CLR but it would make sense if it was optimized this way. <code> ",Is CIL ldstr replaced with constant reference to the string.Intern during JIT/AOT compilation?
"Azure AD - AcquireToken(""AppId"", [AppClientIdCreds]) throwing: ""Application 'AppId' is not assigned to a role for the application 'AppId'."""," I have an MVC Web Application (WebAPI + Angular) deployed to Azure as a Web App (not API App) that is setup to be secured using Settings -> Authentication / Authorization -> AAD -> Express. This created an AD Application with the same name as the Web App, and as a normal web user (in the directory, using OAuth) this works as expected.But I also have external automation that needs to call the WebAPI controllers directly, so I need to programmatically get a Bearer token to pass along with those requests. This all works OK when ""USER ASSIGNMENT REQUIRED TO ACCESS APP"" == NO. But this won't suffice because everyone in the Directory shouldn't have access to this app. Flipping that switch results in the error: Application 'AppId' is not assigned to a role for the application 'AppId'.The code being used: How can I add a role assignment for an Application? (as opposed to for a user)I tried utilizing the 'permissions to other applications' section, but an app cannot be added to itself. To see if this would solve the problem from another app, I went ahead and created one and was able to add the App & set Delegated Permissions to 'Access [App Name]'. But just as before, this only works if user assignment is not required to access the app. Afterwards AcquireToken() throws the same exception. It seems this issue could be solved by decoupling our API from the Angular app, hosting the API as an API App (with a Gateway), but that's not an option at the moment. Also this article says this new Auth feature ""replaces the App Service gateway for most applications"" and this blog post announcing the feature in November says ""We recommend web and mobile applications use this feature instead of the App Service gateway going forward"" so I wonder if this just hasn't made it into the UI & perhaps it's possible to add app role assignments via the app manifest (tried, failed), graph/service-mgmt api, powershell, etc.  <code>  var aadLoginUri = ""http://login.microsoftonline.com/{0}""; var tenantId = ""[xxx].onmicrosoft.com""; var authority = String.Format(CultureInfo.InvariantCulture, aadLoginUri, tenantId); var clientId = ConfigurationManager.AppSettings[""ClientId""]; var clientSecret = ConfigurationManager.AppSettings[""ClientSecret""]; var authContext = new AuthenticationContext(authority); ClientCredential clientCredential = new ClientCredential(clientId, clientSecret); AuthenticationResult authResult = authContext.AcquireToken(clientId, clientCredential);",Azure AD Application - Require Role Assignment + Add a role assignment for an Application?
"Azure AD - AcquireToken() throwing: ""Application 'AppId' is not assigned to a role for the application 'AppId'."""," I have an MVC Web Application (WebAPI + Angular) deployed to Azure as a Web App (not API App) that is setup to be secured using Settings -> Authentication / Authorization -> AAD -> Express. This created an AD Application with the same name as the Web App, and as a normal web user (in the directory, using OAuth) this works as expected.But I also have external automation that needs to call the WebAPI controllers directly, so I need to programmatically get a Bearer token to pass along with those requests. This all works OK when ""USER ASSIGNMENT REQUIRED TO ACCESS APP"" == NO. But this won't suffice because everyone in the Directory shouldn't have access to this app. Flipping that switch results in the error: Application 'AppId' is not assigned to a role for the application 'AppId'.The code being used: How can I add a role assignment for an Application? (as opposed to for a user)I tried utilizing the 'permissions to other applications' section, but an app cannot be added to itself. To see if this would solve the problem from another app, I went ahead and created one and was able to add the App & set Delegated Permissions to 'Access [App Name]'. But just as before, this only works if user assignment is not required to access the app. Afterwards AcquireToken() throws the same exception. It seems this issue could be solved by decoupling our API from the Angular app, hosting the API as an API App (with a Gateway), but that's not an option at the moment. Also this article says this new Auth feature ""replaces the App Service gateway for most applications"" and this blog post announcing the feature in November says ""We recommend web and mobile applications use this feature instead of the App Service gateway going forward"" so I wonder if this just hasn't made it into the UI & perhaps it's possible to add app role assignments via the app manifest (tried, failed), graph/service-mgmt api, powershell, etc.  <code>  var aadLoginUri = ""http://login.microsoftonline.com/{0}""; var tenantId = ""[xxx].onmicrosoft.com""; var authority = String.Format(CultureInfo.InvariantCulture, aadLoginUri, tenantId); var clientId = ConfigurationManager.AppSettings[""ClientId""]; var clientSecret = ConfigurationManager.AppSettings[""ClientSecret""]; var authContext = new AuthenticationContext(authority); ClientCredential clientCredential = new ClientCredential(clientId, clientSecret); AuthenticationResult authResult = authContext.AcquireToken(clientId, clientCredential);",Azure AD Application - Require Role Assignment + Add a role assignment for an Application?
C# Define own keywords and meanings," Is it possible to define your keywords in C#?I mean something like where important would be the new keyword. It would mean something like, for example, that if the type is null when compiling an error occurrs. So the example would produce an error. An example with no error would be  <code>  public important Form newform; public important Form newform = form1;",Define own keywords and meanings
Unity 5.2.2 changing Visual Studio back to the Mono Develop, Is there any way to change default script editor in unity to MonoDevelop? Using Visual Studio is very complicated and slow. <code> ,Unity 5.2.2 changing Visual Studio back to MonoDevelop
Show Resharper warning in the Error list window," I am trying to show ReSharper warnings inside of the Visual Studio Error list window, but it seems that only errors are shown inside of the window. Is there a way to show ReSharper warnings inside of the Error list window in vanilla ReSharper?Example: This code generates two warnings:A visual studio warning: CS0642 Possible mistaken empty statementAnd a resharper warning: Similar expression comparisonBut the Error list window just shows the Visual Studio one.Notes: I am using Microsoft Visual Studio Community 2015 - Update 1 and ReSharper 10.0.2.I know that I can change the inspection severity to error but that is not an option in my case. <code>  if (1 == 1) ;",Show ReSharper warnings in the Error list window
Json can't deserialize 'double'?," I get an exception when I try to deserialize to an object from a JSON string.Input string '46.605' is not a valid integer. Path 'LatitudeCenter'It's really weird because JsonConvert tries to deserialize an attribute as an integer but it actually is a double and not an integer.I already checked in my Web API project. The attribute in my class is a double and same in web project.The code I use in my web asp project: Here is my class: My JSON content: <code>  using (var client = new HttpClient()){ client.BaseAddress = new Uri(""myWebApiHostedUrl""); client.DefaultRequestHeaders.Accept.Clear(); client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue(""application/json"")); // Get the response HttpResponseMessage response = await client.GetAsync(""api/NewMap/?SouthLatitude=46.600&WestLongitude=7.085&NorthLatitude=46.610&EastLongitude=7.095&Width=900&Height=900&isVoxelMap=true""); string jsonData = response.Content.ReadAsStringAsync().Result; //Exception here NewMap dataMewMap = JsonConvert.DeserializeObject<NewMap>(jsonData, new JsonSerializerSettings() { Culture = CultureInfo.InvariantCulture,FloatParseHandling= FloatParseHandling.Double });} public class NewMap{ // ... public double LatitudeCenter { get; set; } public double LongitudeCenter { get; set; } // ...} { // ... ""LatitudeCenter"":46.605, ""LongitudeCenter"":7.09, ""SouthLatitude"":46.6, ""ImageBingUrl"":null, ""PercentEnvironement_Plain"":0, // ...}",JsonConvert throws a 'not a valid integer' exception when deserializing to a double
x509 Certificates on Azure," I'm integrating my app with Xero which requires two certificates. I uploaded them to Azure with help from this article, but I'm still unable to connect to the Xero API. I'm hoping someone has experience integrating a Xero Partner Application with an Azure Web App.I've uploaded two pfx files; one is a self-signed certificate and the other is the partner certificate issued by Xero. The latter pfx file contains two certificates; an Entrust Commercial Private Sub CA1 (whatever than means) and a unique Entrust Id certificate for my app.I'm using the following code to load the certificates by their unique thumbprint: This works fine locally, but on my azure web site I get a 403.7 error: I've also looked at the following references to try and resolve the issue:Xero Partner SSL configuration in Azure (Uses a cloud service and not a web app, so I couldn't follow the steps at the end)403 Forbidden when loading X509Certificate2 from a file (Thread posted on the Xero forums about the same issue, figured out that the resolution is only for once again; cloud services)Xero partner connections and Azure Websites (Posted solution suggests using a VM)What I haven't tried yet:Converting my web app to a cloud service; trying to avoid doing this however I'm not sure what steps are involved.Using a VM; I haven't found any detailed steps on how to do this but seems like a better option than above.Screenshot of the error: <code>  static X509Certificate2 GetCertificateFromStore(string thumbprint) { var store = new X509Store(StoreLocation.CurrentUser); try { thumbprint = Regex.Replace(thumbprint, @""[^\da-zA-z]"", string.Empty).ToUpper(); store.Open(OpenFlags.ReadOnly); var certCollection = store.Certificates; var currentCerts = certCollection.Find(X509FindType.FindByTimeValid, DateTime.Now, false); var signingCert = currentCerts.Find(X509FindType.FindByThumbprint, thumbprint, false); if (signingCert.Count == 0) { throw new Exception($""Could not find Xero SSL certificate. cert_name={thumbprint}""); } return signingCert[0]; } finally { store.Close(); } } The page you are attempting to access requires your browser to have a Secure Sockets Layer (SSL) client certificate that the Web server recognizes.",Connect Azure Website to Xero Partner Application
x509 Certificates on Azure Web App," I'm integrating my app with Xero which requires two certificates. I uploaded them to Azure with help from this article, but I'm still unable to connect to the Xero API. I'm hoping someone has experience integrating a Xero Partner Application with an Azure Web App.I've uploaded two pfx files; one is a self-signed certificate and the other is the partner certificate issued by Xero. The latter pfx file contains two certificates; an Entrust Commercial Private Sub CA1 (whatever than means) and a unique Entrust Id certificate for my app.I'm using the following code to load the certificates by their unique thumbprint: This works fine locally, but on my azure web site I get a 403.7 error: I've also looked at the following references to try and resolve the issue:Xero Partner SSL configuration in Azure (Uses a cloud service and not a web app, so I couldn't follow the steps at the end)403 Forbidden when loading X509Certificate2 from a file (Thread posted on the Xero forums about the same issue, figured out that the resolution is only for once again; cloud services)Xero partner connections and Azure Websites (Posted solution suggests using a VM)What I haven't tried yet:Converting my web app to a cloud service; trying to avoid doing this however I'm not sure what steps are involved.Using a VM; I haven't found any detailed steps on how to do this but seems like a better option than above.Screenshot of the error: <code>  static X509Certificate2 GetCertificateFromStore(string thumbprint) { var store = new X509Store(StoreLocation.CurrentUser); try { thumbprint = Regex.Replace(thumbprint, @""[^\da-zA-z]"", string.Empty).ToUpper(); store.Open(OpenFlags.ReadOnly); var certCollection = store.Certificates; var currentCerts = certCollection.Find(X509FindType.FindByTimeValid, DateTime.Now, false); var signingCert = currentCerts.Find(X509FindType.FindByThumbprint, thumbprint, false); if (signingCert.Count == 0) { throw new Exception($""Could not find Xero SSL certificate. cert_name={thumbprint}""); } return signingCert[0]; } finally { store.Close(); } } The page you are attempting to access requires your browser to have a Secure Sockets Layer (SSL) client certificate that the Web server recognizes.",Connect Azure Website to Xero Partner Application
deserialize json into a c# classes," I am trying to make a UWP app using the RIOT API for League of Legends.When I go to their website to generate the JSON I get something like this: When I select this JSON and copy it into a new class using the special paste method in Visual Studio 2015 I get these classes with these properties: I created a new class called LOLFacade for connecting to the RiotAPI: This is the button event handler method: I hard coded the regionName and the user for testing purposes. This works with my username: ""gigaxel"".When I try another username for example like ""xenon94"" I get an exception: When I change the property name in Rootobject from gigaxel to xenon94 like this: When I recompile my code it works for the username xenon94 but it doesn't work for my username ""gigaxel"".I want it to work for any given username. <code>  {""gigaxel"": { ""id"": 36588106, ""name"": ""Gigaxel"", ""profileIconId"": 713, ""revisionDate"": 1451577643000, ""summonerLevel"": 30}} public class Rootobject{ public Gigaxel gigaxel { get; set; }}public class Gigaxel{ public int id { get; set; } public string name { get; set; } public int profileIconId { get; set; } public long revisionDate { get; set; } public int summonerLevel { get; set; }} public class LOLFacade{ private const string APIKey = ""secret :D""; public async static Task<Rootobject> ConnectToRiot(string user,string regionName) { var http = new HttpClient(); string riotURL = String.Format(""https://{0}.api.pvp.net/api/lol/{0}/v1.4/summoner/by-name/{1}?api_key={2}"",regionName, user, APIKey); var response = await http.GetAsync(riotURL); var result = await response.Content.ReadAsStringAsync(); return JsonConvert.DeserializeObject<Rootobject>(result); }} Rootobject root = new Rootobject { gigaxel = new Gigaxel() }; root = await LOLFacade.ConnectToRiot(""gigaxel"",""EUNE""); string name = root.gigaxel.name; int level = root.gigaxel.summonerLevel; InfoTextBlock.Text = name + "" is level "" + level; Object reference not set to an instance of an object. public class Rootobject{ public Gigaxel xenon94 { get; set; }}",Deserialize json into c# classes
Setting Custom GroupBox BackColor to Transparent C#," I'm using WinForms. In my form I have a GroupBox. This is a custom group box. I wanted a transparent background for the groupbox. I'm having issues creating a transparent background for the groupbox The problem with this code is i keep on getting an error when i set the group box backcolor to transparent. Error: Control does not support transparent background colors. g.Clear(BackColor = Color.Transparent); (This is the line that is giving me the problem) g.Clear(groupBox1.BackColor = Color.Transparent);If i do this i get: This example consists of a Panel with a dice image inside the panel, and the custom Groupbox. <code>  private void DrawGroupBox(GroupBox box, Graphics g, Color textColor, Color borderColor) { if (box != null) { Brush textBrush = new SolidBrush(textColor); Brush borderBrush = new SolidBrush(borderColor); Pen borderPen = new Pen(borderBrush); SizeF strSize = g.MeasureString(box.Text, box.Font); Rectangle rect = new Rectangle(box.ClientRectangle.X, box.ClientRectangle.Y + (int)(strSize.Height / 2), box.ClientRectangle.Width - 1, box.ClientRectangle.Height - (int)(strSize.Height / 2) - 1); // Clear text and border g.Clear(BackColor = Color.Transparent); // Draw text g.DrawString(box.Text, box.Font, textBrush, box.Padding.Left, 0); // Drawing Border //Left g.DrawLine(borderPen, rect.Location, new Point(rect.X, rect.Y + rect.Height)); //Right g.DrawLine(borderPen, new Point(rect.X + rect.Width, rect.Y), new Point(rect.X + rect.Width, rect.Y + rect.Height)); //Bottom g.DrawLine(borderPen, new Point(rect.X, rect.Y + rect.Height), new Point(rect.X + rect.Width, rect.Y + rect.Height)); //Top1 g.DrawLine(borderPen, new Point(rect.X, rect.Y), new Point(rect.X + box.Padding.Left, rect.Y)); //Top2 g.DrawLine(borderPen, new Point(rect.X + box.Padding.Left + (int)(strSize.Width), rect.Y), new Point(rect.X + rect.Width, rect.Y)); } } private void groupBox1_Paint(object sender, PaintEventArgs e) { GroupBox box = sender as GroupBox; DrawGroupBox(box, e.Graphics, Color.Red, Color.Blue); }","Custom GroupBox with custom TextColor, BorderColor and Transparent BackColor"
Custom GroupBox BackColor to Transparent C#," I'm using WinForms. In my form I have a GroupBox. This is a custom group box. I wanted a transparent background for the groupbox. I'm having issues creating a transparent background for the groupbox The problem with this code is i keep on getting an error when i set the group box backcolor to transparent. Error: Control does not support transparent background colors. g.Clear(BackColor = Color.Transparent); (This is the line that is giving me the problem) g.Clear(groupBox1.BackColor = Color.Transparent);If i do this i get: This example consists of a Panel with a dice image inside the panel, and the custom Groupbox. <code>  private void DrawGroupBox(GroupBox box, Graphics g, Color textColor, Color borderColor) { if (box != null) { Brush textBrush = new SolidBrush(textColor); Brush borderBrush = new SolidBrush(borderColor); Pen borderPen = new Pen(borderBrush); SizeF strSize = g.MeasureString(box.Text, box.Font); Rectangle rect = new Rectangle(box.ClientRectangle.X, box.ClientRectangle.Y + (int)(strSize.Height / 2), box.ClientRectangle.Width - 1, box.ClientRectangle.Height - (int)(strSize.Height / 2) - 1); // Clear text and border g.Clear(BackColor = Color.Transparent); // Draw text g.DrawString(box.Text, box.Font, textBrush, box.Padding.Left, 0); // Drawing Border //Left g.DrawLine(borderPen, rect.Location, new Point(rect.X, rect.Y + rect.Height)); //Right g.DrawLine(borderPen, new Point(rect.X + rect.Width, rect.Y), new Point(rect.X + rect.Width, rect.Y + rect.Height)); //Bottom g.DrawLine(borderPen, new Point(rect.X, rect.Y + rect.Height), new Point(rect.X + rect.Width, rect.Y + rect.Height)); //Top1 g.DrawLine(borderPen, new Point(rect.X, rect.Y), new Point(rect.X + box.Padding.Left, rect.Y)); //Top2 g.DrawLine(borderPen, new Point(rect.X + box.Padding.Left + (int)(strSize.Width), rect.Y), new Point(rect.X + rect.Width, rect.Y)); } } private void groupBox1_Paint(object sender, PaintEventArgs e) { GroupBox box = sender as GroupBox; DrawGroupBox(box, e.Graphics, Color.Red, Color.Blue); }","Custom GroupBox with custom TextColor, BorderColor and Transparent BackColor"
Custom GroupBox BackColor to Transparent," I'm using WinForms. In my form I have a GroupBox. This is a custom group box. I wanted a transparent background for the groupbox. I'm having issues creating a transparent background for the groupbox The problem with this code is i keep on getting an error when i set the group box backcolor to transparent. Error: Control does not support transparent background colors. g.Clear(BackColor = Color.Transparent); (This is the line that is giving me the problem) g.Clear(groupBox1.BackColor = Color.Transparent);If i do this i get: This example consists of a Panel with a dice image inside the panel, and the custom Groupbox. <code>  private void DrawGroupBox(GroupBox box, Graphics g, Color textColor, Color borderColor) { if (box != null) { Brush textBrush = new SolidBrush(textColor); Brush borderBrush = new SolidBrush(borderColor); Pen borderPen = new Pen(borderBrush); SizeF strSize = g.MeasureString(box.Text, box.Font); Rectangle rect = new Rectangle(box.ClientRectangle.X, box.ClientRectangle.Y + (int)(strSize.Height / 2), box.ClientRectangle.Width - 1, box.ClientRectangle.Height - (int)(strSize.Height / 2) - 1); // Clear text and border g.Clear(BackColor = Color.Transparent); // Draw text g.DrawString(box.Text, box.Font, textBrush, box.Padding.Left, 0); // Drawing Border //Left g.DrawLine(borderPen, rect.Location, new Point(rect.X, rect.Y + rect.Height)); //Right g.DrawLine(borderPen, new Point(rect.X + rect.Width, rect.Y), new Point(rect.X + rect.Width, rect.Y + rect.Height)); //Bottom g.DrawLine(borderPen, new Point(rect.X, rect.Y + rect.Height), new Point(rect.X + rect.Width, rect.Y + rect.Height)); //Top1 g.DrawLine(borderPen, new Point(rect.X, rect.Y), new Point(rect.X + box.Padding.Left, rect.Y)); //Top2 g.DrawLine(borderPen, new Point(rect.X + box.Padding.Left + (int)(strSize.Width), rect.Y), new Point(rect.X + rect.Width, rect.Y)); } } private void groupBox1_Paint(object sender, PaintEventArgs e) { GroupBox box = sender as GroupBox; DrawGroupBox(box, e.Graphics, Color.Red, Color.Blue); }","Custom GroupBox with custom TextColor, BorderColor and Transparent BackColor"
Code First issue with seeding data in cyrilic," I am using the seed method to populate the database.Some of the objects have properties in cyrillic. Example: The objects are properly created in the database, however when I check the database in MS SQL management studio instead of the wine's name being """", it is displayed as """".Strangely, when I create the wine in my Startup class like this: everything is displayed properly in cyrillic in the database.Do you have an idea what may cause this? <code>  context.Wines.AddOrUpdate(new Wine() { Id = 1, Name = """", etc........................................ var db = new WineSystemDbContext();var ShardoneWine = new Wine { Name = ""};db.Wines.Add(ShardoneWine);",Code First issue with seeding data in Cyrillic
How to keep drawn shapes after the form is refreshed? [C#]," I am trying to create a small paint application in Visual Studio 2015. My project falls into the category of Windows Form Applications. I have the following problem: This part of my codes creates a Rectangular (2nd if), a line segment(3rd if) and just a line. It works pretty much the same as MS Paint; the rectangular or the line segment isn not completed until the user releases the left mouse click (Mouse up). But when a rectangular is finally made when I try again to create another one, the form refreshes ( Refresh(); ) and I lose all the previous drawn rectangulars or lines. I tried replacing Refresh(); with Invalidate(rect); and Update();, but I do not get the result I want.Instead, I get this:  <code>  private void Form1_MouseMove(object sender, MouseEventArgs e) { if (a == 1) { if (r == 1 || el == 1) { int x = Math.Min(inX, e.X); int y = Math.Min(inY, e.Y); int width = Math.Max(inX, e.X) - Math.Min(inX, e.X); int height = Math.Max(inY, e.Y) - Math.Min(inY, e.Y); rect = new Rectangle(x, y, width, height); Refresh(); } else if (l == 1) { ep = e.Location; Refresh(); } else { ep = e.Location; g = this.CreateGraphics(); g.DrawLine(p, sp, ep); sp = ep; } } }",How to keep drawn shapes after the form is refreshed?
C# Towers of Hanoi: Moving Rings from Peg to Peg," Expanding on my previous post, I am still writing Towers of Hanoi. After having a wonderful solution explained of how to draw the rings on the pegs, I still have one question that I have been fiddling with for quite awhile now. Here is my PegClass: And here is my main method. This is the current output: My question remains, how does one move the '-' characters from peg to peg when asked for a prompt. I've tried tweaking it for hours and still couldn't figure it out. Thank you in advance, youmeoutside <code>  namespace Towers_Of_Hanoi{ class PegClass { private int pegheight; private int y = 3; int[] rings = new int[0]; public PegClass() { //this is the default constructor } public PegClass(int height) { pegheight = height; } // other user defined functions public void AddRing(int size) { Array.Resize (ref rings, rings.Length + 2); rings[rings.Length - 1] = size; } public void DrawPeg(int x, int numberOfRings = 0) { for (int i = pegheight; i >= 1; i--) { string halfRing = new string (' ', i); if (numberOfRings > 0) { if (i <= numberOfRings) halfRing = new string ('-', numberOfRings - i + 1); } Console.SetCursorPosition(x - halfRing.Length * 2 + i + (halfRing.Contains(""-"") ? (-i + halfRing.Length) : 0), y); Console.WriteLine(halfRing + ""|"" + halfRing); y++; } if (x < 7) { x = 7; } Console.SetCursorPosition (x - 7, y); //print the base of the peg Console.WriteLine(""----------------""); } }} namespace Tower_of_hanoi{ class Program { static void Main(string[] args) { PegClass myPeg = new PegClass(8); PegClass myPeg2 = new PegClass(8); PegClass myPeg3 = new PegClass(8); DrawBoard(myPeg, myPeg2, myPeg3); Console.WriteLine (""\t\t\nWelcome to kTowers!""); while (true) { string input = ""\nWhat peg do you want to move to commander?""; Console.WriteLine (input); if (input == ""2"") { myPeg.DrawPeg (2); } Console.ReadLine (); } } public static void DrawBoard(PegClass peg1,PegClass peg2,PegClass peg3) { Console.Clear(); peg1.DrawPeg(20,1); peg2.DrawPeg(40,2); peg3.DrawPeg(60,4); } }} | | | | | | | | | | | | | | -|- | | --|-- | -|- ---|--- -|- --|-- ----|---- ---------------- ---------------- ----------------",Towers of Hanoi: Moving Rings from Peg to Peg
Asp.net 5 web api return File as response," My previous question: How to return file from ASP.net 5 web apiI am trying to return a file as the response from Web API POST request. I'm using dnx451 framework and rc1-final build. Controller method: As result I get a file with name ""response"". After saving it as pdf i try to open it, and it says it is damaged. Hope you can help me. I am using Postman as test client.Thanks <code>  [HttpPost("""")]public ActionResult Post([FromBody]DocumentViewModel vm){ try { if (ModelState.IsValid) { var Document = _repository.GetDocumentByGuid(vm.DocumentGuid, User.Identity.Name); var Params = Helper.ClientInputToRealValues(vm.Parameters, Document.DataFields); var file = Helper.GeneratePdf(Helper.InsertValues(Params, Document.Content)); FileStream stream = new FileStream(file,FileMode.Open); return File(stream, ""application/pdf"", ""test.pdf""); } } catch (Exception ex) { Response.StatusCode = (int)HttpStatusCode.BadRequest; return null; } Response.StatusCode = (int)HttpStatusCode.BadRequest; return null;}",Return file from ASP.NET 5 Web API
Shortest way to invoke a method with params in C#," When I need to invoke some code in the specified thread, i am using something like this: This code works fine, but it's quite heavy. I'd like to make it without declaring MethodToInvoke and MethodToInvokeDelegate - using an anonymous method. But I can't figure out how to pass parameters to it.I can't write this like: I need to actually pass parameters to method. Is it any way to write it short and simple?Example: This code will not work: method will be called with i = 1, 2, 3 and will raise IndexOutOfRange exception. i will be incremented before method begins to execute. So we need to rewrite it like: <code>  Dispatcher dispatcher = Dispatcher.CurrentDispatcher;delegate void MethodToInvokeDelegate(string foo, int bar);void MethodToInvoke(string foo, int bar){ DoSomeWork(foo); DoMoreWork(bar); }void SomeMethod(){ string S = ""Some text""; int I = 1; dispatcher.BeginInvoke(new MethodToInvokeDelegate(MethodToInvoke), new object[] {S, I});} dispatcher.BeginInvoke((Action)delegate() { DoSomeWork(S); DoMoreWork(I); }); Dispatcher dispatcher = Dispatcher.CurrentDispatcher;int[] ArrayToFill = new int[3];void SomeMethod(){ for (int i = 0; i < 3; i++) dispatcher.BeginInvoke( { ArrayToFill[i] = 10; } );} Dispatcher dispatcher = Dispatcher.CurrentDispatcher;int[] ArrayToFill = new int[3];delegate void MethodToInvokeDelegate(int i);void MethodToInvoke(int i){ ArrayToFill[i] = 10; }void SomeMethod(){ for (int i = 0; i < 3; i++) dispatcher.BeginInvoke(new MethodToInvokeDelegate(MethodToInvoke), new object[] {i});}",Shortest way to invoke a method with parameters in C#
Shortest way to invoke a method with parameters in C#," When I need to invoke some code in the specified thread, i am using something like this: This code works fine, but it's quite heavy. I'd like to make it without declaring MethodToInvoke and MethodToInvokeDelegate - using an anonymous method. But I can't figure out how to pass parameters to it.I can't write this like: I need to actually pass parameters to method. Is it any way to write it short and simple?Example: This code will not work: method will be called with i = 1, 2, 3 and will raise IndexOutOfRange exception. i will be incremented before method begins to execute. So we need to rewrite it like: <code>  Dispatcher dispatcher = Dispatcher.CurrentDispatcher;delegate void MethodToInvokeDelegate(string foo, int bar);void MethodToInvoke(string foo, int bar){ DoSomeWork(foo); DoMoreWork(bar); }void SomeMethod(){ string S = ""Some text""; int I = 1; dispatcher.BeginInvoke(new MethodToInvokeDelegate(MethodToInvoke), new object[] {S, I});} dispatcher.BeginInvoke((Action)delegate() { DoSomeWork(S); DoMoreWork(I); }); Dispatcher dispatcher = Dispatcher.CurrentDispatcher;int[] ArrayToFill = new int[3];void SomeMethod(){ for (int i = 0; i < 3; i++) dispatcher.BeginInvoke( { ArrayToFill[i] = 10; } );} Dispatcher dispatcher = Dispatcher.CurrentDispatcher;int[] ArrayToFill = new int[3];delegate void MethodToInvokeDelegate(int i);void MethodToInvoke(int i){ ArrayToFill[i] = 10; }void SomeMethod(){ for (int i = 0; i < 3; i++) dispatcher.BeginInvoke(new MethodToInvokeDelegate(MethodToInvoke), new object[] {i});}",Shortest way to invoke a method with parameters in C#
Checking ShouldThrow Data in Fluent Assertions in .NET," OK, I am running a unit test to see if the Exception.Data property contains a specific value against a specific named key.Exception.Data is of type IDictionary. IDictionary only has 2 overloads which I cant see a way to verify what is in the dictionary.I have the following code that throws the exception: Then a test to try and verify that MyKey1 = 212 and MyKey2 = 2121: I want to test that the Data Contains MyKey1 with a value of 212 and MyKey2 with a value of 2121. <code>  public class MyClass{ public void ThrowMyException() { throw new MyException(); }}public class MyException : Exception{ public MyException() { this.Data.Add(""MyKey1"", 212); this.Data.Add(""MyKey2"", 2121); }} [TestClass]public class UnitTest1{ [TestMethod] public void TestMethod1() { MyClass classUnderTest = new MyClass(); Action test = () => { classUnderTest.ThrowMyException(); }; test.ShouldThrow<MyException>() //.And.Data.Keys.Should().Contain("""") }}",Checking ShouldThrow Exception.Data in Fluent Assertions in .NET
Determine assembly path with DNX projects," TargetFor integration tests I want to load a custom XML configuration. This XML is located in a folder inside my integration test project.For further targets I want to use the new DNX projects. I know they are still in preview.Local tests work fine.The problem is now, that I cannot use relative paths, because of the test system the current directory information is not the project folder of my project.The same issue with AppVeyor.The build agent is started in another folder and so the relative path information is wrong and fails.No suprise here.I've tried to solve this with this snippet: ProblemThe problem here is: because of the new DNX Runtime this returns not the location of my project and/or assembly, it returns the runtime folder: Same behavior if I ask for CodeBase or Executing/CallingAssembly.With ""old"" simple C# projects and MsTest, I get the path as expected.Environment.CurrentDirectory does not work on AppVeyor, because process is not started in project folder and then this command returns another path (the path of the started project).QuestionWhat is the correct way to work with relative paths here?EnvironmentVS 2015 Update 1DNX Project templatesxUnit configurationAppVeyor build system <code>  public abstract class IntegrationTestBase{ public static string CurrentPath() { string codeBase = typeof (IntegrationTestBase).Assembly.Location; UriBuilder uri = new UriBuilder( codeBase ); string path = Uri.UnescapeDataString( uri.Path ); return Path.GetDirectoryName( path ); }} C:/Users/ben/.dnx/runtimes/dnx-clr-win-x86.1.0.0-rc1-update1/bin/Microsoft.Dnx.Loader.dll",Determine current path with DNX projects
C# remove text between quotes," I have a program, in which you can input a string. But I want text between quotes "" "" to be removed.Example:in: Today is a very ""nice"" and hot day.out: Today is a very """" and hot day. I don't know how to write the string without text between quotes to the console.I am not allowed to use a complex method like regex. <code>  Console.WriteLine(""Enter text: ""); text = Console.ReadLine(); int letter; string s = null; string s2 = null; for (s = 0; s < text.Length; letter++) { if (text[letter] != '""') { s = s + text[letter]; } else if (text[letter] == '""') { s2 = s2 + letter; letter++; (text[letter] != '""') { s2 = s2 + letter; letter++; } } }",Remove text between quotes
WPF radio button (I guess) with Image, I have to create something similar to the picture. If one of the button is clicked the others should become darker. Thanks a lot!That's what I need <code> ,WPF radio button with Image
Testing for exceptions wiith [TestCase] attribute in NUnit 3?," How do I test for exceptions in a TestCase with NUnit3?Let's say I have a method Divide(a,b) defined as follows: I want to test this method using NUnit 3.0 test cases, so maybe I have: Is there a way to specify a Test Case that will cause Divide() to throw an ArgumentException and somehow have this as the expected result, e.g. something along the lines of: (Of course I could define a separate test method and use Assert.Throws() in this, so this is purely out of curiosity) <code>  public double Divide(double a, double b){ if(Math.Abs(b) < double.Epsilon) throw new ArgumentException(""Divider cannot be 0""); return a/b;} [TestCase(-10, 2, -5)][TestCase(-1, 2, -0.5)]public void TestDivide(double a, double b, double result){ Assert.That(_uut.Divide(a, b), Is.EqualTo(result));} [TestCase(-10, 2, -5)][TestCase(-1, 2, -0.5)][TestCase(-1, 0, ExpectedResult = TypeOf(ArgumentException)]public void TestDivide(double a, double b, double result){ Assert.That(_uut.Divide(a, b), Is.EqualTo(result));}",Testing for exceptions with [TestCase] attribute in NUnit 3?
Enable Cors in ASP.NET WebApi 2.3," I'm trying to enable CORS but I constantly have the same problem for each request sent from my AngularJS web app: Cross-Origin Request Blocked: The Same Origin Policy disallows reading the remote resource at https://.../... (Reason: CORS header 'Access-Control-Allow-Origin' missing). And it only occurs with Firefox! It works perfectly with Chrome, Safari, IE and Edge.Environment:My API is a .NET Web Api 2.3 (.NET 4.6) hosted on Azure App Services (IIS 8.0).My front app is a AngularJS webapp that I access via https and which consumes the API via https.What I did:I have a Startup class which is declared as the startup entry point for Owin. I have a WebApiConfig class which is declared as below: I did not touch web.config to manually add headers (I tried, but it didn't solve my problem). Anyway, it's not recommended to add these headers in web.config and to have app.UseCors() at the same time.So, on Firefox, I have the CORS error, but on Safari/Chrome, no problem! I have the Access-Control-Allow-Origins everywhere except Firefox.On Chrome:On Firefox:EDIT:Well, I've investigated a bit more, and if I switch my webapp address from https:// to http://, everything works fine on Firefox (also, my API can be consumed by Angular via https with no CORS problem at all) ... I really don't understand what's going on, but magically, Access-Control-Allow-Origin appears on every API routes consumed by Firefox, which was not the case when it was a secure connection (https). I rely on https Azure certificate from Microsoft, which seems to be valid (the lock icon is green). Of course, I would like to keep https, but I don't know how I can solve my issue.Seems to be related to: Firefox CORS request giving 'Cross-Origin Request Blocked' despite headersI've made a rewrite rule regarding the web app client (which hosts AngularJS). In my web.config, I have: When I remove it, it's fine (my web app is accessible using HTTP), but when I switch to HTTPS, and even though the API server accept all origins, it fails.So the question: Should I add something special to make HTTPS/Certificate works with CORS (under Firefox)?Also related: https://stackoverflow.com/questions/33743645/iis-reverse-proxy-to-bypass-cors-issue <code>  [assembly: OwinStartup(typeof(Startup))]namespace SentinelleApi{ public class Startup { public void Configuration(IAppBuilder app) { app.UseCors(Microsoft.Owin.Cors.CorsOptions.AllowAll); app.Map(""/signalr"", map => { map.UseCors(Microsoft.Owin.Cors.CorsOptions.AllowAll); var hubConfiguration = new HubConfiguration { EnableDetailedErrors = true, EnableJavaScriptProxies = false }; map.RunSignalR(hubConfiguration); }); HttpConfiguration config = new HttpConfiguration(); WebApiConfig.Register(config); app.UseWebApi(config); } }} namespace SentinelleApi{ public static class WebApiConfig { public static void Register(HttpConfiguration config) { // No need to declare config.EnableCors() here, the app.UseCors(...) does the job in startup section // Web API routes config.MapHttpAttributeRoutes(); config.Routes.MapHttpRoute( name: ""DefaultApi"", routeTemplate: ""api/{controller}/{id}"", defaults: new {id = RouteParameter.Optional} ); } }} <rule name=""RedirectToHTTPS"" stopProcessing=""true""> <match url=""(.*)"" /> <conditions> <add input=""{HTTPS}"" pattern=""off"" ignoreCase=""true"" /> <add input=""{URL}"" pattern=""/$"" negate=""true"" /> <add input=""{REQUEST_FILENAME}"" matchType=""IsFile"" negate=""true"" /> </conditions> <action type=""Redirect"" url=""https://{SERVER_NAME}/{R:1}"" redirectType=""SeeOther"" /> </rule>","No Access-Control-Allow-Origin with Firefox, but works with Chrome and Safari"
Azure Web Api Scaffolding - Generator not found," Summary: When creating a new Web Project in Visual Studio 2015 (Update 1), im unable to use the scaffolding tool for Controllers that relates to Entity Framework.Same issue occures with VS2013 Update 5It returns the following message: There was an error running the selected code generator: There was an error getting the type ""failtest.Models.TestModelClass"". Try rebuilding the project. I have tried to rebuild it, but still nothing. Anyone got a clue about why im getting this? I actually re-installed my Windows 10 system to see if this could fix this error. - Now, that beeing said, it was in need for some tough love anyway, so i figgured it was about time - Maybe its crashing because i have tried a vast amount of node stuff in the past time, and permission errors. But the error occured both before and after i re-installed it. (complete whipe)This is a Fresh install of Visual Studio 2015 Professional - Basically nothing else has been added to the system yet. When i first started this post, i created a blank project for my screenshots just to show the entire process (below) - And i tought i was loosing my mind. At first, the testproject suddenly worked, so i created a second project to test again. And then it failed with the same error. So just to confirm, i deleted the first project that worked, and set it up again with the exact same name and file location as the one that suddenly worked ( after deleting all folders and existing project files ) - And now it keeps failing again. How to reproduce: Create a new ""Azure Api App"" project - Leave all settings as default (Any project type will produce the same result actually)Create a new ModelBuild your project (this is mentioned on an article from Microsoft to be nesesary to use the scaffolder) Add a new Controller by right clicking the ""Controllers"" folder, and selecting New -> Controller - Select ""Web Api 2.0 controller with actions, using Entity Framework""Fill out the information, since this is a new project, we dont have a context - so click the + icon and create a new one. Error is producedEDIT: Packages.config : Web.Config : EDIT 2: I Suspect that this is an EntityFramework issue, as the scaffolder works for everything that doesnt include EntityFramework. Already testedSwitch between Debug and Release configUpdated all packages and pluginsVerified the solution file and project XMLVerified Web.configDeleted Bin / Debug folderNew project with different project typesIssues describing the same error - All testedScaffolding/Auto code generator completely broken?There was an error running the selected code generator...How do i add a controller to asp.net MVC....External: There was an error running the selected code generatorExternal: VS2013 scaffolding errorScaffolding controller doesn't work with visual studio 2013 update 2I also created an issue on this on the aspnet Github issue tracker. https://github.com/aspnet/Tooling/issues/411And reported it to Microsoft trought the internal Feedback system in Visual Studio.  <code>  <?xml version=""1.0"" encoding=""utf-8""?><packages> <package id=""EntityFramework"" version=""6.1.3"" targetFramework=""net452"" /> <package id=""Microsoft.AspNet.WebApi"" version=""5.2.3"" targetFramework=""net452"" /> <package id=""Microsoft.AspNet.WebApi.Client"" version=""5.2.3"" targetFramework=""net452"" /> <package id=""Microsoft.AspNet.WebApi.Core"" version=""5.2.3"" targetFramework=""net452"" /> <package id=""Microsoft.AspNet.WebApi.WebHost"" version=""5.2.3"" targetFramework=""net452"" /> <package id=""Microsoft.Web.Infrastructure"" version=""1.0.0.0"" targetFramework=""net452"" /> <package id=""Newtonsoft.Json"" version=""8.0.2"" targetFramework=""net452"" /> <package id=""Swashbuckle"" version=""5.3.1"" targetFramework=""net452"" /> <package id=""Swashbuckle.Core"" version=""5.3.1"" targetFramework=""net452"" /> <package id=""System.IdentityModel.Tokens.Jwt"" version=""4.0.2.206221351"" targetFramework=""net452"" /> <package id=""WebActivatorEx"" version=""2.1.0"" targetFramework=""net452"" /></packages> <?xml version=""1.0"" encoding=""utf-8""?><!-- For more information on how to configure your ASP.NET application, please visit http://go.microsoft.com/fwlink/?LinkId=301879 --><configuration> <configSections> <!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 --> <section name=""entityFramework"" type=""System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" requirePermission=""false"" /> </configSections> <appSettings></appSettings> <system.web> <compilation debug=""true"" targetFramework=""4.5.2"" /> <httpRuntime targetFramework=""4.5.2"" /> </system.web> <system.webServer> <handlers> <remove name=""ExtensionlessUrlHandler-Integrated-4.0"" /> <remove name=""OPTIONSVerbHandler"" /> <remove name=""TRACEVerbHandler"" /> <add name=""ExtensionlessUrlHandler-Integrated-4.0"" path=""*."" verb=""*"" type=""System.Web.Handlers.TransferRequestHandler"" preCondition=""integratedMode,runtimeVersionv4.0"" /> </handlers> </system.webServer> <runtime> <assemblyBinding xmlns=""urn:schemas-microsoft-com:asm.v1""> <dependentAssembly> <assemblyIdentity name=""Newtonsoft.Json"" culture=""neutral"" publicKeyToken=""30ad4fe6b2a6aeed"" /> <bindingRedirect oldVersion=""0.0.0.0-6.0.0.0"" newVersion=""6.0.0.0"" /> </dependentAssembly> <dependentAssembly> <assemblyIdentity name=""System.Net.Http.Formatting"" publicKeyToken=""31bf3856ad364e35"" culture=""neutral"" /> <bindingRedirect oldVersion=""0.0.0.0-5.2.3.0"" newVersion=""5.2.3.0"" /> </dependentAssembly> <dependentAssembly> <assemblyIdentity name=""System.Web.Http"" publicKeyToken=""31bf3856ad364e35"" culture=""neutral"" /> <bindingRedirect oldVersion=""0.0.0.0-5.2.3.0"" newVersion=""5.2.3.0"" /> </dependentAssembly> </assemblyBinding> </runtime> <entityFramework> <defaultConnectionFactory type=""System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework""> <parameters> <parameter value=""mssqllocaldb"" /> </parameters> </defaultConnectionFactory> <providers> <provider invariantName=""System.Data.SqlClient"" type=""System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer"" /> </providers> </entityFramework></configuration>",Web Api Scaffolding - Error running the selected code generator
Setting Xamarin.Forms binding in code behind," I'm trying to set binding on a TapGestureRecognizer in code and I can't figure out the right way to do it. The working xaml looks something like this... And in C#, it looks something like this... My confusion comes in on the binding of CommandParameterProperty. In xaml, this simply {Binding} with no other parameter. How is this done in code? Passing in new Binding() or this.BindingContext don't seem to work. <code>  <Grid> <Grid.GestureRecognizers> <TapGestureRecognizer Command=""{Binding LaunchLocationDetailsCommand}"" CommandParameter=""{Binding}"" /> </Grid.GestureRecognizers></Grid> var gridTap = new TapGestureRecognizer();gridTap.SetBinding(TapGestureRecognizer.CommandProperty, new Binding(""LaunchLocationDetailsCommand""));gridTap.SetBinding(TapGestureRecognizer.CommandParameterProperty, new Binding(/* here's where I'm confused */));var grid = new Grid();grid.GestureRecognizers.Add(gridTap);",Set Xamarin.Forms binding CommandParameter in code behind
ASP.net 5 - how to use SQLClient," I am trying to use SQLClient library in the ASP.net Core but cant seem to get it working. I found this article online advising how to setup but its not working for me: http://blog.developers.ba/using-classic-ado-net-in-asp-net-vnext/I have a simple console application package. My project.json looks like this: And I try the following code: But get the following errors:Anyone else got this working? <code>  { ""version"": ""1.0.0-*"", ""description"": ""DBTest Console Application"", ""authors"": [ """" ], ""tags"": [ """" ], ""projectUrl"": """", ""licenseUrl"": """", ""compilationOptions"": { ""emitEntryPoint"": true }, ""dependencies"": { ""System.Data.Common"": ""4.0.1-beta-23516"", ""System.Data.SqlClient"" : ""4.0.0-beta-23516"" }, ""commands"": { ""DBTest"": ""DBTest"" }, ""frameworks"": { ""dnx451"": { }, ""dnxcore50"": { ""dependencies"": { ""Microsoft.CSharp"": ""4.0.1-beta-23516"", ""System.Collections"": ""4.0.11-beta-23516"", ""System.Console"": ""4.0.0-beta-23516"", ""System.Linq"": ""4.0.1-beta-23516"", ""System.Threading"": ""4.0.11-beta-23516"" } } }} using System;using System.Data.SqlClient;namespace DBTest{ public class Program { public static void Main(string[] args) { using (SqlConnection con = new SqlConnection(ConnStr)) { con.Open(); try { using (SqlCommand command = new SqlCommand(""SELECT * FROM SAMPLETABLE"", con)) { command.ExecuteNonQuery(); } } catch { Console.WriteLine(""Something went wrong""); } } Console.Read(); } }}",How to use SqlClient in ASP.NET Core?
Implementing OWIN using existing Database from example," I wish to implement OWIN as per the example I could find here:http://www.asp.net/web-api/overview/security/individual-accounts-in-web-api However, since this way of working is new to me especially using my self created database I would like some guidance.I can submit my registration request without a problem.The post takes me to the AccountController: This triggers the below code: ApplicationUserManager: But for some weird reason I'm getting Even though I don't use name anywhere?! Where is this name coming from?So I presume I'm doing something wrong but it's hard to debug without a clear explanation on how to implement OWIN with an existing DB.Below my context/entity and users table that I would like to use to store me user data.context: users : IdentityUser: Edit:If I add UserName back to my new users object before I try to call CreateAsync, the error is gone but I get another one instead: Edit II:I also have this issue in the tutorial code! This is just a freaking bug in .NET?Edit IIII tried to do an override as you can see in the partial class Users above. But I still have the same error. <code>  [AllowAnonymous] [Route(""Register"")] public async Task<IHttpActionResult> Register(RegisterBindingModel model) { if (!ModelState.IsValid) { return BadRequest(ModelState); } try { var email = model.Email; var password = model.Password; var user = new users() { Email = email, PasswordHash = password, Password = password }; IdentityResult result = await UserManager.CreateAsync(user, model.Password); if (!result.Succeeded) { return GetErrorResult(result); } return Ok(); } catch(Exception ex) { throw; } } public ApplicationUserManager UserManager { get { return _userManager ?? Request.GetOwinContext().GetUserManager<ApplicationUserManager>(); } private set { _userManager = value; } } public class ApplicationUserManager : UserManager<users>{ public ApplicationUserManager(IUserStore<users> store) : base(store) { } public static ApplicationUserManager Create(IdentityFactoryOptions<ApplicationUserManager> options, IOwinContext context) { var manager = new ApplicationUserManager(new UserStore<users>(context.Get<DaumAuctionEntities>())); var dataProtectionProvider = options.DataProtectionProvider; // Configure validation logic for passwords manager.PasswordValidator = new PasswordValidator { RequiredLength = 6, RequireNonLetterOrDigit = false, RequireDigit = false, RequireLowercase = true, RequireUppercase = true, }; if (dataProtectionProvider != null) { manager.UserTokenProvider = new DataProtectorTokenProvider<users>(dataProtectionProvider.Create(""ASP.NET Identity"")); } return manager; }} modelState: {undefined: [""Name cannot be null or empty.""]} public partial class DaumAuctionEntities : IdentityDbContext<users>{ public DaumAuctionEntities() : base(""name=DaumAuctionEntities"") { } public DbSet<addresses> addresses { get; set; } public DbSet<auctions> auctions { get; set; } public DbSet<images> images { get; set; } public DbSet<users> users { get; set; }} public partial class users : IdentityUser{ public override string UserName { get { return Email; } set { Email = value; } } override public string PasswordHash { get { return Password; } set { Password = value; } } public async Task<ClaimsIdentity> GenerateUserIdentityAsync(UserManager<users> manager, string authenticationType) { // Note the authenticationType must match the one defined in CookieAuthenticationOptions.AuthenticationType var userIdentity = await manager.CreateIdentityAsync(this, authenticationType); // Add custom user claims here return userIdentity; }}public partial class users{ public int Id { get; set; } public string FirstName { get; set; } public string LastName { get; set; } public System.DateTime CreatedDate { get; set; } public Nullable<System.DateTime> ModifiedDate { get; set; }} ""The specified type member 'UserName' is not supported in LINQ to Entities. Only initializers, entity members, and entity navigation properties are supported.""",Implementing OWIN using existing Database name validation?
Implementing OWIN using existing Database," I wish to implement OWIN as per the example I could find here:http://www.asp.net/web-api/overview/security/individual-accounts-in-web-api However, since this way of working is new to me especially using my self created database I would like some guidance.I can submit my registration request without a problem.The post takes me to the AccountController: This triggers the below code: ApplicationUserManager: But for some weird reason I'm getting Even though I don't use name anywhere?! Where is this name coming from?So I presume I'm doing something wrong but it's hard to debug without a clear explanation on how to implement OWIN with an existing DB.Below my context/entity and users table that I would like to use to store me user data.context: users : IdentityUser: Edit:If I add UserName back to my new users object before I try to call CreateAsync, the error is gone but I get another one instead: Edit II:I also have this issue in the tutorial code! This is just a freaking bug in .NET?Edit IIII tried to do an override as you can see in the partial class Users above. But I still have the same error. <code>  [AllowAnonymous] [Route(""Register"")] public async Task<IHttpActionResult> Register(RegisterBindingModel model) { if (!ModelState.IsValid) { return BadRequest(ModelState); } try { var email = model.Email; var password = model.Password; var user = new users() { Email = email, PasswordHash = password, Password = password }; IdentityResult result = await UserManager.CreateAsync(user, model.Password); if (!result.Succeeded) { return GetErrorResult(result); } return Ok(); } catch(Exception ex) { throw; } } public ApplicationUserManager UserManager { get { return _userManager ?? Request.GetOwinContext().GetUserManager<ApplicationUserManager>(); } private set { _userManager = value; } } public class ApplicationUserManager : UserManager<users>{ public ApplicationUserManager(IUserStore<users> store) : base(store) { } public static ApplicationUserManager Create(IdentityFactoryOptions<ApplicationUserManager> options, IOwinContext context) { var manager = new ApplicationUserManager(new UserStore<users>(context.Get<DaumAuctionEntities>())); var dataProtectionProvider = options.DataProtectionProvider; // Configure validation logic for passwords manager.PasswordValidator = new PasswordValidator { RequiredLength = 6, RequireNonLetterOrDigit = false, RequireDigit = false, RequireLowercase = true, RequireUppercase = true, }; if (dataProtectionProvider != null) { manager.UserTokenProvider = new DataProtectorTokenProvider<users>(dataProtectionProvider.Create(""ASP.NET Identity"")); } return manager; }} modelState: {undefined: [""Name cannot be null or empty.""]} public partial class DaumAuctionEntities : IdentityDbContext<users>{ public DaumAuctionEntities() : base(""name=DaumAuctionEntities"") { } public DbSet<addresses> addresses { get; set; } public DbSet<auctions> auctions { get; set; } public DbSet<images> images { get; set; } public DbSet<users> users { get; set; }} public partial class users : IdentityUser{ public override string UserName { get { return Email; } set { Email = value; } } override public string PasswordHash { get { return Password; } set { Password = value; } } public async Task<ClaimsIdentity> GenerateUserIdentityAsync(UserManager<users> manager, string authenticationType) { // Note the authenticationType must match the one defined in CookieAuthenticationOptions.AuthenticationType var userIdentity = await manager.CreateIdentityAsync(this, authenticationType); // Add custom user claims here return userIdentity; }}public partial class users{ public int Id { get; set; } public string FirstName { get; set; } public string LastName { get; set; } public System.DateTime CreatedDate { get; set; } public Nullable<System.DateTime> ModifiedDate { get; set; }} ""The specified type member 'UserName' is not supported in LINQ to Entities. Only initializers, entity members, and entity navigation properties are supported.""",Implementing OWIN using existing Database name validation?
Clickable hiperlink on tooltip\popup in C# WPF," I need to show a hyperlink on a tooltip. The hyperlink should be clickable. My XAML so far is: Output:But it is not clickable and hides immediately. I need the link to be clickable.  <code>  <Button Content=""Click..!!"" Height=""23"" HorizontalAlignment=""Left"" Margin=""191,108,0,0"" Name=""button1"" VerticalAlignment=""Top"" Width=""75"" > <Button.ToolTip> <ToolTip StaysOpen=""True"" ToolTipService.BetweenShowDelay=""5000"" ToolTipService.ShowDuration=""5000"" ToolTipService.InitialShowDelay=""5000""> <Hyperlink NavigateUri=""http://stackoverflow.com/questions/"">http://stackoverflow.com/questions/</Hyperlink> </ToolTip> </Button.ToolTip></Button>",Clickable hyperlink on tooltip or popup in WPF
Web Api- Decode url in HTTP Module," We have an HTTP Module that decodes all encoded requests.It works great with all WCF requests, but NOT in Web Api requests- in Web Api the request (both POST and GET) gets to the service still encodedI see that it Hits the HTTP Module but,again,still gets to the service encoded.How can i fix it? or what am i doing wrong?i know that its better to work with Message Handlers in Web Api, but HTTP Modules suppose to work too- no? HTTP Module: WebFunction: Web Api: <code>  public void Init(HttpApplication context) { context.BeginRequest += new EventHandler(context_BeginRequest); context.EndRequest += context_PreSendRequestContent; } void context_PreSendRequestContent(object sender, EventArgs e) { string encodedQuerystring = HttpContext.Current.Request.QueryString.ToString(); if (!string.IsNullOrEmpty(encodedQuerystring)) { System.Collections.Specialized.NameValueCollection col = new System.Collections.Specialized.NameValueCollection(); col.Add(""q"", encodedQuerystring); WebFunction.CreateQuerystring(HttpContext.Current, col); } } void context_BeginRequest(object sender, EventArgs e) { string encodedQueryString = String.Empty; if (HttpContext.Current.Request.QueryString.Count > 0 && HttpContext.Current.Request.QueryString[""q""] != null) { object _p = HttpContext.Current.Request.QueryString; encodedQueryString = HttpContext.Current.Server.UrlDecode(HttpContext.Current.Request.QueryString[""q""].ToString()); string originalQueryString = HttpContext.Current.Server.UrlDecode(WebFunction.Base64Decode(encodedQueryString)); if (!string.IsNullOrEmpty(originalQueryString)) { WebFunction.CreateQuerystring(HttpContext.Current, WebFunction.ConvertQueryToCollection(originalQueryString)); } } } public static void CreateQuerystring(HttpContext context, System.Collections.Specialized.NameValueCollection nameValueCollection) { // reflect to readonly property PropertyInfo isreadonly = typeof(System.Collections.Specialized.NameValueCollection).GetProperty(""IsReadOnly"", BindingFlags.Instance | BindingFlags.NonPublic); // make collection editable isreadonly.SetValue(context.Request.QueryString, false, null); context.Request.QueryString.Clear(); context.Request.QueryString.Add(nameValueCollection); // make collection readonly again isreadonly.SetValue(context.Request.QueryString, true, null); } public class NamesController : ApiController{ [HttpGet] [ActionName(""GET_NAMES"")] public Drugs_ResponseData Get(string q) {//need to add the decode function to get it to work string[] arrAmpersant = Commonnn.DecodeFrom64(q).Split('&'); Names_obj = new Names(); return _obj.GetResult(Convert.ToInt32(Commonnn.GetValFromEqual(arrAmpersant[0]))); }}",Web API and HTTP Module
Web API- Decode url in HTTP Module," We have an HTTP Module that decodes all encoded requests.It works great with all WCF requests, but NOT in Web Api requests- in Web Api the request (both POST and GET) gets to the service still encodedI see that it Hits the HTTP Module but,again,still gets to the service encoded.How can i fix it? or what am i doing wrong?i know that its better to work with Message Handlers in Web Api, but HTTP Modules suppose to work too- no? HTTP Module: WebFunction: Web Api: <code>  public void Init(HttpApplication context) { context.BeginRequest += new EventHandler(context_BeginRequest); context.EndRequest += context_PreSendRequestContent; } void context_PreSendRequestContent(object sender, EventArgs e) { string encodedQuerystring = HttpContext.Current.Request.QueryString.ToString(); if (!string.IsNullOrEmpty(encodedQuerystring)) { System.Collections.Specialized.NameValueCollection col = new System.Collections.Specialized.NameValueCollection(); col.Add(""q"", encodedQuerystring); WebFunction.CreateQuerystring(HttpContext.Current, col); } } void context_BeginRequest(object sender, EventArgs e) { string encodedQueryString = String.Empty; if (HttpContext.Current.Request.QueryString.Count > 0 && HttpContext.Current.Request.QueryString[""q""] != null) { object _p = HttpContext.Current.Request.QueryString; encodedQueryString = HttpContext.Current.Server.UrlDecode(HttpContext.Current.Request.QueryString[""q""].ToString()); string originalQueryString = HttpContext.Current.Server.UrlDecode(WebFunction.Base64Decode(encodedQueryString)); if (!string.IsNullOrEmpty(originalQueryString)) { WebFunction.CreateQuerystring(HttpContext.Current, WebFunction.ConvertQueryToCollection(originalQueryString)); } } } public static void CreateQuerystring(HttpContext context, System.Collections.Specialized.NameValueCollection nameValueCollection) { // reflect to readonly property PropertyInfo isreadonly = typeof(System.Collections.Specialized.NameValueCollection).GetProperty(""IsReadOnly"", BindingFlags.Instance | BindingFlags.NonPublic); // make collection editable isreadonly.SetValue(context.Request.QueryString, false, null); context.Request.QueryString.Clear(); context.Request.QueryString.Add(nameValueCollection); // make collection readonly again isreadonly.SetValue(context.Request.QueryString, true, null); } public class NamesController : ApiController{ [HttpGet] [ActionName(""GET_NAMES"")] public Drugs_ResponseData Get(string q) {//need to add the decode function to get it to work string[] arrAmpersant = Commonnn.DecodeFrom64(q).Split('&'); Names_obj = new Names(); return _obj.GetResult(Convert.ToInt32(Commonnn.GetValFromEqual(arrAmpersant[0]))); }}",Web API and HTTP Module
"Why the base method called, not derived?"," I have simple three classes: And I am creating objects and calling their methods: And output will be: ABCWhat I cannot understand is why these code produces B?: I thought that it should be C. However, I tested many times, and it is always B. I understand that A b = new C() creates new object type of C. So output should be C. Or it is special behavior to call overridden method when we use it without casting?Why does it happen? As we have not used any reference to B class. <code>  class A{ public virtual void Write() { Console.Write(""A""); }}class B:A{ public override void Write() { Console.Write(""B""); }}class C : B{ public new void Write() { Console.Write(""C""); }} A a = new A();a.Write();A b = new C();b.Write();C c = new C();c.Write(); A b = new C();b.Write();",New keyword: why is the derived method not called?
C# awaiting task with timeout," I'm trying to write a helper method which allows me to pass in an arbitrary task and a timeout. If the task completes before the timeout, a success delegate is called, otherwise an error delegate is called. The method looks like this: Now this seems to work most of the time, but i wanted to write some tests as well to make sure. This test, to my surprise fails, and calls the error delegate instead of the success: This test, however, is green: How do i make both tests green? Is my usage of Task.WhenAny incorrect? <code>  public static async Task AwaitWithTimeout(Task task, int timeout, Action success, Action error) { if (await Task.WhenAny(task, Task.Delay(timeout)) == task) { if (success != null) { success(); } } else { if (error != null) { error(); } } } var taskToAwait = Task.Delay(1); var successCalled = false; await TaskHelper.AwaitWithTimeout(taskToAwait, 10, () => successCalled = true, null); Assert.IsTrue(successCalled); var taskToAwait = Task.Run(async () => { await Task.Delay(1); }); var successCalled = false; await TaskHelper.AwaitWithTimeout(taskToAwait, 10, () => successCalled = true, null); Assert.IsTrue(successCalled);",awaiting task with timeout
WCF passing header values via Channel," I have a WCF service which requires an application ID parameter to be passed to each service call. Currently my exposed methods require a parameter. I want to try and push this information into the Channel headers. My WCF is hosted using Net.tcp. Here is my client proxy code: (The commented out line is what I want to use going forward).Server code: In the _context object there are private methods containing my header, but publicly in the _context.IncomingRequest.Headers I get this: There is no HttpRequestMessageProperty on the incoming Message.So my question is, am I suffering because I am not hosting on HTTP? Is there a way to trick the server to give me access to those headers by adding some pseudo HTTP headers? Or can I get at the private members maybe via reflection? <code>  public class CustomerClient : ClientBase<ICustomerBrowser>, ICustomerBrowser{ public Customer Get(string ApplicationID, string CustomerId) { try { using (OperationContextScope _scope = new OperationContextScope(this.InnerChannel)) { MessageHeader _header = MessageHeader.CreateHeader(""AppID"", string.Empty, ApplicationId); OperationContext.Current.OutgoingMessageHeaders.Add(_header); return Channel.Get(ApplicationId, CustomerId); // return Channel.Get(CustomerId); } } }} var _context = WebOperationContext.Current;var h = _context.IncomingRequest.Headers;",Using a WCF OperationContext in passing header values via Channel
CreatePerOwinContext ignoring paths," Short:For each and every request a new OWIN context is created, I would like to be able to prevent this for certain resource types or paths (images, css, js).Full:In our application start-up we register a dbcontext creation delegate so that the dbcontext will be created just once per request. If a client makes a request for the style sheet, an OWIN context will be created an thus a new dbcontext will also be created. I would like to be able to either not create the OwinContext at all, or at least to be able to prevent some of it's ""on create"" callbacks to be executed for certain request types/paths.Alternatively, as I can see why the approach of (partially) ""disabling"" OWIN would lead to problems, I would like to hear what the best practice would be? How can I serve a static file without creating a database context for each request? (small remark here is that our static files are embedded resources served using a virtual path provider... The problem also occurs for ""normal"" static files.)Background: Yesterday I started noticing that every now and then some parts of our application did not load. Sometimes it was single image, sometimes the entire CSS file. After some investigation I saw that some requests were throwing http 500 errors, the exception thrown was often things like a SQL connection time out (but also other exceptions).While we are of course trying to fix those exceptions. I do believe it to be complete nonsense for our application to set up a database connection when a client makes a request for a single image... That's about 10 database connections for a single page request???Seems to me like such an obvious problem but I have been Googling all of yesterday and found nothing close to a solution or work around. What am I missing stack?EDIT: I just tried an approach where I did not actually create the dbcontext but a stub instead. In hindsight this obviously is not the solution to this problem as the OwinContext tries to continue it's process and will critically fail when it tries to get the user from the database using that stub dbcontext. The dbcontext is not the problem, I need to completely bypass Owin... I think... <code>  public virtual void Configuration(IAppBuilder app){ app.CreatePerOwinContext(Factory.DbContextCreateDelegate);}",Serving static files without going through OWIN
CreatePerOwinContext - looking for a method to allow ignoring of paths," Short:For each and every request a new OWIN context is created, I would like to be able to prevent this for certain resource types or paths (images, css, js).Full:In our application start-up we register a dbcontext creation delegate so that the dbcontext will be created just once per request. If a client makes a request for the style sheet, an OWIN context will be created an thus a new dbcontext will also be created. I would like to be able to either not create the OwinContext at all, or at least to be able to prevent some of it's ""on create"" callbacks to be executed for certain request types/paths.Alternatively, as I can see why the approach of (partially) ""disabling"" OWIN would lead to problems, I would like to hear what the best practice would be? How can I serve a static file without creating a database context for each request? (small remark here is that our static files are embedded resources served using a virtual path provider... The problem also occurs for ""normal"" static files.)Background: Yesterday I started noticing that every now and then some parts of our application did not load. Sometimes it was single image, sometimes the entire CSS file. After some investigation I saw that some requests were throwing http 500 errors, the exception thrown was often things like a SQL connection time out (but also other exceptions).While we are of course trying to fix those exceptions. I do believe it to be complete nonsense for our application to set up a database connection when a client makes a request for a single image... That's about 10 database connections for a single page request???Seems to me like such an obvious problem but I have been Googling all of yesterday and found nothing close to a solution or work around. What am I missing stack?EDIT: I just tried an approach where I did not actually create the dbcontext but a stub instead. In hindsight this obviously is not the solution to this problem as the OwinContext tries to continue it's process and will critically fail when it tries to get the user from the database using that stub dbcontext. The dbcontext is not the problem, I need to completely bypass Owin... I think... <code>  public virtual void Configuration(IAppBuilder app){ app.CreatePerOwinContext(Factory.DbContextCreateDelegate);}",Serving static files without going through OWIN
Ignore Owin for static files," Short:For each and every request a new OWIN context is created, I would like to be able to prevent this for certain resource types or paths (images, css, js).Full:In our application start-up we register a dbcontext creation delegate so that the dbcontext will be created just once per request. If a client makes a request for the style sheet, an OWIN context will be created an thus a new dbcontext will also be created. I would like to be able to either not create the OwinContext at all, or at least to be able to prevent some of it's ""on create"" callbacks to be executed for certain request types/paths.Alternatively, as I can see why the approach of (partially) ""disabling"" OWIN would lead to problems, I would like to hear what the best practice would be? How can I serve a static file without creating a database context for each request? (small remark here is that our static files are embedded resources served using a virtual path provider... The problem also occurs for ""normal"" static files.)Background: Yesterday I started noticing that every now and then some parts of our application did not load. Sometimes it was single image, sometimes the entire CSS file. After some investigation I saw that some requests were throwing http 500 errors, the exception thrown was often things like a SQL connection time out (but also other exceptions).While we are of course trying to fix those exceptions. I do believe it to be complete nonsense for our application to set up a database connection when a client makes a request for a single image... That's about 10 database connections for a single page request???Seems to me like such an obvious problem but I have been Googling all of yesterday and found nothing close to a solution or work around. What am I missing stack?EDIT: I just tried an approach where I did not actually create the dbcontext but a stub instead. In hindsight this obviously is not the solution to this problem as the OwinContext tries to continue it's process and will critically fail when it tries to get the user from the database using that stub dbcontext. The dbcontext is not the problem, I need to completely bypass Owin... I think... <code>  public virtual void Configuration(IAppBuilder app){ app.CreatePerOwinContext(Factory.DbContextCreateDelegate);}",Serving static files without going through OWIN
.NET Core - Index.html not showing as default page," I have created an empty Web Application in .NET Core, in wwwroot I have the index.html which is not loading as default page, it loads only when I call it explicitly.Here is my project.json Here my Startup: <code>  { ""version"": ""1.0.0-*"", ""compilationOptions"": { ""emitEntryPoint"": true }, ""dependencies"": { ""Microsoft.AspNet.Server.Kestrel"": ""1.0.0-rc1-final"", ""Microsoft.AspNet.StaticFiles"": ""1.0.0-rc1-final"" }, ""commands"": { ""web"": ""Microsoft.AspNet.Server.Kestrel"" }, ""frameworks"": { ""dnxcore50"": { } }, ""exclude"": [ ""wwwroot"", ""node_modules"" ], ""publishExclude"": [ ""**.user"", ""**.vspscc"" ]} public class Startup{ // This method gets called by the runtime. Use this method to add services to the container. // For more information on how to configure your application, visit http://go.microsoft.com/fwlink/?LinkID=398940 public void ConfigureServices(IServiceCollection services) { } // This method gets called by the runtime. Use this method to configure the HTTP request pipeline. public void Configure(IApplicationBuilder app) { app.UseStaticFiles(); } // Entry point for the application. public static void Main(string[] args) => WebApplication.Run<Startup>(args);}",index.html not showing as default page
Custom Colour palette in Visual Studio (Not Theme)," Within the Visual Studio Designer, under the properties window you are able to select the ForeColor, BackColor etc using color picker. When you want to pick a color, a color picker comes up with the tabs 'Custom, Web, System'.If you select custom, then you are able to add a new color to the picker, but only the bottom 2 rows are changeable, and the changes don't persist across controls. So if you add a color to the palette, when you select another control and want to change for example BackColor your previous added color is not there.Is there a way to create and import a custom set of colors into the designer's color-picker control?Note: This question isn't asking about VS themes, or if colors can be implemented as a class in the code-behind. I'm after a way to tailor the designer. <code> ",Custom Color Palette in Visual Studio Color Property Editor
Unity Flip Texture2D," I could use just a little help. I am loading a png into a Texture2D, and have managed to flip it over the y axis using the following script I found. I need to flip it over the x axis now. I know a small modification should do it, but I have not managed to get the results I want. <code>  Texture2D FlipTexture(Texture2D original){ Texture2D flipped = new Texture2D(original.width,original.height); int xN = original.width; int yN = original.height; for(int i=0;i<xN;i++){ for(int j=0;j<yN;j++){ flipped.SetPixel(xN-i-1, j, original.GetPixel(i,j)); } } flipped.Apply(); return flipped;}","Unity 180 rotation for a Texture2D, or maybe flip both"
Unity mirror a Texture2D on the Y axis," I could use just a little help. I am loading a png into a Texture2D, and have managed to flip it over the y axis using the following script I found. I need to flip it over the x axis now. I know a small modification should do it, but I have not managed to get the results I want. <code>  Texture2D FlipTexture(Texture2D original){ Texture2D flipped = new Texture2D(original.width,original.height); int xN = original.width; int yN = original.height; for(int i=0;i<xN;i++){ for(int j=0;j<yN;j++){ flipped.SetPixel(xN-i-1, j, original.GetPixel(i,j)); } } flipped.Apply(); return flipped;}","Unity 180 rotation for a Texture2D, or maybe flip both"
web api empty query string parameters," I am trying to pass multiple parameters to a httpget web api function. The key problem I am having is that empty query string parameters are being converted to null.I can solve this by creating a class like something below: But I absolutely friggin hate the idea of having to create a class for a once off use.Ive done a lot of research and am really struggling to find a way to change the default behaviour other than above. I really just want to do this: Am I missing an easy to way to change this default behaviour or what should I be looking at to impelement my own query string parser that I can apply globally?ThanksUpdateThere seems to be some confusion about my post, sorry if I wasn't clear. I will try to clarify.I want to pass in just simple primitive types to my HttpGet method as shown in the second code snippet. The problem I have is that empty string parameters will get converted to null. will produce the following values in the api: If I change the search function to use the class in the first code snippet, it will work as I want, but Im really trying to avoid using classes for api parameters in the long term. <code>  public class CuttingParams{ [DisplayFormat(ConvertEmptyStringToNull = false)] public string batch_number { get; set; } [DisplayFormat(ConvertEmptyStringToNull = false)] public string filter { get; set; } [DisplayFormat(ConvertEmptyStringToNull = false)] public string initiation_month { get; set; } [DisplayFormat(ConvertEmptyStringToNull = false)] public string initiation_year { get; set; }} [HttpGet] public object Search(string batch_number, string filter, string initiation_month, string initiation_year) { } ie. this url: http://localhost/api/cutting/search?batch_number=&filter=&intiation_month=Jan&initiation_year=2016 batch_number = nullfilter = nullinitiation_month = Janinitiation_year = 2016","Treat empty query string parameters as empty strings, without using a class for parameters"
How to filter data from Entity Data Source in Windoes form application using C# that can be editable using gridview?," I'm using C# Windows Form Application to populate data from sql server database table using Entity Framework (EFWinForms) using the following code : It works fine. When user edit,add data ; data can be saved using the following code : I want a way to filter these data throug Entity Data source so that MyDataGridView remains editable and any update done by user in filtered data can still be Saved back to database.Note: When using linq to entity to filter data it works great but it just populate a snapshot of data that can't be edited or updated by user again. <code>  MyEntityDataModel db = new MyEntityDataModel();MyEDS = new EntityDataSource();MyEDS.DbContext = db;MyDataGridView.DataSource = MyEDS;MyDataGridView.DataMember = ""MyTable""; MyEDS.SaveChanges();",How to filter data using Entity Framework in a way that DataGridView be editable and context track changes?
Merging files in folder using c#," I currently have a window-form that when a button is pressed, will merge 3 separate word docx's into one combined file. however, I want to select the containing folder (""C:\Test"") as opposed to each individual file. This will allow me to combine alot more files without having to code them into the program individually, which would make it much more practical when using.Is there any suggestions how to achieve this? this is the MsWord.merge referenced in the first section of code. i've attempted using ' lnkResult.NavigateUrl = ' however i was unsuccessful.  <code>  private void button1_Click(object sender, EventArgs e) { string document1 = @""C:\Test\Test1.docx""; string document2 = @""C:\Test\Test2.docx""; string document3 = @""C:\Test\Test3.docx""; string[] documentsToMerge = { document1, document2, document3 }; string outputFileName = String.Format(@""C:\Test\Merge\Combined.docx"", Guid.NewGuid()); MsWord.Merge(documentsToMerge, outputFileName, true);} public static void Merge(string[] filesToMerge, string outputFilename, bool insertPageBreaks, string documentTemplate) { object defaultTemplate = documentTemplate; object missing = System.Type.Missing; object pageBreak = Word.WdBreakType.wdSectionBreakNextPage; object outputFile = outputFilename; // Create a new Word application Word._Application wordApplication = new Word.Application(); try { // Create a new file based on our template Word.Document wordDocument = wordApplication.Documents.Add( ref missing , ref missing , ref missing , ref missing); // Make a Word selection object. Word.Selection selection = wordApplication.Selection; //Count the number of documents to insert; int documentCount = filesToMerge.Length; //A counter that signals that we shoudn't insert a page break at the end of document. int breakStop = 0; // Loop thru each of the Word documents foreach (string file in filesToMerge) { breakStop++; // Insert the files to our template selection.InsertFile( file , ref missing , ref missing , ref missing , ref missing); //Do we want page breaks added after each documents? if (insertPageBreaks && breakStop != documentCount) { selection.InsertBreak(ref pageBreak); } } // Save the document to it's output file. wordDocument.SaveAs( ref outputFile , ref missing , ref missing , ref missing , ref missing , ref missing , ref missing , ref missing , ref missing , ref missing , ref missing , ref missing , ref missing , ref missing , ref missing , ref missing); // Clean up! wordDocument = null; } catch (Exception ex) { //I didn't include a default error handler so i'm just throwing the error throw ex; } finally { // Finally, Close our Word application wordApplication.Quit(ref missing, ref missing, ref missing); } }}",Merging Word documents in folder using c#
Sort a List and keep a partibular element at end of list after sorting in c#," I have a list of string containing ""Others"". I am getting this list for drop down. I am sorting this list alphabetically. But I need ""Others"" always at end of list. I don't want to add this element after sorting which is one solution. Is there any other way to do the same like by using custom comparer of .Sort() method. I tried like below but no solution. and calling it as : Please help if it is possible. <code>  public class EOComparer : IComparer<string> { public int Compare(string x, string y) { if (x == null) { if (y == null) { // If x is null and y is null, they're // equal. return 0; } else { // If x is null and y is not null, y // is greater. return -1; } } else { // If x is not null... // if (y == null) // ...and y is null, x is greater. { return 1; } else { if (x.ToLower().Contains(""other"")) { return -1; } else { // If the strings are of equal length, // sort them with ordinary string comparison. // return x.CompareTo(y); } } } } EOComparer c = new EOComparer();a.Sort((x, y) => c.Compare(x.OptionValue, y.OptionValue)); return a;",Sort a List and keep a particular element at end of list after sorting
"How to bind a ""standard"" command to a MVVM ViewModel?"," According to my understanding of MVVM, it is a good practice to handle routed commands directly in the ViewModel. When a routed command is defined in a ViewModel as a RelayCommand (or DelegateCommand), it is easy to bind directly to the command like this: Command={Binding MyViewModelDefinedCommand}.Actually, for routed command that are defined outside of my ViewModel, I handle those commands in the Code behind of the View and forward calls to the ViewModel. But I find it awkward that I have to do so. It goes against recommended MVVM good practices. I think that there should be a more elegant way to achieve the job.How can I handle a ""System.Windows.Input.ApplicationCommands"" or any routed command defined outside of the Viewmodel directly in the ViewModel.In other words, for command defined outside of the ViewModel, how can I handle CommandBinding callback ""CommandExecute"" and/or ""CommandCanExecute"" to the ViewModel directly?Is that possible or not? If yes how? If no, why? <code> ",How can I handle WPF routed commands in my ViewModel without code-behind?
"How to bind a ""standard"" command to a MVVM ViewModel in XAML?"," According to my understanding of MVVM, it is a good practice to handle routed commands directly in the ViewModel. When a routed command is defined in a ViewModel as a RelayCommand (or DelegateCommand), it is easy to bind directly to the command like this: Command={Binding MyViewModelDefinedCommand}.Actually, for routed command that are defined outside of my ViewModel, I handle those commands in the Code behind of the View and forward calls to the ViewModel. But I find it awkward that I have to do so. It goes against recommended MVVM good practices. I think that there should be a more elegant way to achieve the job.How can I handle a ""System.Windows.Input.ApplicationCommands"" or any routed command defined outside of the Viewmodel directly in the ViewModel.In other words, for command defined outside of the ViewModel, how can I handle CommandBinding callback ""CommandExecute"" and/or ""CommandCanExecute"" to the ViewModel directly?Is that possible or not? If yes how? If no, why? <code> ",How can I handle WPF routed commands in my ViewModel without code-behind?
How to handle Command Callbacks (Execute and CanExecute) to ViewModel for command defined outside of the ViewModel?," According to my understanding of MVVM, it is a good practice to handle routed commands directly in the ViewModel. When a routed command is defined in a ViewModel as a RelayCommand (or DelegateCommand), it is easy to bind directly to the command like this: Command={Binding MyViewModelDefinedCommand}.Actually, for routed command that are defined outside of my ViewModel, I handle those commands in the Code behind of the View and forward calls to the ViewModel. But I find it awkward that I have to do so. It goes against recommended MVVM good practices. I think that there should be a more elegant way to achieve the job.How can I handle a ""System.Windows.Input.ApplicationCommands"" or any routed command defined outside of the Viewmodel directly in the ViewModel.In other words, for command defined outside of the ViewModel, how can I handle CommandBinding callback ""CommandExecute"" and/or ""CommandCanExecute"" to the ViewModel directly?Is that possible or not? If yes how? If no, why? <code> ",How can I handle WPF routed commands in my ViewModel without code-behind?
Duplicate requests when debugging ASP.NET on IIS Express," I noticed a strange behavior while debugging an ASP.NET Web Application (.NET 4.6.1). Whenever an HTTP error occurs (e.g. 404 or 403) the request get duplicated up to a total of 3 times.I have tested this singular issue using fiddler, and Intellitrace effectively shows me the three identical requests (even if I send just a single request).I can see the effects of this issue because any Owin middleware in the pipeline is invoked three times. A simple middleware like this: Will print three consecutive ""HIT!"" into the console.This happens only if the request generates an error, and not if the request is handled by a middleware (e.g. not if the middleware responds with a 2XX status code).What's going on?I'm running VS2015 and IIS Express 10 on Win10.[EDIT] It may be related to my Web.config configuration? I'm adding an excerpt from it. <code>  app.Use(async (c, n) =>{ Debug.WriteLine(""HIT!""); await n.Invoke();}); <system.web> <compilation debug=""true"" targetFramework=""4.6.1"" /> <httpRuntime targetFramework=""4.6.1"" enableVersionHeader=""false"" /></system.web><system.webServer> <httpProtocol> <customHeaders> <clear /> </customHeaders> <redirectHeaders> <clear /> </redirectHeaders> </httpProtocol> <security> <requestFiltering removeServerHeader=""true"" /> </security> <handlers> <remove name=""ExtensionlessUrlHandler-Integrated-4.0"" /> <remove name=""OPTIONSVerbHandler"" /> <remove name=""TRACEVerbHandler"" /> <add name=""ExtensionlessUrlHandler-Integrated-4.0"" path=""*."" verb=""*"" type=""System.Web.Handlers.TransferRequestHandler"" preCondition=""integratedMode,runtimeVersionv4.0"" /> </handlers> <modules runAllManagedModulesForAllRequests=""true"" /></system.webServer>",Duplicated requests when debugging ASP.NET on IIS Express
Deserialization of JSON using MiniJSON in Unity C#," I have a list of items send from a PHP file to unity using WWW.The WWW.text looks like: Where I trim the extra [] from the string. When I try to parse it using Boomlagoon.JSON, only the first object is retrieved. I found out that I have to deserialize() the list and have imported MiniJSON. But I am confused how to deserialize() this list. I want to loop through every JSON object and retrieve data. How can I do this in Unity using C#?The class I am using is After trimming the [] I am able to parse the json using MiniJSON. But it is returning only the first KeyValuePair. Thanks! <code>  [ { ""playerId"": ""1"", ""playerLoc"": ""Powai"" }, { ""playerId"": ""2"", ""playerLoc"": ""Andheri"" }, { ""playerId"": ""3"", ""playerLoc"": ""Churchgate"" }] public class player{ public string playerId { get; set; } public string playerLoc { get; set; } public string playerNick { get; set; }} IDictionary<string, object> players = Json.Deserialize(serviceData) as IDictionary<string, object>;foreach (KeyValuePair<string, object> kvp in players){ Debug.Log(string.Format(""Key = {0}, Value = {1}"", kvp.Key, kvp.Value));}",Serialize and Deserialize Json and Json Array in Unity
Adding clickable image/button to datagridview in c#," I'm trying to add a clickable image/button to a datagridview button column. The image/button will be an icon for play or stop. If the user clicks the play button a service on the system is started, if the user clicks the stop button a service is stopped. I already have written functions for starting and stopping the service. What I'm having difficulty with is getting the button/image to show up in the datagrid and making it clickable. Here's what I have for code: I can't work out if it would be better to use a button which is an image or an just an image that's clickable. I also can't get a button to show up correctly.ThanksBrad <code>  this.dgrdServices.RowPrePaint +=new DataGridViewRowPrePaintEventHandler(dgv_RowPrePaint);this.dgrdServices.Rows.Add();this.dgrdServices.Rows[0].Cells[0].Value = Image.FromFile(@""C:\users\brad\desktop\green-dot.gif""); this.dgrdServices.Rows[0].Cells[1].Value = ""MyServer"";this.dgrdServices.Rows[0].Cells[2].Value = ""MyService"";this.dgrdServices.Rows[0].Cells[3].Value = ""Started"";this.dgrdServices.Rows[0].Cells[4].Value = new DataGridViewButtonCell();this.dgrdServices.Rows[0].Cells[5].Value = ""Uninstall"";",DataGridView Image for Button Column
C# How to display comboBox value instead displaying name of objects," About 3 hours I am trying to solve this issue. My combo box display to me name of object instead a value for example: AThis is my class: And here is my code: In foreach I am trying to get all products and represent them in comboBox and in labels.What can I do in this situation? <code>  namespace Supermarket{ public class WhareHouseTable { public string name { get; set; } public double cost { get; set; } public string offer { get; set; } }} private void Form1_Load(object sender, EventArgs e){ List<WhareHouseTable> product = new List<WhareHouseTable>(); product.Add(new WhareHouseTable { name = ""A"", cost = 0.63, offer = ""Buy 2 for the price of 1"" }); product.Add(new WhareHouseTable { name = ""B"", cost = 0.20 }); product.Add(new WhareHouseTable { name = ""C"", cost = 0.74, offer = ""Buy 2; get B half price"" }); product.Add(new WhareHouseTable { name = ""D"", cost = 0.11 }); product.Add(new WhareHouseTable { name = ""E"", cost = 0.50, offer = ""Buy 3 for the price of 2"" }); product.Add(new WhareHouseTable { name = ""F"", cost = 0.40 }); comboBox2.DataSource = product; comboBox2.DropDownStyle = ComboBoxStyle.DropDownList; source.DataSource = product; foreach (var selected in product) { comboBox2.Text = selected.name; itemCostLabel.Text = selected.cost.ToString(); offerLabel.Text = selected.offer; }}",How to display comboBox value instead displaying name of objects
Is there a reason why a void can't return a void value?," This program compiles and runs in C++ but doesn't in a number of different languages, like Java and C#. In Java this gives a compiler error like 'Void methods cannot return a value'. But since the method being called is a void itself, it doesn't return a value. I understand that a construct like this is probably prohibited for the sake of readability. Are there any other objections?Edit: For future reference, I found some a similar question here return-void-type-in-c-and-cIn my humble opinion this question isn't answered yet. The reply 'Because it says so in the specification, move on' doesn't cut it, since someone had to write the specification in the first place. Maybe I should have asked 'What are the pros and cons of allowing returning a void type like C++'? <code>  #include <iostream>using namespace std;void foo2() { cout << ""foo 2.\n"";}void foo() { return foo2();}int main() { foo(); return 0;}","Why can a void method in C++ return a void value, but in other languages it cannot?"
"Why can a void method in C++ return a void value, but other languages cannot?"," This program compiles and runs in C++ but doesn't in a number of different languages, like Java and C#. In Java this gives a compiler error like 'Void methods cannot return a value'. But since the method being called is a void itself, it doesn't return a value. I understand that a construct like this is probably prohibited for the sake of readability. Are there any other objections?Edit: For future reference, I found some a similar question here return-void-type-in-c-and-cIn my humble opinion this question isn't answered yet. The reply 'Because it says so in the specification, move on' doesn't cut it, since someone had to write the specification in the first place. Maybe I should have asked 'What are the pros and cons of allowing returning a void type like C++'? <code>  #include <iostream>using namespace std;void foo2() { cout << ""foo 2.\n"";}void foo() { return foo2();}int main() { foo(); return 0;}","Why can a void method in C++ return a void value, but in other languages it cannot?"
ReactiveUI - {Binding } or this.Bind(...)," When using ReactiveUI, one can set the bindings in xaml ... or in code behind There seem to be certain circumstances (such as binding to child objects in a ListBox) where using the .xaml option seems the only way to goeg Am I wrong to use {Binding } or can i mix and match .xaml and code behind as i see fit?! <code>  <TextBox x:Name=""SomeProperty"" Text=""{Binding SomeProperty}"" /> this.Bind(ViewModel, vm.SomeProperty, v => v.SomeProperty.Text); <ListView> <ListView.ItemTemplate> <DataTemplate DataType=""ListViewItem""> <TextBox Text=""{Binding ChildViewModelProperty}"" /> </DataTemplate> </ListView.ItemTemplate></ListView>",ReactiveUI - Should I use {Binding } or this.Bind(...)?
C#: Why the enumeration value from a multi dimensional array does not equal to itself?," Consider: How can this be explained? It occurs in debug builds in Visual Studio 2015 when running in the x86 JIT. A release build or running in the x64 JIT prints True as expected.To reproduce from the command line: (/debug:pdbonly, /debug:portable and /debug:full also reproduce.) <code>  using System;public class Test{ enum State : sbyte { OK = 0, BUG = -1 } static void Main(string[] args) { var s = new State[1, 1]; s[0, 0] = State.BUG; State a = s[0, 0]; Console.WriteLine(a == s[0, 0]); // False }} csc Test.cs /platform:x86 /debug",Why is the enumeration value from a multi dimensional array not equal to itself?
Why the enumeration value from a multi dimensional array does not equal to itself?," Consider: How can this be explained? It occurs in debug builds in Visual Studio 2015 when running in the x86 JIT. A release build or running in the x64 JIT prints True as expected.To reproduce from the command line: (/debug:pdbonly, /debug:portable and /debug:full also reproduce.) <code>  using System;public class Test{ enum State : sbyte { OK = 0, BUG = -1 } static void Main(string[] args) { var s = new State[1, 1]; s[0, 0] = State.BUG; State a = s[0, 0]; Console.WriteLine(a == s[0, 0]); // False }} csc Test.cs /platform:x86 /debug",Why is the enumeration value from a multi dimensional array not equal to itself?
EPPlus - Store excel table column content into List," Using EPPlus, I want to read an excel table, then store all the contents from each column into its corresponding List. I want it to recognize the table's heading and categorize the contents based on that.For example, if my excel table is as below: I want the data to store in List<ExcelData> where So that I can call out the contents using the heading name. For example, when I do this: It will give me this output: This is really all I got: Please help :(I have spent long hours searching for sample code regarding this so that I can learn from it but to no avail. I also understand ExcelToLinQ is managed to do that but it can't recognize table. <code>  Id Name Gender 1 John Male 2 Maria Female 3 Daniel Unknown public class ExcelData{ public string Id { get; set; } public string Name { get; set; } public string Gender { get; set; }} foreach (var data in ThatList){ Console.WriteLine(data.Id + data.Name + data.Gender);} 1JohnMale2MariaFemale3DanielUnknown var package = new ExcelPackage(new FileInfo(@""C:\ExcelFile.xlsx""));ExcelWorksheet sheet = package.Workbook.Worksheets[1];var table = sheet.Tables.First();table.Columns.Something //I guess I can use this to do what I want",EPPlus - Read Excel Table
OWIN CookieDomain for Cross-Domain SSO," I am using OWIN Authentication for a Multi-Tenant ASP.NET MVC application.The application and authentication sits on one server in a single application but can be accessed via many domains and subdomains. For instance: I would like to allow a user to login on any of these domains and have their authentication cookie work regardless of which domain is used to access the application.This is how I have my authentication setup: I have also explicitly set a Machine Key for my application in the root web.config of my application: UpdateThis setup works as expected when I navigate between domain.com and site1.domain.com, but now it is not letting me login to differentdomain.com.I understand that cookies are tied to a single domain. But what is the easiest way of persisting a login across multiple domains? Is there a way for me to read a cookie from a different domain, decrypt it, and recreate a new cookie for the differentdomain.com? <code>  www.domain.comsite1.domain.comsite2.domain.comsite3.domain.comwww.differentdomain.comsite4.differentdomain.comsite5.differentdomain.comsite6.differentdomain.com public void ConfigureAuthentication(IAppBuilder Application){ Application.CreatePerOwinContext<RepositoryManager>((x, y) => new RepositoryManager(new SiteDatabase(), x, y)); Application.UseCookieAuthentication(new CookieAuthenticationOptions { CookieName = ""sso.domain.com"", CookieDomain = "".domain.com"", LoginPath = new PathString(""/login""), AuthenticationType = DefaultAuthenticationTypes.ApplicationCookie, Provider = new CookieAuthenticationProvider { OnValidateIdentity = SecurityStampValidator.OnValidateIdentity<UserManager, User, int>( validateInterval: TimeSpan.FromMinutes(30), regenerateIdentityCallback: (manager, user) => user.GenerateClaimsAsync(manager), getUserIdCallback: (claim) => int.Parse(claim.GetUserId())) } }); Application.UseExternalSignInCookie(DefaultAuthenticationTypes.ExternalCookie);} <configuration> <system.web> <machineKey decryption=""AES"" decryptionKey=""<Redacted>"" validation=""<Redacted>"" validationKey=""<Redacted>"" /> </system.web></configuration>",Cross-Domain OWIN Authentication for Multi-Tenanted ASP.NET MVC Application
OWIN CookieDomain for Cross-Domain SSO on Multi-Tenant ASP.NET MVC Application," I am using OWIN Authentication for a Multi-Tenant ASP.NET MVC application.The application and authentication sits on one server in a single application but can be accessed via many domains and subdomains. For instance: I would like to allow a user to login on any of these domains and have their authentication cookie work regardless of which domain is used to access the application.This is how I have my authentication setup: I have also explicitly set a Machine Key for my application in the root web.config of my application: UpdateThis setup works as expected when I navigate between domain.com and site1.domain.com, but now it is not letting me login to differentdomain.com.I understand that cookies are tied to a single domain. But what is the easiest way of persisting a login across multiple domains? Is there a way for me to read a cookie from a different domain, decrypt it, and recreate a new cookie for the differentdomain.com? <code>  www.domain.comsite1.domain.comsite2.domain.comsite3.domain.comwww.differentdomain.comsite4.differentdomain.comsite5.differentdomain.comsite6.differentdomain.com public void ConfigureAuthentication(IAppBuilder Application){ Application.CreatePerOwinContext<RepositoryManager>((x, y) => new RepositoryManager(new SiteDatabase(), x, y)); Application.UseCookieAuthentication(new CookieAuthenticationOptions { CookieName = ""sso.domain.com"", CookieDomain = "".domain.com"", LoginPath = new PathString(""/login""), AuthenticationType = DefaultAuthenticationTypes.ApplicationCookie, Provider = new CookieAuthenticationProvider { OnValidateIdentity = SecurityStampValidator.OnValidateIdentity<UserManager, User, int>( validateInterval: TimeSpan.FromMinutes(30), regenerateIdentityCallback: (manager, user) => user.GenerateClaimsAsync(manager), getUserIdCallback: (claim) => int.Parse(claim.GetUserId())) } }); Application.UseExternalSignInCookie(DefaultAuthenticationTypes.ExternalCookie);} <configuration> <system.web> <machineKey decryption=""AES"" decryptionKey=""<Redacted>"" validation=""<Redacted>"" validationKey=""<Redacted>"" /> </system.web></configuration>",Cross-Domain OWIN Authentication for Multi-Tenanted ASP.NET MVC Application
service referece proxy class renamed," I'm having my Web Application which hosts Webservices (svc) which are used in a Silverlight Webapplication. After a while I added some new stuff to my Service and now I tried to refresh my proxy classes in the Silverlight Application Project.Unfortunately, Visual Studio now generates new class names.Before I had this: but now I get a different class name (number one behind the name) Which is really bad because my Silverlight Projects have a lot webservices and these have a lot of code which uses these proxy classes.So far I found out it generates the proxy class 2 times.Some ideas why this renaming is happening? I already tried VS2015, VS2013 and also I deleted the complete reference and add it again, but it's the same. <code>  public SilverlightApplication.ServiceReferenceDoc.Document Document SilverlightApplication.ServiceReferenceDoc.Document1 Document",service reference proxy class renamed
what does this do : ModelState.IsValid," When I do a create method i bind my object in the parameter and then I check if ModelState is valid so I add to the database:But when I need to change something before I add to the database (before I change it the ModelState couldn't be valid so I have to do it)why the model state still non valid.What does this function check exactly?This is my example: <code>  [HttpPost][ValidateAntiForgeryToken]public ActionResult Create([Bind(Include = ""EncaissementID,libelle,DateEncaissement,Montant,ProjetID,Description"")] Encaissement encaissement) { encaissement.Montant = Convert.ToDecimal(encaissement.Montant); ViewBag.montant = encaissement.Montant; if (ModelState.IsValid) { db.Encaissements.Add(encaissement); db.SaveChanges(); return RedirectToAction(""Index"", ""Encaissement""); }; ViewBag.ProjetID = new SelectList(db.Projets, ""ProjetId"", ""nomP""); return View(encaissement);}",What does ModelState.IsValid do?
How to dispose memory stream that in task?," I have the following method: How to correctly dispose memoryStream that in Task? I need to dispose the memoryStream object when the task is finished. <code>  public void Write() { var tasks = new List<Task>(); while(...) { var memoryStream = new MemoryStream(...); var task = _pageBlob.WritePagesAsync(memoryStream, ... ); tasks.Add(task); } Task.WaitAll(tasks.ToArray());}",How to dispose a MemoryStream that is used in a Task?
Download to excel only works for a href links," I have a list of invoices that and I transferred them to an Excel spreadsheet. All the columns are created into the spreadsheet except for the Job Date column. That is blank in the spreadsheet. Here's the code: The sql returns all the correct information and as you can see the job date is there:But when I open the Excel file after it is created, the job date column is blank: <code>  string Directory = ConfigurationSettings.AppSettings[""DownloadDestination""] + Company.Current.CompCode + ""\\"";string FileName = DataUtils.CreateDefaultExcelFile(Company.Current.CompanyID, txtInvoiceID.Value, Directory);FileInfo file = new FileInfo(FileName);Response.Clear();Response.ContentType = ""application/x-download"";Response.AddHeader(""Content-Length"", file.Length.ToString());Response.AddHeader(""Content-Disposition"", ""attachment; filename="" + file.Name);Response.CacheControl = ""public"";Response.TransmitFile(file.FullName);Response.Flush();Context.ApplicationInstance.CompleteRequest();public static string CreateDefaultExcelFile(int CompanyID, string InvoiceNo, string CreateDirectory){ List<MySqlParameter> param = new List<MySqlParameter>{ { new MySqlParameter(""CompanyID"", CompanyID) }, { new MySqlParameter(""InvoiceNo"", InvoiceNo) } }; DataTable result = BaseDisplaySet.CustomFill(BaseSQL, param); string FileName = CreateDirectory + ""InvoiceFile_"" + DateTime.Now.ToString(""yyyyMMddhhmmssff"") + "".""; FileName += ""xlsx""; XLWorkbook workbook = new XLWorkbook(); workbook.Worksheets.Add(result, ""Bulk Invoices""); workbook.SaveAs(FileName); return FileName;} private const string BaseSQL = "" SELECT q.InvoiceNo AS InvoiceNumber, j.JobNo, j.JobDate AS JobDate, "" + "" (SELECT Name FROM job_address WHERE AddressType = 6 AND JobID = j.ID LIMIT 0,1) AS DebtorName, "" + "" (SELECT CONCAT(Name,CONCAT(',',Town)) FROM job_address WHERE AddressType = 3 AND JobID = j.ID LIMIT 0,1) AS CollectFrom, "" + "" (SELECT CONCAT(Name,CONCAT(',',Town)) FROM job_address WHERE AddressType = 2 AND JobID = j.ID LIMIT 0,1) AS DeliverTo, "" + "" deladd.Town AS DeliverToTown, deladd.County AS DeliveryToCounty, "" + "" (SELECT DocketNo FROM job_dockets WHERE JobID = j.ID LIMIT 0,1) AS DocketNo, "" + "" SUM(j.DelAmt) AS DelAmount, "" + "" (SELECT CAST(group_concat(DISTINCT CONCAT(AdvisedQty,' ',PieceType) separator ',') AS CHAR(200)) FROM job_pieces WHERE JobID = j.ID GROUP BY JobID ) AS PieceBreakDown "" + "" FROM Invoice q "" + "" LEFT JOIN customer c ON q.accountcode = c.ID "" + "" INNER JOIN job_new j ON q.JobID = j.ID "" + "" LEFT JOIN job_address coladd ON coladd.JobID = j.ID AND coladd.AddressType = 3 "" + "" LEFT JOIN job_address deladd ON deladd.JobID = j.ID AND deladd.AddressType = 2 "" + "" WHERE q.IsActive = 1 AND q.Company_ID = ?CompanyID AND q.InvoiceNo = ?InvoiceNo "" + "" group by j.id"";",Column missing from excel spreedshet
Double not stored correctly in MySql Database," I have an MVC application which has a restful service that updates latitude and longitude to the database. I am sending the values to the API as string and its converted to Double before it is stored in database as Double. Here is the code I am using to convert string to double: When its stored in database I am missing decimal points. For example: 53.345634 is stored as 53345634I have this working on development environment running on Windows 2012. But when its moved to Windows 2008 production server I am seeing this issue. <code>  Double _latitude, _longitude;try{ Double.TryParse(lattitude, NumberStyles.Any,CultureInfo.CurrentCulture, out _latitude); Double.TryParse(Longtitude, NumberStyles.Any,CultureInfo.CurrentCulture, out _longitude);}catch(Exception e){ _latitude = 0; _longitude = 0;}",Double is not stored correctly in MySQL database
How to decide has the computer a wifi," Which way can I decide the computer has a wifi adapter?When I test my code it works, but I am uncertain, will it always work? <code>  private bool hasWifi(){ try { WlanClient wlanclient = new WlanClient(); } catch (System.ComponentModel.Win32Exception except) { return false; } return true;}",How to determine if the computer has a wifi adapter?
how to retrive the jsonresuli type data in c sharp," I have the following Action in my layouts Controller I am calling this Action from another controller like so: My question is: how can I get the data from result object? <code>  public JsonResult getlayouts(int lid){ List<layouts> L = new List<layouts>(); L = db.LAYOUTS.Where(d => d.seating_plane_id == lid).ToList() return new JsonResult { Data = L, JsonRequestBehavior = JsonRequestBehavior.AllowGet };} layoutsController L = new layoutsController();JsonResult result = L.getlayouts(lid);",How to retrieve JsonResult data
how to retrive the jsonresult type data," I have the following Action in my layouts Controller I am calling this Action from another controller like so: My question is: how can I get the data from result object? <code>  public JsonResult getlayouts(int lid){ List<layouts> L = new List<layouts>(); L = db.LAYOUTS.Where(d => d.seating_plane_id == lid).ToList() return new JsonResult { Data = L, JsonRequestBehavior = JsonRequestBehavior.AllowGet };} layoutsController L = new layoutsController();JsonResult result = L.getlayouts(lid);",How to retrieve JsonResult data
Localization in seperate project Asp.net Core MVC," I just upgraded to Rc2 and what used to work no longer does. I have a couple of resx files in a separate project and I use a custom class to access the data. Now I get the following error when running it:MissingManifestResourceException: Could not find any resources appropriate for the specified culture or the neutral culture. Make sure ""GarageWeb.Core.CoreResources.resources"" was correctly embedded or linked into assembly ""GarageWeb.Core"" at compile time, or that all the satellite assemblies required are loadable and fully signed.EDIT: I simplified this and create a console app that is stripped of everything but what is required to reproduce the error here: https://github.com/GarageWeb/ResourceTestHere is the class that accesses the resources: It fails here: var localizedString = _coreGlobalResources.ResourceManager.GetString(resourceKey);Any ideas? Is there a new way to embed these resources?  <code>  public class ResourceService : IResourceService{ private readonly ILoggingService _loggingService; private readonly ICoreGlobalResourceService _coreGlobalResources; private readonly ISiteGlobalResourceService _siteGlobalResources; public ResourceService(ILoggingService loggingService, ICoreGlobalResourceService coreGlobalResourceService, ISiteGlobalResourceService siteGlobalResources) { _loggingService = loggingService; _coreGlobalResources = coreGlobalResourceService; _siteGlobalResources = siteGlobalResources; } public string GetGlobalText(string resourceKey, bool includeBrackets = true) { var localizedString = _coreGlobalResources.ResourceManager.GetString(resourceKey); if (string.IsNullOrEmpty(localizedString)) { localizedString = _siteGlobalResources.ResourceManager.GetString(resourceKey); } if (string.IsNullOrEmpty(localizedString) && includeBrackets) { _loggingService.LogInvalidResource(resourceKey); } if (includeBrackets) { return localizedString ?? ""["" + resourceKey + ""]""; } return localizedString ?? resourceKey; } public string BuildMessageFromResource(string resourceKey, string placeHolderResourceKey1, bool includeBrackets = true) { var errorString = string.Format(CultureInfo.CurrentCulture, GetGlobalText(resourceKey, includeBrackets), GetGlobalText(placeHolderResourceKey1, includeBrackets)); return errorString; } public string BuildMessageFromResourceAndArray(string resourceKey, string[] arrayOfValues, bool includeBrackets = true) { var placeHolderValue = """"; for (var i = 0; i < arrayOfValues.Length; i++) { if (i + 1 == arrayOfValues.Length) { placeHolderValue += GetGlobalText(arrayOfValues[i], includeBrackets); } else { placeHolderValue += GetGlobalText(arrayOfValues[i], includeBrackets) + "", ""; } } var errorString = string.Format(CultureInfo.CurrentCulture, GetGlobalText(resourceKey, includeBrackets), placeHolderValue); return errorString; } public string BuildMessageFromResourceAndTwoArrays(string resourceKey, string[] firstArrayOfValues, string[] secondArrayOfValues, bool includeBrackets = true) { var placeHolderOneValue = """"; var placeHolderTwoValue = """"; for (var i = 0; i < firstArrayOfValues.Length; i++) { if (i + 1 == firstArrayOfValues.Length) { placeHolderOneValue += GetGlobalText(firstArrayOfValues[i], includeBrackets); } else { placeHolderOneValue += GetGlobalText(firstArrayOfValues[i], includeBrackets) + "", ""; } } for (var i = 0; i < secondArrayOfValues.Length; i++) { if (i + 1 == secondArrayOfValues.Length) { placeHolderTwoValue += GetGlobalText(secondArrayOfValues[i], includeBrackets); } else { placeHolderTwoValue += GetGlobalText(secondArrayOfValues[i], includeBrackets) + "", ""; } } var errorString = string.Format(CultureInfo.CurrentCulture, GetGlobalText(resourceKey, includeBrackets), placeHolderOneValue, placeHolderTwoValue); return errorString; } public string BuildMessageFromResource(string resourceKey, string placeHolderResourceKey1, string placeHolderResourceKey2, bool includeBrackets = true) { var errorString = string.Format(CultureInfo.CurrentCulture, GetGlobalText(resourceKey, includeBrackets), GetGlobalText(placeHolderResourceKey1, includeBrackets), GetGlobalText(placeHolderResourceKey2, includeBrackets)); return errorString; } public string BuildMessageFromResource(string resourceKey, string placeHolderResourceKey1, string placeHolderResourceKey2, string placeHolderResourceKey3, bool includeBrackets = true) { var errorString = string.Format(CultureInfo.CurrentCulture, GetGlobalText(resourceKey, includeBrackets), GetGlobalText(placeHolderResourceKey1, includeBrackets), GetGlobalText(placeHolderResourceKey2, includeBrackets), GetGlobalText(placeHolderResourceKey3, includeBrackets)); return errorString; }}",Localization in separate project Asp.net Core MVC
C# Protected Internal method not allowing Internal Class as parameter, This code does not compile: The compile fails stating:Inconsistent accessibility: parameter type Foo is less accessible than method SomeBaseClass.ProcessFoo <code>  internal class Foo {}public abstract class SomeBaseClass{ protected internal void ProcessFoo(Foo value) { // doing something... }},Protected Internal method not allowing Internal Class as parameter
Why C# chose to use contravariance (not covariance) in input parameters in delegate?," When we have a Base class that inherits BBase and a Derived class that specializes it, let's say there is a delegate that requires Base as an input. In the usage of the delegate, it is not allowed to use BaseDelegate b2 = TakeDerived; as the input is contravariant. TakeBBase can be assigned to BaseDelegate. It's also interesting to see that we can assign subclasses of Base class to the Base type parameter in the delegate. covariance/contravariance rule does not seem to work in the previous example. Why does C# choose to use contravariance (not covariance) in input parameters in delegate? When covariance/contravariance rule is working in C#? What other cases than delegate use covariance/contravariance and why? <code>  using System;class BBase {}class Base : BBase {}class Derived : Base {}delegate void BaseDelegate(Base b); class MainClass{ static void TakeBBase(BBase bb) {} static void TakeBase(Base b) {} static void TakeDerived(Derived d) {} static void Main(string[] args) { BaseDelegate b1 = TakeBase; b1(new Derived()); b1(new Base()); // ERROR // parameters do not match delegate // `BaseDelegate(Base)' parameters // The contract of b2 is to expect only Base //BaseDelegate b2 = TakeDerived; BaseDelegate b2 = TakeBBase; b2(new Derived()); b2(new Base());",Why does C# use contravariance (not covariance) in input parameters with delegate?
Why does C# use contravariance (not covariance) in input parameters in delegate?," When we have a Base class that inherits BBase and a Derived class that specializes it, let's say there is a delegate that requires Base as an input. In the usage of the delegate, it is not allowed to use BaseDelegate b2 = TakeDerived; as the input is contravariant. TakeBBase can be assigned to BaseDelegate. It's also interesting to see that we can assign subclasses of Base class to the Base type parameter in the delegate. covariance/contravariance rule does not seem to work in the previous example. Why does C# choose to use contravariance (not covariance) in input parameters in delegate? When covariance/contravariance rule is working in C#? What other cases than delegate use covariance/contravariance and why? <code>  using System;class BBase {}class Base : BBase {}class Derived : Base {}delegate void BaseDelegate(Base b); class MainClass{ static void TakeBBase(BBase bb) {} static void TakeBase(Base b) {} static void TakeDerived(Derived d) {} static void Main(string[] args) { BaseDelegate b1 = TakeBase; b1(new Derived()); b1(new Base()); // ERROR // parameters do not match delegate // `BaseDelegate(Base)' parameters // The contract of b2 is to expect only Base //BaseDelegate b2 = TakeDerived; BaseDelegate b2 = TakeBBase; b2(new Derived()); b2(new Base());",Why does C# use contravariance (not covariance) in input parameters with delegate?
.net-core CreateType missing from TypeBuilder. How to port this?, Trying to port an application from .net 4.5 to .net core for a client. I'm noticing that CreateType is no longer part of TypeBuilder. I've searched through multiple of the new reflection libs with no luck. Does anyone know how to port this?Code in question: <code>  typeBuilder.CreateType(),CreateType missing from TypeBuilder. How to port this?
How do I pass a null value into a parameter for a sql command," Before anyone comments that this has been answered before in other question I KNOW that..but in spite of the answers I have reviewed atAssign null to a SqlParameterSending null parameters to Sql ServerBest method of assigning NULL value to SqlParameterand even my own question atSQLCommand.CreateParameter.Value = DBNull.Value not returning resultsI am unable to get my query to return values with null parametersI have tried simplifying my code so it can be seen here.I have also tried this with I have tried variations on this where I just did And I have tried using the query I tried explicitly declaring the parameter as nullable Which for some reason I thought I had working hence my reason for accepting the answer I did but I was mistaken that just returns everything to me no matter what the value.I know the command object is connecting and returns data because if I put in a valid value (say 27) it returns the record...I also know that there are records with Null as the value...but no matter how I try to set it up I keep getting nothing returns when I try to pass a null value as the parameter.Anyone who can help me figure out what I'm doing wrong here I would be grateful. <code>  int? i = null; SqlConnection connection = new SqlConnection(Properties.Settings.Default.connstring.ToString()); SqlCommand cmd = new SqlCommand(); cmd.Connection = connection; cmd.CommandText = ""Select * from view_nests where parent_pk = @parent_pk""; cmd.Parameters.AddWithValue(""@parent_pk"", i ?? Convert.DBNull); cmd.Connection.Open(); var dataReader = cmd.ExecuteReader(); var dataTable = new DataTable(); dataTable.Load(dataReader); cmd.Connection.Close(); cmd.Parameters.AddWithValue(""@parent_pk"", DBNull.Value); cmd.CommandText = ""Select * from view_nests where parent_pk = @parent_pk or @parent_pk Is Null""; cmd.Parameters.AddWithValue(""@parent_pk"", i ?? Convert.DBNull).IsNullable = true;",How do I pass a null value into a parameter for a SqlCommand
C# + Firebird 3 - SRP authentication model," I am testing the connection firebird 3 using C #. The version of what I'm used is the latest : Firebird ADO.NET Provider 5.0. But when you make the connection , the error occurs ""Incompatible wire encryption levels requested on client and server""."" At ""Does Firebird ADO.NET 4.10.0.0 Data provider work with Firebird 3.0?"", there are some suggestions for enabling authentication in legacy model or create legacy user.But my question is if really does not support to new SRP authentication model in version 5.0 Net Provider? <code> ",Incompatible wire encryption levels requested on client and server with Firebird ado.net provider
C# Search bytes into byte array," I have a byte array and wish to find the ""occurrences"" of some bytes. For example 00 69 73 6F 6D in a very large byte array (> 50/100 Megabytes)OReven better a reverse operation: Searching the most common pattern without knowing it the code should be able to read and find it from the file. <code> ",Find byte sequence within a byte array
How can i use Left join in linq that we use in sql?," How can I use Left join in Linq that I write SQL query? <code>  select p.Name, p.Family, E.EmployTypecode, E.employtypeName, E.EmplytyppeTye from personnel as pleft join Employee as E on E.EmployTypecode = p.EmployTypecode ",How can I use Left join in linq that we use in sql?
Is there any way to make base view component asp.net core rc2?," In rc1 you can make BaseViewComponent and then inherit it and use it without any problems like baseController, but after migrating my project to rc2 I recieve that error Could: not find an 'Invoke' or 'InvokeAsync' method for the view component 'ForumSystem.Web.ViewComponents.BaseViewComponent'.Is there any way to do that in rc2? <code> ",Is there any way to make base view component ASP.NET Core?
"When a child class is cast to a parent class, is the child-specific data lost?"," I have a function that makes a list of animals, some of which are dogs, and some of which are just animals. That function returns that list to a different function that wants to extract out just the dogs, which is possible because the Animal class has a bool isDog. My question is, is it possible to extract the dog-specific(child-specific) data from the animal(parent) class, aka. can an animal still be a dog under the hood? Things I have tried:Extracting out the dogs using the isDog bool and then calling the Dogconstructor to make a new one outside of the function that returns alist of animalsGiving the dog class a constructor that takes in an animal, but stillno way to preserve tail lengthI have these two interfaces and these two implementations and this is the current state of the two functions Thanks <code>  public interface IAnimal{ string eyeColor; int numLegs;}public interface IDog: IAnimal{ double tailLength;} public class Animal: IAnimal{ public string eyeColor{get;set} public int numLegs {get; set;} public bool isDog; public Animal(string eyes, int legs){ this.eyeColor = eyes; this.numLegs = legs this.isDog = false; }}public class Dog: Animal, IDog{ public double tailLength {get;set;} public Dog(double tail, string eyes) { this.tailLength = tail; this.eyeColor = eyes; this.numLegs = 4; this.isDog = true; }} List<Animal> getAnimals(){ List<Animal> animals; Animal a1 = new Animal(""Blue"", 4); animals.Add(a1); Animal a2 = new Animal(""Green"", 2); animals.Add(a2); Dog d1 = new Dog(2.3, ""Brown""); animals.Add(d1); Dog d2 = new Dog(3.5, ""Black""); animals.Add(d2); return animals;}void foo(){ IEnumerable<IAnimal> sample = getAnimals(); var x = totalTailLength(sample.Where(d => d.isDog));}double totalTailLength(IEnumerable<IDog> dogs){ return dogs.Sum(d => d.tailLength);}","When a Child class is added to a List<parent>, is the child-specific data lost?"
How To Convert String Array to Long Array C#," I am in bust at the moment, I have this string array: I need to convert them To long array data type in C#: But I have no idea how, is it even possible?  <code>  string[] StringNum = { ""4699307989721714673"", ""4699307989231714673"", ""4623307989721714673"", ""4577930798721714673"" }; long[] LongNum= { 4699307989721714673, 4699307989231714673, 4623307989721714673, 4577930798721714673 };",How to convert string array to long array?
Ienumerable Concat not working," Below is the code: I am not able to get all the records in tst, it is giving me records only for the last value in array.So if my array contains 1,2,3,4 I am getting records only for the 4. Whereas i need all the result for 1,2,3 and 4 get appended in tst.Any help will be appreciated. <code>  string[] values = Acode.Split(',');IEnumerable<Test> tst = null;foreach (string a in values){ if (tst== null) tst = entities.Test.Where(t=> (t.TCode == Convert.ToInt16(a))); else tst.Concat(entities.Test.Where(g => (g.TCode == Convert.ToInt16(a))));}return tst.ToList();",Enumerable.Concat not working
Web API 2 returns invalid or corrupt file with StreamContent or ByteArrayContent," I'm trying to return a file in a ASP.NET Web API Controller. This file is a dynamically-generated PDF saved in a MemoryStream.The client (browser) receives the file successfully, but when I open the file, I see that all the pages are totally blank.The thing is that if I take the same MemoryStream and write it to a file, this disk file is displayed correctly, so I assume that the problem is related to the file transfer via Web.My controller looks like this: Just to try, if I write the stream to disk, it's displayed correctly: The differences are:PDF saved on disk: 34KBPDF transferred via web: 60KB (!)If I compare both files contents, the main differences are:File DifferencesOn the left is the PDF transferred via web; on the right, the PDF saved to disk.Is there something wrong with my code?Maybe something related to encodings?Thanks! <code>  [HttpGet][Route(""export/pdf"")]public HttpResponseMessage ExportAsPdf(){ MemoryStream memStream = new MemoryStream(); PdfExporter.Instance.Generate(memStream); memStream.Position = 0; HttpResponseMessage result = new HttpResponseMessage(HttpStatusCode.OK); result.Content = new ByteArrayContent(memStream.ToArray()); //OR: new StreamContent(memStream); return result;} [HttpGet][Route(""export/pdf"")]public HttpResponseMessage ExportAsPdf(){ MemoryStream memStream = new MemoryStream(); PdfExporter.Instance.Generate(memStream); memStream.Position = 0; using (var fs = new FileStream(""C:\\Temp\\test.pdf"", FileMode.OpenOrCreate, FileAccess.ReadWrite)) { memStream.CopyTo(fs); } return null;}",Angular/Web API 2 returns invalid or corrupt file with StreamContent or ByteArrayContent
WebApi 2 POSt with single string parameter not wokring," I have the following controller: WebApi config I use this js code to call the api I get a 405 method not allowed (post)  <code>  public class ValuesController : ApiController{ // POST api/values public IHttpActionResult Post(string filterName) { return new JsonResult<string>(filterName, new JsonSerializerSettings(), Encoding.UTF8, this); }} config.Routes.MapHttpRoute( name: ""DefaultApi"", routeTemplate: ""api/{controller}/{id}"", defaults: new { id = RouteParameter.Optional }); $.ajax({ url: ""/api/values/"", type: ""POST"", dataType: 'json', data: { filterName: ""Dirty Deeds"" }, success: function (result) { console.log(result); }, error: function (xhr, status, p3, p4) { var err = ""Error "" + "" "" + status + "" "" + p3; if (xhr.responseText && xhr.responseText[0] == ""{"") err = JSON.parse(xhr.responseText).message; console.log(err); }});",WebApi 2 POST with single string parameter not working
WebApi 2 POST with single string parameter not wokring," I have the following controller: WebApi config I use this js code to call the api I get a 405 method not allowed (post)  <code>  public class ValuesController : ApiController{ // POST api/values public IHttpActionResult Post(string filterName) { return new JsonResult<string>(filterName, new JsonSerializerSettings(), Encoding.UTF8, this); }} config.Routes.MapHttpRoute( name: ""DefaultApi"", routeTemplate: ""api/{controller}/{id}"", defaults: new { id = RouteParameter.Optional }); $.ajax({ url: ""/api/values/"", type: ""POST"", dataType: 'json', data: { filterName: ""Dirty Deeds"" }, success: function (result) { console.log(result); }, error: function (xhr, status, p3, p4) { var err = ""Error "" + "" "" + status + "" "" + p3; if (xhr.responseText && xhr.responseText[0] == ""{"") err = JSON.parse(xhr.responseText).message; console.log(err); }});",WebApi 2 POST with single string parameter not working
How to add link parameter to asp taghelpers in ASP.NET MVC6," I have a lot of experience with ASP.NET MVC 1-5. Now I learn ASP.NET Core MVC and have to pass a parameter to link in page. For example I have the following Action How can I implement the link for this action using tag helpers? <code>  [HttpGet] public ActionResult GetProduct(string id) { ViewBag.CaseId = id; return View(); } <a asp-controller=""Product"" asp-action=""GetProduct"">ProductName</a>",How to add link parameter to asp tag helpers in ASP.NET Core MVC
Trying to understand ?. operator in C#," I have this very simple example: The line if (list?.Count > 0) compiles perfectly which means that if list is null, the expression Count > 0 becomes false by default.However, the line if (a?.B) throws a compiler error saying I can't implicitly convert bool? to bool.Why is one different from the other? <code>  class Program{ class A { public bool B; } static void Main() { System.Collections.ArrayList list = null; if (list?.Count > 0) { System.Console.WriteLine(""Contains elements""); } A a = null; if (a?.B) { System.Console.WriteLine(""Is initialized""); } }}",Trying to understand ?. (null-conditional) operator in C#
StatusStrip label not visible when less space," I have a StatusStrip docked to the bottom of a C# Form, it contains a label, the text in it displays fine, except when there is longer length of text then it does not display at all, and I have to widen the form and then all of a sudden it appears. Is it possible to show it in the form below: So that the user knows that the app is showing something and then he can widen it himself, because when it is not visible at all, it does not indicate anything to user. <code>  This is a very long tex...",StatusStrip label not visible when text too long
Unable to find Use.RunTimePageInfo() method in startup.cs file in aspnet core," I'm following Scott Allen's Asp.Net core Pluralsight course in Ubuntu 16.04 .Net Core 1.0.0 framework. I'm unable to find the app.UseRuntimeInfoPage method in Configure method in StartUp.cs file, even though I have included Microsoft.AspNetCore.Diagnostics. Does the framework have limitations for the non-windows operating systems in terms of the features provided?StartUp.cs code from Scott Allen's course <code>  using Microsoft.AspNet.Builder;using Microsoft.AspNet.Hosting;using Microsoft.AspNet.Http;using Microsoft.Extensions.DependencyInjection;using Microsoft.Extensions.Configuration;using OdeToFood.Services;namespace OdeToFood{ public class Startup { public Startup() { var builder = new ConfigurationBuilder() .AddJsonFile(""appsettings.json""); Configuration = builder.Build(); } public IConfiguration Configuration { get; set; } // This method gets called by the runtime. Use this method to add services to the container. // For more information on how to configure your application, visit http://go.microsoft.com/fwlink/?LinkID=398940 public void ConfigureServices(IServiceCollection services) { services.AddMvc(); services.AddSingleton(provider => Configuration); services.AddSingleton<IGreeter, Greeter>(); } // This method gets called by the runtime. // Use this method to configure the HTTP request pipeline. public void Configure( IApplicationBuilder app, IHostingEnvironment environment, IGreeter greeter) { app.UseIISPlatformHandler(); if (environment.IsDevelopment()) { app.UseDeveloperExceptionPage(); } app.UseRuntimeInfoPage(""/info""); app.UseFileServer(); app.UseMvcWithDefaultRoute(); app.Run(async (context) => { var greeting = greeter.GetGreeting(); await context.Response.WriteAsync(greeting); }); } // Entry point for the application. public static void Main(string[] args) => WebApplication.Run<Startup>(args); }}",Unable to find Use.RunTimePageInfo() method in startup.cs file in asp.net core
How do you manually set the logged in Identity User?," I am using ASP.NET Identity with an ADFS server. For development purposes, I want to avoid using the ADFS server when I'm in a network environment where I can't reach the ADFS server. That's why I added a simple controller action in my HomeController that manually sets the currently logged in user: And the Owin Configuration method: Commenting out the part where I use WsFederation Authentication is no problem, that way there is no link to my current ADFS server.The problem: When I'm redirected to the Home/Index action (that has the Authorize attribute), ASP.NET Identity doesn't recognize my ClaimsPrincipal as a valid login, so I'm redirected to the Home/Login action, which creates a loop between Home/Login and Home/Index constantly.My question: how do I make ASP.NET accept the ClaimsPrincipal created above as a valid login? <code>  #if DEBUG [AllowAnonymous] public ActionResult LogIn() { var claims = new List<Claim>(); claims.Add(new Claim(ClaimTypes.NameIdentifier, ""tester"")); System.Web.HttpContext.Current.User = new ClaimsPrincipal(new ClaimsIdentity(claims)); System.Threading.Thread.CurrentPrincipal = System.Web.HttpContext.Current.User; return Redirect(""Home/Index""); }#endif public void Configuration(IAppBuilder app) { app.SetDefaultSignInAsAuthenticationType(CookieAuthenticationDefaults.AuthenticationType); app.UseCookieAuthentication(new CookieAuthenticationOptions() { }); app.UseWsFederationAuthentication( new WsFederationAuthenticationOptions { Wtrealm = realm, MetadataAddress = adfsMetadata }); }",How do you manually set a logged in Identity User?
Entity Framework 6 : wondering about Performance and Optimisation," I'm currently using Entity Framework to build a Forum using ASP.NET MVCI Have 3 principal Models[Category] 1--* [Forum] 1--* [Post]If i Had 5 Categories and each one have 4 Forums and each Forum have 1000 post and I want to display only Categories, When I do that is that mean i have selected the 20000 posts too ??Because each Category object have a List<'Forum'> and each Forum object have List<'Post'>due to mapping and relations <code> ",How to prevent Entity Framework from loading all child objects
Difference between '/' and '\' when useing file path names, I was wondering about the difference between \ and / in file paths. I have noticed that sometimes a path contains /and sometimes it is with \.It would be great if anyone can explain when to use \ and /. <code> ,Difference between forward slash (/) and backslash (\) in file path
Difference between '/' and '\' when using file path names, I was wondering about the difference between \ and / in file paths. I have noticed that sometimes a path contains /and sometimes it is with \.It would be great if anyone can explain when to use \ and /. <code> ,Difference between forward slash (/) and backslash (\) in file path
Difference between '/' and '\' in file path, I was wondering about the difference between \ and / in file paths. I have noticed that sometimes a path contains /and sometimes it is with \.It would be great if anyone can explain when to use \ and /. <code> ,Difference between forward slash (/) and backslash (\) in file path
Insert multiple rows with parametres Sql Server," I am trying to figure out if there is a way to perform a multiple values insert in Sql Server while using parameters, to be precise, having a command like this: Is there a way to perform a multiple values single insert with parameters taking into account that parameters may be different for each value? (Example: tagID may be always different)I have been searching in Internet but no luck so far, thanks in advance, greetings. <code>  com = new SqlCommand(""insert into myTable values (@recID,@tagID)"", con);com.Parameters.Add(""@recID"", SqlDbType.Int).Value = recID;com.Parameters.Add(""@tagID"", SqlDbType.Int).Value = tagID;com.ExecuteNonQuery();",Insert multiple rows with parameters Sql Server
"""[DllImport(""__Internal"")]"" what does this ""__Internal"" means ?"," I am working with unity for an iOS game. For unlocking achievement I need to access a ""Achievement.mm"" file from my c# code: I got this code from a forum. But, what does the ""__Internal"" means ? <code>  [DllImport(""__Internal"")] private static extern void GKAchievement(string achievementID, float progress, bool value);","""[DllImport(""__Internal"")]"" - what does the ""__Internal"" mean?"
"""[DllImport(""__Internal"")]"" what does this ""__Internal"" means?"," I am working with unity for an iOS game. For unlocking achievement I need to access a ""Achievement.mm"" file from my c# code: I got this code from a forum. But, what does the ""__Internal"" means ? <code>  [DllImport(""__Internal"")] private static extern void GKAchievement(string achievementID, float progress, bool value);","""[DllImport(""__Internal"")]"" - what does the ""__Internal"" mean?"
Add new byte in array and shift the rest of the bytes c#, I have an array look like this 17 8B 01 00 03 EA 05 00 14 0A 00 00 03 EA 05 00 14 0A 00 00 00 00 00 FF FF FF FF FF FF FF FF FF I want to add an extra byte 0x00 after index 1 (8B) and move the rest of the bytes to right. The array is 32 byte long and after adding the extra byte (0x00) I want it to remain the same length as 32 bytes I dont care if I remove the FF at the end because its spare byte. So the new array should look like 17 8B 00 01 00 03 EA 05 00 14 0A 00 00 03 EA 05 00 14 0A 00 00 00 00 00 FF FF FF FF FF FF FF FF.How can I do that in c#? <code> ,Add new byte in array and shift the rest of the bytes
ASP.NET Core 1.0 on IIS error 502.5, I just updated my server (Windows 2012R2) to .Net Core 1.0 RTM Windows Hosting pack from the previous .Net Core 1.0 RC2. My app works on my PC without any issues but the server keeps showing: It previously worked with the RC2 version. Don't know what could go wrong.This is all event viewer says: the worst part is that app logs are empty! I mean those stdout_xxxxxxxxx.log files are completely empty and all have 0 byte size.What should I do?? How can I know the cause of error when it's not logged?? <code>  HTTP Error 502.5 - Process FailureCommon causes of this issue:The application process failed to startThe application process started but then stoppedThe application process started but failed to listen on the configured port Failed to start process with the commandline 'dotnet .\MyWebApp.dll'. Error code = '0x80004005'.,Why is IIS serving a 502.5 for my ASP.NET Core 1.0 app?
Is ApiController gets deprecated in .NET CORE," Is it true that ""ApiController will get deprecated in .NET Core""? Asking since I'm planning to use it in new projects. <code> ",Is ApiController deprecated in .NET Core
Is ApiController deprecated in .NET CORE?," Is it true that ""ApiController will get deprecated in .NET Core""? Asking since I'm planning to use it in new projects. <code> ",Is ApiController deprecated in .NET Core
C# Warning: Object defines operator == or operator != but does not override Object.Equals(object o)," I'm programming in C# Unity and have really annoying problem - I want to define special Pair class with following relations: Which gives me following warning:Warning CS0660: 'Pair' defines operator == or operator != but doesnot override Object.Equals(object o) (CS0660) (Assembly-CSharp)But also when I spawn two objects of Pair type with same First integer, their == operator returns True (as I want). When I only declare Equals function, same == operator returns False value (I understand that somehow Unity compares their addressees in memory), with no warnings. Is there any method to avoid warnings and still get True value of == operator? <code>  public class Pair<T1>{ public int First; public T1 Second; public bool Equals(Pair<T1> b){ return First == b.First; } public static bool operator==(Pair<T1> a, Pair<T1> b){ return a.First == b.First; } public static bool operator!=(Pair<T1> a, Pair<T1> b){ return a.First != b.First; }}",Warning: Object defines operator == or operator != but does not override Object.Equals(object o)
Rendering ViewComponent with ajax don't work in Edge/IE11 - ASP.NET Core," I have a simple ViewComponent works correctly in the browser chrome and Firefox but do not work in a browser Edge \ IE 11.The component shows the time (just for example).Chrome and firefox time is displayed.Edge Browser \ IE 11, time is displayed only the first time the page is up and remains so, time is ""frozen"".butWhen I open the browser Edge development tools as well as in IE 11, the component starts to work properly and current time is displayed (just like other browsers)And when I close the F12 development tools, component stops working (time ""frozen"").And it repeated - F12 open the component works, F12 Close component stops working.Am I missing something here ?Attaching the simple code of the processThank youHomeController: GetTimeViewComponent: Default: <code>  public IActionResult GetTime(){ return ViewComponent(""GetTime""); //// var time = DateTime.Now.ToString(""h:mm:ss""); //// return Content($""The current time is {time}"");} public class GetTimeViewComponent : ViewComponent{ public IViewComponentResult Invoke() { var model = new string[] { ""Hello"", DateTime.Now.ToString(""h:mm:ss"") , ""the"", ""view"", ""component."" }; return View(""Default"", model); }} @model string[]<ul> @foreach (var item in Model) { <li class=""text-danger"">@item</li> }</ul>**Index**<div id=""myComponentContainer"">@await Component.InvokeAsync(""GetTime"") </div>**Js / Ajax**$(function () { var refreshComponent = function () { $.get(""Home/GetTime"", function (data) { $(""#myComponentContainer"").html(data); });}; $(function () { window.setInterval(refreshComponent, 1000); });});",Rendering ViewComponent with ajax don't work in Edge/IE11
.Net Core / Console Applicatin / Configuration / XML," My first little venture into the .Net Core libraries using the new ConfigurationBuilder, and Options pattern.Lot's of good examples here: https://docs.asp.net/en/latest/fundamentals/configuration.htmland a good copy of the example hereItem 1. it says this can be used with non MVC applications, but no examples on how to use it without MVC - particularly if you are using a custom, strongly-typed class. I would like to see an example of showing the setup of DependencyInjection, Configuration, and Logging using a Console application.Item 2. it says you can write back, but no examples or documentation as to how to persist any changes back to the file store. I would like to see an example of how persist changes back into the configuration using a strongly typed class. In both Json or XML?Item 3. all examples require a hand bombed initial file - would like to see an example where the initial json/xml file is created from a strongly-typed class (comes in handy when there are many parameters for the application).If I can spend enough time on this (rather than re-post an example already in the documentation) I'll do it! If you know of a post/documentation that will help me, I would appreciate it. <code> ",.Net Core / Console Application / Configuration / XML
Publishing appsettings.json to different enviroment," I have three files appsettings.json which is a file that I want to store ""general shared settings"", then I have appsettings.Development.json and appsettings.Production.json.When I do a publish from Visual Studio, it seems like only appsettings.json is copied and not adding / merge or even just send a simple copy the deployment folder, to me this task should be incorporated into the deployment pipeline.The question is: how can I do it? What am I missing? Is it not supposed that these actions should be already be incorporated in the process? <code> ",Publishing appsettings.json to different environment
AggregateException when calling GoogleCredentials.GetApplicationDefaultAsync()," I am trying to run the sample Vision API project. I basically copied and pasted the code Program.cs into my application and executed it.This line (which is line #36-#37 in Program.cs) throws a System.AggregateException in mscorlib.dll with Additional information: One or more errors occurred..By examining InnerException, I found out that the actual exception thrown is InvalidOperationException with Error deserializing JSON credential data..Nonetheless, my cloud project is a basic project, with a Service Account, and Cloud Vision API enabled, nothing else. I checked that my environment variable was set to the JSON file by writing: before the line above. The output of that (just before the crash) is (something like): C:\Users\me\Documents\Projects\MyProject\MyProject-ba31aae6efa1.jsonI checked the file, and it is the file that I got when I enabled my service account. Every property in it looks fine (i.e. project name is correct, path's correct, ...).I installed the Google Cloud SDK and executed gcloud beta auth application-default login and authorized access to my cloud account.Any ideas on what might be causing this? <code>  GoogleCredential credential = GoogleCredential.GetApplicationDefaultAsync().Result; Console.WriteLine(Environment.GetEnvironmentVariable(""GOOGLE_APPLICATION_CREDENTIALS""));",AggregateException when calling GetApplicationDefaultAsync()
Copy dependencies to output directory with .NET core and Visual Studio," I'm trying to build a .NET Core app docker image. But I can't figure out how I'm supposed to get the project's NuGet dependencies into the image.For simplicity reasons I've create a .NET Core console application: It just has one NuGet dependency on Newtonsoft.Json. When I run the app from Visual Studio, everything works fine.However, when I create a Docker image from the project and try to execute the app from there, it can't find the dependency: This is to be expected because Newtonsoft.Json.dll is not being copied by Visual Studio to the output folder.Here's the Dockerfile I'm using: Is there a recommended way of dealing with this problem?I don't want to run dotnet restore inside of the container (as I don't want to re-download all dependencies everytime the container runs).I guess I could add a RUN dotnet restore entry to the Dockerfile but then I couldn't use microsoft/dotnet:<version>-core as base image anymore. And I couldn't find a way to make Visual Studio copy all dependencies into the output folder (like it does with regular .NET Framework projects). <code>  using System;using Newtonsoft.Json;namespace ConsoleCoreTestApp{ public class Program { public static void Main(string[] args) { Console.WriteLine($""Hello World: {JsonConvert.False}""); } }} # dotnet ConsoleCoreTestApp.dllError: assembly specified in the dependencies manifest was not found -- package: 'Newtonsoft.Json', version: '9.0.1', path: 'lib/netstandard1.0/Newtonsoft.Json.dll' FROM microsoft/dotnet:1.0.0-coreCOPY bin/Debug /app",How to include dependencies in .NET Core app docker image?
Selenium: Drag and Drop from file system to webdriver?," I have to test a web-application which contains a drag and drop area for uploading files from the local file system. My test environment is based on C#.For the automation testing I have used Selenium, but it is not possible to drag files from the file system. The upload area is a div tag (no input tag). So what's the best way to do it? AutoIt (is it possible to drop in a web browser)? Sikuli? <code> ",Selenium: Drag and Drop from file system to WebDriver?
Apply FormulaCell to a Data Grid view," I want to add formula cell in a DataGridView. Is there any custom DataGridView to do this?Example:  <code>  grid[4, column].Text = string.Format(""=MAX({0}6:{0}{1})"", columnAsString, grid.RowCount);",Apply Formula Cell to a DataGridview
Azure Service Fabric continuous integration with VSO fails," I have tried to set up continuous integration to deploy my Azure Service Fabric cluster automatically on git push events in Team Services. I followed the default template for a Team Services Build Definition and a Team Services Release Definition based on this guide:Set up continuous integration for a Service Fabric application by using Visual Studio Team ServicesHere are my settings:For the most part everything works for the first deployment. After that it throws the following error: From that it appears as though it is trying to completely redeploy the service instead of just upgrading the service. I have searched through all of the settings and tried creating and recreating the tasks but have not been able to resolve.Has anyone encountered this before? <code>  An application with name 'fabric:/<APP>' already exists, its type is '<APP>Type' and version is '1.0.0.20160812.7'. You must first remove the existing application before a new application can be deployed or provide a new name for the application.",Azure Service Fabric continuous integration fails in Visual Studio Team Services (was VSO)
Is using non standart ensligh character in c# a bad practice?," English is not my native language. I would like to use non-English characters in my code, for instance: "", , ...""Is it a bad practice to use those characters for classes, variable or method declarations?I'm not asking what characters are technically available in c#, My question is whether or not it is a good idea. <code> ",Is using non standard English characters in c# names a bad practice?
"C#,how to set dns resolve timeout?"," I want to check if a host can be resolvedbut I don't want to wait a long time; so I want to set a timeout.I have tried but this is not working correctly, because when it's a wrong host, it also can return true. So how to set a timeout for DnsResolve? <code>  public static bool ResolveTest(string hostNameOrAddress, TimeSpan time_out) { var result = Dns.BeginGetHostEntry(hostNameOrAddress, null, null); var success = result.AsyncWaitHandle.WaitOne(time_out); if (!success) { //throw new Exception(""Failed to resolve the domain.""); return false; } return true; }",C#: how to set DNS resolve timeout?
".NET Standard, .Net Core, PCL"," .NET Standard has been a confusing concept. The idea of a standard .NET library format sounds great. But, it's not clear what it is exactly. There are now .NET Core, and .NET Standard Class Library project templates in Visual Studio, as well as the old PCL projects. I also found that if you go in to the settings for the project, you can switch an existing PCL library over to .NET Standard. It's not clear if .NET standard is a library? Or a DLL format.The basic question I'm asking is which type of library should we be targeting? I'm mainly doing this for Xamarin projects, but it would be great if we could share these libraries with other platforms, especially .NET Core, and UWP. It's confusing as to why Microsoft brought out two seemingly identical Class Library types at the same time: .NET Core, and .NET Standard. DefinitionsNET Core - a .NET based runtime environment which conforms to the .NET Standard API definition.PCL - a .NET based library format supported by several runtime environments including .NET, Mono, UWP, and so on.NET Standard (Definition 1) - A set of standard API definitions for .NET based runtime environments.NET Standard (Definition 2) - a .NET based library format supported by several runtime environments including .NET, Mono, UWP, and so on which is a continuation of the PCL format. In Visual Studio, a PCL library can be converted to a .NET Standard library by going in to the properties of the project and editing the target framework. <code> ",".NET Standard, .NET Core, PCL"
How can I inject ViewDataDictionary or ModelStateDictionary into TagHelper," In razor views I can access model state object: How can i inject and access ViewData or ModelState objects in razor TagHelper? I tried the following, however the ViewData and ModelState are always null: <code>  @ViewData.ModelState public class ModelStateTagHelper : TagHelper{ public ViewDataDictionary ViewData { get; set; } public ModelStateDictionary ModelState { get; set; } public override void Process(TagHelperContext context, TagHelperOutput output) { }}",How can I inject ViewDataDictionary or ModelStateDictionary into TagHelper?
How can I inject ViewDataDictionary or ModelStateDictionary into TagHelper in ASP.NET Core," In razor views I can access model state object: How can i inject and access ViewData or ModelState objects in razor TagHelper? I tried the following, however the ViewData and ModelState are always null: <code>  @ViewData.ModelState public class ModelStateTagHelper : TagHelper{ public ViewDataDictionary ViewData { get; set; } public ModelStateDictionary ModelState { get; set; } public override void Process(TagHelperContext context, TagHelperOutput output) { }}",How can I inject ViewDataDictionary or ModelStateDictionary into TagHelper?
MVC 6 - Asp action route data," In the old version of MVC 5 I could do this to pass route parameters I am trying to get this to work with the new asp-action method and I figgured out I could do this as a workaround. But what is the correct syntax for this? <code>  @Html.ActionLink(""New item"", ""Suggestion"", new ProductSuggestion() { Username = Model.Username }, new { @class = ""btn btn-default"" }) @{ var a = new Dictionary<string, string> { { ""Username"", Model.Username } }; } <a asp-action=""Suggestion"" asp-all-route-data=""a"" class=""btn btn-default"">New item</a>",Asp action route data
IsGenericType missing from .Net Core?," I have this code in .Net 4.6.2 and now trying to convert into .Net core however I am getting error Error CS1061 'Type' does not contain a definition for 'IsGenericType' and no extension method 'IsGenericType' accepting a first argument of type 'Type' could be found (are you missing a using directive or an assembly reference?) What is equivalent in .Net Core?Update1 Surprisingly when I debug the code I see variable t has IsGenericType property however I cannot use IsGenericType in the code. Not sure why or which namespace I need to add. I have added using System and using System.Runtime both namespaces <code>  public static class StringExtensions{ public static TDest ConvertStringTo<TDest>(this string src) { if (src == null) { return default(TDest); } return ChangeType<TDest>(src); } private static T ChangeType<T>(string value) { var t = typeof(T); // getting error here at t.IsGenericType if (t.IsGenericType && t.GetGenericTypeDefinition().Equals(typeof(Nullable<>))) { if (value == null) { return default(T); } t = Nullable.GetUnderlyingType(t); } return (T)Convert.ChangeType(value, t); }}",IsGenericType & IsValueType missing from .Net Core?
c# upload a file to an FTP server from a string or stream," I'm trying to create a file on an FTP server, but all I have is either a string or a stream of the data and the filename it should be created with. Is there a way to create the file on the server (I don't have permission to create local files) from a stream or string? <code>  string location = ""ftp://xxx.xxx.xxx.xxx:21/TestLocation/Test.csv"";WebRequest ftpRequest = WebRequest.Create(location);ftpRequest.Method = WebRequestMethods.Ftp.UploadFile;ftpRequest.Credentials = new NetworkCredential(userName, password);string data = csv.getData();MemoryStream stream = csv.getStream();//Magicusing (var response = (FtpWebResponse)ftpRequest.GetResponse()) { }",Upload a file to an FTP server from a string or stream
Changing the behavior of the console in C# ConsoleApp," I've got a console application that executes my code without user interaction. If the user clicks within the console window, on purpose or on accident, all execution stops. This has something to do with copying text from the console window. The only way for the application to start executing again is if the user selects text and then right-clicks on the console window, copying it to the clipboard.To see this in action, create a console application and add the following code. When you click on the console window, the Task thread stops executing. This is not desirable behavior at all, and I want to prevent this from happening in my console application.How can I prevent this? None of the properties/events on the console window have anything to do with controlling this behavior, as far as I can see.As you can see, when i'm click within window appear cursor. When i press any key - cursor gone and app continue working <code>  class Program{ static void Main(string[] args) { var task = Task.Run(async () => { int i = 0; while (true) { Console.WriteLine(i++); await Task.Delay(1000); } }); Console.ReadLine(); }}",Code stops executing when a user clicks on the console window
c# Static Method for handling null returns," So I have created a provider (a few of them actually) and I am realising there is a bit of a pattern in some of my logic. It is being repeated and I reckon I can remove lots of lines of code if I can just create this extension method :DSo, basically what is happening is something like this: Now, I do this in a lot of places, not just for deleting, but for updating.I would like to create an extension method that allows me to do something like this: I also need this to work with any return type. So in this case it might be an Account, but there will be a provider that also has this code returning an Order but I need the extension method to work for both.I think the challenge here is the async bit, but I might be wrong!Anyone know if it is possible? <code>  // Get our item to be deletedvar model = await this._service.GetAsync(id);// If we have nothing, throw an errorif (model == null) throw new HttpException(404, string.Format(Resources.GenericNotFound, ""List item"")); // Get our item to be deletedvar model = await this._service.GetAsync(id).ThowIfNull(""List item"");",Static Method for handling null returns
c#: Callback with async and await," I have questions regarding the execution order of async jobs.I will ask my question with example because it is easier to be understandable.It is an official example from https://msdn.microsoft.com/en-us/library/mt674882.aspx with some twist. Can I say DoWork2 is a callback of client.GetStringAsync?If so, DoWork2 is not immediately executed following the completion of client.GetStringAsync IF DoWork1 runs longer time than client.GetStringAsync.Am I right here? <code>  async Task<int> AccessTheWebAsync(){ HttpClient client = new HttpClient(); //async operation: Task<string> getStringTask = client.GetStringAsync(""http://msdn.microsoft.com""); // You can do work here that doesn't rely on the string from GetStringAsync. DoWork1(); // The await operator suspends AccessTheWebAsync. string urlContents = await getStringTask; DoWork2(); return urlContents.Length;}",Callback with async and await
How can i pass hidden field value from view to controller ASP.NET MVC 5," I am trying to pass hidden field value from view to controller by doing the following and also tried On both instances the value of ArticleId is 0 but when i use TextboxFor i can see the correct ArticleId, please helpHere it is View Controller Model ViewModel <code>  @Html.HiddenFor(model => model.Articles.ArticleId) <input type=""hidden"" id=""ArticleId"" name=""ArticleId"" value=""@Model.Articles.ArticleId"" /> @model ArticlesCommentsViewModel....@using (Html.BeginForm(""Create"", ""Comments"", FormMethod.Post)){<div class=""row""> <div class=""col-xs-10 col-md-10 col-sm-10""> <div class=""form-group""> @Html.LabelFor(model => model.Comments.Comment, new { @class = ""control-label"" }) @Html.TextAreaFor(m => m.Comments.Comment, new { @class = ""ckeditor"" }) @Html.ValidationMessageFor(m => m.Comments.Comment, null, new { @class = ""text-danger""}) </div> </div></div><div class=""row""> @*@Html.HiddenFor(model => model.Articles.ArticleId)*@ <input type=""hidden"" id=""ArticleId"" name=""ArticleId"" value=""@Model.Articles.ArticleId"" /></div><div class=""row""> <div class=""col-xs-4 col-md-4 col-sm-4""> <div class=""form-group""> <input type=""submit"" value=""Post Comment"" class=""btn btn-primary"" /> </div> </div></div>} // POST: Comments/Create [HttpPost] public ActionResult Create(CommentsViewModel comments)//, int ArticleId) { var comment = new Comments { Comment = Server.HtmlEncode(comments.Comment), ArticleId = comments.ArticleId, CommentByUserId = User.Identity.GetUserId() }; } public class CommentsViewModel{ [Required(ErrorMessage = ""Comment is required"")] [DataType(DataType.MultilineText)] [Display(Name = ""Comment"")] [AllowHtml] public string Comment { get; set; } public int ArticleId { get; set; }} public class ArticlesCommentsViewModel{ public Articles Articles { get; set; } public CommentsViewModel Comments { get; set; }}",How can I pass hidden field value from view to controller ASP.NET MVC 5?
How can I parse json string from Httpclient," I am getting a JSON result by calling an external API. The result in line var s = Newtonsoft.Json.JsonConvert.DeserializeObject(result); I am getting is like: I am using HttpClient. I am facing difficulty in accessing prompt key-value. I want to get prompt from dialog. How can I get it? <code>  HttpClient client = new HttpClient(); client.BaseAddress = new Uri(url); client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue(""application/json"")); HttpResponseMessage response = client.GetAsync(url).Result; if (response.IsSuccessStatusCode) { var result = response.Content.ReadAsStringAsync().Result; var s = Newtonsoft.Json.JsonConvert.DeserializeObject(result); return ""Success""; } else { return ""Fail""; } {{ ""query"": ""1"", ""topScoringIntent"": { ""intent"": ""1"", ""score"": 0.9978111, ""actions"": [ { ""triggered"": false, ""name"": ""1"", ""parameters"": [] } ] }, ""entities"": [], ""dialog"": { ""prompt"": ""1"", ""parameterName"": ""1"", ""parameterType"": ""1::1"", ""contextId"": ""11"", ""status"": ""1"" }}}",How can I parse JSON string from HttpClient?
Disable round-robin pattern and use fanout on MassTransit," I have created a basic demo pub/sub application which works on localhost with MassTransit. What I want to achieve is to publish a message and all the subscribers should receive the message.At the moment, in my environment I start one publisher app and two subscriber apps. But when I publish a message the subscribers receive the message in turns.My pub/sub code:Publish: Subscribers use this code: <code>  var bus = Bus.Factory.CreateUsingRabbitMq(config =>{ config.Host(new Uri(""rabbitmq://localhost/""), h => { }); config.ExchangeType = ExchangeType.Fanout;});var busHandle = bus.Start();bus.Publish<SomethingHappened>(message); var bus = Bus.Factory.CreateUsingRabbitMq(config =>{ var host = config.Host(new Uri(""rabbitmq://localhost/""), h => { }); config.ReceiveEndpoint(host, ""MassTransitExample_Queue"", e => e.Consumer<SomethingHappenedConsumer>());});var busHandle = bus.Start();Console.ReadKey();busHandle.Stop();",Disable round-robin message consumption on MassTransit
Xamarin collapsable StackLayout," I'm trying to implement a kind of collapsable StackLayout.Every tine the user clicks the button, it expands or collapse the stacklayout to show/hide more details.I was able to achieve more/less this with the code below, but it doesn't look right and the effect isn't great, because it grows immediately and I'm applying the effect to other element.Do you have any suggestions to do this, I'm using xamarin Forms?XAML Code <code>  <?xml version=""1.0"" encoding=""utf-8"" ?><StackLayout xmlns=""http://xamarin.com/schemas/2014/forms"" xmlns:x=""http://schemas.microsoft.com/winfx/2009/xaml"" x:Class=""Sample.MyStackLayout"" > <StackLayout x:Name=""TopLayout""> <StackLayout Orientation=""Horizontal""> <Label Text=""some text"" VerticalOptions=""Center"" HorizontalOptions=""StartAndExpand"" /> <Label Text=""123"" VerticalOptions=""Center"" HorizontalOptions=""End"" FontSize=""Large"" /> </StackLayout> <BoxView Color=""Black"" HeightRequest=""1"" /> <StackLayout Orientation=""Horizontal""> <Label Text=""some text"" VerticalOptions=""Center"" HorizontalOptions=""StartAndExpand"" /> <Label Text=""123"" VerticalOptions=""Center"" HorizontalOptions=""End"" FontSize=""Large"" /> </StackLayout> <StackLayout Orientation=""Horizontal""> <Label Text=""some text"" VerticalOptions=""Center"" HorizontalOptions=""StartAndExpand"" /> <Label Text=""123"" VerticalOptions=""Center"" HorizontalOptions=""End"" FontSize=""Large"" /> </StackLayout> <Button x:Name=""btn"" Text=""Button"" Clicked=""btnClicked"" /> </StackLayout> <StackLayout x:Name=""MoreDetails"" IsVisible=""False""> <Label Text=""some text 1""></Label> <Label Text=""some text 2""></Label> <Label Text=""some text 3""></Label> <Label Text=""some text 4""></Label> <Label Text=""some text 5""></Label> <Label Text=""some text 6""></Label> <Label Text=""some text 7""></Label> <Label Text=""some text 8""></Label> </StackLayout></StackLayout> public AccountInfo(){ InitializeComponent();}bool isExpanded = false;protected async void btnClicked(object sender, EventArgs e){ if (isExpanded) { await MoreDetails.FadeTo(0); MoreDetails.IsVisible = !isExpanded; } else { MoreDetails.IsVisible = !isExpanded; await MoreDetails.FadeTo(1); } isExpanded = !isExpanded;}",Xamarin Forms Collapsable StackLayout
"Compiler Error: Check(a < b, a > (flag ? c : b - 10));"," If I have the following code: I get a compile-time error on the call to Check(int, int): error CS0307: The variable 'int' cannot be used with type argumentsI also get these errors: error CS0118: 'b' is a variable but is used like a type error CS0118: 'a' is a variable but is used like a typeWhy do these errors occur? What is wrong with the code? <code>  private void Check(bool a, bool b){}private void Check(int a, int b, int c, bool flag){ Check(a < b, a > (flag ? c : b - 10));}","Compiler Error: ""error CS0307: The variable 'int' cannot be used with type arguments"""
Deserializing an unnamed array using JSON.net (Newtonsoft/C#)," I am having difficulty writing the appropriate annotations to represent data which is returned from a JSON Get request which returns data like so: (ellipsis above just indicating that I could have variable number of these items returned)In my model class (I am using MVVM approach for a Xamarin project but that's not over relevant here) I am using annotations to represent the model attributes I would like to annote another class which shows the container/contained relationship. However, I coming unstuck as there is no JSON attribute to provide in the annotation to represent the ""root"" of the returned collection.I'd have no problem mapping the JSON to an object model for any JSON arrays which are named within the returned JSON. In that case I could create another class with a named JSON attribute which contained a C# List but I am trying to provide an appropriate model mapping for JSON which returns a list of items within an unnamed array.Any ideas how I could approach this? <code>  [{""ProductCode"":""0129923083091"",""Description"":""DIESEL "",""SalesLitres"":6058.7347,""SalesValue"":6416.2000},{""ProductCode"":""0134039344902"",""Description"":""UNLEADED "",""SalesLitres"":3489.8111,""SalesValue"":3695.7100},... ] namespace App8.Models { public class ReportRow { [JsonProperty(""ProductCode"")] public string ProductCode { get; set; } = string.Empty; [JsonProperty(""Description"")] public string Description { get; set; } = string.Empty; [JsonProperty(""SalesLitres"")] public double SalesLitres { get; set; } = 0.0; [JsonProperty(""SalesValue"")] public double SalesValue { get; set; } = 0.0; } }",Deserializing an unnamed array
WPF - Notify property change defined in the ViewModel when underlying Model data changes," Question: What is the proper way to update a bounded UI element to show the values of property defined only in the ViewModel after a property in an individual item in list changes value.When implementing the INotifyPropertyChanged in a class that are going to be the items in list, it only updates the UI element that specific piece of data is bound to. Like a ListView item or DataGrid cell. And that's fine, that's what we want. But what if we need a total's row, like in an Excel table. Sure there are several ways to go about that specific problem, but the underlying issue here is when the property is defined and calculated in the ViewModel based on data from the Model. Like for example: When and how does that get notified/updated/called?Let's try this with a more complete example.Here's the XAML This is the Model: And the ViewModel: I know this is code looks over simplified, but it's part of a larger, frustratingly difficult application.All I want to do is when I change an item's value in the DataGrid I want the ItemsTotal property to update the TxtTotal textbox.So far the solutions I've found include using ObservableCollection and implementing CollectionChanged event.The model changes to: And the viewmodel changes to: This solution works, but it just seems like a work around hack that should have a more eloquent implementation. My project has several of these sum properties in the viewmodel and I as it stands, that's a lot of properties to update and a lot of code to write which just feels like more overhead. I have more research to do, several interesting articles came up while I was writing this question. I'll update this post with links to other solutions as it seems this issues is more common than I thought. <code>  public class ViewModel{ public double OrderTotal => _model.order.OrderItems.Sum(item => item.Quantity * item.Product.Price);} <Grid> <DataGrid x:Name=""GrdItems"" ... ItemsSource=""{Binding Items}""/> <TextBox x:Name=""TxtTotal"" ... Text=""{Binding ItemsTotal, Mode=OneWay}""/></Grid> public class Item : INotifyPropertyChanged{ private string _name; private int _value; public string Name { get { return _name; } set { if (value == _name) return; _name = value; OnPropertyChanged(); } } public int Value { get { return _value; } set { if (value.Equals(_value)) return; _value = value; OnPropertyChanged(); } } public event PropertyChangedEventHandler PropertyChanged; protected virtual void OnPropertyChanged(string propertyName = null) { PropertyChanged?.Invoke(this, new propertyChangedEventArgs(propertyName)); }}public class Model{ public List<Item> Items { get; set; } = new List<Item>(); public Model() { Items.Add(new Item() { Name = ""Item A"", Value = 100 }); Items.Add(new Item() { Name = ""Item b"", Value = 150 }); Items.Add(new Item() { Name = ""Item C"", Value = 75 }); }} public class ViewModel{ private readonly Model _model = new Model(); public List<Item> Items => _model.Items; public int ItemsTotal => _model.Items.Sum(item => item.Value);} public class Model: INotifyPropertyChanged{ public ObservableCollection<Item> Items { get; set; } = new ObservableCollection<Item>(); public Model() { Items.CollectionChanged += ItemsOnCollectionChanged; } . . . private void ItemsOnCollectionChanged(object sender, NotifyCollectionChangedEventArgs e) { if (e.NewItems != null) foreach (Item item in e.NewItems) item.PropertyChanged += MyType_PropertyChanged; if (e.OldItems != null) foreach (Item item in e.OldItems) item.PropertyChanged -= MyType_PropertyChanged; } void MyType_PropertyChanged(object sender, PropertyChangedEventArgs e) { if (e.PropertyName == ""Value"") OnPropertyChanged(nameof(Items)); } public event PropertyChangedEventHandler PropertyChanged; . . .} public class ViewModel : INotifyPropertyChanged{ private readonly Model _model = new Model(); public ViewModel() { _model.PropertyChanged += ModelOnPropertyChanged; } private void ModelOnPropertyChanged(object sender, PropertyChangedEventArgs propertyChangedEventArgs) { OnPropertyChanged(nameof(ItemsTotal)); } public ObservableCollection<Item> Items => _model.Items; public int ItemsTotal => _model.Items.Sum(item => item.Value); public event PropertyChangedEventHandler PropertyChanged; [NotifyPropertyChangedInvocator] protected virtual void OnPropertyChanged([CallerMemberName] string propertyName = null) { PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName)); }}",Notify property change defined in the ViewModel when underlying Model data changes
BindNever not working on ASP.NET Core?," I do not want do bind the Id property on my CustomerViewModel so I added a [BindNever] attribute but it is not working. What could be the solution?I have the following:CustomerController.cs CustomerViewModel If I input the following json . The id property still gets binded <code>  // PUT api/customers/5[HttpPut(""{id}"")]public async Task<IActionResult> Put([FromUri] int id, [FromBody]CustomerViewModel customer){ //Implementation} public class CustomerViewModel{ [BindNever] public int Id { get; set; } public string LastName { get; set; } public string FirstName { get; set; } public string Email { get; set; }} { ""id"": 100, ""lastName"": ""Bruce"", ""firstName"": ""Wayne"", ""email"": ""bruce@gothamcity.com""}",Why BindNever attribute doesn't work
using openxml get word file content by page number - C#.NET," Using OpenXML, can I read the document content by page number?wordDocument.MainDocumentPart.Document.Body gives content of full document. MSDN ReferenceUpdate 1:it looks like page breaks are set as below So now I need to split the XML with above check and take InnerTex for each, that will give me page vise text.Now question becomes how can I split the XML with above check?Update 2:Page breaks are set only when you have page breaks, but if text is floating from one page to other pages, then there is no page break XML element is set, so it revert back to same challenge how o identify the page separations. <code>  public void OpenWordprocessingDocumentReadonly() { string filepath = @""C:\...\test.docx""; // Open a WordprocessingDocument based on a filepath. using (WordprocessingDocument wordDocument = WordprocessingDocument.Open(filepath, false)) { // Assign a reference to the existing document body. Body body = wordDocument.MainDocumentPart.Document.Body; int pageCount = 0; if (wordDocument.ExtendedFilePropertiesPart.Properties.Pages.Text != null) { pageCount = Convert.ToInt32(wordDocument.ExtendedFilePropertiesPart.Properties.Pages.Text); } for (int i = 1; i <= pageCount; i++) { //Read the content by page number } } } <w:p w:rsidR=""003328B0"" w:rsidRDefault=""003328B0""> <w:r> <w:br w:type=""page"" /> </w:r> </w:p>",How to access OpenXML content by page number?
Get offset minutes from timezone (string)," What's the easiest way to get the minutes if I only have a string that represents the timezone? (for example ""Europe/London"")So far I have: But I'm not finding an easy approach to convert it to minutes.NOTE: What I need is the offset in that specific moment in which the code is being executed. Between that timezone and UTC. <code>  public static int ConvertFromTimeZoneToMinutesOffset(string timeZone){ DateTimeZone zone = DateTimeZoneProviders.Tzdb[timeZone]; // Need magic code to get offset as minutes}",Get offset minutes from timezone (string) with NodaTime
"When I develop ASP.NET Core MVC, which service should I use? AddMvc or AddMvcCore?"," I am learning ASP.NET Core MVC from a book, the code snippet in question is as follows: Because the book is about ASP.NET Core MVC rather than ASP.NET MVC, I think I have to use AddMvcCore() rather than AddMvc() as follows: Is what I do here correct? <code>  // CHAPTER 4 - ESSENTIAL C# FEATURESnamespace LanguageFeatures { public class Startup { public void ConfigureServices(IServiceCollection services) { services.AddMvc(); } // etc. public void ConfigureServices(IServiceCollection services){ services.AddMvcCore(); // as opposed to: //services.AddMvc();}",Should I use AddMvc or AddMvcCore for ASP.NET Core MVC development?
How to read latest email using imap c#," I want to read emial from my gmail account.I am using ""OpenPop.Pop3"" to read email from my gmail account, I am using below code :- But its fetching emails before 4 March 2016, Not fetching new/latest emails.Is there any restriction in ""OpenPop.Pop3"" or am I missing something? <code>  using OpenPop.Pop3; public DataTable ReadEmailsFromId() { DataTable table = new DataTable(); try { using (Pop3Client client = new Pop3Client()) { int messageCount = client.GetMessageCount(); for (int i = messageCount; i > 0; i--) { table.Rows.Add(client.GetMessage(i).Headers.Subject, client.GetMessage(i).Headers.DateSent); string msdId = client.GetMessage(i).Headers.MessageId; OpenPop.Mime.Message msg = client.GetMessage(i); OpenPop.Mime.MessagePart plainTextPart = msg.FindFirstPlainTextVersion(); string message = plainTextPart.GetBodyAsText(); } } } return table; }",How to read latest email using pop3 c#
MongoDB and Visual Studio 2015 C# Find()," I have the below code and I am new to mongodb, I need help in finding an specific element in the collection. Once I find the user I will like to print it, is that posible or will find only return the position? if so, how do I print it?I have seen some examples collection.Find(x => x.something) but I do not know what that x is or mean <code>  using MongoDB.Bson;using MongoDB.Driver;namespace mongo_console {public class User { public ObjectId Id { get; set; } public string name { get; set; } public string pwd { get; set; }}class Program { static void Main(string[] args) { MongoClient client = new MongoClient(); MongoServer server = client.GetServer(); MongoDatabase db = server.GetDatabase(""Users""); MongoCollection<User> collection = db.GetCollection<User>(""users""); User user = new User { Id = ObjectId.GenerateNewId(), name = ""admin"", pwd = ""admin"" }; User user2 = new User { Id = ObjectId.GenerateNewId(), name = ""system"", pwd = ""system"" }; collection.Save(user); collection.Save(user2); /* * How do I collection.Find() for example using the name */ }}}",MongoDB and C# Find()
How to setup Automapper in ASP.NET Core," I'm relatively new at .NET, and I decided to tackle .NET Core instead of learning the ""old ways"". I found a detailed article about setting up AutoMapper for .NET Core here, but is there a more simple walkthrough for a newbie? <code> ",How to set up Automapper in ASP.NET Core
Is the JavaScriptSerializer-Class some sort of deprecated?, The MSDN documentation of the JavaScriptSerializer-class states: Json.NET should be used serialization and deserialization. Provides serialization and deserialization functionality for AJAX-enabled applications.Should this be some sort of deprecation hint or should this class not be used in general at all (for the purpose of JSON serialization)? <code> ,Is the JavaScriptSerializer class deprecated?
Is the JavaScriptSerializer-Class deprecated?, The MSDN documentation of the JavaScriptSerializer-class states: Json.NET should be used serialization and deserialization. Provides serialization and deserialization functionality for AJAX-enabled applications.Should this be some sort of deprecation hint or should this class not be used in general at all (for the purpose of JSON serialization)? <code> ,Is the JavaScriptSerializer class deprecated?
How do I debug and step into a native code project from inside a .NET core C# project?," I am developing a .NET core (.NET Standard 1.6) application in VS2015. The application calls C++ code via P/Invoke. Now I need to step into the C/C++ code of my native dll project.In regular .NET application, by enabling unmanaged code debugging in the property window of the application, we can step into the C/C++ code directly:But I can't find such option on a .NET core project. And I know that I can attach the debugger to the application to debug native code only, but that's not suitable for my case.Again, I want to debug from managed C# code into native C/C++ code.Any ideas?Maybe I should switch back to .NET Framework so I can debug the native code. It's really hard to debug by printf. :( <code> ",How to debug and step into a native code project from inside a .NET core C# project?
Two arrays into one Dictinary," I would like to create a out of two arrays: the result: Is there a way i can do this with LINQ?I have read about Zip but I don't think I can use since I need to add values to an existing key.value array. <code>  Dictionary<string, int[]> dict string[] keys = { ""A"", ""B"", ""A"", ""D"" };int[] values = { 1, 2, 5, 2 }; [""A""] = {1,5} [""B""] = {2}[""D""] = {2}",Two arrays into one Dictionary
"C#, nameof(object) doesn't compile", In C# 6.0 you can write this: They have the same result of: But you can't write this: It generates the following error: Invalid expression term 'object'.But you can still write this: Why nameof(object) does not compile? <code>  var instance = default(object);var type = typeof(object); var instance = default(System.Object);var type = typeof(System.Object); var name = nameof(object); var name = nameof(System.Object);,Why is nameof(object) not allowed?
Why is nameof(object) not allowed, In C# 6.0 you can write this: They have the same result of: But you can't write this: It generates the following error: Invalid expression term 'object'.But you can still write this: Why nameof(object) does not compile? <code>  var instance = default(object);var type = typeof(object); var instance = default(System.Object);var type = typeof(System.Object); var name = nameof(object); var name = nameof(System.Object);,Why is nameof(object) not allowed?
Configuring password reset token provider (IUserTokenProvider) in ASP.NET core," Hello,In order to getting password reset work I need to register an IUserTokenProvider instance into DI.Without it I get exception at following line: That makes sense so I tried to register it in the DI: But the interface IUserTokenProvider does not exists. Do you know how to solve this?Thanks <code>  var result = await _userManager.ResetPasswordAsync(user, token, password); ""No IUserTokenProvider named 'PasswordResetTokenProvider' is registered."" services.AddSingleton<IUserTokenProvider<User>, DataProtectorTokenProvider<User>>();",Password reset token provider in ASP.NET core - IUserTokenProvider not found
Why Database.SqlQuery execute procedure with exec sp_executesql N'EXEC SPName'?," I am using DBContext.Database.SqlQuery<entity> to execute stored procedure from my C# code repository.It works fine but I want to know that why it is executing procedure like below: rather than And is there any way that my all procedures execute from c# like thisEXEC GetCaseList @CaseStage = 9 rather than exec sp_executesql N'EXEC GetCaseList @CaseStage',N'@CaseStage int',@CaseStage=9?How can I make SQL Server Profiler to treat procedure name as object rather than SP_EXECUTESQL ? Note: I want to execute procedure from c# as EXEC GetCaseList @CaseStage = 9 because I am saving trace data through SQL Server Profiler in table format. And in ObjectName column, it is showing sp_executesql as object rather than procedure name(GetCaseList) as object. I can make changes only from c# code. <code>  exec sp_executesql N'EXEC GetCaseList @CaseStage',N'@CaseStage int',@CaseStage=9 EXEC GetCaseList @CaseStage = 9",SQL Server Recognise SP_EXECUTESQL as object rather than Procedure Name
Execute procedure with 'EXEC SPName' rather than 'EXEC sp_executesql'," I am using DBContext.Database.SqlQuery<entity> to execute stored procedure from my C# code repository.It works fine but I want to know that why it is executing procedure like below: rather than And is there any way that my all procedures execute from c# like thisEXEC GetCaseList @CaseStage = 9 rather than exec sp_executesql N'EXEC GetCaseList @CaseStage',N'@CaseStage int',@CaseStage=9?How can I make SQL Server Profiler to treat procedure name as object rather than SP_EXECUTESQL ? Note: I want to execute procedure from c# as EXEC GetCaseList @CaseStage = 9 because I am saving trace data through SQL Server Profiler in table format. And in ObjectName column, it is showing sp_executesql as object rather than procedure name(GetCaseList) as object. I can make changes only from c# code. <code>  exec sp_executesql N'EXEC GetCaseList @CaseStage',N'@CaseStage int',@CaseStage=9 EXEC GetCaseList @CaseStage = 9",SQL Server Recognise SP_EXECUTESQL as object rather than Procedure Name
How can I check the url autorisation by a samaccountname?," IIS-ManagerTo restrict the access to an web app, an Administrator is able to set the url authorization of users and groups via the IIS-Manager:Web.configThe IIS-Manager stores the Authorization Rules in the web.config of the app: When bypassLoginPages is set to true, all users are authorized to access the login page. When an user is not logged in, he will automatically be redirected to the login page: MVC5 App:The user has to login in via an custom login page by his Windows SamAccountName and password. The credentials will be sent to the Login action of the AuthController: All restricted controllers are making the authorization check via the [Authorize] attribute automatically: An decoration like [Authorize(Users=""User1,User2"")] is no solution because the code is not accessible by the Endusers which should have the possibility to configurate the access to the app.When a user is not authorized, then he will be redirected to the login page. That works fine. But I need to make the authorization check in the Login action before. So my question:How can I manually validate in my AuthController if the logged in user is authorized to redirect to the MainController? <code>  <security> <authorization bypassLoginPages=""true""> <remove users=""*"" roles="""" verbs="""" /> <add accessType=""Allow"" users=""Testuser"" /> <add accessType=""Deny"" users=""*"" /> </authorization></security> <authentication mode=""Forms""> <forms [...] loginUrl=""~/Auth/Login"" [...] > [...] </forms></authentication> [AllowAnonymous]public class AuthController : Controller{ public ActionResult Login { // validation of SamAccountName and Password against Active Directory here. [...] // We want to check the authorization here. // create authentication ticket FormsAuthenticationTicket lFormsAuthenticationTicket = new FormsAuthenticationTicket(1, SamAccountName, DateTime.Now, DateTime.Now.AddMinutes(AuthCookieTimeout), RememberMe, CustomData, FormsAuthentication.FormsCookiePath); // Encrypt the ticket. string lEncryptedTicket = FormsAuthentication.Encrypt(lFormsAuthenticationTicket); var lAuthCookie = new HttpCookie(FormsAuthentication.FormsCookieName, lEncryptedTicket); // Create the cookie. Response.Cookies.Add(lAuthCookie); [...] return RedirectToAction(""Index"", ""Main""); // redirect to the main controller }} [Authorize]public class MainController : Controller{ [...]}",How can I manually check the url authorization in MVC5?
Mocking FromSql in entity framework core?," I was wondering is there any way other than building a wrapper for mocking the FromSql? I know this method is static, but since they added things like AddEntityFrameworkInMemoryDatabase to entity framework core, I thought there might be a solution for this too, I use EF Core 1.0.1 in my project.My end goal is to test this method: I want to ensure that my query is handled with the same object that I passed into it, based on this answer in entity framework 6 I could do something like this: But unlike SqlQuery<T> in EF 6, the FromSql<T> in EF Core is static extension method, I'm asking this question because I think I might approach this problem from the wrong angle or there might be a better alternative than a wrapper, I'd appreciate any thought on this. <code>  public List<Models.ClosestLocation> Handle(ClosestLocationsQuery message){ return _context.ClosestLocations.FromSql( ""EXEC GetClosestLocations {0}, {1}, {2}, {3}"", message.LocationQuery.Latitude, message.LocationQuery.Longitude, message.LocationQuery.MaxRecordsToReturn ?? 10, message.LocationQuery.Distance ?? 10 ).ToList();} [Fact]public void HandleInvokesGetClosestLocationsWithCorrectData(){ var message = new ClosestLocationsQuery { LocationQuery = new LocationQuery {Distance = 1, Latitude = 1.165, Longitude = 1.546, MaxRecordsToReturn = 1} }; var dbSetMock = new Mock<DbSet<Models.ClosestLocation>>(); dbSetMock.Setup(m => m.FromSql(It.IsAny<string>(), message)) .Returns(It.IsAny<IQueryable<Models.ClosestLocation>>()); var contextMock = new Mock<AllReadyContext>(); contextMock.Setup(c => c.Set<Models.ClosestLocation>()).Returns(dbSetMock.Object); var sut = new ClosestLocationsQueryHandler(contextMock.Object); var results = sut.Handle(message); contextMock.Verify(x => x.ClosestLocations.FromSql(It.IsAny<string>(), It.Is<ClosestLocationsQuery>(y => y.LocationQuery.Distance == message.LocationQuery.Distance && y.LocationQuery.Latitude == message.LocationQuery.Latitude && y.LocationQuery.Longitude == message.LocationQuery.Longitude && y.LocationQuery.MaxRecordsToReturn == message.LocationQuery.MaxRecordsToReturn)));}",How could I Mock the FromSql() method?
How could I Mock the FromSql() method in entity framework core?," I was wondering is there any way other than building a wrapper for mocking the FromSql? I know this method is static, but since they added things like AddEntityFrameworkInMemoryDatabase to entity framework core, I thought there might be a solution for this too, I use EF Core 1.0.1 in my project.My end goal is to test this method: I want to ensure that my query is handled with the same object that I passed into it, based on this answer in entity framework 6 I could do something like this: But unlike SqlQuery<T> in EF 6, the FromSql<T> in EF Core is static extension method, I'm asking this question because I think I might approach this problem from the wrong angle or there might be a better alternative than a wrapper, I'd appreciate any thought on this. <code>  public List<Models.ClosestLocation> Handle(ClosestLocationsQuery message){ return _context.ClosestLocations.FromSql( ""EXEC GetClosestLocations {0}, {1}, {2}, {3}"", message.LocationQuery.Latitude, message.LocationQuery.Longitude, message.LocationQuery.MaxRecordsToReturn ?? 10, message.LocationQuery.Distance ?? 10 ).ToList();} [Fact]public void HandleInvokesGetClosestLocationsWithCorrectData(){ var message = new ClosestLocationsQuery { LocationQuery = new LocationQuery {Distance = 1, Latitude = 1.165, Longitude = 1.546, MaxRecordsToReturn = 1} }; var dbSetMock = new Mock<DbSet<Models.ClosestLocation>>(); dbSetMock.Setup(m => m.FromSql(It.IsAny<string>(), message)) .Returns(It.IsAny<IQueryable<Models.ClosestLocation>>()); var contextMock = new Mock<AllReadyContext>(); contextMock.Setup(c => c.Set<Models.ClosestLocation>()).Returns(dbSetMock.Object); var sut = new ClosestLocationsQueryHandler(contextMock.Object); var results = sut.Handle(message); contextMock.Verify(x => x.ClosestLocations.FromSql(It.IsAny<string>(), It.Is<ClosestLocationsQuery>(y => y.LocationQuery.Distance == message.LocationQuery.Distance && y.LocationQuery.Latitude == message.LocationQuery.Latitude && y.LocationQuery.Longitude == message.LocationQuery.Longitude && y.LocationQuery.MaxRecordsToReturn == message.LocationQuery.MaxRecordsToReturn)));}",How could I Mock the FromSql() method?
HTTP Error 500.19 when publish .net core project into iis," I want to publish a sample .net core web application on my pc's IIS manager but I failed. I am using Microsoft guidance but it doesn't work for me, if you have reasonable experience to fix this problem I would be grateful to see your suggestions. <code> ",HTTP Error 500.19 when publish .net core project into iis with 0x80070005
WPF exe is running very slow compare to running in Visual studio," I have created an application in WPF using the MVVM pattern.The application is running fine in the Visual Studio debugger, but when I'm running the exe from the debug/release folder, it becomes very slow.Here is my RelayCommand class: If I remove the CanExcecute() method from my RelayCommand class, then the exe version runs as normal.Please can anyone explain why this thing is happening? Is it for the CanExecuteChanged event handler?  <code>  public class RelayCommand : ICommand{ private readonly Action<object> execute; private readonly Predicate<object> canExecute; public RelayCommand(Action<object> execute) : this(execute, DefaultCanExecute) { } public RelayCommand(Action<object> execute, Predicate<object> canExecute) { this.execute = execute; this.canExecute = canExecute; } public event EventHandler CanExecuteChanged { add { CommandManager.RequerySuggested += value; } remove { CommandManager.RequerySuggested -= value; } } [DebuggerStepThrough] public bool CanExecute(object parameter) { bool res = false; if (canExecute != null) { res = canExecute(parameter); } return res; } public void Execute(object parameter) { execute(parameter); } private static bool DefaultCanExecute(object parameter) { return true; }}",WPF exe running very slow compared to running in Visual studio
Xamarin.Froms.Color to hex," I have a Xamarin.Forms.Color and I want to convert it to a 'hex value'.So far, I haven't found a solution to my problem.My code is as follows: <code>  foreach (var cell in Grid.Children){ var pixel = new Pixel { XAttribute = cell.X , YAttribute = cell.Y , // I want to convert the color to a hex value here Color = cell.BackgroundColor };}",Xamarin.Forms.Color to hex value
Xamarin.Forms.Color to hex," I have a Xamarin.Forms.Color and I want to convert it to a 'hex value'.So far, I haven't found a solution to my problem.My code is as follows: <code>  foreach (var cell in Grid.Children){ var pixel = new Pixel { XAttribute = cell.X , YAttribute = cell.Y , // I want to convert the color to a hex value here Color = cell.BackgroundColor };}",Xamarin.Forms.Color to hex value
Raw Html code with razor," I've searched over this website and I've looked over similar questions and i did not find the answer, I am sure it is somewhere but i did not find it, I have a string like this one for example : This string comes from a certain request in control, and i have no power to change the model or the control. I can only change my razor view, using Html.Raw displays this result : And the result i want to be displayed is this one :Hello WorldHow is it possible ?PS: this is only a simple example, it can be any HTML Code. <code>  string inputText = ""&lt;strong&gt;Hello World&lt;/strong&gt;"" <strong>Hello World</strong>",Render Html code with razor
An error occurred attempting to determine the process id of dot net.exe which is hosting your application.One or more error occured," I have clone the project from source url. My friend has developed the asp.net core web application using .NetCore 1.0.0-preview2-003121 sdk. However on my pc I have install .NetCore 1.0.1-preview2-003131 sdk. I am getting the error. I changed the version in the global.json file as you can see below but still no solution.I google it but all the solution are not working for me.Global.json file Project.json Dot net version in my pcHow can I solve this issue. Please can anyone let me know about this.[[ <code>  { ""projects"": [ ""src"", ""test"" ], ""sdk"": { ""version"": ""1.0.0-preview2-003131"" }} { ""userSecretsId"": ""aspnet-FMM-02f339eb-4af7-42c9-b7f3-d05b48d36811"", ""dependencies"": { ""Microsoft.NETCore.App"": { ""version"": ""1.0.0"", ""type"": ""platform"" }, ""Microsoft.AspNetCore.Authentication.Cookies"": ""1.0.0"", ""Microsoft.AspNetCore.Diagnostics"": ""1.0.0"", ""Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore"": ""1.0.0"", ""Microsoft.AspNetCore.Mvc"": ""1.0.0"", ""Microsoft.AspNetCore.Razor.Tools"": { ""version"": ""1.0.0-preview2-final"", ""type"": ""build"" }, ""Microsoft.AspNetCore.Server.IISIntegration"": ""1.0.0"", ""Microsoft.AspNetCore.Server.Kestrel"": ""1.0.0"", ""Microsoft.AspNetCore.StaticFiles"": ""1.0.0"", ""Microsoft.Extensions.Configuration.EnvironmentVariables"": ""1.0.0"", ""Microsoft.Extensions.Configuration.Json"": ""1.0.0"", ""Microsoft.Extensions.Configuration.UserSecrets"": ""1.0.0"", ""Microsoft.Extensions.Logging"": ""1.0.0"", ""Microsoft.Extensions.Logging.Console"": ""1.0.0"", ""Microsoft.Extensions.Logging.Debug"": ""1.0.0"", ""Microsoft.Extensions.Options.ConfigurationExtensions"": ""1.0.0"", ""Microsoft.VisualStudio.Web.BrowserLink.Loader"": ""14.0.0"", ""Microsoft.VisualStudio.Web.CodeGeneration.Tools"": { ""version"": ""1.0.0-preview2-final"", ""type"": ""build"" }, ""Microsoft.VisualStudio.Web.CodeGenerators.Mvc"": { ""version"": ""1.0.0-preview2-final"", ""type"": ""build"" }, ""Microsoft.EntityFrameworkCore.Tools"": { ""version"": ""1.0.0-preview2-final"", ""type"": ""build"" }, ""Microsoft.EntityFrameworkCore"": ""1.0.0"", ""Microsoft.AspNetCore.Identity"": ""1.0.0"", ""Microsoft.AspNetCore.Identity.EntityFrameworkCore"": ""1.0.0"", ""Microsoft.EntityFrameworkCore.Relational"": ""1.0.0"", ""Microsoft.EntityFrameworkCore.SqlServer"": ""1.0.0"", ""Microsoft.EntityFrameworkCore.Design"": ""1.0.0-preview2-final"", ""Microsoft.AspNetCore.Authentication.Facebook"": ""1.0.0"", ""Microsoft.AspNetCore.Authentication.Google"": ""1.0.0"", ""MailKit"": ""1.8.1"", ""NLog.Extensions.Logging"": ""1.0.0-*"", ""System.Data.SqlClient"": ""4.1.0"" }, ""tools"": { ""Microsoft.AspNetCore.Razor.Tools"": ""1.0.0-preview2-final"", ""Microsoft.AspNetCore.Server.IISIntegration.Tools"": ""1.0.0-preview2-final"", ""Microsoft.EntityFrameworkCore.Tools"": ""1.0.0-preview2-final"", ""Microsoft.Extensions.SecretManager.Tools"": ""1.0.0-preview2-final"", ""Microsoft.VisualStudio.Web.CodeGeneration.Tools"": { ""version"": ""1.0.0-preview2-final"", ""imports"": [ ""portable-net45+win8"" ] } }, ""frameworks"": { ""netcoreapp1.0"": { ""imports"": [ ""dotnet5.6"", ""portable-net45+win8"" ] } }, ""buildOptions"": { ""emitEntryPoint"": true, ""preserveCompilationContext"": true, ""xmlDoc"": false }, ""runtimeOptions"": { ""configProperties"": { ""System.GC.Server"": true } }, ""publishOptions"": { ""include"": [ ""wwwroot"", ""Views"", ""Areas/**/Views"", ""appsettings.json"", ""web.config"", ""nlog.config"" ] }, ""scripts"": { ""prepublish"": [ ""bower install"" ], ""postpublish"": [ ""dotnet publish-iis --publish-folder %publish:OutputPath% --framework %publish:FullTargetFramework%"" ] }}",An error occurred attempting to determine the process id of dotnet.exe which is hosting your application. One or more error occured
Upload a document to new Dropbox API V2," I'm using the new Dropbox SDK v2 for .NET.I'm trying to upload a document to a Dropbox account. This code snippet actually creates a test.txt document on the Dropbox account with the ""Testing!"" content, but I want to upload a document, with a given path (for example: ""C:\MyDocuments\test.txt""), is that possible?Any help would be very much appreciated. <code>  public async Task UploadDoc() { using (var dbx = new DropboxClient(""XXXXXXXXXX"")) { var full = await dbx.Users.GetCurrentAccountAsync(); await Upload(dbx, @""/MyApp/test"", ""test.txt"",""Testing!""); } }async Task Upload(DropboxClient dbx, string folder, string file, string content) { using (var mem = new MemoryStream(Encoding.UTF8.GetBytes(content))) { var updated = await dbx.Files.UploadAsync( folder + ""/"" + file, WriteMode.Overwrite.Instance, body: mem); Console.WriteLine(""Saved {0}/{1} rev {2}"", folder, file, updated.Rev); } }",File uploading Dropbox v2.0 API
xaml conditional price format," I would like to make a binding with a ""conditional"" price format.More precisely, If another property is at true: display price without percentage, if it is at false, display price with percentage. Is there a way to handle this case with xaml or should I just make a string price property in my code-behind code? <code> ",xaml conditional StringFormat
Volitile variables," I recently had an interview with a software company who asked me the following question: Can you describe to me what adding volatile in front of variables does? Can you explain to me why it's important?Most of my programming knowledge comes from C, yet the job position is for C# (I thought I might add this bit of info if necessary for the question specifically)I answered by saying it just lets the compiler know that the variable can be used across processes or threads, and that it should not use optimization on that variable; as optimizing it can deteriorate behavior. In a nutshell, it's a warning to the compiler.According to the interviewer, however, it's the other way around, and the volatile keyword warns the OS, not the compiler. I was a bit befuddled by this, so I did some research and actually found conflicting answers! Some sources say it's for the compiler, and others for the OS.Which is it? Does it differ by language? <code> ",Volatile variables
"Control or access ""Rotate 180 degree"" checkbox for printers in C#"," I have multiple printers which contain a ""Rotate 180 degree"" checkbox like below:Here's another one (""Nee"" means ""no""):Is there a way to programmatically set this value, and change PrintTicket? If not, how can I get the current value of it? For my software I need to know if this is set or not and if it's set it needs to be changed, if possible. For my software it would be the best if I don't have to open the printdialog, it's a piece of software where users can print directly without clicking any buttons, so setting or getting it programmatically is what I'm looking for.I've been searching around using ManagementObjectSearcher and in the normal PrintDocument.DefaultPageSettings property but couldn't find anything! If this option isn't set, I automatically want to set it temporarily for the users (otherwise it prints upside down with my particular printers). I've been messing around trying to set it for the users but I can't figure out how to get it to work. I've been looking at the DEVMODE struct and tried to implement it but it also doesn't have a ""rotate 180 degrees option"" or anything similar.NOTE: I'M NOT TRYING TO SET LANDSCAPE MODE. That's pretty easy and something different.I tried doing the following: pdialog.PrintQueue.CurrentJobSettings.CurrentPrintTicket.PageOrientation = PageOrientation.ReversePortrait; However, this only inverts the page orientation and not the content (the content needs to be rotated as well). If I rotate the visual that I'm printing, the margins aren't right anymore so that doesn't work either! Hope someone can help. Thanks in advance.EDITI used Hans' method to figure out which value to change. Note that his method would apply for any type of printer! The devmode changes the value of the PrintDialog. This took me hours and hours to solve so for whoever I can help, here's my code and I'm glad to share or help! First I was trying to change DefaultPrintTicket from a new PrintServer() which didn't work, but UserPrintTicket seemed to be the right one where you can actually see the value change in WindowsControl Panel if you don't switch back to the original one. *However*, this only seemed to work on just my pc (which was necessary), on a virtual machine for example themagic` value was already different. This was rather practice than real-life usage. ... The value in the printdialog changes, but it still prints wrong. The changes don't apply. Any help is welcome! <code>  var pdialog = new PrintDialog();pdialog.PrintQueue = new PrintQueue(new LocalPrintServer(), _printername, PrintSystemDesiredAccess.AdministratePrinter); // this will be your printer. any of these: new PrintServer().GetPrintQueues()pdialog.PrintTicket.PageMediaSize = size;pdialog.PrintTicket.CopyCount = _amount;if (CheckPrinterDriverName(_printername)){ int magic = 361; var defaulttckt = pdialog.PrintQueue.UserPrintTicket; pdialog.PrintQueue.UserPrintTicket = PrinterModifier.ChangeDevMode(pdialog, magic, vis); pdialog.PrintQueue.Commit(); pdialog.PrintVisual(vis, ""Label""); //Set back old settings so it's not permanently changed pdialog.PrintQueue.UserPrintTicket = defaulttckt; pdialog.PrintQueue.Commit();} class PrinterModifier{ public static PrintTicket ChangeDevMode(PrintDialog pdialog, int prpty, DrawingVisual vis) { var queue = pdialog.PrintQueue; var cvt = new PrintTicketConverter(queue.Name, PrintTicketConverter.MaxPrintSchemaVersion); // Display dialog, don't make changes var devmode1 = cvt.ConvertPrintTicketToDevMode(pdialog.PrintTicket, BaseDevModeType.UserDefault); // Consistency check var dmSize = BitConverter.ToInt16(devmode1, 68); var dmDriverExtra = BitConverter.ToInt16(devmode1, 70); if (devmode1[361] == 0) { devmode1[361] = 1; } return cvt.ConvertDevModeToPrintTicket(devmode1, PrintTicketScope.PageScope); }}",Control or access custom printer settings (Rotate 180 degrees) for printers in C#
C# 7.0 Tuples vs anonymous types," Looking at the new C# 7.0 ValueTuples, I am wondering if they will completely replace Anonymous Types. I understand that ValueTuples are structs and therefore behave a bit differently than Anonymous Types which are classes. I don't see a use-case, however, in which I would prefer using an Anonymous Type over a ValueTuple.Are there any use-cases where using an Anonymous Type would still be beneficial over using ValueTuples in C# 7.0? <code> ",C# 7.0 ValueTuples vs Anonymous Types
C# 7.0 ValueTuples vs anonymous types," Looking at the new C# 7.0 ValueTuples, I am wondering if they will completely replace Anonymous Types. I understand that ValueTuples are structs and therefore behave a bit differently than Anonymous Types which are classes. I don't see a use-case, however, in which I would prefer using an Anonymous Type over a ValueTuple.Are there any use-cases where using an Anonymous Type would still be beneficial over using ValueTuples in C# 7.0? <code> ",C# 7.0 ValueTuples vs Anonymous Types
he connection was not closed. The connection's current state is connecting," I have jwt auth: The JwtMessageHandler is my custom handler. In the handler I have to make some queries to database, so I pass ServiceProvider and resolve my user service: In the service I make queries: The OnMessageReceived is called for every request.When I have one request on page to the server or I wait one-two seconds before doing something all works fine. But, I have several pages where I make 2-3 simultaneous requests to the server. And, in this case I get error about: The connection was not closed. The connection's current state is connecting I understand that problem with multithreading. The JwtMessageHandler is created once when application is started. So, I put the line: inside method, before it was located in the constructor. But, It didn't help. Also, I tried to set null to _userService in the end of my method.How to correctly use in this case? <code>  var messageHandlers = new JwtMessageHandler(_serviceProvider);app.UseJwtBearerAuthentication(new JwtBearerOptions{ AutomaticAuthenticate = true, AutomaticChallenge = true, Events = new JwtBearerEvents { OnMessageReceived = messageHandlers.OnMessageReceived, }, TokenValidationParameters = tokenValidationParameters}); public class JwtMessageHandler{ private IUserService _userService; public async Task OnMessageReceived(MessageReceivedContext arg) { //parsing header, get claims from token ... _userService = (IUserService)arg.HttpContext.RequestServices.GetService(typeof(IUserService)); var isRoleChanged = await _userService.IsRoleChanged(tokenObject.Subject, rolesFromToken); if (isRoleChanged) { GenerateBadResponse(arg); return; } var canLogin = await _userService.CanLogin(tokenObject.Subject); if (!canLogin) { GenerateBadResponse(arg); return; } } } ... var user = await _userManager.FindByEmailAsync(email); var currentRoles = await _userManager.GetRolesAsync(user);.. _userService = (IUserService)_serviceProvider.GetService(typeof(IUserService)); ",EF. The connection was not closed. The connection's current state is connecting
How EntityFramework creates 36 digit primary key?," When we run the ASP.NET application and register the user, Entity Framework automatically sets the unique id (PK) in AspNetUser table:The same is true for other AspNetRoles, AspNetUserLogins, AspNetUserRolesexcept AspNetUserClaims which has identity enabled.Can anybody explain how Entity framework create this unique Id? And if we want to create our own table with identity disabled in EF, how will we generate this kind of Id for primary key? <code> ",How does Entity Framework generate a GUID for a primary key value?
How EntityFramework creates 36 digit primary key value?," When we run the ASP.NET application and register the user, Entity Framework automatically sets the unique id (PK) in AspNetUser table:The same is true for other AspNetRoles, AspNetUserLogins, AspNetUserRolesexcept AspNetUserClaims which has identity enabled.Can anybody explain how Entity framework create this unique Id? And if we want to create our own table with identity disabled in EF, how will we generate this kind of Id for primary key? <code> ",How does Entity Framework generate a GUID for a primary key value?
How to refresh tableview data after tapping viewcell in Xamarin Forms?," So I have the following code that creates ViewCells for my TableView dynamically:XAML: C#: What I wanted to do is whenever I tap on a view cell to update the selected property, the data in the table view are also updated. In ListView I could call the ItemSelected event and call the ItemSource again with the updated categories. Is this possible with TableView? <code>  <StackLayout> <TableView Intent=""Settings""> <TableView.Root> <TableSection x:Name=""tableSection""></TableSection> </TableView.Root> </TableView></StackLayout> categories = getCategories();foreach (var category in categories){ var viewCell = new ViewCell { View = new StackLayout() { Padding = new Thickness(20, 0, 20, 0), HorizontalOptions = LayoutOptions.FillAndExpand, Children = { new StackLayout() { Orientation = StackOrientation.Horizontal, VerticalOptions = LayoutOptions.CenterAndExpand, Children = { new StackLayout() { HorizontalOptions = LayoutOptions.StartAndExpand, Children = { new Label { Text = category.Name} }, new StackLayout() { HorizontalOptions = LayoutOptions.EndAndExpand, Orientation = StackOrientation.Horizontal, Children = { new Label { Text = category.Count}, new Image { Source = ""right1.png"", IsVisible = category.Selected } } } } } } } }; viewCell.Tapped += (sender, e) => { if (category.Selected == false) { App.DB.UpdateSelected(true); } else { App.DB.UpdateSelected(false); } categories = getCategories(); totalPhraseCount = getTotalPhraseCount(); Title = totalPhraseCount.ToString() + "" phrases""; }; tableSection.Add(viewCell);}",How to refresh TableView data after tapping ViewCell in Xamarin Forms?
Unit testing WebAPI controller methods who return IActionResult," I'm in the process of building an ASP.NET Core WebAPI and I'm attempting to write unit tests for the controllers. Most examples I've found are from the older WebAPI/WebAPI2 platforms and don't seem to correlate with the new Core controllers.My controller methods are returning IActionResults. However, the IActionResult object only has a ExecuteResultAsync() method which requires a controller context. I'm instantiating the controller manually, so the controller context in this instance is null, which causes an exception when calling ExecuteResultAsync. Essentially this is leading me down a very hacky path to get these unit tests to successfully complete and is very messy. I'm left wondering that there must be a more simple/correct way of testing API controllers.Also, my controllers are NOT using async/await if that makes a difference.Simple example of what I'm trying to achieve:Controller method: Unit test: <code>  [HttpGet(Name = ""GetOrdersRoute"")]public IActionResult GetOrders([FromQuery]int page = 0){ try { var query = _repository.GetAll().ToList(); int totalCount = query.Count; int totalPages = (int)Math.Ceiling((double)totalCount / pageSize) - 1; var orders = query.Skip(pageSize * page).Take(pageSize); return Ok(new { TotalCount = totalCount, TotalPages = totalPages, Orders = orders }); } catch (Exception ex) { return BadRequest(ex); }} [Fact]public void GetOrders_WithOrdersInRepo_ReturnsOk(){ // arrange var controller = new OrdersController(new MockRepository()); // act IActionResult result = controller.GetOrders(); // assert Assert.Equal(HttpStatusCode.OK, ????);}",Unit testing controller methods which return IActionResult
C#: Get name of specific Exception, Is this the best method for getting the name of a specific Exception in C#: It is in a generic exception handler: <code>  ex.GetType().ToString() catch (Exception ex),Get name of specific Exception
Startup.cs in a .NET Core Console Application, I have a self-hosted .NET Core Console Application.The web shows examples for ASP.NET Core but I do not have a web server. Just a simple command line application.Is it possible to do something like this for console applications? I would like to use a Startup.cs like in ASP.NET Core but on console.How do I to this? <code>  public static void Main(string[] args){ // I don't want a WebHostBuilder. Just a command line var host = new WebHostBuilder() .UseKestrel() .UseContentRoot(Directory.GetCurrentDirectory()) .UseIISIntegration() .UseStartup<Startup>() .Build(); host.Run();},Startup.cs in a self-hosted .NET Core Console Application
How to define if string contains list value and separately if contains but with other value," I'm trying to figure out how to define if string contains/does not contains list value and if contains but with other value. If I have input string: and I want find specific value for condition: But not sure what is a proper way if I want to know also about third condition, if string contains value but also contains other words.For string: inputString = ""it was one""; desired result should be: for string: inputString = ""one""; and for: inputString = ""it was""; <code>  string inputString = ""it was one""; var numbList = new List<string> {""zero"", ""one"", ""two""}; if (!numbList.Any(inputString.Contains)) { Console.WriteLine(""string does not contains list value""); }else{ Console.WriteLine(""string contains list value""); } Console.WriteLine(""string contains list value and other words""); Console.WriteLine(""string contains list value""); Console.WriteLine( ""string does not contains list value""); ",How to check if string contains list value and separately if contains but with other value
Where are generic methods stored," I've read some information about generics in . and noticed one interesting thing.For example, if I have a generic class: Two classes Foo<int> and Foo<string> are different at runtime. But what about case when non-generic class having generic method? It's obvious that there's only one Foo class. But what about method Bar? All the generic classes and methods are closed at runtime with parameters they used with. Does it mean that class Foo has many implementations of Bar and where the information about this method stored in memory? <code>  class Foo<T> { public static int Counter; }Console.WriteLine(++Foo<int>.Counter); //1Console.WriteLine(++Foo<string>.Counter); //1 class Foo { public void Bar<T>() { }}",Where are generic methods stored?
What is causing Azure Event Hubs' ReceiverDisconnectedException?," I'm receiving events from an EventHub using EventProcessorHost and an IEventProcessor class (call it: MyEventProcessor). I scale this out to two servers by running my EPH on both servers, and having them connect to the Hub using the same ConsumerGroup, but unique hostName's (using the machine name).The problem is: at random hours of the day/night, the app logs this: This Exception occurs at the same time as a LeaseLostException, thrown from MyEventProcessor's CloseAsync method when it tries to checkpoint. (Presumably Close is being called because of the ReceiverDisconnectedException?)I think this is occurring due to Event Hubs' automatic lease management when scaling out to multiple machines. But I'm wondering if I need to do something different to make it work more cleanly and avoid these Exceptions? Eg: something with epochs? <code>  Exception information: Exception type: ReceiverDisconnectedException Exception message: New receiver with higher epoch of '186' is created hence current receiver with epoch '186' is getting disconnected. If you are recreating the receiver, make sure a higher epoch is used. at Microsoft.ServiceBus.Common.ExceptionDispatcher.Throw(Exception exception) at Microsoft.ServiceBus.Common.Parallel.TaskHelpers.EndAsyncResult(IAsyncResult asyncResult) at Microsoft.ServiceBus.Messaging.IteratorAsyncResult`1.StepCallback(IAsyncResult result)",What is causing Azure Event Hubs ReceiverDisconnectedException/LeaseLostException?
How to compile .NET Core app for Linux on a windows machine," I'm developing a .NET Core app on a Windows 10 machine (with Visual Studio 2015 update 3 + Microsoft .NET Core 1.0.1 VS 2015 Tooling Preview 2) which should published on an Ubuntu 16 machine. To do that, I have to move my source code to the end machine and compile it there, to get it to run. e.g. I'm not able to compile the code on windows and run it on linux. Question: Is there any way to compile the code on win machine and run it on linux?  <code> ",How to compile .NET Core app for Linux on a Windows machine
Dapper tuple c#7," I need return a list from dapper with the new tuple in C# 7. But this function only return me 56 rows with (0,0), Item1=0, Item2=0.What I missing? <code>  public static List<(int StyleId, decimal StyleCode)> GetOnlyServices(){ var query = $@"" SELECT ST.style_id as StyleId, ST.style_code as StyleCode ... ...""; using (SqlConnection db = new SqlConnection(InfobaseConString)) { var a = db.Query<(int StyleId, decimal StyleCode)>(query, commandTimeout: 90).ToList(); return a; }}",Dapper materializing to a Tuple
AES Encrypt In Typescript And Decrypt In C#," I am having struggle to implement the encryption in typescript and decryption in C#. Before posting question here, I did Google it and find some links but those links are related to JavaScript not a typescript.Encrypt in javascript and decrypt in C# with AES algorithmencrypt the text using cryptojs library in angular2How to import non-core npm modules in Angular 2 e.g. (to use an encryption library)?I followed the above links, for implementing the encryption/decryption concept in my current application.This is the code I wrote in myservice.ts Before I added the above lines of code in myservice.ts, I added the dependency as ""crypto-js"": ""^3.1.9-1"" in package.json file.After added the above dependency in package.json, then I was restored the packages successfully. But still also CryptoJS shows error in myservice.ts like can not found name as CryptoJS.Can you please tell me how to import the CryptoJS from node modules and also tell me how to encrypt the string in typescript and decrypt the same string in C# using Advanced Security Algorithm (AES)?Pradeep <code>  //import { CryptoJS } from 'node_modules/crypto-js/crypto-js.js'; //import 'crypto-js'; import * as CryptoJS from 'crypto-js'; var key = CryptoJS.enc.Utf8.parse('7061737323313233'); var iv = CryptoJS.enc.Utf8.parse('7061737323313233'); var encrypted = CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse(""It works""), key, { keySize: 128 / 8, iv: iv, mode: CryptoJS.mode.CBC, padding: CryptoJS.pad.Pkcs7 }); var decrypted = CryptoJS.AES.decrypt(encrypted, key, { keySize: 128 / 8, iv: iv, mode: CryptoJS.mode.CBC, padding: CryptoJS.pad.Pkcs7 }); console.log('Encrypted :' + encrypted); console.log('Key :' + encrypted.key); console.log('Salt :' + encrypted.salt); console.log('iv :' + encrypted.iv); console.log('Decrypted : ' + decrypted); console.log('utf8 = ' + decrypted.toString(CryptoJS.enc.Utf8));",Encrypt the string In Typescript And Decrypt In C# using Advanced Encryption Standard Algorithm(AES)
"""Unable to set the FreezePanes property of the Window class"" Excel office365"," I've build an excel addin which fills a worksheet with data from a database. I also add some styling and lock some rows and columns by using FreezePanes. This all worked like a charm in excel 2010/2013 but I recently switched to excel 2016 (office 365) and from then on I had problems with the FreezePanes when my excel worksheet is not on the foreground. I searched the internet and the only thing I come across is that I can only preform a FreezePanes on an active sheet, I knew that - I allready do activate the sheet before setting the FreezePanes. This worked in excel 2010, even though physically my excel wasn't sent to the foreground.Excel from the office 365 probably really want my excel worksheet to be physically in the foreground but worksheet.Activate() doesn't help and I also tried the following code: But this too didn't work. Can any body help me with this one?To be clear: The version of my excel is 2016 Version 1611 (Build 7571.2109)  <code>  worksheet.Activate();worksheet.Application.ActiveWindow.FreezePanes = false;worksheet.Application.ActiveWindow.SplitRow = 4;worksheet.Application.ActiveWindow.SplitColumn = 11;worksheet.Application.ActiveWindow.FreezePanes = true; [DllImport(""user32.dll"")][return: MarshalAs(UnmanagedType.Bool)]static extern bool SetForegroundWindow(IntPtr hWnd); [DllImport(""user32.dll"", SetLastError = true)]static extern System.IntPtr FindWindow(string lpClassName, string lpWindowName); string caption = oExcel.Caption;IntPtr handler = FindWindow(null, caption);SetForegroundWindow(handler);","""Unable to set the FreezePanes property of the Window class"" Excel 2016 (office 365)"
EF6 With TransactionScope - IsolationLevel.ReadUncommitted," There is a performance and lock issue when using EF for a update-from-query case on MSSQL 2008. So I put ReadUncommitted transaction isolationlevel, hoping to resolve it, like this,Before After We use SQL profiler to trace. However, got these scripts in order, (Expect read-uncommitted for the 1st script.)Audit Login SP:StmtStarting Audit Login Though I could resend this request and make it right order (will show read-uncommitted for the following requests, same SPID), I wonder why it sent read-uncommitted command after read-committed command and how to fix by using EF and TransactionScope ? Thanks. <code>  using (MyEntities db = new MyEntities()){ // large dataset var data = from _Contact in db.Contact where _Contact.MemberId == 13 select _Contact; for (var item in data) item.Flag = 0; // Probably db lock db.SaveChanges(); } using (var scope = new TransactionScope(TransactionScopeOption.RequiresNew, new TransactionOptions() { IsolationLevel = IsolationLevel.ReadUncommitted })){ using (MyEntities db = new MyEntities()) { // large dataset but with NOLOCK var data = from _Contact in db.Contact where _Contact.MemberId == 13 select _Contact; for (var item in data) item.Flag = 0; // Try avoid db lock db.SaveChanges(); }} set transaction isolation level read committed SELECT [Extent1].[ContactId] AS [ContactId], [Extent1].[MemberId] AS [MemberId], FROM [dbo].[Contact] AS [Extent1]WHERE [Extent1].[MemberId] = @p__linq__0 set transaction isolation level read uncommitted",EF6 with TransactionScope - IsolationLevel.ReadUncommitted but got ReadCommitted first
Register all implementation of type T interface in .NET Core, I have an interface An Event class Two Event Handlers classes In .NET 4.5 this was possible using Autofac And then I would get the list of classes based on the type T How to do this in .NET Core <code>  public interface IEvent { } public class ContactEvent : IEvent { } public class ContactCreateHandler : IEventHandler<ContactEvent> { }public class ContactUpdateHandler : IEventHandler<ContactEvent> { } var assemblies = BuildManager.GetReferencedAssemblies() .Cast<Assembly>() .ToArray()builder.RegisterAssemblyTypes(assemblies).AsClosedTypesOf(typeof(IEventHandler<>)).AsImplementedInterfaces().InstancePerRequest(); var handlerList = _container.Resolve<IEnumerable<IEventHandler<T>>>();,Register all implementation of type T interface in .NET core
Register all implementation of type T interface, I have an interface An Event class Two Event Handlers classes In .NET 4.5 this was possible using Autofac And then I would get the list of classes based on the type T How to do this in .NET Core <code>  public interface IEvent { } public class ContactEvent : IEvent { } public class ContactCreateHandler : IEventHandler<ContactEvent> { }public class ContactUpdateHandler : IEventHandler<ContactEvent> { } var assemblies = BuildManager.GetReferencedAssemblies() .Cast<Assembly>() .ToArray()builder.RegisterAssemblyTypes(assemblies).AsClosedTypesOf(typeof(IEventHandler<>)).AsImplementedInterfaces().InstancePerRequest(); var handlerList = _container.Resolve<IEnumerable<IEventHandler<T>>>();,Register all implementation of type T interface in .NET core
C# : Application crashes when spamming Refresh button in ReportViewer," IntroductionThis is a portion of how the ReportViewer looks like in my Winforms application which is targeting .NET framework 4.6.1. The OK button calls the btnOk_Click event while the refresh button (Double-green arrows in a circle) calls the ReportViewer event which in itself calls btnOK_Click event with null parameters. The code below illustrates itCode ProblemMy application crashes after clicking Refresh button in ReportViewer a few times.This is what I found in the Event Viewer > Windows Logs > ApplicationMessage: An exception was not handled in an AsyncLocal notification callback. I tried googling for the error but came up short.CluesThis problem does not happen in debug mode (Visual Studio 2015)This problem does not happen when I rapidly click the OK button.This problem does not happen when I add redundant/test codes (e.g., MessageBox.Show()) after this.rpvCustomReport.RefreshReport(); line in btnOk_Click event. But when I add them before that line, the problem happens. This was how I concluded that the this.rpvCustomReport.RefreshReport(); was causing the problem.QuestionsWhy did that problem occur?What are the steps I should perform to be able to debug this kind of problem in the future?WorkaroundIn order to fix this, I have to cancel the event before calling btnOk_Click. I still don't understand why I need to cancel the default behavior. It doesn't seem like a good fix. <code>  private void btnOk_Click(object sender, EventArgs e) { try { ... //Code adding datasources to rpvCustomReport ... this.rpvCustomReport.RefreshReport(); //Causing the error. //NOTE: this.rpvCustomReport is instantiated in .Design.cs as //new Microsoft.Reporting.WinForms.ReportViewer(); ... } catch (Exception ex) { HandleException(ex); //Custom function to handle exception } }private void rpvCustomReport_ReportRefresh(object sender, CancelEventArgs e) { this.btnOk_Click(null, null); //sender object and event variables are not used in this function, hence, it is set to null } private void rpvCustomReport_ReportRefresh(object sender, CancelEventArgs e){ e.Cancel = true; //Cancel the default event. this.btnOk_Click(null, null); //sender object and event variables are not used in this function, hence, it is set to null}",C# : Application crashes after clicking Refresh button in ReportViewer a few times
Regex for removing only specific special charachters from string," I'd like to write a regex that would remove the special characters on following basis:To remove white space character@, &, ', (, ), <, > or #I have written this regex which removes whitespaces successfully: But I'd like to upgrade/change it so that it can remove the characters above that I mentioned.Can someone help me out with this? <code>  string username = Regex.Replace(_username, @""\s+"", """");",Regex for removing only specific special characters from string
What is the correct way to use EntityFramework as datasource for DataGridView?, I tried setting DataSource via DataGridView Designer but it wasn't listed there and then I generated new datasource via wizard which generated DataSet.But now I have Entity Framework in my project + DataSet how can I use Entity Framework only... I'm confused.artiklBindingSource was automatically generated I only wanted to use EF as datasource now I'm stuck with unwanted DataSet. <code> ,What is the correct way to use Entity Framework as datasource for DataGridView?
"Connecting to FTP with SSL using C#, causing error"," I am using IIS in my local machine for testing FTP with SSL connection. I am using the FluentFTP library for connecting to the FTP. I am using the following code to connect to the Server. The server is returning me with the following error. FluentFTP.FtpCommandException: Policy requires SSL.; Win32 error: Access is denied.; Error details: SSL policy requires SSL for control channel.;For connecting over FTP the above code is working fine and for FTP with SSL it is not working. <code>  FtpClient conn = new FtpClient();conn.Host = firewallSslDetails.Address;conn.Credentials = new NetworkCredential(firewallSslDetails.UserName, firewallSslDetails.Password);conn.SslProtocols = System.Security.Authentication.SslProtocols.Default;X509Certificate2 cert = new X509Certificate2(@""C:\Users\BizTalk360\Desktop\FtpSites\ServerCert.cer"");conn.EncryptionMode = FtpEncryptionMode.Implicit;conn.DataConnectionType = FtpDataConnectionType.AutoActive;conn.DataConnectionEncryption = true;conn.EnableThreadSafeDataConnections = false;conn.ClientCertificates.Add(cert);conn.ValidateCertificate += new FtpSslValidation(OnValidateCertificate);conn.Connect();",Connecting to FTPS (FTP over SSL) with FluentFTP
Are there buil-in Month name declensions in C#," I'm wondering if there's any built-in functionality in .NET for declining dates in languages that support noun declensions, (ie. In Russian the month name is , but if I wanted to say the date or say that something is due by, I'd use the form ). I made my own version, which works for this case, but I will need to expand to to other cases, and other languages, which will have their own declensions for dates.Is this functionality built-in, or available in an external library? Thank you for any help.I've provided my function for the Russian genitive case, if my explanation wasn't clear. <code>  public static string DeclineMonth(this DateTime time){ var month = time.ToString(""MMMM""); if (month.Last() == '') return month.Replace('', ''); else return month + ""a"";} ",Are there built-in Month name declensions in C#
Replacement for DataTable/DataSet in .NET Core," .NET Core 3.1 supports DataTable/DataSet, DataRow, DataView, etc - which was not available when the OP created the following questionbased on my research, it seems like .net core does not support DataTable/DataSet. I recently shifted to .net core for developing a new application, but failed to recognize that .net core does not have library for those in the first place. I used to use dt/ds for fetching the data via stored procedure and fill collection of classes. But now, I am quite lost with this new problem that I have to find replacement for dt/ds. To be more specific, I used to do this:I have a stored procedure that takes four input parameters and returns a table. and create a class with same fields as I have in my stored procedure. and fetch data and fill collection of class My bad, I should have researched more before I initiated the project, but I really need anyone's help to find replacement for the above code. Would it be possible to use .net core's FromSql method as a replacement? Any suggestion or sample codes would be appreciated.EditAccording to Peter's article, found a way to implement ds/dt in .net core version, but having a bit problem passing an int array(StudentIds) to my stored procedure. I think the problem comes from passing IEnumerable? How can I pass an int array to stored procedure correctly? <code>  ALTER PROCEDURE stp_Student@Name nvarchar(450), @StudentIds tvp_ArrayInt READONLY, @StartDate date,@EndDate date, ASblah blah //returns student summarySELECT stu.StudentId, stu.StudentName, CASE WHEN (COUNT(DISTINCT course.Id) IS NOT NULL) THEN COUNT(DISTINCT course.Id) ELSE 0 END AS CourseCount, CASE WHEN (SUM(course.TotalCourses) IS NOT NULL) THEN SUM(course.TotalCourses) ELSE 0 END AS TotalCourses, CASE WHEN (SUM(course.Hours) IS NOT NULL) THEN SUM(course.Hours) ELSE 0 END AS HoursFROM #TempStudent AS #Temp public class StudentModel{ public string StudentId { get; set; } public string StudentName { get; set; } public int CourseCount { get; set; } [Column(TypeName = ""Money"")] public decimal TotalCourses { get; set; } public double Hours { get; set; }} using (SqlConnection conn = new SqlConnection(connectionString)) { SqlCommand cmd = new SqlCommand(""sp_Student"", conn); cmd.CommandType = CommandType.StoredProcedure; cmd.Parameters.AddWithValue(""@Name"", name); cmd.Parameters.AddWithValue(""@StudentIds"", studentIds); cmd.Parameters.AddWithValue(""@StartDate"", startDate); cmd.Parameters.AddWithValue(""@EndDate"", endDate); conn.Open(); SqlDataAdapter da = new SqlDataAdapter(); da.SelectCommand = cmd; da.Fill(ds); conn.Close();}foreach (Datarow row in ds.Tables[0].Rows){ var model = new StudentModel(); model.StudentId = Convert.ToString(row[""StudentId""]); //etc.. studentList.Add(model);} public List<StudentModel> GetStudents(string name, IEnumerable<int> studentIds, DateTime startDate, DateTime endDate) { List<StudentModel> students = new List<StudentModel>(); StudentModel = null; List<DbParameter> parameterList = new List<DbParameter>(); parameterList.Add(base.GetParameter(""Name"", name)); parameterList.Add(base.GetParameter(""StudentIds"", studentIds)); parameterList.Add(base.GetParameter(""StartDate"", startDate)); parameterList.Add(base.GetParameter(""EndDate"", endDate)); using (DbDataReader dataReader = base.ExecuteReader(""stp_Student"", parameterList, CommandType.StoredProcedure)) { if (dataReader != null) { while (dataReader.Read()) { model = new StudentModel(); model.StudentId= (int)dataReader[""StudentId""]; .... students .Add(model); } } } return students; }}",Replacement for DataTable/DataSet in .NET Core (NET Standard 2.1)
How to creat roles in asp.net core and assign it to user," I am using the ASP.NET Core default website template and have the authentication selected as ""Individual User Accounts"". How can I create roles and assign it to users so that I can use the roles in a controller to filter access? <code> ",How to create roles in ASP.NET Core and assign them to users?
How to create roles in asp.net core and assign them to users," I am using the ASP.NET Core default website template and have the authentication selected as ""Individual User Accounts"". How can I create roles and assign it to users so that I can use the roles in a controller to filter access? <code> ",How to create roles in ASP.NET Core and assign them to users?
XmlWriter encoding UTF-8 StringWriter C#," I'm using C# to output an xml file and Im trying to set the xml encoding value to UTF-8 but its currently outputting: This is my code: Must be something simple I am missing? <code>  <?xml version=""1.0""?> public sealed class StringWriterWithEncoding: StringWriter { private readonly Encoding encoding; public StringWriterWithEncoding(Encoding encoding) { this.encoding = encoding; } public override Encoding Encoding { get { return encoding; } }}private string GetXml(JobStore jobStore) { StringWriterWithEncoding sw = new StringWriterWithEncoding(); XmlWriterSettings settings = new XmlWriterSettings(); settings.Encoding = Encoding.UTF8; settings.Encoding = Encoding.GetEncoding(""utf-8""); settings.Indent = true; using(var writer = XmlWriter.Create(sw, settings)) { writer.WriteStartDocument(); writer.WriteStartElement(""resources""); writer.WriteStartElement(""string""); writer.WriteAttributeString(""name""); writer.WriteCData(""value""); writer.WriteEndElement(); writer.WriteEndElement(); writer.WriteEndDocument(); } return sw.ToString();}",XmlWriter encoding UTF-8 using StringWriter in C#
Entity Framework Core: How can I get the Primary Key for the Db Set without knowing the context?," I use Net Core 1.1 and Entity Framework Core with the fluent API. I am writing a simple extension method for DbSet to show its entities in Console: This works but I'd like to have the entities sorted by the primary key before showing them. If I had the DbContext it would have been easily accomplished by doing something like this: Is there a way to get the same result starting from the DbSet? <code>  public static class DbSetExtension{ public static void Show<T>(this DbSet<T> set) where T:class { WriteLine(); WriteLine($""Set: {typeof(T).Name} - {set.Count()} objects.""); WriteLine(); foreach (var e in set) { WriteLine(e); } WriteLine(); WriteLine(); }} var entityType = db.Model.FindEntityType(typeof(T));var primaryKeyName = entityType.FindPrimaryKey().Properties.First().Name;var set = db.Set<T>();var orderedEntities = (set.OrderBy(e=> e.GetType().GetProperty(primaryKeyName).GetValue(e,null))).ToList();",How can I get the Primary Key for the DbSet?
How can I get the Primary Key for the Db Set without knowing the context?," I use Net Core 1.1 and Entity Framework Core with the fluent API. I am writing a simple extension method for DbSet to show its entities in Console: This works but I'd like to have the entities sorted by the primary key before showing them. If I had the DbContext it would have been easily accomplished by doing something like this: Is there a way to get the same result starting from the DbSet? <code>  public static class DbSetExtension{ public static void Show<T>(this DbSet<T> set) where T:class { WriteLine(); WriteLine($""Set: {typeof(T).Name} - {set.Count()} objects.""); WriteLine(); foreach (var e in set) { WriteLine(e); } WriteLine(); WriteLine(); }} var entityType = db.Model.FindEntityType(typeof(T));var primaryKeyName = entityType.FindPrimaryKey().Properties.First().Name;var set = db.Set<T>();var orderedEntities = (set.OrderBy(e=> e.GetType().GetProperty(primaryKeyName).GetValue(e,null))).ToList();",How can I get the Primary Key for the DbSet?
How can I get the Primary Key for the Db Set without knowing the context?," I use Net Core 1.1 and Entity Framework Core with the fluent API. I am writing a simple extension method for DbSet to show its entities in Console: This works but I'd like to have the entities sorted by the primary key before showing them. If I had the DbContext it would have been easily accomplished by doing something like this: Is there a way to get the same result starting from the DbSet? <code>  public static class DbSetExtension{ public static void Show<T>(this DbSet<T> set) where T:class { WriteLine(); WriteLine($""Set: {typeof(T).Name} - {set.Count()} objects.""); WriteLine(); foreach (var e in set) { WriteLine(e); } WriteLine(); WriteLine(); }} var entityType = db.Model.FindEntityType(typeof(T));var primaryKeyName = entityType.FindPrimaryKey().Properties.First().Name;var set = db.Set<T>();var orderedEntities = (set.OrderBy(e=> e.GetType().GetProperty(primaryKeyName).GetValue(e,null))).ToList();",How can I get the Primary Key for the DbSet?
EF Core: How can I get the Primary Key for the DbSet?," I use Net Core 1.1 and Entity Framework Core with the fluent API. I am writing a simple extension method for DbSet to show its entities in Console: This works but I'd like to have the entities sorted by the primary key before showing them. If I had the DbContext it would have been easily accomplished by doing something like this: Is there a way to get the same result starting from the DbSet? <code>  public static class DbSetExtension{ public static void Show<T>(this DbSet<T> set) where T:class { WriteLine(); WriteLine($""Set: {typeof(T).Name} - {set.Count()} objects.""); WriteLine(); foreach (var e in set) { WriteLine(e); } WriteLine(); WriteLine(); }} var entityType = db.Model.FindEntityType(typeof(T));var primaryKeyName = entityType.FindPrimaryKey().Properties.First().Name;var set = db.Set<T>();var orderedEntities = (set.OrderBy(e=> e.GetType().GetProperty(primaryKeyName).GetValue(e,null))).ToList();",How can I get the Primary Key for the DbSet?
How can I enable C# 7 in Visual Studio 2017 in my project?," After Visual Studio 2017 was released I wanted to try to create simple console project with new C# 7 features. I expected that I simply download new Visual Studio 2017, then create new console project and can use new C# 7 features. But I can't. I can use some features, like Tuples if I install NuGet package System.ValueTuple.But for other features, I don't know what I need to do. For example this NuGet issue. Do I need to do all this dirty install now? Or I can enable c# 7 features in a more simple way? <code> ",How can I enable all features of C# 7 in Visual Studio 2017 project?
Code Contracts in .NET Core," I wonder, how to properly use Code Contracts in .NET Core, so far I tried to add CC to my project, compile and debug. I'm confused by message, which is appearing in each call which uses Contract.Requires, and information found by googling. The message states: An assembly must be rewritten using the code contracts binary rewriter (CCRewrite) because it is calling Contract.Requires<TException> and CONTRACTS_FULL symbol is defined. Remove any explicit definitions of the CONTRACTS_FULL symbol from your project and rebuild. CCRewrite ....As I can see there are no CC options in the project properties and as I can see CC's Github repository is nearly dead. Is the are any way how to successfully use CC in .NET Core?And if not, is there any simple way how to replace them? I use Contract.Requires and ContractClassAttribute. Replacing Contract.Requires is obvious, but ContractClassAttribute is blowing my mind :-) <code> ",How to properly use Code Contracts in .NET Core
ASP.NET Core 1.1: Exclude or include files on publish," There were before aspdotnet1.0 include/exclude sections on project.json file Where is this section in ASP.NET Core 1.1 (there is no project.json)? Are there similar sections on .csproj file or .pubxml? <code>  { ""exclude"": [ ""node_modules"", ""bower_components"" ], ""publishExclude"": [ ""**.xproj"", ""**.user"", ""**.vspscc"" ]}",ASP.NET Core: Exclude or include files on publish
C# 7 how to unit testing local functions," I've been looking at some articles about local functions, and the one sentence states: Local functions are defined within a method and aren't available outside of itSo given the below code example is there any way to unit test the square method? <code>  int SumAndSquare(int x, int y){ var sum = x + y; return square(sum); int square(int z) { return z * z; }}",C# 7 how to unit test local functions
How to use joins with generic repository pattern for many to many relation," I have a Generic Repository like below which handles my CRUD, for a single entity its easy to use, problem starts when i try to join my POCOs.Lets say I have these POCO, they are mapped using fluent api (many to many and One to many relation) : Mapping: Generic Repository: Now if i want to join Standard to Many-to-Many Table how may i be able to do this? <code>  public class Student{ public Student() { this.Courses = new HashSet<Course>(); } public int StudentId { get; set; } public string StudentName { get; set; } //FKs public virtual Standard Standard { get; set; } public int StdandardRefId { get; set; } public virtual ICollection<Course> Courses { get; set; }}public class Course{ public Course() { this.Students = new HashSet<Student>(); } public int CourseId { get; set; } public string CourseName { get; set; } public virtual ICollection<Student> Students { get; set; }}public class Standard{ public Standard() { Students = new List<Student>(); } public int StandardId { get; set; } public string Description { get; set; } public virtual ICollection<Student> Students { get; set; }} protected override void OnModelCreating(DbModelBuilder modelBuilder){ //Many-To-Many modelBuilder.Entity<Student>() .HasMany<Course>(s => s.Courses) .WithMany(c => c.Students) .Map(cs => { cs.MapLeftKey(""StudentRefId""); cs.MapRightKey(""CourseRefId""); cs.ToTable(""StudentCourse""); }); //One-To-Many modelBuilder.Entity<Student>() .HasRequired<Standard>(s => s.Standard) .WithMany(s => s.Students) .HasForeignKey(s => s.StandardId);} public class Repository<T> : IRepository<T> where T : class, IDisposable{ internal MyDbContext context; internal DbSet<T> dbSet; public Repository() { context = new MyDbContext(); this.dbSet = context.Set<T>(); } public bool Add(T entity) { var query = dbSet.Add(entity); if (query != null) return true; return false; } public bool Update(T entity) { dbSet.Attach(entity); var query = context.Entry(entity).State = EntityState.Modified; if (query == EntityState.Modified) return true; return false; } public bool Delete(T entity) { var query = dbSet.Remove(entity); if (query != null) return true; return false; } public bool Delete(Guid id) { var query = dbSet.Remove(dbSet.Find(id)); if (query != null) return true; return false; } public T GetById(Guid id) { var query = dbSet.Find(id); if (query != null) return query; else return null; } public ICollection<T> GetAll() { return dbSet.AsEnumerable<T>().ToList(); } public void Save() { context.SaveChanges(); } public void Dispose() { if (context != null) { context.Dispose(); context = null; } }}",How to use joins with generic repository pattern - Entity Framework
How to use joins with generic repository pattern," I have a Generic Repository like below which handles my CRUD, for a single entity its easy to use, problem starts when i try to join my POCOs.Lets say I have these POCO, they are mapped using fluent api (many to many and One to many relation) : Mapping: Generic Repository: Now if i want to join Standard to Many-to-Many Table how may i be able to do this? <code>  public class Student{ public Student() { this.Courses = new HashSet<Course>(); } public int StudentId { get; set; } public string StudentName { get; set; } //FKs public virtual Standard Standard { get; set; } public int StdandardRefId { get; set; } public virtual ICollection<Course> Courses { get; set; }}public class Course{ public Course() { this.Students = new HashSet<Student>(); } public int CourseId { get; set; } public string CourseName { get; set; } public virtual ICollection<Student> Students { get; set; }}public class Standard{ public Standard() { Students = new List<Student>(); } public int StandardId { get; set; } public string Description { get; set; } public virtual ICollection<Student> Students { get; set; }} protected override void OnModelCreating(DbModelBuilder modelBuilder){ //Many-To-Many modelBuilder.Entity<Student>() .HasMany<Course>(s => s.Courses) .WithMany(c => c.Students) .Map(cs => { cs.MapLeftKey(""StudentRefId""); cs.MapRightKey(""CourseRefId""); cs.ToTable(""StudentCourse""); }); //One-To-Many modelBuilder.Entity<Student>() .HasRequired<Standard>(s => s.Standard) .WithMany(s => s.Students) .HasForeignKey(s => s.StandardId);} public class Repository<T> : IRepository<T> where T : class, IDisposable{ internal MyDbContext context; internal DbSet<T> dbSet; public Repository() { context = new MyDbContext(); this.dbSet = context.Set<T>(); } public bool Add(T entity) { var query = dbSet.Add(entity); if (query != null) return true; return false; } public bool Update(T entity) { dbSet.Attach(entity); var query = context.Entry(entity).State = EntityState.Modified; if (query == EntityState.Modified) return true; return false; } public bool Delete(T entity) { var query = dbSet.Remove(entity); if (query != null) return true; return false; } public bool Delete(Guid id) { var query = dbSet.Remove(dbSet.Find(id)); if (query != null) return true; return false; } public T GetById(Guid id) { var query = dbSet.Find(id); if (query != null) return query; else return null; } public ICollection<T> GetAll() { return dbSet.AsEnumerable<T>().ToList(); } public void Save() { context.SaveChanges(); } public void Dispose() { if (context != null) { context.Dispose(); context = null; } }}",How to use joins with generic repository pattern - Entity Framework
Discard changes to context in EF Core," I have a huge list of ""flattened"" objects in json format, and a somewhat complicated relational DB schema (with about 20 tables corresponding to a flattened object). I'm trying to automate the insertions of those flattened objects in my new relational database: The Insert() method callsAddRangeAsync() and AddAsync() for a number of related objects in different tables.Since the flattened objects are legacy, I'd say about 0.001% of them are malformed and will violate DB constraints - for example trying to insert a duplicate composite primary key in one of the tables.I expect these rare errors, thus my idea is - wrap the whole Insert() operation in a transaction - if any piece of the operation is invalid, just don't insert anything and log the error, so I can modify the flattened object manually before trying again. Thus my code looks somewhat similar to this: However, if an error occurs somewhere in my try block (I try to insert an object that violates a composite primary key) my whole context object becomes corrupt. The object that caused the exception still remains in my DbContext and any following call to AddAsync() in a different transaction triggers a new exception.I tried recreating my DbContext and repo for every new object in the foreach loop above - but even then if I query: I see my old object is still in the new instance of dbContext.Is there any (elegant) way to tell my context to reset all pending changes - so that I can put it in the catch block whenever an error occurs? I want everything that happens within my failed transaction to stay there and not leak. <code>  foreach (var flattenedObject in flattenedObjects){ _repository.Insert(flattenedObject).Wait(); //some time logging, etc} public async Task Insert(FlattenedObject fo){ using (var transaction = _context.Database.BeginTransaction()) { try { //magical code that calls AddAsync for multiple tables } catch (Exception ex) { transaction.Rollback() //logging } }} _context.ChangeTracker.Entries().Where(e => e.State != EntityState.Unchanged);",How to discard changes to context in EF Core
C#7 Pattern Matching on a string," I was wondering if there is a way to do something like this in c# 7 Sadly it does not look like it possible. Is this correct or am I doing something wrong? <code>  var test = ""aaeag""; switch (test) { case test.StartsWith(""a""): break; default: break; }",Pattern Matching on a string
dynamic property name in lambda expression," I'm trying to write a linq query that takes a dynamic property name. So for example, if the property name is 'test', a simple query would look like this: But I want to dynamically generate the property name, eg: I get an error because 'propertyName' isn't an actual property.What would be the best way to achieve this? <code>  var test = testList.Select(x => x.test).Distinct().ToList(); var propertyName = ""test"";var test = testList.Select(x => x.propertyName).Distinct().ToList();",dynamic property name in linq
dynamic property name," I'm trying to write a linq query that takes a dynamic property name. So for example, if the property name is 'test', a simple query would look like this: But I want to dynamically generate the property name, eg: I get an error because 'propertyName' isn't an actual property.What would be the best way to achieve this? <code>  var test = testList.Select(x => x.test).Distinct().ToList(); var propertyName = ""test"";var test = testList.Select(x => x.propertyName).Distinct().ToList();",dynamic property name in linq
Zip/rar/7z files in .net core with password," I'm trying to generate zip (or other compression formats) files in .net core with password, but I can't find any tool that does not come without a cost.I've tried System.IO.Compression but it doesn't have a method with password. <code> ",Zip files in .net core with password
"Dependent Role are nullable, multiplicity of the Principal Role must be 0..1"," I'm developing a C# library with .NET Framework 4.6.2 and Entity Framework 6.1.3 Code First to use it in a SQL Server 2012 database.I have these two classes: With these two configuration classes: But, when I try to run it, I get the following message that I don't understand: Product_ProductionOrders: : Multiplicity is not valid in Role 'Product_ProductionOrders_Source' in relationship 'Product_ProductionOrders'. Because all the properties in the Dependent Role are nullable, multiplicity of the Principal Role must be '0..1'.The model I'm trying to represent is:A production order can have zero or one product. And a product could be in one or n production orders.I don't know how to set multiplicity of the Principal Role to '0..1'. <code>  public class Product{ public int ProductId { get; set; } // Omitted for brevity public virtual ICollection<ProductionOrder> ProductionOrders { get; set; }}public class ProductionOrder{ public int ProductionOrderId { get; set; } public int? ProductId { get; set; } // Omitted for brevety public virtual Product Product { get; set; } // Omitted for brevity} class ProductionOrderConfiguration : EntityTypeConfiguration<ProductionOrder>{ public ProductionOrderConfiguration() { HasKey(po => po.ProductionOrderId); Property(c => c.ProductionOrderId) .HasDatabaseGeneratedOption(DatabaseGeneratedOption.None); Property(po => po.ProductionOrderId) .IsRequired(); Property(po => po.ProductId) .IsOptional(); // Omitted for brevity }}class ProductConfiguration : EntityTypeConfiguration<Product>{ public ProductConfiguration() { HasKey(p => p.ProductId); Property(p => p.ProductId) .HasDatabaseGeneratedOption(DatabaseGeneratedOption.None); // Omitted for brevity HasMany(p => p.ProductionOrders) .WithRequired(po => po.Product) .HasForeignKey(p => p.ProductId); }}",Multiplicity of the Principal Role must be 0..1
How does c# string evaluates his own value?," Why does this snippet of code produces 60ddd,and this one produces ddd302010?Seems like it's very simple, but I can't get my head around it.Please, show me direction in which I can go in order to find a detailed answer.Thanks! <code>  string str = 30 + 20 + 10 + ""ddd"";Console.WriteLine(str); string str = ""ddd"" + 30 + 20 + 10;Console.WriteLine(str);",How does c# string evaluates its own value?
Add hours/minute to datetime variable in C#," I want to add 30 minutes to my date time variable.My code: Here my datetime variable is Closetime. I want to add 30 minute to it. How is it possible? <code>  string time = ViewState[""CloseTime""].ToString();DateTime Closetime = DateTime.ParseExact(time, ""HH:mm:ss"", CultureInfo.InvariantCulture);",Add hours/minute to a datetime variable in C#
.Net 4.6 Winforms DateTimePicker garbled after Windows 10 Creators Update," Application built with VS 2015, C#, Winforms, using the DateTimePicker Windows control, text is garbled after updating machines to the Windows Creators Update.Has anyone else come across this or is there any suggested work around ? <code> ",DateTimePicker garbled after Windows 10 Creators Update
dotnet add package with local package file," Using the dotnet command line tool, how can I add a reference to an existing local package that is not downloaded with NuGet?I have tried adding a local package to a project bar with dotnet: The package foo.1.0.0.nupkg has been created with dotnet pack in a different project. The command dotnet add package however tries to download the file foo.1.0.0.nupkg from https://api.nuget.org/ which of course fails. <code>  dotnet add package /Users/sakra/foo/bin/Debug/foo.1.0.0.nupkg",Add a package with a local package file in 'dotnet'
Add a package with a local package file in 'dotnet''," Using the dotnet command line tool, how can I add a reference to an existing local package that is not downloaded with NuGet?I have tried adding a local package to a project bar with dotnet: The package foo.1.0.0.nupkg has been created with dotnet pack in a different project. The command dotnet add package however tries to download the file foo.1.0.0.nupkg from https://api.nuget.org/ which of course fails. <code>  dotnet add package /Users/sakra/foo/bin/Debug/foo.1.0.0.nupkg",Add a package with a local package file in 'dotnet'
The presence of WindowsFormsHost causes the IsKeyboardFocusWithinChanged to be fired only twice and not more," I discover a very strange behavior of WindowsFormsHost in WPF. I find that if a WPF control doesn't have WindowsFormsHost as a child control, then IsKeyboardFocusWithinChanged fires properly-- it is fired whenever the WPF control gains or loses focuses, and the variable IsKeyboardFocusWithin is toggled as expected ( true when the control gains focus, false when loses focus).But, if I host a WindowsFormHost in WPF, then after a short while, the IsKeyboardFocusWithinChanged event is no longer fired for both the WPF mother control and the WindowsFormHost child control. I can't find in MSDN documentation or SO why so, any reason?This is my code:MainWindow.xaml MainWindow.xaml.cs When the lines involving WindowsFormHost are commented out, then IsKeyboardFocusWithin is true whenever the control gains focus, and false when the control loses focus.When the lines involving WindowsFormHost are there, then IsKeyboardFocusWithin is true, until I click on the control, and then host.IsKeyboardFocusWithin becomes false, and IsKeyboardFocusWithin also becomes false, and then, no matter what I do, IsKeyboardFocusWithinChanged event will never be fired again.  <code>  <Window x:Class=""WpfApplication1.MainWindow"" xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" xmlns:d=""http://schemas.microsoft.com/expression/blend/2008"" xmlns:mc=""http://schemas.openxmlformats.org/markup-compatibility/2006"" xmlns:local=""clr-namespace:WpfApplication1"" mc:Ignorable=""d"" Title=""MainWindow"" Height=""350"" Width=""525"" IsKeyboardFocusWithinChanged=""Window_IsKeyboardFocusWithinChanged""> <Grid Name=""grid1""> </Grid></Window> public partial class MainWindow : Window{ public MainWindow() { InitializeComponent(); host = new System.Windows.Forms.Integration.WindowsFormsHost(); var mtbDate = new System.Windows.Forms.MaskedTextBox(""00/00/0000""); host.Child = mtbDate; host.IsKeyboardFocusWithinChanged += Host_IsKeyboardFocusWithinChanged; grid1.Children.Add(host); } private void Host_IsKeyboardFocusWithinChanged(object sender, DependencyPropertyChangedEventArgs e) { Console.WriteLine(host.IsKeyboardFocusWithin.ToString()+"" blah""); } private System.Windows.Forms.Integration.WindowsFormsHost host; private void Window_IsKeyboardFocusWithinChanged(object sender, DependencyPropertyChangedEventArgs e) { Console.WriteLine(IsKeyboardFocusWithin.ToString()); }}",The presence of WindowsFormsHost causes the IsKeyboardFocusWithinChanged to be fired at most twice and not more
How to remove commas from string if it's null else append commas," I am creating simple webform in C#. Here I am getting full address by concatenating which works well. But let's say if I don't have address2, city, etc, then I want to skip appending commas at end of each string (e.g. if address1 is null or empty).  <code>  string address1 = ""Address1"";string address2 = ""Address2"";string city = ""City"";string country = ""Country"";string postalCode = ""00000"";string fullAddress = ? --> address1 + "",""+ address2 +"",""+ city and so on",how to append commas only if strings are not null or empty?
Append commas only if strings are not null or empty," I am creating simple webform in C#. Here I am getting full address by concatenating which works well. But let's say if I don't have address2, city, etc, then I want to skip appending commas at end of each string (e.g. if address1 is null or empty).  <code>  string address1 = ""Address1"";string address2 = ""Address2"";string city = ""City"";string country = ""Country"";string postalCode = ""00000"";string fullAddress = ? --> address1 + "",""+ address2 +"",""+ city and so on",how to append commas only if strings are not null or empty?
Understanding async/await vs Wait in C#," One method is a standard async method, like this one : I have tested two implementations, one that use await and the other uses .Wait()The two implementations are not equal at all because the same tests are failing with the await version but not the Wait() one.The goal of this method is to ""execute a Task returned by the input function, and retry by executing the same function until it works"" (with limitations to stop automatically if a certain number of tries is reached).This works: And this (with async t => and the usage of await instead of t => and the usage of .Wait() doesn't work at all because the result of the recursive call is not awaited before the final return; is executed : I'm trying to understand why this simple change does change everything, when it's supposed to do the exact same thing : waiting the ContinueWith completion.If I extract the task ran by the ContinueWith method, I do see the state of the ContinueWith function passing to ""ranToCompletion"" before the return of the inner await completes.Why? Isn't it supposed to be awaited?Concrete testable behaviour Why does var hello = o; is reached before o=10?Isn't the #1 await supposed to hang on before the execution can continue? <code>  private static async Task AutoRetryHandlerAsync_Worker(Func<Task<bool>> taskToRun,...) private static async Task AutoRetryHandlerAsync_Worker(Func<Task<bool>> taskToRun,...){ try { await taskToRun(); } catch(Exception) { // Execute later, and wait the result to complete await Task.Delay(currentDelayMs).ContinueWith(t => { // Wait for the recursive call to complete AutoRetryHandlerAsync_Worker(taskToRun).Wait(); }); // Stop return; } } private static async Task AutoRetryHandlerAsync_Worker(Func<Task<bool>> taskToRun,...){ try { await taskToRun(); } catch(Exception) { // Execute later, and wait the result to complete await Task.Delay(currentDelayMs).ContinueWith(async t => { // Wait for the recursive call to complete await AutoRetryHandlerAsync_Worker(taskToRun); }); // Stop return; } } public static void Main(string[] args){ long o = 0; Task.Run(async () => { // #1 await await Task.Delay(1000).ContinueWith(async t => { // #2 await await Task.Delay(1000).ContinueWith(t2 => { o = 10; }); }); var hello = o; }); Task.Delay(10000).Wait();}","Understanding async/await vs Wait in C# with ""ContinueWith"" behavior"
FromBluetoothAddressAsync returns null on Windows 10 Creators Update in WPF Application," I upgraded to Windows 10, version 1703 build 15063 (Creators Update) official release. When I run the following code in a WPF desktop application, BluetoothLEDevice.FromBluetoothAddressAsync never returns. This code worked on fine before my Windows 10 update (i.e. the previous 1607 build 14393). This code also works fine if it is running as a UWP in the new Win 10 1703. I followed the instructions here https://stackoverflow.com/a/37335251/3187714 to setup my WPF desktop app to use the UWP APIs.The problem is even worse because my existing WPF application will be broken when customers start upgrading to Win 10 1703 because my existing exe no longer works.Is anyone else experiencing this problem with the Windows 10 1703 update in a (Non UWP) desktop exe?After further experiments, I did find if I added the optional BluetoothAddressType.Public 2nd argument to the FromBluetoothAddressAsync call, the function returned, but the device returned was null. <code>  BluetoothLEAdvertisementWatcher BleWatcher = null;private void Button_Click(object sender, RoutedEventArgs e){ BleWatcher = new BluetoothLEAdvertisementWatcher { ScanningMode = BluetoothLEScanningMode.Active }; BleWatcher.Received += Watcher_Received; BleWatcher.Start();}private async void Watcher_Received(BluetoothLEAdvertisementWatcher sender, BluetoothLEAdvertisementReceivedEventArgs args){ var device = await BluetoothLEDevice.FromBluetoothAddressAsync(args.BluetoothAddress); // never continues beyond this point above with my BTLE devices that previously worked } var device = await BluetoothLEDevice.FromBluetoothAddressAsync(args.BluetoothAddress, BluetoothAddressType.Public);",FromBluetoothAddressAsync never returns on Windows 10 Creators Update in WPF Application
C# - Reuse of for loop iteration variable," I have seen a lot of questions about whether to declare variables inside or outside a for loop scope. This is discussed at length, for example here, here, and here. The answer is that there is absolutely no performance difference (same IL), but for clarity, declaring variables in the tightest scope is preferred.I was curious about a slightly different situation: versus I expected both methods to compile to the same IL in Release mode. However, this is not the case. I'll spare you the full IL and just point out the difference. The first method has one local: while the second has just two locals, one for each for loop counter: So there is a difference between these two which is not optimized away, which is surprising to me.Why am I seeing this, and is there actually a performance difference between the two methods? <code>  int i;for (i = 0; i < 10; i++) { Console.WriteLine(i);}for (i = 0; i < 10; i++) { Console.WriteLine(i);} for (int i = 0; i < 10; i++) { Console.WriteLine(i);}for (int i = 0; i < 10; i++) { Console.WriteLine(i);} .locals init ( [0] int32 i) .locals init ( [0] int32 i, [1] int32 i)",Reuse of for loop iteration variable
How to set outputpath-attribute in Visual Studio 2017 project without target framework cluttering the resolved path?," Setting OutputPath in the new Visual Studio 2017 project format automatically adds the target framework in the path. For example, if I have these set in the project file: The actual output folder will resolve to /build/debug/net462/, not /build/debug/ like in the older versions.How do I solve this without workarounds like moving things around with post build actions? <code>  <TargetFramework>net462</TargetFramework><OutputPath>/build/debug/<OutputPath>",How do I set `OutputPath` in a Visual Studio 2017 project (new .csproj file format) without the target framework cluttering the resolved path?
How to set `OutputPath` attribute in Visual Studio 2017 project without target framework cluttering the resolved path?," Setting OutputPath in the new Visual Studio 2017 project format automatically adds the target framework in the path. For example, if I have these set in the project file: The actual output folder will resolve to /build/debug/net462/, not /build/debug/ like in the older versions.How do I solve this without workarounds like moving things around with post build actions? <code>  <TargetFramework>net462</TargetFramework><OutputPath>/build/debug/<OutputPath>",How do I set `OutputPath` in a Visual Studio 2017 project (new .csproj file format) without the target framework cluttering the resolved path?
How to set `OutputPath` attribute in Visual Studio 2017 project ( new .csproj file format ) without target framework cluttering the resolved path?," Setting OutputPath in the new Visual Studio 2017 project format automatically adds the target framework in the path. For example, if I have these set in the project file: The actual output folder will resolve to /build/debug/net462/, not /build/debug/ like in the older versions.How do I solve this without workarounds like moving things around with post build actions? <code>  <TargetFramework>net462</TargetFramework><OutputPath>/build/debug/<OutputPath>",How do I set `OutputPath` in a Visual Studio 2017 project (new .csproj file format) without the target framework cluttering the resolved path?
Recognize Disposable Objects in C#?, It is suggested that IDisposable objects should be disposed in either using statement or by calling Dispose() method. I find it is not intuitive to find out if an object is disposable in Visual Studio.My question is: is there any way to recognize IDisposable objects in VS? <code> ,Recognize Disposable Objects in Visual Studio?
Selenium C# Open New Tab CTRL+T Not working," This is the code that I am trying to use to open a new tab and its not working, I am not getting any errors nothing, the driver opens Google and thats all....I have searched a lot and found many tutorials even videos where people are using the exact same code and it works for them, but for me it doesnt and I can't figure it out...I tried sending Keys.Shift + ""t"" to the search field and it works, it writes a capital T in the fieldI have also tried And it still does not work, but again if I change Keys.Control to Keys.Shift it writes, seems like nothing that involves Keys.Control is working!!Edit: I have tried running the code with a IE Driver and it worked there, it opens new tab, but it does not open new tabs on Chrome? <code>  static void Main(){ IWebDriver driver = new ChromeDriver(); driver.Navigate().GoToUrl(""http://google.com""); IWebElement body = driver.FindElement(By.TagName(""body"")); body.SendKeys(Keys.Control + ""t"");} Actions act = new Actions(driver);act.KeyDown(Keys.Control).SendKeys(""t"").Perform();",Selenium C# Open New Tab CTRL+T Not working with CHROME
Why is 'DefaultInlineConstraintResolver' unable to resolve 'apiVersion'," I have a basic WebApi implementation setup with the default Values controller.After reading a blog about RESTful WebApi Versioning I decided to integrate the package into a new WebApi project.I've added the NuGet package Microsoft.AspNet.WebApi.Versioning to assist with the versioning of my API. Here is the URL to the packages configuration instructions that I am following:https://github.com/Microsoft/aspnet-api-versioning/wiki/Configuring-Your-ApplicationMy values controller is very straightforward. I've added the decoration to my Get method. Here is the code: Unfortunately, as soon as I add the following line of code to the controller the whole thing blows up: Here is a peek at the error message that is being returned: Here is the code I have inside of my Startup.cs I thought that calling AddApiVersioning and supplying the constraintResolver as outlined in the documentation would fix the issue, but it did not. Now I am struggling with what to do next. Any suggestions? <code>  [Authorize][ApiVersion(""1.0"")][Route(""api/v{version:apiVersion}/values"")]public class ValuesController : ApiController{ // GET api/values public IEnumerable<string> Get() { return new string[] { ""value1"", ""value2"" }; } public string Get(int id) { return ""value""; } // POST api/values public void Post([FromBody]string value) { } // PUT api/values/5 public void Put(int id, [FromBody]string value) { } // DELETE api/values/5 public void Delete(int id) { }} [Route(""api/v{version:apiVersion}/values"")] The inline constraint resolver of type 'DefaultInlineConstraintResolver' was unable to resolve the following inline constraint: 'apiVersion'. Line 82: GlobalConfiguration.Configure(WebApiConfig.Register); public void Configuration(IAppBuilder app){ // HTTP Configuration HttpConfiguration config = new HttpConfiguration(); //config.MapHttpAttributeRoutes(); // Configure API Versioning config.AddApiVersioning(); var constraintResolver = new DefaultInlineConstraintResolver() { ConstraintMap = { [""apiVersion""] = typeof( ApiVersionRouteConstraint ) // or mvc routing? } }; config.MapHttpAttributeRoutes(constraintResolver); // Configure the API to accept token authentication ConfigureOAuthTokenConsumption(app); // CORS app.UseCors(Microsoft.Owin.Cors.CorsOptions.AllowAll); // Configure the Authorization server ConfigureOAuth(app); // Use WebAPI app.UseWebApi(config); // Moved from global.asax AreaRegistration.RegisterAllAreas(); GlobalConfiguration.Configure(WebApiConfig.Register); FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters); RouteConfig.RegisterRoutes(RouteTable.Routes); BundleConfig.RegisterBundles(BundleTable.Bundles);} config.AddApiVersioning();var constraintResolver = new DefaultInlineConstraintResolver(){ ConstraintMap = { [""apiVersion""] = typeof( ApiVersionRouteConstraint ) // or mvc routing? }};config.MapHttpAttributeRoutes(constraintResolver);",The inline constraint resolver of type 'DefaultInlineConstraintResolver' was unable to resolve the following inline constraint: 'apiVersion'
How to copy table row with dropdownlist in MVC + jquery," I have a table and I want to clone the last line of it after the Add New link is pressed. It works completely fine when I have only TextBoxes in my rows but it doesn't when there's a dropdown. Please help me to modify the jquery code.Here's the code of the table: And here's the code that needs some improvement: I tried to modify this line whith changing input to select, but it didnt help var suffix = $trNew.find(':input:first').attr('name').match(/\d+/); <code>  <div><a href=""#"" id=""addNew"">Add New</a></div> <table id=""dataTable""> <tr> <th>Item</th> <th>Cost</th> <th></th> </tr> @if (Model != null && Model.Count > 0) { int j = 0; foreach (var i in Model) { <tr> <td>@Html.DropDownListFor(a => a[j].fk_purchase_id, (SelectList)ViewBag.fk_purchase_id, null, htmlAttributes: new { @class = ""form-control""})</td> <td>@Html.TextBoxFor(a => a[j].cost, htmlAttributes: new { @class = ""form-control"" })</td> <td> @if (j > 0) { <a href=""#"" class=""remove"">Remove</a> } </td> </tr> j++; } } </table> <script> $(function () { //1. Add new row $(""#addNew"").click(function (e) { e.preventDefault(); var $tableBody = $(""#dataTable""); var $trLast = $tableBody.find(""tr:last""); var $trNew = $trLast.clone(); alert($trNew.html); var suffix = $trNew.find(':input:first').attr('name').match(/\d+/); $trNew.find(""td:last"").html('<a href=""#"" class=""remove"">Remove</a>'); $.each($trNew.find(':input'), function (i, val) { // Replaced Name var oldN = $(this).attr('name'); var newN = oldN.replace('[' + suffix + ']', '[' + (parseInt(suffix) + 1) + ']'); $(this).attr('name', newN); //Replaced value var type = $(this).attr('type'); if (type.toLowerCase() == ""text"") { $(this).attr('value', ''); } }); $trLast.after($trNew); }); }); </script>",How to copy table row with dropdownlist in with jQuery
How to get .NET Core projects to copy NuGet references to build output?," I'm trying to write a plugin system with .NET Core, and one of my requirements are to be able to distribute the plugin DLL along with its dependencies to the user for install.However, I can't figure out how to include my NuGet dependencies as a build artifact and have them output to the build folder, without having to use dotnet publish as a hack. Is there some way I can specify this in the .csproj file (project file)? <code> ",How do I get .NET Core projects to copy NuGet references to the build output?
EntintyFramework Core auto generate key id property," Using .Net Core MVC. I need to setup my model so that EntityFrameworkCore will auto generate the ID property. I thought that just adding the [Key] annotation would do this, but it doesn't. As a matter of fact, it produces an error when the ID field is left blank, which is always because I'm hiding it from the user. I need it to instead Autogenerate a unique ID for the model every time. How do I go about doing this? My ID property is currently of type int.ExampleModel ExampleView ExampleController <code>  public class ExampleModel{ [Key] public int ID { get; set; } public string SomeData { get; set; }} @model MyNamespace.Models.ExampleModel<form asp-action=""Create"" asp-controller=""ExampleModel""> @Html.EditorForModel() <input type=""submit"" name=""Submit"" value=""Create""/></form> public IActionResult Create (){ return View();}public IActionResult Create (ExampleModel model){ if (ModelState.IsValid) { _context.ExampleModels.Add(model); _context.SaveChanges(); return RedirectToAction(""Index""); } return View(model);}",EntityFramework Core auto generate key id property
Asynchronous methods in .Net/C#," I was reading up on async/await and when Task.Yield might be useful and came across this post. I had a question regarding the below from that post: When you use async/await, there is no guarantee that the method you call when you do await FooAsync() will actually run asynchronously. The internal implementation is free to return using a completely synchronous path.This is a little unclear to me probably because the definition of asynchronous in my head is not lining up.In my mind, since I do mainly UI dev, async code is code that does not run on the UI thread, but on some other thread. I guess in the text I quoted, a method is not truly async if it blocks on any thread (even if it's a thread pool thread for example).Question:If I have a long running task that is CPU bound (let's say it is doing a lot of hard math), then running that task asynchronously must be blocking some thread right? Something has to actually do the math. If I await it then some thread is getting blocked.What is an example of a truly asynchronous method and how would they actually work? Are those limited to I/O operations which take advantage of some hardware capabilities so no thread is ever blocked? <code> ",Confusion regarding threads and if asynchronous methods are truly asynchronous in C#
How can I filter nested items of Iqueriable<T>?," I am building an expression of type Expression<Func<Project, bool>> which returns the correct IQueryable<Project> from the database. IQueryable<Project> has a nested collection of SubProjects that I would like to filter as well. It looks something like thisCan this be done with one call to the database?For example: This is what I would like to do: The GetProjectsByOrganization is as follows How can I add an Expression<Func<SubProject, bool>> to the filter? If not what alternatives do I have? <code>  Expression<Func<Project, bool>> projectFilter = FilterEnabled();projectFilter = projectFilter.And(GetProjectsByOrganization());var projectData = GetProjectsAsQueryable(projectFilter); //returns correct projects Expression<Func<Project, bool>> projectFilter = FilterEnabled();projectFilter = projectFilter.And(GetProjectsByOrganization()) .And(GetSubProjectsByStartDate());var projectData = GetProjectsAsQueryable(projectFilter); //returns correct projects and the filtered sub projects by start date public Expression<Func<Project, bool>> GetProjectByOrganization(){ var organizationIDs = new List<Guid>(); if (FilterCriteria.OrganiazaitonId != null) organizationIDs = OrganizationRepository.GetParentAndChildrenOrganizationIds(FilterCriteria.OrganiazaitonId.Value).ToList(); //... return prj => FilterCriteria.OrganiazaitonId == null || organizationIDs.Contains(prj.OrganizationID.Value);}",How can I filter nested items of IQueryable<T>?
Missing Create GUID in Visual Studio 2017?, Where can I find Create GUID options in Visual Studio 2017?I'm using Visual Studio Enterprise 2017 Edition and I'm not finding the Create GUID options from the Tools menu. <code> ,Missing Create GUID in Visual Studio Enterprise 2017?
"this is Sparta, or is it?"," The following is an interview question. I came up with a solution, but I'm not sure why it works.Question:Without modifying the Sparta class, write some code that makes MakeItReturnFalse return false. My solution: (SPOILER) public class Place{ public interface Sparta { }}But why does Sparta in MakeItReturnFalse() refer to {namespace}.Place.Sparta instead of {namespace}.Sparta? <code>  public class Sparta : Place{ public bool MakeItReturnFalse() { return this is Sparta; }}","This is Sparta, or is it?"
How to initialise ReadOnlyDictionary?," I have an unchanging dictionary that is exposed in a class.Currently my code looks like I've used the backing field _validRevisions as I could not figure out a better way of creating a shared constant dictionary property. Is there neater way to manage this or maybe I should just make the field public?My main question being is there a shorter way to initialise the _validRevisions field itself? Creating a Dictionary inline to pass it into a Dictionary (that happens to be read only) seems a bit... of a code smell. Is it? Is there a better way?EDIT: one more thing about the ROD I just noticed, there are no methods to support checking if it contains a given value... is there a reason for that related to it' read-only-ness? <code>  using System.Collections.Generic;using System.Collections.ObjectModel;public class FooClass{ private static ReadOnlyDictionary<string, byte> _validRevisions = new ReadOnlyDictionary<string, byte>( new Dictionary<string, byte>() { { ""1.0"", 0x00 }, { ""1.1"", 0x01 }, { ""1.2"", 0x02 }, { ""1.3"", 0x03 } } ); public static ReadOnlyDictionary<string, byte> ValidRevisions => _validRevisions; // other FooClass contents...}",How to initialize ReadOnlyDictionary?
ASP.NET Core MVC: Is it possible to use ValueTuple as model in View?," Is it possible to use value tuples as model type in views in ASP.NET Core MVC? I mean like this:Controller: View: However, using this setup, exception is raised when page is rendered. I am using .NET 4.6.2 with System.ValueTuple NuGet package installed. <code>  public IActionResult Index(){ ... (int ImportsCount, int ExportsCount) importsExports = (imports.Count, exports.Count); return View(importsExports);} @model (int ImportsCount, int ExportsCount)",Is it possible to use ValueTuple as model in View?
c# roslyn SyntaxFactory generate constructor with calling base class constructor," I wrote code which generates a new class in accordance with an initial state.Roslyn provides the class SyntaxFactory for it, but I don't understand how to generate a constructor by calling the base class, like this: https://github.com/ddydeveloper/Roslyn.ApiClient.CodegenAny idea? <code>  public TestClientApi(String entryPoint) : **base(entryPoint)**{ _entryPoint = entryPoint;}",SyntaxFactory generate constructor with calling base class constructor
Signing email in AS.NET MVC," Based on this question I decided to sign emails send from ASP.NET.MVC to decrease SPAM score of emails, but I have some bug somewhere.Code: I check the result on http://www.isnotspam.com, the output is following: My DNS record is: UPDATE:I fix some issues in DNS record and I have found better online checker at dkimcore.orgI still face validation issue of my public key. I generated 1024 RSA using puttyGen (ppk) and convert it to RSA format. The original file from PuttyGen is: So I just copy the content (except the commented lines) to DNS record and I got following output from checker: <code>  public void SendEmail(MailMessage mailMessage) { string domain = ""kup-nemovitost.cz""; var message = MimeMessage.CreateFromMailMessage(mailMessage); HeaderId[] headers = new HeaderId[] { HeaderId.From, HeaderId.Subject, HeaderId.Date }; DkimCanonicalizationAlgorithm headerAlgorithm = DkimCanonicalizationAlgorithm.Relaxed; DkimCanonicalizationAlgorithm bodyAlgorithm = DkimCanonicalizationAlgorithm.Relaxed; string dkimPath = Path.Combine(ConfigHelper.GetDataPath(), ""DKIM""); string privateKey = Path.Combine(dkimPath, ""kup-nemovitost.cz.private.rsa""); DkimSigner signer = new DkimSigner(privateKey, domain, ""mail"") { SignatureAlgorithm = DkimSignatureAlgorithm.RsaSha1, AgentOrUserIdentifier = ""@"" + domain, QueryMethod = ""dns/txt"", }; message.Prepare(EncodingConstraint.SevenBit); message.Sign(signer, headers, headerAlgorithm, bodyAlgorithm); using (var client = new MailKit.Net.Smtp.SmtpClient()) { client.Connect(""localhost"", 25, false); client.Send(message); client.Disconnect(true); } } DKIM check details:----------------------------------------------------------Result: invalidID(s) verified: header.From=no-reply@kup-nemovitost.czSelector=maildomain=kup-nemovitost.czDomainKeys DNS Record=mail._domainkey.kup-nemovitost.cz @ IN TXT ""v=dkim1; s=mail; p=migfma0gcsqgsib3dqebaquaa4gnadcbiqkbgqdnov2pxnjmghdpxw5wpypk1rf7 kxs+5ouvh6f0hraryncku6wbvq+xovbgxz1kuddcb/s9o8wquftxrlffniik3wbm qc+upm+ndloxcxwy0bb2iktbgnmndjiexm/z0npaviwzebr2k6vqdzbp+lmcuece bwasqgw2fki5ospb4qidaqab"" ---- BEGIN SSH2 PUBLIC KEY ----Comment: ""rsa-key-20170606""AAAAB3NzaC1yc2EAAAABJQAAAIEAiyEwx+Idlf/Qp2fTYrQMwV3MuF9W7yaKDMHkhzoH+MqWKtNDngQoJcmbyrkMeF0VLYo246ma3gPZh9cDL7i8ygOYKagbyUjgtZFzy+et0tY/+G/IZNaHiQp0QuG/J71uZrl4Jlgkq+0s5bZxpRR45aRpcG1HQMIm6Ku7lgmOt88=---- END SSH2 PUBLIC KEY ---- p= AAAAB3NzaC1yc2EAAAABJQAAAIEAiyEwx+Idlf/Qp2fTYrQMwV3MuF9W7yaKDMHkhzoH+MqWKtNDngQoJcmbyrkMeF0VLYo246ma3gPZh9cDL7i8ygOYKagbyUjgtZFzy+et0tY/+G/IZNaHiQp0QuG/J71uZrl4Jlgkq+0s5bZxpRR45aRpcG1HQMIm6Ku7lgmOt88=This doesn't seem to be a valid RSA public key: RSA.xs:178: OpenSSL error: wrong tag at blib/lib/Crypt/OpenSSL/RSA.pm (autosplit into blib/lib/auto/Crypt/OpenSSL/RSA/new_public_key.al) line 91.",Signing email in C#
Signing email in ASP.NET MVC," Based on this question I decided to sign emails send from ASP.NET.MVC to decrease SPAM score of emails, but I have some bug somewhere.Code: I check the result on http://www.isnotspam.com, the output is following: My DNS record is: UPDATE:I fix some issues in DNS record and I have found better online checker at dkimcore.orgI still face validation issue of my public key. I generated 1024 RSA using puttyGen (ppk) and convert it to RSA format. The original file from PuttyGen is: So I just copy the content (except the commented lines) to DNS record and I got following output from checker: <code>  public void SendEmail(MailMessage mailMessage) { string domain = ""kup-nemovitost.cz""; var message = MimeMessage.CreateFromMailMessage(mailMessage); HeaderId[] headers = new HeaderId[] { HeaderId.From, HeaderId.Subject, HeaderId.Date }; DkimCanonicalizationAlgorithm headerAlgorithm = DkimCanonicalizationAlgorithm.Relaxed; DkimCanonicalizationAlgorithm bodyAlgorithm = DkimCanonicalizationAlgorithm.Relaxed; string dkimPath = Path.Combine(ConfigHelper.GetDataPath(), ""DKIM""); string privateKey = Path.Combine(dkimPath, ""kup-nemovitost.cz.private.rsa""); DkimSigner signer = new DkimSigner(privateKey, domain, ""mail"") { SignatureAlgorithm = DkimSignatureAlgorithm.RsaSha1, AgentOrUserIdentifier = ""@"" + domain, QueryMethod = ""dns/txt"", }; message.Prepare(EncodingConstraint.SevenBit); message.Sign(signer, headers, headerAlgorithm, bodyAlgorithm); using (var client = new MailKit.Net.Smtp.SmtpClient()) { client.Connect(""localhost"", 25, false); client.Send(message); client.Disconnect(true); } } DKIM check details:----------------------------------------------------------Result: invalidID(s) verified: header.From=no-reply@kup-nemovitost.czSelector=maildomain=kup-nemovitost.czDomainKeys DNS Record=mail._domainkey.kup-nemovitost.cz @ IN TXT ""v=dkim1; s=mail; p=migfma0gcsqgsib3dqebaquaa4gnadcbiqkbgqdnov2pxnjmghdpxw5wpypk1rf7 kxs+5ouvh6f0hraryncku6wbvq+xovbgxz1kuddcb/s9o8wquftxrlffniik3wbm qc+upm+ndloxcxwy0bb2iktbgnmndjiexm/z0npaviwzebr2k6vqdzbp+lmcuece bwasqgw2fki5ospb4qidaqab"" ---- BEGIN SSH2 PUBLIC KEY ----Comment: ""rsa-key-20170606""AAAAB3NzaC1yc2EAAAABJQAAAIEAiyEwx+Idlf/Qp2fTYrQMwV3MuF9W7yaKDMHkhzoH+MqWKtNDngQoJcmbyrkMeF0VLYo246ma3gPZh9cDL7i8ygOYKagbyUjgtZFzy+et0tY/+G/IZNaHiQp0QuG/J71uZrl4Jlgkq+0s5bZxpRR45aRpcG1HQMIm6Ku7lgmOt88=---- END SSH2 PUBLIC KEY ---- p= AAAAB3NzaC1yc2EAAAABJQAAAIEAiyEwx+Idlf/Qp2fTYrQMwV3MuF9W7yaKDMHkhzoH+MqWKtNDngQoJcmbyrkMeF0VLYo246ma3gPZh9cDL7i8ygOYKagbyUjgtZFzy+et0tY/+G/IZNaHiQp0QuG/J71uZrl4Jlgkq+0s5bZxpRR45aRpcG1HQMIm6Ku7lgmOt88=This doesn't seem to be a valid RSA public key: RSA.xs:178: OpenSSL error: wrong tag at blib/lib/Crypt/OpenSSL/RSA.pm (autosplit into blib/lib/auto/Crypt/OpenSSL/RSA/new_public_key.al) line 91.",Signing email in C#
How do you change the icon of the `wwwroot` folder in a standard .NET Core project to be the same as an ASP.NET Core Web Application project?," In Visual Studio 2017, when I want to create an ASP.NET Core Web Application from scratch using either one of these standard .NET Core project templates:Console App (.NET Core)Class Library (.NET Core)These project templates; obviously would not include the wwwroot folder. So, when I add the folder to my project it will look like (and behave like) a standard folder:When you create it using the ASP.NET Core Web Application project template, the wwwroot folder looks like this:Question - Appearance (Icon) How do you change the icon of the wwwroot folder to look like the one found in the ASP.NET Core Web Application project template?Additional Question - Behavior (Copying Files to Output Directory)In the standard .NET Core project, I would have to add this to my .csproj file: so that it copies all my files from the wwwroot folder to the output directory similar to the ASP.NET Core Web Application project. I looked in the ASP.NET Core Web Application's .csproj file and didn't see anything like that.I'm assuming the answer to the main question will also provide the answer for this one, as the project templates are obviously different. I can't seem to find the resources online to help me manually edit this myself.Thanks in advance. <code>  <ItemGroup> <Content Include=""wwwroot\**"" CopyToOutputDirectory=""PreserveNewest"" /></ItemGroup>",How do you change the icon of the `wwwroot` folder in a .NET Core project?
c#7 How to create named reference-type tuples?," The following line creates a named ValueTuple: Value types can not be passed around efficiently. Does C#7 offer a way to create named tuples of the Tuple type?  <code>  var tuple = (a:1, b:2, c:3, d:4, e:5, f:6); ",How to create named reference-type tuples?
ASP NET Core modify/substitute a request body," I want to do a substitution on HttpContext.Request.Body.I've tried to do it inside a middleware: The first problem is that the body can be read only once, and secondly, the stream is read-only and can't be written to.How can I modify/substitute Request.Body? I need to change property value of request body. <code>  public async Task Invoke(HttpContext context){ if (context.Request.Path.Value.Contains(""DataSourceResult"")) { var originalBody = new StreamReader(context.Request.Body).ReadToEnd(); DataSourceRequest dataSource = null; try { dataSource = JsonConvert.DeserializeObject<DataSourceRequest>(originalBody); } catch { await _next.Invoke(context); } if (dataSource != null && dataSource.Take > 2000) { dataSource.Take = 2000; var bytesToWrite = dataSource.AsByteArray(); await context.Request.Body.WriteAsync(bytesToWrite, 0, bytesToWrite.Length); } else { var bytesToWrite = originalBody.AsByteArray(); await context.Request.Body.WriteAsync(bytesToWrite, 0, bytesToWrite.Length); } } await _next.Invoke(context);}",ASP.NET Core modify/substitute request body
Ftp Transfer error with a zip file," I am using .NET 4 C#. I am trying to upload and then download a ZIP file to (my) server.For uploading I have This seems to work, in that I get a file on the server of the right size.1) How do I stream it, rather than load it into memory first? I will be uploading very large files.And for downloading I have 2) Everything seems to work ... except when I try to unzip the downloaded ZIP file I get an invalid ZIP file. <code>  using (WebClient client = new WebClient()){ FtpWebRequest request = (FtpWebRequest)WebRequest.Create(MyUrl); request.Method = WebRequestMethods.Ftp.UploadFile; request.EnableSsl = false; request.Credentials = new NetworkCredential(MyLogin, MyPassword); byte[] fileContents = null; using (StreamReader sourceStream = new StreamReader(LocalFilePath)) { fileContents = Encoding.UTF8.GetBytes(sourceStream.ReadToEnd()); } request.ContentLength = fileContents.Length; using (Stream requestStream = request.GetRequestStream()) { requestStream.Write(fileContents, 0, fileContents.Length); } FtpWebResponse response = null; response = (FtpWebResponse)request.GetResponse(); response.Close();} using (WebClient client = new WebClient()){ string HtmlResult = String.Empty; FtpWebRequest request = (FtpWebRequest)WebRequest.Create(remoteFile); request.Method = WebRequestMethods.Ftp.DownloadFile; request.EnableSsl = false; request.Credentials = new NetworkCredential(MyLogin, MyPassword); using (FtpWebResponse response = (FtpWebResponse)request.GetResponse()) using (Stream responseStream = response.GetResponseStream()) using (StreamReader reader = new StreamReader(responseStream)) using (FileStream writer = new FileStream(localFilename, FileMode.Create)) { long length = response.ContentLength; int bufferSize = 2048; int readCount; byte[] buffer = new byte[2048]; readCount = responseStream.Read(buffer, 0, bufferSize); while (readCount > 0) { writer.Write(buffer, 0, readCount); readCount = responseStream.Read(buffer, 0, bufferSize); } }}",Upload and download a file to/from FTP server in C#/.NET
Upload and download a binary file to/from FTP server in C#/.NET," I am using .NET 4 C#. I am trying to upload and then download a ZIP file to (my) server.For uploading I have This seems to work, in that I get a file on the server of the right size.1) How do I stream it, rather than load it into memory first? I will be uploading very large files.And for downloading I have 2) Everything seems to work ... except when I try to unzip the downloaded ZIP file I get an invalid ZIP file. <code>  using (WebClient client = new WebClient()){ FtpWebRequest request = (FtpWebRequest)WebRequest.Create(MyUrl); request.Method = WebRequestMethods.Ftp.UploadFile; request.EnableSsl = false; request.Credentials = new NetworkCredential(MyLogin, MyPassword); byte[] fileContents = null; using (StreamReader sourceStream = new StreamReader(LocalFilePath)) { fileContents = Encoding.UTF8.GetBytes(sourceStream.ReadToEnd()); } request.ContentLength = fileContents.Length; using (Stream requestStream = request.GetRequestStream()) { requestStream.Write(fileContents, 0, fileContents.Length); } FtpWebResponse response = null; response = (FtpWebResponse)request.GetResponse(); response.Close();} using (WebClient client = new WebClient()){ string HtmlResult = String.Empty; FtpWebRequest request = (FtpWebRequest)WebRequest.Create(remoteFile); request.Method = WebRequestMethods.Ftp.DownloadFile; request.EnableSsl = false; request.Credentials = new NetworkCredential(MyLogin, MyPassword); using (FtpWebResponse response = (FtpWebResponse)request.GetResponse()) using (Stream responseStream = response.GetResponseStream()) using (StreamReader reader = new StreamReader(responseStream)) using (FileStream writer = new FileStream(localFilename, FileMode.Create)) { long length = response.ContentLength; int bufferSize = 2048; int readCount; byte[] buffer = new byte[2048]; readCount = responseStream.Read(buffer, 0, bufferSize); while (readCount > 0) { writer.Write(buffer, 0, readCount); readCount = responseStream.Read(buffer, 0, bufferSize); } }}",Upload and download a file to/from FTP server in C#/.NET
DDD validation without exceptions," I am attempting my first foray into DDD, and I asked a question about bulk imports here, but I am going in circles trying to apply the validation for my domain model. Essentially I want to run through all the validation without throwing exceptions so that I can reject the command with all the validation errors via a list of CommandResult objects inside the Command object. Whilst some are just mandatory field checks which are configurable and so will be handled outside the aggregate, there are also business rules, so I don't want to duplicate the validation logic and don't want to fall into an anaemic model by moving everything outside the aggregate to maintain the always-valid mantra of entities.I am at a bit of a loss, so thought it be best I ask the experts if this I am going about things correctly before I start muddying the waters further! To try and demonstrate:Take the below, we have fairly simple UserProfile aggregate, the constructor takes the minimum information required for a profile to exist. I then have a method which accepts a command object, which will construct a UserProfile and save to the database, but I want to validate before saving Now, I could handle exceptions and add them to the command result, but that seems expensive and surely violates the rule of allowing exceptions to control flow? but on the other hand I want to keep entities and value object valid, so I find myself in a bit of a rut!Also, in the example above, the profile could be imported or done manually from a creation screen, but the user should get all error messages rather than each one in the order they occur. In the application I am working on, the rules applied are a bit more complex, but the idea is the same. I am aware that I shouldn't let a UI concern impact the domain as such, but I don't want to have to duplicate all validation twice more so that I can make sure the command won't fail as that will cause maintainability issues further down the line (the situation I find myself in and trying to resolve!) <code>  public class UserProfile : AggregateRoot { public Guid Id {get; private set; } public Name Name {get private set;} public CardDetail PaymentInformation {get; private set;} public UserProfile(Guid id, Name name, CardDetail paymentInformation) { Name = name; PaymentInformation = paymentInformation; } }public class CardDetail : ValueObject{ public string Number {get; private set;} public string CVC {get; private set; } public DateTime? IssueDate {get; private set;} public DateTime ExpiryDate {get;private set;} public CardDetail(string number, string cvc, DateTime? issueDate, DateTime expiryDate) { if(!IsValidCardNumber(number)) { /*Do something to say details invalid, but not throw exception, possibly?*/ } Number = number; CVC = cvc; IssueDate = issueDate ExpiryDate = expiryDate; } private bool IsValidCardNumber(string number) { return Regex.IsMatch(/*regex for card number*/); }} public void CreateProfile(CreateProfileCommand command){ var paymentInformation = new CardDetail(command.CardNumber, command.CardCVC, command.CardIssueDate, command.CardExpiryDate) var errors = /* list of errors added to from card detail validation, possibly? */ var profile = new UserProfile(/* pass args, add to errors? */ if(errors.Any()) { command.Results.Add(errors.Select(x => new CommandResult { Severity = Severity.Error, Message = x.Message }); return; } /* no errors, so continue to save */}",DDD validation without throwing exceptions
How do I apply Json.NET CamelCasePropertyNamesContractResolver on a class level," I want my class to be serialized and deserialized using camel case naming convention. I know I can use the JsonConvert.SerializeObject(object, settings) overload as stated here: Is there any way to apply the same configuration on a class level (via attributes) so that I do not need to override the serialization settings? I could write a custom converter but that looks like an overkill for such a simple thing. <code>  var serializerSettings = new JsonSerializerSettings();serializerSettings.ContractResolver = new CamelCasePropertyNamesContractResolver();var json = JsonConvert.SerializeObject(product, serializerSettings);",Configure Json.NET serialization settings on a class level
Alternative way to check if CTRL+ALT+DELETE screen is visible," Currently I'm using the below code to test if the CTRL+ALT+DEL screen is visible and it is working as expected. The problem is that polling this info consumes CPU and I'm looking for an event based option. Does anyone know another way to detect if this screen is visible?I only need to know when this screen is closed. I don't really care when it opens. Just that it had been open and is now closed.To be honest, I found this code and I'm not exactly sure how it is specific, if at all, to the screen I'm referring to. It appears to look for any process creation and deletion events. What this means is that this screen must be opening a new process. Knowing that process name would be helpful too. What is the name of this screen? And how do I detect this type of window? It seems like the same type as the login window. <code>  var interval = new TimeSpan(0, 0, 3);const string isWin32Process = ""TargetInstance isa \""Win32_Process\"""";// Listen for started processes.WqlEventQuery startQuery = new WqlEventQuery(""__InstanceCreationEvent"", interval, isWin32Process);var _startWatcher = new ManagementEventWatcher(startQuery);_startWatcher.Start();_startWatcher.EventArrived += OnStartEventArrived;// Listen for closed processes.WqlEventQuery stopQuery = new WqlEventQuery(""__InstanceDeletionEvent"", interval, isWin32Process);var _stopWatcher = new ManagementEventWatcher(stopQuery);_stopWatcher.Start();_stopWatcher.EventArrived += OnStopEventArrived;",Alternative way to check if CTRL+ALT+DEL screen is visible
Guid.NewGuId(); behind the scenes in .NET Core," Researching the subject yesterday, I found several interesting questions (such as this one) on how GUIDs are ultimately generated. In brief; it seems that Guid.NewGuid(); calls CoCreateGuid in the COM, which in turn calls UuidCreate in the Windows RPC (docs here and here).I found myself wondering; How does this work when the OS is not Windows, such as might be the case with .NET Core, and does this affect the 'version' algorithm used to generate the GUID (which I understand is Version 4 on Windows)? <code> ",Guid.NewGuid(); behind the scenes in .NET Core
Cannot instantiate implementation type for service type with generics," In an ASP.NET Core 1.1.2 web project, which depends on Microsoft.Extensions.DependencyInjection 1.1.1, I'm trying to register a generic FluentValidation validator both with its implementation and with its interface. At runtime, during host building, I got following exception: This is the (generic, non-abstract) validator class: (not sure is important to show WithUser<T> class, it just holds a Guid UserId and a T Content).Registration happens like so: and at runtime those variables hold: which seems correct.I've looked around for similar problems and questions on SO as well, but they're not really related, as they were about generic implementation, while this is a concrete one.I've stepped through DependencyInjection module code, and exception is thrown here. For some reason, serviceTypeInfo.IsGenericTypeDefinition returns false (shouldn't that be true, as the interface type is generic?) and so the else-branch is taken. There, instead, the implementation type return true to implementationTypeInfo.IsGenericTypeDefinition, so there you have the exception.Runtime values are: While fiddling, I tried registering only the implementation, without also registering interface+implementation, and that exception goes away. But I'd like to inject the interface, if possible, not the implementation.What am I doing wrong? TA <code>  An unhandled exception of type 'System.ArgumentException' occurred in Microsoft.Extensions.DependencyInjection.dllCannot instantiate implementation type 'MyProj.Shared.Api.WithUserCommandValidator`1[T]' for service type 'FluentValidation.IValidator`1[MyProj.Shared.Model.WithUser`1[T]]'. at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceTable..ctor(IEnumerable`1 descriptors) at Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(IEnumerable`1 serviceDescriptors, Boolean validateScopes) at Microsoft.Extensions.DependencyInjection.ServiceCollectionContainerBuilderExtensions.BuildServiceProvider(IServiceCollection services) at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication() at Microsoft.AspNetCore.Hosting.WebHostBuilder.Build() at MyProj.Program.Main(String[] args) in X:\MySolution\src\MyProj\Program.cs:line 31 public class WithUserCommandValidator<TCommand> : AbstractValidator<WithUser<TCommand>> where TCommand : ICommand{ public WithUserCommandValidator(IValidator<TCommand> commandValidator) { RuleFor(cmd => cmd).NotNull(); RuleFor(cmd => cmd.UserId).NotEqual(Guid.Empty); RuleFor(cmd => cmd.Content).NotNull() .SetValidator(commandValidator); }} someInterface = typeof(FluentValidation.IValidator<WithUser<>>);someImplementation = typeof(Shared.Api.WithUserCommandValidator<>);// this is for top-level command validators, injected by interfaceservices.AddScoped(someInterface, someImplementation);// this is for nested validators, injected by implementationservices.AddScoped(someImplementation); + someInterface {FluentValidation.IValidator`1[MyProj.Shared.Model.WithUser`1[TCommand]]} System.Type {System.RuntimeType}+ someImplementation {MyProj.Shared.Api.WithUserCommandValidator`1[TCommand]} System.Type {System.RuntimeType} + serviceTypeInfo {FluentValidation.IValidator`1[MyProj.Shared.Model.WithUser`1[TCommand]]} System.Reflection.TypeInfo {System.RuntimeType}+ implementationTypeInfo {MyProj.Shared.Api.WithUserCommandValidator`1[TCommand]} System.Reflection.TypeInfo {System.RuntimeType}",Registering partially-closed generic type with ASP.NET Core Microsoft.Extensions.DependencyInjection
How can i change the color of a Xamarin.Forms label in C#," I have this XAML code: In my C# code I am familar with setting the Text property of the label by simply specifying like this: But this situation is different. Can someone tell me how I can change the color of a label from C# when the label is clicked on. <code>  <StackLayout Grid.Row=""0"" Grid.Column=""0"" Padding=""15,10,20,10"" HorizontalOptions=""StartAndExpand"" VerticalOptions=""CenterAndExpand""> <StackLayout.GestureRecognizers> <TapGestureRecognizer Tapped=""tapFavorites"" NumberOfTapsRequired=""1"" /> </StackLayout.GestureRecognizers> <Label x:Name=""faveLabel"" FontFamily=""FontAwesome"" XAlign=""Center"" FontSize=""23""> <Label.Triggers> <DataTrigger TargetType=""Label"" Binding=""{Binding Favorite}"" Value=""true""> <Setter Property=""TextColor"" Value=""Red"" /> </DataTrigger> <DataTrigger TargetType=""Label"" Binding=""{Binding Favorite}"" Value=""false""> <Setter Property=""TextColor"" Value=""Gray"" /> </DataTrigger> </Label.Triggers> </Label></StackLayout> sampleLabel.Text = ""ABC""","Change Color of Xamarin Forms Label in C# only, no XAML"
Change the Color of a Label in C#," I have this XAML code: In my C# code I am familar with setting the Text property of the label by simply specifying like this: But this situation is different. Can someone tell me how I can change the color of a label from C# when the label is clicked on. <code>  <StackLayout Grid.Row=""0"" Grid.Column=""0"" Padding=""15,10,20,10"" HorizontalOptions=""StartAndExpand"" VerticalOptions=""CenterAndExpand""> <StackLayout.GestureRecognizers> <TapGestureRecognizer Tapped=""tapFavorites"" NumberOfTapsRequired=""1"" /> </StackLayout.GestureRecognizers> <Label x:Name=""faveLabel"" FontFamily=""FontAwesome"" XAlign=""Center"" FontSize=""23""> <Label.Triggers> <DataTrigger TargetType=""Label"" Binding=""{Binding Favorite}"" Value=""true""> <Setter Property=""TextColor"" Value=""Red"" /> </DataTrigger> <DataTrigger TargetType=""Label"" Binding=""{Binding Favorite}"" Value=""false""> <Setter Property=""TextColor"" Value=""Gray"" /> </DataTrigger> </Label.Triggers> </Label></StackLayout> sampleLabel.Text = ""ABC""","Change Color of Xamarin Forms Label in C# only, no XAML"
"Change the Color of a Xamarin Forms Label in C# only, no XAML"," I have this XAML code: In my C# code I am familar with setting the Text property of the label by simply specifying like this: But this situation is different. Can someone tell me how I can change the color of a label from C# when the label is clicked on. <code>  <StackLayout Grid.Row=""0"" Grid.Column=""0"" Padding=""15,10,20,10"" HorizontalOptions=""StartAndExpand"" VerticalOptions=""CenterAndExpand""> <StackLayout.GestureRecognizers> <TapGestureRecognizer Tapped=""tapFavorites"" NumberOfTapsRequired=""1"" /> </StackLayout.GestureRecognizers> <Label x:Name=""faveLabel"" FontFamily=""FontAwesome"" XAlign=""Center"" FontSize=""23""> <Label.Triggers> <DataTrigger TargetType=""Label"" Binding=""{Binding Favorite}"" Value=""true""> <Setter Property=""TextColor"" Value=""Red"" /> </DataTrigger> <DataTrigger TargetType=""Label"" Binding=""{Binding Favorite}"" Value=""false""> <Setter Property=""TextColor"" Value=""Gray"" /> </DataTrigger> </Label.Triggers> </Label></StackLayout> sampleLabel.Text = ""ABC""","Change Color of Xamarin Forms Label in C# only, no XAML"
Multiple Database Entity Framework migrations," I am quite confused with a situation here. I need to connect to two separate databases, one is a SQL Server database and the other is a MySQL database.I have the connection strings in the web.config file. I am able to connect to the servers and access data.But, I need to run entity migration on both the servers simultaneously. Or one by one, which I don't think is possible.Here is my database context: Initially I had only one database and I used to run add-migration MigrationName in the package manager console and it would create a migration with the changes in the database. But now, when I have two separate databases, the migrations does not contain any changes in the second database or the one I added later.Please help. Any help is greatly appreciated.Thank you <code>  // Database 1public class DatabaseContext : DbContext{ public DatabaseContext() : base(""name=OldDBContext""){ } protected override void OnModelCreating(DbModelBuilder modelBuilder) { } public static DatabaseContext Create() { return new DatabaseContext(); } public DbSet<User> UserModel { get; set; }}// Database 2public class NewDatabaseContext : DbContext{ public NewDatabaseContext() : base(""name=NewDBContext"") { } protected override void OnModelCreating(DbModelBuilder modelBuilder) { } public static NewDatabaseContext Create() { return new NewDatabaseContext(); } public DbSet<UserData> UserDataModel { get; set; }}",Entity Framework code first migrations for two different databases
XmlNode is not creating an end element," I have the following code: This results in my XML file containing <Users FileDirectory=""C:\data"" />instead of <Users FileDirectory=""C:\data"" ></Users> as I want.How do I create the end element? I've given it a Google and I can't find much. Any help is appreciated, thanks. <code>  string PathName = ""C:\\Users\\TestUser\\Documents\\Project"";string FileName = ""settings.xml"";XmlDocument Settings = new XmlDocument(); Settings.Load(Path.Combine(PathName, FileName));XmlNode KnowledgeNode = Settings.SelectSingleNode(""/Config/Map/Knowledge"");XmlNode UsersNode = Settings.CreateNode(XmlNodeType.Element, ""Users"", null);XmlAttribute FileDirectory = Settings.CreateAttribute(""FileDirectory"");FileDirectory.Value = UserSelectedFileDirectory;UsersNode.Attributes.Append(FileDirectory);KnowledgeNode.AppendChild(UsersNode);Settings.Save(Path.Combine(PathName, FileName));",Force XmlDocument to save empty elements with an explicit closing tag
How to generate Options(CORS) witch Swagger," For a project we are working on we are generating an Swagger File automatically. However at this moment we are struggling with the CORS part. We are using the Amazon API gateway import api functionality. To use this in combination with Swagger and CORS, we have to create an additional action (operation) in our source code which allows CORS(options) for each api method (operation)! eg: As you can see this makes the code a lot dirtier. this is a temporary fix, but we can not find another way. Is there any way to generate this in the swagger definition file automatically? Or how can we do this, Amazon API gateway required this (documentation: http://docs.aws.amazon.com/apigateway/latest/developerguide/how-to-cors.html)  <code>  [HttpOptions] [Route(""{id}"")] [ProducesResponseType((int)HttpStatusCode.OK)] public IActionResult UserOptions() { return new OkResult(); }",How to generate Options(CORS) with Swagger
How to add header in IHttpActionResult in web api2?," Hi i am developing API's using Web API 2. I know how to add header when using HttpResponseMessage. Now I am using IHttpActionResult.Below is my sample current code. How can I add a header when I am returning content? Whenever I use HttpResponseMessage I will be having request object and I can add header.Below code I tried in HttpResponseMessage. In this case where can I add header values? <code>  return Content(HttpStatusCode.OK, LoginResponse); response.Content.Headers.ContentType = new MediaTypeHeaderValue(""application/json"");response.Headers.AddCookies(new[] { cookie });return response;",How to add header in IHttpActionResult in Web API 2?
C# Xml Serializer serializes list to count of 0 instead of null," I am confused on how XmlSerializer works behind the scenes. I have a class that deserializes XML into an object. What I am seeing is for the following two elements that are NOT part of the Xml being deserialized. Let's take the following XML as an example: You notice that Tests and Comments are NOT part of the XML.When this XML gets deserialized Comments is null(which is expected) and Tests is an empty list with a count of 0. If someone could explain this to me it would be much appreciated. What I would prefer is that if <Tests> is missing from the XML then the list should remain null, but if a (possibly empty) node <Tests /> is present then the list should get allocated. <code>  [XmlRootAttribute(""MyClass"", Namespace = """", IsNullable = false)]public class MyClass{ private string comments; public string Comments { set { comments = value; } get { return comments; } } private System.Collections.Generic.List<string> tests = null; public System.Collections.Generic.List<string> Tests { get { return tests; } set { tests = value; } }} <MyClass> <SomeNode>value</SomeNode></MyClass>",C# Xml Serializer deserializes list to count of 0 instead of null
"In Visual Studio 2017, How can I use the C# interactive windows to query a source in my data connections"," I'm connected to an external SQL server in my ""Data Connections"" (in the ""Server Explorer"" view). I can right click my SQL source and click ""New Query"" to quickly look up data with SQL statements.I would like to use LINQ instead and I think the ""C# Interactive"" window would be a good and quick way to do this. My problem is that I don't know how to access my 'open' data connection. The name of the database or tables are not recognized. <code> ","How can I use, in Visual Studio 2017, the ""C# Interactive"" window to query a source in my ""Data Connections"""
"ASP.Net Core: How can I validate Request.Headers[""Authorization""] for all controller at a single place?"," How can I validate Request.Headers[""Authorization""] for all controller at a single place? <code>  [HttpGet]public IActionResult Get(){ string token = Request.Headers[""Authorization""]; // Validate token.}[HttpPost]public IActionResult Post(int id){ string token = Request.Headers[""Authorization""]; // Validate token.}","How can I validate Request.Headers[""Authorization""] for all controller at a single place?"
"Visual studios 2017, cannot debug or run the application"," After I turned on my computer today, I haven't been able to debug or run the application at all. If I publish the project, it works fine. But if I run it from Visual Studio, it's just stuck loading and Visual Studio stops responding.Here are the errors I get when I force quit the application: Exception thrown: 'System.UnauthorizedAccessException' in mscorlib.dll Exception thrown: 'System.Globalization.CultureNotFoundException' in mscorlib.dll Exception thrown: 'System.Security.SecurityException' in mscorlib.dll The program '[6276] chrome.exe: WebKit' has exited with code -1 (0xffffffff). The program '[8852] iisexpress.exe' has exited with code -1 (0xffffffff).Have you ever experinced anything similar? I've been trying to look up answers but haven't been able to locate any. Also I tried on a diffrent machine, and cannot debug the application there either.Have tried updating and reinstalling all packages using Nuget.Best Regards Solan. <code> ","Visual Studio 2017, cannot debug or run the application"
How to add CommandLine in .NET-Core 2.0?," I use below code to add CommandLine in my .Net-Core 1.2 environment, I can use the command line like dotnet run --urls ""http://a.cn.com:5000"" --environment ""Production"". And After migrate to .net core 2.0 it becomes like that I use the same command line ,it fails.How to add the Command in .net core 2.0 ?Supply: 2017.08.17launchsetting.json below : What I expect the listening isNow listening on http://a.cn.com:5000What I get is that:And we should not add any other code in Program.cs file, cause CreateDefaultBuilder is contain addCommandLine. for more detail, you can see WebHost.cs#L177Supply 2017 0817 17:44 UTC+8[::] is the IPv6 equivalent of IPv4 0.0.0.0. <code>  public static void Main(string[] args){ var config = new ConfigurationBuilder() .AddJsonFile(""hosting.json"", optional: true) .AddCommandLine(args) .Build(); var host = new WebHostBuilder() .UseKestrel() .UseContentRoot(Directory.GetCurrentDirectory()) .UseIISIntegration() .UseStartup<Startup>() .UseConfiguration(config) .Build(); host.Run();} public static void Main(string[] args){ BuildWebHost(args).Run();}public static IWebHost BuildWebHost(string[] args){ return WebHost.CreateDefaultBuilder(args) .ConfigureLogging((context, logging) => { logging.AddSerilog(); }) .UseStartup<Startup>() .Build(); } { ""iisSettings"": { ""windowsAuthentication"": false, ""anonymousAuthentication"": true, ""iisExpress"": { ""applicationUrl"": ""http://localhost:5005/"", ""sslPort"": 0 } }, ""profiles"": { ""IIS Express"": { ""commandName"": ""IISExpress"", ""launchBrowser"": true, ""environmentVariables"": { ""ASPNETCORE_ENVIRONMENT"": ""Development"" } }, ""Robert.Project.Web"": { ""commandName"": ""Project"", ""environmentVariables"": { ""ASPNETCORE_ENVIRONMENT"": ""Development"" }, ""applicationUrl"": ""http://localhost:5006"" } }}",WebHostBuilder. How to set url address using CommandLine in .NET-Core 2.0?
Load all scenes in splash screen in Unity," I have a multiple scenes in my mobile 2D unity game, I want to load all my scenes in splash screen, so that the scene passing would be smooth. How can I do this ? If I do this, do I need to change ""Application.LoadScene()"" method, and what method can I use ? <code> ",Load all scenes during splash screen
ASP.NET Core 2: Cannot consume scoped service IMongoDbContext from singleton IActiveUsersService," I updated a project to ASP.NET Core 2 today and I get the following error: Cannot consume scoped service IMongoDbContext from singleton IActiveUsersServiceI have the following registration: Why DI can't consume the service? All works fine for ASP.NET Core 1.1. <code>  services.AddSingleton<IActiveUsersService, ActiveUsersService>();services.AddScoped<IMongoDbContext, MongoDbContext>();services.AddSingleton(option =>{ var client = new MongoClient(MongoConnectionString.Settings); return client.GetDatabase(MongoConnectionString.Database);})public class MongoDbContext : IMongoDbContext{ private readonly IMongoDatabase _database; public MongoDbContext(IMongoDatabase database) { _database = database; } public IMongoCollection<T> GetCollection<T>() where T : Entity, new() { return _database.GetCollection<T>(new T().CollectionName); }}public class IActiveUsersService: ActiveUsersService{ public IActiveUsersService(IMongoDbContext mongoDbContext) { ... }}",Cannot consume scoped service IMongoDbContext from singleton IActiveUsersService after upgrade to ASP.NET Core 2.0
exclude certain column from entity framework select statment," I have an image column in the product table in a SQL Server database. The image column is used to save the images as bytes.I know it is better to make a separate table for images, but I did not do that,so is there any way to exclude the image column when I am trying to list the products only without the images? <code> ",Exclude certain column from Entity Framework select statment
ef core dont use ASPNETCORE_ENVIRONMENT during update-database," I use visual studio to update all my environments with a certain migration. It had worked fine using the command below. In ef core 2.0 this command has been changed and parameter -Environment has been removed. In the docs it said.""With 2.0, you can use the ASPNETCORE_ENVIRONMENT environment variableinstead.""https://docs.microsoft.com/en-us/ef/core/miscellaneous/cli/dotnetI have now tried all kinds of ways but when I run the update-database with ef core 2.0 it doesn't use the ASPNETCORE_ENVIRONMENT variable. I tried to set in registry, application properties.Please let me know what I need to do to get this working to update different environments?If I start the application with different launchsettings it works but not using the package manager console. <code>  update-database -Migration initMigrationProduct -c ProductContext -Environment Production",ef core doesn't use ASPNETCORE_ENVIRONMENT during update-database
Can we Unzip file in ftp server using C#, Can I extract the ZIP file in FTP and place this extracted file on the same location using C#? <code> ,Can we unzip file in FTP server using C#
"How to Handle notificationOpened in AppDelegate? (Xamarin.forms, Visual studio)"," I am working on implementing OneSignal push-notification in Xamarin.Forms.I need to pass the string returned by OneSignal AdditionalData into the constructor of App().So I used HandleNotificationOpened(OSNotificationOpenedResult result) for handling the notification tap and fetching the string and then pass it to LoadApplication(new App(myData)).So for this, I have written the code in MainActivity for Android and in AppDelegate for iOS.Everything is working fine for Android; i.e. the HandleNotificationOpened() fetched the additionalData and passes it toLoadApplication(new App(myData)).But in iOS, when I opened the notification, the HandleNotificationOpened() code is not called.AppDelegate.cs <code>  static string s = null;public override bool FinishedLaunching(UIApplication app, NSDictionary options){ OneSignal.Current.StartInit(""MyKey"").HandleNotificationOpened(HandleNotificationOpened).EndInit(); if(s!=null) { LoadApplication(new App(s)); } else { LoadApplication(new App(""myUrl.lasso"")); } return base.FinishedLaunching(app, options);}private static void HandleNotificationOpened(OSNotificationOpenedResult result){ OSNotificationPayload payload = result.notification.payload; Dictionary<string, object> additionalData = payload.additionalData; if (additionalData != null) { if (additionalData.ContainsKey(""url_direct"")) { s = additionalData[""url_direct""].ToString(); System.Diagnostics.Debug.WriteLine(""We need to redirect it to: "" + s); } }}",OneSignal: How to Handle notificationOpened in AppDelegate of a Xamarin.Forms app?
Performance issue using in memory database with Typscript/javascript," I have a server side developed in c# with entity framework as a provider for SQL server. My server is managing a many to many relation between students and classes. My client side is developed in angular js with Typscript.To be synchronized with the server, each change in server is pushed to the clients with push notifications (signalr).For faster response time, my client keeps a sort of database in memory (since the amount of data is not that big, less than 500 records). I keep an array of students and for each one of them also keep array of courses: And in that object I keep track of all the students and their courses in the client side.In my application I have the option to remove multiple courses from the entire system. However when doing such thing, when the action is successfully finished on server-side, the processing in the client side becomes heavy when there are many students. That is because I need to iterate through all the removed courses and for each one of them iterate through the entire students array to locate and remove those courses from the students array. (Or iterate the removed courses first and within iterate through the students) - both are heavy and take a while.Is there a different better design for this? Should I approach this in a different way maybe?  <code>  public class Student { public List<Course> Courses . . } public class Course { public List<Student> Students . . } Students: { [studentId: number] : Courses } ={}",Performance issue using in memory database with Typescript/javascript
Is it possible to reassign a ref local in C#?," C#'s ref locals are implemented using a CLR feature called managed pointers, that come with their own set of restrictions, but luckily being immutable is not one of them. I.e. in ILAsm if you have a local variable of managed pointer type, it's entirely possible to change this pointer, making it ""reference"" another location. (C++/CLI also exposes this feature as interior pointers.)Reading the C# documentation on ref locals it appears to me that C#'s ref locals are, even though based on the managed pointers of CLR, not relocatable; if they are initialized to point to some variable, they cannot be made to point to something else. I've tried using and similar constructs, to no avail.I've even tried to write a small struct wrapping a managed pointer in IL, it works as far as C# is concerned, but the CLR doesn't seem to like having a managed pointer in a struct, even if in my usage it doesn't ever go to the heap.Does one really have to resort to using IL or tricks with recursion to overcome this? (I'm implementing a data structure that needs to keep track of which of its pointers were followed, a perfect use of managed pointers.) <code>  ref object reference = ref some_var;ref reference = ref other_var;",Is it possible to reassign a ref local?
Ldap referal error," I am using active directory and want a list of all users, basically in dotnet core. But I am receiving an exception: Search result reference received, and referral following is offBelow is my code. <code>  LdapSearchResults lsc = lc.Search(""DC = xyz, DC = local"", LdapConnection.SCOPE_ONE , ""(|(objectClass = person)(objectClass = user))"", null, false);",a list of all users: Ldap referral error (LDAPReferralException)
Is it possible to compile a single file with .net core?," In old .NET we used to be able to run the csc compiler to compile a single .cs file or several files.With .NET Core we have dotnet build that insists on having a proper project file. Is there a stand-alone command line compiler that would allow to compile source code files without having a project (and listing referenced dependencies on the same command line)?On Linux, when I have the old csc and the new .NET Core installed, I get these timings: Note 7 seconds with .NET Core versus several hundred milliseconds with the old csc for the same file, Program.cs.I'd like to be able to compile as fast with .NET Core as I used to be able with csc. <code>  [root@li1742-80 test]# time dotnet buildMicrosoft (R) Build Engine version 15.3.409.57025 for .NET CoreCopyright (C) Microsoft Corporation. All rights reserved. test -> /root/test/bin/Debug/netcoreapp2.0/test.dllBuild succeeded. 0 Warning(s) 0 Error(s)Time Elapsed 00:00:03.94real 0m7.027suser 0m5.714ssys 0m0.838s[root@li1742-80 test]# time csc Program.csMicrosoft (R) Visual C# Compiler version 2.3.0.61801 (3722bb71)Copyright (C) Microsoft Corporation. All rights reserved.real 0m0.613suser 0m0.522ssys 0m0.071s[root@li1742-80 test]#",Is it possible to compile a single C# code file with the .NET Core Roslyn compiler?
Is it possible to compile a single C# code file with .net core Roslyn compiler?," In old .NET we used to be able to run the csc compiler to compile a single .cs file or several files.With .NET Core we have dotnet build that insists on having a proper project file. Is there a stand-alone command line compiler that would allow to compile source code files without having a project (and listing referenced dependencies on the same command line)?On Linux, when I have the old csc and the new .NET Core installed, I get these timings: Note 7 seconds with .NET Core versus several hundred milliseconds with the old csc for the same file, Program.cs.I'd like to be able to compile as fast with .NET Core as I used to be able with csc. <code>  [root@li1742-80 test]# time dotnet buildMicrosoft (R) Build Engine version 15.3.409.57025 for .NET CoreCopyright (C) Microsoft Corporation. All rights reserved. test -> /root/test/bin/Debug/netcoreapp2.0/test.dllBuild succeeded. 0 Warning(s) 0 Error(s)Time Elapsed 00:00:03.94real 0m7.027suser 0m5.714ssys 0m0.838s[root@li1742-80 test]# time csc Program.csMicrosoft (R) Visual C# Compiler version 2.3.0.61801 (3722bb71)Copyright (C) Microsoft Corporation. All rights reserved.real 0m0.613suser 0m0.522ssys 0m0.071s[root@li1742-80 test]#",Is it possible to compile a single C# code file with the .NET Core Roslyn compiler?
AutoMapper - skip mapping null properties," I'm using AutoMapper to map a ViewModel to a Model. However, I want properties to not be mapped if the corresponding source property is null. My source class is as follows: And the destination class is: And here is how I configured the mapper: I thought that mapping would mean that properties don't get overwritten in the destination if the source one is null. But apparently I'm wrong: even when Source.Id is null, it still gets mapped, AutoMapper assigns it an empty Guid (00000000-0000-0000-0000-000000000000), overwriting the existing one. How do I properly tell AutoMapper to skip mapping of a property if the source is null? NOTE: I don't think this is a problem with the Guid<->String conversion, such conversion works in automapper, I've used it in the pass. The problem is that it's not skipping the Id property when it is null. <code>  public class Source{ //Other fields... public string Id { get; set; } //This should not be mapped if null} public class Destination{ //Other fields... public Guid Id { get; set; }} Mapper.Initialize(cfg =>{ //Other mappings... cfg.CreateMap<Source, Destination>() .ForAllMembers(opts => opts.Condition((src, dest, srcMember) => srcMember != null));});",Skip mapping null properties
Asp.net core 2.0 log4net," I configure log4net in my asp.net core 2.0 application as mentioned in this article LINK program.cs HomeController log4net.config Unlucky!, I didn't see any file generated in C:\Temp\app.log directory. What would be the mistake? how to configure log4net for asp.net core 2.0?  <code>  public static void Main(string[] args){ var logRepository = LogManager.GetRepository(Assembly.GetEntryAssembly()); XmlConfigurator.Configure(logRepository, new FileInfo(""log4net.config"")); BuildWebHost(args).Run();} public class HomeController : Controller{ private static readonly log4net.ILog log = log4net.LogManager.GetLogger(typeof(HomeController)); public IActionResult Error() { log.Info(""Hello logging world!""); return View(new ErrorViewModel { RequestId = Activity.Current?.Id ?? HttpContext.TraceIdentifier }); }} <?xml version=""1.0"" encoding=""utf-8""?><configuration> <log4net> <root> <level value=""ALL"" /> <appender-ref ref=""RollingFile"" /> </root> <appender name=""RollingFile"" type=""log4net.Appender.FileAppender""> <file value=""C:\Temp\app.log"" /> <layout type=""log4net.Layout.PatternLayout""> <conversionPattern value=""%-5p %d{hh:mm:ss} %message%newline"" /> </layout> </appender> </log4net></configuration>",How to use log4net in Asp.net core 2.0
Generate web page from Database in Asp.Net Core 2.0," I have an application use Asp.Net 4.61 in which I read html from a database field Description and use it to populate my a page in my application. I do this by marking the property Description with [AllowHtml]. In my Asp.Net Core 2.0 app, I get an error that the assembly reference or directive is not found. I have 2 questions - that will hopefully enable me to better answer questions such as this in the future:Is there a document/site that I could search to see if AllowHtml isin Core 2.0Is there a better/more secure way that I should use if I want topopulate web pages by reading from my database than decorating the field/property with [AllowHtml]? <code> ",Generate web page from Database using AllowHtml in Asp.Net Core 2.0
VB.NET Chr(34) equvalent in C#," I am converting VB.NET code to c# and I am stopped when I reached the following code snippet. I need someone's help to convert Chr(34). Please help me to convert it to c#. VB.NET Code My c# conversion is  <code>  Dim inputString As StringinputString = ""Some text ...""inputString = Replace(inputString, Chr(34), """")** string inputString = ""Some text ..."";inputString = inputString.Replace(NEED HELP HERE, """");**",Chr(34) equivalent
Including a file when I publish my azure function in Visual Studio," I know this seems like a simple thing but I can't find any help online.I want to include a file (.html) along with my Azure function when I publish it using Visual Studio. Then I want to be able to access this file in my Azure function.Why? It seems like only the .dll gets sent to the server when I publish.This file will be an .html file that will be an email template. I want to read it in my function and then send emails out.Any help is much appreciated.I see I can use [send grid in Azure functions][1], but it looks like I can only send out one email and not multiple emails, which is what I want. <code> ",Including a file when I publish my Azure function in Visual Studio
Explicitly marking derived class as implementing interfacef," In this case output will be ""Base"".If I explicitly state that Derived implements IBase (which is in fact already implemented by base class Base and such annotation seem to be useless) the output will be ""Derived"" What's the reason for such behavior?VS 15.3.5, C# 7 <code>  interface IBase{ string Name { get; }}class Base : IBase{ public Base() => this.Name = ""Base""; public string Name { get; }}class Derived : Base//, IBase{ public Derived() => this.Name = ""Derived""; public new string Name { get; }}class Program{ static void Main(string[] args) { IBase o = new Derived(); Console.WriteLine(o.Name); }} class Derived : Base, IBase{ public Derived() => this.Name = ""Derived""; public new string Name { get; }}",Explicitly marking derived class as implementing interface of base class
Ajax.BeginForm with 4 arguements not finding the action method," I have a weird case and I wanted your enlightenment.I have two controllers. One Person Controller for general Person use action methods and one Candidate Controller for more specific action methods related to Candidate. I use one partial view that is located under the Person folder in order to be used as generic in case I want to use it in the future for other types of Person.For the time being this partial view uses an Ajax.BeginForm targeting the Candidate Controller. The syntax I am using is This type of Ajax.BeginForm works correctly despite of the fact that it targets an action in a different controller.Now for my form validation I had to put some more arguments to my Ajax.BeginForm. My new syntax is like that: For some reason this way can't find the Action method. If I put my action inside the Person Controller it works correctly again. However I was wondering why is that case. I did some digging but I didn't manage to get an answer about that. From firebug I see that the url the browser tries to post is for some reason http://{ProjectName}/Person/SaveCandidateLanguage?Length=9 instead ofhttp://{ProjectName}/Candidate/SaveCandidateLanguage?Length=9and naturally I get a 404 Not found response. I was also wondering what is the variable ?Length=9 that I see at the end of the url and where does it come from. <code>  @using (Ajax.BeginForm(""SaveCandidateLanguage"", ""Candidate"", new AjaxOptions { HttpMethod = ""Post"", OnBegin = ""onBeginFormValidation"", OnSuccess = ""onSaveCandidateLanguageSuccess"" })){ // form input elements} @using (Ajax.BeginForm(""SaveCandidateLanguage"", ""Candidate"", new AjaxOptions { HttpMethod = ""Post"", OnBegin = ""onBeginFormValidation"", OnSuccess = ""onSaveCandidateLanguageSuccess"" }, new { id = ""addEditCandidateLanguageForm"", novalidate = ""novalidate"" })){ // form input elements}",Ajax.BeginForm with 4 arguments not finding the action method
Is there any case where `catch { throw; }` is actually useful?," Disclaimer: It is well known that catch (ex) { throw ex; } is bad practice. This question is not about that.While digging through Microsoft reference sources, I noticed the following pattern in a lot of methods: No logging, no debugging codejust a plain simple catch { throw; }.Since, obviously, the guys at Microsoft should be fairly proficient in the use of C#, what could be the point of doing that instead of just omitting the catch block (and the try statement) altogether? Is there a technical reason for coding like this, or is it purely a stylistic choice?Note: I don't know if it is relevant, but all such instances I could find also contain a try-finally block nested inside the try clause of the try-catch block. <code>  try { ...} catch { throw;}",Is there any technical reason to write a catch block containing only a throw statement?
Migration issue .net core 1.1 to 2.0 - InvalidOperationException: Cannot create a DbSet for 'Role'," The following solution works in .net core 1.1, but after upgrading from 1.1 to 2.0, I received the following error: InvalidOperationException: Cannot create a DbSet for 'Role' because this type is not included in the model for the context.When the user attempts to log in and the following statement is executed: What is wrong?User.cs IdentityEntities.cs ConfigureServices <code>  var result = await _signInManager.PasswordSignInAsync(model.Email, model.Password, model.RememberMe, lockoutOnFailure: false); public partial class User : IdentityUser<Guid>{ public string Name { get; set; }} public partial class UserLogin : IdentityUserLogin<Guid>{}public partial class UserRole : IdentityUserRole<Guid>{}public partial class UserClaim : IdentityUserClaim<Guid>{}public partial class Role : IdentityRole<Guid>{ public Role() : base() { } public Role(string roleName) { Name = roleName; }}public partial class RoleClaim : IdentityRoleClaim<Guid>{}public partial class UserToken : IdentityUserToken<Guid>{} services.AddIdentity<User, Role> ",InvalidOperationException: Cannot create a DbSet for 'Role' because this type is not included in the model for the context
ASP.NET Core 2.0 - Cannot resolve scoped service Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.IViewBufferScope from root provider," I'm trying to use in my ASP.NET Core 2.0 web app this sample RazorViewEngineEmailTemplates to create an html email body from View. But when I run it and my controller gets an ajax request, I get this error: Cannot resolve scoped service Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.IViewBufferScope from root provider It's probably coming from resolving dependencies in the RazorViewToStringRenderer class but I have no idea how to fix this. <code> ",Cannot resolve scoped service Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.IViewBufferScope from root provider
Align Center the header text of a TemplateField," I've a GridView with TemplateFields.I have tried HeaderStyle-HorizontalAlign=""Center"" to align the header text of the TemplateField to center but it's not working. How I can align center the header text of a TemplateField?While ItemStyle-HorizontalAlign=""Center"" aligning center the items of TemplateField is working correctly.Any help will be really appreciated! <code>  <asp:TemplateField HeaderText=""Events"" HeaderStyle-HorizontalAlign=""Center"" ItemStyle-HorizontalAlign=""Center""></asp:TemplateField>",How to center align the header text of a TemplateField?
Align Center - the header text of a TemplateField," I've a GridView with TemplateFields.I have tried HeaderStyle-HorizontalAlign=""Center"" to align the header text of the TemplateField to center but it's not working. How I can align center the header text of a TemplateField?While ItemStyle-HorizontalAlign=""Center"" aligning center the items of TemplateField is working correctly.Any help will be really appreciated! <code>  <asp:TemplateField HeaderText=""Events"" HeaderStyle-HorizontalAlign=""Center"" ItemStyle-HorizontalAlign=""Center""></asp:TemplateField>",How to center align the header text of a TemplateField?
How to centrally align the header text of a TemplateField?," I've a GridView with TemplateFields.I have tried HeaderStyle-HorizontalAlign=""Center"" to align the header text of the TemplateField to center but it's not working. How I can align center the header text of a TemplateField?While ItemStyle-HorizontalAlign=""Center"" aligning center the items of TemplateField is working correctly.Any help will be really appreciated! <code>  <asp:TemplateField HeaderText=""Events"" HeaderStyle-HorizontalAlign=""Center"" ItemStyle-HorizontalAlign=""Center""></asp:TemplateField>",How to center align the header text of a TemplateField?
How can I deconstruct Value Tuples in a Dictionary using C# 7?," Given the following: I can easily get the value out of the dictionary, but how can I deconstruct it to get each individual values so something like this: <code>  var dic = new Dictionary<string, (int, int)>(){ [""A""] = (1, 2)};dic.TryGetValue(""A"", out (int, int) value); dic.TryGetValue(""A"", out var (left, right));",How can I Deconstruct Value Tuples that are out parameters in C# 7?
Deconstruct Value Tuples in a Dictionary using C# 7?," Given the following: I can easily get the value out of the dictionary, but how can I deconstruct it to get each individual values so something like this: <code>  var dic = new Dictionary<string, (int, int)>(){ [""A""] = (1, 2)};dic.TryGetValue(""A"", out (int, int) value); dic.TryGetValue(""A"", out var (left, right));",How can I Deconstruct Value Tuples that are out parameters in C# 7?
Deconstruct Value Tuples that are out parameters using C# 7?," Given the following: I can easily get the value out of the dictionary, but how can I deconstruct it to get each individual values so something like this: <code>  var dic = new Dictionary<string, (int, int)>(){ [""A""] = (1, 2)};dic.TryGetValue(""A"", out (int, int) value); dic.TryGetValue(""A"", out var (left, right));",How can I Deconstruct Value Tuples that are out parameters in C# 7?
How to convert two-letter county codes to flag emojis?," I have ISO 3166-1 (alpha-2) country codes, which are two-letter codes, such as ""US"" and ""NL"". How do I get the corresponding flag emoji?EDIT: Preferably I would like to do this without using an explicit mapping between country codes and their corresponding emojis. It has been done in JavaScript but I'm not sure how to do it in C#. <code> ",How to convert two-letter country codes to flag emojis?
Updating EF 6.2.0 from EF 6.1.3 causes cannot access a disposed object error," I'm working with SQLite. I am able to use entity framework 6.1.3 in my WPF application without problems, but when I update it to 6.2.0 I get the following error: Any ideas? <code>  Test method DataAccessLayerTests.GenericDataRepositoryTests.CRUD_On_Pipe threw exception: System.ObjectDisposedException: Cannot access a disposed object.Object name: 'SQLiteConnection'. at System.Data.SQLite.SQLiteConnection.CheckDisposed() at System.Data.SQLite.SQLiteConnection.get_State() at System.Data.Entity.Internal.RepositoryBase.CreateConnection() at System.Data.Entity.Migrations.History.HistoryRepository.QueryExists(String contextKey) at System.Data.Entity.Migrations.History.HistoryRepository.Exists(String contextKey) at System.Data.Entity.Migrations.History.HistoryRepository.GetPendingMigrations(IEnumerable`1 localMigrations) at System.Data.Entity.Migrations.DbMigrator.GetPendingMigrations() at Core.DatabaseContext.CreateAndSeedIfNotExists`1.InitializeDatabase(T context) in C:\Users\roadrunner\propulsimcs\Propulsim\Core\DatabaseContext.cs:line 40 at System.Data.Entity.Internal.InternalContext.<>c__DisplayClassf`1.<CreateInitializationAction>b__e() at System.Data.Entity.Internal.InternalContext.PerformInitializationAction(Action action) at System.Data.Entity.Internal.InternalContext.PerformDatabaseInitialization() at System.Data.Entity.Internal.LazyInternalContext.<InitializeDatabase>b__4(InternalContext c) at System.Data.Entity.Internal.RetryAction`1.PerformAction(TInput input) at System.Data.Entity.Internal.LazyInternalContext.InitializeDatabaseAction(Action`1 action) at System.Data.Entity.Internal.LazyInternalContext.InitializeDatabase() at System.Data.Entity.Internal.InternalContext.Initialize() at System.Data.Entity.Database.Initialize(Boolean force) at Core.DatabaseContext..ctor() in C:\Users\roadrunner\propulsimcs\Propulsim\Core\DatabaseContext.cs:line 114 at DataAccessLayer.GenericDataRepository`1.GetAll(Expression`1[] navigationProperties) in C:\Users\roadrunner\propulsimcs\Propulsim\DataAccessLayer\GenericDataRepository.cs:line 16 at DataAccessLayerTests.GenericDataRepositoryTests.CRUD_On_Pipe() in C:\Users\roadrunner\propulsimcs\Propulsim\DataAccessLayerTests\GenericDataRepositoryTests.cs:line 34Debug Trace:Native library pre-loader is trying to load native SQLite library ""C:\Users\roadrunner\propulsimcs\Propulsim\DataAccessLayerTests\bin\Debug\x86\SQLite.Interop.dll""...",Updating to EF 6.2.0 from EF 6.1.3 causes cannot access a disposed object error
Entity framework Core : property setter is never caller," In both EF Core and EF6, invoking the getter of the property 'Date' (see below) gives the correct value, however notice the slight difference between the two : in EF Core the setter is never called!This is my model : This is my way to retrieve a single item : Does EF core initialize the backup field instead of the property (through reflection)? doesn't this violate encapsulation? I'm migrating some code from EF6 to EF Core and I really would like to avoid wasting time in manually invoking the logic behind each setter...EDIT : Asking the question made me try something fancy, if I rename my backup field from _Property to any thing else like _PropertyX (In this example it would be _DateX) magically my setter is invoked by EF Core!  <code>  public class MyModel{ private DateTime _Date; private bool dateTimeHasBeenSet = false; public DateTime Date { get { return _Date; } set { dateTimeHasBeenSet = true; _Date = value; } }} //Entity Framework 6 using (Ef6Context context = new Ef6Context()) { var m = context.MyModels.First(); // m.dateTimeHasBeenSet is true } //Entity Framework Core using (EfCoreContext context = new EfCoreContext()) { var m = context.MyModels.First(); // m.dateTimeHasBeenSet is false }",Entity framework Core : property setter is never called (Violation of encapsulation?)
Execute long time command in SSH.net C# and display the result," Is there any way to execute Linux command and display the result in text box in Windows application like PuTTY.For example I'm trying to execute the following commands using the following code This command takes along time to be executed and no result appeared on the result text box. <code>  wget http://centos-webpanel.com/cwp-latestsh cwp-latest SshClient sshclient = new SshClient(IPtxtBox.Text, UserNameTxt.Text, PasswordTxt.Text);sshclient.Connect();ShellStream stream = sshclient.CreateShellStream(""customCommand"", 80, 24, 800, 600, 1024);resultTxt.Text = SSHCommand.SendCommand(stream, ""wget http://centos-webpanel.com/cwp-latest && sh cwp-latest""); private static void WriteStream(string cmd, StreamWriter writer, ShellStream stream){ writer.WriteLine(cmd); while (stream.Length == 0) Thread.Sleep(500);}private static string ReadStream(StreamReader reader){ StringBuilder result = new StringBuilder(); string line; while ((line = reader.ReadLine()) != null) result.AppendLine(line); return result.ToString();}private static string SendCommand(ShellStream stream, string customCMD){ StringBuilder strAnswer = new StringBuilder(); var reader = new StreamReader(stream); var writer = new StreamWriter(stream); writer.AutoFlush = true; WriteStream(customCMD, writer, stream); strAnswer.AppendLine(ReadStream(reader)); string answer = strAnswer.ToString(); return answer.Trim();}",Execute long time command in SSH.NET and display the results continuously in TextBox
Execute long time command in SSH.net and display the result," Is there any way to execute Linux command and display the result in text box in Windows application like PuTTY.For example I'm trying to execute the following commands using the following code This command takes along time to be executed and no result appeared on the result text box. <code>  wget http://centos-webpanel.com/cwp-latestsh cwp-latest SshClient sshclient = new SshClient(IPtxtBox.Text, UserNameTxt.Text, PasswordTxt.Text);sshclient.Connect();ShellStream stream = sshclient.CreateShellStream(""customCommand"", 80, 24, 800, 600, 1024);resultTxt.Text = SSHCommand.SendCommand(stream, ""wget http://centos-webpanel.com/cwp-latest && sh cwp-latest""); private static void WriteStream(string cmd, StreamWriter writer, ShellStream stream){ writer.WriteLine(cmd); while (stream.Length == 0) Thread.Sleep(500);}private static string ReadStream(StreamReader reader){ StringBuilder result = new StringBuilder(); string line; while ((line = reader.ReadLine()) != null) result.AppendLine(line); return result.ToString();}private static string SendCommand(ShellStream stream, string customCMD){ StringBuilder strAnswer = new StringBuilder(); var reader = new StreamReader(stream); var writer = new StreamWriter(stream); writer.AutoFlush = true; WriteStream(customCMD, writer, stream); strAnswer.AppendLine(ReadStream(reader)); string answer = strAnswer.ToString(); return answer.Trim();}",Execute long time command in SSH.NET and display the results continuously in TextBox
C# BeforeFieldInit Jon Skeet explaination confusion," I read through Jon Skeet's article about beforefieldinit and I stumbled upon a question. He mentions that the type initializer can be invoked at any time before the first reference to a static field is called.This is my test code: The output is: But without the marked line, so without the invocation of the static field x1, the output is: So the invocation of objects that are flagged with beforefieldinit affects the invocation of their type initializers? Or does this belong to the strange effect of beforefieldinit he mentioned? So, beforefieldinit can make the invocation of the type initializer even lazier or more eager. <code>  class Test1{ public static string x1 = EchoAndReturn1(""Init x1""); public static string EchoAndReturn1(string s) { Console.WriteLine(s); return s; }}class Programm{ public static void Main() { Console.WriteLine(""Starting Main""); Test1.EchoAndReturn1(""Echo 1""); Console.WriteLine(""After echo""); string y = Test1.x1; //marked line }} Init x1Starting MainEcho 1After echo Starting MainInit x1Echo 1After echo",C# BeforeFieldInit Jon Skeet explanation confusion
.Net COre Web API," New to .NET Core. What am I doing wrong? Here is my controller I am able to call the API with this URLhttp://localhost:51375/api/customer/8172858817I hit the breakpoint in GET method, but Id is always zero. I cannot get the method to read the value which is being passed from URL.Any suggestions? <code>  [Route(""api/[controller]"")]public class customerController : Controller{ // GET: api/values //[HttpGet] //public IEnumerable<string> Get() //{ // return new string[] { ""value1"", ""value2"" }; //} // GET api/values/5 [HttpGet(""{id}"")] public customer Get(int id) { var repo = new customerRepository(); return repo.GetCustomerOnPhone(id); }}",.Net Core Web API
"Remove accents in string except """" C#"," I have the following example code: I need to normalize the text without removing the """"sI followed this example But it's for Java and it has not worked for meI want your result to be: ""aame"".  <code>  var inputString = ""ame"";inputString = inputString.Replace('', '\u00F1');var normalizedString = inputString.Normalize(NormalizationForm.FormD);var result = Regex.Replace(normalizedString, @""[^a-zA-Z0-9\s]*"", string.Empty);return result.Replace('\u00F1', ''); // naame :(","Remove accents in string except """""
Property or indexer googleprotobuf RepeatedField cannot be assigned to  it is read only," I am new to Google ProtoBuf file. I have below message in a ProtoBuf file. I have generated the corresponding ProtoBuf C# class using protoc.exe and added that generated C# class file inside my .NET project file.When I assign a value to the generated LockerIds field I get the error ""Property or indexer 'AvailabilityOfLockersResp.LockerIds' cannot be assigned to -- it is read only"":It is showing me that it's a read-only field. But, I want to assign a value to this field. How can I add things to this field? <code>  message AvailabilityOfLockersResp{ uint32 NumberOfAvailableLockers; repeated uint32 lockerIds = 1; }",Property or indexer of type RepeatedField cannot be assigned to  it is read only
Get a specific header on HTTP call," I cannot get a specific header (Content-Disposition) when I'm accessing it via an Angular service. CORS is enabled and the Angular HTTPClient is set to retrieve ALL headers.Startup.cs fileController.cs fileService.ts Here's the header console.log: What am I missing? I just want to get the Content-Disposition header. <code>  public void Configuration(IAppBuilder app) { HttpConfiguration config = new HttpConfiguration(); WebApiConfig.Register(config); ConfigureOAuth(app, config); app.UseCors(Microsoft.Owin.Cors.CorsOptions.AllowAll); app.UseWebApi(config); } [Route(""file/{idFile}"")] public HttpResponseMessage GetFile(string idFile) { string file; byte[] file; document = fileService.GetFile(idDFile, out fileName); var result = new HttpResponseMessage(HttpStatusCode.OK) { Content = new ByteArrayContent(file) }; result.Content.Headers.ContentDisposition = new System.Net.Http.Headers.ContentDispositionHeaderValue(""attachment"") { FileName = nomeFile }; result.Content.Headers.ContentType = new MediaTypeHeaderValue(""application/octet-stream""); return result; } getFile(fileId: number): Observable<Response> { const url = `${urlBackEnd}/file/${fileId}`; return this.http.get(url, { observe: 'response', responseType: 'blob' }) .map(res => {; console.log(res.headers.keys()); // There's no CONTENT-DISPOSITION saveAs(<Blob>res.body); return res.body; }) .catch(e => this.handleErrors(e));} [ ""content-type"", ""cache-control""]","Get a specific response header (e.g., Content-Disposition) in Angular from an ASP.NET Web API 2 response for a cross-origin http.get request"
Thread safe Singleton C#," I have read in Jon's Skeet online page about how to create a thread safe Singleton in C#http://csharpindepth.com/Articles/General/Singleton.aspx in the paragraph below this code it says: As hinted at before, the above is not thread-safe. Two different threads could both have evaluated the test if (instance==null) and found it to be true, then both create instances, which violates the singleton pattern. Note that in fact the instance may already have been created before the expression is evaluated, but the memory model doesn't guarantee that the new value of instance will be seen by other threads unless suitable memory barriers have been passed.Can you please explain why doesn't the memory model does not guarantee that the new value of instance will be seen by other threads?the static variable is located on the heap, but why it is not shared with other threads immediately? do we need to wait for the context switch so the other thread will know the instance is not null anymore? <code>  // Bad code! Do not use!public sealed class Singleton{ private static Singleton instance=null; private Singleton() { } public static Singleton Instance { get { if (instance==null) { instance = new Singleton(); } return instance; } }}",Thread safe Singleton: why the memory model does not guarantee that the new instance will be seen by other threads?
Is it possible to dynamically compile class in App_Code while pre-compiling the rest a project/library," ASP.NET has specicial application folders like App_Code which: Contains source code for shared classes and business objects (for example, ..cs, and .vb files) that you want to compile as part of your application. In a dynamically compiled Web site project, ASP.NET compiles the code in the App_Code folder on the initial request to your application. Items in this folder are then recompiled when any changes are detected.Problem is, I'm building a web application, not a dynamically compiled web site. But I'd love to be able to store config values directly in C#, rather than serve via an XML and have to read in during Application_Start and store in HttpContext.Current.ApplicationSo I have the following code in /App_Code/Globals.cs: Which could be anywhere within the application like this: The goal is to be able to store any literals in a configurable area that can be updated without recompiling the entire application.I can use the .cs file by setting its build action to compile, but doing so strips out App_Code/Globals.cs from my output.Q: Is there a way to identify some parts of a project that should dynamically compile while allowing the rest of the project to be precompiled?If I set the build action to content - the .cs file will get copied to the bin folder and compiled at runtime. However, in that case, it's not available at design time. If I set the build action to compile - I can access the objects the same as any other compiled class during design/runtime, but it'll get stripped out of the /App_Code folder when published. I can still place it in the output directory via Copy Always, but the already compiled classes seem to take priority so I can't push config changes without re-deploying the whole application. <code>  namespace AppName.Globals{ public static class Messages { public const string CodeNotFound = ""The entered code was not found""; }} string msg = AppName.Globals.Messages.CodeNotFound;",Dynamically compile a class in App_Code while pre-compiling the rest of the project/library
Is it possible to dynamically compile a class in App_Code while pre-compiling the rest a project/library," ASP.NET has specicial application folders like App_Code which: Contains source code for shared classes and business objects (for example, ..cs, and .vb files) that you want to compile as part of your application. In a dynamically compiled Web site project, ASP.NET compiles the code in the App_Code folder on the initial request to your application. Items in this folder are then recompiled when any changes are detected.Problem is, I'm building a web application, not a dynamically compiled web site. But I'd love to be able to store config values directly in C#, rather than serve via an XML and have to read in during Application_Start and store in HttpContext.Current.ApplicationSo I have the following code in /App_Code/Globals.cs: Which could be anywhere within the application like this: The goal is to be able to store any literals in a configurable area that can be updated without recompiling the entire application.I can use the .cs file by setting its build action to compile, but doing so strips out App_Code/Globals.cs from my output.Q: Is there a way to identify some parts of a project that should dynamically compile while allowing the rest of the project to be precompiled?If I set the build action to content - the .cs file will get copied to the bin folder and compiled at runtime. However, in that case, it's not available at design time. If I set the build action to compile - I can access the objects the same as any other compiled class during design/runtime, but it'll get stripped out of the /App_Code folder when published. I can still place it in the output directory via Copy Always, but the already compiled classes seem to take priority so I can't push config changes without re-deploying the whole application. <code>  namespace AppName.Globals{ public static class Messages { public const string CodeNotFound = ""The entered code was not found""; }} string msg = AppName.Globals.Messages.CodeNotFound;",Dynamically compile a class in App_Code while pre-compiling the rest of the project/library
Is it really possible to protect a connectionstring in app. config?," We want to protect the login information that is used to connect to our SQL Server database from a .NET windows application.This information is stored as a connection string in an app.config file on the client PC.Almost everywhere it is suggested you encrypt your connection string using However, a malicious user that wants your database password, could just copy the encrypted config file, use it with it's own application, and call This will decrypt the connection string back to plain text.Is there any way to really protect a database password in a .NET application that is stored on a user's PC?EDIT: to further clarify the situation, we are indeed talking about a malicious user (read: competitor) that has access to the same PC and wants the password.As a secondary measure, we first encrypt the password ourselves, save it to app.config and then call ProtectSection(). This will make Unprotect() output the encrypted password. But the user will still be able to decompile our code and figure out our encryption key and algorithm that is used... <code>  (ConnectionStringsSection)config.GetSection(""connectionStrings"").ProtectSection(); (ConnectionStringsSection)config.GetSection(""connectionStrings"").UnprotectSection();",Is it really possible to protect a connection string in app. config?
How to display power values in a string, I need to write values like: I need to know if there is a way to format numbers as above in a string. <code>  9.6 x 109.6 x 10,How to format numbers in scientific notation with powers in superscript
How to display power values in a string in especific format, I need to write values like: I need to know if there is a way to format numbers as above in a string. <code>  9.6 x 109.6 x 10,How to format numbers in scientific notation with powers in superscript
C# WebClient.CancelAsync - File still downloading," I'm trying to create a Web API using Asp.NET Core that exposes routes to start and cancel long downloads of large files. The server should be able to handle multiple downloads at the same time.The download is performed using WebClient.DownloadFileAsync in order to have a short response time and returning a downloadId for later use. The instance of the WebClient is stored as value in a static dictionary whose corresponding key is of naturally the downloadId.The download should be canceled using WebClient.CancelAsync on the instance of the client retrieved by accessing the value of the dictionary corresponding to the downloadId key.The following code works perfectly when the download reaches its completion without being canceled; the AsyncCompletedEventHandler (OnDownloadFileCompleted in that case) is properly invoked. PROBLEM: When invoking WebClient.CancelAsync, the file keeps on downloading and OnDownloadFileCompleted is not invoked right away. The WebClient seems to wait until the download finishes before invoking the handler. In both case however, the property AsyncCompletedEventArgs.Canceled is properly set (e.g to true if WebClient.CancelAsync was indeed invoked.Am I missing something?Is there a better/smarter pattern to handle multiple downloads in a WebAPI?Any help would much appreciated!DownloadController.cs DownloadService.cs <code>  [Route (""api/download"")]public class DownloadController { private readonly DownloadService service; public DownloadController (DownloadService service) { this.service = service; } [Route (""start"")] [HttpPost] public string Start ([FromForm] string fileUrl) => this.service.StartDownload (fileUrl); [Route (""cancel"")] [HttpPost] public void Cancel ([FromForm] string downloadId) => this.service.CancelDownload (downloadId);} public class DownloadService { public string DOWNLOAD_FOLDER { get => ""C:\\tmp""; } public static Dictionary<string, WebClient> DownloadClients = new Dictionary<string, WebClient> (); public string StartDownload (string fileUrl) { var downloadId = Guid.NewGuid ().ToString (""N""); DownloadClients[downloadId] = new WebClient (); DownloadClients[downloadId].DownloadFileCompleted += OnDownloadFileCompleted; DownloadClients[downloadId].DownloadFileAsync (new Uri (fileUrl), Path.Combine (DOWNLOAD_FOLDER, downloadId), downloadId); return downloadId; } public void CancelDownload (string downloadId) { if (DownloadClients.TryGetValue (downloadId, out WebClient client)) { client.CancelAsync (); } } private void OnDownloadFileCompleted (object sender, AsyncCompletedEventArgs e) { var downloadId = e.UserState.ToString (); if (!e.Cancelled) { Debug.WriteLine (""Completed""); } else { Debug.WriteLine (""Cancelled""); //will only be reached when the file finishes downloading } if (DownloadClients.ContainsKey (downloadId)) { DownloadClients[downloadId].Dispose (); DownloadClients.Remove (downloadId); } }}",WebClient.CancelAsync  File still downloading
C# Nullable Reference Types," Null reference exceptions are one of the top sources of program failures. Tony Hoare called it his billion dollar mistake. So I'm particularly looking forward to C# 8 and the new nullable reference types feature. I think I've got a pretty good grasp of the feature and what it's going to mean for my code. There is one aspect I'm struggling the get my head around though and that's how default will behave.Currently in C# default(string) will return null. But when C# 8 comes along then doing something like string x = default(string); should surely give a compiler warning straight off the bat. Seems like this is a bit of a paradox. I'm also wondering if default(string?) will be possible and what would it even return. I guess it would have to be null which just adds to my confusion.I don't think there has been a preview release of this feature yet, but I was wondering if anyone knows yet how this will be handled. <code> ",Nullable Reference Types with C# 8
C# Nullable Reference Types with c# 8," Null reference exceptions are one of the top sources of program failures. Tony Hoare called it his billion dollar mistake. So I'm particularly looking forward to C# 8 and the new nullable reference types feature. I think I've got a pretty good grasp of the feature and what it's going to mean for my code. There is one aspect I'm struggling the get my head around though and that's how default will behave.Currently in C# default(string) will return null. But when C# 8 comes along then doing something like string x = default(string); should surely give a compiler warning straight off the bat. Seems like this is a bit of a paradox. I'm also wondering if default(string?) will be possible and what would it even return. I guess it would have to be null which just adds to my confusion.I don't think there has been a preview release of this feature yet, but I was wondering if anyone knows yet how this will be handled. <code> ",Nullable Reference Types with C# 8
How to tell Unity 3d to open Scripts with Monodevelop," How to tell Unity 3d to open Scripts with Monodevelop?My system run's :Ubuntu 17.10 MonoDevelop 5.10Unity 2017.3.0p2Usualy, under windows, Unity will open scripts with Visual Studio when double clicked.I am under linux and to achieve the same thing I have to use Monodevelop.Everything is working fine but I would like unity to launch Monodevelop to edit the scripts.Most forum are saying that unity should launch mono to edit script but for some reason my built is not. If I try to open a script within Unity there is just nothing hapening. Its not even asking me how should it open the file.Anyone know how to do this? <code> ",Change default IDE in Unity
How to change .Net framework in Rider IDE?," In Rider IDE, I am trying to create a new solution:But I'm unable to change the .NET Framework as the dropdown is disabled. How can I change the version? I have installed .NET Framework 3.5, 4.5, 4.6. <code> ",How to change .NET Framework in Rider IDE?
C# Generic Method with Type Constraints or Base Class Parameter," If I write a method accepting a parameter which derives from a BaseClass (or an interface), as far as I know there are two ways to achieve that: and What are the differences between the two methods? <code>  void MyMethod<T>(T obj) where T : BaseClass { ... } void MyMethod(BaseClass obj) { ... }",Generic method with type constraints or base class parameter
CSV file created with C# shows  characters in Excel," When a CSV file is generated using C# and opened in Microsoft Excel it displays characters before special symbols e.g. In Notepad++ the hex value for is: C2So before writing the symbol to file, I have tried the following... When opening the CSV file in Excel, I still see the """" character before the symbol (hex equivalent \xC2 \xA3); It made no difference.Do I need to use a different encoding? or am I missing something? <code>  var test = ""200.00""; var replaced = test.Replace(""\xC2"", "" ""); StreamWriter outputFile = File.CreateText(""testoutput.csv""); // default UTF-8 outputFile.WriteLine(replaced); outputFile.Close(); ",UTF-8 CSV file created with C# shows  characters in Excel
Copy NuGet pdb to output directory," When I build an ASP.NET Core project it copies to the output directory only its own .pdb files and all .dlls of any installed NuGet packages. However, it does not copy their .pdb files. I have to select them manually from the %UserProfile%\.nuget\packages directory. I was wondering whether there is an option to enable NuGet package .pdb to be copied to the output directory? <code> ",Copy NuGet .pdb to output directory
how to make a struct component a variable?," Not sure I am asking this right or this even possible.I feel to explain my question it is best to ask right in the code at the relevant places so please see my comments in the snippet below.I wonder how to achieve this without building a new list of values for each I iteration. I feel this should not be necessary.The bigger picture of this loop is to plot individual dimensions of 3D points to three new 2D plots of these. Hope that makes sense. <code>  for (int i = 0; i < 3; i++) // 3 iterations (X,Y;Z){ // what here? how to make the data component of Vector3D a variable for (int k = 0; k <= Points.Count - 1; k++) { Vector2D TL = new Vector2D(); TL.x = ((1 / (float)FrameCount.Sum()) * k); TL.y = Points[k].x; // on i = 0 want Points[k].x // on i = 1 want Points[k].y // on i = 2 want Points[k].z TimelinePoints.Add(TL); // just collect to a flat list for now }}",How to make a struct component a variable?
Chain asynchronous operations that return Either using Language-Ext in C#," I am using the Language-Ext library for C# and I am trying to chain asynchronous operations that return an Either type. Let's say that I have three functions that would return an integer if they succeed and a string if the fail, and another function that sums the result of the previous three functions. In the sample implementations below Op3 fails and returns a string. I want to chain these operations and I am trying to do it like this: But we the code does not compile because I get the error cannot convert from 'LanguageExt.Either<string, int>' to 'int' for the arguments of Calculate. How should I chain these functions? <code>  public static async Task<Either<string, int>> Op1(){ return await Task.FromResult(1);}public static async Task<Either<string, int>> Op2(){ return await Task.FromResult(2);}public static async Task<Either<string, int>> Op3(){ return await Task.FromResult(""error"");}public static async Task<Either<string, int>> Calculate(int x, int y, int z){ return await Task.FromResult(x + y + z);} var res = await (from x in Op1() from y in Op2() from z in Op3() from w in Calculate(x, y, z) select w);",Chain asynchronous operations that return Either using Language-Ext in C#
Chain asynchronous operations that return Either using Language-Ext," I am using the Language-Ext library for C# and I am trying to chain asynchronous operations that return an Either type. Let's say that I have three functions that would return an integer if they succeed and a string if the fail, and another function that sums the result of the previous three functions. In the sample implementations below Op3 fails and returns a string. I want to chain these operations and I am trying to do it like this: But we the code does not compile because I get the error cannot convert from 'LanguageExt.Either<string, int>' to 'int' for the arguments of Calculate. How should I chain these functions? <code>  public static async Task<Either<string, int>> Op1(){ return await Task.FromResult(1);}public static async Task<Either<string, int>> Op2(){ return await Task.FromResult(2);}public static async Task<Either<string, int>> Op3(){ return await Task.FromResult(""error"");}public static async Task<Either<string, int>> Calculate(int x, int y, int z){ return await Task.FromResult(x + y + z);} var res = await (from x in Op1() from y in Op2() from z in Op3() from w in Calculate(x, y, z) select w);",Chain asynchronous operations that return Either using Language-Ext in C#
how to get my app settings folder path for the current user C# WPF?," When I use the code to save my settings it write the file to that path like How can I get the path for ""the app version"" folder so I can write another stuff to it?I am using .Net Framework 4.6.2 and Visual Studio 2017. <code>  Properties.Settings.Default.Save(); %USERPROFILE%\AppData\Local\MyAppName\MyAppName.exe_Url_SomeWiredCode\TheAppVersionNumber\user.config ""C:\Users\Username\AppData\Local\MyApp\MyApp.exe_Url_claumreyuxtgqul2vuc3couyu5tso2n0\1.0.0.0\user.config""",How to get my app settings folder path for the current user?
Odd behavior when naming a MonoBehaviour class GameManager," Is there something special about the name GameManager in Unity that causes the designer to act differently? I have a class named GameManager that is derived from ScriptableObject, and the designer is doing a few things differently for that class versus my other ScriptableObject derived classes.I can verify this behavior by changing the name from GameManager to Manager, and the Unity editor acts differently.My definition of GameManager looks like this: Here's what the Project view looks like when my C# class is named GameManager. Notice the different icon next to Game Manager. If I delete that asset, change the underlying C# class name to Manager, and then create the asset again, the icon is the normal icon, rather than being the gear.The other issue, which is more of a problem, is that if I have a game object that includes a MonoBehaviour that has a property of type GameManager, Unity won't show me the existing GameManager asset when I click on the little circle icon next to the field in the Inspector. Unity will let me drag the GameManager asset from the Project view into the field, but Unity won't let me select the reference by clicking in the field. As shown in the screenshots below, Unity doesn't give me the option of selecting my GameManager asset, even though it's available in the Project view.However, If I change the name of the underlying C# class from GameManager to Manager, the Unity editor works correctly, as shown below.Is there something special about the C# class name of GameManager, or could this behavior be due to something else? <code>  [CreateAssetMenu(menuName = ""Managers/GameManager"")]public class GameManager : ScriptableObject{ // ...}",Special Icon when naming a MonoBehaviour class GameManager
c# 7.0 discard feature use cases," While going through new C# 7.0 features, I stuck up with discard feature. It says:Discards are local variables which you can assign but cannot readfrom. i.e. they are write-only local variables.and, then, an example follows: What is real use case when this will be beneficial? I mean what if I would have defined it in normal way, say: <code>  if (bool.TryParse(""TRUE"", out bool _)) if (bool.TryParse(""TRUE"", out bool isOK))",Discard feature significance in C# 7.0?
c# 7.0 - discard feature significance?," While going through new C# 7.0 features, I stuck up with discard feature. It says:Discards are local variables which you can assign but cannot readfrom. i.e. they are write-only local variables.and, then, an example follows: What is real use case when this will be beneficial? I mean what if I would have defined it in normal way, say: <code>  if (bool.TryParse(""TRUE"", out bool _)) if (bool.TryParse(""TRUE"", out bool isOK))",Discard feature significance in C# 7.0?
Executing T4 text template in Visual Studio Code," I created a T4 text template (.tt) file in Visual Studio Code, but unlike Visual Studio 2017 (or 2015 ,...) it won't generate the output file after saving the .tt file. How can I generate the output in Visual Studio Code? <code> ",Executing a T4 text template in Visual Studio Code
Entity Framework Core: many-to-many self referencing relationship," I am new in EF. And I ran into a problem with creation many-to-many self referencing relation.I've tried to use solution from: Entity Framework Core: many-to-many relationship with same entitymy entities : and next configuration: but it leads to next exception. System.InvalidOperationException: 'Cannot create a relationship between 'WordEntity.Sinonyms' and 'WordSinonymEntity.Word', because there already is a relationship between 'WordEntity.Sinonyms' and 'WordSinonymEntity.Sinonym'. Navigation properties can only participate in a single relationship.'Does anyone can help me or may be suggest some examples to learn ?Thanks. <code>  public class WordEntity{ public long Id { get; set; } public string Name { get; set; } public string Json { get; set; } public virtual List<WordSinonymEntity> Sinonyms { get; set; }}public class WordSinonymEntity{ public long WordId { get; set; } public virtual WordEntity Word { get; set; } public long SinonymId { get; set; } public virtual WordEntity Sinonym { get; set; }} modelBuilder.Entity<WordSinonymEntity>() .HasOne(pt => pt.Sinonym) .WithMany(p => p.Sinonyms) .HasForeignKey(pt => pt.SinonymId);modelBuilder.Entity<WordSinonymEntity>() .HasOne(pt => pt.Word) .WithMany(t => t.Sinonyms) .HasForeignKey(pt => pt.WordId);`",Many-to-many self referencing relationship
Does Database.CompatibleWithModel(bool) exist in EF Core," I'm working on a project that uses EFCore 2.1.0-preview1-final code first approach. Like in EF6 (and previous versions) I want to ensure the compatibility of my DbContext (and models) to the database.In EF6 it was enabled by default and it was possible to deactivate it with Database.CompatibleWithModel(false);. As far as I know EF uses the __MigrationHistory table where the model information was stored. EFCore has no such column in __EFMigrationsHistory table that could provide such information.I cannot find any information about compatibility check in EFCore. But I want to ensure the compatibility, because after some tests it seems not to be enabled by default (or does exist). I tested it by adding and deleting some columns from database manually and executing the application after the modifications. I - against my expectation - received no exception.Does anybody know how to achieve a compatibility check from model to database and vice versa like in EF6 for EFCore?Or could provide some helpful links for further information about it or why it doesn't exist in EFCore (because it is not necessary)? <code> ",Does an equivalent to Database.CompatibleWithModel(bool) exist in EF Core
Different domain in the same app ASP .NET Core 2.0," I have an ASP.NET Core 2.0 app hosted on an Azure App Service.This application is bound to domainA.com. I have one route in my appfor example, domainA.com/route.Now, I want to introduce another domain, but have it respond only to a different routefor example, domainB.com.What is the best way to do this? <code> ",Domain-based routing in ASP.NET Core 2.0
Different domain in the same app ASP.NET Core 2.0," I have an ASP.NET Core 2.0 app hosted on an Azure App Service.This application is bound to domainA.com. I have one route in my appfor example, domainA.com/route.Now, I want to introduce another domain, but have it respond only to a different routefor example, domainB.com.What is the best way to do this? <code> ",Domain-based routing in ASP.NET Core 2.0
Custom return type based on input data c#," I have a method which takes an interface type and evaluates what the type is and from that I need to return a type related to it. But I'm not sure how to make the type returns flexible for it. I tried something like this: But I get this error: Cannot implicitly convert type Hex to TAm I on the right lines here using T? Trying to understand how to use it properly. <code>  public static T GridPosition <T>(IReSizeableGrid gridData) { if (gridData is Hex) { var hexGrid = (HexGrid) gridData; return HexLibrary.WorldToHex(WorldPoint(Input.mousePosition, GroundPlane), hexGrid); } if (gridData is QuadGrid) { var quadGrid = (QuadGrid) gridData; return Grid.Get(WorldPoint(Input.mousePosition, GroundPlane), quadGrid); } throw new Exception(""Wrong type passed to GridPosition: "" + gridData.GetType());}",Custom return type based on input data
How to wait for a selenium frame to load before waiting for an element to load?," I'm trying to wait for Selenium to switch changing frames before waiting on another element. I.e. If I toss in a simple Thread.Sleep(1000); before the second wait it functions fine, but without that I get the following error: Is there a better way to wait for the frame context to switch finishing before waiting for an element within that frame to be populated? <code>  var wait = new WebDriverWait(driver, 15);wait.Until(ExpectedConditions.FrameToBeAvailableAndSwitchToIt(By.Id(""frameA""));var wait2 = new WebDriverWait(driver, 15);// wait for element within frameA to existwait2.Until(ExpectedConditions.ElementExists(By.Id(""elementA""))); 'unknown error: unhandled inspector error: {""code"":-32000,""message"":""Cannot find context with specified id""} enter code here",How to wait for a frame to load before locating an element?
c# WriteAllBytes ignores character encding," I'm using the following code: Which should in theory write a UTF8 file, but I just get an ANSI file. I also tried this just to be especially verbose; Still the same issue though.I am testing the outputted files by loading in TextPad which reads the format correctly (I tested with a sample file as I know these things can be a bit weird sometimes) <code>  File.WriteAllBytes(""c:\\test.xml"", Encoding.UTF8.GetBytes(""THIS IS A TEST"")) File.WriteAllBytes(""c:\\test.xml"", ASCIIEncoding.Convert(ASCIIEncoding.ASCII, UTF8Encoding.UTF8, Encoding.UTF8.GetBytes(""THIS IS A TEST"")))",C# WriteAllBytes ignores character encoding
ASP.NET Boilerplate UpdateAsync Error," I made a test with code below to update the Product: But it throws an exception: Mvc.ExceptionHandling.AbpExceptionFilter - The instance of entity type 'Product' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached.This is caused by querying existing. Is there any solution for this? <code>  var existing = await _productRepository.FirstOrDefaultAsync(c => c.Id == input.Id);if (existing == null) throw new UserFriendlyException(L(""ProductNotExist""));var updatedEntity = ObjectMapper.Map<Product>(input);var entity = await _productRepository.UpdateAsync(updatedEntity);",The instance of entity type 'Product' cannot be tracked because another instance with the same key value is already being tracked
Cannot add reference to Outlook 2016 Interop (16.0.0.0)," I'm trying to add a reference to 'Microsoft Outlook 16.0 Object Library' in a C# .NET 4.6.1 WPF project, because I have office 2016 installed. Previous versions of the Object Library are incompatible with the 2016 version of office.If I use Excel's VBA editor, 'Microsoft Outlook 16.0 Object Library' is listed, and exists in C:\Program Files\WindowsApps\Microsoft.Office.Desktop_16010.9126.2116.0_x86_8wekyb3d8bbwe\VFS\ProgramFilesCommonX86\Microsoft Shared\OFFICE16\MSOUTL.OLB, as you can see below:However, when I use Visual Studio, the COM tab does not list 'Microsoft Office 16.0 Object Library', and when I try to browse to C:\Program Files\WindowsApps, i get 'You dont currently have permission to access this folder', and clicking 'Continue' (to get access) results in 'You have been denied permission to access this folder'.So basically, the Office 2016 dlls seem to have been tucked away in a folder that is inaccessible to man, dog, and local administrator.All I'm trying to do is connect to the open Outlook application, and then send an email with an attachment, so perhaps another question to ask is, is there some new fangled way to communicate with Outlook 2016 that hasn't cropped up in my Googleathon?Also worth noting is that my version of office is installed as a 'Windows Store Application' and therefore does not appear on the usual Add/Remove programs list, so I can't find any 'repair' options for the installation.Thanks.Further investigation reveals that I am doing the right thing - trying to add a COM reference to 'Microsoft Outlook 16.0 Object Library' is now the correct way to target Outlook ... https://stackoverflow.com/a/21018418/5040941.I've checked the GAC, and the assemblies aren't registered. I've done a repair via the 'Apps and Features' right-click start menu option, and they still aren't appearing - it's as if the Windows Store apps just shove their dlls into the Program Files\WindowsApps\* folder, and don't bother to register them in the GAC.In answer to the much appreciated comments!Using the following code If I use the nuget Microsoft.Office.Interop.Outlook package, i get a System.Runtime.InteropServices.COMException: 'Invalid class string (Exception from HRESULT: 0x800401F3 (CO_E_CLASSSTRING))' exception.If I try using Microsoft Outlook 15.0 Object Library or Microsoft Outlook 14.0 Object Library references via the Assemblies/Extensions tab of Add Reference, I get a System.Runtime.InteropServices.COMException: 'Invalid class string (Exception from HRESULT: 0x800401F3 (CO_E_CLASSSTRING))' exception.I don't think accessing the WindowsApps folder is the way to go.Firstly, it's locked down for some reason which typically indicates the potential for trouble if i start digging around and changing security permissions, not to mention the fact that maintaining a copy of the latest dll in my solution will undoubtedly add unnecessary complexity to my project.Secondly, but more importantly, if I have office installed, and I can access 'Microsoft Outlook 16.0 Object Library' from Excel Vba, then why can't I access it from Visual Studio?There is obviously some issue with the installation not registering the dlls properly, only Excel has some trick it uses to make the reference available anyway.Has anyone reading this managed to install Office 365/2016 Windows Store and found a reference to 'Microsoft Outlook 16.0 Object Library' in Visual Studio?Am I the only with this problem?! Because it affects multiple computers in my office running Windows 10 and Office 365 ...In answer to RogerN (thanks), please see the image below - I don't have Microsoft.Office.Interop.Outlook version 16 listed, and Microsoft.Office.Core isn't listed either.If I try to use the v15 library, I get the following error:System.Runtime.InteropServices.COMException HResult=0x80040154 Message=Retrieving the COM class factory for component with CLSID {0006F03A-0000-0000-C000-000000000046} failed due to the following error: 80040154 Class not registered (Exception from HRESULT: 0x80040154 (REGDB_E_CLASSNOTREG)). Source=mscorlib*AND THE ANSWER IS *The two computers I bought from Dell are 64 bit, but they come preinstalled with 32 bit, windows store versions of MS Office 2016/365.In order to fix the problem, I had to:uninstall the store app from Settings > Apps > Apps&Features > Microsoft Office Desktop Apps > Uninstalllog into portal.office.comselect install office apps, advanced, choosing the 64-bit versionQuite why Dell think we want 32 bit versions installed on 64 bit machines, or why someone from Microsoft hasn't posted a solution to this problem, is beyond my understanding, but nevertheless, RogerN was correct. Thanks to everyone for taking time out their days to help me out. <code>  Outlook.Application application = (Outlook.Application)Marshal.GetActiveObject(""Outlook.Application"");",Cannot add reference to Outlook 2016 (Office 365) Interop (16.0.0.0)
Automapper in xUnit testing and .Net core 2.0," I have .NET Core 2.0 Project which contains Repository pattern and xUnit testing.Now, here is some of it's code.Controller: My Test Class: Issue I Am facing.My Issue is that when I run this code with database context and execute Get() method, it works fine, it gives me all results.But when I tries to run test case, it's not returning any data of Dto object.When I debugged I found thatI am getting my test object in controller using mockRepo.But it looks like Auto mapper is not initialized correctly, because while mapping it's not returning anything invar result = mapper.Map<IEnumerable<Schedule>, IEnumerable<ScheduleDto>>(source: repository.items);What I tried So Far?I followed all this answers but still it's not working.Mocking Mapper.Map() in Unit TestingHow to Mock a list transformation using AutoMapperSo, I need help from someone who is good in xUnit and automapper, and need guidance on how to initialize mock Mapper correctly. <code>  public class SchedulesController : Controller{ private readonly IScheduleRepository repository; private readonly IMapper mapper; public SchedulesController(IScheduleRepository repository, IMapper mapper) { this.repository = repository; this.mapper = mapper; } [HttpGet] public IActionResult Get() { var result = mapper.Map<IEnumerable<Schedule>, IEnumerable<ScheduleDto>>(source: repository.items); return new OkObjectResult(result); }} public class SchedulesControllerTests{ [Fact] public void CanGet() { try { //Arrange Mock<IScheduleRepository> mockRepo = new Mock<IScheduleRepository>(); mockRepo.Setup(m => m.items).Returns(new Schedule[] { new Schedule() { Id=1, Title = ""Schedule1"" }, new Schedule() { Id=2, Title = ""Schedule2"" }, new Schedule() { Id=3, Title = ""Schedule3"" } }); var mockMapper = new Mock<IMapper>(); mockMapper.Setup(x => x.Map<Schedule>(It.IsAny<ScheduleDto>())) .Returns((ScheduleDto source) => new Schedule() { Title = source.Title }); SchedulesController controller = new SchedulesController(repository: mockRepo.Object, mapper: mockMapper.Object); //Act var result = controller.Get(); //Assert var okResult = result as OkObjectResult; Assert.NotNull(okResult); var model = okResult.Value as IEnumerable<ScheduleDto>; Assert.NotNull(model); } catch (Exception ex) { //Assert Assert.False(false, ex.Message); } }}",Automapper in xUnit testing and .NET Core 2.0
Mocking HttpResponse WriteAsync using xUnit and Moq," I'm trying to get a call to WriteAsync mocked on a mockHttpResponse and I can't figure out the syntax to use. The test bombs with the following error: System.NotSupportedException : Invalid setup on an extension method: x => x.WriteAsync(It.IsAny(), It.IsAny())Ultimately I want to verify the correct string has been written to the response.How to correctly set this up? <code>  var responseMock = new Mock<HttpResponse>();responseMock.Setup(x => x.WriteAsync(It.IsAny<string>(), It.IsAny<CancellationToken>()));ctx.Setup(x => x.Response).Returns(responseMock.Object);",Mocking HttpResponse WriteAsync
webapi method return json data, I am using ASP.net web API 2.0 and would like my method to return the data in JSON format only.Please suggest the code changes for this below method from the API controller class. <code>  public async Task<List<Partner>> GetPartnerList(){ return await _context.Partners.Take(100).ToListAsync();},Web API method return JSON data
How do you update sub-document," I am new to Cosmos Db and want to understand how to delete/upsert sub-documents within a document collection.If i have a document:{ ""Id"": ""1234"", ""Name"": ""foo"", ""Items"": [ { ""Id"": ""abcd"", ""Age"": 35, ""Claims"": [ { ""Name"": ""email"", ""Value"": ""foo@bar.com"" } ] } ]}How do i:1) add an item to the Items list in the document.2) delete the existing Item from the Items list3) upsert item to the items list in the document4) add/delete a claim value to existing item in items list?Thanks in advance.  <code> ",How do you update sub-document in cosmos db
"How C# convert primitive type value to enum value, when enum contains elements with the same values?"," I wrote the code : and I expect to see in ouput :only short names or only long names or names that occur first, after sorting in alphabetical order, which in this case coincides with ""only short names"".But I did not expect to see what the program showed up : Short name at the end of the output. Why ?I tried to rearrange columns in enum : and again I got a surprise in the output : Why ?Please, explain to me what's going on here. <code>  enum FlipRotate2dEnum : byte { NO = 0, None = 0, R2 = 1, RotateTwice = 1, FX = 2, FlipX = 2, FY = 3, FlipY = 3, D1 = 4, ReflectDiagonal1 = 4, D2 = 5, ReflectDiagonal2 = 5, RC = 6, RotateClockwise = 6, RN = 7, RotateNonClockwise = 7}class EnumTest { public static void Main() { for(byte i = 0; i < 8; ++i) { FlipRotate2dEnum v = (FlipRotate2dEnum)i; System.Console.WriteLine(""{0} {1}"", i, v); } }} 0 NO1 R22 FX3 FY4 D15 D26 RC7 RN 0 None1 RotateTwice2 FlipX3 FlipY4 ReflectDiagonal15 ReflectDiagonal26 RotateClockwise7 RotateNonClockwise 0 None1 RotateTwice2 FlipX3 FlipY4 ReflectDiagonal15 ReflectDiagonal26 RotateClockwise7 RN public enum FlipRotate2dEnum : byte { None = 0, NO = 0, RotateTwice = 1, R2 = 1, FlipX = 2, FX = 2, FlipY = 3, FY = 3, ReflectDiagonal1 = 4, D1 = 4, ReflectDiagonal2 = 5, D2 = 5, RotateClockwise = 6, RC = 6, RotateNonClockwise = 7, RN = 7}class EnumTest { public static void Main() { for(byte i = 0; i < 8; ++i) { FlipRotate2dEnum v = (FlipRotate2dEnum)i; System.Console.WriteLine(""{0} {1}"", i, v); } }} 0 NO1 R22 FX3 FY4 D15 D26 RC7 RotateNonClockwise","How to convert primitive type value to enum value, when enum contains elements with the same values?"
Why is a generic type constrained by 'Enum' failing to qualify as a 'struct'?," If I have a generic interface with a struct constraint like this: I can supply an enumeration as my type T like so, because an enum satisfies a struct constraint: C# 7.3 added an Enum constraint. The following code, which was previously illegal, now compiles: However, to my surprise, the following fails to compile: ...with the error CS0453 The type 'T' must be a non-nullable value type in order to use it as parameter 'T' in the generic type or method 'IStruct'Why is this? I would expect a generic type constrained by Enum to be usable as a type argument where the type is constrained by struct but this doesn't seem to be the case - I am having to change my Enum constraint to struct, Enum. Is my expectation wrong? <code>  public interface IStruct<T> where T : struct { } public class EnumIsAStruct : IStruct<DateTimeKind> { } public class MCVE<T> : IStruct<T> where T : struct, Enum { } public class MCVE<T> : IStruct<T> where T : Enum { }",Why is a generic type constrained by 'Enum' failing to qualify as a 'struct' in C# 7.3?
ASP.NET Core 2.1: Seeding roles," I've created a test project using: This creates a Startup.cs that contains: I want to seed some users and roles. Both users and roles will use the same store (SQLite). I'm using a static class for seeding which it's called from Program.I can seed users, but not roles, since the above does not seem to inject a RoleManager.In ASP.NET Core 2.0 the following is used: I'm guessing AddDefaultIdentity is new in 2.1 but the problem is that it does not inject a RoleMnager, so what should I do? <code>  dotnet new razor --auth Individual --output Test public void ConfigureServices(IServiceCollection services){ services.Configure<CookiePolicyOptions>(options => { // This lambda determines whether user consent for non-essential cookies is needed for a given request. options.CheckConsentNeeded = context => true; options.MinimumSameSitePolicy = SameSiteMode.None; }); services.AddDbContext<ApplicationDbContext>(options => options.UseSqlite( Configuration.GetConnectionString(""DefaultConnection""))); services.AddDefaultIdentity<IdentityUser>() .AddEntityFrameworkStores<ApplicationDbContext>(); services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1);} services.AddIdentity<IdentityUser, IdentityRole>()",How to use Roles in ASP.NET Core 2.1?
Winforms tree view checking/unchecking," The following code is intended to recursively check or un-check parent or child nodes as required.For instance, at this position, A, G, L, and T nodes must be unchecked if we un-check any one of them.The problem with the following code is, whenever I double-click any node the algorithm fails to achieve its purpose.The tree-searching algorithm starts here: Driver Program Expected to happen:Take a look at the screenshot of the application. A, G, L, and T are checked. If I uncheck, say, L, - T should be unchecked as T is a child of L. - G and A should be unchecked as they will have no children left.What is happening:This application code works fine if I single-click any node. If I double-click a node, that node becomes checked/unchecked but the same change is not reflected on the parent and children. Double-click also freezes the application for a while.How can I fix this issue and obtain the expected behavior? <code>  // stack is used to traverse the tree iteratively. Stack<TreeNode> stack = new Stack<TreeNode>(); private void treeView1_AfterCheck(object sender, TreeViewEventArgs e) { TreeNode selectedNode = e.Node; bool checkedStatus = e.Node.Checked; // suppress repeated even firing treeView1.AfterCheck -= treeView1_AfterCheck; // traverse children stack.Push(selectedNode); while(stack.Count > 0) { TreeNode node = stack.Pop(); node.Checked = checkedStatus; System.Console.Write(node.Text + "", ""); if (node.Nodes.Count > 0) { ICollection tnc = node.Nodes; foreach (TreeNode n in tnc) { stack.Push(n); } } } //traverse parent while(selectedNode.Parent!=null) { TreeNode node = selectedNode.Parent; node.Checked = checkedStatus; selectedNode = selectedNode.Parent; } // ""suppress repeated even firing"" ends here treeView1.AfterCheck += treeView1_AfterCheck; string str = string.Empty; } using System;using System.Collections.Generic;using System.ComponentModel;using System.Drawing;using System.Windows.Forms;namespace WindowsFormsApplication1{ public partial class Form1 : Form { public Form1() { InitializeComponent(); } #region MyRegion private void button1_Click(object sender, EventArgs e) { TreeNode a = new TreeNode(""A""); TreeNode b = new TreeNode(""B""); TreeNode c = new TreeNode(""C""); TreeNode d = new TreeNode(""D""); TreeNode g = new TreeNode(""G""); TreeNode h = new TreeNode(""H""); TreeNode i = new TreeNode(""I""); TreeNode j = new TreeNode(""J""); TreeNode k = new TreeNode(""K""); TreeNode l = new TreeNode(""L""); TreeNode m = new TreeNode(""M""); TreeNode n = new TreeNode(""N""); TreeNode o = new TreeNode(""O""); TreeNode p = new TreeNode(""P""); TreeNode q = new TreeNode(""Q""); TreeNode r = new TreeNode(""R""); TreeNode s = new TreeNode(""S""); TreeNode t = new TreeNode(""T""); TreeNode u = new TreeNode(""U""); TreeNode v = new TreeNode(""V""); TreeNode w = new TreeNode(""W""); TreeNode x = new TreeNode(""X""); TreeNode y = new TreeNode(""Y""); TreeNode z = new TreeNode(""Z""); k.Nodes.Add(x); k.Nodes.Add(y); l.Nodes.Add(s); l.Nodes.Add(t); l.Nodes.Add(u); n.Nodes.Add(o); n.Nodes.Add(p); n.Nodes.Add(q); n.Nodes.Add(r); g.Nodes.Add(k); g.Nodes.Add(l); i.Nodes.Add(m); i.Nodes.Add(n); j.Nodes.Add(b); j.Nodes.Add(c); j.Nodes.Add(d); a.Nodes.Add(g); a.Nodes.Add(h); a.Nodes.Add(i); a.Nodes.Add(j); treeView1.Nodes.Add(a); treeView1.ExpandAll(); button1.Enabled = false; } #endregion",WinForms TreeView checking/unchecking hierarchy
.Net Core dependency injection register two implementations then get one of them," I have parts of my code which depend on more than one implementation of the same interface, and other parts which depend on one of the implementations.I am registering implementations like: Then getting both implementations when needed like: My Issue is when I need one of them, I am trying the following which returns null: Of course I could use: But I am thinking that I can get my FirstImplementation directly somehow. <code>  services.AddSingleton<MyInterface, FirstImplementation>();services.AddSingleton<MyInterface, SecondImplementation>(); var implementations= serviceProvider.GetServices<MyInterface>(); var firstImplementation= serviceProvider.GetService<FirstImplementation>(); var implementations= serviceProvider.GetServices<MyInterface>();foreach (var implementation in implementations){ if (typeof(FirstImplementation) == implementation.GetType()) { FirstImplementation firstImplementation = (FirstImplementation)implementation; }}",How to register two implementations then get one in .Net Core dependency injection
.Net Core dependency injection register two implementations then get one," I have parts of my code which depend on more than one implementation of the same interface, and other parts which depend on one of the implementations.I am registering implementations like: Then getting both implementations when needed like: My Issue is when I need one of them, I am trying the following which returns null: Of course I could use: But I am thinking that I can get my FirstImplementation directly somehow. <code>  services.AddSingleton<MyInterface, FirstImplementation>();services.AddSingleton<MyInterface, SecondImplementation>(); var implementations= serviceProvider.GetServices<MyInterface>(); var firstImplementation= serviceProvider.GetService<FirstImplementation>(); var implementations= serviceProvider.GetServices<MyInterface>();foreach (var implementation in implementations){ if (typeof(FirstImplementation) == implementation.GetType()) { FirstImplementation firstImplementation = (FirstImplementation)implementation; }}",How to register two implementations then get one in .Net Core dependency injection
Call MongoDB query directly in .Net," I have the following MongoDb query working: This retrieves a list of objects joined with a matching object from another collection.Does anybody know how I can use this in C# using either LINQ or by using this exact string?I tried using the following code but it can't seem to find the types for QueryDocument and MongoCursor - I think they've been deprecated? <code>  db.Entity.aggregate( [ { ""$match"":{""Id"": ""12345""} }, { ""$lookup"": { ""from"": ""OtherCollection"", ""localField"": ""otherCollectionId"", ""foreignField"": ""Id"", ""as"": ""ent"" } }, { ""$project"": { ""Name"": 1, ""Date"": 1, ""OtherObject"": { ""$arrayElemAt"": [ ""$ent"", 0 ] } } }, { ""$sort"": { ""OtherObject.Profile.Name"": 1 } } ]) BsonDocument document = MongoDB.Bson.Serialization.BsonSerializer.Deserialize<BsonDocument>(""{ name : value }"");QueryDocument queryDoc = new QueryDocument(document);MongoCursor toReturn = _connectionCollection.Find(queryDoc);",Aggregate $lookup with C#
Is there a way to connect to a MySQL DB without ssl in C#?," I'm trying to connect to a local MySQL DB. I have this connector: But I get this Exception: MySql.Data.MySqlClient.MySqlException (0x80004005): The host 127.0.0.1 does not support SSL connections.It seems that it cannot connect to the DB because the DB doesn't support SSL. So is there a way how to connect to the DB whithout SSL? <code>  using(MySqlConnection conn = new MySqlConnection(""Database=Studentenverwaltung;Port=3306;Data Source=127.0.0.1;User Id=root;Password=abc123"")) { try { conn.Open(); Console.WriteLine(""Opened!""); conn.Close(); } catch(Exception e) { Console.WriteLine(""Cannot open Connection""); Console.WriteLine(e.ToString()); }}",How to connect to a MySQL Database without SSL
Is there a way to connect to a MySQL database without ssl?," I'm trying to connect to a local MySQL DB. I have this connector: But I get this Exception: MySql.Data.MySqlClient.MySqlException (0x80004005): The host 127.0.0.1 does not support SSL connections.It seems that it cannot connect to the DB because the DB doesn't support SSL. So is there a way how to connect to the DB whithout SSL? <code>  using(MySqlConnection conn = new MySqlConnection(""Database=Studentenverwaltung;Port=3306;Data Source=127.0.0.1;User Id=root;Password=abc123"")) { try { conn.Open(); Console.WriteLine(""Opened!""); conn.Close(); } catch(Exception e) { Console.WriteLine(""Cannot open Connection""); Console.WriteLine(e.ToString()); }}",How to connect to a MySQL Database without SSL
Testing a unit test," I am creating an extension method that performs a test on an object to see if it has a specific custom attribute. I want to create a unit test for my extension method. How can I assert that the test in the extension method should fail? Basically, the ShouldValidateTheseFields does reflection and asserts that it should have a custom attribute on the field named ""Field"" and I need to assert that it failed. <code>  [Test]public void ShouldFailIfEmailAttributeMissingFromFieldName(){ //--Arrange var model = new { Field = 1 }; //--Act model.ShouldValidateTheseFields(new List<FieldValidation> { new EmailAddressFieldValidation { ErrorId = 1, ErrorMessage = ""Message"", FieldName = nameof(model.Field) } }); //--Assert}",Asserting that a system under test should throw an assertion exception
Asserting that a system under test should throw an exception," I am creating an extension method that performs a test on an object to see if it has a specific custom attribute. I want to create a unit test for my extension method. How can I assert that the test in the extension method should fail? Basically, the ShouldValidateTheseFields does reflection and asserts that it should have a custom attribute on the field named ""Field"" and I need to assert that it failed. <code>  [Test]public void ShouldFailIfEmailAttributeMissingFromFieldName(){ //--Arrange var model = new { Field = 1 }; //--Act model.ShouldValidateTheseFields(new List<FieldValidation> { new EmailAddressFieldValidation { ErrorId = 1, ErrorMessage = ""Message"", FieldName = nameof(model.Field) } }); //--Assert}",Asserting that a system under test should throw an assertion exception
User control with part of should behave as a container," I wrote User Control (yay!). But I want it to behave as a container. But wait! I know about Trick. The problem is - I don't want all of my control to behave like container, but only one part. One - de facto - panel ;) To give wider context: I wrote a control that has Grid, some common buttons, labels and functionalities. But it also has a part where the user is supposed to drop his custom buttons/controls whatever. Only in this particular part of the control, nowhere else. Anyone had any idea?  <code>  [Designer(""System.Windows.Forms.Design.ParentControlDesigner, System.Design"", typeof(IDesigner))]",UserControl with header and content - Allow dropping controls in content panel and Prevent dropping controls in header at design time
.NET Core 2.0 project error: 'The type or namespace name 'Hosting' does not exist in the namespace 'Microsoft.AspNetCore.Razor'," I've created a project using the Visual Studio .NET Core 2.1 SDK + React Template.I'm met with the following error when running the project: One or more compilation references are missing. Ensure that your project is referencing 'Microsoft.NET.Sdk.Web' and the 'PreserveCompilationContext' property is not set to false. The type or namespace name 'Hosting' does not exist in the namespace 'Microsoft.AspNetCore.Razor' (are you missing an assembly reference?)I've done what research I could and have tried the following to no avail:dotnet restore in Package Manager ConsoleDeleting my bin and obj foldersOpening _ViewImports.cshtml and adding a @using for every namespace in my solutionIf I modify the HomeController Index() from returning the View() to instead [HttpGet] public string Index() => ""Hello World!"";, the text is returned without any error.Index.cshtml HomeController.cs <code>  @{ ViewData[""Title""] = ""Home Page"";}<div id=""react-app"">Loading...</div>@section scripts { <script src=""~/dist/main.js"" asp-append-version=""true""></script>} using System.Diagnostics;using Microsoft.AspNetCore.Mvc;namespace sample_project.Controllers{ public class HomeController : Controller { public IActionResult Index() { return View(); } public IActionResult Error() { ViewData[""RequestId""] = Activity.Current?.Id ?? HttpContext.TraceIdentifier; return View(); } }}",The type or namespace name 'Hosting' does not exist in the namespace 'Microsoft.AspNetCore.Razor'
'The type or namespace name 'Hosting' does not exist in the namespace 'Microsoft.AspNetCore.Razor'," I've created a project using the Visual Studio .NET Core 2.1 SDK + React Template.I'm met with the following error when running the project: One or more compilation references are missing. Ensure that your project is referencing 'Microsoft.NET.Sdk.Web' and the 'PreserveCompilationContext' property is not set to false. The type or namespace name 'Hosting' does not exist in the namespace 'Microsoft.AspNetCore.Razor' (are you missing an assembly reference?)I've done what research I could and have tried the following to no avail:dotnet restore in Package Manager ConsoleDeleting my bin and obj foldersOpening _ViewImports.cshtml and adding a @using for every namespace in my solutionIf I modify the HomeController Index() from returning the View() to instead [HttpGet] public string Index() => ""Hello World!"";, the text is returned without any error.Index.cshtml HomeController.cs <code>  @{ ViewData[""Title""] = ""Home Page"";}<div id=""react-app"">Loading...</div>@section scripts { <script src=""~/dist/main.js"" asp-append-version=""true""></script>} using System.Diagnostics;using Microsoft.AspNetCore.Mvc;namespace sample_project.Controllers{ public class HomeController : Controller { public IActionResult Index() { return View(); } public IActionResult Error() { ViewData[""RequestId""] = Activity.Current?.Id ?? HttpContext.TraceIdentifier; return View(); } }}",The type or namespace name 'Hosting' does not exist in the namespace 'Microsoft.AspNetCore.Razor'
The type or namespace name 'Hosting' does not exist in the namespace 'Microsoft.AspNetCore.Razor," I've created a project using the Visual Studio .NET Core 2.1 SDK + React Template.I'm met with the following error when running the project: One or more compilation references are missing. Ensure that your project is referencing 'Microsoft.NET.Sdk.Web' and the 'PreserveCompilationContext' property is not set to false. The type or namespace name 'Hosting' does not exist in the namespace 'Microsoft.AspNetCore.Razor' (are you missing an assembly reference?)I've done what research I could and have tried the following to no avail:dotnet restore in Package Manager ConsoleDeleting my bin and obj foldersOpening _ViewImports.cshtml and adding a @using for every namespace in my solutionIf I modify the HomeController Index() from returning the View() to instead [HttpGet] public string Index() => ""Hello World!"";, the text is returned without any error.Index.cshtml HomeController.cs <code>  @{ ViewData[""Title""] = ""Home Page"";}<div id=""react-app"">Loading...</div>@section scripts { <script src=""~/dist/main.js"" asp-append-version=""true""></script>} using System.Diagnostics;using Microsoft.AspNetCore.Mvc;namespace sample_project.Controllers{ public class HomeController : Controller { public IActionResult Index() { return View(); } public IActionResult Error() { ViewData[""RequestId""] = Activity.Current?.Id ?? HttpContext.TraceIdentifier; return View(); } }}",The type or namespace name 'Hosting' does not exist in the namespace 'Microsoft.AspNetCore.Razor'
"C# Struct Performance - Why casting via Pointer is slow, while Unsafe.As is fast?"," BackgroundI wanted to make a few integer-sized structs (i.e. 32 and 64 bits) that are easily convertible to/from primitive unmanaged types of the same size (i.e. Int32 and UInt32 for 32-bit-sized struct in particular).The structs would then expose additional functionality for bit manipulation / indexing that is not available on integer types directly. Basically, as a sort of syntactic sugar, improving readability and ease of use.The important part, however, was performance, in that there should essentially be 0 cost for this extra abstraction (at the end of the day the CPU should ""see"" the same bits as if it was dealing with primitive ints).Sample StructBelow is just the very basic struct I came up with. It does not have all the functionality, but enough to illustrate my questions: The TestI wanted to test the performance of this struct. In particular I wanted to see if it could let me get the individual bytes just as quickly if I were to use regular bitwise arithmetic: (i >> 8) & 0xFF (to get the 3rd byte for example).Below you will see a benchmark I came up with: The Byte1(), Byte2(), Byte3(), and Byte4() are just the extension methods that do get inlined and simply get the n-th byte by doing bitwise operations and casting: EDIT: Fixed the code to make sure variables are actually used. Also commented out 3 of 4 variables to really test struct casting / member access rather than actually using the variables.The ResultsI ran these in the Release build with optimizations on x64. EDIT: New results after fixing the code: QuestionsThe benchmark results were surprising for me, and that's why I have a few questions:EDIT: Fewer questions remain after altering the code so that the variables actually get used.Why is the pointer stuff so slow?Why is the cast taking twice as long as the baseline case? Aren't implicit/explicit operators inlined?How come the new System.Runtime.CompilerServices.Unsafe package (v. 4.5.0) is so fast? I thought it would at least involve a method call...More generally, how can I make essentially a zero-cost struct that would simply act as a ""window"" onto some memory or a biggish primitive type like UInt64 so that I can more effectively manipulate / read that memory? What's the best practice here? <code>  [StructLayout(LayoutKind.Explicit, Pack = 1, Size = 4)]public struct Mask32 { [FieldOffset(3)] public byte Byte1; [FieldOffset(2)] public ushort UShort1; [FieldOffset(2)] public byte Byte2; [FieldOffset(1)] public byte Byte3; [FieldOffset(0)] public ushort UShort2; [FieldOffset(0)] public byte Byte4; [DebuggerStepThrough, MethodImpl(MethodImplOptions.AggressiveInlining)] public static unsafe implicit operator Mask32(int i) => *(Mask32*)&i; [DebuggerStepThrough, MethodImpl(MethodImplOptions.AggressiveInlining)] public static unsafe implicit operator Mask32(uint i) => *(Mask32*)&i;} public unsafe class MyBenchmark { const int count = 50000; [Benchmark(Baseline = true)] public static void Direct() { var j = 0; for (int i = 0; i < count; i++) { //var b1 = i.Byte1(); //var b2 = i.Byte2(); var b3 = i.Byte3(); //var b4 = i.Byte4(); j += b3; } } [Benchmark] public static void ViaStructPointer() { var j = 0; int i = 0; var s = (Mask32*)&i; for (; i < count; i++) { //var b1 = s->Byte1; //var b2 = s->Byte2; var b3 = s->Byte3; //var b4 = s->Byte4; j += b3; } } [Benchmark] public static void ViaStructPointer2() { var j = 0; int i = 0; for (; i < count; i++) { var s = *(Mask32*)&i; //var b1 = s.Byte1; //var b2 = s.Byte2; var b3 = s.Byte3; //var b4 = s.Byte4; j += b3; } } [Benchmark] public static void ViaStructCast() { var j = 0; for (int i = 0; i < count; i++) { Mask32 m = i; //var b1 = m.Byte1; //var b2 = m.Byte2; var b3 = m.Byte3; //var b4 = m.Byte4; j += b3; } } [Benchmark] public static void ViaUnsafeAs() { var j = 0; for (int i = 0; i < count; i++) { var m = Unsafe.As<int, Mask32>(ref i); //var b1 = m.Byte1; //var b2 = m.Byte2; var b3 = m.Byte3; //var b4 = m.Byte4; j += b3; } }} [DebuggerStepThrough, MethodImpl(MethodImplOptions.AggressiveInlining)]public static byte Byte1(this int it) => (byte)(it >> 24);[DebuggerStepThrough, MethodImpl(MethodImplOptions.AggressiveInlining)]public static byte Byte2(this int it) => (byte)((it >> 16) & 0xFF);[DebuggerStepThrough, MethodImpl(MethodImplOptions.AggressiveInlining)]public static byte Byte3(this int it) => (byte)((it >> 8) & 0xFF);[DebuggerStepThrough, MethodImpl(MethodImplOptions.AggressiveInlining)]public static byte Byte4(this int it) => (byte)it; Intel Core i7-3770K CPU 3.50GHz (Ivy Bridge), 1 CPU, 8 logical cores and 4 physical coresFrequency=3410223 Hz, Resolution=293.2360 ns, Timer=TSC [Host] : .NET Framework 4.6.1 (CLR 4.0.30319.42000), 64bit RyuJIT-v4.6.1086.0 DefaultJob : .NET Framework 4.6.1 (CLR 4.0.30319.42000), 64bit RyuJIT-v4.6.1086.0 Method | Mean | Error | StdDev | Scaled | ScaledSD |------------------ |----------:|----------:|----------:|-------:|---------:| Direct | 14.47 us | 0.3314 us | 0.2938 us | 1.00 | 0.00 | ViaStructPointer | 111.32 us | 0.6481 us | 0.6062 us | 7.70 | 0.15 | ViaStructPointer2 | 102.31 us | 0.7632 us | 0.7139 us | 7.07 | 0.14 | ViaStructCast | 29.00 us | 0.3159 us | 0.2800 us | 2.01 | 0.04 | ViaUnsafeAs | 14.32 us | 0.0955 us | 0.0894 us | 0.99 | 0.02 | Method | Mean | Error | StdDev | Scaled | ScaledSD |------------------ |----------:|----------:|----------:|-------:|---------:| Direct | 57.51 us | 1.1070 us | 1.0355 us | 1.00 | 0.00 | ViaStructPointer | 203.20 us | 3.9830 us | 3.5308 us | 3.53 | 0.08 | ViaStructPointer2 | 198.08 us | 1.8411 us | 1.6321 us | 3.45 | 0.06 | ViaStructCast | 79.68 us | 1.5478 us | 1.7824 us | 1.39 | 0.04 | ViaUnsafeAs | 57.01 us | 0.8266 us | 0.6902 us | 0.99 | 0.02 |","Why is casting a struct via Pointer slow, while Unsafe.As is fast?"
"Why casting a struct via Pointer is slow, while Unsafe.As is fast?"," BackgroundI wanted to make a few integer-sized structs (i.e. 32 and 64 bits) that are easily convertible to/from primitive unmanaged types of the same size (i.e. Int32 and UInt32 for 32-bit-sized struct in particular).The structs would then expose additional functionality for bit manipulation / indexing that is not available on integer types directly. Basically, as a sort of syntactic sugar, improving readability and ease of use.The important part, however, was performance, in that there should essentially be 0 cost for this extra abstraction (at the end of the day the CPU should ""see"" the same bits as if it was dealing with primitive ints).Sample StructBelow is just the very basic struct I came up with. It does not have all the functionality, but enough to illustrate my questions: The TestI wanted to test the performance of this struct. In particular I wanted to see if it could let me get the individual bytes just as quickly if I were to use regular bitwise arithmetic: (i >> 8) & 0xFF (to get the 3rd byte for example).Below you will see a benchmark I came up with: The Byte1(), Byte2(), Byte3(), and Byte4() are just the extension methods that do get inlined and simply get the n-th byte by doing bitwise operations and casting: EDIT: Fixed the code to make sure variables are actually used. Also commented out 3 of 4 variables to really test struct casting / member access rather than actually using the variables.The ResultsI ran these in the Release build with optimizations on x64. EDIT: New results after fixing the code: QuestionsThe benchmark results were surprising for me, and that's why I have a few questions:EDIT: Fewer questions remain after altering the code so that the variables actually get used.Why is the pointer stuff so slow?Why is the cast taking twice as long as the baseline case? Aren't implicit/explicit operators inlined?How come the new System.Runtime.CompilerServices.Unsafe package (v. 4.5.0) is so fast? I thought it would at least involve a method call...More generally, how can I make essentially a zero-cost struct that would simply act as a ""window"" onto some memory or a biggish primitive type like UInt64 so that I can more effectively manipulate / read that memory? What's the best practice here? <code>  [StructLayout(LayoutKind.Explicit, Pack = 1, Size = 4)]public struct Mask32 { [FieldOffset(3)] public byte Byte1; [FieldOffset(2)] public ushort UShort1; [FieldOffset(2)] public byte Byte2; [FieldOffset(1)] public byte Byte3; [FieldOffset(0)] public ushort UShort2; [FieldOffset(0)] public byte Byte4; [DebuggerStepThrough, MethodImpl(MethodImplOptions.AggressiveInlining)] public static unsafe implicit operator Mask32(int i) => *(Mask32*)&i; [DebuggerStepThrough, MethodImpl(MethodImplOptions.AggressiveInlining)] public static unsafe implicit operator Mask32(uint i) => *(Mask32*)&i;} public unsafe class MyBenchmark { const int count = 50000; [Benchmark(Baseline = true)] public static void Direct() { var j = 0; for (int i = 0; i < count; i++) { //var b1 = i.Byte1(); //var b2 = i.Byte2(); var b3 = i.Byte3(); //var b4 = i.Byte4(); j += b3; } } [Benchmark] public static void ViaStructPointer() { var j = 0; int i = 0; var s = (Mask32*)&i; for (; i < count; i++) { //var b1 = s->Byte1; //var b2 = s->Byte2; var b3 = s->Byte3; //var b4 = s->Byte4; j += b3; } } [Benchmark] public static void ViaStructPointer2() { var j = 0; int i = 0; for (; i < count; i++) { var s = *(Mask32*)&i; //var b1 = s.Byte1; //var b2 = s.Byte2; var b3 = s.Byte3; //var b4 = s.Byte4; j += b3; } } [Benchmark] public static void ViaStructCast() { var j = 0; for (int i = 0; i < count; i++) { Mask32 m = i; //var b1 = m.Byte1; //var b2 = m.Byte2; var b3 = m.Byte3; //var b4 = m.Byte4; j += b3; } } [Benchmark] public static void ViaUnsafeAs() { var j = 0; for (int i = 0; i < count; i++) { var m = Unsafe.As<int, Mask32>(ref i); //var b1 = m.Byte1; //var b2 = m.Byte2; var b3 = m.Byte3; //var b4 = m.Byte4; j += b3; } }} [DebuggerStepThrough, MethodImpl(MethodImplOptions.AggressiveInlining)]public static byte Byte1(this int it) => (byte)(it >> 24);[DebuggerStepThrough, MethodImpl(MethodImplOptions.AggressiveInlining)]public static byte Byte2(this int it) => (byte)((it >> 16) & 0xFF);[DebuggerStepThrough, MethodImpl(MethodImplOptions.AggressiveInlining)]public static byte Byte3(this int it) => (byte)((it >> 8) & 0xFF);[DebuggerStepThrough, MethodImpl(MethodImplOptions.AggressiveInlining)]public static byte Byte4(this int it) => (byte)it; Intel Core i7-3770K CPU 3.50GHz (Ivy Bridge), 1 CPU, 8 logical cores and 4 physical coresFrequency=3410223 Hz, Resolution=293.2360 ns, Timer=TSC [Host] : .NET Framework 4.6.1 (CLR 4.0.30319.42000), 64bit RyuJIT-v4.6.1086.0 DefaultJob : .NET Framework 4.6.1 (CLR 4.0.30319.42000), 64bit RyuJIT-v4.6.1086.0 Method | Mean | Error | StdDev | Scaled | ScaledSD |------------------ |----------:|----------:|----------:|-------:|---------:| Direct | 14.47 us | 0.3314 us | 0.2938 us | 1.00 | 0.00 | ViaStructPointer | 111.32 us | 0.6481 us | 0.6062 us | 7.70 | 0.15 | ViaStructPointer2 | 102.31 us | 0.7632 us | 0.7139 us | 7.07 | 0.14 | ViaStructCast | 29.00 us | 0.3159 us | 0.2800 us | 2.01 | 0.04 | ViaUnsafeAs | 14.32 us | 0.0955 us | 0.0894 us | 0.99 | 0.02 | Method | Mean | Error | StdDev | Scaled | ScaledSD |------------------ |----------:|----------:|----------:|-------:|---------:| Direct | 57.51 us | 1.1070 us | 1.0355 us | 1.00 | 0.00 | ViaStructPointer | 203.20 us | 3.9830 us | 3.5308 us | 3.53 | 0.08 | ViaStructPointer2 | 198.08 us | 1.8411 us | 1.6321 us | 3.45 | 0.06 | ViaStructCast | 79.68 us | 1.5478 us | 1.7824 us | 1.39 | 0.04 | ViaUnsafeAs | 57.01 us | 0.8266 us | 0.6902 us | 0.99 | 0.02 |","Why is casting a struct via Pointer slow, while Unsafe.As is fast?"
how to sort the child nodes of treeView in c#.Net, I want to sort a given TreeView child nodes in alphabetical order.Suppose my tree View is like this:firstNode1secondNode1thirdNode1thirdNode2thirdNode3...firstNode2secondNode1thirdNode1thirdNode2thirdNode3...I want to sort the nodes in secondNodes of every firstNode.How can I do it? - I have red about Custom Comparer but cant understand how to use it in my case. <code> ,how to sort the child nodes of treeView
"count how many times number 14 appear in 1 to 10,000,000,000"," i tried this code but it takes so long and I can not get the result please help <code>  public long getCounter([FromBody]object req) { JObject param = Utility.GetRequestParameter(req); long input = long.Parse(param[""input""].ToString()); long counter = 0; for (long i = 14; i <= input; i++) { string s = i.ToString(); if (s.Contains(""14"")) { counter += 1; } } return counter; }",how many numbers between 1 to 10 billion contains 14
Is querying deserialized YAML in C# with a `jq`-like syntax possible?," I need to work with YAML generated by Kubernetes and I'd like to be able to read specific properties with an XPath-like or jq-like DSL notation in C#.The structure and nature of the YAML that Kubernetes generates is well-defined in most places, but in some cases is arbitrary and comes from user input, so it's not possible to define static types up front that can capture the entire structure of the YAML.The most popular solution for deserializing and reading YAML in C# seems to be YamlDotNet, but it's mostly geared towards deserializing into fully-typed objects.I'd rather not have to define a bunch of static types or do a lot of cumbersome casting just to get one or two fields or aggregate across them. My ideal approach would instead be something like: Is this possible with YamlDotNet or another similar and well-supported tool in C#?Update: I tried a number of approaches, but in the end, the one that worked best was reserializing to JSON and then querying with Json.NET, which has better support. <code>  var reader = new FileReader(""my-file.yaml"");List<string> listOfPodNames = Yaml.Deserialize(reader) .Query("".pods[*].name"") .AsList;// expected result: list of all pod names as strings","With C#, is querying YAML possible without defining lots of types?"
Asp.net mvc core RedirectToPage error - specify root relative path error," I want to redirect to a razor page from a normal controller action like this: I have already a razor page named ""Edit"" which is working when navigating to it normally:With RedirectToPage I get the following error: InvalidOperationException: The relative page path 'Edit' can only be used while executing a Razor Page. Specify a root relative path with a leading '/' to generate a URL outside of a Razor Page.Any idea how to specify that path? <code>  return RedirectToPage(""Edit"", new { id = blogId });",ASP.net MVC core RedirectToPage error - specify root relative path error
MongoDB c# driver create index, I just updated my MongoDB from version 2.5.0 to 2.7.0. Visual Studio tells me that the following way to create an index is obsolete: It suggests me to use CreateIndexModel.The only problem is that I cannot find an example to get this working that will do the same.I tried: But I get the following exception:System.FormatException: 'JSON reader was expecting a value but found 'TimestampUtc'.' <code>  protected override Task OnPerformMaintenanceAsync(CancellationToken cancellationToken) => NotificationLogs.Indexes .CreateOneAsync(Builders<NotificationLog>.IndexKeys .Ascending(_ => _.TimestampUtc)); protected Task OnPerformMaintenanceTestAsync(CancellationToken cancellationToken){ // Old approach var builder = Builders<NotificationLog>.IndexKeys .Ascending(x => x.TimestampUtc); // New approach var indexModel = new CreateIndexModel<NotificationLog>(nameof(NotificationLog.TimestampUtc)); return NotificationLogs.Indexes.CreateOneAsync(indexModel);},MongoDB C# Driver Create Index
HttpClient - How many connections," BackgroundI have to download about 16k documents and the same amount of html pages from the internet. This number will increase in the future. Currently I am just using Parallel.ForEach to download and work on the data in parallel. This however does not seem to fully utilize my resources, so I am planning to bring async/await into play, to have as many downloads running in asynchronously as possible, but I will probably have to limit that.Actual QuestionHow many open connections can a single HttpClient have? What other factors will I have to keep in mind when creating such an amount of connections? I am aware that I should reuse the same HttpClientand I have also read this answer, but I have doubts that I can really have several billion connections open at once. <code> ",How many connections in HttpClient
"Calculate Free Space on Different OS, .NET Core"," Is there a way to find free space on different OS (Mostly Linux & Windows) using C# ASP.NET Core. I found a way (using DriveInfo) to get free space by passing the Drive Name as a parameter. This is working fine on Windows, but I want the same for Linux as well. Passing the Drive (C:/) as below: Update: This also works for Linux.  <code>  public static int CheckDiskSpace(string driveLetter){ DriveInfo drive = new DriveInfo(driveLetter); var totalBytes = drive.TotalSize; var freeBytes = drive.AvailableFreeSpace; var freePercent = (int)((100 * freeBytes) / totalBytes); return freePercent;} var freespace = DriveDetails.CheckDiskSpace(""C:/"");",.Net Core Find Free Disk Space on Different OS
.Net Core Current Project Path," Is there a way to find free space on different OS (Mostly Linux & Windows) using C# ASP.NET Core. I found a way (using DriveInfo) to get free space by passing the Drive Name as a parameter. This is working fine on Windows, but I want the same for Linux as well. Passing the Drive (C:/) as below: Update: This also works for Linux.  <code>  public static int CheckDiskSpace(string driveLetter){ DriveInfo drive = new DriveInfo(driveLetter); var totalBytes = drive.TotalSize; var freeBytes = drive.AvailableFreeSpace; var freePercent = (int)((100 * freeBytes) / totalBytes); return freePercent;} var freespace = DriveDetails.CheckDiskSpace(""C:/"");",.Net Core Find Free Disk Space on Different OS
Null response returns a 204 in .NET Core 2 MVC," My controller returns a 204 when I do a GET request and I don't find any data. This is only for GET requests, POST, PUT, DELETE return a 200 empty response. This messes with my swagger definition which has a response defined for a 200 response, and I would rather be consistent.The 204 would be fine if I was serving HTML out of this controller but it is for a REST API.How do I get it to return a 200? <code>  [Route(""user/v1/[controller]"")]public class UserLoginController : Controller{ [HttpGet] public async Task<UserLogin> Get(int userId) { var userLoginLogic = new UserLoginLogic(); return await userLoginLogic.GetUserLogin(userId); }}",Null response returns a 204
How to check if statements dynamically from database," My questions as follows, I need to check conditions through the database. which means in the simple application we check if conditions like this. Suppose, Client, needs to change the condition dynamically, which means he need to add additional condition to the system like,if 31 <= age && age <= 40 => Range 31 - 40When doing this in the client side, sometimes wrong conditions can be added to the system like, (4 <= age && age <= 15) this condition cannot be added, because the system already have condition (5 <= age && age <= 10). When age is 7, both conditions will be true. like this type situations what is the best thing to do.I need to store the conditions in my database,(PS:database table structure can be changed according to your answer)as the sample table structure Please give me a solution to solve this. How can I do this with C# and oracle SQL <code>  private static void Main(string[] args){ Console.WriteLine(""Enter your age""); var age = int.Parse(Console.ReadLine() ?? throw new InvalidOperationException()); if (5 <= age && age <= 10) { Console.WriteLine(""Range 5 - 10""); }else if (11 <= age && age <= 20) { Console.WriteLine(""Range 11 - 20""); } else if (21 <= age && age <= 30) { Console.WriteLine(""Range 21 - 30""); } else { Console.WriteLine(""Over range""); }} ConditionID Condition Detailscon001 5 <= age && age <= 10 Range 5 - 10con002 11 <= age && age <= 20 Range 11 - 20con003 21 <= age && age <= 30 Range 21 - 30",How to check if statements dynamically
`PowerShell.Create()` returning null (.NET CORE MVC)," Added reference: PowerShellStandard.LibraryRepro inside a default .net-core project: I've tried it with or without the using block, but I end up with the same result: the Create method is not creating a PowerShell object, but it's also not throwing an exception.Is this a common issue with the PowerShell .net-standard library? Is there a workaround or another way to solve my problem?Additional info, this is also happening with the RunspaceFactory class CreateRunspace method as I was exploring a workaround with managing runspaces myself. <code>  // ...using System.Management.Automation;using System.Collections.ObjectModel;// ...public static void Main(string[] args){ Collection<PSObject> output; using (PowerShell ps = PowerShell.Create()) { ps.AddScript(""$test = Get-Date; $test""); output = ps.Invoke(); }// ...",`PowerShell.Create()` returning null
Long running CPU-bound synchronous implementation of an interface that returns a Task," I'm using this question as a basis for my question.TL;DR: If you're not supposed to wrap synchronous code in an async wrapper, how do you deal with long-running, thread-blocking methods that implement an interface method which expects an asynchronous implementation? Let's say I have an application that runs continuously to process a work queue. It's a server-side application (running mostly unattended) but it has a UI client to give a more-fine-grained control over the behavior of the application as required by the business processes: start, stop, tweak parameters during execution, get progress, etc.There's a business logic layer into which services are injected as dependencies.The BLL defines a set of interfaces for those services.I want to keep the client responsive: allow UI client to interact with the running process, and I also want threads to be used efficiently because the process needs to be scalable: there could be any number of asynchronous database or disk operations depending on the work in the queue. Thus I'm employing async/await ""all the way"".To that end, I have methods in the service interfaces that are obviously designed to encourage async/await and support for cancellation because they take a CancellationToken, are named with ""Async"", and return Tasks.I have a data repository service that performs CRUD operations to persist my domain entities. Let's say that at the present time, I'm using an API for this that doesn't natively support async. In the future, I may replace this with one that does, but for the time being the data repository service performs the majority of its operations synchronously, many of them long-running operations (because the API blocks on the database IO).Now, I understand that methods returning Tasks can run synchronously. The methods in my service class that implement the interfaces in my BLL will run synchronously as I explained, but the consumer (my BLL, client, etc) will assume they are either 1: running asynchronously or 2: running synchronously for a very short time. What the methods shouldn't do is wrap synchronous code inside an async call to Task.Run.I know I could define both sync and async methods in the interface.In this case I don't want to do that because of the async ""all the way"" semantics I'm trying to employ and because I'm not writing an API to be consumed by a customer; as mentioned above, I don't want to change my BLL code later from using the sync version to using the async version.Here's the data service interface: And it's implementation: The BLL: Presentation and presentation logic: So the question is: how do you deal with long-running, blocking methods that implement an interface method which expects an asynchronous implementation? Is this an example where it's preferable to break the ""no async wrapper for sync code"" rule? <code>  public interface IDataRepository{ Task<IReadOnlyCollection<Widget>> GetAllWidgetsAsync(CancellationToken cancellationToken);} public sealed class DataRepository : IDataRepository{ public Task<IReadOnlyCollection<Widget>> GetAllWidgetsAsync( CancellationToken cancellationToken) { /******* The idea is that this will /******* all be replaced hopefully soon by an ORM tool. */ var ret = new List<Widget>(); // use synchronous API to load records from DB var ds = Api.GetSqlServerDataSet( ""SELECT ID, Name, Description FROM Widgets"", DataResources.ConnectionString); foreach (DataRow row in ds.Tables[0].Rows) { cancellationToken.ThrowIfCancellationRequested(); // build a widget for the row, add to return. } // simulate long-running CPU-bound operation. DateTime start = DateTime.Now; while (DateTime.Now.Subtract(start).TotalSeconds < 10) { } return Task.FromResult((IReadOnlyCollection<Widget>) ret.AsReadOnly()); }} public sealed class WorkRunner{ private readonly IDataRepository _dataRepository; public WorkRunner(IDataRepository dataRepository) => _dataRepository = dataRepository; public async Task RunAsync(CancellationToken cancellationToken) { var allWidgets = await _dataRepository .GetAllWidgetsAsync(cancellationToken).ConfigureAwait(false); // I'm using Task.Run here because I want this on // another thread even if the above runs synchronously. await Task.Run(async () => { while (true) { cancellationToken.ThrowIfCancellationRequested(); foreach (var widget in allWidgets) { /* do something */ } await Task.Delay(2000, cancellationToken); // wait some arbitrary time. } }).ConfigureAwait(false); }} private async void HandleStartStopButtonClick(object sender, EventArgs e){ if (!_isRunning) { await DoStart(); } else { DoStop(); }}private async Task DoStart(){ _isRunning = true; var runner = new WorkRunner(_dependencyContainer.Resolve<IDataRepository>()); _cancellationTokenSource = new CancellationTokenSource(); try { _startStopButton.Text = ""Stop""; _resultsTextBox.Clear(); await runner.RunAsync(_cancellationTokenSource.Token); // set results info in UI (invoking on UI thread). } catch (OperationCanceledException) { _resultsTextBox.Text = ""Canceled early.""; } catch (Exception ex) { _resultsTextBox.Text = ex.ToString(); } finally { _startStopButton.Text = ""Start""; }}private void DoStop(){ _cancellationTokenSource.Cancel(); _isRunning = false;}",Long running synchronous implementation of an interface that returns a Task
EF Core 2.1 seed with HasData() from external source (such as json file) without deleting and re-inserting," Update 8/29/18Seeing this issue in inline new-ing of seed data as well. Opened an EF Core issue. Will update the question with any findings.I am trying to use EF Core 2.1's seeding mechanism. However, I want to load the seed data from json flat files rather than hard-coding new C# objects. I wrote the extension method below, which worked well for the initial migration. It looks for files named [MyEntity].json in DataPath and deserializes them into objects.The problem is that if I add a subsequent migration, even without changing a single thing in the models, configurations, or json files, the new migration deletes every single entity and re-inserts them again. So, the Up() contains a bunch of deletes followed by a bunch of inserts of the same data. I suspect this is because EF Core is not smart enough to recognize that it is an identical set of seed data.Question:Is there a way to use EF Core 2.1 seeding with an external data source (such as json files) without having each migration delete and re-insert the data?My seeding extension method: <code>  public static class ModelBuilderExtensions{ public static string DataPath { private get; set; } = ""..\\..\\data""; public static void Seed<TEntity>(this ModelBuilder modelBuilder) where TEntity : class, IBaseEntity { var entities = GetSeedRows<TEntity>(); modelBuilder.Entity<TEntity>().HasData(entities); } private static TEntity[] GetSeedRows<TEntity>() where TEntity : IBaseEntity { try { return JsonConvert.DeserializeObject<TEntity[]>( File.ReadAllText(DataPath + Path.DirectorySeparatorChar + typeof(TEntity).Name + "".json"")); } catch (FileNotFoundException e) { Console.WriteLine(e.Message); return null; } }}",EF Core 2.1 HasData() creating deletes and re-inserts for unchanged entities on subsequent migrations
c# webapi - Post frombody causes serializable error," Here's the basic setup, I have an asp.net core webapi controller (in c#) with a post function like so: I'm trying to send the following raw JSON request body to this function: But when send a post request to this function with the body above, I get back the following error in the server console: ""Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.SerializableError'""And this error on the client side { """": [ ""Unexpected character encountered while parsing value: {. Path '', line 1, position 1."" ] }I tried setting a break point at the beginning of the function but it doesn't even trigger! Why am I getting a serializable error? <code>  [HttpPost]public ActionResult<string> Post([FromBody] string Name){ //Do some processing with the ""Name"" argument... return Ok( ""Success!"" );} { ""Name"": ""Foo""}",Post received by FromBody causes serializable error
visual studio 2017 the connection string could not be found in application settings," For connection database and reading data, I am using a dataset which read connection string from Web.config file. Everything working in Visual Studio 2013. But when I opened this project in Visual Studio 2017, I can't configure. It errors: Unable to find connection string xxxx. the connection string could not be found in application settings or the data provider associated with the connection string could not be loaded <code> ",Visual Studio 2017 the connection string could not be found in application settings
"In C#, how can one achieve recursive value equality with anonymous arrays and objects?"," Note: For Assert, using XunitAnonymous objects use value equality: Anonymous arrays with anonymous objects use value equality: Anonymous objects with nested arrays seem to use reference equality (this fails): But this works (presumably because there's now reference equality): And this works (so it appears I can recursively nest anonymous objects with value equality preserved): I'm not sure how equality is being conducted here, but I'd like to be able to nest objects and arrays and have infinite-depth value equality. How might I go about doing that?UpdateLooks like Fluent Assertions solved my problem (this test passes): <code>  Assert.Equal( new { foo = ""bar"" }, new { foo = ""bar"" }); Assert.Equal( new [] { new { foo = ""bar"" } }, new [] { new { foo = ""bar"" } }); Assert.Equal( new { baz = new [] { new { foo = ""bar"" } }, new { baz = new [] { new { foo = ""bar"" } }); var baz = new [] { new { foo = ""bar"" } };Assert.Equal( new { baz }, new { baz }); Assert.Equal( new { baz = new { qux = new { foo = ""bar"" } } }, new { baz = new { qux = new { foo = ""bar"" } } }); (new { baz = new[] { new { foo = ""bar"" } } }) .Should() .BeEquivalentTo(new { baz = new [] { new { foo = ""bar"" } } });","In C#, how do you get recursive value equality for nested anonymous arrays and objects?"
Process Terminated due to Internal Error in the .NET Runtime - 80131506," So I'm getting this error that looks as though it's a corrupted garbage collection:Application Crashes With ""Internal Error In The .NET Runtime""The full error is: The process was terminated due to an internal error in the .NET Runtime at IP 71C571C8 (71B20000) with exit code 80131506.It's running on: Framework Version: v4.0.30319This occurs inconsistently when running this function repeatedly: Where FindWindowEx(), EnumChildWindows() and GetWindowText() are all p/invoke signatures defined similarly to this: The error only seems to occur after I've run the method many times, however, this doesn't happen consistently. Sometimes it works, sometimes it doesn't.Any suggestions on how to fix this? <code>  public static int GetMdiTitledChildWindows(IntPtr parentWindow) { IntPtr mdiClient = FindWindowEx(parentWindow, IntPtr.Zero, MdiClient, """"); List<IntPtr> handles = new List<IntPtr>(); EnumChildWindows(mdiClient, (hwnd, param) => { handles.Add(hwnd); return true; }, IntPtr.Zero); int counter = 0; foreach (IntPtr handle in handles) { StringBuilder builder = new StringBuilder(); GetWindowText(handle, builder, GetWindowTextLength(handle)+1); if (builder.Length > 0) { counter++; } } return counter; } [DllImport(""user32.dll"")] [return: MarshalAs(UnmanagedType.Bool)] private static extern bool EnumChildWindows(IntPtr hwndParent, EnumWindowsProc lpEnumFunc, IntPtr lParam);",.NET Runtime Error 80131506 - Passing Lambda to Native Function
.NET Runtime Error 80131506 - Passing Lamda to Native Function," So I'm getting this error that looks as though it's a corrupted garbage collection:Application Crashes With ""Internal Error In The .NET Runtime""The full error is: The process was terminated due to an internal error in the .NET Runtime at IP 71C571C8 (71B20000) with exit code 80131506.It's running on: Framework Version: v4.0.30319This occurs inconsistently when running this function repeatedly: Where FindWindowEx(), EnumChildWindows() and GetWindowText() are all p/invoke signatures defined similarly to this: The error only seems to occur after I've run the method many times, however, this doesn't happen consistently. Sometimes it works, sometimes it doesn't.Any suggestions on how to fix this? <code>  public static int GetMdiTitledChildWindows(IntPtr parentWindow) { IntPtr mdiClient = FindWindowEx(parentWindow, IntPtr.Zero, MdiClient, """"); List<IntPtr> handles = new List<IntPtr>(); EnumChildWindows(mdiClient, (hwnd, param) => { handles.Add(hwnd); return true; }, IntPtr.Zero); int counter = 0; foreach (IntPtr handle in handles) { StringBuilder builder = new StringBuilder(); GetWindowText(handle, builder, GetWindowTextLength(handle)+1); if (builder.Length > 0) { counter++; } } return counter; } [DllImport(""user32.dll"")] [return: MarshalAs(UnmanagedType.Bool)] private static extern bool EnumChildWindows(IntPtr hwndParent, EnumWindowsProc lpEnumFunc, IntPtr lParam);",.NET Runtime Error 80131506 - Passing Lambda to Native Function
Round a decimal to the first decimal position that is not null c#," I want to shorten a number to the first significant digit that is not 0. The digits behind should be rounded.Examples: Currently I have the following procedure: Note:numbers will always be positivethe number of significant digits will always be 1values larger 0.01 will always be rounded to two decimal places, hence the if < 0.01As you can see from the examples above, a rounding to 4 Decimal places might not be enough and the value might vary greatly. <code>  0.001 -> 0.0010.00367 -> 0.0040.00337 -> 0.0030.000000564 -> 0.00000060.00000432907543029 -> 0.000004 if (value < (decimal) 0.01){ value = Math.Round(value, 4);}",Round a decimal number to the first decimal position that is not zero
Round a decimal to the first decimal position that is not zero," I want to shorten a number to the first significant digit that is not 0. The digits behind should be rounded.Examples: Currently I have the following procedure: Note:numbers will always be positivethe number of significant digits will always be 1values larger 0.01 will always be rounded to two decimal places, hence the if < 0.01As you can see from the examples above, a rounding to 4 Decimal places might not be enough and the value might vary greatly. <code>  0.001 -> 0.0010.00367 -> 0.0040.00337 -> 0.0030.000000564 -> 0.00000060.00000432907543029 -> 0.000004 if (value < (decimal) 0.01){ value = Math.Round(value, 4);}",Round a decimal number to the first decimal position that is not zero
Net Core: how to separate controllers by ports and use only 1 Startup for that?," I need to separate controllers by ports inside netcore2.0 selfhosted web service.Example:There are 2 ports(p1 and p2) and 3 controllers(c1, c2, c3). Requirement scheme: c1 processes requests from p1, but c2 and c3 will processes requests from p2. Any ideas about how can i do that?  <code> ",Net Core: how to separate controllers by ports?
WPF: Animation that reverse UI element to its default state is too slow," Let's imagine we have an animation that changes a Rectangle's width from 50 to 150 when user moves the cursor over it and back from 150 to 50 when user moves the cursor away. Let the duration of each animation be 1 second.Everything is OK if user moves the cursor over the rectangle, then waits for 1 second for animation to finish, and then moves the cursor away from the rectangle. Two animations take 2 seconds totally and their speed is exactly what we are expecting to be.But if user moves the cursor away before the first animation (50 -> 150) is finished, the second animation's duration will be 1 second but the speed of it will be very slow. I mean, the second animation will animate the rectangle's width not from 150 to 50 but from let's say 120 to 50 or from 70 to 50 if you take cursor away very fast. But for the same 1 second!So what I want to understand is how to make the duration of the ""backwards"" animation to be dynamic. Dynamic based on at what point the first animation was stopped. Or, if I specify From and To values to 150 and 50, Duration to 1 seconds and rectangle width will be 100 WPF would calculate by itself that animation is 50% done.I was testing different ways to use animation like Triggers, EventTrigger in style, and VisualStateGroups but no success.Here is a XAML sample that shows my problem. If you want to see by yourself what I am talking about, move the cursor over the rectangle, wait for 1-2 seconds (first animation is finished) then move the cursor away. After that, move the cursor over the rectangle for like 0.25 seconds and move it away. You will see that the rectangle's width changes very slowly. Also, I would like to explain what calculation I am expecting to see.So let's imagine another animation that goes from 100 to 1100 and has a duration of 2 seconds. If we stop it at the point of 300, it must start to go back to 100 but not for 2 seconds but for: If we stop at 900, duration will be: And if we let animation finish normally it will be: <code>  <Rectangle Width=""50"" Height=""100"" HorizontalAlignment=""Left"" Fill=""Black""><Rectangle.Triggers> <EventTrigger RoutedEvent=""MouseEnter""> <BeginStoryboard> <Storyboard> <DoubleAnimation Storyboard.TargetProperty=""Width"" To=""150"" Duration=""0:0:1"" /> </Storyboard> </BeginStoryboard> </EventTrigger> <EventTrigger RoutedEvent=""MouseLeave""> <BeginStoryboard> <Storyboard> <DoubleAnimation Storyboard.TargetProperty=""Width"" /> </Storyboard> </BeginStoryboard> </EventTrigger></Rectangle.Triggers> ((300 - 100) / (1100 - 100)) * 2s = 0.4s ((900 - 100) / (1100 - 100)) * 2s = 1.6s ((1100 - 100) / (1100 - 100)) * 2s = 2s",How to make the duration of an animation dynamic?
How to make the duration of an animation dynamic?," Let's imagine we have an animation that changes a Rectangle's width from 50 to 150 when user moves the cursor over it and back from 150 to 50 when user moves the cursor away. Let the duration of each animation be 1 second.Everything is OK if user moves the cursor over the rectangle, then waits for 1 second for animation to finish, and then moves the cursor away from the rectangle. Two animations take 2 seconds totally and their speed is exactly what we are expecting to be.But if user moves the cursor away before the first animation (50 -> 150) is finished, the second animation's duration will be 1 second but the speed of it will be very slow. I mean, the second animation will animate the rectangle's width not from 150 to 50 but from let's say 120 to 50 or from 70 to 50 if you take cursor away very fast. But for the same 1 second!So what I want to understand is how to make the duration of the ""backwards"" animation to be dynamic. Dynamic based on at what point the first animation was stopped. Or, if I specify From and To values to 150 and 50, Duration to 1 seconds and rectangle width will be 100 WPF would calculate by itself that animation is 50% done.I was testing different ways to use animation like Triggers, EventTrigger in style, and VisualStateGroups but no success.Here is a XAML sample that shows my problem. If you want to see by yourself what I am talking about, move the cursor over the rectangle, wait for 1-2 seconds (first animation is finished) then move the cursor away. After that, move the cursor over the rectangle for like 0.25 seconds and move it away. You will see that the rectangle's width changes very slowly. Also, I would like to explain what calculation I am expecting to see.So let's imagine another animation that goes from 100 to 1100 and has a duration of 2 seconds. If we stop it at the point of 300, it must start to go back to 100 but not for 2 seconds but for: If we stop at 900, duration will be: And if we let animation finish normally it will be: <code>  <Rectangle Width=""50"" Height=""100"" HorizontalAlignment=""Left"" Fill=""Black""><Rectangle.Triggers> <EventTrigger RoutedEvent=""MouseEnter""> <BeginStoryboard> <Storyboard> <DoubleAnimation Storyboard.TargetProperty=""Width"" To=""150"" Duration=""0:0:1"" /> </Storyboard> </BeginStoryboard> </EventTrigger> <EventTrigger RoutedEvent=""MouseLeave""> <BeginStoryboard> <Storyboard> <DoubleAnimation Storyboard.TargetProperty=""Width"" /> </Storyboard> </BeginStoryboard> </EventTrigger></Rectangle.Triggers> ((300 - 100) / (1100 - 100)) * 2s = 0.4s ((900 - 100) / (1100 - 100)) * 2s = 1.6s ((1100 - 100) / (1100 - 100)) * 2s = 2s",How to make the duration of an animation dynamic?
How do you do fulltext search with EntityFramework Core?," I have the following query: I am having trouble converting it to an Entity Framework Core query. I have a SQL Server with a catalog that has a few indexes.I want to be able to use FREETEXT and CONTAINS to do a fulltext query on the tables. I cannot find the method in Entity Framework Core for fulltext search with CONTAINS.  <code>  SELECT Animals.name FROM Animals WHERE CONTAINS(*, 'feline AND black');",How do you do fulltext search with Entity Framework Core?
Rijndael BlockSize can be set only to 128 in dotnet core 2.1," I'm trying to encrypt a string with RijndaelManaged in order to send it to a third-party service. I've implemented the procedure in older versions of .Net framework (4.5, 4.6.x) like below: According to documentation, RijndaelManaged class can be used with BlockSize = 256. But, when the code is running in dotenet core 2.1, an exception thrown: System.PlatformNotSupportedException: BlockSize must be 128 in this implementation. at System.Security.Cryptography.RijndaelManaged.set_BlockSize(Int32 value)UPDATEThanks to @Access-Denied's response, according to this, I've noticed that it may be a mistake in dotnet core documentation and I can't use a 256 long BlockSize with RijndaelManaged class. As I mentioned, encrypted data is going to be sent to a third-party service. I have to use Rijndael with a 32 long IV. How can I handle that? <code>  RijndaelManaged rm= new RijndaelManaged();rm.KeySize = 256;rm.BlockSize = 256;//causes exception in dotnet core 2.1rm.Padding = PaddingMode.PKCS7;rm.Key = Convert.FromBase64String(this.Key);rm.IV = Convert.FromBase64String(this.IV);var encrypt = rm.CreateEncryptor(rm.Key, rm.IV);",How to use Rijndael algorithm with 256 long block size in dotnet core 2.1
How to force Serilog to log only my log messages," I configured Serilog in appsettings.json to log entries into Logstash via tcp in my asp net core web api app the following way: But it logs too many messages. For example, I have a CreateToken action method in Token controller: I need to log only one message: Unable to authenticate an user Login PasswordBut Serilog logs the following: Request starting HTTP/1.1 POST http://localhost:5000/api/token application/json 57 Route matched with ""{action = \""CreateToken\"", controller = \""Token\""}"". Executing action ""Deal.WebApi.Controllers.TokenController.CreateToken (Deal.WebApi)"" Executing action method ""Deal.WebApi.Controllers.TokenController.CreateToken (Deal.WebApi)"" with arguments ([""Deal.BL.Models.Auth.CredentialsModel""]) - Validation state: Valid Unable to authenticate an user: Login Password Executed action method ""Deal.WebApi.Controllers.TokenController.CreateToken (Deal.WebApi)"", returned result ""Microsoft.AspNetCore.Mvc.UnauthorizedResult"" in 11.0935ms. Executing HttpStatusCodeResult, setting HTTP status code 401 Executed action ""Deal.WebApi.Controllers.TokenController.CreateToken (Deal.WebApi)"" in 95.272ms Request finished in 123.9485ms 401How can I get rid of unwanted messages?This is my Program.cs file: <code>  { ""Serilog"": { ""Using"": [ ""Serilog.Sinks.Network"" ], ""MinimumLevel"": { ""Default"": ""Information"" }, ""WriteTo:0"": { ""Name"": ""TCPSink"", ""Args"": { ""uri"": ""tcp://172.26.48.39:5066"" } }, ""Properties"": { ""app_id"": ""my-service-api"", ""index"": ""my-app-"" } }, ...} [HttpPost]public ActionResult<string> CreateToken([FromBody] CredentialsModel credentials){ var user = _authentication.Authenticate(credentials); if (user == null) { Log.Warning(""Unable to authenticate an user: {Login}, {Password}"", credentials.Username, credentials.Password); return Unauthorized(); } return BuildToken();} public class Program{ public static void Main(string[] args) { var currentEnv = Environment.GetEnvironmentVariable(""ASPNETCORE_ENVIRONMENT""); var config = new ConfigurationBuilder() .SetBasePath(Directory.GetCurrentDirectory()) .AddJsonFile(""appsettings.json"") .AddJsonFile($""appsettings.{currentEnv}.json"", true) .AddEnvironmentVariables() .Build(); Log.Logger = new LoggerConfiguration() .ReadFrom.Configuration(config) .CreateLogger(); try { Log.Information(""Start web host""); CreateWebHostBuilder(args).Build().Run(); } catch (Exception ex) { Log.Fatal(ex, ""Host terminated unexpectedly""); } finally { Log.CloseAndFlush(); } } public static IWebHostBuilder CreateWebHostBuilder(string[] args) => WebHost.CreateDefaultBuilder(args) .UseSerilog() .UseStartup<Startup>();}",How to force Serilog to log only my custom log messages
C# Improve performance of Bitconverter.ToInt16," I am collecting data from a USB device and this data has to go to an audio output component. At the moment I am not delivering the data fast enough to avoid clicks in the output signal. So every millisecond counts.At the moment I am collecting the data which is delivered in a byte array of 65536 bytes.The first two bytes represent 16 bits of data in little endian format. These two bytes must be placed in the first element of a double array. The second two bytes, must be placed in the first element of a different double array. This is then repeated for all the bytes in the 65536 buffer so that you end up with 2 double[] arrays of size 16384.I am currently using BitConverter.ToInt16 as shown in the code. It takes around 0.3ms to run this but it has to be done 10 times to get a packet to send off to the audio output. So the overhead is 3ms which is just enough for some packets to not be delivered on time eventually.Code How can I improve this? Is it possible to copy the values with unsafe code? I have no experience in that.Thanks <code>  byte[] buffer = new byte[65536];double[] bufferA = new double[16384];double[] bufferB = new double[16384]for(int i= 0; i < 65536; i +=4){ bufferA[i/4] = BitConverter.ToInt16(buffer, i); bufferB[i/4] = BitConverter.ToInt16(buffer, i+2);}",Improve performance of Bitconverter.ToInt16
Adaptive Card response from a WaterfallDialog MS Bot framework v4," I am trying to send an adaptive card which has 2 options for user to select.When user submit the response from adaptive card I am receiving : Full code example Link : Manage a complex conversation flow with dialogsModification made in HotelDialogs.cs:- Note: [""testPrompt""] I tried with Text Prompt and slightly customizing the TextPrompt to read Activity Value. If Text prompt is not the appropriate prompt for adaptive card response,please let me know is there any other prompt that can be used or some custom prompt will be helpful for this kind of scenario.Custom Prompt:- Card Creation Method:- Thanks! <code>  Newtonsoft.Json.JsonReaderException: Error reading JArray from JsonReader. Current JsonReader item is not an array: StartObject. Path [BotAccessors.DialogState].DialogStack.$values[0].State.options.Prompt.attachments.$values[0].content.body. public static async Task<DialogTurnResult> PresentMenuAsync( WaterfallStepContext stepContext, CancellationToken cancellationToken) { // Greet the guest and ask them to choose an option. await stepContext.Context.SendActivityAsync( ""Welcome to Contoso Hotel and Resort."", cancellationToken: cancellationToken); //return await stepContext.PromptAsync( // Inputs.Choice, // new PromptOptions // { // Prompt = MessageFactory.Text(""How may we serve you today?""), // RetryPrompt = Lists.WelcomeReprompt, // Choices = Lists.WelcomeChoices, // }, // cancellationToken); var reply = stepContext.Context.Activity.CreateReply(); reply.Attachments = new List<Attachment> { new Attachment { Content = GetAnswerWithFeedbackSelectorCard(""Choose: ""), ContentType = AdaptiveCard.ContentType, }, }; return await stepContext.PromptAsync( ""testPrompt"", new PromptOptions { Prompt = reply, RetryPrompt = Lists.WelcomeReprompt, }, cancellationToken).ConfigureAwait(true); } using System;using System.Collections.Generic;using System.Threading;using System.Threading.Tasks;using Microsoft.Bot.Builder;using Microsoft.Bot.Builder.Dialogs;using Microsoft.Bot.Schema;namespace HotelBot{ public class CustomPrompt : Prompt<string> { public CustomPrompt(string dialogId, PromptValidator<string> validator = null) : base(dialogId, validator) { } protected async override Task OnPromptAsync(ITurnContext turnContext, IDictionary<string, object> state, PromptOptions options, bool isRetry, CancellationToken cancellationToken = default(CancellationToken)) { if (turnContext == null) { throw new ArgumentNullException(nameof(turnContext)); } if (options == null) { throw new ArgumentNullException(nameof(options)); } if (isRetry && options.RetryPrompt != null) { await turnContext.SendActivityAsync(options.RetryPrompt, cancellationToken).ConfigureAwait(false); } else if (options.Prompt != null) { await turnContext.SendActivityAsync(options.Prompt, cancellationToken).ConfigureAwait(false); } } protected override Task<PromptRecognizerResult<string>> OnRecognizeAsync(ITurnContext turnContext, IDictionary<string, object> state, PromptOptions options, CancellationToken cancellationToken = default(CancellationToken)) { if (turnContext == null) { throw new ArgumentNullException(nameof(turnContext)); } var result = new PromptRecognizerResult<string>(); if (turnContext.Activity.Type == ActivityTypes.Message) { var message = turnContext.Activity.AsMessageActivity(); if (!string.IsNullOrEmpty(message.Text)) { result.Succeeded = true; result.Value = message.Text; } else if (message.Value != null) { result.Succeeded = true; result.Value = message.Value.ToString(); } } return Task.FromResult(result); } }} private static AdaptiveCard GetAnswerWithFeedbackSelectorCard(string answer) { if (answer == null) { return null; } AdaptiveCard card = new AdaptiveCard(); card.Body = new List<AdaptiveElement>(); var choices = new List<AdaptiveChoice>() { new AdaptiveChoice() { Title = ""Reserve Table"", Value = ""1"", }, new AdaptiveChoice() { Title = ""Order food"", Value = ""0"", }, }; var choiceSet = new AdaptiveChoiceSetInput() { IsMultiSelect = false, Choices = choices, Style = AdaptiveChoiceInputStyle.Expanded, Value = ""1"", Id = ""Feedback"", }; var text = new AdaptiveTextBlock() { Text = answer, Wrap = true, }; card.Body.Add(text); card.Body.Add(choiceSet); card.Actions.Add(new AdaptiveSubmitAction() { Title = ""Submit"" }); return card; }",Adaptive Card response from a WaterfallStep Dialog MS Bot framework v4
C# int array.Sum() result in an overflow," I have an int array like this and then I created an int64 var But this reslted in an overflow Run-time exception (line 19): Arithmetic operation resulted in an overflow.How can I solve this problem without using loop to sum it up ? (array type must be int) <code>  int[] arr = {256741038,623958417,467905213,714532089,938071625}; Int64 sum = arr.Sum();",Array.Sum() results in an overflow
Aarray.Sum() results in an overflow," I have an int array like this and then I created an int64 var But this reslted in an overflow Run-time exception (line 19): Arithmetic operation resulted in an overflow.How can I solve this problem without using loop to sum it up ? (array type must be int) <code>  int[] arr = {256741038,623958417,467905213,714532089,938071625}; Int64 sum = arr.Sum();",Array.Sum() results in an overflow
How to get files from azure blob storage which modified on today," I want to get files from Azure Blob Storage that are modified everyday. We have a container in Azure which is filled by two Excel files every day, and I need to get those files.So far, I'm only able to get one file using latestmodifiedon. How can I get both files? <code>  private static DataSet GetExcelBlobData(){ var containerName = ""salesbycontract""; CloudStorageAccount storageAccount = CloudStorageAccount.Parse(Microsoft.Azure.CloudConfigurationManager.GetSetting(""StorageConnectionString"")); CloudBlobClient blobClient = storageAccount.CreateCloudBlobClient(); CloudBlobContainer container = blobClient.GetContainerReference(containerName); CloudBlockBlob blockbob = container.ListBlobs().OfType<CloudBlockBlob>().OrderByDescending(m => m.Properties.LastModified).ToList().First(); var x = blockbob.Name; Console.WriteLine(x); DataSet ds; using (var memstream = new MemoryStream()) { blockbob.DownloadToStream(memstream); var excelReader = ExcelReaderFactory.CreateOpenXmlReader(memstream); ds = excelReader.AsDataSet(); excelReader.Close(); } return ds;}",How to get files modified today from Azure Blob Storage
c# Unix Timestamp: Difference between using ToUnixTimeMilliseconds and TimeSpan.TotalMilliseconds," I am converting a DateTime to Unix time. As I understand these two ways should return teh same result.Option 1 Option 2 Option 1 returns 1287525600000 and Option2 returns 1287529200000.Why am I getting different results? <code>  DateTime dtfoo = new DateTime(2010, 10, 20);DateTimeOffset dtfoo2 = new DateTimeOffset(dtfoo).ToUniversalTime();long afoo = dtfoo2.ToUnixTimeMilliseconds(); DateTime dtfoo = new DateTime(2010, 10, 20);DateTimeOffset dtfoo2 = new DateTimeOffset(dtfoo).ToUniversalTime();long afoo = (Int64)(dtfoo2.Subtract(new DateTime(1970, 1, 1))).TotalMilliseconds;",Unix Timestamp: Difference between using ToUnixTimeMilliseconds and TimeSpan.TotalMilliseconds
Having Issue on Implementing MVVM with ArcGIS Runtime Local Server," I am trying to setup a ESRI Local Server for displaying .mpk. I have a Model like in ViewModel.cs Class I have As you can see I am trying to implement the local server and dynamic layer in ViewModel.cs like but I do not know how to bind this service to the Model ? I tried but as you know the myModel doesn't have any Map object. Update <code>  public class Model{ private string basemapLayerUri = ""http://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer""; private string mapPackage = ""D:\\App\\Data\\Canada.mpk""; public Model() { } public string BasemapLayerUri { get { return this.basemapLayerUri; } set { if (value != this.basemapLayerUri) { this.basemapLayerUri = value; } } } public string MapPackage { get { return this.mapPackage; } set { if (value != this.mapPackage) { this.mapPackage = value; } } }} public class ViewModel : INotifyPropertyChanged{ public Model myModel { get; set; } public event PropertyChangedEventHandler PropertyChanged; public ViewModel() { myModel = new Model(); this.CreateLocalServiceAndDynamicLayer(); } public string BasemapUri { get { return myModel.BasemapLayerUri; } set { this.myModel.BasemapLayerUri = value; OnPropertyChanged(""BasemapUri""); } } public async void CreateLocalServiceAndDynamicLayer() { LocalMapService localMapService = new LocalMapService(this.MAPKMap); await localMapService.StartAsync(); ArcGISDynamicMapServiceLayer arcGISDynamicMapServiceLayer = new ArcGISDynamicMapServiceLayer() { ID = ""mpklayer"", ServiceUri = localMapService.UrlMapService, }; //myModel.Map.Layers.Add(arcGISDynamicMapServiceLayer); } public string MAPKMap { get { return myModel.MapPackage; } set { this.myModel.MapPackage = value; OnPropertyChanged(""MAPKMap""); } } protected void OnPropertyChanged([CallerMemberName] string member = """") { var eventHandler = PropertyChanged; if (eventHandler != null) { PropertyChanged(this, new PropertyChangedEventArgs(member)); } }} public async void CreateLocalServiceAndDynamicLayer(){ LocalMapService localMapService = new LocalMapService(this.MAPKMap); await localMapService.StartAsync(); ArcGISDynamicMapServiceLayer arcGISDynamicMapServiceLayer = new ArcGISDynamicMapServiceLayer() { ID = ""mpklayer"", ServiceUri = localMapService.UrlMapService, }; //myModel.Map.Layers.Add(arcGISDynamicMapServiceLayer);} myModel.Map.Layers.Add(arcGISDynamicMapServiceLayer); using M_PK2.Models;using System;using System.Collections.Generic;using System.ComponentModel;using System.Linq;using System.Runtime.CompilerServices;using System.Text;using System.Threading.Tasks;using Esri.ArcGISRuntime.LocalServices;using Esri.ArcGISRuntime.Controls;using Esri.ArcGISRuntime.Layers;namespace M_PK2.ViewModels{ class ViewModel : ViewModelBase { private readonly LocalMapService localMapService; private readonly Model myModel; private LayerCollection layers; public ViewModel() { myModel = new Model(); layers = new LayerCollection(); localMapService = new LocalMapService(myModel.MapPackage); starting += onStarting; starting(this, EventArgs.Empty); } private event EventHandler starting = delegate { }; private async void onStarting(object sender, EventArgs args) { starting -= onStarting; //optional // the following runs on background thread await localMapService.StartAsync(); // returned to the UI thread var serviceLayer = new ArcGISDynamicMapServiceLayer() { ID = ""mpklayer"", ServiceUri = localMapService.UrlMapService, }; Layers.Add(serviceLayer); OnPropertyChanged(nameof(Layers)); //Notify UI } public LayerCollection Layers { get { return layers; } } } public class ViewModelBase : INotifyPropertyChanged { public event PropertyChangedEventHandler PropertyChanged = delegate { }; protected void OnPropertyChanged([CallerMemberName] string member = """") { PropertyChanged(this, new PropertyChangedEventArgs(member)); } }}",Implementing MVVM with ArcGIS Runtime local server
C#: Deserializing json string fails when json dictionary is empty," Currently I'm facing the following issue when I try to deserialize a json string that I receive from a 3rd party (--> I cannot change the received json string by myself) with Newtonsoft.Json:The json contains a dictionary (and some other entries that I don't list here): I've created a class that contains the property (plus the properties that I didn't list here): In this case the desiralization of the json works fine.The problem occurs when food is empty: In this case it seems that food is not a dictionary but an array.That's the reason why the desirialization fails with the following error: Newtonsoft.Json.JsonSerializationException: ""Cannot deserialize the current JSON array (e.g. [1,2,3]) into type 'System.Collections.Generic.Dictionary`2[System.String,System.String]' because the type requires a JSON object (e.g. {""name"":""value""}) to deserialize correctly. To fix this error either change the JSON to a JSON object (e.g. {""name"":""value""}) or change the deserialized type to an array or a type that implements a collection interface (e.g. ICollection, IList) like List that can be deserialized from a JSON array. JsonArrayAttribute can also be added to the type to force it to deserialize from a JSON array. Path 'food'.""Is anybody out there who can help me to solve this problem, please?EDITThe desiralization code: EDIT 2Full json with values: Full json without values: EDIT 3The class: And the method call: <code>  ""food"": { ""Menu 1"": ""abc"", ""Menu 2"": ""def""} Dictionary<string, string> Food {get; set;} { ""food"": [],} public T DeserializeAPIResults<T>(string json){ JObject obj = JsonConvert.DeserializeObject<JObject>(json); return obj.GetValue(""canteen"").ToObject<T>();} { ""canteen"": [ { ""name"": ""Canteen1"", ""src"": ""a link"", ""food"": { ""Menu 1"": ""abc"", ""Menu 2"": ""def"", ""Menu 3"": ""ghi"", ""Menu 4"": ""jkl"", ""Menu 5"": ""mno"" } }, { ""name"": ""Canteen2"", ""src"": ""a link"", ""food"": { ""Menu 1"": ""abc"", ""Menu 2"": ""def"", ""Menu 3"": ""ghi"" } }, { ""name"": ""Canteen3"", ""src"": ""a link"", ""food"": { ""Line 1"": ""abc"", ""Line 2"": ""def"", ""Line 3"": ""ghi"" } } ] } { ""canteen"": [ { ""name"": ""Canteen1"", ""src"": ""a link"", ""food"": [], }, { ""name"": ""Canteen2"", ""src"": ""a link"", ""food"": [], }, { ""name"": ""Canteen3"", ""src"": ""a link"", ""food"": [], } ]} public sealed class Canteen{ [JsonProperty(""name"")] public string Name { get; set; } [JsonProperty(""src"")] public string Src { get; set; } [JsonProperty(""food"")] public Dictionary<string, string> Food { get; set; } public Canteen() { }} Canteen[] canteens = DeserializeAPIResults<Canteen[]>(json);",Deserializing JSON string fails when JSON dictionary is empty
c# What happend if span<T>(memory<T>) refers to buffers on stack," .NET Standard 2.1 has introduced a new feature where you can ""control"" the memory blocks instead of copying them: Span or Memory.In the docs example, I noticed that it is possible to refer to a stack buffer: As far as I know, stack memory for a process is limited (1MB or 4MB), and we cannot manually release it.So I guess creating a Memory<T> or Span<T> will somehow ""Pin"" the memory location on stack thus we can index it? But wouldn't that be a potenial case of stack-leak which might result in stack-overfolow?Since the array on stack should live as long as Memory<T> or Span<T>. <code>  byte data = 0;Span<byte> stackSpan = stackalloc byte[100];for (int ctr = 0; ctr < stackSpan.Length; ctr++) stackSpan[ctr] = data++;",c# What happen if span<T>(memory<T>) refers to buffers on stack
how to select multiple Elements in Selenium List (not <Select><Option>)," How can I select multiple web elements from an ordered list using Selenium WebDriver in C#?I want to do it manually, I would press Ctrl and select multiple options. I want to automate this.Below is the sample HTML: Appreciate your time and efforts. <code>  <ol id=""selectable"" class=""ui-selectable""> <li class=""ui-state-default ui-selectee"">1</li> <li class=""ui-state-default ui-selectee"">2</li> <li class=""ui-state-default ui-selectee"">3</li> <li class=""ui-state-default ui-selectee"">4</li> <li class=""ui-state-default ui-selectee"">5</li> <li class=""ui-state-default ui-selectee"">6</li> <li class=""ui-state-default ui-selectee"">7</li> <li class=""ui-state-default ui-selectee"">8</li> <li class=""ui-state-default ui-selectee"">9</li> <li class=""ui-state-default ui-selectee"">10</li> <li class=""ui-state-default ui-selectee"">11</li> <li class=""ui-state-default ui-selectee"">12</li></ol> ",How to select multiple elements in Selenium (not <Select> - <Option>)
"How can I return <TEnumerable, T> : where T:IEnumerable<T>"," Goal: Generic enumerated type to be the same type when returned.Note: This works when the types are entered but I don't understand why they can't be inferred.List<T> then return List<T>IOrderedEnumerable<T> then return IOrderedEnumerable<T>ETCCurrent method (works only if all types are entered) Example Only Making it work What I'm missing is why C# can't infer the types although the where filter does make the types accurate. I understand why you either supply all or none generic types to methods so please do not point me to those answers.Edit: If I can't infer the types; then how can I make this more elegant? <code>  public static TEnumerable WithEach<TEnumerable, T>(this TEnumerable items, Action<T> action)where TEnumerable : IEnumerable<T>{ foreach (var item in items) action.Invoke(item); return items;} var list = new List<int>(); //TODO: Mock random valueslist.WithEach(x => Console.WriteLine(x)) //Here WithEach ideally returns List<int> following orignal type List<int> .OrderBy(x => x) .WithEach(x => Console.WriteLine(x)); //Here WithEach ideally returns IOrderedEnumerable<int> following OrderBy var list = new List<int>(); //TODO: Mock random valueslist.WithEach<List<int>, int>(x => Console.WriteLine(x)) .OrderBy(x => x) .WithEach<IOrderedEnumerable<int>, int>(x => Console.WriteLine(x));","How can I return <TEnumerable, T> : where TEnumerable:IEnumerable<T>"
Query was compiled for a different mapping source than the one associated with the specified DataContext," I have the following code for a compiled Linq2sql query to count rows in a table. The query throws an exception despite the same uncompiled query running smoothly: ServiceCustomContext inherits from DataContext and has only (besides a constructor) Tables including a table named Current used in the example above.And I get the following exception: 'Query was compiled for a different mapping source than the one associated with the specified DataContext.'This is only when using, as above, a compiled query. As long as I have a simple: in the Count() method, everything is fine.I don't understand what's wrong. I thought it might be that I need to keep a reference to the DataContext (ServiceCustomContext) although that seemed counter intuitive, but even the Microsoft examples don't do that. The only explanation I've found, is here which is basically that compiled queries as mentioned in the Microsoft examples in the link above are really wrong. I doubt that's true though. <code>  public static Func<ServiceCustomContext, int> CompiledCount = CompiledQuery.Compile((ServiceCustomContext db) => db.Current.Count());public static int Count(){ using (ServiceCustomContext db = new ServiceCustomContext(Constants.NewSqlConnection)) return CompiledCount(db);} return db.Current.Count();",Compiled query fails - Query was compiled for a different mapping source than the one associated with the specified DataContext
property or navigation with the same name already exists on entity type - how to add foreign keys in migration scenario of entity framework," I have this class with only the foreign key references: I get an error while running the command Error is: The property or navigation 'DeviceType' cannot be added to the entity type 'Device' because a property or navigation with the same name already exists on entity type 'Device'.This is my context class content <code>  public class Device{ [Required] [DataMember(Name = ""key"")] [Key] public Guid Key { get; set; } [ForeignKey(""DeviceType"")] [IgnoreDataMember] public virtual DeviceType DeviceType { get; set; } [ForeignKey(""Model"")] [IgnoreDataMember] public virtual ModelType Model { get; set; }} Add-Migration -Name ""DeviceMigration"" public class MyContext: DbContext { public MyContext(DbContextOptions<MyContext> options) : base(options) { } public DbSet<DeviceType> DeviceTypes { get; set; } public DbSet<Device> Devices { get; set; } }",Property or navigation with the same name already exists on entity type - how to add foreign keys in migration scenario of Entity Framework
How to track enable interface concepts with Entity Framework Code First," I have added DateCreated, UserCreated, DateModified and UserModified fields to each entity by creating a BaseEntity.cs class. My requirement is to generate single table which is having all the fields of base class as columns. Here is my Student class Here is my context class I have run the below migration commands to create script and update database It has created separate tables BaseEntity and Student in the SQL Server database. My expectation is to create a single Student table with all the BaseEntity fields as columns.How to achieve it?I am using ASP.NET CORE2.1 <code>  public class BaseEntity{ public DateTime? DateCreated { get; set; } public string UserCreated { get; set; } public DateTime? DateModified { get; set; } public string UserModified { get; set; }} public class Student : BaseEntity{ public int Id { get; set; } public string Name { get; set; }} public class SchoolContext: DbContext{ public LibraContext(DbContextOptions<SchoolContext> options) : base(options) { } public DbSet<Student> Students { get; set; }}protected override void OnModelCreating(ModelBuilder modelBuilder){ //CreatedDate modelBuilder.Entity<BaseEntity>().Property(x => x.DateCreated).HasDefaultValueSql(""GETDATE()""); //Updated Date modelBuilder.Entity<BaseEntity>().Property(x => x.DateModified).HasDefaultValueSql(""GETDATE()""); } Add-Migration -Name ""InitialMigration"" -Context ""SchoolContext""update-database",Configuring abstract base class without creating table in EF Core
Why is it not possible to use pattern matching to discern between `bool` and `Nullable<bool>`?," I came across this and am curious as to why is it not possible to use the is operator to discern between bool and Nullable<bool>? Example; Calling Main() gives; I'd expect; Why do both bool and Nullable<bool> match each other?What have I tried;I've consulted the docs for Nullable, is, switch and pattern matching.I think this might be related to unboxing of the value when it's passed into the method?I think it might be unique to Nullable because I don't run into the same problems for other generic types. For example; Gives; I'm not looking to solve a problem. Just interested as to why it works this way.Answers so far suggest it's implicit and explicit conversions that cause this behaviour but I haven't been able to replicate with the following example; Gives; The docs for is say: It only considers reference conversions, boxing conversions, and unboxing conversions; it does not consider user-defined conversions or conversions defined by a type's implicit and explicit operators. The following example generates warnings because the result of the conversion is known at compile-time. Note that the is expression for conversions from int to long and double return false, since these conversions are handled by the implicit operator.Are reference conversions, boxing conversions, and unboxing conversions something the framework decides? <code>  void Main(){ bool theBool = false; Nullable<bool> theNullableBoolThatsFalse = false; Nullable<bool> theNullableBoolThatsNull = null; void WhatIsIt(object value) { if(value is bool) Console.WriteLine("" It's a bool!""); if(value is Nullable<bool>) Console.WriteLine("" It's a Nullable<bool>!""); if(value is null) Console.WriteLine("" It's a null!""); } Console.WriteLine(""Considering theBool:""); WhatIsIt(theBool); Console.WriteLine(""Considering theNullableBoolThatsFalse:""); WhatIsIt(theNullableBoolThatsFalse); Console.WriteLine(""Considering theNullableBoolThatsNull:""); WhatIsIt(theNullableBoolThatsNull);} Considering theBool: It's a bool! It's a Nullable<bool>!Considering theNullableBoolThatsFalse: It's a bool! It's a Nullable<bool>!Considering theNullableBoolThatsNull: It's a null! Considering theBool: It's a bool!Considering theNullableBoolThatsFalse: It's a Nullable<bool>!Considering theNullableBoolThatsNull: It's a null! void Main(){ bool theBool = false; List<bool> theListOfBool= new List<bool>(); void WhatIsIt(object value) { if(value is bool) Console.WriteLine("" It's a bool!""); if(value is List<bool>) Console.WriteLine("" It's a List<bool>!""); } Console.WriteLine(""Considering theBool:""); WhatIsIt(theBool); Console.WriteLine(""Considering theListOfBool:""); WhatIsIt(theListOfBool);} Considering theBool: It's a bool!Considering theListOfBool: It's a List<bool> class A{ public static implicit operator A(B value) => new A(); public static explicit operator B(A value) => new B();}class B{ public static implicit operator A(B value) => new A(); public static explicit operator B(A value) => new B();}static void Main(string[] args){ var a = new A(); var b = new B(); void WhatIsIt(object value) { if (value is A) Console.WriteLine("" It's a A!""); if (value is B) Console.WriteLine("" It's a B!""); } Console.WriteLine(""Considering a;""); WhatIsIt(a); Console.WriteLine(""Considering b;""); WhatIsIt(b);} Considering a; It's a A!Considering b; It's a B!",Why is it not possible to use the is operator to discern between bool and Nullable<bool>?
Evaluation of method System.Linq.Enumerable.ToList() calls into native method Interop+Kernel32.FindStringOrdinal()," I have a list of posts that i get from DB like that: I wanna filter my posts after getting all from DB, if i add where to my iQueryable it works just fine but i need to get all post from DB.That's what i did and the message I see in QuickWatch : QuickWatch message: Evaluation of method System.Linq.Enumerable.ToList() calls into native method Interop+Kernel32.FindStringOrdinal(). Evaluation of native methods in this context is not supported. System.Collections.Generic.ListThe project is based in a CQRS design-pattern <code>  var iQueryablePost= from p in context.Posts select new Post { Id=p.id, Label=p.label }; var posts = new List<Post>(); posts = await iQueryablePost.ToListAsync(); posts = !string.IsNullOrWhiteSpace(query.PdcIdSITiers) ? posts.Where(c => c.Label.ToLower().Contains(query.label.ToLower())).ToList() : posts;",Evaluation of method System.Linq.Enumerable.ToList() calls into native method Interop+Kernel32.FindStringOrdinal() in QuickWatch
UrlHelper throws NullReferenceException," Trying to create a URLHelper for testing purposes throws a NullReferenceException.Example: Every time I run this Test, the Exception that is thrown in Url = new UrlHelper(new ActionContext()) is:Exception.Message: Message: System.NullReferenceException : Object reference not set to an instance of an object.Exception.StackTrace: UrlHelperBase.ctor(ActionContext actionContext) ControllerUnitTest.AuthenticateAsyncTest()Using: xUnit 2.4.1, Microsoft.NETCore.App 2.2.0, Microsoft.AspNetCore.Routing.Abstractions 2.2.0To recreate the Exception:Create a empty MVC core 2.2 solutionCreate a xunit test ProjectInstall the NuGet Microsoft.AspNetCore.Mvc.Core 2.2.0Write in the test: var Url = new UrlHelper(new ActionContext());Run testShould look like this: My questions:Is there a bug, or why is this not working?Literature to a workaround or links are appreciated? <code>  [Fact]public async void AuthenticateAsyncTest(){ // Arrange var controller = new Controller(serviceProvider) { Url = new UrlHelper(new ActionContext()) // Exception thrown }; // Act var result = await controller.Authenticate() as ViewResult; // Assert Assert.NotNull(result);} using Microsoft.AspNetCore.Mvc;using Microsoft.AspNetCore.Mvc.Routing;using Xunit;namespace XUnitTestProject1{ public class UnitTest1 { [Fact] public void Test1() { var Url = new UrlHelper(new ActionContext()); } }}",Trying to Test a Controller with a UrlHelper
Where should handle TreeView's Invoke method between two WinForms?," I have two WinForms (Setting and frmMain). I have a TreeView in Setting's form and I want to call its FillTree method in the second form frmMain.I'm using the TreeView.Invoke for the threading purposes.Here is my code for TreeView filling data in Setting's form : FillTree method from above code, I wants call it in my second form frmMain which I tried like so: When I call FillTree method it show me error like this: Invoke or BeginInvoke cannot be called on a control until the window handle has been created.I real wants to know, where should be handle TreeView's Invoke method in my second winform frmMain?I'm following these links (but no avail):1) Populating TreeView on a Background Thread2) How to add object in treeview from another thread3) How can i invoke a method called from backgroundworker dowork event?Edited for Visualizing ProblemI have tried it with TreeView its not working then I Tried it with ListBox but the problem is still same.Problem: I've a method (which populate my ListBox) in WinForm settingsWindow and I want to call that method in my second WinForm frmMain.Settings form screenshot:frmMain form screenshot:Problem GIF :Settings form Code for ListBox Populating : Calling PopulateGroupListData in second form frmMain 's method: <code>  TreeNode parentNode;public void FillTree(DataTable dtGroups, DataTable dtGroupsChilds){ treeViewGroups.Nodes.Clear(); if (dtGroups == null) return; foreach (DataRow rowGroup in dtGroups.Rows) { parentNode = new TreeNode { Text = rowGroup[""Groupname""].ToString(), Tag = rowGroup[""Groupid""] }; treeViewGroups.Invoke(new Add(AddParent), new object[] { parentNode }); if (dtGroupsChilds == null) continue; foreach (DataRow rowUser in dtGroupsChilds.Rows) { if (rowGroup[""Groupid""] == rowUser[""Groupid""]) { TreeNode childNode = new TreeNode { Text = rowUser[""Username""].ToString(), Tag = rowUser[""Phone""] }; treeViewGroups.Invoke(new Add(AddParent), new object[] { childNode }); System.Threading.Thread.Sleep(1000); } } } treeViewGroups.Update();}public delegate void Add(TreeNode tn);public void AddParent(TreeNode tn){ treeViewGroups.Nodes.Add(tn);}public void AddChild(TreeNode tn){ parentNode.Nodes.Add(tn);} Settings settingsWindow;public frmMain(){ InitializeComponent(); settingsWindow = new Settings(this);}private void SomeMethod(){ //Two DataTables (dt1 and dt2) are passed from frmMain form settingWindow.FillTree(dt1, dt2);} public void PopulateGroupListData(DataTable dt){ listGroups.DataSource = null; listGroups.DisplayMember = ""GroupName""; listGroups.ValueMember = ""Groupid""; listGroups.DataSource = dt; if (listGroups.Items.Count > 0) listGroups.SelectedItem = listGroups.Items[0];} void onCompleteReadFromServerStream(IAsyncResult iar){ /... some code String[] arr1 = ServerMessage[1].Split('&'); string Groupid1 = arr1[0]; string GroupName1 = arr1[1]; GroupsList.Rows.Add(Groupid1, GroupName1); settingsWindow.PopulateGroupListData(GroupsList); /... some code}",Where should TreeView's Invoke method between two WinForms be handled?
Loading Related Data and use where," I have the following models And now I can load all people with all their roles using the following code: But I wantn't load all data to List, I need load PersonRole according entered typeOfDutyId.I am trying to solve this with the following code But VS throw error InvalidOperationException: The Include property lambda expression 'p => {from PersonRole t in p.PersonRoles where ([t].RoleInDuty.typeOfDutyId == __typeOfDuty_typeOfDutyId_0) select [t]}' is invalid. The expression should represent a property access: 't => t.MyProperty'. To target navigations declared on derived types, specify an explicitly typed lambda parameter of the target type, E.g. '(Derived d) => d.MyProperty'. For more information on including related data, see http://go.microsoft.com/fwlink/?LinkID=746393.As I understand I can't access property RoleInDuty.typeOfDutyId because i'm not include it yet. I solved this problem with the following code <code>  public class Person{ public int PersonId { get; set; } public string Name { get; set; } public List<PersonRole> PersonRoles { get; set; }}public class RoleInDuty{ public int roleInDutyId { get; set; } public string Name { get; set; } public int typeOfDutyId { get; set; } public TypeOfDuty typeOfDuty { get; set; } public List<PersonRole> PersonRoles { get; set; }}public class PersonRole{ public int PersonId { get; set; } public Person Person { get; set; } public int RoleInDutyId { get; set; } public RoleInDuty RoleInDuty { get; set; }} var people = _context.Persons .Include(p => p.PersonRoles) .ThenInclude(e => e.RoleInDuty).ToList(); people = _context.Persons .Include(p => p.PersonRoles .Where(t=>t.RoleInDuty.typeOfDutyId == Id)).ToList(); people = _context.Persons .Include(p => p.PersonRoles) .ThenInclude(e=>e.RoleInDuty).ToList(); foreach (Person p in people){ p.PersonRoles = p.PersonRoles .Where(e => e.RoleInDuty.typeOfDutyId == Id) .ToList();}","Filtering ""include"" entities in EF Core"
Filtering parent based on child collection property in EF Core," I have the following models And now I can load all people with all their roles using the following code: But I wantn't load all data to List, I need load PersonRole according entered typeOfDutyId.I am trying to solve this with the following code But VS throw error InvalidOperationException: The Include property lambda expression 'p => {from PersonRole t in p.PersonRoles where ([t].RoleInDuty.typeOfDutyId == __typeOfDuty_typeOfDutyId_0) select [t]}' is invalid. The expression should represent a property access: 't => t.MyProperty'. To target navigations declared on derived types, specify an explicitly typed lambda parameter of the target type, E.g. '(Derived d) => d.MyProperty'. For more information on including related data, see http://go.microsoft.com/fwlink/?LinkID=746393.As I understand I can't access property RoleInDuty.typeOfDutyId because i'm not include it yet. I solved this problem with the following code <code>  public class Person{ public int PersonId { get; set; } public string Name { get; set; } public List<PersonRole> PersonRoles { get; set; }}public class RoleInDuty{ public int roleInDutyId { get; set; } public string Name { get; set; } public int typeOfDutyId { get; set; } public TypeOfDuty typeOfDuty { get; set; } public List<PersonRole> PersonRoles { get; set; }}public class PersonRole{ public int PersonId { get; set; } public Person Person { get; set; } public int RoleInDutyId { get; set; } public RoleInDuty RoleInDuty { get; set; }} var people = _context.Persons .Include(p => p.PersonRoles) .ThenInclude(e => e.RoleInDuty).ToList(); people = _context.Persons .Include(p => p.PersonRoles .Where(t=>t.RoleInDuty.typeOfDutyId == Id)).ToList(); people = _context.Persons .Include(p => p.PersonRoles) .ThenInclude(e=>e.RoleInDuty).ToList(); foreach (Person p in people){ p.PersonRoles = p.PersonRoles .Where(e => e.RoleInDuty.typeOfDutyId == Id) .ToList();}","Filtering ""include"" entities in EF Core"
Run script based on sound level in vb.net," I'm designing an application to farm one of my games for me. However, The approach I'm going with is to listen for a sound or spike in sound levels before running a desired macro combination. The audio I'm looking to monitor is the current PC's audio output, not a microphone or external device.This subject seem's to be vary vague on tutorials or information, however from my knowledge I found a post here that explains to use a BuckSoft.DirectSound project?So based on the information I found, I assume you do something like the following? From personal prospective I would love to help clarify a solution to the public as this topic is not well documented and avoided. I'm open to all solutions or suggestions, however, my focus is on vb.net and will consider C# if needed.Another option that I have seen is the CoreAudio API. I have seen this API used on multiple posts for the ability to extract the current sound levels, however I have not seen examples for reading the current Master VU meter and fader data/Levels. Data I'm looking to gather:As showed bellow, I'm NOT looking to gather the physical sound level % but rather looking to run actions if the VU levels spike from 0. This means if I play a video or sound file, the application will hear a sound coming from the current work station and perform a desired action.Bellow will be my rough example of how I plan to use or collect data from my prospective. Using an timer within vb.net I can have an statement consistently looking for an change in ""VUSoundLevels"" (Not a real statement) and run a script when an change/input happens. <code>  If AnalogSignalMeter1.LeftLevel > 0 Or AnalogSignalMeter1.RightLevel > 0 Then ' Do SomethingEnd If Private Function GetVol() As Integer 'Function to read current volume setting Dim MasterMinimum As Integer = 0 Dim DevEnum As New MMDeviceEnumerator() Dim device As MMDevice = DevEnum.GetDefaultAudioEndpoint(EDataFlow.eRender, ERole.eMultimedia) Dim Vol As Integer = 0 With device.AudioEndpointVolume Vol = CInt(.MasterVolumeLevelScalar * 100) If Vol < MasterMinimum Then Vol = MasterMinimum / 100.0F End If End With Return VolEnd Function Private Sub Timer1_Tick() If VUSoundLevels > 0 Then ' Run Code & Exit Loop End IFEnd Sub",Run script based on sound VU level in vb.net
Asp.net Core action does not return 401 (Unauthorized) when using Authorize attribute?," I wanted to add a principle onto the thread by myself , without using the Identity mechanism which really reminds me the old membership/forms authentication mechanics.So I've managed (successfully) to create a request with principle : MyAuthMiddleware.cs The Configure method: And here is the Action in the Controller: (Notice Authorize attribute) Ok Let's try calling this method, Please notice that this does work :So where is the problem ? Please notice that there is an [Authorize] attribute. Now let's remove setting principle on the thread ( by removing this line ) : But now when I navigate to : I'm being redirected to : But I'm expecting to see Unauthorized error.I'm after WebApi alike responses. This is not a website but an API.Question:Why don't I see the Unauthorized error ? And how can I make it appear?Nb here is my ConfigureServices: EDITCurrently What I've managed to do is to use OnRedirectionToLogin : But it will be really disappointing if that's the way to go. I'm expecting it to be like webapi. <code>  public class MyAuthMiddleware{ private readonly RequestDelegate _next; public MyAuthMiddleware(RequestDelegate next ) { _next = next; } public async Task Invoke(HttpContext httpContext) { var claims = new List<Claim> { new Claim(""userId"", ""22222222"") }; ClaimsIdentity userIdentity = new ClaimsIdentity(claims ,""MyAuthenticationType""); ClaimsPrincipal principal = new ClaimsPrincipal(userIdentity); httpContext.User = principal; await _next(httpContext); }} public void Configure(IApplicationBuilder app, IHostingEnvironment env) { //app.UseAuthentication(); //removed it. I will set the thread manually if (env.IsDevelopment()) app.UseDeveloperExceptionPage(); app.UseMyAuthMiddleware(); // <---------- Myne app.UseMvc(); app.Run(async context => { await context.Response.WriteAsync(""Hello World!""); }); } [HttpGet] [Route(""data"")] [Authorize] public IActionResult GetData() { var a=User.Claims.First(f => f.Type == ""userId""); return new JsonResult(new List<string> {""a"", ""b"",a.ToString() , User.Identity.AuthenticationType}); } //httpContext.User = principal; // line is remarked http://localhost:5330/api/cities/data http://localhost:5330/Account/Login?ReturnUrl=%2Fapi%2Fcities%2Fdata public void ConfigureServices(IServiceCollection services) { services.AddAuthentication( CookieAuthenticationDefaults.AuthenticationScheme ) .AddCookie( CookieAuthenticationDefaults.AuthenticationScheme, a => { a.LoginPath = """"; a.Cookie.Name = ""myCookie""; }); services.AddMvc(); }",Asp.net Core action does not return 401 when using Authorize attribute on a thread without a principle?
MemoryCache.TryGetValue returns false if i put null in cache," In this code snippet i simply put null in MemoryCache and then check if this key exists: isInCache is false in this case. Is this behavior expected?I use .NET Core 2.2 Console app. <code>  var _cache = new MemoryCache(new MemoryCacheOptions()); _cache.Set<string>(cacheKey, null); var isInCache = _cache.TryGetValue(cacheKey, out string nothing);",Issues with Memory Cache. TryGetValue returns false
"Creating a custom SignInManager in Asp,Net Core 3 Identity"," I want to create a custom class for my SignInManager, so I've created a class that inherts from SignInManager<> as follows: and then I've added it in the services configuration in Startup.cs: The problem is that the default SignInManager<ApplicationUser> cannot be casted to a ApplicationSignInManager, so I get this error when accessing a page in whose controller the manager is injected: InvalidCastException: Unable to cast object of type 'Microsoft.AspNetCore.Identity.SignInManager`1[Socialize.Data.ApplicationUser]' to type 'Socialize.Utilities.Identity.ApplicationSignInManager'. <code>  public class ApplicationSignInManager : SignInManager<ApplicationUser>{ private readonly UserManager<ApplicationUser> _userManager; private readonly ApplicationDbContext _dbContext; private readonly IHttpContextAccessor _contextAccessor; public ApplicationSignInManager(UserManager<ApplicationUser> userManager, IHttpContextAccessor contextAccessor, IUserClaimsPrincipalFactory<ApplicationUser> claimsFactory, IOptions<IdentityOptions> optionsAccessor, ILogger<SignInManager<ApplicationUser>> logger, ApplicationDbContext dbContext, IAuthenticationSchemeProvider schemeProvider ) : base(userManager, contextAccessor, claimsFactory, optionsAccessor, logger, schemeProvider) { _userManager = userManager ?? throw new ArgumentNullException(nameof(userManager)); _contextAccessor = contextAccessor ?? throw new ArgumentNullException(nameof(contextAccessor)); _dbContext = dbContext ?? throw new ArgumentNullException(nameof(dbContext)); }} services.AddDefaultIdentity<ApplicationUser>(configure =>{ configure.User.AllowedUserNameCharacters += "" "";}).AddSignInManager<ApplicationSignInManager>() .AddDefaultUI(UIFramework.Bootstrap4) .AddEntityFrameworkStores<ApplicationDbContext>();",Creating a custom SignInManager in Asp.Net Core 3 Identity
How to consume scoped service with dependency in a background task ASP.NET Core 2.2," Here is my scenerio. I want to use background task to send newsletter to subscribed users. This is done by MailService, which has UnitOfWork as dependency. I tried the solution from docs.microsoft.comso in my case I use a method of IMailService instead of ILogger, but I'm getting an error: System.InvalidOperationException: 'Cannot consume scoped service >'Fit4You.Core.Data.IUnitOfWork' from singleton >'Microsoft.AspNetCore.Hosting.Internal.HostedServiceExecutor'.'I don't want to make my UnitOfWork or DbContext with Singleton lifetime. Is it possible to consume somehow a dependency of MailService which is scoped UnitOfWork?I know about IServiceScopeFactory but maybe don't know how to use it properly.I'm using .NET Core 2.2 and build in interface IHostedServiceScopedMailService: ConsumeScopedMailService: Startup.cs: MailService: <code>  public class ScopedMailService : IScopedMailService{ private readonly IMailService mailService; public ScopedMailService(IMailService mailService) { this.mailService = mailService; } public void DoWork() { mailService.SendNewsletterToSubscribedUsers(); }} public class ConsumeScopedMailService : IHostedService{ private Timer timer; private readonly IMailService mailService; public IServiceProvider Services { get; } public ConsumeScopedMailService(IServiceProvider services, IMailService mailService) { Services = services; this.mailService = mailService; } public Task StartAsync(CancellationToken cancellationToken) { var startTimeSpan = GetStartTimeSpan(); var periodTimeSpan = TimeSpan.FromSeconds(30); timer = new Timer(DoWork, null, startTimeSpan, periodTimeSpan); return Task.CompletedTask; } private void DoWork(object state) { using (var scope = Services.CreateScope()) { var scopedMailService = scope.ServiceProvider.GetRequiredService<IScopedMailService>(); scopedMailService.DoWork(); } } public Task StopAsync(CancellationToken cancellationToken) { timer?.Change(Timeout.Infinite, 0); return Task.CompletedTask; } public void Dispose() { timer?.Dispose(); } private TimeSpan GetStartTimeSpan() { var currentTime = DateTime.Now.Ticks; var executeTime = DateTime.Today.AddHours(8) .AddMinutes(0) .Ticks; long ticks = executeTime - currentTime; if (ticks < 0) { ticks = ticks + TimeSpan.TicksPerDay; } var startTimeSpan = new TimeSpan(ticks); return startTimeSpan; }} public void ConfigureServices(IServiceCollection services){ ... services.AddDbContext<Fit4YouDbContext>(options => options.UseSqlServer(Configuration.GetConnectionString(""MyConnectionString""))); services.AddScoped<IUnitOfWork, UnitOfWork>(); services.AddTransient<IMailService, MailService>(); services.AddHostedService<ConsumeScopedMailService>(); services.AddScoped<IScopedMailService, ScopedMailService>(); ...} public class MailService : IMailService { private readonly IUnitOfWork unitOfWork; public MailService(IUnitOfWork unitOfWork) { this.unitOfWork = unitOfWork; } public void SendNewsletterToSubscribedUsers() { // Some Code } }",How to consume scoped service with dependency in a background task
What happens with returning IEnumerable if used with async/await?," I am using Dapper to stream data from a very large set in SQL Server. It works fine with returning IEnumerable and calling Query(), but when I switch to QueryAsync(), it seems that the program tries to read all of the data from SQL Server instead of streaming.According to this question, it should work fine with buffered: false, which I am doing, but the question says nothing about async/await.Now according to this question, it's not straightforward to do what I want with QueryAsync().Do I understand correctly that enumerables are iterated when the context is switched for async/await?Another question if this is something that will be possible to do when the new C#8 async streaming is available? <code> ",What happens with returning IEnumerable if used with async/await (streaming data from SQL Server with Dapper)?
Can a long async-await chain cause big memory consumption ? ( theoretically)," Looking at this code: Let's say that a,b,c,d also have nested async awaits (and so on)Async/await POV - for each await , there is a state machine being kept.Question (theoretical): As each state machine is kept in memory, could this cause big memory consumption?It might be a vague question to ask, but if there are many states, it seems inevitable not to wonder about the sizes of state machines being kept. <code>  public async Task<T> ConsumeAsync() { await a(); await b(); await c(); await d(); //.. }",Can a long async-await chain cause big memory consumption? (theoretically)
there are no scaffolders supported for this item visual studio 2019," I'm using Visual Studio 2019 version 16.0.4, and I tried to create a view or a partial one on asp.net core 2.1 (in views folder) but I get an error There are no scaffolders supported for this itemThen I realized this problem happens when you have a folder which its name is ""Pages"" in your project that we use this folder for razor pages .If I remove the pages folder then the views scaffold works. When I put it back it is broken again.I don't know it is a bug or not but I need to use both pages and views together on my project... <code> ",There are no scaffolders supported for this item Visual Studio 2019
How to Seprate Code From UI In Blazor.Net," Reference to this VisualStudioMagazine article, I am trying to have code in a separate file instead of razor view.I tried: And ItemComponent: But it does not work , it shows that: Severity Code Description Project File Line Suppression State Error CS0115 'Item.BuildRenderTree(RenderTreeBuilder)': no suitable method found to override WebApplication1.Client D:\Other\blazor\WebApplication1.Client\obj\Debug\netstandard2.0\RazorDeclaration\Pages\ItemModule\Item.razor.g.cs 30 ActiveAlso as per tutorial page can not inherit BlazorComponent to ItemComponent because it failed to have reference.Is there any way to separate most of the code from Blazor view to a separate code file?Update 1After Making changes as per Chris Answer, it show exception System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. ---> System.Net.Sockets.SocketException: No connection could be made because the target machine actively refused it. at System.Net.Http.ConnectHelper.ConnectAsync(String host, Int32 port, CancellationToken cancellationToken) --- End of inner exception stack trace --- at System.Net.Http.ConnectHelper.ConnectAsync(String host, Int32 port, CancellationToken cancellationToken) at System.Threading.Tasks.ValueTask1.get_Result() at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean allowHttp2, CancellationToken cancellationToken) at System.Threading.Tasks.ValueTask1.get_Result() at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, CancellationToken cancellationToken) at System.Threading.Tasks.ValueTask1.get_Result() at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, CancellationToken cancellationToken) at System.Threading.Tasks.ValueTask1.get_Result() at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean doRequestAuth, CancellationToken cancellationToken) at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, CancellationToken cancellationToken) at System.Net.Http.HttpClient.FinishSendAsyncUnbuffered(Task1 sendTask, HttpRequestMessage request, CancellationTokenSource cts, Boolean disposeCts) at System.Net.Http.HttpClient.GetStringAsyncCore(Task1 getTask) at Microsoft.AspNetCore.Builder.BlazorMonoDebugProxyAppBuilderExtensions.GetOpenedBrowserTabs(String debuggerHost) at Microsoft.AspNetCore.Builder.BlazorMonoDebugProxyAppBuilderExtensions.DebugHome(HttpContext context) <code>  @page ""/Item""@using WebApplication1.Shared@using WebApplication1.Client.Services;@inject HttpClient Http@inherits ItemComponent@if (ItemList != null){ <table class=""table""> <thead> <tr> <th>ID</th> <th>Name</th> <th>Category</th> <th>Metal</th> <th>Price</th> <th>Quantity</th> </tr> </thead> <tbody> @foreach (var item in ItemList) { <tr> <td>@item.ID</td> <td>@item.Name</td> <td>@item.Category</td> <td>@item.Metal</td> <td>@item.Price</td> <td>@item.Quantity</td> </tr> } </tbody> </table>}@functions{ public ItemModel[] ItemList; ItemComponent IC = new ItemComponent(); protected override async Task OnInitAsync() { ItemList = IC.GetItems().Result; //ItemList = await Http.GetJsonAsync<ItemModel[]>(""api/Item/GetItems""); StateHasChanged(); }} using System.Threading.Tasks;using WebApplication1.Shared;using System.Net.Http;using Microsoft.AspNetCore.Components;using Microsoft.AspNetCore.Blazor;namespace WebApplication1.Client.Services{ public class ItemComponent { public async Task<ItemModel[]> GetItems() { ItemModel[] ItemList; HttpClient Http = new HttpClient(); ItemList = await Http.GetJsonAsync<ItemModel[]>(""api/Item/GetItems""); return ItemList; } }}",How to Separate Code From UI In Blazor.Net
What is the difference between the old ListViev and new CollectionView in Xamarin 4?," I don't understand what is different in Xamarin Form by new version 4.0 between old ListView and new CollectionView. Why is better to use CollectionView?I se help in microsoft docs, but don't se anything better.public CollectionView ();  <code> ",What is the difference between the old ListView and new CollectionView in Xamarin 4?
"ASP.NET Core 2.2, services.AddSingleton, service's constructor is never called"," tl;dr In a variation on the classic SignalR Chat app, I'm monitoring changes to a SQL Server table and reporting them in real-time through SignalR. Watch this video for 10 seconds to get the idea. My code is adapted from this project. The chat part works fine.Changes to the SQL Server table are supposed to be monitored by class SqlDependencyService. However, its constructor is never called, and that's where it should get a reference to the SignalR hub.Here's my Startup.ConfigureServices: And here's part of my SqlDependencyService class: Here's the service's interface: As stated, the constructor is never called. Additionally, I don't see how the Config method could possibly be invoked - some ASP.NET Core convention magic?I don't have this issue with the HomeController, whose constructor is called and passed an IHubContext<ChatHub>: <code>  services.AddSingleton<ISomeService, SomeService>();// SomeService not instantiated nor initialized? public void ConfigureServices(IServiceCollection services){ services.AddDbContext<ApplicationDbContext>(options => options.UseSqlServer(Configuration.GetConnectionString(""DefaultConnection""))); services.AddSignalR(); services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1); // No instantiation ?!? services.AddSingleton<IDatabaseChangeNotificationService, SqlDependencyService>(); // My lame attempt at forcing instantiation: SqlDependencyService sqlDS = serviceProvider.GetService<SqlDependencyService>(); //sqlDS.Config(); // Fails, sqlDS is null.} public class SqlDependencyService : IDatabaseChangeNotificationService { private readonly IConfiguration configuration; private readonly IHubContext<ChatHub> chatHub; // Never gets called! public SqlDependencyService(IConfiguration configuration, IHubContext<ChatHub> chatHub) { this.configuration = configuration; this.chatHub = chatHub; } // Never gets called! public void Config() { SubscribeToPersonTableChanges(); } private void SubscribeToPersonTableChanges() { // ... } // ... } public interface IDatabaseChangeNotificationService{ void Config();} public class HomeController : Controller{ private readonly IHubContext<ChatHub> chatHub; public HomeController(IHubContext<ChatHub> chatHub) { this.chatHub = chatHub; } // ...}","services.AddSingleton, service's constructor is never called"
How to handle multiple SPA application in aspnetcore," I have an ASP.NET Core Web API application, I want to serve two Angular apps, one for admin and one for users.In production, I don't use angular CLI tools so there is only some static files of two angular web applications.Admin files are in /angular/admin and user files are in /angular/user.So, how can I serve them? I tried multiple calls to IServiceCollection.AddSpaStaticFiles but they override each other. [From source repository I found this is Singleton services] <code> ",How to handle multiple SPA application in ASP.NET Core
is-operator causes unneccessary boxing?," The documentation of constant pattern matching with the is-operator (expr is constant) states:The constant expression is evaluated as follows:If expr and constant are integral types, the C# equality operator determines whether the expression returns true (that is, whether expr == constant).Otherwise, the value of the expression is determined by a call to the static Object.Equals(expr, constant) method.Therefore, when using this code I expect it to use the == operator (case 1) and generate this code: However, in reality, the integer parameter and the constant (literal) are boxed in order to be passed to the static Object.Equals method (case 2): Why is that the case? <code>  public bool IsZero(int value){ return value is 0;} .method public hidebysig instance bool IsZero( int32 'value' ) cil managed{ .maxstack 8 ldarg.1 ldc.i4.0 ceq ret} .method public hidebysig instance bool IsZero( int32 'value' ) cil managed{ .maxstack 8 ldc.i4.0 box [mscorlib]System.Int32 ldarg.1 box [mscorlib]System.Int32 call bool [mscorlib]System.Object::Equals(object, object) ret}",Why does the is-operator cause unnecessary boxing?
Automatically add references from PackageReference to NuGet package on pack," In my project I reference some packages with PackageReference like that:But, if I run pack command, it doesn't include them unless I manually add them to .nuspec file.I want to automatically add packages from PackageReference in my C# project to NuGet packages.I pack my project using nuget pack ProjectFile on Build or manually.Current nuspec with dependencies:P.S. AFAIK references from packages.config are automatically added, but I don't want to use this file. I want to use PackageReferences instead. <code> ",Auto-add PackageReferences to NuGet package
How can I get the current route name with ASP.NET Core 2.2?," I have an application that is written on the top of ASP.NET Core 2.2 framework.I have the following controller How can I get the route name in the action and/or the view? <code>  public class TestController : Controller{ [Route(""some-parameter-3/{name}/{id:int}/{page:int?}"", Name = ""SomeRoute3Name"")] [Route(""some-parameter-2/{name}/{id:int}/{page:int?}"", Name = ""SomeRoute2Name"")] [Route(""some-parameter-1/{name}/{id:int}/{page:int?}"", Name = ""SomeRoute1Name"")] public ActionResult Act(ActVM viewModel) { // switch the logic based on the route name return View(viewModel); }}",How can I get the current route name with ASP.NET Core?
How to set relative paths for working directory and start action in csproj," In a C# project I try to use relative paths for ""Start external program"" and for ""Working directory"".I tried relative paths starting with ../ and relative paths with $(SolutionDir) / $(ProjectDir)With all tries I get an error popup. (The external program cannot be found / the working directory you entered does not exist) - see screenshots.Is it possible to use relative paths and how? I also searched on msdn but there is almost no info about the csproj.user file. We need this as we don't like to force a folder structure for all developers.This is stored in the csproj.user file (myproject.csproj.user) like this: <code>  <?xml version=""1.0"" encoding=""utf-8""?><Project ToolsVersion=""15.0"" xmlns=""http://schemas.microsoft.com/developer/msbuild/2003""> <PropertyGroup> <ProjectView>ProjectFiles</ProjectView> </PropertyGroup> <PropertyGroup Condition=""'$(Configuration)|$(Platform)' == 'Debug|AnyCPU'""> <StartAction>Program</StartAction> <StartWorkingDirectory>%24%28SolutionDir%29\..\..\..\..\mydir</StartWorkingDirectory> <StartProgram>%24%28SolutionDir%29\..\..\dir\myapplication.exe</StartProgram> </PropertyGroup></Project>",Use relative paths for working directory & start in C# project
How to set relative paths for working directory and start action in csproj.user," In a C# project I try to use relative paths for ""Start external program"" and for ""Working directory"".I tried relative paths starting with ../ and relative paths with $(SolutionDir) / $(ProjectDir)With all tries I get an error popup. (The external program cannot be found / the working directory you entered does not exist) - see screenshots.Is it possible to use relative paths and how? I also searched on msdn but there is almost no info about the csproj.user file. We need this as we don't like to force a folder structure for all developers.This is stored in the csproj.user file (myproject.csproj.user) like this: <code>  <?xml version=""1.0"" encoding=""utf-8""?><Project ToolsVersion=""15.0"" xmlns=""http://schemas.microsoft.com/developer/msbuild/2003""> <PropertyGroup> <ProjectView>ProjectFiles</ProjectView> </PropertyGroup> <PropertyGroup Condition=""'$(Configuration)|$(Platform)' == 'Debug|AnyCPU'""> <StartAction>Program</StartAction> <StartWorkingDirectory>%24%28SolutionDir%29\..\..\..\..\mydir</StartWorkingDirectory> <StartProgram>%24%28SolutionDir%29\..\..\dir\myapplication.exe</StartProgram> </PropertyGroup></Project>",Use relative paths for working directory & start in C# project
Rounding of last digit changes after Windows update," After Windows has updated, some calculated values have changed in the last digit, e.g. from -0.0776529085243926 to -0.0776529085243925. The change is always down by one and both even and odd numbers are affected. This seems to be related to KB4486153, as reverting this update changes the values back to the previous ones.This change can be seen already when debugging in Visual Studio and hovering over the variable. The value is later written to an output file and changes therein as well (without running the debugger).Minimal reproducible example BackgroundThe calculated value comes from Disregarding the loss of precision in floating-point arithmetic, I can do the calculation in the Immediate window and get -0.07765290852439255 both before and after the upgrade. However, when hovering over the output variable , I see {[2011-01-12 00:00:00, -0.0776529085243926]} before the upgrade and {[2011-01-12 00:00:00, -0.0776529085243925]} after, and this difference is also propagated to an output file.It seems like the calculated value is the same before and after the update, but its representation is rounded differently.The input values are Target framework is set to .NET Framework 4.6.1QuestionIs there something I can do to get the previous behaviour while keeping the updates? I know about loss of precision in floating-point calculations, but why does this change happen after an update and how can we guarantee that future updates don't change the representation of values?KB4486153 is an update for Microsoft .NET Framework 4.8, see https://support.microsoft.com/en-us/help/4486153/microsoft-net-framework-4-8-on-windows-10-version-1709-windows-10-vers <code>  var output = -0.07765290852439255;Trace.WriteLine(output); // This printout changes with the update.var dictionary = new Dictionary<int, double>();dictionary[0] = output; // Hover over dictionary to see the change in debug mode output[date] = input[date] / input[previousDate] - 1; {[2011-01-11 00:00:00, 0.983561000400506]} {[2011-01-12 00:00:00, 0.907184628008246]}",Rounding of last digit changes after Windows .NET update
Do multiple instances of System.Random still use the same seed?," I've seen several articles talking about not generating too many System.Random instances too closely together because they'll be seeded with the same value from the system clock and thus return the same set of numbers:https://stackoverflow.com/a/2706537/2891835https://codeblog.jonskeet.uk/2009/11/04/revisiting-randomness/https://docs.microsoft.com/en-us/dotnet/api/system.random?view=netframework-4.8#instantiating-the-random-number-generatorThat appears to be true for .net framework 4.8.Looking at the source code for .net core, however, it looks like instances of System.Random generated on the same thread are seeded from a [ThreadStatic] generator.So it would seem to me that, in .net core, you are now safe to do something like: Is this true? Am I missing something?Note: Assume we're talking about a single thread here (although I'm not sure it matters because it looks like .net core uses bcrypt or something to seed the global generator per-thread?).EDIT:This is now tracked in this ticket. <code>  Random[] randoms = new Random[1000];for (int i = 0; i < randoms.Length; i++){ randoms[i] = new Random();}// use Random instances and they'll all have distinct generated patterns",Do multiple instances of System.Random still use the same seed in .Net Core?
Add field for a digital signature to pdf," I create a new PDF file using PDFsharp and MigraDoc.Now I want to add a field where the user can click on it and select a certificate for digital signing the file.I found in the web, that this should be possible with AcroForms.But I wasn't able to use AcroForm because it is always null.My current example code: Why is this property null? What can I do to set this to a correct value?Or better, how can I add a field to select the digital certificate? <code>  Document document = new Document();Section section = document.AddSection();section.AddParagraph(""Signature Test"");PdfDocumentRenderer pdfRenderer = new PdfDocumentRenderer(false, PdfFontEmbedding.Always);pdfRenderer.Document = document;pdfRenderer.RenderDocument();// NullPointerException at the following line. AcroForm is null pdfRenderer.PdfDocument.AcroForm.Elements.Add(PdfAcroForm.Keys.SigFlags, new PdfInteger(3));const string filename = ""HelloWorld.pdf"";pdfRenderer.PdfDocument.Save(filename);Process.Start(filename);",Add field for a digital signature to PDF
"C# Source array was not long enough. Check srcIndex and length, and the array's lower bounds"," I have a C# list which will be added value in Parallel Foreach. Now it always returns exception System.IndexOutOfRangeException. When I pointed to the listTotalCost, it has the following message Source array was not long enough. Check srcIndex and length, and the array's lower bounds.Is it caused by the thread safe problem and any other issue? Here is my code <code>  List<decimal> listTotalCost = new List<decimal>();Parallel.ForEach(listDates, dates =>{ using (DataSet result = calculationMgr.EvaluateFormula(companyID, dates.startDate, dates.endDate, subIndicatorID.Value.ToString(), null, false, null , (int)Common.Systems.Sustainability.Constants.ApprovalStatuses.Approved )) { DataRow dr = result.Tables[0].Rows[0]; //totalPrice = Convert.ToDecimal(dr[""Result""]).ToString(""#,##0.00""); decimal? temp = Common.Util.TryToConvertToDecimal(dr, ""Result""); if (temp != null) { //the following line is the error happened listTotalCost.Add(temp.Value); } }});","Source array was not long enough. Check srcIndex and length, and the array's lower bounds"
Model binding stoped working after migrating .net core from 2.2 to 3.0-preview-9," I have an Angular front-end app and an ASP.NET Core back-end app. Everything was fine until I decided to migrate from ASP.NET Core 2.2 to 3.0-preview-9.For example, I have a DTO class: And an example JSON request: Before migration, this was a valid request because 123 was parsed as a decimal. But now, after migration, I am getting an HTTP 400 error with this body: In addition, it doesn't hit the first line of my methodit is thrown before, probably during model binding.If I send the following, however: Everything works fine. But this means that I need to change every request I have written so far. The same thing is true with all other data types (int, bool, ).Does anybody know how I can avoid this and make it work without changing my requests? <code>  public class DutyRateDto{ public string Code { get; set; } public string Name { get; set; } public decimal Rate { get; set; }} { ""name"":""F"", ""code"":""F"", ""rate"":""123""} { ""type"": ""https://tools.ietf.org/html/rfc7231#section-6.5.1"", ""title"": ""One or more validation errors occurred."", ""status"": 400, ""traceId"": ""|3293cead-4a35656a3ae5e95b."", ""errors"": { ""$.rate"": [ ""The JSON value could not be converted to System.Decimal. Path: $.rate | LineNumber: 0 | BytePositionInLine: 35."" ] }} { ""name"":""F"", ""code"":""F"", ""rate"":123}",Model binding stopped working after migrating from .NET Core 2.2 to 3.0-preview-9
"AspNet Core 3.0 [FromBody] string content returns ""The JSON value could not be converted to System.String."""," Using [FromBody] string content on an ApiController in ASP.NET Core 3.0 returns a validation error: when the client post data with content-type : application/jsonHow do I get the raw json data as a string in my api controller in .NET Core 3.0? Without the client having to update its content type? <code>  {""type"": ""https://tools.ietf.org/html/rfc7231#section-6.5.1"", ""title"":""One or more validation errors occurred."", ""status"":400, ""traceId"":""|9dd96d96-4e64bafba4ba0245."", ""errors"":{""$"":[""The JSON value could not be converted to System.String. Path: $ | LineNumber: 0 | BytePositionInLine: 1.""]}}","ASP.NET Core 3.0 [FromBody] string content returns ""The JSON value could not be converted to System.String."""
How can I make javascript get the position for the same object in different places," Im trying to get the position of same object in different places, where ,with a javascript function, I should get different top positions but thats not the scenario. The script code: The Index.razor code: As you can see here Im doing a for in the same div, where he goes down the line. What I want from this is for every div posted it should give me a different value of offsetTop, because he goes down the line one by one. How can I manage this problem?For a better understanding here you have a demo https://blazorfiddle.com/s/4g57o82k . As you can see in the demo the value for each Click Here is the same.Thank you for your attention. <code>  <script type=""text/javascript""> window.ShowAlert = function myFunction(element) { console.log(""Hello World.""); alert(element.offsetTop); }</script> @inject IJSRuntime jsRuntime<div> @for (int i = 0; i < 10; i++) { <div @onclick=""MemberFunction"" @ref=""memberRef"">Click Here</div> }</div>@code { private ElementReference memberRef; void MemberFunction() { jsRuntime.InvokeAsync<object>(""ShowAlert"", memberRef); }}",Using @ref inside for loop to get element reference
SignalR Core on .NET 4.6.1," As said in the SignalR differences documentation we can use SignalR Core on .NET 4.6.1 and latter...So I know the code for the startup and configuration for both cases:SignalR Core:ConfigureServices Startup SignalR:Startup And my question is, what I need to do in the .NET 4.6.1 startup to map my SignalR hub and etc...?I can't find any documentation about this particular case.Update1:I tried to run the same code and obviously changed the client code to use the SignalR core approach and what I get now is (not authorized) during negotiation request. <code>  //Add SignalR serviceservices.AddSignalR(); app.UseSignalR(routes =>{ routes.MapHub<NotificationsHub>(""/notification"");}); app.Map(""/signalr"", map =>{ map.UseCors(CorsOptions.AllowAll); var hubConfiguration = new HubConfiguration { }; hubConfiguration.EnableDetailedErrors = true; map.RunSignalR(hubConfiguration);});",Using SignalR Core on .NET 4.6.1
What is UnityMainThreadDispatcher?," I read this code.https://github.com/johnjcsmith/iPhoneMoCapUnity/blob/master/Assets/NetworkMeshAnimator.csThere is the following description around the 62nd line of the code. What kind of processing is this doing? There is code on GitHub, but is it a standard feature in Unity? <code>  if (UnityMainThreadDispatcher.Exists()) { dispatcher = UnityMainThreadDispatcher.Instance (); } ",What does UnityMainThreadDispatcher do?
ASP.NET Core 3.0 System.Text.Json AddJsonOptions Camel Case Options," In ASP.NET Core 3.0 Web API project, how do you specify System.Text.Json serialization options to serialize/deserialize Pascal Case properties to Camel Case and vice versa automatically?Given a model with Pascal Case properties such as: And code to use System.Text.Json to deserialize a JSON string to type of Person class: Does not successfully deserialize unless JsonPropertyName is used with each property like: I tried the following in startup.cs, but it did not help in terms of still needing JsonPropertyName: How can you set Camel Case serialize/deserialize in ASP.NET Core 3.0 using the new System.Text.Json namespace?Thanks! <code>  public class Person{ public string Firstname { get; set; } public string Lastname { get; set; }} var json = ""{\""firstname\"":\""John\"",\""lastname\"":\""Smith\""}"";var person = JsonSerializer.Deserialize<Person>(json); public class Person{ [JsonPropertyName(""firstname"")] public string Firstname { get; set; } [JsonPropertyName(""lastname"")] public string Lastname { get; set; }} services.AddMvc().AddJsonOptions(options =>{ options.JsonSerializerOptions.DictionaryKeyPolicy = JsonNamingPolicy.CamelCase; options.JsonSerializerOptions.PropertyNamingPolicy = JsonNamingPolicy.CamelCase;});// also the following given it's a Web API projectservices.AddControllers().AddJsonOptions(options => { options.JsonSerializerOptions.DictionaryKeyPolicy = JsonNamingPolicy.CamelCase; options.JsonSerializerOptions.PropertyNamingPolicy = JsonNamingPolicy.CamelCase; });",ASP.NET Core 3.0 System.Text.Json Camel Case Serialization
Throw exception when convert dynamic object to json with System.Text.Json.Serialization," I want to convert a dynamic object to json string. It worked perfect when I used Newtonsoft.Json at past. when I upgraded .net core to 3.0 and used System.Text.Json instead, it was bad.See the code: If I want to persist using System.Text.Json to convert the dynamic object because I hear that it is faster then other json converts, how could I do? <code>  using System;using System.Collections.Generic;using System.Dynamic;namespace ConsoleApp{ class Program { static void Main(string[] args) { dynamic product = new ExpandoObject(); product.ProductName = ""Elbow Grease""; product.Enabled = true; product.Price = 4.90m; product.StockCount = 9000; product.StockValue = 44100; product.Tags = new string[] { ""Real"", ""OnSale"" }; // Will output: { ""ProductName"":""Elbow Grease"",""Enabled"":true,""Price"":4.90, // ""StockCount"":9000,""StockValue"":44100,""Tags"":[""Real"",""OnSale""]} var json1 = Newtonsoft.Json.JsonConvert.SerializeObject(product); Console.WriteLine(json1); // Both will throw exception: System.InvalidCastException:Unable to // cast object of type '<GetExpandoEnumerator>d__51' to type // 'System.Collections.IDictionaryEnumerator'. var json2 = System.Text.Json.JsonSerializer.Serialize(product); Console.WriteLine(json2); var json3 = System.Text.Json.JsonSerializer.Serialize<IDictionary<string, object>>(product as IDictionary<string, object>); Console.WriteLine(json3); Console.ReadKey(); } }}",Throw exception when converting dynamic object to json with System.Text.Json.Serialization
Streaming data from the database - ASPNET Core & SqlDataReader.GetStream()," I'm trying to minimize loading large objects into memory from the database when sending them out from an ASP.NET Core site because I'm hitting OutOfMemoryException on occasion.I figured I'd stream it. Now from my research SQL Server supports this so long as you've specified CommandBehavior.SequentialAccess in your command. I figured if I'm going to stream it, I might as well stream it as directly as possible, so I'm pretty much streaming it directly from the DataReader to the ASP.NET MVC ActionResult. But once the FileStreamResult (hidden under the call to File()) has finished executing, how do I clean up my reader/command? The connection was provided by DI, so that's not a problem, but I create the reader/command in the call to GetDocumentStream().I have a subclass of ActionFilterAttribute registered in MVC, so that gives me an entry point I can call for ActionFilterAttribute.OnResultExecuted(), but I have absolutely no idea on what to put there other than my current logic that deals with cleaning up my database transaction and commit/rollback stuff (not included since it's not really relevant).Is there a way to cleanup after my DataReader/Command and still provide a Stream to File()? <code>  public class DocumentsController : Controller{ private DocumentService documentService; public FilesController(DocumentService documentService) { this.documentService = documentService; } public IActionResult Stream(Guid id, string contentType = ""application/octet-stream"") // Defaults to octet-stream when unspecified { // Simple lookup by Id so that I can use it for the Name and ContentType below if(!(documentService.GetDocument(id)) is Document document) return NotFound(); var cd = new System.Net.Http.Headers.ContentDispositionHeaderValue(""inline"") {FileNameStar = document.DocumentName}; Response.Headers.Add(Microsoft.Net.Http.Headers.HeaderNames.ContentDisposition, cd.ToString()); return File(documentService.GetDocumentStream(id), document.ContentType ?? contentType); } /* public class Document { public Guid Id { get; set; } public string DocumentName { get; set; } public string ContentType { get; set; } } */}public class DocumentService{ private readonly DbConnection connection; public DocumentService(DbConnection connection) { this.connection = connection; } /* Other content omitted for brevity */ public Stream GetDocumentStream(Guid documentId) { //Source table definition /* CREATE TABLE [dbo].[tblDocuments] ( [DocumentId] [uniqueidentifier] NOT NULL, [ContentType] [varchar](100) NULL, [DocumentName] [varchar](100) NULL, [DocumentData] [varbinary](max) NULL CONSTRAINT [PK_DocumentId] PRIMARY KEY NONCLUSTERED ([DocumentID] ASC) ) GO */ const string query = ""SELECT DocumentData FROM tblDocuments WHERE DocumentId = @documentId""; //build up the command var command = connection.CreateCommand(); command.CommandText = query; var parameter = command.CreateParameter(); parameter.DbType = System.Data.DbType.Guid; parameter.ParameterName = ""@documentId""; parameter.Value = documentId; command.Parameters.Add(parameter); //Execute commmand with SequentialAccess to support streaming the data var reader = command.ExecuteReader(System.Data.CommandBehavior.SequentialAccess); if(reader.Read()) return reader.GetStream(0); else return Stream.Null; }}",Streaming data from the database - ASP.NET Core & SqlDataReader.GetStream()
How to register typed httpClient service witch autofac?," I'm creating MVC web application which calls an api using .net core 2.2 using separate HttpClients to call each controller (same api).Ex:For user controller actions : UserService (httpclient)For post controller actions : PostService (httpclient)In startup.cs I use DI as: In my handler : But when invoking command handler I get this error: None of the constructors found with 'Autofac.Core.Activators.Reflection.DefaultConstructorFinder' on type 'xxx.Application.Services.Users.UserService' can be invoked with the available services and parameters: Cannot resolve parameter 'System.Net.Http.HttpClient httpClient' of constructor 'Void .ctor(System.Net.Http.HttpClient, xxx.Application.Configurations.IApplicationConfigurations, Microsoft.Extensions.Logging.ILogger`1[xxx.Application.Services.Users.UserService])'.But I've registered services in autofac module: Here is my UserService class constructor: I have two questions:What does the above error mean?Is it good practice to use separate httpclients for different controllers in api? <code>  services.AddHttpClient<IUserService, UserService>();services.AddHttpClient<IPostService, PostService>(); public class CommandHandler : IRequestHandler<Command, BaseResponse>{ private readonly IUserService _userService; public CommandHandler(IUserService userService) { _userService = userService; } public Task<BaseResponse> Handle(Command request, CancellationToken cancellationToken) { throw new System.NotImplementedException(); }} public class ServiceModule : Module{ protected override void Load(ContainerBuilder builder) { builder.RegisterAssemblyTypes(typeof(ServiceModule).Assembly) .Where(t => t.Namespace.StartsWith(""xxx.Application.Services"")) .AsImplementedInterfaces().InstancePerLifetimeScope(); }} public UserService (HttpClient httpClient, IApplicationConfigurations applicationConfig, ILogger<UserService> logger){ _httpClient = httpClient; _applicationConfig = applicationConfig; _logger = logger; _remoteServiceBaseUrl = $""{_applicationConfig.WebApiBaseUrl}"";}",How to register typed httpClient service with autofac?
Trouble running C# getting scriptcs error," This is my first time using Visual Studio Code and I am trying to run a simple code on it but it is giving me an error that says: 'scriptcs' is not recognized as an internal or external command, operable program or batch file.I have this as code: I have tried installing the Scriptcs Runner, but still the same issue. Can anybody suggest something else?Edit:After many of your suggestions I tried the following:Created an entire new folder without spaces and named the files the same way.Re-installed the scriptcs Runner extension from VS Code Extension manager.Doubled checked my code. It is running on online c# compiler, but not in VS Code.Problem is still the same. Getting the above error. <code>  using System;struct Employee{ public int Id { get; set; } public string FullName { get; set; }}public class MyClass{ public static void Main(){ Employee obj= new Employee(); obj.FullName = ""Hello World""; Console.WriteLine(obj.FullName); }}",Trouble running C# code in VS Code: Getting scriptcs error
Using Linq's Where() to filter out null and convert the type to non-nullable," Suppose I have I want to turn it into List<MyObject>, but I have not been able to drop the nullable reference.Below is an MCVE. In my project I have nullable reference warnings turned to errors, so the commented out line below will not compile.If I do .Where(e => e != null).Select(e => e!) then it will be fine in the latest .NET Core 3.1.100, however I cannot extract this into an extension method.I tried adding this extension method However it will not convert IEnumerable<MyObject?> to IEnumerable<MyObject> and I am unsure why. This leads me to an error like: [CS8619] Nullability of reference types in value of type 'List' doesn't match target type 'List'.Is there a way I can make the NotNull function above work somehow? <code>  List<MyObject?> list = ...; public static IEnumerable<T> NotNull<T>(this IEnumerable<T> enumerable) { return enumerable.Where(e => e != null).Select(e => e!); }",Using Linq's Where/Select to filter out null and convert the type to non-nullable cannot be made into an extension method
get user-agent and ip in blazor server-side app," I created a server-side app with Blazor and I want get the ip and user-agent with each page request, how can I achieve that? In a .NET Core app I just need to use this code in the controller: But in Blazor I can't retrieve this data. <code>  var userAgent = Request.Headers[""User-Agent""].ToString()",Get user-agent and ip in Blazor server-side app
Weird behavior in Entity Framework Core with properties without setters," In my .net core 3.1 application I wanted to encapsulate properties in some entity: So I've removed all public setters and because of that somewhere in my code when I want to check whether such Sample already exists that line causes the error: System.InvalidOperationException: 'No suitable constructor found for entity type 'Sample'. The following constructors had parameters that could not be bound to properties of the entity type: cannot bind 'name' in 'Sample(string name)'.'.So I've added to code empty construtor and now that line causes error: System.InvalidOperationException: 'The LINQ expression 'DbSet<Sample> .Any(s => s.Name == __name_0)' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to either AsEnumerable(), AsAsyncEnumerable(), ToList(), or ToListAsync(). See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.'.But if I'll add private set to Name (or public) then everything works fine (even without empty constructor). Can anyone explain me why this setter is required, for instance Id does not require that setter. <code>  public class Sample : AuditableEntity{ public Sample(string name) { Name = name; } public int Id { get; } public string Name { get; }} _context.Samples.Any(r => r.Name == name) public class Sample : AuditableEntity{ public Sample() { } // Added empty constructor here public Sample(string name) { Name = name; } public int Id { get; } public string Name { get; }} public class Sample : AuditableEntity{ public Sample(string name) { Name = name; } public int Id { get; } public string Name { get; private set; } // added setter, removed empty constructor}",Entity Framework Core properties without setters
How to get the list of index for a string in a array?," I have one array: I m looking for the index of BMW, and I using below code to get: Unfortunately it return the result for the first BMW index only. Current output: My expected output will be <code>  string[] cars = {""Volvo"", ""BMW"", ""Volvo"", ""Mazda"",""BMW"",""BMW""}; Label1.Text = Array.FindIndex(filterlistinput, x => x.Contains(""BMW"")).ToString(); 1 {1,4,5}",Get the list of index for a string in an array?
"Does ""async"" runs in saparate thread?"," When I call to foo(), is this method runs on a separate thread? <code>  public async Task<bool> foo(){ //Some code }","Does ""async"" run in a separate thread?"
"Session.SetString method throw exception ""IFeatureCollection has been disposed.\r\nObject name: 'Collection'. "" in ASP.NET Core 3.1"," I have a project written in ASP.NET Core 3.1.I need to set data to Session in Singleton service: I injected the session object from DI: I calls the my method as below: but I get the exception below : and I added some code to Startup.cs's ConfigureServices method: And I added app.UseSession(); to the Configure method of Startup.cs.I trid services.AddSingleton<IHttpContextAccessor, HttpContextAccessor>(); and I get the session from httpContextAccessor.HttpContext.Session but I get the same error.Please help me, thank you. <code>  _session.SetString(""some key"", ""some value""); public OperatorService(ILogger<OperatorService> logger, ISession session, IOptions<AppSettings> options){ this._session = session; this._logger = logger; this._appSettings = options.Value;} public void ChangeOperatorStatus(StatusChangeRequest request){ try { _session.SetString(request.Key, request.Value); } catch (Exception ex) { _logger.LogInformation($""Exception while changing status: {ex}""); } } IFeatureCollection has been disposed.\r\nObject name: 'Collection'. services.AddHttpContextAccessor();services.AddSession(options =>{ options.IdleTimeout = TimeSpan.FromMinutes(20); options.Cookie.HttpOnly = true;}).AddDistributedMemoryCache();","Session.SetString method throws exception ""IFeatureCollection has been disposed. Object name: 'Collection'. "" in ASP.NET Core 3.1"
Failed executing DbCommand .net core," My goal is to provide simple API to retrieve data from Payments (~400 rows) table which consists 5 columns. Users can make posts request with with the request params of (should return ~12 rows): Using EF-Core: On azure application insights I can see 2 consecutive logs, caused by the same exception:Log1: Failed executing DbCommand.Log2: Execution Timeout Expired. The timeout period elapsed prior to completion of the operation or the server is not responding.The Log1 is (while there is no need to write here the log2): Failed executing DbCommand (65,238ms) [Parameters=[@__request_ClientClubType_0='?' (Size = 1) (DbType = Byte), @__request_ProductType_1='?' (Size = 1) (DbType = Byte)], CommandType='Text', CommandTimeout='60'] SELECT [p].[Id], [p].[ClientClubType], [p].[PaymentsNumber], [p].[ProductType], [p].[Rate] FROM [Payments] AS [p] WHERE (([p].[ClientClubType] = @__request_ClientClubType_0) AND @__request_ClientClubType_0 IS NOT NULL) AND (([p].[ProductType] = @__request_ProductType_1) AND @__request_ProductType_1 IS NOT NULL)My application is a .net core 3.0 application deployed on azure linux webapp.The issue only occurs from production not every time and I can not reconstruct the issue from MSSMS.Any idea?UPDATE:After @panagiotis-kanavos commented, I've updated my code to: <code>  Payment: Id (int),PaymentsNumber (tinyint),Rate (decimal(18,2)),ProductType (tinyint),ClientClubType (tinyint). PaymentsRequest { public int? PaymentsNumber { get; set; } public byte? ProductType { get; set; } public byte? ClientClubType { get; set; }} services.AddDbContext<MyContext>(cfg => cfg.UseSqlServer(Configuration.GetConnectionString(...),optionsBuilder => optionsBuilder.CommandTimeout(60)));public async Task<IEnumerable<Payments>> GetPaymentsAsync(PaymentsRequest request){ IQueryable<Payments> query = this._context.Set<Payments>(); query = query.Where(filter => (request.ClientClubType == null || filter.ClientClubType == request.ClientClubType) && (request.ProductType == null || filter.ProductType == request.ProductType) && (request.PaymentsNumber == null || filter.PaymentsNumber == request.PaymentsNumber)); return await query.ToListAsync();} services.AddDbContextPool<MyContext>(cfg => cfg.UseSqlServer(Configuration.GetConnectionString(...),optionsBuilder => optionsBuilder.CommandTimeout(60)));public async Task<IEnumerable<Payments>> GetPaymentsAsync(PaymentsRequest request){ IQueryable<Payments> query = this._context.Payments; query = query.Where(filter => (filter.ClientClubType == request.ClientClubType) && (filter.ProductType == request.ProductType) && (filter.PaymentsNumber == request.PaymentsNumber)); return await query.ToListAsync();}",Failed executing DbCommand because timeout expired .net core
Linq group by in EF Core 3.1," I have a database table to connect data between user and clients. I want to query to get list of ClientCorporates grouped by userid. I have follow some example on Stack Overflow like Group by in LINQand here is my query: When I run this, I got error: fail: Microsoft.AspNetCore.Server.Kestrel[13] Connection id ""0HLT67LJQA4IP"", Request id ""0HLT67LJQA4IP:0000000F"": An unhandled exception was thrown by the application. System.InvalidOperationException: The LINQ expression 'ToList(GroupByShaperExpression: KeySelector: u.UserId, ElementSelector:ProjectionBindingExpression: EmptyProjectionMember )' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to either AsEnumerable(), AsAsyncEnumerable(), ToList(), or ToListAsync(). See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.How to solve this problem?SOLVED !After I did more research it seems EF Core has limitation doing this query on database server. so I need to get the data first and processed it on my dotnet server (client). Here is the  <code>  db: class UserClientCorporate{ int UserId; User User; int ClientCorporateId; ClientCorporate ClientCorporate;} var data3 = from db in _context.UserClientCorporate group db.ClientCorporateId by db.UserId into g select new { UserId = g.Key, Clients = g.ToList() };return Ok(await data3.ToListAsync()); var data = await _context.UserClientCorporate.Include(x => x.User).Include( x => x.ClientCorporate).var res2 = from db in data group db by db.UserId into g select new {UserId = g.Key, Clients = g};",LINQ group by in Entity Framework Core 3.1
How is this c# dictionary initialization correct?," I stumbled upon the following and I'm wondering why it didn't raise a syntax error. Notice that the "","" is missing between the ""MyA"", and ""OtherAs"".This is where the confusion happens:The code compiles.The final dictionary ""dict"" contains only three elements: ""Id"", ""Tribes"", and ""MyA"".The value for all except ""MyA"" are correct,""MyA"" takes the declared value for ""OtherAs"", while its original value is ignored.Why isn't this illegal? Is this by design? <code>  var dict = new Dictionary<string, object>{ [""Id""] = Guid.NewGuid(), [""Tribes""] = new List<int> { 4, 5 }, [""MyA""] = new Dictionary<string, object> { [""Name""] = ""Solo"", [""Points""] = 88 } [""OtherAs""] = new List<Dictionary<string, object>> { new Dictionary<string, object> { [""Points""] = 1999 } }};",How is this C# dictionary initialization correct?
"In C#, how do you cast a dictionary<int, child> to dictionary<int, parent>?"," Let's say I have: And containers of these two types of animals: Is there a way to cast 'lions' and 'boars' so that I can pass them into a function like this? <code>  public class Animal{ virtual public void Attack() {};}public class Lion : Animal{ public override void Attack() { base.Attack(); }}public class Boar : Animal{ public override void Attack() { base.Attack(); }} Dictionary<int, Lion> lions;Dictionary<int, Boar> boars; void IterateTable(Dictionary<int, Animal> dictionary){ foreach(var entry in dictionary) entry.Value.Attack();}","How do you cast a dictionary<int, child> to dictionary<int, parent>?"
Better way to add spaces between double semicolons in C#," My task is simple: I have a CSV file inside a C# string, split with semicolons. I need to add spaces for each empty cell. A;B;;;;C; should become A;B; ; ; ;C;. Right now, I'm using the replace method twice: That's necessary, because in the first pass, it will replace any occurance of ;; with a space between, but there's no lookback, so the second semicolon of the replaced sequence won't be checked again. Therefore I would end up with a A;B; ;; ;C;, which is not what I want.Is there a more elegant, clear, and less redundand way to solve that task? <code>  csv = csv.Replace("";;"", ""; ;"").Replace("";;"", ""; ;"");",Better way to add spaces between double semicolons
Exchange Date between Page and NavMenu in Blazor," I have a standard - blazor - project which has the following components: The MainLayout looks like this: Now I want to exchange Data between my pages (index.razor, sub1.razor) and the navmenu so I could add something like this in navmenu: How can I set (navMenu).CurrentPageName directly from within my page? I would expect that using a static class for that is not really a good option. <code>  -> MainLayout.razor-> NavMenu.razor-> Pages/Index.razor-> Pages/Sub1.razor <div class=""sidebar""> <NavMenu /></div><div>@Body</div> <div><p>You are now on Page: @CurrentPageName</p></div>",Exchange Data between Page and NavMenu in Blazor
How to get return value from eventcallback in blazor?," My situation is this: I'm trying to implement and Autocomplete.The Autocomplete will have a Parameter that will receive a string and return a IEnumerable<TValue>.Here is an example of what I'm trying to doAutocomplete.razor ParentComponent.razor The problem is that I don't know what to put in SOME_TYPE. Should I use EventCallback? Action? What should I use?I tried using EventCallback but looks like I can't get a return value from EventCallback? I have no idea. <code>  @code { [Parameter] public SOME_TYPE GetItems { get; set; } async void Foo(){ IEnumerable<TValue> items = await GetItems(SomeString); // do something with items } } <Autocomplete TValue=""SomeEntity"" GetItems=""@GetItems"" />@code { SOME_TYPE GetItems(string name) { IEnumerable<SomeEntity> entity = await GetEntitys(name); return entity; } }",How to get return value from EventCallback in blazor?
Share data between two after exporting Unity Project to Android Studio," I Export my unity project to the android studio using these steps:https://forum.unity.com/threads/integration-unity-as-a-library-in-native-android-app.685240/But I want to ask that is there any option that I can send data from my native android app Intent to unity scripts because I am making an online game and I need to transfer my tokens to unity.I have saved the token in shared preferences using Encrypted SharedPreference library in the android studio, server required token to respond on request so I want the token from my android intent to unity script.Or Is there any way in unity to decrypt this token.Please help me I am stuck <code> ",Share data between Unity Project to Android Studio java code
Visual Studio does not show all errors in the code," I've been using Visual Studio (2017) for quite a long time now, to program mostly in C#, for Unity games. Recently though, I noticed that it was not displaying any errors in the code anymore, or at least most of them. I initially started making some small tests, for example removing variables that were being used multiple times in the scripts. Visual Studio was not showing any errors, while when going back to Unity, it was showing all the correct errors in the console (as always). Instead, if I tried to remove a parenthese, it was, after a bit, showing errors all over the place. Again, it was really strange.After one day, I was still testing, and I noticed that if I first opened Visual Studio, and then in ""recent"" I clicked on the the .sln file, that opened all the scripts for one Unity project, it was immediately showing all the right errors, like it had always done and how (I think) it should always do. I started looking for some differences between what I was seeing there, and what I was seeing when opening the .cs files (in the way that wasn't working):At the top, I wasn't seeing ""Debug"" and ""Any CPU"" how I was when it was working:Another thing was that, between the ""Project"" and the ""Debug"" buttons (at the top, that open the drop-down lists), I didn't have the ""Compile"" button.Also, under the the ""Debug"" drop-down many options like ""start debug"" were not available / disabled.At the top left, under the left-most script name, I have ""External files"" instead of ""Assembly-CSharp""At the right of where there should be ""Debug"" and ""Any CPU"", I have ""Connect"" instead of ""Start"" (Or something similar, my system's language is not english, these are translations)Another (maybe less relevant) thing that has changed from before, when it was working:I have installed Visual Studio 2019, and uninstalled after a few minutes (I've always preferred Visual Studio 2017!).Programming without seeing the errors realtime takes much more time, so I'd really like to fix this problem, if it is possible to do so. Is there anything that I have to activate? Did I accidentally press a combination of keys?Thanks in advance! :) <code> ",Visual Studio does not show errors in the code anymore
How to use DbContext with DI in desktop applications," I've been working on several non-web applications with Entity Framework and always it was struggling for me to find a correct approach for implementing Generic Repository with DbContext.I've searched a lot, many of articles are about web applications which have short-living contexts. In desktop approaches I can't find suitable method.One approach is DbContext per ViewModel but I don't agree with coupling View with Repository layers.Another one is using using clause this way: but this way we will not have Unit of Work and also can't use IoC Containers.So what is the best practice for using DbContext in desktop applications? <code>  using(var context = new AppDbContext()){ // ...}",How to use DbContext with DI in desktop applications?
How to get environment variables from inside Main() in ASP.NET CORE?, I want to know if the code is Dev/Stage so I need to get this. I tried the code below but it seems to skip running the Configure() of Startup.cs. Help ? <code>  public static void Main(string[] args) { IHost host = CreateHostBuilder(args).Build(); SeedDatabase(host); host.Run(); } public static IHostBuilder CreateHostBuilder(string[] args) { //return Host.CreateDefaultBuilder(args) // .ConfigureWebHostDefaults(webBuilder => // { // webBuilder.UseStartup<Startup>(); // }); return Host.CreateDefaultBuilder(args) .ConfigureWebHostDefaults(webBuilder => { webBuilder.UseStartup<Startup>(); webBuilder.ConfigureServices(services => { }) .Configure(app => { Env = app.ApplicationServices.GetRequiredService<IWebHostEnvironment>(); }); }); },How to get environment variables from inside Main() in ASP.NET Core?
class comment missing when parsing & re-emitting C# code with roslyn," Scenario: I'm trying to use Roslyn to merge a set of C# source fragments into a single code fragment.Issue: when parsing different classes with a leading comment, the comment above the first class (SomeClass in the example) is not preserved. For the second class (AnotherClass), the comment IS preserved...The code below demonstrates the issue. Use this in a console program (& install Microsoft.CodeAnalysis.CSharp nuget package) What am I missing? <code>  using Microsoft.CodeAnalysis;using Microsoft.CodeAnalysis.CSharp;using Microsoft.CodeAnalysis.CSharp.Syntax;using System.Collections.Generic;using System.Diagnostics;using System;namespace roslyn01{ class Program { static void Main(string[] args) { var input = new[] { ""// some comment\r\nclass SomeClass {}"", ""// another comment\r\nclass AnotherClass {}"", }; // parse all input and collect members var members = new List<MemberDeclarationSyntax>(); foreach (var item in input) { var syntaxTree = CSharpSyntaxTree.ParseText(item); var compilationUnit = (CompilationUnitSyntax)syntaxTree.GetRoot(); members.AddRange(compilationUnit.Members); } // assemble all members in a new compilation unit var result = SyntaxFactory.CompilationUnit() .AddMembers(members.ToArray()) .NormalizeWhitespace() .ToString(); var expected = @""// some commentclass SomeClass{}// another commentclass AnotherClass{}""; Console.WriteLine(result); // the assert fails; the first comment ('// some comment') is missing from the output Debug.Assert(expected == result); } }}",merging C# code with roslyn: comment disappears
"when I deploy my project in heroku in production, I get a 405 error, locally in my IIS my web requests workS (C#)"," I am using .net core 3.1. With the help of docker I uploaded my code to heroku. but when i make a web request I get a 405 error with all my endpoints. (I cant see more details of the error)using Get: from visual studio code and also locally from my IIS everything works fine. but the problem occurs when I deploy to my server.What am I doing wrong? this is the code of my controller: update:this is my Dockerfile At no time have I seen CORS issues or anything like that. just the 405 error. <code>  http://xxxx.herokuapp.com/api/pqrs/test/1315315 using System; using System.Collections.Generic; using System.IdentityModel.Tokens.Jwt; using System.Linq; using System.Security.Claims; using System.Text; using System.Threading.Tasks; using apiPQR.Contexts; using apiPQR.Entities; using apiPQR.Models; using Microsoft.AspNetCore.Authentication.JwtBearer; using Microsoft.AspNetCore.Authorization; using Microsoft.AspNetCore.Mvc; using Microsoft.Extensions.Configuration; using Microsoft.IdentityModel.Tokens; namespace apiPQR.Controllers { [ApiController] [Route(""api/[controller]"")] public class Pqrs : Controller { private readonly AppDbContext context; private readonly IConfiguration configuration; public Pqrs(AppDbContext context, IConfiguration configuration) { this.context = context; this.configuration = configuration; } [HttpGet, Route(""test/{id}"")] public PQRS Get(int id) { var num_pqrs = context.PQRS.FirstOrDefault(p => p.num_solicitud==id); return num_pqrs; } } } #See https://aka.ms/containerfastmode to understand how Visual Studio uses this Dockerfile to build your images for faster debugging.FROM mcr.microsoft.com/dotnet/core/aspnet:3.1-buster-slim AS baseWORKDIR /appEXPOSE 80EXPOSE 443FROM mcr.microsoft.com/dotnet/core/sdk:3.1-buster AS buildWORKDIR /srcCOPY [""apiPQR.csproj"", """"]RUN dotnet restore ""./apiPQR.csproj""COPY . .WORKDIR ""/src/.""RUN dotnet build ""apiPQR.csproj"" -c Release -o /app/buildFROM build AS publishRUN dotnet publish ""apiPQR.csproj"" -c Release -o /app/publishFROM base AS finalWORKDIR /appCOPY --from=publish /app/publish .ENTRYPOINT [""dotnet"", ""apiPQR.dll""]","Deploy ASP.NET Core Docker project - get a 405 error (locally in my IIS, web requests works). How to fix it?"
"when I deploy my project in my server, I get a 405 error, locally in my IIS my web requests workS (C#)"," I am using .net core 3.1. With the help of docker I uploaded my code to heroku. but when i make a web request I get a 405 error with all my endpoints. (I cant see more details of the error)using Get: from visual studio code and also locally from my IIS everything works fine. but the problem occurs when I deploy to my server.What am I doing wrong? this is the code of my controller: update:this is my Dockerfile At no time have I seen CORS issues or anything like that. just the 405 error. <code>  http://xxxx.herokuapp.com/api/pqrs/test/1315315 using System; using System.Collections.Generic; using System.IdentityModel.Tokens.Jwt; using System.Linq; using System.Security.Claims; using System.Text; using System.Threading.Tasks; using apiPQR.Contexts; using apiPQR.Entities; using apiPQR.Models; using Microsoft.AspNetCore.Authentication.JwtBearer; using Microsoft.AspNetCore.Authorization; using Microsoft.AspNetCore.Mvc; using Microsoft.Extensions.Configuration; using Microsoft.IdentityModel.Tokens; namespace apiPQR.Controllers { [ApiController] [Route(""api/[controller]"")] public class Pqrs : Controller { private readonly AppDbContext context; private readonly IConfiguration configuration; public Pqrs(AppDbContext context, IConfiguration configuration) { this.context = context; this.configuration = configuration; } [HttpGet, Route(""test/{id}"")] public PQRS Get(int id) { var num_pqrs = context.PQRS.FirstOrDefault(p => p.num_solicitud==id); return num_pqrs; } } } #See https://aka.ms/containerfastmode to understand how Visual Studio uses this Dockerfile to build your images for faster debugging.FROM mcr.microsoft.com/dotnet/core/aspnet:3.1-buster-slim AS baseWORKDIR /appEXPOSE 80EXPOSE 443FROM mcr.microsoft.com/dotnet/core/sdk:3.1-buster AS buildWORKDIR /srcCOPY [""apiPQR.csproj"", """"]RUN dotnet restore ""./apiPQR.csproj""COPY . .WORKDIR ""/src/.""RUN dotnet build ""apiPQR.csproj"" -c Release -o /app/buildFROM build AS publishRUN dotnet publish ""apiPQR.csproj"" -c Release -o /app/publishFROM base AS finalWORKDIR /appCOPY --from=publish /app/publish .ENTRYPOINT [""dotnet"", ""apiPQR.dll""]","Deploy ASP.NET Core Docker project - get a 405 error (locally in my IIS, web requests works). How to fix it?"
"deploy project on heroku get a 405 error, locally in my IIS, web requests works"," I am using .net core 3.1. With the help of docker I uploaded my code to heroku. but when i make a web request I get a 405 error with all my endpoints. (I cant see more details of the error)using Get: from visual studio code and also locally from my IIS everything works fine. but the problem occurs when I deploy to my server.What am I doing wrong? this is the code of my controller: update:this is my Dockerfile At no time have I seen CORS issues or anything like that. just the 405 error. <code>  http://xxxx.herokuapp.com/api/pqrs/test/1315315 using System; using System.Collections.Generic; using System.IdentityModel.Tokens.Jwt; using System.Linq; using System.Security.Claims; using System.Text; using System.Threading.Tasks; using apiPQR.Contexts; using apiPQR.Entities; using apiPQR.Models; using Microsoft.AspNetCore.Authentication.JwtBearer; using Microsoft.AspNetCore.Authorization; using Microsoft.AspNetCore.Mvc; using Microsoft.Extensions.Configuration; using Microsoft.IdentityModel.Tokens; namespace apiPQR.Controllers { [ApiController] [Route(""api/[controller]"")] public class Pqrs : Controller { private readonly AppDbContext context; private readonly IConfiguration configuration; public Pqrs(AppDbContext context, IConfiguration configuration) { this.context = context; this.configuration = configuration; } [HttpGet, Route(""test/{id}"")] public PQRS Get(int id) { var num_pqrs = context.PQRS.FirstOrDefault(p => p.num_solicitud==id); return num_pqrs; } } } #See https://aka.ms/containerfastmode to understand how Visual Studio uses this Dockerfile to build your images for faster debugging.FROM mcr.microsoft.com/dotnet/core/aspnet:3.1-buster-slim AS baseWORKDIR /appEXPOSE 80EXPOSE 443FROM mcr.microsoft.com/dotnet/core/sdk:3.1-buster AS buildWORKDIR /srcCOPY [""apiPQR.csproj"", """"]RUN dotnet restore ""./apiPQR.csproj""COPY . .WORKDIR ""/src/.""RUN dotnet build ""apiPQR.csproj"" -c Release -o /app/buildFROM build AS publishRUN dotnet publish ""apiPQR.csproj"" -c Release -o /app/publishFROM base AS finalWORKDIR /appCOPY --from=publish /app/publish .ENTRYPOINT [""dotnet"", ""apiPQR.dll""]","Deploy ASP.NET Core Docker project - get a 405 error (locally in my IIS, web requests works). How to fix it?"
Best practices for managing JWT token inside a Web API," My Project:Web API project - ASP .NET Framework 4.8Problem?The code flow is as follows:1.) The API is called -> it must call another API -> 2.) Get JWT authentication token -> 3.) Calls the desired method.The problem is if my API is called 100 times, I will make 100 calls for the GetJwtToken() method and another 100 for the desired method itself, which seems like an overhead on the auth server. The token itself has a lifespan of 2 hours.Are there any documented best practices on how to manage a Web API JWT token in another Web API?What have I tried?I've tried the following solutions and I'm still not sure whether they could be considered good practices.One static class with two static properties Token and ValidTo and one static method GetJwtToken() that updates those properties. Before each call to the desired external API method, we check the ValidTo property and update the Token value if it has expired, via the static method.In our service, we have one static private field Token.The method that calls the external API method is surrounded by a try catch blocks. The Catch(WebException ex) expects an Unauthorized exception if the token has expired. I check for HTTP Status Code 401 - Unauthorized. In case we go into that if clause we update the Token property by calling the GetJwtToken() method inside the catch block and then calling recursively the method again. In this way, we update the token only when it has expired and an unauthorized exception was thrown.Another idea that I got, but didn't test isActionFilterAttribute with overridden OnActionExecuting(HttpActionContext actionContext) method. Before we go into the Web API controller the action attribute has already checked whether we have Token and if it has expired. The problem here was I am not sure where to save the Token property. Possibly as a static value in another class.Are there any other ways to manage a JWT Token of a Web API inside another Web API and what is considered best practices?Some code snippets, pseudo-code, or articles would be appreciated.Edit1:I've read this question, but it doesn't help me, since it's about how to manage the token on the front end part. The project here is Web API it's all on the server-side.Edit2:Edited some sentences here and there so it's more readable.Edit3:Added one more option that I thought about. <code>  if (response.StatusCode == HttpStatusCode.Unauthorized)",Best practices for managing Web API JWT token in another Web API
"Asynchronous handler for each observable element, drop elements while handling"," I am looking for something similar to the exhaustMap operator from rxjs, but RX.NET does not seem to have such an operator.What I need to achieve is that, upon every element of the source stream, I need to start an async handler, and until it finishes, I would like to drop any elements from the source. As soon as the handler finishes, resume taking elements.What I don't want is to start an async handler upon every element - while the handler runs, I want to drop source elements.I also suspect I need to cleverly use the defer operator here?Thank you! <code> ",How can I implement an exhaustMap handler in Rx.Net?
"RX.NET: asynchronous handler for each observable element, drop elements while handling"," I am looking for something similar to the exhaustMap operator from rxjs, but RX.NET does not seem to have such an operator.What I need to achieve is that, upon every element of the source stream, I need to start an async handler, and until it finishes, I would like to drop any elements from the source. As soon as the handler finishes, resume taking elements.What I don't want is to start an async handler upon every element - while the handler runs, I want to drop source elements.I also suspect I need to cleverly use the defer operator here?Thank you! <code> ",How can I implement an exhaustMap handler in Rx.Net?
"Asynchronous handler for each observable element, drop elements while handling"," I am looking for something similar to the exhaustMap operator from rxjs, but RX.NET does not seem to have such an operator.What I need to achieve is that, upon every element of the source stream, I need to start an async handler, and until it finishes, I would like to drop any elements from the source. As soon as the handler finishes, resume taking elements.What I don't want is to start an async handler upon every element - while the handler runs, I want to drop source elements.I also suspect I need to cleverly use the defer operator here?Thank you! <code> ",How can I implement an exhaustMap handler in Rx.Net?
Visual Studio Intellisense fails on C# 9.0 records," I'm playing with a new record feature in a console app. I'm using my VS Community 16.8.0 + R# 2020.2.4 trial.C# code Csproj file The code could be compiled and it runs.ProblemThe thing is that IntelliSense does not recognise the record itself. VS underlines the record definition and does not recognise its use despite the fact that the program itself can be compiled.What am I doing wrong?NoteVS somehow recognise a typo in record definition/use. <code>  using System;namespace ConsoleApp2{ class Program { static void Main(string[] args) { var test = new Person(""firstname"", ""lastname""); Console.WriteLine($""test.FirstName: {test.FirstName} test.LastName: {test.LastName}""); } } public record Person(string FirstName, string LastName);} <Project Sdk=""Microsoft.NET.Sdk""> <PropertyGroup> <OutputType>Exe</OutputType> <TargetFramework>net5.0</TargetFramework> </PropertyGroup></Project>",ReSharper 2020.2.4 fails on C# 9.0 records
Resharper 2020.2.4 fails on C# 9.0 records," I'm playing with a new record feature in a console app. I'm using my VS Community 16.8.0 + R# 2020.2.4 trial.C# code Csproj file The code could be compiled and it runs.ProblemThe thing is that IntelliSense does not recognise the record itself. VS underlines the record definition and does not recognise its use despite the fact that the program itself can be compiled.What am I doing wrong?NoteVS somehow recognise a typo in record definition/use. <code>  using System;namespace ConsoleApp2{ class Program { static void Main(string[] args) { var test = new Person(""firstname"", ""lastname""); Console.WriteLine($""test.FirstName: {test.FirstName} test.LastName: {test.LastName}""); } } public record Person(string FirstName, string LastName);} <Project Sdk=""Microsoft.NET.Sdk""> <PropertyGroup> <OutputType>Exe</OutputType> <TargetFramework>net5.0</TargetFramework> </PropertyGroup></Project>",ReSharper 2020.2.4 fails on C# 9.0 records
Mark a whole assembly as dynamically accessed," With .NET 5, we can trim our project to reduce it's footprint. If we know that we will access a Type via reflection, we can mark it as dynamically accessed: But is there also a way to mark a whole assembly as dynamically accessed? <code>  public void DoSomethingReflective<[DynamicallyAccessedMembers(DynamicallyAccessedMemberTypes.All)] T>(); public void DoSomethingReflective(Assembly assembly);",Mark a whole assembly as dynamically accessed when Application Trimming
c# Using Global Query Filters for all entities," I have recently found global filters, which is great because I have been tasked with implementing soft deletes in my applicaiton.Currently I have done this: All the entities inherit a BaseModel which looks like this: Is it possible to add the query filter for any class that inherits the BaseModel?Something like: So I don't forget (at a later date) to add the query filter for models I add? <code>  // Query filters https://docs.microsoft.com/en-us/ef/core/querying/filtersmodelBuilder.Entity<Address>().HasQueryFilter(m => !m.Deleted);modelBuilder.Entity<Attribute>().HasQueryFilter(m => !m.Deleted);modelBuilder.Entity<Brand>().HasQueryFilter(m => !m.Deleted);modelBuilder.Entity<BrandAddress>().HasQueryFilter(m => !m.Deleted);modelBuilder.Entity<BrandCategory>().HasQueryFilter(m => !m.Deleted);modelBuilder.Entity<Category>().HasQueryFilter(m => !m.Deleted);// many more entity types.... public class BaseModel{ public Guid CreatedBy { get; set; } public Guid UpdatedBy { get; set; } public DateTime DateCreated { get; set; } public DateTime DateUpdated { get; set; } public bool Deleted { get; set; }} modelBuilder.Entity<BaseModel>().HasQueryFilter(m => !m.Deleted);",Using Global Query Filters for all entities
C# Sort Values - WinForm," With Windows form application, I select a txt file with random numerical values and I can print it on the screen properly. But ""Array.Sort (values)"" didn't work when I wanted to sort the values. How can I handle this?Button Click Function OUTPUT Sample txt <code>  private void button4_Click(object sender, EventArgs e) { OpenFileDialog openFileDialog1 = new OpenFileDialog { InitialDirectory = @""C:\"", Title = ""Title"", CheckFileExists = true, CheckPathExists = true, DefaultExt = ""txt"", Filter = ""txt (*.txt)|*.txt"", FilterIndex = 2, RestoreDirectory = true, ReadOnlyChecked = true, ShowReadOnly = true }; if(openFileDialog1.ShowDialog()==DialogResult.OK) { string path = openFileDialog1.FileName; string[] txtDoc = File.ReadAllLines(path); textBox6.Text = path; Array.Sort(txtDoc); foreach (string s in txtDoc) { txtDoc = s.Split(new[] { "" "" }, StringSplitOptions.RemoveEmptyEntries); foreach (string ss in txtDoc) { richTextBox1.Text +=ss+""\n""; } } } } 1025-412,3726945-4,41357635-45610541278251 10 2 5 -4 6 10 5 4 12 35 -4512,372 69 45 -4,41 35 7678 25 1 ",How to sort an array of string representing numbers (positive and negative as well as having a decimal part)?
C# SSH.NET using openssh private key," I'm not experienced with SFTP or OpenSSH. I am trying to connect to a client's SFTP to upload a file.I am using the SSH.NET library https://github.com/sshnet/SSH.NETWithin my C# code I have the private key in a string variable: But I get an error:invalid private key file.My question is, I have seen other keys which begin BEGIN RSA but my key begins BEGIN OPENSSH is this the issue? <code>  var key = @""-----BEGIN OPENSSH PRIVATE KEY-----// snipped-----END OPENSSH PRIVATE KEY-----"";MemoryStream keyStream = new MemoryStream(Encoding.UTF32.GetBytes(key));Renci.SshNet.ConnectionInfo conn = new Renci.SshNet.ConnectionInfo( host, port, username, new AuthenticationMethod[] { new PrivateKeyAuthenticationMethod(username, new PrivateKeyFile[] { new PrivateKeyFile(keyStream, """"), }), });","Using ""OPENSSH"" private key file in string with SSH.NET in C# fails with ""invalid private key file"""
"FAQ: HotChocolate throws `Unexpected Execution Error`, but doesn't expose any information about the error"," Im building out a simple HotChocolate GraphQl server and HotChocolate throws an Unexpected Execution Error, but doesn't expose any information about the error, as soon as I post a request against it.It doesn't matter how I post the request against the backend (BananaCakePop, Postman, Insomnia, ...).The reponse looks like this: The request response contains no further information and nothing is logged to the applications console.What would be a reasonable next step to try and figure out what went wrong? <code>  { ""errors"": [ { ""message"": ""Unexpected Execution Error"", ""locations"": [ { ""line"": 2, ""column"": 3 } ], ""path"": [ ""pong"" ] } ], ""data"": { ""pong"": null }}","How can I get more error details or logging, when an exception is thrown in a HotChocolate GraphQL server?"
"HotChocolate throws `Unexpected Execution Error`, but doesn't expose any information about the error"," Im building out a simple HotChocolate GraphQl server and HotChocolate throws an Unexpected Execution Error, but doesn't expose any information about the error, as soon as I post a request against it.It doesn't matter how I post the request against the backend (BananaCakePop, Postman, Insomnia, ...).The reponse looks like this: The request response contains no further information and nothing is logged to the applications console.What would be a reasonable next step to try and figure out what went wrong? <code>  { ""errors"": [ { ""message"": ""Unexpected Execution Error"", ""locations"": [ { ""line"": 2, ""column"": 3 } ], ""path"": [ ""pong"" ] } ], ""data"": { ""pong"": null }}","How can I get more error details or logging, when an exception is thrown in a HotChocolate GraphQL server?"
"How can I get more details of logging, when an exception is thrown in an HotChocolate GraphQL Server?"," Im building out a simple HotChocolate GraphQl server and HotChocolate throws an Unexpected Execution Error, but doesn't expose any information about the error, as soon as I post a request against it.It doesn't matter how I post the request against the backend (BananaCakePop, Postman, Insomnia, ...).The reponse looks like this: The request response contains no further information and nothing is logged to the applications console.What would be a reasonable next step to try and figure out what went wrong? <code>  { ""errors"": [ { ""message"": ""Unexpected Execution Error"", ""locations"": [ { ""line"": 2, ""column"": 3 } ], ""path"": [ ""pong"" ] } ], ""data"": { ""pong"": null }}","How can I get more error details or logging, when an exception is thrown in a HotChocolate GraphQL server?"
"C#, have a error Argument 2: cannot convert from 'string' to 'Microsoft.EntityFrameworkCore.ServerVersion"""," I'm using C# and have an error:Argument 2: cannot convert from 'string' to 'Microsoft.EntityFrameworkCore.ServerVersion' <code>  using Microsoft.EntityFrameworkCore; using System; namespace Infrastructure { public class BotContext : DbContext { public DbSet<Server> Servers { get; set; } protected override void OnConfiguring(DbContextOptionsBuilder options) => options.UseMySql(""server=localhost;user=root;port=3306;Connect Timeout=5;""); public class Server { public ulong Id { get; set; } public string Prefix { get; set; } } } }",Cannot convert from 'string' to 'Microsoft.EntityFrameworkCore.ServerVersion
Using File.SetCreationTime and File.SetLastWriteTime makes Windows Explorer to hide these details for the file," I encountered something weird while trying to set CreationTime and LastWriteTime on a file. I'm using this code in a console app and when it runs, it updates those properties but the related values disappear from Windows Explorer.Did I make any mistake? <code>  DateTime nDT = new DateTime(1974, 12, 23,10,31,34);string path = @""C:\Users\matte\Desktop\Desktop_Test.zip"";File.SetCreationTime(path, nDT);File.SetLastWriteTime(path, nDT);",Using File.SetCreationTime and File.SetLastWriteTime makes Windows Explorer hide these details for the file
Pass DateOnly query argument as string," As of .NET 6 in ASP.NET API, if you want to get DateOnly (or TimeOnly) as query parameter, you need to separately specify all it's fields instead of just providing a string (""2021-09-14"", or ""10:54:53"" for TimeOnly) like you can for DateTime.I was able to fix that if they are part of the body by adding adding custom JSON converter (AddJsonOptions(o => o.JsonSerializerOptions.Converters.Add(...))), but it doesn't work for query parameters.I know that could be fixed with model binder, but I don't want to create a model binder for every model that contains DateOnly/TimeOnly. Is there a way to fix this application wide?Demo:Lets assume you have a folowwing action:[HttpGet] public void Foo([FromQuery] DateOnly date, [FromQuery] TimeOnly time, [FromQuery] DateTime dateTime)Here's how it would be represented in Swagger:I want it represented as three string fields: one for DateOnly, one for TimeOnly and one for DateTime (this one is already present).PS: It's not a Swagger problem, it's ASP.NET one. If I try to pass ?date=2021-09-14 manually, ASP.NET wouldn't understand it. <code> ",How can I use DateOnly/TimeOnly query parameters in ASP.NET Core 6?
"HttpRepl, navigation command ""ls"" does not show available endpoints for the current URL path, what could be wrong?"," I am working through the Microsoft Learn tutorials to ""Create a web API with ASP.Net Core"".Under the heading, ""Build and test the web API"", at instruction (5) I am getting a response, ""Unable to find an OpenAPI description"".For step (6) when executing the ""ls"" command I get the response, ""No directory structure has been set, so there is nothing to list. Use the 'connect' command to set a directory structure based on an OpenAPI description"". I have tried the ""connect"" command suggested here and have tried ""dir"" as an alternative to ""ls"".I can successfully change directories in step (7) and execute the GET request for step (8) and receive the expected reply. However, it really bothers me the ""ls"" command is not working here and seems like an important function of the httprepl tool.How can I get the ""ls"" command to work here or tell me why does it not work? ADDED RESULTS OF SUGGESTIONS-- httprepl GitHub repo and MS Docs page <code>  C:\Users\xxxx\source\repos\Learn\ContosoPizza>httprepl http://localhost:5000(Disconnected)> connect http://localhost:5000Using a base address of http://localhost:5000/Unable to find an OpenAPI descriptionFor detailed tool info, see https://aka.ms/http-repl-dochttp://localhost:5000/> lsNo directory structure has been set, so there is nothing to list. Use the ""connect"" command to set a directory structure based on an OpenAPI description. http://localhost:5000/> C:\Users\xxxx\source\repos\Learn\ContosoPizza>dotnet --version3.1.412C:\Users\xxxx\source\repos\Learn\ContosoPizza>dotnet add WebAPI.csproj package Swashbuckle.AspNetCore -v 5.6.3Could not find project or directory `WebAPI.csproj`.","Why is HttpRepl unable to find an OpenAPI description? The command ""ls"" does not show available endpoints"
Can I tell Blazor to re-render specific HTML elements even if the property they depend on hasn't changed?," In Blazor, how can I undo invalid user input, without changing the state of the component to trigger a re-render?Here is a simple Blazor counter example (try it online): For input element A, I want to replicate the behavior of input element B, but without using the bind-xxx-style data binding attributes.E.g., when I type 123x inside A, I want it to revert back to 123 automatically, as it happens with B.I've tried StateHasChanged but it doesn't work, I suppose, because the count property doesn't actually change.So, basically I need to re-render A to undo invalid user input, even thought the state hasn't changed. How can I do that without the bind-xxx magic?Sure, bind-xxx is great, but there are cases when a non-standard behavior might be desired, built around a managed event handler like ChangeEvent.Updated, to compare, here's how I could have done it in React (try it online): Also, here's how I could have done it in Svelte, which I find conceptually very close to Blazor (try it online). Updated, to clarify, I simply want to undo whatever I consider an invalid input, retrospectively after it has happened, by handling the change event, without mutating the component's state itself (counter here).That is, without Blazor-specific two-way data binding, HTML native type=number or pattern matching attributes. I simply use the number format requirement here as an example; I want to be able to undo any arbitrary input like that.The user experience I want (done via a JS interop hack): https://blazorrepl.telerik.com/wPbvcvvi128Qtzvu03Surprised this so difficult in Blazor compared to other frameworks, and that I'm unable to use StateHasChanged to simply force a re-render of the component in its current state. <code>  <label>Count:</label><button @onclick=Increment>@count times!</button><br>A: <input @oninput=OnChange value=""@count""><br>B: <input @bind-value=count @bind-value:event=""oninput"">@code { int count = 1; void Increment() => count++; void OnChange(ChangeEventArgs e) { var userValue = e.Value?.ToString(); if (int.TryParse(userValue, out var v)) { count = v; } else { if (String.IsNullOrWhiteSpace(userValue)) { count = 0; } // if count hasn't changed here, // I want to re-render ""A"" // this doesn't work e.Value = count.ToString(); // this doesn't work either StateHasChanged(); } }} function App() { let [count, setCount] = useState(1); const handleClick = () => setCount((count) => count + 1); const handleChange = (e) => { const userValue = e.target.value; let newValue = userValue ? parseInt(userValue) : 0; if (isNaN(newValue)) newValue = count; // re-render even when count hasn't changed setCount(newValue); }; return ( <> Count: <button onClick={handleClick}>{count}</button><br/> A: <input value={count} onInput={handleChange}/><br/> </> );} <script> let count = 1; const handleClick = () => count++; const handleChange = e => { const userValue = e.target.value; let newValue = userValue? parseInt(userValue): 0; if (isNaN(newValue)) newValue = count; if (newValue === count) e.target.value = count; // undo user input else count = newValue; } }; </script>Count: <button on:click={handleClick}>{count}</button><br/>A: <input value={count} on:input={handleChange}/><br/>","In Blazor, is there a way to undo invalid user input, without changing the state?"
Entity Framework Core: strange behaviour when filtering on Include with AsNoTracking," I don't know if it is expected to be this way but I thought it is strange since changes the query results.When I execute the query below I get my entity with only 2 ""Mensagens"" entity because i'm filtering only the actives so it's right, I have 2 active entities on my database and 1 inactive. But if I execute the exact same command just removing the AsNoTracking() line it gives me the 3 records, both active and inactive.But the inactive one EF doesn't fetch the ThenInclude below. It changes the behaviour.With AsNoTracking it filters the data according to the filter I used on IncludeWithout AsNoTracking it bring me all the data but it filters if it will load or not the ThenInclude objects.Does anyone know if this is a normal behaviour and why does it behaves like this? <code>  return await context.Lancamentos .Include(x => x.UsuarioCriacao) .Include(x => x.Mensagens.Where(m => m.Ativo)) .ThenInclude(m => m.MensagemMedias) .ThenInclude(m => m.MediaWhatsapp) .ThenInclude(m => m.TipoMediaWhatsapp) .Include(x => x.Mensagens.Where(m => m.Ativo)) .ThenInclude(x => x.TemplateMensagem) .ThenInclude(t => t.Medias) .ThenInclude(m => m.MediaWhatsapp) .ThenInclude(m => m.TipoMediaWhatsapp) .AsNoTracking() .FirstOrDefaultAsync(l => l.Id == id && l.Ativo);",Strange behaviour when filtering on Include with AsNoTracking
