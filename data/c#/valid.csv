originalTitle,body,reformulatedTitle
How do I fill a DataSet or a DataTable from a LINQ query resultset ?," How do you expose a LINQ query as an ASMX web service?Usually, from the business tier, I can return a typed DataSet or a DataTable which can be serialized for transport over ASMX.How can I do the same for a LINQ query? Is there a way to populate a typed DataSet or a DataTable via a LINQ query? How could I put the result set of a LINQ query into a DataSet or a DataTable?Alternatively, can the LINQ query be serializable so that I can expose it as an ASMX web service? <code>  public static MyDataTable CallMySproc(){ string conn = ""...""; MyDatabaseDataContext db = new MyDatabaseDataContext(conn); MyDataTable dt = new MyDataTable(); // execute a sproc via LINQ var query = from dr in db.MySproc().AsEnumerable select dr; // copy LINQ query resultset into a DataTable -this does not work ! dt = query.CopyToDataTable(); return dt;}",Filling a DataSet or a DataTable from a LINQ query result set
Filling a DataSet or DataTable from a LINQ query result set," How do you expose a LINQ query as an ASMX web service?Usually, from the business tier, I can return a typed DataSet or a DataTable which can be serialized for transport over ASMX.How can I do the same for a LINQ query? Is there a way to populate a typed DataSet or a DataTable via a LINQ query? How could I put the result set of a LINQ query into a DataSet or a DataTable?Alternatively, can the LINQ query be serializable so that I can expose it as an ASMX web service? <code>  public static MyDataTable CallMySproc(){ string conn = ""...""; MyDatabaseDataContext db = new MyDatabaseDataContext(conn); MyDataTable dt = new MyDataTable(); // execute a sproc via LINQ var query = from dr in db.MySproc().AsEnumerable select dr; // copy LINQ query resultset into a DataTable -this does not work ! dt = query.CopyToDataTable(); return dt;}",Filling a DataSet or a DataTable from a LINQ query result set
Adding Scripting functionality to .net Apps," I have a little game written in C#. It uses a database as back-end. It's a trading card game, and I wanted to implement the function of the cards as a script.What I mean is that I essentially have an interface, ICard, which a card class implements (public class Card056: ICard) and which contains a function that is called by the game.Now, to make the thing maintainable/moddable, I would like to have the class for each card as source code in the database and essentially compile it on first use. So when I have to add/change a card, I'll just add it to the database and tell my application to refresh, without needing any assembly deployment (especially since we would be talking about 1 assembly per card which means hundreds of assemblies).Is that possible? Register a class from a source file and then instantiate it, etc. The language is C# but extra bonus if it's possible to write the script in any .NET language. <code>  ICard Cards[current] = new MyGame.CardLibrary.Card056();Cards[current].OnEnterPlay(ref currentGameState);",Adding scripting functionality to .NET applications
Adding Scripting functionality to .NET applications," I have a little game written in C#. It uses a database as back-end. It's a trading card game, and I wanted to implement the function of the cards as a script.What I mean is that I essentially have an interface, ICard, which a card class implements (public class Card056: ICard) and which contains a function that is called by the game.Now, to make the thing maintainable/moddable, I would like to have the class for each card as source code in the database and essentially compile it on first use. So when I have to add/change a card, I'll just add it to the database and tell my application to refresh, without needing any assembly deployment (especially since we would be talking about 1 assembly per card which means hundreds of assemblies).Is that possible? Register a class from a source file and then instantiate it, etc. The language is C# but extra bonus if it's possible to write the script in any .NET language. <code>  ICard Cards[current] = new MyGame.CardLibrary.Card056();Cards[current].OnEnterPlay(ref currentGameState);",Adding scripting functionality to .NET applications
.NET Testing Framework Advice," I'm looking to introduce a unit testing framework into the mix at my job. We're using Visual Studio 2005 (though we may be moving to 2008 within the next six months) and work primarily in C#. If the framework has some kind of IDE integration that would be best, but I'm open to frameworks that don't have integration but are still relatively simple to get set up. I'm going to get resistance to it one way or another, so if I can make sure what I'm pushing isn't a pain in the neck, that would help my case.The obvious choice from the research I've done so far points to NUnit, but I'd like to get the impressions of someone who's actually used it before recommending it to my team.Has anyone out there used NUnit? If so, are there any pitfalls or limitations of which I should be aware? Are there other good options out there? If so, if you've used both NUnit at that, I'd greatly appreciate an idea of the strengths and weaknesses of them. <code> ",.NET testing framework advice
Hiding inherited members in C#," I'm looking for some way to effectively hide inherited members. I have a library of classes which inherit from common base classes. Some of the more recent descendant classes inherit dependency properties which have become vestigial and can be a little confusing when using IntelliSense or using the classes in a visual designer.These classes are all controls that are written to be compiled for either WPF or Silverlight 2.0. I know about ICustomTypeDescriptor and ICustomPropertyProvider, but I'm pretty certain those can't be used in Silverlight. It's not as much a functional issue as a usability issue. What should I do?UpdateSome of the properties that I would really like to hide come from ancestors that are not my own and because of a specific tool I'm designing for, I can't do member hiding with the new operator. (I know, it's ridiculous) <code> ",Hiding inherited members
C#: Accessing a Dictionary.Keys Key through a numeric index," I'm using a Dictionary<string, int> where the int is a count of the key.Now, I need to access the last-inserted Key inside the Dictionary, but I do not know the name of it. The obvious attempt: does not work, because Dictionary.Keys does not implement a []-indexer.I just wonder if there is any similar class? I thought about using a Stack, but that only stores a string. I could now create my own struct and then use a Stack<MyStruct>, but I wonder if there is another alternative, essentially a Dictionary that implements an []-indexer on the Keys? <code>  int LastCount = mydict[mydict.keys[mydict.keys.Count]];",Accessing a Dictionary.Keys Key through a numeric index
C# logic order," In C#, (and feel free to answer for other languages), what order does the runtime evaluate a logic statement?Example: Which statement does the runtime evaluate first - or: ?Is there a time when the compiler would ever evaluate the statement backwards? Perhaps when an ""OR"" operator is involved? & is known as a logical bitwise operator and will always evaluate all the sub-expressionsWhat is a good example of when to use the bitwise operator instead of the ""short-circuited boolean""? <code>  DataTable myDt = new DataTable();if (myDt != null && myDt.Rows.Count > 0){ //do some stuff with myDt} myDt != null myDt.Rows.Count > 0",C# logic order and compiler behavior
In C# what is the difference between String and string," Example (note the case): What are the guidelines for the use of each? And what are the differences? <code>  string s = ""Hello world!"";String s = ""Hello world!"";",What is the difference between String and string in C#?
What is the difference between String and string," Example (note the case): What are the guidelines for the use of each? And what are the differences? <code>  string s = ""Hello world!"";String s = ""Hello world!"";",What is the difference between String and string in C#?
What's the difference between String and string?," Example (note the case): What are the guidelines for the use of each? And what are the differences? <code>  string s = ""Hello world!"";String s = ""Hello world!"";",What is the difference between String and string in C#?
In C# What's the difference between String and string?," Example (note the case): What are the guidelines for the use of each? And what are the differences? <code>  string s = ""Hello world!"";String s = ""Hello world!"";",What is the difference between String and string in C#?
What is the difference between String and string in C#?," Example (note the case): What are the guidelines for the use of each? And what are the differences? <code>  string s = ""Hello world!"";String s = ""Hello world!"";",What is the difference between String and string in C#?
WPF - Sorting a composite collection," So WPF doesn't support standard sorting or filtering behavior for views of CompositeCollections, so what would be a best practice for solving this problem. There are two or more object collections of different types. You want to combine them into a single sortable and filterable collection (withing having to manually implement sort or filter).One of the approaches I've considered is to create a new object collection with only a few core properties, including the ones that I would want the collection sorted on, and an object instance of each type. And then loop through my two object collections to build the new composite collection. Obviously this is a bit of a brute force method, but it would work. I'd get all the default view sorting and filtering behavior on my new composite object collection, and I'd be able to put a data template on it to display my list items properly depending on which type is actually stored in that composite item.What suggestions are there for doing this in a more elegant way? <code>  class MyCompositeObject{ enum ObjectType; DateTime CreatedDate; string SomeAttribute; myObjectType1 Obj1; myObjectType2 Obj2;{class MyCompositeObjects : List<MyCompositeObject> { }",Sorting a composite collection
C# Save Dialogs, What would be the easiest way to separate the directory name from the file name when dealing with SaveFileDialog.FileName in C#? <code> ,How to get only directory name from SaveFileDialog.FileName
Increases Skills what should I learn?," My path to a 'fulltime'- developer stated as a analyst using VBA with Excel, Access, and then onto C#. I went to college part time once I discovered I had a passion for coding not business.I do about most of my coding in C#, but being an ASP.NET developer I also write in HTML, JavaScript, SQL etc. . . the usual suspects.I like to keep moving forward find the edge that will get me to the next level, the next job, and of course more money. Most importantly I just want to learning something new and challenge me.I have spent time recently learning LINQ, but was wondering what should I learn next? Something on the .NET Framework or a new language technology? <code> ",What should I learn to increase my skills?
Is it possible to Embed Gecko or Webkit in a C#.NET Win Form just like a WebView?," I'd love to know if there is such a thing as a Gecko.NET ;) I mean, just like we can embed a WebView and that is an ""instance"" of IE7 inside any Windows Forms application (and tell it to navigateto(fancy_url);). I'd love to use Firefox or WebKit. Anybody tried this?UPDATE: Please bear in mind that although it is possible to embed Gecko using the mentioned controls, it is still impossible to print while using Gecko.UPDATE March 2010: Its still not possible to print natively using GeckoFX, however a couple of methods exist that may be enough, depending upon what youre trying to do. See: http://geckofx.org/viewtopic.php?id=796 for more information.UPDATE October 2013: I am no longer doing Windows development so I have no interest in this, but seems like the development of Gecko can be found here: https://bitbucket.org/geckofx and it seems to be recently updated. Leaving this here for future Windows devs ;)UPDATE January 2017: I have gotten an email from a company called TeamDev. They created a Chromium-based .NET browser component called ""DotNetBrowser"" which can be used to display modern web pages in Windows Forms applications. To quote the email directly: Here are some details about the component, which might be helpful:DotNetBrowser is based on Chromium, thus supporting HTML5, CSS3, JS and the latest web standards. The underlying Chromium version of the library is regularly updated.The component is suitable for WPF as well as Windows Forms desktop applications, and works both for C# and VB.NET.The library is licensed commercially, however free licences are provided for Open Source and academic projects.Disclaimer: I have not used this DotNetBrowser for I no longer do Windows Development but may be worth checking if you're looking for a solution to this. <code> ",Is it possible to Embed Gecko or Webkit in a Windows Form just like a WebView?
"In .NET, how do I launch a file with command line arguments (without knowing the location of the exe)?"," Here's the situation: I am trying to launch an application, but the location of the .exe isn't known to me. Now, if the file extension is registered (in Windows), I can do something like: However, I need to pass some command line arguments as well. I couldn't get this to work Any suggestions on a mechanism to solve this?Edit @ akuMy StackOverflow search skills are weak; I did not find that post. Though I generally dislike peering into the registry, that's a great solution. Thanks! <code>  Process.Start(""Sample.xls""); Process p = new Process(); p.StartInfo.FileName = ""Sample.xls""; p.StartInfo.Arguments = ""/r""; // open in read-only mode p.Start();",Launch a file with command line arguments without knowing location of exe?
Whats the best way to test a method from multiple threads?," this kind of follows on from another question of mine.Basically, once I have the code to access the file (will review the answers there in a minute) what would be the best way to test it?I am thinking of creating a method which just spawns lots of BackgroundWorker's or something and tells them all load/save the file, and test with varying file/object sizes. Then, get a response back from the threads to see if it failed/succeeded/made the world implode etc.Can you guys offer any suggestions on the best way to approach this? As I said before, this is all kinda new to me :)EditFollowing ajmastrean's post:I am using a console app to test with Debug.Asserts :)UpdateI originally rolled with using BackgroundWorker to deal with the threading (since I am used to that from Windows dev) I soon realised that when I was performing tests where multiple ops (threads) needed to complete before continuing, I realised it was going to be a bit of a hack to get it to do this.I then followed up on ajmastrean's post and realised I should really be using the Thread class for working with concurrent operations. I will now refactor using this method (albeit a different approach). <code> ",Whats the best way to unit test from multiple threads?
how would you architect a desktop application in C# 3.0," I've created a simple desktop application in C# 3.0 to learn some C#, wpf and .Net 3.5.My application essentially reads data from a csv file and stores it in a SQL server CE database. I use sqlmetal to generate the ORM code for the database.My first iteration of this app is ugly as hell and I'm in the process of refactoring it.Which brings me to my question. How would you architect a desktop database app in C#?What are the best practices?Do you create a Database Abstraction Layer (DAL) which uses the sqlmetal generated code? Or is the generated code enough of an abstraction?If you use DAL pattern, do you make it a singleton or a static member?Do you use the View-Model-ModelView pattern with the DAL pattern?Apologies if this seems like a long open ended question, but I have been giving this a lot of thought recently.I see a lot of examples on how to architect an enterprise n-tier app in C# but not that many on architecting standalone desktop apps. <code> ",How would you architect a desktop application in C# 3.0
What are the best code snippets for C#?," What are the best code snippets for C#? (using visual studio) VB has a lot that are pre-defined, but there are only a handful for C#. Do you have any really useful ones for C#?Anyone want to post a good custom one you created yourself?Anyone?... Bueller? <code> ",What are the most useful (custom) code snippets for C#?
Is it possible to unit test p/invoke calls?," I want to wrap a piece of code that uses the Windows Impersonation API into a neat little helper class, and as usual, I'm looking for a way to go test-first. However, while WindowsIdentity is a managed class, the LogonUser call that is required to actually perform the logging in as another user is an unmanaged function in advapi32.dll. I think I can work around this by introducing an interface for my helper class to use and hiding the P/Invoke calls in an implementation, but testing that implementation will still be a problem. And you can imagine actually performing the impersonation in the test can be a bit problematic, given that the user would actually need to exist on the system. <code> ",Is it possible to unit test a class that makes P/Invoke calls?
Get the App.Config of Another Exe," I have an exe with an App.Config file. Now I want to create a wrapper dll around the exe in order to consume some of the functionalities.The question is how can I access the app.config property in the exe from the wrapper dll?Maybe I should be a little bit more in my questions, I have the following app.config content with the exe: The question is how to how to get ""myValue"" out from the wrapper dll?thanks for your solution.Actually my initial concept was to avoid XML file reading method or LINQ or whatever. My preferred solution was to use the configuration manager libraries and the like.I'll appreciate any help that uses the classes that are normally associated with accessing app.config properties.  <code>  <?xml version=""1.0"" encoding=""utf-8"" ?><configuration> <appSettings> <add key=""myKey"" value=""myValue""/> </appSettings></configuration>",Get the App.Config of another Exe
C#: Is there any difference between bool? and Nullable<bool> ?, In C# are the nullable primitive types (i.e. bool?) just aliases for their corresponding Nullable<T> type or is there a difference between the two? <code> ,Is there any difference between type? and Nullable<type>?
Is there any difference between bool? and Nullable<bool>?, In C# are the nullable primitive types (i.e. bool?) just aliases for their corresponding Nullable<T> type or is there a difference between the two? <code> ,Is there any difference between type? and Nullable<type>?
Help convert this delegate to an anonymous method or lambda," I am new to all the anonymous features and need some help. I have gotten the following to work: But this is totally ugly and I would like to have the inside of the Do to be an anonymous method or even a lambda if it is possible. I tried: and but these give me Cannot convert anonymous method to type 'System.Delegate' because it is not a delegate type** compile errors.What am I doing wrong?Because of what Mark Ingram posted, seems like the best answer, though nobody's explicitly said it, is to do this: <code>  public void FakeSaveWithMessage(Transaction t){ t.Message = ""I drink goats blood"";}public delegate void FakeSave(Transaction t);public void SampleTestFunction(){ Expect.Call(delegate { _dao.Save(t); }).Do(new FakeSave(FakeSaveWithMessage));} Expect.Call(delegate { _dao.Save(t); }).Do(delegate(Transaction t2) { t2.Message = ""I drink goats blood""; }); Expect.Call(delegate { _dao.Save(t); }).Do(delegate { t.Message = ""I drink goats blood""; }); public delegate void FakeSave(Transaction t);Expect.Call(delegate { _dao.Save(t); }).Do( new FakeSave(delegate(Transaction t2) { t.Message = expected_msg; }));",Convert this delegate to an anonymous method or lambda
Null or default comparsion of generic argument," I have a generic method defined like this: The first thing I want to do is check if the value of myArgument is the default value for that type, something like this: But this doesn't compile because I haven't guaranteed that T will implement the == operator. So I switched the code to this: Now this compiles, but will fail if myArgument is null, which is part of what I'm testing for. I can add an explicit null check like this: Now this feels redundant to me. ReSharper is even suggesting that I change the myArgument == null part into myArgument == default(T) which is where I started. Is there a better way to solve this problem?I need to support both references types and value types. <code>  public void MyMethod<T>(T myArgument) if (myArgument == default(T)) if (myArgument.Equals(default(T))) if (myArgument == null || myArgument.Equals(default(T)))",Null or default comparison of generic argument in C#
Null or default comparsion of generic argument in C#," I have a generic method defined like this: The first thing I want to do is check if the value of myArgument is the default value for that type, something like this: But this doesn't compile because I haven't guaranteed that T will implement the == operator. So I switched the code to this: Now this compiles, but will fail if myArgument is null, which is part of what I'm testing for. I can add an explicit null check like this: Now this feels redundant to me. ReSharper is even suggesting that I change the myArgument == null part into myArgument == default(T) which is where I started. Is there a better way to solve this problem?I need to support both references types and value types. <code>  public void MyMethod<T>(T myArgument) if (myArgument == default(T)) if (myArgument.Equals(default(T))) if (myArgument == null || myArgument.Equals(default(T)))",Null or default comparison of generic argument in C#
Double and floats in C#, Do C#/.NET floating point operations differ in precision between debug mode and release mode? <code> ,Float/double precision in debug/release modes
Flout/double precision in debug/release modes, Do C#/.NET floating point operations differ in precision between debug mode and release mode? <code> ,Float/double precision in debug/release modes
How do I get my c# program to sleep for 50 msec?," How do I get my C# program to sleep for 50 milliseconds?This might seem an easy question, but I'm having a temporary brain failure moment! <code> ",How do I get my C# program to sleep for 50 msec?
Background color of a ListBox item (winforms), How can I set the background color of a specific item in a System.Windows.Forms.ListBox?I would like to be able to set multiple ones if possible. <code> ,Background color of a ListBox item (Windows Forms)
How to remove all event handlers from a control, To create a new event handler on a control you can do this or this and to remove an event handler you can do this But how do you remove all event handlers from an event? <code>  c.Click += new EventHandler(mainFormButton_Click); c.Click += mainFormButton_Click; c.Click -= mainFormButton_Click;,How to remove all event handlers from an event
C# - How do you get total amount of RAM the computer has?," Using C#, I want to get the total amount of RAM that my computer has.With the PerformanceCounter I can get the amount of Available ram, by setting: But I can't seem to find a way to get the total amount of memory. How would I go about doing this?Update:MagicKat: I saw that when I was searching, but it doesn't work - ""Are you missing an assembly or reference?"". I've looked to add that to the References, but I don't see it there. <code>  counter.CategoryName = ""Memory"";counter.Countername = ""Available MBytes"";",How do you get total amount of RAM the computer has?
Best way to randomize a string array in C#, What is the best way to randomize an array of strings with .NET? My array contains about 500 strings and I'd like to create a new Array with the same strings but in a random order.Please include a C# example in your answer. <code> ,Best way to randomize an array with .NET
Best way to randomize a string array with .NET, What is the best way to randomize an array of strings with .NET? My array contains about 500 strings and I'd like to create a new Array with the same strings but in a random order.Please include a C# example in your answer. <code> ,Best way to randomize an array with .NET
How do i kill a process using Vb.NET or C# ?," I have a scenario where I have to check whether user has already opened Microsoft Word. If he has, then I have to kill the winword.exe process and continue to execute my code. Does any one have any straight-forward code for killing a process using vb.net or c#? <code> ",How do I kill a process using Vb.NET or C# ?
ASP Nested Tags in a Custom User Control ," I'm just getting started with Custom User Controls in C# and I'm wondering if there are any examples out there of how to write one which accepts nested tags?For example, when you create an asp:repeater you can add a nested tag for itemtemplate. <code> ",ASP Nested Tags in a Custom User Control
Easier way to start debugging a windows service in C#, Is there an easier way to step through the code than to start the service through the Windows Service Control Manager and then attaching the debugger to the thread? It's kind of cumbersome and I'm wondering if there is a more straightforward approach. <code> ,Easier way to debug a Windows service
Easier way to debug a C# Windows Service, Is there an easier way to step through the code than to start the service through the Windows Service Control Manager and then attaching the debugger to the thread? It's kind of cumbersome and I'm wondering if there is a more straightforward approach. <code> ,Easier way to debug a Windows service
regular expression banker's rounding," Does anyone know how I can get a format string to use bankers rounding? I have been using ""{0:c}"" but that doesn't round the same way that bankers rounding does. The Math.Round() method does bankers rounding. I just need to be able to duplicate how it rounds using a format string.Note: the original question was rather misleading, and answers mentioning regex derive from that. <code> ",.NET currency formatter: can I specify the use of banker's rounding?
What is the best way to iterate over a Dictionary in C#?, I've seen a few different ways to iterate over a dictionary in C#. Is there a standard way? <code> ,How to iterate over a dictionary?
What is the best way to iterate over a dictionary?, I've seen a few different ways to iterate over a dictionary in C#. Is there a standard way? <code> ,How to iterate over a dictionary?
Maximum number of threads in a C# app?, What is the maximum number of threads you can create in a C# application? And what happens when you reach this limit? Is an exception of some kind thrown? <code> ,Maximum number of threads in a .NET app?
".Net, Is Array.Sort stable sort?", Is the sorting algorithm used by .NET's Array.Sort() method a stable algorithm? <code> ,Is the sorting algorithm used by .NET's `Array.Sort()` method a stable algorithm?
Tuples in C#," .Net 3.5 doesn't support tuples. Too bad, But not sure whether the future version of .net will support tuples or not?  <code> ",Will a future version of .NET support tuples in C#?
Show a Form without stealing focus (in C#)," I'm using a Form to show notifications (it appears at the bottom right of the screen), but when I show this form it steals the focus from the main Form. Is there a way to show this ""notification"" form without stealing focus? <code> ",Show a Form without stealing focus?
C# Can I Override with derived types?," As far as i know it is not possible to do the following in C# 2.0 I workaround the problem by creating the property in the derived class as ""new"", but of course that is not polymorphic. Is there any solution in 2.0?What about any features in 3.5 that address this matter?  <code>  public class Father{ public virtual Father SomePropertyName { get { return this; } }}public class Child : Father{ public override Child SomePropertyName { get { return this; } }} public new Child SomePropertyName",Can I Override with derived types?
Creating SQL Server Management Studio 2005 Plugins," I have read that while plug-ins are not supported for SQL Server Management Studio, it can be done.Does anyone have any resources or advice on how to go about it using C#?A company that is currently offering plug-ins to Management Studio is Red Gate:http://www.red-gate.com/products/SQL_Refactor/index.htm <code> ",Where can i find information on creating plugins for SQL Server Management Studio?
How do you force creator signatures and static methods?," Is there a way of forcing a (child) class to have constructors with particular signatures or particular static methods in C# or Java?You can't obviously use interfaces for this, and I know that it will have a limited usage. One instance in which I do find it useful is when you want to enforce some design guideline, for example:ExceptionsThey should all have the four canonical constructors, but there is no way to enforce it. You have to rely on a tool like FxCop (C# case) to catch these.OperatorsThere is no contract that specifies that two classes can be summed (with operator+ in C#)Is there any design pattern to work around this limitation?What construct could be added to the language to overcome this limitation in future versions of C# or Java? <code> ",How do you force constructor signatures and static methods?
What tools and techniques do you use to find dead code in .NET?," What tools and techniques do you use to find dead code in .NET?In the past, I've decorated methods with the Obsolete attribute (passing true so the compiler will issue an error, as described in MSDN).I'd be interested in seeing the suggestions of others (beyond tools like FxCop or ReSharper). I want to make sure I'm not missing out on other tools that would be helpful. <code> ",What tools and techniques do you use to find dead code?
StreamWriter: Max Write Length?," Is there a maximum number of characters that can be written to a file using a StreamWriter? Or is there a maximum number of characters that WriteLine() can output? I am trying to write some data to a file but all of the data does not seem to make it. This is the current state of my code: <code>  StreamWriter sw = new StreamWriter(pathToFile);foreach (GridViewRow record in gv_Records.Rows){ string recordInfo = ""recordInformation""; sw.WriteLine(recordInfo);}",Is there a maximum number of characters that can be written using a StreamWriter?
Assuming 32bit ints," In my C# source code I may have declared integers as: or In the currently prevalent 32-bit world they are equivalent. However, as we move into a 64-bit world, am I correct in saying that the following will become the same? <code>  int i = 5; Int32 i = 5; int i = 5;Int64 i = 5;",Is an int a 64-bit integer in 64-bit C#?
Is it safe to assume an int will always be 32 bits in C#?," In my C# source code I may have declared integers as: or In the currently prevalent 32-bit world they are equivalent. However, as we move into a 64-bit world, am I correct in saying that the following will become the same? <code>  int i = 5; Int32 i = 5; int i = 5;Int64 i = 5;",Is an int a 64-bit integer in 64-bit C#?
Simple 2 way encryption for C#," I'm looking for very simple obfuscation (like encrypt and decrypt but not necessarily secure) functionality for some data. It's not mission critical. I need something to keep honest people honest, but something a little stronger than ROT13 or Base64.I'd prefer something that is already included in the .NET framework 2.0, so I don't have to worry about any external dependencies.I really don't want to have to mess around with public/private keys, etc. I don't know much about encryption, but I do know enough to know that anything I wrote would be less than worthless... In fact, I'd probably screw up the math and make it trivial to crack. <code> ","Simple insecure two-way data ""obfuscation""?"
Simple two-way encryption for C#," I'm looking for very simple obfuscation (like encrypt and decrypt but not necessarily secure) functionality for some data. It's not mission critical. I need something to keep honest people honest, but something a little stronger than ROT13 or Base64.I'd prefer something that is already included in the .NET framework 2.0, so I don't have to worry about any external dependencies.I really don't want to have to mess around with public/private keys, etc. I don't know much about encryption, but I do know enough to know that anything I wrote would be less than worthless... In fact, I'd probably screw up the math and make it trivial to crack. <code> ","Simple insecure two-way data ""obfuscation""?"
Simple 2 way encryption for C#," I'm looking for very simple obfuscation (like encrypt and decrypt but not necessarily secure) functionality for some data. It's not mission critical. I need something to keep honest people honest, but something a little stronger than ROT13 or Base64.I'd prefer something that is already included in the .NET framework 2.0, so I don't have to worry about any external dependencies.I really don't want to have to mess around with public/private keys, etc. I don't know much about encryption, but I do know enough to know that anything I wrote would be less than worthless... In fact, I'd probably screw up the math and make it trivial to crack. <code> ","Simple insecure two-way data ""obfuscation""?"
Simple two-way encryption for C#," I'm looking for very simple obfuscation (like encrypt and decrypt but not necessarily secure) functionality for some data. It's not mission critical. I need something to keep honest people honest, but something a little stronger than ROT13 or Base64.I'd prefer something that is already included in the .NET framework 2.0, so I don't have to worry about any external dependencies.I really don't want to have to mess around with public/private keys, etc. I don't know much about encryption, but I do know enough to know that anything I wrote would be less than worthless... In fact, I'd probably screw up the math and make it trivial to crack. <code> ","Simple insecure two-way data ""obfuscation""?"
"Simple insecure two-way ""encryption"" for C"," I'm looking for very simple obfuscation (like encrypt and decrypt but not necessarily secure) functionality for some data. It's not mission critical. I need something to keep honest people honest, but something a little stronger than ROT13 or Base64.I'd prefer something that is already included in the .NET framework 2.0, so I don't have to worry about any external dependencies.I really don't want to have to mess around with public/private keys, etc. I don't know much about encryption, but I do know enough to know that anything I wrote would be less than worthless... In fact, I'd probably screw up the math and make it trivial to crack. <code> ","Simple insecure two-way data ""obfuscation""?"
"Simple insecure two-way ""obfuscation"" for C"," I'm looking for very simple obfuscation (like encrypt and decrypt but not necessarily secure) functionality for some data. It's not mission critical. I need something to keep honest people honest, but something a little stronger than ROT13 or Base64.I'd prefer something that is already included in the .NET framework 2.0, so I don't have to worry about any external dependencies.I really don't want to have to mess around with public/private keys, etc. I don't know much about encryption, but I do know enough to know that anything I wrote would be less than worthless... In fact, I'd probably screw up the math and make it trivial to crack. <code> ","Simple insecure two-way data ""obfuscation""?"
"Simple insecure two-way ""obfuscation"" for C#"," I'm looking for very simple obfuscation (like encrypt and decrypt but not necessarily secure) functionality for some data. It's not mission critical. I need something to keep honest people honest, but something a little stronger than ROT13 or Base64.I'd prefer something that is already included in the .NET framework 2.0, so I don't have to worry about any external dependencies.I really don't want to have to mess around with public/private keys, etc. I don't know much about encryption, but I do know enough to know that anything I wrote would be less than worthless... In fact, I'd probably screw up the math and make it trivial to crack. <code> ","Simple insecure two-way data ""obfuscation""?"
Is there a Timer class in C# that isn't in the Windows.Forms namespace?, I want to use a timer in my simple .NET application written in C#. The only one I can find is the Windows.Forms.Timer class. I don't want to reference this namespace just for my console application. Is there a C# timer (or timer like) class for use in console applications? <code> ,Is there a timer class in C# that isn't in the Windows.Forms namespace?
Avoiding duplicate content in asp.net MVC due to case insensetive URLs and defaults," Edit: Now I need to solve this problem for real, I did a little more investigation and came up with a number of things to reduce duplicate content. I posted detailed code samples on my blog: Reducing Duplicate Content with ASP.NET MVCFirst post - go easy if I've marked this up wrong or tagged it badly :PIn Microsoft's new ASP.NET MVC framework it seems there are two things that could cause your content to be served up at multiple URLs (something which Google penalize for and will cause your PageRank to be split across them):Case-insensitive URLsDefault URLYou can set the default controller/action to serve up for requests to the root of your domain. Let's say we choose HomeController/Index. We end up with the following URLs serving up the same content:mydomain.com/mydomain.com/Home/IndexNow if people start linking to both of these then PageRank would be split. Google would also consider it duplicate content and penalize one of them to avoid duplicates in their results.On top of this, the URLs are not case sensitive, so we actually get the same content for these URLs too:mydomain.com/Home/Indexmydomain.com/home/indexmydomain.com/Home/indexmydomain.com/home/Index(the list goes on)So, the question... How do I avoid these penalties? I would like:All requests for the default action to be redirected (301 status) to the same urlAll URLs to be case sensitivePossible? <code> ",How can I avoid duplicate content in ASP.NET MVC due to case-insensitive URLs and defaults?
Avoiding duplicate content penalties in asp.net MVC due to case insensetive URLs and default actions," Edit: Now I need to solve this problem for real, I did a little more investigation and came up with a number of things to reduce duplicate content. I posted detailed code samples on my blog: Reducing Duplicate Content with ASP.NET MVCFirst post - go easy if I've marked this up wrong or tagged it badly :PIn Microsoft's new ASP.NET MVC framework it seems there are two things that could cause your content to be served up at multiple URLs (something which Google penalize for and will cause your PageRank to be split across them):Case-insensitive URLsDefault URLYou can set the default controller/action to serve up for requests to the root of your domain. Let's say we choose HomeController/Index. We end up with the following URLs serving up the same content:mydomain.com/mydomain.com/Home/IndexNow if people start linking to both of these then PageRank would be split. Google would also consider it duplicate content and penalize one of them to avoid duplicates in their results.On top of this, the URLs are not case sensitive, so we actually get the same content for these URLs too:mydomain.com/Home/Indexmydomain.com/home/indexmydomain.com/Home/indexmydomain.com/home/Index(the list goes on)So, the question... How do I avoid these penalties? I would like:All requests for the default action to be redirected (301 status) to the same urlAll URLs to be case sensitivePossible? <code> ",How can I avoid duplicate content in ASP.NET MVC due to case-insensitive URLs and defaults?
F# Comments convention," I am just checking out F#, so apologies if this is a silly question, but in the VS2008 F# CTP 1.9.6.2 'Tutorial' project, both // and /// are used for commenting code.Is there a functional difference between the two slash vs three slash commenting, or is it convention (as it appears in the tutorial code) to comment a function with /// and use // for everything else? <code> ",.NET // vs /// Comments convention
How to manipulate images at pixel level in C#?, How do I manipulate images at the pixel level in C#?I need to be able to read/modify each bitmap pixel RGB values separately. A code sample would be appreciated. <code> ,How to manipulate images at the pixel level in C#
integer formatting with given digits," I need to pad the output of an integer to a given length.For example, with a length of 4 digits, the output of the integer 4 is ""0004"" instead of ""4"". How can I do this in C# 2.0? <code> ","Integer formatting, padding to a given length"
Difference between a C# 2.0 and C# 3.0 feature, What is the difference between anonymous methods of C# 2.0 and lambda expressions of C# 3.0.? <code> ,What's the difference between anonymous methods (C# 2.0) and lambda expressions (C# 3.0)?
Best (free?) Decompiler for C# with VS integration?," In my Java development I have had great benefit from the Jad/JadClipse decompiler. It made it possible to know why a third-party library failed rather than the usual guesswork.I am looking for a similar setup for C# and Visual Studio. That is, a setup where I can point to any class or variable in my code and get a code view for that particular class.What is the best setup for this? I want to be able to use the usual ""jump to declaration/implementation"" that I use to navigate my own code. It doesn't have to be free, but it would be a bonus if it was.It should support Visual Studio 2008 or Visual Studio 2005 and .NET 2 and 3(.5). <code> ",Best (free?) decompiler for C# with Visual Studio integration?
CSharp little endian or big endian?," In the documentation of hardware that allows us to control it via UDP/IP,I found the following fragment: In this communication protocol, DWORD is a 4 bytes data, WORD is a 2 bytes data, BYTE is a single byte data. The storage format is little endian, namely 4 bytes (32bits) data is stored as: d7-d0, d15-d8, d23-d16, d31-d24; double bytes (16bits) data is stored as: d7-d0 , d15-d8.I am wondering how this translates to C#?Do I have to convert stuff before sending it over?For example, if I want to send over a 32 bit integer, or a 4 character string? <code> ",C# little endian or big endian?
Differentiating between single and double clicks in .Net," I want to override OnMouseClick and OnMouseDoubleClick and perform different actions depending on which click style was used.The problem is that OnMouseClick is happening for both single and double clicks, and is getting called before OnMouseDoubleClick.I'm certain this must be a common requirement, so I guess I'm missing something pretty obvious. Can someone fill me in?Edit to add: the MouseEventArgs.Clicks count doesn't help. In the case of a double-click, the first click is handled as a single click in OnMouseClick with MouseEventArgs.Clicks == 1.Edit to add: the objects are image thumbnails. Single click should toggle selection on and off for export. Double click should make the thumbnail full screen. The selection and ""activation"" actions are orthogonal. This may indicate an underlying problem with the two actions...Cheers,Rob  <code> ",How can I differentiate between single and double clicks in .Net?
How can I differentiating between single and double clicks in .Net?," I want to override OnMouseClick and OnMouseDoubleClick and perform different actions depending on which click style was used.The problem is that OnMouseClick is happening for both single and double clicks, and is getting called before OnMouseDoubleClick.I'm certain this must be a common requirement, so I guess I'm missing something pretty obvious. Can someone fill me in?Edit to add: the MouseEventArgs.Clicks count doesn't help. In the case of a double-click, the first click is handled as a single click in OnMouseClick with MouseEventArgs.Clicks == 1.Edit to add: the objects are image thumbnails. Single click should toggle selection on and off for export. Double click should make the thumbnail full screen. The selection and ""activation"" actions are orthogonal. This may indicate an underlying problem with the two actions...Cheers,Rob  <code> ",How can I differentiate between single and double clicks in .Net?
Possible to test if regex is valid without throwing exception," I allow users to enter a regular expression to match IP addresses, for doing an IP filtration in a related system. I would like to validate if the entered regular expressions are valid as a lot of userse will mess op, with good intentions though.I can of course do a Regex.IsMatch() inside a try/catch and see if it blows up that way, but are there any smarter ways of doing it? Speed is not an issue as such, I just prefer to avoid throwing exceptions for no reason. <code> ",Can I test if a regex is valid in C# without throwing exception
.net 2.0 or 3.5," Our clients use a vb6 version of our software.We are upgrading them to a .NET application written in C#...Is there less bulk using .net 2.0 than .net 3.5?My definition of less bulk would be: Smaller size, smaller installation time, etc.Most of them probably already have 2.0 anyway.I only ask because I would like to take advantage of LINQ in 3.5. <code> ",.NET 2.0 or 3.5?
.NET 2.0 or 3.5," Our clients use a vb6 version of our software.We are upgrading them to a .NET application written in C#...Is there less bulk using .net 2.0 than .net 3.5?My definition of less bulk would be: Smaller size, smaller installation time, etc.Most of them probably already have 2.0 anyway.I only ask because I would like to take advantage of LINQ in 3.5. <code> ",.NET 2.0 or 3.5?
"I got problem while stopping thread which displays dialog window in C#, i get exception ""Thread was being aborted"""," In my app I've got a thread which displays for some time ""please wait"" dialog window, sometimes it is a very tiny amout of time and there is some glitch while drawing UI (I guess).I get the exception ""Thread was being aborted"" and completly have no idea how get rid of it. I mean Catch that exception in some way, or in some other way hide it from user. This exception has got nothing to do with rest of my app and that error in any way doesn't affect it. Appears randomly and it is hard to recreate on a call.I tried in various ways to catch that exception by side of code which starts and stops thread with dialog window but it seems that error apparently is by side some other thread which dispalys window in my newly created thread.Here is a code sample, part of static class with useful stuff, of course I don't say that is good way to solve this kind of ""busy"" situation but I want to solve this problem. Thread.Sleep(500); or other try/catch improvments doesn't help me to avoid that thread exception. Any ideas? <code>  public static bool alreadyBusy = false; public static BusyIndicator bi = new BusyIndicator(""""); public static Thread backgroundOpertionThread; public static void showBusy(bool isBusy, System.Windows.Forms.Form hostform, string message) { Common.busyMessage = message; if (isBusy) { Common.alreadyBusy = true; backgroundOpertionThread = new Thread(new ThreadStart(showBusy)); Thread.Sleep(500); if (hostform != null) { hostform.Enabled = false; hostform.SuspendLayout(); } backgroundOpertionThread.Start(); } else { backgroundOpertionThread.Abort(); Thread.Sleep(500); Common.alreadyBusy = false; if (hostform != null) { hostform.Enabled = true; hostform.ResumeLayout(); } } } public static void showBusy() { BusyIndicator bir = new BusyIndicator(Common.busyMessage); bir.ShowDialog(); }","""Thread was being aborted"" exception whilst displaying dialog"
StringBuilder how to get the final String?, Someone told me that it's faster to concatenate strings with StringBuilder. I have changed my code but I do not see any Properties or Methods to get the final build string. How can I get the string? <code> ,StringBuilder: how to get the final String?
Why is it bad to use a iteration variable in a lambda expression," I was just writing some quick code and noticed this complier error Using the iteration variable in a lambda expression may have unexpected results. Instead, create a local variable within the loop and assign it the value of the iteration variable.I know what it means and I can easily fix it, not a big deal.But I was wondering why it is a bad idea to use a iteration variable in a lambda?What problems can I cause later on? <code> ",Why is it bad to use an iteration variable in a lambda expression
Why is it bad to use an iteration variable in a lambda expression," I was just writing some quick code and noticed this complier error Using the iteration variable in a lambda expression may have unexpected results. Instead, create a local variable within the loop and assign it the value of the iteration variable.I know what it means and I can easily fix it, not a big deal.But I was wondering why it is a bad idea to use a iteration variable in a lambda?What problems can I cause later on? <code> ",Why is it bad to use an iteration variable in a lambda expression
Whats the diferance between Invoke() and BeginInvoke(), Just wondering what the difference between BeginInvoke() and Invoke() are? Mainly what each one would be used for.EDIT: What is the difference between creating a threading object and calling invoke on that and just calling BeginInvoke() on a delegate? or are they the same thing? <code> ,What's the difference between Invoke() and BeginInvoke()
Whats the difference between Invoke() and BeginInvoke(), Just wondering what the difference between BeginInvoke() and Invoke() are? Mainly what each one would be used for.EDIT: What is the difference between creating a threading object and calling invoke on that and just calling BeginInvoke() on a delegate? or are they the same thing? <code> ,What's the difference between Invoke() and BeginInvoke()
Add property to anonymous object after creation," I use an anonymous object to pass my Html Attributes to some helper methods.If the consumer didn't add an ID attribute, I want to add it in my helper method.How can I add an attribute to this anonymous object? <code> ",Add property to anonymous type after creation
Can I make subclasses override a method without making it abstract?," I have a class with some abstract methods, but I want to be able to edit a subclass of that class in the designer. However, the designer can't edit the subclass unless it can create an instance of the parent class. So my plan is to replace the abstract methods with stubs and mark them as virtual - but then if I make another subclass, I won't get a compile-time error if I forget to implement them.Is there a way to mark the methods so that they have to be implemented by subclasses, without marking them as abstract? <code> ",Can I force subclasses to override a method without making it abstract?
What is the worst C#/.NET gotcha?," I was recently working with a DateTime object, and wrote something like this: The intellisense documentation for AddDays() says it adds a day to the date, which it doesn't - it actually returns a date with a day added to it, so you have to write it like: This one has bitten me a number of times before, so I thought it would be useful to catalog the worst C# gotchas. <code>  DateTime dt = DateTime.Now;dt.AddDays(1);return dt; // still today's date! WTF? DateTime dt = DateTime.Now;dt = dt.AddDays(1);return dt; // tomorrow's date",What is the worst gotcha in C# or .NET?
[C#] How do I form a good predicate to Find() something in my List<T>?," After looking on MSDN, it's still unclear to me how I should form a proper predicate to use the Find() method in List using a member variable of T (where T is a class)For example: What should my ""byYear"" predicate look like? (The MSDN example only talks about a List of dinosaurs and only searches for an unchanging value ""saurus"" -- It doesn't show how to pass a value into the predicate...)EDIT: I'm using VS2005/.NET2.0, so I don't think Lambda notation is available to me...EDIT2: Removed ""1999"" in the example because I may want to ""Find"" programatically based on different values. Example changed to range of cars from 1980 to 2000 using for-do loop. <code>  public class Car{ public string Make; public string Model; public int Year;}{ // somewhere in my code List<Car> carList = new List<Car>(); // ... code to add Cars ... Car myCar = new Car(); // Find the first of each car made between 1980 and 2000 for (int x = 1980; x < 2000; x++) { myCar = carList.Find(byYear(x)); Console.Writeline(myCar.Make + myCar.Model); }}",How do I form a good predicate delegate to Find() something in my List<T>?
How do I form a good predicate to Find() something in my List<T>?," After looking on MSDN, it's still unclear to me how I should form a proper predicate to use the Find() method in List using a member variable of T (where T is a class)For example: What should my ""byYear"" predicate look like? (The MSDN example only talks about a List of dinosaurs and only searches for an unchanging value ""saurus"" -- It doesn't show how to pass a value into the predicate...)EDIT: I'm using VS2005/.NET2.0, so I don't think Lambda notation is available to me...EDIT2: Removed ""1999"" in the example because I may want to ""Find"" programatically based on different values. Example changed to range of cars from 1980 to 2000 using for-do loop. <code>  public class Car{ public string Make; public string Model; public int Year;}{ // somewhere in my code List<Car> carList = new List<Car>(); // ... code to add Cars ... Car myCar = new Car(); // Find the first of each car made between 1980 and 2000 for (int x = 1980; x < 2000; x++) { myCar = carList.Find(byYear(x)); Console.Writeline(myCar.Make + myCar.Model); }}",How do I form a good predicate delegate to Find() something in my List<T>?
Best way test for XPath existence in Linq?," Lately I've been using XPathDocument and XNavigator to parse an XML file for a given XPath and attribute. It's been working very well, when I know in advance what the XPath is. Sometimes though, the XPath will be one of several possible XPath values, and I'd like to be able to test whether or not a given XPath exists. In case I'm getting the nomenclature wrong, here's what I'm calling an XPath - given this XML blob: I might be looking for what I'm calling an XPath of ""//foo/bar"" and then reading the attribute ""baz"" to get the value. Example of the code that I use to do this: Now, if the call to navigator.SelectSingleNode fails, it will return a NullReferenceException or an XPathException. I can catch both of those and refactor the above into a test to see whether or not a given XPath returns an exception, but I was wondering whether there was a better way? I didn't see anything obvious in the Intellisense. XPathNavigator has .HasAttributes and .HasChildren but short of iterating through the path one node at a time, I don't see anything nicer to use.  <code>  <foo> <bar baz=""This is the value of the attribute named baz""></foo> XPathDocument document = new XPathDocument(filename);XPathNavigator navigator = document.CreateNavigator();XPathNavigator node = navigator.SelectSingleNode(""//foo/bar"");if(node.HasAttributes){ Console.WriteLine(node.GetAttribute(""baz"", string.Empty));}",Best way test for XPath existence in an XML file?
Windows service and timer, I need to create some windows service which will execute every N period of time.The question is:Which timer control should I use: System.Timers.Timer or System.Threading.Timer one? Does it influence on something? I am asking because I heard many evidences to non correct work of System.Timers.Timer in windows services.Thank you. <code> ,Best Timer for using in a Windows service
What are the correct version numbers for C#?," What are the correct version numbers for C#? What came out when? Why can't I find any answers about C# 3.5?This question is primarily to aid those who are searching for an answer using an incorrect version number, e.g. C# 3.5. The hope is that anyone failing to find an answer with the wrong version number will find this question and then search again with the right version number. <code> ",What are the correct version numbers for C#?
What are the correct version numbers?," What are the correct version numbers for C#? What came out when? Why can't I find any answers about C# 3.5?This question is primarily to aid those who are searching for an answer using an incorrect version number, e.g. C# 3.5. The hope is that anyone failing to find an answer with the wrong version number will find this question and then search again with the right version number. <code> ",What are the correct version numbers for C#?
High Quality Image Scaling C#, I want to scale an image in C# with quality level as good as Photoshop does. Is there any C# image processing library available to do this thing? <code> ,High Quality Image Scaling Library
Can't use HttpWebRequest with GET method," I have the following code which works just fine when the method is ""POST"", but changing to ""GET"" doesn't work: I get a ProtocolViolationException exception with the ""GET"" method.Edit: After having a look using Reflector, it seems there is an explicit check for the ""GET"" method, if it's set to that it throws the exception.Edit2: I've updated my code to the following, but it still throws an exception when I call EndGetResponse() In my function, ResponseCallback, I have this: Which throws the exception as well.Answer The above code now works, I had forgotten to take out the Content-Type line which was causing the exception to be thrown at the end. +1 to tweakt & answer to Jon.The working code is now below: <code>  HttpWebRequest request = null;request = HttpWebRequest.Create(uri) as HttpWebRequest;request.ContentType = ""application/x-www-form-urlencoded; charset=UTF-8"";request.Method = ""POST""; // Doesn't work with ""GET""request.BeginGetRequestStream(this.RequestCallback, null); if (request.Method == ""GET""){ request.BeginGetResponse(this.ResponseCallback, state);}else{ request.BeginGetRequestStream(this.RequestCallback, state);} HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(asyncResult); HttpWebRequest request = null;request = HttpWebRequest.Create(uri) as HttpWebRequest;request.Method = ""GET"";// Supports POST tooif (request.Method == ""GET""){ request.BeginGetResponse(this.ResponseCallback, state);}else{ request.BeginGetRequestStream(this.RequestCallback, state);}",How do I use HttpWebRequest with GET method
"C# Interface Implementaton relationship is just ""Can-Do"" Relationship?"," Today somebody told me that interface implementation in C# is just ""Can-Do"" relationship, not ""Is-A"" relationship. This conflicts with my long-time believing in LSP(Liskov Substitution Principle). I always think that all inheritance should means ""Is-A"" relationship. So, If interface implementation is just a ""Can-Do"" relationship. What if there is a interface ""IHuman"" and ""IEngineer"", and one class ""Programmer"" inherits from ""IHuman"" & ""IEngineer""? Surely, a ""Programmer"" Is A ""IHuman"" and A ""IEngineer"". If it is just ""Can-Do"" relationship, does it mean we cannot expect the ""Programmer"" instance behavior may be different between when treated as a IHuman and treated as IEngineer? <code> ","C# Interface Implementation relationship is just ""Can-Do"" Relationship?"
"C#, return statement in a lock procedure, inside or outside?", I just realized that in some place in my code I have the return statement inside the lock and sometime outside. Which one is the best?1) 2) Which one should I use? <code>  void example(){ lock (mutex) { //... } return myData;} void example(){ lock (mutex) { //... return myData; }},Should a return statement be inside or outside a lock?
C# ASP.NET How to determine which Child Page is being displayed from Master Page?," I'm writing code on the master page, and I need to know which child (content) page is being displayed. How can I do this programmatically?  <code> ",How to determine which Child Page is being displayed from Master Page?
Can I initialize a C# attribute with an array or other variable number of arguemts," Is it possible to create an attribute that can be initialized with a variable number of arguments?For example: <code>  [MyCustomAttribute(new int[3,4,5])] // this doesn't workpublic MyClass ...",Can I initialize a C# attribute with an array or other variable number of arguments?
Can I initialize a C# attribute with an array or other variable number of arguments," Is it possible to create an attribute that can be initialized with a variable number of arguments?For example: <code>  [MyCustomAttribute(new int[3,4,5])] // this doesn't workpublic MyClass ...",Can I initialize a C# attribute with an array or other variable number of arguments?
csharp read only fields, What are the benefits of having a member variable declared as read only? Is it just protecting against someone changing its value during the lifecycle of the class or does using this keyword result in any speed or efficiency improvements? <code> ,What are the benefits to marking a field as `readonly` in C#?
Why mark fields as `readonly` in C#?, What are the benefits of having a member variable declared as read only? Is it just protecting against someone changing its value during the lifecycle of the class or does using this keyword result in any speed or efficiency improvements? <code> ,What are the benefits to marking a field as `readonly` in C#?
Run once a day," Is there any clever method out there to make my executeEveryDayMethod() execute once a day, without having to involve the Windows TaskScheduler? <code> ",Run once a day in C#
How do I get a human-readable file size using .NET?," How do I get a human-readable file size in bytes abbreviation using .NET?Example:Take input 7,326,629 and display 6.98 MB <code> ",How do I get a human-readable file size in bytes abbreviation using .NET?
How do I get a human-readable file size abbreviation using .NET?," How do I get a human-readable file size in bytes abbreviation using .NET?Example:Take input 7,326,629 and display 6.98 MB <code> ",How do I get a human-readable file size in bytes abbreviation using .NET?
LINQ Distinct operator ignore case?," Given the following simple example: It appears the CaseInsensitiveComparer is not actually being used to do a case-insensitive comparison. In other words distinctList contains the same number of items as list. Instead I would expect, for example, ""Three"" and ""three"" be considered equal.Am I missing something or is this an issue with the Distinct operator? <code>  List<string> list = new List<string>() { ""One"", ""Two"", ""Three"", ""three"", ""Four"", ""Five"" }; CaseInsensitiveComparer ignoreCaseComparer = new CaseInsensitiveComparer(); var distinctList = list.Distinct(ignoreCaseComparer as IEqualityComparer<string>).ToList();","LINQ Distinct operator, ignore case?"
Retreiving AlternateView's of email," I can't seem to retrieve the AlternateView from System.Net.Mail.AlternateView.I have an application that is pulling email via POP3. I understand how to create an alternate view for sending, but how does one select the alternate view when looking at the email. I've have the received email as a System.Net.MailMessage object so I can easily pull out the body, encoding, subject line, etc. I can see the AlternateViews, that is, I can see that the count is 2 but want to extract something other than the HTML that is currently returned when I request the body.Hope this makes some amount of sense and that someone can shed some light on this. In the end, I'm looking to pull the plaintext out, instead of the HTML and would rather not parse it myself. <code> ",Retrieving AlternateView's of email
How to correctly deregister an event handler," In a code review, I stumbled over this (simplified) code fragment to unregister an event handler: I thought that this does not unregister the event handler because it creates a new delegate which had never been registered before. But searching MSDN I found several code samples which use this idiom.So I started an experiment: To my surprise, the following happened:Fire(""Hello 1""); produced two messages, as expected.Fire(""Hello 2""); produced one message!This convinced me that unregistering new delegates works!Fire(""Hello 3""); threw a NullReferenceException. Debugging the code showed that Fire is null after unregistering the event.I know that for event handlers and delegate, the compiler generates a lot of code behind the scene. But I still don't understand why my reasoning is wrong.What am I missing?Additional question: from the fact that Fire is null when there are no events registered, I conclude that everywhere an event is fired, a check against null is required. <code>  Fire -= new MyDelegate(OnFire); internal class Program{ public delegate void MyDelegate(string msg); public static event MyDelegate Fire; private static void Main(string[] args) { Fire += new MyDelegate(OnFire); Fire += new MyDelegate(OnFire); Fire(""Hello 1""); Fire -= new MyDelegate(OnFire); Fire(""Hello 2""); Fire -= new MyDelegate(OnFire); Fire(""Hello 3""); } private static void OnFire(string msg) { Console.WriteLine(""OnFire: {0}"", msg); }}",How to correctly unregister an event handler
SharpSvn question," I was hoping to automate some tasks related to SubVersion, so I got SharpSvn. Unfortunately I cant find much documentation for it. I want to be able to view the changes after a user commits a new revision so I can parse the code for special comments that can then be uploaded into my ticket system. <code> ",How can I view the changes made after a revision is committed and parse it for comments?
Why Dictionary is preferred over hashtable in C#?," In most programming languages, dictionaries are preferred over hashtables.What are the reasons behind that? <code> ",Why is Dictionary preferred over Hashtable in C#?
Why is Dictionary preferred over hashtable?," In most programming languages, dictionaries are preferred over hashtables.What are the reasons behind that? <code> ",Why is Dictionary preferred over Hashtable in C#?
Why is Dictionary preferred over Hashtable?," In most programming languages, dictionaries are preferred over hashtables.What are the reasons behind that? <code> ",Why is Dictionary preferred over Hashtable in C#?
workarounds for nameof() operator in C#: typesafe databinding," There has been a lot of sentiment to include a nameof operator in C#. As an example of how this operator would work, nameof(Customer.Name) would return the string ""Name"".I have a domain object. And I have to bind it. And I need names of properties as strings then. And I want them to be type-safe.I remember coming across a workaround in .NET 3.5 which provided the functionality of nameof and involved lambda expressions. However, I have not been able to locate this workaround. Can anyone provide that workaround to me?I am also interested in a way to implement the functionality of nameof in .NET 2.0 if that is possible. <code> ",Workaround for lack of 'nameof' operator in C# for type-safe databinding?
How can I return NULL from a generic mehod in C#," I have a generic method with this (dummy) code (yes I'm aware IList has predicates, but my code is not using IList but some other collection, anyway this is irrelevant for the question...) This gives me a build error ""Cannot convert null to type parameter 'T' because it could be a value type. Consider using 'default(T)' instead.""Can I avoid this error? <code>  static T FindThing<T>(IList collection, int id) where T : IThing, new(){ foreach T thing in collecion { if (thing.Id == id) return thing; } return null; // ERROR: Cannot convert null to type parameter 'T' because it could be a value type. Consider using 'default(T)' instead.}",How can I return NULL from a generic method in C#?
How can I return NULL from a generic method in C#," I have a generic method with this (dummy) code (yes I'm aware IList has predicates, but my code is not using IList but some other collection, anyway this is irrelevant for the question...) This gives me a build error ""Cannot convert null to type parameter 'T' because it could be a value type. Consider using 'default(T)' instead.""Can I avoid this error? <code>  static T FindThing<T>(IList collection, int id) where T : IThing, new(){ foreach T thing in collecion { if (thing.Id == id) return thing; } return null; // ERROR: Cannot convert null to type parameter 'T' because it could be a value type. Consider using 'default(T)' instead.}",How can I return NULL from a generic method in C#?
Generate distinctly different colors in graphs," When generating graphs and showing different sets of data it usually a good idea to difference the sets by color. So one line is red and the next is green and so on. The problem is then that when the number of datasets is unknown one needs to randomly generate these colors and often they end up very close to each other (green, light green for example). Any ideas on how this could be solved and how it would be possibler to generate distinctly different colors? I'd be great if any examples (feel free to just discuss the problem and solution without examples if you find that easier) were in C# and RGB based colors. <code> ",Generate distinctly different RGB colors in graphs
How to check if I can create a file in a specific folder in c#?," I need to know if I can create a file in a specific folder, but there are too many things to check such as permissions, duplicate files, etc. I'm looking for something like File.CanCreate(@""C:\myfolder\myfile.aaa""), but haven't found such a method.The only thing I thought is to try to create a dummy file and check for exceptions but this is an ungly solution that also affects performance.Do you know a better solution? <code> ",How to check if I can create a file in a specific folder
How do I find out which process is locking a file (C#)?," I've seen several of answers about using Handle or Process Monitor, but I would like to be able to find out in my own code (C#)which process is locking a file.I have a nasty feeling that I'm going to have to spelunk around in the win32 API, but if anyone has already done this and can put me on the right track, I'd really appreciate the help.UpdateLinks to similar questionsHow does one figure out what process locked a file using c#?Command line toolAcross a NetworkLocking a USB deviceUnit test fails with locked filedeleting locked file <code> ",How do I find out which process is locking a file using .NET?
C# Syntax Highlighter for Blogging on BlogSpot," I'm looking for a syntax highlighter cum code formatter for my blog on BlogSpot. I've tried several today, but the all want to include <style> tags, or reference a stylesheet. I'm looking for one that is ideal for segments of code, and includes styling inline. Any suggestions? <code> ",C# syntax highlighter for blogging on BlogSpot
"asp.net mvc redirecttoaction(""Index"") vs Index()"," Say I have a controller with an Index Method and a Update Method. After the Update is done I want to redirect to Index(). Should I use return RedirectToAction(""Index"") or can I just call return Index()? Is there a difference? <code>  public ActionResult Index(){ return View(""Index"", viewdata);}public ActionResult Update(){ // do updates return RedirectToAction(""Index""); or return Index();}","asp.net mvc RedirectToAction(""Index"") vs Index()"
System.Collections namespace . ., After moving to .NET 2.0+ is there ever a reason to still use the systems.Collections namespace (besides maintaining legacy code)? Should the generics namespace always be used instead? <code> ,Generics and System.Collections
"How to fix ""Referenced assembly does not have a strong name"" error (VS2005)"," I've added a weakly named assembly to my VisualStudio2005 project (which is strongly named). I'm now getting the error:""Referenced assembly 'xxxxxxxx' does not have a strong name""Do I need to sign this third-party assembly? <code> ","How to fix ""Referenced assembly does not have a strong name"" error"
"How to fix ""Referenced assembly does not have a strong name"" error (Visual Studio 2005)"," I've added a weakly named assembly to my VisualStudio2005 project (which is strongly named). I'm now getting the error:""Referenced assembly 'xxxxxxxx' does not have a strong name""Do I need to sign this third-party assembly? <code> ","How to fix ""Referenced assembly does not have a strong name"" error"
"How to fix ""Referenced assembly does not have a strong name"" error?"," I've added a weakly named assembly to my VisualStudio2005 project (which is strongly named). I'm now getting the error:""Referenced assembly 'xxxxxxxx' does not have a strong name""Do I need to sign this third-party assembly? <code> ","How to fix ""Referenced assembly does not have a strong name"" error"
why didnt header files catch on in other programming languages?, Based on the response to this question: Why does C++ have header files and CPPI have seen the responses and understand the answers - so why didn't this catch on? C# Java? <code> ,Why didn't header files catch on in other programming languages?
Help With Overriding and Inheritance...," Ok, bear with me guys and girls as I'm learning. Here's my question.I can't figure out why I can't override a method from a parent class. Here's the code from the base class (yes, I pilfered the java code from an OOP book and am trying to rewrite it in C#). and here are my other 2 objects that inherit the base class (MoodyObject): And: and here is my main: As you can see, pretty basic stuff, but here's the output: How does the moody object feel today? I feel moody today! How does the sad object feel today? I feel moody today! wah...boohoo How does the happy object feel today? I feel moody today! hehehehehehe. Press any key to continue . . .Not as I expected. I've tried to make the base method virtual and calling override when trying to override it and that just gets me this error ""cannot override inherited member 'MoodyObject.getMood()' because it is not marked virtual, abstract, or override"". I also tried it without the virtual and override and it thinks I'm trying to hide the base method. Again, I'm new to OOP and would appreciate any guidance.EDITED TO ADD: I found it! The MoodyObject.cs was only a ""solution item"" in the solution explorer as opposed to a ""ConsoleApplication1"" item. I dragged it down to where it belonged in the solution explorer and voila! It works now. I marked Luc's answer below as the answer because he offered the help I needed to get to where I have it resolved... I'm learning so much here. It's amazing and you guys and girls are crazy smart! <code>  using System;public class MoodyObject{ protected String getMood() { return ""moody""; } public void queryMood() { Console.WriteLine(""I feel "" + getMood() + "" today!""); }} using System;using System.Collections.Generic;using System.Linq;using System.Text;namespace ConsoleApplication1{ public class SadObject: MoodyObject { protected String getMood() { return ""sad""; } //specialization public void cry() { Console.WriteLine(""wah...boohoo""); } }} using System;using System.Collections.Generic;using System.Linq;using System.Text;namespace ConsoleApplication1{ public class HappyObject: MoodyObject { protected String getMood() { return ""happy""; } public void laugh() { Console.WriteLine(""hehehehehehe.""); } }} using System;using System.Collections.Generic;using System.Linq;using System.Text;namespace ConsoleApplication1{ class Program { static void Main(string[] args) { MoodyObject moodyObject = new MoodyObject(); SadObject sadObject = new SadObject(); HappyObject happyObject = new HappyObject(); Console.WriteLine(""How does the moody object feel today?""); moodyObject.queryMood(); Console.WriteLine(""""); Console.WriteLine(""How does the sad object feel today?""); sadObject.queryMood(); sadObject.cry(); Console.WriteLine(""""); Console.WriteLine(""How does the happy object feel today?""); happyObject.queryMood(); happyObject.laugh(); } }}",Overriding and Inheritance in C#
What is the difference between using IDispose vs a destructor in C#?," When would I implement IDispose on a class as opposed to a destructor? I read this article, but I'm still missing the point. My assumption is that if I implement IDispose on an object, I can explicitly 'destruct' it as opposed to waiting for the garbage collector to do it. Is this correct?Does that mean I should always explicitly call Dispose on an object? What are some common examples of this? <code> ",What is the difference between using IDisposable vs a destructor in C#?
Comment Inheritance for C# (actually any language)," Suppose I have this interface And this class Is there a way, or is there a tool that can let me automatically put in the comments of each member in a base class or interface?Because I hate re-writing the same comments for each derived sub-class! <code>  public interface IFoo{ ///<summary> /// Foo method ///</summary> void Foo(); ///<summary> /// Bar method ///</summary> void Bar(); ///<summary> /// Situation normal ///</summary> void Snafu();} public class Foo : IFoo{ public void Foo() { ... } public void Bar() { ... } public void Snafu() { ... }}",Inheriting comments from an interface in an implementing class?
Possible to override null-coalescing operator?," Is it possible to overload the null-coalescing operator for a class in C#? Say for example I want to return a default value if an instance is null and return the instance if it's not. The code would look like something like this: But what if I would like to use the null-coalescing operator to also check if the MyClass.MyValue is set? <code>  return instance ?? new MyClass(""Default""); ",Possible to overload null-coalescing operator?
.NET built-in helper to parse Domain\Username in User.Identity.Name," Is there any built-in utility or helper to parse HttpContext.Current.User.Identity.Name, e.g. domain\user to get separately domain name if exists and user?Or is there any other class to do so?I understand that it's very easy to call String.Split(""\"") but just interesting <code> ",Built-in helper to parse User.Identity.Name into Domain\Username
How do I create an immutable Class ?, I am working on creating an immutable class.I have marked all the properties as read-only. I have a list of items in the class.Although if the property is read-only the list can be modified. Exposing the IEnumerable of the list makes it immutable.I wanted to know what is the basic rules one has to follow to make a class immutable ?  <code> ,How do I create an immutable Class?
.NET Winforms: Can the runtime dispose a windows' handle out from under me?," The current declaration of SendMessage over at PInvoke.net is: Note: The hWnd is no longer an IntPtr, and has been replaced with HandleRef. A very loose explanation for the change is given: You can replace ""hWnd"" with ""IntPtr"" instead of ""HandleRef"". However, you are taking a risk in doing this - it may cause your code to crash with race conditions. The .NET runtime can, and will, dispose your window handles out from under your message - causing all sorts of nasty problems!Someone wiki'd a followup question: Question: Can't this last issue be addressed with marshaling, specifically pinning?And someone answered: Answer: You can use GC.KeepAlive() right after the SendMessage() with the Form object as the parameter to KeepAlive().All this ""disposing your form underneath you"" seems odd to me. SendMessage is a synchronous call. It will not return until until the sent message has been processed. The implication then is that a form handle can be destroyed at any time. For example: This means that the window handle can become invalid between the time i use it and the time the method ends?Update Onei understand the notion that once a form goes out of scope, it's handle is invalid. e.g.: It's obvious to me that the form's handle is not valid once DoStuff has returned. The same would be true no matter what the technique - if the form is not held in some scope, it is not valid to use.i would disagree with (todo link guy) in that a form will stick around until all send messages have been received. The CLR does not know who may have been given my form's window handle, and has no way of knowing who may call SendMessage() in the future.In other words, i cannot imagine that calling: will now prevent this from being garbage collected.Update Twoi cannot imagine having a window handle around will keep a form from being garbage collected. i.e.: AnswerBut these are illevant points - the original question still is: Can the runtime dispose a form's handle out from under me?The answer, it turns out, is no. The runtime will not dispose of a form out from under me. It will dispose of an unreferenced form - but unreferenced forms are not under me. ""Under Me"" means i have a reference to the form.On the other hand, a Form object's underlying Windows window handle can be destroy out from under me (and really how could it not - window handles are not reference counted - nor should they be): It's also important to note that HandleRef will not help prevent the problems caused by creating object wrappers around Windows window handles:Reason 1 If a form object is being destroyed because you didn't have a reference to it - then you're just stupid for trying to talk to a form that by rights should no longer exist. Just because the GC hasn't gotten around to it yet doesn't make you smart - it makes you lucky. A HandleRef is a hack to keep a reference to the form. Rather than using: you could easily use: Reason 2HandleRef will not prevent a form from re-creating it's underlying window handle, e.g.: So while the original modifier of SendMessage on P/Invoke did point out a problem, his solution isn't a solution. <code>  [DllImport(""user32.dll"", CharSet = CharSet.Auto, SetLastError = false)]static extern IntPtr SendMessage(HandleRef hWnd, uint Msg, IntPtr wParam, IntPtr lParam); private void DoStuff(){ //get the handle IntPtr myHwnd = this.Handle; //Is the handle still valid to use? DoSomethingWithTheHandle(myHwnd); //handle might not be valid??? //fall off the function} private IntPtr theHandle = IntPtr.Zero;private void DoStuff(){ MyForm frm = new MyForm()) theHandle = frm.Handle; //Note i didn't dispose of the form. //But since it will be unreferenced once this method ends //it will get garbage collected, //making the handle invalid} IntPtr hWnd = this.Handle; Clipboard.AsText = this.Handle.ToString();IntPtr theHandle = (IntPtr)(int)Clipboard.AsText; IntPtr hwnd = this.Handle;this.RightToLeft = RightToLeft.Yes;//hwnd is now invalid HandleRef hr = new HandleRef(this, this.Handle);DoSomethingWithHandle(this.Handle); Object o = this;DoSomethingWithHandle(this.Handle); HandleRef hr = new HandleRef(this, this.Handle);this.RightToLeft = RightToLeft.Yes;//hr.Hande is now invalid",.NET Winforms: Can the runtime dispose a form's handle out from under me?
What is a good ASP.Net database application (C# or VB.NET)," I would like to learn the best practices to employ when creating a database driven web-application.I prefer to learn from examples. What is a good sample application that I can download and run to learn this:I am looking for:Should be written in C# (preferably)Should contain a complex database design (parent child relations, etc.)Should implement the best practices for an ASP.net website as well as for database design.Preferably uses Oracle. <code> ",Where can I find a Good Sample ASP.NET Database Driven Web Application? 
How to change RGB color to HSV?, How can I convert a RGB Color to HSV using C#?I've searched for a fast method without using any external library. <code> ,How to Convert RGB Color to HSV?
How do I programmatically check an item in a checkedlistbox in c#," I have a CheckedListBox, and I want to automatically tick one of the items in it.The CheckedItems collection doesn't allow you to add things to it.Any suggestions? <code> ",How to programmatically check an item in a CheckedListBox in C#?
How do I programmatically check an item in a checkedlistbox in C#?," I have a CheckedListBox, and I want to automatically tick one of the items in it.The CheckedItems collection doesn't allow you to add things to it.Any suggestions? <code> ",How to programmatically check an item in a CheckedListBox in C#?
Contains workaround using Linq to Entities?," I'm trying to create a query which uses a list of ids in the where clause, using the Silverlight ADO.Net Data Services client api (and therefore Linq To Entities). Does anyone know of a workaround to Contains not being supported?I want to do something like this: Tried this: But got ""The method 'Any' is not supported"". <code>  List<long?> txnIds = new List<long?>();// Fill list var q = from t in svc.OpenTransaction where txnIds.Contains(t.OpenTransactionId) select t; var q = from t in svc.OpenTransactionwhere txnIds.Any<long>(tt => tt == t.OpenTransactionId)select t;",'Contains()' workaround using Linq to Entities?
How to circumvent using an out parameter in an anonymous method block," The following method does not compile. Visual Studio warns ""An out parameter may not be used within an anonymous method"". The WithReaderLock(Proc action) method takes a delegate void Proc(). What's the best way to get this behavior? (Please refrain from providing advice on threadsafe dictionaries, this question is intended to solve the out parameter problem in general). <code>  public Boolean TryGetValue(TKey key, out TValue value){ Boolean got = false; WithReaderLock(delegate { got = dictionary.TryGetValue(key, out value); }); return got;}",How to circumvent using an out parameter in an anonymous method block?
why C# is functional programmming language?," It has been said that C# can be regarded as a functional programming language, even though it is widely recognized as a OO programming language.So, what feature set makes C# a functional programming language?I can only think of:delegates (even without anonymous methods and lambda expressions)closuresAnything else? <code> ",Why is C# a functional programmming language?
How to get parent process in .NET in managed wau," I was looking a lot for method to get parent process in .NET, but found only P/Invoke way. <code> ",How to get parent process in .NET in managed way
Get last 10 lines of very large text file > 10GB c#, What is the most efficient way to display the last 10 lines of a very large text file (this particular file is over 10GB). I was thinking of just writing a simple C# app but I'm not sure how to do this effectively. <code> ,Get last 10 lines of very large text file > 10GB
Update all objects in a collection using Linq," Is there a way to do the following using LINQ? To clarify, I want to iterate through each object in a collection and then update a property on each object.My use case is I have a bunch of comments on a blog post, and I want to iterate through each comment on a blog post and set the datetime on the blog post to be +10 hours. I could do it in SQL, but I want to keep it in the business layer. <code>  foreach (var c in collection){ c.PropertyToSet = value;}",Update all objects in a collection using LINQ
C# - List<T> or IList<T>, Can anyone explain to me why I would want to use IList over List in C#?Related question: Why is it considered bad to expose List<T> <code> ,List<T> or IList<T>
Returning from inside a using in .Net," I've got some code that looks like this: If I return from inside a ""using"", will the using still clean up? <code>  using (DBDataContext dc = new DBDataContext(ConnectionString)){ Main main = new Main { ClientTime = clientTime }; dc.Mains.InsertOnSubmit(main); dc.SubmitChanges(); return main.ID;}",Returning from inside the scope of a 'using' statement?
Best practices for exception management in JAVA or C#," I'm stuck deciding how to handle exceptions in my application. Much if my issues with exceptions comes from 1) accessing data via a remote service or 2) deserializing a JSON object. Unfortunately I can't guarantee success for either of these tasks (cut network connection, malformed JSON object that is out of my control). As a result, if I do encounter an exception I simply catch it within the function and return FALSE to the caller. My logic is that all the caller really cares about is if the task was successful, not why it is wasn't successful.Here's some sample code (in JAVA) of a typical method) I think this approach is fine, but I'm really curious to know what the best practices are for managing exceptions (should I really bubble an exception all the way up a call stack?). In summary of key questions:Is it okay to just catch exceptions but not bubble them up or formally notifying the system (either via a log or a notification to the user)?What best practices are there for exceptions that don't result in everything requiring a try/catch block?Follow Up/EditThanks for all the feedback, found some excellent sources on exception management online:Best Practices for Exception Handling | O'Reilly MediaException Handling Best Practices in .NETBest Practices: Exception Management (Article now points to archive.org copy)Exception-Handling AntipatternsIt seems that exception management is one of those things that vary based on context. But most importantly, one should be consistent in how they manage exceptions within a system. Additionally watch out for code-rot via excessive try/catches or not giving a exception its respect (an exception is warning the system, what else needs to be warned?).Also, this is a pretty choice comment from m3rLinEz. I tend to agree with Anders Hejlsberg and you that the most callers only care if operation is successful or not.From this comment it brings up some questions to think about when dealing with exceptions:What is the point this exception being thrown?How does it make sense to handle it? Does the caller really care about the exception or do they just care if the call was successful?Is forcing a caller to manage a potential exception graceful?Are you being respectful to the idoms of the language? Do you really need to return a success flag like boolean? Returning boolean (or an int) is more of a C mindset than a Java (in Java you would just handle the exception) one. Follow the error management constructs associated with the language :) ! <code>  public boolean doSomething(Object p_somthingToDoOn){ boolean result = false; try{ // if dirty object then clean doactualStuffOnObject(p_jsonObject); //assume success (no exception thrown) result = true; } catch(Exception Ex) { //don't care about exceptions Ex.printStackTrace(); } return result;}",Best practices for exception management in Java or C#
Send Key Strokes to Games., I can send any windows application key strokes with PostMessage api. But I can't send key strokes to Game window by using PostMessage.Anyone know anything about using Direct Input functions for sending keys to games from C#. <code> ,Send Key Strokes to Games using Direct Input
Send Key Strokes to Games, I can send any windows application key strokes with PostMessage api. But I can't send key strokes to Game window by using PostMessage.Anyone know anything about using Direct Input functions for sending keys to games from C#. <code> ,Send Key Strokes to Games using Direct Input
can you lock on a generic dictionary?, Or should you always create some other lock object? <code> ,Can you lock on a generic dictionary?
C# - Do method names get compiled into the EXE?," Do class, method and variable names get included in the MSIL after compiling a Windows App project into an EXE?For obfuscation - less names, harder to reverse engineer.And for performance - shorter names, faster access.e.g. So if methods ARE called via name:Keep names short, better performance for named-lookup.Keep names cryptic, harder to decompile. <code> ",Do method names get compiled into the EXE?
C# - Array that can be resized fast," I'm looking for a kind of array data-type that can easily have items added, without a performance hit.System.Array - Redim Preserve copies entire RAM from old to new, as slow as amount of existing elementsSystem.Collections.ArrayList - good enough?System.Collections.IList - good enough? <code> ",Array that can be resized fast
C# Why are timer frequencies off?," Both System.Timers.Timer and System.Threading.Timer fire at intervals that are considerable different from the requested ones.For example: yields a timer that fires 16 times per second, not 20.To be sure that there are no side-effects from too long event handlers, I wrote this little test program: The output looks like this:Requested: 5 Hz; actual: 4,8 HzRequested: 10 Hz; actual: 9,1 HzRequested: 15 Hz; actual: 12,7 HzRequested: 20 Hz; actual: 16 HzRequested: 30 Hz; actual: 21,3 HzRequested: 50 Hz; actual: 31,8 HzRequested: 75 Hz; actual: 63,9 HzRequested: 100 Hz; actual: 63,8 HzRequested: 200 Hz; actual: 63,9 HzRequested: 500 Hz; actual: 63,9 HzThe actual frequency deviates by up to 36% from the requested one. (And evidently cannot exceed 64 Hz.) Given that Microsoft recommends this timer for its ""greater accuracy"" over System.Windows.Forms.Timer, this puzzles me.Btw, these are not random deviations. They are the same values every time.And a similar test program for the other timer class, System.Threading.Timer, shows the exact same results.In my actual program, I need to collect measurements at precisely 50 samples per second. This should not yet require a real-time system. And it is very frustrating to get 32 samples per second instead of 50.Any ideas?@Chris:You are right, the intervals all seem to be integer multiples of something around 1/64th second. Btw, adding a Thread.Sleep(...) in the event handler doesn't make any difference. This makes sense given that System.Threading.Timer uses the thread pool, so each event is fired on a free thread. <code>  new System.Timers.Timer(1000d / 20); int[] frequencies = { 5, 10, 15, 20, 30, 50, 75, 100, 200, 500 };// Test System.Timers.Timerforeach (int frequency in frequencies){ int count = 0; // Initialize timer System.Timers.Timer timer = new System.Timers.Timer(1000d / frequency); timer.Elapsed += delegate { Interlocked.Increment(ref count); }; // Count for 10 seconds DateTime start = DateTime.Now; timer.Enabled = true; while (DateTime.Now < start + TimeSpan.FromSeconds(10)) Thread.Sleep(10); timer.Enabled = false; // Calculate actual frequency Console.WriteLine( ""Requested frequency: {0}\nActual frequency: {1}\n"", frequency, count / 10d);}",C# Why are timer frequencies extremely off?
How do can I get the current DateTime from the Precompiler in C#," In C# 3.0, I have a property which is suppose to contain the version of the class. The version number is simply the date and time of compilation. Right now, I have the following code: Obviously, this is wrong since this property returns me the current date and time. So, is the precompiler can print the DateTime at compile time? In this case, I could do something similar to below. <code>  public DateTime Version{ get { return DateTime.UtcNow; }} public DateTime Version{ get { return new DateTime(""PRECOMPILER DATE""); }}",How can I get the current DateTime from the Precompiler in C#?
Does the Garbage Collector destroy temporarily unreferenced objects during async calls in .NET," Imagine that I will make an async call in .NET, i.e. HttpWebRequest.BeginGetResponse, and the HttpWebRequest object isn't referenced at a broader scope. Will the Garbage Collector destroy it and cause problems?Example code: Alternate version (with the request being passed as an AsyncState): <code>  using System;using System.Net;public class AsyncHttpWebRequest{ void Main() { var Request = HttpWebRequest.Create(""http://www.contoso.com""); var result = Request.BeginGetResponse(GetResponseCallback, null); } private void GetResponseCallback(IAsyncResult AsyncResult) { // Do Something.. }} using System;using System.Net;public class AsyncHttpWebRequest{ void Main() { var Request = HttpWebRequest.Create(""http://www.contoso.com""); var result = Request.BeginGetResponse(GetResponseCallback, Request); } private void GetResponseCallback(IAsyncResult AsyncResult) { // Do Something.. }}",Does the Garbage Collector destroy temporarily unreferenced objects during async calls in .NET?
Attaching to child process automatically in Visual Studio," When writing plugins for media center your plugin is hosted in ehexthost.exe this exe gets launched from ehshell.exe and you have no way of launching it directly, instead you pass a special param to ehshell.exe which will launch the plugin in a separate process.When we are debugging media browser I find the process of attaching to a second process kind of clunky, I know about Debugger.Attach and also of some special registry entries I can use.Both these methods don't exactly fit my bill. What I want is to press F5 and have my current instance of visual studio attach to the child process automatically. Can this be done? If there is a plugin for VS that allows me to achieve this functionality I would be happy with it. EDITI ended up going with the following macro: Also, I outlined the process on how to get this going on my blog.  <code>  Public Sub CompileRunAndAttachToEhExtHost() DTE.Solution.SolutionBuild.Build(True) DTE.Solution.SolutionBuild.Debug() Dim trd As System.Threading.Thread = New System.Threading.Thread(AddressOf AttachToEhExtHost) trd.Start()End SubPublic Sub AttachToEhExtHost() Dim i As Integer = 0 Do Until i = 50 i = i + 1 Try For Each proc As EnvDTE.Process In DTE.Debugger.LocalProcesses If (proc.Name.IndexOf(""ehexthost.exe"") <> -1) Then proc.Attach() Exit Sub End If Next Catch e As Exception ' dont care - stuff may be busy End Try Threading.Thread.Sleep(100) LoopEnd Sub",Attaching to a child process automatically in Visual Studio during Debugging
C# String enums.," I have the following enumeration: The problem however is that I need the word ""FORMS"" when I ask for AuthenticationMethod.FORMS and not the id 1.I have found the following solution for this problem (link):First I need to create a custom attribute called ""StringValue"": Then I can add this attribute to my enumerator: And of course I need something to retrieve that StringValue: Good now I've got the tools to get a string value for an enumerator.I can then use it like this: Okay now all of these work like a charm but I find it a whole lot of work. I was wondering if there is a better solution for this.I also tried something with a dictionary and static properties but that wasn't better either. <code>  public enum AuthenticationMethod{ FORMS = 1, WINDOWSAUTHENTICATION = 2, SINGLESIGNON = 3} public class StringValue : System.Attribute{ private readonly string _value; public StringValue(string value) { _value = value; } public string Value { get { return _value; } }} public enum AuthenticationMethod{ [StringValue(""FORMS"")] FORMS = 1, [StringValue(""WINDOWS"")] WINDOWSAUTHENTICATION = 2, [StringValue(""SSO"")] SINGLESIGNON = 3} public static class StringEnum{ public static string GetStringValue(Enum value) { string output = null; Type type = value.GetType(); //Check first in our cached results... //Look for our 'StringValueAttribute' //in the field's custom attributes FieldInfo fi = type.GetField(value.ToString()); StringValue[] attrs = fi.GetCustomAttributes(typeof(StringValue), false) as StringValue[]; if (attrs.Length > 0) { output = attrs[0].Value; } return output; }} string valueOfAuthenticationMethod = StringEnum.GetStringValue(AuthenticationMethod.FORMS);",String representation of an Enum
C# String enums," I have the following enumeration: The problem however is that I need the word ""FORMS"" when I ask for AuthenticationMethod.FORMS and not the id 1.I have found the following solution for this problem (link):First I need to create a custom attribute called ""StringValue"": Then I can add this attribute to my enumerator: And of course I need something to retrieve that StringValue: Good now I've got the tools to get a string value for an enumerator.I can then use it like this: Okay now all of these work like a charm but I find it a whole lot of work. I was wondering if there is a better solution for this.I also tried something with a dictionary and static properties but that wasn't better either. <code>  public enum AuthenticationMethod{ FORMS = 1, WINDOWSAUTHENTICATION = 2, SINGLESIGNON = 3} public class StringValue : System.Attribute{ private readonly string _value; public StringValue(string value) { _value = value; } public string Value { get { return _value; } }} public enum AuthenticationMethod{ [StringValue(""FORMS"")] FORMS = 1, [StringValue(""WINDOWS"")] WINDOWSAUTHENTICATION = 2, [StringValue(""SSO"")] SINGLESIGNON = 3} public static class StringEnum{ public static string GetStringValue(Enum value) { string output = null; Type type = value.GetType(); //Check first in our cached results... //Look for our 'StringValueAttribute' //in the field's custom attributes FieldInfo fi = type.GetField(value.ToString()); StringValue[] attrs = fi.GetCustomAttributes(typeof(StringValue), false) as StringValue[]; if (attrs.Length > 0) { output = attrs[0].Value; } return output; }} string valueOfAuthenticationMethod = StringEnum.GetStringValue(AuthenticationMethod.FORMS);",String representation of an Enum
Is it possible to love LINQ too much?," I recently found LINQ and love it. I find lots of occasions where use of it is so much more expressive than the longhand version but a colleague passed a comment about me abusing this technology which now has me second guessing myself. It is my perspective that if a technology works efficiently and the code is elegant then why not use it? Is that wrong? I could spend extra time writing out processes ""longhand"" and while the resulting code may be a few ms faster, it's 2-3 times more code and therefore 2-3 times more chance that there may be bugs.Is my view wrong? Should I be writing my code out longhand rather than using LINQ? Isn't this what LINQ was designed for?Edit: I was speaking about LINQ to objects, I don't use LINQ to XML so much and I have used LINQ to SQL but I'm not so enamoured with those flavours as LINQ to objects. <code> ",Where to draw the line - is it possible to love LINQ too much?
Select either a file or folder from the same dialog in VB.NET," Is there an ""easy"" way to select either a file OR a folder from the same dialog?In many apps I create I allow for both files or folders as input.Until now i always end up creating a switch to toggle between file or folder selection dialogs or stick with drag-and-drop functionality only. Since this seems such a basic thing i would imagine this has been created before, but googling does not result in much information. So it looks like i would need to start from scratch and create a custom selection Dialog, but I rather not introduce any problems by reinventing the wheel for such a trivial task.Anybody any tips or existing solutions?To keep the UI consistent it would be nice if it is possible to extend the OpenFileDialog (or the FolderBrowserDialog). <code> ",Select either a file or folder from the same dialog in .NET
should i html encode values in an input field?," Which should I use? or  <code>  <input type=""hidden"" name=""first_name"" value=""<%= person.first_name %>"" /> <input type=""hidden"" name=""first_name"" value=""<%= Html.Encode( person.first_name ) %>"" />",Should I html encode values in an input field?
Map and Reduce," What scenarios would warrant the use of the ""Map and Reduce"" algorithm? Is there a .NET implementation of this algorithm?  <code> ",Map and Reduce in .NET
FindLast on IEnumarable," I would like to call FindLast on a collection which implements IEnumerable, but FindLast is only available for List. What is the best solution? <code> ",FindLast on IEnumerable
Whose on First? Dictionary<>.First() that is.," What is the meaning of the .NET 3.5 extension method Enumerable.First() when you call it on an instance of the Dictionary collection?Does the set of keys determine which item is first, or is it just not defined? <code> ",Who's on Dictionary<>.First() ?
c#  StatusStrip questions," Consider System.Windows.Forms.StatusStrip. I have added a StatusStrip to my Windows Forms application, but I am having a few problems.I would like to have a label anchored at the left and a progressbar anchored on the right in the StatusStrip, but I can't find a way to set these properties.I then thought that I may need to create two StatusStrips and anchor them on either side of the bottom of the form... That didn't pan out; besides that, it just doesn't feel right. <code> ",Using StatusStrip in C#
Exceptions vs return codes : do we loose something (while gaining something else) ?," My question is pretty vague :o) - But here is an example :When I was writing C code, I was able to log counter's value when something failed : Now, using exceptions, I get this : Of course, one may declare ""i"" outside of the try/catch statement (and this is what I'm doing). But I don't like it - I like declare variable where they are used, not before.But maybe am I missing something here. Do you have any elegant solution ?Thank in advance !Sylvain.ADDED : myCall() is an obscure API call - I have no clue what it can throw. Also, I can of course add a Try/Catch block around each call, but I would then be better to use return codes ? Would I then add a lot of noise around important lines of code ?. <code>  <...> for ( int i = 0 ; i < n ; i++ ) if ( SUCCESS != myCall()) Log( ""Failure, i = %d"", i ); <...> try { <...> for ( int i = 0 ; i < n ; i++ ) myCall(); <...> } catch ( Exception exception ) { Log( ""Failure ! Maybe in myCall() ? Don't know. i's value ? No clue."" ); }",Exceptions vs return codes : do we lose something (while gaining something else) ?
Case insensitive contains(string)," Is there a way to make the following return true? There doesn't seem to be an overload that allows me to set the case sensitivity. Currently I UPPERCASE them both, but that's just silly (by which I am referring to the i18n issues that come with up- and down casing).UPDATEThis question is ancient and since then I have realized I asked for a simple answer for a really vast and difficult topic if you care to investigate it fully.For most cases, in mono-lingual, English code bases this answer will suffice. I'm suspecting because most people coming here fall in this category this is the most popular answer.This answer however brings up the inherent problem that we can't compare text case insensitive until we know both texts are the same culture and we know what that culture is. This is maybe a less popular answer, but I think it is more correct and that's why I marked it as such. <code>  string title = ""ASTRINGTOTEST"";title.Contains(""string"");",Case insensitive 'Contains(string)'
Is it bad practice to return from within a try catch finally block," So I came across some code this morning that looked like this: Now this code compiles fine and works as it should, but it just doesn't feel right to return from within a try block, especially if there's an associated finally.My main issue is what happens if the finally throws an exception of it's own? You've got a returned variable but also an exception to deal with... so I'm interested to know what others think about returning from within a try block? <code>  try{ x = SomeThingDangerous(); return x;}catch (Exception ex){ throw new DangerousException(ex);}finally{ CleanUpDangerousStuff();}",Is it bad practice to return from within a try catch finally block?
Private inner classes in C# - why aren't they used more often ?," I am relatively new to C# and each time I begin to work on a C# project (I only worked on nearly mature projects in C#) I wonder why there are no inner classes?Maybe I don't understand their goal. To me, inner classes -- at least private inner classes -- look a lot like ""inner procedures"" in Pascal / Modula-2 / Ada : they allow to break down a main class in smaller parts in order to ease the understanding.Example : here is what is see most of the time : Since ClassB will be used (at least for a while) only by ClassA, my guess is that this code would be better expressed as follow : I would be glad to hear from you on this subject - Am I right? <code>  public class ClassA{ public MethodA() { <some code> myObjectClassB.DoSomething(); // ClassB is only used by ClassA <some code> }}public class ClassB{ public DoSomething() { }} public class ClassA { public MethodA() { <some code> myObjectClassB.DoSomething(); // Class B is only usable by ClassA <some code> } private class ClassB { public DoSomething() { } } }",Private inner classes in C# - why aren't they used more often?
How to Count Duplicates in List and Sort by amount of Duplicates with LINQ," I have a list of itemsJohn IDMatt IDJohn IDScott IDMatt IDJohn IDLucas IDI want to shove them back into a list like so which also means I want to sort by the highest number of duplicates.John ID 3Matt ID 2Scott ID 1Lucas ID 1Let me know how I can do this with LINQ and C#.Thanks AllEDIT 2 Showing Code: This query displays these results:1 hello world times1 hello world times1 Hello World.1 hello world times1 hello world times1 hello world times1 Hello World.1 hello world timesIt gives me the count and name, but it doesn't give me the ID of the game....It should display:6 hello world times 2342342 Hello World. 23432432 <code>  List<game> inventory = new List<game>(); drinkingforDataContext db = new drinkingforDataContext(); foreach (string item in tbTitle.Text.Split(' ')) { List<game> getItems = (from dfg in db.drinkingfor_Games where dfg.game_Name.Contains(tbTitle.Text) select new game { gameName = dfg.game_Name, gameID = Boomers.Utilities.Guids.Encoder.EncodeURLs(dfg.uid) }).ToList<game>(); for (int i = 0; i < getItems.Count(); i++) { inventory.Add(getItems[i]); } } var items = (from xx in inventory group xx by xx into g let count = g.Count() orderby count descending select new { Count = count, gameName = g.Key.gameName, gameID = g.Key.gameID }); lvRelatedGames.DataSource = items; lvRelatedGames.DataBind();",How to Count Duplicates in List with LINQ
C# collection initializers," I was looking at C# collection initializers and found the implementation to be very pragmatic but also very unlike anything else in C#I am able to create code like this: Since I have satisfied the minimum requirements for the compiler (implemented IEnumerable and a public void Add) this works but obviously has no value.I was wondering what prevented the C# team from creating a more strict set of requirements? In other words why, in order for this syntax to compile, does the compiler not require that the type implement ICollection? That seems more in the spirit of other C# features. <code>  using System;using System.Collections;class Program{ static void Main() { Test test = new Test { 1, 2, 3 }; }}class Test : IEnumerable{ public IEnumerator GetEnumerator() { throw new NotImplementedException(); } public void Add(int i) { }}",Why do C# collection initializers work this way?
How to write safe/correct multi-threaded code in .Net?," Today I had to fix some older VB.NET 1.0 code which is using threads. The problem was with updating UI elements from the worker thread instead of the UI-thread. It took me some time to find out that I can use assertions with InvokeRequired to find the problem.Besides the above mentioned concurrent modification problem, there are deadlocks, race conditions, etc. one could run into. As debugging/fixing threading problems is a pain, I'm wondering how I could reduce coding errors/faults in this area and how I could easier find any of them. So, what I'm asking for, is:Are there any good patterns to follow when writing multi-threading code? What are the Dos and Don'ts?What techniques do you use to debug threading problems?Please provide some example code if applicable and possible. The answers should be related to the .NET framework (any version). <code> ",How to write safe/correct multi-threaded code in .NET?
Can one executable be both a console and GUI app?," I want to make a C# program that can be run as a CLI or GUI application depending on what flags are passed into it. Can this be done?I have found these related questions, but they don't exactly cover my situation:How to write to the console in a GUI applicationHow do I get console output in C++ with a Windows program? <code> ",Can one executable be both a console and GUI application?
C# 3.0:  Need to return duplicates from a List<>," I have a List<> of objects in C# and I need a way to return those objects that are considered duplicates within the list. I do not need the Distinct resultset, I need a list of those items that I will be deleting from my repository.For the sake of this example, lets say I have a list of ""Car"" types and I need to know which of these cars are the same color as another in the list. Here are the cars in the list and their color property: For this example I need the result (IEnumerable<>, List<>, or whatever) to contain Car4 and Car5 because I want to delete these from my repository or db so that I only have one car per color in my repository. Any help would be appreciated. <code>  Car1.Color = Red;Car2.Color = Blue;Car3.Color = Green;Car4.Color = Red;Car5.Color = Red;",C# 3.0: Need to return duplicates from a List<>
"An object reference is required for the nonstatic field, method, or property 'WindowsApplication1.Form1.setTextboxText(int)"," Consider: Why is this error occurring? An object reference is required for the nonstatic field, method, or property 'WindowsApplication1.Form1.setTextboxText(int) <code>  namespace WindowsApplication1{ public partial class Form1 : Form { public Form1() { InitializeComponent(); } private void button1_Click(object sender, EventArgs e) { //int[] val = { 0, 0}; int val; if (textBox1.Text == """") { MessageBox.Show(""Input any no""); } else { val = Convert.ToInt32(textBox1.Text); Thread ot1 = new Thread(new ParameterizedThreadStart(SumData)); ot1.Start(val); } } private static void ReadData(object state) { System.Windows.Forms.Application.Run(); } void setTextboxText(int result) { if (this.InvokeRequired) { this.Invoke(new IntDelegate(SetTextboxTextSafe), new object[] { result }); } else { SetTextboxTextSafe(result); } } void SetTextboxTextSafe(int result) { label1.Text = result.ToString(); } private static void SumData(object state) { int result; //int[] icount = (int[])state; int icount = (int)state; for (int i = icount; i > 0; i--) { result += i; System.Threading.Thread.Sleep(1000); } setTextboxText(result); } delegate void IntDelegate(int result); private void button2_Click(object sender, EventArgs e) { Application.Exit(); } }}","CS0120: An object reference is required for the nonstatic field, method, or property 'foo'"
"An object reference is required for the nonstatic field, method, or property on a Windows form"," Consider: Why is this error occurring? An object reference is required for the nonstatic field, method, or property 'WindowsApplication1.Form1.setTextboxText(int) <code>  namespace WindowsApplication1{ public partial class Form1 : Form { public Form1() { InitializeComponent(); } private void button1_Click(object sender, EventArgs e) { //int[] val = { 0, 0}; int val; if (textBox1.Text == """") { MessageBox.Show(""Input any no""); } else { val = Convert.ToInt32(textBox1.Text); Thread ot1 = new Thread(new ParameterizedThreadStart(SumData)); ot1.Start(val); } } private static void ReadData(object state) { System.Windows.Forms.Application.Run(); } void setTextboxText(int result) { if (this.InvokeRequired) { this.Invoke(new IntDelegate(SetTextboxTextSafe), new object[] { result }); } else { SetTextboxTextSafe(result); } } void SetTextboxTextSafe(int result) { label1.Text = result.ToString(); } private static void SumData(object state) { int result; //int[] icount = (int[])state; int icount = (int)state; for (int i = icount; i > 0; i--) { result += i; System.Threading.Thread.Sleep(1000); } setTextboxText(result); } delegate void IntDelegate(int result); private void button2_Click(object sender, EventArgs e) { Application.Exit(); } }}","CS0120: An object reference is required for the nonstatic field, method, or property 'foo'"
Speeding up Lucene.net," I've used Lucene.net to implement search functionality (for both database content and uploaded documents) on several small websites with no problem. Now I've got a site where I'm indexing 5000+ documents (mainly PDFs) and the querying is becoming a bit slow.I'm assuming the best way to speed it up would be to implement caching of some kind. Can anyone give my any pointers / examples on where to start? If you've got any other suggestions aside from caching (e.g should I be using multiple indexes?) I'd like to hear those too.Edit:Dumb user error responsible for the slow querying. I was creating highlights for the entire results set at once, instead of just the 'page' I was displaying. Oops. <code> ",Caching Lucene.net search results
.net DeflateStream 4Gb Limit, From MSDN: DeflateStream ClassDeflateStream cannot be used to compress files larger than 4 GB.Are there any other implementations for .NET without the 4 GB limit?NOTE: I really need to decompress a file in GZ format with content larger than 4 GB. Can any code do that? <code> ,DeflateStream 4GB Limit in .NET
DeflateStream 4&nbsp;GB Limit in .NET, From MSDN: DeflateStream ClassDeflateStream cannot be used to compress files larger than 4 GB.Are there any other implementations for .NET without the 4 GB limit?NOTE: I really need to decompress a file in GZ format with content larger than 4 GB. Can any code do that? <code> ,DeflateStream 4GB Limit in .NET
C# How to trigger an Control.Resize event?," I'm not subclassing the control. Trying to trigger the event via Control.Size = Control.Size fails, since it does not trigger then even unless the new size is actually different. <code> ",How to trigger an Control.Resize event without actually resizing?
C# How to trigger an Control.Resize event without actually resizing?," I'm not subclassing the control. Trying to trigger the event via Control.Size = Control.Size fails, since it does not trigger then even unless the new size is actually different. <code> ",How to trigger an Control.Resize event without actually resizing?
Create a transparent cursor from an image," Is it possible to create a cursor from an image and have it be semi-transparent? I'm currently taking a custom image and overylaying the mouse cursor image. It would be great if I could make this semi-transparent, but not necessary. The sales guys love shiny.Currently doing something like this: alt text http://members.cox.net/dustinbrooks/drag.jpg <code>  Image cursorImage = customImage.GetThumbnailImage(300, 100, null, IntPtr.Zero);cursorImage.SetResolution(96.0F, 96.0F);int midPointX = cursorImage.Width / 2;int midPointY = cursorImage.Height / 2;Bitmap cursorMouse = GetCursorImage(cursorOverlay);Graphics cursorGfx = Graphics.FromImage(cursorImageCopy);cursorGfx.DrawImageUnscaled(cursorMouse, midPointX, midPointY);Cursor tmp = new Cursor(cursorImage.GetHicon());",Create a semi-transparent cursor from an image
Does Dispose method still get called when Exception is thrown inside of Using statment?," In the example below, is the connection going to close and disposed when an exception is thrown if it is within a using statement? I know this code below will make sure that it does, but I'm curious how using statement does it. Related: What is the proper way to ensure a SQL connection is closed when an exception is thrown? <code>  using (var conn = new SqlConnection(""..."")){ conn.Open(); // stuff happens here and exception is thrown...} var conn;try{ conn = new SqlConnection(""...""); conn.Open(); // stuff happens here and exception is thrown...}// catch it or let it bubble upfinally{ conn.Dispose();}",Does Dispose still get called when exception is thrown inside of a using statement?
How can I determine member types using reflection?," How would I test a property of a type to see if it is a specified type?EDIT: My goal is to examine an assembly to see if any of the types in that assembly contain properties that are MyType (or inherited from MyType).Here is the track I've gone down... This compiles with warning CS0184: The given expression is never of the provided ('MyType') type <code>  AssemblyName n = new AssemblyName();n.CodeBase = ""file://"" + dllName;Assembly a = AppDomain.CurrentDomain.Load(n);foreach (Type t in a.GetTypes()) foreach (PropertyInfo pi in t.GetProperties()) if ( pi.PropertyType is MyType ) // warning CS0184 Console.WriteLine(""Found a property that is MyType"");",How can I determine property types using reflection?
"To fix the run-time error: ""Dynamic SQL generation for the DeleteCommand is not supported against a SelectCommand that does not return any key column information"" How do I generate a primary key? "," My code works. After I copy about 10 tables I get an error. Dynamic SQL generation for the DeleteCommand is not supported against a SelectCommand that does not return any key column information. Okay, I know I need to generate a primary key. But why can I copy 10 or so tables over, and THEN I get the error. Does each row have to return a primary key? If a row doesn't have a primary key, how do I generate one?Here is my code: Google was not very helpful to me on this. Please provide a coding example. <code>  using System;using System.Collections.Generic;using System.Data;using System.Data.OleDb;using System.IO;using System.Linq;using System.Text;namespace LCR_ShepherdStaffupdater_1._0{ public class DatabaseHandling { static DataTable datatableB = new DataTable(); static DataTable datatableA = new DataTable(); public static DataSet datasetA = new DataSet(); public static DataSet datasetB = new DataSet(); static OleDbDataAdapter adapterA = new OleDbDataAdapter(); static OleDbDataAdapter adapterB = new OleDbDataAdapter(); static string connectionstringA = ""Provider=Microsoft.Jet.OLEDB.4.0;"" + ""Data Source="" + Settings.getfilelocationA(); static string connectionstringB = ""Provider=Microsoft.Jet.OLEDB.4.0;"" + ""Data Source="" + Settings.getfilelocationB(); static OleDbConnection dataconnectionB = new OleDbConnection(connectionstringB); static OleDbConnection dataconnectionA = new OleDbConnection(connectionstringA); static DataTable tableListA; static DataTable tableListB; static public void addTableA(string table, bool addtoDataSet) { dataconnectionA.Open(); datatableA = new DataTable(table); try { OleDbCommand commandselectA = new OleDbCommand(""SELECT * FROM ["" + table + ""]"", dataconnectionA); adapterA.SelectCommand = commandselectA; adapterA.Fill(datatableA); } catch { Logging.updateLog(""Error: Tried to get "" + table + "" from DataSetA. Table doesn't exist!"", true, false, false); } if (addtoDataSet == true) { datasetA.Tables.Add(datatableA); Logging.updateLog(""Added DataTableA: "" + datatableA.TableName.ToString() + "" Successfully!"", false, false, false); } dataconnectionA.Close(); } static public void addTableB(string table, bool addtoDataSet) { dataconnectionB.Open(); datatableB = new DataTable(table); try { OleDbCommand commandselectB = new OleDbCommand(""SELECT * FROM ["" + table + ""]"", dataconnectionB); adapterB.SelectCommand = commandselectB; adapterB.Fill(datatableB); } catch { Logging.updateLog(""Error: Tried to get "" + table + "" from DataSetB. Table doesn't exist!"", true, false, false); } if (addtoDataSet == true) { datasetB.Tables.Add(datatableB); Logging.updateLog(""Added DataTableB: "" + datatableB.TableName.ToString() + "" Successfully!"", false, false, false); } dataconnectionB.Close(); } static public string[] getTablesA(string connectionString) { dataconnectionA.Open(); tableListA = dataconnectionA.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, new Object[] { null, null, null, ""TABLE"" }); string[] stringTableListA = new string[tableListA.Rows.Count]; for (int i = 0; i < tableListA.Rows.Count; i++) { stringTableListA[i] = tableListA.Rows[i].ItemArray[2].ToString(); } dataconnectionA.Close(); return stringTableListA; } static public string[] getTablesB(string connectionString) { dataconnectionB.Open(); tableListB = dataconnectionB.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, new Object[] { null, null, null, ""TABLE"" }); string[] stringTableListB = new string[tableListB.Rows.Count]; for (int i = 0; i < tableListB.Rows.Count; i++) { stringTableListB[i] = tableListB.Rows[i].ItemArray[2].ToString(); } dataconnectionB.Close(); return stringTableListB; } static public void createDataSet() { string[] tempA = getTablesA(connectionstringA); string[] tempB = getTablesB(connectionstringB); int percentage = 0; int maximum = (tempA.Length + tempB.Length); Logging.updateNotice(""Loading Tables...""); Logging.updateLog(""Started Loading File A"", false, false, true); for (int i = 0; i < tempA.Length ; i++) { if (!datasetA.Tables.Contains(tempA[i])) { addTableA(tempA[i], true); percentage++; Logging.loadStatus(percentage, maximum); } else { datasetA.Tables.Remove(tempA[i]); addTableA(tempA[i], true); percentage++; Logging.loadStatus(percentage, maximum); } } Logging.updateLog(""Finished loading File A"", false, false, true); Logging.updateLog(""Started loading File B"", false, false, true); for (int i = 0; i < tempB.Length ; i++) { if (!datasetB.Tables.Contains(tempB[i])) { addTableB(tempB[i], true); percentage++; Logging.loadStatus(percentage, maximum); } else { datasetB.Tables.Remove(tempB[i]); addTableB(tempB[i], true); percentage++; Logging.loadStatus(percentage, maximum); } } Logging.updateLog(""Finished loading File B"", false, false, true); Logging.updateLog(""Both files loaded into memory successfully"", false, true, false); } static public DataTable getDataTableA() { datatableA = datasetA.Tables[Settings.textA]; return datatableA; } static public DataTable getDataTableB() { datatableB = datasetB.Tables[Settings.textB]; return datatableB; } static public DataSet getDataSetA() { return datasetA; } static public DataSet getDataSetB() { return datasetB; } static public void InitiateCopyProcessA() { DataSet tablesA; tablesA = DatabaseHandling.getDataSetA(); int percentage = 0; int maximum = (tablesA.Tables.Count); foreach (DataTable table in tablesA.Tables) { Logging.loadStatus(percentage, maximum); OverwriteTable(table, table.TableName); Logging.updateLog(""Copied "" + table.TableName + "" successfully."", false, true, false); percentage++; } } static void OverwriteTable(DataTable sourceTable, string tableName) { using (var destConn = new OleDbConnection(connectionstringA)) using (var destCmd = new OleDbCommand(tableName, destConn) { CommandType = CommandType.TableDirect }) using (var destDA = new OleDbDataAdapter(destCmd)) { // Since we're using a single table, we can have the CommandBuilder // generate the appropriate INSERT and DELETE SQL statements using (var destCmdB = new OleDbCommandBuilder(destDA)) { destCmdB.QuotePrefix = ""[""; // quote reserved column names destCmdB.QuoteSuffix = ""]""; destDA.DeleteCommand = destCmdB.GetDeleteCommand(); destDA.InsertCommand = destCmdB.GetInsertCommand(); // Get rows from destination, and delete them var destTable = new DataTable(); destDA.Fill(destTable); foreach (DataRow dr in destTable.Rows) { dr.Delete(); } destDA.Update(destTable); // Set rows from source as Added, so the DataAdapter will insert them foreach (DataRow dr in sourceTable.Rows) { dr.SetAdded(); } destDA.Update(sourceTable); } } } } }",How to fix: Dynamic SQL generation for the DeleteCommand is not supported against a SelectCommand that does not return any key column information
Dictionary," In a dictionary like this: The output is: For Key = ""rtf"" value = wordpad.exeWhat does the {0} mean? <code>  Dictionary<string, string> openWith = new Dictionary<string, string>();openWith.Add(""txt"", ""notepad.exe"");openWith.Add(""bmp"", ""paint.exe"");openWith.Add(""dib"", ""paint.exe"");openWith.Add(""rtf"", ""wordpad.exe"");Console.WriteLine(""For key = \""rtf\"", value = {0}."", openWith[""rtf""]);",What does {0} mean when found in a string in C#?
What does {0} mean when found in a string in c#?," In a dictionary like this: The output is: For Key = ""rtf"" value = wordpad.exeWhat does the {0} mean? <code>  Dictionary<string, string> openWith = new Dictionary<string, string>();openWith.Add(""txt"", ""notepad.exe"");openWith.Add(""bmp"", ""paint.exe"");openWith.Add(""dib"", ""paint.exe"");openWith.Add(""rtf"", ""wordpad.exe"");Console.WriteLine(""For key = \""rtf\"", value = {0}."", openWith[""rtf""]);",What does {0} mean when found in a string in C#?
How to copy an animated gif image using C#?, Is there a method to create a copy of an animated gif image using C#?What I want is to generate a copy of a given gif image using the height and width parameters that the user provides. I have tried for a couple of hours to accomplish this but the resulting image does not preserve the original animations. <code> ,How to resize an animated gif image using C#?
How would you count occurences of a string within a string (C#)?," I am doing something where I realised I wanted to count how many /s I could find in a string, and then it struck me, that there were several ways to do it, but couldn't decide on what the best (or easiest) was.At the moment I'm going with something like: But I don't like it at all, any takers?I don't really want to dig out RegEx for this, do I?I know my string is going to have the term I'm searching for, so you can assume that...Of course for strings where length > 1, <code>  string source = ""/once/upon/a/time/"";int count = source.Length - source.Replace(""/"", """").Length; string haystack = ""/once/upon/a/time"";string needle = ""/"";int needleCount = ( haystack.Length - haystack.Replace(needle,"""").Length ) / needle.Length;",How would you count occurrences of a string (actually a char) within a string?
How would you count occurrences of a string within a string (C#)?," I am doing something where I realised I wanted to count how many /s I could find in a string, and then it struck me, that there were several ways to do it, but couldn't decide on what the best (or easiest) was.At the moment I'm going with something like: But I don't like it at all, any takers?I don't really want to dig out RegEx for this, do I?I know my string is going to have the term I'm searching for, so you can assume that...Of course for strings where length > 1, <code>  string source = ""/once/upon/a/time/"";int count = source.Length - source.Replace(""/"", """").Length; string haystack = ""/once/upon/a/time"";string needle = ""/"";int needleCount = ( haystack.Length - haystack.Replace(needle,"""").Length ) / needle.Length;",How would you count occurrences of a string (actually a char) within a string?
How would you count occurrences of a string within a string?," I am doing something where I realised I wanted to count how many /s I could find in a string, and then it struck me, that there were several ways to do it, but couldn't decide on what the best (or easiest) was.At the moment I'm going with something like: But I don't like it at all, any takers?I don't really want to dig out RegEx for this, do I?I know my string is going to have the term I'm searching for, so you can assume that...Of course for strings where length > 1, <code>  string source = ""/once/upon/a/time/"";int count = source.Length - source.Replace(""/"", """").Length; string haystack = ""/once/upon/a/time"";string needle = ""/"";int needleCount = ( haystack.Length - haystack.Replace(needle,"""").Length ) / needle.Length;",How would you count occurrences of a string (actually a char) within a string?
How to quickly organize functions in source code (c#) to order by alpabetical order?," I'm doing some class clean to organize the functions in cs file in alphabetical order. I'm using Visual Studio 2008.When writing them, I just put them arbitrarily, but it now looks quite messy. Is there some easy way to organize them automatically? Better to have a tool because there're quite a lot files to clean up.  <code> ",How to quickly organize functions in source code (c#) to order by alphabetical order?
"C#, Linq2SQL: Sum() causes exception instead of returning 0 when no rows"," I have this code (ok, I don't, but something similar :p) Here I go through all dogs and sum up the weight (into a non-nullable decimal) of all not-annoying cats which has the same owner as the dog. Of course, pretty much all cats are annoying, so I get this error: The null value cannot be assigned to a member with type System.Decimal which is a non-nullable value type.None of the fields or foreign keys used can be null. So the error happens when the Where clause returns no cats, which it often does. But how can I solve this? I want it to return 0 when that happens. Tried with a DefaultIfEmpty() after the Where clause, but then I get this error: Object reference not set to an instance of an object.Which I guess is understandable. I tried to add a ?? after the Sum, but then it wont compile because of this error: Operator '??' cannot be applied to operands of type 'decimal' and 'decimal'Which also makes sense of course. So what can I do? Would be nice if the Sum thing just returned 0 when there was nothing to sum. Or a SumOrZero statement of some sort. Would it be difficult to make a SumOrZero method that worked with Linq2SQL? <code>  var dogs = Dogs.Select( => new Row { Name = .Name, WeightOfNiceCats = .Owner .Cats .Where( => !.Annoying) .Sum( => .Weight), });",Sum() causes exception instead of returning 0 when no rows
Program does not contain a static 'Main' method suitable for an entry point," Suddenly my whole project stopped compiling at all, showing the following message:Program 'path_to_obj_project_folder' does not contain a static 'Main'method suitable for an entry pointI made no changes to project properties, just added some classes, moved some other classes into folders. Its an WPF Application project so it should be all OK. Entry point is where it should be, file App.xaml was not modified at all :(What should I do to make it work again?NOTEFor reference: if renaming the App.xaml this can happen. As OP stated, App.xaml was not altered; however, this is added for anyone that does rename the App.xaml. <code> ","How to fix WPF error: ""Program does not contain a static 'Main' method suitable for an entry point""?"
Add DataBinding for attachted Property per Code Behind, I want to add a DataBinding per Codebehind for an attached Property and want to show the Canvas.Left property in a TextBox. How do I add this property? <code> ,Add DataBinding for attached Property per Code Behind
Should I return object[] or ICollection<object> from a function?," What's the preferred container type when returning multiple objects of the same type from a function? Is it against good practice to return a simple array (like MyType[]), or should you wrap it in some generic container (like ICollection<MyType>)? Thanks! <code> ",Should I return an array or a collection from a function?
[.NET] IDisposable GC.SuppressFinalize(this) location," I use a default IDisposable implementation template (pattern) for my code.snippet: My question: why is the call ""GC.SuppressFinalize(this)"" in the Dispose public method? I would place ""GC.SuppressFinalize(this)"" in the ""if (isDisposing)"" section of the protected method, after disposing managed resources.Like this: <code>  public void Dispose(){ Dispose(true); GC.SuppressFinalize(this);}protected virtual void Dispose(bool isDisposing){ if (!this.disposed) { if (isDisposing) { //cleanup managed resources } //cleanup unmanaged resources this.disposed = true; }} protected virtual void Dispose(bool isDisposing){ if (!this.disposed) { if (isDisposing) { //cleanup managed resources GC.SuppressFinalize(this); } //cleanup unmanaged resources this.disposed = true; }}",IDisposable GC.SuppressFinalize(this) location
What is MVC Futures Library ?," On Stack Overflow, I've seen a few people referring to the MVC Futures libraryWhat is this project? How do I use it? Where is the documentation? <code> ",What is the MVC Futures Library?
What is the MVC Futures Library ?," On Stack Overflow, I've seen a few people referring to the MVC Futures libraryWhat is this project? How do I use it? Where is the documentation? <code> ",What is the MVC Futures Library?
Under C# how much of a performance hit is a catch block ," First of all, a disclaimer:I have experience in other languages, but am still learning the subtleties of C#On to the problem... I am looking at some code, which uses the try/catch blocks in a way that concerns me. When a parsing routine is called, rather than return an error code, the programmer used the following logic This is caught by the caller, which throws the same error ...... which is caught by the caller, which throws the same error ........ which is caught by the caller, which throws the same error ...back up about 6 levels.Am I right in thinking all these catch/throw blocks are causing a performance problem, or is this a reasonable implementation under C#? <code>  catch (TclException e) { throw new TclRuntimeError(""unexpected TclException: "" + e.Message,e);} ","Under C# how much of a performance hit is a try, throw and catch block "
"How can I set a WPF control's color to a system color programatically, so that it updates on color scheme changes?"," How can I do this in WPF's code-behind? <code>  <Grid Background=""{DynamicResource {x:Static SystemColors.DesktopBrushKey}}""/>","How can I set a WPF control's color to a system color programmatically, so that it updates on color scheme changes?"
Rhino mocks change behaviour of stubs," Can I change the behaviour of a stub during runtime? Something like: My code example still fails in the given line, fi.GetBar() still returns ""A"".Or is there another trick to model stubs whose behaviour changes over time? I'd rather not resort to using fi.Stub(...).Do(...).Ah, probably I just need hardcopy of the fine manual for somebody to hit me over the head with it. It looks like it should really be obvious, but I can't find it. <code>  public interface IFoo { string GetBar(); } [TestMethod] public void TestRhino() { var fi = MockRepository.GenerateStub<IFoo>(); fi.Stub(x => x.GetBar()).Return(""A""); Assert.AreEqual(""A"", fi.GetBar()); fi.Stub(x => x.GetBar()).Return(""B""); Assert.AreEqual(""B"", fi.GetBar()); // Currently fails here }",How to change behaviour of stubs?
Rhino mocks  change behaviour of stubs," Can I change the behaviour of a stub during runtime? Something like: My code example still fails in the given line, fi.GetBar() still returns ""A"".Or is there another trick to model stubs whose behaviour changes over time? I'd rather not resort to using fi.Stub(...).Do(...).Ah, probably I just need hardcopy of the fine manual for somebody to hit me over the head with it. It looks like it should really be obvious, but I can't find it. <code>  public interface IFoo { string GetBar(); } [TestMethod] public void TestRhino() { var fi = MockRepository.GenerateStub<IFoo>(); fi.Stub(x => x.GetBar()).Return(""A""); Assert.AreEqual(""A"", fi.GetBar()); fi.Stub(x => x.GetBar()).Return(""B""); Assert.AreEqual(""B"", fi.GetBar()); // Currently fails here }",How to change behaviour of stubs?
.NET How to serialize a TimeSpan to XML," I am trying to serialize a .NET TimeSpan object to XML and it is not working. A quick google has suggested that while TimeSpan is serializable, the XmlCustomFormatter does not provide methods to convert TimeSpan objects to and from XML.One suggested approach was to ignore the TimeSpan for serialization, and instead serialize the result of TimeSpan.Ticks (and use new TimeSpan(ticks) for deserialization). An example of this follows: While this appears to work in my brief testing - is this the best way to achieve this?Is there a better way to serialize a TimeSpan to and from XML? <code>  [Serializable]public class MyClass{ // Local Variable private TimeSpan m_TimeSinceLastEvent; // Public Property - XmlIgnore as it doesn't serialize anyway [XmlIgnore] public TimeSpan TimeSinceLastEvent { get { return m_TimeSinceLastEvent; } set { m_TimeSinceLastEvent = value; } } // Pretend property for serialization [XmlElement(""TimeSinceLastEvent"")] public long TimeSinceLastEventTicks { get { return m_TimeSinceLastEvent.Ticks; } set { m_TimeSinceLastEvent = new TimeSpan(value); } }}",How to serialize a TimeSpan to XML
Is it better to use WPF over WinForms?," For a brand new application, is it better to use WPF over Windows Forms? I used Windows Forms before but not much WPF. As far as I know, WPF is the successor to Windows Forms, right?The application is going to host DirectX Windows (not WPF 3D, but Managed DirectX and SlimDX) with lots of custom controls.EDIT: The application is a 3D related application, editor, such as modo: <code> ",Is it better to use WPF over Windows Forms?
Open an Excel 2003 spreadsheet with C#. Could not find installable ISAM. Exeption ," I need to pull data from an xls, I also need have the user be able to change the location of the file it will. So an OleDbConnection seemed like a good start, and it was until the first merged cell.This works for all but the merged cells: I found that this should allow access to the merged cells: But then I get a Could not find installable ISAM exception on cmd.conn.open();I followed the advice here:http://support.microsoft.com/kb/209805And here:Error: ""Could Not Find Installable ISAM""No luck.Im open to other ways of pulling data from the xls. Or even if there was a command I could run on the xls to remove the mirged cells that might work. <code>  OleDbCommand cmd = new OleDbCommand();cmd.Connection = new OleDbConnection(@""Provider=Microsoft.Jet.OLEDB.4.0;Data Source=F:\test.xls;Extended Properties=Excel 8.0;"");cmd.CommandText = ""SELECT * FROM [Sheet$]"";cmd.Connection.Open(); OleDbConnection(@""Provider=Microsoft.Jet.OLEDB.4.0;Data Source=F:\test.xls;Extended Properties=Excel 8.0;HDR=Yes;IMEX=1;"");",Open an Excel 2003 spreadsheet with C#. Could not find installable ISAM. Exception 
Is using a Mutex to prevent multipule instances of the same program from running safe?," I'm using this code to prevent a second instance of my program from running at the same time, is it safe? I'm worried that if something throws an exception and the app crashes that the Mutex will still be held. Is that true? <code>  Mutex appSingleton = new System.Threading.Mutex(false, ""MyAppSingleInstnceMutx"");if (appSingleton.WaitOne(0, false)) { Application.EnableVisualStyles(); Application.SetCompatibleTextRenderingDefault(false); Application.Run(new MainForm()); appSingleton.Close();} else { MessageBox.Show(""Sorry, only one instance of MyApp is allowed."");}",Is using a Mutex to prevent multiple instances of the same program from running safe?
"Asp.NET Excel spreadsheet generation  results in  ""different file format than extension error"" when opening in excel, but the spreadsheet show correctly"," The spreadsheet still displays, but with the warning message. The problem seems to occur because Excel 2007 is more picky about formats matching their extensions than earlier versions of Excel.The problem was initially discovered by an ASP.Net program and produces in the Excel error ""The file you are trying to open, ""Spreadsheet.aspx-18.xls', is in a different format than specified by the file extension. Verify ..."". However, when I open the file it displays just fine. I am using Excel 2007. Firefox identifies the file as an Excel 97-2003 worksheet. Here is an ASP.NET page which generates the problem: The code behind file looks like: }T <code>  <%@ Page Language=""C#"" AutoEventWireup=""true"" CodeFile=""Spreadsheet.aspx.cs"" Inherits=""Spreadsheet"" %> public partial class Spreadsheet : System.Web.UI.Page { protected void Page_Load(object sender, EventArgs e) { Response.ContentType = ""application/vnd.ms-excel""; Response.Clear(); Response.Write(""Field\tValue\tCount\n""); Response.Write(""Coin\tPenny\t443\n""); Response.Write(""Coin\tNickel\t99\n""); } ","Excel spreadsheet generation results in ""different file format than extension error"" when opening in excel 2007"
"Asp.NET Excel spreadsheet generation  results in  ""different file format than extension error"" when opening in excel, but the spreadsheet shows correctly"," The spreadsheet still displays, but with the warning message. The problem seems to occur because Excel 2007 is more picky about formats matching their extensions than earlier versions of Excel.The problem was initially discovered by an ASP.Net program and produces in the Excel error ""The file you are trying to open, ""Spreadsheet.aspx-18.xls', is in a different format than specified by the file extension. Verify ..."". However, when I open the file it displays just fine. I am using Excel 2007. Firefox identifies the file as an Excel 97-2003 worksheet. Here is an ASP.NET page which generates the problem: The code behind file looks like: }T <code>  <%@ Page Language=""C#"" AutoEventWireup=""true"" CodeFile=""Spreadsheet.aspx.cs"" Inherits=""Spreadsheet"" %> public partial class Spreadsheet : System.Web.UI.Page { protected void Page_Load(object sender, EventArgs e) { Response.ContentType = ""application/vnd.ms-excel""; Response.Clear(); Response.Write(""Field\tValue\tCount\n""); Response.Write(""Coin\tPenny\t443\n""); Response.Write(""Coin\tNickel\t99\n""); } ","Excel spreadsheet generation results in ""different file format than extension error"" when opening in excel 2007"
"Asp.NET Excel spreadsheet generation  results in  ""different file format than extension error"" when opening in excel 2007"," The spreadsheet still displays, but with the warning message. The problem seems to occur because Excel 2007 is more picky about formats matching their extensions than earlier versions of Excel.The problem was initially discovered by an ASP.Net program and produces in the Excel error ""The file you are trying to open, ""Spreadsheet.aspx-18.xls', is in a different format than specified by the file extension. Verify ..."". However, when I open the file it displays just fine. I am using Excel 2007. Firefox identifies the file as an Excel 97-2003 worksheet. Here is an ASP.NET page which generates the problem: The code behind file looks like: }T <code>  <%@ Page Language=""C#"" AutoEventWireup=""true"" CodeFile=""Spreadsheet.aspx.cs"" Inherits=""Spreadsheet"" %> public partial class Spreadsheet : System.Web.UI.Page { protected void Page_Load(object sender, EventArgs e) { Response.ContentType = ""application/vnd.ms-excel""; Response.Clear(); Response.Write(""Field\tValue\tCount\n""); Response.Write(""Coin\tPenny\t443\n""); Response.Write(""Coin\tNickel\t99\n""); } ","Excel spreadsheet generation results in ""different file format than extension error"" when opening in excel 2007"
"Excel spreadsheet generation  results in  ""different file format than extension error"" when opening in excel 2007"," The spreadsheet still displays, but with the warning message. The problem seems to occur because Excel 2007 is more picky about formats matching their extensions than earlier versions of Excel.The problem was initially discovered by an ASP.Net program and produces in the Excel error ""The file you are trying to open, ""Spreadsheet.aspx-18.xls', is in a different format than specified by the file extension. Verify ..."". However, when I open the file it displays just fine. I am using Excel 2007. Firefox identifies the file as an Excel 97-2003 worksheet. Here is an ASP.NET page which generates the problem: The code behind file looks like: }T <code>  <%@ Page Language=""C#"" AutoEventWireup=""true"" CodeFile=""Spreadsheet.aspx.cs"" Inherits=""Spreadsheet"" %> public partial class Spreadsheet : System.Web.UI.Page { protected void Page_Load(object sender, EventArgs e) { Response.ContentType = ""application/vnd.ms-excel""; Response.Clear(); Response.Write(""Field\tValue\tCount\n""); Response.Write(""Coin\tPenny\t443\n""); Response.Write(""Coin\tNickel\t99\n""); } ","Excel spreadsheet generation results in ""different file format than extension error"" when opening in excel 2007"
Passing command line arguments in C#," I'm trying to pass command-line arguments to a C# application, but I have problem passing something like this even if I add "" "" to the argument.Here is my code: And here is what I'm passing: The problem is I can get the first and the second args correctly, but the last one it gets as C:\Documents.Any help? <code>  ""C:\Documents and Settings\All Users\Start Menu\Programs\App name"" public ObjectModel(String[] args) { if (args.Length == 0) return; //no command line arg. //System.Windows.Forms.MessageBox.Show(args.Length.ToString()); //System.Windows.Forms.MessageBox.Show(args[0]); //System.Windows.Forms.MessageBox.Show(args[1]); //System.Windows.Forms.MessageBox.Show(args[2]); //System.Windows.Forms.MessageBox.Show(args[3]); if (args.Length == 3) { try { RemoveInstalledFolder(args[0]); RemoveUserAccount(args[1]); RemoveShortCutFolder(args[2]); RemoveRegistryEntry(); } catch (Exception e) { } } } C:\WINDOWS\Uninstaller.exe ""C:\Program Files\Application name\"" ""username"" ""C:\Documents and Settings\All Users\Start Menu\Programs\application name""",Passing command-line arguments in C#
How do I skip an iteration of a foreach loop in C#?, In Perl I can skip a foreach (or any loop) iteration with a next; command.Is there a way to skip over an iteration and jump to the next loop in C#? <code>  foreach (int number in numbers) { if (number < 0) { // What goes here to skip over the loop? } // otherwise process number },How do I skip an iteration of a `for` or `foreach` loop?
How do I skip an iteration of a `foreach` loop in C#?, In Perl I can skip a foreach (or any loop) iteration with a next; command.Is there a way to skip over an iteration and jump to the next loop in C#? <code>  foreach (int number in numbers) { if (number < 0) { // What goes here to skip over the loop? } // otherwise process number },How do I skip an iteration of a `for` or `foreach` loop?
How do I skip an iteration of a `foreach` loop?, In Perl I can skip a foreach (or any loop) iteration with a next; command.Is there a way to skip over an iteration and jump to the next loop in C#? <code>  foreach (int number in numbers) { if (number < 0) { // What goes here to skip over the loop? } // otherwise process number },How do I skip an iteration of a `for` or `foreach` loop?
System.InvalidOperationException: Unable to generate a temporary class (result=1).," I have developed an application using .net 3.5 and have deployed it as an .exe on a number of machines with the same environment.However, on one particular machine I get the following error. Stack Trace:See the end of this message for details on invoking just-in-time (JIT) debugging instead of this dialog box. Loaded Assemblies: ************** JIT Debugging **************To enable just-in-time (JIT) debugging, the .config file for thisapplication or computer (machine.config) must have thejitDebugging value set in the system.windows.forms section.The application must also be compiled with debuggingenabled.For example: When JIT debugging is enabled, any unhandled exceptionwill be sent to the JIT debugger registered on the computerrather than be handled by this dialog box.Could someone help me with this?As I am new to .net could someone also tell me when why a temporary class needs to be created in the first place? <code>  System.InvalidOperationException: Unable to generate a temporary class (result=1).error CS2001: Source file 'C:\WINDOWS\TEMP\wz58eig4.0.cs' could not be founderror CS2008: No inputs specified at System.Xml.Serialization.Compiler.Compile(Assembly parent, String ns, XmlSerializerCompilerParameters xmlParameters, Evidence evidence) at System.Xml.Serialization.TempAssembly.GenerateAssembly(XmlMapping[] xmlMappings, Type[] types, String defaultNamespace, Evidence evidence, XmlSerializerCompilerParameters parameters, Assembly assembly, Hashtable assemblies) at System.Xml.Serialization.TempAssembly..ctor(XmlMapping[] xmlMappings, Type[] types, String defaultNamespace, String location, Evidence evidence) at System.Xml.Serialization.XmlSerializer.GetSerializersFromCache(XmlMapping[] mappings, Type type) at System.Xml.Serialization.XmlSerializer.FromMappings(XmlMapping[] mappings, Type type) at System.Web.Services.Protocols.SoapClientType..ctor(Type type) at System.Web.Services.Protocols.SoapHttpClientProtocol..ctor() at SSOClient..ctor() at sc.tradesvc.SSOManager..ctor() at sc.tradesvc.SSOManager.get_Inst() at sc.cashflowgenerator.Controls.LoginForm.btnLogin_Click(Object sender, EventArgs e) at System.Windows.Forms.Control.OnClick(EventArgs e) at System.Windows.Forms.Button.OnClick(EventArgs e) at System.Windows.Forms.Button.PerformClick() at System.Windows.Forms.Form.ProcessDialogKey(Keys keyData) at System.Windows.Forms.TextBoxBase.ProcessDialogKey(Keys keyData) at System.Windows.Forms.Control.PreProcessMessage(Message& msg) at System.Windows.Forms.Control.PreProcessControlMessageInternal(Control target, Message& msg) at System.Windows.Forms.Application.ThreadContext.PreTranslateMessage(MSG& msg) mscorlib Assembly Version: 2.0.0.0 Win32 Version: 2.0.50727.1433 (REDBITS.050727-1400) CodeBase: file:///C:/WINDOWS/Microsoft.NET/Framework/v2.0.50727/mscorlib.dllCashflowGenerator Assembly Version: 1.0.0.0 Win32 Version: 1.0.0.0 CodeBase: file:///C:/DATA/DEVEL/Output/CashflowGenerator.exeSystem.Windows.Forms Assembly Version: 2.0.0.0 Win32 Version: 2.0.50727.1433 (REDBITS.050727-1400) CodeBase: file:///C:/WINDOWS/assembly/GAC_MSIL/System.Windows.Forms/2.0.0.0__b77a5c561934e089/System.Windows.Forms.dllSystem Assembly Version: 2.0.0.0 Win32 Version: 2.0.50727.1433 (REDBITS.050727-1400) CodeBase: file:///C:/WINDOWS/assembly/GAC_MSIL/System/2.0.0.0__b77a5c561934e089/System.dllSystem.Drawing Assembly Version: 2.0.0.0 Win32 Version: 2.0.50727.1433 (REDBITS.050727-1400) CodeBase: file:///C:/WINDOWS/assembly/GAC_MSIL/System.Drawing/2.0.0.0__b03f5f7f11d50a3a/System.Drawing.dllSystem.Configuration Assembly Version: 2.0.0.0 Win32 Version: 2.0.50727.1433 (REDBITS.050727-1400) CodeBase: file:///C:/WINDOWS/assembly/GAC_MSIL/System.Configuration/2.0.0.0__b03f5f7f11d50a3a/System.Configuration.dllSystem.Xml Assembly Version: 2.0.0.0 Win32 Version: 2.0.50727.1433 (REDBITS.050727-1400) CodeBase: file:///C:/WINDOWS/assembly/GAC_MSIL/System.Xml/2.0.0.0__b77a5c561934e089/System.Xml.dllSystem.Core Assembly Version: 3.5.0.0 Win32 Version: 3.5.21022.8 built by: RTM CodeBase: file:///C:/WINDOWS/assembly/GAC_MSIL/System.Core/3.5.0.0__b77a5c561934e089/System.Core.dllSystem.Web.Services Assembly Version: 2.0.0.0 Win32 Version: 2.0.50727.1433 (REDBITS.050727-1400) CodeBase: file:///C:/WINDOWS/assembly/GAC_MSIL/System.Web.Services/2.0.0.0__b03f5f7f11d50a3a/System.Web.Services.dll",System.InvalidOperationException: Unable to generate a temporary class (result=1)
parse directory name from full filepath in C#," If I have a string variable that has: and I want to get ""foo""what is the best way to do this? <code>  ""C:\temp\temp2\foo\bar.txt""",Parse directory name from a full filepath in C#
How to Get Local Machine Name ?, How do I get the local machine name? <code> ,How do I get the local machine name in C#?
How do I get the local machine Name?, How do I get the local machine name? <code> ,How do I get the local machine name in C#?
"C# Web Service wont output JSON, only XML"," I'm trying to use jQuery and JSON with a C# Web Service that I wrote. No matter what, the following code will only output in XML.Webservice Code I also have these attributes assigned to the class jQuery Code The ASMX page always returns as content type ""text/xml"". Anything I'm missing?EDITS: In response to a couple answers:If I have the datatype as just ""json"" the content is still XML and jQuery also will not call my callback function. If I add the ""&callback=?"" to the url, IIS throws a HTTP 500 error.My class does inherit from ""System.Web.Services.WebService"". From doing some research on your guys answers, it looks like I do need to mess with WCF. Unfortunately the JSON that is returned is more designed for MS Ajax and is a lot of useless bloat for my use. I may look into an open source library like Jayrock or something similar.Thanks for all your help! <code>  [WebMethod][ScriptMethod(ResponseFormat = ResponseFormat.Json)]public string HelloWorld() { return ""Hello World!"";} [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)][ScriptService] $.ajax({ type: ""POST"", contentType: ""application/json; charset=utf-8"", url: ""ScheduleComputerDS.asmx/HelloWorld"", data: ""{}"", dataType: ""jsonp"", success: function(data) { alert(data); }});","C# Web Service won't output JSON, only XML"
is a 2 Multidimensional Lists possible?," I'd like to set up a multidimensional list.For reference, I am working on a playlist analyzer.I have a file/file-list, which my program saves in a standard list. One line from the file in each list entry.I then analyze the list with regular-expressions to find specific lines.Some of the data/results from the lines needs to be put into a new multidimensional list; since I don't know how many results/data I'll end up with, I can't use a multidimensional array.Here is the data I want to insert: Real Example: So yeah, mlist[0][0] would get TrackID from song 1, mlist[1][0] from song 2 etc.But I am having huge issues creating a multidimensional list.So far I have come up with But I haven't really had much more progress :( <code>  List( [0] => List ( [0] => Track ID [1] => Name [2] => Artist [3] => Album [4] => Play Count [5] => Skip Count ) [1] => List (And so on.... List( [0] => List ( [0] => 2349 [1] => The Prime Time of Your Life [2] => Daft Punk [3] => Human After All [4] => 3 [5] => 2 ) [1] => List ( List<List<string>> matrix = new List<List<string>>();",Are 2 dimensional Lists possible in c#?
The State of C# Linkers for .NET apps," Many people here are probably familiar with one of Joel Spolsky most popular blog posts, Please Sir, May I Have a Linker, where he cries out for a way to remove dependencies on the .NET framework so a stand-alone application can be developed and sold.Jason Zander of the Visual Studio development team, at the time, replied with his views on the topic, arguing that the topic is somewhat moot - the ability to fix security problems in the runtime (among other points) was their chief concern. Overall, the small overhead was worth it.Fast forward to 2009. There's a few groups out there now claiming to have C# linkers. (Jason Zander even said himself that it wouldn't take much to implement one.) Instead of the cute, dozen-so meg download of .NET 1.0, we now have a massive 200-300 mb cross-platform complete .NET 3.5 installer that contains versions of .NET for x86, x64, and ia64. Microsoft's suggestions to decrease the runtime size include:Unpack the redistributable, remove the target platforms you don't want, and put it back togetherUse the web bootstrapper that only downloads the libraries for your platformUse the Client Profile installer (new as of late 2008) which has limited libraries and only works for x86To make matters worse, as I understand it (please correct me if I'm wrong) the client profile don't even register with windows as having .NET 3.5 installed. This means if multiple .NET 3.5 client applications are installed on the computer, none will see each other and the runtime will be re-installed again and again!I really don't know what Microsoft is thinking here. Even assuming the worst case install will be for one target platform (eg, x64) and only those libraries need to be included, you're still looking at upwards of 60 mb overhead on your app. Even one of the most well known .NET apps, Paint.NET, was fraught with Difficulties installing the application because of the massive .NET dependencies. If THEY have problems distributing a free app, what about the rest of the world? In the end, they had to Make a bootstrapper that installed Microsoft Installer 3.1, the .NET runtime bootstrapper, and all their other dependent libraires before they could install their own application.So how about it. A linker. Do any good ones exist - or a tool that simply makes it possible to build a C# application without requiring that the user install the massive .NET runtime?Update: so, it looks like there's a couple of options:Mono:Mono has its own linker. From the answer below, it looks like it works pretty well..NET:Xenocode seems to be one that's available and works.Thinstall is another that was recommended, and it's by VMware.There's another linker by Remotesoft. They bill it as an 'obfuscator'. Any thoughts there?Found another by Rustemsoft called Skater .NET Obfuscator. Anyone familiar with them?ILmerge by Microsoft was also suggested; this looks like it only performs part of the task (ie, merging libraries, not stripping out unused bits).It looks like the Mono tools are getting use; how about the .NET based tools? Any other experience with them, or are we just going to have to wait for Microsoft to push it 3.5 out to everyone? I shudder to think how long it'll take for .NET 4.0 to be put out... <code> ","The State of Linkers for .NET apps (aka ""Please Sir, May I have a Linker"" 2009 edition)"
"The State of Linkers for .NET apps aka ""Please Sir, May I have a Linker"" 2009 edition"," Many people here are probably familiar with one of Joel Spolsky most popular blog posts, Please Sir, May I Have a Linker, where he cries out for a way to remove dependencies on the .NET framework so a stand-alone application can be developed and sold.Jason Zander of the Visual Studio development team, at the time, replied with his views on the topic, arguing that the topic is somewhat moot - the ability to fix security problems in the runtime (among other points) was their chief concern. Overall, the small overhead was worth it.Fast forward to 2009. There's a few groups out there now claiming to have C# linkers. (Jason Zander even said himself that it wouldn't take much to implement one.) Instead of the cute, dozen-so meg download of .NET 1.0, we now have a massive 200-300 mb cross-platform complete .NET 3.5 installer that contains versions of .NET for x86, x64, and ia64. Microsoft's suggestions to decrease the runtime size include:Unpack the redistributable, remove the target platforms you don't want, and put it back togetherUse the web bootstrapper that only downloads the libraries for your platformUse the Client Profile installer (new as of late 2008) which has limited libraries and only works for x86To make matters worse, as I understand it (please correct me if I'm wrong) the client profile don't even register with windows as having .NET 3.5 installed. This means if multiple .NET 3.5 client applications are installed on the computer, none will see each other and the runtime will be re-installed again and again!I really don't know what Microsoft is thinking here. Even assuming the worst case install will be for one target platform (eg, x64) and only those libraries need to be included, you're still looking at upwards of 60 mb overhead on your app. Even one of the most well known .NET apps, Paint.NET, was fraught with Difficulties installing the application because of the massive .NET dependencies. If THEY have problems distributing a free app, what about the rest of the world? In the end, they had to Make a bootstrapper that installed Microsoft Installer 3.1, the .NET runtime bootstrapper, and all their other dependent libraires before they could install their own application.So how about it. A linker. Do any good ones exist - or a tool that simply makes it possible to build a C# application without requiring that the user install the massive .NET runtime?Update: so, it looks like there's a couple of options:Mono:Mono has its own linker. From the answer below, it looks like it works pretty well..NET:Xenocode seems to be one that's available and works.Thinstall is another that was recommended, and it's by VMware.There's another linker by Remotesoft. They bill it as an 'obfuscator'. Any thoughts there?Found another by Rustemsoft called Skater .NET Obfuscator. Anyone familiar with them?ILmerge by Microsoft was also suggested; this looks like it only performs part of the task (ie, merging libraries, not stripping out unused bits).It looks like the Mono tools are getting use; how about the .NET based tools? Any other experience with them, or are we just going to have to wait for Microsoft to push it 3.5 out to everyone? I shudder to think how long it'll take for .NET 4.0 to be put out... <code> ","The State of Linkers for .NET apps (aka ""Please Sir, May I have a Linker"" 2009 edition)"
C# compare two Lists for differences," I would like some feedback on how we can best write a generic function that will enable two Lists to be compared. The Lists contain class objects and we would like to iterate through one list, looking for the same item in a second List and report any differences.We already have a method to compare classes, so we need feedback on how we can feed the method (shown below) from two Lists.For example, say we have a simple ""Employee"" class that has three properties, Name, ID, Department. We want to report the differences between List and another List.Note:Both lists will always contain the same number of items. As mentioned above, we have a generic method that we use to compare two classes, how can we incorporate this method to cater for Lists, i.e. from another method, loop through the List and feed the classes to the generic method .... but how do we find the equivalent class in the second List to pass to the method below; Any suggestions or ideas appreciated?Edit: Targeting .NET 2.0 so LINQ is out of the question. <code>  public static string CompareTwoClass_ReturnDifferences<T1, T2>(T1 Orig, T2 Dest) where T1 : class where T2 : class{ // Instantiate if necessary if (Dest == null) throw new ArgumentNullException(""Dest"", ""Destination class must first be instantiated.""); var Differences = CoreFormat.StringNoCharacters; // Loop through each property in the destination foreach (var DestProp in Dest.GetType().GetProperties()) { // Find the matching property in the Orig class and compare foreach (var OrigProp in Orig.GetType().GetProperties()) { if (OrigProp.Name != DestProp.Name || OrigProp.PropertyType != DestProp.PropertyType) continue; if (OrigProp.GetValue(Orig, null).ToString() != DestProp.GetValue(Dest, null).ToString()) Differences = Differences == CoreFormat.StringNoCharacters ? string.Format(""{0}: {1} -> {2}"", OrigProp.Name, OrigProp.GetValue(Orig, null), DestProp.GetValue(Dest, null)) : string.Format(""{0} {1}{2}: {3} -> {4}"", Differences, Environment.NewLine, OrigProp.Name, OrigProp.GetValue(Orig, null), DestProp.GetValue(Dest, null)); } } return Differences;}",Compare two Lists for differences
Does an EventWaitHandle have any implciit MemoryBarrier?," New to this website, so let me know if I'm not posting in an accepted manner.I've frequently coded something along the lines of the sample below(with stuff like Dispose ommited for clarity. ). My question is, are the volatiles needed as shown? Or does the ManualResetEvent.Set have an implicit memory barrier as I've read Thread.Start does? Or would an explicit MemoryBarrier call be better than the volatiles? Or is it completely wrong? Also, the fact that the ""implicit memory barrier behavior"" in some operations is not documented as far as I've seen is quite frutrating, is there a list of these operations somewhere?Thanks,Tom: <code>  class OneUseBackgroundOp{ // background args private string _x; private object _y; private long _z; // background results private volatile DateTime _a private volatile double _b; private volatile object _c; // thread control private Thread _task; private ManualResetEvent _completedSignal; private volatile bool _completed; public bool DoSomething(string x, object y, long z, int initialWaitMs) { bool doneWithinWait; _x = x; _y = y; _z = z; _completedSignal = new ManualResetEvent(false); _task = new Thread(new ThreadStart(Task)); _task.IsBackground = true; _task.Start() doneWithinWait = _completedSignal.WaitOne(initialWaitMs); return doneWithinWait; } public bool Completed { get { return _completed; } } /* public getters for the result fields go here, with an exception thrown if _completed is not true; */ private void Task() { // args x, y, and z are written once, before the Thread.Start // implicit memory barrier so they may be accessed freely. // possibly long-running work goes here // with the work completed, assign the result fields _a, _b, _c here _completed = true; _completedSignal.Set(); }}",Does an EventWaitHandle have any implicit MemoryBarrier?
sql injection on insert," I have created a small survey web page on our company Intranet. This web page is not accessible from the outside.The form is simply a couple of radio buttons and a comments box.I would like to maintain good coding practices and would like to guard against SQL Injections.Can SQL injections happen on a insert statement with comments from the textbox?If so, how can I guard against it using .NET 2.0? <code> ",SQL injection on INSERT
SQL injection on insert," I have created a small survey web page on our company Intranet. This web page is not accessible from the outside.The form is simply a couple of radio buttons and a comments box.I would like to maintain good coding practices and would like to guard against SQL Injections.Can SQL injections happen on a insert statement with comments from the textbox?If so, how can I guard against it using .NET 2.0? <code> ",SQL injection on INSERT
TCPClient vs Socket in Csharp," I don't see much use of TCPClient, yet there is a lot of Socket? What is the major difference between them and when would you use each?I understand that .NET Socket is written on top of WINSOCK, and TCPClient is a wrapper over Socket class. Thus TCPClient is way up the chain, and possibly inefficient. Correct me if I am wrong.  <code> ",TCPClient vs Socket in C#
When would I use the TCPClient class instead of the Socket class in C#?," I don't see much use of TCPClient, yet there is a lot of Socket? What is the major difference between them and when would you use each?I understand that .NET Socket is written on top of WINSOCK, and TCPClient is a wrapper over Socket class. Thus TCPClient is way up the chain, and possibly inefficient. Correct me if I am wrong.  <code> ",TCPClient vs Socket in C#
Check Dll is registered or not," How do I find whether a DLL file written in C# is registered or not programmatically?I already tried this code, but it doesn't come off.If I register a DLL file and check using this code it returns. If I unregister it and run this same piece of code, it returns true again. I'm giving the full-path of the DLL file as argument.We developed a simple DLL file in Visual C++. After that we registered it. Now we want to confirm whether it is registered.Bob, will you replace the piece of code on your own, it is still difficult for me?If I register a DLL file, is there an entry present in the registry? Shall I find those entries and judge whether the DLL file is registered or not? <code> ",How to check if a DLL file is registered?
How to check if a dll is registered ?," How do I find whether a DLL file written in C# is registered or not programmatically?I already tried this code, but it doesn't come off.If I register a DLL file and check using this code it returns. If I unregister it and run this same piece of code, it returns true again. I'm giving the full-path of the DLL file as argument.We developed a simple DLL file in Visual C++. After that we registered it. Now we want to confirm whether it is registered.Bob, will you replace the piece of code on your own, it is still difficult for me?If I register a DLL file, is there an entry present in the registry? Shall I find those entries and judge whether the DLL file is registered or not? <code> ",How to check if a DLL file is registered?
Plain image in Windows Forms StatusString control," I'm trying to put a plain image on a System.Windows.Forms.StatusStrip control (Visual Studio 2008, C# .Net 3.5).I remember being able to do it quite easily in earlier framework versions, but for some reason the only controls made available to me from this new StatusStrip are a StatusLabel, a ProgressBar, a DropDownButton, and a SplitButton.I'm using the SplitButton control at the moment as it lets me include an image, but it's obviously not ideal as it has the menu dropdown attached to it.Is there a way I can add a plain image to this StatusStrip control? Should I be using a different Windows Forms control? <code> ",Plain image in Windows Forms StatusStrip control
Is Microsoft taking C# in the right direction?," A number of features were introduced into C# 3.0 which made me uneasy, such as object initializers, extension methods and implicitly typed variables. Now in C# 4.0 with things like the dynamic keyword I'm getting even more concerned.I know that each of these features CAN be used in appropriate ways BUT in my view they make it easier for developers to make bad coding decisions and therefore write worse code. It seems to me that Microsoft are trying to win market share by making the coding easy and undemanding. Personally I prefer a language that is rigorous and places more demands on my coding standards and forces me to structure things in an OOP way.Here are a few examples of my concerns for the features mentioned above:Object constructors can do important logic that is not exposed to the consumer. This is in the control of the object developer. Object initializers take this control away and allow the consumer to make the decisions about which fields to initialize.EDIT: I had not appreciated that you can mix constructor and initializer (my bad) but this starts to look messy to my mind and so I am still not convinced it is a step forward.Allowing developers to extend built-in types using extension methods allows all and sundry to start adding their favourite pet methods to the string class, which can end up with a bewildering array of options, or requires more policing of coding standards to weed these out.Allowing implicitly typed variables allows quick and dirty programming instead or properly OOP approaches, which can quickly become an unmanageable mess of vars all over your application.Are my worries justified? <code> ",How do you deal with new features of C# so that they don't lead to poorly written code?
"Using refelction to check if a method is ""Extension Method"""," As part of my application I have a function that receives a MethodInfo and need to do specific operations on it depending if that method is ""Extension Method"".I've checked the MethodInfo class and I could not find any IsExtension property or flag that shows that the method is extension.Does anyone knows how can I find that from the method's MethodInfo? <code> ","Using reflection to check if a method is ""Extension Method"""
Double.Parse - internalization problem," This is driving me crazy. I have the following string in a ASP.NET 2.0 WebForm Page Simple enough. Now, if my culture is Spanish - which is ""es-ES"" - and I try to convert the string to Double, I do the following: what I'd expect is 0,009. Instead, I get 9. I understand that .NET thinks it is a thousand separator, which in en-US is a comma, but shouldn't it take the culture info I'm passing to the parse method and apply the correct format to the conversion?If I do formatted is now 0,009. Anybody? <code>  string s = ""0.009""; double d = Double.Parse(s, new CultureInfo(""es-ES"")); double d = 0.009D;string formatted = d.ToString(new CultureInfo(""es-ES""));",Double.Parse - Internationalization problem
"VS debugging ""quick watch"" tool and lambda expressions", Why can't I use lambda expressions while debugging in Quick watch window?UPD: see alsohttp://blogs.msdn.com/b/jaredpar/archive/2009/08/26/why-no-linq-in-debugger-windows.aspxhttp://blogs.msdn.com/b/jaredpar/archive/2010/06/02/why-is-linq-absent-from-debugger-windows-part-2.aspx <code> ,"Visual Studio debugging ""quick watch"" tool and lambda expressions"
Overwrite .Net Generic List<MyType> .Contains(MyTypeInstance)?," Is it possible, and if so how do I override the Contains method of an otherwise normal List<T>, where T is my own, custom type? <code> ",Override .NET Generic List<MyType>.Contains(MyTypeInstance)?
Do .NET Timers Run Asynchronously ?," I have a messaging aspect of my application using Jabber-net (an XMPP library.)What I would like to do, if for some reason the connection to the Server is ended, is keep trying to connect every minute or so.If I start a Timer to wait for a period of time before the next attempt, does that timer run asynchronously and the resulting Tick event join the main thread, or would I need to start my own thread and start the timer from within there? <code> ",Do .NET Timers Run Asynchronously?
ASP.NET BinaryWrite Response.Close vs. Response.End," Initially I was trying to figure out what the difference is between Response.Close and Response.End, but after doing more googling and research, its clear that I haven't seen a common way a Byte[] gets sent back to the client. I'll leave the code sample below, but I would like to know what the industry standard is for doing this. <code>  Byte[] myBytes = GetReportBytes();HttpContext.Current.Response.ClearContent();HttpContext.Current.Response.AppendHeader(""content-length"", myBytes.Length.ToString());HttpContext.Current.Response.AppendHeader(""content-Disposition"", ""attachment;filename="" + this.ReportFileName + GetReportExtension());HttpContext.Current.Response.ContentType = GetApplicationContentType();HttpContext.Current.Response.BinaryWrite(myBytes);HttpContext.Current.Response.Flush();HttpContext.Current.Response.Close();//CERT FIX//HttpContext.Current.Response.End();",ASP.NET How To Stream File To User
ASP.NET Response.Close() vs. Response.End() For File Downloads," Initially I was trying to figure out what the difference is between Response.Close and Response.End, but after doing more googling and research, its clear that I haven't seen a common way a Byte[] gets sent back to the client. I'll leave the code sample below, but I would like to know what the industry standard is for doing this. <code>  Byte[] myBytes = GetReportBytes();HttpContext.Current.Response.ClearContent();HttpContext.Current.Response.AppendHeader(""content-length"", myBytes.Length.ToString());HttpContext.Current.Response.AppendHeader(""content-Disposition"", ""attachment;filename="" + this.ReportFileName + GetReportExtension());HttpContext.Current.Response.ContentType = GetApplicationContentType();HttpContext.Current.Response.BinaryWrite(myBytes);HttpContext.Current.Response.Flush();HttpContext.Current.Response.Close();//CERT FIX//HttpContext.Current.Response.End();",ASP.NET How To Stream File To User
Testing exceptions, Do you think that this is a good way for testing exceptions? Any suggestions? I'm using MS Test. <code>  Exception exception = null;try{ //I m sure that an exeption will happen here}catch (Exception ex){ exception = ex;}Assert.IsNotNull(exception);,Best way to test exceptions with Assert to ensure they will be thrown
Best way to test exceptions with Assert to ensure they will throw, Do you think that this is a good way for testing exceptions? Any suggestions? I'm using MS Test. <code>  Exception exception = null;try{ //I m sure that an exeption will happen here}catch (Exception ex){ exception = ex;}Assert.IsNotNull(exception);,Best way to test exceptions with Assert to ensure they will be thrown
"How to write, compile and run c# for free (in windows)"," Is it possible to use C# for free? Which tools would you use?For fun/studying: I'm pretty sure you can, but still, the tools question remains.For programs you wish to sell? The tools I'm looking for:IDE (as complete as possible: debugging, refactoring, libraries, IntelliSense etc.) - also, if it's not included in the IDE, compiler.Unit Testing,Documenting (extracting comments as with JavaDoc),Deploying.Other suggestions for nice free tools are also welcome.Note that IMO, Visual Studio Express is NOT offering all these tools. <code> ","How to write, compile and run C# for free (in Windows)"
How to hide close button in wpf window?," I'm writing a modal dialog in WPF. How do I set a WPF window to not have a close button? I'd still like for its WindowState to have a normal title bar.I found ResizeMode, WindowState, and WindowStyle, but none of those properties allow me to hide the close button but show the title bar, as in modal dialogs. <code> ",How to hide close button in WPF window?
Lock{lock} : locks a resource or lock a piece of code," I'm still confused... When we write some thing like this: ...and have two blocks of code that lock o while accessing resource... Now, if i have two threads, with one thread executing code which reads from resource and another writing to it, i would want to lock resource such that when it is being read, the writer would have to wait (and vice versa - if it is being written to, readers would have to wait). Will the lock construct help me? ...or should i use something else?(I'm using Dictionary for the purposes of this example, but could be anything)There are two cases I'm specifically concerned about:two threads trying to execute same line of code two threads trying to work on the same resourceWill lock help in both conditions? <code>  Object o = new Object();var resource = new Dictionary<int , SomeclassReference>(); //Code onelock(o){ // read from resource }//Code twolock(o){ // write to resource}","Does lock(){} lock a resource, or does it lock a piece of code?"
Lock {lock} : locks a resource or lock a piece of code," I'm still confused... When we write some thing like this: ...and have two blocks of code that lock o while accessing resource... Now, if i have two threads, with one thread executing code which reads from resource and another writing to it, i would want to lock resource such that when it is being read, the writer would have to wait (and vice versa - if it is being written to, readers would have to wait). Will the lock construct help me? ...or should i use something else?(I'm using Dictionary for the purposes of this example, but could be anything)There are two cases I'm specifically concerned about:two threads trying to execute same line of code two threads trying to work on the same resourceWill lock help in both conditions? <code>  Object o = new Object();var resource = new Dictionary<int , SomeclassReference>(); //Code onelock(o){ // read from resource }//Code twolock(o){ // write to resource}","Does lock(){} lock a resource, or does it lock a piece of code?"
"To ""new"" or not to ""new""- C#", Is there a rule of thumb to follow when to use the new keyword and when not to when declaring objects? OR <code>  List<MyCustomClass> listCustClass = GetList(); List<MyCustomClass> listCustClass = new List<MyCustomClass>();listCustClass = GetList();,"To ""new"" or not to ""new"""
Use of Session in high traffic websites," I am watching the ASP.NET learn videos on asp.net/learn. In this tutorial, they are building a quiz engine. At one point, the narrator explains that we are going to use the Session object to maintain the state between each page (each page contains a question and four answers). He says that ""since this is a low traffic website"" it is okay to use Session and that he doesn't have the time to implement a more sophisticated method.I am just wondering what alternate method(s) is he hinting at? And why is session a bad choice for a high traffic website? <code> ",Why is it a bad idea to use Session to store state in high traffic websites?
How do I obtain the latency between server and client in C#," I'm working on a C# Server application for a game engine I'm writing in ActionScript 3. I'm using an authoritative server model as to prevent cheating and ensure fair game. So far, everything works well: When the client begins moving, it tells the server and starts rendering locally; the server, then, tells everyone else that client X has began moving, among with details so they can also begin rendering. When the client stops moving, it tells the server, which performs calculations based on the time the client began moving and the client render tick delay and replies to everyone, so they can update with the correct values. The thing is, when I use the default 20ms tick delay on server calculations, when the client moves for a rather long distance, there's a noticeable tilt forward when it stops. If I increase slightly the delay to 22ms, on my local network everything runs very smoothly, but in other locations, the tilt is still there. After experimenting a little, I noticed that the extra delay needed is pretty much tied to the latency between client and server. I even boiled it down to a formula that would work quite nicely: delay = 20 + (latency / 10).So, how would I proceed to obtain the latency between a certain client and the server (I'm using asynchronous sockets). The CPU effort can't be too much, as to not have the server run slowly. Also, is this really the best way, or is there a more efficient/easier way to do this? <code> ",How do I obtain the latency between server and client in C#?
How to change the color(colour) of progressbar in C# .NET 3.5?, I'd like to do two things on my progress bar.Change the green colour to red.Remove the blocks and make it in one color.Any information about those two things I wonder how to accomplish will be greatfuly appreaciated!Thanks. <code> ,How to change the color of progressbar in C# .NET 3.5?
C# remove icon from the form's title bar, A client has asked me to remove the icon from the form's title bar. As they don't want to display any icon. But this me guessing as when I click on the icon property you have to browse to some icon.  <code> ,C# 2005: Remove icon from the form's title bar
Calling a javascript function from an aspx.cs code behind," I would like to call a javascript function from an aspx control. For instance, suppose I had: and in the code behind: Is there a way to do it? <code>  <html xmlns=""http://www.w3.org/1999/xhtml""> <head runat=""server""><title>Untitled Page</title><script type=""text/javascript""> function test(x, y) { }</script></head><body> <form id=""form1"" runat=""server""> <div> <asp:Button ID=""Button1"" runat=""server"" Text=""Button"" onclick=""Button1_Click""/> </div> </form></body></html> protected void Button1_Click(object sender, EventArgs e){ // do stuff (really going to a database to fill x and y) int[] x = new int[] { 1, 2, 3, 4, 5 }; int[] y = new int[] { 1, 2, 3, 4, 5 }; // call javascript function as test(x,y);}",Passing arguments to JavaScript function from code-behind
"C#: ReSharper complains when method can be static, but isn't"," Why does ReSharper complain when a method can become static, but is not?Is it because only one instance of a static method is created (on the type) and thus save on performance?  <code> ","ReSharper complains when method can be static, but isn't"
C# - is it possible to mark overriden method as final," In C#, is it possible to mark an overridden virtual method as final so implementers cannot override it? How would I do it?An example may make it easier to understand: Is there a way to modify B in order to prevent other children C from overriding DoAction, either at compile-time or runtime? <code>  class A{ abstract void DoAction();}class B : A{ override void DoAction() { // Implements action in a way that it doesn't make // sense for children to override, e.g. by setting private state // later operations depend on }}class C: B{ // This would be a bug override void DoAction() { }}",is it possible to mark overridden method as final
C# - is it possible to mark overridden method as final," In C#, is it possible to mark an overridden virtual method as final so implementers cannot override it? How would I do it?An example may make it easier to understand: Is there a way to modify B in order to prevent other children C from overriding DoAction, either at compile-time or runtime? <code>  class A{ abstract void DoAction();}class B : A{ override void DoAction() { // Implements action in a way that it doesn't make // sense for children to override, e.g. by setting private state // later operations depend on }}class C: B{ // This would be a bug override void DoAction() { }}",is it possible to mark overridden method as final
How to pass a lambda expression to a C# constructor from a IronPython script?," I'm integrating an IronPython scritping engine into my C# raytracer which, so far, has been a breeze even though I'm completely new to Python. There is one particular thing, though, that I need help with. I have a C# class which defines a constructor like this: In C#, I would instantiate this like so: I can't quite figure out how to make a similar assignment for the Action object in IronPython, so how would the Python syntax look? <code>  public CameraAnimation(Action<Camera, float> animation) var camAnimation = new CameraAnimation((camera, time) => camera.Position += new Vector(1, 0, 0));",How to pass a lambda expression to a C# constructor from an IronPython script?
C# reference to the destktop," I am using a file stream to write out a file.I was hoping to be able to write the file to the desktop.If I have something like I would like to be able to have some sort of @desktop identified in front of the file name that would automatically insert the path to the desktop. Does this exist in C#? OR do I have to look and see what there desktop is on a computer by computer(OS by OS) basis. <code>  tw = new StreamWriter(""NameOflog file.txt"");",C# reference to the desktop
understanding events and event handlers in C#," I understand the purpose of events, especially within the context of creating user interfaces. I think this is the prototype for creating an event: What do event handlers do, why are they needed, and how do I to create one? <code>  public void EventName(object sender, EventArgs e);",Understanding events and event handlers in C#
"in C#, where you use ""ref"" in front of a parameter"," There are a number of questions already on the definition of ""ref"" and ""out"" parameter but they seem like bad design. Are there any cases where you think ref is the right solution?It seems like you could always do something else that is cleaner. Can someone give me an example of where this would be the ""best"" solution for a problem? <code> ","In C#, where do you use ""ref"" in front of a parameter?"
Populate WinFrom TreeView from DataTable," I have a WinForm TreeView Control that displays the Parent Child relationship of CaseNotes(I know that means nothing to most of you but it helps me visualize the answers). I have a DataTable of the CaseNotes that I need to display. The Parent/Child is defined as: If the row has a ParentNoteID then it is a childNode of that note otherwise it is a rootNode. It could also be a parent note(but not a rootNode) if another row has it's ID as it's ParentNoteID.To complicate(maybe simplify) things I have the below working(mostly) code that colors the nodes alternatingly. I manually created a static collection for the treeview and it colors them fairly correctly. Now I need to dynamically populate the Nodes from my DataTable.Since I already am going thru the treeview node by node shouldn't I be able to append the data into this process somehow? Maybe I need to build the nodes first and then color as a separate routine but the Recursion Method would still apply, correct?Lets say I want to display CaseNoteID for each Node. That is returned in the DataTable and is unique. EDITMy thoughts/attempts so far: Obviously this is flawed. One it just display's ContactDate over and over. Granted it shows it the correct number of times but I would like the Value of ContactDate(which is a Column in the database and is being returned in the DataTable. Second I need to add the ChildNode Logic. A if (node.parentNode = node.CaseNoteID) blah...EDIT 2So I found this link, here, and it makes it seem like I need to get my DataTable into an ArrayList. Is that correct?EDIT 3Okay, thanks to Cerebus this is mostly working. I just have one more question. How do I take this--> and use my returned DataTable in this? Do I just replace this --> My confusion, I think, is do I still need to do the Column.Add and Row.Adds? Also how would the DataColumn translate to my real data structure? Sorry for the very ignorant questions, the good news is I never have to ask twice.EDIT 4The following is providing a runtime error. The error is as follows --> Cannot find column [ea8428e4] Which is the first 8 digits of the correct NoteID(I have to use a Guid). Should it be looking for a column of that name?? Because I am using a Guid is there something else I need to do? I changed all the references in mine and your code to Guid... <code>  foreach (TreeNode rootNode in tvwCaseNotes.Nodes) { ColorNodes(rootNode, Color.MediumVioletRed, Color.DodgerBlue); }protected void ColorNodes(TreeNode root, Color firstColor, Color secondColor) { root.ForeColor = root.Index % 2 == 0 ? firstColor : secondColor; foreach (TreeNode childNode in root.Nodes) { Color nextColor = childNode.ForeColor = childNode.Index % 2 == 0 ? firstColor : secondColor; if (childNode.Nodes.Count > 0) { // alternate colors for the next node if (nextColor == firstColor) ColorNodes(childNode, secondColor, firstColor); else ColorNodes(childNode, firstColor, secondColor); } } } public void BuildSummaryView() { tvwCaseNotes.Nodes.Clear(); DataTable cNotesForTree = CurrentCaseNote.GetAllCNotes(Program._CurrentPerson.PersonID); foreach (var cNote in cNotesForTree.Rows) { tvwCaseNotes.Nodes.Add(new TreeNode(""ContactDate"")); } FormPaint(); } DataTable cNotesForTree = CurrentCaseNote.GetAllCNotes(Program._CurrentPerson.PersonID); dt = new DataTable(""CaseNotes"");dt.Columns.Add(""NoteID"", typeof(string));dt.Columns.Add(""NoteName"", typeof(string));DataColumn dc = new DataColumn(""ParentNoteID"", typeof(string));dc.AllowDBNull = true;dt.Columns.Add(dc);// Add sample data.dt.Rows.Add(new string[] { ""1"", ""One"", null });dt.Rows.Add(new string[] { ""2"", ""Two"", ""1"" });dt.Rows.Add(new string[] { ""3"", ""Three"", ""2"" });dt.Rows.Add(new string[] { ""4"", ""Four"", null });dt.Rows.Add(new string[] { ""5"", ""Five"", ""4"" });dt.Rows.Add(new string[] { ""6"", ""Six"", null });dt.Rows.Add(new string[] { ""7"", ""Seven"", null });dt.Rows.Add(new string[] { ""8"", ""Eight"", ""7"" });dt.Rows.Add(new string[] { ""9"", ""Nine"", ""8"" }); if (nodeList.Find(FindNode) == null) { DataRow[] childRows = dt.Select(""ParentNoteID = "" + dr[""NoteID""]); if (childRows.Length > 0) { // Recursively call this function for all childRowsl TreeNode[] childNodes = RecurseRows(childRows); // Add all childnodes to this node. node.Nodes.AddRange(childNodes); } // Mark this noteID as dirty (already added). //doneNotes.Add(noteID); nodeList.Add(node); }",Populate WinForms TreeView from DataTable
Linq to Sql - return selected specified columns," I would like to select only few columns from a certain (Blobs) table. I have fields like: Id, RowVersion, Size, Signature, Blob, and I want to select only first four. I do it like this: (---> is an error place) Error occures when I am trying to return BlobDetails - as VS.08 doesn't know how to convert from Anonymous Type (allBlobs) to List. I do not want to select all values, because Blob field can be quite heavy and I don't want to send it all the time.Do you have any idea how to do it properly? <code>  public List<BlobDetails> GetAllBlobsNames() { RichTekstModelDataContext dc = new RichTekstModelDataContext(); var allBlobs = from b in dc.Blobs orderby b.RowVersion descending select new {b.Id, b.Size, b.Signature, b.RowVersion};---> allBlobs.ToList<BlobDetails>();}public class BlobDetails { public int Id { get; set; } public string Signature { get; set; } public int Size { get; set; } public System.Data.Linq.Binary RowVersion { get; set; } }",Return selected specified columns
Is there a way to take a C# class or library and automaticly convert it to Visio?, I have a C# class library that I need to document. Is there a way I can convert the project or class to a Visio Uml.I am using Visual Studios 2008 Professional. <code> ,Is there a way to take a C# class or library and automatically convert it to Visio?
Unit Testing Expresstion Trees," I recently need to build a Expression tree so I wrote a Test method like so... When I finally got the ""BuildForeignKeysContainsPredicate"" method working I could never get teh test to pass... Here is the method: But the test fails every time, I switched the line Assert.AreEqual(expected, actual);to this: Assert.AreEqual(expected.ToString(), actual.ToString()); I understand why it is failing because when you look at the results of the ToString method they are different. I just don't understand why... Does any one have general tips on unit testing expressions and suggestions how to get my specific test to pass?Thanks... <code>  /// <summary> /// /// </summary> [TestMethod()] [DeploymentItem(""WATrust.Shared.Infrastructure.dll"")] public void BuildForeignKeysContainsPredicate_shoud_build_contains_predicate() { RemoteEntityRefLoader_Accessor<ReferencedEntity> target = CreateRemoteEntityRefLoader_Accessor(); List<object> foreignKeys = new List<object>() { 1, 2, 3, 4 }; Expression<Func<ReferencedEntity, bool>> expected = (ReferencedEntity referencedEntity) => foreignKeys.Contains(referencedEntity.Id); Expression<Func<ReferencedEntity, bool>> actual; actual = target.BuildForeignKeysContainsPredicate(foreignKeys, ""Id""); Assert.AreEqual(expected.ToString(), actual.ToString()); } /// <summary> /// /// </summary> /// <param name=""foreignKeys""></param> /// <returns></returns> private Expression<Func<TReferencedEntity, bool>> BuildForeignKeysContainsPredicate(List<object> foreignKeys, string primaryKey) { Expression<Func<TReferencedEntity, bool>> result = default(Expression<Func<TReferencedEntity, bool>>); try { ParameterExpression entityParameter = Expression.Parameter(typeof(TReferencedEntity), ""referencedEntity""); ConstantExpression foreignKeysParameter = Expression.Constant(foreignKeys, typeof(List<object>)); MemberExpression memberExpression = Expression.Property(entityParameter, primaryKey); Expression convertExpression = Expression.Convert(memberExpression, typeof(object)); MethodCallExpression containsExpression = Expression.Call(foreignKeysParameter , ""Contains"", new Type[] { }, convertExpression); result = Expression.Lambda<Func<TReferencedEntity, bool>>(containsExpression, entityParameter); } catch (Exception ex) { throw ex; } return result; } Assert.AreEqual failed.Expected:<referencedEntity => value(Shared.Infrastructure.Test.RemoteEntityRefLoaderTest+<>c__DisplayClass13).foreignKeys.Contains(Convert(referencedEntity.Id))>.Actual :<referencedEntity => value(System.Collections.Generic.List`1[System.Object] ) .Contains(Convert(referencedEntity.Id))>.",Unit Testing Expression Trees
Properties in a WCF service," In the interface required to implement a WCF service, I declare the main class with the [ServiceContract()] attribute and any exposed method with [OperationContract()].How can i expose public properties? Thanks <code> ",Do WCF Services Expose Properties?
C# thread with multiple parameters," Does anyone know how to pass multiple parameters into a Thread.Start routine?I thought of extending the class, but the C# Thread class is sealed.Here is what I think the code would look like: BTW, I start a number of threads with different orchestrators, balances and ports. Please consider thread safety also. <code>  ... Thread standardTCPServerThread = new Thread(startSocketServerAsThread); standardServerThread.Start( orchestrator, initializeMemberBalance, arg, 60000);...}static void startSocketServerAsThread(ServiceOrchestrator orchestrator, List<int> memberBalances, string arg, int port){ startSocketServer(orchestrator, memberBalances, arg, port);}",thread with multiple parameters
How do I programmatically select a tab on a .NET CF 2.0 TabControl?," With the .NET Framework 2.0/3.5 TabControl, I can programmatically select a tab using the SelectedTab property as shown in the code below: The .NET Compact Framework TabControl doesn't have a SelectedTab property like its .NET Framework counterpart. So, how do I select a tab programmatically? <code>  //toggles between tabPage1 and tabPage2private void button1_Click(object sender, EventArgs e){ if (tabControl1.SelectedTab == tabPage1) tabControl1.SelectedTab = tabPage2; else tabControl1.SelectedTab = tabPage1;}",How do I programmatically select a tab on a .NET CF TabControl?
Programmatically apply / deactivate breakpoints in visual studio," Regardless of other options that may achieve the same result (i.e. adding breakpointsby hand), is it possible to programmatically add a breakpoint into the source code of a Visual Studio project?Such as: That way when you run in debug the next time, it will automatically have set breakpoints at all the points that caused trouble during the last run.I'm not saying that's a particularly useful way of debugging. I'm just wondering if the capability is there. <code>  try{ FunctionThatThrowsErrors(obj InscrutableParameters);}catch(Exception ex){ Log.LogTheError(ex); AddBreakPointToCallingFunction();}",Programmatically apply / deactivate breakpoints in Visual Studio
Set folder browser dialog start loaction," Is there any way to set the initial directory of a folder browser dialog to a non-special folder? This is what I'm currently using but I want to use a path I have stored in a string something like this This causes an error ""Cannot convert 'string' to 'System.Environment.SpecialFolder'"". <code>  fdbLocation.RootFolder = Environment.SpecialFolder.Desktop; fdbLocation.RootFolder = myFolder;",Set folder browser dialog start location
Injecting a custom UITypeEditor for all properties of a certain type, I want to avoid placing an EditorAttribute on every instance of a certain type that I've written a custom UITypeEditor for. I can't place an EditorAttribute on the type because I can't modify the source.I have a reference to the only PropertyGrid instance that will be used.Can I tell a PropertyGrid instance (or all instances) to use a custom UITypeEditor whenever it encounters a specific type?Here is an MSDN article that provides are starting point on how to do this in .NET 2.0 or greater.  <code> ,How do I inject a custom UITypeEditor for all properties of a closed-source type?
How do you programatically end a session in asp.net?, Session.Abandon() doesn't seem to do anything. You would expect the Session_end event to fire when Session.Abandon() is called. <code> ,How do you programmatically end a session in asp.net when Session.Abandon() doesn't work?
How do you programatically end a session in asp.net when Session.Abandon() doesn't work?, Session.Abandon() doesn't seem to do anything. You would expect the Session_end event to fire when Session.Abandon() is called. <code> ,How do you programmatically end a session in asp.net when Session.Abandon() doesn't work?
Total no of items defined in an enum, How can I get the number of items defined in an enum? <code> ,Total number of items defined in an enum
Working behind a proxy server," I need to add a functionality in an application (C#) which will use a web service (XML SOAP service).Now this application can (and mostly) be used in an corporate environment which has a proxy server in place.I understand the SOAP services use HTTP protocol and hence should use port 80, which is normally kept opened. Is it right that application can use web service without any special coding or I will need to write special code to detect proxy settings or some other issues you see?EDIT: Webservice is a publicly available service on internet. Its not on same network. <code> ",Calling a webservice from behind a proxy server
How to add resources in seperate folders?," When I try to add a resource at the resource designer by clicking ""Add an existing item"",the item is placed in the folder ""Resource"".The problem is that if I create a new directory in the Resource directory and place the resources there,I get a compiler error that the files cannot be found.I can't put all resources in one folder,because I have to add 2500 images and some of them match their names. <code> ",How to add resources in separate folders?
use vb.net and c#.net in same application," I am developing a GUI based application in MS Visual Studio 2005, I just want to know if it is possible to use both VB.NET and C# in the same project. Or can I include a module written in C# in my VB.NET project?I have a class written in C# which I want to use in my VB.NET based project, so if I can include and call functions from that project than I won't have to write the class again in VB.NET.So please help me as I am new to .NET programming.  <code> ",Use VB.NET and C# in the same application?
Setting credentials for a WCF applicaiton?," I've written a simple Application that utilizes WCF to communicate between client and server. When I run it locally it works fine, however when I run the server and client on two different boxes I get the following exception: What are the credentials that are not being accepted? And how can I set them?Is there a way to configure the server to not require authentication? The application is a simple monitoring app to security is not really an issue.Sorry about not being very specific:The app uses a pipe proxy and there is no wcf config file as the wcf code is hand coded.My WCF code is based on the code in this tutorial:http://www.switchonthecode.com/tutorials/wcf-tutorial-basic-interprocess-communicationI didn't konw it was standard proctice to generate the wcf classes from a config till after I'd finished writing all the code. Now whenever I look at a tutorial/ help doc they use generated code and everything requires changing the config.I don't have the bandwidth (I'm juggling 3 projects already) to replace my wcf component with one tht uses generated code but I will make sure to use the code generation next time I use wcf. <code>  Unexpected error occured, while getting the group names from the VDN serverSystem.ServiceModel.Security.SecurityNegotiationException: The server has rejected the client credentials.System.Security.Authentication.InvalidCredentialException: The server has rejected the client credentials.System.ComponentModel.Win32Exception: The logon attempt failed",Setting credentials for a WCF application?
Unable to cast object of type 'System.DBNull' to type 'System.String," I got the above error in my app. Here is the original code I replaced with Is there a better way around this? <code>  public string GetCustomerNumber(Guid id){ string accountNumber = (string)DBSqlHelperFactory.ExecuteScalar(connectionStringSplendidmyApp, CommandType.StoredProcedure, ""GetCustomerNumber"", new SqlParameter(""@id"", id)); return accountNumber.ToString(); } public string GetCustomerNumber(Guid id){ object accountNumber = (object)DBSqlHelperFactory.ExecuteScalar(connectionStringSplendidCRM, CommandType.StoredProcedure, ""spx_GetCustomerNumber"", new SqlParameter(""@id"", id)); if (accountNumber is System.DBNull) { return string.Empty; } else { return accountNumber.ToString(); }}",Unable to cast object of type 'System.DBNull' to type 'System.String`
"In WPF, how do I adjust the scroll increment for a FlowDocumentReader with ViewingMode set to Scroll?"," I'm displaying a FlowDocument in a FlowDocumentReader with the ViewingMode=""Scroll"". If I use the wheel on my mouse, the document scrolls very slowly. I'd like to increase the scroll step. I've tried to change the Scroll setting of my mouse in Control Panel, but that doesn't have any effect. I think that WPF ignores that setting for the FlowDocumentScrollViewer.I've added a Scroll event on the FlowDocument and FlowDocumentReader, but that doesn't fire when I use the mouse wheel.I've added a Loaded event on the FlowDocumentReader, got the ScrollViewer descendant, found the ScrollBar (""PART_VerticalScrollBar"") from the scroll viewer's template and adjusted the SmallChange & LargeChange properties. That also didn't have any effect.Anyone have any ideas? <code> ",Adjust FlowDocumentReader's Scroll Increment When ViewingMode Set to Scroll?
Exporting X.509 certificate WITHOUT private key (.NET C#)," I thought this would be straightforward but apparently it isn't. I have a certificate installed that has a private key, exportable, and I want to programmatically export it with the public key ONLY. In other words, I want a result equivalent to selecting ""Do not export the private key"" when exporting through certmgr and exporting to .CER.It seems that all of the X509Certificate2.Export methods will export the private key if it exists, as PKCS #12, which is the opposite of what I want.Is there any way using C# to accomplish this, or do I need to start digging into CAPICOM? <code> ",Exporting X.509 certificate WITHOUT private key
LINQ - how to convert query syntax to method syntax," I'm fooling around trying to learn the ins an outs of LINQ. I want to convert the following query (which is working correctly) from query syntax to method syntax, but I can't seem to get it right. Can anyone show me the correct way to accomplish that?  <code>  var logQuery = from entry in xDoc.Descendants(""logentry"") where (entry.Element(""author"").Value.ToLower().Contains(matchText) || entry.Element(""msg"").Value.ToLower().Contains(matchText) || entry.Element(""paths"").Value.ToLower().Contains(matchText) || entry.Element(""revision"").Value.ToLower().Contains(matchText)) select new { Revision = entry.Attribute(""revision"").Value, Author = entry.Element(""author"").Value, CR = LogFormatter.FormatCR(entry.Element(""msg"").Value), Date = LogFormatter.FormatDate(entry.Element(""date"").Value), Message = LogFormatter.FormatComment(entry.Element(""msg"").Value), ET = LogFormatter.FormatET(entry.Element(""msg"").Value), MergeFrom = LogFormatter.FormatMergeFrom(entry.Element(""msg"").Value), MergeTo = LogFormatter.FormatMergeTo(entry.Element(""msg"").Value) };",How to convert query syntax to method syntax
"C# 'ref' keyword, performance."," If you have a Bitmap object that needs to be passed to numerous methods (about 10), and finally to an event where it shall finally be disposed of after it's used, would it be (performance wise) beneficial to pass it to every one of those methods by reference instead of value?Passing by value, the object is copied, passing by reference its not.(Performance is critical in this situation. The application needs to run as fast as possible.) <code> ","C# 'ref' keyword, performance"
Condition Synchronization, Could someone explain condition synchronization to me?An example (preferably in C#) would be greatly appreciated also. <code> ,What is condition synchronization?
How to convert from System.Enum base integer?," I'd like to create a generic method for converting any System.Enum derived type to its corresponding integer value, without casting and preferably without parsing a string.Eg, what I want is something like this: But this doesn't appear to work. Resharper reports that you can not cast expression of type 'System.Enum' to type 'int'.Now I've come up with this solution but I'd rather have something more efficient. Any suggestions? <code>  // Trivial example, not actually what I'm doing.class Converter{ int ToInteger(System.Enum anEnum) { (int)anEnum; }} class Converter{ int ToInteger(System.Enum anEnum) { return int.Parse(anEnum.ToString(""d"")); }}",How to convert from System.Enum to base integer?
How to delete Cookies from windows.form Webbrowser control C#," I am working with the Webbrowser control on a windows.form application written in C#. I would like to write a method for deleting the cookies from the Webbrowers control after it visits a certain site. Unfortunately, I don't know how to do that exactly and haven't found a lot of help on the internet.If anyone has experience actually doing this, not just hypothetical because it might be trickier than it seems, I don't know. I would just assume something like the above code would work but I guess it won't. Can anyone shed some light on this whole cookie thing? <code>  int count = webBrowser2.Document.Cookie.Length;webBrowser2.Document.Cookie.Remove(0,count);",How to delete Cookies from windows.form?
"C#, Webbrowser control: How to delete Cookies from windows.form?"," I am working with the Webbrowser control on a windows.form application written in C#. I would like to write a method for deleting the cookies from the Webbrowers control after it visits a certain site. Unfortunately, I don't know how to do that exactly and haven't found a lot of help on the internet.If anyone has experience actually doing this, not just hypothetical because it might be trickier than it seems, I don't know. I would just assume something like the above code would work but I guess it won't. Can anyone shed some light on this whole cookie thing? <code>  int count = webBrowser2.Document.Cookie.Length;webBrowser2.Document.Cookie.Remove(0,count);",How to delete Cookies from windows.form?
Using C# 'using' statement with an custom object's function do I Need to implement IDisposable?," I have an sqlConnection manager class like so: If I use a function with the 'using' statement like: Does the using statement dispose of the connection automatically since conn.Connection() returns a SqlConnection object? Or, do I have to implement IDisposable and a custom Dispose method on the SqlConn class?Is this even a good way at all? I'm working with legacy code and I'm not able to use an ORM yet but is there a way to simplify this existing pattern to manage/create SQL connections? <code>  public class SQLConn { public string connStr = System.Configuration.ConfigurationSettings.AppSettings[""ConnectionString""]; private SqlConnection sqlConn; public SqlConnection Connection() { sqlConn = new SqlConnection(connStr); return sqlConn; } public void Open() { sqlConn .Open(); }} var conn = new SQLConn();using (conn.Connection()) { String query = ""Select * from table""; objSql = new SqlCommand(query, conn.Connection()); conn.Open(); DoSomething(); }","Using C#'s 'using' statement with a custom object's function, do I Need to implement IDisposable?"
Why does DateTime.Now.ToString(," I am currently in British summer time which is UTC +1 Hour. I confirmed my PC is correct with the following code and it returns true. My question is then why does the UTC formatter not work as I would expect: It returns the exact current system date as below in UTC format as expected but with the Z (Zulu Time) at the end not +01:00?i.e. not Is this correct functionality? <code>  System.TimeZone.CurrentTimeZone.IsDaylightSavingTime(Date.Now) DateTime.Now.ToString(""u"") 2009-05-27 14:21:22Z 2009-05-27 14:21:22+01:00","Why does DateTime.Now.ToString(""u"") not work?"
Correct useage of OnClick vs. MouseClick events in Winforms using C#," I'm currently developing a custom control and realize that my code is being run twice. It is not really a huge issue (it is only a Focus method call). However, I would like to understand it.From reading the MSDN description for click | onclick event, it states that: Fires when the user clicks the left mouse button on the object. So I added the OnClick event and the MouseClick events to handle both left and right clicking. But after debugging the code I found that the OnClick handles both left and right click events. Why is OnClick handling both and do I need to keep both events in my code for some reason I'm overlooking? <code>  protected override void OnClick(EventArgs e){ this.Focus(); base.OnClick(e);}private void CustomControl_MouseClick(object sender, MouseEventArgs e){ if (e.Button == MouseButtons.Right) { rightClickMenu(e); }}",Correct usage of OnClick vs. MouseClick events in Windows Forms applications using C#
How can I add a type constraint to include anything serializable in a generic method," My generic method needs to serialize the object passed to it, however just insisting that it implements ISerializable doesn't seem to work. For example, I have a struct returned from a web service (marked with SerializableAttribute) that serializes to xml just fine, but, as expected, the C# compiler complains.Is there a way I can check the object is serializable before attempting to serialize it, or, better still, a way of using the where keyword to check the object is suitable?Here's my full method: And SerializeMessage: If this isn't possible, what's the best way to perform a check that an object is serializable at runtime? <code>  public static void Push<T>(string url, T message) where T : ISerializable{ string xml = SerializeMessage(message); // Send the message to Amazon SQS SendMessageRequest sendReq = new SendMessageRequest { QueueUrl = url, MessageBody = xml }; AmazonSQSClient client = new AmazonSQSClient(S3User, S3Pass); client.SendMessage(sendReq);} private static string SerializeMessage<T>(T message){ XmlSerializer xmlSerializer = new XmlSerializer(typeof(T)); using (StringWriter stringWriter = new StringWriter()) { xmlSerializer.Serialize(stringWriter, message); return stringWriter.ToString(); }}",How can I add a type constraint to include anything serializable in a generic method?
Howto create a System.Linq.Expressions.Expression for Like," I created a filterable BindingList from this source. It works great: does what it should. The internals work like a parser, that converts the expression == or != into System.Linq.Expressions.Expression. In this case, == becomes System.Linq.Expressions.Expression.Equal.Unfortunately System.Linq.Expressions.Expression does not contain a like operator and I don't know how to solve this.The initial code looks like this: Then I created an expression that will do what I want: e.g. But binaryOpFactory requires this: The predefined expressions seem to be exactly that: Can anyone tell me how to convert my expression? <code>  list.Filter(""Customer == 'Name'""); private static Dictionary<String, Func<Expression, Expression, Expression>> binaryOpFactory = new Dictionary<String, Func<Expression, Expression, Expression>>();static Init() { binaryOpFactory.Add(""=="", Expression.Equal); binaryOpFactory.Add("">"", Expression.GreaterThan); binaryOpFactory.Add(""<"", Expression.LessThan); binaryOpFactory.Add("">="", Expression.GreaterThanOrEqual); binaryOpFactory.Add(""<="", Expression.LessThanOrEqual); binaryOpFactory.Add(""!="", Expression.NotEqual); binaryOpFactory.Add(""&&"", Expression.And); binaryOpFactory.Add(""||"", Expression.Or);} private static System.Linq.Expressions.Expression<Func<String, String, bool>> Like_Lambda = (item, search) => item.ToLower().Contains(search.ToLower());private static Func<String, String, bool> Like = Like_Lambda.Compile(); Console.WriteLine(like(""McDonalds"", ""donAld"")); // trueConsole.WriteLine(like(""McDonalds"", ""King"")); // false Func<Expression, Expression, Expression> System.Linq.Expressions.Expression.Or;",How to create a System.Linq.Expressions.Expression for Like?
Simple c# XML Deserialization, How can I transform the following XML into a List<string> or String[]: <code>  <Ids> <id>1</id> <id>2</id></Ids>,How can I transform XML into a List<string> or String[]?
C# Constructor Design," I have a class which you pass in a folder and then it goes off and processes a lot of data within the specified folder.For instance: Now it goes off and reads say a couple of thousand files and populates the class with data.Should I move this data out from the constructor and have it as a separate method, such as the following? <code>  MyClass myClass = new MyClass(@""C:\temp""); MyClass myClass = new MyClass();myClass.LoadFromDirectory(@""C:\temp"");",C# constructor design
Func without any parameters?, This may sound like a bit of a dumb question but how do I make a Func<> variable that doesn't return anything? <code> ,Func not returning anything?
Problem rendering UserControl using Server.Execute()," Can anyone explain to why Server.Execute() is requiring my rendered UserControls to contain <form> tags (or alternately, what I am doing wrong that is making Server.Execute() require form tags in my UserControls)?I have created an ASMX service to dynamically load UserControls via JQuery+JSON as follows:ControlService.asmx ControlService.cs I load the control into a page via the following bit of JQuery which replaces a with the id ContentPlaceholder with the HTML returned from the service:JQueryControlLoadExample.aspx This works with one huge caveat. If I don't define a form inside the .ascx control's markup then HttpContext.Current.Server.Execute() throws an HttpException with the following message:Control 'hdnspecialoffer' of type 'HiddenField' must be placed inside a form tag with runat=server.SimpleControl.ascx When I added a form tag to the ascx control to work around this, the form would render, but the renderer rewrites the form tag in the control so that it POSTs back to the ASMX service instead of the form defined in the aspx page.I googled around and discovered Scott Guthrie's excellent ViewManager example. I don't see anything fundamentally different from what he did there, which leads me to believe that what I am doing ought to work.  <code>  <%@ WebService Language=""C#"" CodeBehind=""ControlService.asmx.cs"" Class=""ManagementConcepts.WebServices.ControlService"" %> [WebService(Namespace = ""http://tempuri.org/"")][WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)][System.Web.Script.Services.ScriptService]public class ControlService : System.Web.Services.WebService{ private string GetControl(String controlName, String ClassId) { Page page = new Page(); UserControl ctl = (UserControl)page.LoadControl(controlName); page.Controls.Add(ctl); StringWriter writer = new StringWriter(); HttpContext.Current.Server.Execute(page, writer, false); return writer.ToString(); } [WebMethod] [ScriptMethod(ResponseFormat = ResponseFormat.Json)] public string GetSimpleControl(string ClassId) { return GetControl(""SimpleControl.ascx"", ClassId); }} <%@ Page Language=""C#"" AutoEventWireup=""true"" CodeBehind=""JQueryControlLoadExample.aspx.cs"" Inherits=""ControlService_Prototype._Default"" %><!DOCTYPE html PUBLIC ""-//W3C//DTD XHTML 1.0 Transitional//EN"" ""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd""><html xmlns=""http://www.w3.org/1999/xhtml"" ><head runat=""server""> <title>ControlService Prototype</title></head><body> <form id=""theForm"" runat=""server"" action=""JQueryControlLoadExample.aspx""> <asp:ScriptManager ID=""ScriptManager1"" runat=""server"" EnablePageMethods=""true"" > <Scripts> <asp:ScriptReference NotifyScriptLoaded=""true"" Path=""~/Scripts/jquery-1.3.2.js"" /> </Scripts> </asp:ScriptManager> <div> <asp:HiddenField runat=""server"" ID=""hdncourse""/> <asp:HiddenField runat=""server"" ID=""hdnTargetContent"" Value=""GetSimpleControl""/> <div runat=""server"" id=""ContentPlaceholder"" class=""loading""></div> </div> <script type=""text/javascript""> $(document).ready(function() { var servicemethod = document.getElementById(""hdnTargetContent"").value; $.ajax({ type: ""POST"", url: ""ControlService.asmx/"" + servicemethod, data: ""{'ClassId':'""+document.getElementById(""hdncourse"").value+""'}"", contentType: ""application/json; charset=utf-8"", dataType: ""json"", success: function(msg) { $('#ContentPlaceholder').html(msg.d); } }); }); </script> </form></body></html> <%@ Control Language=""C#"" AutoEventWireup=""true"" CodeBehind=""SimpleControl.ascx.cs"" Inherits=""ControlService_Prototype.UserControls.SimpleControl"" %> <asp:HiddenField runat=""server"" ID=""hdnspecialoffer""/>",Issues rendering UserControl using Server.Execute() in an ASMX web service
C# Dictionary as a Property," Can someone point me out to some C# code examples or provide some code, where a Dictionary has been used as a property for a Class.The examples I have seen so far don't cover all the aspects viz how to declare the dictionary as property, add, remove, and retrieve the elements from the dictionary. <code> ",.NET Dictionary as a Property
TransactionInDoubtException using LTM on SQL Server 2005 ," The underlying question to this post is ""Why would a non-promoted LTM Transaction ever be in doubt?"" I'm getting System.Transactions.TransactionInDoubtException and i can't explain why. Unfortunately i cannot reproduce this issue but according to trace files it does happen. I am using SQL 2005, connecting to one database and using one SQLConnection so i don't expect promotion to take place. The error message indicates a timeout. However, sometimes I get a timeout message but the exception is that the transaction has aborted as opposed to in doubt, which is much easier to handle.Here is the full stack trace: Any ideas? Why am i getting in doubpt and what should i do when i get it?EDIT for more informationI actually still don't have the answer for this. What I did realize is that the transaction actually partially commits. One table gets the insert but the other does not get the update. The code is HEAVILY traced and there is not much room for me to be missing something. Is there a way I can easily find out if the transaction has been promoted. Can we tell from the stack trace if it is? SIngle Phase commit (which is in the strack trace) seems to indicate no promotion to me, but maybe i'm missing something. If its not getting promoted then how can it be in doubt. Another interesting piece to the puzzle is that i create a clone of the current transaction. I do that as a workarround to this issue. http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=914869&SiteID=1Unfortunately, i don't know if this issue has been resolved. Maybe creating the clone is causing a problem. Here is the relevant code Thanks <code>  System.Transactions.TransactionInDoubtException: The transaction is in doubt. ---> System.Data.SqlClient.SqlException: Timeout expired. The timeout period elapsed prior to completion of the operation or the server is not responding. at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection) at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj) at System.Data.SqlClient.TdsParserStateObject.ReadSniError(TdsParserStateObject stateObj, UInt32 error) at System.Data.SqlClient.TdsParserStateObject.ReadSni(DbAsyncResult asyncResult, TdsParserStateObject stateObj) at System.Data.SqlClient.TdsParserStateObject.ReadNetworkPacket() at System.Data.SqlClient.TdsParserStateObject.ReadBuffer() at System.Data.SqlClient.TdsParserStateObject.ReadByte() at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) at System.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest) at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransactionYukon(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest) at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest) at System.Data.SqlClient.SqlDelegatedTransaction.SinglePhaseCommit(SinglePhaseEnlistment enlistment) --- End of inner exception stack trace --- at System.Transactions.TransactionStateInDoubt.EndCommit(InternalTransaction tx) at System.Transactions.CommittableTransaction.Commit() at System.Transactions.TransactionScope.InternalDispose() at System.Transactions.TransactionScope.Dispose() using (TransactionScope ts = new TransactionScope()){ transactionCreated = true; //part of the workarround for microsoft defect mentioned in the beginning of this class Transaction txClone = Transaction.Current.Clone(); transactions[txClone] = txClone; Transaction.Current.TransactionCompleted += new TransactionCompletedEventHandler(TransactionCompleted); MyTrace.WriteLine(""Transaction clone stored and attached to event""); m_dataProvider.PersistPackage(ControllerID, package); MyTrace.WriteLine(""Package persisted""); m_dataProvider.PersistTransmissionControllerStatus(this); MyTrace.WriteLine(""Transmission controlled updated""); ts.Complete();}",TransactionInDoubtException using System.Transactions on SQL Server 2005 
Medium Trust Unit Test Context," I would like to write automated tests that run in medium trust and fail if they require full trust. I am writing a library where some functionality is only available in full trust scenarios and I want to verify that the code I wish to run in medium trust will work fine. If also want to know that if I change a class that requires full trust, that my tests will fail.I have tried creating another AppDomain and loading the medium trust PolicyLevel, but I always get an error with assembly or its dependency could not be loaded while trying to run the cross AppDomain callback.Is there a way to pull this off?UPDATE: Based replies, here is what I have. Note that your class being tested must extend MarshalByRefObject. This is very limiting, but I don't see a way around it. <code>  using System;using System.Reflection;using System.Security;using System.Security.Permissions;using Xunit;namespace PartialTrustTest{ [Serializable] public class ClassUnderTest : MarshalByRefObject { public void PartialTrustSuccess() { Console.WriteLine( ""partial trust success #1"" ); } public void PartialTrustFailure() { FieldInfo fi = typeof (Int32).GetField( ""m_value"", BindingFlags.Instance | BindingFlags.NonPublic ); object value = fi.GetValue( 1 ); Console.WriteLine( ""value: {0}"", value ); } } public class Test { [Fact] public void MediumTrustWithExternalClass() { // ClassUnderTest must extend MarshalByRefObject var classUnderTest = MediumTrustContext.Create<ClassUnderTest>(); classUnderTest.PartialTrustSuccess(); Assert.Throws<FieldAccessException>( classUnderTest.PartialTrustFailure ); } } internal static class MediumTrustContext { public static T Create<T>() { AppDomain appDomain = CreatePartialTrustDomain(); var t = (T) appDomain.CreateInstanceAndUnwrap( typeof (T).Assembly.FullName, typeof (T).FullName ); return t; } public static AppDomain CreatePartialTrustDomain() { var setup = new AppDomainSetup {ApplicationBase = AppDomain.CurrentDomain.BaseDirectory}; var permissions = new PermissionSet( null ); permissions.AddPermission( new SecurityPermission( SecurityPermissionFlag.Execution ) ); permissions.AddPermission( new ReflectionPermission( ReflectionPermissionFlag.RestrictedMemberAccess ) ); return AppDomain.CreateDomain( ""Partial Trust AppDomain: "" + DateTime.Now.Ticks, null, setup, permissions ); } }}",How to Automate Testing of Medium Trust Code
What C# collection provides the fastest search," I have 60k items that need to be checked against a 20k lookup list. Is there a collection object (like List, HashTable) that provides an exceptionly fast Contains() method? Or will I have to write my own? In otherwords, is the default Contains() method just scan each item or does it use a better search algorithm. Note. The lookup list is already sorted. <code>  foreach (Record item in LargeCollection){ if (LookupCollection.Contains(item.Key)) { // Do something }}",What .NET collection provides the fastest search
What is diff Between Ref And OUt??," Possible Duplicate: Whats the difference between the 'ref' and 'out' keywords? What is the difference between ref and out? I am confused about when to use ref and out. So please explain how to use ref and out, and in which situations. <code> ",What is diff Between Ref And Out??
URL split? in C#?, I have a url like example.com/page?a=1&ret=/user/page2. I was using string.split('/') to figure out the paths but this case you can see it isn't very useful. How do i split the URL so i can get the page path? <code> ,URL split in C#?
Need Help understanding Interfaces," I am still having trouble understanding what interfaces are good for. I read a few tutorials and I still don't know what they really are for other then ""they make your classes keep promises"" and ""they help with multiple inheritance"".Thats about it. I still don't know when I would even use an interface in a real work example or even when to identify when to use it.From my limited knowledge of interfaces they can help because if something implements it then you can just pass the interface in allowing to pass in like different classes without worrying about it not being the right parameter.But I never know what the real point of this since they usually stop short at this point from showing what the code would do after it passes the interface and if they sort of do it it seems like they don't do anything useful that I could look at and go ""wow they would help in a real world example"".So what I guess I am saying is I am trying to find a real world example where I can see interfaces in action.I also don't understand that you can do like a reference to an object like this: So now if I would go myInterface dot and intellisense would pull up I would only see the interface methods and not the other methods in JustSomeClass. So I don't see a point to this yet.Also I started to do unit testing where they seem to love to use interfaces but I still don't understand why.Like for instance this example: Like why bother making this interface? Why not just make FormsAuthenticationWrapper with the methods in it and call it a day? Why First make an interface then have the Wrapper implement the interface and then finally write the methods?Then I don't get what the statement is really saying.Like I now know that the statement is saying this if formsAuth is null then make a new FormsAuthenticationWrapper and then assign it to the property that is an Interface.I guess it goes back to the whole point of why the reference thing. Especially in this case since all the methods are exactly the same. The Wrapper does not have any new methods that the interface does not have and I am not sure but when you do this the methods are filled right(ie they have a body) they don't get converted to stubs because that would really seem pointless to me(it it would be converted back to an interface).Then in the testing file they have: So they just pass in the FormsAuthentication what I am guessing makes all the fake stubs. I am guessing the wrapper class is used when the program is actually running since it has real methods that do something(like sign a person out).But looking at new Mock(from moq) it accepts a class or an interface. Why not just again made the wrapper class put those methods in and then in the new Mock call that?Would that not just make the stubs for you? <code>  ICalculator myInterface = new JustSomeClass(); public AuthenticationController(IFormsAuthentication formsAuth){ FormsAuth = formsAuth ?? new FormsAuthenticationWrapper();}public class FormsAuthenticationWrapper : IFormsAuthentication{ public void SetAuthCookie(string userName, bool createPersistentCookie) { FormsAuthentication.SetAuthCookie(userName, createPersistentCookie); } public void SignOut() { FormsAuthentication.SignOut(); }}public IFormsAuthentication FormsAuth{ get; set;} FormsAuth = formsAuth ?? new FormsAuthenticationWrapper(); var formsAuthenticationMock = new Mock<AuthenticationController.IFormsAuthentication>();",Understanding Interfaces
Add Business Days and GetBusinessDays," I need to find 2 elegant complete implementations of O(1) preferable (no loops).EDIT: By business days i mean working days (Monday, Tuesday, Wednesday, Thursday, Friday). No holidays, just weekends excluded. I already have some ugly solutions that seem to work but i wonder if there are elegant ways to do this. ThanksThis is what i've written so far. It works in all cases and does negatives too.Still need a GetBusinessDays implementation <code>  public static DateTime AddBusinessDays(this DateTime date, int days){ // code here}and public static int GetBusinessDays(this DateTime start, DateTime end){ // code here} public static DateTime AddBusinessDays(this DateTime startDate, int businessDays){ int direction = Math.Sign(businessDays); if(direction == 1) { if(startDate.DayOfWeek == DayOfWeek.Saturday) { startDate = startDate.AddDays(2); businessDays = businessDays - 1; } else if(startDate.DayOfWeek == DayOfWeek.Sunday) { startDate = startDate.AddDays(1); businessDays = businessDays - 1; } } else { if(startDate.DayOfWeek == DayOfWeek.Saturday) { startDate = startDate.AddDays(-1); businessDays = businessDays + 1; } else if(startDate.DayOfWeek == DayOfWeek.Sunday) { startDate = startDate.AddDays(-2); businessDays = businessDays + 1; } } int initialDayOfWeek = (int)startDate.DayOfWeek; int weeksBase = Math.Abs(businessDays / 5); int addDays = Math.Abs(businessDays % 5); if((direction == 1 && addDays + initialDayOfWeek > 5) || (direction == -1 && addDays >= initialDayOfWeek)) { addDays += 2; } int totalDays = (weeksBase * 7) + addDays; return startDate.AddDays(totalDays * direction);}",AddBusinessDays and GetBusinessDays
Does Console.WriteLine(ex.Message) have performance cost?," We usually catch exception in the upper level of a code like the GUI (forms).But I usually have this kind of code I could just catch(Exception) without the identifier because I do not need the message on runtime, but for the debugging build, it sure is convenient to break at the catch statement. So I usually write a Console.WriteLine to prevent a lot of warning of unused ex variable. I have a lot of case of Console.WriteLine(ex.Message) in my code. Does this cost performance decrease?Note: Changed title from ""Does Console.WriteLine(ex.Message) have performance cost?"" to ""Calling Console.WriteLine(ex.Message) to prevent warning message"" <code>  try{}catch(Exception ex){ Console.WriteLine(ex.Message); MessageBox.Show(""Application has encountered error...."");}",Calling Console.WriteLine(ex.Message) to prevent warning message
SharpSVN read filenames," still a bit of a n00b on SharpSVN, I'm looking to get some simple code to open up an SVN repository, and read (at least) the full path of all files in a specific folder.Lets say that this folder is \trunk\sourceI'm not looking to checkout or commit, just read into a listI'm also looking to read ALL files, not just the changed ones. <code> ",SharpSVN read ALL filenames
WPF ListView Programmatically Select Item," I'm unable to figure out how to select an item programmatically in a ListView.I'm attempting to use the listview's ItemContainerGenerator, but it just doesn't seem to work. For example, obj is null after the following operation: I've tried (based on suggestions seen here and other places) to use the ItemContainerGenerator's StatusChanged event, but to no avail. The event never fires. For example: The crux of this whole thing is that I simply want to pre-select a few of the items in my ListView. In the interest of not leaving anything out, the ListView uses some templating and Drag/Drop functionality, so I'm including the XAML here. Essentially, this template makes each item a textbox with some text - and when any item is selected, the checkbox is checked. And each item also gets a little glyph underneath it to insert new items (and this all works fine): So what am I missing? How do I programmatically select one or more of the items in the ListView? <code>  //VariableList is derived from BindingListm_VariableList = getVariableList();lstVariable_Selected.ItemsSource = m_VariableList;var obj = lstVariable_Selected.ItemContainerGenerator.ContainerFromItem(m_VariableList[0]); m_VariableList = getVariableList();lstVariable_Selected.ItemContainerGenerator.StatusChanged += new EventHandler(ItemContainerGenerator_StatusChanged);lstVariable_Selected.ItemsSource = m_VariableList;...void ItemContainerGenerator_StatusChanged(object sender, EventArgs e){ //This code never gets called var obj = lstVariable_Selected.ItemContainerGenerator.ContainerFromItem(m_VariableList[0]);} <DataTemplate x:Key=""ItemDataTemplate_Variable""><StackPanel> <CheckBox x:Name=""checkbox"" Content=""{Binding Path=ListBoxDisplayName}"" IsChecked=""{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListViewItem}}, Path=IsSelected}"" /> <Image ToolTip=""Insert Custom Variable"" Source=""..\..\Resources\Arrow_Right.gif"" HorizontalAlignment=""Left"" MouseLeftButtonDown=""OnInsertCustomVariable"" Cursor=""Hand"" Margin=""1, 0, 0, 2"" Uid=""{Binding Path=CmiOrder}"" /></StackPanel></DataTemplate>...<ListView Name=""lstVariable_All"" MinWidth=""300"" Margin=""5"" SelectionMode=""Multiple"" ItemTemplate=""{StaticResource ItemDataTemplate_Variable}"" SelectionChanged=""lstVariable_All_SelectionChanged"" wpfui:DragDropHelper.IsDropTarget=""True"" wpfui:DragDropHelper.IsDragSource=""True"" wpfui:DragDropHelper.DragDropTemplate=""{StaticResource ItemDataTemplate_Variable}"" wpfui:DragDropHelper.ItemDropped=""OnItemDropped""/>",Select item programmatically in WPF ListView
Learning  python for a .NET developer," I have been doing active development in C# for several years now. I primarily build enterprise application and in house frameworks on the .NET stack.I've never had the need to use any other mainstream high level languages besides C# for my tasks, since .NET is the standard platform we use.There are some legacy Python applications that I have been asked to support going forward, I have no exposure to python and dynamic languages in general(although I've done a fair bit of JavaScript).I was hoping to get some guidance/advise to aid in how to go about learning a language like python for the statically typed mind.EDIT: Using IronPython is not an option! <code> ",Learning  Python for a .NET developer
C# modify List.Contains behavior," I have a List<MyObj> with the class MyObj : IComparable. I wrote the method CompareTo in the MyObj class per the IComparable interface, but when I use the List<MyObj>.Contains(myObjInstance) it returns false when it should be true. I'm not sure I'm understanding how I need to proceed to make sure the List uses my custom comparison method when calling then Contains function.Here is my compareTo implementation: Note the Symbol property is a string.To clarify I've put a stopping point in that compareTo method and it doesn't even go in there. Anyone has ever tried that?Thanks. <code>  #region IComparable Members public int CompareTo(object obj) { MyObj myObj = (MyObj)obj; return String.Compare(this.Symbol, myObj.Symbol, true); } #endregion",Modify List.Contains behavior
Basic Doubts..," I have a very basic question. When we compile a VS 2005 C# application, it creates two folders. One is a bin folder and another one is an obj folder. Does anyone know why it creates an obj folder? I tried to find out the docs for it but I could not find it... <code> ",Two folders : Bin and Obj....Does anyone know why...?
"c# supports value types and reference types, but are they all objects?"," I know C# has both value and reference types, but how can you do a this: If age is a value type, how does it have a ToString method on it? Does it get converted to an object ONLY when required internally then? <code>  int age = 100;string blah = age.ToString();","C# supports value types and reference types, but are they all objects?"
C# - setting a property by reflection with a string value," I'd like to set a property of an object through Reflection, with a value of type string.So, for instance, suppose I have a Ship class, with a property of Latitude, which is a double.Here's what I'd like to do: As is, this throws an ArgumentException: Object of type 'System.String' cannot be converted to type 'System.Double'.How can I convert value to the proper type, based on propertyInfo? <code>  Ship ship = new Ship();string value = ""5.5"";PropertyInfo propertyInfo = ship.GetType().GetProperty(""Latitude"");propertyInfo.SetValue(ship, value, null);",Setting a property by reflection with a string value
How to convert DateTime? to DateTime?," I want to convert a nullable DateTime (DateTime?) to a DateTime, but I am getting an error: Cannot implicitly convert type 'System.DateTime?' to 'System.DateTime'. An explicit conversion exists (are you missing a cast?)I have attempted the following: <code>  DateTime UpdatedTime = (DateTime)_objHotelPackageOrder.UpdatedDate == null ? DateTime.Now : _objHotelPackageOrder.UpdatedDate;",How to convert nulalble<DateTime> to DateTime
How to convert DateTime? to DateTime," I want to convert a nullable DateTime (DateTime?) to a DateTime, but I am getting an error: Cannot implicitly convert type 'System.DateTime?' to 'System.DateTime'. An explicit conversion exists (are you missing a cast?)I have attempted the following: <code>  DateTime UpdatedTime = (DateTime)_objHotelPackageOrder.UpdatedDate == null ? DateTime.Now : _objHotelPackageOrder.UpdatedDate;",How to convert nulalble<DateTime> to DateTime
C# - How to detect the currently pressed key?," In Windows Forms, you can know, at any time, the current position of the cursor thanks to the Cursors class.The same thing doesn't seem to be available for the keyboard. Is it possible to know if, for example, the Shift key is pressed?Is it absolutely necessary to track down every keyboard notification (KeyDown and KeyUp events)? <code> ",How to detect the currently pressed key?
Tables and charts using PDFSharp," I just started with a project that requires me to write to PDF file. After some googling I decided on using PDFsharp which looks simple enough, however I have a few questions regarding drawing tables and charts.Is PDFsharp a good choice for writing PDF files that contain tables and charts? If no, can you recommend a better alternative? If yes, where could I find some good literature on the subject? A tutorial would be nice (doesn't have to be a sample project, just something I can use to familiarise myself with the library and its classes).Can anyone tell me what MigraDoc is all about? I just took a glimpse and it seems perfect for what I need, however I would like some more information about it. <code> ",Tables and charts using PDFsharp
How to put an interface constraint on a generic method in c# 3.5?," I want to achieve something like this in C# 3.5: I can do it with class or struct, but how to do it with an interface? <code>  public void Register<T>() : where T : interface {}",How to put an interface constraint on a generic method in C# 3.5?
How do I progromatically save an image from a URL?," How do I programmatically save an image from a URL? I am using C# and need to be able grab images from a URL and store them locally. ...and no, I am not stealing :)  <code> ",How do I programmatically save an image from a URL?
How do I programatically save an image from a URL?," How do I programmatically save an image from a URL? I am using C# and need to be able grab images from a URL and store them locally. ...and no, I am not stealing :)  <code> ",How do I programmatically save an image from a URL?
How to dinamically call a class' method in .NET?," How to pass a class and a method name as strings and invoke that class' method?Like Thanks <code>  void caller(string myclass, string mymethod){ // call myclass.mymethod();}",How to dynamically call a class' method in .NET?
Format XML String to Print Friendly XML String," I have an XML string as such: There are no lines between one element and another, and thus is very difficult to read. I want a function that formats the above string: Without resorting to manually write the format function myself, is there any .Net library or code snippet that I can use offhand? <code>  <?xml version='1.0'?><response><error code='1'> Success</error></response> <?xml version='1.0'?><response><error code='1'> Success</error></response> ",Format XML string to print friendly XML string
Linq: What is the difference between == and equals?, I always wondered why there's an equals keyword in linq joins rather than using the == operator. Instead of [EDIT] Rephrased the question and revised the examples. <code>  Property deadline =(from p in properties join w in widgets on p.WidgetID equals w.ID select p).First(); Property deadline =(from p in properties join w in widgets on p.WidgetID == w.ID select p).First();,Linq: What is the difference between == and equals in a join?
C# DataTemplate and Binding," I continue my understanding of MVVC with the code of MSDN and I have a question.In the .xaml they have a list of commands displayed to the screen. From here, I understand that the DataContext is set (not shown here) and it will display the collection of Commands. What I do not understand is the CommandsTemplate that you can see below: How does the binding is created? How this code tell to check the property Command and DisplayName from the object inside the collection? Is it from the ItemsSource? If yes, I do not understand why it's only at {Binding}. Anyone can explain me please how the DataTemplate binding work from a ContentTemplate? <code>  <Border Grid.Column=""0"" Style=""{StaticResource MainBorderStyle}"" Width=""170"" > <HeaderedContentControl Content=""{Binding Path=Commands}"" ContentTemplate=""{StaticResource CommandsTemplate}"" Header=""Control Panel"" Style=""{StaticResource MainHCCStyle}"" /> </Border> <DataTemplate x:Key=""CommandsTemplate""><ItemsControl IsTabStop=""False"" ItemsSource=""{Binding}"" Margin=""6,2""> <ItemsControl.ItemTemplate> <DataTemplate> <TextBlock Margin=""2,6"">pou <Hyperlink Command=""{Binding Path=Command}""> <TextBlock Text=""{Binding Path=DisplayName}"" /> </Hyperlink> </TextBlock> </DataTemplate> </ItemsControl.ItemTemplate></ItemsControl></DataTemplate>",WPF DataTemplate and Binding
How to debug a referenced dll," I have two solutions in my workspace, say A and B.Solution A is an older project which I finished coding some time ago.In solution B, I need to use some classes from Solution A. To do so, I add a reference to the dll of one of the projects in solution A.The problem is when I try to debug. I want to be able to step into A's code as well. Visual studio is not able to load the code for these classes (""There is no source code available for the current location."") and I can only view the disassembly, which is not useful.The only way I know to debug classes from solution A is by running solution B, detach all processes (in the Debug menu item) and attach the process from solution A.However, this is very inconvenient and I can only debug A OR B at once.Is there a way to allow stepping into the code of referenced dlls (for which I do have the source code)?Solution: My mistake was that I thought that a project can only be part of a single solution. In fact, a project can be part of any number of solutions.When you need to reference the old project, you should simply add the project to the solution. This is done by right clicking the new solution in the Solution Explorer > Add > Existing Project.Then, you'll be able to add the project reference. As others wrote, you should probably completely avoid using dll references to your own code (or other code you might need to change and debug).A very good reference to how solutions should be designed can be found in MSDN. <code> ",How to debug a referenced dll (having pdb)
ASP.Net : DataPager Control always a step behind," Take the following example...a page with a ListView and a DataPager used for paging the data of the ListView:Code Behind: Source: The problem with the DataPager is that it is always a step-behind with the binding.For example, when the page loads it's on page number 1. Then when you click on page 3, it stays on page 1 after the postback. Then you click on page 5, and after the postback it finds itself on page 3...and after that you click on page 6, and it finds itself on page 5...and so on and so forth.Why isn't the paging working as expected? <code>  protected void Page_Load(object sender, EventArgs e){ MyList.DataSource = GetSomeList(); MyList.DataBind();} <asp:ListView ID=""MyList"" runat=""server""> <% //LayoutTemplate and ItemTemplate removed for the example %></asp:ListView><asp:DataPager ID=""ListPager"" PagedControlID=""MyList"" runat=""server"" PageSize=""10""> <Fields> <asp:NumericPagerField /> </Fields></asp:DataPager>",ASP.Net : DataPager Control always a step behind with paging
.NET DateTimeFormatInfo to Javascript jQuery formatDate," I hava a jQuery UI datepicker which I intend to use with a textbox in ASP.NET MVC. The date-display in the textbox is localized via CultureInfo and of course should be recognized by jquery to select the correct date in the datepicker: What I am trying to do now is to initialize the datepicker with a dateformat like The Problem is that the format of the format string of DateTimeFormatInfo (see MSDN Link)is completely different to the format string in jQuery (jQuery formatDate).https://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.aspxSample (German date format like 16.07.2009): Is there a method or a library that does the needed transformation between the two formats? <code>  <%= Html.TextBox(""Date"", Model.Date.ToString(""d"", currentCultureInfo), new { @class = ""datepicker"" })%> string jsCode = @""$("""".datepicker"""").datepicker({ dateFormat: '"" + currentCultureInfo.DateTimeFormat.ShortDatePattern + @""',});""; .NET: 'dd.MM.yyyy' should be converted to 'dd.mm.yy' in jQuery/Javascript",Convert .NET DateTimeFormatInfo to Javascript jQuery formatDate?
c#: a method to count occurrences in a list," Is there a simple way to count the number of occurrences of all elements of a list into that same list in C#? Something like this: <code>  using System;using System.IO;using System.Text.RegularExpressions;using System.Collections.Generic;using System.Linq;string Occur;List<string> Words = new List<string>();List<string> Occurrences = new List<string>();// ~170 elements added. . . for (int i = 0;i<Words.Count;i++){ Words = Words.Distinct().ToList(); for (int ii = 0;ii<Words.Count;ii++){Occur = new Regex(Words[ii]).Matches(Words[]).Count;} Occurrences.Add (Occur); Console.Write(""{0} ({1}), "", Words[i], Occurrences[i]); }}",A method to count occurrences in a list
Baby's First Regular Expression," I know precisely zilch about regular expressions and figured this was as good an opportunity as any to learn at least the most basic of basics.How do I do this case-insensitive string replacement in C# using a regular expression? (Note that the '/' is a literal.) <code>  myString.Replace(""/kg"", """").Replace(""/KG"", """");",How do you do case-insensitive string replacement using regular expressions?
Does MEF do duck typing?," I have 2 assemblies: Assembly 1: Assembly 2: I know how to get this to work. I can either ask the MEF (Managed Extensibility Framework) for the object, or get it to export the correct IWeapon instead of just the object by name. Can MEF do the ""duck"" typing for me and return a proxy object if all the interface points are implemented?  <code>  interface IWeapon { int Might { get; }}[Export(""sword"")]public class Sword : IWeapon { public int Might { get { return 10; } }} interface IWeapon { int Might { get; }}var catalog = new AssemblyCatalog(typeof(Ninja.Sword).Assembly);var container = new CompositionContainer(catalog);// not allowed to use the IWeapon def in assembly 2 var sword = container.GetExportedValue<IWeapon>(""sword"");","Does MEF (Managed Extensibility Framework) do ""duck"" typing?"
What is the minimun Cross AppDomain communication performance penalty?," I am trying to minimize the performance penalty of communicating across AppDomains in the same machine. In my toy example, Class A is loaded in AppDomain 1. It creates an AppDomain 2 and loads there an instance of Class 2 (Class 2 inherits from MarshalByRef) getting back a proxy. Then Class 1 calls repeatedly a method on the proxy that returns no values.I get the following results:No AppDomains, both classes are loaded in the same AppDomain and the first calls repetedly the method on the second (the method has no parameters): 24 million method calls/secTwo AppDomain as described above, method has no parameters or ""bleeding"" string parameters: 340.000 methods calls/secTwo AppDomains as described above, one serializable parameter (array of two strings): 64.000 method calls/secAlthough I understand the performance penalty between 2 and 3 (serialization), I really don't understand why I am 100 times slower from case 1 to case 2. To my understanding, once the proxy is created all subsequent method invocations must be really fast since no data are being marshalled from one AppDomain to the other. Does anybody now why communicating across AppDomains is so slow? Am I doing something wrong?PS1. The only tip that I have on this is here: ""And the cost of crossing an AppDomain boundary is embarrassing."". I was guessing he refers to serialization...PS2. I don't count the AppDomain or Proxy creation time (my benchmarks start in the first method invocation)PS3. I am using .NET 3.5 in a WinXP SP3 machine. I also tried .NET 4.0 Beta 1 with no significant differences. <code> ",What is the minimum Cross AppDomain communication performance penalty?
Dynamic strong return type on a c# based webservice," My web service method returns a collection object, this will serialize nicely, thanks to the way C# web services work!But if my code throws an uncaught exception, I want to instead return a custom error object.Is this possible using C# ASP.NET v2?For example,Normal Operation should return: But on error I want <code>  <Books> <book>Sample</book> <book>Sample</book></Books> <error> <errorMessage></errorMessage> </error>",How to Return Errors from an ASMX Web Service?
Dynamic strong return type on a C# based web service," My web service method returns a collection object, this will serialize nicely, thanks to the way C# web services work!But if my code throws an uncaught exception, I want to instead return a custom error object.Is this possible using C# ASP.NET v2?For example,Normal Operation should return: But on error I want <code>  <Books> <book>Sample</book> <book>Sample</book></Books> <error> <errorMessage></errorMessage> </error>",How to Return Errors from an ASMX Web Service?
(.net) When is an attribute's constructor run?," When is it run? Does it run for each object to which I apply it, or just once? Can it do anything, or its actions are restricted? <code> ",When is a custom attribute's constructor run?
Run Code as a different user (C#), Is there a way to tell my code to run as a different user?I am calling NetUserSetInfo via a PInvoke and I need to call it as a different user. Is there a way to do that? <code> ,Run Code as a different user
How to change application settings (Settings) during while app is open?," I've written a class that should allow me to easily read and write values in app settings: the problem is the value isn't really saved, I mean it is not changed when I exit the application and run it again. What can I do to ensure that the saved value persists between closing and opening again? <code>  public static class SettingsManager { public static string ComplexValidationsString { get { return (string)Properties.Settings.Default[""ComplexValidations""]; } set { Properties.Settings.Default[""ComplexValidations""] = value; Properties.Settings.Default.Save(); } }",How to change application settings (Settings) while app is open?
.NET 2.0 Google openID for newbie," I'd like to implement OpenID in a new application using ASP.NET 2.0 and SQL Server 2005.I chosen Twitter, Facebook and Google as potential OpenID providers.I've found the Twitter implementation in .NET and I was studying Google's OpenID implementation, but I want to make sure that my design is (mostly!) flawless.Is my database schema correct? I've associated a Reader with an ProviderOpenID which contains only a nullable Name column. I store the OauthToken and use that at every request to gain access to his profile and verify the login. Am I missing something?Can anyone tell me if there is an Open Source Library for the .NET implementation of the OpenID provider for Google? I found the following tutorial on Google but I don't understand how it works. Has anyone tried this? Is this the best way to do this? <code> ",Using OpenID for website Authentication
Ignoring event subscribers when serializing an object," When the following class is serialized with a BinaryFormatter, any objects subscribing to the Roar event will also be serialized, since references to those objects are held by the EventHandler delegate. How would you stop event subscribers being serialized as part of the object graph starting with a Lion?Putting the [NonSerializable] attribute on the event will not compile.Note: I'm answering my own question since I think it might be useful to have the information on the site! FAQ: It's also perfectly fine to ask and answer your own question, but pretend you're on Jeopardy: phrase it in the form of a question. <code>  [Serializable]public class Lion{ public event EventHandler Roar; public string Name { get; set; } public float Fluffiness { get; set; } public Lion(string name, float fluffiness) { Name = name; Fluffiness = fluffiness; } public void Poke() { Roar(); // Could be null, etc.. }}",How do I ignore event subscribers when serializing an object?
Is the a C# equvilant to the With statement in VB?," Possible Duplicate: Equivalence of “With…End With” in c#? There was one feature of VB that I really like...the With statement. Does C# have any equivalent to it? I know you can use using to not have to type a namespace, but it is limited to just that. In VB you could do this: The same code in C# would be: <code>  With Stuff.Elements.Foo .Name = ""Bob Dylan"" .Age = 68 .Location = ""On Tour"" .IsCool = TrueEnd With Stuff.Elements.Foo.Name = ""Bob Dylan"";Stuff.Elements.Foo.Age = 68;Stuff.Elements.Foo.Location = ""On Tour"";Stuff.Elements.Foo.IsCool = true;",What's the C# equivalent to the With statement in VB?
Is the a C# equivalent to the With statement in VB?," Possible Duplicate: Equivalence of “With…End With” in c#? There was one feature of VB that I really like...the With statement. Does C# have any equivalent to it? I know you can use using to not have to type a namespace, but it is limited to just that. In VB you could do this: The same code in C# would be: <code>  With Stuff.Elements.Foo .Name = ""Bob Dylan"" .Age = 68 .Location = ""On Tour"" .IsCool = TrueEnd With Stuff.Elements.Foo.Name = ""Bob Dylan"";Stuff.Elements.Foo.Age = 68;Stuff.Elements.Foo.Location = ""On Tour"";Stuff.Elements.Foo.IsCool = true;",What's the C# equivalent to the With statement in VB?
Fast DateTime formating," In my binary to text decoding application (.NET 2.0) I found that the line: takes 33% of total processing time. Does anyone have any ideas on how to make it faster?EDIT: This app is used to process some binary logs and it currently takes 15 hours to run. So 1/3 of this will be 5 hours. EDIT: I am using NProf for profiling. App is processing around 17 GBytes of binary logs. <code>  logEntryTime.ToString(""dd.MM.yy HH:mm:ss:fff"")",How do I improve the performance of code using DateTime.ToString?
How to change cursor alway right," I would like to change all the characters entered into a textbox to upper case. The code will add the character, but how do I move the caret to the right? <code>  private void textBox3_KeyPress(object sender, KeyPressEventArgs e){ textBox3.Text += e.KeyChar.ToString().ToUpper(); e.Handled = true;}",How to move the textbox caret to the right
How to right justify and upper case my text box?," I would like to change all the characters entered into a textbox to upper case. The code will add the character, but how do I move the caret to the right? <code>  private void textBox3_KeyPress(object sender, KeyPressEventArgs e){ textBox3.Text += e.KeyChar.ToString().ToUpper(); e.Handled = true;}",How to move the textbox caret to the right
How to move the textbox caret to the right.," I would like to change all the characters entered into a textbox to upper case. The code will add the character, but how do I move the caret to the right? <code>  private void textBox3_KeyPress(object sender, KeyPressEventArgs e){ textBox3.Text += e.KeyChar.ToString().ToUpper(); e.Handled = true;}",How to move the textbox caret to the right
C# wierdness: Array loses type sign information when cast to object," Investigating a bug, I discovered it was due to this weirdness in c#: The output is ""True False True True"", while I would have expected ""bar is byte[]"" to return False. Apparently bar is both a byte[] and an sbyte[]? The same happens for other signed/unsigned types like Int32[] vs UInt32[], but not for say Int32[] vs Int64[].Can anyone explain this behavior? This is in .NET 3.5. <code>  sbyte[] foo = new sbyte[10];object bar = foo;Console.WriteLine(""{0} {1} {2} {3}"", foo is sbyte[], foo is byte[], bar is sbyte[], bar is byte[]);",Why does my C# array lose type sign information when cast to object?
C# weirdness: Array loses type sign information when cast to object," Investigating a bug, I discovered it was due to this weirdness in c#: The output is ""True False True True"", while I would have expected ""bar is byte[]"" to return False. Apparently bar is both a byte[] and an sbyte[]? The same happens for other signed/unsigned types like Int32[] vs UInt32[], but not for say Int32[] vs Int64[].Can anyone explain this behavior? This is in .NET 3.5. <code>  sbyte[] foo = new sbyte[10];object bar = foo;Console.WriteLine(""{0} {1} {2} {3}"", foo is sbyte[], foo is byte[], bar is sbyte[], bar is byte[]);",Why does my C# array lose type sign information when cast to object?
How to pass a parameter to a WinForm Application?," I have two different WinForms applications, AppA & AppB. Both are running .NET 2.0.In AppA I want to open AppB, but I need to pass command-line arguments to it. How do I consume the arguments that I pass in the command line?This is my current main method in AppB, but I don't think you can change this? <code>  static void main() { }",How do I pass command-line arguments to a WinForms application?
How do I pass command-lie arguments to a WinForms application?," I have two different WinForms applications, AppA & AppB. Both are running .NET 2.0.In AppA I want to open AppB, but I need to pass command-line arguments to it. How do I consume the arguments that I pass in the command line?This is my current main method in AppB, but I don't think you can change this? <code>  static void main() { }",How do I pass command-line arguments to a WinForms application?
C# newbie: verifying that a string contains only letters," I have an input string and I want to verify that it contains:Only letters orOnly letters and numbers orOnly letters, numbers or underscore To clarify, I have 3 different cases in the code, each calling for different validation. What's the simplest way to achieve this in C#? <code> ",Verifying that a string contains only letters in C#
Why can't I use LINQ on ListView.SelectedItems," I am trying to do use .Select extension method on ListView.SelectedItems which is SelectedListViewItemCollection, but .Select doesn't show up in intellisense.I can use foreach on SelectedListViewItemCollection, so it must have implemented IEnumerable. I just checked on MSDN, and it certainly does. Then why can't the LINQ extension methods be used on it? <code> ",Why can't I use LINQ on ListView.SelectedItems?
How to Query an NTP Server from C#, All I need is a way to query an NTP Server using C# to get the Date Time of the NTP Server returned as either a string or as a DateTime. How is this possible in its simplest form? <code> ,How to Query an NTP Server using C#?
C# MailTo with Attachment!??!," Currently I am using the below method to open the users outlook email account and populate an email with the relevant content for sending: I want to however, be able to populate the email with an attached file.something like: However this does not seem to work.Does anyone know of a way which will allow this to work!?Help greatly appreciate.Regards. <code>  public void SendSupportEmail(string emailAddress, string subject, string body){ Process.Start(""mailto:"" + emailAddress + ""?subject="" + subject + ""&body="" + body);} public void SendSupportEmail(string emailAddress, string subject, string body){ Process.Start(""mailto:"" + emailAddress + ""?subject="" + subject + ""&body="" + body + ""&Attach="" + @""C:\Documents and Settings\Administrator\Desktop\stuff.txt"");}",C# MailTo with Attachment?
"Get property value from  string using reflection in c"""," I am trying implement the Data transformation using Reflection1 example in my code.The GetSourceValue function has a switch comparing various types, but I want to remove these types and properties and have GetSourceValue get the value of the property using only a single string as the parameter. I want to pass a class and property in the string and resolve the value of the property.Is this possible?1 Web Archive version of original blog post <code> ",Get property value from string using reflection
Get property value from  string using reflection in c#," I am trying implement the Data transformation using Reflection1 example in my code.The GetSourceValue function has a switch comparing various types, but I want to remove these types and properties and have GetSourceValue get the value of the property using only a single string as the parameter. I want to pass a class and property in the string and resolve the value of the property.Is this possible?1 Web Archive version of original blog post <code> ",Get property value from string using reflection
Get property value from string using reflection in C#," I am trying implement the Data transformation using Reflection1 example in my code.The GetSourceValue function has a switch comparing various types, but I want to remove these types and properties and have GetSourceValue get the value of the property using only a single string as the parameter. I want to pass a class and property in the string and resolve the value of the property.Is this possible?1 Web Archive version of original blog post <code> ",Get property value from string using reflection
Reading dll.config (not app.config!) from a plugin module.," I am writing a C# .NET 2.0 .dll that is a plug in to a Larger application. The visual studio project for my module has a app.config file which is copied to a MyProj.dll.config along side of MyProj.dll. The plan is that MyProj.dll.config will be edited after the .dll is deployed. I am trying to read my settings from that modified local file. I have tried pulling out the LocalFilesSettingsObject and changing it's application name to my .dll like this: That is not working. I am struggling to wrap my head around the whole .NET Settings mess. I'd like a recipe to finish this task. I would also like a link to a clear explanation (with examples) of how settings are supposed to work in .NET 2.0 <code>  Properties.Settings config = Properties.Settings.Default; SettingsContext context = config.Context; SettingsPropertyCollection properties = config.Properties; SettingsProviderCollection providers = config.Providers; SettingsProvider configFile = Properties.Settings.Default.Providers[""LocalFileSettingsProvider""]; configFile.ApplicationName = Assembly.GetExecutingAssembly().GetName().Name; config.Initialize(context, properties, providers); config.Reload();",Reading dll.config (not app.config!) from a plugin module
how to add an item into IEnumerable<T>," My question as title above. For example but after all it only has 1 item inside. Can we have a method like items.Add(item) like the List<T>? <code>  IEnumerable<T> items = new T[]{new T(""msg"")};items.ToList().Add(new T(""msg2""));",How can I add an item to a IEnumerable<T> collection?
Setting the user state when downloading aysnc'ly," VS 2008 SP1I am using the web clicent to download some files asynchronously.I have 5 files to download.However, I want to monitor each download and want to set the user state as the name of the file, so in the ProgressCompletedEvent I can check the user state to see which file has completed?He is a short code snippet of what I am trying to do.  <code>  // This function will be called for each file that is going to be downloaded.// is there a way I can set the user state so I know that the download // has been completed // for that file, in the DownloadFileCompleted Event? private void DownloadSingleFile(){ if (!wb.IsBusy) { // Set user state here wb.DownloadFileAsync(new Uri(downloadUrl), installationPath); }}void wb_DownloadFileCompleted(object sender, AsyncCompletedEventArgs e){ Console.WriteLine(""File userstate: [ "" + e.UserState + "" ]""); }void wb_DownloadProgressChanged(object sender, DownloadProgressChangedEventArgs e){ Console.WriteLine(""File userstate: [ "" + e.UserState + "" ]""); double bytesIn = double.Parse(e.BytesReceived.ToString()); double totalBytes = double.Parse(e.TotalBytesToReceive.ToString()); double percentage = bytesIn / totalBytes * 100; progressBar1.Value = int.Parse(Math.Truncate(percentage).ToString());}",Setting the user state when downloading asynchronously
Setting the user state when downloading async'ly," VS 2008 SP1I am using the web clicent to download some files asynchronously.I have 5 files to download.However, I want to monitor each download and want to set the user state as the name of the file, so in the ProgressCompletedEvent I can check the user state to see which file has completed?He is a short code snippet of what I am trying to do.  <code>  // This function will be called for each file that is going to be downloaded.// is there a way I can set the user state so I know that the download // has been completed // for that file, in the DownloadFileCompleted Event? private void DownloadSingleFile(){ if (!wb.IsBusy) { // Set user state here wb.DownloadFileAsync(new Uri(downloadUrl), installationPath); }}void wb_DownloadFileCompleted(object sender, AsyncCompletedEventArgs e){ Console.WriteLine(""File userstate: [ "" + e.UserState + "" ]""); }void wb_DownloadProgressChanged(object sender, DownloadProgressChangedEventArgs e){ Console.WriteLine(""File userstate: [ "" + e.UserState + "" ]""); double bytesIn = double.Parse(e.BytesReceived.ToString()); double totalBytes = double.Parse(e.TotalBytesToReceive.ToString()); double percentage = bytesIn / totalBytes * 100; progressBar1.Value = int.Parse(Math.Truncate(percentage).ToString());}",Setting the user state when downloading asynchronously
"C# Error ""The type initializer for ... threw an exception."," This error occurs only in some computers. By reading the stack information, there is some problem when I call to this static method (""FormatQuery"") in a static class: So, what's the problem? How do I solve it? Is there something wrong with the project configuration or debbuging mode or what?Error information: <code>  using System;using System.Collections.Generic;using System.Data;using System.Diagnostics;using System.IO;using System.Text;using System.Windows.Forms;using DevExpress.XtraEditors;using FlexCel.Report;using FlexCel.XlsAdapter;using ComboBox=System.Windows.Forms.ComboBox;namespace XSoftArt.A{ static class RHelper { private static string FormatQuery(string FieldName, int Count, CheckedListBox chekedListBox) { string ID = string.Empty; int n = Count; foreach (DataRowView item in chekedListBox.CheckedItems) { ID = ID + item["""" + FieldName + """"]; if (n > 1) { ID = ID + "" , ""; n--; } } return ID; } public static string FormatQuery(CheckedListBox chekedListBox) { return FormatQuery(chekedListBox.ValueMember, chekedListBox.CheckedItems.Count, chekedListBox); } } at XSoftArt.EVS.ReportHelper.FormatQuery(CheckedListBox chekedListBox) at XSoftArt.EVS.NewEmailSelectClient.LoadList_v2(String search, TextBox txtbox) at XSoftArt.EVS.NewEmailSelectClient.LoadContacts() at XSoftArt.EVS.NewEmailSelectClient.button7_Click(Object sender, EventArgs e) at System.Windows.Forms.Control.OnClick(EventArgs e) at System.Windows.Forms.Button.OnClick(EventArgs e) at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent) at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks) at System.Windows.Forms.Control.WndProc(Message& m) at System.Windows.Forms.ButtonBase.WndProc(Message& m) at System.Windows.Forms.Button.WndProc(Message& m) at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m) at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m) at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)","C# Error ""The type initializer for ... threw an exception"
How can I generate random numbers with C#, I know that the Random class can generate pseudo-random numbers but is there a way to generate truly random numbers? <code> ,How can I generate truly (not pseudo) random numbers with C#?
how to get current username in .net using c#?, How do I get the current username in .NET using C#? <code> ,How do I get the current username in .NET using C#?
C# File.Copy vs. Manual FileStream.Write For Copying File," My problem is in regards file copying performance. We have a media management system that requires a lot of moving files around on the file system to different locations including windows shares on the same network, FTP sites, AmazonS3, etc. When we were all on one windows network we could get away with using System.IO.File.Copy(source, destination) to copy a file. Since many times all we have is an input Stream (like a MemoryStream), we tried abstracting the Copy operation to take an input Stream and an output Stream but we are seeing a massive performance decrease. Below is some code for copying a file to use as a discussion point. Does anyone know why this performs so much slower than File.Copy? Is there anything I can do to improve performance? Am I just going to have to put special logic in to see if I'm copying from one windows location to another--in which case I would just use File.Copy and in the other cases I'll use the streams?Please let me know what you think and whether you need additional information. I have tried different buffer sizes and it seems like a 64k buffer size is optimal for our ""small"" files and 256k+ is a better buffer size for our ""large"" files--but in either case it performs much worse than File.Copy(). Thanks in advance!  <code>  public void Copy(System.IO.Stream inStream, string outputFilePath){ int bufferSize = 1024 * 64; using (FileStream fileStream = new FileStream(outputFilePath, FileMode.OpenOrCreate, FileAccess.Write)) { int bytesRead = -1; byte[] bytes = new byte[bufferSize]; while ((bytesRead = inStream.Read(bytes, 0, bufferSize)) > 0) { fileStream.Write(bytes, 0, bytesRead); fileStream.Flush(); } }}",File.Copy vs. Manual FileStream.Write For Copying File
C#: List all processes and their current memory & CPU consumption?, How can I get a list of all processes in C# and then for each process current memory and CPU consumption?Sample code is highly appreciated. <code> ,List all processes and their current memory & CPU consumption?
How do I get the currently deplyed version in a .NET application?," I want to be able to display the current version of a .NET application that I have deployed using the publish wizard. There is a nice option to automatically update the version number every time I publish my application.I found another question (Automatically update version number) that had this to get the current version: This gets you the version you set in the project properties, but not the version that is automatically incremented each time you publish. <code>  Assembly.GetExecutingAssembly().GetName().Version",How do I get the current published version in a .NET application?
Should the ID in the business object read-only or not?," In my mind the ID field of a business object should be read-only (public get and private set) as by definition the ID will never change (as it uniquely identifies a record in the database).This creates a problem when you create a new object (ID not set yet), save it in the database through a stored procedure for example which returns the newly created ID then how do you store it back in the object if the ID property is read-only?Example: How does the Save method (which actually connects to the database to save the new employee) update the EmployeeId property in the Employee object if this property is read-only (which should be as the EmployeeId will never ever change once it's created). It looks like the Id should be writable by the DAL and read-only for the rest of the world. How do you implement this especially if the DAL classes and the Business object ones are in different assemblies? I don't want to create a Save method in the Employee class as this class should have nothing to do with the database. <code>  Employee employee = new Employee(); employee.FirstName=""John""; employee.LastName=""Smith""; EmployeeDAL.Save(employee);",Should the ID in the business object be read-only or not?
Has anyone successfully mocked the Socket class in C#?, I'm trying to mock out the System.net.Sockets.Socket class in C# - I tried using NUnit mocks but it can't mock concrete classes. I also tried using Rhino Mocks but it seemed to use a real version of the class because it threw a SocketException when Send(byte[]) was called. Has anyone successfully created and used a Socket mock using any mocking framework? <code> ,Has anyone successfully mocked the Socket class in .NET?
How do I do this in Entity Framework(multiple where's or Join)?," I have 2 tables that have a relation ship to each otherTable A has 1 to many relationship with table B, so this creates a navigation property into each.Now I need to check a value from Table A (userName) and I need to check a value from table B (ClubId).So in my mind it would be something like but now I know with Entity stuff it should make joins less common so I am wondering if I can do it with a join then.I tried this so this does not work since it won't return the right type(the 2nd where). This is just how I thought along the lines how I would expect it to be done would work.So how should it look?P.S I rather have an example done in the Linq method queries like I did above. <code>  Join the tables togetherWhere A.userName == ""bob"" &&where B.clubId == ""Car""// return the count. int count = Entity.TableA.where(a => a.userName == ""bob"" && a.TableB.where(i => i.ClubId == ""Car"")).Count();",How do I do this in Entity Framework (multiple where's or Join)?
Is this Good c# style?," Consider the following method signature: This method performs the following:accesses the database to generate a list of Poll objects. returns true if it was success and errorMessage will be an empty stringreturns false if it was not successful and errorMessage will contain an exception message. Is this good style?Update:Lets say i do use the following method signature: and in that method, it doesn't catch any exceptions (so i depend the caller to catch exceptions). How do i dispose and close all the objects that is in the scope of that method? As soon as an exception is thrown, the code that closes and disposes objects in the method is no longer reachable. <code>  public static bool TryGetPolls(out List<Poll> polls, out string errorMessage) public static List<Poll> GetPolls()",Is this good C# style?
How much more does an Exception costs more then return a value from function?," Is it possible to change this code, with a return value and an exception: to this, which throws separate exceptions for success and failure <code>  public Foo Bar(Bar b){ if(b.Success) { return b; } else { throw n.Exception; }} public Foo Bar(Bar b){ throw b.Success ? new BarException(b) : new FooException();}try{ Bar(b)}catch(BarException bex){ return ex.Bar;}catch(FooException fex){ Console.WriteLine(fex.Message);}",How much more expensive is an Exception than a return value?
C# Func with out parameter," Can I pass a method with an out parameter as a Func? Func needs a type so out won't compile there, and calling listFunction requires an int and won't allow an out in.Is there a way to do this? <code>  public IList<Foo> FindForBar(string bar, out int count) { }// somewhere elsepublic IList<T> Find(Func<string, int, List<T>> listFunction) { }",Func<T> with out parameter
how to convert  System.Drawing.font to System.Windows.Media.Fonts  or TypeFace, How can I convert a System.Drawing.Font to a System.Windows.Media.Fonts or TypeFace?Or how can I generate an instance of System.Windows.Media.Fonts or TypeFace from an instance of System.Drawing.Font? <code> ,How can I convert a System.Drawing.font to a System.Windows.Media.Fonts or TypeFace?
Where methods are stored in .net??," I learned that class fields are stored in the heap, but where are methods stored? In the heap or somewhere else? are they inline? <code> ",Where are methods stored in memory?
What are the C# namespace and class/sub-class naming conventions when the top namespace contains the base class and inner namespaces contain sub-classes?," I'm trying to design a class library for a particular engineering application and I'm trying to ensure that my class & namespace naming conventions make sense. I have the following situation: The code gets used in ways that all of these classes will need to be referenced from within the same scope. The following situation would be likely: Under these circumstances, am I better off giving the classes more specific names or leave the naming as shown in the first example and rely on the information that is encoded in the namespace for clarity? Under the latter approach, I assume I would want to utilize alaising for clarity in the code that makes use of this library, corret?It seems redundent to have: or but I also want to have very descriptive and specific class names.Philosophically, what I'm asking is whether or not to include the namespace as a part of the class name when considering if a class name is descriptive enough. <code>  namespace Vehicle{ class Wheel{...} //base class for Wheel objects class Engine{...} //base class for Engine objects ... namespace Truck{ class Wheel: Vehicle.Wheel{...} //Truck specific Wheel object class Engine: Vehicle.Engine{...} //Truck specific Engine object ... } namespace Car{ class Wheel: Vehicle.Wheel{...} //Car specific Wheel object class Engine: Vehicle.Engine{...} //Car specific Engine object ... } ...} ...Vehicle.Wheel.DoSomething();Vehicle.Truck.Wheel.DoSomething();Vehicle.Car.Wheel.DoSomething();... namespace Car{ class CarWheel: Vehicle.Wheel{...} //Car specific Wheel object ...} Vehicle.Car.CarWheel Vehicle.Truck.TruckEngine",The C# namespace and class/sub-class naming conventions when the top namespace contains the base class and inner namespaces contain sub-classes
What is the best way to support multiple databases for a .Net product?," We are designing a product which could support multiple databases. We are doing something like this currently so that our code supports MS SQL as well as MySQL: Can you please suggest if there is any better way of doing it? Also what are the pros and cons of the approach? <code>  namespace Handlers{ public class BaseHandler { protected string connectionString; protected string providerName; protected BaseHandler() { connectionString = ApplicationConstants.DatabaseVariables.GetConnectionString(); providerName = ApplicationConstants.DatabaseVariables.GetProviderName(); } }}namespace Constants{ internal class ApplicationConstants { public class DatabaseVariables { public static readonly string SqlServerProvider = ""System.Data.SqlClient""; public static readonly string MySqlProvider = ""MySql.Data.MySqlClient""; public static string GetConnectionString() { return ConfigurationManager.ConnectionStrings[""CONNECTION_STRING""].ConnectionString; } public static string GetProviderName() { return ConfigurationManager.ConnectionStrings[""CONNECTION_STRING""].ProviderName; } } }}namespace Handlers{ internal class InfoHandler : BaseHandler { public InfoHandler() : base() { } public void Insert(InfoModel infoModel) { CommonUtilities commonUtilities = new CommonUtilities(); string cmdInsert = InfoQueryHelper.InsertQuery(providerName); DbCommand cmd = null; try { DbProviderFactory provider = DbProviderFactories.GetFactory(providerName); DbConnection con = LicDbConnectionScope.Current.GetOpenConnection(provider, connectionString); cmd = commonUtilities.GetCommand(provider, con, cmdInsert); commonUtilities.PrepareCommand(cmd, infoModel.AccessKey, ""paramAccessKey"", DbType.String, false, provider, providerName); commonUtilities.PrepareCommand(cmd, infoModel.AccessValue, ""paramAccessValue"", DbType.String, false, provider, providerName); cmd.ExecuteNonQuery(); } catch (SqlException dbException) { //-2146232060 for MS SQL Server //-2147467259 for MY SQL Server /*Check if Sql server instance is running or not*/ if (dbException.ErrorCode == -2146232060 || dbException.ErrorCode == -2147467259) { throw new BusinessException(""ER0008""); } else { throw new BusinessException(""GENERIC_EXCEPTION_ERROR""); } } catch (Exception generalException) { throw generalException; } finally { cmd.Dispose(); } } }}namespace QueryHelpers{ internal class InfoQueryHelper { public static string InsertQuery(string providerName) { if (providerName == ApplicationConstants.DatabaseVariables.SqlServerProvider) { return @""INSERT INTO table1 (ACCESS_KEY ,ACCESS_VALUE) VALUES (@paramAccessKey ,@paramAccessValue) ""; } else if (providerName == ApplicationConstants.DatabaseVariables.MySqlProvider) { return @""INSERT INTO table1 (ACCESS_KEY ,ACCESS_VALUE) VALUES (?paramAccessKey ,?paramAccessValue) ""; } else { return string.Empty; } } }}",What is the best way to support multiple databases for a .NET product?
Is Culture in C# equivalent to Locale in Java, C# uses the concept of Culture. Is this operationally similar to Locale in Java or are there significant differences in the underlying concepts? <code> ,Is Culture in C# equivalent to Locale in Java?
Strip Byte Order Mark from string in C#," In C#, I have a string that I'm obtaining from WebClient.DownloadString. I've tried setting client.Encoding to new UTF8Encoding(false), but that's made no difference - I still end up with a byte order mark for UTF-8 at the beginning of the result string. I need to remove this (to parse the resulting XML with LINQ), and want to do so in memory.So I have a string that starts with \x00EF\x00BB\x00BF, and I want to remove that if it exists. Right now I'm using but that just feels wrong. I've tried all sorts of code with streams, GetBytes, and encodings, and nothing works. Can anyone provide the ""right"" algorithm to strip a BOM from a string? <code>  if (xml.StartsWith(ByteOrderMarkUtf8)){ xml = xml.Remove(0, ByteOrderMarkUtf8.Length);}",Strip the byte order mark from string in C#
what is the best way to wait for a certain time ( say 10 sec) in C# ?," I want to wait for 15 seconds, then the control should resume from the next statement.I don't have anything else to do while waiting (Just waiting).I know that there is Thread.Sleep(15000). What I don't know is the best method to wait? What are the limitations of this?The code would be like this: <code>  Method(){ statement 1; statement 2; //WaitFor 15 secs here; statement 3;}",What is the best way to wait for a certain time (say 10 seconds) in C#?
find first element of certain type in a list uisng LINQ, What would be the shortest notation to find the first item that is of a certain type in a list of elements using LINQ and C#.  <code> ,Find first element of certain type in a list using LINQ
How do I tell which tab you are moving from/to in a .NET tab control?," I need to determine which tab the user is coming from, and going to, when they switch tabs, and possibly cancel the switch. I have tried the Deselecting, Deselected, Selecting, Selected events, and all of them show the e.TabPageIndex to be the same as the sender.SelectedIndex.Is there an event, or property, that I can use so that I can determine both sides of this, or do I have to hack something together with caching it from one event and using that value in the new event.I am trying to avoid handling the Deselecting/Deselected events and caching the value to use in the Selecting event. I already know I can do this, so I am asking if there is a cleaner way, without doing this.I have tried in both C# and VB, with the same results (no surprise).Thanks. <code> ",How do I tell which tab you are moving from/to in a WinForms tab control?
How to kill a thread instantly in C# ?," I am using the thread.Abort method to kill the thread, but it not working. Is there any other way of terminating the thread? I am using this but every time I get the Alive status, Receiver is my global thread. <code>  private void button1_Click(object sender, EventArgs e){ if (Receiver.IsAlive == true) { MessageBox.Show(""Alive""); Receiver.Abort(); } else { MessageBox.Show(""Dead""); Receiver.Start(); }}",How to kill a thread instantly in C#?
Can someone demystify yield keyword?, I have seen the yield keyword being used quite a lot on Stack Overflow and blogs. I don't use LINQ. Can someone explain the yield keyword? I know that similar questions exist.But none really explain what is its use in plain simple language. <code> ,Can someone demystify the yield keyword?
Acceptance testing a large c# forms app," I am working on a fairly complicated project. We have a c# forms app that has several layers of business logic, communicating with a c++ hardware management layer via a socket interface.We have unit test coverage of the c++ side, and the business logic, but acceptance testing of the forms app is a whole new world for me, as we have done exclusively web apps heretofore.Any suggestions on where to start? I looked at NUnitUI, but I'm not sure that it has enough depth to do what we need. I am looking for a suite to do automated UI testing.Also, I am okay with paying for the right solution if that is what I need to do.Thanks! <code> ",Automated UI testing a large c# forms app
Debugging and diagnosign lock convoying in .NET," I am looking into performance issues of a large C#/.NET 3.5 system that exhibits performance degradation as the number of users making requests scales up to 40-50 distinct user requests per second.The request durations increase significantly, while CPU and I/O loads appear to stay about the same. This leads me to believe we may have problem with how shared objects in our system, which are protected using c# lock() {...} statements may be affecting concurrent access performance. Specifically, I suspect that some degree of lock convoying is occurring on frequently used shared data that is protected by critical sections (because it it read/write).Does anyone have suggestions on how to actually diagnose if lock convoying is the problem .. or if lock contention of any kind is contributing to long request times? <code> ",Debugging and diagnosing lock convoying problems in .NET
How do you add a separator to a menu in C# ?," Inside my control, I have: How to add a separation line to this ContextMenu? <code>  ContextMenu = new ContextMenu();ContextMenu.MenuItems.Add(new MenuItem(""&Add Item"", onAddSpeaker));ContextMenu.MenuItems.Add(new MenuItem(""&Edit Item"", onEditSpeaker));ContextMenu.MenuItems.Add(new MenuItem(""&Delete Item"", onDeleteSpeaker));ContextMenu.MenuItems.Add( ??? );ContextMenu.MenuItems.Add(new MenuItem(""Cancel""));",How to add a separator to a WinForms ContextMenu?
How do you add a separator to a WinForms menu in C# ?," Inside my control, I have: How to add a separation line to this ContextMenu? <code>  ContextMenu = new ContextMenu();ContextMenu.MenuItems.Add(new MenuItem(""&Add Item"", onAddSpeaker));ContextMenu.MenuItems.Add(new MenuItem(""&Edit Item"", onEditSpeaker));ContextMenu.MenuItems.Add(new MenuItem(""&Delete Item"", onDeleteSpeaker));ContextMenu.MenuItems.Add( ??? );ContextMenu.MenuItems.Add(new MenuItem(""Cancel""));",How to add a separator to a WinForms ContextMenu?
how to Close XBAP browser from code," I am using an XBAP application in full trust. I need to close the browser hosting the XBAP when I click a button. How can I achieve this? Application.Currenty.ShutDown() only closes the application, leaving the browser blank. <code> ",How can I close the browser from an XBAP?
C#: Resharper suggests parameter can be of type 'BaseType', what are the benefits of using base types in method parameters?Here's one sample: And here's another one ...where we can change the type and anything but Foo will fail at runtime.So the question: what should I do when R# suggests parameter can be of type 'X'?PS. Just another explanation for Whysharper - a plugin that dovetails Resharper and StackOverflow. People say it's nice but lacks good explanations - hopefully together we can make it better ;). <code>  private void Foo(List<int> numbers) //R# laments: parameter can be IEnumerable. { foreach (var i in numbers) { Console.WriteLine(i); }} public class Foo : ICloneable{ public object Clone() { return MemberwiseClone(); } public Foo CopyMe(Foo other) //R# laments: parameter can be ICloneable { return (Foo)other.Clone(); }},Resharper suggests parameter can be of type 'BaseType'
What is the best way to merge two objects?," I have two objects and I want to merge them: To create: I will only know the structure of Foo at runtime. Bar can be any type at runtime. I would like to have a method that will be given a type and it combine that type with Foo. For instance, the scenario above, the method was given a Bar type at runtime and I combined it with Foo.What would be the best way to do this? Can it be done using LINQ Expressions or do I have to generate it Dynamically or is there another way? I am still learning the new LINQ namespace in C# 3.0, so excuse the ignorance if it can't be done using LINQ Expressions. This is also the first time I have ever had to do something dynamic like this with C#, so I am not quite sure of all the options I have available to me.Thanks for any options given.EDITThis is strictly for adding meta information to the type given to me for serialization. This scenario keeps the user's objects ignorant of the meta information that needs to be added, before it is serialized. I have come up with two options before asking this question and I just wanted to see if there was anymore, before deciding on which one to use.The two options I have come up with are:Manipulating the serialized string of the type given to me after serializing it, by adding the meta information.Wrapping the type given to me, which is similar to what @Zxpro mentioned, but mine differed slightly, which is fine. It will just make the user of my API have to follow the convention, which isn't a bad thing, since everybody is about convention over configuration: EDITThanks everybody for their answers. I decided on wrapping the object like above and I gave the answer to @Zxpro, since a majority liked that approach also.If anybody else comes across this question, feel free to post, if you think there might be a better way. <code>  public class Foo{ public string Name { get; set; }}public class Bar{ public Guid Id { get; set; } public string Property1 { get; set; } public string Property2 { get; set; } public string Property3 { get; set; } public string Property4 { get; set; }} public class FooBar{ public string Name { get; set; } public Guid Id { get; set; } public string Property1 { get; set; } public string Property2 { get; set; } public string Property3 { get; set; } public string Property4 { get; set; }} public class Foo<T>{ public string Name { get; set; } public T Content { get; set; }}",What is the best way to merge two objects during runtime using C#?
Best way to check if a dll is an clr assembly in C#, What is the best way to check if a DLL file is a Win32 DLL or if it is a CLR assembly. At the moment I use this code But I like to check before loading because I do not want those exceptions (time).Is there a better way? <code>  try { this.currentWorkingDirectory = Path.GetDirectoryName(assemblyPath); //Try to load the assembly. assembly = Assembly.LoadFile(assemblyPath); return assembly != null; } catch (FileLoadException ex) { exception = ex; } catch (BadImageFormatException ex) { exception = ex; } catch (ArgumentException ex) { exception = ex; } catch (Exception ex) { exception = ex; } if (exception is BadImageFormatException) { return false; },Best way to check if a DLL file is a CLR assembly in C#
Image rotate #c, What is the best way to rotate a image in asp.netI did use matrix.rotateAt but i can't get it to work so please tell me what is the best way?I should write out that hate to rotate a image with the image object. <code> ,C# Image rotation
WPF: Use one window style for Debug mode and another for Release mode?," I have two different styles for my window:Regular - window has title bar and can be moved/resizedFixed - window has no title bar and is fixed at the center of the screenThe window is too wide for either of the monitors on my development machine, but it's a perfect fit for the target/install machine. So, when debugging, I need to be able to move the Window so I can see everything on it, but when I release the app, I need it to run in ""full screen"" mode (like a PowerPoint app in projector mode).Is there any way to set the Style property of the window based on whether I'm compiling in Debug vs. Release mode? I was thinking I might be able to use a binding, but I'm not quite sure how to implement it. <code> ",How can I have WPF use one window style for Debug mode and another for Release mode?
Why does WPF use one window style for Debug mode and another for Release mode?," I have two different styles for my window:Regular - window has title bar and can be moved/resizedFixed - window has no title bar and is fixed at the center of the screenThe window is too wide for either of the monitors on my development machine, but it's a perfect fit for the target/install machine. So, when debugging, I need to be able to move the Window so I can see everything on it, but when I release the app, I need it to run in ""full screen"" mode (like a PowerPoint app in projector mode).Is there any way to set the Style property of the window based on whether I'm compiling in Debug vs. Release mode? I was thinking I might be able to use a binding, but I'm not quite sure how to implement it. <code> ",How can I have WPF use one window style for Debug mode and another for Release mode?
C#-Does C# Compiler supply default constructor for reference type (if one not specified) or CLR?," I believe (correct me if i am wrong), according to the C# rule for value types, there is no default constructor. The CLR will define the one for zeroing out the field values.For reference type : Will the default constructor be supplied by C# or the CLR? <code>  class Test{ private string Name;}",Does the C# Compiler supply a default constructor for reference types (if one not specified) or does the CLR?
Clueless programming an Infrared application. Will I succeed?," I have a monitor which can be used also as television (it has a DVI-D connector AND a cable connector.) And for a while I have an infrared device on my computer which I use to synchronize my PDA and mobile phone.I want the infrared/irDA device of my PC to send a signal to my monitor to switch between TV and PC mode. (Or to control the monitor in some other way, like turning it on and off during logon/logoff.) To do this I need to:Use the PC device to record the commands from my monitor remote.Repeat that signal from my PC to my monitor to send the command.With nearly 30 years of programming experience, the code is no problem. But since my only knowledge of infrared devices is extremely limited, I need some useful hints and tips about this. A Google search will provide plenty of links that are useful. But I could use help to find the most useful ones. <code> ",Allow an infrared device to send a signal to control the monitor of a PC
Getting all unique Items in a C# list, What is the fastest / most efficient way of getting all the distinct items from a list?I have a List<string> that possibly has multiple repeating items in it and only want the unique values within the list. <code> ,Getting unique items from a list
How to avoid repeating similar code in C#," I have some auto-instantiation code which I would like to apply to about 15 properties in a fairly big class. The code is similar to the following but the type is different for each instance: To repeat this in C++ (as there are ~15 instances), I would have used a preprocessor macro but I notice C# doesn't support them.I am wondering if anyone has a recommendation on how to do this cleanly in C#? <code>  protected ComplexType _propertyName;public ComplexType PropertyName{ get { if (_propertyName == null) { _propertyName = new ComplexType(); } return _propertyName; }}",C# Equivalent for C++ Macros and using Auto<> Properties
C# Equivilent for C++ Macros and using Auto<> Properties," I have some auto-instantiation code which I would like to apply to about 15 properties in a fairly big class. The code is similar to the following but the type is different for each instance: To repeat this in C++ (as there are ~15 instances), I would have used a preprocessor macro but I notice C# doesn't support them.I am wondering if anyone has a recommendation on how to do this cleanly in C#? <code>  protected ComplexType _propertyName;public ComplexType PropertyName{ get { if (_propertyName == null) { _propertyName = new ComplexType(); } return _propertyName; }}",C# Equivalent for C++ Macros and using Auto<> Properties
operator overloading .net, In what situations would you consider overloading an operator in .NET? <code> ,Operator overloading in .NET
Supress 3rd party library console output?," I need to call a 3rd party library that happens to spew a bunch of stuff to the console. The code simply like this... Is there an easy way to suppress the unwanted console output from ThirdPartyLibrary? For performance reasons, new processes or threads cannot be used in the solution. <code>  int MyMethod(int a){ int b = ThirdPartyLibrary.Transform(a); // spews unwanted console output return b;}",Suppress 3rd party library console output?
C# assign values of array to separate variables in one line," Can I assign each value in an array to separate variables in one line in C#? Here's an example in Ruby code of what I want: I'm not sure if what I'm wanting is possible in C#.Edit: for those suggesting I just assign the strings ""hey"" and ""now"" to variables, that's not what I want. Imagine the following: Now the fact that the method get_two_values returned strings ""hey"" and ""now"" is arbitrary. In fact it could return any two values, they don't even have to be strings. <code>  irb(main):001:0> str1, str2 = [""hey"", ""now""]=> [""hey"", ""now""]irb(main):002:0> str1=> ""hey""irb(main):003:0> str2=> ""now"" irb(main):004:0> val1, val2 = get_two_values()=> [""hey"", ""now""]irb(main):005:0> val1=> ""hey""irb(main):006:0> val2=> ""now""",Assign values of array to separate variables in one line
"linq to objects - set object property to null if it equals ""folder"""," I have a collection of objects representing a folder structure.I'd like to set the property FileExtension to null, if it's a folder.This is as far as I've got. Can anyone help? <code>  var items = MyClass.All().ToList();items.ForEach(x => x.FileExtension = string.empty) .Where(y => y.FileExtension == ""folder"") .ToList();","In LINQ to objects, how to set an object property to null if it equals ""folder""?"
Thread Control.Invoke ," I have a function In Form_Load Function Like this; But When I run it;in ShowAllFly function What is the problem? <code>  public void ShowAllFly(){ cbFly.Items.Clear(); cbFly.Items.Add(""Uu Seiniz...""); dsFlyTableAdapters.tblFlyTableAdapter _t=new KTHY.dsFlyTableAdapters.tblFlyTableAdapter(); dsFly _mds = new dsFly(); _mds.EnforceConstraints = false; dsFly.tblFlyDataTable _m = _mds.tblFly; _t.Fill(_m); foreach (DataRow _row in _m.Rows) { cbFly.Items.Add(_row[""FlyID""].ToString()+""-""+_row[""FlyName""].ToString() + ""-"" + _row[""FlyDirection""].ToString() + ""-"" + _row[""FlyDateTime""].ToString()); } _Thread.Abort(); timer1.Enabled = false; WaitPanel.Visible = false;} { _Thread = new System.Threading.Thread(new System.Threading.ThreadStart(ShowAllFly)); _Thread.Start(); _Thread.Priority = System.Threading.ThreadPriority.Normal;} cbFly.Items.Clear(); ---- HERE Gives ERROR LIKE Control.Invoke must be used to interact with controls created on a separate thread.",Thread Control.Invoke
Get file type in C#," How can i get type of file using c#.for example if a file name id ""abc.png"" and type of file will ""PNG Image"" same as third column ""Type"" in window explorer. <code> ",Get file type in .NET
PropertyGrid - Custom property names?," I have a class that I use in a PropertyGrid. I found that by setting CategoryAttribute on each property it creates a new category for each item, obviously. This sets my property grid to have a [+] for each item with my custom name in it, and this isn't the behavior I'm trying to achieve.In Visual Studio, if you click on an item in the Solution Explorer, say, an assembly, it has zero tree nodes and just a list of perfectly-named properties, i.e. any string can identify a property, not just the object's name. So instead of having this:[+ File Path]    FilePath | propertyValue[+ File Size]    FileSize | 0 KBI'm looking for this:[+ File]    File Path | value    File Size | 0 KBOr even the above without the initial [+] node. I've poured through the System.ComponentModel namespace looking for an applicable attribute but I can't find one.How can I achieve this effect? It must be possible, Visual Studio does it and I believe they're the same component, not a derived and extended one. <code> ",Custom property names in PropertyGrid?
Design-Time drag and drop.," I'm currently working of a project where my part is to design a Design Surface where the end user can add/remove/move controls at run-time.I followed this tutorial ""Hosting Windows Forms Designers, by Tim Dawson"", and almost have implemented all the features I need.Short story for those who don't want to read the tutorial : I implemented IDesignerHost, IContainer, ISelectionService, IToolboxService and some other interface, to create my design surface. I didn't use the System.ComponentModel.Design.DesignSurface already in the framework, mainly beacause I need a really custom design surface.Question :I want to allow user to drag & drop new Control from the IToolboxService to the IDesignerHost/IContainer. In this tutorial, you clic on a Control in the toolbox, the click on the design surface to add the control.What i've found :There is a built-in feature thatautomagically does drag & drop fromIToolboxService toSystem.ComponentModel.Design.DesignSurface but it is clearly not working if you implement IDesignerHost from nothing.When you use theControl.DoDragDrop(ToolboxItem)method, to initiate a drag & drop :IToolboxService.SerializeToolboxItem(ToolboxItem)is called to serialize the item IToolboxService.IsToolboxItem(object)andIToolboxService.IsSupported(object)are called to evaluate if theserialized ToolboxItem can be allowedto be droped on the design surfaceWhen you drop the control : IToolboxService.DeserializeToolboxItem(object serializedObject) is called by the design surface to deserialize the controldropped.IToolboxService.SetCursor() is called to know if you define a custom cursor, or let the standard windows cursor.Problem :I implemented all mentionned above, in the ""What i've found"", but the drag & drop is buggy : I drag, everything's fine, but whenhovering the design surface, mycursor blink a little betweenstandard cursor and the""DragDropEffects.Copy"" style.When I drop, nothing happens, and when my cursor leave the design surface (after I dropped), then the new Control is created and added where I dropped it.Has anyone ever tried to do what I'm doing, and if so, how did you manage it ?Is there anyone that has any pointer/link/good advices ?Thank you =) <code> ",Design-Time drag and drop
C# Remove All Directory Permissions," In C# (2.0) How do I remove all permissions to a directory, so I can limit the access. I will be adding access back to a limited set of users. <code> ",Remove All Directory Permissions
Input on same line as output in c#?," For example:C:\> Input a number: 60Where the output would be ""Input a number: "" and the input would be ""60"".How do I get these to be on the same line?The problem is when I output ""Input a number: "", it automatically starts a new line, so the user inputs ""60"" underneath (on the next line). <code> ",Input on same line as output in C#
Overriding a private function with Reflection, Is it possible to override a private method by using Reflection in .NET 3.5? <code> ,Overriding a private method with Reflection
Can I make nUnit execute tests in random order?," Greetings, I would like to make NUnit execute my unit tests in a random order every time in order to ensure they are isolated and FIRST. Does anyone know of a easy way to do this well without branching NUnit?  <code> ",Can I make NUnit execute tests in random order?
Is it bad practice to nest 2 tries in C#?," Is the following code bad practice? I know from a program review point of view, other developers seeing 2 tries nested directly like that might wonder why, but is it totally taboo, or is it accepted practice now days?Thanks Guys, I agree with you all about the refactoring, going to create a seperate method for the sub functionality, the method was getting really long. I am very impressed to all of you who picked this up... <code>  try //Try Overall Operation { try //Try section 1 of operation { } catch(exception ex) { //handle exception code //throw the exception } catch (exception ex) { // send soap exception back to SOAP client. }",Is it bad practice to nest 2 try catch statements in C#?
C# using params and extension methods," Is the params keyword really not supported within extension methods?I have found that when I create extension methods with the params keyword, that I get ""No overloaded method for X takes 2 arguments"". Intellisense recognizes the extension method and even knows that it needs an object array. Here's some sample code: Here's some sample code that calls it (to no avail) <code>  public static DalRow EasyRetrieveSingle(this DalRow dalRow, object[] parameters) { Dictionary<string, object> dic = new Dictionary<string, object>(); for (int i = 0; i < parameters.Length; i += 2) dic.Add(parameters[i].ToString(), parameters[i + 1]); List<DalRow> list = DalRow.RetrieveByFieldValues(dalRow.Structure, null, dic).Cast<DalRow>().ToList(); if (list.Count == 0) return null; return list[0];} (new X()).EasyRetrieveSingle(1, 2);",C# params - ignore
Ignore Question," Is the params keyword really not supported within extension methods?I have found that when I create extension methods with the params keyword, that I get ""No overloaded method for X takes 2 arguments"". Intellisense recognizes the extension method and even knows that it needs an object array. Here's some sample code: Here's some sample code that calls it (to no avail) <code>  public static DalRow EasyRetrieveSingle(this DalRow dalRow, object[] parameters) { Dictionary<string, object> dic = new Dictionary<string, object>(); for (int i = 0; i < parameters.Length; i += 2) dic.Add(parameters[i].ToString(), parameters[i + 1]); List<DalRow> list = DalRow.RetrieveByFieldValues(dalRow.Structure, null, dic).Cast<DalRow>().ToList(); if (list.Count == 0) return null; return list[0];} (new X()).EasyRetrieveSingle(1, 2);",C# params - ignore
Ho to get custom attributes from an assembly that is not (really) loaded," We all know that the assembly can be queried for attributes using the GetCustomAttributes method. I want to use this to identify an extension module for my application. However, to avoid loading every assembly I prefer a defensive approach:using Assembly.ReflectionOnlyLoadFrom to get more details about an assembly (has it my ModuleAttribute?)if the ModuleAttribute is found, I will finally load it using Assembly.LoadFromUnfortunately it seems that there is no way to get the attributes from an assembly, that is loaded into the reflection-only context: fails with an InvalidOperationExceptionIt is illegal to reflect on the custom attributes of a Type loaded via ReflectionOnlyGetTypeand fails with ReflectionTypeLoadException because of dependant assemblies not being loaded.So how to get the attributes withoutpolluting my application domain with useless (maybe harmful) types by calling Assembly.LoadFromthe need to load all referenced assembliesthe need for separate application domains (gave it a short try, smelled like even more PITA)? <code>  myAssembly.GetCustomAttributes(typeof(ModuleAttribute), false) CustomAttributeData.GetCustomAttributes(myAssembly)",How to get custom attributes from an assembly that is not (really) loaded
How to detect where a Memory Leak is, I have a large website that seems to be sucking up all the memory that is being allocated. There is nothing else on the server beside this site. Within a week it eats away the 2 gigs and requires a restart. Currently this is server 2008 32 bit using IIS 7. We are reinstalling to use 64bit and add more memory. It would be nice to be able to track down where the leaks are occurring.So what is the best practice to tracking memory leaks? <code> ,How to detect where a Memory Leak is?
How can i easily convert DataReader to List<T> ?," I have data in a DataReader which I want to be converted to a List<T>.What is a possible simple solution for this?For e.g. in CustomerEntity class, I have CustomerId and CustomerName properties.If my DataReader returns these two columns as data, then how can I convert it into List<CustomerEntity>. <code> ",How can I easily convert DataReader to List<T>?
How can I easily convert DataReader to List<T> ?," I have data in a DataReader which I want to be converted to a List<T>.What is a possible simple solution for this?For e.g. in CustomerEntity class, I have CustomerId and CustomerName properties.If my DataReader returns these two columns as data, then how can I convert it into List<CustomerEntity>. <code> ",How can I easily convert DataReader to List<T>?
(C#) Set InnerException of Exception object," How can I set the InnerException property of an Exception object, while I'm in the constructor of that object? This boils down to finding and setting the backing field of a property that has no setter.BTW: I have seen this evain.net - Getting the field backing a property using Reflection but looking for non IL-based solution, if possible.The constructor of Exception is the place where the Exception type is created, so I cannot call it using the base class constructor MyException() :base(...) etc. <code> ",How to set the InnerException of custom Exception class from its constructor
Set InnerException of .NET Exception object," How can I set the InnerException property of an Exception object, while I'm in the constructor of that object? This boils down to finding and setting the backing field of a property that has no setter.BTW: I have seen this evain.net - Getting the field backing a property using Reflection but looking for non IL-based solution, if possible.The constructor of Exception is the place where the Exception type is created, so I cannot call it using the base class constructor MyException() :base(...) etc. <code> ",How to set the InnerException of custom Exception class from its constructor
How to set InnerException of .NET Exception object," How can I set the InnerException property of an Exception object, while I'm in the constructor of that object? This boils down to finding and setting the backing field of a property that has no setter.BTW: I have seen this evain.net - Getting the field backing a property using Reflection but looking for non IL-based solution, if possible.The constructor of Exception is the place where the Exception type is created, so I cannot call it using the base class constructor MyException() :base(...) etc. <code> ",How to set the InnerException of custom Exception class from its constructor
How to set InnerException of .NET custom Exception class from a constructor," How can I set the InnerException property of an Exception object, while I'm in the constructor of that object? This boils down to finding and setting the backing field of a property that has no setter.BTW: I have seen this evain.net - Getting the field backing a property using Reflection but looking for non IL-based solution, if possible.The constructor of Exception is the place where the Exception type is created, so I cannot call it using the base class constructor MyException() :base(...) etc. <code> ",How to set the InnerException of custom Exception class from its constructor
Compare two xml and print the different using LINQ ," I am comparing two xml and I have to print the difference. How can I achieve this using LINQ. I know I can use XML diff patch by Microsoft but I prefer to use LINQ . If you have any other idea I will implement that //First Xml //Second Xml I want to compare this two xml and print result like this. <code>  <Books> <book> <id=""20504"" image=""C01"" name=""C# in Depth""> </book> <book> <id=""20505"" image=""C02"" name=""ASP.NET""> </book> <book> <id=""20506"" image=""C03"" name=""LINQ in Action ""> </book> <book> <id=""20507"" image=""C04"" name=""Architecting Applications""> </book> </Books> <Books> <book> <id=""20504"" image=""C011"" name=""C# in Depth""> </book> <book> <id=""20505"" image=""C02"" name=""ASP.NET 2.0""> </book> <book> <id=""20506"" image=""C03"" name=""LINQ in Action ""> </book> <book> <id=""20508"" image=""C04"" name=""Architecting Applications""> </book></Books> Issued Issue Type IssueInFirst IssueInSecond1 image is different C01 C0112 name is different ASP.NET ASP.NET 2.03 id is different 20507 20508",Compare two xml and print the difference using LINQ 
ASP.NET MVC: How many repositorys?," I am in the process is designing a website in ASP.NET MVC and am perhaps a little confused as to the exact nature of a repository.Following the NerdDinner example, my site should have one repository which serves up the entities as I need them. However, I have also heard that you should have different repositorys that deal with specific sets of related entities....?In the case of my site, there will be a number of entities (around 15 tables) yet the majority are all related. Is it ok / advisable to have one repository that contains all the methods that I'll need for pulling / updating / deleting etc or should I split them down? <code> ",ASP.NET MVC: How many repositories?
"Getting lost in the world of encryption, please help"," I have a .NET application. I need to store a text value encrypted in a file, then retrieve the encrypted value somewhere else in the code, and decrypt it. I don't need the strongest or most secure encryption method on earth, just something that will suffice to say - I have the value encrypted, and am able to decrypt it.I've searched a lot on the net to try and use cryptography, but most of the examples I find, don't clearly define the concepts, and the worst part is they seem to be machine specific. Essentially, can someone please send a link to an easy to use method of encryption that can encrypt string values to a file, and then retrieve these values. <code> ",How would I do some simple file encryption and decryption?
C# Silverlight - Programmatically Navigate Between Pages?!," Say I have a C# Silverlight 3 application with a number of pages. The first page is called Home, and the second page is called Details. The only way to navigate to details is programmatically. How do I do this?! Looked everywhere for the answer and all i've found are xaml uri mapper implementations....Help greatly appreciated <code> ",C# Silverlight 3 - Programmatically Navigate Between Pages?!
Is it possible to iterate through method's parameters in C#?," I've been thinking that it would be useful to be able to do such a thing, for example, to check the parameters for null references and eventually throw an exception.This would save some typing and also would make it impossible to forget to add a check if a new parameter is added. <code> ",Iterate through method's parameters for validation purposes
When to use ref vs out," Someone asked me the other day when they should use the parameter keyword out instead of ref. While I (I think) understand the difference between the ref and out keywords (that has been asked before) and the best explanation seems to be that ref == in and out, what are some (hypothetical or code) examples where I should always use out and not ref. Since ref is more general, why do you ever want to use out? Is it just syntactic sugar? <code> ",When to use in vs ref vs out
Ho to get BackSpace - with only numbers limit in textbox ?," I insert this on KeyPress event: But I don't have the Backspace key, how to fix it? <code>  e.Handled = !Char.IsNumber(e.KeyChar);",How to get BackSpace - with only numbers limit in textbox?
C# - How to indicate when purposely ignoring a return value.," In some situations using C/C++, I can syntactically indicate to the compiler that a return value is purposely ignored: I find this to be a fair practice, firstly because most compilers won't generate a warning here, and secondly because it explicitly shows to future developers that the author made a conscious choice to ignore the return. It makes the author's trail of thought non ambiguous.As far as I know, the C# compiler won't complain about implicitly ignored return values, but I would like to know if there's a similar convention to use in order to make a clear indication to other developers.In response to some people here who questions the actual use of this convention (or that it would show bad design to have a method with a potentially unimportant return value).A real life .NET example (which I maybe should have based the question on from the start) is the Mutex::WaitOne() overload which takes no arguments. It will only return if the mutex was safely acquired, otherwise it never returns. The boolean return value is for the other overloads where you might end up not being in possession of the mutex when it returns.So along my reasoning, I would like to indicate in my multi-threaded code that I have made a choice to ignore the return: Since the return value never can be anything but true. <code>  int SomeOperation(){ // Do the operation return report_id;}int main(){ // We execute the operation, but in this particular context we // have no use of the report id returned. (void)SomeOperation();} Mutex mtx = new Mutex();(void)mtx.WaitOne();",How to indicate when purposely ignoring a return value
C# make a window topmost using a window handle," After launching an application using the Process class I'd like to make that window topmost. Currently, my app is the topmost window so when i launch the other app it doesn't display. One thing that came to mind is that I could set topmost = false for my application before launching the process, the problem with this is I want to give the process ample time to load up before displaying it to the user, so I'd like more control over when I switch the other application to the topmost. <code> ",Make a window topmost using a window handle
Will CLR handle both CLS-Complaint and non-CLS complaint exceptions?, Just for my clarification:Can I throw both CLS-compliant and non-CLS compliant exceptions in .NET Framework? I am using C# 3.0.When I catch an exception Will it catch only CLS-compliant exceptions?What is the use of RuntimeWrappedException class (can I have a simple example?). <code>  catch(Exception ex){},Will CLR handle both CLS-compliant and non-CLS compliant exceptions?
why do we prefer ? than ?? operator in c# ??," I recently found that we can use ?? operator to check nulls. Please check the below code samples: This is exactly similar to I checked my whole project source repository and some of other open source projects. And this ?? operator never been used.I just wondering is there any reason behind this, like performance problems or something?EDIT:I just updated my sample code based on the comments from recursive & Anton. Its a mistake in careless. :( <code>  var res = data ?? new data(); var res = (data==null) ? new data() : data ;",why do we prefer ? to ?? operator in c#?
Is global:: a bad code smell in C#?," From what I understand, the global:: qualifier allows you to access a namespace that has been hidden by another with the same name. The MSDN page uses System as an example. If you create your own namespace System, you can reach the original with global::System. The first thing that came to mind is, why would anyone call their namespace System?? The page goes on to say this is obviously not recommended, but namespace duplication is very possible in large projects. If/when this does occur, is it a sign that things are heading in the wrong direction, or are there valid reasons to have conflicting namespaces? <code> ",The use of global:: for conflicting namespaces
"CSharp : Monitor - Wait,Pulse,PulseAll "," I am having hard time in understanding Wait(), Pulse(), PulseAll(). Will all of them avoid deadlock? I would appreciate if you explain how to use them? <code> ","C# : Monitor - Wait,Pulse,PulseAll "
How to tell wether a point is right or left of a line," I have a set of points. I want to separate them into 2 distinct sets. To do this, I choose two points (a and b) and draw an imaginary line between them. Now I want to have all points that are left from this line in one set and those that are right from this line in the other set.How can I tell for any given point z whether it is in the left or in the right set? I tried to calculate the angle between a-z-b – angles smaller than 180 are on the right hand side, greater than 180 on the left hand side – but because of the definition of ArcCos, the calculated angles are always smaller than 180. Is there a formula to calculate angles greater than 180 (or any other formula to chose right or left side)? <code> ",How to tell whether a point is to the right or left side of a line
How to tell whether a point is to the right or left of a line," I have a set of points. I want to separate them into 2 distinct sets. To do this, I choose two points (a and b) and draw an imaginary line between them. Now I want to have all points that are left from this line in one set and those that are right from this line in the other set.How can I tell for any given point z whether it is in the left or in the right set? I tried to calculate the angle between a-z-b – angles smaller than 180 are on the right hand side, greater than 180 on the left hand side – but because of the definition of ArcCos, the calculated angles are always smaller than 180. Is there a formula to calculate angles greater than 180 (or any other formula to chose right or left side)? <code> ",How to tell whether a point is to the right or left side of a line
Using a single item for IEnumerable<T>," Is there a common way to pass a single item of type T to a method which expects an IEnumerable<T> parameter? Language is C#, framework version 2.0.Currently I am using a helper method (it's .Net 2.0, so I have a whole bunch of casting/projecting helper methods similar to LINQ), but this just seems silly: Other way would of course be to create and populate a List<T> or an Array and pass it instead of IEnumerable<T>.[Edit] As an extension method it might be named: Am I missing something here?[Edit2] We found someObject.Yield() (as @Peter suggested in the comments below) to be the best name for this extension method, mainly for brevity, so here it is along with the XML comment if anyone wants to grab it: <code>  public static class IEnumerableExt{ // usage: IEnumerableExt.FromSingleItem(someObject); public static IEnumerable<T> FromSingleItem<T>(T item) { yield return item; }} public static class IEnumerableExt{ // usage: someObject.SingleItemAsEnumerable(); public static IEnumerable<T> SingleItemAsEnumerable<T>(this T item) { yield return item; }} public static class IEnumerableExt{ /// <summary> /// Wraps this object instance into an IEnumerable&lt;T&gt; /// consisting of a single item. /// </summary> /// <typeparam name=""T""> Type of the object. </typeparam> /// <param name=""item""> The instance that will be wrapped. </param> /// <returns> An IEnumerable&lt;T&gt; consisting of a single item. </returns> public static IEnumerable<T> Yield<T>(this T item) { yield return item; }}",Passing a single item as IEnumerable<T>
C# .NET String object is really by reference?," I have being studying (newbie) .NET and I got some doubts.Reading from a book examples I learnt that String are object then Reference Type.So, I did this test and the result was different what I expected:I'm really curious, is this an exception because ""string"" are special types? Output: <code>  class Program{ static void Main(string[] args) { SByte a = 0; Byte b = 0; Int16 c = 0; Int32 d = 0; Int64 e = 0; string s = """"; Exception ex = new Exception(); object[] types = { a, b, c, d, e, s, ex }; // C# foreach (object o in types) { string type; if (o.GetType().IsValueType) type = ""Value type""; else type = ""Reference Type""; Console.WriteLine(""{0}: {1}"", o.GetType(), type); } // Test if change string str = ""I'll never will change!""; Program.changeMe(str); Console.WriteLine(str); } public static string changeMe(string param) { param = ""I have changed you!!!""; return """"; // no return for test }} System.SByte: Value typeSystem.Byte: Value typeSystem.Int16: Value typeSystem.Int32: Value typeSystem.Int64: Value typeSystem.String: Reference TypeSystem.Exception: Reference TypeI'll never will change!",String object is really by reference?
The methods xx use the same SOAPAction," We are trying to create a mock service for a web service for testing purposes.To do this we run wsdl.exe to create an interface and then create an asmx web service based on that interface. We have done this several times over the last years without any problems.This time we get an error:The methods xx and yy use the same SOAPActionWhen we call the web service. Have done some searching on google, it says that this is a bug with wsdl.exe. But says nothing about what to do about it.Is there a way to fix this? Should I just delete parts of references.cs?Thanks Shiraz <code> ",The methods xx and yy use the same SOAPAction
Is there any framework to populate test data?, I am use c# and for unit testing and integration testing usually I need to populate fields automatically based on attributes. Lets say we will test if we can write and get back user data to database. I create a user object populate fields write user to database Read user object from database Check fields if what I write is same as what I readIs there any framework to populate user with test data automatically and check if two object are have the same values?Sample code may like this  <code>  User user = new User();AutoPopulator.Populate(user);user.Save();,Is there any framework for .NET to populate test data?
How can I know the day name from a selected date?, I have this : Datetime.Now(); or 23/10/2009I want this : FridayFor local date-time (GMT-5) and using Gregorian calendar. <code> ,How to get the day name from a selected date?
How could i Drag and Drop DataGridView Rows under each other ?," I've DataGridView that bound a List<myClass> and i sort it by ""Priority"" property in ""myClass"".So I want to drag an ""DataGridViewRow"" to certain position to change it's ""Priority"" property.How could I ""Drag & Drop"" DataGridView Rows ?.And how to handle this ?. <code> ",How could I Drag and Drop DataGridView Rows under each other ?
how can i pass a method aquierd by reflection in C# to a struct that accepts the method as a delegate ?, I realize the title needs to be read more than once for understanding ... :)I implemented a custom attribute that i apply to methods in my classes.all methods i apply the attribute to have the same signature and thus i defined a delegate for them: I have a struct that accepts that delegate as a parameter Is it possible to get from reflection a method that has the custom attribute and pass it to the struct into the 'method' member ?I know you can invoke it but i think reflection won't give me the actual method from my class that i can cast to the TestMethod delegate. <code>  public delegate void TestMethod(); struct TestMetaData{ TestMethod method; string testName;},How can I pass a method acquired by reflection in C# to a method that accepts the method as a delegate?
Fix embedded resources for generic UserControl," During a refactoring, I added a generic type parameter to MyControl, a class derived from UserControl. So my class is now MyControl<T>.Now I get an error at runtime stating that the embedded resource file MyControl`1.resources cannot be found. A quick look with .NET Reflector shows that the resource file is actually called MyControl.resources, without the `1.At the start of the MyControl<T>.InitializeComponent method there is this line which is probably the one causing problems: How do I force the ComponentResourceManager to use the embedded resource file MyControl.resources? Other ways to resolve this issue are also welcome. <code>  System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager( typeof(MyControl<>));",Fix embedded resources for a generic UserControl
CRUD Class Library Design for possible use in a wcf service environment (possibly RESTful)," I'm building a basic CRUD library, that I anticipate use in both local (add reference) and wcf (add service reference) environments.What are the best return types for the Create, Uupdate, and Delete portions (that have more complex business rules) of a CRUD setup?I want to be able to minimize back-and-forth on the wire, but I also want to provide my clients with meaningful information about when an operation fails my business logic, but is technically valid (thus it's not an exception).Take for example the CRUD is for a Person class, which has these fields: FirstName, MiddleName LastName, and Date of Brith. First, Last, and DOB are required, but Middle is not.How should I convey failures of business logic back to the client? I.E. ""You must specify a value for FirstName.""Is this where I should be throwingexceptions? (it does not feel likean exceptional case, so I thinknot but I could be wrong).Should I use void and an ""out"" parameter? If so, what type should it be?Should I use an object return type and put data in there about what happens?Some other option that I've missed completely? <code> ","CRUD Class Library Design, to return useful messages about business logic failure, that is not exceptional"
Automatic resizing of the Windows From controls.," I'm using VS2008's designer for doing this.For example if I've a windows form of size say 500x500 and I added a DataGridView to it (490x490). when I run this program. and maximize the form, the DataGridView still remains of the same size. rest of the additional space is blank on the form. I want DataGridView to also take the entire window size.No software will be like that. I don't know what to change inorder get desired behaviour. <code> ",Automatic resizing of the Windows Forms controls.
How to Bind Blackout Days in WPF Toolkit Calendar control?, I'd like to bind a list of dates to the BlackoutDates property but it doesn't really seem to possible. Especially in a MVVM scenario. Has anyone accomplished something like this? Are there any good calendar controls that play nice with MVVM? <code> ,How to Bind BlackoutDates in WPF Toolkit Calendar control?
Using global keyboard hook (WH_KEYBOARD_LL) in WPF / C#.," I stitched together from code I found in internet myself WH_KEYBOARD_LL helper class:Put the following code to some of your utils libs, let it be YourUtils.cs: Which I use like this:App.xaml: App.xaml.cs: The problem is that it stops working after hitting keys a while. No error is raised what so ever, I just don't get anything to output after a while. I can't find a solid pattern when it stops working.Reproducing this problem is quiet simple, hit some keys like a mad man, usually outside the window.I suspect there is some evil threading problem behind, anyone got idea how to keep this working?What I tried already:Replacing return HookCallbackInner(nCode, wParam, lParam); with something simple.Replacing it with asynchronous call, trying to put Sleep 5000ms (etc).Asynchronous call didn't make it work any better, it seems stop always when user keeps single letter down for a while. <code>  using System;using System.Diagnostics;using System.Runtime.InteropServices;using System.Runtime.CompilerServices;using System.Windows.Input;namespace MYCOMPANYHERE.WPF.KeyboardHelper{ public class KeyboardListener : IDisposable { private static IntPtr hookId = IntPtr.Zero; [MethodImpl(MethodImplOptions.NoInlining)] private IntPtr HookCallback( int nCode, IntPtr wParam, IntPtr lParam) { try { return HookCallbackInner(nCode, wParam, lParam); } catch { Console.WriteLine(""There was some error somewhere...""); } return InterceptKeys.CallNextHookEx(hookId, nCode, wParam, lParam); } private IntPtr HookCallbackInner(int nCode, IntPtr wParam, IntPtr lParam) { if (nCode >= 0) { if (wParam == (IntPtr)InterceptKeys.WM_KEYDOWN) { int vkCode = Marshal.ReadInt32(lParam); if (KeyDown != null) KeyDown(this, new RawKeyEventArgs(vkCode, false)); } else if (wParam == (IntPtr)InterceptKeys.WM_KEYUP) { int vkCode = Marshal.ReadInt32(lParam); if (KeyUp != null) KeyUp(this, new RawKeyEventArgs(vkCode, false)); } } return InterceptKeys.CallNextHookEx(hookId, nCode, wParam, lParam); } public event RawKeyEventHandler KeyDown; public event RawKeyEventHandler KeyUp; public KeyboardListener() { hookId = InterceptKeys.SetHook((InterceptKeys.LowLevelKeyboardProc)HookCallback); } ~KeyboardListener() { Dispose(); } #region IDisposable Members public void Dispose() { InterceptKeys.UnhookWindowsHookEx(hookId); } #endregion } internal static class InterceptKeys { public delegate IntPtr LowLevelKeyboardProc( int nCode, IntPtr wParam, IntPtr lParam); public static int WH_KEYBOARD_LL = 13; public static int WM_KEYDOWN = 0x0100; public static int WM_KEYUP = 0x0101; public static IntPtr SetHook(LowLevelKeyboardProc proc) { using (Process curProcess = Process.GetCurrentProcess()) using (ProcessModule curModule = curProcess.MainModule) { return SetWindowsHookEx(WH_KEYBOARD_LL, proc, GetModuleHandle(curModule.ModuleName), 0); } } [DllImport(""user32.dll"", CharSet = CharSet.Auto, SetLastError = true)] public static extern IntPtr SetWindowsHookEx(int idHook, LowLevelKeyboardProc lpfn, IntPtr hMod, uint dwThreadId); [DllImport(""user32.dll"", CharSet = CharSet.Auto, SetLastError = true)] [return: MarshalAs(UnmanagedType.Bool)] public static extern bool UnhookWindowsHookEx(IntPtr hhk); [DllImport(""user32.dll"", CharSet = CharSet.Auto, SetLastError = true)] public static extern IntPtr CallNextHookEx(IntPtr hhk, int nCode, IntPtr wParam, IntPtr lParam); [DllImport(""kernel32.dll"", CharSet = CharSet.Auto, SetLastError = true)] public static extern IntPtr GetModuleHandle(string lpModuleName); } public class RawKeyEventArgs : EventArgs { public int VKCode; public Key Key; public bool IsSysKey; public RawKeyEventArgs(int VKCode, bool isSysKey) { this.VKCode = VKCode; this.IsSysKey = isSysKey; this.Key = System.Windows.Input.KeyInterop.KeyFromVirtualKey(VKCode); } } public delegate void RawKeyEventHandler(object sender, RawKeyEventArgs args);} <Application ... Startup=""Application_Startup"" Exit=""Application_Exit""> ... public partial class App : Application{ KeyboardListener KListener = new KeyboardListener(); private void Application_Startup(object sender, StartupEventArgs e) { KListener.KeyDown += new RawKeyEventHandler(KListener_KeyDown); } void KListener_KeyDown(object sender, RawKeyEventArgs args) { Console.WriteLine(args.Key.ToString()); // I tried writing the data in file here also, to make sure the problem is not in Console.WriteLine } private void Application_Exit(object sender, ExitEventArgs e) { KListener.Dispose(); }}",Using global keyboard hook (WH_KEYBOARD_LL) in WPF / C#
"Up, Down, Left and Right arrow are not catch by KeyDown", I am building an application where all the key input must be handled by the windows itself.I set tabstop to false for each control witch could grab the focus except a panel (but I don't know if it has effect).I set KeyPreview to true and I am handling the KeyDown event on this form.My problem is that sometimes the arrow key aren't responsive anymore:The keydown event is not fired when I pressed only an arrow key.The keydown event is fired if I press an arrow key with the control modifier.Have you an idea why my arrow key suddenly stop firing event? <code> ,"Up, Down, Left and Right arrow keys do not trigger KeyDown event"
"In C#, how can I force the format of dates in a DropDownList to ""DD/MM/YYYY""?"," I have to build a DropDownList with the dates of the last 7 days. I would like the DropDownList displays the date as ""DD/MM/YYYY"". So I created a list of dates: I add my dates as DateTime, not as strings. I think it is the method ToString() of my DateTime object that is called to create text that is visible in my DropDownList. By default it is the date and time. The result is: [0]: {16/07/2008 11:08:27} [1]: {15/07/2008 11:08:27} [2]: {14/07/2008 11:08:27} [3]: {13/07/2008 11:08:27} [4]: {12/07/2008 11:08:27} [5]: {11/07/2008 11:08:27} [6]: {10/07/2008 11:08:27}How can I force the format to ""DD/MM/YYYY""? <code>  DateTime date = DateTime.Now;List<DateTime> dates = new List<DateTime>();for (int i = 0; i < HISTORY_LENGTH; i++){ dates.Add(date.AddDays(-i));}DropDownList.DataSource = dates;DropDownList.DataBind();","In ASP.NET, how can I force the format of dates in a DropDownList to ""DD/MM/YYYY""?"
Where do I tie my custom membership provider into my ASP.NET MVC application?," How do I tie up my custom membership provider with my ASP.NET MVC [Authorize()] attribute? I've blasted through a number of tutorials for how to create a custom membership provider but all the information I've found about how to hook it up to an application seems to revolve around regular ASP.NET WebForms applications which seem to be a piece of cake.I'm coming unstuck with the amount of ""magic"" that just happens in ASP.NET MVC which is great, but I'm used to plugging stuff in in a WebForms way so this ""it just works"" methodology is a bit of a mind bender for me. How do I know when I'm supposed to do the heavy lifting or I'm supposed to just rely on it happening by magic?Where do I tie my provider in to an MVC app? Am I right in assuming that it is invoked through the [Authorize()] attribute once I do get it hooked up? <code> ",How can I attach a custom membership provider in my ASP.NET MVC application?
Converting observable collection to List - C#, How does one convert an ObservableCollection to a List of the held objects? <code> ,Converting ObservableCollection to List?
Converting observable collection back to regular collection, How does one convert an ObservableCollection to a List of the held objects? <code> ,Converting ObservableCollection to List?
What is a value class and what is a reference class ?," What is the definition of a value class and reference class in C#?How does this differ from a value type and reference type?I ask this question because I read this in the MCTS Self-Paced Training Kit (Exam 70-536). Chapter 1, Lesson 1, Lesson review 4 : You need to create a simple class or structure that contains only value types. You must create the class or structure so that it runs as efficiently as possible. You must be able to pass the class or structure to a procedure without concern that the procedure will modify it. Which of the following should you create? A reference class B reference structure C value class D value structure Correct Answer: D A Incorrect: You could create a reference class; however, it could be modified when passed to a procedure. B Incorrect: You cannot create a reference structure. C Incorrect: You could create a value class; however, structures tend to be more efficient. D Correct: Value structures are typically the most efficient. <code> ",What is a Value Class and what is a reference Class in C#?
What is a Value Type and what is a reference type in C#?," What is the definition of a value class and reference class in C#?How does this differ from a value type and reference type?I ask this question because I read this in the MCTS Self-Paced Training Kit (Exam 70-536). Chapter 1, Lesson 1, Lesson review 4 : You need to create a simple class or structure that contains only value types. You must create the class or structure so that it runs as efficiently as possible. You must be able to pass the class or structure to a procedure without concern that the procedure will modify it. Which of the following should you create? A reference class B reference structure C value class D value structure Correct Answer: D A Incorrect: You could create a reference class; however, it could be modified when passed to a procedure. B Incorrect: You cannot create a reference structure. C Incorrect: You could create a value class; however, structures tend to be more efficient. D Correct: Value structures are typically the most efficient. <code> ",What is a Value Class and what is a reference Class in C#?
How to communicate between two forms in C#?," I have two forms, one is the main form and the other is an options form. So say for example that the user clicks on my menu on the main form: Tools -> Options, this would cause my options form to be shown.My question is how can I send data from my options form back to my main form? I know I could use properties, but I have a lot of options and this seems like an tedious odd thing to do. So what is the best way? <code> ",Communicate between two windows forms in C#
system.drawing.image to stream c#, I have a System.Drawing.Image in my program. The file is not on the file system it is being held in memory. I need to create a stream from it. How would I go about doing this? <code> ,System.Drawing.Image to stream C#
Iso-lines to 3D Surface Generation," I have a set of isoline points (or contour points) such as this:Each point on an isoline has its own respective X, Y, and Z coordinate. Since they are isolines, that means that each point will have a unique X-Y pair, but points on the same line will have the same Z coordinate.Now, is there any algorithm or any software packages (either in C# or C++ or MATLAB) that I can use to interpolate the isoline points into a full 3-D surface?P/S: I am not just interested in the final output, I am interested in getting the interpolated surface data so that I can plot the surface myself.Edit: C++ solutions are welcomed as well. <code> ",How Do I Generate a 3-D Surface From Isolines?
eliminate duplicates ienumerable, I have this code: I want to convert list to a dictionary like this: but it tells me I have duplicate keys. How can I keep only the first item for each key? <code>  class MyObj { int Id; string Name; string Location;}IEnumerable<MyObj> list; list.ToDictionary(x => x.Name);,Filtering duplicates out of an IEnumerable
C# Array of Buttons.," How do I build an array of buttons in a Winforms application?What I am trying to do is this: I have a lot of buttons in a sort of calendar arrangement, that are indicating time slots. IE: Monday0700Button, Monday0730Button, Monday0800Button, and so on in 30min intervals.I have a xml database, where one of the fields for appointments is <Duration> When the duration = 0.5hrs, and the <Time> field equals ""07:00am"", to color the 'Monday0700Button'. When the Duration is 1.0hrs, I want it to populate 'Monday0700Button' as well as the following time slot button of 'Monday0730Button'.Any ideas?Thanks. <code> ",How do I create a C# Array of Buttons?
How to write FireFox plugin with Visual Studio using C# programming language?," I was wondering if it's possible to write Firefox extension using .Net Framework?Had anybody such experience in writing Firefox extensions using C# programming language?Any good sites or guidelines would be very helpful.FFPlugin http://img81.imageshack.us/img81/3049/ffplugin.jpgHere is an example of what I need. Extension to enter phone number and to send SMS Message.I draw it in Paint, so I'm sorry for having no artistic touch. <code> ",How to write FireFox extension with Visual Studio using C# programming language?
COM Interop registration problem," I have a .NET assembly which I am exposing to COM. The assembly has two public interfaces and one public class. When I build the assembly I get this warning: (assemblyName.dll) does not contain any types that can be registered for COM Interop.My assembly information includes the following line. Most people having this problem on the web, that I have found, fixed it with the above line in their assembly information. This has not helped for me.I also tried adding [ComVisible(true)] to the class and interface definitions, and it also did not help. <code>  [assembly: ComVisible(true)]",COM Interop registration
What ORM for .net should I use?," I'm relatively new to .NET and have being using Linq2Sql for a almost a year, but it lacks some of the features I'm looking for now. I'm going to start a new project in which I want to use an ORM with the following characteristics:It has to be very productive, I don't want to be dealing with the access layer to save or retrieve objects from or to the database, but it should allows me to easily tweak any object before actually commit it to the database; also it should allows me to work easily with a changing database schemaIt should allows me to extend the objects mapped from the database, for example to add virtual attributes to them (virtual columns to a table)It has to be (at least almost) database agnostic, it should allows me to work with different databases in a transparent wayIt has to have not so much configuration or must be based on conventions to make it workIt should allows me to work with LinqSo, do you know any ORM that I could use? Thank you for your help.EDIT I know that an option is to use NHibernate. This appears as the facto standard for enterprise level applications, but also it seems that is not very productive because its deep learning curve. In other way, I have read in some other post here in SO that it doesn't integrate well with Linq. Is all of that true? <code> ",What ORM for .NET should I use?
the difference between try/catch/throw and try/catch(e)/throw e, What is the difference between and ?And when should I use one or the other? <code>  try { }catch{ throw; } try { }catch(Exception e){ throw e;},The difference between try/catch/throw and try/catch(e)/throw e
How to sort an ASp.net MVC dropdownlist?," I have this code This will be used for binding with the asp.net mvc html helper. However I want to sort it before I bind it. How could i do this? <code>  List<SelectListItem> list = new List<SelectListItem>() { new SelectListItem() { Text = ""bob"", Value = ""bob""}, new SelectListItem() { Text = ""apple"", Value = ""apple""}, new SelectListItem() { Text = ""grapes"", Value = ""grapes""}, };",How to sort an ASP.NET MVC dropdownlist?
Getting a Method's Return Value in the VS Dubugger," Is it possible to get a method's return value in the Visual Studio debugger, even if that value isn't assigned to a local variable? For example, I'm debugging the following code: Since I'm not setting any local variables in Foo, and assuming I'm not setting a break point in whatever's calling Foo, is there a way to see what the return value is if I have a breakpoint inside of Foo (or another way)? I don't have much experience with the Autos or Intermediate windows, so I'm not sure if those are even a valid option or not. <code>  public string Foo(int valueIn){ if (valueIn > 100) return Proxy.Bar(valueIn); else return ""Not enough"";}",Getting a Method's Return Value in the VS Debugger
C# and ffmpeg without invoking shell commands," I'd like to be able to use FFmpeg to convert a video file from within my C# program. I know I can just call a shell command, but is there a better way? The issue with invoking a command via the shell, is I'm not sure you could do things like a progress bar, etc... or could you?If there isn't a way, can anyone suggest the best way to layout some framework for executing shell commands. Passing one big long string is very cumbersome atm. <code> ",C# and FFmpeg preferably without shell commands?
C# and ffmpeg preferably without shell commands?," I'd like to be able to use FFmpeg to convert a video file from within my C# program. I know I can just call a shell command, but is there a better way? The issue with invoking a command via the shell, is I'm not sure you could do things like a progress bar, etc... or could you?If there isn't a way, can anyone suggest the best way to layout some framework for executing shell commands. Passing one big long string is very cumbersome atm. <code> ",C# and FFmpeg preferably without shell commands?
What is a predicate in c# ?," I am very new to using predicates and just learned how to write: What will the predicate return, and how is it useful when programming? <code>  Predicate<int> pre = delegate(int a){ a %2 == 0 };",What is a predicate in c#?
Sublist in C sharp, I have a List<String> and i need to take a sublist out of this list. Is there any methods of List available for this in .NET 3.5? <code> ,How to Get a Sublist in C#
VB to C# Operators, Which are the equivalent of the following operators from VB.Net to C#?UBound()LBound()IsNothing()Chr()Len()UCase() LCase()Left()Right()RTrim()LTrim()Trim()Mid()Replace()Split() Join()MsgBox() IIF() <code> ,VB to C# Functions
Why can I split and trim a string into parts all on one line?," I want to split this line: into an array of their trimmed versions: How can I do this all on one line? The following gives me an error ""cannot convert type void"": <code>  string line = ""First Name ; string ; firstName""; ""First Name""""string""""firstName"" List<string> parts = line.Split(';').ToList().ForEach(p => p.Trim()); ",How can I split and trim a string into parts all on one line?
C#-Events of interface practical use, What is a good example of the power of interface events (declaring events inside interface)?Most of the times I have seen only public abstract methods inside interface. <code> ,Practical use of interface events
C# - how to determine whether a Type is a number , Is there a way to determine whether or not a given .Net Type is a number? For example: System.UInt32/UInt16/Double are all numbers. I want to avoid a long switch-case on the Type.FullName. <code> ,C# - how to determine whether a Type is a number
C# Form resx usage for programmatic strings?," Had a basic WinForm question: By default a resx file is created for every form or user control (along with the designer.cs). This resx works fine for all the controls and the text added to the controls via the UI.I was wondering if I could use the same resx to add strings which have to be used programmatically and based on conditions, attached to the controls? Will the resx get overridden in any case and this custom strings be removed? What is the best practice to follow in this case? <code> ",Form resources usage for programmatic strings?
Form resouces usage for programmatic strings?," Had a basic WinForm question: By default a resx file is created for every form or user control (along with the designer.cs). This resx works fine for all the controls and the text added to the controls via the UI.I was wondering if I could use the same resx to add strings which have to be used programmatically and based on conditions, attached to the controls? Will the resx get overridden in any case and this custom strings be removed? What is the best practice to follow in this case? <code> ",Form resources usage for programmatic strings?
SmtpClient.SendAsync - How to ensure my application doesn't finish before callback?," I need to send emails asychronously through a console application. I need to do some DB updates on the callback but my application is exiting before the callback code gets run!How can I stop this from happening in a nice manner rather than simply guessing how long to wait before exiting. I would imagine the Async calls get placed in some form of thread? Is it possible to check if any are waiting to be called?Sample Code <code>  private static void SendCompletedCallback(object sender, AsyncCompletedEventArgs e){ // Get the unique identifier for this asynchronous operation. String token = (string) e.UserState; if (e.Cancelled) { Console.WriteLine(""[{0}] Send canceled."", token); } if (e.Error != null) { Console.WriteLine(""[{0}] {1}"", token, e.Error.ToString()); } else { // update DB Console.WriteLine(""Message sent.""); }}public static void Main(string[] args){ var users = Repository.GetUsers(); SmtpClient client = new SmtpClient(""Host""); client.SendCompleted += new SendCompletedEventHandler(SendCompletedCallback); MailAddress from = new MailAddress(""system@domain.com"", ""System"", Encoding.UTF8); foreach (var user in users) { MailAddress to = new MailAddress(user.Email); MailMessage message = new MailMessage(from, to); message.Body = ""This is a test""; message.BodyEncoding = System.Text.Encoding.UTF8; message.Subject = ""test message 1"" + someArrows; message.SubjectEncoding = System.Text.Encoding.UTF8; string userState = String.Format(""Message for user id {0}"", user.ID); client.SendAsync(message, userState); message.Dispose(); } // need to wait here until I have received a callback for each message // otherwise the application will exit}",SmtpClient.SendAsync - How to stop the application exiting before the callback is triggered?
c#: transcribe wav file to text (speech-to-text) with System.Speech namespaces," How do you use the .NET speech namespace classes to convert audio in a WAV file to textual form which I can display on the screen or save to file?I am looking for some tutorial samples.UPDATEFound a code sample here. But when I tried it it gives incorrect results. Below is the vb code sample I've adopted. (Actually I don't mind the lang as long as its either vb/c#...). It is not giving me proper results. I assume if we put the right grammar - i.e. the words we expect in the recording - we should get the textual output of that. First I've tried with sample words that are in the call. It sometimes printed only that (one) word and nothing else. Then I tried words which we totally do not expect in the recording...Unfortunately it printed out that too... :( UPDATE(after Nov 28th)Found a way to load a default grammar. It goes something like this: There are still problems here. The recognition is not exact. The output is rubbish. For a 6min file it gives probably 5-6 words of text totally irrelevant to the voice file. <code>  Imports SystemImports System.Speech.RecognitionPublic Class Form1 Dim WithEvents sre As SpeechRecognitionEngine Private Sub btnLiterate_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnLiterate.Click If TextBox1.Text.Trim.Length = 0 Then Exit Sub sre.SetInputToWaveFile(TextBox1.Text) Dim r As RecognitionResult r = sre.Recognize() If r Is Nothing Then TextBox2.Text = ""Could not fetch result"" Return End If TextBox2.Text = r.Text End Sub Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click TextBox1.Text = String.Empty Dim dr As DialogResult dr = OpenFileDialog1.ShowDialog() If dr = Windows.Forms.DialogResult.OK Then If Not OpenFileDialog1.FileName.Contains(""wav"") Then MessageBox.Show(""Incorrect file"") Else TextBox1.Text = OpenFileDialog1.FileName End If End If End Sub Public Sub New() ' This call is required by the Windows Form Designer. InitializeComponent() sre = New SpeechRecognitionEngine() End Sub Private Sub sre_LoadGrammarCompleted(ByVal sender As Object, ByVal e As System.Speech.Recognition.LoadGrammarCompletedEventArgs) Handles sre.LoadGrammarCompleted End Sub Private Sub sre_SpeechHypothesized(ByVal sender As Object, ByVal e As System.Speech.Recognition.SpeechHypothesizedEventArgs) Handles sre.SpeechHypothesized System.Diagnostics.Debug.Print(e.Result.Text) End Sub Private Sub sre_SpeechRecognitionRejected(ByVal sender As Object, ByVal e As System.Speech.Recognition.SpeechRecognitionRejectedEventArgs) Handles sre.SpeechRecognitionRejected System.Diagnostics.Debug.Print(""Rejected: "" & e.Result.Text) End Sub Private Sub sre_SpeechRecognized(ByVal sender As Object, ByVal e As System.Speech.Recognition.SpeechRecognizedEventArgs) Handles sre.SpeechRecognized System.Diagnostics.Debug.Print(e.Result.Text) End Sub Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load Dim words As String() = New String() {""triskaidekaphobia""} Dim c As New Choices(words) Dim grmb As New GrammarBuilder(c) Dim grm As Grammar = New Grammar(grmb) sre.LoadGrammar(grm) End SubEnd Class sre.LoadGrammar(New DictationGrammar)",C#: transcribe WAV file to text (speech-to-text) with System.Speech namespaces
Why does this IF statement returns false?," I have two text boxes and I want skip a block of code only when both are empty: If either of the text boxes has something, I want the //Do something part to execute. Only when both are empty do I want to skip.However the above code fragment doesn't work. Why? <code>  if (txtBox1.Text.Trim() != string.Empty && txtBox2.Text.Trim() != string.Empty ){ // Do something}",Why does this IF statement return false?
Cast/Convert IEnumerable<T> to IEnumberable<U> ?," The following complies but at run time throws an exception. What I am trying to do is to cast a class PersonWithAge to a class of Person. How do I do this and what is the work around? EDIT: By the way PersonWithAge will always contain the same properties as Person plus a couple more.EDIT 2 Sorry guys but I should have made this a bit clearer, say I have two db views in a database that contains the same columns but view 2 contains 1 extra field. My model view entities are generated by a tool that mimics the database views. I have a MVC partial view that inherits from one of the class entities but I have more than one way to grab data...Not sure if this helps but it means that I cant make personWithAge inherit from person. <code>  class Person{ public int Id { get; set; } public string Name { get; set; }}class PersonWithAge{ public int Id { get; set; } public string Name { get; set; } public int Age { get; set; }}class Program{ static void Main(string[] args) { IEnumerable<PersonWithAge> pwa = new List<PersonWithAge> { new PersonWithAge {Id = 1, Name = ""name1"", Age = 23}, new PersonWithAge {Id = 2, Name = ""name2"", Age = 32} }; IEnumerable<Person> p = pwa.Cast<Person>(); foreach (var i in p) { Console.WriteLine(i.Name); } }}",Cast/Convert IEnumerable<T> to IEnumerable<U> ?
HyperLink with NavigateUrl with Eval(). Where is a mistake?," First I was changing HyperLink.NavigateUrl in code-behind on Page_Load().But after I decided to do it in design using Eval() method. or where id and type - are variables from Request.But it doesn't work. Only raw text 'Refuse' is shown. Where is my mistake? Thanks in advance. <code>  <asp:HyperLink runat=""server"" NavigateUrl='<%# String.Format(""~/Refuse.aspx?type={0}&id={1}"", Eval(""type""), Eval(""id"")) %>' Text=""Refuse"" /> <asp:HyperLink ID=""urlRefuse"" runat=""server"" NavigateUrl='<%# String.Format(""~/Refuse.aspx?type={0}&id={1}"", Request[""type""], Request[""id""]) %>' Text=""Refuse"" />",HyperLink with NavigateUrl with Eval(). Where is the mistake?
Change image using tigger WPF MVVM," This may be a no brainier but I just can't seem to get it to work. I have a view model that exposes a property called bool NotFound I would like to bind that to a trigger so that when it changes an image on my control changes.This is the xaml that I am using as a data template for one of my view models. I would like to be able to bind the to the NotFound property and change the image source. <code>  <DataTemplate DataType=""{x:Type local:TabFileViewModel}""> <StackPanel Orientation=""Horizontal""> <Image Width=""16"" Height=""16"" Margin=""3,0"" Source=""Image\TabFile.PNG"" /> <TextBlock Text=""{Binding Name}"" ToolTip=""{Binding FullPath}""/> </StackPanel></DataTemplate>",Change image using trigger WPF MVVM
how to  programatically change the backgroundimage on form c#," I need to change the background image of my form when i klick a button, and change it back to null again the second time it is clicked, how can i do this? <code> ",how to programmatically change the background image on form c#
How i can learn asp.net . are you suggest me best way to learning," I am an absolute beginner at ASP.NET. How can I learn it better? Currently I am reading ebooks. Can you suggest better ways, or other ways, I can learn ASP.NET? <code> ",How can I learn ASP.NET?
how to add a new row to an existing table usign c# sql server," I need to write a program. A part of the program is to write to an sql database (.mdf).I had a lot of trouble trying to add a new row to my table (called: ""Data""). Here is the code: I execute this code, but the data didn't get saved to the table. Does anyone know how to enter a new row to the table and to save it? <code>  ...DataSet ds = new DataSet();System.Data.SqlClient.SqlDataAdapter da;DataRow dRow;string sql = ""SELECT * From Data"";da = new System.Data.SqlClient.SqlDataAdapter(sql, con);...System.Data.SqlClient.SqlCommandBuilder cb;cb = new System.Data.SqlClient.SqlCommandBuilder(da);dRow = ds.Tables[""Data""].NewRow();dRow[0] = ""my_data1"";dRow[1] = ""my_data2"";dRow[2] = ""my_data3"";...ds.Tables[""Data""].Rows.Add(dRow);da.Update(ds, ""Data"");...",How to add a new row to an existing table using c# sql server
asp.net programmatically add a span tag? Not Label control," How can I add a span tag from a code behind? Is there an equivalent HtmlControl? I am currently doing it this way. I am building out rows to a table in an Itemplate implementation. I know I could use new Label(), but I am trying to avoid a server control here. Am I correct in using the LiteralControl this way? Does anyone have any better ideas of how to do this? <code>  var headerCell = new TableHeaderCell { Width = Unit.Percentage(16)};var span = new LiteralControl(""<span class='nonExpense'>From<br/>Date</span>"");headerCell.Controls.Add(span);headerRow.Cells.Add(headerCell);","Programmatically add a span tag, not a Label control?"
Change Entity framework database at runtime," In most asp.net applications you can change the database store by modifing the connectionstring at runtime. i.e I can change from using a test database to a production database by simply changing the value of the ""database"" field in the connectionstringI'm trying to change the schema (but not necessarily the database itself) with entity framework but no luck.The problem I'm seeing is the that the SSDL content in the edmx xml file is storing the schema for each entityset.see below Now I have changed the schema attribute value to ""prod"" from test and it works.. But this does not seem to be a good solution.I need to update evert entity set as well as stored procedures ( I have +50 tables )I can only do this an compile time?If I then try to later update the Entity model-entityies that already exist are being read due to EF not recognizing that the table already exists in the edm.Any thoughts? <code>  <EntitySet Name=""task"" EntityType=""hardModel.Store.task"" store:Type=""Tables"" Schema=""test"" />",Change Entity framework database schema at runtime
How to call a .NET dll from a win32 process?," What are the options when it comes to using a .NET DLL from a Win32 process?I need to basically use a C# DLL from a Win32 process.I have a possible solution right now that requires adding the C# DLL to the GAC (using RegAsm.exe), then calling the C# DLL via COM wrapped calls. However that solution is pretty heavy. It requires that the .NET DLL be added to the GAC on all machines that are supposed to run this Win32 process.Would it be possible to do this without having to call RegAsm prior to being able to use the C# DLL? <code> ",How to call a .NET DLL from a Win32 process?
C# -Generic Extension Method," I want to develop a Generic Extension Method which should arrange the string in alphabetical then by lengthwise ascending order.I mean What is the way to develop Generic Extension Method?I tried : I received :Error 1: T does not contain definition for LengthError 2: can not convert System.Linq.IOrderedEnumerable to T[]. <code>  string[] names = { ""Jon"", ""Marc"", ""Joel"", ""Thomas"", ""Copsey"",""Konrad"",""Andrew"",""Brian"",""Bill""};var query = names.OrderBy(a => a.Length).ThenBy(a => a); public static class ExtensionOperation { public static T[] AlphaLengthWise<T>(this T[] names) { var query = names.OrderBy(a => a.Length).ThenBy(a => a); return query; } }",How to create a generic extension method?
What is faster or preferred: IEnumerable<>.ToArray() or .ToList()?," Possible Duplicate: Is it better to call ToList() or ToArray() in LINQ queries? I have code like this: which method is preferred?I could go without any but I need to know the size and I don't want to call Enumerable.Count<T>() - it seems do do more actions then Array<T>.Size or List<T>.Count. Am I right? <code>  void Foobar(string[] arr, Dictionary<string, string[]>){ var t = arr.Intersect(dic.Keys).ToList(); // .or ToArray() ? foreach(var item in t) { .. } var j = t.Count; // also I need this}",I need to iterate and count. What is fastest or preferred: ToArray() or ToList()?
"Help, what is a good 2D Graphics Framework, for a Drawing Application?"," I am trying to build a raster drawing application using C# and so far I have not been able to locate any versatile light weight 2D graphics frameworks, or guides. I was hoping a few of you would be able to give me a good head start because currently my choices are using GDI+ or WPF and that is about it :(...Basically I need something simple that will provide me with the ability to create a Canvas, Layers, Brushes, and the ability to import/export all of these things. I have looked through several graphic applications to see how they implemented their tools and looked online for books and have come out with no knowledge about where to begin.Thank You,Andrew <code> ","What is a good 2D graphics framework, for a drawing application?"
function that returning index position of string after match found C#, I have strings of 15 characters long. I am performing some pattern matching on it with a regular expression. I want to know the position of the substring where the IsMatch() function returns true.Question: Is there is any function that returns the index of the match? <code> ,Is there a function that returns index where RegEx match starts?
How can I lower the spam score of my ," I am sending a new logon and password to a user, however when I do on a test version of our site on the internet the Spam score is 4.6 by spam assassin. Which means it gets trapped.The Email is HTML (so the marketing dept have their nice fonts and colours) with a linked image.The MailMessage() object does not appear to give me a lot of control over the output format of the message.What measures could I take to lower the spam score?I am sending using this: The spam score is this: <code>  /* send an email */MailMessage msg = new MailMessage();msg.IsBodyHtml = true;//msg.BodyEncoding = Encoding.UTF8;msg.To.Add(new MailAddress(sToEmail));msg.From = new MailAddress(sFromEmail);msg.Subject = sEmailSubject;msg.Body = sEmailTemplate;try{ client.Send(msg);} X-Spam-Score: 4.6 (++++)X-Spam-Report: Spam detection software report (4.6 points): pts rule name description ---- ---------------------- -------------------------------------------------- 1.8 HTML_IMAGE_ONLY_20 BODY: HTML: images with 1600-2000 bytes of words 0.0 HTML_MESSAGE BODY: HTML included in message 1.7 MIME_HTML_ONLY BODY: Message only has text/html MIME parts 1.1 HTML_MIME_NO_HTML_TAG HTML-only message, but there is no HTML tag 0.1 RDNS_NONE Delivered to trusted network by a host with no rDNS",How can I lower the spam score of my email message?
"C#: How to Delete the matching substring between 2 strings? or How to ""subtract"" two strings?"," If I have two strings ..say string1=""Hello Dear c'Lint""and string2=""Dear"".. I want to Compare the strings first and delete the matching substring .. the result of the above string pairs is: ""Hello  c'Lint""(i.e, two spaces between ""Hello"" and ""c'Lint"") for simplicity, we'll assume that string2 will be the sub-set of string1 .. (i mean string1 will contain string2).. <code> ",C#: How to Delete the matching substring between 2 strings?
C#: How to communicate with SFTP server," I've written a service for our customer that automatically transmits files to given destinations using FTP. For historic reasons I'm using WinInet to perform the FTPing. All works well, but now the customer wants to add one destination that only accepts SFTP connections.I do not really like the idea of implementing this from scratch, so is there a way to communicate natively or through WinInet with a SFTP server? Are there any system libraries that I can use (I have no fear of P/Invoke :) )? Do I have to purchase third party components for that - if so, which ones would you suggest? <code> ",How to communicate with SFTP server
quickest way to remove one array of items from another," I have two arrays of strings: I want to generate a new string array with c and d which is all - taken.Any quick way in .net 3.5 to do this without a manual loop and creating new lists? <code>  string[] all = new string[]{""a"", ""b"", ""c"", ""d""} string[] taken = new string[]{""a"", ""b""}",What is the quickest way to remove one array of items from another?
"declare a variable inside or outside an foreach-loop, which is faster/better?"," Which one of these is the faster/better one?This one: Or this one: My newbie-developing skills tells me the first one is better, but a friend of mine tells me im wrong, but could not give me a good reason why the second one is better.Is there any difference in performance at all? <code>  List<User> list = new List<User>();User u;foreach (string s in l){ u = new User(); u.Name = s; list.Add(u);} List<User> list = new List<User>();foreach (string s in l){ User u = new User(); u.Name = s; list.Add(u);}",Declaring a variable inside or outside an foreach loop: which is faster/better?
How Guid is generated? Combination of numbers and letters or numbers alone??, How are GUIDs generated in C#? <code> ,How does C# generate GUIDs?
WPF - Remove forward entry on Navigation service?," How would one remove all the forward entries in a navigation service?I tried this but it is crashing. I know ""RemoveBackEntry()"" seems odd but there is no RemoveForwardEntry() method.Any ideas?Thanks,KohanEdit 1:Im a little closer, i can access the forward stack, and even output each item in there but i can not seem to work out how to remove the entries. None of the properties or methods on _frame.ForwardStack or j give any insight into how to remove these entries. <code>  while (NavigationService.CanGoForward) NavigationService.RemoveBackEntry(); Window mainWindow = Application.Current.MainWindow; Frame _frame = (Frame)mainWindow.FindName(""mainFrame""); foreach (JournalEntry j in _frame.ForwardStack) { MessageBox.Show(j.Name); }",Remove forward entry on Navigation service?
Cannot determine whether a queue with the specified format name exists.," I get the exception when executing the following code. Any ideas what is wrong? Edit:Here is the exception message and first line of stacktrace Cannot determine whether a queue with the specified format name exists. at System.Messaging.MessageQueue.Exists(String path)It works for a local queue by the way. <code>  string queueName = ""FormatName:Direct=TCP:1.1.1.1\\Private$\\test"";MessageQueue queue;if (MessageQueue.Exists(queueName)) queue = new System.Messaging.MessageQueue(queueName);else queue = MessageQueue.Create(queueName);queue.Send(sWriter.ToString());",Cannot determine whether a queue with the specified format name exists
how to First load form then show," I have a form that is very slow because there are many controls placed on the form. As a result the form takes a long time to loaded. How do I load the form first, then display it and while loading delay show another form which that have message like ""Loading... please wait.?"" <code> ","How do I show a ""Loading . . . please wait"" message in Winforms for a long loading form?"
default value for user defined class in c#," I see some code will return the default value, so I am wondering for a user defined class, how will the compiler define its default value? <code> ",Default value for user defined class in C#
Optimalize Color manipulation on XNA," I am profiling my simple 2D XNA game. I found that 4% of entire running time is taken by simple operarion of adding together two Colors , one of them multiplied first by float.I need to call this method rogulthy 2000 times per frame (for each tile on map), which gave me 120000 times per second for XNA's 60 fps. Even minimal boosting of single call whould give huge speed impact. Yet I simple do not know how can I make this more effective EDIT: As suggested by Michael Stum: This lowered time usage from 4% to 2.5% <code>  private void DoColorCalcs(float factor, Color color) { int mul = (int)Math.Max(Math.Min(factor * 255.0, 255.0), 0.0); tile.Color = new Color( (byte)Math.Min(tile.Color.R + (color.R * mul / 255), 255), (byte)Math.Min(tile.Color.G + (color.G * mul / 255), 255), (byte)Math.Min(tile.Color.B + (color.B * mul / 255), 255)); } private void DoColorCalcs(float factor, Color color) { factor= (float)Math.Max(factor, 0.0); tile.Color = new Color( (byte)Math.Min(tile.Color.R + (color.R * factor), 255), (byte)Math.Min(tile.Color.G + (color.G * factor), 255), (byte)Math.Min(tile.Color.B + (color.B * factor), 255)); }",Optimize color manipulation on XNA
.NET 4: Expression/Statement trees," Updated Question Further DownI've been experimenting with expression trees in .NET 4 to generate code at runtime and I've been trying to implement the foreach statement by building an expression tree. In the end, the expression should be able to generate a delegate that does this: I've come up with the following helper method that generates a BlockExpression from an IEnumerable: The following code: Generates this expression tree: This seems to be OK, but calling Compile on that expression results in an exception: Didn't I define it here: ?Of course, the example here is contrived and doesn't have a practical use yet, but I'm trying to get the hang of expression trees that have bodies, in order to dynamically combine them at runtime in the future. EDIT: My initial problem was solved by Alexandra, thanks! Of course, I've run into the next problem now. I've declared a BlockExpression that has a variable in it. Inside that expression, I want another expression that references that variable. But I don't have an actual reference to that variable, just its name, because the expression is supplied externally. The body variable is passed in externally and has no direct reference to param, but does know the name of the variable in the expression (""something""). It looks like this: This is the ""code"" that this generates: However, it doesn't compile. With the same error as before.TLDR: How do I reference a variable by identifier in an expression tree?  <code>  Action<IEnumerable<int>> action = source => { var enumerator = source.GetEnumerator(); while(enumerator.MoveNext()) { var i = enumerator.Current; // the body of the foreach that I don't currently have yet }} public static BlockExpression ForEachExpr<T>(this IEnumerable<T> source, string collectionName, string itemName){ var item = Expression.Variable(typeof(T), itemName); var enumerator = Expression.Variable(typeof(IEnumerator<T>), ""enumerator""); var param = Expression.Parameter(typeof(IEnumerable<T>), collectionName); var doMoveNext = Expression.Call(enumerator, typeof(IEnumerator).GetMethod(""MoveNext"")); var assignToEnum = Expression.Assign(enumerator, Expression.Call(param, typeof(IEnumerable<T>).GetMethod(""GetEnumerator""))); var assignCurrent = Expression.Assign(item, Expression.Property(enumerator, ""Current"")); var @break = Expression.Label(); var @foreach = Expression.Block( assignToEnum, Expression.Loop( Expression.IfThenElse( Expression.NotEqual(doMoveNext, Expression.Constant(false)), assignCurrent , Expression.Break(@break)) ,@break) ); return @foreach;} var ints = new List<int> { 1, 2, 3, 4 };var expr = ints.ForEachExpr(""ints"", ""i"");var lambda = Expression.Lambda<Action<IEnumerable<int>>>(expr, Expression.Parameter(typeof(IEnumerable<int>), ""ints"")); .Lambda #Lambda1<System.Action`1[System.Collections.Generic.IEnumerable`1[System.Int32]]>(System.Collections.Generic.IEnumerable`1[System.Int32] $ints){ .Block() { $enumerator = .Call $ints.GetEnumerator(); .Loop { .If (.Call $enumerator.MoveNext() != False) { $i = $enumerator.Current } .Else { .Break #Label1 { } } } .LabelTarget #Label1: }} ""variable 'enumerator' of type 'System.Collections.Generic.IEnumerator`1[System.Int32]' referenced from scope '', but it is not defined"" var enumerator = Expression.Variable(typeof(IEnumerator<T>), ""enumerator""); var param = Expression.Variable(typeof(IEnumerable<T>), ""something"");var block = Expression.Block( new [] { param }, body ); var body = Expression.Call(typeof(Console).GetMethod(""WriteLine"",new[] { typeof(bool) }), Expression.Equal(Expression.Parameter(typeof(IEnumerable<int>), ""something""), Expression.Constant(null))); .Lambda #Lambda1<System.Action`1[System.Collections.Generic.IEnumerable`1[System.Int32]]>(System.Collections.Generic.IEnumerable`1[System.Int32] $something){ .Block(System.Collections.Generic.IEnumerable`1[System.Int32] $something) { .Call System.Console.WriteLine($something== null) }}",Expression/Statement trees
How to get the XSD file root element with C# System.xml.schema ," Good day.As i know. There is a root element in XML file.But from the XSD file structure, it is not easy to get the root element value.Is there any method to do it?(I wouldn't like to take use of hard code to find XSD root element value in my project.i want to find the root element of ""RootValueHere"" thank you. <code>  <xsd:schema xmlns:xsd=""http://www.w3.org/2001/XMLSchema""> <xsd:element name=""RootValueHere""> <xsd:complexType> <xsd:sequence> <xsd:element ref=""DocumentInfo"" minOccurs=""1"" maxOccurs=""1"" /> <xsd:element ref=""Prerequisite"" minOccurs=""1"" maxOccurs=""1"" /> </xsd:sequence> </xsd:complexType> </xsd:element> <!-- Element of DocumentInfo --> <xsd:element name=""DocumentInfo""> <xsd:complexType> <xsd:attribute name=""Name"" type=""xsd:string"" /> <xsd:attribute name=""Description"" type=""xsd:string"" /> <xsd:attribute name=""Creator"" type=""xsd:string"" /> <xsd:attribute name=""CreateTime"" type=""xsd:string"" /> </xsd:complexType> </xsd:element> <!-- Element of Prerequisite --> <xsd:element name=""Prerequisite""> <xsd:complexType> <xsd:sequence> <xsd:element name=""Type"" type=""Prerequisite.Type.type"" minOccurs=""1"" maxOccurs=""1"" /> <xsd:element name=""Miscellaneous"" type=""Prerequisite.Misc.type"" minOccurs=""0"" maxOccurs=""1"" /> </xsd:sequence> </xsd:complexType> </xsd:element>",How to find XSD root element in C#
Why we can't use non-sealed classes as generic constraints? , Can you guess what is the reason to not allow sealed classes for type-constraints in generics? I only have one explanation is to give opportunity to use naked constraints. <code> ,Why we cant use sealed classes as generic constraints?
Why can't we use sealed classes as generic constraints? , Can you guess what is the reason to not allow sealed classes for type-constraints in generics? I only have one explanation is to give opportunity to use naked constraints. <code> ,Why we cant use sealed classes as generic constraints?
Why can't we use sealed classes as generic constraints?, Can you guess what is the reason to not allow sealed classes for type-constraints in generics? I only have one explanation is to give opportunity to use naked constraints. <code> ,Why we cant use sealed classes as generic constraints?
how to change the back ground color of a rich text box when it is disabled?," Whenever I set the RichTextBox.Enabled property to false, its background color is automatically set to gray as it is set to the color in system color which is set in the control panel. How can I change its color to black even if I set it to disabled? <code> ",How to change the background color of a rich text box when it is disabled?
how can i change WebBrowser from Ie to mozilla.," I am working on a C# .NET application with System.Windows.Forms.WebBrowser.IE is not responding properly, so i want to change to Mozilla Firefox.How can I do this? <code> ",How to change WebBrowser from IE to Firefox
How call from C# a higher order F# function?," Given the F# higher order function (taking a function in parameter): and the C# function How do I call ApplyOn2 with Increment as parameter (from C#)?Note that ApplyOn2 is exported as Microsoft.FSharp.Core.FSharpFunc<int,int> which do not match with Increment's signature. <code>  let ApplyOn2 (f:int->int) = f(2) public static int Increment(int a) { return a++; } ",Call a higher order F# function from C#
Single-Assembly multi-language winforms deployment (ilmerge and satellite assemblies) - possible?," I have a simple Windows Forms (C#, .NET 2.0) application, built with Visual Studio 2008.I would like to support multiple UI languages, and using the ""Localizable"" property of the form, and culture-specific .resx files, the localization aspect works seamlessly and easily. Visual Studio automatically compiles the culture-specific resx files into satellite assemblies, so in my compiled application folder there are culture-specific subfolders containing these satellite assemblies.I would like to have the application be deployed (copied into place) as a single assembly, and yet retain the ability to contain multiple sets of culture-specific resources.Using ILMerge (or ILRepack), I can merge the satellite assemblies into the main executable assembly, but the standard .NET ResourceManager fallback mechanisms do not find the culture-specific resources that were compiled into the main assembly.Interestingly, if I take my merged (executable) assembly and place copies of it into the culture-specific subfolders, then everything works! Similarly, I can see the main and culture-specific resources in the merged assemby when I use Reflector (or ILSpy). But copying the main assembly into culture-specific subfolders defeats the purpose of the merging anyway - I really need there to be just a single copy of the single assembly...I'm wondering whether there is any way to hijack or influence the ResourceManager fallback mechanisms to look for the culture-specific resources in the same assembly rather than in the GAC and culture-named subfolders. I see the fallback mechanism described in the following articles, but no clue as to how it would be modified: BCL Team Blog Article on ResourceManager.Does anyone have any idea? This seems to be a relatively frequent question online (for example, another question here on Stack Overflow: ""ILMerge and localized resource assemblies""), but I have not found any authoritative answer anywhere.UPDATE 1: Basic SolutionFollowing casperOne's recommendation below, I was finally able to make this work.I'm putting the solution code here in the question because casperOne provided the only answer, I don't want to add my own.I was able to get it to work by pulling the guts out of the Framework resource-finding fallback mechanisms implemented in the ""InternalGetResourceSet"" method and making our same-assembly search the first mechanism used. If the resource is not found in the current assembly, then we call the base method to initiate the default search mechanisms (thanks to @Wouter's comment below).To do this, I derived the ""ComponentResourceManager"" class, and overrode just one method (and re-implemented a private framework method): To actually use this class, you need to replace the System.ComponentModel.ComponentResourceManager in the ""XXX.Designer.cs"" files created by Visual Studio - and you will need to do this every time you change the designed form - Visual Studio replaces that code automatically. (The problem was discussed in ""Customize Windows Forms Designer to use MyResourceManager"", I did not find a more elegant solution - I use fart.exe in a pre-build step to auto-replace.)UPDATE 2: Another Practical Consideration - more than 2 languagesAt the time I reported the solution above, I was actually only supporting two languages, and ILMerge was doing a fine job of merging my satellite assembly into the final merged assembly.Recently I started working on a similar project where there are multiple secondary languages, and therefore multiple satellite assemblies, and ILMerge was doing something very strange: Instead of merging the multiple satellite assemblies I had requested, it was merging the first satellite assembly in multiple times!eg command-line: With that command-line, I was getting the following sets of resources in the merged assembly (observed with ILSpy decompiler): After some playing around, I ended up realizing this is just a bug in ILMerge when it encounters multiple files with the same name in a single command-line call. The solution is simply to merge each satellite assembly in a different command-line call: When I do this, the resulting resources in the final assembly are correct: So finally, in case this helps clarify, here's a complete post-build batch file: UPDATE 3: ILRepackAnother quick note - One of the things that bothered me with ILMerge was that it is an additional proprietary Microsoft tool, not installed by default with Visual Studio, and therefore an extra dependency that makes it that little bit harder for a third party to get started with my open-source projects.I recently discovered ILRepack, an open-source (Apache 2.0) equivalent that so far works just as well for me (drop-in replacement), and can be freely distributed with your project sources.I hope this helps someone out there! <code>  class SingleAssemblyComponentResourceManager : System.ComponentModel.ComponentResourceManager{ private Type _contextTypeInfo; private CultureInfo _neutralResourcesCulture; public SingleAssemblyComponentResourceManager(Type t) : base(t) { _contextTypeInfo = t; } protected override ResourceSet InternalGetResourceSet(CultureInfo culture, bool createIfNotExists, bool tryParents) { ResourceSet rs = (ResourceSet)this.ResourceSets[culture]; if (rs == null) { Stream store = null; string resourceFileName = null; //lazy-load default language (without caring about duplicate assignment in race conditions, no harm done); if (this._neutralResourcesCulture == null) { this._neutralResourcesCulture = GetNeutralResourcesLanguage(this.MainAssembly); } // if we're asking for the default language, then ask for the // invariant (non-specific) resources. if (_neutralResourcesCulture.Equals(culture)) culture = CultureInfo.InvariantCulture; resourceFileName = GetResourceFileName(culture); store = this.MainAssembly.GetManifestResourceStream( this._contextTypeInfo, resourceFileName); //If we found the appropriate resources in the local assembly if (store != null) { rs = new ResourceSet(store); //save for later. AddResourceSet(this.ResourceSets, culture, ref rs); } else { rs = base.InternalGetResourceSet(culture, createIfNotExists, tryParents); } } return rs; } //private method in framework, had to be re-specified here. private static void AddResourceSet(Hashtable localResourceSets, CultureInfo culture, ref ResourceSet rs) { lock (localResourceSets) { ResourceSet objA = (ResourceSet)localResourceSets[culture]; if (objA != null) { if (!object.Equals(objA, rs)) { rs.Dispose(); rs = objA; } } else { localResourceSets.Add(culture, rs); } } }} ""c:\Program Files\Microsoft\ILMerge\ILMerge.exe"" /t:exe /out:%1SomeFinalProg.exe %1InputProg.exe %1es\InputProg.resources.dll %1fr\InputProg.resources.dll InputProg.resourcesInputProg.es.resourcesInputProg.es.resources <-- Duplicated! ""c:\Program Files\Microsoft\ILMerge\ILMerge.exe"" /t:exe /out:%1TempProg.exe %1InputProg.exe %1es\InputProg.resources.dll""c:\Program Files\Microsoft\ILMerge\ILMerge.exe"" /t:exe /out:%1SomeFinalProg.exe %1TempProg.exe %1fr\InputProg.resources.dll InputProg.resourcesInputProg.es.resourcesInputProg.fr.resources ""%ProgramFiles%\Microsoft\ILMerge\ILMerge.exe"" /t:exe /out:%1TempProg.exe %1InputProg.exe %1es\InputProg.resources.dll IF %ERRORLEVEL% NEQ 0 GOTO END""%ProgramFiles%\Microsoft\ILMerge\ILMerge.exe"" /t:exe /out:%1SomeFinalProg.exe %1TempProg.exe %1fr\InputProg.resources.dll IF %ERRORLEVEL% NEQ 0 GOTO ENDdel %1InputProg.exe del %1InputProg.pdb del %1TempProg.exe del %1TempProg.pdb del %1es\*.* /Q del %1fr\*.* /Q :END",Single-assembly multi-language Windows Forms deployment (ILMerge and satellite assemblies / localization) - possible?
Single-Assembly multi-language winforms deployment (ilmerge and satellite assemblies / localization) - possible?," I have a simple Windows Forms (C#, .NET 2.0) application, built with Visual Studio 2008.I would like to support multiple UI languages, and using the ""Localizable"" property of the form, and culture-specific .resx files, the localization aspect works seamlessly and easily. Visual Studio automatically compiles the culture-specific resx files into satellite assemblies, so in my compiled application folder there are culture-specific subfolders containing these satellite assemblies.I would like to have the application be deployed (copied into place) as a single assembly, and yet retain the ability to contain multiple sets of culture-specific resources.Using ILMerge (or ILRepack), I can merge the satellite assemblies into the main executable assembly, but the standard .NET ResourceManager fallback mechanisms do not find the culture-specific resources that were compiled into the main assembly.Interestingly, if I take my merged (executable) assembly and place copies of it into the culture-specific subfolders, then everything works! Similarly, I can see the main and culture-specific resources in the merged assemby when I use Reflector (or ILSpy). But copying the main assembly into culture-specific subfolders defeats the purpose of the merging anyway - I really need there to be just a single copy of the single assembly...I'm wondering whether there is any way to hijack or influence the ResourceManager fallback mechanisms to look for the culture-specific resources in the same assembly rather than in the GAC and culture-named subfolders. I see the fallback mechanism described in the following articles, but no clue as to how it would be modified: BCL Team Blog Article on ResourceManager.Does anyone have any idea? This seems to be a relatively frequent question online (for example, another question here on Stack Overflow: ""ILMerge and localized resource assemblies""), but I have not found any authoritative answer anywhere.UPDATE 1: Basic SolutionFollowing casperOne's recommendation below, I was finally able to make this work.I'm putting the solution code here in the question because casperOne provided the only answer, I don't want to add my own.I was able to get it to work by pulling the guts out of the Framework resource-finding fallback mechanisms implemented in the ""InternalGetResourceSet"" method and making our same-assembly search the first mechanism used. If the resource is not found in the current assembly, then we call the base method to initiate the default search mechanisms (thanks to @Wouter's comment below).To do this, I derived the ""ComponentResourceManager"" class, and overrode just one method (and re-implemented a private framework method): To actually use this class, you need to replace the System.ComponentModel.ComponentResourceManager in the ""XXX.Designer.cs"" files created by Visual Studio - and you will need to do this every time you change the designed form - Visual Studio replaces that code automatically. (The problem was discussed in ""Customize Windows Forms Designer to use MyResourceManager"", I did not find a more elegant solution - I use fart.exe in a pre-build step to auto-replace.)UPDATE 2: Another Practical Consideration - more than 2 languagesAt the time I reported the solution above, I was actually only supporting two languages, and ILMerge was doing a fine job of merging my satellite assembly into the final merged assembly.Recently I started working on a similar project where there are multiple secondary languages, and therefore multiple satellite assemblies, and ILMerge was doing something very strange: Instead of merging the multiple satellite assemblies I had requested, it was merging the first satellite assembly in multiple times!eg command-line: With that command-line, I was getting the following sets of resources in the merged assembly (observed with ILSpy decompiler): After some playing around, I ended up realizing this is just a bug in ILMerge when it encounters multiple files with the same name in a single command-line call. The solution is simply to merge each satellite assembly in a different command-line call: When I do this, the resulting resources in the final assembly are correct: So finally, in case this helps clarify, here's a complete post-build batch file: UPDATE 3: ILRepackAnother quick note - One of the things that bothered me with ILMerge was that it is an additional proprietary Microsoft tool, not installed by default with Visual Studio, and therefore an extra dependency that makes it that little bit harder for a third party to get started with my open-source projects.I recently discovered ILRepack, an open-source (Apache 2.0) equivalent that so far works just as well for me (drop-in replacement), and can be freely distributed with your project sources.I hope this helps someone out there! <code>  class SingleAssemblyComponentResourceManager : System.ComponentModel.ComponentResourceManager{ private Type _contextTypeInfo; private CultureInfo _neutralResourcesCulture; public SingleAssemblyComponentResourceManager(Type t) : base(t) { _contextTypeInfo = t; } protected override ResourceSet InternalGetResourceSet(CultureInfo culture, bool createIfNotExists, bool tryParents) { ResourceSet rs = (ResourceSet)this.ResourceSets[culture]; if (rs == null) { Stream store = null; string resourceFileName = null; //lazy-load default language (without caring about duplicate assignment in race conditions, no harm done); if (this._neutralResourcesCulture == null) { this._neutralResourcesCulture = GetNeutralResourcesLanguage(this.MainAssembly); } // if we're asking for the default language, then ask for the // invariant (non-specific) resources. if (_neutralResourcesCulture.Equals(culture)) culture = CultureInfo.InvariantCulture; resourceFileName = GetResourceFileName(culture); store = this.MainAssembly.GetManifestResourceStream( this._contextTypeInfo, resourceFileName); //If we found the appropriate resources in the local assembly if (store != null) { rs = new ResourceSet(store); //save for later. AddResourceSet(this.ResourceSets, culture, ref rs); } else { rs = base.InternalGetResourceSet(culture, createIfNotExists, tryParents); } } return rs; } //private method in framework, had to be re-specified here. private static void AddResourceSet(Hashtable localResourceSets, CultureInfo culture, ref ResourceSet rs) { lock (localResourceSets) { ResourceSet objA = (ResourceSet)localResourceSets[culture]; if (objA != null) { if (!object.Equals(objA, rs)) { rs.Dispose(); rs = objA; } } else { localResourceSets.Add(culture, rs); } } }} ""c:\Program Files\Microsoft\ILMerge\ILMerge.exe"" /t:exe /out:%1SomeFinalProg.exe %1InputProg.exe %1es\InputProg.resources.dll %1fr\InputProg.resources.dll InputProg.resourcesInputProg.es.resourcesInputProg.es.resources <-- Duplicated! ""c:\Program Files\Microsoft\ILMerge\ILMerge.exe"" /t:exe /out:%1TempProg.exe %1InputProg.exe %1es\InputProg.resources.dll""c:\Program Files\Microsoft\ILMerge\ILMerge.exe"" /t:exe /out:%1SomeFinalProg.exe %1TempProg.exe %1fr\InputProg.resources.dll InputProg.resourcesInputProg.es.resourcesInputProg.fr.resources ""%ProgramFiles%\Microsoft\ILMerge\ILMerge.exe"" /t:exe /out:%1TempProg.exe %1InputProg.exe %1es\InputProg.resources.dll IF %ERRORLEVEL% NEQ 0 GOTO END""%ProgramFiles%\Microsoft\ILMerge\ILMerge.exe"" /t:exe /out:%1SomeFinalProg.exe %1TempProg.exe %1fr\InputProg.resources.dll IF %ERRORLEVEL% NEQ 0 GOTO ENDdel %1InputProg.exe del %1InputProg.pdb del %1TempProg.exe del %1TempProg.pdb del %1es\*.* /Q del %1fr\*.* /Q :END",Single-assembly multi-language Windows Forms deployment (ILMerge and satellite assemblies / localization) - possible?
geting the int value from enum," I am working on a basic Battleship game to help my C# skills. Right now I am having a little trouble with enum. I have: I would like the player to pass the input ""C"" and some code return the integer 3. How would I set it up for it to take a string var (string pick;) and convert it to the correct int using this enum? The book I am reading on this is bit confusing <code>  enum game : int{ a=1, b=2, c=3,}",Getting the integer value from enum
can you mock an object that implements and interface AND a abstract class?," Is it possible to use Moq to mock an object that implements an interface and abstract class?I.e.: Can you mock this? <code>  public class MyClass: SomeAbstractClass, IMyClass",Can you mock an object that implements an interface AND an abstract class?
Convert Gridview to an image in asp.net using c#," Is it possible to convert a Html Control to an image in C#?Is there any C# method where I can pass the Html Control object and return an image of that html control?Is this possible, any suggestions? <code> ",Convert a HTML Control (Div or Table) to an image using C#
Convert an asp:gridview to an image using C#," Is it possible to convert a Html Control to an image in C#?Is there any C# method where I can pass the Html Control object and return an image of that html control?Is this possible, any suggestions? <code> ",Convert a HTML Control (Div or Table) to an image using C#
"ASP.NET MVC: Putting HTML inside Html.ActionLink(), plus No Link Text?"," I have two questions:I'm wondering how I can display no link text when using Html.ActionLink() in an MVC view (actually, this is Site.Master). There is not an overloaded version that does not allow link text, and when I try passing in just a blank string, the compiler tells me it needs a non-empty string. How can I fix this?I need to put <span> tags within the anchor tag, but it's not working with Html.ActionLink();. I'd like to see the following output:Span textHow can I put tags inside of the anchor tag in ASP.NET MVC? <code> ","Putting HTML inside Html.ActionLink(), plus No Link Text?"
how to a WebPart configurable?," I am using SharePoint Server 2007 Enterprise with Windows Server 2008 Enterprise. I am publishing a portal template. I want to develop a WebPart and make some settings configurable (just like we can configure parameters for a console application in app.config) For example, authorized users could set parameters of WebPart in Edit Page (from browser based UI interface), then Select -> Modify WebPart properties, or edit parameters in SharePoint Designer.The parameters would be application specific parameters.How do I go about doing this? <code> ",How do I make a webpart's settings configurable in Sharepoint?
Extension methods on a static class? C#, I know i can do the below to extend a class. I have a static class i would like to extend. How might i do it? I would like to write ClassName.MyFunc() <code>  static public class SomeName{ static public int HelperFunction(this SomeClass v),Extension methods on a static class?
Getting full URL of action in ASP .NET MVC," Is there a built-in way of getting the full URL of an action?I am looking for something like GetFullUrl(""Action"", ""Controller"") that would return something like http://www.fred.com/Controller/Action.The reason I am looking for this is to avoid hardcoding URLs in automated emails that are generated so that the URLs can always be generated relative to the current location of the site. <code> ",Getting full URL of action in ASP.NET MVC
"""Could not load type [Namespace].Global"" causing me grief."," In my .Net 2.0 Asp.net WebForms app, I have my Global.asax containing the following code: However when I build I get an error stating- Could not load type 'MyNamespace.Global'.This seems to be because the MyNamespace namespace (defined in the code behind file Global.asax.cs) is not seen by the compiler in the Global.asax file (does not show in R# intellisence..).This turned out to be a very hard nut to crack... any help will be appreciated!Note: The Global.asax and the Global.asax.cs are located in the same folder.Note2: When compiling from the vs prompt with csc it compiles o.k.  <code>  <%@ Application CodeBehind=""Global.asax.cs"" Inherits=""MyNamespace.Global"" Language=""C#"" %>","""Could not load type [Namespace].Global"" causing me grief"
Change App.config at Runtime," I'm writing a test WinForms / C# / .NET 3.5 application for the system we're developing and we fell in the need to switch between .config files at runtime, but this is turning out to be a nightmare.Here's the scene: the WinForms application is aimed at testing a WebApp, divided into 5 subsystems. The test process works with messages being sent between the subsystems, and for this process to be successful each subsystem got to have its own .config file.For my Test Application I wrote 5 separate configuration files. I wish I was able to switch between these 5 files during runtime, but the problem is: I can programatically edit the application .config file numerous times, but these changes will only take effect once. I've been searching a long time for a form to address this problem but I still wasn't successful.I know the problem definition may be a bit confusing but I would really appreciate it if someone helped me.Thanks in advance!--- UPDATE 01-06-10 ---There's something I didn't mention before. Originally, our system is a Web Application with WCF calls between each subsystem. For performance testing reasons (we're using ANTS 4), we had to create a local copy of the assemblies and reference them from the test project. It may sound a bit wrong, but we couldn't find a satisfying way to measure performance of a remote application.--- End Update ---Here's what I'm doing: <code>  public void UpdateAppSettings(string key, string value){ XmlDocument xmlDoc = XmlDocument.Load(AppDomain.CurrentDomain.SetupInformation.ConfigurationFile); foreach (XmlElement item in xmlDoc.DocumentElement) { foreach (XmlNode node in item.ChildNodes) { if (node.Name == key) { node.Attributes[0].Value = value; break; } } } xmlDoc.Save(AppDomain.CurrentDomain.SetupInformation.ConfigurationFile); System.Configuration.ConfigurationManager.RefreshSection(""section/subSection""); }",Changing App.config at Runtime
Change App.config at Runtime - I'll trade a six pack for a solution! =)," I'm writing a test WinForms / C# / .NET 3.5 application for the system we're developing and we fell in the need to switch between .config files at runtime, but this is turning out to be a nightmare.Here's the scene: the WinForms application is aimed at testing a WebApp, divided into 5 subsystems. The test process works with messages being sent between the subsystems, and for this process to be successful each subsystem got to have its own .config file.For my Test Application I wrote 5 separate configuration files. I wish I was able to switch between these 5 files during runtime, but the problem is: I can programatically edit the application .config file numerous times, but these changes will only take effect once. I've been searching a long time for a form to address this problem but I still wasn't successful.I know the problem definition may be a bit confusing but I would really appreciate it if someone helped me.Thanks in advance!--- UPDATE 01-06-10 ---There's something I didn't mention before. Originally, our system is a Web Application with WCF calls between each subsystem. For performance testing reasons (we're using ANTS 4), we had to create a local copy of the assemblies and reference them from the test project. It may sound a bit wrong, but we couldn't find a satisfying way to measure performance of a remote application.--- End Update ---Here's what I'm doing: <code>  public void UpdateAppSettings(string key, string value){ XmlDocument xmlDoc = XmlDocument.Load(AppDomain.CurrentDomain.SetupInformation.ConfigurationFile); foreach (XmlElement item in xmlDoc.DocumentElement) { foreach (XmlNode node in item.ChildNodes) { if (node.Name == key) { node.Attributes[0].Value = value; break; } } } xmlDoc.Save(AppDomain.CurrentDomain.SetupInformation.ConfigurationFile); System.Configuration.ConfigurationManager.RefreshSection(""section/subSection""); }",Changing App.config at Runtime
c# General Question," Since variables declared inside a method are available only within that method, and variables declared private within a class are only available within a class. What is the purpose of the this key word? Why would I want to have the following: When this will do the exact same thing: to practice my typing skills? <code>  private static class SomeClass : ISomeClass{ private string variablename; private void SomeMethod(string toConcat) { this.variablename = toConcat+toConcat; return this.variablename; }} private static class SomeClass : ISomeClass{ private string variablename; private void SomeMethod(string toConcat) { variablename = toConcat+toConcat; return variablename; }}",What is the purpose of 'this' keyword in C#.
removing dynamically created controls C#," I have a program that adds a series of ""blips"" to a graph: How do I have a button clear all of the ""blips"" that have been created with this code?Is there a way to change a blip's background color when its name is equal to a certain callsign? Each blip is associated with a selection in a ListBox, and I would like to change the blip's color when the user selects it. <code>  PictureBox blip = new PictureBox();blip.Location = new Point(blipHours, blipAltitude);blip.Size = new Size(6, 6);blip.BackColor = System.Drawing.Color.Lime;blip.Text = """";blip.Name = callsign;this.Controls.Add(blip);this.Controls.SetChildIndex(blip, 0);",Removing dynamically created controls in C#
Why would one want to use AttributeUsage AllowMultiple when creating attributes ?," According to a book I'm reading, the AllowMultiple public property of AttributeUsage specifies: ...whether the target can have multiple instances of the attribute applied to it.Why would I want/not want to use this? <code> ",Why would one want to use AttributeUsage AllowMultiple when creating attributes?
Access random item in list.," I have an ArrayList, and I need to be able to click a button and then randomly pick out a string from that list and display it in a messagebox.How would I go about doing this? <code> ",How to access random item in list?
Access random item in list," I have an ArrayList, and I need to be able to click a button and then randomly pick out a string from that list and display it in a messagebox.How would I go about doing this? <code> ",How to access random item in list?
"Override Get, But Not Set"," I have an abstract class that defines a get, but not set, because as far as that abstract class is concerned, it needs only a get. However, in some of the derive class, I need a set property, so I am looking at this implementation The problem is, I got a compilation error, saying that *.set: cannot override because *. does not have an overridable set accessor.Even though I think that the above syntax is perfectly legitimate. Any idea on this? Workaround, or why this is so?Edit: The only approach I can think of is to put both get and set as in the abstract class, and let the subclass throws a NotImplementedException if set is called and it's not necessary. That's something I don't like, along with a special setter method .  <code>  public abstract BaseClass{ public abstract double MyPop {get;}} public class DClass: BaseClass{ public override double MyPop {get;set;}}","Override get, but not set"
"Override get, But not set"," I have an abstract class that defines a get, but not set, because as far as that abstract class is concerned, it needs only a get. However, in some of the derive class, I need a set property, so I am looking at this implementation The problem is, I got a compilation error, saying that *.set: cannot override because *. does not have an overridable set accessor.Even though I think that the above syntax is perfectly legitimate. Any idea on this? Workaround, or why this is so?Edit: The only approach I can think of is to put both get and set as in the abstract class, and let the subclass throws a NotImplementedException if set is called and it's not necessary. That's something I don't like, along with a special setter method .  <code>  public abstract BaseClass{ public abstract double MyPop {get;}} public class DClass: BaseClass{ public override double MyPop {get;set;}}","Override get, but not set"
ASP.NET MVC Action Parameter Naming," Using the default route provided, I'm forced to name my parameters ""id"". That's fine for a lot of my Controller Actions, but I want to use some better variable naming in certain places. Is there some sort of attribute I can use so that I can have more meaningful variable names in my action signatures? <code>  // Default Route:routes.MapRoute( ""Default"", // Route name ""{controller}/{action}/{id}"", // URL with parameters new { controller = ""Home"", action = ""Index"", id = """" } // Parameter defaults);// Action Signature:public ActionResult ByAlias(string alias){ // Because the route specifies ""id"" and this action takes an ""alias"", nothing is bound}",Action Parameter Naming
.NET 4.0: What does Expression.Reduce() do?," I've been working with expression trees for a few days now and I'm curious to know what Expression.Reduce() does. The msdn documentation is not very helpful as it only states that it ""reduces"" the expression. Just in case, I tried an example (see below) to check if this method included mathematical reduction, but this doesn't seem to be the case.Does anyone know what this method does and is it possible to provide a quick example showing it in action? Any good resources out there? <code>  static void Main(string[] args){ Expression<Func<double, double>> func = x => (x + x + x) + Math.Exp(x + x + x); Console.WriteLine(func); Expression r_func = func.Reduce(); Console.WriteLine(r_func); // This prints out the same as Console.WriteLine(func)}",What does Expression.Reduce() do?
HOw to change windows Applicatoin's default icon in Setup Project, How to change the Windows Application's default icon with other one in C# desktop application. I am trying to change it in Setup Project but it is not. I want to show my own icon with Application's shortcut rather then windows default icon <code> ,How to change windows Application's default icon in Setup Project
How to change windows Applicatoin's default icon in Setup Project, How to change the Windows Application's default icon with other one in C# desktop application. I am trying to change it in Setup Project but it is not. I want to show my own icon with Application's shortcut rather then windows default icon <code> ,How to change windows Application's default icon in Setup Project
System.Array GetLength and Length, How do you use the Array.GetLength function in C#?What is the difference between the Length property and the GetLength function? <code> ,What is the difference between Array.GetLength() and Array.Length?
Can a class inherit from another class and an inteface?," I want to know if a class can inherit from a class and an interface. The example code below doesn't work but I think it conveys what I want to do.The reason that I want to do this is because at my company we make USB, serial, Ethernet, etc device. I am trying to develop a generic component/interface that I can use to write programs for all our devices that will help keep the common things (like connecting, disconnecting, getting firmware) the same for all of our applications.To add to this question: If GenericDevice is in different project, can I put the IOurDevices interface in that project then then make the USBDevice class implement the interface if I add a reference to the first project? Because would like to just reference one project and then implement different interfaces depending on what the device is. <code>  class GenericDevice{ private string _connectionState; public connectionState { get{return _connectionState; } set{ _connectionState = value;} }}interface IOurDevices{ void connectToDevice(); void DisconnectDevice(); void GetFirmwareVersion();}class USBDevice : IOurDevices : GenericDevice{ //here I would define the methods in the interface //like this... void connectToDevice() { connectionState = ""connected""; }}//so that in my main program I can do this...class myProgram{ main() { USBDevice myUSB = new USBDevice(); myUSB.ConnectToDevice; }}","In C#, can a class inherit from another class and an interface?"
How do I capture the mouse mouse move event in my winform application," I would like to capture the mouse move event in my main form. Although I am able to wire up the MouseEventHandler for the main form, the event no longer fires when the cursor is over a UserControl or any other control. How do I ensure that I always have the mouse position. <code> ",How do I capture the mouse move event
How do I capture the mouse move event in my winform application," I would like to capture the mouse move event in my main form. Although I am able to wire up the MouseEventHandler for the main form, the event no longer fires when the cursor is over a UserControl or any other control. How do I ensure that I always have the mouse position. <code> ",How do I capture the mouse move event
a curious c# syntax," What does the following code mean? Is it equal to the following code? What is the function of the '?' sign here? <code>  private enum E_Week{ Mon = 0, Tue, . . .} E_Week? week= null; E_Week week= null;",A curious C# syntax with a question mark
User Control - Custom Properties (Help Please)," I have developed a User Control in Visual Studio (WinForms C#) and have a question.I need the user of my User Control to be able to change certain string values and I would like them to be able to add the user control to their Form and click on it to bring up the Properties Pane where my User Control's custom properties will be displayed.How can I have my own custom properties for my user control? For example:My user control contains a TextBox, and I would like the user to be able to change the value of that TextBox via a property named ""Text"" or ""Value"" in the properties at Design-Time. <code> ",User Control - Custom Properties
C# Version class serializable?," I've got a class with a System.Version property, which looks like this:VersionBuild: 111Major: 1MajorRevision: 0Minor: 1MinorRevision: 10Revision: 10When I serialize the class, version is always empty: The Client class looks like: <code>  <Version /> [Serializable]public class Client{ public string Description; public string Directory; public DateTime ReleaseDate; public Version Version;}",System.Version not serialized
Best Practice Using C# XSD In Enterprise Applications ," I'm trying to understand what is the best practice using XSD tables generated from the Database scheme that I currently use.1) Do you think the XSD information should be located as part of the Model?2) Does it mean that Data Access Layer returns Datasets and other generated objects?3) Does it goes through all the system layers all the way to the UI?4) If the XSD is part of the Data Access Layer, should I convert the results to objects from the Model? What is best convert methodology?Thanks, Ronny <code> ",Best Practice Using C# XSD typed-datasets In Enterprise Applications 
Regular Expression Help," I have a string which would be delivered to my application in the format below: What I need to do is format it for my database so it reads as follows: I assume the easiest way to do this would be using regular expressions, but I have never used them before, and this is the first time I have ever needed to, and to be honest, I simply don't have the time to read up on them at the moment, so if anyone could help me with this I would be eternally grateful. <code>  ece4241692a1c7434da51fc1399ea2fa155d4fc983084ea59d1455afc79fafed <ece42416 92a1c743 4da51fc1 399ea2fa 155d4fc9 83084ea5 9d1455af c79fafed>",Regular expression to split string into equal length chunks
How should i log exceptions in C# .NET?," How should I log exceptions? I never tried logging in .NET before. Nor try to dump exceptions to a txt (or binary) file. I dont require a text file, just a way to view the logs with the file and line #. -edit- using asp.net <code> ",How should I log exceptions in ASP.NET?
Can I develop blackberry applications using C#.NET on windows7," Hey, I have a keen interest to build an application for blackberry OS, can I do it with C#?Also Blackberry has launched a plug-in for Visual Studio but how would you use it along with the simulator? <code> ",Can I develop Blackberry applications using C# .NET on windows7
Writing an Inverted Index in C# for a search application," I am writing an in-house application that holds several pieces of text information as well as a number of pieces of data about these pieces of text. These pieces of data will be held within a database (SQL Server, although this could change) in order of entry.I'd like to be able to search for the most relevant of these pieces of information, with the most relevant of these to be at the top. I originally looked into using SQL Server Full-Text Search but it's not as flexible for my other needs as I had hoped so it seems that I'll need to develop my own solution to this.From what I understand what is needed is an inverted index, then for the contents of said inverted index to be restored and modified based on the results of the additional information held (although for now this can be left for a later date as I just want the inverted index to index the main text from the database table/strings provided). I've had a crack at writing this code in Java using a Hashtable with the key as the words and the value as a list of the occurrences of the word but in all honesty I'm still rather new at C# and have only really used things like DataSets and DataTables when handling information. If requested I'll upload the Java code soon once I've cleared this laptop of viruses.If given a set of entries from a table or from a List of Strings, how could one create an inverted index in C# that will preferably save into a DataSet/DataTable?EDIT: I forgot to mention that I have already tried Lucene and Nutch, but require my own solution as modifying Lucene to meet my needs would take far longer than writing an inverted index. I'll be handling a lot of meta-data that'll also need handling once the basic inverted index is completed, so all I require for now is a basic full-text search on one area using the inverted index. Finally, working on an inverted index isn't something I get to do every day so it'd be great to have a crack at it. <code> ",Writing an Inverted Index in C# for an information retrieval application
Why can't C# interfaces contained fields?," For example, suppose I want an ICar interface and that all implementations will contain the field Year. Does this mean that every implementation has to separately declare Year? Wouldn't it be nicer to simply define this in the interface? <code> ",Why can't C# interfaces contain fields?
How should I use Abstract Class/Method to force the implementation in child of derived class.," Question Heading seems to be little confusing, But I will Try to clear my question here. Please do not try to understand the whole code. I am summarising it.Employee is a Abstract class, which have an abstract method GiveBonusSalesPerson is a deriving from Employee. SalesPerson has to give definition to abstract Method GiveBonus.(SalesPerson can not be Abstract)PTSalesPerson is deriving from SalesPerson.Now my question is, How can I force PTSalesPerson to have its own implementation of GiveBonus. <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;namespace ConsoleApplication1{ public abstract class Employee { private string name; private int empid; BenefitPackage _BenefitPackage = new BenefitPackage(); public string Name { get { return this.name; } set { this.name = value; } } public int EmpId { get { return this.empid; } set { if (value == 1) return; this.empid = value; } } public Employee(string Name, int EmpId) { this.Name = Name; this.EmpId = EmpId; } public Employee() { } public abstract void GiveBonus(); } public class Manager : Employee { private int noofstockoptions; public override void GiveBonus() { Console.WriteLine(""Manger GiveBonus Override""); } public int NoOfStockOptions { get { return this.noofstockoptions; } set { this.noofstockoptions = value; } } public Manager(string Name,int EmpId, int NoOfStockOptions):base(Name,EmpId) { this.NoOfStockOptions=NoOfStockOptions; } } public class SalesPerson:Employee { private int noofsales; public int NoOfSales { get { return this.noofsales; } set { this.noofsales = value; } } public SalesPerson(string Name, int EmpId, int NoOfSales):base(Name,EmpId) { this.NoOfSales = NoOfSales; } public override void GiveBonus() { Console.WriteLine(""Hi from salesperson""); } } public sealed class PTSalesPerson : SalesPerson { private int noofhrworked; public int NoOfHrWorked { get { return this.noofhrworked; } set { this.noofhrworked = value; } } public PTSalesPerson(string Name, int EmpId, int NoOfSales,int NoOfHrWorked):base(Name,EmpId,NoOfSales) { this.NoOfHrWorked = NoOfHrWorked; } //public new void GiveBonus() //{ // Console.WriteLine(""hi from ptsalesperson""); //} } class BenefitPackage { public int Bonus; public int GiveBonus() { int i = 200; return i; } private class innerPublic { public int innerBonus; } } class MainClass { public static void Main() { Manager _Manager=new Manager(""Vaibhav"",1,50); PTSalesPerson _PTSalesPerson = new PTSalesPerson(""Shantanu"", 1, 4, 6); _Manager.GiveBonus(); Employee _emp; //_emp = new Employee(""new emp"",4); //_emp.GiveBonus(); _PTSalesPerson.GiveBonus(); ((SalesPerson)_PTSalesPerson).GiveBonus(); Console.ReadLine(); } }}","How to force overriding a method in a descendant, without having an abstract base class?"
How do you properly use a javascriptserializer without a stackoverflow?,"  <code>  [Serializable]public class ModelResource:ISerializable{ public Int64 Ore { get; private set; } public Int64 Crystal { get; private set; } public Int64 Hydrogen { get; private set; } //needs to be ignored public Int64 Total { get { return Ore + Hydrogen + Crystal; } } public string ResourceType { get; private set; } public Int64 HerculesNeeded { get { return Total / 25000; } } public Int64 AtlasNeeded { get { return Total / 5000; } } public bool IsPlanet { get { return ResourceType == ""Planet""; } } //causes serializer to stackoverflow public ModelResource MakeChild {get{return new ModelResource(Ore/2,Crystal/2,Hydrogen/2);}} public string ToJson() { var jss = new System.Web.Script.Serialization.JavaScriptSerializer(new SimpleTypeResolver()); return jss.Serialize(this); //throws recursion limit exceed exception } #region ISerializable Members public void GetObjectData(SerializationInfo info, StreamingContext context) { info.AddValue(""Ore"", Ore); info.AddValue(""Crystal"", Crystal); info.AddValue(""Hydrogen"", Hydrogen); info.AddValue(""ResourceType"", ResourceType); } private ModelResource(SerializationInfo si, StreamingContext context) { Ore = si.GetInt64(""Ore""); Crystal = si.GetInt64(""Crystal""); Hydrogen = si.GetInt64(""Hydrogen""); ResourceType = si.GetString(""ResourceType""); } #endregion}",How do you get System.Web.Script.javascriptSerializer to ignore a property?
c#: How to check a input IP fall in a specific IP range," If we let users input a couple of ip ranges, e.g., 172.16.11.5 - 100, how could I write a function to check if a IP (172.16.11.50) falls in the ranges?Is there any existing library in .NET to leverage? <code> ",How to check a input IP fall in a specific IP range
SQLServer uniqueidentifier in C#, What datatype should I use in C# to work with the SQL Server uniqueidentifier. Do I need any conversions etc ? <code> ,SQL Server unique-identifier equivalent in C#
SQL Server uniqueidentifier in C#, What datatype should I use in C# to work with the SQL Server uniqueidentifier. Do I need any conversions etc ? <code> ,SQL Server unique-identifier equivalent in C#
Should I use an assembly as a licence file?," I was initially going to use a signed serialized xml file to store license details. In planning, more and more has moved into this ""license file"" which will allow for us to distribute a single application and control available functions via the supplied license file.The UI and printed reports are co-branded with distributors logos, so it would be good if this could be embedded into the license. I know this could be done with the serialized xml file but I was wondering what are the pros and cons of storing this data in a compiled assembly?The license generation tool could compile the assembly with the appropriate properties and resources and sign it. UpdateFrom what I can see, using serialized xml or an assembly would be pretty similar. From my point of view, assemblies would allow me to add other resources and leaves some flexibility for the future. As soon as the resources get complicated, xml serialization is a pain.Update2The software only works with our hardware so licence security is not a massive concern. The main aim is to stop the casual user from enabling features that they have not paid for. I would be choosing one over the other for design simplicity! <code> ",Pros/Cons of using an assembly as a license file?
Pros/Cons of using an assembly as a licence file?," I was initially going to use a signed serialized xml file to store license details. In planning, more and more has moved into this ""license file"" which will allow for us to distribute a single application and control available functions via the supplied license file.The UI and printed reports are co-branded with distributors logos, so it would be good if this could be embedded into the license. I know this could be done with the serialized xml file but I was wondering what are the pros and cons of storing this data in a compiled assembly?The license generation tool could compile the assembly with the appropriate properties and resources and sign it. UpdateFrom what I can see, using serialized xml or an assembly would be pretty similar. From my point of view, assemblies would allow me to add other resources and leaves some flexibility for the future. As soon as the resources get complicated, xml serialization is a pain.Update2The software only works with our hardware so licence security is not a massive concern. The main aim is to stop the casual user from enabling features that they have not paid for. I would be choosing one over the other for design simplicity! <code> ",Pros/Cons of using an assembly as a license file?
"How to insert copyright, trademark, service mark, etc. into WPF textbox when font doesn't support symbols."," We have a WPF application that displays text containing the various corporate symbols; such as trademark, registered trademark, copyright, and service mark.The database has some fields that include the standard corporate symbols. Initially, the data was marked as follows:Example Corp(TM) or Example Plan (SM)We can easily change the placeholders to their respective Unicode equivalents; and actually have in most cases.The problem we have is that the font used by the application doesn't support the Service Mark symbol (which is just a superscripted SM). Chances are we can not replace the font or edit it.The fields could be a simple product name with the symbol at the end, or a long description with a symbol contained 0 or more times. We bind TextBoxes or Labels directly to a ViewModel and/or the business object (usually through DataTemplates). All the data in the application is read-only.So, assuming we have to tackle this via code (in C# and WPF), what are my options? <code> ","How to insert copyright, trademark, service mark, etc. into WPF textbox when font doesn't support symbols"
Problem with RibbonWindow.," Working with the ribboncontrolslibrary, when I run my application the title bar looks like W98 application,. How can I make it look pretty? Edit: It seems that has something to do with the theme used on windows.any help would be appreciated.alt text http://img718.imageshack.us/img718/8188/321321.jpg <code>  <r:RibbonWindow x:Class=""Produccion_Dampers.main"" xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" xmlns:r=""clr-namespace:Microsoft.Windows.Controls.Ribbon;assembly=RibbonControlsLibrary"" Title=""Window1"" Height=""600"" Width=""800""> <DockPanel> <r:Ribbon DockPanel.Dock=""Top"" Title=""my App looks like s***t""> </r:Ribbon> </DockPanel></r:RibbonWindow>",Why is my RibbonWindow not themed correctly?
Edited: Problem with RibbonWindow.," Working with the ribboncontrolslibrary, when I run my application the title bar looks like W98 application,. How can I make it look pretty? Edit: It seems that has something to do with the theme used on windows.any help would be appreciated.alt text http://img718.imageshack.us/img718/8188/321321.jpg <code>  <r:RibbonWindow x:Class=""Produccion_Dampers.main"" xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" xmlns:r=""clr-namespace:Microsoft.Windows.Controls.Ribbon;assembly=RibbonControlsLibrary"" Title=""Window1"" Height=""600"" Width=""800""> <DockPanel> <r:Ribbon DockPanel.Dock=""Top"" Title=""my App looks like s***t""> </r:Ribbon> </DockPanel></r:RibbonWindow>",Why is my RibbonWindow not themed correctly?
Help!!! with RibbonWindow.," Working with the ribboncontrolslibrary, when I run my application the title bar looks like W98 application,. How can I make it look pretty? Edit: It seems that has something to do with the theme used on windows.any help would be appreciated.alt text http://img718.imageshack.us/img718/8188/321321.jpg <code>  <r:RibbonWindow x:Class=""Produccion_Dampers.main"" xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" xmlns:r=""clr-namespace:Microsoft.Windows.Controls.Ribbon;assembly=RibbonControlsLibrary"" Title=""Window1"" Height=""600"" Width=""800""> <DockPanel> <r:Ribbon DockPanel.Dock=""Top"" Title=""my App looks like s***t""> </r:Ribbon> </DockPanel></r:RibbonWindow>",Why is my RibbonWindow not themed correctly?
Help!!! with RibbonWindow," Working with the ribboncontrolslibrary, when I run my application the title bar looks like W98 application,. How can I make it look pretty? Edit: It seems that has something to do with the theme used on windows.any help would be appreciated.alt text http://img718.imageshack.us/img718/8188/321321.jpg <code>  <r:RibbonWindow x:Class=""Produccion_Dampers.main"" xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" xmlns:r=""clr-namespace:Microsoft.Windows.Controls.Ribbon;assembly=RibbonControlsLibrary"" Title=""Window1"" Height=""600"" Width=""800""> <DockPanel> <r:Ribbon DockPanel.Dock=""Top"" Title=""my App looks like s***t""> </r:Ribbon> </DockPanel></r:RibbonWindow>",Why is my RibbonWindow not themed correctly?
Will putting a using() around a datareader close it?," I usually write my DataReader code like this: Is it safe to replace the try and finally with just a using block around the DataReader's creation? The reason I wonder is because in all the Microsoft examples I've seen they use a using for the connection but always explicitly call Close() on the DataReader.Heres's an example fromRetrieving Data Using a DataReader (ADO.NET): <code>  try{ dr = cmd.ExecuteReader(CommandBehavior.SingleResult); while (dr.Read()) { // Do stuff }}finally{ if (dr != null) { dr.Close(); }} static void HasRows(SqlConnection connection){ using (connection) { SqlCommand command = new SqlCommand( ""SELECT CategoryID, CategoryName FROM Categories;"", connection); connection.Open(); SqlDataReader reader = command.ExecuteReader(); if (reader.HasRows) { while (reader.Read()) { Console.WriteLine(""{0}\t{1}"", reader.GetInt32(0), reader.GetString(1)); } } else { Console.WriteLine(""No rows found.""); } reader.Close(); }}","Will putting a ""using"" statement around a DataReader close it?"
How to force a derived class to include certain properties," I have a class structure for a role playing game which looks like this... Basically, I am trying to force every derived type to include a ""Name"" property. Is this the best way to do it? I know I can remove ""abstract"" from Item.Name and then remove the overriden ""Name"" properties in Armor and Helmet. If I do that the code looks a little cleaner but I might forget to set the base.Name in these derived classes.Could someone help show me the best way to do this? EDIT:Sorry, let me clarify my question a little more. I want to make sure of 2 things.1) Name property exists in all derived classes2) Name property is not null or emptyI basically want to force any class that derives from Item (and is not abstract) to have a value for Name.  <code>  public abstract class Item{ public abstract string Name { get; set; }}public abstract class Armor : Item{ public override string Name { get; set; }}public class Helmet : Armor{ public override string Name { get; set; }}",How to force a derived class to include certain properties with default value
"C#, attach multiple files to an email programticaly without writing to disk"," Our project has files stored in a sql server db as blobs. I'd like to get the files from the database and attach multiple files to an email without writing to disk. This is what I have so far(everything works ok, with no attachments): I'm getting the following errors: I copied most of the stream code from examples I found on the web. <code>  // snipList<System.Net.Mail.Attachment> attachments = null;// Attachments is a child list of Messagebody object holding Attachment idsMessageBody.Attachments = MessageBodyAttachmentList.GetMessageBodyAttachmentList(this.MessageBody.ID);if (MessageBody.Attachments != null && MessageBody.Attachments.Count > 0){ attachments = new List<Attachment>(); foreach (Library.Entity.Messaging.MessageBodyAttachment att in MessageBody.Attachments) { using (MemoryStream memoryStream = new MemoryStream()) { // create a new attachment Library.Attachments.Attachment attachment = Library.Attachments.Attachment.GetAttachment(att.AttachmentID); byte[] contentAsBytes = attachment.FileData;// FileData holds byte[] that is the contents of the file memoryStream.Write(contentAsBytes, 0, contentAsBytes.Length); memoryStream.Seek(0, SeekOrigin.Begin); // content type for file info ContentType contentType = new ContentType(); contentType.MediaType = MediaTypeNames.Application.Octet; contentType.Name = attachment.FileName; // create the .Net specific attachment Attachment netAttachment = new Attachment(memoryStream, contentType); attachments.Add(netAttachment); memoryStream.Position = 0; } }}response = message.SendMessage(_recipient, _sender, _cc, _bcc, MessageBody.Subject, MessageBody.Body, true, attachments);// snippublic string SendMessage(string to, string from, string cc, string bcc, string subject, string body, bool IsHtml, List<Attachment> attachments){ string response = String.Empty; System.Net.Mail.MailMessage message = new System.Net.Mail.MailMessage(from, to, subject, body); // Add the attachments if (attachments != null) { foreach (Attachment a in attachments) message.Attachments.Add(a); } message.IsBodyHtml = IsHtml; if (IsHtml) { // snip } try { _client.Timeout = 500000; _client.Send(message); } catch (SmtpException smtpex) { response = smtpex.Message; } catch (System.Exception ex) { response = ex.Message; } return response;} exception message: Failure sending mail.source: Systemstack trace: at System.Net.Mail.SmtpClient.Send(MailMessage message) at MyCompany.Shared.Email.SMTPMessage.SendMessage(String to, String from, String cc, String bcc, String subject, String body, Boolean IsHtml, List`1 attachments) in C:\svn_repos\branches\2010.02.28\Net\Common\Shared\Email\SMTPMessage.cs:line 116inner exception msg: Cannot access a closed Stream.inner source: mscorlibinner targetsite: {Void StreamIsClosed()}inner stack trace: at System.IO.__Error.StreamIsClosed() at System.IO.MemoryStream.Read(Byte[] buffer, Int32 offset, Int32 count) at System.Net.Mime.MimePart.Send(BaseWriter writer) at System.Net.Mime.MimeMultiPart.Send(BaseWriter writer) at System.Net.Mail.Message.Send(BaseWriter writer, Boolean sendEnvelope) at System.Net.Mail.MailMessage.Send(BaseWriter writer, Boolean sendEnvelope) at System.Net.Mail.SmtpClient.Send(MailMessage message)",attach multiple files to an email programticaly without writing to disk
A Program to Repel Mosquitoes !?!," No, I'm serious.Recently, I read that when the PC's piezo buzzer is made to vibrate at a certain frequency the sound would repel mosquitoes.Is that true?How do I programmatically access the PC buzzer (not the speaker), in C# preferably?I don't know about mosquitoes, but my head hurts like mad. Argh...! <code> ",A program to repel mosquitoes?
A Program to Repel Mosquitoes?," No, I'm serious.Recently, I read that when the PC's piezo buzzer is made to vibrate at a certain frequency the sound would repel mosquitoes.Is that true?How do I programmatically access the PC buzzer (not the speaker), in C# preferably?I don't know about mosquitoes, but my head hurts like mad. Argh...! <code> ",A program to repel mosquitoes?
Method not supported error? Then why let me use first ?," Why I am getting this error:The method 'Single' is not supported by LINQ to Entities. Consider using the method 'First' instead. Code compiles safe, but only breaks if call is made to the respective section. I am new to LINQ, therefore do not know which methods are for LINQtoSQL or LINQtoEntities. This means more errors! We cannot remember all methods this way.My question is, if there are limitations to the methods applicable to certain types / scenarios, why do they appear in Intellisense?EDIT: Any work-around / technique helpful to have an idea if one is supported ? <code>  public ActionResult Details(int id)Line 27: { var result = (from d in _db.MovieSetLine 29: where d.Id == idLine 30: select d).Single(); // // } ","Error, method not supported by LINQ to Entities"
Method not supported error? Then why let me use first?," Why I am getting this error:The method 'Single' is not supported by LINQ to Entities. Consider using the method 'First' instead. Code compiles safe, but only breaks if call is made to the respective section. I am new to LINQ, therefore do not know which methods are for LINQtoSQL or LINQtoEntities. This means more errors! We cannot remember all methods this way.My question is, if there are limitations to the methods applicable to certain types / scenarios, why do they appear in Intellisense?EDIT: Any work-around / technique helpful to have an idea if one is supported ? <code>  public ActionResult Details(int id)Line 27: { var result = (from d in _db.MovieSetLine 29: where d.Id == idLine 30: select d).Single(); // // } ","Error, method not supported by LINQ to Entities"
error? method not supported! why let use first?," Why I am getting this error:The method 'Single' is not supported by LINQ to Entities. Consider using the method 'First' instead. Code compiles safe, but only breaks if call is made to the respective section. I am new to LINQ, therefore do not know which methods are for LINQtoSQL or LINQtoEntities. This means more errors! We cannot remember all methods this way.My question is, if there are limitations to the methods applicable to certain types / scenarios, why do they appear in Intellisense?EDIT: Any work-around / technique helpful to have an idea if one is supported ? <code>  public ActionResult Details(int id)Line 27: { var result = (from d in _db.MovieSetLine 29: where d.Id == idLine 30: select d).Single(); // // } ","Error, method not supported by LINQ to Entities"
Error? method not supported! why let use first?," Why I am getting this error:The method 'Single' is not supported by LINQ to Entities. Consider using the method 'First' instead. Code compiles safe, but only breaks if call is made to the respective section. I am new to LINQ, therefore do not know which methods are for LINQtoSQL or LINQtoEntities. This means more errors! We cannot remember all methods this way.My question is, if there are limitations to the methods applicable to certain types / scenarios, why do they appear in Intellisense?EDIT: Any work-around / technique helpful to have an idea if one is supported ? <code>  public ActionResult Details(int id)Line 27: { var result = (from d in _db.MovieSetLine 29: where d.Id == idLine 30: select d).Single(); // // } ","Error, method not supported by LINQ to Entities"
Error! method not supported! why let use first?," Why I am getting this error:The method 'Single' is not supported by LINQ to Entities. Consider using the method 'First' instead. Code compiles safe, but only breaks if call is made to the respective section. I am new to LINQ, therefore do not know which methods are for LINQtoSQL or LINQtoEntities. This means more errors! We cannot remember all methods this way.My question is, if there are limitations to the methods applicable to certain types / scenarios, why do they appear in Intellisense?EDIT: Any work-around / technique helpful to have an idea if one is supported ? <code>  public ActionResult Details(int id)Line 27: { var result = (from d in _db.MovieSetLine 29: where d.Id == idLine 30: select d).Single(); // // } ","Error, method not supported by LINQ to Entities"
Error! method not supported by LINQ to Entities," Why I am getting this error:The method 'Single' is not supported by LINQ to Entities. Consider using the method 'First' instead. Code compiles safe, but only breaks if call is made to the respective section. I am new to LINQ, therefore do not know which methods are for LINQtoSQL or LINQtoEntities. This means more errors! We cannot remember all methods this way.My question is, if there are limitations to the methods applicable to certain types / scenarios, why do they appear in Intellisense?EDIT: Any work-around / technique helpful to have an idea if one is supported ? <code>  public ActionResult Details(int id)Line 27: { var result = (from d in _db.MovieSetLine 29: where d.Id == idLine 30: select d).Single(); // // } ","Error, method not supported by LINQ to Entities"
Windows Form Radio Button (How do i Group) C#, How can I group the radio buttons in Windows Form application (a lot like ASP.NET's radiobuttonlist!)? So I can switch between each case chosen from the options. <code> ,How do I group Windows Form radio buttons?
How can I get close to non-nullable types in C# today?," I've read many of the non-nullable questions and answers. It looks like the best way to get close to non-nullable types in C# (4.0) is Jon Skeet's NonNullable<> hack.However, it seems that C++/CLI has solved much of the problem by supporting managed references: Foo% (instead of native C++ Foo&). The compiler makes this work by adding modreq(IsImplicitlyDereferenced) to the argument. Trying to call such a function from C# results in: Is there anything better then NonNullable<>?Is there any way to (reasonably--i.e., w/o using reflection) call a C++/CLI method Foo::Method(Bar%) from C#?[edit] It seems there is currently nothing better than NonNullable<>...I wish I would have gotten some comments on the C++/CLI stuff as it already has at least a partial solution. <code>  '<FunctionName>' is not supported by the language",How can I get close to non-nullable reference types in C# today?
See if left mouse button is held down onmousemoveenvent, How do I detect if the left mouse button is being held down in the OnMouseMove event for a control? <code> ,See if left mouse button is held down in the OnMouseMove event
C# user controls custom events," Is there a way to give a User Control custom events, and invoke the event on a event within the user control. (I'm not sure if invoke is the correct term) And the MainForm: <code>  public partial class Sample: UserControl{ public Sample() { InitializeComponent(); } private void TextBox_Validated(object sender, EventArgs e) { // invoke UserControl event here }} public partial class MainForm : Form{ private Sample sampleUserControl = new Sample(); public MainForm() { this.InitializeComponent(); sampleUserControl.Click += new EventHandler(this.CustomEvent_Handler); } private void CustomEvent_Handler(object sender, EventArgs e) { // do stuff }}",Winforms user controls custom events
Is there a way to detect if a debugger is attached to a process from c#," I have a program that Process.Start() another program, and it shuts it down after N seconds. Sometimes I choose to attach a debugger to the started program. In those cases, I don't want the process shut down after N seconds.I'd like the host program to detect if a debugger is attached or not, so it can choose to not shut it down.Clarification: I'm not looking to detect if a debugger is attached to my process, I'm looking to detect if a debugger is attached to the process I spawned. <code> ",Is there a way to detect if a debugger is attached to another process from C#?
Is there a way to detect if a debugger is attached to a process from C#?," I have a program that Process.Start() another program, and it shuts it down after N seconds. Sometimes I choose to attach a debugger to the started program. In those cases, I don't want the process shut down after N seconds.I'd like the host program to detect if a debugger is attached or not, so it can choose to not shut it down.Clarification: I'm not looking to detect if a debugger is attached to my process, I'm looking to detect if a debugger is attached to the process I spawned. <code> ",Is there a way to detect if a debugger is attached to another process from C#?
C# DateTime to SqlDateTime Conversion, While converting .NET DateTime (when is default(DateTime)) to SqlDateTime should I always check if the .NET date is between SqlDateTime.MinValue and SqlDateTime.MaxValue [or] Is there a good way to do this. <code> ,.NET DateTime to SqlDateTime Conversion
Does CLR reference counting mean it's safe to throw circular object references around?, I have a theory that the CLR garbage collection mechanism means that I can get away with circular references in my object hierarchy without creating deadlocks for teardown and garbage collection. Is this a safe assumption to make? (Target language VB.NET) <code> ,Does the CLR garbage collection methodology mean it's safe to throw circular object references around?
Draw border around text box on Button Click," When a user clicks my Validate Button (in my C#, WinForm, .net 3.5 app) I would like to draw a border around a certain control if it is empty. Say a textbox that is named tbxLastName I thought I needed to do something like this --> Unfortunately, I have no idea what to put for the Graphics Object as what I have does NOTHING. All of the examples I have come across, MSDN - HERE, have this code in a Paint Event. Like so --> I, however, only want to have the border appear while certain conditions are meet which is kicked off by a Button_ClickSo many of the suggestions suggest using a container object to hold the textbox and call it's Paint_Event. I did this and a box appears but NOT around the control. It appears in the Top Left corner of the Container Control. Here is what I am doing --> EDITThis is what I came up with combining suggestions here with what worked for me. I call this from the Paint_Event of any Container I need to. <code>  ControlPaint.DrawBorder(Graphics.FromHwnd(this.Handle), tbxLastName.ClientRectangle, Color.Firebrick, ButtonBorderStyle.Solid); private void panel1_Paint(object sender, PaintEventArgs e){ ControlPaint.DrawBorder(e.Graphics, this.panel1.ClientRectangle, Color.DarkBlue, ButtonBorderStyle.Solid);} private void grpImmunizationCntrl_Paint(object sender, PaintEventArgs e) { if (lkuNOImmunizationReason.Text.Equals(string.Empty) { ControlPaint.DrawBorder( e.Graphics, lkuNOImmunizationReason.ClientRectangle, Color.Firebrick, ButtonBorderStyle.Solid); } } public static void HighlightRequiredFields(Control container, Graphics graphics, Boolean isVisible) { Rectangle rect = default(Rectangle); foreach (Control control in container.Controls) { if (control.Tag is string && control.Tag.ToString() == ""required"") { rect = control.Bounds; rect.Inflate(3, 3); if (isVisible && control.Text.Equals(string.Empty)) { ControlPaint.DrawBorder(graphics, rect, Color.FromArgb(173,216,230), ButtonBorderStyle.Solid); } else { ControlPaint.DrawBorder(graphics, rect, container.BackColor, ButtonBorderStyle.None); } } if (control.HasChildren) { foreach (Control ctrl in control.Controls) { HighlightRequiredFields(ctrl, graphics, isVisible); } } } }",Draw border around a Control on Button_Click
asp.net mvc help writing helper method," Possible Duplicate: How do I calculate someone's age based on a DateTime type birthday?I want to write an ASP.NET helper method which returns the age of a person given his or her birthday.I've tried code like this: But it's not working. What is the correct way to calculate the person's age based on their birthday? <code>  public static string Age(this HtmlHelper helper, DateTime birthday){ return (DateTime.Now - birthday); //??}",How to calculate an age based on a birthday
How to calculate an age based on a birthday?," Possible Duplicate: How do I calculate someone's age based on a DateTime type birthday?I want to write an ASP.NET helper method which returns the age of a person given his or her birthday.I've tried code like this: But it's not working. What is the correct way to calculate the person's age based on their birthday? <code>  public static string Age(this HtmlHelper helper, DateTime birthday){ return (DateTime.Now - birthday); //??}",How to calculate an age based on a birthday
How to get friendly device name from DEV_BROADCAST_DEVICEINTERFACE," I've registered a window with RegisterDeviceNotification and can successfully recieve DEV_BROADCAST_DEVICEINTERFACE messages. However, the dbcc_name field in the returned struct is always empty. The struct I have is defined as such: And I'm using Marshal.PtrToStructure on the LParam of the WM_DEVICECHANGE message.Should this be working? Or even better... Is there an alternative way to get the name of a device upon connection?EDIT (02/05/2010 20:56GMT):I found out how to get the dbcc_name field to populate by doing this: but I still need a way to get a ""Friendly"" name from what is int dbcc_name. It looks like the following: \?\USB#VID_05AC&PID_1294&MI_00#0#{6bdd1fc6-810f-11d0-bec7-08002be2092f}And I really just want it to say ""Apple iPhone"" (which is what the device is in this case). <code>  [StructLayout(LayoutKind.Sequential)]public struct DEV_BROADCAST_DEVICEINTERFACE{ public int dbcc_size; public int dbcc_devicetype; public int dbcc_reserved; public Guid dbcc_classguid; [MarshalAs(UnmanagedType.LPStr)] public string dbcc_name;} [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]public struct DEV_BROADCAST_DEVICEINTERFACE{ public int dbcc_size; public int dbcc_devicetype; public int dbcc_reserved; public Guid dbcc_classguid; [MarshalAs(UnmanagedType.ByValTStr, SizeConst=255)] public string dbcc_name;}",How to get friendly device name from DEV_BROADCAST_DEVICEINTERFACE and Device Instance ID
How do I call unmanaged C++ from C#?," I have a class implemented in C++ that's responsible for the arithmetic computation of the program, and an interface using WPF. I process the input with C# but then how can I use my C++ class?I've seen some comments about making a managed C++ wrapper class to interact with it, but I don't know where to start. Nor do I know how I'd go to compile it along with all the other code. I can't really find a tutorial on this, and the stuff google shows on managed C++ doesn't really seem helpful.Anything out there to help me out? This doesn't seem unreasonable to me.EDIT Tried m3rLinEz solution but it's giving me a BadImageFormatException, I think it's because the DLL isn't generated. I did everything as told, I don't know what happened. Any ideas? <code> ",How do I call C++/CLI from C#?
How do I call native C++ from C#?," I have a class implemented in C++ that's responsible for the arithmetic computation of the program, and an interface using WPF. I process the input with C# but then how can I use my C++ class?I've seen some comments about making a managed C++ wrapper class to interact with it, but I don't know where to start. Nor do I know how I'd go to compile it along with all the other code. I can't really find a tutorial on this, and the stuff google shows on managed C++ doesn't really seem helpful.Anything out there to help me out? This doesn't seem unreasonable to me.EDIT Tried m3rLinEz solution but it's giving me a BadImageFormatException, I think it's because the DLL isn't generated. I did everything as told, I don't know what happened. Any ideas? <code> ",How do I call C++/CLI from C#?
C# Expression Trees and Invoking a Delegate," So I have a delegate which points to some function which I don't actually know about when I first create the delegate object. The object is set to some function later.I also then want to make an expression tree that invokes the delegate with an argument (for this question's sake the argument can be 5). This is the bit I'm struggling with; the code below shows what I want but it doesn't compile. For this example I could do (this is practical since I need to build the expression trees at runtime): This makes expr become: Which seems to mean that to use the delegate func, I need to produce the value(Test.Program+<>c__DisplayClass0).func bit.So, how can I make an expression tree which invokes a delegate? <code>  Func<int, int> func = null;Expression expr = Expression.Invoke(func, Expression.Constant(5)); Func<int, int> func = null;Expression<Func<int>> expr = () => func(5); () => Invoke(value(Test.Program+<>c__DisplayClass0).func, 5)",Expression Trees and Invoking a Delegate
"C#, how to delete files older than 3 months old in a directory?"," I would like to know (using C#) how I can delete files in a certain directory older than 3 months, but I guess the date period could be flexible. Just to be clear: I am looking for files that are older than 90 days, in other words files created less than 90 days ago should be kept, all others deleted. <code> ",Delete files older than 3 months old in a directory using .NET
how to delete files older than 3 months old in a directory using .net?," I would like to know (using C#) how I can delete files in a certain directory older than 3 months, but I guess the date period could be flexible. Just to be clear: I am looking for files that are older than 90 days, in other words files created less than 90 days ago should be kept, all others deleted. <code> ",Delete files older than 3 months old in a directory using .NET
Filenames of thumbnail files in PowerPoint 2007," Presentation.Export(filename, ""PNG"", sizeX, sizeY); creates thumbnail images of all slides in the PowerPoint presentation. My problem is that the thumbnail filenames change according to the Language of PowerPoint.On an English PowerPoint, the thumbnail files are: ""slide1.png"", ""slide2.png"", etc.On Hebrew PowerPoint: 1.png, 2.png, etc.How can I control the name of each slide on export to PNG? <code> ",Naming Slide Images on Export in PowerPoint 2007
C# Procees Killing," I need to write a program in c# that would just start, kill one process\exe that it is supposed to kill and end itself. The process I need to kill is another C# application so it is a local user process and I know the path to the exe. <code> ",C# Process Killing
c# instantiate class from string," I have an abstract class and I want to initalize it to a class that extends it.I have the child classes name as a string.Besides this... How can I do this? Basically how do I get rid of the if statements here? <code>  String childClassString;MyAbstractClass myObject;if (childClassString = ""myExtenedObjectA"") myObject = new ExtenedObjectA();if (childClassString = ""myExtenedObjectB"") myObject = new ExtenedObjectB();",How do I instantiate a class given its string name?
is there any better way of doing this...," Assume you are given two arrays of integers of constant length which is 3, and you are always sure that two elements of the given two arrray will have same values.so assume array A has three values: a, b, c.and array B has three values: d, e, f.we are sure that two of the values will be same. we are asked to put these four different values in an array of size 4, such that output array C, should have in indices 1 and 2 the same values from arrays A and B. and at indices 0 and 3 it should have the different values of array A and B. i have implemented it, but really not satisfied with this solution... does anyone has better solution idea? except the one that would put my counters in array... :) <code>  int[] a = { 1, 201, 354 };int[] b = { 404, 201, 354 };int[] c = new int[4];for (int i = 0; i < c.Length; i++){ Console.WriteLine(c[i]);}",Find duplicates between arrays
Find duplicates in array.," Assume you are given two arrays of integers of constant length which is 3, and you are always sure that two elements of the given two arrray will have same values.so assume array A has three values: a, b, c.and array B has three values: d, e, f.we are sure that two of the values will be same. we are asked to put these four different values in an array of size 4, such that output array C, should have in indices 1 and 2 the same values from arrays A and B. and at indices 0 and 3 it should have the different values of array A and B. i have implemented it, but really not satisfied with this solution... does anyone has better solution idea? except the one that would put my counters in array... :) <code>  int[] a = { 1, 201, 354 };int[] b = { 404, 201, 354 };int[] c = new int[4];for (int i = 0; i < c.Length; i++){ Console.WriteLine(c[i]);}",Find duplicates between arrays
Find duplicates in array," Assume you are given two arrays of integers of constant length which is 3, and you are always sure that two elements of the given two arrray will have same values.so assume array A has three values: a, b, c.and array B has three values: d, e, f.we are sure that two of the values will be same. we are asked to put these four different values in an array of size 4, such that output array C, should have in indices 1 and 2 the same values from arrays A and B. and at indices 0 and 3 it should have the different values of array A and B. i have implemented it, but really not satisfied with this solution... does anyone has better solution idea? except the one that would put my counters in array... :) <code>  int[] a = { 1, 201, 354 };int[] b = { 404, 201, 354 };int[] c = new int[4];for (int i = 0; i < c.Length; i++){ Console.WriteLine(c[i]);}",Find duplicates between arrays
"Add a control on a form, from another Thread."," I was trying to postpone adding controls to my main form, with a goal to speed up it's start time. Well I run in the following exception: Cross-thread operation not valid: Control 'Form1' accessed from a thread other than the thread it was created on.I tried to simply the problem on a smaller example but the problem stays. Here is my code: I did use the Invoke method and did check if InvokeRequiered is true, but InvokeRequiered keep staying ""true"". I really don't understand that. At least I would expect StackOverflow exception, since this is a recursion call.So, if anyone met the similar problem, please could you tell me what did I do wrong? <code>  using System;using System.Drawing;using System.Threading;using System.Windows.Forms;namespace AddConrolFromAnotherThread { public partial class Form1 : Form { public Form1() { InitializeComponent(); } private void AddButton() { if(this.InvokeRequired){ this.Invoke(new MethodInvoker(this.AddButton)); } Random random = new Random(2); Thread.Sleep(20); Button button = new Button(); button.Size = new Size(50,50); button.Location = new Point(random.Next(this.Width),random.Next(this.Height)); this.Controls.Add(button); } private void buttonStart_Click(object sender, EventArgs e) { Thread addControlThread = new Thread(new ThreadStart(this.AddButton)); addControlThread.Start(); } }}","Add a control on a form, from another Thread"
Best way to display read only Text in C#," Showing text in a Textbox that's got property Enabled set to false or read-only set to true produces black on grey text, which isn't very nice to read at all.What's the easiest way to show read only text nicely in Windows Forms? <code> ",Best way to display read-only text in C#
Detecting coincident part of two line segments in C#," This question is related to:How do I determine the intersection point of two lines in GDI+? (great explanation of algebra but no code)How do you detect where two line segments intersect? (accepted answer doesn't actually work)But note that an interesting sub-problem is completely glossed over in most solutions which just return null for the coincident case even though there are three sub-cases:coincident but do not overlaptouching just points and coincidentoverlap/coincident line sub-segmentFor example we could design a C# function like this: where (a1,a2) is one line segment and (b1,b2) is another.This function would need to cover all the weird cases that most implementations or explanations gloss over. In order to account for the weirdness of coincident lines, the function could return an array of PointF's:zero result points (or null) if the lines are parallel or do not intersect (infinite lines intersect but line segments are disjoint, or lines are parallel)one result point (containing the intersection location) if they do intersect or if they are coincident at one pointtwo result points (for the overlapping part of the line segments) if the two lines are coincident <code>  public static PointF[] Intersection(PointF a1, PointF a2, PointF b1, PointF b2)",Detecting coincident subset of two coincident line segments
FileUpload and UpdatePanel: FileUpload.HasFile is always FALSE.," I'm developing an ASP.NET application with C# and Visual Studio 2008 SP1. I'm using WebForms.I have an ASPX page with two UpdatePanels, one on the left that holds a TreeView and other on the right where I load dynamically user controls.One user control, that I used on right panel, has a FileUpload control and a button to save that file on server. The ascx code to save control is: I make a full postback to upload the file to the server and save it to database. But I always getting False on FileUpload.HasFile.I problem is the right UpdatePanel. I need it to load dynamically the user controls. This panel has three UpdatePanels to load the three user controls that I use.Maybe I can use an Async File Uploader or delete the right Update Panel and do a full postback to load controls dynamically.Any advice?UPDATE:RegisterPostBackControl works... the second time I click on save button. First time FileUpload.HasFile is FALSE, and second time is TRUE.Second UpdateOn first click I also check ScriptManager.IsInAsyncPostBack and is FALSE. I don't understand ANYTHING!!Why?The code to load user control first time, and on each postback is: Thank you. <code>  <asp:UpdatePanel ID=""UpdatePanelBotons"" runat=""server"" RenderMode=""Inline"" UpdateMode=""Conditional""><ContentTemplate> <asp:Button ID=""Save"" runat=""server"" Text=""Guardar"" onclick=""Save_Click"" CssClass=""button"" /> </ContentTemplate> <Triggers> <asp:PostBackTrigger ControlID=""Save"" /> </Triggers></asp:UpdatePanel> DynamicControls.CreateDestination ud = this.LoadControl(ucUrl) as DynamicControls.CreateDestination;if (ud != null){ Button save = ud.FindControl(""Save"") as Button; if (save != null) ScriptManager1.RegisterPostBackControl(save); PanelDestination.Controls.Add(ud);}",FileUpload and UpdatePanel: ScriptManager.RegisterPostBackControl works the second time.
"C#, convert image to grayscale"," Is there a way to convert an image to grayscale 16 bits per pixel format, rather than setting each of the r,g and b components to luminance. I currently have a bmp from file. I want a Bitmap d, that is grayscale version of c. I do see a constructor that includes System.Drawing.Imaging.PixelFormat, but I don't understand how to use that. I'm new to Image Processing and the relevant C# libraries, but have a moderate experience with C# itself.Any help, reference to an online source, hint or suggestion will be appreciated. EDIT: d is the grayscale version of c. <code>  Bitmap c = new Bitmap(""filename"");",Convert an image to grayscale
"C#, How can I improve this try / catch scenario?"," I have a web service method I am calling which is 3rd party and outside of my domain. For some reason every now and again the web service fails with a gateway timeout. Its intermittent and a call to it directly after a failed attempt can succeed. Now I am left with a coding dilemma, I have code that should do the trick, but the code looks like amateur hour, as you'll see below. Is this really bad code, or acceptable given the usage? If its not acceptable, how can I improve it? Please try hard to keep a straight face while looking at it. <code>  try{ MDO = OperationsWebService.MessageDownload(MI);}catch{ try { MDO = OperationsWebService.MessageDownload(MI); } catch { try { MDO = OperationsWebService.MessageDownload(MI); } catch { try { MDO = OperationsWebService.MessageDownload(MI); } catch { try { MDO = OperationsWebService.MessageDownload(MI); } catch (Exception ex) { // 5 retries, ok now log and deal with the error. } } } }}",How can I improve this exception retry scenario?
Simulate button click c#," I have written a WinForms program in C#.Net to click a button programmatically within a password form.Form1 loads and shows Form2 as a dialogue box.The application will close if DialogResult is anything other that DialogResult.OK.So far I have a button click event, which is coded as follows: I use radButton1.PerformClick();, but running the program gives me the following message: I'm unsure what is causing this exception to throw. <code>  if (txtpass.Text == """") { MessageBox.Show(""You need to enter a password"", ""Password"", MessageBoxButtons.OK, MessageBoxIcon.Asterisk); txtpass.Focus(); } else { if (txtpass.Text == ""1234"") { radButton1.DialogResult = DialogResult.OK; radButton1.PerformClick(); } else { MessageBox.Show(""Password Incorrect"", ""Password"", MessageBoxButtons.OK, MessageBoxIcon.Error); txtpass.Text = """"; txtpass.Focus(); } } An unhandled exception of type 'System.StackOverflowException' occurred in mscorlib.dll",Programmatic button click throws 'System.StackOverflowException' exception
Invalidate(); Vs. Update();," I have code that lets be drag around a borderless form in winforms that I've been using for several months now, which works extremely well.But when I first was given the code, they used this.Invalidate(); in the MouseMove event of the Form, and the Form flickered a little and was slow when dragging around. So, I replaced Invalidate() with Update() in the MouseMove event and, to my surprise, the Form can now be dragged very smoothly and has no flickering whatsoever.Can somebody explain to me why Update makes the code work better than Invalidate, even when Invalidate sounds like it's the right one to be using?Thanks :)P.S. Maybe it would help more if I added the code... Adding it now.Edit - Here's the code: <code>  private void titlebar_MouseDown(object sender, MouseEventArgs e){ this.IsMouseDown = true; this.LastCursorPosition = new Point(e.X, e.Y); if (this.BackColor == Color.White) { this.BackColor = Color.GhostWhite; tbox.BackColor = Color.GhostWhite; tbox.ForeColor = Color.Black; } else { this.BackColor = Color.FromArgb(20, 20, 20); tbox.BackColor = Color.FromArgb(20, 20, 20); tbox.ForeColor = Color.White; }}private void titlebar_MouseMove(object sender, MouseEventArgs e){ if (this.IsMouseDown == true) { //Move the form this.Location = new Point(this.Left - (this.LastCursorPosition.X - e.X), this.Top - (this.LastCursorPosition.Y - e.Y)); // Update works better than Invalidate();. Update(); }}private void titlebar_MouseUp(object sender, MouseEventArgs e){ this.IsMouseDown = false; this.BackColor = fc; tbox.BackColor = fc;}",Invalidate vs Update
Where is the system locale set for .Net," I have a problem with a c# assembly (.net 2.0 written using Visual studio 2005) that is installed on a UK server and should use UK regional settings.What my code does is to convert a date in the form dd/MM/yyyy into utc. i.e. yyyy-mm-dd. The problem arose with dates like 16/02/2010 where the component failed to convert the date and returned Error. After debugging I realised that, for a strange reason, the CultureInfo returned by System.CultureInfo is en-US.I can programatically change those settings using: and my code works fine. However I don't want to do that all the time as my system should be UK. Not US. So, how do I change the default culture for .Net framework to be by default en-GB instead of en-US ? For information:I have tried to update the machine.config file and specify culture=en-GB for the globalization section (it was set to neutral) but it doesn't work either [have done that for 1.1 and 2.0] but it's possible I have not changed it correctly.I have verified my windows regional settings and they are definitely set-up to UK with dates as dd/MM/yyyy I am running in a Virtual server and have verified my host system. It too is set to UKEdit:A bit of extra detail about the context. The assembly in question is being called via COM interop from a native C++ third party component that is running as a COM+ application. <code>  Thread.CurrentThread.CurrentCulture = new CultureInfo(""en-GB"", false); ",Where is the system locale/culture set for .Net
Calling the overriden method from the base class in C#," Given the following C# class definitions and code: I would like to call the MyMethod() that is actually found in A or B, assuming the object passed in is actually an instance of A or B, not that which is found in BaseClass. Short of doing something like this: How can I do it? <code>  public class BaseClass{ public virtual void MyMethod() { ...do something... }}public class A : BaseClass{ public override void MyMethod() { ...do something different... }}public class B : BaseClass{ public override void MyMethod() { ...do something different... }}public class AnotherObject{ public AnotherObject(BaseClass someObject) { someObject.MyMethod(); //This calls the BaseClass method, unfortunately. }} public class AnotherObject{ public AnotherObject(BaseClass someObject) { A temp1 = someObject as A; if (A != null) { A.MyMethod(); } B temp2 = someObject as B; if (B != null) { B.MyMethod(); } }}",Calling the overridden method from the base class in C#
how can i convert a list of objects to csv," If I have a list of objects called ""Car"": How do I convert a list of objects, e.g. List<Car> to a csv? <code>  public class Car{ public string Name; public int Year; public string Model;}",How can I convert a list of objects to csv?
arraylist vs List<> in c#, What is the difference between ArrayList and List<> in C#? Is it only that List<> has a type while ArrayList doesn't? <code> ,ArrayList vs List<> in C#
Why a C# struct cannot be inherited?," I am reading CLR via C# by Jeffery Richter and it says a struct is a value type and cannot be inherited.Are there any technical or philosophical reasons?ADD 1 - 5:53 PM 11/11/2020Every decision, no matter how reasonable or accidental it may look, has its impact, subtle or profound. We try to decouple things, sometimes by creating new coupling... <code> ",Why C# structs cannot be inherited?
"Request[""key""] vs Request.Params[""key""] vs Request.QueryString[""key""] C# asp.net"," Request[""key""] vs Request.Params[""key""] vs Request.QueryString[""key""]Which method do you seasoned programmers use? and why? <code> ","Request[""key""] vs Request.Params[""key""] vs Request.QueryString[""key""]"
Take next parameter as width in string.Format() (C#)," In C#, I have a width I want to use for some strings, but I won't know that width until runtime. I'm doing something like this: Is there a string formatting directive that lets me specify this without smashing my own format string together like this?I looked around on MSDN for a little while and I feel like I'm missing a whole chapter on format strings or something. <code>  string.Format(""{0, "" + digits + ""}"", value) // prints 123 as "" 123""",Take next parameter as field width in String.Format
Remove readonly of Folder from c#, How can I programatically remove the readonly attribute from a directory in C#? <code> ,Remove readonly attribute from directory
C#.Net: Taking screenshot of a webpage," How do take a sceenshot of a webpage programmatically given the URL as input?And here is what I have till now: But this is not working. It is only giving me a white blank picture. What am I missing here?Is there any other way I could get the screenshot of a web page programmatically? <code>  // The size of the browser window when we want to take the screenshot (and the size of the resulting bitmap)Bitmap bitmap = new Bitmap(1024, 768);Rectangle bitmapRect = new Rectangle(0, 0, 1024, 768);// This is a method of the WebBrowser control, and the most important partwebBrowser1.DrawToBitmap(bitmap, bitmapRect);// Generate a thumbnail of the screenshot (optional)System.Drawing.Image origImage = bitmap;System.Drawing.Image origThumbnail = new Bitmap(120, 90, origImage.PixelFormat);Graphics oGraphic = Graphics.FromImage(origThumbnail);oGraphic.CompositingQuality = CompositingQuality.HighQuality;oGraphic.SmoothingMode = SmoothingMode.HighQuality;oGraphic.InterpolationMode = InterpolationMode.HighQualityBicubic;Rectangle oRectangle = new Rectangle(0, 0, 120, 90);oGraphic.DrawImage(origImage, oRectangle);// Save the file in PNG formatorigThumbnail.Save(@""d:\Screenshot.png"", ImageFormat.Png);origImage.Dispose();",Taking screenshot of a webpage programmatically
C#.Net: Taking screenshot of a webpage programmatically," How do take a sceenshot of a webpage programmatically given the URL as input?And here is what I have till now: But this is not working. It is only giving me a white blank picture. What am I missing here?Is there any other way I could get the screenshot of a web page programmatically? <code>  // The size of the browser window when we want to take the screenshot (and the size of the resulting bitmap)Bitmap bitmap = new Bitmap(1024, 768);Rectangle bitmapRect = new Rectangle(0, 0, 1024, 768);// This is a method of the WebBrowser control, and the most important partwebBrowser1.DrawToBitmap(bitmap, bitmapRect);// Generate a thumbnail of the screenshot (optional)System.Drawing.Image origImage = bitmap;System.Drawing.Image origThumbnail = new Bitmap(120, 90, origImage.PixelFormat);Graphics oGraphic = Graphics.FromImage(origThumbnail);oGraphic.CompositingQuality = CompositingQuality.HighQuality;oGraphic.SmoothingMode = SmoothingMode.HighQuality;oGraphic.InterpolationMode = InterpolationMode.HighQualityBicubic;Rectangle oRectangle = new Rectangle(0, 0, 120, 90);oGraphic.DrawImage(origImage, oRectangle);// Save the file in PNG formatorigThumbnail.Save(@""d:\Screenshot.png"", ImageFormat.Png);origImage.Dispose();",Taking screenshot of a webpage programmatically
How to make tabPage Text to be Bold, I have some tabControl in C# Windows app. It has some tabPages. Does anyone kwows how to make the tabPage Text to become Bold..? <code> ,How do I make a TabPage's title text bold?
confusing use of a comma in if statement," I have this piece of code in C++: But how would it look in C#? <code>  ihi = y[0]>y[1] ? (inhi=1,0) : (inhi=0,1);",Confusing use of a comma in an 'if' statement
Calculate GPS coordinates to form a radius of given size.," I've come up with a method that takes a coordinate and a range (in miles) and return a list of coordinates that form a circle around the origin. I seem to have made some progress with it, but I have an issue with getting the range part down. The issue I've found is that the constant I'm using to tell the distance in miles to degrees changes depending on location.. Does anyone have any suggestions for resolving this issue, or a better mousetrap altogether?EDIT:I should note, I'm horrible at math :) <code>  private const Double LAT_MILE = 0.0144839;private const Double LONG_MILE = 0.0190693;public static List<Gps.Coordinate> GetRadius(Double OriginLatitude, Double OriginLongitude, Double Range, int Points){ List<Gps.Coordinate> Result = new List<Coordinate>(); //insert a new point for (int i = 0; i < Points; i++) { Result.Add(new Gps.Coordinate() { Latitude = ((Range * LAT_MILE) * System.Math.Cos(i)) + OriginLatitude, Longitude = ((Range * LONG_MILE) * System.Math.Sin(i)) + OriginLongitude }); } //sort using nearest neighbor return SortCoords(ref Result);}",Calculate GPS coordinates to form a radius of given size
OutOfMemoryException - Microsoft Visual C# 2008 Express Edition," How can I reduce the number of loaded dlls When debugging in Visual C# 2008 Express Edition?When running a visual C# project in the debugger I get an OutOfMemoryException due to fragmentation of 2GB virtual address space and we assume that the loaded dlls might be the reason for the fragmentation. Brian Rasmussen, you made my day! :)His proposal of ""disabling the visual studio hosting process"" solved the problem.(for more information see history of question-development below)Hi,I need two big int-arrays to be loaded in memory with ~120 million elements (~470MB) each, and both in one Visual C# project.When I'm trying to instantiate the 2nd Array I get an OutOfMemoryException.I do have enough total free memory and after doing a web-search I thought my problem is that there aren't big enough contiguous free memory blocks on my system. BUT! - when I'm instantiating only one of the arrays in one Visual C# instance and then open another Visual C# instance, the 2nd instance can instantiate an array of 470MB.(Edit for clarification: In the paragraph above I meant running it in the debugger of Visual C#)And the task-manager shows the corresponding memory usage-increase just as you would expect it.So not enough contiguous memory blocks on the whole system isn't the problem. Then I tried running a compiled executable that instantiates both arrays which works also (memory usage 1GB)Summary:OutOfMemoryException in Visual C# using two big int arrays, but running the compiled exe works (mem usage 1GB) and two separate Visual C# instances are able to find two big enough contiguous memory blocks for my big arrays, but I need one Visual C# instance to be able to provide the memory.Update:First of all special thanks to nobugz and Brian Rasmussen, I think they are spot on with their prediction that ""the Fragmentation of 2GB virtual address space of the process"" is the problem.Following their suggestions I used VMMap and listdlls for my short amateur-analysis and I get:* 21 dlls listed for the ""standalone""-exe. (the one that works and uses 1GB of memory.)* 58 dlls listed for vshost.exe-version. (the version which is run when debugging and that throws the exception and only uses 500MB)VMMap showed me the biggest free memory blocks for the debugger version to be 262,175,167,155,108MBs.So VMMap says that there is no contiguous 500MB block and according to the info about free blocks I added ~9 smaller int-arrays which added up to more than 1,2GB memory usage and actually did work.So from that I would say that we can call ""fragmentation of 2GB virtual address space"" guilty.From the listdll-output I created a small spreadsheet with hex-numbers converted to decimal to check free areas between dlls and I did find big free space for the standalone version inbetween (21) dlls but not for the vshost-debugger-version (58 dlls). I'm not claiming that there can't be anything else between and I'm not really sure if what I'm doing there makes sense but it seems consistent with VMMaps analysis and it seems as if the dlls alone already fragment the memory for the debugger-version.So perhaps a solution would be if I would be able to reduce the number of dlls used by the debugger.1. Is that possible?2. If yes how would I do that? <code> ",Microsoft Visual C# 2008 Reducing number of loaded dlls
OutOfMemoryException While Allocating Large Arrays in a .NET Program," How can I reduce the number of loaded dlls When debugging in Visual C# 2008 Express Edition?When running a visual C# project in the debugger I get an OutOfMemoryException due to fragmentation of 2GB virtual address space and we assume that the loaded dlls might be the reason for the fragmentation. Brian Rasmussen, you made my day! :)His proposal of ""disabling the visual studio hosting process"" solved the problem.(for more information see history of question-development below)Hi,I need two big int-arrays to be loaded in memory with ~120 million elements (~470MB) each, and both in one Visual C# project.When I'm trying to instantiate the 2nd Array I get an OutOfMemoryException.I do have enough total free memory and after doing a web-search I thought my problem is that there aren't big enough contiguous free memory blocks on my system. BUT! - when I'm instantiating only one of the arrays in one Visual C# instance and then open another Visual C# instance, the 2nd instance can instantiate an array of 470MB.(Edit for clarification: In the paragraph above I meant running it in the debugger of Visual C#)And the task-manager shows the corresponding memory usage-increase just as you would expect it.So not enough contiguous memory blocks on the whole system isn't the problem. Then I tried running a compiled executable that instantiates both arrays which works also (memory usage 1GB)Summary:OutOfMemoryException in Visual C# using two big int arrays, but running the compiled exe works (mem usage 1GB) and two separate Visual C# instances are able to find two big enough contiguous memory blocks for my big arrays, but I need one Visual C# instance to be able to provide the memory.Update:First of all special thanks to nobugz and Brian Rasmussen, I think they are spot on with their prediction that ""the Fragmentation of 2GB virtual address space of the process"" is the problem.Following their suggestions I used VMMap and listdlls for my short amateur-analysis and I get:* 21 dlls listed for the ""standalone""-exe. (the one that works and uses 1GB of memory.)* 58 dlls listed for vshost.exe-version. (the version which is run when debugging and that throws the exception and only uses 500MB)VMMap showed me the biggest free memory blocks for the debugger version to be 262,175,167,155,108MBs.So VMMap says that there is no contiguous 500MB block and according to the info about free blocks I added ~9 smaller int-arrays which added up to more than 1,2GB memory usage and actually did work.So from that I would say that we can call ""fragmentation of 2GB virtual address space"" guilty.From the listdll-output I created a small spreadsheet with hex-numbers converted to decimal to check free areas between dlls and I did find big free space for the standalone version inbetween (21) dlls but not for the vshost-debugger-version (58 dlls). I'm not claiming that there can't be anything else between and I'm not really sure if what I'm doing there makes sense but it seems consistent with VMMaps analysis and it seems as if the dlls alone already fragment the memory for the debugger-version.So perhaps a solution would be if I would be able to reduce the number of dlls used by the debugger.1. Is that possible?2. If yes how would I do that? <code> ",Microsoft Visual C# 2008 Reducing number of loaded dlls
OutOfMemoryException - Microsoft Visual C# 2008," How can I reduce the number of loaded dlls When debugging in Visual C# 2008 Express Edition?When running a visual C# project in the debugger I get an OutOfMemoryException due to fragmentation of 2GB virtual address space and we assume that the loaded dlls might be the reason for the fragmentation. Brian Rasmussen, you made my day! :)His proposal of ""disabling the visual studio hosting process"" solved the problem.(for more information see history of question-development below)Hi,I need two big int-arrays to be loaded in memory with ~120 million elements (~470MB) each, and both in one Visual C# project.When I'm trying to instantiate the 2nd Array I get an OutOfMemoryException.I do have enough total free memory and after doing a web-search I thought my problem is that there aren't big enough contiguous free memory blocks on my system. BUT! - when I'm instantiating only one of the arrays in one Visual C# instance and then open another Visual C# instance, the 2nd instance can instantiate an array of 470MB.(Edit for clarification: In the paragraph above I meant running it in the debugger of Visual C#)And the task-manager shows the corresponding memory usage-increase just as you would expect it.So not enough contiguous memory blocks on the whole system isn't the problem. Then I tried running a compiled executable that instantiates both arrays which works also (memory usage 1GB)Summary:OutOfMemoryException in Visual C# using two big int arrays, but running the compiled exe works (mem usage 1GB) and two separate Visual C# instances are able to find two big enough contiguous memory blocks for my big arrays, but I need one Visual C# instance to be able to provide the memory.Update:First of all special thanks to nobugz and Brian Rasmussen, I think they are spot on with their prediction that ""the Fragmentation of 2GB virtual address space of the process"" is the problem.Following their suggestions I used VMMap and listdlls for my short amateur-analysis and I get:* 21 dlls listed for the ""standalone""-exe. (the one that works and uses 1GB of memory.)* 58 dlls listed for vshost.exe-version. (the version which is run when debugging and that throws the exception and only uses 500MB)VMMap showed me the biggest free memory blocks for the debugger version to be 262,175,167,155,108MBs.So VMMap says that there is no contiguous 500MB block and according to the info about free blocks I added ~9 smaller int-arrays which added up to more than 1,2GB memory usage and actually did work.So from that I would say that we can call ""fragmentation of 2GB virtual address space"" guilty.From the listdll-output I created a small spreadsheet with hex-numbers converted to decimal to check free areas between dlls and I did find big free space for the standalone version inbetween (21) dlls but not for the vshost-debugger-version (58 dlls). I'm not claiming that there can't be anything else between and I'm not really sure if what I'm doing there makes sense but it seems consistent with VMMaps analysis and it seems as if the dlls alone already fragment the memory for the debugger-version.So perhaps a solution would be if I would be able to reduce the number of dlls used by the debugger.1. Is that possible?2. If yes how would I do that? <code> ",Microsoft Visual C# 2008 Reducing number of loaded dlls
Online Code Coloring Service," I would like to know if there is an online service where we paste the code and it generates back the colored HTML source code for that code. It could be PHP, HTML, CSS, JavaScript, C, and Java.The idea is that once I have the colored HTML code, I could easily put that in my wordpress.com blog. I know about [sourcecode language=""whatever""], but I just wanted to know an online service that supports multiple languages. The benefit is that, I can choose any color style/theme from that online service for my code. <code> ",Is there an online code coloring service?
how to get the list of all printers in computer - C# Winform," I need to get the list of all printers that connect to computer?How I can do it in C#, WinForms? <code> ",How to get the list of all printers in computer
Compute the Centroid of a  3D Planer Polygon," This is a similar question to this one here.Given a list of 3D coordinates that define the surface( Point3D1, Point3D2, Point3D3, and so on), how to calculate the centroid of the surface?In 2D the computation is given by the following formula:What about the 3D analogue? <code> ",Compute the centroid of a 3D planar polygon
Compute the Centroid of a  3D Planar Polygon," This is a similar question to this one here.Given a list of 3D coordinates that define the surface( Point3D1, Point3D2, Point3D3, and so on), how to calculate the centroid of the surface?In 2D the computation is given by the following formula:What about the 3D analogue? <code> ",Compute the centroid of a 3D planar polygon
Bind the text of  RichTextArea from xaml , How to Bind the text of RichTextArea from xaml  <code> ,Bind the text of RichTextBox from Xaml 
How many kittens die when WPF is used in a WCF service?," I have a requirement to take client side XAML (from Silverlight) and create a bitmap merged with a server side resource (high res image) and can do this quite easily using WPF (DrawingContext etc). It has been mentioned that server side (hosted in IIS WCF) use of WPF is akin to running Office on the server and a really bad idea.Is WPF built to run on the server? What are the alternatives (particularly with xaml)? What do I need to look out for (memory leaks, threading etc)? <code> ",Can the WPF API be safely used in a WCF service?
convert list to entitycollection<T> or cast it, How would you to convert or cast a List<T> to EntityCollection<T>?Sometimes this occurs when trying to create 'from scratch' a collection of child objects (e.g. from a web form) <code>  Cannot implicitly convert type 'System.Collections.Generic.List' to 'System.Data.Objects.DataClasses.EntityCollection',convert or cast a List<t> to EntityCollection<T>
Returning an EditorTemplate as a PartialView in an Action Result - ASP.Net MVC 2," I have a model similar to this: In my main view, I have tags similar to this: ClassA and ClassB both have Editor templates defined.I created some JavaScript that makes an Ajax call to reload the section1 div. I want the action method to return the editor for ObjectA, ClassA.ascx that is in the EditorTemplates folder.I have the following in my Action method: This gives an error because it cannot find the ClassA view.My solution has been to create a PartialView in the Views folder called ""GetData"" and my return renders the GetData view. The GetData view has only one line of code: This does work, but I was wondering if there was a way for an action method to return and editor template? <code>  public class myModel { public ClassA ObjectA {get; set;} public ClassB ObjectB {get; set;}} <div id=""section1""> <%=Html.EditorFor(m => m.ObjectA)%></div><div id=""section2""> <%=Html.EditorFor(m => m.ObjectB)%></div> public ActionResult GetData(int input) { // Process input here and create modelData return PartialView(""ClassA"", modelData);} <%=Html.RenderForModel()%>",Returning an EditorTemplate as a PartialView in an Action Result
[C#] Convert 24-bit bmp to 16-bit?," I know that the .NET Framework comes with an image conversion class (the System.Drawing.Image.Save method).But I need to convert a 24-bit (R8G8B8) bitmap image to a 16-bit (X1R5G5B5) and I really got no idea on this kind of conversion, and a 24-to-16-bit change in the bmp header wouldn't work (since we need to convert the entire image data).Also I would like to know if I can control over the image Dither, etc.Ideas?Any kind of help would be appreciated. <code> ",Convert 24-bit bmp to 16-bit?
Problem in sending mail with SmtpClient," I want to send a mail message with the SmtpClient class.Here's the code I use: But it always throws an exception: The server committed a protocol violation The server response was: UGFzc3dvcmQ6I can't find the reason for that. Please, if anyone has faced something like this, tell me what to do. <code>  SmtpClient smtpClient = new SmtpClient(""Host"",25);NetworkCredential basicCredential =new NetworkCredential(""UserName"", ""Password"");MailMessage message = new MailMessage();MailAddress fromAddress = new MailAddress(""me@domain.com"");smtpClient.UseDefaultCredentials = false;smtpClient.Credentials = basicCredential;message.From = fromAddress;message.Subject = ""test send"";message.IsBodyHtml = true;message.Body = ""<h1>hello</h1>"";message.To.Add(""mail@domain.com"");smtpClient.Send(message);","Troubleshooting ""The server committed a protocol violation"" when sending mail with SmtpClient"
"Troubleshooting ""The server committed a protocol violation The server response was: UGFzc3dvcmQ6"" when sending mail with SmtpClient."," I want to send a mail message with the SmtpClient class.Here's the code I use: But it always throws an exception: The server committed a protocol violation The server response was: UGFzc3dvcmQ6I can't find the reason for that. Please, if anyone has faced something like this, tell me what to do. <code>  SmtpClient smtpClient = new SmtpClient(""Host"",25);NetworkCredential basicCredential =new NetworkCredential(""UserName"", ""Password"");MailMessage message = new MailMessage();MailAddress fromAddress = new MailAddress(""me@domain.com"");smtpClient.UseDefaultCredentials = false;smtpClient.Credentials = basicCredential;message.From = fromAddress;message.Subject = ""test send"";message.IsBodyHtml = true;message.Body = ""<h1>hello</h1>"";message.To.Add(""mail@domain.com"");smtpClient.Send(message);","Troubleshooting ""The server committed a protocol violation"" when sending mail with SmtpClient"
Double to String keeping trailing zero...," I've tried converting the double value into a string and using the Replace() method to replace the ',' to '.'.This works well but only when the trailing digits are not zero, I need zeros in my string, even if the value is 1234.0. This worked well for the decimal values. I have tried to convert the double to decimal but I lose the decimal digits if there are zeros.I know I'm missing something. I would be grateful for some suggestions. <code> ",Double to String keeping trailing zero
Storing Creditentials in Creditential Manager Service," I have some credentials (username and a password), and I cannot figure out where to store them.I heard about an application storing credentials in the Windows Credential Service, so I looked into this option. It seemed ideal. Just store sensitive information in a Windows Service, and not have to worry about storing them in your own registry key.Unfortunately, I soon found out this was not so simple. The only help I found in MSDN was in C. I then thought I must have been mistaken, but then I downloaded Cain, and saw an entry for decoding credential manager passwords.Is there a way to use this feature in .NET? Please let me know. <code> ",Storing Credentials in Credential Manager Service
What is the advantage of Currying in C#?, What is the advantage of Currying in C#?What is the advantage of achieving partial function application on a curried function? <code> ,What is the advantage of Currying in C#? (achieving partial function)
Convert XMLDocument to String," Here is how I'm currently converting XMLDocument to String The problem with this method is that if I have "" ((quotes) which I have in attributes) it escapes them.For Instance: Above is the expected XML. But it returns I can do String.Replace ""\"" but is that method okay? Are there any side-effects? Will it work fine if the XML itself contains a ""\"" <code>  StringWriter stringWriter = new StringWriter();XmlTextWriter xmlTextWriter = new XmlTextWriter(stringWriter);xmlDoc.WriteTo(xmlTextWriter);return stringWriter.ToString(); <Campaign name=""ABC""></Campaign> <Campaign name=\""ABC\""></Campaign>",Convert XmlDocument to String
Baloon tooltip with close button - C#, How do I create a ballon tool tip with a close button.I can show a tooltip: but I can't do the opposite: Or even a way to show a close box on a Balloon Tip.I saw this question posted on another site but with no (free) answer.Thanks in advance <code>  TaskbarIcon.ShowBalloonTip(10000); TaskbarIcon.CloseBalloonTip();,Balloon tooltip with close button - C#
what is charecter for end of file of filestream?, i am searching in a while loop for a particular character to check whether it reached the end of file.Which character which i can search for ??Eg:  <code>  Indexof('/n') end of lineIndexof(' ') end of word???? ---------- end of file??,what is character for end of file of filestream?
How To?  Use an Expression Tree to call a Generic Method when the Type is only known at runtime.," This is something that I solved using reflection, but would like to see how to do it using expression trees.I have a generic function: that I need to call from else where in my class. Now, normally, this would be be simple: but only if I know, at design time that I am working with an int. When I do not know the type until runtime is where I need the help. Like I said, I know how to do it via reflection, but I would like to do it via expression trees, as my (very limited) understanding is that I can do so.Any suggestions or points to sites where I can get this understanding, preferably with sample code? <code>  private void DoSomeThing<T>( param object[] args ) { // Some work is done here.} DoSomeThing<int>( blah );",How can I use an expression tree to call a generic method when the Type is only known at runtime?
WebBrowser DrawToBitmap other methods?," I am trying to capture the content of the WebBrowser control. DrawToBitmap() would work perfectly, but it is not supported in documentation for the WebBrowser control. I have been trying to find another way to capture the contents of the WebBrowser control and save them to a local image file.Does anyone have any workarounds or other methods to save the contents of the WebBrowser control to a local image file? <code> ",WebBrowser.DrawToBitmap() or other methods?
Can somebody explain me the difference between an error and an exception ? I am really confused about both the two :(, Could you please explain to me what the difference is between an error and an exception? <code> ,What is the difference between an error and an exception in .NET?
What is the difference between an error and an exception in C#?, Could you please explain to me what the difference is between an error and an exception? <code> ,What is the difference between an error and an exception in .NET?
what is meant by default implementation of interface," I have seen this statement in many of the documention samples, like here This class is the default implementation of the ""ISomeInterface"" interfacewhat exactly this means ? Thanks <code> ",what is meant by default implementation of an interface
Does a System.Collection.Collection<T> wrap a  IList<T> or enumerate over the IList<T> or simply wrap it?," If I am exposing a internal member via a Collection property via: When this property is called what happens? For example what happens when the following lines of code are called: It's clear that each time this property is called a new reference type is created but what acctually happens? Does it simply wrap the IList<T> underneath, does it enumerate over the IList<T> and to create a new Collection<T> instance? I'm concerned about performance if this property is used in a for loop. <code>  public Collection<T> Entries{ get { return new Collection<T>(this.fieldImplimentingIList<T>); }} T test = instanceOfAbove.Entries[i];instanceOfAbove[i] = valueOfTypeT;",Does a Collection<T> wrap an IList<T> or enumerate over the IList<T>?
Perform a case insensitive match using Regex without using RegexOptions enumeration," Is it possible to do a case insensitive match in C# using the Regex class without setting the RegexOptions.IgnoreCase flag?What I would like to be able to do is within the regex itself define whether or not I want the match operation to be done in a case insensitive manner.I would like this regex, taylor, to match on the following values:TaylortaylortaYloR <code> ",Case insensitive Regex without using RegexOptions enumeration
"C# : having a ""+"" in the class name ?"," Class name: MyAssembly.MyClass+MyOtherClassThe problem is obviously the + as separator, instead of traditionnal dot, its function, and to find official documentation to see if others separators exist. <code> ","Having a ""+"" in the class name?"
MVC using LINQ? - Can't return anonymous types," I'd like to implement MVC while using LINQ (specifically, LINQ-to-entities). The way I would do this is have the Controller generate (or call something which generates) the result-set using LINQ, then return that to the View to display the data. The problem is, if I do: All the columns are read from the database, even the ones (potentially dozens) I don't want. And - more importantly - I can't do something like this: because there is no way to make anonymous types type-safe! I know for sure there is no nice, clean way of doing this in 3.5 (this is not clean...), but what about 4.0? Is there anything planned, or even proposed? Without something like duck-typing-for-LINQ, or type-safe anonymous return values (it seems to me the compiler should certainly be capable of that), it appears to be nearly impossible to cleanly separate the Controller from the View. <code>  return (from o in myTable select o); return (from o in myTable select new { o.column });",Simple way to return anonymous types (to make MVC using LINQ possible)
Action Delegate C#," So I read MSDN and Stack Overflow. I understand what the Action Delegate does in general but it is not clicking no matter how many examples I do. In general, the same goes for the idea of delegates. So here is my question. When you have a function like this: What is this, and what should I pass to it? <code>  public GetCustomers(Action<IEnumerable<Customer>,Exception> callBack){}",Please Explain .NET Delegates
ASP.NET C# : Adding Bcc to Email sending using SMTP," When sending email using the SMTPClient class in ASP.NET C#, how can I add bcc to the email? How can I add bcc to a MailMessage instance? <code> ",Adding Bcc to Email sending using .NET SmtpClient?
Disable JavaScript error in webbrowser control, I am developing a windows application with a WebBrowser control that navigates to a sharepoint site.My problem is that i am getting JavaScript error.How can i disable the JavaScript error? I don't want them to pop up. <code> ,Disable JavaScript error in WebBrowser control
Why can't I use an Action to a ThreadStart?," Both are delegates and have the same signature, but I can not use Action as ThreadStart.Why? but this seems to work: <code>  Action doIt;doIt = () => MyMethod(""test"");Thread t;t = new Thread(doIt);t.Start(); Thread t;t = new Thread(() => MyMethod(""test""));t.Start();",Why can't I use/cast an Action for/to a ThreadStart?
Who do you Read the value of an attribute in a Method," I need to be able to read the value of my attribute from within my Method, how can I do that? <code>  [MyAttribute(""Hello World"")]public void MyMethod(){ // Need to read the MyAttribute attribute and get its value}",Read the value of an attribute of a method
How do you Read the value of an attribute in a Method," I need to be able to read the value of my attribute from within my Method, how can I do that? <code>  [MyAttribute(""Hello World"")]public void MyMethod(){ // Need to read the MyAttribute attribute and get its value}",Read the value of an attribute of a method
How do you read the value of an attribute in a Method," I need to be able to read the value of my attribute from within my Method, how can I do that? <code>  [MyAttribute(""Hello World"")]public void MyMethod(){ // Need to read the MyAttribute attribute and get its value}",Read the value of an attribute of a method
At what line in the following code should I be commiting my UnitOfWork ?," I have the following code which is in a transaction. I'm not sure where/when I should be commiting my unit of work.On purpose, I've not mentioned what type of Respoistory i'm using - eg. Linq-To-Sql, Entity Framework 4, NHibernate, etc.If someone knows where, can they please explain WHY they have said, where? (i'm trying to understand the pattern through example(s), as opposed to just getting my code to work).Here's what i've got :- <code>  using( TransactionScope transactionScope = new TransactionScope ( TransactionScopeOption.RequiresNew, new TransactionOptions { IsolationLevel = IsolationLevel.ReadUncommitted } )){ _logEntryRepository.InsertOrUpdate(logEntry); //_unitOfWork.Commit(); // Here, commit #1 ? // Now, if this log entry was a NewConnection or an LostConnection, // then we need to make sure we update the ConnectedClients. if (logEntry.EventType == EventType.NewConnection) { _connectedClientRepository.Insert( new ConnectedClient { LogEntryId = logEntry.LogEntryId }); //_unitOfWork.Commit(); // Here, commit #2 ? } // A (PB) BanKick does _NOT_ register a lost connection, // so we need to make sure we handle those scenario's as a LostConnection. if (logEntry.EventType == EventType.LostConnection || logEntry.EventType == EventType.BanKick) { _connectedClientRepository.Delete( logEntry.ClientName, logEntry.ClientIpAndPort); //_unitOfWork.Commit(); // Here, commit #3 ? } _unitOfWork.Commit(); // Here, commit #4 ? transactionScope.Complete();}",At which line in the following code should I commit my unit of work?
[game] How to write ::: in cpp and ??? in c#?," These questions are a kind of game, and I did not find the solution for them.It is possible to write ::: in C++ without using quotes or anything like this and the compiler will accept it (macros are prohibited too).And the same is true for C# too, but in C#, you have to write ???.I think C++ will use the :: scope operator and C# will use ? : , but I do not know the answers to them.Any idea? <code> ",How is it possible to legally write ::: in C++ and ??? in C#?
[game] How is it possible to legally write ::: in C++ and ??? in C#?," These questions are a kind of game, and I did not find the solution for them.It is possible to write ::: in C++ without using quotes or anything like this and the compiler will accept it (macros are prohibited too).And the same is true for C# too, but in C#, you have to write ???.I think C++ will use the :: scope operator and C# will use ? : , but I do not know the answers to them.Any idea? <code> ",How is it possible to legally write ::: in C++ and ??? in C#?
EASY C# PROBLEM," I'm creating an application in C#. Its function is to evaluate if a given is prime and if the same swapped number is prime as well.When I build my solution in Visual Studio, it says that ""an object reference is required for the non-static field, method or property..."". I'm having this problem with the ""volteado"" and ""siprimo"" methods.Where is the problem and how can I fix it? <code>  namespace ConsoleApplication1{ class Program { static void Main(string[] args) { Console.Write(""Write a number: ""); long a= Convert.ToInt64(Console.ReadLine()); // a is the number given by the user long av = volteado(a); // av is ""a"" but swapped if (siprimo(a) == false && siprimo(av) == false) Console.WriteLine(""Both original and swapped numbers are prime.""); else Console.WriteLine(""One of the numbers isnt prime.""); Console.ReadLine(); } private bool siprimo(long a) { // Evaluate if the received number is prime bool sp = true; for (long k = 2; k <= a / 2; k++) if (a % k == 0) sp = false; return sp; } private long volteado(long a) { // Swap the received number long v = 0; while (a > 0) { v = 10 * v + a % 10; a /= 10; } return v; } }}","Error: ""an object reference is required for the non-static field, method or property..."""
Non initialized variable in C# , I have the following piece of code: Code gurus will already see that this gives an error. Bar might not be initialized before the if statement.What is the value of bar? Shouldn't it be null? Aren't they set to null? (null pointer?) <code>  class Foo{ public Foo() { Bar bar; if (null == bar) { } }}class Bar { },Noninitialized variable in C#
C# how to change user settings location," By default settings are stored at: C:\Documents and Settings\\Local Settings\Application Data\<Project Name>How can I change this path to application directory. I also don't want to have different files for different users. How make the settings global? I tried to change the scope of the settings to ""application"" but then I cannot change them at runtime. <code> ",how to change .NET user settings location
C# using statement with a null object," Is it safe to use the using statement on a (potentially) null object?Consider the following example: Is it guaranteed that Dispose will be called only if the object is not null, and I will not get a NullReferenceException? <code>  class Test { IDisposable GetObject(string name) { // returns null if not found } void DoSomething() { using (IDisposable x = GetObject(""invalid name"")) { if (x != null) { // etc... } } }}",Will Dispose() be called in a using statement with a null object?
Using statement with a null object," Is it safe to use the using statement on a (potentially) null object?Consider the following example: Is it guaranteed that Dispose will be called only if the object is not null, and I will not get a NullReferenceException? <code>  class Test { IDisposable GetObject(string name) { // returns null if not found } void DoSomething() { using (IDisposable x = GetObject(""invalid name"")) { if (x != null) { // etc... } } }}",Will Dispose() be called in a using statement with a null object?
Draw a rectangle using c#," Can I draw a rectangle with mouseClick? My code is not working so far. Can you help me? <code>  private void panel1_MouseClick(object sender, MouseEventArgs e){ Graphics g = this.CreateGraphics(); Pen pen = new Pen(Color.Black, 2); g.DrawRectangle(pen, 100,100, 100, 200);}",Draw a rectangle on mouse click
Draw a rectangle using Winforms," Can I draw a rectangle with mouseClick? My code is not working so far. Can you help me? <code>  private void panel1_MouseClick(object sender, MouseEventArgs e){ Graphics g = this.CreateGraphics(); Pen pen = new Pen(Color.Black, 2); g.DrawRectangle(pen, 100,100, 100, 200);}",Draw a rectangle on mouse click
WebBrowser control and XPath," Can i use XPAth expressions to navigate through DOM elements in WebBrowser control? May be attaching javascript code and use document.evaluate function is right way?Can another activeX browser component(firefox,webkit.net) help me to solve my task? <code> ",Navigation and WebBrowser control
[C#] How to share a variable between two classes?," How would you share the same object between two other objects? For instance, I'd like something in that flavor: Here, I don't want to give a ref to the Bar method. What I want to achieve is something that would look like that in C++: I read there is some ref/out stuff, but I couldn't get what I'm asking here. I could only apply some changes in the methods scope where I was using ref/out arguments...I also read we could use pointers, but is there no other way to do it? <code>  class A{ private string foo_; // It could be any other class/struct too (Vector3, Matrix...) public A (string shared) { this.foo_ = shared; } public void Bar() { this.foo_ = ""changed""; }}...// inside mainstring str = ""test"";A a = new A(str);Console.WriteLine(str); // ""test""a.Bar();Console.WriteLine(str); // I get ""test"" instead of ""changed""... :( class A{ int* i;public: A(int* val);};A::A (int* val){ this->i = val;}",How to share a variable between two classes?
Can I use Html Agility Pack for this?," Can Html Agility Pack be used to parse an html string fragment?Such As: Then extract all <b> tags? All the examples I seen so far have been loading like html documents. <code>  var fragment = ""<b>Some code </b>"";",Can I use Html Agility Pack To Parse HTML Fragment?
Distinct by proeprty of class by linq," I have a collection: Cars are uniquely identified by their property CarCode.I have three cars in the collection, and two with identical CarCodes.How can I use LINQ to convert this collection to Cars with unique CarCodes? <code>  List<Car> cars = new List<Car>();",Distinct by property of class with LINQ
Distinct by property of class by linq," I have a collection: Cars are uniquely identified by their property CarCode.I have three cars in the collection, and two with identical CarCodes.How can I use LINQ to convert this collection to Cars with unique CarCodes? <code>  List<Car> cars = new List<Car>();",Distinct by property of class with LINQ
Are concurrency issues possible when using the WCF Service Behavoir attribute set to ConcurrencyMode.Multiple and InstanceContextMode.PerCall?," We have a WCF service that makes a good deal of transactional NHibernate calls. Occasionally we were seeing SQL timeouts, even though the calls were updating different rows and the tables were set to row level locking.After digging into the logs, it looks like different threads were entering the same point in the code (our transaction using block), and an update was hanging on commit. It didn't make sense, though, because we believed that the following service class attribute was forcing a unique execution thread per service call: We recently changed the concurrency mode to ConcurrencyMode.Single and haven't yet run into any issues, but the bug was very difficult to reproduce (if anyone has any thoughts on flushing a bug like that out, let me know!).Anyway, that all brings me to my question: shouldn't an InstanceContextMode of PerCall enforce thread-safety within the service, even if the ConcurrencyMode is set to multiple? How would it be possible for two calls to be serviced by the same service instance?Thanks! <code>  [ServiceBehavior(ConcurrencyMode = ConcurrencyMode.Multiple, InstanceContextMode = InstanceContextMode.PerCall)]",Are concurrency issues possible when using the WCF Service Behavior attribute set to ConcurrencyMode.Multiple and InstanceContextMode.PerCall?
C#: What is the fastest way to count newlines in a string?, Is there a way to improve this: I'm particularly concerned about the Item accessor on the string. Not sure if it is just pointer arithmetic like C/C++.  <code>  private static int CountNewlines(string s){ int len = s.Length; int c = 0; for (int i=0; i < len; i++) { if (s[i] == '\n') c++; } return c;},What is the fastest way to count newlines in a large .NET string?
What is the fastest way to count newlines in a .NET string?, Is there a way to improve this: I'm particularly concerned about the Item accessor on the string. Not sure if it is just pointer arithmetic like C/C++.  <code>  private static int CountNewlines(string s){ int len = s.Length; int c = 0; for (int i=0; i < len; i++) { if (s[i] == '\n') c++; } return c;},What is the fastest way to count newlines in a large .NET string?
Determite when and which a character added or deleted to/from a Text Box.," I have a simple text box in a WPF application.I need to know when a character was added/deleted in the text box, which character and where it was added or deleted. I thought about using the TextBox.KeyDown event, but it has some problems:I can't know where the character was added or deleted.I have no idea how to determine which character was added (from the KeyEventArgs).Any ideas?  <code> ",Determine when and which character is added or deleted in a Text Box
Determine when and which character is added or deleted in a Text Box.," I have a simple text box in a WPF application.I need to know when a character was added/deleted in the text box, which character and where it was added or deleted. I thought about using the TextBox.KeyDown event, but it has some problems:I can't know where the character was added or deleted.I have no idea how to determine which character was added (from the KeyEventArgs).Any ideas?  <code> ",Determine when and which character is added or deleted in a Text Box
"""Authorize"" attribute and 403 error page"," [Authorize] attribute is nice and handy MS invention, and I hope it can solve the issues I have nowTo be more specific:When current client isn't authenticated - [Authorize] redirects from secured action to logon page and after logon was successful - brings user back, this is good.But when current client already authenticated but not authorized to run specific action - all I need is to just display my general 403 page.Is it possible without moving authorization logic within controller's body?Update: The behavior I need in should be semantically equals to this sketch: so - there should no any redirect and url should be stay the same, but contents of the page should be replaced with 403-pageUpdate 2: I implemented sketch in this way: And can't get how to properly forward execution to HomeController.Action_403() so it display 403.Update 3: so this is an answer on how to render specific view template... but still have no idea how to run another controller - anyway, it's enough good solution. <code>  public ActionResult DoWork(){ if (!NotAuthorized()) { // this should be not redirect, but forwarding return RedirectToAction(""403""); } return View();} [HandleError]public class HomeController : Controller{ public ActionResult Index() { ViewData[""Message""] = ""Welcome to ASP.NET MVC!""; return View(); } [CustomActionFilter] public ActionResult About() { return View(); } public ActionResult Error_403() { return Content(""403""); }}public class CustomActionFilter : ActionFilterAttribute{ public override void OnActionExecuting(ActionExecutingContext filterContext) { filterContext.Result = new ContentResult { Content = ""403"" }; }} filterContext.Result = new ViewResult() { ViewName = ""Error_403"" };",How to make Authorize attribute return custom 403 error page instead of redirecting to the Logon page
"Why Moq is thorwing ""expected Invocation on the mock at least once"". Where as it is being set once,even though it is being set to null?"," Following is the code. create a class lib add the ref to NUnit framework 2.5.3.9345 and Moq.dll 4.0.0.0 and paste the following code. Try running it on my machine it throws TestCase 'MoqTest.TryClassTest.IsMessageNotNull' failed: Moq.MockException : Expected invocation on the mock at least once, but was never performed: v => v.Model = It.Is(value(Moq.It+<>c__DisplayClass21[MoqTest.GenInfo]).match) at Moq.Mock.ThrowVerifyException(IProxyCall expected, Expression expression, Times times, Int32 callCount) at Moq.Mock.VerifyCalls(Interceptor targetInterceptor, MethodCall expected, Expression expression, Times times) at Moq.Mock.VerifySet[T](Mock1 mock, Action1 setterExpression, Times times, String failMessage) at Moq.Mock1.VerifySet(Action`1 setterExpression) Class1.cs(22,0): at MoqTest.TryClassTest.IsMessageNotNull() And if you change one line to it works fine. I think Exception is incorrect.  <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using Moq;using NUnit.Framework;namespace MoqTest{ [TestFixture] public class TryClassTest { [Test] public void IsMessageNotNull() { var mockView = new Mock<IView<GenInfo>>(); mockView.Setup(v => v.ModuleId).Returns(""""); TryPresenter tryPresenter = new TryPresenter(mockView.Object); tryPresenter.SetMessage(new object(), new EventArgs()); // mockView.VerifySet(v => v.Message, Times.AtLeastOnce()); mockView.VerifySet(v => v.Model = It.Is<GenInfo>(x => x != null)); } } public class TryPresenter { private IView<GenInfo> view; public TryPresenter(IView<GenInfo> view) { this.view = view; } public void SetMessage(object sender, EventArgs e) { this.view.Model = null; } } public class MyView : IView<GenInfo> { #region Implementation of IView<GenInfo> public string ModuleId { get; set; } public GenInfo Model { get; set; } #endregion } public interface IView<T> { string ModuleId { get; set; } T Model { get; set; } } public class GenInfo { public String Message { get; set; } }} mockView.VerifySet(v => v.Model = It.Is<GenInfo>(x => x != null)); mockView.VerifySet(v => v.Model, Times.AtLeastOnce()); ","Why Moq is throwing ""expected Invocation on the mock at least once"". Where as it is being set once,even though it is being set to null?"
C# : Attachment from byte array?," I have a byte[] with the contents of file. I would like to send it as an attachment using System.Net.Mail. I noticed the attachment class has 1 overload which accepts a stream. Is it possible to pass the byte[] through this overload? <code>  Attachment att = new Attachment(Stream contentStream,string name);",How to add an email attachment from a byte array?
C# : How to add an email attachment from a byte array?," I have a byte[] with the contents of file. I would like to send it as an attachment using System.Net.Mail. I noticed the attachment class has 1 overload which accepts a stream. Is it possible to pass the byte[] through this overload? <code>  Attachment att = new Attachment(Stream contentStream,string name);",How to add an email attachment from a byte array?
What I the virtues of using XML comments? I can't see ones.," I can't understand the virtues of using XML comments. I know they can be converted into nice documentation external to the code, but the same can be achieved with the much more concise DOxygen syntax. In my opinion the XML comments are wrong, because:They obfuscate the comments and the code in general. (They are more difficult to read by humans).Less code can be viewed on a single screen, because ""summary"" and ""/summary"" take additional lines.(removed)What then could have been be the reasons, why XML was preferred in .NET rather that the simple DOxygen syntax? <code> ",What are the virtues of using XML comments in .NET?
What are the virtues of using XML comments?," I can't understand the virtues of using XML comments. I know they can be converted into nice documentation external to the code, but the same can be achieved with the much more concise DOxygen syntax. In my opinion the XML comments are wrong, because:They obfuscate the comments and the code in general. (They are more difficult to read by humans).Less code can be viewed on a single screen, because ""summary"" and ""/summary"" take additional lines.(removed)What then could have been be the reasons, why XML was preferred in .NET rather that the simple DOxygen syntax? <code> ",What are the virtues of using XML comments in .NET?
Creating a Cross-Process EventWaitHandle c#," I have two windows application, one is a windows service which create EventWaitHandle and wait for it. Second application is a windows gui which open it by calling EventWaitHandle.OpenExisting() and try to Set the event. But I am getting an exception in OpenExisting. The Exception is ""Access to the path is denied"".windows Service code Windows GUI code I tried the same code with two sample console application, it was working fine. <code>  EventWaitHandle wh = new EventWaitHandle(false, EventResetMode.AutoReset, ""MyEventName"");wh.WaitOne(); try{ EventWaitHandle wh = EventWaitHandle.OpenExisting(""MyEventName""); wh.Set();}catch (Exception ex){ MessageBox.Show(ex.Message);}",Creating a Cross-Process EventWaitHandle
Exposing a C++ class to C#," I need to expose some C++ classes to C# (I am building on Linux, using mono, so COM is not an option)The evidence I have gathered so far suggests that the best way to approach this is:Write a wrapper C++.Net class around the ISO C++ classConsume the C++.Net classes from C#I have the following questions:First, is this the ""best"" way of achieving the goal of exposing ISO C++ classes to C# ?So far though, I have not seen any examples that actually show how to do this - can anyone suggest some links, or a code snippet to show how this is done for a dummy class?How may I send asynchronous message notifications from the C++ code to the C# code ?. Ideally, I would like to cause the C# class to raise an event, with the received data as an argument <code> ",Exposing an ISO C++ class to C#
Elegant code question: How to avoid creating unneeded object ," The root of my question is that the C# compiler is too smart. It detects a path via which an object could be undefined, so demands that I fill it. In the code, I look at the tables in a DataSet to see if there is one that I want. If not, I create a new one. I know that dtOut will always be assigned a value, but the the compiler is not happy unless it's assigned a value when declared. This is inelegant.How do I rewrite this in a more elegant way?  <code>  System.Data.DataTable dtOut = new System.Data.DataTable(); . . // find table with tablename = grp // if none, create new table bool bTableFound = false; foreach (System.Data.DataTable d1 in dsOut.Tables) { string d1_name = d1.TableName; if (d1_name.Equals(grp)) { dtOut = d1; bTableFound = true; break; } } if (!bTableFound) dtOut = RptTable(grp);",How to avoid creating unneeded object in an elegant way?
"CollectionEditor leads to ""Object does not match target type."""," I have a custom control which has a property of type Collection<System.Drawing.Point>. When I use CollectionEditor to edit this property, the CollectionEditor window shows ""Object does not match target type."" for the ""X"" and ""Y"" properties. But if I use System.Drawing.PointF instead, there's no failure.Can anyone please explain why this difference occurs? <code> ","CollectionEditor yielding ""Object does not match target type."" for System.Drawing.Point"
How to install a windows-service which doesn't have visual-studio installed?," The only way to install windows-service I know is using ""Visual Studio 2008 Command Prompt"", Is there a way to install windows-service on a machine which isn't having Visual Studio installed (assume that .Net version 2.X is installed.) <code> ",How can I install a windows service onto a machine that doesn't have Visual Studio installed?
Name for method that takes a string value and returns DBNull.Value || string," I got tired of writing the following code: So, I wrote this: If this is a good way to go about doing this then what would you suggest as the method name? DBNullValueorStringIfNotNull is a bit verbose and confusing.I'm also open to ways to alleviate this problem entirely. I'd LOVE to do this: but that won't work because the ""Operator '??' cannot be applied to operands of type 'string and 'System.DBNull'"".I've got C# 3.5 and SQL Server 2005 at my disposal if it matters. <code>  /* Commenting out irrelevant partspublic string MiddleName;public void Save(){ SqlCommand = new SqlCommand(); // blah blah...boring INSERT statement with params etc go here. */ if(MiddleName==null){ myCmd.Parameters.Add(""@MiddleName"", DBNull.Value); } else{ myCmd.Parameters.Add(""@MiddleName"", MiddleName); } /* // more boring code to save to DB.}*/ public static object DBNullValueorStringIfNotNull(string value){ object o; if (value == null) { o = DBNull.Value; } else { o = value; } return o;}// which would be called like:myCmd.Parameters.Add(""@MiddleName"", DBNullValueorStringIfNotNull(MiddleName)); myCmd.Parameters.Add(""@MiddleName"", MiddleName==null ? DBNull.Value : MiddleName);",How do I Parameterize a null string with DBNull.Value clearly and quickly.
Why should we call SuppressFinalize when we dont have a destructor ," I have few Question for which I am not able to get a proper answer .1) Why should we call SuppressFinalize in the Dispose function when we don't have a destructor .2) Dispose and finalize are used for freeing resources before the object is garbage collected. Whether it is managed or unmanaged resource we need to free it , then why we need a condition inside the dispose function , saying pass 'true' when we call this overridden function from IDisposable:Dispose and pass false when called from a finalize.See the below code I copied from net. what if I remove the boolean protected Dispose function and implement the as below. <code>  class Test : IDisposable { private bool isDisposed = false; ~Test() { Dispose(false); } protected void Dispose(bool disposing) { if (disposing) { // Code to dispose the managed resources of the class } // Code to dispose the un-managed resources of the class isDisposed = true; } public void Dispose() { Dispose(true); GC.SuppressFinalize(this); } } class Test : IDisposable { private bool isDisposed = false; ~Test() { Dispose(); } public void Dispose() { // Code to dispose the managed resources of the class // Code to dispose the un-managed resources of the class isDisposed = true; // Call this since we have a destructor . what if , if we don't have one GC.SuppressFinalize(this); } } ",Why should we call SuppressFinalize when we don't have a destructor
how to start a thread in a different security context?, How to start a thread in the security context of a different user? When a process starts a thread normally the security context is also passed but how to launch a thread in a different security context with the principal of a different user? <code> ,How do I start a thread in a different security context?
C#: AutoFixture refactoring," I started to use AutoFixture http://autofixture.codeplex.com/ as my unit tests was bloated with a lot of data setup. I was spending more time on seting up the data than to write my unit test. Here's an example of how my initial unit test looks like (example taken from cargo application sample from DDD blue book) Here's how I tried to refactor it with AutoFixture I would like to know if there's better way to refactor it. Would like to do it shorter and easier than that. <code>  [Test]public void should_create_instance_with_correct_ctor_parameters(){ var carrierMovements = new List<CarrierMovement>(); var deparureUnLocode1 = new UnLocode(""AB44D""); var departureLocation1 = new Location(deparureUnLocode1, ""HAMBOURG""); var arrivalUnLocode1 = new UnLocode(""XX44D""); var arrivalLocation1 = new Location(arrivalUnLocode1, ""TUNIS""); var departureDate1 = new DateTime(2010, 3, 15); var arrivalDate1 = new DateTime(2010, 5, 12); var carrierMovement1 = new CarrierMovement(departureLocation1, arrivalLocation1, departureDate1, arrivalDate1); var deparureUnLocode2 = new UnLocode(""CXRET""); var departureLocation2 = new Location(deparureUnLocode2, ""GDANSK""); var arrivalUnLocode2 = new UnLocode(""ZEZD4""); var arrivalLocation2 = new Location(arrivalUnLocode2, ""LE HAVRE""); var departureDate2 = new DateTime(2010, 3, 18); var arrivalDate2 = new DateTime(2010, 3, 31); var carrierMovement2 = new CarrierMovement(departureLocation2, arrivalLocation2, departureDate2, arrivalDate2); carrierMovements.Add(carrierMovement1); carrierMovements.Add(carrierMovement2); new Schedule(carrierMovements).ShouldNotBeNull();} [Test]public void should_create_instance_with_correct_ctor_parameters_AutoFixture(){ var fixture = new Fixture(); fixture.Register(() => new UnLocode(UnLocodeString())); var departureLoc = fixture.CreateAnonymous<Location>(); var arrivalLoc = fixture.CreateAnonymous<Location>(); var departureDateTime = fixture.CreateAnonymous<DateTime>(); var arrivalDateTime = fixture.CreateAnonymous<DateTime>(); fixture.Register<Location, Location, DateTime, DateTime, CarrierMovement>( (departure, arrival, departureTime, arrivalTime) => new CarrierMovement(departureLoc, arrivalLoc, departureDateTime, arrivalDateTime)); var carrierMovements = fixture.CreateMany<CarrierMovement>(50).ToList(); fixture.Register<List<CarrierMovement>, Schedule>((carrierM) => new Schedule(carrierMovements)); var schedule = fixture.CreateAnonymous<Schedule>(); schedule.ShouldNotBeNull();}private static string UnLocodeString(){ var stringBuilder = new StringBuilder(); for (int i = 0; i < 5; i++) stringBuilder.Append(GetRandomUpperCaseCharacter(i)); return stringBuilder.ToString();}private static char GetRandomUpperCaseCharacter(int seed){ return ((char)((short)'A' + new Random(seed).Next(26)));}",AutoFixture refactoring
Rewriting a statement using LAMBDA(C#)," Is it possible to write the folowing using lambda(C#) <code>  private static void GetRecordList(List<CustomerInfo> lstCustinfo){ for (int i = 1; i <= 5; i++) { if (i % 2 == 0) lstCustinfo.Add(new CustomerInfo { CountryCode = ""USA"", CustomerAddress = ""US Address"" + i.ToString(), CustomerName = ""US Customer Name"" + i.ToString(), ForeignAmount = i * 50 }); else lstCustinfo.Add(new CustomerInfo { CountryCode = ""UK"", CustomerAddress = ""UK Address"" + i.ToString(), CustomerName = ""UK Customer Name"" + i.ToString(), ForeignAmount = i * 80 }); }}",Rewriting a statement using LINQ(C#)
Is this a well known design pattern? what is it's name," I have seen this often in code, but when I speak of it I don't know the name for such 'pattern'I have a method with 2 arguments that calls an overloaded method that has 3 arguments and intentionally sets the 3rd one to empty string. The reason I'm doing this is to not duplicate code, and to allow existing callers to still call the method that has only 2 parameters.Is this a pattern, and does it have a name? <code>  public void DoWork(string name, string phoneNumber){ DoWork(name, phoneNumber, string.Empty)}private void DoWork(string name, string phoneNumber, string emailAddress){ //do the work}",Is this a well known design pattern? What is its name?
Is a switch statment ok for 30 or so conditions? (c#)," I am in the final stages of creating an MP4 tag parser in .Net. For those who have experience with tagging music you would be aware that there are an average of 30 or so tags. If tested out different types of loops and it seems that a switch statement with Const values seems to be the way to go with regard to catching the tags in binary.The switch allows me to search the binary without the need to know which order the tags are stored or if there are some not present but I wonder if anyone would be against using a switch statement for so many conditionals.Any insight is much appreciated.EDIT: One think I should add now that where discussing this is that the function is recursive, should I pull out this conditional and pass the data of to a method I can kill? <code> ",Is a switch statement ok for 30 or so conditions?
Is a switch statment ok for 30 or so conditions?," I am in the final stages of creating an MP4 tag parser in .Net. For those who have experience with tagging music you would be aware that there are an average of 30 or so tags. If tested out different types of loops and it seems that a switch statement with Const values seems to be the way to go with regard to catching the tags in binary.The switch allows me to search the binary without the need to know which order the tags are stored or if there are some not present but I wonder if anyone would be against using a switch statement for so many conditionals.Any insight is much appreciated.EDIT: One think I should add now that where discussing this is that the function is recursive, should I pull out this conditional and pass the data of to a method I can kill? <code> ",Is a switch statement ok for 30 or so conditions?
attatch '@'  in front of String. ," Consider the following line: In this line, why does @ need to be attached? <code>  readonly private string TARGET_BTN_IMG_URL = @""\\ad1-sunglim\Test\"";",What does `@` mean at the start of a string in C#?
attach '@'  in front of String," Consider the following line: In this line, why does @ need to be attached? <code>  readonly private string TARGET_BTN_IMG_URL = @""\\ad1-sunglim\Test\"";",What does `@` mean at the start of a string in C#?
"C# disable Alt+F4 but allow the the form to be closed by code, CloseReason.UserClosing is not helping."," I want that the form will not close by doing Alt + F4 but if Application.Exit() or this.Close is called from the same Form, it should be closed.I tried CloseReason.UserClosing but still no help. <code> ","Disable Alt+F4 but allow the form to be closed by code, CloseReason.UserClosing is not helping"
"Disable Alt+F4 but allow the the form to be closed by code, CloseReason.UserClosing is not helping"," I want that the form will not close by doing Alt + F4 but if Application.Exit() or this.Close is called from the same Form, it should be closed.I tried CloseReason.UserClosing but still no help. <code> ","Disable Alt+F4 but allow the form to be closed by code, CloseReason.UserClosing is not helping"
List box control, How can I display two columns in a list box? <code> ,Multiple columns in List box control
What does Protected Internal means in .Net," Protected Means, we can access this member only in a deriving class, and internal means we can access this member in any type in the same assembly using a object.So can I consider a Protected Internal member as a public member in the same assembly. and as a protected member in the different assembly.EDIT: }See I am able to access, protected internal in a non deriving class...so its working as public in same assembly..what do you say. <code>  namespace pracConsole {class Class1{ protected internal int val; public int hello() { Console.WriteLine(""This is method pracConsole.hello""); Console.ReadLine(); return 1; }}class program{ static void Main(string[] args) { Class1 _class1 = new Class1(); _class1.val = 3; _class1.hello(); Console.ReadLine(); }}",What does Protected Internal mean in .Net
Funtion Overloading," Let us suppose i have these three methods defined: and i am calling method F1 here: Which method it will call and why? <code>  int F1(int, int);int F1(float, float);Float F1(int, int); Console.writeline(F1(5,6).ToString()));",Function Overloading
Where can I find clamp in the C# class library?," I would like to clamp a value x to a range [a, b]: This is quite basic. But I do not see a function ""clamp"" in the class library - at least not in System.Math.(For the unaware to ""clamp"" a value is to make sure that it lies between some maximum and minimum values. If its greater than the max value, then its replaced by the max, etc.) <code>  x = (x < a) ? a : ((x > b) ? b : x);","Where can I find the ""clamp"" function in .NET?"
Sql Server CE - Temporary disable auto increment on a specific collum," I have this little question that's been on my mind for a while now.Here it goes:Is it possible to temporary disable the Auto_Increment on the column ID.So that I can add a new row to the table and being able specify the ID value when inserting the row.And then in the end enable the Auto_Increment again, and let do its work as usual?And if its possible how can I do it?The table structure is very simpleColumn name (attributes) Note:The table name is: People.Let's also consider that the table already has data and cannot be changed.The database server is SQL Server CE.The SQL commands will be executed in a C# program, if it's of any help.I really hope its possible, it would come very handy.ThanksEDIT The connection string is working, I have tried it.He reports: There was an error parsing the query. [ Token line number = 1,Token line offset = 20,Token in error = SET ]SOLUTION thanks to OrbMan <code>  ID (Primary Key, Auto Increment, int, not null)Name (nvarchar(100), not null) SqlActions SqlActions = new SqlActions();SqlCeCommand SqlCmd = new SqlCeCommand(""SET IDENTITY_INSERT People ON"", SqlActions.Connection());try{ SqlCmd.ExecuteNonQuery();}catch (SqlCeException Error){ Console.WriteLine(Error.ToString());}string query = ""INSERT INTO People SET (ID, Nome) VALUES (@ID, @Nome)"";SqlCeCommand SqlInsert = new SqlCeCommand(query, SqlActions.Connection());SqlInsert.Parameters.AddWithValue(""@ID"", 15);SqlInsert.Parameters.AddWithValue(""@Nome"", ""Maria"");try{ SqlInsert.ExecuteNonQuery();}catch (SqlCeException Error){ Console.WriteLine(Error.ToString());} SqlActions SqlActions = new SqlActions(); SqlCeCommand SqlCmd = new SqlCeCommand(""SET IDENTITY_INSERT People ON"", SqlActions.Connection()); try { SqlCmd.ExecuteNonQuery(); string query = ""INSERT INTO People (ID, Nome) VALUES (@ID, @Nome)""; SqlCmd.CommandText = query; SqlCmd.Parameters.AddWithValue(""@ID"", 15); SqlCmd.Parameters.AddWithValue(""@Nome"", ""Vania""); SqlCmd.ExecuteNonQuery(); } catch (SqlCeException Error) { Console.WriteLine(Error.ToString()); }",Sql Server CE - Temporary disable auto increment on a specific column
When should I use Yield in c#? ," I have a vague understanding of the yield keyword in c#, but I haven't yet seen the need to use it in my code. This probably comes from a lack of understanding of it. So, what are some typical good usages of yield?  <code> ",Using yield in C#
"Programming terms - field, member, properties"," I was trying to find meaning of this terms but especially due to language barrier I was not able to understand what they are used for.I assume that ""field"" is variable (object too?) in the class while ""property"" is just an object that returns specific value and cannot contain methods etc. By ""member"" I understand any object that is declared on the class level. But these are just my assumptions based on commented code samples where some careful programmers used ""property region"" etc.I would really appreciate if someone could explain it to me. <code> ","Programming terms - field, member, properties (C#)"
neo4j - is there a C# version/binding? ," Is there a .NET version/binding for Neo4j?It looks like exactly what I want, but I'm working in C# on .NET. Thanks <code> ",Is there any .NET binding for Neo4J?
My C# program has been 'published'... how can I change the installation path?," I ""published"" my C# solution in Visual Studio 2008 to C:\Deploy. When I run the setup.exe program, it installs my program to C:\Documents and Settings\Kevin\Start Menu\Programs\MyProgramIs there any way, within Visual Studio, to set a custom install path? For instance, what if I wanted my program to install to C:\Program Files\MyProgram? <code> ","My program has been ""published"", how can I change the installation path?"
C# Process.Start() on an executable on a remote system - security warning?," I've created a Windows Service that accepts commands from remote machines via WCF. One of those commands is to run a specified executable (let's ignore the security implications of such functionality).In my Service I am using Process.Start() to run the executable. All works well if the executable is local to the machine, but if it is on a remote file share it is failing with no error (or more accurately just hanging). I suspect the problem is that it is triggering the standard Windows 'Unverified Publisher' warning that one would see if they double click an exe on a remote system.Is there any way I can bypass this from my service so that I can truly run any executable? As I said I understand the security implications of allowing it to run any executable, but this is really what I need. I would have thought this warning was only a user mode concept, but it really does seem to be getting in the way of my Service.Ideas? <code> ",.NET Process.Start() on an executable on a remote system - security warning?
Moq.Mock<T> - how to setup a method that takes an expression," I am Mocking my repository interface and am not sure how to set up a method that takes an expression and returns an object? I am using Moq and NUnit.Interface: Test with IQueryable is already set up, but don't know how to set up the T Single: <code>  public interface IReadOnlyRepository : IDisposable{ IQueryable<T> All<T>() where T : class; T Single<T>(Expression<Func<T, bool>> expression) where T : class;} private Moq.Mock<IReadOnlyRepository> _mockRepos;private AdminController _controller;[SetUp]public void SetUp(){ var allPages = new List<Page>(); for (var i = 0; i < 10; i++) { allPages.Add(new Page { Id = i, Title = ""Page Title "" + i, Slug = ""Page-Title-"" + i, Content = ""Page "" + i + "" on page content."" }); } _mockRepos = new Moq.Mock<IReadOnlyRepository>(); _mockRepos.Setup(x => x.All<Page>()).Returns(allPages.AsQueryable()); //Not sure what to do here??? _mockRepos.Setup(x => x.Single<Page>() //---- _controller = new AdminController(_mockRepos.Object);}",Moq.Mock<T> - how to set up a method that takes an expression
How to pull a method out of it's class (and into a new or exsisting)?, What is the easiest way of pulling an existing method out of its class and into a new class using Visual studio 2010 / Resharper?Edit: I use Resharper version 5. <code> ,How to pull a method out of its class (and into a new or existing)?
Question about Multicaste Delegates?," I am going through some exam questions for the 70-536 exam and an actual question one developer posted on his blog has popped up in my exam questions. I cannot remember what his answer was .... but below is the question:You need to write a multicast delegate that accepts a DateTime argument and returns a boolvalue. Which code segment should you use?A: public delegate int PowerDeviceOn(bool, DateTime)B: public delegate bool PowerDeviceOn(Object, EventArgs)C: public delegate void PowerDeviceOn(DateTime)D: public delegate bool PowerDeviceOn(DateTime)The answer is A.Can someone please explain why? As I already did some research into thisquestion a while ago and so I was sure that it was C, obviously now lookingback at the question its clear that I did not read properly. As i was sureI had seen the same one before so I jumped to the most obvious one.A variation on this question:You need to write a multicast delegate that accepts a DateTime argument.Which code segment should you use?A: public delegate int PowerDeviceOn(bool, DateTime)B: public delegate bool PowerDeviceOn(Object, EventArgs)C: public delegate void PowerDeviceOn(DateTime)D: public delegate bool PowerDeviceOn(DateTime)Now this is another variation on this question, it still has the same bogus sample answers, as they still kind work in throwing the exam taker off. Notice how by simply keeping the sample answers the same and by removing a small portion of the question text, the answer is C and not A. The variation has no official answer as I just conjured it up using the exam question as a baseplate. The answer is definitely C. This time round its easy to see why C is correct but the very first question I have an inkling but as you know an inkling is not good enough in passing exams. <code> ",Multicast Delegates in 70-536 exam?
Question about Multicast Delegates?," I am going through some exam questions for the 70-536 exam and an actual question one developer posted on his blog has popped up in my exam questions. I cannot remember what his answer was .... but below is the question:You need to write a multicast delegate that accepts a DateTime argument and returns a boolvalue. Which code segment should you use?A: public delegate int PowerDeviceOn(bool, DateTime)B: public delegate bool PowerDeviceOn(Object, EventArgs)C: public delegate void PowerDeviceOn(DateTime)D: public delegate bool PowerDeviceOn(DateTime)The answer is A.Can someone please explain why? As I already did some research into thisquestion a while ago and so I was sure that it was C, obviously now lookingback at the question its clear that I did not read properly. As i was sureI had seen the same one before so I jumped to the most obvious one.A variation on this question:You need to write a multicast delegate that accepts a DateTime argument.Which code segment should you use?A: public delegate int PowerDeviceOn(bool, DateTime)B: public delegate bool PowerDeviceOn(Object, EventArgs)C: public delegate void PowerDeviceOn(DateTime)D: public delegate bool PowerDeviceOn(DateTime)Now this is another variation on this question, it still has the same bogus sample answers, as they still kind work in throwing the exam taker off. Notice how by simply keeping the sample answers the same and by removing a small portion of the question text, the answer is C and not A. The variation has no official answer as I just conjured it up using the exam question as a baseplate. The answer is definitely C. This time round its easy to see why C is correct but the very first question I have an inkling but as you know an inkling is not good enough in passing exams. <code> ",Multicast Delegates in 70-536 exam?
Get The Currency From Current Culture?," Is there a way to get current information dynamically from the apps culture settings? Basically if the user has set the culture to US I want to know the currency is dollars, or if they have it set to UK I want to pound sterling etc... etc..This is so I can send this information to PayPal when a payment is being made <code> ",Get the currency from current culture?
"c# Multi diemention (array, arraylist, or hashtable) ?"," I'm trying to figure out how to build a multi-dimensional ""array"" that is:flexible sizeuse 2 keys1st key is int (flexible)2nd key is string (kind of limited)The use will be like: <code>  console.writelen(array[0][""firstname""]);console.writelen(array[0][""lastname""]);console.writelen(array[0][""phone""]);console.writelen(array[1][""firstname""]);console.writelen(array[1][""lastname""]);console.writelen(array[1][""phone""]);..........console.writelen(array[x][""firstname""]);console.writelen(array[x][""lastname""]);console.writelen(array[x][""phone""]);","C# multi-dimensional array, ArrayList, or hash table?"
"ASP .NET Added Event Handlers to buttons on Page_Load. Event handlers do not fire the first click, but on the second click, after a PostBack"," Background: I am customizing an existing ASP .NET / C# application. It has it's own little ""framework"" and conventions for developers to follow when extending/customizing its functionality. I am currently extending some of it's administrative functionality, to which the framework provides a contract to enforce implementation of the GetAdministrationInterface() method, which returns System.Web.UI.Control. This method is called during the Page_Load() method of the page hosting the GUI interface.Problem: I have three buttons in my GUI, each of which have been assigned an Event Handler. My administration GUI loads up perfectly fine, but clicking any of the buttons doesn't do what I expect them to do. However, when I click them a second time, the buttons work.I placed breakpoints at the beginning of each event handler method and stepped through my code. On the first click, none of the event handlers were triggered. On the second click, they fired.Any ideas?Example of Button Definition (within GetAdministrationInterface) Example of Event Handler Method Definition Page_Load Method that calls GetAdministrationInterface <code>  public override Control GetAdministrationInterface(){ // more code... Button btn = new Button(); btn.Text = ""Click Me!""; btn.Click += new EventHandler(Btn_Click); // more code...} void Btn_Click(object sender, EventArgs e){ // Do Something} protected void Page_Load(object sender, System.EventArgs e){ if (!Page.IsAsync) { List<AdministrationInterface> interfaces = <DATABASE CALL>; foreach(AdministrationInteface ai in interfaces) { placeholderDiv.Controls.Add(ai.GetAdministrationInterface()); } }}","ASP .NET Button event handlers do not fire on the first click, but on the second click after a PostBack"
ASP.NET MVC2 Custom membership, How do I create a custom membership for ASP.NET MVC 2 based on the ASP.NET membership provider? <code> ,How do I create a custom membership provider for ASP.NET MVC 2?
ToList()-- Does it Create a New List?," Let's say I have a class And I have a List<MyObject>, and I ToList() it and then change one of the SimpleInt, will my change be propagated back to the original list. In other words, what would be the output of the following method? Why? P/S: I'm sorry if it seems obvious to find out. But I don't have compiler with me now... <code>  public class MyObject{ public int SimpleInt{get;set;}} public void RunChangeList(){ var objs = new List<MyObject>(){new MyObject(){SimpleInt=0}}; var whatInt = ChangeToList(objs );}public int ChangeToList(List<MyObject> objects){ var objectList = objects.ToList(); objectList[0].SimpleInt=5; return objects[0].SimpleInt;}",ToList()-- does it create a new list?
Finding all methods containing a method in C#," I want to search through all classes in a namespace for those containing a certain method. If a class contains a method then I want to create an instance of the class and run the method.Obviously I have to start with reflection but I'm stuck on where to go.Edit:Interfaces are not the way I want to do this.What I'm looking for is embedding testing functions into the code but a single calling interface. If there's a self-test function, call it. If there isn't, ignore it. <code> ",Finding all classes containing a method in C#
What production software have you written in F# in the past year or so that you would previously have written in C#?," Over the last few years F# has evolved into one of Microsoft's fully supported languages employing many ideas incubated in OCaml, ML and Haskell.Over the last several years C# has extended its general purpose features by introducing more and more functional language features: LINQ (list comprehension), Lambdas, Closures, Anonymous Delegates and more...Given C#'s adoption of these functional features and F#'s taxonomy as an impure functional language (it allows YOU to access framework libraries or change shared state when a function is called if you want to) there is a strong similarity between the two languages although each has its own polar opposite primary emphasis.I'm interested in any successful models employing these two languages in your production polyglot programs and also the areas within production software (web apps, client apps, server apps) you have written in F# in the past year or so that you would previously have written in C#. <code> ",In what areas might the use of F# be more appropriate than C#?
In what specific areas has F# proven more applicable than C#?," Over the last few years F# has evolved into one of Microsoft's fully supported languages employing many ideas incubated in OCaml, ML and Haskell.Over the last several years C# has extended its general purpose features by introducing more and more functional language features: LINQ (list comprehension), Lambdas, Closures, Anonymous Delegates and more...Given C#'s adoption of these functional features and F#'s taxonomy as an impure functional language (it allows YOU to access framework libraries or change shared state when a function is called if you want to) there is a strong similarity between the two languages although each has its own polar opposite primary emphasis.I'm interested in any successful models employing these two languages in your production polyglot programs and also the areas within production software (web apps, client apps, server apps) you have written in F# in the past year or so that you would previously have written in C#. <code> ",In what areas might the use of F# be more appropriate than C#?
C# Reflection: How to call method of interface without creating instance?," I have situation where I have to call method of interface using reflection, like this As you can see I do not create instance of object! And, as I can supposed, I receive exception Non-static method requires a targetAnd Question, Can I call method of interface using reflection without creating instance of interface and if YES, How I can do it ? <code>  object x = null;MethodInfo method = interfaceExists.GetMethod(""ShutDown"");method.Invoke(x, new object[] { 4 })",.NET Reflection: How to call method of interface without creating instance?
Create PDF in memory instead of physical file using C#," How do one create PDF in memorystream instead of physical file using itextsharp.The code below is creating actual pdf file.Instead how can I create a byte[] and store it in the byte[] so that I can return it through a function <code>  using iTextSharp.text;using iTextSharp.text.pdf;Document doc = new Document(iTextSharp.text.PageSize.LETTER, 10, 10, 42, 35);PdfWriter wri = PdfWriter.GetInstance(doc, new FileStream(""c:\\Test11.pdf"", FileMode.Create));doc.Open();//Open Document to writeParagraph paragraph = new Paragraph(""This is my first line using Paragraph."");Phrase pharse = new Phrase(""This is my second line using Pharse."");Chunk chunk = new Chunk("" This is my third line using Chunk."");doc.Add(paragraph);doc.Add(pharse);doc.Add(chunk);doc.Close(); //Close document",Create PDF in memory instead of physical file
how  to force my C# program to run as administrator on Windows 7," Once my program is installed on a client machine, how do I force my program to run as an administrator on Windows 7? <code> ",How do I force my .NET application to run as administrator?
How to force C# App to run as administrator on Windows 7," Once my program is installed on a client machine, how do I force my program to run as an administrator on Windows 7? <code> ",How do I force my .NET application to run as administrator?
How to force my .NET App to run as administrator on Windows 7," Once my program is installed on a client machine, how do I force my program to run as an administrator on Windows 7? <code> ",How do I force my .NET application to run as administrator?
How to force my .NET App to run as administrator on Windows 7?," Once my program is installed on a client machine, how do I force my program to run as an administrator on Windows 7? <code> ",How do I force my .NET application to run as administrator?
How to force my .NET application to run as administrator on Windows 7?," Once my program is installed on a client machine, how do I force my program to run as an administrator on Windows 7? <code> ",How do I force my .NET application to run as administrator?
How to force my .NET application to run as administrator?," Once my program is installed on a client machine, how do I force my program to run as an administrator on Windows 7? <code> ",How do I force my .NET application to run as administrator?
Changing the cursor in asp.net," I want to change the cursor to an hourglass in my asp.net application to let my users know that the process is running. I searched for an answer and was advised to use JavaScript as follows:Add this JavaScript: then in my code in the page load event: Where btnImport is the button they click on.However this does not work. If I add an alert to the hourglass function. it does work. Is there some way to get this to work without the alert? <code>  function hourglass() { document.body.style.cursor = ""wait"";} btnImport.Attributes.Add(""onclick"", ""javascript: hourglass();"");",Changing the cursor in ASP.NET while loading doesn't work without a JS alert
Windows API Codepack - TaskDialog on Window XP," I don't have an XP machine handy. If I use the Windows API Codepack to do something new to Vista/Win7 (e.g. ""TaskDialog"") in C#, how does it cope with running on Windows XP machines?If I use the Codepack, have I effectively made my application only support Vista and later versions of Windows? <code> ",Windows API Codepack Backwards Compatibility on Windows XP
Windows API Codepack Backwards Compatibility on Window XP," I don't have an XP machine handy. If I use the Windows API Codepack to do something new to Vista/Win7 (e.g. ""TaskDialog"") in C#, how does it cope with running on Windows XP machines?If I use the Codepack, have I effectively made my application only support Vista and later versions of Windows? <code> ",Windows API Codepack Backwards Compatibility on Windows XP
"L2S, what's better", or <code>  db.Albums.FirstOrDefault(x => x.OrderId == orderId) db.Albums.FirstOrDefault(x => x.OrderId.Equals(orderId)),Linq to SQL - what's better?
Detecting a Dipose() from an exception inside using block in C#," I have the following code in my application: This code triggers the Database class Dispose() method as usual, and this method automatically commits the transaction to the database, but this leaves my database in an inconsistent state as the answers are erased but the question and the poll are not.There is any way that I can detect in the Dispose() method that it being called because of an exception instead of regular end of the closing block, so I can automate the rollback?I dont want to manually add a try ... catch block, my objective is to use the using block as a logical safe transaction manager, so it commits to the database if the execution was clean or rollbacks if any exception occured.Do you have some thoughts on that?  <code>  using (var database = new Database()) { var poll = // Some database query code. foreach (Question question in poll.Questions) { foreach (Answer answer in question.Answers) { database.Remove(answer); } // This is a sample line that simulate an error. throw new Exception(""deu pau""); database.Remove(question); } database.Remove(poll);}",Detecting a Dispose() from an exception inside using block
.NET SSH Port Forwarding," I am trying to build in SSH port forwarding into a .NET application that I am writing. I have tried using sharpSSH, but it requires the user to input their password every time, and I don't want that. I am going to handle storing the password.I have downloaded Granados, but there is basically zero documentation for it. How do I accomplish port forwarding with Granados or any other free SSH library for .NET? <code> ",.NET SSH port forwarding
Getting my head around object oriented programing, I am entry level .Net developer and using it to develop web sites. I started with classic asp and last year jumped on the ship with a short C# book.As I developed I learned more and started to see that coming from classic asp I always used C# like scripting language.For example in my last project I needed to encode video on the webserver and wrote a code like While searching samples related to my project Ive seen people doing this As I understand second example is more object oriented but I dont see the point of using EncodedVideo object.Am I doing something wrong? Does it really necessary to use this sort of code in a web app? <code>  public class Encoder{ Public static bool Encode(string videopath) { ...snip... return true; }} public class Encoder{ Public static Encode(string videopath) { EncodedVideo encoded = new EncodedVideo(); ...snip... encoded.EncodedVideoPath = outputFile; encoded.Success = true; ...snip... }}public class EncodedVideo{ public string EncodedVideoPath { get; set; } public bool Success { get; set; }},Getting my head around object oriented programming
Are background threads a bad idea?  Why?," So I've been told what I'm doing here is wrong, but I'm not sure why.I have a webpage that imports a CSV file with document numbers to perform an expensive operation on. I've put the expensive operation into a background thread to prevent it from blocking the application. Here's what I have in a nutshell. (obviously with some error checking & messages for users thrown in)So my three-fold question is:a) Is this a bad idea?b) Why is this a bad idea?c) What would you do instead? <code>  protected void ButtonUpload_Click(object sender, EventArgs e){ if (FileUploadCSV.HasFile) { string fileText; using (var sr = new StreamReader(FileUploadCSV.FileContent)) { fileText = sr.ReadToEnd(); } var documentNumbers = fileText.Split(new[] {',', '\n', '\r'}, StringSplitOptions.RemoveEmptyEntries); ThreadStart threadStart = () => AnotherClass.ExpensiveOperation(documentNumbers); var thread = new Thread(threadStart) {IsBackground = true}; thread.Start(); }}",Are background threads a bad idea? Why?
C#/.NET: + string concatenation uses StringBuilder internally???," Three of my coworkers just told me that there's no reason to use a StringBuilder in place of concatenation using the + operator. In other words, this is fine to do with a bunch of strings: myString1 + myString2 + myString3 + myString4 + mySt...The rationale that they used was that since .NET 2, the C# compiler will build the same IL if you use the + operator as if you used a StringBuilder.This is news to me. Are they correct? <code> ",Does string concatenation use StringBuilder internally?
VB.Net equivalent for C# 'dynamic' with Option Strict On," Is there an equivalent for the C# 4 'dynamic' keyword when using type safe VB.NET, i.e. with Option Strict On? <code> ",VB.NET equivalent for C# 'dynamic' with Option Strict On
VB.NET equivalent for C# 'dynamic' with Option Strict On," Is there an equivalent for the C# 4 'dynamic' keyword when using type safe VB.NET, i.e. with Option Strict On? <code> ",VB.NET equivalent for C# 'dynamic' with Option Strict On
C#: Return start and end of year given any month., I need two or one (out) C# method that will take any datetime and return the start date of year and end date of year for that year. <code> ,Return start and end of year given any year
C#: Return start and end of year given any year, I need two or one (out) C# method that will take any datetime and return the start date of year and end date of year for that year. <code> ,Return start and end of year given any year
convert Grafhics to Image in  c#, How to convert Image to Graphic? <code> ,Convert Image to Graphic in c#
convert Graphics to Image in  c#, How to convert Image to Graphic? <code> ,Convert Image to Graphic in c#
Parsing plain Win32 PE File (Exe/DLL) in C#.NET," I need to parse plain Win32 DLL/Exe and get all imports and exports from it to show on console or GUI (i.e. Win Forms). Is it possible to parse Win32 DLL/Exe in C#.NET by reading its export/import tables and get managed types from it? As it's unmanaged PE, .NET doesn't allows you to convert unmanaged PE files to managed .NET assemblies, it only generates COM managed assemblies.How can I parse these tables and take all of its methods (signatures) in managed form. (e.g. if char* as argument, it should display as IntPtr). <code> ",Parsing plain Win32 PE File (Exe/DLL) in .NET
Why can't I insert record with foregion key in a single server request?," I'm tryring to do a simple insert with foreign key, but it seems that I need to use db.SaveChanges() for every record insert. How can I manage to use only one db.SaveChanges() at the end of this program? After running the above code I get this exception:System.Data.UpdateException: An error occurred while updating the entries. See the InnerException for details. The specified value is not an instance of a valid constant typeParameter name: value.EDIT: Changed example code and added returned exception. <code>  public static void Test(){ using (var entities = new DBEntities()) { var sale = new SalesFeed { SaleName = ""Stuff..."", }; entities.AddToSalesFeedSet(sale); var phone = new CustomerPhone { CreationDate = DateTime.UtcNow, sales_feeds = sale }; entities.AddToCustomerPhoneSet(phone); entities.SaveChanges(); }}",Why can't I insert record with foreign key in a single server request?
C++ - Is TDD useful?," Hi! I recently tried developing a small-sized project in C# and during the whole project our team used the Test-Driven-Development (TDD) technique (xunit, moq). I really think this was awesome, because (when paired with C#) this approach allowed to relax when coding, relax when projecting and relax when refactoring. I suspect that all this TDD-stuff actually simplifies the coding process and, well, it allowed (eventually, for me) to get the same result with fewer brain cells working.Right after that I tried using TDD paired with C++ (I used Google Test and Google Mock libraries), and, I don't know why but I actually think that TDD here was a step back in terms of rapid application development.I had some moments when I had to spend huge amounts of time thinking of my tests, building proper mocks, rebuilding them and swearing at my monitor.And, well, I obviously can't ask something like ""what I did wrong?"" or ""what was wrong in my approach?"", because I don't know what to describe. But if there are any people who are used to TDD in C++ (and, probably C#) too, could you please advise me how to do this properly.Framework recommendations, architecture approaches, plain coding advices - if you are experienced in TDD & C++, please respond. <code> ",C++ & proper TDD
What is the best way to store static data in C# that will never changes," I have a class that stores data in asp.net c# application that never changes. I really don't want to put this data in the database - I would like it to stay in the application. Here is my way to store data in the application: When the constructor is called the code above is ran. I have some functions that can query the data above too. But is this the best way to store information in asp.net? if not what would you recommend? <code>  public class PostVoteTypeFunctions{ private List<PostVoteType> postVotes = new List<PostVoteType>(); public PostVoteTypeFunctions() { PostVoteType upvote = new PostVoteType(); upvote.ID = 0; upvote.Name = ""UpVote""; upvote.PointValue = PostVotePointValue.UpVote; postVotes.Add(upvote); PostVoteType downvote = new PostVoteType(); downvote.ID = 1; downvote.Name = ""DownVote""; downvote.PointValue = PostVotePointValue.DownVote; postVotes.Add(downvote); PostVoteType selectanswer = new PostVoteType(); selectanswer.ID = 2; selectanswer.Name = ""SelectAnswer""; selectanswer.PointValue = PostVotePointValue.SelectAnswer; postVotes.Add(selectanswer); PostVoteType favorite = new PostVoteType(); favorite.ID = 3; favorite.Name = ""Favorite""; favorite.PointValue = PostVotePointValue.Favorite; postVotes.Add(favorite); PostVoteType offensive = new PostVoteType(); offensive.ID = 4; offensive.Name = ""Offensive""; offensive.PointValue = PostVotePointValue.Offensive; postVotes.Add(offensive); PostVoteType spam = new PostVoteType(); spam.ID = 0; spam.Name = ""Spam""; spam.PointValue = PostVotePointValue.Spam; postVotes.Add(spam); }}",What is the best way to store static data in C# that will never change
C# WPF Slider Issue with IsMoveToPointEnabled," I have IsMoveToPointEnabled on for my Slider, so when I click anywhere on the component the selector moves to my mouse. The problem is if I have this option on and click and hold the mouse down to drag the selector the selector doesn't move. Anyone know how to fix this? <code> ",Slider does not drag in combination with IsMoveToPointEnabled behaviour
Is there a more easy way to create a WCF/OData Data Service Query Provider?," I have a simple little data model resembling the following:InventoryContext{IEnumerable<Computer> GetComputers()IEnumerable<Printer> GetPrinters()}Computer{public string ComputerName { get; set; }public string Location { get; set; }}Printer{public string PrinterName { get; set; }public string Location { get; set; }}The results come from a non-SQL source, so this data does not come from Entity Framework connected up to a database.Now I want to expose the data through a WCF OData service. The only way I've found to do that thus far is creating my own Data Service Query Provider, per this blog tutorial:http://blogs.msdn.com/alexj/archive/2010/01/04/creating-a-data-service-provider-part-1-intro.aspx... which is great, but seems like a pretty involved undertaking. The code for the provider would be 4 times longer than my whole data model to generate all of the resource sets and property definitions.Is there something like a generic provider in between Entity Framework and writing your own data source from zero? Maybe some way to build an object data source or something, so that the magical WCF unicorns can pick up my data and ride off into the sunset without having to explicitly code the provider? <code> ",Is there an easier way to create a WCF/OData Data Service Query Provider?
Static constructors cause a performance over head ?, Recently read in a article on dotnetpearls.com here saying that static ctors take a substantial amount of perfomance hit. Could not fathom why?  <code> ,Static constructors cause a performance overhead?
C# PredicateBuilder Entities: The parameter 'f' was not bound in the specified LINQ to Entities query expression., I needed to build a dynamic filter and I wanted to keep using entities. Because of this reason I wanted to use the PredicateBuilder from albahari.I created the following code: When I ran the code there was only 1 filter which wasn't a date filter. So only the inner predicate was filled. When the predicate was executed I got the following error.The parameter 'f' was not bound in thespecified LINQ to Entities queryexpression.While searching for an answer I found the following page. But this is already implemented in the LINQKit.Does anyone else experienced this error and know how to solve it? <code>  var invoerDatums = PredicateBuilder.True<OnderzoeksVragen>();var inner = PredicateBuilder.False<OnderzoeksVragen>();foreach (var filter in set.RapportInvoerFilter.ToList()){ if(filter.IsDate) { var date = DateTime.Parse(filter.Waarde); invoerDatums = invoerDatums.Or(o => o.Van >= date && o.Tot <= date); } else { string temp = filter.Waarde; inner = inner.Or(o => o.OnderzoekType == temp); }}invoerDatums = invoerDatums.And(inner);var onderzoeksVragen = entities.OnderzoeksVragen .AsExpandable() .Where(invoerDatums) .ToList();,C# PredicateBuilder Entities: The parameter 'f' was not bound in the specified LINQ to Entities query expression
XML file creation Using XDocument in C#," I have a List<string> ""sampleList"" which contains The file structure is like I'm currently using XmlDocument to do this. Example: How can I create the same XML structure using XDocument? <code>  Data1Data2Data3... <file> <name filename=""sample""/> <date modified ="" ""/> <info> <data value=""Data1""/> <data value=""Data2""/> <data value=""Data3""/> </info></file> List<string> lst;XmlDocument XD = new XmlDocument();XmlElement root = XD.CreateElement(""file"");XmlElement nm = XD.CreateElement(""name"");nm.SetAttribute(""filename"", ""Sample"");root.AppendChild(nm);XmlElement date = XD.CreateElement(""date"");date.SetAttribute(""modified"", DateTime.Now.ToString());root.AppendChild(date);XmlElement info = XD.CreateElement(""info"");for (int i = 0; i < lst.Count; i++) { XmlElement da = XD.CreateElement(""data""); da.SetAttribute(""value"",lst[i]); info.AppendChild(da);}root.AppendChild(info);XD.AppendChild(root);XD.Save(""Sample.xml"");",XML file creation using XDocument in C#
Entity Framework 4 How to find the primary key?," I am trying to create a generic method using EF4 to find the primary key of an object. example To give more info I am working off of the Tekpub StarterKit and below is the class I am trying to get up and running <code>  public string GetPrimaryKey<T>(){ ...} using System;using System.Collections.Generic;using System.Linq;using System.Web;using System.Data.Objects;using System.Data.Objects.ELinq;using System.Data.Linq;using Web.Infrastructure.Storage.EF4;namespace Web.Infrastructure.Storage {public class EFSession:ISession { PuzzleEntities _db;//This is an ObjectContext public EFSession() { _db = new PuzzleEntities(); } public void CommitChanges() { _db.SaveChanges(); } /// <summary> /// Gets the table provided by the type T and returns for querying /// </summary> private ObjectSet<T> GetObjectSet<T>() where T:class { return _db.CreateObjectSet<T>(); } private T GetByPrimaryKey<T>() where T: class { ..... } public void Delete<T>(System.Linq.Expressions.Expression<Func<T, bool>> expression) where T: class{ foreach (T item in All<T>().Where(expression)) { GetObjectSet<T>().DeleteObject(item); } } public void Delete<T>(T item) where T : class { GetObjectSet<T>().DeleteObject(item); } public void DeleteAll<T>() where T : class { foreach(T item in All<T>()) { GetObjectSet<T>().DeleteObject(item); } } public void Dispose() { _db.Dispose(); } public T Single<T>(System.Linq.Expressions.Expression<Func<T, bool>> expression) where T:class { return GetObjectSet<T>().SingleOrDefault(expression); } public IQueryable<T> All<T>() where T : class { return GetObjectSet<T>().AsQueryable(); } public void Add<T>(T item) where T : class { GetObjectSet<T>().AddObject(item); } public void Add<T>(IEnumerable<T> items) where T : class { foreach (T item in items) { GetObjectSet<T>().AddObject(item); } } public void Update<T>(T item) where T : class { //nothing needed here }}}",Entity Framework 4: How to find the primary key?
.NET - Is it possible to change the value of a variable during execution time?," I want to know if there is any way I can change the value of a variable during execution time, using Visual Studio 2008? I know I can do this on Eclipse (put a breakpoint, add a watcher and edit whatever variable value I want) but I didn't find this feature on VS yet?Any idea?Thanks. <code> ",Is it possible to change the value of a variable during execution time?
Reading membership section from web.config in C#," I have created a custom MembershipProvider class, so far so good, however, I am not sure how to read the configuration settings from the web.config file.I tried to search from Google and Stackoverflow, seems like someone also experiencing my problem and asked, but no answer has been given.It should be a simple thing, but I am very new in web development, so reading settings from web.config seems away too technical to me.Here is my settings: I would like to read the minRequiredPasswordLength setting, please assist. <code>  <membership defaultProvider=""CustomMembershipProvider""> <providers> <clear/> <add name=""CustomMembershipProvider"" type=""Test.Models.CustomMembershipProvider,Test"" passwordFormat=""Hashed"" connectionStringName=""ApplicationServices"" minRequiredPasswordLength=""8"" minRequiredNonalphanumericCharacters=""0"" maxInvalidPasswordAttempts=""5"" enablePasswordReset=""false"" enablePasswordRetrieval=""false"" requiresQuestionAndAnswer=""false"" applicationName=""/""/> </providers></membership>",Reading membership section from web.config
How to use imagemagick.net in .net ? Please for examples," I'm looking almost hour for examples of using imagemagick.net in c# and I can't find antything.All what I need is resize image (.jpg) to new size image (jpg, too) and would be great if you known how to add watermark.I downloaded imagemagick.net from http://imagemagick.codeplex.com/ <code> ",How to use imagemagick.net in .net ?
difference between throw and throw new Exception(), What is the difference between and regardless that the second shows a message. <code>  try { ... }catch{ throw } try{ ... }catch(Exception e) {throw new Exception(e.message) },Difference between 'throw' and 'throw new Exception()'
How to catch key press on a form c# .net," I have a parent form that contains a lot of controls. What I am trying to do is filter all of the key presses for that form. The trouble is that if the focus is on one of the controls on the form then the parent form is not getting the key press event, so how do I capture the key down event? <code> ",How to catch a key press on a C# .NET form
How to show controls hierarchy in Winform designer," One of our clients has an old WinForms application that contains forms with a lot of controls on them. Some of those controls have a deep hierarchy and that makes it to hard to select them in the designer.I need to understand this hierarchy to make modifications to the application to correct some bugs. Is there a way to see this hierarchy clearly? For example, is there something available that is similar to what can be seen in an .aspx source file when you have a breadcrumb of where you are in the HTML hierarchy (HTML > Body > div > etc.)? Or something more visual maybe? <code> ",Show control hierarchy in the WinForms designer
How to show controls hierarchy in the WinForm designer," One of our clients has an old WinForms application that contains forms with a lot of controls on them. Some of those controls have a deep hierarchy and that makes it to hard to select them in the designer.I need to understand this hierarchy to make modifications to the application to correct some bugs. Is there a way to see this hierarchy clearly? For example, is there something available that is similar to what can be seen in an .aspx source file when you have a breadcrumb of where you are in the HTML hierarchy (HTML > Body > div > etc.)? Or something more visual maybe? <code> ",Show control hierarchy in the WinForms designer
c#-excel interop - create chart on own sheet," Using c# MS Excel interop library, I would like to programmatically create a new chart on the workbook, as opposed to on an a sheet.The code below allows me to create a chart on an existing _Worksheet (sheet). Does anyone know how to rather go about creating a chart on the workbook (i.e. where the chart is the sheet). <code>  using using Microsoft.Office.Interop.Excel; _Worksheet sheet; (assume this is a reference to a valid _Worksheet object) ChartObjects charts = (ChartObjects)sheet.ChartObjects(Type.Missing); ChartObject chartObject = (ChartObject)charts.Add(10, 80, 300, 250); Chart chart = chartObject.Chart; chart.ChartType = XlChartType.xlXYScatter;",c#-excel interop - create chart on workbook as opposed to in a sheet
"Compiling code at runtime, loading into current appdomain."," Im compiling some code at runtime then loading the assembly into the current appdomain, however when i then try to do Type.GetType it cant find the type...Here is how i compile the code... This bit fails after getting the type from the compiled assembly just fine, it does not seem to be able to find it using Type.GetType.... <code>  public static Assembly CompileCode(string code) { Microsoft.CSharp.CSharpCodeProvider provider = new CSharpCodeProvider(); ICodeCompiler compiler = provider.CreateCompiler(); CompilerParameters compilerparams = new CompilerParameters(); compilerparams.GenerateExecutable = false; compilerparams.GenerateInMemory = false; foreach (Assembly assembly in AppDomain.CurrentDomain.GetAssemblies()) { try { string location = assembly.Location; if (!String.IsNullOrEmpty(location)) { compilerparams.ReferencedAssemblies.Add(location); } } catch (NotSupportedException) { // this happens for dynamic assemblies, so just ignore it. } } CompilerResults results = compiler.CompileAssemblyFromSource(compilerparams, code); if (results.Errors.HasErrors) { StringBuilder errors = new StringBuilder(""Compiler Errors :\r\n""); foreach (CompilerError error in results.Errors) { errors.AppendFormat(""Line {0},{1}\t: {2}\n"", error.Line, error.Column, error.ErrorText); } throw new Exception(errors.ToString()); } else { AppDomain.CurrentDomain.Load(results.CompiledAssembly.GetName()); return results.CompiledAssembly; } } Assembly assem = RuntimeCodeCompiler.CompileCode(code);string typeName = String.Format(""Peverel.AppFramework.Web.GenCode.ObjectDataSourceProxy_{0}"", safeTypeName);Type t = assem.GetType(typeName); //This works just fine..Type doesntWork = Type.GetType(t.AssemblyQualifiedName);Type doesntWork2 = Type.GetType(t.Name);....","Compiling code at runtime, loading into current appdomain but Type.GetType cant see it."
Changing the Default Path Installation  in Windows Application, I want to Change default installation path which is Program Files in windows application When Creating setup. I tried but i couldn't do that please tell me solution. <code> ,Changing the Default Installation  Path in Windows Application
Extension methods for encapsulation and reusability," edit4: wikified, since this seems to have morphed more into a discussion than a specific question.In C++ programming, it's generally considered good practice to ""prefer non-member non-friend functions"" instead of instance methods. This has been recommended by Scott Meyers in this classic Dr. Dobbs article, and repeated by Herb Sutter and Andrei Alexandrescu in C++ Coding Standards (item 44); the general argument being that if a function can do its job solely by relying on the public interface exposed by the class, it actually increases encapsulation to have it be external. While this confuses the ""packaging"" of the class to some extent, the benefits are generally considered worth it.Now, ever since I've started programming in C#, I've had a feeling that here is the ultimate expression of the concept that they're trying to achieve with ""non-member, non-friend functions that are part of a class interface"". C# adds two crucial components to the mix - the first being interfaces, and the second extension methods:Interfaces allow a class to formally specify their public contract, the methods and properties that they're exposing to the world.Any other class can choose to implement the same interface and fulfill that same contract.Extension methods can be defined on an interface, providing any functionality that can be implemented via the interface to all implementers automatically.And best of all, because of the ""instance syntax"" sugar and IDE support, they can be called the same way as any other instance method, eliminating the cognitive overhead!So you get the encapsulation benefits of ""non-member, non-friend"" functions with the convenience of members. Seems like the best of both worlds to me; the .NET library itself providing a shining example in LINQ. However, everywhere I look I see people warning against extension method overuse; even the MSDN page itself states:In general, we recommend that you implement extension methods sparingly and only when you have to.(edit: Even in the current .NET library, I can see places where it would've been useful to have extensions instead of instance methods - for example, all of the utility functions of List<T> (Sort, BinarySearch, FindIndex, etc.) would be incredibly useful if they were lifted up to IList<T> - getting free bonus functionality like that adds a lot more benefit to implementing the interface.)So what's the verdict? Are extension methods the acme of encapsulation and code reuse, or am I just deluding myself?(edit2: In response to Tomas - while C# did start out with Java's (overly, imo) OO mentality, it seems to be embracing more multi-paradigm programming with every new release; the main thrust of this question is whether using extension methods to drive a style change (towards more generic / functional C#) is useful or worthwhile..)edit3: overridable extension methodsThe only real problem identified so far with this approach, is that you can't specialize extension methods if you need to. I've been thinking about the issue, and I think I've come up with a solution.Suppose I have an interface MyInterface, which I want to extend -I define my extension methods in a MyExtension static class, and pair it with another interface, call it MyExtensionOverrider. MyExtension methods are defined according to this pattern: The override interface mirrors all of the methods defined in MyExtension, except without the this or attemptCast parameters: Now, any class can implement the interface and get the default extension functionality: Anyone that wants to override it with specific implementations can additionally implement the override interface: And there we go: extension methods provided on an interface, with the option of complete extensibility if needed. Fully general too, the interface itself doesn't need to know about the extension / override, and multiple extension / override pairs can be implemented without interfering with each other.I can see three problems with this approach -It's a little bit fragile - the extension methods and override interface have to be kept synchronized manually.It's a little bit ugly - implementing the override interface involves boilerplate for every function you don't want to specialize.It's a little bit slow - there's an extra bool comparison and cast attempt added to the mainline of every method.Still, all those notwithstanding, I think this is the best we can get until there's language support for interface functions. Thoughts? <code>  public static int MyMethod(this MyInterface obj, int arg, bool attemptCast=true){ if (attemptCast && obj is MyExtensionOverrider) { return ((MyExtensionOverrider)obj).MyMethod(arg); } // regular implementation here} public interface MyExtensionOverrider{ int MyMethod(int arg); string MyOtherMethod();} public class MyClass : MyInterface { ... } public class MySpecializedClass : MyInterface, MyExtensionOverrider{ public int MyMethod(int arg) { //specialized implementation for one method } public string MyOtherMethod() { // fallback to default for others MyExtension.MyOtherMethod(this, attemptCast: false); }}",Prefer extension methods for encapsulation and reusability?
C# / WPF / .NET - Drag and drop to Desktop / Explorer," Following my scenario.I got an Application which loads a Filestructure (Folders, Files) from a Database into a WPF ListView. Now I'd like to grab a file from this ListView, drag it over my Desktop (or some open explorer window) and drop it there. Basic Drag and Drop, nothing fancy. This sounds like a ""standard"" function for a windows application - but google won't help.So how can I achieve this? Interops?ThanksEdit: Thanks for the solution, I still had to do some googling. Here's my complete solution. <code> ",Drag and drop to Desktop / Explorer
How do you  get the solution directory in C# (VS 2008) in code?," Got an annoying problem here. I've got an NHibernate/Forms application I'm working through SVN. I made some of my own controls, but when I drag and drop those (or view some form editors where I have already dragged and dropped) onto some of my other controls, Visual studio decides it needs to execute some of the code I wrote, including the part that looks for hibernate.cfg.xml.I have no idea why this is, but (sometimes!) when it executes the code during my form load or drag and drop it switches the current directory to C:\program files\vs 9.0\common7\ide, and then nhibernate throws an exception that it can't find hibernate.cfg.xml, because I'm searching for that in a relative path.Now, I don't want to hard code the location of hibernate.cfg.xml, or just copy hibernate.cfg.xml to the ide directory (which will work). I want a solution that gets the solutions directory while the current directory is common7\ide. Something that will let someone view my forms in the designer on a fresh checkout to an arbitrary directory on an arbitrary machine. And no, I'm not about to load the controls in code. I have so many controls within controls that it is a nightmare to line everything up without it.I tried a pre build event that made a file that has the solution directory in it, but of course how can I find that from common7\ide? All the projects files need to be in the solution directory because of svn.Thanks for your help guys, I've already spent a few hours fiddling with this in vain.UPDATE: I set hibernate.cfg as an embedded resource. For each configuration I just simply make a new build configuration, debug, release, XYZ. In most cases I'd recommend embedding any files you depend on to run the program. It makes it much simpler to build an installer. <code> ",How do you get the solution directory in C# (VS 2008) in code?
How to compare DateTime in C# WPF?," I don't want user to give the back date or time. How can I compare if the entered date and time is LESS then the current time?If the current date and Time is 17-Jun-2010 , 12:25 PM , I want user cannot give date before 17 Jun -2010 and time before 12:25 PM.Like my function return false if the time entered by user is 16-Jun-2010 and time 12:24 PM <code> ",How to compare DateTime in C#?
how to set combobox read only or user cannot write in a combo box only can select the given items?," I am facing a problem in setting the combo property such that only user can select the values form given items, but I cannot write in the combo box.How can I do so in C#? <code> ",How do I set combobox read-only or user cannot write in a combo box only can select the given items?
How can i sort DESC and ASC in list generic?," How can I sort generic list DESC and ASC? With LINQ and without LINQ? I'm using VS2008. <code>  class Program{ static void Main(string[] args) { List<int> li = new List<int>(); li.Add(456); li.Add(123); li.Add(12345667); li.Add(0); li.Add(1); li.Sort(); foreach (int item in li) { Console.WriteLine(item.ToString() + ""\n""); } Console.ReadKey(); }}",How can I sort generic list DESC and ASC?
Convert int 2 string in C#, How can I convert an int datatype into a string datatype in C#? <code> ,Convert int to string?
Convert int to string in C#, How can I convert an int datatype into a string datatype in C#? <code> ,Convert int to string?
Convert int to string in C#?, How can I convert an int datatype into a string datatype in C#? <code> ,Convert int to string?
how to set background image on grid in wpf using C#, I have a problem: I want to set the image of my grid through code behind. Can anybody tell me how to do this? <code> ,Set background image on grid in WPF using C#
Rule of thumb to test the equality/inequality of two doubles in C#?," Let's say I have some code that does some floating point arithmetic and stores the values in doubles. Because some values can't be represented perfectly in binary, how do I test for equality to a reasonable degree of certainty?How do I determine what ""reasonable"" means?Can double.Epsilon be used in some way?UpdateCouple things. As @ho1 pointed out, the documentation for double.Epsilon points out that, when it comes to comparing two doubles for equality, you are probably going to want a value much greater than epsilon. Here is the relevant paragraph from the documentation: Two apparently equivalent floating-point numbers might not compare equal because of differences in their least significant digits. For example, the C# expression, (double)1/3 == (double)0.33333, does not compare equal because the division operation on the left side has maximum precision while the constant on the right side is precise only to the specified digits. If you create a custom algorithm that determines whether two floating-point numbers can be considered equal, you must use a value that is greater than the Epsilon constant to establish the acceptable absolute margin of difference for the two values to be considered equal. (Typically, that margin of difference is many times greater than Epsilon.) -- http://msdn.microsoft.com/en-us/library/system.double.epsilon.aspx...but the question is, how many times greater??In case it would affect your answer, my particular situation involves geometry calculations (such as dot products and cross products using points and vectors). In some cases, you reach different conclusions based on whether A == B, A > B, or A < B, so I'm looking for a good rule of thumb for how to determine the size of the equivalence window. <code> ",Rule of thumb to test the equality of two doubles in C#?
c# Registry GetSubKeyNames lists different keys than regedit?," We are using WIX to install a number of services we create. I am writing a quick utility to dump the currently installed services. I just iterate over subkeys of: looking for DisplayName. The problem is, only two of my ten services show up in the list.However, when I look at the subkeys in Regedit, they are there. As well, they are in the installed programs (and I can find them in SELECT * from Win32_Product too).I looked through the MSDN docs, trying to find out if there is some special view of the registry that I am missing. Maybe it is a privilege issue? But I am running the tool as admin. Is there some hive mounting issue?Just to be clear with the code, here is the test app code (from this answer): Any thoughts on this? <code>  SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall String registryKey = @""SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall"";using(Microsoft.Win32.RegistryKey key = Registry.LocalMachine.OpenSubKey(registryKey)){ foreach(String subkeyName in key.GetSubKeyNames()) Console.WriteLine(key.OpenSubKey(subkeyName).GetValue(""DisplayName""));}",Registry GetSubKeyNames() lists different keys than Regedit?
Registry GetSubKeyNames lists different keys than regedit?," We are using WIX to install a number of services we create. I am writing a quick utility to dump the currently installed services. I just iterate over subkeys of: looking for DisplayName. The problem is, only two of my ten services show up in the list.However, when I look at the subkeys in Regedit, they are there. As well, they are in the installed programs (and I can find them in SELECT * from Win32_Product too).I looked through the MSDN docs, trying to find out if there is some special view of the registry that I am missing. Maybe it is a privilege issue? But I am running the tool as admin. Is there some hive mounting issue?Just to be clear with the code, here is the test app code (from this answer): Any thoughts on this? <code>  SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall String registryKey = @""SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall"";using(Microsoft.Win32.RegistryKey key = Registry.LocalMachine.OpenSubKey(registryKey)){ foreach(String subkeyName in key.GetSubKeyNames()) Console.WriteLine(key.OpenSubKey(subkeyName).GetValue(""DisplayName""));}",Registry GetSubKeyNames() lists different keys than Regedit?
C# Out of Memory Exception," I have a fairly simple C# application that has builds a large hashtable. The keys of this hashtable are strings, and the values are ints.The program runs fine until around 10.3 million items are added to the hashtable, when an out of memory error is thrown on the line that adds an item to the hasbtable.According to the task manager, my program is only using 797mb of memory, and there's still over 2gb available. It's a 32-bit machine, so I know only a total of 2gb can be used by one process, but that still leaves about 1.2gb that the hashtable should be able to expand into.Why would an out of memory error be thrown? <code> ",Why Would an Out of Memory Exception be Thrown if Memory is Available?
Query string parameters with no values.," I am trying to set up a page that has two behaviors. I'm separating them by URL: One behavior is accessed via /some-controller/some-action, the other is via /some-controller/some-action?customize. It doesn't look like the Request.QueryString object contains anything, though, when I visit the second URL...I mean, the keys collection has one element in it, but it's null, not 'customize'. Anyone have any ideas about this or how to enable this. I'd like to avoid manually parsing the query string at all costs :). <code> ",Access Query string parameters with no values in ASP.NET
DataTable to XML and ViceVersa in C# .Net," I am having a problem with reading an XML file onto a DataTable. Initially, I am writing a Datatable to an XML file and saving it. Now, when I want to read the XML file back to the DataTable, it's not happening.The following code is for writing the file: And for reading the file: <code>  private void saveAsToolStripMenuItem_Click(object sender, EventArgs e) { if (myDT_For_DGV.Rows.Count != 0) { saveFileDialog1.ShowDialog(); saveFileDialog1.FileName = ""checkOutFile.xml""; myDT_For_DGV.TableName = ""CheckOutsAndIns""; myDT_For_DGV.WriteXml(saveFileDialog1.FileName, true); } else { MessageBox.Show(""Please add licences to DataGridView, you havent added any licences as of now"", ""Alert""); }} private void openToolStripMenuItem_Click(object sender, EventArgs e){ //write code to open file if (openFileDialog1.ShowDialog() == DialogResult.OK) { //myFile = openFileDialog1.FileName; System.IO.MemoryStream xmlStream = new System.IO.MemoryStream(); xmlStream.Position = 0; myDT_For_DGV.ReadXml(openFileDialog1.FileName); //MessageBox.Show(openFileDialog1.FileName); }}",Convert DataTable to XML file and viceversa
msdn: Thread Safety," In many MSDN documents, this is written under the Thread Safety heading;""Any public static (Shared in Visual Basic) members of this type are thread safe. Any instance members are not guaranteed to be thread safe.""for example; herecan someone explain it please in a rather simple way?Thank you :) <code> ","msdn: What is ""Thread Safety""?"
hello i am suffring to get system time upto millisecond precision using windows ," Related to my previous question, but with C#, I need the precise system time including milliseconds.C# time function has accuracy up to 10 to 15 milliseconds, but not exactly 1 millisecond.The same is the case with Queue performance counter. Is there any other way to get accuracy up to exact millisecond? <code> ",Windows system time with millisecond precision
hello i am suffering to get system time upto millisecond precision using windows ," Related to my previous question, but with C#, I need the precise system time including milliseconds.C# time function has accuracy up to 10 to 15 milliseconds, but not exactly 1 millisecond.The same is the case with Queue performance counter. Is there any other way to get accuracy up to exact millisecond? <code> ",Windows system time with millisecond precision
c# inter-thread communication," I want two threads to collaborate; a producer and a consumer. the consumer is rather slow, and the producer is very fast and works in bursts.for example the consumer can process one message per 20 seconds, and the producer can produce 10 messages in one second, but does it about once in a long while so the consumer can catch up.I want something like: <code>  Stream commonStream;AutoResetEvent commonLock;void Producer(){ while (true) { magic.BlockUntilMagicAvalible(); byte[] buffer = magic.Produce(); commonStream.Write(buffer); commonLock.Set(); }}void Consumer(){ while(true) { commonLock.WaitOne(); MagicalObject o = binarySerializer.Deserialize(commonStream); DoSomething(o); }}",C# inter-thread communication
C# - Confirming all Keys in a dictionary have populated Values," I have a Dictionary<string, List<string>>I want to do a check that all Keys in the dictionary have at least 1 item in its corresponding list <code> ",Confirming all Keys in a dictionary have populated Values
"Linq in C#, Select not found"," I want to use Linq to query a 2D array but I get an error: Could not find an implementation of the query pattern for source type 'SimpleGame.ILandscape[,]'. 'Select' not found. Are you missing a reference to 'System.Core.dll' or a using directive for 'System.Linq'?Code is following: I've checked that I included the reference System.Core and using System.Linq.Could anyone give some possible causes? <code>  var doors = from landscape in this.map select landscape;","Using Linq with 2D array, Select not found"
C (ish) style union in C#," [Note: This question had the original title ""C (ish) style union in C#""but as Jeff's comment informed me, apparently this structure is called a 'discriminated union']Excuse the verbosity of this question.There are a couple of similar sounding questions to mine already in SO but they seem to concentrate on the memory saving benefits of the union or using it for interop.Here is an example of such a question.My desire to have a union type thing is somewhat different.I am writing some code at the moment which generates objects that look a bit like this Pretty complicated stuff I think you will agree. The thing is that ValueA can only be of a few certain types (let's say string, int and Foo (which is a class) and ValueB can be another small set of types. I don't like treating these values as objects (I want the warm snugly feeling of coding with a bit of type safety). So I thought about writing a trivial little wrapper class to express the fact that ValueA logically is a reference to a particular type. I called the class Union because what I am trying to achieve reminded me of the union concept in C. Using this class ValueWrapper now looks like this which is something like what I wanted to achieve but I am missing one fairly crucial element - that is compiler enforced type checking when calling the Is and As functions as the following code demonstrates IMO It is not valid to ask ValueA if it is a char since its definition clearly says it is not - this is a programming error and I would like the compiler to pick up on this. [Also if I could get this correct then (hopefully) I would get intellisense too - which would be a boon.] In order to achieve this I would want to tell the compiler that the type T can be one of A, B or C Does anyone have any idea if what I want to achieve is possible? Or am I just plain stupid for writing this class in the first place?Thanks in advance. <code>  public class ValueWrapper{ public DateTime ValueCreationDate; // ... other meta data about the value public object ValueA; public object ValueB;} public class Union<A, B, C>{ private readonly Type type; public readonly A a; public readonly B b; public readonly C c; public A A{get {return a;}} public B B{get {return b;}} public C C{get {return c;}} public Union(A a) { type = typeof(A); this.a = a; } public Union(B b) { type = typeof(B); this.b = b; } public Union(C c) { type = typeof(C); this.c = c; } /// <summary> /// Returns true if the union contains a value of type T /// </summary> /// <remarks>The type of T must exactly match the type</remarks> public bool Is<T>() { return typeof(T) == type; } /// <summary> /// Returns the union value cast to the given type. /// </summary> /// <remarks>If the type of T does not exactly match either X or Y, then the value <c>default(T)</c> is returned.</remarks> public T As<T>() { if(Is<A>()) { return (T)(object)a; // Is this boxing and unboxing unavoidable if I want the union to hold value types and reference types? //return (T)x; // This will not compile: Error = ""Cannot cast expression of type 'X' to 'T'."" } if(Is<B>()) { return (T)(object)b; } if(Is<C>()) { return (T)(object)c; } return default(T); }} public class ValueWrapper2{ public DateTime ValueCreationDate; public Union<int, string, Foo> ValueA; public Union<double, Bar, Foo> ValueB;} public void DoSomething() { if(ValueA.Is<string>()) { var s = ValueA.As<string>(); // .... do somethng } if(ValueA.Is<char>()) // I would really like this to be a compile error { char c = ValueA.As<char>(); } } public bool Is<T>() where T : A or T : B // Yes I know this is not legal! or T : C { return typeof(T) == type; } ",Discriminated union in C#
"I can'nt create a clear picture, why and when to use RESTful services"," Why and when to use RESTful services?I know how to create a WCF webservice. But I am not able to comprehend when to use a SOAP based service and when to use a RESTful service. I read many articles on SOAP vs REST, but still, I don't have a clear picture of why and when to use RESTful services.What are some concrete points in order to easily decide between these services? <code> ","I can't create a clear picture, why and when to use RESTful services?"
"I can't create a clear picture, why and when to use RESTful services"," Why and when to use RESTful services?I know how to create a WCF webservice. But I am not able to comprehend when to use a SOAP based service and when to use a RESTful service. I read many articles on SOAP vs REST, but still, I don't have a clear picture of why and when to use RESTful services.What are some concrete points in order to easily decide between these services? <code> ","I can't create a clear picture, why and when to use RESTful services?"
c# silverlight assembly," I want to be able to change a setting in my silverlight assembly at runtime, i want a bit like a web.config in a asp.net web site?what is the best way of doing this?thank you <code> ",Storing application settings in Silverlight
"C#: What is the ""(type)"" in (type)objectname.var "," I am going through a book on C# and have come across something that I can't seem to look up, because I don't know what it is called, or trying to search for something by description.Could some explain to me what is going on, or the meaning behind the (type) that comes before a reference to an object as in (int)objectname.variablename? It seems like casting to me.EDIT:Since most of you are going off 'My' reference to casting when I am only guessing, and needed more code, I am including the code that I am reviewing that has brought on this question. I am questioning the (int) in the (int)numericupDown1.Value; <code>  private void numericUpDown1_ValueChanged(object sender, EventArgs e) { dinnerParty.NumberOfPeople = (int)numericUpDown1.Value; DisplayDinnerPartyCost();}",What is the (type) in (type)objectname.var
What is the (type) in (type)objectname.var ," I am going through a book on C# and have come across something that I can't seem to look up, because I don't know what it is called, or trying to search for something by description.Could some explain to me what is going on, or the meaning behind the (type) that comes before a reference to an object as in (int)objectname.variablename? It seems like casting to me.EDIT:Since most of you are going off 'My' reference to casting when I am only guessing, and needed more code, I am including the code that I am reviewing that has brought on this question. I am questioning the (int) in the (int)numericupDown1.Value; <code>  private void numericUpDown1_ValueChanged(object sender, EventArgs e) { dinnerParty.NumberOfPeople = (int)numericUpDown1.Value; DisplayDinnerPartyCost();}",What is the (type) in (type)objectname.var
Whats better interface or abstract class ?," I have been into C# and always feel confusion between what should be selected between interfaces and abstract classes. Can some one please help resolve this query ?Thanks , <code> ",How do I decide whether to use an interface or an abstract class ?
"List of new features in C#2.0, 3.0 and 4.0"," I worked on the .NET 1.1 project for a long time, and I was stuck at C# 1.0 and now I would like to catch up with the latest and greatest.Google returned a lot of information on new features in C# v2.0, but for the versions 3 and 4 I found only partial information.Is there somewhere on the Internet some list of all new features introduced in C# in v2.0, v3.0 and v4.0? <code> ","List of new features in C# 2.0, 3.0 and 4.0"
Given a List<int> how to create a comman seperated string?, Given a List<int> how to create a comma separated string? <code> ,Given a List<int> how to create a comma separated string?
Understanding the extention ElementAt(index)," Consider this code: when I call emu.ElementAt(size-10) and arr.ElementAt(size-10) and measure the time the arr is much faster (the array is 0.0002s compared to IEnumerable 0.59s). As I understand it, the extention method ElementAt() have the signature and since the 'source' is a IEnumerable the logic carried out would be similar - opposed to what I see where the array is accessed directly.Could someone please explain this :) <code>  int size = 100 * 1000 * 1000;var emu = Enumerable.Range(0, size);var arr = Enumerable.Range(0, size).ToArray(); public static TSource ElementAt<TSource>(this IEnumerable<TSource> source, int index)",Understanding the extension ElementAt(index)
C# WPF Button Down Detection, How can I detect that the button in my application is still clicked (down)? and how to know when it is released? <code> ,C# WPF Perform action while button down
How to elegantly check if a number is within a range?," How can I do this elegantly with C#?For example, a number can be between 1 and 100.I know a simple if (x >= 1 && x <= 100) would suffice; but with a lot of syntax sugar and new features constantly added to C#/.Net this question is about more idiomatic (one can all it elegance) ways to write that.Performance is not a concern, but please add performance note to solutions that are not O(1) as people may copy-paste the suggestions. <code> ",How to elegantly check if a number is within a range?
C#: How to elegantly check if a number is within a range?," How can I do this elegantly with C#?For example, a number can be between 1 and 100.I know a simple if (x >= 1 && x <= 100) would suffice; but with a lot of syntax sugar and new features constantly added to C#/.Net this question is about more idiomatic (one can all it elegance) ways to write that.Performance is not a concern, but please add performance note to solutions that are not O(1) as people may copy-paste the suggestions. <code> ",How to elegantly check if a number is within a range?
Which should i use for empty string and why?," Possible Duplicate: What is the difference between String.Empty and “” Which of the following should I use for assigning an empty string and why? or <code>  string variableName = """"; string variableName = string.Empty;",Which should I use for empty string and why?
Parse number from string value in C#," I am working on .NET project and I am trying to parse only the numeric value from string. For example, A couple assumptions areThe string pattern always will be number follow by characters.The number portion always will be either one or two digits value.Is there any C# predefined function to parse the numeric value from string? <code>  string s = ""12ACD"";int t = someparefun(s); print(t) //t should be 12",Parse a number from a string with non-digits in between
How can I utilize Json.NET to modify parts of an existing JSON object?," Example:I have the following JSON object. I want to be able to remove one or more items from the services array based on the value of the name attribute. For instance, I want to search for name=""nyc"" and remove the following object from the array. The end result is an object that looks like this: I have been able to create new JSON object fairly easily and I can read existing ones. However, I am having difficultly determining the best way to modify an existing JSON object. Particularly as it relates to querying for specific objects within the JSON object.One method that I have uncovered (specific to this example) is to rebuild portions of the JSON that I want modified and replace the tokens as necessary. However, I have to think there is a better way. This code is shown below. How can I best utilize Json.NET to modify parts of an existing JSON object? <code>  {""currentVersion"" : ""10.0"", ""folders"" : [], ""services"" : [ {""name"" : ""nyc"", ""type"" : ""MapServer""}, {""name"" : ""philly"", ""type"" : ""MapServer""} ]} {""name"" : ""nyc"", ""type"" : ""MapServer""} {""currentVersion"" : ""10.0"", ""folders"" : [], ""services"" : [ {""name"" : ""philly"", ""type"" : ""MapServer""} ]} string json = @""{""""currentVersion"""" : """"10.0"""", """"folders"""" : [], """"services"""" : [ {""""name"""" : """"nyc"""", """"type"""" : """"MapServer""""}, {""""name"""" : """"philly"""", """"type"""" : """"MapServer""""} ] }"";string[] keepList = new string[] { ""nyc"" };JObject o = JObject.Parse(json);JArray services = (JArray)o[""services""];JArray newServices = new JArray();foreach (JToken service in services){ foreach (string keeper in keepList) { if ((string)service[""name""] == keeper) { newServices.Add(service); break; } }}services.Replace(newServices);string output = o.ToString();",How can I best utilize Json.NET to modify parts of an existing JSON object?
Is it possible to format a date column of a datatable in c#?," Consider i have a datatable dt and it has a column DateofOrder, I want to format these dates in DateOfOrder column to this Any suggestion.. <code>  DateofOrder07/01/201007/05/201007/06/2010 DateofOrder01/Jul/201005/Jul/201006/Jul/2010",Is it possible to format a date column of a datatable?
How to properly define a class ?, When defining a new class within a project what is the correct/best practice for doing so? In the past I have created classes such as: Normally Id use a class such as this for the creation of collections within a project.However as I continue to learn and read more about c# sharp I see examples where classes are defined as: Is the first approach incorrect in definition or is this an accepted shorthand version within C#? As a best practice should you always first define the class with private fields and then define them as properties using get / set to a value?I ask because I am self taught in C# and I am trying to improve and well as better understand the proper approach to development and some samples and tutorials out there simply state approaches without a solid explanation as to why one approach is preferred (or should be done) over the other.Thanks in advance <code>  public class MyClass { public string FirstName {get; set;} public string LastName {get; set;} } class MyClass //not set to public { private string _firstName; //first defined as fields private string _lastName; public string FirstName // then defined as properties { get { return _firstName; } set { _firstName = value; } } public string LastName { get { return _lastName; } set { _lastName = value; } } },How to properly define class properties?
ASP.NET MVC2 - Dynamic list of checkboxes and model binding," I'm trying to create a view that contains a list of checkboxes that is dynamically created from a database, and then retrieve the list of selected ones when the form is posted back. My EF model contains a class: I have a view model that contains a list of these: My controller get method: My view: My controller post method: I can't seem to get it to work. My basic questions are mixed in as comments in the code snippets, but to recap:Is my view model OK? (do I need to add anything to capture the selected ones as opposed to simply the list to display?)What exactly should I put in the view to render each check box?How do I access the selected checkboxes in the controller after the post? <code>  public class ItemIWouldLikeACheckboxFor { public int Id { get; set; } public string Description { get; set; }} public class PageViewModel { // various other properties public List<ItemIWouldLikeACheckboxFor> checkboxList { get; set; }} public ActionResult Create() { var viewModel = new PageViewModel(); viewModel.checkboxList = db.ItemIWouldLikeACheckboxFors.ToList(); return View(viewModel);} <% using (Html.BeginForm()) { %> <%-- other stuff here... %> <% foreach (var item in checkboxList) { %> <%: Html.CheckBox( <!-- what exactly ?????? -->) %> <% } %> <%-- other stuff here...%> <input type=""submit"" /><% } %> [HttpPost]public ActionResult Create(PageViewModel viewModel) { // do stuff with other fields // I would like to do something like: foreach (var item in selectedCheckBoxes) { // do stuff }}",Dynamic list of checkboxes and model binding
"Given a bounding box and a line (two points), detemine if the line intersects the box"," Given a bounding box, with definitions like bounds.min.(x/y/z), bounds.max.(x/y/z), and two points in 3D space (expressed as Vector3 objects), how can I determine if the line made by the two points intersects the bounding box? <code> ","Given a bounding box and a line (two points), determine if the line intersects the box"
"Do interfaces derive from System.Object? C# spec says yes, Eric says no, reality says no."," Question is simple and asked in the title.C# 4.0 Specification says: (4.2.2) The object class type is the ultimate base class of all other types. Every type in C# directly or indirectly derives from the object class type.Eric Lippert says: Interface types, not being classes, are not derived from object.Reality says: TrueSo is spec wrong or what? Whom to believe? <code>  Type t = typeof(ICloneable).BaseType;Console.WriteLine(t == null);",Do interfaces derive from System.Object?
"Do interfaces derive from System.Object? C# spec says yes, Eric says no, reality says no"," Question is simple and asked in the title.C# 4.0 Specification says: (4.2.2) The object class type is the ultimate base class of all other types. Every type in C# directly or indirectly derives from the object class type.Eric Lippert says: Interface types, not being classes, are not derived from object.Reality says: TrueSo is spec wrong or what? Whom to believe? <code>  Type t = typeof(ICloneable).BaseType;Console.WriteLine(t == null);",Do interfaces derive from System.Object?
c# do if( a == (b or c or d)) is it possible ?," Is there another way to write something like this: One way that I found is doing it like this: Are there other good ways? <code>  if (a == x || a == y || a == z) if( new [] {x,y,z}.Contains(a))",C#. Do if( a == (b or c or d)). Is it possible?
OpenXml Replace sdt element with table," I'm using the OpenXML SDK to programatically replace some <w:sdt/> elements with chunks of OpenXML (WordProcessingML) markup.For example, I have a paragraph with these contents: And a table with a structure like this: Basically I want to replace the <w:sdt/> element in the paragraph with the table markup.The problem is that I cannot just replace it because it will create an invalid document (a table with paragraphs inside another paragraph element isn't valid).The result that I want to get is this: I was thinking on creating a method that created a new paragraph with the elements before the <w:sdt/> element, and another one with the elements after the sdt element, but it seems like such a method would be error-prone.Is there a method that can do what I want without having to do it manually (a method that does what Word does when I try to insert a new table inside a text line)?Any help will be greatly appreciated. <code>  <w:p> <w:run><w:text> Text before </w:text></w:run> <w:sdt><w:sdtPr> ...</w:sdtPr><w:sdtContent>...</w:sdtContent></w:sdt> <w:run><w:text> Text after </w:text></w:run></w:p> <w:tbl> <w:tblPr>...</w:tblPr> <w:tblGrid> ... gridCol elements ...</w:tblGrid> <w:tr> <w:trPr>...</w:trPr> <w:tc> <w:tcPr>...</w:tcPr> <w:p> Cell contents </w:p> </w:tc> <w:tc> <w:tcPr>...</w:tcPr> <w:p> Cell contents </w:p> </w:tc> </w:tr> </w:tbl> <w:p> <w:run><w:text> Text before </w:text></w:run></w:p><w:tbl> <w:tblPr>...</w:tblPr> <w:tblGrid> ... gridCol elements ...</w:tblGrid> <w:tr> <w:trPr>...</w:trPr> <w:tc> <w:tcPr>...</w:tcPr> <w:p> Cell contents </w:p> </w:tc> <w:tc> <w:tcPr>...</w:tcPr> <w:p> Cell contents </w:p> </w:tc> </w:tr></w:tbl><w:p> <w:run><w:text> Text after </w:text></w:run></w:p>",OpenXML: Replace <sdt/> element with table in WordprocessingML
How to eliminate dupliocate code?, I have the following codes and I would like to write it in a way that I have minimum duplication of codes. Please note that Category and priority do not have a common base type or interface that includes ID. <code>  if (Categories != null){ bool flag=false; foreach (dynamic usableCat in Category.LoadForProject(project.ID)) { foreach (dynamic catRow in Categories) { if (usableCat.ID == catRow.ID) flag = true; } if (!flag) { int id = usableCat.ID; Category resolution = Category.Load(id); resolution.Delete(Services.UserServices.User); } }}if (Priorities != null){ bool flag = false; foreach (dynamic usableCat in Priority.LoadForProject(project.ID)) { foreach (dynamic catRow in Priorities) { if (usableCat.ID == catRow.ID) flag = true; } if (!flag) { int id = usableCat.ID; Priority resolution = Priority.Load(id); resolution.Delete(Services.UserServices.User); } }},How to eliminate duplicate code?
Programming Add-Ons," I'm starting a new project which would greatly benefit from program add-ons. The program in its most basic form reads data from a serial port and parses it into database records. Examples of add-ons that could be written would be an auto-archive add-on, an add-on to filter records, etc. I'm writing both the program and the add-ons, but some customers need custom solutions, so instead of branching off and making a completely separate program, add-ons would be great. The simplest add-on would probably be a form who's constructor takes an object reference, manipulates the object in some way, then closes.Unfortunately, I have absolutely no idea where to start coding, and almost as little idea where to search. Everything I search for turns up browser add-ons. From what I have gathered, I need to look into dynamic loading DLLs. Besides that, I'm clueless. Does anyone have any good resources or examples I that they know of?I'm happy to provide more details, but this project is in its inception, so I don't have a ton of specific details (specifics kind of defeats the point of add-ons, too.) <code> ",Building An App With Plug-in Support
how to check that list already contain or not.," I used a struct in List<stuff> stuff = new List<stuff>();How i can check the list already have a stuff ""where ID = 1""? <code>  public struct stuff{ public int ID; public int quan;}",Check if a List already contains an item or not?
C# Code to validate SQL Scripts, How can I validate sql scripts before executing them using .net 2.0 and c#? If the sql is not valid I want to return error rows. <code> ,Code to validate SQL Scripts
Help me to sort a List," I have a class: I have a List of Myobject objects: How to sort this list with condition: sort Name first & sort Age later. With this list, the result after sorting: <code>  public class MyObject{public string Name;public int Age;} Name AgeABC 12BBC 14ABC 11 Name AgeABC 11ABC 12BBC 14",How to sort a List in C#
Generate img object with canvas todataurl," How can i make a Bitmap or Image object with the code generated by canvas.toimageurl() method?The string looks like this: data:image/jpeg;base64,/9j/4AAQSkZJRgABAQA... <code> ",Generate c# image object with canvas todataurl
Filtering an hierarchical object displayed with nested xaml data templates," I'm having trouble filtering hierarchical data that's being displayed in nested xaml templates.I've got a ObservableCollection<Foo> Foos, that I'm displaying in XAML.Lets say Foo looks like: I'm displaying Foos with the following xaml: To put it into words, there's a tab control, with a tab for each Foo. Each Foo is a tab control, with each Bar it contains in it's own tab. Each Bar contain's a listbox of its Quxes.or: I also have a TextBox that I'd like to use to filter this breakdown. When I type in the text box, I'd like to filter the quxes so those not containing the text wouldn't be visible. Ideally Bar tabs would also be hidden if they have no visible quxes, and Foo tabs hidden when they have no visible BarsI have considered two approaches:Approach 1, reset the Filter property on the appropriate CollectionViewSourcesOn my text box's TextChanged event, I loop through my Foo's asking for the corresponding (static) TabControl's CollectionViewSource: Approach 2, declare the ListView's ItemSource to a CollectionViewSourceI tried setting the Filter via xaml, by changing this line: to this, I've tried a number of things where I have ""?????"" but I cannot correctly bind to the ListBox's datacontext and appropriate Quxes member. Nothing I try results in the quxes being displayed, and I get no errors on the console. Even If I could get this approach to work, I'm not sure how I would re-trigger this filter when the text in the search box changed.Any advice or direction would be appreciated. <code>  class Foo{ public ObservableCollection<Bar> Bars;}class Bar{ public ObservableCollection<Qux> Quxes;} <Grid> <Grid.Resources> <CollectionViewSource x:Key=""MyCVS"" Source=""{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListView}}, Path=DataContext.UnifiedSymbols}"" Filter=""MyCVS_Filter"" /> <DataTemplate x:Key=""NestedTabHeaderTemplate""> <TextBlock Text=""{Binding Path=Name}""/> </DataTemplate> <DataTemplate x:Key=""NestedTabContentTemplate""> <ListBox ItemsSource=""{Binding Path=Quxes}"" DisplayMemberPath=""Name""/> </DataTemplate> <DataTemplate x:Key=""TopLevelTabHeaderTemplate""> <TextBlock Text=""{Binding Path=Name}""/> </DataTemplate> <DataTemplate x:Key=""TopLevelTabContentTemplate""> <TabControl ItemsSource=""{Binding Path=Bars}"" ItemTemplate=""{StaticResource NestedTabHeaderTemplate}"" ContentTemplate=""{StaticResource NestedTabContentTemplate}"" /> </DataTemplate> </Grid.Resources> <TabControl ItemSource=""{Binding correct binding for my control's collection of Foos}"" ItemTemplate=""{StaticResource TopLevelTabHeaderTemplate}"" ContentTemplate=""{StaticResource TopLevelTabContentTemplate}"" x:Name=""tabControl"" /></Grid> ______ ______ ______ | Foo1 | Foo2 | Foo3 | |______ ______ | | Bar1 | Bar2 |______| | | qux1 || | | qux2 || | | qux3 || ---------------------- foreach(Foo foo in tabControl.Items){ var tabItem = tabControl.ItemContainerGenerator.ContainerFromItem(foo); // This is always of type TabItem // How do I get the TabControl that will belong to each of Foo's Bar's?} <ListBox ItemsSource=""{Binding Path=Quxes}"" DisplayMemberPath=""Name""> <CollectionViewSource x:Key=""MyCVS"" Source=""?????"" Filter=""MyCVS_Filter"" />...<ListBox ItemsSource=""{Binding Source={StaticResource MyCVS}}"" DisplayMemberPath=""Name"">",Filtering a hierarchical object displayed with nested xaml data templates
Binding a Dictionary's key and value in a listbox," I am trying to bind a dictionary's key to a row of the grid in a listbox, and bind the dictionary's value to another row of the grid. key's type is Book, a class thati wrote and the value's type is int.i want to write the elements of the class and the integer value in grid.Can you help me on this? I'm quite confused on determining the itemsSource and the data type to bind.thanks for helpingEdit: i forgot to say that i am using c# - wpf. =)I sent the dictionary as the itemsSource, and i specified the dictionary as type in objectdataprovider tag, and tried to send the value (int) by this code: and the selecteditem was shown as [myNameSpace.Book, 4] instead of only 4. this is what I wrote in Window.xaml.cs and Books is a BookList, where BookList is a type of dictionary< Book, int> .and the xaml file: there is one more problem with my code-- I cant see the listed items in listbox. I mean I could get the values by ListBox.SelectedItem but couldn't see in the listbox. thus I can't be sure if I could pass the integer value to where I want.So I think I also need help for this problem first...I write a label that I write by hand, and another label that should be filled by data binding in the same row but I can just see the first label, but I can reach the value in code behind. <code>  < TextBlock Text=""{Binding Value, Mode=OneWay}"" Grid.Row=""1"" Width=""65"" > BookListBox.ItemsSource = LibManager.Books; < ListBox Height=""571"" HorizontalAlignment=""Left"" Margin=""444,88,0,0"" Name=""BookListBox"" VerticalAlignment=""Top"" Width=""383"" > < ListBox.Resources> <ObjectDataProvider x:Key=""BookData"" ObjectType=""{x:Type local:BookList}""/> </ListBox.Resources> < ListBox.ItemTemplate> < DataTemplate> < Border BorderThickness=""2"" BorderBrush=""Black"" Margin=""5"" CornerRadius=""5"" Width=""350"" > < Grid DataContext=""{StaticResource BookData}"" > < Grid.ColumnDefinitions> < ColumnDefinition/> </Grid.ColumnDefinitions> < Grid.RowDefinitions> < RowDefinition/> < RowDefinition/> < /Grid.RowDefinitions> < Label Content=""count: "" /> < TextBlock Text=""{Binding Value, Mode=OneWay}"" Grid.Row=""1"" Width=""65""/> < /Grid> < /Border> < /DataTemplate> < /ListBox.ItemTemplate> < /ListBox>",Binding a Dictionary's key and value in a listbox with wpf
"c# FlowLayoutPanel scroll, background distorts + flickers"," I have a windows form application that has a background. Within it, I have a flowlayoutpanel with a transparent background. When I scroll, the following happens: I also see some flickering. I've tried all the doublebuffered business, and it doesn't work.Any suggestions? <code> ","During FlowLayoutPanel scrolling, background distorts + flickers"
How do you convert 3 bytes into a 24bit number in C#?," I have an array of bytes that I read from a header section of a message. These bytes contain the length of the message. There never are more than 3 bytes and they are ordered from LSB to MSB. So in the example below, 39 is the LSB and 2 is the MSB. In the example above how can I take those bytes and convert to a number (int,short,etc)? <code>  var data = new byte[] { 39, 213, 2 };",How do you convert 3 bytes into a 24 bit number in C#?
C#: what is the difference between var++ and ++var?," I've seen them both being used in numerous pieces of C# code, and I'd like to know when to use i++ or ++i (i being a number variable like int, float, double, etc). Anyone who knows this? <code> ",What is the difference between i++ and ++i?
C#: what is the difference between i++ and ++i?," I've seen them both being used in numerous pieces of C# code, and I'd like to know when to use i++ or ++i (i being a number variable like int, float, double, etc). Anyone who knows this? <code> ",What is the difference between i++ and ++i?
How to convert TryCast in c# ?," How to convert following vb code in to c#? I tried it using AS operator in c# but it is not working. <code>  Dim request As HttpWebRequest = TryCast(WebRequest.Create(address), HttpWebRequest)",How to convert TryCast in c#?
sending and receiving files socket programming c#," i am developing two application one is server application and other is for handheld device application both communicate using wireless connection.here client is handheld and server is my computer where server application running. when i send files from client to server it sendperfectly without any error but when client request for files the server produce errorsomething like ""No connection could be made because the target machine actively refused it 192.168.1.5:9050""server side code: client side code: this code is used to get file from server. <code>  private bool SendData(string StrIP) { try { string strmyFile = Directory.GetCurrentDirectory() + ""\\"" + ""XML"" + @""\Login.xml""; char[] delimiter = splitter.ToCharArray(); split = strmyFile.Split(delimiter); int limit = split.Length; fName = split[limit - 1].ToString(); byte[] fileName = Encoding.UTF8.GetBytes(fName); //file name byte[] fileData = File.ReadAllBytes(strmyFile); //file using (FileStream stream = File.OpenRead(strmyFile)) { fileData = new byte[stream.Length]; stream.Read(fileData, 0, fileData.Length); } byte[] fileNameLen = BitConverter.GetBytes(fileName.Length); //lenght of file name clientData = new byte[4 + fileName.Length + fileData.Length]; fileNameLen.CopyTo(clientData, 0); fileName.CopyTo(clientData, 4); fileData.CopyTo(clientData, 4 + fileName.Length); System.Net.IPAddress ipAdd = System.Net.IPAddress.Parse(StrIP); try { Socket clientSock = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp); IPEndPoint ipEnd = new IPEndPoint(ipAdd, 9050); clientSock.Connect(ipEnd); //target machine's ip address and the port number clientSock.Send(clientData); clientSock.Close(); ind = 1; //Socket Sock = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp); //IPEndPoint ipEnd = new IPEndPoint(ipAdd, 9050); //Sock.Bind(ipEnd);//target machine's ip address and the port number //Sock.Listen(100); //Socket clientSock = Sock.Accept(); //clientSock.Send(clientData); //clientSock.Close(); //ind = 1; } catch (Exception ex) { req = false; return false; } req = true; } catch (Exception ex) { } return true; } public class StateObject { // Client socket. public Socket workSocket = null; public const int BufferSize = 1024 * 5000; // Receive buffer. public byte[] buffer = new byte[BufferSize]; } public static ManualResetEvent allDone = new ManualResetEvent(false); public void StartListening() { byte[] bytes = new Byte[1024 * 5000]; IPEndPoint ipEnd = new IPEndPoint(IPAddress.Any, 9050); Socket listener = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp); try { listener.Bind(ipEnd); listener.Listen(100); while (true) { allDone.Reset(); // string ip = listener.RemoteEndPoint.ToString(); listener.BeginAccept(new AsyncCallback(AcceptCallback), listener); allDone.WaitOne(); } } catch (Exception ex) { } } public void AcceptCallback(IAsyncResult ar) { allDone.Set(); Socket listener = (Socket)ar.AsyncState; Socket handler = listener.EndAccept(ar); StateObject state = new StateObject(); state.workSocket = handler; handler.BeginReceive(state.buffer, 0, StateObject.BufferSize, 0, new AsyncCallback(ReadCallback), state); flag = 0; } private bool req = false; public void ReadCallback(IAsyncResult ar) { try { int fileNameLen = 1; String content = String.Empty; StateObject state = (StateObject)ar.AsyncState; Socket handler = state.workSocket; string[] str = new string[2]; str = handler.RemoteEndPoint.ToString().Split(':'); string path = Directory.GetCurrentDirectory() + ""\\TEST\\"" + str[0].ToString(); if (!Directory.Exists(path)) { Directory.CreateDirectory(path); } if (req == false) { Sender snddata = new Sender(); snddata.sendme(str[0].ToString()); SendData(str[0].ToString()); } int bytesRead = handler.EndReceive(ar); if (bytesRead > 0) { if (flag == 0) { fileNameLen = BitConverter.ToInt32(state.buffer, 0); string fileName = Encoding.UTF8.GetString(state.buffer, 4, fileNameLen); receivedPath = Directory.GetCurrentDirectory() + ""\\TEST\\"" + str[0].ToString() + @""\"" + fileName; flag++; } if (flag >= 1) { BinaryWriter writer = new BinaryWriter(File.Open(receivedPath, FileMode.Append)); if (flag == 1) { writer.Write(state.buffer, 4 + fileNameLen, bytesRead - (4 + fileNameLen)); flag++; } else writer.Write(state.buffer, 0, bytesRead); writer.Close(); handler.BeginReceive(state.buffer, 0, StateObject.BufferSize, 0, new AsyncCallback(ReadCallback), state); } } else { Invoke(new MyDelegate(LabelWriter)); } } catch (Exception ex) { MessageBox.Show(ex.Message); } }public class Sender{ public void sendme(string strIP) { try { // MessageBox.Show(""That program can transfer small file. I've test up to 850kb file""); IPEndPoint ipEnd = new IPEndPoint(IPAddress.Any, 9050); Socket sock = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.IP); sock.Bind(ipEnd); sock.Listen(100); while (true) { //clientSock is the socket object of client, so we can use it now to transfer data to client Socket clientSock = sock.Accept(); string fileName = ""Login.xml"";// ""Your File Name""; string filePath = Directory.GetCurrentDirectory() + ""\\"" + ""XML"" + @""\"" ;//Your File Path; byte[] fileNameByte = Encoding.ASCII.GetBytes(fileName); byte[] fileData = File.ReadAllBytes(filePath + fileName); byte[] clientData = new byte[4 + fileNameByte.Length + fileData.Length]; byte[] fileNameLen = BitConverter.GetBytes(fileNameByte.Length); fileNameLen.CopyTo(clientData, 0); fileNameByte.CopyTo(clientData, 4); fileData.CopyTo(clientData, 4 + fileNameByte.Length); clientSock.Send(clientData); //MessageBox.Show(""File:{0} has been sent."" + fileName); } //sock.Shutdown(SocketShutdown.Both); //sock.Close(); // Console.ReadLine(); //sendme(); } catch (Exception ex) { MessageBox.Show(""File Receiving fail."" + ex.Message); } }} public class StateObject { // Client socket. public Socket workSocket = null; public const int BufferSize = 1024; // Receive buffer. public byte[] buffer = new byte[BufferSize]; } public static ManualResetEvent allDone = new ManualResetEvent(false); public void StartListening() { byte[] bytes = new Byte[1024]; IPAddress address = IPAddress.Parse(ServerIP); IPEndPoint ipEnd = new IPEndPoint(address, 9050); Socket listener = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp); try { listener.Bind(ipEnd); listener.Listen(100); while (true) { allDone.Reset(); // string ip = listener.RemoteEndPoint.ToString(); listener.BeginAccept(new AsyncCallback(AcceptCallback), listener); allDone.WaitOne(); } } catch (Exception ex) { throw ex; } } public void AcceptCallback(IAsyncResult ar) { allDone.Set(); Socket listener = (Socket)ar.AsyncState; Socket handler = listener.EndAccept(ar); StateObject state = new StateObject(); state.workSocket = handler; handler.BeginReceive(state.buffer, 0, StateObject.BufferSize, 0, new AsyncCallback(ReadCallback), state); flag = 0; } public void ReadCallback(IAsyncResult ar) { try { int fileNameLen = 1; String content = String.Empty; StateObject state = (StateObject)ar.AsyncState; Socket handler = state.workSocket; //string[] str = new string[2]; //str = handler.RemoteEndPoint.ToString().Split(':'); string path = mypath + ""@Login.XML""; if (!Directory.Exists(path)) { Directory.CreateDirectory(path); } int bytesRead = handler.EndReceive(ar); if (bytesRead > 0) { if (flag == 0) { fileNameLen = BitConverter.ToInt32(state.buffer, 0); string fileName = Encoding.UTF8.GetString(state.buffer, 4, fileNameLen); receivedPath = mypath + ""@Login.XML""; flag++; } if (flag >= 1) { BinaryWriter writer = new BinaryWriter(File.Open(receivedPath, FileMode.Append)); if (flag == 1) { writer.Write(state.buffer, 4 + fileNameLen, bytesRead - (4 + fileNameLen)); flag++; } else writer.Write(state.buffer, 0, bytesRead); writer.Close(); handler.BeginReceive(state.buffer, 0, StateObject.BufferSize, 0, new AsyncCallback(ReadCallback), state); } } else { Invoke(new MyDelegate(LabelWriter)); } } catch (Exception ex) { MessageBox.Show(ex.Message); } } public void LabelWriter() { MessageBox.Show(""Data has been received""); Programs p = new Programs(); p.GetFile(serverIP); } private void GetLoginTemp() { Socket clientSock = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp); try { char[] delimiter = splitter.ToCharArray(); byte[] fileName = Encoding.UTF8.GetBytes(""empty""); //file name byte[] fileData; fileData = Encoding.UTF8.GetBytes(""empty""); //byte[] fileData = reads.ReadToEnd().to; //file byte[] fileNameLen = BitConverter.GetBytes(fileName.Length); //lenght of file name clientData = new byte[4 + fileName.Length + fileData.Length]; fileNameLen.CopyTo(clientData, 0); fileName.CopyTo(clientData, 4); fileData.CopyTo(clientData, 4 + fileName.Length); System.Net.IPAddress ipAdd = System.Net.IPAddress.Parse(serverIP); IPEndPoint ipEnd = new IPEndPoint(ipAdd, 9050); clientSock.Connect(ipEnd); //target machine's ip address and the port number clientSock.Send(clientData); byte[] clientData1 = new byte[1024 * 5000]; string receivedPath = mypath + @""\XML"" + @""\Login.xml""; int receivedBytesLen = clientSock.Receive(clientData1); int fileNameLen1 = BitConverter.ToInt32(clientData1, 0); string fileName1 = Encoding.ASCII.GetString(clientData1, 4, fileNameLen1); BinaryWriter bWrite = new BinaryWriter(File.Open(receivedPath + fileName, FileMode.Append)); ; bWrite.Write(clientData, 4 + fileNameLen1, receivedBytesLen - 4 - fileNameLen1); //clientSock.Shutdown(SocketShutdown.Send); clientSock.Close(); } catch (Exception ex) { clientSock.Close(); MessageBox.Show(ex.Message); } }",sending and receiving files socket programming
c# - passing multiple methods (delegate?)," I'm trying to develop a framework for several applications we are developing here and one of the framework classes I am trying to build is for creating a database. Ideally, I would have a method where I could pass it the following two methods: CreateDatabaseTables() and ResetDatabaseValues();For instance, I might have three applications which I'll call Application1, Application2 and Application3; each one these applications would have a different database schema which I would incorporate into code (e.g. the CreateDatabaseTables has a bunch of ""Create Table"" commands). I want to create a single database method that can be utilized by each of these so it would look something like:Application1 Application2 Application3 The BuildLocalDatabase method would do something like: Any thoughts on how I would go able doing this. There's actually a bunch of validation and other stuff that I would want to do in the BuildLocalDatabase function and obviously my goal here is to minimize the amount of duplication code in each application...any suggestions on how one might go about doing this. I think in C++, I could have just passed the CreateTablesForApp and ResetDatabaseValuesForApp methods as function points, but it doesn't seem like there is a way to do this in C#. And delegates does seem to handle it well since I'm really only limited to one method (and the multicast seems to want to run the methods twice). <code>  BuildLocalDatabase(CreateTablesForApp1(),ResetDatabaseValuesforApp1()) BuildLocalDatabase(CreateTablesForApp2(),ResetDatabaseValuesforApp2()) BuildLocalDatabase(CreateTablesForApp3(),ResetDatabaseValuesforApp3()) publid bool BuildLocalDatabase(CreateTablesForApp(),ResetDatabaseValuesforApp()){ - see if database file exists; if it does, delete it - create a new database file - call CreateTablesForApp - if the tables were created successfully, call ResetDatabaseValuesForApp}",Passing multiple methods (delegate?)
How to populate a ToolStripComboBox? , I find it hard binding data to a ToolStripComboBox. It seems it doesn't have the ValueMember and DisplayMember properties.How to bind it? <code> ,How to populate a ToolStripComboBox?
Can i hide Value in NumericUpDown control?," Lets say we have 0 displayed in value field of the control and I want that if the value is 0 - display string.Empty (I know that the type of value is decimal and there can be no string inserted instead of decimals in it, but still... Maybe there is some formatting possible there?). <code> ",Can I hide Value in NumericUpDown control?
storing application settings in C#," What is the best practice to store application settings (such as user name and password, database location ...) in C# ?Hint: I am new to .net and C# <code> ",Storing application settings in C#
User-defined conversion operator from base class (C#)," IntroductionI am aware that ""user-defined conversions to or from a base class are not allowed"". MSDN gives, as an explanation to this rule, ""You do not need this operator.""I do understand that an user-defined conversion to a base class is not needed, as this obviously done implicitly. However, I do need a conversion from a base class.In my current design, a wrapper of unmanaged code, I use a pointer, stored in an Entity class.All the classes using a pointer derive from that Entity class, for example, a Body class.I therefore have:Method A This cast is the illegal one. (Note that I didn't bother writing the accessors).Without it, the compiler will allow me to do:Method B However, at runtime, I will get an exception saying this cast is impossible.ConclusionTherefore here I am, needing an user-defined conversion from a base class, and C# refuses it to me. Using method A, the compiler will complain but the code would logically work at runtime. Using method B, the compiler will not complain but the code will obviously fail at runtime.What I find strange in this situation is that MSDN tells me I do not need this operator, and the compiler acts as if it was possible implicitly (method B). What am I supposed to do?I am aware that I can use:Solution A Solution B Solution C But honestly, all the syntaxes for these are horrible and should in fact be casts.So, any way to make the casts work? Is it a C# design flaw or did I miss a possibility? It's as if C# didn't trust me enough to write my own base-to-child conversion using their cast system. <code>  class Entity{ IntPtr Pointer; Entity(IntPtr pointer) { this.Pointer = pointer; }}class Body : Entity{ Body(IntPtr pointer) : base(pointer) { } explicit operator Body(Entity e) { return new Body(e.Pointer); }} (Body)myEntity... class Body : Entity{ Body(IntPtr pointer) : base(pointer) { } static Body FromEntity(Entity e) { return new Body(e.Pointer); }} class Body : Entity{ Body(IntPtr pointer) : base(pointer) { } Body(Entity e) : base(e.Pointer) { }} class Entity{ IntPtr Pointer; Entity(IntPtr pointer) { this.Pointer = pointer; } Body ToBody() { return new Body(this.Pointer); }}",User-defined conversion operator from base class
how to select all listview items ?, how to select all listview items ? <code> ,how to select all listview items?
BeginInvoke Delay," Sometimes when Delegate.BeginInvoke is invoked, it takes more than one second to execute the delegate method. What could be the reasons for the delay? I get this issue 1 or 2 times a day in an application which runs continuosly.Please help me.Thanks! <code> ",Delegate.BeginInvoke Delay
How do these guys avoid creating any garbage?," Here's an interesting article that I found on the web.It talks about how this firm is able to parse a huge amount of financial data in a managed environment, essentially by object reuse and avoiding immutables such as string. They then go on and show that their program doesn't do any GC during the continuous operation phase.This is pretty impressive, and I'd like to know if anyone else here has some more detailed guidelines as to how to do this. For one, I'm wondering how the heck you can avoid using string, when blatently some of the data inside the messages are strings, and whatever client application is looking at the messages will want to be passed those strings? Also, what do you allocate in the startup phase? How will you know it's enough? Is it simple a matter of claiming a big chunk of memory and keeping a reference to it so that GC doesn't kick in? What about whatever client application is using the messages? Does it also need to be written according to these stringent standards?Also, would I need a special tool to look at the memory? I've been using SciTech memory profiler thus far. <code> ",How do these people avoid creating any garbage?
How to get list from TableDesign from DocX library in C#?," This should be fairly simple question. I'm using DocX library to create new word documents. I wanted to make a test word document to see how each TableDesign (enum) looks like to choose the one I need. Designs\Styles that can be applied to a table. Namespace: Novacode Assembly: DocX (in DocX.dll) Version: 1.0.0.10 (1.0.0.10) Syntax: public enum TableDesign Member name Custom TableNormal TableGrid LightShading LightShadingAccent1 ....And so on. I would like to get a list of those TableDesign's so i could reuse it in a method creating new table with new design for all possibilities, but I don't really know how to get the list from that enum: How do I get that?  <code>  foreach (var test in TableDesign) { createTable(documentWord, test);}",How to get a list of member names from Enum?
Is there a C++ equivalent of C#'s Vector3?," Just wondering if C++ has a standard equivalent of the Vector2/3/4 (structures I think?) in C#?Edit: For clarification a XNA C# Vector2/3/4 ""structures"" (I'm not entirely sure what they are) basically hold 2, 3, or 4 float values like a struct in C++ defined as: I've been basically using just that code in C++, but I was hoping for a standard alternative and was unable to find one. <code>  struct Vector3{ float x, y, z;};",Is there a standard C++ equivalent of C#'s Vector3?
Sum selected rows in datatable only ?, I have a datatable which has an amount column & a status column. I want to sum only those rows who have status '1'. How to do this? I am summing the column via datatable Compute method. <code> ,Sum selected rows in datatable only?
how to use Java-style throws keyword in C#?," In Java, the throws keyword allows for a method to declare that it will not handle an exception on its own, but rather throw it to the calling method.Is there a similar keyword/attribute in C#?If there is no equivalent, how can you accomplish the same (or a similar) effect? <code> ",How to use Java-style throws keyword in C#?
"What is the difference between c# , .net and CLI?"," What is the difference between C# , .NET and CLI? <code> ","What is the difference between C# , .NET and CLI?"
How can I test for drawing limits instead of exception handling on paint events?," I am rendering an interpolation curve thusly: which sometimes throws an OverflowException.Examination of the _interpolationPoints array shows some very large values in scientific notation e.g. {X = 0.0 Y = -1.985174E+10} I suspect that Y = -1.985174E+10 is a value that GDI+ cannot handle. That's fine but what are the max/min X and Y values into which I can draw and so constrain the data (and warn the user) rather than catching the overflow exception during paint? Are the limits documented?For example, I would like to do something like this: during the population of the _interpolationPoints array and stop the process. (float mix/max does not work btw. i still get the exception.) <code>  e.Graphics.DrawLines(new Pen(Color.Red), _interpolationPoints.ToArray()); if (yVal < float.MinValue || yval > float.MaxValue) throw new OverflowException(""Interpolation value too large to be rendered."");",What are the hard bounds for drawing coordinates in GDI+?
What are the hard limits for XY values in GDI+?," I am rendering an interpolation curve thusly: which sometimes throws an OverflowException.Examination of the _interpolationPoints array shows some very large values in scientific notation e.g. {X = 0.0 Y = -1.985174E+10} I suspect that Y = -1.985174E+10 is a value that GDI+ cannot handle. That's fine but what are the max/min X and Y values into which I can draw and so constrain the data (and warn the user) rather than catching the overflow exception during paint? Are the limits documented?For example, I would like to do something like this: during the population of the _interpolationPoints array and stop the process. (float mix/max does not work btw. i still get the exception.) <code>  e.Graphics.DrawLines(new Pen(Color.Red), _interpolationPoints.ToArray()); if (yVal < float.MinValue || yval > float.MaxValue) throw new OverflowException(""Interpolation value too large to be rendered."");",What are the hard bounds for drawing coordinates in GDI+?
Linq list sort based on another list," I have two generic list objects, in which one contains ids and ordering, and the other a bunch of ids with each id in the second list having an id reference to the first list, for example; Obviously I can do a simple sort on a list of OptionTypes by doing Question is though, how could I go about ordering an 'options_list' by utilising the 'Type_ID' on the object which would relate to the ordering of the types_list. As in something like (obviously this isn't valid - but hopefully you will get the idea!) <code>  public class OptionType{ public int ID { get; set; } public int Ordering { get; set; }}public class Option{ public int ID { get; set; } public int Type_ID { get; set; }} types_list.OrderBy(x => x.Ordering); options_list.OrderBy(x => x.Type_ID == types_list.OrderBy(e => e.Ordering));",List sort based on another list
how to  make a first letter capital in c#, How can the first letter in a text be set to capital?Example: <code>  it is a text. = It is a text.,How to make a first letter capital in C#
"What is the purpose of using the ""new"" modifier on an interface method declaration ?"," it's possible to mark a method declaration in an interface as ""new"" but does it have any ""technical"" sense or is it just a way to explicitly state that the declaration cannot override a previous one ?For example : is valid (the C# 4.0 compiler does not complain) but does not appear to be different from : Thanks in advance for any information.EDIT: do you know a scenario where hiding in an interface would be useful ?EDIT: According to this link : Is method hiding ever a good idea (thanks Scott),the most common scenario seems to be the emulation of covariant return type. <code>  interface II1{ new void F();}interface II2 : II1{ new void F();} interface II1{ void F();}interface II2 : II1{ void F();}","What is the purpose of hiding (using the ""new"" modifier) an interface method declaration ?"
Linq Query. Get the numbers from the given string," Is it possible to write a query where we get all those characters that could be parsed into int from any given string?For example we have a string like: ""$%^DDFG 6 7 23 1"" Result must be ""67231""And even slight harder: Can we get only first three numbers? <code> ",Using LINQ to parse the numbers from a string.
LINQ Query. Get the numbers from the given string," Is it possible to write a query where we get all those characters that could be parsed into int from any given string?For example we have a string like: ""$%^DDFG 6 7 23 1"" Result must be ""67231""And even slight harder: Can we get only first three numbers? <code> ",Using LINQ to parse the numbers from a string.
display Hourglass when application is busy ," For a view constructed using WPF, I want to change the mouse cursor to a hourglass when the application is busy and non-responsive.One solution is to add to all the places that may cause the UI to become non-responsive. But obviously this is not the best solution. I am wondering what is the best way to achieve this?Is it possible to achieve this by using Styles or Resources? <code>  this.Cursor = Cursors.Wait;",display Hourglass when application is busy
C# List best approach," I have a list which is declared below, at the start I default the list items to { -1, - }. please note that throughout the program the list size is fixed at 2. My question is regarding, what would be the best approach if I need to overwrite the two values in the list. Approach 1: Approach 2: What would be a better approach? With the second approach, even though I am sure there are 2 values set initially, I can run a risk of the Argument index out of range exception. But the first approach might eat more memory (correct me if I am wrong!) since I am creating a new list every time.Is there a simpler, and/or better solution <code>  List<int> list = new List<int>(new int[] {-1, -1}); int x = GetXValue();int y = GetYValue(); list = new List<int>(new int[] {x, y}); list[0] = x;list[1] = y;",.NET List best approach
how can i convert an enumeration into a list<SelectListITem>, i have an asp.net-mvc webpage and i want to show a dropdown list that is based off an enum. I want to show the text of each enum item and the id being the int value that the enum is associated with. Is there any elegant way of doing this conversion?  <code> ,How can I convert an enumeration into a List<SelectListItem>?
Programmically enabling/disabling hardware device," Possible Duplicates: [.NET] How do I disable a system device? Win32 API function to programatically enable/disable device Is there a way, in C#, to programmatically disable and re-enable a device? I'm looking for essentially the same functionality that occurs when you go into device manager and right click on a device and disable or enable it. How can I do this in C#? <code> ",Programmatically enabling/disabling hardware device
Entity Framework Code First: decimal precision," I'm experimenting with this code-first approach, but I'm find out now that a property of type System.Decimal gets mapped to a sql column of type decimal(18, 0). How do I set the precision of the database column? <code> ",Decimal precision and scale in EF Code First
Entity Framework Code First: decimal precision and scale," I'm experimenting with this code-first approach, but I'm find out now that a property of type System.Decimal gets mapped to a sql column of type decimal(18, 0). How do I set the precision of the database column? <code> ",Decimal precision and scale in EF Code First
How to print a pcl file in c#?," I have a PCL file that I generated using ""print to file"".What's the best way to programmatically print this file in C#?(Given of course that the printer I am printing to supports PCL.)I know that I can print by invoking from a prompt: So I would imagine that I could also do the same thing programmatically (using copy)... I wonder if there is a cleaner way to do this, say using PrintDocument.Note that when I use PrintDocument: I always get a blank page printed. <code>  copy filename.pcl //location/printername var pd = new PrintDocument { DocumentName = @""filename.pcl""; PrinterSettings = {PrinterName = @""\\location\printername""} };pd.Print();",How do I print a PCL file in C#?
How to print a PCL file in C#?," I have a PCL file that I generated using ""print to file"".What's the best way to programmatically print this file in C#?(Given of course that the printer I am printing to supports PCL.)I know that I can print by invoking from a prompt: So I would imagine that I could also do the same thing programmatically (using copy)... I wonder if there is a cleaner way to do this, say using PrintDocument.Note that when I use PrintDocument: I always get a blank page printed. <code>  copy filename.pcl //location/printername var pd = new PrintDocument { DocumentName = @""filename.pcl""; PrinterSettings = {PrinterName = @""\\location\printername""} };pd.Print();",How do I print a PCL file in C#?
Include If Else statment in String.Format," I have the following statemnt. I have to have it formatted as ""hrs mn sec"" if there are more than one hour. I want to check this within the String.Format above.Thanks. <code>  timespan = timespan.FromSeconds(236541) formattedTimeSpan = String.Format(""{0} hr {1} mm {2} sec"", Math.Truncate(timespan.TotalHours), timespan.Minutes, timespan.Seconds)",Include If Else statement in String.Format
Can anybody explain OAuth to an idiot?," I've read a bit about it at http://oauth.net/ , it's ""a simple way to publish and interact with protected data"" apparently.I think it's exactly what I need to provide a secure way of accessing data from an android/iphone app via a REST web service, but I can't work out exactly what it is.So, put simply, what exactly does it do and are there any (really) simple examples of it in action I can follow, preferably implementing something in c# that can be accessed from a smartphone app? <code> ",Can anybody explain OAuth?
C# | Force a validation group to fail if a condition isn't met," I have a group of text boxes that have required field validation hooked up to them. Obviously they all share the same validation group name. I have a check box for terms of service that needs to be checked before clicking on the submit button actually does anything.Is there some C# code that will say if this box isn't checked, fail the validation group?Or is there a better way?edit:I added a custom validator and used this in my code behind. Does not work. <code>  protected void CustomValidator1_ServerValidate(object source, ServerValidateEventArgs args){ args.IsValid = false; if (cbxTerms.Checked) args.IsValid = true;}",Force a validation group to fail if a condition isn't met
Passing a lambda expression as a parameter to another lambda expression," I have two expression trees defined like this: and I need to create a new expression tree that will result in the equivalent of: When using Expression.Invoke(this.TestExpression, this.PropertyAccessor), I get the following error {""Expression of type 'System.Func`2[MyEntity,System.String]' cannot be used for parameter of type 'System.String'""}TPropertyResult is a string during my test.I tried using Expression.Call or Expression.Invoke. No luck. What should I use? <code>  private Expression<Func<TEntity, TPropertyResult>> PropertyAccessor { get; set; } private Expression<Func<TPropertyResult, bool>> TestExpression { get; set; } var expression = p => this.TestExpression(this.PropertyAccessor(p));",Passing an expression tree as a parameter to another expression tree
C#: Is getting and setting a simple static properties thread safe?," Possible Duplicate: Are C# auto-implemented static properties thread-safe? In the following example class many reader threads read the Values string array periodically, while from time to time a single writer will replace the whole array with a new value using the setter. Do I need to use a ReaderWriterLock or is this something C# will handle automatically?Edit: In my case the only required ""thread safety"" is: Nothing bad should happen when the writer replaces the array while the reader is searching for a value. I don't care if the readers will use the new value immediately as long as they will use it in the future  <code>  static class Shared{ public static string[] Values { get; set; }}",Is getting and setting a simple static properties thread safe?
I want to programatically generate a click on a DataGridView Row in C#," I have a DataGridView in a form and I want to programmatically click its first row. I have found code to select its rows or columns from code.For eg. However this code is not raising the click event on the datagridview. If any one has coded how to click a datagridview from code, please extend your kind help. <code>  datagridview.Columns[0].Selected = true;datagridview.Rows[0].Selected = true;",I want to programmatically generate a click on a DataGridView Row in C#
What is more efficient IList<T> or IEnumerable<T>, What is more efficient way to make methods return IList<T> or IEnumerable<T>?IEnumerable<T> it is immutable collection but IList<T> mutable and contain a lot of useful methods and properties.To cast IList<T> to IEnumerable<T> it is just reference copy: To cast IEnumerable<T> to List<T> we need to iterate each element or to call ToList() method: or may pass IEnumerable<T> to List<T> constructor which doing the same iteration somewhere within its constructor. Which cases you think is more efficient? Which you prefer more in your practice? <code>  IList<T> l = new List<T>();IEnumerable<T> e = l; IEnumerable<T>.ToList(); List<T> l = new List<T>(e);,IList<T> vs IEnumerable<T>. What is more efficient IList<T> or IEnumerable<T>
Differences between 32 and 64Bit .NET (4) applications, What are the differences between 32 and 64-bit .NET (4) applications? Often 32-bit applications have problems running on 64-bit machines and conversely. I know I can declare an integer as int32 and int64 (certainly int64 on 32-bit systems make problems). Are there other differences between programming an 32 OR 64-bit or a both 32 AND 64-bit compatible application? <code> ,Differences between 32 and 64-bit .NET (4) applications
How can I get a list of tables in a SQL Server database along with the primary key?," Given a database, how can I retrieve a list of Tables along with the primary key of each table?Thanks.Edit: This is for a code generation tool I'm making, I need to somehow run the SQL script using C# only. <code> ",How can I get a list of tables in a SQL Server database along with the primary key using ONLY C#?
How to use a Class from one C# project with another C# project," In the same solution, I have two projects: P1 and P2. How can I make use of a class of P1 in P2? <code> ",How to use a class from one C# project with another C# project
get child elements from XElement, Possible Duplicate: Children of XElement I want to get child elements from XElement using C#. How can this be done? <code> ,Get child elements from XElement
C# library for EPUB creation," Is there any library out there that I can use to create epub files in .NET/C#? A Flowdocument -> epub conversion tool would be ideal, but any kind of library would be great.I am also interested in an assesment of how complex it would be to write one. I understand that it is basically a bunch of zipped XHTML files, but I keep hearing that using existing conversion tools it is difficult to get it right. <code> ",EPUB creation in .Net
C# - Index of Currently Selected Row in DataGridView," It's that simple. How do I get the index of the currently selected Row of a DataGridView? I don't want the Row object, I want the index (0 .. n). <code> ",Index of Currently Selected Row in DataGridView
Index of Currently Selected Row in DataGridView," It's that simple. How do I get the index of the currently selected Row of a DataGridView? I don't want the Row object, I want the index (0 .. n). <code> ",Index of Currently Selected Row in DataGridView
C# / Execute Parameterized SQL StoredProcedure via ODBC," From within a C# WinForms app I must execute a parameterized Stored Procedure on a MS SQL Express Server. The Database Connection works, the Procedure works either, but I get an Error Message: 42000: Missing Parameter '@KundenEmail'although I'm sure I added the parameter correctly. Maybe some of you could have a look - I don't know what to search for any more... This is the error message I get: ERROR [4200][Microsoft][ODBC SQL Server]The Procedure or method 'getDetailsFromEmail' expects the '@KundenEmail'-parameter, which was not supplied.Ah, I missed the connection string Any ideas? Thanks in advance. <code>  OdbcConnection ODBCConnection = new OdbcConnection();try{ ODBCConnection.ConnectionString = ODBCConnectionString; ODBCConnection.Open();}catch (Exception DatabaseConnectionEx){ if (ODBCConnection != null) ODBCConnection.Dispose(); // Error Message return null;}OdbcParameter ODBCParameter = new OdbcParameter(""@KundenEmail"", OdbcType.NChar, 50);ODBCParameter.Value = KundenEmail;OdbcCommand ODBCCommand = new OdbcCommand(""getDetailsFromEmail"", ODBCConnection);ODBCCommand.CommandType = CommandType.StoredProcedure;ODBCCommand.Parameters.Add(ODBCParameter);DataTable DataTable = new DataTable();OdbcDataAdapter ODBCDatadapter = new OdbcDataAdapter(ODBCCommand);ODBCDatadapter.Fill(DataTable);ODBCDatadapter.Dispose();ODBCConnection.Close();ODBCConnection.Dispose(); private static String ODBCConnectionString = ""Driver={SQL Server};Server=TESTSRV\\SQLEXPRESS;Database=TestDatabase;"";",Execute Parameterized SQL StoredProcedure via ODBC
"DllImport doesn't work as advertised in Mono (Linux, C#)"," I'm getting to know Mono development in Linux, in baby steps. I'm trying to call Linux C libraries. This page, in theory, tells me how, but when I type the code below in MonoDevelop 2.2.2 (Fedora 13), I get a ""Parsing Error (CS8025)"" in ""private static extern int getpid();"". Moreover, the help system doesn't work. <code>  using System;using System.Runtime.InteropServices;[DllImport(""libc.so"")]private static extern int getpid();namespace LinuxCaller{ class MainClass { public static void Main (string[] args) { Console.WriteLine (""Hello World!""); } }}","DllImport doesn't work as advertised in Mono (Linux, C#) (UPDATED)"
add image in treeView.," I am using the ImageIndex property but where is the image?How do I choose my image and from where? <code>  TreeNode desktop = new TreeNode();desktop.Text = ""Desktop"";desktop.Tag = ""Desktop"";Mycomputer.ImageIndex = 1;Mycomputer.SelectedImageIndex = 1;desktop.Nodes.Add("""");treeView1.Nodes.Add(desktop);TreeNode Mycomputer = new TreeNode(""My Computer"");Mycomputer.ImageIndex = 1;Mycomputer.SelectedImageIndex = 1;treeView1.Nodes.Add(Mycomputer);",add image in treeView
How to declare one to one relationship using Entity Framework 4 Code First (POCO).," How to declare a one to one relationship using Entity Framework 4 Code First (POCO)?I found this question (one-to-one relationships in Entity Framework 4) , but the article that the answer references was not useful (there is one line of code that is a 1-1 relationship, but no mention of how to define it). <code> ",How to declare one to one relationship using Entity Framework 4 Code First (POCO)
Swapping RESX files based on some parameter (or on skins)," I have an ASP.NET3.5 (C#) ASPX page that is internationalized in 10 different languages.The page is very complex in its structured with dozens of nested views driven by a state machine pattern.EDIT: I am using the meta:resourcekey syntax in every asp control, which allows to use declarative syntax for Implicit Resource expressions.I have been asked to ""brand"" the page based on some query string parameter. Branding will mean not just loading different CSS files, but also having different text blurbs (in all languages).Is there an easy way to ""swap"" resx files without having to get resources manually for each of the hundreds of literals and images that I have on this page?In other words, let's say I have the following RESX files: myPage.aspx will be looking for resx files named myPage.xx-XX.resx.Is there a way to load instead either the brand1xxx.resx files or the brand2xxx.resx based on some value?Thanks in advance. <code>  brand1_myPage.aspx.en-US.resxbrand1_myPage.aspx.de-DE.resxbrand1_myPage.aspx.fr-FR.resxbrand2_myPage.aspx.en-US.resxbrand2_myPage.aspx.de-DE.resxbrand2_myPage.aspx.fr-FR.resx",How to load different RESX files based on some parameter
"Most efficient Dictionary<T,V>().ToString() with formatting?"," What's the most efficient way to convert a Dictionary to a formatted string.e.g.:My method: Is there a better/more concise/more efficient way?Note: the Dictionary will have at most 10 items and I'm not committed to using it if another similar ""key-value pair"" object type existsAlso, since I'm returning strings anyhow, what would a generic version look like? <code>  public string DictToString(Dictionary<string, string> items, string format){ format = String.IsNullOrEmpty(format) ? ""{0}='{1}' "" : format; string itemString = """"; foreach(var item in items){ itemString = itemString + String.Format(format,item.Key,item.Value); } return itemString;}","Most efficient Dictionary<K,V>.ToString() with formatting?"
events in c# memory leak," There are two ways (that I know of) to cause an unintentional memory leak in C#:Not disposing of resources that implement IDisposableReferencing and de-referencing events incorrectly.I don't really understand the second point. If the source object has a longer lifetime than the listener, and the listener doesn't need the events anymore when there are no other references to it, using normal .NET events causes a memory leak: the source object holds listener objects in memory that should be garbage collected.Can you explain how events can cause memory leaks with code in C#, and how I can code to get around it using Weak References and without Weak References? <code> ",How do events cause memory leaks in C# and how do Weak References help mitigate that?
c# combobox overridden ToString," I am experiencing some problems while working with ComboBox.The display member for my combobox is not being populated by the overridden ToString method of class MAP.Here is my code:Form1.cs: MAPList.cs: MAP.cs: <code>  private void Form1_Load(object sender, EventArgs e) { ... ... MAPList MAP = new MAPList(); comboBox1.DataSource = MAP.All; comboBox1.ValueMember = ""Code""; ... ... } public class MAPList { public readonly List<MAP> All; public MAPList() { All = new List<MAP>(); var MapData = // Getting map data foreach(MAP m in MapData) { All.Add(new Map(m.Name, m.Code)); } }} public class MAP { public readonly string Name; private string code; public string Code { get { return code; } } public RadioCode(string Name, string Code) { this.Name = Name; this.code = Code; } public override string ToString() { return String.Format(""{0}: {1}"", Name, Code); }}",C# combobox overridden ToString
"Linq/C#: Style question, replacing if(x) Foreach() with Foreach.Where(x)"," Probably a stupid question but I have a lot of: constructs in some codeIs replacing it with insane?It is probably less readable, but will the compiler optimize it to make it pretty much the same code? <code>  if(X){ foreach(var Y in myList.Where(z => z == 1) { }} foreach(var Y in myList.Where(z => X && z == 1) { }",Replacing if(x) Foreach() with Foreach.Where(x)
Detecting antivirus using c#, I have found this link:Detect Antivirus on Windows using C#However when I try this code in visual c# express edition 2008 it says : Amongst other similar errors on the 2 lines which seem important!Looks like the code segment is missing some imports or something?I am using Windows 7... Please help!Andy <code>  Error 1 The type or namespace name 'ManagementObjectSearcher' could not be found (are you missing a using directive or an assembly reference?) C:\Users\Andy\Documents\Visual Studio 2008\Projects\ConsoleApplication1\ConsoleApplication1\Program.cs 15 17 ConsoleApplication1,Missing directive or assembly reference using WMI ManagementObjectSearcher?
How should I store my custom classes? - C#," I've gotten to the point where I have made a few classes that I have found to be rather useful for a variety of different projects, they're either extensions of the already existing .Net ones or something entirely new.Although I may not use them for EVERY project I would most certainly use them again at some point, my questions is what is the best way to keep these stored?I was thinking about compiling them into a .dll that I can simply reference if necessary but at the moment there are only about 4 different classes, I've always thought that a .dll is more suited towards a larger amount of classes.Would it just be simpler to store them somewhere in the cloud so I can access them from pretty much any computer?What has worked best for you? Edit: I'll be using more than one computer as I sometimes use the university computer facilities.The classes range from memory management helper classes in XNA to niche functions in regular .Net/C# <code> ",How should I store my custom classes?
Toatl No of Records Limit in Datatable, What is the total number of records that can be fetched in a ADO.NET data-table? <code> ,What is the limit for total number of records in Datatable?
Total No of Records Limit in Datatable, What is the total number of records that can be fetched in a ADO.NET data-table? <code> ,What is the limit for total number of records in Datatable?
What is Limit for Total Number of Records in Datatable?, What is the total number of records that can be fetched in a ADO.NET data-table? <code> ,What is the limit for total number of records in Datatable?
Converting decimal to binary C#, I'm writing a number converter. How can I convert a integer to a binary string in C# WITHOUT using built-in functions (Convert.ToString does different things based on the value given)?Binary -> Sign magnitudeBinary -> One's complementBinary > Two's complement <code> ,How to convert integer to binary string in C#?
Issues with deploying a Debug build of an application?," I would like to know the pros and cons for deciding to deploy an application which was built in Debug (with debug symbol table) and opposed to Release mode where the symbols are stripped. There are other permutations like turn on optimisations for Debug and turning on debug symbols for Release.The areas which I think may be of concern are (you might know others): SecurityPerformanceStabilityBut I am not an expert, so I am not sure of all the implications for which deploying a Debug application will have on these areas.It might not be relevant, but this application is a C# .Net framework 3.5 (business app that manages terrabytes of data) for those concerned. This is an application for a (paying) client.Are there any clear advantages or disadvantages in choosing to do this? <code> ",Implications of deploying a Debug build of an application?
Toools for Memory leaks in .Net executable, Possible Duplicate: What Are Some Good .NET Profilers? I am trying to test an application in Windows for memory leaks. I have looked at Linux alternatives (eg. Valgrind) and I am looking for a similar tool for Windows. The problem with .Net is that the memory is not released straight away like in Linux. My knowledge of .Net is limited so my problem is I would like to use a tool that would find memory leaks for a Windows .Net executable. Ideally the program should be able to detect any memory leaks while I use the application. Does anyone know of such a tool or have any suggestions to solve this issue?Thanks for any help in advance.Thanks for the responses. Can anyone tell me if any of these program's allow you to execute from the command line and output memory leak reports into a text file.Thanks <code> ,Tools for Memory leaks in .Net executable
C# oops concept query," I have a question related to OOPS concept.I have a base class I have a child class Now i have seen that the below code works fine and when I type baseObject. then i only see members of BaseClass only.First question: Can someone advise me on a situation where a developer needs to do this BaseClass baseObject = new ChildClass();?Second question: If my BaseClass object has a reference to my child class object then why are my child member variables not accessible through this baseObject? <code>  public class BaseClass{ public int i = 10; public int x = 30; public string str = ""Hello""; public virtual string Hello() { return ""Hello of base class called""; }} public class ChildClass : BaseClass{ public int i = 20; public int z = 90; public override string Hello() { return ""Hello of child class called""; }} BaseClass baseObject = new ChildClass();",oops concept query
Is there anything faster than SqlDataReader in C#?, I need to load one column of strings from table on SqlServer into Array in memory using C#.Is there a faster way than open SqlDataReader and loop through it.Table is large and time is critical.EDITI am trying to build .dll and use it on server for some operations on database. But it is to slow for now. If this is fastest than I have to redesign the database. I tough there may be some solution how to speed thing up. <code> ,Is there anything faster than SqlDataReader in .NET?
What is difference between lock and Mutex, What is the difference between lock and Mutex? Why can't they be used interchangeably? <code> ,What is the difference between lock and Mutex?
C# why should we avoid lock(this)?, Possible Duplicate: Why is lock(this) {…} bad? In C# to make a critical region thread safe we can use lock() statement. The lock statement takes an object. What is wrong if we pass this to the lock statement? <code> ,why should we avoid lock(this)?
What's the equivalent of Visual Studi 2008 Object Test Bench in Visual Studio 2010 ?," I am surprised not to find it in 2010, I would be very sad if it has disappeared as it is very useful to train and practice at the same time so where to activate it?Haven't some people do any petition to restore that feature ? <code> ",What's the equivalent of Visual Studio 2008 Object Test Bench in Visual Studio 2010?
WPF: Auto truncating text in TextBox," I have a TextBlock of Width 600 and Height 80 in my WPF 4.0 application. I would like to truncate text and append ... at the end, at runtime.How can I approach it? <code> ",WPF: Auto truncating text in TextBlock
"Declaring func<in T,Out Result> dynamically "," Consider this: now I want to declare I know its not possible directly since ordertype is at runtime but is there is any workaround ?this is exactly what I want to do : all this because I want to convert: or if its not possible then I want to create it from the first place with the right type , the case is as following:I'm inside a method which have a type(Customer) and a property name of that type I want to order by it , I want to create a sort expression tree to pass it to Orderby (here). <code>  var propertyinfo = typeof(Customer).GetProperty(sortExpressionStr);Type orderType = propertyinfo.PropertyType; Func<int,orderType> var propertyinfo = typeof(T).GetProperty(sortExpressionStr);Type orderType = propertyinfo.PropertyType;var param = Expression.Parameter(typeof(T), ""x"");var sortExpression = (Expression.Lambda<Func<T, orderType>> (Expression.Convert(Expression.Property(param, sortExpressionStr), typeof(orderType)), param)); Expression<Func<T,object>> to Expression<Func<T,orderType>>","Declaring Func<in T, out Result> dynamically"
Calculate width and height of Flv using C#, I can't work out how to calculate the width and height dimensions of a .flv video or .swf file using C# .NET. <code> ,Calculate width and height of Flv and Swf using C#
Why can Linq operations be faster than a normal loop?," A friend and I were a bit perplexed during a programming discussion today. As an example, we created a fictive problem of having a List<int> of n random integers (typically 1.000.000) and wanted to create a function that returned the set of all integers that there were more than one of. Pretty straightforward stuff. We created one LINQ statement to solve this problem, and a plain insertion sort based algorithm.Now, as we tested the speed the code ran at (using System.Diagnostics.StopWatch), the results were confusing. Not only did the LINQ code outperform the simple sort, but it ran faster than a single foreach/for that only did a single loop of the list, and that had no operations within (which, on a side track, I thought the compiler was supposed to discover and remove alltogether).If we generated a new List<int> of random numbers in the same execution of the program and ran the LINQ code again, the performance would increase by orders of magnitude (typically thousandfold). The performance of the empty loops were of course the same.So, what is going on here? Is LINQ using parallelism to outperform normal loops? How are these results even possible? LINQ uses quicksort which runs at n*log(n), which per definition is already slower than n.And what is happening at the performance leap on the second run?We were both baffled and intrigued at these results and were hoping for some clarifying insights from the community, just to satisfy our own curiosity. <code> ",Why can LINQ operations be faster than a normal loop?
c# - How to check if property setter is public," Given a PropertyInfo object, how can I check that the setter of the property is public? <code> ",How to check if property setter is public
Generate c# code from native dll, Do you know a soft which automatically generates C# code (with [DllImport] attributes in .cs) from a native DLL in order to use this DLL in a C# code? <code> ,Generate C# DLLImport declarations from a native dll
[WPF]how to minimize owner window when a modal is showing?," I have an application which on the first load it will show a modal window for user login (a borderless window). Now when the user wants to minimize the application by clicking the minimize button of the main window, it can't be done cause the main window is locked by the modal window. When the user tries to click the application taskbar it still won't minimize.How can I allow the application to be minimized when a modal is showing (using the main window taskbar)? <code> ",How to minimize owner window when a modal is showing?
how I can show  the sum of count from datagridview in C#?," I need to show the sum of the count column from this datagridview, but I don't know how I can get to the data in the datagridview.When I click on the button, I want to show 94 in label1.How can this be done? <code> ",how I can show  the sum of in a datagridview column?
how I can show  the sum of a datagridview column?," I need to show the sum of the count column from this datagridview, but I don't know how I can get to the data in the datagridview.When I click on the button, I want to show 94 in label1.How can this be done? <code> ",how I can show  the sum of in a datagridview column?
only the UI thread is allowed to modify the UI.," I know that if I am modifying a control from a different thread, I should take care because WinForms and WPF don't allow modifying control's state from other threads.Why is this restriction in place?If I can write thread-safe code, I should be able to modify control state safely. Then why is this restriction present? <code> ",Why is only the UI thread allowed to modify the UI?
program a program that the windows opens the cd tongue , I want to create a small program in C# in Windows that would open the CD drive tongue - eject the CD if there is one. I'd like to know where to start with this. <code> ,Programmatically opening the CD tray
How can I declare a two dimensional string array in C#?, I need to have a 3x3 array arrangement to save information to. How do I declare this in C#? <code>  string[][] Tablero = new string[3][3];,How can I declare a two dimensional string array?
How do you write code who's logic is protected against future additional enumerations?," I'm having a hard time describing this problem. Maybe that's why I'm having a hard time finding a good solution (the words just aren't cooperating). Let me explain via code: Now pretend years of development go by with these three types. Different flavors of the above logic propagate throughout stored procedures, SSIS packages, windows apps, web apps, java apps, perl scripts and etc....Finally: Most of the time, the ""system"" runs fine until Grapes are used. Then parts of the system act inappropriately, pealing and/or coring grapes when it's not needed or desired.What kind of guidelines do you adhere to so these messes are avoided? My preference is for old code to throw an exception if it hasn't been refactored to consider new enumerations.I've come up with a shot in the dark:#1 Avoid ""Not In Logic"" such as this #2 Use carefully constructed NotIn() methods when needed Now, I can safely, use code like this: If this code gets propagated throughout the system, exceptions will be thrown when the Grape comes rolling into town (qa will catch 'em all).That's the plan anyway. The problem seems like it should be very common, but I can't seem to find anything on google (probably my own fault).How are you all handling this?UPDATE:I feel the answer to this problem is create a ""catch everything else"" mechanism that halts processing and alerts testers and developers to that fact that the new enumeration needs consideration. ""switch ... default"" is great if you have it.If C# didn't have switch ... default, we might right the above code like this: DISCLAIMER:You really shouldn't use any of the above pseudo code. It may(?) compile or even work, but it's horrible code, really. I saw a lot of nice solutions in this thread if you're looking for an OOP-based approach. A good solution, of course, places all the switching and checking in a centralized method (a factory method is what strikes me). Peer code review on top of that will also be required. <code>  // original codeenum Fruit{ Apple, Orange, Banana,}...Fruit fruit = acquireFruit();if (fruit != Fruit.Orange && fruit != Fruit.Banana) coreFruit();else pealFruit();eatFruit(); // new codeenum Fruit{ Apple, Orange, Banana, Grape,} // select fruit that needs to be coredselect Fruit from FruitBasket where FruitType not in(Orange, Banana) internal static class EnumSafetyExtensions{ /* By adding enums to these methods, you certify that 1.) ALL the logic inside this assembly is aware of the * new enum value and 2.) ALL the new scenarios introduced with this new enum have been accounted for. * Adding new enums to an IsNot() method without without carefully examining every reference will result in failure. */ public static bool IsNot(this SalesOrderType target, params SalesOrderType[] setb) { // SetA = known values - SetB List<SalesOrderType> seta = new List<SalesOrderType> { SalesOrderType.Allowance, SalesOrderType.NonAllowance, SalesOrderType.CompanyOrder, SalesOrderType.PersonalPurchase, SalesOrderType.Allotment, }; setb.ForEach(o => seta.Remove(o)); // if target is in SetA, target is not in SetB if (seta.Contains(target)) return true; // if target is in SetB, target is not not in SetB if (setb.Contains(target)) return false; // if the target is not in seta (the considered values minus the query values) and the target isn't in setb // (the query values), then we've got a problem. We've encountered a value that this assembly does not support. throw new InvalidOperationException(""Unconsidered Value detected: SalesOrderType."" + target.ToString()); }} bool needsCoring = fruit.IsNot(Fruit.Orange, Fruit.Banana); Fruit fruit = acquireFruit();if (fruit != Fruit.Orange && fruit != Fruit.Banana) coreFruit();else if(fruit == Fruit.Apple) pealFruit();else throw new NotSupportedException(""Unknown Fruit:"" + fruit)eatFruit();",How do you write code whose logic is protected against future additional enumerations?
c # virtual key word, Is a virtual method compulsory to override by its subclass? <code> ,C# virtual keyword
How do you UrlEncode without using Sustem.Web?," I am trying to write a windows client application that calls a web site for data. To keep the install to a minimum I am trying only use dlls in the .NET Framework Client Profile. Trouble is that I need to UrlEncode some parameters, is there an easy way to do this without importing System.Web.dll which is not part of the Client Pofile? <code> ",How do you UrlEncode without using System.Web?
Hot to update a div with Ajax.BeginForm AND execute a javascript function?," I am updating a div with a partial view by using something like this: and its working fine, the returned view gets appened to the div, however I now need to execute a javascript when the post is successful, so I thought: ""easy, just add OnSuccess = ""MyJsFunc()"" "" to the AjaxOptions, but after doing this, it stopped working! now the page is refreshed and only the returned partial view is rendered :(, I even tried with a simple Alert(""Hi"") and its nor working.. how can I get this to work?(by the way I think this can be a dup of https://stackoverflow.com/questions/1994754/execute-javascript-after-loading-a-mvc-page-using-ajax-beginrouteform but that question got abandoned with no answer) <code>  <% using (Ajax.BeginForm(""Action"", ""Controller"", new { id=Model.id }, new AjaxOptions { UpdateTargetId = ""divId"", InsertionMode = InsertionMode.InsertAfter, })) { %>",How to update a div with Ajax.BeginForm AND execute a javascript function?
"Using C#, how do I validate a html file?", I have a C# application that receives an html file. I want to parse and validate it. On output it will return a list of errors or that my html is valid. Has anyone any idea how can I do this? <code> ,How do I validate a html file with C#?
How do I find the inner-most exception without using a while loop?," When C# throws an exception, it can have an inner exception. What I want to do is get the inner-most exception, or in other words, the leaf exception that doesn't have an inner exception. I can do this in a while loop: But I was wondering if there was some one-liner I could use to do this instead. <code>  while (e.InnerException != null){ e = e.InnerException;}",Find the inner-most exception without using a while loop?
How can i change the name of windows service?," I have a windows service application developed in C#. The same service needs to be run with different config files. To run on these on the same machine I would need to change the name of the service. I can create multiple copies of the solution, but not sure how to change the names of the services.Thanks <code> ",How can I change the name of a windows service?
"Gridview first column,first row, is selected on Load, I don't want this.."," So basically the very first column in the first row is always selected, I can't figure out a way to have it so the gridview has no selected cells. Any help? <code> ","DataGridView first column,first row, is selected on Load, I don't want this.."
C# declare a method always throws an exception?," I have a method like: This produces a compiler error, ""not all code paths return a value"". But in my case ThrowSpecificFault() will always throw (the appropriate) exception. So I am forced to a put a return value at the end but this is ugly.The purpose of this pattern in the first place is because ""process()"" is a call to an external web service but need to translate a variety of different exceptions to match a client's expected interface (~facade pattern I suppose).Any cleaner way to do this? <code>  int f() { try { int i = process(); return i; } catch(Exception ex) { ThrowSpecificFault(ex); }}",Declare a method that always throws an exception?
declare a method always throws an exception?," I have a method like: This produces a compiler error, ""not all code paths return a value"". But in my case ThrowSpecificFault() will always throw (the appropriate) exception. So I am forced to a put a return value at the end but this is ugly.The purpose of this pattern in the first place is because ""process()"" is a call to an external web service but need to translate a variety of different exceptions to match a client's expected interface (~facade pattern I suppose).Any cleaner way to do this? <code>  int f() { try { int i = process(); return i; } catch(Exception ex) { ThrowSpecificFault(ex); }}",Declare a method that always throws an exception?
Declare a method always throws an exception?," I have a method like: This produces a compiler error, ""not all code paths return a value"". But in my case ThrowSpecificFault() will always throw (the appropriate) exception. So I am forced to a put a return value at the end but this is ugly.The purpose of this pattern in the first place is because ""process()"" is a call to an external web service but need to translate a variety of different exceptions to match a client's expected interface (~facade pattern I suppose).Any cleaner way to do this? <code>  int f() { try { int i = process(); return i; } catch(Exception ex) { ThrowSpecificFault(ex); }}",Declare a method that always throws an exception?
What is 'long?'  data type?," I am going over some code written by another developer and am not sure what long? means: <code>  protected string AccountToLogin(long? id){ string loginName = """"; if (id.HasValue) { try {....",What is 'long?' data type?
Find Control by name from windows forms controls.," I have a list of my textbox names, and I want to find a control by name. How is it possible? <code> ",Find control by name from Windows Forms controls
IDisposible Interface ," I know about IDisposable Interface and it's use in .net but there is a question in my mind that If i am writing all managed code , does implementing IDisposable interface make any sense?i know when and how to use Idisposible but my question is if i am writing all managed code say a simple class nothing expensive in it so if i implement IDisposable in this class and do some cleanup like freeing some global values, Does it make some sense? <code> ",IDisposable Interface 
Move all files in subfolders to another folder using c#," My source path is C:\Music\ in which I have hundreds of folders called Album-1, Album-2 etc.What I want to do is create a folder called Consolidated in my source path.And then I want to move all the files inside my albums to the folder Consolidated, so that I get all the music files in one folder.How can I do this? <code> ",Move all files in subfolders to another folder
covert bitarray to string," Could someone help me to convert bittarray to string properly?I wrote this: but on the output I have this: ""*&L9qzP*&L9qzP*&Y(W"" -many unrecognised symbols, what shoud I do? <code>  static String BitArrayToStr(BitArray ba) { byte[] strArr = new byte[ba.Length / 8]; System.Text.ASCIIEncoding encoding = new System.Text.ASCIIEncoding(); for (int i = 0; i < ba.Length / 8; i++) { for (int index = i * 8, m = 1; index < i * 8 + 8; index++, m *= 2) { strArr[i] += ba.Get(index) ? (byte)m : (byte)0; } } return encoding.GetString(strArr); }",Convert bitarray to string
Creating Thousands of Threads Quickly and Executing Them Simultaneously," I have a C#.NET application that needs to inform anywhere from 4000 to 40,000 connected devices to perform a task all at once (or as close to simultaneous as possible).The application works well; however, I am not satisfied with the performance. In a perfect world, as soon as I send the command I would like to see all of the devices respond simultaneously. Yet, there seems to be a delay as all the threads I have created spin up and perform the task.I have used the .NET 4.0 ThreadPool, created my own solution using custom threads and I have even tweaked the existing ThreadPool to allow for more threads to be executed at once. I still want better performance and that is why I am here. Any ideas? Comments? Suggestion? Thank you.-ShaunLet me add that the application notifies these 'connected devices' that they need to go listen for audio on a multicast address.  <code> ",Creating Thousands of Threads Quickly and Executing Them Near Simultaneously
SignedXml checksignature returns false.," I've looked at other posts on here regarding this issue and none of them seem to address my situation.I've been trying to verify a SAML assertion for the last week and I have 2 clients that have sent me SAML but I cannot verify it.The main process is we get a base64 encoded assertion and I decode it. Load it into an XmlDocment with PreserveWhitespace = true.The verify method is I have the certificate from the client that I read in from Web.Config (its stored as base64 encoded string) xmlelement is the signed element, signedXml is a SignedXml object that was created with new SignedXml(xmlElement)Both clients get false returned by checksignature but when I create my own signed saml with my certificate it will return true.What am I missing here? EDIT: Yes both of the clients are on Java and I posted the SetSigningKeyFromKeyInfo method <code>  public static bool Verify(X509Certificate2 cert, XmlElement xmlElement, SignedXml signedXml) { bool flag; try { KeyInfo keyInfo = new KeyInfo(); var clause = new KeyInfoX509Data(cert); keyInfo.AddClause(clause); XmlElement signatureElement = GetSignatureElement(xmlElement); if (signatureElement == null) { string message = ""The XML does not contain a signature.""; throw new SAMLSignatureException(message); } signedXml.LoadXml(signatureElement); if (keyInfo != null) { signedXml.KeyInfo = keyInfo; } SetSigningKeyFromKeyInfo(signedXml); flag = signedXml.CheckSignature(cert.PublicKey.Key); } catch (Exception exception) { throw new SAMLSignatureException(""Failed to verify the XML signature."", exception); } return flag; } private static void SetSigningKeyFromKeyInfo(SignedXml signedXml) { IEnumerator enumerator = signedXml.KeyInfo.GetEnumerator(); while (enumerator.MoveNext()) { if (enumerator.Current is KeyInfoX509Data) { var current = (KeyInfoX509Data) enumerator.Current; if (current.Certificates.Count != 0) { var certificate = (X509Certificate) current.Certificates[0]; var certificate2 = new X509Certificate2(certificate); AsymmetricAlgorithm key = certificate2.PublicKey.Key; signedXml.SigningKey = key; return; } } else { if (enumerator.Current is RSAKeyValue) { var value2 = (RSAKeyValue) enumerator.Current; signedXml.SigningKey = value2.Key; return; } if (enumerator.Current is DSAKeyValue) { var value3 = (DSAKeyValue) enumerator.Current; signedXml.SigningKey = value3.Key; return; } } } throw new SAMLSignatureException(""No signing key could be found in the key info.""); }",SignedXml checksignature returns false
Readable C++ Exception Message in C#?," the following code throws an exception in C++ and catch in C#C++ When i catch in C#, it gives me the following: here is how i call the C++ code Just wondering how can i get the ""a C++ exception"" in C# <code>  throw std::exception (""a C++ exception""); [SEHException (0x80004005): External component has thrown an exception.] using Foo.Bar.Sample; //C++ library....Class1 class1 = new Class1(); //C++ classclass1.throwAnException();",Readable C++\CLI Exception Message in C#?
"Why [  (int)(object)10m;  ] does throw ""Specified cast is not valid"" exception?", Why this explicit cast does throw Specified cast is not valid. exception ? But this works: <code>  decimal d = 10m;object o = d;int x = (int)o; int x = (int)(decimal)o;,"Why does (int)(object)10m throw ""Specified cast is not valid"" exception?"
Using Backup Database Programatically, How can I use a .bak database backup file (backed up via a query in SQL Server) programmatically?I want my application to back up my database to a location (which I can already do) and I also want it to be able to load a backed up database (the .bak file).How can I do this using C#? <code> ,Using backup database programmatically
&&= and ||= (15 chars required in title)," Possible Duplicates: Why doesn't Java have compound assignment versions of the conditional-and and conditional-or operators? (&&=, ||=) Why does a “&&=” Operator not exist? Today at work I wrote the following LOC (the real identities of b and b1 are confidential :) I stared at it for a couple of seconds and realized that there exists no such operator. Just to be sure, I clicked on compile and it failed. To be dead sure I consulted the standard. Are there specific reasons that there are no such operators? I can think of some:b &&= b1 and b = b && b1 may not be equivalent because of short-circuit evaluation of &&.&&= is ugly&&= is rarely needed I do not claim that it would be very useful to have such operators, no. I also don't claim that any or all of the three above reasons are not enough to refrain from creating that operator. My question is the following: is there maybe a much more serious reason which I am overseeing? <code>  b &&= b1; // meaning b = b && b1; ",&&= and ||= operators
In C# is it a good practise to use recursive functions in algorithms?," In many functional languages using a recursion is considered to be a good practice. I think it is good because of the way compiler optimizes functional language's code. But is it a good practice to use recursion in C#, when creating an algorithm? Is it right to say in regards to C#, that recursive algorithms will result in your stack growing quite dramatically (if the amount of calls is very big) and this won't be any fast at all, and might result in stack overflow. Or there are also some optimization happening to make recursive functions efficient?I would appreciate if you would give some comparison (speed, memory, readability) between algorithms which uses recursion in Functional languages and C#. <code> ",In C# is it a good practice to use recursive functions in algorithms?
C# Simple Text to HTML Conversion," I have a very simple asp:textbox with the multiline attribute enabled. I then accept just text, with no markup, from the textbox. Is there a common method by which line breaks and returns can be converted to <p> and <br/> tags? I'm not looking for anything earth shattering, but at the same time I don't just want to do something like: The above code doesn't work right, as in generating correct html, if there are more than 2 line breaks in a row. Having html like <br/></p><p> is not good; the <br/> can be removed. <code>  html.Insert(0, ""<p>"");html.Replace(Enviroment.NewLine + Enviroment.NewLine, ""</p><p>"");html.Replace(Enviroment.NewLine, ""<br/>"");html.Append(""</p>"");",Simple text to HTML conversion
get path for my .exe using c#, how can I get my .exe path because if I copy my .exe I can get my new path ? <code> ,get path for my .exe
Sum of multiplications of two arrays," First off, I know my title can be formulated better, but my math classes are so far gone I can't remember the correct words anymore..I need to do something like this (pseudo c#) This would be the sum of the product of element[i] of each array.This obviously doesn't work.Any suggestions towards either a better title or the solution?EDITclarification: I know I could loop them both and do the math.Basically I would think there is a better way to do this and I'm looking for it purely out of personal curiousity. <code>  int[] digits1 = new int[10]{0,1,2,3,4,5,6,7,8,9};int[] digits2 = new int[10]{0,1,2,3,4,5,6,7,8,9};int result = digits1*digits2",Sum of products of two arrays (dotproduct)
Sum of products of two arrays," First off, I know my title can be formulated better, but my math classes are so far gone I can't remember the correct words anymore..I need to do something like this (pseudo c#) This would be the sum of the product of element[i] of each array.This obviously doesn't work.Any suggestions towards either a better title or the solution?EDITclarification: I know I could loop them both and do the math.Basically I would think there is a better way to do this and I'm looking for it purely out of personal curiousity. <code>  int[] digits1 = new int[10]{0,1,2,3,4,5,6,7,8,9};int[] digits2 = new int[10]{0,1,2,3,4,5,6,7,8,9};int result = digits1*digits2",Sum of products of two arrays (dotproduct)
c#: whats the easiest way to subtract time?, I'm trying to put together a tool that will help me make work schedules. What is the easiest way to solve the following?8:00am + 5 hours = 1:00pm5:00pm - 2 hours = 3:00pm5:30pm - :45 = 4:45and so on. <code> ,What is the easiest way to subtract time in C#?
C#: what is the easiest way to subtract time?, I'm trying to put together a tool that will help me make work schedules. What is the easiest way to solve the following?8:00am + 5 hours = 1:00pm5:00pm - 2 hours = 3:00pm5:30pm - :45 = 4:45and so on. <code> ,What is the easiest way to subtract time in C#?
C#: Why does Try-Catch require curly braces," Just curious: Why is the syntax for try catch in C# (Java also?) hard coded for multiple statements? Why doesn't the language allow: The example is for trivial purposes only. I know there's int.TryParse. <code>  int i;string s = DateTime.Now.Seconds % 2 == 1 ? ""1"" : ""not 1"";try i = int.Parse(s);catch i = 0;",Why does Try-Catch require curly braces
how to sort list in c#, I want to sort a list in C#.Like where structure property AVC goes to true then show them first then AVC goes to false. Are any way to do this in C# LINQ? <code> ,Sort list in C# with LINQ
WPF DataGrid: Automatically resort on a DataGridTemplateColumn," In WPF's DataGrid control, if you set a column to one of the default column types (like DataGridTextColumn or DataGridCheckBoxColumn), sort on that column, and then change its value, the grid will automatically be re-sorted.However, if you use a DataGridTemplateColumn (and allow the column to be sorted), it can be sorted, but changing the value of a cell in this column does not cause the grid is not re-sorted. How can I coax it into automatically triggering a re-sort?XAML: Binding: Here's my item class, just in case that's relevant: <code>  <DataGrid Name=""grid"" AutoGenerateColumns=""False""> <DataGrid.Columns> <DataGridTextColumn Header=""First name"" Binding=""{Binding First}""/> <DataGridTemplateColumn Header=""Last name"" SortMemberPath=""Last""> <DataGridTemplateColumn.CellTemplate> <DataTemplate> <TextBox Text=""{Binding Last}""/> </DataTemplate> </DataGridTemplateColumn.CellTemplate> </DataGridTemplateColumn> </DataGrid.Columns></DataGrid> ObservableCollection items = new ObservableCollection();grid.ItemsSource = items;items.Add(new Character() { First = ""Homer"", Last = ""Simpson"" });items.Add(new Character() { First = ""Kent"", Last = ""Brockman"" });items.Add(new Character() { First = ""Montgomery"", Last = ""Burns"" }); public class Character : INotifyPropertyChanged { private string first, last; public event PropertyChangedEventHandler PropertyChanged; private void Notify(string name) { if (PropertyChanged != null) PropertyChanged(this, new PropertyChangedEventArgs(name)); } public string First { get { return first; } set { first = value; Notify(""First""); } } public string Last { get { return last; } set { last = value; Notify(""Last""); } }}",WPF DataGrid: Automatically re-sort on a DataGridTemplateColumn
arabic text box," I have developed a web site: Some fields are entered in English while others are entered in Arabic language.Now i wanna simplify the input operation for the user and want Arabic textbox as a DLL.I have one but it works only with IE - not with firefox or google chrome ..thanks so much..How to enforce the user to write in Arabic? I mean moving the cursor directly without (ALT + SHIFT) keys every time when trying to change the language... If there is any way, property , DLL or what ever to do that... <code> ",Arabic text box
C# - Varying ListView item background color," How can I make it so that a ListViews control's background color for items varies from item to item like in WinAmp, along with changing the column header colors?If you look closely you can see the first item is a dark gray and the second is black and so on. <code> ",Varying ListViews item background color
adjust screen brightness c#, How do I adjust the screen brightness in C#? <code> ,Adjust screen brightness using C#
Pass a method a s a parameter in c#," I want to be able to pass a method as a parameter.eg.. How can I do this? <code>  //really dodgy codepublic void PassMeAMethod(string text, Method method){ DoSomething(text); // call the method //method1(); Foo();}public void methodA(){ //Do stuff}public void methodB(){ //Do stuff}public void Test(){ PassMeAMethod(""calling methodA"", methodA) PassMeAMethod(""calling methodB"", methodB)}",Pass a method as a parameter
Pass a Method as a Parameter in C#," I want to be able to pass a method as a parameter.eg.. How can I do this? <code>  //really dodgy codepublic void PassMeAMethod(string text, Method method){ DoSomething(text); // call the method //method1(); Foo();}public void methodA(){ //Do stuff}public void methodB(){ //Do stuff}public void Test(){ PassMeAMethod(""calling methodA"", methodA) PassMeAMethod(""calling methodB"", methodB)}",Pass a method as a parameter
Pass a method as a parameter in c#," I want to be able to pass a method as a parameter.eg.. How can I do this? <code>  //really dodgy codepublic void PassMeAMethod(string text, Method method){ DoSomething(text); // call the method //method1(); Foo();}public void methodA(){ //Do stuff}public void methodB(){ //Do stuff}public void Test(){ PassMeAMethod(""calling methodA"", methodA) PassMeAMethod(""calling methodB"", methodB)}",Pass a method as a parameter
What advantages does one big Database querry have over many small ones.," I inherited the app and what it does is get data from 4 views with an (xml file in it) in chunks of 1000 records then writes them down in an xml file all this split up by a type parameter that has 9 different possibilities. That means in a worst case there will be 36 connections to the database for each 1000 of that type/view combination.The real data will exist of 90.000 lines and in this case 900 - 936 times fetching up to 1000 lines from database.Now I am wondering what advantages it would give to read all data into the app and make the app work with this to write the 900+ files.1000 lines is about 800MB, 90.000 lines is approx 81GB of data being transferred.The code would have to be rewritten if we read it all at once and although it would make more sense this is a one time job. After the 90.000 lines, we will never use this code again. Is it worth it to spend 2, 3 hours to rewrite code that works to reduce the amount of connections this way? <code> ",What advantages does one big database query have over many small ones
Creating an anonymous type dynamically??," I wanna create an anonymous type that I can set the property name dynamically. it doesn't have to be an anonymous type. All I want to achieve is set any objects property names dynamically. It can be ExpandoObject, but dictionary will not work for me.What are your suggestions? <code> ",Creating an anonymous type dynamically?
c# Icon (Windows.Drawing.Icon) selecting the size?," I have a icon which has a few different sizes (16px, 32px, 64px). I am calling ToBitmap() on it, but it is always returning the 32px image. How do I retrieve the 64px one? <code> ",Selecting the size of a System.Drawing.Icon?
how to merge 2 List<T> with removing duplicate values in C#," I have two lists List that I need to combine in third list and remove duplicate values from that listsA bit hard to explain, so let me show an example of what the code looks like and what I want as a result, in sample I use int type not ResultAnalysisFileSql class.first_list = [1, 12, 12, 5]second_list = [12, 5, 7, 9, 1]The result of combining the two lists should result in this list:resulting_list = [1, 12, 5, 7, 9]You'll notice that the result has the first list, including its two ""12"" values, and in second_list has an additional 12, 1 and 5 value.ResultAnalysisFileSql class Any sample code for combine and removing duplicates ? <code>  [Serializable] public partial class ResultAnalysisFileSql { public string FileSql { get; set; } public string PathFileSql { get; set; } public List<ErrorAnalysisSql> Errors { get; set; } public List<WarningAnalysisSql> Warnings{ get; set; } public ResultAnalysisFileSql() { } public ResultAnalysisFileSql(string fileSql) { if (string.IsNullOrEmpty(fileSql) || fileSql.Trim().Length == 0) { throw new ArgumentNullException(""fileSql"", ""fileSql is null""); } if (!fileSql.EndsWith(Utility.ExtensionFicherosErrorYWarning)) { throw new ArgumentOutOfRangeException(""fileSql"", ""Ruta de fichero Sql no tiene extensin "" + Utility.ExtensionFicherosErrorYWarning); } PathFileSql = fileSql; FileSql = ObtenerNombreFicheroSql(fileSql); Errors = new List<ErrorAnalysisSql>(); Warnings= new List<WarningAnalysisSql>(); } private string ObtenerNombreFicheroSql(string fileSql) { var f = Path.GetFileName(fileSql); return f.Substring(0, f.IndexOf(Utility.ExtensionFicherosErrorYWarning)); } public override bool Equals(object obj) { if (obj == null) return false; if (!(obj is ResultAnalysisFileSql)) return false; var t = obj as ResultAnalysisFileSql; return t.FileSql== this.FileSql && t.PathFileSql == this.PathFileSql && t.Errors.Count == this.Errors.Count && t.Warnings.Count == this.Warnings.Count; } }",How to merge 2 List<T> and removing duplicate values from it in C#
How to format DateTime columns in DataGridView/WinForms?," I'm using a DataGridView with object data binding to display information about logging entities in a system, retrieved via SOAP from a remote service.One of the columns is called ""Last action"" and means the last time the entity logged a message. It is a System.DateTime value. When I read the SOAP response (example below), he timestamp obviously contains all the information, up to second fractions. When I display it on the table, I instead can read up to the minutesI use the following code to do the data binding when I press the refresh button I would like to know how to control column formatting of data bound values. I think that the format dd/MM/yyyy hh:mm comes from my system's settings. How to override formatting settings programmatically?Thank you in advanceFull solution code on Subversion (FFDAGui program) for the Logbus-ng open source project. <code>  <LoggingEntity><host>marty86ce</host><process>10148</process><logger>http_core</logger><appName>httpd</appName><ffda>true</ffda><lastAction>2010-10-27T12:00:19.5117509Z</lastAction><lastHeartbeat>0001-01-01T00:00:00</lastHeartbeat><channelId>em_9BA2A2B4D0B6E66</channelId><ffdaChannelId>em_E7C8D1D4DE8EEB9</ffdaChannelId></LoggingEntity> public void RefreshEntities(){ IEntityManagement management = EntityPlugin.GetProxy(); LoggingEntity[] result = management.FindLoggingEntities(new TemplateQuery { ffdaSpecified = true, ffda = true }); //Remote invocation Invoke(new MethodInvoker(delegate { gridEntities.DataSource = result; })); //THIS does the data binding from the array Invoke(new MethodInvoker(delegate { btnRefresh.Enabled = true; }));}",How to format DateTime columns in DataGridView?
How to use LINQ Contains() to find a list of specific enums?," I have an enum called OrderStatus, and it contains various statuses that an Order can be in:CreatedPendingWaitingValidActiveProcessedCompletedWhat I want to do is create a LINQ statement that will tell me if the OrderStaus is Valid, Active, Processed or Completed. Right now I have something like: That works, but it's very ""wordy"". Is there a way to convert this to a Contains() statement and shorten it up a bit? <code>  var status in Order.Status.WHERE(status => status.OrderStatus == OrderStatus.Valid || status.OrderStatus == OrderStatus.Active|| status.OrderStatus == OrderStatus.Processed|| status.OrderStatus == OrderStatus.Completed)",How to use LINQ Contains() to find a list of enums?
C# goto case good practice, I have a code for updating my application resources to current application version.This code is called after application update. Here we have a cascade method calling by jumping to specified case block.I wonder - is that good practice to use go to (often considered as such bad practise!) in this case?I do not want to call method one by other - like this: It there any design pattern describes such an issue? <code>  int version = 1002; // current app versionswitch(version){ case 1001: updateTo1002(); goto case 1002; case 1002: updateTo1003(); goto case 1003; case 1003: updateTo1004(); goto case 1004; break; case 1004: updateTo1005(); break;} updateTo1002(){ // do the job updateTo1003();}updateTo1003(){ // do the job updateTo1004();},Design pattern that can replace chained switch/goto?
"C# , SQLite - what is ""Data Source cannot be empty.  Use :memory: to open an in-memory database"" why i get this"," I recently converted my SQL Server database into SQLite DB. But when I try to open my SQLite using .Open() it throws me this error: Edit: added connection string: Why do I get this? I converted the same SQL Server database to SQL CE and mySQL and I didn't get these errors. <code>  Data Source cannot be empty. Use :memory: to open an in-memory database ConnectionString = @""Data Source=D:\XXX.db;Version=3"";connection = new SQLiteConnection(connectionString);connection.Open();","What does ""Data Source cannot be empty. Use :memory: to open an in-memory database"" mean?"
How to eliminate username's and passwords from source code in Test Automation?, I write test automation and scripts that require windows authentication to the domain to access.I don't like keeping them in the app.config because they are available in plain text.I don't like prompting for input because then it isn't automated anymore.If I hard code them in the assembly they are visible from .Net Reflector and they get checked into source control when I commit the .cs files.Is there a pattern / practice that makes it easy to use configured usernames and passwords without exposing them. This also applies to web sites that have credentials to log in and databases the use either windows authentication or sql server authentication to connect.Any advice would be greatly appreciated. <code> ,How to eliminate usernames and passwords from source code in Test Automation?
IEnumerator Function," I don't quite understand what the use of IEnumerator from the C# Collections is.What is it used for and why should it be used? I tried looking online at http://msdn.microsoft.com/en-us/library/system.collections.ienumerator.aspxbut that article doesn't make much sense. The reason I ask is in Unity3d Game Engine, it's used along with the yield function. I am trying to make sense of the reason for the use of IEnumerator. <code> ",IEnumerator Purpose
Speeding up the loading of a List," I'm loading a List<Image> from a folder of about 250 images. I did a DateTime comparison and it takes a full 11 second to load those 250 images. That's slow as hell, and I'd very much like to speed that up.The images are on my local harddrive, not even an external one.The code: EDIT: yes, I need all the pictures. The thing I'm planning is to take the center 30 pixelcolums of each and make a new image out of that. Kinda like a 360 degrees picture. Only right now, I'm just testing with random images.I know there are probably way better frameworks out there to do this, but I need this to work first.EDIT2: Switched to a stopwatch, the difference is just a few milliseconds. Also tried it with Directory.EnumerateFiles, but no difference at all.EDIT3: I am running .NET 4, on a 32-bit Win7 client. <code>  DialogResult dr = imageFolderBrowser.ShowDialog();if(dr == DialogResult.OK) { DateTime start = DateTime.Now; //Get all images in the folder and place them in a List<> files = Directory.GetFiles(imageFolderBrowser.SelectedPath); foreach(string file in files) { sourceImages.Add(Image.FromFile(file)); } DateTime end = DateTime.Now; timeLabel.Text = end.Subtract(start).TotalMilliseconds.ToString();}",Speeding up the loading of a List of images
c# permanent casting to a subclass ," If: I can do: but if I do tauto.GetType().Name it will still be Car. Is it possible to perform a cast, so that the type is permanently changed to Automobile (without having to clone the object) ? The problem i am trying to overcome is that there is no multiple inheritance in c#, and i need to merge objects (with the same signature) from 2 services, in one method, and return one type.  <code>  class Car : Automobile{} Car toyota = new Car();Automobile tauto = (Automobile)toyota;",Permanent casting to a superclass
how to wake up system which is shutdowned using C# ?," Is there any Win32 API for waking up a system that has been shut down, at a specific time? I have seen a program named Autopower On which is able to power the system on at a specified time. <code> ",C#: How to wake up system which has been shutdown?
Addition of two integers using bitwise operators," In C#, is it possible to perform a sum of two 32-bit integers without using things like if..else, loops etc?That is, can it be done using only the bitwise operations OR (|), AND (&), XOR (^), NOT (!), shift left (<<) and shift right (>>)? <code> ",Add two integers using only bitwise operators?
Ninject 2.1 ActivationException : Error activating string ...," I am confused about why I am receiving ""Ninject.ActivationException : Error Activating string No matching bindings are available, and the type is not self-bindable"" in random bindings. If I leave the binding for IMedia in place it will throw the ActivationException, but if I use the CallbackProvider it works. All of these classes are structured the same with a few different properties. I'm confused as to why ILocationType, IMedia, and IFarmDataContext throw ActivationException while the others do not. Any ideas? <code>  /****************************** * Core Types ******************************/Bind<IFarmDataContext>().ToProvider(new CallbackProvider<IFarmDataContext>(delegate { return new FarmDataContext(); }));//MediaBind<IMedia>().To<Media>(); //blows up//Bind<IMedia>().ToProvider(new CallbackProvider<IMedia>(delegate { return new Media(); }));Bind<IMediaType>().To<MediaType>();Bind<IMediaRelated>().To<MediaRelated>();//LocationBind<ILocation>().To<Location>();Bind<ILocationType>().ToProvider(new CallbackProvider<ILocationType>(delegate { return new LocationType(); }));Bind<ILocationDetail>().To<LocationDetail>();",Ninject 2.1 ActivationException : Error activating string
Format Currency string to integer...., I'm have a string with currency format like $35.00 and this has to be converted to 35. Is that possible to retrieve using String.Format{ } <code> ,How to format a Currency string to Integer?
Format Currency string to integer, I'm have a string with currency format like $35.00 and this has to be converted to 35. Is that possible to retrieve using String.Format{ } <code> ,How to format a Currency string to Integer?
c# (Winform NEt 2.0) read Excel 2007 file(XLSX) without installed Excel and without Oledb ," Is there any chance to read .xlsx files in C# without having Excel installed on the client, and with no OLEDB connection available?The application is a Winforms project written in VS2005 C# .NET Framework 2.0. <code> ",read .xlsx without Excel and OLEDB
Whats wrong with casting 0.0 to double?," I have InvalidCastException when I try to cast 0.0 to double, why is that so? It's fine when I do (float)value instead. <code> ",What's wrong with casting 0.0 to double?
How to Use Model Validation Rules in WPF VIewModel," I'm using WPF with the MVVM pattern and just starting a very large project. To keep concerns separated, I want to put all my validation rules into my data models. But when I review how to do WPF validation, all the examples that I can find show how to do it with the ViewModel holding the validation rules. Some of these examples show some real deep understanding of WPF and are very cool.In this particular app, I have a 1:1 mapping between the ViewModels that edit and models, so I could put it in the ViewModels. But it just doesn't feel right. <code> ",How to Use Model Validation Rules in WPF ViewModel
How to remove newline character or tab characters from a .NET string ?," I have a string in the following format I want to remove all the occurrences of \n and \r from the string above.I have tried string s = s.Trim(new char[] {'\n', '\r'}); but it didn't help. <code>  string s = ""This is a Test String.\n This is a next line.\t This is a tab.\n'",How to remove new line characters from a string?
Selecting items from a List based on object properties?," Im trying to perform a parameterized query in SQLite from C#, and the method im using is along the lines of creating a static command with and calling it like this: but im getting an error along the line of "" '@search' is not a correct column name "" or something like that. if i use a constant column name, and only use the data for parameters it works, but i dont want to create 10 different commands for when i need to search by different column names.What is the issue here? <code>  SQLiteCommand cmd = new SQLiteCommand( ""SELECT [ID]"" + "",[email]"" + "",[serializedata]"" + "",[restrictions]"" + "" FROM "" + UserTable + "" WHERE @search = @searchparam"", SQLConnection); cmd.Parameters.Add(new SQLiteParameter(""@searchparam"")); cmd.Parameters.Add(new SQLiteParameter(""@search"")); Command.Parameters[""@searchparam""].Value = searchdata; Command.Parameters[""@search""].Value = search; SQLiteDataAdapter slda = new SQLiteDataAdapter(UserSelectUsernameCommand); DataSet ds = new DataSet(); slda.Fill(ds); User[] array = new User[ds.Tables[0].Rows.Count]; int index = 0; foreach (DataRow row in ds.Tables[0].Rows) { array[index] = new User(this, row); index++; } return array;",Is it possible to parameterize table and column names in SQLite queries?
Parameterized queries in SQLite," Im trying to perform a parameterized query in SQLite from C#, and the method im using is along the lines of creating a static command with and calling it like this: but im getting an error along the line of "" '@search' is not a correct column name "" or something like that. if i use a constant column name, and only use the data for parameters it works, but i dont want to create 10 different commands for when i need to search by different column names.What is the issue here? <code>  SQLiteCommand cmd = new SQLiteCommand( ""SELECT [ID]"" + "",[email]"" + "",[serializedata]"" + "",[restrictions]"" + "" FROM "" + UserTable + "" WHERE @search = @searchparam"", SQLConnection); cmd.Parameters.Add(new SQLiteParameter(""@searchparam"")); cmd.Parameters.Add(new SQLiteParameter(""@search"")); Command.Parameters[""@searchparam""].Value = searchdata; Command.Parameters[""@search""].Value = search; SQLiteDataAdapter slda = new SQLiteDataAdapter(UserSelectUsernameCommand); DataSet ds = new DataSet(); slda.Fill(ds); User[] array = new User[ds.Tables[0].Rows.Count]; int index = 0; foreach (DataRow row in ds.Tables[0].Rows) { array[index] = new User(this, row); index++; } return array;",Is it possible to parameterize table and column names in SQLite queries?
Obtain first string in an arry which is not null using LINQ?," I have a string array and I need to use the first string in the string array which is not null. Lets consider this code snippet - So, according to this code snippet, txtbox should now display ""test"".To do this I have this code. This is working fine. But, I want to know if it is possible to use LINQ to obtain the same result and perhaps skip using an extra foreach loop?  <code>  string[] strDesc = new string[] {"""", """", ""test""};foreach (var Desc in strDesc){ if (!string.IsNullOrEmpty(Desc)) { txtbox.Text = Desc; break; }}",Obtain first string in an array which is not null using LINQ?
Operator '??' cannot be applied," I have the following C# code: But it throws the following compilation error: Operator ?? cannot be applied to operands of type string and System.DBNullWhy doesn't the compiler allow this syntax? <code>  sqlCommand.Parameters.AddWithValue(""@Parameter"", table.Value ?? DBNull.Value);",Operator '??' cannot be applied to operands of type 'string' and 'System.DBNull'
Caching inASP.NET," I am developing a website and I want to implement caching to improve its performance. If I use where will my page be stored? On the client side or on the server? If it's stored on the client side, where is it stored?Can I cache a master page? <code>  <@ OutputCache Duration=""20"" VaryByParam=""None""> ",Where is cached information stored in ASP.NET ?
StyleCop-Where's my output and the beef?," When I run it, I see this output in the ""Output"" window.Where can I find the detail about the actual violations found? <code>  ------ StyleCop started ------Pass 1: Form1.Designer.cs...Pass 1: Form1.cs...Pass 1: MonthPeriod.cs...Pass 1: Application.Designer.cs...Pass 1: MonthPeriods.cs...Pass 1: AssemblyInfo.cs...Pass 1: Resources.Designer.cs...Pass 1: MyNamespaceSupportForCSharp.cs...Loaded Analyzer: Documentation Rules...Loaded Analyzer: Layout Rules...Loaded Analyzer: Maintainability Rules...Loaded Analyzer: Naming Rules...Loaded Analyzer: Ordering Rules...Loaded Analyzer: Readability Rules...Loaded Analyzer: Spacing Rules...Pass 1: Period.cs...Pass 2: Form1.cs...Pass 2: Application.Designer.cs...Pass 2: MyNamespaceSupportForCSharp.cs...Pass 2: Form1.Designer.cs...---------------------- Done ----------------------Violation Count: 547",StyleCop-Where's my output?
How do I find the closest array element to an arbitrary (non-member) number? [C#]," Seemingly similar questions: ""Finding closest number in an array"" (in Java) and ""find nearest match to array of doubles"" (actually a geography problem).I have a (sorted) array of doubles. Given an arbitrary number (which may or may not be an exact match for one of the array elements), how can I return the index of the number which is the closest match?For example, using the following array:1.82.42.73.14.5Querying 2.5 would return with an index of 1, corresponding to the value of 2.4.Bonus points for detecting values that lie completely outside of the range of the array elements. For example, using the array listed above, your code may decide that 4.6 is in, but 5.9 is out. If you want to try this part of the question, the specifics are in your hands. <code> ",How do I find the closest array element to an arbitrary (non-member) number?
Where is the client class when adding a service reference in VS2010?," I'm going insane, I beleive.That is, I've never had an issue like this before, and nobody (that Google has indexed) seems to be having the same issue.Whenever I add a reference to a particular ASMX service to a VS2010 project, all of the code is generated, there is an interface ServiceSoap that represents all of the features of the service, but there is no concrete implementation of that interface anywhere in the solution!What am I doing wrong? I just right click project, add service reference, paste url to .asmx, type 'Blah' in the namespace box, click OK.Everything seems to happen OK. I'm just bat-shit insane, I guess...Update:If I go to Advanced... in the add service reference dialog, and choose to add it as a .NET 2.0 service, everything works, but I don't particularly want to do it that way.The actual namespace I'm using is Remedy and the service .asmx file is Service.asmx. <code> ","Why, when adding a service reference in VS2010, is the client class not generated?"
How do I register a COM DLL written in C# with Regsvr32?," I have a VB6 application that uses a COM DLL. The DLL is written in C#. In the C# project properties I have checked the ""Register for COM interop"" option. The VB6 app works fine on my development machine. The C# code follows this format exactly: CodeProject C# COM ExampleWhen deploying to other machines, Regsvr32.exe gives me the following error when I try to register the DLL:The module ""MyCOM.dll"" was loaded but the entry-point DLLRegisterServer was not found.What does this mean?No tutorials/documentation I've read about COM DLLs say anything about ""entry-point DLLRegisterServer"".We have had MAJOR problems using RegAsm.exe on different machines, so we really need a solution where we can run regsvr32.exe instead that will work for any machine that we deploy to (i.e. XP, Vista, Windows 7, x86 machines, x64 machines, etc.)What do I need to add to my C# code to make it register-able with regsvr32.exe? <code> ",How do I register a .NET COM DLL with Regsvr32?
System.ObjectDisposedException: The ObjectContext instance has been disposed and can no longer be used for operations that require a connection.," I am using EF 4 to retrieve a list of Employees. The list is retrieved OK, but when I serialize it, I get this exception; I find this very odd. I have already retrieved the list of employees and the DataContext has been disposed. So why would I get this error? <code>  public ContentResult AutoCompleteResult(string searchText){ List<Employee> list = Employee.GetAllCurrentEmployees(); List<Employee> filteredEmployees = list .Where(x => x.GetName().ToLower().Contains(searchText.ToLower())) .ToList(); JavaScriptSerializer jsonSerializer = new JavaScriptSerializer(); var jsonString = jsonSerializer.Serialize(filteredEmployees).ToString(); return Content(jsonString);} System.ObjectDisposedException: The ObjectContext instance has been disposed and can no longer be used for operations that require a connection. Generated: Wed, 17 Nov 2010 16:06:56 GMT System.ObjectDisposedException: The ObjectContext instance has been disposed and can no longer be used for operations that require a connection. at System.Data.Objects.ObjectContext.EnsureConnection() at System.Data.Objects.ObjectQuery`1.GetResults(Nullable`1 forMergeOption) at System.Data.Objects.ObjectQuery`1.Execute(MergeOption mergeOption) at System.Data.Objects.DataClasses.EntityCollection`1.Load(List`1 collection, MergeOption mergeOption) at System.Data.Objects.DataClasses.EntityCollection`1.Load(MergeOption mergeOption) at System.Data.Objects.DataClasses.RelatedEnd.Load() at System.Data.Objects.DataClasses.RelatedEnd.DeferredLoad() at System.Data.Objects.DataClasses.EntityCollection`1.System.Collections.IEnumerable.GetEnumerator() at System.Web.Script.Serialization.JavaScriptSerializer.SerializeEnumerable(IEnumerable enumerable, StringBuilder sb, Int32 depth, Hashtable objectsInUse, SerializationFormat serializationFormat) at System.Web.Script.Serialization.JavaScriptSerializer.SerializeValueInternal(Object o, StringBuilder sb, Int32 depth, Hashtable objectsInUse, SerializationFormat serializationFormat) at System.Web.Script.Serialization.JavaScriptSerializer.SerializeValue(Object o, StringBuilder sb, Int32 depth, Hashtable objectsInUse, SerializationFormat serializationFormat) at System.Web.Script.Serialization.JavaScriptSerializer.SerializeCustomObject(Object o, StringBuilder sb, Int32 depth, Hashtable objectsInUse, SerializationFormat serializationFormat) at System.Web.Script.Serialization.JavaScriptSerializer.SerializeValueInternal(Object o, StringBuilder sb, Int32 depth, Hashtable objectsInUse, SerializationFormat serializationFormat) at System.Web.Script.Serialization.JavaScriptSerializer.SerializeValue(Object o, StringBuilder sb, Int32 depth, Hashtable objectsInUse, SerializationFormat serializationFormat) at System.Web.Script.Serialization.JavaScriptSerializer.SerializeEnumerable(IEnumerable enumerable, StringBuilder sb, Int32 depth, Hashtable objectsInUse, SerializationFormat serializationFormat) at System.Web.Script.Serialization.JavaScriptSerializer.SerializeValueInternal(Object o, StringBuilder sb, Int32 depth, Hashtable objectsInUse, SerializationFormat serializationFormat) at System.Web.Script.Serialization.JavaScriptSerializer.SerializeValue(Object o, StringBuilder sb, Int32 depth, Hashtable objectsInUse, SerializationFormat serializationFormat) at System.Web.Script.Serialization.JavaScriptSerializer.Serialize(Object obj, StringBuilder output, SerializationFormat serializationFormat) at System.Web.Script.Serialization.JavaScriptSerializer.Serialize(Object obj, SerializationFormat serializationFormat) at System.Web.Script.Serialization.JavaScriptSerializer.Serialize(Object obj) at SHP.Controllers.EmployeeController.AutoCompleteResult(String searchText) in C:\Documents and Settings\geoffreypayne\My Documents\Visual Studio 2010\Projects\MVC\SHP\SHP\Controllers\EmployeeController.cs:line 623 at lambda_method(Closure , ControllerBase , Object[] ) at System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters) at System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters) at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters) at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClassd.InvokeActionMethodWithFilters>b__a() at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClassd.<>c__DisplayClassf.<InvokeActionMethodWithFilters>b__c() at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor, IDictionary`2 parameters) at System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName)",System.ObjectDisposedException: The ObjectContext instance has been disposed and can no longer be used for operations that require a connection
c# how to print aspect ratio  /  full page," I am printing the CHART control on button click: How do I force it to print the control so that it fits to the size of the page (preserving the aspect ratio)? <code>  chart1.SaveImage(ms, ChartImageFormat.Bmp);Bitmap bm = new Bitmap(ms);PrintDocument doc = new PrintDocument();doc.PrintPage += (s, ev) =>{ ev.Graphics.DrawImage(bm, Point.Empty); // adjust this to put the image elsewhere ev.HasMorePages = false;};doc.DefaultPageSettings.Landscape = true;doc.Print();",C# - How to print aspect ratio / full page
how to print aspect ratio  /  full page with GDI+?," I am printing the CHART control on button click: How do I force it to print the control so that it fits to the size of the page (preserving the aspect ratio)? <code>  chart1.SaveImage(ms, ChartImageFormat.Bmp);Bitmap bm = new Bitmap(ms);PrintDocument doc = new PrintDocument();doc.PrintPage += (s, ev) =>{ ev.Graphics.DrawImage(bm, Point.Empty); // adjust this to put the image elsewhere ev.HasMorePages = false;};doc.DefaultPageSettings.Landscape = true;doc.Print();",C# - How to print aspect ratio / full page
Could not create the driver from NHibernate.Driver.SQLite20Driver ," Here's the code that raises the exception The full exception text: Failure: NHibernate.HibernateException : Could not create the driver from NHibernate.Driver.SQLite20Driver, NHibernate, Version=2.1.2.4000, Culture=neutral, PublicKeyToken=aa95f207798dfdb4. ----> System.Reflection.TargetInvocationException : Exception has been thrown by the target of an invocation. ----> NHibernate.HibernateException : The IDbCommand and IDbConnection implementation in the assembly System.Data.SQLite could not be found. Ensure that the assembly System.Data.SQLite is located in the application directory or in the Global Assembly Cache. If the assembly is in the GAC, use element in the application configuration file to specify the full name of the assembly.Version of NHibernate is 2.1.2.4000Version of System.Data.SQLite is 1.0.66.0Target Framework is 3.5 (x86)Local copy for System.Data.SQLite is ON.What may be wrong? <code>  public Configuration GetConfiguration() { var persister = SQLiteConfiguration .Standard .UsingFile(""Test.db"") .ShowSql(); var configuration = Fluently .Configure() .Database(persister) .Mappings(map => map.FluentMappings.AddFromAssemblyOf<WordMap>()) .BuildConfiguration(); new SchemaExport(configuration).Execute(true, true, false); return configuration; }",Could not create the driver from NHibernate.Driver.SQLite20Driver
c# System.IO.DirectoryNotFoundException after creating folder," I want to copy a folder, and i want to delete destination folder first.So I am deleting destination folder then recreate it and then copy files.The problem is that i get the An unhandled exception of type 'System.IO.DirectoryNotFoundException' occurred in mscorlib.dllwhen trying to copy files. This is the code I get the exception in this line FileInfo fileinfo = new FileInfo(dest);.It seems like there is a delay in the creation of the folder and in the mean time I try to copy a file into it. Any clue, what is the problem? The full exception message: An unhandled exception of type 'System.IO.DirectoryNotFoundException' occurred in mscorlib.dll Additional information: Could not find a part of the path 'C:\Users\joe\Desktop\destfolder\.buildpath'.SOLUTIONAs it been pointed out by good people, the reason for this exception is that I try recreating the folder before the deletion process is finished.So the solution is to add 2 lines of code after deletion:GC.Collect();GC.WaitForPendingFinalizers();so the correct code will be This way, you wait with the creation until the deletion process is finished.Yhanks everyone and especially Saeed. <code>  static public void CopyFolder(string sourceFolder, string destFolder) { if (Directory.Exists(destFolder)) // check if folde exist { Directory.Delete(destFolder, true); // delete folder } Directory.CreateDirectory(destFolder); // create folder string[] files = Directory.GetFiles(sourceFolder); foreach (string file in files) { string name = Path.GetFileName(file); string dest = Path.Combine(destFolder, name); File.Copy(file, dest, true); FileInfo fileinfo = new FileInfo(dest); // get file attrib if (fileinfo.Attributes != FileAttributes.ReadOnly) // check if read only File.SetAttributes(dest, FileAttributes.Normal); }....... static public void CopyFolder(string sourceFolder, string destFolder){ if (Directory.Exists(destFolder)) // check if folde exist { Directory.Delete(destFolder, true); // delete folder GC.Collect(); // CODE ADDED GC.WaitForPendingFinalizers(); // CODE ADDED } Directory.CreateDirectory(destFolder); // create folder string[] files = Directory.GetFiles(sourceFolder); foreach (string file in files) { string name = Path.GetFileName(file); string dest = Path.Combine(destFolder, name); File.Copy(file, dest, true); FileInfo fileinfo = new FileInfo(dest); // get file attrib if (fileinfo.Attributes != FileAttributes.ReadOnly) // check if read only File.SetAttributes(dest, FileAttributes.Normal); }.......",System.IO.DirectoryNotFoundException after deleting an empty folder and recreating it
C# List<T> deep copy?," I'm trying to make a deep copy of a generic list, and am wondering if there is any other way then creating the copying method and actually copying over each member one at a time. I have a class that looks somewhat like this: And I have a list of the above data, i.e List<Data>. What I'm trying to do is plot a trace data of the subset of List onto a graph, possibly with some scaling or sweeping on the data. I obviously don't need to plot everything in the list because they don't fit into the screen. I initially tried getting the subset of the list using the List.GetRange() method, but it seems that the underneath List<double> is being shallow copied instead of deep copied. When I get the subset again using List.GetRange(), I get previously modified data, not the raw data retrieved elsewhere.Can anyone give me a direction on how to approach this? Thanks a lot. <code>  public class Data{ private string comment; public string Comment { get { return comment; } set { comment = value; } } private List<double> traceData; public List<double> TraceData { get { return traceData; } set { traceData = value; } }}",Deep copy of List<T>
"How to match a string, considering that a newline (\n) at the end of the string as significant?"," I want to be able to match an entire string (hence the word boundaries) against a pattern ""ABC"" (""ABC"" is just used for convenience, I don't want to check for equality with a fixed string), so newlines are significant to me. However it appears that a single ""\n"" when put at the end of a string is ignored. Is there something wrong with my pattern? <code>  Regex r = new Regex(@""^ABC$"");string[] strings ={ ""ABC"",//True ""ABC\n"",//True: But, I want it to say false. ""ABC\n\n"",//False ""\nABC"",//False ""ABC\r"",//False ""ABC\r\n"",//False ""ABC\n\r""//False};foreach(string s in strings){ Console.WriteLine(r.IsMatch(s));}","How to match a string, ignoring ending newline?"
Is there a way to make the C# compiler issue a warning when instance variable is shadowed?, I am refactoring a little bit of code and I think I have created some instance variables that are being hidden(shadowed) in older methods. I want to see a warning wherever the hiding(shadowing) happens so I can check to make sure that it's actually what I want (and it's hardly ever what I want). Is there any easy way to do that? <code> ,Is there a way to make the C# compiler issue a warning when instance variable is hidden(shadowed)?
changing the name of messagebox control button text," I need to change the message box control buttons Yes to Continue and No to Close. How do I change the button text?Here is my code: <code>  DialogResult dlgResult = MessageBox.Show(""Patterns have been logged successfully"", ""Logtool"", MessageBoxButtons.YesNo, MessageBoxIcon.Information);",How to change the button text for 'Yes' and 'No' buttons in the MessageBox.Show dialog?
How to change button text for Yes & No buttons on MessageBox.Show Dialog?," I need to change the message box control buttons Yes to Continue and No to Close. How do I change the button text?Here is my code: <code>  DialogResult dlgResult = MessageBox.Show(""Patterns have been logged successfully"", ""Logtool"", MessageBoxButtons.YesNo, MessageBoxIcon.Information);",How to change the button text for 'Yes' and 'No' buttons in the MessageBox.Show dialog?
Whats the Difference between Encapsulate a private member as property and define a property without private memeber," What's the difference (Performance, memory...etc) between encapsulating a private member like this and define a property like this <code>  private int age;public int Age{ get { return age; } set { age = value; }} public int Age{ get ; set ;}",What's the difference between encapsulating a private member as a property and defining a property without a private member?
Why does Visual Studio 2010's debugger continue instead of stepping over?," Possible Duplicate: Visual Studio 2010 debugger skipping If I break at a breakpoint in visual studio (C#), I can step over statements quite happily. Occasionally though, it ignores the step over and it's as though I'd hit continue instead.It is not repeatable.. immediately re-running and breaking on the same point and stepping over will sometimes work fine, or will fail to step over on a different statement.It may be my imagination, but the faster I step over things, the more reliable it seems. As though it's timing out on something.My app is a single-threaded app debugging a method via MSTest.UpdateIt seems to be more repeatable if I inspect things in the debugger, e.g. expand the 'this' reference in the locals window. It's not 100% repeatable though. <code> ",Why does Visual Studio 2010's C# debugger continue instead of stepping over?
is the following exactly same,  <code>  public static void function()static public void function(),Are the following exactly same?
TextView Gtk#: i don't understand how to load text into !," I can't understand how to load text into a GtkTexView, how is it done? <code> ",How do I set the text of a GtkTextView?
Setting the text of a GtkTextView," I can't understand how to load text into a GtkTexView, how is it done? <code> ",How do I set the text of a GtkTextView?
Setting the text of a GtkTextView in GTK#," I can't understand how to load text into a GtkTexView, how is it done? <code> ",How do I set the text of a GtkTextView?
How do I set the text of a GtkTextView in GTK#?," I can't understand how to load text into a GtkTexView, how is it done? <code> ",How do I set the text of a GtkTextView?
problem converting 4 bytes array to float.C#," I'm using C# and reading bytes array from some controller and converting them to their types. all values (int,string) OK except the float values.The value that suppose to get is 533174.1.but when reading the array getting some gibberish value.I used the System.BitConverter.ToDouble(bytesArr,0) and other methods without success.please help.Thanks,Igal. <code>  byteArr[0]=2byteArr[1]=73byteArr[2]=98byteArr[3]=43",problem converting 4-bytes array to float in C#
C# - get attribute values from matching XML nodes using XPath query," This doesn't seem like it should be difficult, but I'm stuck currently. I'm trying to get the attribute values for a particular attribute from nodes that match a given XPath query string. Here's what I have so far: This currently throws an exception: System.InvalidCastException: Unable to cast object of type 'MS.Internal.Xml.Cache.XPathDocumentNavigator' to type 'System.Xml.IHasXmlNode'.Am I going about this wrong? Is there a simpler way to get attribute values from matching nodes? <code>  public static IEnumerable<string> GetAttributes(this XmlDocument xml, string xpathQuery, string attributeName) { var doc = new XPathDocument(new XmlNodeReader(xml)); XPathNavigator nav = doc.CreateNavigator(); XPathExpression expr = nav.Compile(xpathQuery); XPathNodeIterator iterator = nav.Select(expr); while (iterator.MoveNext()) { XPathNavigator curNav = iterator.Current; if (curNav.HasAttributes) { XmlNode curNode = ((IHasXmlNode)curNav).GetNode(); if (null != curNode) { XmlAttribute attrib = curNode.Attributes[attributeName]; if (null != attrib) { yield return attrib.Value; } } } } }",Get attribute values from matching XML nodes using XPath query
how to Auto Complete combo-box or text box filter text contain a string in c#," How do I create an Auto-complete ComboBox or TextBox that filters text based on a string?For example: if I type an ""a"" in a TextBox, I only get to see all strings containing an ""a"".  <code> ",How to create an Auto-complete combo-box or text box to filter text containing a string
Getting domain group users in Sharepoint," In my Sharepoint code I display a list of all defined users via: The great part is, I can add a domain security group to a Sharepoint group (like Visitors) thus adding many users at once (simpler administration). But my code doesn't see those users at least not until they log-in for the first time (if they have sufficient rights). In this case I can only see the domain security group SPUser object instance with its IsDomainGroup set to true.Is it possible to get domain group members by means of Sharepoint without resorting to Active Directory querying (which is something I would rather avoid because you probably need sufficient rights to do such operations = more administration: Sharepoint rights + AD rights). <code>  foreach (SPUser user in SPContext.Current.Web.AllUsers){ ...}",Getting members of an AD domain group using Sharepoint API
Getting domain group users," In my Sharepoint code I display a list of all defined users via: The great part is, I can add a domain security group to a Sharepoint group (like Visitors) thus adding many users at once (simpler administration). But my code doesn't see those users at least not until they log-in for the first time (if they have sufficient rights). In this case I can only see the domain security group SPUser object instance with its IsDomainGroup set to true.Is it possible to get domain group members by means of Sharepoint without resorting to Active Directory querying (which is something I would rather avoid because you probably need sufficient rights to do such operations = more administration: Sharepoint rights + AD rights). <code>  foreach (SPUser user in SPContext.Current.Web.AllUsers){ ...}",Getting members of an AD domain group using Sharepoint API
Getting members (users) of a domain group," In my Sharepoint code I display a list of all defined users via: The great part is, I can add a domain security group to a Sharepoint group (like Visitors) thus adding many users at once (simpler administration). But my code doesn't see those users at least not until they log-in for the first time (if they have sufficient rights). In this case I can only see the domain security group SPUser object instance with its IsDomainGroup set to true.Is it possible to get domain group members by means of Sharepoint without resorting to Active Directory querying (which is something I would rather avoid because you probably need sufficient rights to do such operations = more administration: Sharepoint rights + AD rights). <code>  foreach (SPUser user in SPContext.Current.Web.AllUsers){ ...}",Getting members of an AD domain group using Sharepoint API
Getting members of a domain group via Sharepoint API," In my Sharepoint code I display a list of all defined users via: The great part is, I can add a domain security group to a Sharepoint group (like Visitors) thus adding many users at once (simpler administration). But my code doesn't see those users at least not until they log-in for the first time (if they have sufficient rights). In this case I can only see the domain security group SPUser object instance with its IsDomainGroup set to true.Is it possible to get domain group members by means of Sharepoint without resorting to Active Directory querying (which is something I would rather avoid because you probably need sufficient rights to do such operations = more administration: Sharepoint rights + AD rights). <code>  foreach (SPUser user in SPContext.Current.Web.AllUsers){ ...}",Getting members of an AD domain group using Sharepoint API
HierarchyID in WCFDataService not working," We are using WCF Data Service based on an Entity Framework model for our application. In this we need to add the table with a column of type HierarchyId. When I add that table to the EDMX file, the HierarchId column is not appearing in the class file. What should I do to make use of HierarchyID? I read that Entity Framework is not supporting HierarchyID, so how can I achieve this? <code> ",HierarchyID in Entity Framework not working
C# convert int to string with padding zeros, In C# I have an integer value which need to be convereted to string but it needs to add zeros before:For Example: When I convert it to string it needs to become 0001I need to know the syntax in C#. <code>  int i = 1;,C# convert int to string with padding zeros?
C# visual studio using resource files," I'm trying to add two image files into the solution, so they will be compiled into the .exe, so I can load them right there instead of from an absolute path on the computer.I believe I need to use resource files in Visual Studio, but I never have before. If I'm completely on the wrong track, please correct me.Here's what I've done so far. In Visual Studio 2010 Solution Explorer, right click Properties Open Resources Add Resource Add Existing File...So now I have both my images in the Properties Resources tab. Now how do I get them back out in the C# code?I'm using C#, Windows Forms and Visual Studio 2010. <code>  PictureBox pic;pic.Image = new Bitmap( /* What is the address now? */ );",C# Visual Studio using resource files
help on Google web history," I want to retrieve old Google searches which I did a few years/months back and that are present in Google web history. How can I programmatically retrieve them all?https://www.google.com/history/?output=rss only provides recent Google searches, but not all of them.Also this question : How can I retrieve my Google search history? doesn't provide any answer for my question! <code> ",Retrieve old searches from Google web history
"Where is ""Run Tests"" in monodevelop 2.6"," I have a solution already containing a library with NUnit tests. When I develop with Visual Studio, I normally run these tests with the nunit.exe binaries I have included in a tools\nunit folder in my project.I'm now developing the same solution with monodevelop. I'm pretty sure I remember that there was an integrated ""run tests"" action in monodevelop, and I would like to use this to run the tests. According to this article there should be a ""View - Unit Tests"" menu item. However, I must be doing something wrong/special because I can't find it.How do I run my NUnit tests with Monodevelop? <code> ","Where is ""Run Tests"" in monodevelop"
How to bind DataGrid in wpf from List," I am trying to bind a DataGrid to a generic list in WPF.The following code results in blank rows for each row of data in my list (i.e. if i have 5 rows, it shows 5 rows, but doesn't shows any data in the cells): If I convert my list of objects to a DataTable, it works (shows data). For example: But if I had a List<DataRow>, how would I convert it to DataTable?What is the best practice for binding a DataGrid to a `List' in WPF? <code>  List<DataRow> DataBindingSource = GuestList.Where(row => (row.Field<long>(""FK_GROUP_ID"") == Int64.Parse(cmbGroup.SelectedValue.ToString())) && (row.Field<long>(""FK_AGE_GROUP_ID"") != (int)L_Age_Group.Child)) .ToList();gvwAddultDetails.ItemsSource = DataBindingSource; List<DataRow> DataBindingSource = GuestList.Where(row => (row.Field<long>(""FK_GROUP_ID"") == Int64.Parse(cmbGroup.SelectedValue.ToString())) && (row.Field<long>(""FK_AGE_GROUP_ID"") != (int)L_Age_Group.Child)) .ToList();gvwAdultDetails.ItemsSource = DataBindingSource.CopyToDataTable().DefaultView;",Best way to bind DataGrid to generic list in WPF
Hiding a form and showing another when a button is clicked in a Windows Forms Application," I am doing an application a Windows Form application. At first, a certain form appears, and after the user hits the next button, this form should be hidden and another form is shown.I tried to do it. I managed to hide the current form, but the next one won't show.Here is my attempt:This is the button's event handler This is the main function: <code>  private void button1_Click_1(object sender, EventArgs e){ if (richTextBox1.Text != null) { this.Visible=false; } else MessageBox.Show(""Insert Attributes First !"");} static void Main(){ Application.EnableVisualStyles(); Application.SetCompatibleTextRenderingDefault(false); Form2 form2 = new Form2(); Form1 form1 = new Form1(); form2.Hide(); Application.Run(form1); while (true) { if (form1.Visible == false) form2.Show(); }}",Hiding a form and showing another when a button is clicked in a Windows Forms application
Upload multiple files using Plupload and ASP.NET/C#," UPDATEI was able to get everything to work properly and I just wanted to post back with the updated code. I used Darin Dimitrov's suggestion on using a separate generic http handler for handling the file uploads and so this is the code I came up with for that... let me know if you have questions. I'm trying to integrate the Plupload file uploader in ASP.NET using C#. I've read the Angry Monkeys article as well as the Marco Valsecchi blog post but I'm a little lost.The C# that the above articles suggest is roughly similar to the following: First, I have set up the Plupload configuration as follows: ... but I feel like I'm missing something here that will be necessary for the uploading to work.I guess my main question is how do I call the above C# code so that the uploading can begin? I have a form on a page named SubmitRequest.aspx. Clicking 'Submit' on the form results in the following: ... so the uploader starts when 'Submit' is clicked and uploads the files. Once that is done, the rest of the form is submitted. I don't understand how to link this event to the C# code that will handle the uploading to a folder TicketUploads on the server.I apologize for the longish post, but I would appreciate any help :) <code>  <%@ WebHandler Language=""C#"" Class=""Upload"" %>using System;using System.Configuration;using System.Data;using System.Data.SqlClient;using System.IO;using System.Net;using System.Web;public class Upload : IHttpHandler { public void ProcessRequest(HttpContext context) { /** * If 'newTicket' is ""false"", then the directory to upload to already exists and we can extract it from * the 'ticketID' POST parameter. * * If 'newTicket' is ""true"", then this is a new Ticket submission so we need to work with a NEW directory * on the server, so the ID needs to be 1 more than the total number of directories in ~/TicketUploads/ */ String newTicket = context.Request[""newTicket""] != null ? context.Request[""newTicket""] : String.Empty; int theID = -1; if (newTicket.Equals(""true"")) { // we need to calculate a new ID theID = getNewID(context); // calculate the new ID = # of rows theID++; // add 1 to make it unique } else if (newTicket.Equals(""false"")) { // we can just get the ID from the POST parameter theID = context.Request[""ticketID""] != null ? Convert.ToInt32(context.Request[""ticketID""]) : -1; } else { // something went wrong with the 'newTicket' POST parameter context.Response.ContentType = ""text/plain""; context.Response.Write(""Error with 'newTicket' POST parameter.""); } // if theID is negative, something went wrong... can't continue if (theID < 0) { return; } // ready to read the files being uploaded and upload them to the correct directory int chunk = context.Request[""chunk""] != null ? int.Parse(context.Request[""chunk""]) : 0; string fileName = context.Request[""name""] != null ? context.Request[""name""] : string.Empty; var uploadPath = context.Server.MapPath(""~/TicketUploads/"" + theID + ""/""); HttpPostedFile fileUpload = context.Request.Files[0]; // if the NEW directory doesn't exist, create it DirectoryInfo di = new DirectoryInfo("""" + uploadPath + """"); if (!(di.Exists)) { di.Create(); } using (var fs = new FileStream(Path.Combine(uploadPath, fileName), chunk == 0 ? FileMode.Create : FileMode.Append)) { var buffer = new byte[fileUpload.InputStream.Length]; fileUpload.InputStream.Read(buffer, 0, buffer.Length); fs.Write(buffer, 0, buffer.Length); } context.Response.ContentType = ""text/plain""; context.Response.Write(""File uploaded.""); return; }} int chunk = Request.QueryString[""chunk""] != null ? int.Parse(Request.QueryString[""chunk""]) : 0;string fileName = Request.QueryString[""name""] != null ? Request.QueryString[""name""] : string.Empty;HttpPostedFile fileUpload = Request.Files[0];using (FileStream fs = new FileStream(Server.MapPath(""~/TicketUploads/"" + fileName), chunk == 0 ? FileMode.Create : FileMode.Append)){ Byte[] buffer = new Byte[fileUpload.InputStream.Length]; fileUpload.InputStream.Read(buffer, 0, buffer.Length); fs.Write(buffer, 0, buffer.Length); fs.Close();} $(""#plupload_container"").pluploadQueue({ runtimes: 'html5,gears,flash,silverlight,html4', flash_swf_url: '../plupload/js/plupload.flash.swf', silverlight_xap_url: '../plupload/js/plupload.silverlight.xap', filters: [ { title: ""Image files"", extensions: ""jpg,gif"" }, { title: ""Zip files"", extensions: ""zip"" }, { title: ""Document files"", extensions: ""doc,pdf,txt"" } ]}); $('form').submit(function (e) { // Validate number of uploaded files if (uploader.total.uploaded == 0) { // Files in queue upload them first if (uploader.files.length > 0) { // When all files are uploaded submit form uploader.bind('UploadProgress', function () { if (uploader.total.uploaded == uploader.files.length) $('form').submit(); }); uploader.start(); } e.preventDefault(); }});",using Plupload with ASP.NET/C#
File uploading in ASP.NET/C# - Plupload," UPDATEI was able to get everything to work properly and I just wanted to post back with the updated code. I used Darin Dimitrov's suggestion on using a separate generic http handler for handling the file uploads and so this is the code I came up with for that... let me know if you have questions. I'm trying to integrate the Plupload file uploader in ASP.NET using C#. I've read the Angry Monkeys article as well as the Marco Valsecchi blog post but I'm a little lost.The C# that the above articles suggest is roughly similar to the following: First, I have set up the Plupload configuration as follows: ... but I feel like I'm missing something here that will be necessary for the uploading to work.I guess my main question is how do I call the above C# code so that the uploading can begin? I have a form on a page named SubmitRequest.aspx. Clicking 'Submit' on the form results in the following: ... so the uploader starts when 'Submit' is clicked and uploads the files. Once that is done, the rest of the form is submitted. I don't understand how to link this event to the C# code that will handle the uploading to a folder TicketUploads on the server.I apologize for the longish post, but I would appreciate any help :) <code>  <%@ WebHandler Language=""C#"" Class=""Upload"" %>using System;using System.Configuration;using System.Data;using System.Data.SqlClient;using System.IO;using System.Net;using System.Web;public class Upload : IHttpHandler { public void ProcessRequest(HttpContext context) { /** * If 'newTicket' is ""false"", then the directory to upload to already exists and we can extract it from * the 'ticketID' POST parameter. * * If 'newTicket' is ""true"", then this is a new Ticket submission so we need to work with a NEW directory * on the server, so the ID needs to be 1 more than the total number of directories in ~/TicketUploads/ */ String newTicket = context.Request[""newTicket""] != null ? context.Request[""newTicket""] : String.Empty; int theID = -1; if (newTicket.Equals(""true"")) { // we need to calculate a new ID theID = getNewID(context); // calculate the new ID = # of rows theID++; // add 1 to make it unique } else if (newTicket.Equals(""false"")) { // we can just get the ID from the POST parameter theID = context.Request[""ticketID""] != null ? Convert.ToInt32(context.Request[""ticketID""]) : -1; } else { // something went wrong with the 'newTicket' POST parameter context.Response.ContentType = ""text/plain""; context.Response.Write(""Error with 'newTicket' POST parameter.""); } // if theID is negative, something went wrong... can't continue if (theID < 0) { return; } // ready to read the files being uploaded and upload them to the correct directory int chunk = context.Request[""chunk""] != null ? int.Parse(context.Request[""chunk""]) : 0; string fileName = context.Request[""name""] != null ? context.Request[""name""] : string.Empty; var uploadPath = context.Server.MapPath(""~/TicketUploads/"" + theID + ""/""); HttpPostedFile fileUpload = context.Request.Files[0]; // if the NEW directory doesn't exist, create it DirectoryInfo di = new DirectoryInfo("""" + uploadPath + """"); if (!(di.Exists)) { di.Create(); } using (var fs = new FileStream(Path.Combine(uploadPath, fileName), chunk == 0 ? FileMode.Create : FileMode.Append)) { var buffer = new byte[fileUpload.InputStream.Length]; fileUpload.InputStream.Read(buffer, 0, buffer.Length); fs.Write(buffer, 0, buffer.Length); } context.Response.ContentType = ""text/plain""; context.Response.Write(""File uploaded.""); return; }} int chunk = Request.QueryString[""chunk""] != null ? int.Parse(Request.QueryString[""chunk""]) : 0;string fileName = Request.QueryString[""name""] != null ? Request.QueryString[""name""] : string.Empty;HttpPostedFile fileUpload = Request.Files[0];using (FileStream fs = new FileStream(Server.MapPath(""~/TicketUploads/"" + fileName), chunk == 0 ? FileMode.Create : FileMode.Append)){ Byte[] buffer = new Byte[fileUpload.InputStream.Length]; fileUpload.InputStream.Read(buffer, 0, buffer.Length); fs.Write(buffer, 0, buffer.Length); fs.Close();} $(""#plupload_container"").pluploadQueue({ runtimes: 'html5,gears,flash,silverlight,html4', flash_swf_url: '../plupload/js/plupload.flash.swf', silverlight_xap_url: '../plupload/js/plupload.silverlight.xap', filters: [ { title: ""Image files"", extensions: ""jpg,gif"" }, { title: ""Zip files"", extensions: ""zip"" }, { title: ""Document files"", extensions: ""doc,pdf,txt"" } ]}); $('form').submit(function (e) { // Validate number of uploaded files if (uploader.total.uploaded == 0) { // Files in queue upload them first if (uploader.files.length > 0) { // When all files are uploaded submit form uploader.bind('UploadProgress', function () { if (uploader.total.uploaded == uploader.files.length) $('form').submit(); }); uploader.start(); } e.preventDefault(); }});",using Plupload with ASP.NET/C#
ASP.NET: removing BOTH table and span tags from asp:datalist," A DataListis rendered with <table> or <span> tags, which I don't want.I've set RepeatLayout=""Flow"" but that still gives me spans.I've set RepeaterDirection=""Horizontal"" but that still give me the tables.how can i get a simple datalist without all the spans \ tables? Thanks in advance! <code>  <asp:DataList ID=""MyDataList"" runat=""server"" RepeatLayout=""Flow"" RepeatDirection=""Horizontal""> <ItemTemplate> .... </ItemTemplate></asp:Datalist>",Removing both table and span tags from asp:DataList
"AutoMapper: How to ignore all destination members, except the ones that are mapped?"," Is there a way to do this? We have a SummaryDto that maps from three different types, and when we create a map for each type, props that are not mapped are throwing an error. There are about 35 attributes on the summary dto. To use Ignore() option on each one is just too much trouble. Is there a global ignore? Something like <code>  CreateMap<Source,Target>() .IgnoreAllUnmapped();","How to ignore all destination members, except the ones that are mapped?"
Detect active screen changed using C# without polling," How might one invoke a callback whenever the current active window changes. I've seen how it might be done using CBTProc. However, global events aren't easy to hook into with managed code. I'm interested in finding a way that doesn't require polling. I'd prefer an event driven approach.Regards <code> ",Detect active window changed using C# without polling
"Using linq or otherwise, how do check if all list items have the same value and return it, or return an otherValue if they dont?"," If all the items in a list have the same value, then I need to use that value, otherwise I need to use an otherValue. I cant think of a simple and clear way of doing this. When the list is empty it should return the ""other"" value.See also Neat way to write loop that has special logic for the first item in a collection. <code> ","How to check if all list items have the same value and return it, or return an otherValue if they dont?"
Programatically disable 'Required Checkout' using sharepoint webservices, How does one programatically disable the 'Required Checkout' field of a column inside a sharepoint document library using sharepoint webservices?Preferably using C# <code> ,Programmatically disable 'Required Checkout' using sharepoint webservices
C# serialization," Could someone please explain what's the difference between inheriting from ISerializable interface and declaring your object as [Serializable]?I know that in the first case you are have to implement the ISerializable interface members, while in the second case this work is likely to be done by the C# itself.But what doesn't make sense to me then is the following behavior: Now, if I have some class like this: And unfortunately I can't call my X.Foo<Value>(), because the compiler says: I'm pretty sure it's my misunderstanding of something obvious, so please point out what am I doing wrong.UPDATE (IMPORTANT :)How do I make the where T : ISerializable statement work with [Serializable] class too? Is there a way?What I'm trying to achieve is the compilation-time error if the supplied type T is not serializable (by using [Serializable] or ISerializable way). Obviously, my current check handles only the second case, so how do I make it handle both of them? <code>  public void Foo<T>() where T : ISerializable{ // Whatever} [Serializable]public class Value{ public String Value { get; set; }} There is no implicit reference conversion from 'Value' to 'System.Runtime.Serialization.ISerializable'",.NET Runtime Serialization
C# - mocking generic methods," Assume I have some interface with a generic method and no parameters: Now I wish to implement the mock for this class (I'm using Moq) and I wish to mock this method for some concrete type - let's say I'm mocking Method<String>() calls. The idea of ???? should be clear - this lambda expression should handle the case when T in the Method<T> is actually a String.Is there any way I can achieve the wanted behavior? <code>  public interface Interface { void Method<T>();} mock = new Mock<Interface>();mock.Setup(x => x.Method ????).Returns(String(""abc""));",Mocking generic methods
Run specific unit test in visual studios," I have dozens of unit tests, and I'd like to fix the code I am working on now, but every time I run the tests it takes over 30 seconds to run every unit test (I think reflection is the cause of some of these being especially slow). My current test and many other tests take less than one second to run, but it is annoying to disable and then enable specific unit tests.Is there a way to say, ""For now, run a single, specific test?""I'm using Visual Studio 2010 with the built-in unit test system. I create tests by right-clicking any code and selecting ""create unit test"" which creates a project. <code> ",Run specific unit test in Visual Studio
Computing a covariance matrix," this question seems surprisingly obscure...I asked google before posting it here and the closest thing I found that resemble an answer is this : Covariance matrix computationHowever I am not sure of the answer, from the comments.What would be the best way to correctly compute a covariance matrix in C#?Any good free library?Thanks! <code> ",How to compute a covariance matrix
WPF thread model: can I update data context in a non-UI thread?," Can we update the data context of a WPF control in a non-UI thread?Say we have a Label that has MyClass as data context, and bind Content to MyProperty: <Label Name=""label"" Content=""{Binding MyProperty}"" />, where MyClass is simply: In a non-UI thread, we can do myClass.MyProperty = ""updated"" to update the content of the label, but we cannot do label.Content = ""updated"" directly. Is that correct?My own answer:Here's what I've found:From a non-UI thread, you cannot update a control;From a non-UI thread, you can update properties of a control's data context;From a non-UI thread, you cannot add items to or remove items from an ObserverableCollection that is bound to a control. But there is a workaround: http://geekswithblogs.net/NewThingsILearned/archive/2008/01/16/have-worker-thread-update-observablecollection-that-is-bound-to-a.aspx <code>  public class MyClass : INotifyPropertyChanged{ int _myField; public int MyProperty { get { return _myField; } set { _myField = value; PropertyChanged(this, new PropertyChangedEventArgs(""MyProperty"")); } } public event PropertyChangedEventHandler PropertyChanged;}",WPF threading: can I update a control's data context in a non-UI thread?
WPF thread: can I update a control's data context in a non-UI thread?," Can we update the data context of a WPF control in a non-UI thread?Say we have a Label that has MyClass as data context, and bind Content to MyProperty: <Label Name=""label"" Content=""{Binding MyProperty}"" />, where MyClass is simply: In a non-UI thread, we can do myClass.MyProperty = ""updated"" to update the content of the label, but we cannot do label.Content = ""updated"" directly. Is that correct?My own answer:Here's what I've found:From a non-UI thread, you cannot update a control;From a non-UI thread, you can update properties of a control's data context;From a non-UI thread, you cannot add items to or remove items from an ObserverableCollection that is bound to a control. But there is a workaround: http://geekswithblogs.net/NewThingsILearned/archive/2008/01/16/have-worker-thread-update-observablecollection-that-is-bound-to-a.aspx <code>  public class MyClass : INotifyPropertyChanged{ int _myField; public int MyProperty { get { return _myField; } set { _myField = value; PropertyChanged(this, new PropertyChangedEventArgs(""MyProperty"")); } } public event PropertyChangedEventHandler PropertyChanged;}",WPF threading: can I update a control's data context in a non-UI thread?
Accessing UI Control from BackgroundWorker Thread - C#," I have a button on my windows form that calls the RunWorkerAsync() method, this in turn performs an action which then updates a ListBox on the same form.After the DoWork event has finished I assign the Result for the event (Which is a list), I process the RunWorkerCompleted() event and then perform the following code to update my Listboxwhich calls this:(Apologies, code formatting won't work)Now when I run the application and press the refresh button the following exception appears:How would I get around this?Edit:The exception is thrown on the folowing statement, this occurs in the DoWork method where I clear the contents to keep the list up to date;listBoxServers.Items.Clear(); <code> ",Accessing UI Control from BackgroundWorker Thread
"C#.NET MDI bugs when programicaly hiding and showing again a maximized child form and when maximized, child form's icon cannot be changed"," Basically I am having two problems with C#.NET MDI. You can download VS2010 solution which reproduces bugs here.1) When programmatically hiding and showing again a maximized child form, it is not maximized properly again and becomes neither maximized or in normal state. When child form is maximized, then programicaly hidden and shown again, it becomes something like this (please notice the menu bar - child form's control box appears, but child form is not maximized):At this stage, child form cannot be moved around. However, I found a workaround for that, simply by showing and hiding a dummy child form, which forces the actual child form to become properly maximized. But this makes MDI area to flicker. Tried Invalidate, Refresh, Update methods, but they don't help. Maybe there are other workarounds to overcome this bug and not to make MDI area flicker with dummy child form? 2) When child form is maximized, the icon of the child form is displayed on menu bar. However, if you have to change the icon while the child form is maximized, the icon on the menu bar is not being refreshed (see the image above). I found a workaround for that too, which basically hides and shows menu bar. Icon gets refreshed, but it makes everything below menu bar to flicker. Tried Invalidate, Refresh, Update methods, but they don't help. Is there any other way to make menu bar to refresh the child form's icon? Also I noticed that when parent form is in normal window state mode (not maximized) and you change the width or height of the form by 1 pixel, child form becomes maximized as it should be and child form's icon on menu bar gets refreshed properly and you don't need other workaround I described above. If I change the size of the form programicaly, form flickers by 1 pixel and I cannot do that, when parent form is maximized. Is there any way how I could invoke the repaint/refresh functionality which is called when you resize a form and which makes child form become maximized properly and the icon on the menu bar refreshed?  <code>  childForm = new Form();childForm.Text = ""Child Form"";childForm.MdiParent = this;...private void showButton_Click(object sender, EventArgs e){ childForm.Visible = true;}...private void hideButton_Click(object sender, EventArgs e){ childForm.Visible = false;} private void workaround1Button_Click(object sender, EventArgs e){ dummyForm.Visible = true; dummyForm.Visible = false;} private void workaround2Button_Click(object sender, EventArgs e){ menuStrip.Visible = false; menuStrip.Visible = true;}","C#.NET MDI bugs when programmatically hiding and showing again a maximized child form and when maximized, child form's icon cannot be changed"
how to get attribute in the XDocument object," I have this xml I want my code to able to do something like this How do I do this with LINQ XDocument?What I have so far is the XDocument Object loaded with that xml string.  <code>  <config> <audio first=""true"" second=""false"" third=""true"" /></config> if (xdoc.getAttr(""first"")==""true"") Console.Write(""first is true"");",How to get attribute in the XDocument object
Bow to get attribute in the XDocument object," I have this xml I want my code to able to do something like this How do I do this with LINQ XDocument?What I have so far is the XDocument Object loaded with that xml string.  <code>  <config> <audio first=""true"" second=""false"" third=""true"" /></config> if (xdoc.getAttr(""first"")==""true"") Console.Write(""first is true"");",How to get attribute in the XDocument object
I have a program that needs to display results in collums and i cant seem to get the alingment right with the tabs.," I have a sort of column display, but the end two column's seem to not be aligning correctly. This is the code I have at the moment: <code>  Console.WriteLine(""Customer name "" + ""sales "" + ""fee to be paid "" + ""70% value "" + ""30% value"");for (int DisplayPos = 0; DisplayPos < LineNum; DisplayPos = DisplayPos + 1){ seventy_percent_value = ((fee_payable[DisplayPos] / 10.0) * 7); thirty_percent_value = ((fee_payable[DisplayPos] / 10.0) * 3); Console.WriteLine(customer[DisplayPos] + "" "" + sales_figures[DisplayPos] + "" "" + fee_payable[DisplayPos] + "" "" + seventy_percent_value + "" "" + thirty_percent_value);}",How can I align text in columns using Console.WriteLine?
C# Creation Date and File.Copy Issue," I am trying to copy files from one directory to another and test based upon the file creation date. The problem occurs later in my program when I checked the creation date to ensure it is no more than 5 days old. I have seen that the creation date when copied back is set to 1980-01-01. This is not useful for my requirements as I would like maintain the creation date from the original file. Is there another method of comparing the dates or is it the copy that loses the creation date value.I guess my question is, how can I maintain the Creation Date? <code>  File.Copy(fileName, directory + fileNameOnly, true); FileInfo file = new FileInfo(fileName);if (file.CreationTime.AddHours(120) < DateTime.Now) {}",Creation Date and File.Copy Issue
No ItemChecked event in a CheckedListBox," The ListView control has an ItemCheck event which is fired before the item changes, and an ItemChecked event that is fired after the item changes. See this SO question for more detail.The CheckedListBox control only has the ItemCheck event.What is the best way to do something like this with a CheckedListBox? Supplemental question:Why is there no CheckedListBox.ItemChecked event? <code>  private void checkedListBox_ItemChecked(object sender ItemCheckedEventArgs e){ okButton.Enabled = (checkedListBox.CheckedItems.Count > 0);}",No ItemChecked event in a CheckedListBox?
exporting from dataset to tab limited file, I have data in a dataset. How would I export it into a tab delimited file? <code> ,Exporting from a dataset to a tab delimited file
How to produce a StackOverflow Exception with a few lines of code?, How can I produce a StackOverflowException with minimal lines of code? <code> ,How to produce a StackOverflowException with a few lines of code?
How null + true is a string ?," Since true is not a string type, how is null + true a string ? What is the reason behind this? <code>  string s = true; //Cannot implicitly convert type 'bool' to 'string' bool b = null + true; //Cannot implicitly convert type 'string' to 'bool'",How is null + true a string ?
HttpWebRequest.GetRequestStream gives Timeout on SSL connect in Windows 7/Vista," I have an C# windows application (.Net 3.0 Framework) that makes a call to PHP web service using HttpWebRequest.In Win 7 & Vista, if the call is made via non-SSL (i.e. http://), the code works fine. When the call is changed to call the SSL(https:) version of the link, it times out at the HttpWebRequest.GetRequestStream(). This happens every time. When this same application is run on a Windows XP machine it works fine with either the HTTP or the HTTPS url being used. The code does have the accept all server certificates code in it. Also, I have added System.Net logging. It writes out the log but because the packets are encrypted you really don't see much except for the Timeout abort statement. I've also tried Fiddler but again with the encrypted packets, I don't see much. BTW, when I try to use Fiddler2 to decrypt the app hangs so that has not been successful.Anyway, any help would be appreciated. Thanks.I will add:I can telnet into the portI have tried running the app as AdministratorI have tried the Win XP compatibility mode (trying anything)I have singled the connect code out into a simple stand-alone app <code> ",HttpWebRequest.GetRequestStream() breaks by timeout on SSL connection under Windows 7/Vista
How to now if native method is safe / unsafe?," I implement this function : GetSystemPowerStatusEx & GetSystemPowerStatusEx2according to this article on MSDN, I should create a class named according to the functions I will use, but my question is : How can I know in which class I should put GetSystemPowerStatusEx & GetSystemPowerStatusEx2 ?I'm lost...Thanks for help.[EDIT] My question is : which of these three class names are the good one for me (NativeMethods / SafeNativeMethods / UnsafeNativeMethods) ? These methods should be in one of the following classes: NativeMethods - This class does not suppress stack walks for unmanaged code permission. (System.Security.SuppressUnmanagedCodeSecurityAttribute must not be applied to this class.) This class is for methods that can be used anywhere because a stack walk will be performed. SafeNativeMethods - This class suppresses stack walks for unmanaged code permission. (System.Security.SuppressUnmanagedCodeSecurityAttribute is applied to this class.) This class is for methods that are safe for anyone to call. Callers of these methods are not required to perform a full security review to make sure that the usage is secure because the methods are harmless for any caller. UnsafeNativeMethods - This class suppresses stack walks for unmanaged code permission. (System.Security.SuppressUnmanagedCodeSecurityAttribute is applied to this class.) This class is for methods that are potentially dangerous. Any caller of these methods must perform a full security review to make sure that the usage is secure because no stack walk will be performed. <code> ",How to know if native method is safe / unsafe?
type of int? variable in c#, why is typeof int? an Int32 If it is okay then what's the use of Nullable.GetUnderlyingType? <code>  int? x = 1;Console.WriteLine(x.GetType().Name);,"Whats the use of Nullable.GetUnderlyingType, if typeof(int?) is an Int32?"
"Whats the use of `Nullable.GetUnderlyingType`, if `typeof(int?)` is Int32?", why is typeof int? an Int32 If it is okay then what's the use of Nullable.GetUnderlyingType? <code>  int? x = 1;Console.WriteLine(x.GetType().Name);,"Whats the use of Nullable.GetUnderlyingType, if typeof(int?) is an Int32?"
"Whats the use of `Nullable.GetUnderlyingType`, if `typeof(int?)` is `Int32`?", why is typeof int? an Int32 If it is okay then what's the use of Nullable.GetUnderlyingType? <code>  int? x = 1;Console.WriteLine(x.GetType().Name);,"Whats the use of Nullable.GetUnderlyingType, if typeof(int?) is an Int32?"
C# - Using the same lock for muliple methods," I haven't had any issues using the same lock for multiple methods so far, but I'm wondering if the following code might actually have issues (performance?) that I'm not aware of: The 3 methods and the collections are not related in anyway.In addition, will it be a problem if this lockObj is also used by a singleton (in Instance property) ?Edit: To clarify my question on using the same lock object in a Singleton class: Will this cause issues? <code>  private static readonly object lockObj = new object();public int GetValue1(int index){ lock(lockObj) { // Collection 1 read and/or write }}public int GetValue2(int index){ lock(lockObj) { // Collection 2 read and/or write }}public int GetValue3(int index){ lock(lockObj) { // Collection 3 read and/or write }} private static readonly object SyncObject = new object();public static MySingleton Instance{ get { lock (SyncObject) { if (_instance == null) { _instance = new MySingleton(); } } return _instance; }}public int MyMethod(){ lock (SyncObject) { // Read or write } }",Using the same lock for multiple methods
Using the same lock for muliple methods," I haven't had any issues using the same lock for multiple methods so far, but I'm wondering if the following code might actually have issues (performance?) that I'm not aware of: The 3 methods and the collections are not related in anyway.In addition, will it be a problem if this lockObj is also used by a singleton (in Instance property) ?Edit: To clarify my question on using the same lock object in a Singleton class: Will this cause issues? <code>  private static readonly object lockObj = new object();public int GetValue1(int index){ lock(lockObj) { // Collection 1 read and/or write }}public int GetValue2(int index){ lock(lockObj) { // Collection 2 read and/or write }}public int GetValue3(int index){ lock(lockObj) { // Collection 3 read and/or write }} private static readonly object SyncObject = new object();public static MySingleton Instance{ get { lock (SyncObject) { if (_instance == null) { _instance = new MySingleton(); } } return _instance; }}public int MyMethod(){ lock (SyncObject) { // Read or write } }",Using the same lock for multiple methods
Reduce TypeText delay in Watin," How does one reduce the delay between keypresses in the TypeText method of Watin? Is there a better way if I want to ""instantaneously"" type some text? <code> ",How can the TypeText delay in Watin be reduced?
stepping into a linq query," Is it possible to step into a linq query? I have a linq to entity framework 4 query in it's simplest form: It's a query against an Entity Framework DbContext and I'm having trouble seeing why it works for something like:List searching for 001 yields no results against the following listTest001Test002Test003Test004However any other search yields results (Such as t00 or Test)UpdateBasically I'm looking for why a query such as the above wouldn't return a result when I'm using a contains and the value matches the end of a string vs just the middle or begining. It's really confusing.OK, it appears to have something to do with ToLowerInvariant() - when I removed that method it works just fine. <code>  List = List.Where(f => f.Value.ToString().ToLowerInvariant().Contains(filter.ToLowerInvariant()));",EF Query using .Contains() and .ToLowerInvariant() Results in no matches when match is found at the end of a string
"When using source control, what files should actually be commited?"," I am working on a small project, hosted on Google Code, using SVN for source control. This is my first time using source control, and I'm a bit confused about what I should actually be committing to the repository. My project is very simple: A Class Library project, written in C#. The actual code that I have written is a single file. My question is this: Should I be committing the entire project (including directories like Debug, Release, Properties, etc.) or just my main .cs file?After fighting with Subversion for a while (note to self: do not reset repository), it looks like I finally have it working with the directories laid out properly. <code> ","When using source control, what files should actually be committed?"
Speed of different constructs are in programming languages (Java/C#/C++/Python/)," My boss just told me that he learned about fast VB6 algorithms from a book and that the shortest way to write things is not necessarily the fastest (e.g. builtin methods are sometimes way slower than selfwritten ones because they do all kinds of checking or unicode conversions which might not be necessary in your case).Now I wonder, is there a website with info on fast different constructs are in various languages, esp. Java/C#/Python/ (also C++ but there are so many compilers which probably differ a lot).E.g. is there a difference between and Another example: is a = a * 4 maybe compiled to the same code as a <<= 2?I could test this myself, of course, writing both then running them 100000 times and comparing the runtime, but I'd also like to learn about new ways to write things, maybe even things that I hadn't considered before. Thanks for your answers! <code>  if (a()) b(); a() && b();",Speed of different constructs in programming languages (Java/C#/C++/Python/)
"How to create and Expression tree to do the same as ""StartsWith"" "," Currently, I have this method to compare two numbers It works fine and is consumed in this way As you can see, I give it an IQueryable collection and it add a where clause to it, base on a property and a value. Y can construct Lessthan, LessOrEqualThan etc equivalents as System.Linq.Expressions.Expression has this operators predefined.How can I transform this code to do the same with strings? System.Linq.Expressions.Expression don't give me a predefined operator like ""contains"" or ""startwith"" and I'm really noob with Expression trees.Thanks, and please Post your answer in C#/VB. Choose the one that make you feel more confortable. <code>  Private Function ETForGreaterThan(ByVal query As IQueryable(Of T), ByVal propertyValue As Object, ByVal propertyInfo As PropertyInfo) As IQueryable(Of T) Dim e As ParameterExpression = Expression.Parameter(GetType(T), ""e"") Dim m As MemberExpression = Expression.MakeMemberAccess(e, propertyInfo) Dim c As ConstantExpression = Expression.Constant(propertyValue, propertyValue.GetType()) Dim b As BinaryExpression = Expression.GreaterThan(m, c) Dim lambda As Expression(Of Func(Of T, Boolean)) = Expression.Lambda(Of Func(Of T, Boolean))(b, e) Return query.Where(lambda)End Function query = ETForGreaterThan(query, Value, propertyInfo)","How to create an Expression tree to do the same as ""StartsWith"" "
Invalid length for a Base-64 char array during dycryption," Q: I face the following big problem :from time to another i find the following exception:Invalid length for a Base-64 char arrayI use encryption and decryption: i read many articles about the problem some posts talking about the solution is:text = text.Replace("" "", ""+"")and this not fixes my problem at allmy string is :3DZF/NZpp0yuQ=3Dplease i need help to fix this problem.EDITIf there are any modifications orenhancements to this class to make itwork better or more secure or avoidany possible problems like this , iwill be grateful.If there are alternating classes instead of this,moresecure and doesn't make theseproblems , I will be grateful.I use this class in a smallapplication used to verifying mails.EDIT: https://stackoverflow.com/a/10879400/418343 <code>  public static string Encrypt(string text) { try { key = Encoding.UTF8.GetBytes(stringKey.Substring(0, 8)); DESCryptoServiceProvider des = new DESCryptoServiceProvider(); Byte[] byteArray = Encoding.UTF8.GetBytes(text); MemoryStream memoryStream = new MemoryStream(); CryptoStream cryptoStream = new CryptoStream(memoryStream,des.CreateEncryptor(key, IV), CryptoStreamMode.Write); cryptoStream.Write(byteArray, 0, byteArray.Length); cryptoStream.FlushFinalBlock(); return Convert.ToBase64String(memoryStream.ToArray()); } catch (Exception ex) { string message = ex.Message; } return string.Empty; } public static string Decrypt(string text) { try { key = Encoding.UTF8.GetBytes(stringKey.Substring(0, 8)); DESCryptoServiceProvider des = new DESCryptoServiceProvider(); text = text.Replace("" "", ""+"") Byte[] byteArray = Convert.FromBase64String(text); MemoryStream memoryStream = new MemoryStream(); CryptoStream cryptoStream = new CryptoStream(memoryStream, des.CreateDecryptor(key, IV), CryptoStreamMode.Write); cryptoStream.Write(byteArray, 0, byteArray.Length); cryptoStream.FlushFinalBlock(); return Encoding.UTF8.GetString(memoryStream.ToArray()); } catch (Exception ex) { string message = ex.Message; } Decoding the querystring values is done already when it's parsed into the Request.",Invalid length for a Base-64 char array during decoding/decryption
Linq and Xdocument: How to create XML File?," I have a three List in c# ,the variable names are l_lstData1, l_lstData2, l_lstData3.File structure is The Values of 3 Lists are as follows : so the level attribute of the above XML(element : Data) has value=""2"". so the level attribute of the above XML(element : Data) has value=""1"". so the level attribute of the above XML (element: Data) has value=""0"". <code>  <FileDetails> <Date FileModified=""29/04/2010 12:34:02"" /> <Data Name=""Data_1"" DataList=""India"" Level=""2"" /> <Data Name=""Data_2"" DataList=""chennai"" Level=""2"" /> <Data Name=""Data_3"" DataList=""hyderabad"" Level=""2"" /> <Data Name=""Data_4"" DataList=""calcutta"" Level=""2"" /> <Data Name=""Data_5"" DataList=""vijayawada"" Level=""1"" /> <Data Name=""Data_6"" DataList=""cochin"" Level=""1"" /> <Data Name=""Data_7"" DataList=""madurai"" Level=""0"" /> <Data Name=""Data_8"" DataList=""trichy"" Level=""0"" /> </FileDetails> l_lstData1[0] = ""India""; l_lstData1[1] = ""chennai""; l_lstData1[2] = ""hyderabad""; l_lstData1[3] = ""calcutta""; l_lstData2[0] = ""vijayawada""; l_lstData2[1] = ""cochin""; l_lstData3[0] = ""madurai""; l_lstData3[1] = ""trichy""; ",LINQ and XDocument: How to create XML file?
LINQ and XDocument: How to create XML ile?," I have a three List in c# ,the variable names are l_lstData1, l_lstData2, l_lstData3.File structure is The Values of 3 Lists are as follows : so the level attribute of the above XML(element : Data) has value=""2"". so the level attribute of the above XML(element : Data) has value=""1"". so the level attribute of the above XML (element: Data) has value=""0"". <code>  <FileDetails> <Date FileModified=""29/04/2010 12:34:02"" /> <Data Name=""Data_1"" DataList=""India"" Level=""2"" /> <Data Name=""Data_2"" DataList=""chennai"" Level=""2"" /> <Data Name=""Data_3"" DataList=""hyderabad"" Level=""2"" /> <Data Name=""Data_4"" DataList=""calcutta"" Level=""2"" /> <Data Name=""Data_5"" DataList=""vijayawada"" Level=""1"" /> <Data Name=""Data_6"" DataList=""cochin"" Level=""1"" /> <Data Name=""Data_7"" DataList=""madurai"" Level=""0"" /> <Data Name=""Data_8"" DataList=""trichy"" Level=""0"" /> </FileDetails> l_lstData1[0] = ""India""; l_lstData1[1] = ""chennai""; l_lstData1[2] = ""hyderabad""; l_lstData1[3] = ""calcutta""; l_lstData2[0] = ""vijayawada""; l_lstData2[1] = ""cochin""; l_lstData3[0] = ""madurai""; l_lstData3[1] = ""trichy""; ",LINQ and XDocument: How to create XML file?
.Net assembly references being lost as soon as project is compiled," I have tried all the suggestions below but still no joy.I'm now trying a console application, and let me explain exactly what I'm doing. I create a new console project in VS 2010I add a number of references (dll's) some that aren't mine such as Castle.Winsor and N2 CMS dllsin the console app I can add using statements indicating I am using name spaces within the referenced DLLsI start writing code.As soon as I compile all the code that uses the referenced DLLs immediately complains with ""The type or namespace name '' could not be found (are you missing a using directive or an assembly reference?)""I have tried setting the dlls to copy to local always, I have copied the DLL into the same directory, I have tried added reference by project and adding a reference to the DLL's themselvesI don't get this problem with a web application project or a ASP.net project they always work fine, only something that is compiled to an EXE like a console app or windows service.there must be something I'm missing or I would have got this working by now. <code> ",Cannot use external references with C# Console Application
Cannot use external refernces with C# Console Application," I have tried all the suggestions below but still no joy.I'm now trying a console application, and let me explain exactly what I'm doing. I create a new console project in VS 2010I add a number of references (dll's) some that aren't mine such as Castle.Winsor and N2 CMS dllsin the console app I can add using statements indicating I am using name spaces within the referenced DLLsI start writing code.As soon as I compile all the code that uses the referenced DLLs immediately complains with ""The type or namespace name '' could not be found (are you missing a using directive or an assembly reference?)""I have tried setting the dlls to copy to local always, I have copied the DLL into the same directory, I have tried added reference by project and adding a reference to the DLL's themselvesI don't get this problem with a web application project or a ASP.net project they always work fine, only something that is compiled to an EXE like a console app or windows service.there must be something I'm missing or I would have got this working by now. <code> ",Cannot use external references with C# Console Application
Azure 1.3 SDK open two browser windows (or tabs)," Why is it that when run I website using Azure SDK 1.3 it opens two browser windows (or tabs) despite the fact that I have only defined one end point: What do I have to do to get just one browser window appearing when I run (using F5) my Azure application from Visual Studio? <code>  <Sites> <Site name=""Web""> <Bindings> <Binding name=""Endpoint1"" endpointName=""Endpoint1"" /> </Bindings> </Site></Sites>",Azure SDK 1.3 opens two browser windows (or tabs)
Generate a PNG file with C#," I'm trying to generate a PNG file using C#. Everything I google seems to be WPF related. My issue is, I need to create a PNG 50x50 square filled with green in .NET 2.0.My question is, how do I do this? I was looking in the System.Drawing namespace. But after all of that, I feel I'm way off. Can someone give me some pointers? <code> ",How to generate a PNG file with C#?
capture Shell command output in c sharp," Summary:query registry on remote machinecapture output to use in applicationneeds to be in csharpso far all methods used can only query on the local machineany hope is greatly appreciatedFull issue:I need to find a way to run a commandline command in csharp and capture its output. I know how to do this in Perl, below is the code I would use in Perl. Any suggestions on how to do this in csharp would be welcome. So far ive tried using the RegistryKey OurKey = Registry.Users method and it works great but i can not query the registry on a remote machine.Please let me know if you need any more information.SOLUTION:(Thank you to @Robaticus) <code>  #machine to checkmy $pc = $_[0];#create location of registry querymy $machine = ""\\\\"".$pc.""\\HKEY_USERS"";#run registry querymy @regQuery= `REG QUERY $machine`; private void reg(string host) { string build = ""QUERY \\\\"" + host + ""\\HKEY_USERS""; string parms = @build; string output = """"; string error = string.Empty; ProcessStartInfo psi = new ProcessStartInfo(""reg.exe"", parms); psi.RedirectStandardOutput = true; psi.RedirectStandardError = true; psi.WindowStyle = System.Diagnostics.ProcessWindowStyle.Normal; psi.UseShellExecute = false; System.Diagnostics.Process reg; reg = System.Diagnostics.Process.Start(psi); using (System.IO.StreamReader myOutput = reg.StandardOutput) { output = myOutput.ReadToEnd(); } using (System.IO.StreamReader myError = reg.StandardError) { error = myError.ReadToEnd(); } Output.AppendText(output + ""\n""); } ",How to capture Shell command output in C#?
update silently a windows service," I have built a Windows service, now I want it to auto-update. I have read about a creating a second service to do that or different program , cant use click one, what about myBuild? Does anyone know it? What is the best way? Can I just change assemblies?  <code> ",Silently update a Windows service
IE Error 404.11 and 400.0 - How come?," Why do the following URLs give me the IIS errors below:A) http://192.168.1.96/cms/View.aspx/Show/Small+test'A2) http://192.168.1.96/cms/View.aspx/Show/Small%20test' <-- this works, but is not the result from HttpUtility.UrlEncode()B) http://192.168.1.96/cms/View.aspx/Show/'%26$%23funky**!!~''+pageError for A: Error for B: The last part of the URL after /Show/ is the result after the text is being sent through HttpUtility.UrlEncode() so, according to Microsoft it is URL Encoded correctly.If I user HttpUtility.UrlPathEncode() rather than HttpUtility.UrlEncode() I get the A2 results. But B ends up looking like:http://192.168.1.96/TVCMS-CVJZ/cms/View.aspx/Show/'&$#funky**!!~''%20pagewhich is still wrong. Does Microsoft know how to URL Encode at all? Is there a function someone has written up to do it the correct way?EDIT:I've written my own encoder: The function works with A2 above just fine the result for B is:http://192.168.1.96/cms/View.aspx/Show/%27%26%24%23funky%2A%2A%21%21~%27%27%20pageBut even though that looks like a nice valid URL IIS still gives me aHTTP Error 400.0 - Bad RequestASP.NET detected invalid characters in the URL. <code>  HTTP Error 404.11 - Not FoundThe request filtering module is configured to deny a request that contains a double escape sequence. HTTP Error 400.0 - Bad RequestASP.NET detected invalid characters in the URL. static public string UrlEncode(string encode){ if (encode == null) return null; string encoded = """"; foreach (char c in encode) { int val = (int)c; if ((val >= 48 && val <= 57) || (val >= 65 && val <= 90) || (val >= 97 && val <= 122)) encoded += c; else encoded += ""%"" + val.ToString(""X""); } return encoded;}",Getting error 400 / 404 - HttpUtility.UrlEncode not encoding full string?
IEnumerable<object> a = new IEnumerable<object>(); Can i do this?, I want to create a new instance of an object IEnumerable<object>Can I do this? <code>  IEnumerable<object> a = new IEnumerable<object>();,IEnumerable<object> a = new IEnumerable<object>(); Can I do this?
Linq Distint() use delegate for equality comparer," I have a LINQ Distinct() statement that uses my own custom comparer, like this: This is all fine and dandy and works as I want. Out of curiosity, do I need to define my own Comparer, or can I replace it with a delegate? I thought I should be able to do something like this: But this doesn't compile. Is there a neat trick? <code>  class MyComparer<T> : IEqualityComparer<T> where T : MyType{ public bool Equals(T x, T y) { return x.Id.Equals(y.Id); } public int GetHashCode(T obj) { return obj.Id.GetHashCode(); }}...var distincts = bundle.GetAllThings.Distinct(new MyComparer<MySubType>()); var distincts = bundle.GetAllThings.Distinct((a,b) => a.Id == b.Id);",Use a delegate for the equality comparer for LINQ's Distinct()
Linq Distinct() use delegate for equality comparer," I have a LINQ Distinct() statement that uses my own custom comparer, like this: This is all fine and dandy and works as I want. Out of curiosity, do I need to define my own Comparer, or can I replace it with a delegate? I thought I should be able to do something like this: But this doesn't compile. Is there a neat trick? <code>  class MyComparer<T> : IEqualityComparer<T> where T : MyType{ public bool Equals(T x, T y) { return x.Id.Equals(y.Id); } public int GetHashCode(T obj) { return obj.Id.GetHashCode(); }}...var distincts = bundle.GetAllThings.Distinct(new MyComparer<MySubType>()); var distincts = bundle.GetAllThings.Distinct((a,b) => a.Id == b.Id);",Use a delegate for the equality comparer for LINQ's Distinct()
What is IP address '::1' ?," I was playing with sockets on local machine with no network connection. See below: So what is exactly ::1 IP address ? Is it the default available IP address or it's the loopback address ? what happens to above code (working line) on a machine with dedicated IP address and network connection ?EDIT:exact code is used to bind a specific IP address to socket. Here it is: <code>  IPAddress address = IPAddress.Any; // doesn't workIPAddress address = IPAddress.Parse(""::1""); // works ServicePoint sp = ServicePointManager.FindServicePoint(uri);sp.BindIPEndPointDelegate = new BindIPEndPoint(Bind);// here's the bind delegate:private IPEndPoint Bind(ServicePoint sp, IPEndPoint ep, int retryCount){ return new IPEndPoint(IPAddress.Parse(""::1""), 0);}",What is IP address '::1'?
ConcurrentBag TryTake failure," I'm thinking of using a ConcurrentBag in a program I'm writing, however I can't seem to find enough documentation on TryTake. I understand that the method might fail, but I can't find an explanation of the cases in which such failure might happen, and what state the collection will be left in after the failure.If it's only in the case of another thread having already removed the item then I don't care, but what I can't really afford is the item I want to remove to still be in the collection after the call. Can this ever be the case? <code> ",Under what circumstances can ConcurrentBag.TryTake() fail?
"Need of OrderedDictionary,ListDictionary and HybridDictionary"," What is the need of three different dictionaries- OrderedDictionary,ListDictionary and HybridDictionary when all of them perform similar functions?None of them is sorted, and elements of the collection can be retrieved by key in all of them. So, what is the purpose of three different classes? <code> ","What is the need of OrderedDictionary, ListDictionary, and HybridDictionary?`"
Specify which Property goes between `>` and `<` in Xaml, Consider the following Xaml It will set theText Property of a TextBox (only WPF)Content Property of a ButtonChildren Property of a GridBut how is this specified? How do you specify which Property that goes between the opening and closing tag in Xaml?Is this set by some metadata in the Dependency Property or what?Thanks <code>  <Grid> <TextBox>Text</TextBox> <Button>Content</Button></Grid>,Specify which Property goes between the opening and closing tag in Xaml
How to skip optional parameters in c#," Example: I'd like to call it like this: In other words, I want to provide x and z, but I want to use the default for Y, optionalY = 1.Visual Studio does not like the ,,Please help. <code>  public int foo(int x, int optionalY = 1, int optionalZ = 2) { ... } int returnVal = foo(5,,8); ",How to skip optional parameters in C#?
Best way to create application icon," What is the best way to create an icon for an application?From Visual Studio or maybe some another program.I create an icon in Visual Studio and use it as application icon, but when I put the icon shortcut on the desktop there is only some gray icon. Is this maybe because of icon dimensions or something else? <code> ",Best way to create an application icon
How to set ExportMetaData with multiple values as well as single w/ custom attribute ?," I have the following ExportMetaData attributes set on my class: I also have a supporting interface: And of course my ImportMany: What I would like to do is use a strongly-typed attribute class instead of using the ExportMetaData attribute. I have not figured out a way to do this while also supporting single values (Name, SupportsEditing, in the example above).I envision doing something similiar the following (or whatever is suggested as best): I am fairly certain that there IS a way to do this, I just haven't found the right way to connect the dots. :) <code>  [Export(typeof(IDocumentViewer))] [ExportMetadata(""Name"", ""MyViewer"")] [ExportMetadata(""SupportsEditing"", true)] [ExportMetadata(""Formats"", DocFormat.DOC, IsMultiple = true)] [ExportMetadata(""Formats"", DocFormat.DOCX, IsMultiple = true)] [ExportMetadata(""Formats"", DocFormat.RTF, IsMultiple = true)] public interface IDocumentViewerMetaData { /// <summary> /// Gets the format. /// </summary> /// <value>The format.</value> IEnumerable<DocFormat> Formats { get; } /// <summary> /// Gets the name of the viewer /// </summary> /// <value>The name.</value> string Name { get; } /// <summary> /// Gets a value indicating whether this viewer supports editing /// </summary> /// <value><c>true</c> if [supports editing]; otherwise, <c>false</c>.</value> bool SupportsEditing { get; } } [ImportMany(typeof(IDocumentViewer))]public IEnumerable<Lazy<IDocumentViewer, IDocumentViewerMetaData>> _viewers { get; set; } [Export(typeof(IDocumentViewer))][DocumentViewerMetadata(Name = ""MyViewer"")][DocumentViewerMetadata(SupportsEditing = true)][DocumentViewerMetadata(Format = DocFormat.DOC)][DocumentViewerMetadata(Format = DocFormat.DOCX)]",How to set ExportMetaData with multiple values as well as single w/ custom attribute?
extension methods on struct, Can you add extension methods to a struct? <code> ,Extension methods on a struct
Immutable List in C#," I have some class with List-property: I want provide access to this field only for read.I.e. I want property with access to Enumerable, Count, etc. and without access to Clear, Add, Remove, etc. How I can do it? <code>  class Foo { private List<int> myList;}",Read-Only List in C#
C#: split a string with delimiters but keep the delimiters in the result, I would like to split a string with delimiters but keep the delimiters in the result.How would I do this in C#? <code> ,Split a string with delimiters but keep the delimiters in the result in C#
How to trigger a timer tick programatically?," Let's say I have a Windows Forms timer configured with a 10 second (10k ms) interval: I want to start it and fire off the Tick event right away: The last line works but is there a better or more appropriate way? <code>  myTimer.Interval = 10000; myTimer.Start();myTimer_Tick(null, null);",How to trigger a timer tick programmatically?
Could not find any resources appropriate for the specified culture or the neutral culture.," I have created an assembly and later renamed it.Then I started getting runtime errors when calling: The resourceName variable is ""enTools"" at runtime. Could not find any resources appropriate for the specified culture or the neutral culture. Make sure ""Jfc.TFSAddIn.CommandBar.resources"" was correctly embedded or linked into assembly ""Jfc.TFSAddIn"" at compile time, or that all the satellite assemblies required are loadable and fully signed.The code: I can see the file CommandBar.resx included in the project, I can open it and can see the ""enTools"" string there. It seems that either resources are not included into assembly or resource are included but .NET cannot resolve the name. <code>  toolsMenuName = resourceManager.GetString(resourceName); string resourceName;ResourceManager resourceManager = new ResourceManager(""Jfc.TFSAddIn.CommandBar"", Assembly.GetExecutingAssembly());CultureInfo cultureInfo = new CultureInfo(_applicationObject.LocaleID);if(cultureInfo.TwoLetterISOLanguageName == ""zh""){ CultureInfo parentCultureInfo = cultureInfo.Parent; resourceName = String.Concat(parentCultureInfo.Name, ""Tools"");}else{ resourceName = String.Concat(cultureInfo.TwoLetterISOLanguageName, ""Tools"");}toolsMenuName = resourceManager.GetString(resourceName); // EXCEPTION IS HERE",Could not find any resources appropriate for the specified culture or the neutral culture
Parsing XML String in C NET," I have looked over other posts here on the same subject and searched Google but I am extremely new to C# NET and at a loss. I am trying to parse this XML... using this code.. I have printed out the contents of strResponse and the XML is definitely there. However, when I click this button, nothing is added to the listBox1 or the label1 so I something is wrong. <code>  <whmcsapi version=""4.1.2""> <action>getstaffonline</action> <result>success</result> <totalresults>1</totalresults> <staffonline> <staff> <adminusername>Admin</adminusername> <logintime>2010-03-03 18:29:12</logintime> <ipaddress>127.0.0.1</ipaddress> <lastvisit>2010-03-03 18:30:43</lastvisit> </staff> </staffonline> </whmcsapi> XDocument doc = XDocument.Parse(strResponse); var StaffMembers = doc.Descendants(""staff"").Select(staff => new { Name = staff.Element(""adminusername"").Value, LoginTime = staff.Element(""logintime"").Value, IPAddress = staff.Element(""ipaddress"").Value, LastVisit = staff.Element(""lastvisit"").Value, }).ToList(); label1.Text = doc.Element(""totalresults"").Value; foreach (var staff in StaffMembers) { listBox1.Items.Add(staff.Name); }",Parsing XML String in C#
How to select a node of treeview programatically in c#?," Used treeview.SelectedNode to select a child node. How to invoke treeview.AfterSelect event when a node is selected programmatically? <code>  this.treeView1.SelectedNode = this.treeView1.Nodes[0].Nodes[0].Nodes[0].Nodes[0]; if (this.treeView1.Nodes[0].Nodes[0].Nodes[0].Nodes[0].IsSelected) { MessageBox.Show(""Node is selected""); }",How to select a node of treeview programmatically in c#?
explaining c# statement !?," Can you please explain to me what where T : class, new() means in the following line of code?  <code>  void Add<T>(T item) where T : class, new();","What does ""where T : class, new()"" mean?"
Acceleration/Deceleration Ratio equivalant with KeySpline," Is there a formula to translate AccelerationRatio or DecelerationRatio to Bezier control points for use in a KeySpline in a SplineDoubleKeyFrame? For example, an ""Ease Out"" may be DecelerationRatio=0.5, but this doesn't seem equivalent to KeySpline=""0.0,0.0 0.5,1.0"" or KeySpline=""0.5,0 1,0.5"".Would this involve multiple SplineDoubleKeyFrame to achieve DecelerationRatio=0.5? Or is their a particular formula that makes them equivalent in a single frame?Or is this not to be achieved via a SplineDoubleKeyFrame but a EasingDoubleKeyFrame instead (if so, what is the EasingFunction/EasingMode/Other Attributes)?Essentially, I'm trying to achieve <DoubleAnimation Storyboard.TargetName=""deceleratedRectangle"" Storyboard.TargetProperty=""(Rectangle.Width)"" DecelerationRatio=""0.5"" Duration=""0:0:10"" From=""20"" To=""400"" /> with KeyFrames as there will be multiple frames that target the same property path and accelerate/decelerate it.UPDATE: According to the Microsoft WPF-Silverlight Comparison Whitepaper.pdf on page 7: The linear interpolation can be modified somewhat by adding AccelerationRatio and DecelerationRatio properties to the animation. These attributes essentially create three linear interpolations for the entire animation in order to modify the starting and stopping speeds. For example, a designer would use these attributes to have an object gradually pick up speed or stop suddenly. Unfortunately, Silverlight does not implement these two attributes, but the effect can be duplicated using keyframe animations with linear interpolation.So I guess this means it can be done with just 3 key frames, but what the formula is I have no idea.SOLUTION: For others that may come along that need this, posting the ECMAScript solution crafted by Peter Taylor: <code>  <html> <head> <title>Acceleration or deceleration with Bezier splines</title> <script type=""text/javascript""><!-- function calcBezier() { var res = new Array(); var y0 = +document.getElementById(""y0"").value; var y1 = +document.getElementById(""y1"").value; var t0 = +document.getElementById(""t0"").value; var t1 = +document.getElementById(""t1"").value; var ra = +document.getElementById(""ra"").value; var rd = +document.getElementById(""rd"").value; var ta = t0 + ra * (t1 - t0); if (ra > 0) res.push(""ta = "" + ta + ""<br />""); var td = t1 - rd * (t1 - t0); if (rd > 0) res.push(""td = "" + td + ""<br />""); var vm = 2 * (y1 - y0) / (t1 + td - ta - t0); res.push(""vm = "" + vm + ""<br />""); var ya = y0 + vm * (ta - t0) / 2 if (ra > 0) res.push(""ya = "" + ya + ""<br />""); var yd = y1 - vm * (t1 - td) / 2 if (rd > 0) res.push(""yd = "" + yd + ""<br />""); res.push('&lt;DiscreteDoubleKeyFrame KeyTime=""'+t0+'"" Value=""'+y0+'"" /&gt;<br />'); if (ra > 0) { // y - ya = (t - ta) * vm => t = ta + (y - ya) / vm var p1t = ta - (ya - y0) / vm; // Scale for spline params: (t0,y0):(0,0) and (ta,ya):(1,1) p1t = (p1t - t0) / (ta - t0); // Lift to cubic. res.push('&lt;SplineDoubleKeyFrame KeyTime=""'+ta+'"" Value=""'+ya+'"" KeySpline=""'+((2*p1t)/3)+',0 '+((2*p1t+1)/3)+','+(1/3)+'"" /&gt;<br />'); } if (ra + rd < 1) { res.push('&lt;LinearDoubleKeyFrame KeyTime=""'+td+'"" Value=""'+yd+'"" /&gt;<br />'); } if (rd > 0) { var q1y = 1; var q1t = td + (y1 - yd) / vm; q1t = (q1t - td) / (t1 - td); res.push('&lt;SplineDoubleKeyFrame KeyTime=""'+t1+'"" Value=""'+y1+'"" KeySpline=""'+((2*q1t)/3)+','+(2/3)+' '+((2*q1t+1)/3)+',1"" /&gt;<br />'); } document.getElementById(""results"").innerHTML = res.join(""""); } //--> </script> </head>",Acceleration/Deceleration Ratio equivalent with KeyFrame
Acceleration/Deceleration Ratio equivalent with KeySpline," Is there a formula to translate AccelerationRatio or DecelerationRatio to Bezier control points for use in a KeySpline in a SplineDoubleKeyFrame? For example, an ""Ease Out"" may be DecelerationRatio=0.5, but this doesn't seem equivalent to KeySpline=""0.0,0.0 0.5,1.0"" or KeySpline=""0.5,0 1,0.5"".Would this involve multiple SplineDoubleKeyFrame to achieve DecelerationRatio=0.5? Or is their a particular formula that makes them equivalent in a single frame?Or is this not to be achieved via a SplineDoubleKeyFrame but a EasingDoubleKeyFrame instead (if so, what is the EasingFunction/EasingMode/Other Attributes)?Essentially, I'm trying to achieve <DoubleAnimation Storyboard.TargetName=""deceleratedRectangle"" Storyboard.TargetProperty=""(Rectangle.Width)"" DecelerationRatio=""0.5"" Duration=""0:0:10"" From=""20"" To=""400"" /> with KeyFrames as there will be multiple frames that target the same property path and accelerate/decelerate it.UPDATE: According to the Microsoft WPF-Silverlight Comparison Whitepaper.pdf on page 7: The linear interpolation can be modified somewhat by adding AccelerationRatio and DecelerationRatio properties to the animation. These attributes essentially create three linear interpolations for the entire animation in order to modify the starting and stopping speeds. For example, a designer would use these attributes to have an object gradually pick up speed or stop suddenly. Unfortunately, Silverlight does not implement these two attributes, but the effect can be duplicated using keyframe animations with linear interpolation.So I guess this means it can be done with just 3 key frames, but what the formula is I have no idea.SOLUTION: For others that may come along that need this, posting the ECMAScript solution crafted by Peter Taylor: <code>  <html> <head> <title>Acceleration or deceleration with Bezier splines</title> <script type=""text/javascript""><!-- function calcBezier() { var res = new Array(); var y0 = +document.getElementById(""y0"").value; var y1 = +document.getElementById(""y1"").value; var t0 = +document.getElementById(""t0"").value; var t1 = +document.getElementById(""t1"").value; var ra = +document.getElementById(""ra"").value; var rd = +document.getElementById(""rd"").value; var ta = t0 + ra * (t1 - t0); if (ra > 0) res.push(""ta = "" + ta + ""<br />""); var td = t1 - rd * (t1 - t0); if (rd > 0) res.push(""td = "" + td + ""<br />""); var vm = 2 * (y1 - y0) / (t1 + td - ta - t0); res.push(""vm = "" + vm + ""<br />""); var ya = y0 + vm * (ta - t0) / 2 if (ra > 0) res.push(""ya = "" + ya + ""<br />""); var yd = y1 - vm * (t1 - td) / 2 if (rd > 0) res.push(""yd = "" + yd + ""<br />""); res.push('&lt;DiscreteDoubleKeyFrame KeyTime=""'+t0+'"" Value=""'+y0+'"" /&gt;<br />'); if (ra > 0) { // y - ya = (t - ta) * vm => t = ta + (y - ya) / vm var p1t = ta - (ya - y0) / vm; // Scale for spline params: (t0,y0):(0,0) and (ta,ya):(1,1) p1t = (p1t - t0) / (ta - t0); // Lift to cubic. res.push('&lt;SplineDoubleKeyFrame KeyTime=""'+ta+'"" Value=""'+ya+'"" KeySpline=""'+((2*p1t)/3)+',0 '+((2*p1t+1)/3)+','+(1/3)+'"" /&gt;<br />'); } if (ra + rd < 1) { res.push('&lt;LinearDoubleKeyFrame KeyTime=""'+td+'"" Value=""'+yd+'"" /&gt;<br />'); } if (rd > 0) { var q1y = 1; var q1t = td + (y1 - yd) / vm; q1t = (q1t - td) / (t1 - td); res.push('&lt;SplineDoubleKeyFrame KeyTime=""'+t1+'"" Value=""'+y1+'"" KeySpline=""'+((2*q1t)/3)+','+(2/3)+' '+((2*q1t+1)/3)+',1"" /&gt;<br />'); } document.getElementById(""results"").innerHTML = res.join(""""); } //--> </script> </head>",Acceleration/Deceleration Ratio equivalent with KeyFrame
c# checking for null problems," How can I check for a NULL value in an open MySqlDataReader?The following doesn't work; it's always hitting the else: rdr.IsDbNull(int i) only accepts a column number, not name. <code>  if (rdr.GetString(""timeOut"") == null){ queryResult.Egresstime = ""Logged in"";}else{ queryResult.Egresstime = rdr.GetString(""timeOut"");}",How to check for NULL in MySqlDataReader by the column's name?
How to specify access modifiers in property.," Can we specify the access modifiers for the get and set accessors of property in C#/.NET?If so, what would be the best approach to implement this? <code> ",Can separate access modifiers be specified for the get and set accessors of a property?
How to manully get instance of Graphics object in WinForms?, I know how to work with object of type Graphics (at least I am able to render images) but I always do that by passing graphics object retrieved from OnPaint method.I would like to display an image when the app is opened (ie in Form_Load method) but have no clue how to obtain the instance of Graphics object I could use?Thanks <code> ,How to manually get instance of Graphics object in WinForms?
How can I obtain the sensitive path on Windows?, I need to know which is the real path of a given path.For example:The real path is: d:\src\File.txtAnd the user give me: D:\src\file.txtI need as a result: d:\src\File.txt <code> ,How can I obtain the case-sensitive path on Windows?
 C#  Not able to serialize class with List<CustomObject> as propertity.," HiI am trying to serialize Getting following error :There was an error reflecting type 'System.Collections.Generic.List`1[DownloadTRON.Entities.Batche]'.been trying this since last 4 hours,can any body point out what i am doing Wrong !RegardsPravin <code>  FileStream fileStream = new FileStream(""batches.xml"", FileMode.Open);XmlSerializer serializer = new XmlSerializer(typeof(List<Batche>));List<Batche> listOfBatches = new List<Batche>();[Serializable][XmlRoot(""Batch"")]public class Batche{ [XmlElement(""Title"")] public string Title { get;set; } [XmlArray(""ListOfLinks""),XmlArrayItem(""Link"",Type = typeof(Link))] public List<Link> Links { get;set; }}[Serializable][XmlRoot(""Link"")]public class Link{ [XmlElement(""Uri"")] public Uri Uri { get; set; } [XmlElement(""Status"")] public string Status { get; set; }}", C#  Not able to serialize class with List<CustomObject> as property.
What is the best practices of making a repository class ?, There seem to be many ways to apply the repository patterns that is why i need your opinion and a good clear answer on what seem the best way of applying the repository pattern. It is the generic repository ? But there is a problem where some domain object dont have the same behaviour as others. It is specify repository ? What about code repeatition between repositories? it is both combinaison ? how about using a di container for both kind of implementation ? ThanksEdit: the orm i am using is entity framework 4. Would be nice to have an example with EF4. <code> ,What is the best practices of making a repository class with EF4 code first ?
Tasks in a thread : how to abort ?," In a thread, I create some System.Threading.Task and start each task.When I do a .Abort() to kill the thread, the tasks are not aborted.How can I transmit the .Abort() to my tasks ? <code> ",How do I abort/cancel TPL Tasks?
TypeLoadException not always wrapped into TargetInvocationException with Reflection used," (title was: ""TypeLoadException not always wrapped into TargetInvocationException with Reflection used"")With BLToolkit I figured out interesting fact - methodInfo.Invoke not always catching exception in the calling method. See example - it emulates exception in the static constructor for the method, invoking via reflection.Problem is that TestComponent inherits from Component AND have overridden Dispose method.So in this sample will be 2 messages - one ""handle"" and one ""unhandle"" - seems like Components have different handling inside Reflection on lower levels.If we comment out method Dispose(bool disposing) - we will receive only ""handle"" message.Can anyone give explanation why does it happen and propose a solution? Try-catch inside BLToolkit cannot be marked as answer - I am not member of their team :) <code>  class Program{ static void Main() { AppDomain.CurrentDomain.UnhandledException += (sender, eventArgs) => Console.WriteLine(""unHandled "" + eventArgs.ExceptionObject.GetType().FullName); try { try { var instance = Activator.CreateInstance(typeof(ComponentExecutor)); MethodInfo mi = typeof(ComponentExecutor).GetMethod(""Do""); BindingFlags bf = BindingFlags.Public | BindingFlags.Instance | BindingFlags.DeclaredOnly | BindingFlags.InvokeMethod; mi.Invoke(instance, bf, null, new object[0], CultureInfo.InvariantCulture); } catch (TargetInvocationException tarEx) { throw tarEx.InnerException; } } catch (Exception ex) { Console.WriteLine(""Handled "" + ex.GetType().FullName); } } class ComponentExecutor { public void Do() { new TestComponent().Do(); } } class TestComponent : Component { static TestComponent() { throw new NullReferenceException(); } [MethodImpl(MethodImplOptions.NoInlining)] public void Do() { Console.WriteLine(""Doing""); } protected override void Dispose(bool disposing) { Console.WriteLine(""Disposing""); base.Dispose(disposing); } }}",Unhandled exception coming from GC thread when a static-constructor / type-initializer fails
what's the advantage to use datacontract rather than serializable in WCF, Any advantage to using DataContract? <code> ,What are the advantages of using [DataContract] rather than [Serializable] in WCF
Get every 100 vaule in a loop," Is there a way to make this cleaner and not use the tempvalue like i have done here?UPDATE the code had a logic bug and didn't show what I'm doing.This is what I'm doing: UPDATE FinalThis is how its fixed after the feedback, thx guys. <code>  var loopTempValue = noOfPackets / 100;for(i=0; i < noOfPackets; i++){ \\DoStuff if (i == loopTempValue) { loopTempValue = loopTempValue + (noOfPackets / 100); UploadBackGroundWorker.ReportProgress(pross); }} if (i % (noOfPackets / 100) == 0 && i != 0){ UploadBackGroundWorker.ReportProgress(pross);}",Get every 100th value in a loop
WPF 4: Grow/Shrink TextBlock (Font Size) based on available space.," I've seen this question asked a lot, however, to the opposite of what I'm looking for. While other people want a control to size itself based on the size of text, I'm trying to figure out is if there is a way to grow the size of text to the amount of space available.Take the idea of a digital clock window and you want the numbers stating the time to grow (or shrink) based on the size of the window the clock is in. If there isn't a way to automatically do this any pointers to a programmatic way I can get this accomplished? <code> ",How to grow/shrink a TextBlock (Font Size) to the available space in WPF?
Concatenate textvalue in dropdown list - asp.net," My stored procedure is like this I have a drop down list in asp.net, which I am loading as : But at the Databind() statement, I am getting this error: System.Web.HttpException: DataBinding: 'System.Data.DataRowView' does not contain a property with the name 'Id-StudentName'.In text part of the dropdown list, I want to display the concatenated value of Id - StudentName.How can I do it? <code>  SELECT Id, StudentNameFROM xyz ddlA.DataSource = // Some sourceddlA.DataTextField = ""Id"" + "" -"" + ""StudentName"";ddlA.DataValueField = ""Id"";ddlA.DataBind();ddlA.Items.Insert(0, new ListItem("" Select one"", ""0""));",Format DropDownList.TextValue
Concatenate textvalue in dropdown list ," My stored procedure is like this I have a drop down list in asp.net, which I am loading as : But at the Databind() statement, I am getting this error: System.Web.HttpException: DataBinding: 'System.Data.DataRowView' does not contain a property with the name 'Id-StudentName'.In text part of the dropdown list, I want to display the concatenated value of Id - StudentName.How can I do it? <code>  SELECT Id, StudentNameFROM xyz ddlA.DataSource = // Some sourceddlA.DataTextField = ""Id"" + "" -"" + ""StudentName"";ddlA.DataValueField = ""Id"";ddlA.DataBind();ddlA.Items.Insert(0, new ListItem("" Select one"", ""0""));",Format DropDownList.TextValue
C#: How do I use an XmlSerializer to deserialize an object that might be of a base or derived class without knowing the type beforehand?," In C#, how do I use an XmlSerializer to deserialize an object that might be of a base class, or of any of several derived classes without knowing the type beforehand?All of my derived classes add additional data members. I've made a simple GUI that can serialize and deserialize class objects. It will serialize objects as whatever inherited class (or even just the base class) is appropriate based on which fields the user chooses to populate.I have no issues with the serialization; the problem is the deserialization. How can I possibly have the XmlSerializer deserialize data to the correct derived class without knowing the class beforehand? I currently create an XmlReader to read the first node of the XML file and determine the class from it, and it seems to work for my purposes, but it seems like an extremely inelegant solution.I've posted some sample code below. Any suggestions? <code>  BaseType objectOfConcern = new BaseType();XmlSerializer xserializer;XmlTextReader xtextreader = new XmlTextReader(DEFAULT_FILENAME);do { xtextreader.Read(); } while (xtextreader.NodeType != XmlNodeType.Element);string objectType = xtextreader.Name;xtextreader.Close();FileStream fstream = new FileStream(DEFAULT_FILENAME, FileMode.Open);switch (objectType) {case ""type1"": xserializer = new XmlSerializer(typeof(DerivedType)); objectOfConcern = (DerivedType)xserializer.Deserialize(fstream); //Load fields specific to that derived type here whatever = (objectOfConcern as DerivedType).NoOfstreamubordinates.ToString(); case ""xxx_1"": //code here case ""xxx_2"": //code here case ""xxx_n"": //code here //and so forth case ""BaseType"": xserializer = new XmlSerializer(typeof(BaseType)); AssignEventHandler(xserializer); objectOfConcern = (BaseType)xserializer.Deserialize(fstream);}//Assign all deserialized values from base class common to all derived classes here//Close the FileStreamfstream.Close();",How do I use an XmlSerializer to deserialize an object that might be of a base or derived class without knowing the type beforehand?
How to get related files of a running process (c#)?, I try to figure out a way to get the used files of a process to show which files are currently opened / used by this process. I have found Listing Used Files.Is there a link to get this in C#? <code> ,How to get opened/used files of a running process
How to get related files of a running process in C#?, I try to figure out a way to get the used files of a process to show which files are currently opened / used by this process. I have found Listing Used Files.Is there a link to get this in C#? <code> ,How to get opened/used files of a running process
C# getting file names without extentions," When getting file names in a certain folder: fi.Name gives me a file name with its extension: file1.txt, file2.txt, file3.txt.How can I get the file names without the extensions? (file1, file2, file3) <code>  DirectoryInfo di = new DirectoryInfo(currentDirName);FileInfo[] smFiles = di.GetFiles(""*.txt"");foreach (FileInfo fi in smFiles){ builder.Append(fi.Name); builder.Append("", ""); ...}",Getting file names without extensions
C# getting file names without extensions," When getting file names in a certain folder: fi.Name gives me a file name with its extension: file1.txt, file2.txt, file3.txt.How can I get the file names without the extensions? (file1, file2, file3) <code>  DirectoryInfo di = new DirectoryInfo(currentDirName);FileInfo[] smFiles = di.GetFiles(""*.txt"");foreach (FileInfo fi in smFiles){ builder.Append(fi.Name); builder.Append("", ""); ...}",Getting file names without extensions
Array of dynamic with a compressed initialize syntax," Im trying to use DynamicObject in c#, and I needed an array of dynamic: which works fine. EDIT : See ExpandoObject below.But I also like to fill that array with some data with this compressed initialize new syntax: But in that case all objects gets the non-dynamic type ""object"" and a loop through the items will give me an exception: Error : 'object' does not contain a definition for 'Name'. I guess I just initialize the array items the wrong way. How to add dynamic objects instead?EDIT: New content:I realize ""dynamic"" does not have the capability to dynamically add properties. I better be using ExpandoObject which exposes all items in an an internal dictionary as properties. But unfortunately ExpandoObject does not seem to support this nice compressed create syntax, and the compiler complains: So the answer might just be : it's not possible. <code>  var d = new dynamic[]; var d = new dynamic[] { new { Name = ""Some"", Number = 1010 }, new { Name = ""Other"", Number = 2010 } } foreach (dynamic item in d){ @item.Name @item.Number} var d = new ExpandoObject[]{new ExpandoObject(){ Name=""Nnn"", Number=1080 }}",Array of dynamic | ExpandoObject | with a compressed initialize syntax
.NET 2.0 : File.AppendAllText(...) - Thread safe implementation.," As an exercise in idle curiosity more than anything else, consider the following simple logging class: Is the lock needed around File.AppendAllText(...) or is the method inherently thread-safe by its own implementation ?Searching for information on this yields a lot of contradictory information, some say yes, some say no. MSDN says nothing. <code>  internal static class Logging{ private static object threadlock; static Logging() { threadlock = new object(); } internal static void WriteLog(string message) { try { lock (threadlock) { File.AppendAllText(@""C:\logfile.log"", message); } } catch { ...handle logging errors... } }}",.NET 2.0 : File.AppendAllText(...) - Thread safe implementation
Find out in c# if my mssql-server-instance supports snapshots?," I want to write c# code to make a snapshot-backup if available. This is supported since SQL Server version 2005 but only in Enterprise edition but not in Express or Standard edition. My question: how to find out in C# if the connected server supports snapshot backup (is Enterprise Edition 2005 or newer or some kind of ""hasFeature(...))?My current solution puts a try catch around the following code. If I catch a SqlException I assume there is no support on the connected server. But maybe there could be other reasons to fail although the database supports snapshots (i.e. something is locked, connection is broken, ...)The ideal solution would be some sqlCommand.ExecuteNonQuery() to find out if the feature is supported.The second best is if I had to include some extra dll that can find it (?sqldmo?) but this would create an additional dependency to the project.The third best would be some kind of exception handling. <code>  sqlCommand.CommandText = String.Format(""CREATE DATABASE {0} ON "" + (NAME = {1}, FILENAME = \""{2}\"" ) AS SNAPSHOT OF {1}"", databaseBackupName, databaseName, filenameOfDatabseBackup);sqlCommand.ExecuteNonQuery();",Find out in C# if my SQL Server instance supports snapshots?
High Precision Sleep or How to Yield CPU and Maintain Precise Frame Rate," I work on a 2D game engine that has a function called LimitFrameRate to ensure that the game does not run so fast that a user cannot play the game. In this game engine the speed of the game is tied to the frame rate. So generally one wants to limit the frame rate to about 60 fps. The code of this function is relatively simple: calculate the amount of time remaining before we should start work on the next frame, convert that to milliseconds, sleep for that number of milliseconds (which may be 0), repeat until it's exactly the right time, then exit. Here's the code: Of course I have found that due to the imprecise nature of the sleep function on some systems, the frame rate comes out quite differently than expected. The precision of the sleep function is only about 15 milliseconds, so you can't wait less than that. The strange thing is that some systems achieve a perfect frame rate with this code and can achieve a range of frame rates perfectly. But other systems don't. I can remove the sleep function and then the other systems will achieve the frame rate, but then they hog the CPU.I have read other articles about the sleep function:Sleep function in c in windows. Does a function with better precision exist?Sleep Function Error In CWhat's a coder to do? I'm not asking for a guaranteed frame rate (or guaranteed sleep time, in other words), just a general behavior. I would like to be able to sleep (for example) 7 milliseconds to yield some CPU to the OS and have it generally return control in 7 milliseconds or less (so long as it gets some of its CPU time back), and if it takes more sometimes, that's OK. So my questions are as follows:Why does sleep work perfectly and precisely in some Windows environments and not in others? (Is there some way to get the same behavior in all environments?)How to I achieve a generally precise frame rate without hogging the CPU from C# code? <code>  public virtual void LimitFrameRate(int fps){ long freq; long frame; freq = System.Diagnostics.Stopwatch.Frequency; frame = System.Diagnostics.Stopwatch.GetTimestamp(); while ((frame - previousFrame) * fps < freq) { int sleepTime = (int)((previousFrame * fps + freq - frame * fps) * 1000 / (freq * fps)); System.Threading.Thread.Sleep(sleepTime); frame = System.Diagnostics.Stopwatch.GetTimestamp(); } previousFrame = frame;}",High precision sleep or How to yield CPU and maintain precise frame rate
High precision sleep or How to yield CPU and aaintain frecise frame rate," I work on a 2D game engine that has a function called LimitFrameRate to ensure that the game does not run so fast that a user cannot play the game. In this game engine the speed of the game is tied to the frame rate. So generally one wants to limit the frame rate to about 60 fps. The code of this function is relatively simple: calculate the amount of time remaining before we should start work on the next frame, convert that to milliseconds, sleep for that number of milliseconds (which may be 0), repeat until it's exactly the right time, then exit. Here's the code: Of course I have found that due to the imprecise nature of the sleep function on some systems, the frame rate comes out quite differently than expected. The precision of the sleep function is only about 15 milliseconds, so you can't wait less than that. The strange thing is that some systems achieve a perfect frame rate with this code and can achieve a range of frame rates perfectly. But other systems don't. I can remove the sleep function and then the other systems will achieve the frame rate, but then they hog the CPU.I have read other articles about the sleep function:Sleep function in c in windows. Does a function with better precision exist?Sleep Function Error In CWhat's a coder to do? I'm not asking for a guaranteed frame rate (or guaranteed sleep time, in other words), just a general behavior. I would like to be able to sleep (for example) 7 milliseconds to yield some CPU to the OS and have it generally return control in 7 milliseconds or less (so long as it gets some of its CPU time back), and if it takes more sometimes, that's OK. So my questions are as follows:Why does sleep work perfectly and precisely in some Windows environments and not in others? (Is there some way to get the same behavior in all environments?)How to I achieve a generally precise frame rate without hogging the CPU from C# code? <code>  public virtual void LimitFrameRate(int fps){ long freq; long frame; freq = System.Diagnostics.Stopwatch.Frequency; frame = System.Diagnostics.Stopwatch.GetTimestamp(); while ((frame - previousFrame) * fps < freq) { int sleepTime = (int)((previousFrame * fps + freq - frame * fps) * 1000 / (freq * fps)); System.Threading.Thread.Sleep(sleepTime); frame = System.Diagnostics.Stopwatch.GetTimestamp(); } previousFrame = frame;}",High precision sleep or How to yield CPU and maintain precise frame rate
How to render an empty tag using TagBuilder?," The following code: Creates a tag: Is it possible to render instead, using TagBuilder? <code>  var canonical = new TagBuilder(""link"");canonical.MergeAttribute(""rel"", ""canonical"");canonical.MergeAttribute(""href"", url);return new MvcHtmlString(canonical.ToString()); <link href=""http://local.domain.com/"" rel=""canonical""></link> <link href=""http://local.domain.com/"" rel=""canonical""/>",How to render a self closing tag using TagBuilder?
What are the limits to code generaltion from XML Schema in C#?," I've seen several questions regarding problems with generating classes from XML Schema using xsd.exe, along with suggestions for how to pre-process the schema (often using XSLT) to resolve some of the trickier aspects prior to generation. My question is whether it's possible to construct a C# code generator that is 100% compliant with XML Schema. Are the problems with xsd.exe merely a question of its implementation, or do they point to a fundamental inconsistency between XML Schema and C#?In particular, I'm interested in how to map concepts in XML Schema to C# - what are the accepted mappings, which mappings are debatable, are there XML Schema constructs that are inherently un-mappable and are there C# constructs that are underutilised? Is there a compliance specification that would provide rules for mapping, such that it could be implemented and tested?EDIT: For the sake of clarity I'm fully aware that XML Schema won't provide me with fully implemented C# interfaces, I'm interested in whether it can be fully mapped to a C# class hierarchy.EDIT 2: I've added a small bounty, as I'm interested in getting a bit more detail. EDIT 3: Bounty still open, but so far heading toward stakx - a good answer but mainly dealing with how to replicate C# structures in XML Schema, rather than the other way round. Good input though. <code> ",What are the limits to code generation from XML Schema in C#?
TDD: Unit testing the Viewmodel," I am sort of new to TDD. I have started creating the properties I need on the view model as plain auto property. Then I create a test Then I would extend the actual implementation to make the test pass like this: The problem I have is that test still passes for the Aut property. Any tip for me how i could improve my process? <code>  public string Firstname { get; set; } [TestMethod][Tag(""Property"")]public void FirstNameTest(){ ViewModel = new CustomerViewModel(); ViewModel.PropertyChanged += (s, e) => { Assert.AreEqual(""Firstname"", e.PropertyName); Assert.AreEqual(""Test"", ViewModel.Firstname); }; ViewModel.Firstname = ""Test"";} public string Firstname{ get { return _contact.FirstName; } set { if (_contact.FirstName == value) return; _contact.FirstName = value; RaisePropertyChanged(() => Firstname); }}",Unit testing the Viewmodel
c# : transitive Inheritance , Is Inheritance a transitive relation in C#?I am asking because I cannot understand why IList<T> implements ICollection<T> and IEnumerable<T> as ICollection<T> already implements IEnumerable<T>Thanks for clarifying this for me. <code> ,C# : Transitive Inheritance 
empty row in datagridview," When I fill a DataGridView with data, there is always an empty row at the bottom.How do I disable this? <code> ",How do I remove the empty row from the bottom of a DataGridView control?
c# struct stack allocated or sometimes heap allocated?," I was of the impression that in C#, struct elements are allocated on the stack and thus disappear when returning from a method in which they were created. But what happens if I place the struct-values in a list and return that? The elements survives. Are struct instances sometimes allocated on the heap? code printing 0, 1, 2 <code>  internal struct Stru{ public int i;}internal class StruTry{ public List<Stru> Get(int max) { var l = new List<Stru>(); for (int i = 0; i < max; i++) l.Add(new Stru {i=i}); return l; }} [Test]public void T(){ var ll = new StruTry().Get(3); foreach (var stru in ll) Console.WriteLine(""* ""+ stru.i);}",Are Structs always stack allocated or sometimes heap allocated?
C# Finding image location on Excel, Say if I have an excel spreadsheet with an image overlaid. Obviously they are not embedded to any cell and are instead laid over the spreadsheet.How would I find the cell locations that the image lies on? Is there anyway to do this? <code> , Finding image location on Excel
Finding image location on Excel, Say if I have an excel spreadsheet with an image overlaid. Obviously they are not embedded to any cell and are instead laid over the spreadsheet.How would I find the cell locations that the image lies on? Is there anyway to do this? <code> , Finding image location on Excel
C# - Finding image location on Excel, Say if I have an excel spreadsheet with an image overlaid. Obviously they are not embedded to any cell and are instead laid over the spreadsheet.How would I find the cell locations that the image lies on? Is there anyway to do this? <code> , Finding image location on Excel
how do i hide the black screen of the consolde application? c#," How do I hide the black screen of the console application?googled it, found nothing...  <code> ",How do I hide the black screen of the console application? 
how do i hide the black screen of the consolde application? ," How do I hide the black screen of the console application?googled it, found nothing...  <code> ",How do I hide the black screen of the console application? 
Applying CQRS - Should I unit test queries?," Given that some of the advice for implementing CQRS advocates fairly close-to-the-metal query implementation, such as ADO.NET queries directly against the database (or perhaps a LINQ-based ORM), is it a mistake to try and unit test them?I wonder if it's really even necessary?My thoughts on the matter:The additional architectural complexity to provide a mockable ""Thin Read Layer"" seems opposite to the very nature of the advice to keep the architectural ceremony to a minimum.The number of unit tests to effectively cover every angle of query that a user might compose is horrendous.Specifically I'm trying CQRS out in an ASP.NET MVC application and am wondering whether to bother unit testing my controller action methods, or just test the Domain Model instead.Many thanks in advance. <code> ",Applying CQRS - Is unit testing the thin read layer necessary?
C# Generics - Calling generic method from a genric class," I have the following classes and I am trying to call Compare method from ExportFileBaseBL class but I get the errorCannot implicitly convert type 'Class1' to 'T'. An explicit conversion exists (are you missing a cast?) Shouldn't the type conversion be implicit? Am I missing something? <code>  public abstract class Class1<T> where T: Class2{ public abstract Class1<T> Compare(Class1<T> otherObj);}public abstract class Class3<T, U> where T: Class1<U> where U: Class2{ public T Compare(T obj1, T obj2) { if (obj1.Prop1 > obj2.Prop1) { return obj1.Compare(obj2); // Compiler Error here } else { return obj2.Compare(obj1); // Compiler Error here } }}",C# Generics - Calling generic method from a generic class
How to combine to Observables so the resulting Observable completes when the any of the observables completes?," I have this code: I've solved my problem using OnError(new OperationCanceledException()), but I'd like a better solution (there has to be a combinator right?). <code>  var s1 = new Subject<Unit>();var s2 = new Subject<Unit>();var ss = s1.Merge(s2).Finally(() => Console.WriteLine(""Finished!""));ss.Subscribe(_ => Console.WriteLine(""Next""));s1.OnNext(new Unit());s2.OnNext(new Unit());s1.OnCompleted(); // I wish ss finished here.s2.OnCompleted(); // Yet it does so here. =(",How to Merge two Observables so the result completes when the any of the Observables completes?
Slicing a FormCollection by keys that start with a certain string (c#)," Is there a nice linqy way of splitting a FormCollection into a Dictionary<string,string> that contains only those keys that start with a certain string?(This question is basically the same as this-> but for C#/FormCollection instead of python Slicing a dictionary by keys that start with a certain string)Here's what I came up with to get around the problem: Edit: The problem with this code, is that I have to do it multiple times for different StartsWith strings, and will therefore need to create a 'utility' method to do the above.It would be nice if it could read in one line like: Background (not necessary to solve the problem): The context is asp.net mvc, and of a form with a dynamic dictionary of fields.It's also similar to this question - Return FormCollection items with Prefix - but not quite the same. And having read this answer How to build C# object from a FormCollection with complex keys - I started to wonder whether I'd be better off not even using form post, but sending JSON instead. <code>  public ActionResult Save(FormCollection formCollection) { var appSettings = new Dictionary<string, string>(); var appKeys = formCollection.AllKeys.Where(k => k.StartsWith(""AppSettings."")); foreach (var key in appKeys) { appSettings[key] = formCollection[key]; }... formCollection.Where(k=>k.Key.StartsWith(""AppSettings."");",Slicing a FormCollection by keys that start with a certain string
Move DataTable from one DataSet to another," I'm trying to add to a new DataSet X a DataTable that is inside of a different DataSet Y.If I add it directly, I get the following error: DataTable already belongs to another DataSet.Do I have to clone the DataTable and import all the rows to it and then add the new DataTable to the new DataSet? Is there a better/easy way to do it? <code> ",Copy DataTable from one DataSet to another
C# creating stack overflow," I'm trying to create a buffer overflow with C# for a school project: I thought this would flood ptr_str2 and thereby overwriting chars in ptr_str. However that does not seem to happen. It does execute but the values in ptr_str are not overwritten.Can anyone help with achieving this? I don't understand what I'm doing wrong. <code>  unsafe{ fixed (char* ptr_str = new char[6] {'H', 'a', 'l', 'l', 'o', ','}) { fixed (char* ptr_str2 = new char[6] {'W', 'e', 'r', 'e', 'l', 'd'}) { fixed (char* ptr_str3 = new char[6] {'!', '!', '!', '!', '!', '!'}) { for (int i = 0; i < 8; i++) { ptr_str2[i] = 'a'; } for (int i = 0; i < 6; i++) { this.Label2.Text += ptr_str[i]; this.Label3.Text += ptr_str2[i]; this.Label4.Text += ptr_str3[i]; } } } }}",C# creating buffer overflow
A question about reference type assignment ByRef in .NET," Suppose I have a Person class and have the following: Is there a way I can change it so that if I assign a new Person to B, B = new Person(""Harry""), A would be referring to the same instance too? I know you can do that in a ref parameter assignment in a function. <code>  Person A = new Person(""Tom"");Person B = A;",ref for variables not parameters in functions
TCP speed tester algoritm question.," I am working in an ISP company. We are developing a speed tester for our customers, but running into some issues with TCP speed testing.One client had a total time duration on 102 seconds transferring 100 MB with a packet size of 8192. 100.000.000 / 8192 = 12.202 packets. If the client sends an ACK every other packet that seems like a lot of time just transmitting the ACKs. Say the client sends 6000 ACKs and the RTT is 15ms - that's 6000 * 7.5 = 45.000ms = 45 seconds just for the ACKs?If I use this calculation for Mbit/s: I will get the result in Mbp/s, but then the higher the TTL is between the sender and the client the lower the Mbp/s speed will become.To simulate that the user is closer to the server, would it be ""legal"" to remove the ACK response time in the final result on the Mbp/s? This would be like simulating the enduser is close to the server?So I would display this calculation to the end user: Is that valid? <code>  (((sizeof_download_in_bytes / durationinseconds) /1000) /1000) * 8 = Mbp/s (((sizeof_download_in_bytes / (durationinseconds - 45sec)) /1000)/1000) * 8 = Mbp/s ",TCP speed tester algorithm question.
"Asp.Net ""Sessions Timed Out"" Counter (perfmon.exe)"," I'm currently load testing an ASP.NET application. I'm charging with 500 users on the app, and while it's running I'm checking, in a perfmon.exe console, the ""Sessions Actives"" and ""Sessions Timed Out"" counters on the web server.In my web.config, the session timeout is 3 minutes (for test's purpose).So as the test goes, the ""Sessions Actives"" counter stays on about 900 active sessions, which I assume is normal because of the 500 active users and about 400 other whose sessions haven't timed out yet.But when I look at the ""Session Timed Out"" counter, it countinuously increases. It just goes down gradually when the load test finishes.What is this counter exactly? As I understand it, it's the deprecated sessions that have not been yet cleaned up (by the garbage collector?) and are still using memory.Since our application is using a huge ammount of memory, I'm trying to find exactly where is that memory. <code> ","ASP.NET ""Sessions Timed Out"" Counter (perfmon.exe)"
Format code shortcut for VS2010?," In Eclipse there is a shortcut, Ctrl+Shift+F, that re-indents code and fixes comments and blank lines. Is there an equivalent for Visual Studio 2010? <code> ",Is there a format code shortcut for Visual Studio?
Format code shortcut for Visual Studio?," In Eclipse there is a shortcut, Ctrl+Shift+F, that re-indents code and fixes comments and blank lines. Is there an equivalent for Visual Studio 2010? <code> ",Is there a format code shortcut for Visual Studio?
Set Enabled Property of ComboBox Based on SelectedItem," I want to enable/disable a ComboBox based on if there is an item selected in another ComboBox. I was able to get it working by setting a trigger on the Style, but that overrides my custom global style for the combobox. Is there another way to get the same functionality without losing my style? <code>  <ComboBox Grid.Column=""1"" Grid.Row=""1"" Name=""AnalysisComboBox"" MinWidth=""200"" VerticalAlignment=""Center"" HorizontalAlignment=""Left"" ItemsSource=""{Binding Path=AvailableAnalysis}""> <ComboBox.Style> <Style TargetType=""{x:Type ComboBox}""> <Setter Property=""IsEnabled"" Value=""True"" /> <Style.Triggers> <DataTrigger Binding=""{Binding SelectedItem,ElementName=ApplicationComboBox}"" Value=""{x:Null}""> <Setter Property=""IsEnabled"" Value=""False"" /> </DataTrigger> </Style.Triggers> </Style> </ComboBox.Style> </ComboBox>",Set IsEnabled Property of ComboBox Based on SelectedItem
what is the default value for enum variable," An enum variable, anyone know if it is always defaulting to the first element? <code> ",What is the default value for enum variable?
Is flags attribute neccessary?," I found with or without flags attributes, I can do bit operation if I defined the following enum I am wondering why we need flags attribute? <code>  enum TestType{ None = 0x0, Type1 = 0x1, Type2 = 0x2}",Is flags attribute necessary?
C#: how do I set cookie expiration time in user local time?," I want a cookie to expire in 10 minutes precisely (just for the sake of argument).If I use Expires = DateTime.Now.AddMinutes(30) and user is 3 hours behind me, cookie will expire as soon as it is received (is this correct?)How do I set expiration so it is local to user?Sure, I can use JavaScript to send that info together with the request, or use a JS-library of some sort to create cookie on the client side, or keep user profile and ask user for time zone, but I am looking a lazy-man solution. <code> ",how do I set cookie expiration time in user local time?
What is the best way to log a C# Func<> , I have a generic method that accepts a Func<int> and I would like to log the Func that is passed into the method. What properties are available on the passed in func to help me understand what it is doing? <code> ,What is the best way to log a .NET Func<> 
How to create extension method for toString?," I have tried this: But it does not work, both for string[] and List<string>. Maybe I need some special annotations? <code>  public static class ListHelper{ public static string ToString<T>(this IList<String> list) { return string.Join("", "", list.ToArray()); } public static string ToString<T>(this String[] array) { return string.Join("", "", array); }}",How to create an extension method for ToString?
WPF: Add controls from code," I have an Xml file which tells me the controls that I have to add to a form but this Xml changes dynamically and I need to update the form.Currently, I can read the XML file, but I dont know if it is possible to automatically create forms based on that or not ?  <code> ",How to generate WPF controls automatically based on XML file?
How to generate WPF controls automatically based on XML file ?," I have an Xml file which tells me the controls that I have to add to a form but this Xml changes dynamically and I need to update the form.Currently, I can read the XML file, but I dont know if it is possible to automatically create forms based on that or not ?  <code> ",How to generate WPF controls automatically based on XML file?
How to map interfaces to different ConcreteClasses with StructureMap?," When Controller1 is being created, I want that IService will be mapped to ConcreteService1 and IPageService to ConcretePageService1And when Controller2 is created, I want that IService will be mapped to ConcreteService2 and IPageService to ConcretePageService2How I can initialize ObjectFactory so that the above will work?Mean while I initialezed ObjectFactory this way: But this ALWAYS maps ConcreteService1 to IService and ConcretePageService1 to IPageService regardless of controller type <code>  ObjectFactory.Initialize(x => { x.For<IService>().Use<ConcreteService1>(); x.For<IPageService>().Use<ConcretePageService1>(); }); public class Controller1 : Controller{ public Controller1(IService service, IPageService pageService) { }}public class Controller2 : Controller{ public Controller2(IService service, IPageService pageService) { }}public interface IService {}public class ConcreteService1:IService {}public class ConcreteService2:IService {}public interface IPageService {}public class ConcretePageService1:IPageService {}public class ConcretePageService2:IPageService {}",How to map same interface to different ConcreteClasses with StructureMap?
Print LINQ when Joins are used," [Note After Answer: I am actually querying in memory-objects and that's why ToTraceString doesn't work. I added this to save the reader potential time from reading my long post].I'm using a ToTraceString command when trying to inspect how my LINQ queries end up looking. However, today my query got a bit complicated, involving a join and all of the sudden, I get this error when I try to Trace my String:Unable to cast object of type 'd__7a`1[EGSLanguageProviderShared.DTODataType]' to type 'System.Data.Objects.ObjectQuery'.My Query, and subsequent invocation of ToTraceString is as follows (note that System.Data.Entity has to be referenced in order for this to work). Both objects I'm querying (langDTs and langInstructionsAVDTs) are Entity Framework (.Net 3.5) objects from the same database. My Where Clause (== av.InstructionAVKey) uses a simple Value Collection Class, nothing to see there. Any ideas on how I could see the LINQ translation of this Join? ::- ). I noticed that System.Data.Objects has more types of queries, but I can't get any of the ones which seem more relevant to this case, to work.LATER EDIT:As you recommended, I tried changing the IEnumerable to an IQueryable but that resulted in a type incompatibility compilation error ::- /.After doing an explicit cast, I got the same error, but at Runtime (Unable to cast object of type '<DistinctIterator>d__7a1[EGSLanguageProviderShared.DTODataType]' to type 'System.Linq.IQueryable1[EGSLanguageProviderShared.DTODataType]'.`)Additional code: my objects langDTs and langInstructionsAVDTs are: So these objects are indeed queried immediately because they are Lists ::- ). As for DTODataType and DTOInstructionActiveValueDataType, they are simple Value Collection Classes, just public Properties, that's all. EVEN LATER EDITMight be of interest that at their root, the objects I'm using are indeed declared as ObjectQuery back in the deepest layer (Entity Framework): However, as I bring the data from over the Data Access Layer, I am converting them to Data Transfer Objects (the DTO-prefixed classes you keep seeing), which are simple Value Collection Classes (a property-by-property map of the Entity Objects which I use in order to keep the Data Model completely separated from the View and also to execute any data post-processing in the Presentation side). <code>  IEnumerable<DTODataType> dts = (from langDT in langDTs join langIAVDT in langInstructionsAVDTs on langDT.DataTypeKey equals langIAVDT.DataTypeKey where langIAVDT.InstructionAVKey == av.InstructionAVKey select langDT).Distinct(); var sql = ((System.Data.Objects.ObjectQuery)dts).ToTraceString(); List<DTOInstructionActiveValueDataType> langInstructionsAVDTs = CurrentLPInstructionManager.GetInstructionsActiveValuesDataTypes((from avKey in langInstructionsAVs select avKey.InstructionAVKey).Distinct().ToArray());List<DTODataType> langDTs = _LPDataTypeManager.GetDataTypes((from dt in langInstructionsAVDTs orderby dt.DataTypeKey select dt.DataTypeKey).Distinct().ToArray()); public global::System.Data.Objects.ObjectQuery<instructions> instructions",Trace LINQ when Joins are used
Detect user idle (per aplication instance)," I need user idle detection in my application only (per ""my application instance"").I can't use GetLastInputInfo because is session-specific user input: GetLastInputInfo does not provide system-wide user input information across all running sessions. Rather, GetLastInputInfo provides session-specific user input information for only the session that invoked the function.Any suggestions ? <code> ",Detect user idle (per application instance)
How to get the error message with C# ," For vsinstr -coverage hello.exe, I can use the C# code as follows. When there's an error, I get the error message : Error VSP1018: VSInstr does not support processing binaries that are already instrumented.. How can I get this error message with C#?SOLVEDI could get the error messages from the answers. <code>  Process p = new Process(); StringBuilder sb = new StringBuilder(""/COVERAGE ""); sb.Append(""hello.exe""); p.StartInfo.FileName = ""vsinstr.exe""; p.StartInfo.Arguments = sb.ToString(); p.Start(); p.WaitForExit(); using System;using System.Text;using System.Diagnostics;// You must add a reference to Microsoft.VisualStudio.Coverage.Monitor.dllnamespace LvFpga{ class Cov2xml { static void Main(string[] args) { Process p = new Process(); p.StartInfo.RedirectStandardOutput = true; p.StartInfo.RedirectStandardError = true; p.StartInfo.UseShellExecute = false; StringBuilder sb = new StringBuilder(""/COVERAGE ""); sb.Append(""helloclass.exe""); p.StartInfo.FileName = ""vsinstr.exe""; p.StartInfo.Arguments = sb.ToString(); p.Start(); string stdoutx = p.StandardOutput.ReadToEnd(); string stderrx = p.StandardError.ReadToEnd(); p.WaitForExit(); Console.WriteLine(""Exit code : {0}"", p.ExitCode); Console.WriteLine(""Stdout : {0}"", stdoutx); Console.WriteLine(""Stderr : {0}"", stderrx); } }}",How to get the error message with C#
Python's in operator equivalent to C#," With Python, I can use 'in' operator for set operation as follows : What's the equivalent in C#? <code>  x = ['a','b','c']if 'a' in x: do something",Python's 'in' operator equivalent to C#
Windows 7 phone -- need Hashtable() and Arraylist() -- what am I missing?," I am trying to use someone else's C# classes in my Windows 7 Phone app. The classes use objects of type Hashtable. The file in question has at the top, so I'm assuming that's the Hashtable object it wants. When I try to build my solution, I get errors that the type or namespace name 'Hashtable' could not be found, are you missing a using directive or assembly reference.In Microsoft's documentation of Hashtable, I see it says Assembly: mscorlibBut if I try to add mscorlib via Project>Add Reference, VS says it can't add it because it is automatically referenced by the build system.What am I missing? <code>  using System.Collections;",Need Hashtable and Arraylist
Need Hashtable and Arraylist.," I am trying to use someone else's C# classes in my Windows 7 Phone app. The classes use objects of type Hashtable. The file in question has at the top, so I'm assuming that's the Hashtable object it wants. When I try to build my solution, I get errors that the type or namespace name 'Hashtable' could not be found, are you missing a using directive or assembly reference.In Microsoft's documentation of Hashtable, I see it says Assembly: mscorlibBut if I try to add mscorlib via Project>Add Reference, VS says it can't add it because it is automatically referenced by the build system.What am I missing? <code>  using System.Collections;",Need Hashtable and Arraylist
how to replace part of string by position ?," I have this string: ABCDEFGHIJI need to replace from position 4 to position 5 with the string ZXIt will look like this: ABCZXFGHIJBut not to use with string.replace(""DE"",""ZX"") - I need to use with positionHow can I do it? <code> ",How to replace part of string by position?
Umbraco 4.6 - how to get all nodes by type in C#," Using Umbraco 4.6+, is there a way to retrieve all nodes of a specific doctype in C#? I've been looking in the umbraco.NodeFactory namespace, but haven't found anything of use yet. <code> ",Umbraco 4.6+ - How to get all nodes by doctype in C#?
"Excclude file from StyleCop analysis - ""auto-generated"" tag is ignored"," At the beginning of a C# file, I have added: I want StyleCop to skip checking this file, so I used the auto-generated trick explained in other answers.However, after cleaning and rebuilding my solution, StyleCop keeps generating warnings for this file. Why does this happen? How can it be fixed?I am using Microsoft Visual Studio 2008 Professional Edition and StyleCop v4.3. <code>  //-----------------------------------------------------------------------// <copyright company=""SomeCompany"" file=""MyFile.cs"">// Copyright Some Company, 2011// </copyright>// <auto-generated />//-----------------------------------------------------------------------","Exclude file from StyleCop analysis: ""auto-generated"" tag is ignored"
"Exclude file from StyleCop analysis - ""auto-generated"" tag is ignored"," At the beginning of a C# file, I have added: I want StyleCop to skip checking this file, so I used the auto-generated trick explained in other answers.However, after cleaning and rebuilding my solution, StyleCop keeps generating warnings for this file. Why does this happen? How can it be fixed?I am using Microsoft Visual Studio 2008 Professional Edition and StyleCop v4.3. <code>  //-----------------------------------------------------------------------// <copyright company=""SomeCompany"" file=""MyFile.cs"">// Copyright Some Company, 2011// </copyright>// <auto-generated />//-----------------------------------------------------------------------","Exclude file from StyleCop analysis: ""auto-generated"" tag is ignored"
C# | How do I send code ( a class in this case) to a server/program and receive output," Here is the situation:I have a huge data set that I need quick access to. It's a financial data set so basically the way it's set up is that at each point in time, you have data for thousands of stocks. Now, loading this data into the program takes a while (20-40 seconds) and I would like to avoid having to do this every time I make changes in the code. Basically, I had an idea and I want to know if it makes sense / if it is optimal. I was thinking of setting up some kind of server that has all the data loaded and all the object definitions, and then from a second program/client, I would like to send a predefined type of class (a strategy class) to the server, have the server run the code, and then have the server send me back the results of the test. I am creating trading strategies in this case, so I have an abstract class that defines what a ""strategy"" needs. I have a market simulator that calls the derived ""strategy"" every time the date changes, then the strategy buys or sells stocks, and then stores the profits from the strategy in some result object. So I want to be able to code the strategy part, send it over, and receive the result part. I want to avoid loading all the data every time I change params or raw code in my strategy object. I hope this makes sense to someone and I am sorry if it isn't very clear. Please let me know if this is possible, and then, how would I go about googling for this?? I don't even know what to search for here.  <code> ",How do I send code ( a class in this case) to a server/program and receive output
C# Repository Pattern and ObjectContext - Multiple repositories ," I have multiple repositories in my application. Where should I put the ObjectContext? Right now, I have a reference like ObjectContext ctx; in every repository. What is the smartest and safest way to go about this? <code> ",C#/EF and the Repository Pattern: Where to put the ObjectContext in a solution with multiple repositories?
"""Base abstract generic class is a bad choice in most situations.""  Why? (Or Why not)"," I have just seen on the comment to a blog post: Base abstract generic class is a bad choice in most situationsIs this true, if not why?What insight(s) leads to this statement? <code> ","""Base abstract generic class is a bad choice in most situations."" Why? (Or Why not)"
How to cut a video in respect with time or percentage and save output in different file," Is there any tutorial or a c# library which which help me to accomplish the followingChose a file to editAsk user to select cut/crop/trim method :- by time or by percentagecut/crop/trim the video by time or percentage as chosen ( say I wishto reduce a 5 minute video to 4 minute video, or reduce the video by80%)Save the video as requested in required pathnow steps 1) and 4) I have implemented but could not find a good c# library to accomplish 3) and 4)I looked up the ffmpeg library but could not find a good C# wrapper to accomplish the requirements. <code> ",How to cut/crop/trim a video in respect with time or percentage and save output in different file
How to cut/crop a video in respect with time or percentage and save output in different file," Is there any tutorial or a c# library which which help me to accomplish the followingChose a file to editAsk user to select cut/crop/trim method :- by time or by percentagecut/crop/trim the video by time or percentage as chosen ( say I wishto reduce a 5 minute video to 4 minute video, or reduce the video by80%)Save the video as requested in required pathnow steps 1) and 4) I have implemented but could not find a good c# library to accomplish 3) and 4)I looked up the ffmpeg library but could not find a good C# wrapper to accomplish the requirements. <code> ",How to cut/crop/trim a video in respect with time or percentage and save output in different file
What is the difference between log4j.net and elmah ?, Some people are using ELMAH instead of log4net. What makes it better?I found out about ELMAH in an answer to Stack Overflow question How do I do logging in C#? <code> ,What is the difference between log4net and ELMAH?
What is the difference between log4net and elmah ?, Some people are using ELMAH instead of log4net. What makes it better?I found out about ELMAH in an answer to Stack Overflow question How do I do logging in C#? <code> ,What is the difference between log4net and ELMAH?
Performing type convertions while using Abstarct Pattern," Let's imagine we got the following:A) Factory interface such as B) Concrete factory such as C) Employees family: Manager and Sales inherited from an abstract Employee. More on my simple) architectureSome client code I wanted to ask about some business logic architecture details. Using the architecture I can't design what the Company class should be, don't know how do I integrate it. I have read that it more appropriate to use Role-based architecture in such cases. Could you provide an example (Company, Employees entities)?Thanks! <code>  public interface IEmployeeFactory{ IEmployee CreateEmployee(Person person, Constants.EmployeeType type, DateTime hiredate);} public sealed class EmployeeFactory : Interfaces.IEmployeeFactory{ public Interfaces.IEmployee CreateEmployee(Person person, Constants.EmployeeType type, DateTime hiredate) { switch(type) { case BusinessObjects.Common.Constants.EmployeeType.MANAGER: { return new Concrete.Manager(person, hiredate); } case BusinessObjects.Common.Constants.EmployeeType.SALES: { return new Concrete.Sales(person, hiredate); } default: { throw new ArgumentException(""Invalid employee type""); } } }} public sealed class EmployeeFactoryClient{ private Interfaces.IEmployeeFactory factory; private IDictionary<String, Interfaces.IEmployee> employees; public Interfaces.IEmployee this[String key] { get { return this.employees[key]; } set { this.employees[key] = value; } } public EmployeeFactoryClient(Interfaces.IEmployeeFactory factory) { this.factory = factory; this.employees = new Dictionary<String, Interfaces.IEmployee>(); } public void AddEmployee(Person person, Constants.EmployeeType type, DateTime hiredate, String key) { this.employees.Add( new KeyValuePair<String, Interfaces.IEmployee>( key, this.factory.CreateEmployee( person, type, hiredate ) ) ); } public void RemoveEmployee(String key) { this.employees.Remove(key); } public void ListAll() { foreach(var item in this.employees) { Console.WriteLine( ""Employee ID: "" + item.Key.ToString() + ""; Details: "" + item.Value.ToString() ); } }}class ApplicationShell{ public static void Main() { var client = new EmployeeFactoryClient(new EmployeeFactory()); client.AddEmployee( new Person { FirstName = ""Walter"", LastName = ""Bishop"", Gender = BusinessObjects.Common.Constants.SexType.MALE, Birthday = new DateTime() }, BusinessObjects.Common.Constants.EmployeeType.MANAGER, new DateTime(), ""A0001M"" ); Console.WriteLine(client[""A0001M""].ToString()); Console.ReadLine(); }}","Roles, Abstract Pattern, Loose Coupling"
Performing type conversions while using Abstract Pattern," Let's imagine we got the following:A) Factory interface such as B) Concrete factory such as C) Employees family: Manager and Sales inherited from an abstract Employee. More on my simple) architectureSome client code I wanted to ask about some business logic architecture details. Using the architecture I can't design what the Company class should be, don't know how do I integrate it. I have read that it more appropriate to use Role-based architecture in such cases. Could you provide an example (Company, Employees entities)?Thanks! <code>  public interface IEmployeeFactory{ IEmployee CreateEmployee(Person person, Constants.EmployeeType type, DateTime hiredate);} public sealed class EmployeeFactory : Interfaces.IEmployeeFactory{ public Interfaces.IEmployee CreateEmployee(Person person, Constants.EmployeeType type, DateTime hiredate) { switch(type) { case BusinessObjects.Common.Constants.EmployeeType.MANAGER: { return new Concrete.Manager(person, hiredate); } case BusinessObjects.Common.Constants.EmployeeType.SALES: { return new Concrete.Sales(person, hiredate); } default: { throw new ArgumentException(""Invalid employee type""); } } }} public sealed class EmployeeFactoryClient{ private Interfaces.IEmployeeFactory factory; private IDictionary<String, Interfaces.IEmployee> employees; public Interfaces.IEmployee this[String key] { get { return this.employees[key]; } set { this.employees[key] = value; } } public EmployeeFactoryClient(Interfaces.IEmployeeFactory factory) { this.factory = factory; this.employees = new Dictionary<String, Interfaces.IEmployee>(); } public void AddEmployee(Person person, Constants.EmployeeType type, DateTime hiredate, String key) { this.employees.Add( new KeyValuePair<String, Interfaces.IEmployee>( key, this.factory.CreateEmployee( person, type, hiredate ) ) ); } public void RemoveEmployee(String key) { this.employees.Remove(key); } public void ListAll() { foreach(var item in this.employees) { Console.WriteLine( ""Employee ID: "" + item.Key.ToString() + ""; Details: "" + item.Value.ToString() ); } }}class ApplicationShell{ public static void Main() { var client = new EmployeeFactoryClient(new EmployeeFactory()); client.AddEmployee( new Person { FirstName = ""Walter"", LastName = ""Bishop"", Gender = BusinessObjects.Common.Constants.SexType.MALE, Birthday = new DateTime() }, BusinessObjects.Common.Constants.EmployeeType.MANAGER, new DateTime(), ""A0001M"" ); Console.WriteLine(client[""A0001M""].ToString()); Console.ReadLine(); }}","Roles, Abstract Pattern, Loose Coupling"
Best approach to use jira programatically, I would like to be able to create/assign/and close jira tickets or entries programmatically..I was able to google and found that jira has command line tools available as well as a soap API.Suggestions on what approach would be the best? <code> ,Best approach to use jira programmatically
C# SharePoint Memory Leak," Does this contain a memory leak? I've been trying to better understand memory leaks, but I can't tell if I have corrected this? If not, how do I correctly dispose of the SPweb object and SPSite object? <code>  using (SPWeb oWebsite = new SPSite(webUrl).OpenWeb()) //Open SP Web{ SPListCollection collList = oWebsite.Lists; //Open Lists foreach (SPList oList in collList) //For Each List Execute this { if (!oList.Hidden) //If the list is hidden do this else nothing { ListSitesDropDownBox.Items.Add(new ListItem(SPEncode.HtmlEncode(oList.Title), SPEncode.HtmlEncode(oList.Title))); ViewState[""Item"" + counter] = SPEncode.HtmlEncode(oList.Title); counter++; } }}",SharePoint memory leak
How to programmatically scroll TreeView?," I need to scroll TreeView (Windows Forms) from TOP to BOTTOM... I should clarify that I have two TreeViews... If the first was scrolled by the user, the second treeView must be automatically scrolled. I don't know what node is selected...How can I do this? <code> ",How do I programmatically scroll TreeView?
C#: How to implement a Dictionary with two keys?," Using C#, I'd like to find a way how to implement something like a dictionary that depends on two key objects.I have an object and a string. To this two values I want to assign one double value. So what structure should I use? Or how can I implement such a structure? <code> ",How to implement a Dictionary with two keys?
What does stream means? What are it's characteristics?," C++ and C# both use the word stream to name many classes.C++: iostream, istream, ostream, stringstream, ostream_iterator, istream_iterator...C#: Stream, FileStream,MemoryStream, BufferedStream...So it made me curious to know, what does stream mean?What are the characteristics of a stream?When can I use this term to name my classes?Is this limited to file I/O classes only?Interestingly, C doesnt use this word anywhere, as far as I know. <code> ",What does stream mean? What are its characteristics?
remove asp.net event on code behind," I want to remove an event in code behind.For example my control is like this. I want to remove the OnTextChanged programmatically.. how can I achieve this? <code>  <asp:Textbox ID=""txtName"" runat=""server"" OnTextChanged=""txtName_Changed"" AutoPostBack=""true"" />",Remove asp.net event on code behind
best way to interate folders and subfolders," What's the best way to iterate folders and subfolders to get file size, total number of files, and total size of folder in each folder starting at a specified location? <code> ",Best way to iterate folders and subfolders
equivalent of app.config for library (dll)," Is there an equivalent to app.config for libraries (DLLs)? If not, what is the easiest way to store configuration settings that are specific to a library? Please consider that the library might be used in different applications. <code> ",Equivalent to 'app.config' for a library (DLL)
ASP.NET postbacks creates problem in URL rewriting?," I am using Intelligencia for url rewriting in my asp.net project.I have solved many issues by doing R & D for url rewriting but right now i stuck with one issue regarding page postback.page postback change my rewrite url to original url.SO, anyone help me to get out from here. <code> ",ASP.NET postbacks creates issue in URL rewriting?
How to get all drives in PC using C#," how to get all drives in a PC. and types of every drive and free-space of eachi.e. System-Drive, CD-Drive, DVD-Drive, Removable, ... etc.If a system is attached with a new drive may be a pen drive or external hard disc.How to detect them at time of attachment ?  <code> ",How to get all drives in PC with .NET using C#
C# cast object of type int to nullible enum," I just need to be able to cast an object to nullable enum. Object can be enum, null, or int. Thanks! <code>  public enum MyEnum { A, B }void Put(object value){ System.Nullable<Myenum> val = (System.Nullable<MyEnum>)value;}Put(null); // worksPut(Myenum.B); // worksPut(1); // Invalid cast exception!!",C# cast object of type int to nullable enum
About c# struct memory overhead," My code is like this: The result bin file is 10095 bytes big. Why do my Foo structs eat so many bytes? What's the 9 bytes per struct overhead all about?PS: I'm writing a lookup library for Chinese characters (it's about infos for circa 70,000 characters), for which db4o or other embeddable databases (like sqlite) are kind of bloat. I thought to store all information in pure string format,which is most memory friendly, but less flexible. I'd like to keep infos in lists and store them as binary serialization into an archive, I've chosen the DotNetZip for the archiving. But the serialization overhead is an unexpected obstacle. A better serialization solution would be good, otherwise I've to save infos in plain string format and parse it by hard-coding. <code>  [Serializable][StructLayout(LayoutKind.Sequential,Pack=1)]struct Foo{ public byte Bar; public Foo(byte b){Bar=b;}}public static void Main (string[] args){ Foo[] arr = new Foo[1000]; for (int i = 0; i < 1000; i++) { arr[i]=new Foo(42); } var fmt = new BinaryFormatter(); using(FileStream f= File.Create(""test.bin"")){ fmt.Serialize(f,arr); } Console.WriteLine (new FileInfo(""test.bin"").Length);}",About c# struct memory/serialization overhead
load a form in windows service, I want to load a form in OnStart() method in my windows service; here is my code. It is not working. Can you please provide any help ? <code>  protected override void OnStart(string[] args){ Form1 fr = new Form1(); fr.Show();},How to show a form in windows service.
Asp.Net MVC3: Resolve a service from custom validator," Update 18th December 2012Since this question seems to be getting quite a few views, I should point out that the accepted answer is not the solution I used, but it does provide the links and resources to build a solution, but, to my mind, not the ideal solution. My answer contains replacements for standard parts of the MVC framework; and you should only use those if you are comfortable checking that they still work for future versions (some private code was ripped out of the official sources, because there wasn't enough extensibility in the base classes).I can confirm, however, that these two classes also work for Asp.Net MVC 4 as well as 3.It is also possible to repeat a similar implementation for the Asp.Net Web API framework as well, which I have done recently.End updateI have a type that has a lot of 'standard' validation (required etc) but also a bit of custom validation as well.Some of this validation requires grabbing hold of a service object and looking up some lower-level (i.e. 'beneath' the Model layer) meta data using one of the other properties as a key. The meta data then controls whether one or more properties are required as well as valid formats for those properties.To be more concrete - the type is a Card Payment object, simplified to two of the properties in question as follows: I then have a service: ICardType then contains different bits of information - the two here that are crucial being: My controllers all have the ability to resolve an ICardTypeService using a standard pattern i.e. (Although I should mention that the framework behind this call is proprietary)Which they gain via the use of a common interface My framework then takes care of assigning the most-specific dependency resolver available for the controller instance when it is constructed (either by another resolver, or by the MVC standard controller factory). That Resolve method in the last-but one code block is a simple wrapper around this Resolver member.So - if I can grab the selected ICardType for the payment that is received from the browser, I can then perform initial checks on card number length etc. The issue is, how to resolve the service from within my override of IsValid(object, ValidationContext) override of ValidationAttribute?I need to pass through the current controller's dependency resolver to the validation context. I see that ValidationContext both implements IServiceProvider and has an instance of IServiceContainer - so clearly I should be able to create a wrapper for my service resolver that also implements one of those (probably IServiceProvider).I've already noted that in all places where a ValidationContext is produced by the MVC framework, the service provider is always passed null.So at what point in the MVC pipeline should I be looking to override the core behaviour and inject my service provider?I should add that this will not be the only scenario in which I need to do something like this - so ideally I'd like something which I can apply to the pipeline so that all ValidationContexts are configured with the current service provider for the current controller. <code>  public class CardDetails{ public string CardTypeID { get; set; } public string CardNumber { get; set; }} public interface ICardTypeService{ ICardType GetCardType(string cardTypeID);} public interface ICardType{ //different cards support one or more card lengths IEnumerable<int> CardNumberLengths { get; set; } //e.g. - implementation of the Luhn algorithm Func<string, bool> CardNumberVerifier { get; set; }} var service = Resolve<ICardTypeService>(); public interface IDependant{ IDependencyResolver Resolver { get; set; }}",Asp.Net MVC3: Set custom IServiceProvider in ValidationContext so validators can resolve services
Can someone explain what the point of nulling an object before it goes out of scope is>," I have seen code with the following logic in a few places: What is the point of setting foo to null in the dictionary before removing it? I thought the garbage collection cares about the number of things pointing to whatever *foo originally was. If that's the case, wouldn't setting myDictonary[""foo""] to null simply decrease the count by one? Wouldn't the same thing happen once myDictonary.Remove(""foo"") is called? What is the point of _myDictonary[""foo""] = null;edit: To clarify - when I said ""remove the count by one"" I meant the following:- myDictonary[""foo""] originally points to an object. That means the object has one or more things referencing it.- Once myDictonary[""foo""] is set to null it is no longer referencing said object. This means that object has one less thing referencing it. <code>  public void func(){ _myDictonary[""foo""] = null; _myDictionary.Remove(""foo"");}",Can someone explain what the point of nulling an object before it goes out of scope is?
How do I disable the controlbox in with RibbonWindow in WPF," According to this MSDN page, if I were using Window, then I could disable the control box in the top left hand corner by setting it to false. Like this: this.ControlBox = false;The ControlBox has Maximize, Minimize, Restore and Close options But since I'm using RibbonWindow instead of Window, how would I disable the control box in this situation?This question is very related, but I'm looking to disable the SystemMenu all the time, not just to prevent the Alt+Space. This is because (I think) the action listener for the SystemMenu in the top left hand corner blocks a clickable UI element in my XAML.I should note that this is not a problem with Windows Server 2003, but when the application is opened in Windows 7, the SystemMenu/ControlBox interferes with the UI element in the top left corner.Additionally, I've found that interfering with the system menu usually results in the buttons in the top right hand corner of the application being deactivated, but I don't want that to happen.Thanks for the link Eammonn. I Think what that person was trying to do is disable the [X] button in the top right hand corner, not the menu in the top left hand corner, but I could be wrong. The reason I don't think it'll work is that they're using <Window x:Class= and I'm using <dc:RibbonWindow x:Class=. Does this make a difference? <code> ",How to remove the System Menu in WPF?
How do I disable the ControlBox with RibbonWindow in WPF," According to this MSDN page, if I were using Window, then I could disable the control box in the top left hand corner by setting it to false. Like this: this.ControlBox = false;The ControlBox has Maximize, Minimize, Restore and Close options But since I'm using RibbonWindow instead of Window, how would I disable the control box in this situation?This question is very related, but I'm looking to disable the SystemMenu all the time, not just to prevent the Alt+Space. This is because (I think) the action listener for the SystemMenu in the top left hand corner blocks a clickable UI element in my XAML.I should note that this is not a problem with Windows Server 2003, but when the application is opened in Windows 7, the SystemMenu/ControlBox interferes with the UI element in the top left corner.Additionally, I've found that interfering with the system menu usually results in the buttons in the top right hand corner of the application being deactivated, but I don't want that to happen.Thanks for the link Eammonn. I Think what that person was trying to do is disable the [X] button in the top right hand corner, not the menu in the top left hand corner, but I could be wrong. The reason I don't think it'll work is that they're using <Window x:Class= and I'm using <dc:RibbonWindow x:Class=. Does this make a difference? <code> ",How to remove the System Menu in WPF?
How to disable the ControlBox with RibbonWindow in WPF?," According to this MSDN page, if I were using Window, then I could disable the control box in the top left hand corner by setting it to false. Like this: this.ControlBox = false;The ControlBox has Maximize, Minimize, Restore and Close options But since I'm using RibbonWindow instead of Window, how would I disable the control box in this situation?This question is very related, but I'm looking to disable the SystemMenu all the time, not just to prevent the Alt+Space. This is because (I think) the action listener for the SystemMenu in the top left hand corner blocks a clickable UI element in my XAML.I should note that this is not a problem with Windows Server 2003, but when the application is opened in Windows 7, the SystemMenu/ControlBox interferes with the UI element in the top left corner.Additionally, I've found that interfering with the system menu usually results in the buttons in the top right hand corner of the application being deactivated, but I don't want that to happen.Thanks for the link Eammonn. I Think what that person was trying to do is disable the [X] button in the top right hand corner, not the menu in the top left hand corner, but I could be wrong. The reason I don't think it'll work is that they're using <Window x:Class= and I'm using <dc:RibbonWindow x:Class=. Does this make a difference? <code> ",How to remove the System Menu in WPF?
Obtain containing object instance from ModelMetadataProvider," Implementing custom DataAnnotationsModelMetadataProvider in ASP.NET MVC2.Assuming the object that is being rendered looks like this: and the method below is in the context of Contact.ContactType meaning that:meta.PropertyName == ""ContactType""meta.ContainerType == typeof(Contact)meta.Model == ContactType.Lead(the code under question:) The question: How can I obtain the instance of Contact from the metadata? (replace NotSureWhatGoesHere with the correct one)?Thanks. <code>  - Contact : IUpdateable - Name: string - ContactType: (Lead, Prospect, Customer) protected override ModelMetadata CreateMetadata(IEnumerable<Attribute> attributes, Type containerType, Func<object> modelAccessor, Type modelType, string propertyName) { var containerInstance = meta.NotSureWhatGoesHere as IUpdateable; meta.IsReadOnly = containerInstance != null && containerInstance.CanBeUpdated(meta.PropertyName);}",Obtain containing object instance from ModelMetadataProvider in ASP.NET MVC
System.Management.ManagementException question," I am running following code: And on some machines it is ok, and on some I am getting following error: System.Management.ManagementException: Not found Call stack: Any idea why? <code>  System.Management.ManagementClass wmiNetAdapterConfiguration = new System.Management.ManagementClass(""Win32_NetworkAdapterConfiguration"");System.Management.ManagementObjectCollection wmiNetAdapters = wmiNetAdapterConfiguration.GetInstances();Log.logInfo(""Net adapters:"" + wmiNetAdapters.get_Count()); System.Management.ManagementException: Not found at System.Management.ManagementException.ThrowWithExtendedInfo(ManagementStatus errorCode) at System.Management.ManagementScope.InitializeGuts(Object o) at System.Management.ManagementScope.Initialize() at System.Management.ManagementObject.Initialize(Boolean getObject) at System.Management.ManagementClass.GetInstances(EnumerationOptions options) at System.Management.ManagementClass.GetInstances()",System.Management.ManagementException
How do I SSL certificate from HttpWebRequest in C#?," Currently I'm writing a utility application that will connect to a given IP and port and check the information in the SSL certificate using HttpWebRequest. When I try to extract the certificate I get an error that an exception was thrown. The exception seems to be because the act of coping the SSL certificate seems to trigger yet another validation check.Here is the code, and maybe someone can either show me a better way to do this or if I am missing something. I don't care if the SSL Certificate is expired or doesn't match the URL. None of that is relevant for what I'm doing.When I assign the X509Certificate in the delegate to a new variable, and look at the variable in the debugger, all the properties show SSLCert.Issuer threw an exception of type 'System.Security.Cryptography.CyrptographicException'When I try to access a property of SSLCert, I get the following Exception thrown: m_safeCertContext is an invalid handleI'be searched for that exception, but everything points to an invalid certificate, which might be true if the certificate is expired, and might be true for the IP and port combination I am connecting to. But since I am connecting to the IP using the IP and not anything that would match the common name, I expect that and could care less as I still need the information.The code is below, I put some comments in as well for what doesn't work and what does work. <code>  // To get around the SSL validation in the HttpWebRequest System.Net.ServicePointManager.ServerCertificateValidationCallback = delegate(object sender, System.Security.Cryptography.X509Certificates.X509Certificate certificate, System.Security.Cryptography.X509Certificates.X509Chain chain, System.Net.Security.SslPolicyErrors sslPolicyErrors) { // The below works but isn't what I want. CertName and ExpireDate are both Strings this.CertName = ProcessSubject(certificate.Subject); this.ExpireDate = certificate.GetExpirationDateString(); // The below works but the X509Certificate SSLCert shows exceptions in the debugger for most of the properties. this.SSLCert = certificate; return true; // **** Always accept }; HttpWebRequest myRequest = (HttpWebRequest)System.Net.WebRequest.Create(""https://"" + this.IP + "":"" + this.Port + ""/SSLCheck.html""); myRequest.KeepAlive = false; myRequest.Method = ""GET""; try { HttpWebResponse myResponse = (HttpWebResponse)myRequest.GetResponse(); } catch (Exception e) { if (e.Message != ""The remote server returned an error: (404) Not Found."") { throw Exception(""Error""); } } // THE BELOW FAILS this.CertName = this.SSLCert.Subject;",How do I use SSL certificates with HttpWebRequest in C#?
Honeywell Dolphin 9500 C# Event Handling Conflicts?," EnvironmentWindows XP x32 Visual Studio 2005 Standard EditionHoneywell Dolphin 9500 running Windows Mobile 2003 (Pocket PC 2003)With built in Barcode scanner and B&W cameraUsing their SDK located here..NET Compact Framework 1.0 SP3 and .NET Framework 1.1Using VC#GoalI am attempting to create an application that allows an individual to scan a barcode and then capture an image. These things should not happen simultaneously. The user should be able to double check the barcode scan, then move onto the portion of the application that handles image capturing.ProblemLine numbers are referencing my code in the friendpaste link in the Code section below.I have two event handlers in place: one for the decode event from the barcode scanner control, and one to invoke the image capture control via a KeyDown event. The decode control has its own event/handler DecodeEventHandler and a trigger key set with an enum (lns 201 and 202). The image control, however, does not. Its documentation states that the Form should have a KeyDown event handler (ln 120) and the trigger key enum (ln 178). Upon running the application (without the SelectedIndexChanged [ln 76] event handler in place), the barcode scanner works great, but switching over to the tab (or Form, as I have tried separate forms as well), with the image capture control and hitting the Trigger Key on the device (SCAN in this case) causes the handheld to act like it's still scanning a barcode (red lights come on, green aim light is show, beeps when encounters a barcode) instead of the behavior normally displayed when using the image control (no lights, or white lights like a flash).Things I have TriedIMPORTANT: If I remove the decode control from the application, the image control works. If I build a separate application with only the image control, it works.I put a break point at line 210 and found out the KeyDown event is never getting hit. At this point I tried to somehow segregate the event handlers or controls so I introduced the SelectedIndexChanged event handler for my tab control and upon switching to the tab with the appropriate control, I tried removing event handlers. I was able to remove the DecodeEvent handler but was still unable to hit the KeyDown event handler delegate I wrote. Both the decode and image controls from Honeywell's SDK have ""Disconnect"" events which (to quote the documentation) ""Disconnect from the scan engine"". So I tried disconnecting and reconnecting controls based on which tab I was switching to but was unsuccessful in this as well.I also read somewhere that Form events can sometimes be disrupted if the Form loses focus. So I implemented the Form.LostControl event/handler and put in this.Focus() to return focus to the form but to no avail.I have run across multiple people suggesting KeyPreview = true and handling/delegating the events at the form level. It appears the .NET Compact Framework version 1 does not implement this as my Form objects have no KeyPreview member.Within the TriggerKey enum (example at line 202) there is an enum for the Enter key on the device. I tried wiring that up to the image control, and scan up to the decoder control but was still unable to hit the KeyDown event.Codehttp://friendpaste.com/355cQOCghvPkE5YR29lthOI posted the code as a friendpaste link because it's somewhat long (~230 lines). Let me know if I should just include it here.Need additional information?Ask away and I'll do my best!I would have tagged this Honeywell Dolphin 9500 but I am a new user. <code> ",Honeywell Dolphin 9500 (Pocket PC 2003) C# Event Handling Conflicts?
c# regex email validation," I use this regexp to validate the email([\w\.\-]+) - this is for the first-level domain (many letters and numbers, also point and hyphen)([\w\-]+) - this is for second-level domain((\.(\w){2,3})+) - and this is for other level domains(from 3 to infinity) which includes a point and 2 or 3 literalswhat's wrong with this regex?EDIT:it doesn't match the ""something@someth.ing"" email <code>  @""^([\w\.\-]+)@([\w\-]+)((\.(\w){2,3})+)$""",Regex Email validation
Is there any open source or free graphic/reports/charts framework for windows forms (.Net - c#)?, Are there any open source or free graphic/reports/charts framework for windows forms? <code> ,Is there any open source or free graphic/reports/charts framework for windows forms?
"Is there a high resolution (Micro, nanosecond) DateTime object available for the CLR?"," I have an instrument that stores timestamps the microsecond level, and I need to store those timestamps as part of collecting information from the instrument. Note that I do not need to generate timestamps; these time stamps are pre-generated by the instrument itself using a high resolution real-time operating system. Parsing out these values is not an issue they are stored using a standard format in UTC time. Originally I wanted to use the C# DateTime structure can only store time stamps up millisecond resolution.Is there another object supplied with .NET or a common C# library that supports micro- and (ideally) nanosecond resolution timestamps, or am I going to have to roll my own? <code> ","Is there a high resolution (microsecond, nanosecond) DateTime object available for the CLR?"
"Is there a high resolution (Microsecond, nanosecond) DateTime object available for the CLR?"," I have an instrument that stores timestamps the microsecond level, and I need to store those timestamps as part of collecting information from the instrument. Note that I do not need to generate timestamps; these time stamps are pre-generated by the instrument itself using a high resolution real-time operating system. Parsing out these values is not an issue they are stored using a standard format in UTC time. Originally I wanted to use the C# DateTime structure can only store time stamps up millisecond resolution.Is there another object supplied with .NET or a common C# library that supports micro- and (ideally) nanosecond resolution timestamps, or am I going to have to roll my own? <code> ","Is there a high resolution (microsecond, nanosecond) DateTime object available for the CLR?"
ASP.Net MVC 3 Disable Required validation attribute under certain circumstances," I was wondering if it is possible to disable the Required validation attribute in certain controller actions. I am wondering this because on one of my edit forms I do not require the user to enter values for fields that they have already specified previously. However I then implement logic that when they enter a value it uses some special logic to update the model, such as hashing a value etc.Any sugestions on how to get around this problem?EDIT:And yes client validation is a problem here to, as it will not allow them to submit the form without entering a value. <code> ",Disable Required validation attribute under certain circumstances
SQL Server CE 4 DataProvider not avaliable in server explorer," I have installed the sp1 for visual studio 2010 and installed sql server ce 4 runtime. But still not able to create connection to the sql ce database using standart data provider.This is how my Select DataProvider Dialog looks like now.P.S. Does not know if it matters, but I have tested this with console application and winforms application both targeted at .Net 4.0  <code> ",SQL Server CE 4 DataProvider not available in server explorer
declaring byte in a short way," I am wondering if there is any way to declare a byte variable in a short way like floats or doubles? I mean like 5f and 5d. Sure I could write byte x = 5, but that's a bit inconsequential if you use var for local variables. <code> ",Literal suffix for byte in .NET?
Is there a literal suffix for a .NET byte?," I am wondering if there is any way to declare a byte variable in a short way like floats or doubles? I mean like 5f and 5d. Sure I could write byte x = 5, but that's a bit inconsequential if you use var for local variables. <code> ",Literal suffix for byte in .NET?
Is there a literal suffix for byte in .NET?," I am wondering if there is any way to declare a byte variable in a short way like floats or doubles? I mean like 5f and 5d. Sure I could write byte x = 5, but that's a bit inconsequential if you use var for local variables. <code> ",Literal suffix for byte in .NET?
Polymorphish with Dependency Injection using Castle Windsor," How to configure Interface having multiple concrete implementation using Castle Windsor (using code). Below is the sample code. The ServiceTaxCalculator implementation: I want the instance of a concrete class based on service tax applicability. If service tax is applicable, I need ServiceTaxCalculator else DefaultCostCalculator.How to configure this scenario using Castle Windsor. <code>  public interface ICostCalculator{ double CalculateTotal(Order order);}public class DefaultCostCalculator : ICostCalculator{ public double CalculateTotal(Order order) { return order.Items.Sum(x => x.Product.Rate * x.Quantity); }} public class ServiceTaxCalculator : ICostCalculator{ private readonly ICostCalculator calculator; private double serviveTaxRate = 10.2; public ServiceTaxCalculator(ICostCalculator calculator) { this.calculator = calculator; } public double ServiceTaxRate { get { return this.serviceTaxRate; } set { this.serviceTaxRate = value; } } public double CalculateTotal(Order order) { double innerTotal = this.calculator.CalculateTotal(order); innerTotal += innerTotal * servieTaxRate / 100; return innerTotal; }}",Polymorphism with Dependency Injection using Castle Windsor
How to send/receive SOAP request and response using C#," I tried different code to send/receive soap responses but all fail with the same ""The remote server returned an error: (500) Internal Server Error."".I can access the same service using SoapUI. Am able to invoke the method too. I read in this forum that the reason why am I getting 500 error could be wrong header. I verified the header, it seems to be ok. I would appreciate if someone can help.Following is the sample SOAP request: I used the above sample request to execute the method and it worked. Here is the Soap request that I passed: Edit:I have updated the code above in WebServiceCall that worked for .asmx service. But the same code didn't work for WCF service. Why? <code>  private static string WebServiceCall(string methodName) { WebRequest webRequest = WebRequest.Create(""http://localhost/AccountSvc/DataInquiry.asmx""); HttpWebRequest httpRequest = (HttpWebRequest)webRequest; httpRequest.Method = ""POST""; httpRequest.ContentType = ""text/xml; charset=utf-8""; httpRequest.Headers.Add(""SOAPAction: http://tempuri.org/"" + methodName); httpRequest.ProtocolVersion = HttpVersion.Version11; httpRequest.Credentials = CredentialCache.DefaultCredentials; Stream requestStream = httpRequest.GetRequestStream(); //Create Stream and Complete Request StreamWriter streamWriter = new StreamWriter(requestStream, Encoding.ASCII); StringBuilder soapRequest = new StringBuilder(""<soap:Envelope xmlns:xsi=\""http://www.w3.org/2001/XMLSchema-instance\""""); soapRequest.Append("" xmlns:xsd=\""http://www.w3.org/2001/XMLSchema\"" ""); soapRequest.Append(""xmlns:soap=\""http://schemas.xmlsoap.org/soap/envelope/\""><soap:Body>""); soapRequest.Append(""<GetMyName xmlns=\""http://tempuri.org/\""><name>Sam</name></GetMyName>""); soapRequest.Append(""</soap:Body></soap:Envelope>""); streamWriter.Write(soapRequest.ToString()); streamWriter.Close(); //Get the Response HttpWebResponse wr = (HttpWebResponse)httpRequest.GetResponse(); StreamReader srd = new StreamReader(wr.GetResponseStream()); string resulXmlFromWebService = srd.ReadToEnd(); return resulXmlFromWebService;} POST /AccountSvc/DataInquiry.asmx HTTP/1.1Host: abc.def.gh.comContent-Type: text/xml; charset=utf-8Content-Length: lengthSOAPAction: ""http://tempuri.org/GetMyName""<?xml version=""1.0"" encoding=""utf-8""?><soap:Envelope xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:soap=""http://schemas.xmlsoap.org/soap/envelope/""> <soap:Body> <GetMyName xmlns=""http://tempuri.org/""> <name>string</name> </GetMyName> </soap:Body></soap:Envelope> <?xml version=""1.0"" encoding=""utf-8""?><soap:Envelope xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:soap=""http://schemas.xmlsoap.org/soap/envelope/""><soap:Body><GetMyName xmlns=""http://tempuri.org/""><name>Sam</name></GetMyName></soap:Body></soap:Envelope>",How to send/receive SOAP request and response using C#?
IoC - Constructor takes a specific instance as one parameter," I have a WPF app which, when it starts, looks at the file system for some config filesFor each config file it finds, it displays some info in a different windowEach window has an associated ViewModel object which is bound to the windows datacontextSo a new ViewModel is created for each config file. An object representing the data in the config file is passed into the viewmodels constructorHowever, the View model also has other dependancies passed into the constructorThe code looks something like this (in a bootstrapper initiated from app.xaml) I want to use Castle IoC contaoiner resolve these dependancies. I know how to do that for IMyService, but how can I do it for the specific class that has been created from the config file ?thanks <code>  foreach (WindowConfig config in ConfigManager.GetConfigs()){ IMyService svc = new MyService(); //change to resolve from IoC container MyViewModel vm = new MyViewModel(config, svc); Window1 view = new Window1(); view.DataContext = vm; window.show();}",IoC - Constructor takes a runtime value as one parameter and a service as another
C# Entity Framework 4 Insert new object with existing object," I am new to EF 4 and this is what I have done so far:Create an edmx file based on my databaseCreate a code generation for my objects (POCO). Now I have a model1.tt, when expanded I see al my classesCreate a repository for each class, based on IRepositoryNow, I am working with two objects, A and B. Object A has a property of type B. In my winform I have a combo filled with objects of type B. When the save button is pressed, a new instance of class A is created and all the properties are set. The object B property is set as follows: Then I create a repository for objectA and call the save method. In this save method I have this code This code, does save a new entry to the database, but it is also creating a new record for object B! I don't want this, because object B already exists in the database! (I have selected this one from the combobox).This is how I fill my combobox:In the objectB repository: In my form: So my question is, what do I have to do to save object A without creating a new record for objectB? <code>  objectA.myObjectB = (objectB)cmbBObjects.selectedItem; public bool Save(ObjectA obj){ using(MyContext context = new MyContext()) { context.objectAs.AddObject(obj); context.SaveChanges(); }} public IList<ObjectB> GetAll(){ using(MyContext context = new MyContext()) { IList<ObjectB> objects = context.objectBs.ToList(); return objects; }} ObjectBRepository rep = new ObjectBRepository();IList<ObjectB> objects = rep.GetAll;cmbBObjects.Datasource = objects;// etc..", Insert new object with existing object
C# How can I format a number into a string with leading zeros?, I have a number that I need to convert to a string. First I used this: But I realize it's being sorted in a strange order and so I need to pad it with zeros. How could I do this? <code>  Key = i.ToString();,How can I format a number into a string with leading zeros?
How to convert a byte array to char[] in c#, How do I convert a byte array to a char array in C#? <code> ,Convert byte[] to char[]
Difference between Ninject and RhinoMock or Moq, What is the difference between Ninject and a mocking framework like RhinoMocks or Moq? I Google'd this but it is still unclear. <code> ,Difference between Dependency Injection and Mocking Framework (Ninject vs RhinoMocks or Moq)
Difference between Dependency Injection and Mocking framework (Ninject vs RhinoMock or Moq), What is the difference between Ninject and a mocking framework like RhinoMocks or Moq? I Google'd this but it is still unclear. <code> ,Difference between Dependency Injection and Mocking Framework (Ninject vs RhinoMocks or Moq)
Why DateTime.Now() method is missing in C#," After reading this blog entry : http://wekeroad.com/post/4069048840/when-should-a-method-be-a-property,I'm wondering why Microsoft choose in C# : instead of Best practices say : Use a method when calling the member twice in succession produces different resultsAnd DateTime.Now is perfect example of non-determistic method/property.Do you know if there any reason for that design ?Or if it's just a small mistake ? <code>  DateTime aDt = DateTime.Now; DateTime aDt = DateTime.Now();",Why is DateTime.Now a property and not a method?
Where i can found System.Web.MVC dll in a system where MVC 3 goes installed ?," I want to know where I can find the System.Web.MVC dll in a system, where MVC 3 is already installed. I want to it on an X64-based system.Any idea how to get them? <code> ",Where can I find System.Web.MVC dll in a system where MVC 3 is installed?
Where i can find System.Web.MVC dll in a system where MVC 3 is installed ?," I want to know where I can find the System.Web.MVC dll in a system, where MVC 3 is already installed. I want to it on an X64-based system.Any idea how to get them? <code> ",Where can I find System.Web.MVC dll in a system where MVC 3 is installed?
Where can I find System.Web.MVC dll in a system where MVC 3 is installed ?," I want to know where I can find the System.Web.MVC dll in a system, where MVC 3 is already installed. I want to it on an X64-based system.Any idea how to get them? <code> ",Where can I find System.Web.MVC dll in a system where MVC 3 is installed?
"Does ""Anonymous Recurssion"" work in .NET? It does in Mono."," I surfed into this site a few days ago on ""Anonymous Recursion in C#"". The thrust of the article is that the following code will not work in C#: The article then goes into some detail about how to use currying and the Y-combinator to get back to ""Anonymous Recursion"" in C#. This is pretty interesting but a tad complex for my everyday coding I am afraid. At this point at least...I like to see stuff for myself so I opened the Mono CSharp REPL and entered that line. No errors. So, I entered fib(8);. Much to my great surprise, it worked! The REPL replied back with 21!I thought maybe this was some magic with the REPL, so I fired-up 'vi', typed in the following program, and compiled it. It built and ran perfectly too!I am running Mono 2.10 on a Mac. I do not have access to a Windows machine right now so I cannot test this on .NET on Windows.Has this been fixed on .NET as well or is this a silent feature of Mono? The article is a couple of years old.If it is Mono only, I cannot wait for the next job interview where they ask me to write a Fibinocci function in the language of my choice (Mono C#) where I have to provide the caveat that .NET will not work. Well, actually I can wait since I love my job. Still, interesting...Update:Mono is not really doing ""anonymous"" recursion as it is using fib as a named delegate. My bad. The fact that the Mono C# compiler assumes a null value for fib before assignment is a bug as noted below. I say ""compiler"" because the .NET CLR would run the resulting assembly just fine even though the .NET C# compiler would not compile the code.For all the interview Nazis out there: can be replaced with an iterative version: You might want to do this because the recursive version is inefficient in a language like C#. Some might suggest using memoization but, since this is still slower than the iterative method, they may just be being wankers. :-)At this point though, this becomes more of an ad for functional programming than anything else (since the recursive version is so much nicer). It really does not have anything to do with my original question, but some of the answers thought that it was important. <code>  Func<int, int> fib = n => n > 1 ? fib(n - 1) + fib(n - 2) : n; using System;public class Program{ public static void Main(string[] args) { int x = int.Parse(args[0]); Func<int, int> fib = n => n > 1 ? fib(n - 1) + fib(n - 2) : n; Console.WriteLine(fib(x)); }} Func<int, int> fib = n => n > 1 ? fib(n - 1) + fib(n - 2) : n; Func<int, int> fib = n => { int old = 1; int current = 1; int next; for (int i = 2; i < n; i++) { next = current + old; old = current; current = next; } return current;};","Does ""Anonymous Recursion"" work in .NET? It does in Mono."
How to instantiate or mock a Window programatically?," For some of my unit tests I have to call methods that require a Window as parameter. Unfortunately I can't pass null, since the method uses the window as a reference to update the status bar where I show what is actually loaded in the real application.So I tried to call the constructor in the unit test: But this results in the following error on the InitializeComponent method of the MainWindow constructor: So my question is, how can I instantiate or mock a window in unit testing? <code>  MainWindow window = new MainWindow(); System.Windows.Markup.XamlParseException occurred Message='Provide value on 'System.Windows.Baml2006.TypeConverterMarkupExtension' threw an exception.' Line number '9' and line position '42'. Source=PresentationFramework LineNumber=9 LinePosition=42 StackTrace: at System.Windows.Markup.XamlReader.RewrapException(Exception e, IXamlLineInfo lineInfo, Uri baseUri) InnerException: System.IO.IOException Message=Assembly.GetEntryAssembly() returns null. Set the Application.ResourceAssembly property or use the pack://application:,,,/assemblyname;component/ syntax to specify the assembly to load the resource from. Source=PresentationFramework StackTrace: at MS.Internal.AppModel.ResourceContainer.GetResourceManagerWrapper(Uri uri, String& partName, Boolean& isContentFile) at MS.Internal.AppModel.ResourceContainer.GetPartCore(Uri uri) at System.IO.Packaging.Package.GetPartHelper(Uri partUri) at System.IO.Packaging.Package.GetPart(Uri partUri) at System.IO.Packaging.PackWebResponse.CachedResponse.GetResponseStream() at System.IO.Packaging.PackWebResponse.GetResponseStream() at System.IO.Packaging.PackWebResponse.get_ContentType() at System.Windows.Media.Imaging.BitmapDecoder.SetupDecoderFromUriOrStream(Uri uri, Stream stream, BitmapCacheOption cacheOption, Guid& clsId, Boolean& isOriginalWritable, Stream& uriStream, UnmanagedMemoryStream& unmanagedMemoryStream, SafeFileHandle& safeFilehandle) at System.Windows.Media.Imaging.BitmapDecoder.CreateFromUriOrStream(Uri baseUri, Uri uri, Stream stream, BitmapCreateOptions createOptions, BitmapCacheOption cacheOption, RequestCachePolicy uriCachePolicy, Boolean insertInDecoderCache) at System.Windows.Media.Imaging.BitmapFrame.CreateFromUriOrStream(Uri baseUri, Uri uri, Stream stream, BitmapCreateOptions createOptions, BitmapCacheOption cacheOption, RequestCachePolicy uriCachePolicy) at System.Windows.Media.ImageSourceConverter.ConvertFrom(ITypeDescriptorContext context, CultureInfo culture, Object value) at System.Windows.Baml2006.TypeConverterMarkupExtension.ProvideValue(IServiceProvider serviceProvider) at MS.Internal.Xaml.Runtime.ClrObjectRuntime.CallProvideValue(MarkupExtension me, IServiceProvider serviceProvider) InnerException: ",How to instantiate or mock a Window programmatically?
Why isn't values implicitly convertible to string in C#?," I have some code like: and the MessageBox.Show complains saying: ""cannot convert from 'int' to 'string'""I seem to remember some cases where values seem to be implicitly converted to string values, but can't recall them exactly.What's the reason behind this decision that any value isn't implicitly convertible to string values? <code>  int value = 5;MessageBox.Show ( value );",Why aren't values implicitly convertible to string in C#?
fastest way to check a word can be made by letters of another word," How to check, if a word can be made by letters of another word. using every letter only once.Example:if str = ""computer""; then <code>  //if user enters below words output must be true comp put poet//and if user enters below words output must be false count // since n is not in str root // since there is only single o in str ",Check if a string can be made by chars of another string in C#
How to know whether there is any intersection in a collection of periods using LINQ," I have a collection of periods [FromDate, ToDate].I would know whether there is any overlap between a given period and the periods in the collection.I've already started with this: The problem that it does not cover all the situation, for example: And if I discuss more situation I think the query will become more complicated.I wonder if you could help me with the simplest valid way.Regards. <code>  // periodToCheck is the given item bool conflict = Periods.Any(p => ((p.FromDate >= periodToCheck.fromDate && p.FromDate <= periodToCheck.toDate) || (p.ToDate >= periodToCheck.fromDate && p.ToDate <= periodToCheck.toDate)) ); [2010.1.1], [2010.1.31][2010.1.5], [2010.1.6] // Is valid in the query in spite of it is not valid // (because there is intersection).",How to know whether there is any overlap in a collection of periods using LINQ
How to I refactor code to explicitly name each parm to a method?," I wish to transform code like: To: As a first step in making the code more readable, I am willing to use a 3rd party refactoring tool if need be.(Please do not tell me to use parameter objects and factor methods etc, these may come later once I can at least read the code!)  <code>  var p = new Person(""Ian"", ""Smith"", 40, 16) var p = new Person(surname: ""Ian"", givenName:""Smith"", weight:40, age:16)",Is there any tools to help me refactor a method call from using position-based to name-based parameters
How to disable horizontal Scroll bar disabled in flowlayoutpanel?," I have a FlowLayoutPanel and there are multiple controls on it. I only want to scroll in vertical direction. But when I set AutoScroll = true, I got both Vertical and Horizontal Scroll bars. How could I disable the horizontal scroll bar and only keep the vertical scroll bar working? <code> ",How to disable horizontal scroll bar in FlowLayoutPanel?
Update Row if it Exists Else Insert Logic with Entity Framework," What is the most efficient way to implement update row if it exists, else insert new row logic using Entity Framework? Or are there any patterns for this? <code> ",Update row if it exists else insert logic with Entity Framework
"C# - Close SqlConnection in the Finally when using ""Using""", I want to close the SqlConnection in the Finally since the using not really close it and the connection pool gets full. but I don't realize what's the right way to fo that since the conn object isn't reachable any more in the finally section. <code>  try { using (var conn = new SqlConnection(_dbconnstr)) { //... }}catch (Exception ex){ //...}finally { conn.Close //?!?!?!?!???},"Close SqlConnection in the Finally when using ""Using"""
Using MySQLConnection in C# does not close properly.," Final solution:The connection was added to the connection pool. So I closed it, but it still remained physically open. With the ConnectionString Parameter ""Pooling=false"" or the static methods MySqlConnection.ClearPool(connection) and MySqlConnection.ClearAllPools the problem can be avoided. Note that the problem was, that the connection was still alive when I closed the application. Even though I closed it. So either I don't use connection pooling at all or I clear the specific pool before closing the connection and the problem is solved. I'll take my time figuring out what's the best solution in my case.Thanks to all who answered! It helped my understand the concepts of C# better and I learned alot from the useful input. :)===Original Problem:I've searched for a while now and haven't found the solution for my problem:I'm new to C# and try to write a class to make MySql Connections easier. My problem is, after I open a connection and close it. It is still open in the Database and gets aborted.I'm using the 'using' statement' of course, but the connection is still open and gets aborted after I exit the program.Here's what my code looks like: The class Database manager opens the connection and closes it when disposed: So, I checked it in the debugger and the Dispose()-method is called and executes correctly.What am I missing? Is there something I did wrong or misunderstood?Any help is appreciated!Greetings,SimonP.S.:Just in case, the DataReader()-method (Updated version): Ok, I tried to use the yield return: And I changed the DataReader-method: It works in the way that I can retrieve the data, yet I still have the same problem: The connection isn't closed properly. :( <code>  using (DatabaseManager db = new DatabaseManager()){using (MySqlDataReader result = db.DataReader(""SELECT * FROM module WHERE Active=1 ORDER BY Sequence ASC"")){ foreach (MySqlDataReader result in db.DataReader(""SELECT * FROM module WHERE Active=1 ORDER BY Sequence ASC"")) { //Do stuff here }}} public DatabaseManager(){ this.connectionString = new MySqlConnectionStringBuilder(""Server=localhost;Database=businessplan;Uid=root;""); connect();}private bool connect(){ bool returnValue = true; connection = new MySqlConnection(connectionString.GetConnectionString(false)); connection.Open();}public void Dispose(){ Dispose(true);}public void Dispose(bool disposing){ if (disposing) { if (connection.State == System.Data.ConnectionState.Open) { connection.Close(); connection.Dispose(); } } //GC.SuppressFinalize(this);//Updated}//Updated//~DatabaseManager()//{// Dispose(false);//} public IEnumerable<IDataReader> DataReader(String query) { using (MySqlCommand com = new MySqlCommand()) { com.Connection = connection; com.CommandText = query; using (MySqlDataReader result = com.ExecuteReader(System.Data.CommandBehavior.CloseConnection)) { while (result.Read()) { yield return (IDataReader)result; } } } } foreach (MySqlDataReader result in db.DataReader(""SELECT * FROM module WHERE Active=1 ORDER BY Sequence ASC"")){ //...} public IEnumerable<IDataReader> DataReader(String query) { using (MySqlCommand com = new MySqlCommand()) { com.Connection = connection; com.CommandText = query; using (MySqlDataReader result = com.ExecuteReader()) { while (result.Read()) { yield return (IDataReader)result; } } } }",Using MySQLConnection in C# does not close properly
AutoMapper: Map Interface to Abstract class," I'm using AutoMapper to map objects between different layers of my application.On the one side I have an interface which looks like this: IRootObject looks like this: So the GetItems()call actually returns an array of only IxxxSubObjectItems.On the other side the structure looks like this: Now I've set up the mapper like so But I keep getting MapperExceptions (""Cannot construct abstract class"", which makes sense in a way). I also call AssertConfigurationIsValid, and that passes for this code.If I don't make the MyCustomRoot class abstract, then the mapping works, but I get a list of MyCustomRoot objects, while I actually would like to have a list of MyCustomxxxSub, because there is a Factory later on which uses this type to generate the correct UI... I hope someone can point me in the right direction for this one!Thanks!  <code>  public interface MyRepo { IEnumerable<IRootObject> GetItems(param);} public interface IRootObject{ int Id { get; set; } DateTime? Date { get; set; }}public interface IFirstSubObject : IRootObject { string MyFirstProp { get; set; }}public interface ISecondSubObject : IRootObject { string MySecondProp { get; set; }} public abstract class MyCustomRoot{ protected MyCustomRoot(){} public int Id { get; set; } public DateTime? Date { get; set; }}public class MyCustomFirstSub : MyCustomRoot{ public MyCustomFirstSub() : base() {} public string MyFirstProp { get; set; }}public class MyCustomSecondSub : MyCustomRoot{ public MyCustomSecondSub () : base() {} public string MySecondProp { get; set; }} AutoMapper.Mapper.CreateMap<IRootObject, MyCustomRoot> .Include<IFirstSubObject, MyCustomFirstSub> .Include<ISecondSubObject, MyCustomSecondSub>();AutoMapper.Mapper.CreateMap<IFirstSubObject, MyCustomFirstSub>();AutoMapper.Mapper.CreateMap<ISecondSubObject, MyCustomSecondSub>();",AutoMapper: Map Interface to Abstract class - is this possible?
Enum to Dictionary c#," I have searched this online, but I can't find the answer I am looking for. Basically I have the following enum: How can I convert this enum to Dictionary so that it stores in the following Dictionary? And myDic would look like this: Any ideas? <code>  public enum typFoo : int{ itemA : 1, itemB : 2 itemC : 3} Dictionary<int,string> myDic = new Dictionary<int,string>(); 1, itemA2, itemB3, itemC",Enum to Dictionary in C#
Enum to dictionary in C#," I have searched this online, but I can't find the answer I am looking for. Basically I have the following enum: How can I convert this enum to Dictionary so that it stores in the following Dictionary? And myDic would look like this: Any ideas? <code>  public enum typFoo : int{ itemA : 1, itemB : 2 itemC : 3} Dictionary<int,string> myDic = new Dictionary<int,string>(); 1, itemA2, itemB3, itemC",Enum to Dictionary in C#
Keep the left column of a treeview visible while scrolling horizontally," I implemented a treeview with columns in WPF using ControlTemplate and a stackpanel of GridViewRowPresenter. I followed this article : http://blogs.msdn.com/b/atc_avalon_team/archive/2006/03/01/541206.aspx It works perfectly!However, I would like to keep the left column (with the names) visible while scrolling horizontally.It would be like 'freeze panes' on microsoft excel on the first column.An idea, anyone?ThanksFrederic <code> ",Keep the leftmost column of a treeview visible while scrolling horizontally
WPF Keep the most left column of a treeview visible while scrolling horizontally," I implemented a treeview with columns in WPF using ControlTemplate and a stackpanel of GridViewRowPresenter. I followed this article : http://blogs.msdn.com/b/atc_avalon_team/archive/2006/03/01/541206.aspx It works perfectly!However, I would like to keep the left column (with the names) visible while scrolling horizontally.It would be like 'freeze panes' on microsoft excel on the first column.An idea, anyone?ThanksFrederic <code> ",Keep the leftmost column of a treeview visible while scrolling horizontally
C# Type.GetConstructor() returns null," I'm using Type.GetConstructor(Type.EmptyTypes) to get the default constructor for a class. It works if the class has a default constructor with no parameters (class A). But it doesn't work if a class has a constructor with all parameters optional (class B). Program doesn't know what the optional parameters are because it only needs the default constructor. What can statements can I use to make it work for both cases? Thanks, appreciate any help! <code>  public class A{ public A() {}} public class B{ public B(int i = 0, string str = """") {}}",How to get default constructor when parameters are optional
C# make datetimepicker work as only timepicker, How to restrict DateTimePicker to select the time only? I don't know how to disable calendar control which drops when you press the button at the right of DateTimePicker. <code> ,Make DateTimePicker work as TimePicker only in WinForms
How to print PDF document from Windows serverce," I have windows service that must periodically print PDF document from server. My function is When I implement this in Windows Application it works, but when I implement in Windows service it does not work.Can you help me? <code>  private void PrintFormPdfData(byte[] formPdfData){ string tempFile; tempFile = Path.GetTempFileName(); using (FileStream fs = new FileStream(tempFile, FileMode.Create)) { fs.Write(formPdfData, 0, formPdfData.Length); fs.Flush(); } string pdfArguments = string.Format(""/p /h\""{0}\"""", tempFile); string pdfPrinterLocation = @""C:\Program Files (x86)\Adobe\Reader 9.0\Reader\AcroRd32.exe""; ProcessStartInfo newProcess = new ProcessStartInfo(pdfPrinterLocation, pdfArguments); newProcess.CreateNoWindow = true; newProcess.RedirectStandardOutput = true; newProcess.UseShellExecute = false; newProcess.RedirectStandardError = true; Process pdfProcess = new Process(); pdfProcess.StartInfo = newProcess; pdfProcess.StartInfo.WindowStyle = ProcessWindowStyle.Hidden; pdfProcess.Start(); pdfProcess.WaitForExit();}",How to print PDF document from Windows Service
C# Dictionary to JSON," I want to convert my Dictionary<int,List<int>> to JSON string. Does anyone know how to achieve this in C#? <code> ",How do I convert a dictionary to a JSON String in C#?
How to total columns in a dataTable?," How can I get a sum for all the columns in a datatable? Say I had the following table. How can I calculate the ""total"" row? It should be easy to add total row to a datatable. UpdateI ended up with this. It was the only thing I could get to work. <code>  Columns hits uniques sigups, etc...Rows 1 12 1 232 1 0 53 6 2 9total 19 3 37 For Each col As DataColumn In TotalsTable.Columns If col.DataType.Name = ""DateTime"" Then count = count + 1 Continue For End If Dim colTotal As Double = 0 Dim value As Double For Each row As DataRow In TotalsTable.Rows If Double.TryParse(row(col), value) Then colTotal += Double.Parse(row(col)) End If Next totalRow(count) = colTotal count = count + 1 Next",How to sum columns in a dataTable?
C# XML Parsing - Read a Simple XML File and Retrieve Values.," I've written a Task Scheduling program for learning purposes. Currently I'm saving the scheduled tasks just as plain text and then parsing it using Regex. This looks messy (code wise) and is not very coherent. I would like to load the scheduled tasks from an XML file instead, I've searched quite a bit to find some solutions but I couldn't get it to work how I wanted. I wrote an XML file structured like this to store my data in: The way I'd like to parse the data is like so: Open Tasks.xml Load the first Task tag. In that task retrieve the values of the Name, Location and Arguments tags. Then open the RunWhen tag and retrieve the values of the Time and Date tags. After that open the Days tag and retrieve the value of each individual tag within. Retrieve the value of Enabled. Load the next task and repeat steps 3 -> 7 until all the Task tags in Tasks have been parsed. I'm very sure you can do it this way I just can't work it out as there are so many different ways to do things in XML I got a bit overwhelmed. But what I've go so far is that I would most likely be using XPathDocument and XPathNodeIterator right?If someone can show me an example or explain to me how this would be done I would be very happy. <code>  <Tasks> <Task> <Name>Shutdown</Name> <Location>C:/WINDOWS/system32/shutdown.exe</Location> <Arguments>-s -f -t 30</Arguments> <RunWhen> <Time>8:00:00 a.m.</Time> <Date>18/03/2011</Date> <Days> <Monday>false</Monday> <Tuesday>false</Tuesday> <Wednesday>false</Wednesday> <Thursday>false</Thursday> <Friday>false</Friday> <Saturday>false</Saturday> <Sunday>false</Sunday> <Everyday>true</Everyday> <RunOnce>false</RunOnce> </Days> </RunWhen> <Enabled>true</Enabled> </Task></Tasks>",XML Parsing - Read a Simple XML File and Retrieve Values
Razor And Javascript," I'm pretty confused with how to mix razor and js. This is the current function I am stuck with: If I could declare c# code with <c#></c#> and everything else was JS code -- this would be what I am after: What is the best method to achieve this? <code>  <script type=""text/javascript""> var data = []; @foreach (var r in Model.rows) { data.push([ @r.UnixTime * 1000, @r.Value ]); } <script type=""text/javascript""> var data = []; <c#>@foreach (var r in Model.rows) {</c#> data.push([ <c#>@r.UnixTime</c#> * 1000, <c#>@r.Value</c#> ]); <c#>}</c#>",Mix Razor and Javascript code
Hyperlink to bookmark in a word document - wpf c#," Is it possible to link to a bookmark within a word document from a WPF text block?So far I have: I am assuming the relative path is from the exe location. I can't get the document to open at all. <code>  <TextBlock TextWrapping=""Wrap"" FontFamily=""Courier New""> <Hyperlink NavigateUri=""..\\..\\..\\MyDoc.doc""> My Word Document </Hyperlink></TextBlock>",Hyperlink to bookmark in a MS Word document
C# - Any easy way to use icons from resources?," I have an C# app. I need to add an icon to that app so i added an icon resource. Adding resource went fine, but is there any way to use my (resource) icon as form icon WITHOUT adding additional code? When i try to use design-time ""icon"" property of form it seems i have to choose a file, but i want to use embedded icon...Any help? <code> ",Any easy way to use icons from resources?
C# Custom Error Handling Web.Config / Global.asax not handling non-existing directory," Question is: Why is custom Error handling not working for non-existing paths/directories?Updated with fixed code (thanks to everyone for you input):* Updated code for web.config and global.asax * We have a site setup with custom error handling in web.config and global.asax (the setup is shown below). We are able to handle all 404's and 500's with no problems. The errors are caught in the Application_Error in the global.asax, logged to a DB then using HttpContext we set the status code and use Server.Transfer() to move the user to the appropriate error page (redirects cause a 302, and hurts SEO).The problem is when the user types in http://www.example.com/whatever a blank page is shown in Firefox and in IE it shows the IE 404 page. Firebug shows no status codes being fired, and when I debug the solution, no breakpoints I have set are hit in the global.asax. The odd thing is that a user can enter http://www.example.com/whatever/hmm.aspx and an error will be hit. It seems it's only working on non-existing pages and not paths/directories that don't exist. Below is my web.config code for the Errors and my global.asax code for Application error.I've added the ** to hide info, they have valid .aspx pages in them:Web config: Code: <code>  <httpErrors errorMode=""Custom""> <remove statusCode=""500"" subStatusCode=""-1"" /> <remove statusCode=""404"" subStatusCode=""-1"" /> <error statusCode=""404"" subStatusCode=""-1"" prefixLanguageFilePath="""" path=""/*****.aspx"" responseMode=""ExecuteURL"" /> <error statusCode=""500"" subStatusCode=""-1"" prefixLanguageFilePath="""" path=""/*****.aspx"" responseMode=""ExecuteURL""/> </httpErrors> added this to the global.asax to stop IIS from handling my 500 errors after @Kev's suggestions IIS handled my 500's these lines fixed that HttpApplication myApplication = new HttpApplication(); myApplication.Response.TrySkipIisCustomErrors = true; <customErrors defaultRedirect=""~/******.aspx"" mode=""On"" redirectMode=""ResponseRewrite""> <error statusCode=""500"" redirect=""~/*****.aspx"" /> <error statusCode=""404"" redirect=""~/*****.aspx"" /></customErrors> <httpErrors errorMode=""Custom""> <remove statusCode=""500"" subStatusCode=""-1"" /> <remove statusCode=""404"" subStatusCode=""-1"" /> <error statusCode=""404"" subStatusCode=""-1"" prefixLanguageFilePath="""" path=""/*****.aspx"" responseMode=""ExecuteURL"" /> <error statusCode=""500"" subStatusCode=""-1"" prefixLanguageFilePath="""" path=""/*****.aspx"" responseMode=""ExecuteURL""/> </httpErrors> protected void Application_Error(Object sender, EventArgs e){ // At this point we have information about the error HttpContext ctx = HttpContext.Current; // set the exception to the Context Exception exception = ctx.Server.GetLastError(); // get the status code of the Error int httpCode = ((HttpException)exception).GetHttpCode(); // get the IP Address String strHostName = string.Empty; String ipAddress_s = string.Empty; strHostName = System.Net.Dns.GetHostName(); System.Net.IPHostEntry ipEntry = System.Net.Dns.GetHostByName(strHostName); System.Net.IPAddress[] addr = ipEntry.AddressList; for (int i = 0; i < addr.Length; i++) { ipAddress_s += ""IP Address {"" + (i + 1) + ""} "" + addr[i].ToString() + Environment.NewLine; } // setup the error info one for user display and one for the DB Insert string errorInfo = ""<br /><b>Error Location:</b> "" + ctx.Request.Url.ToString() + ""<br /><br /><b>Error Source:</b> "" + exception.Source + ""<br /><br /><b>Error Try/Catch:</b> "" + exception.InnerException + ""<br /><br /><b>Error Info:</b> "" + exception.Message + ""<br /><br /><b>Status Code:</b> "" + httpCode + ""<br /><br /><b>Stack trace:</b> "" + exception.StackTrace; string errorInfoDB = ""||Error Location: "" + ctx.Request.Url.ToString() + ""||Error Source: "" + exception.Source + ""||Error Try/Catch: "" + exception.InnerException + ""||Error Info: "" + exception.Message + ""||HttpErrorCode: "" + httpCode + ""||Stack trace: "" + exception.StackTrace + ""||IP Address: "" + ipAddress_s; // clean the input befor you put it in the DB char quote = (char)34; char filler = (char)124; char tick = (char)39; char greaterThan = (char)60; char lessThan = (char)62; errorInfo = errorInfo.Replace(quote, filler); errorInfo = errorInfo.Replace(tick, filler); errorInfo = errorInfo.Replace(greaterThan, filler); errorInfo = errorInfo.Replace(lessThan, filler); errorInfoDB = errorInfoDB.Replace(quote, filler); errorInfoDB = errorInfoDB.Replace(tick, filler); errorInfoDB = errorInfoDB.Replace(greaterThan, filler); errorInfoDB = errorInfoDB.Replace(lessThan, filler); string pattern = string.Empty; string replacement = ""sQueEl""; pattern = ""/cookie|SELECT|UPDATE|INSERT|INTO|DELETE|FROM|NOT IN|WHERE|TABLE|DROP|script*/ig""; errorInfoDB = Regex.Replace(errorInfoDB, pattern, replacement); pattern = ""/cookie|select|update|insert|into|delete|from|not in|where|table|drop|script*/ig""; errorInfoDB = Regex.Replace(errorInfoDB, pattern, replacement); if (httpCode == 404) { InSert_To_DB_Class(*****, *****, *****, *****, *****, errorInfoDB); } else { InSert_To_DB_Class(*****, *****, *****, *****, *****, errorInfoDB); } // set the error info to the session variable to display to the allowed users Application[""AppError""] = errorInfo; // clear the error now that is has been stored to a session ctx.Server.ClearError(); ctx.Response.ClearHeaders(); // set the status code so we can return it for SEO ctx.Response.StatusCode = httpCode; ctx.Response.TrySkipIisCustomErrors = true; HttpApplication myApplication = new HttpApplication(); myApplication.Response.TrySkipIisCustomErrors = true; try { if (ctx.Request.RawUrl.Contains(""/*****"")) { // redirect to the error page ctx.Server.Transfer(""~/*****.aspx"", false); } else if(ctx.Request.RawUrl.Contains(""/*****"")) { ctx.Server.Transfer(""~/*****/*****.aspx"", false); } else { // check the httpCode if (httpCode == 404) { // set the page name they were trying to find to a session variable // this will be cleared in the ****** page Application[""404_page""] = exception.Message; // redirect to the 404 page ctx.Server.Transfer(""~/*****"", false); } else { // redirect to the error page ctx.Server.Transfer(""~/*****"", false); } } }}",Custom Error Handling in web.config / Global.asax not handling non-existant directory
Custom Error Handling Web.config / Global.asax not handling non-existing directory," Question is: Why is custom Error handling not working for non-existing paths/directories?Updated with fixed code (thanks to everyone for you input):* Updated code for web.config and global.asax * We have a site setup with custom error handling in web.config and global.asax (the setup is shown below). We are able to handle all 404's and 500's with no problems. The errors are caught in the Application_Error in the global.asax, logged to a DB then using HttpContext we set the status code and use Server.Transfer() to move the user to the appropriate error page (redirects cause a 302, and hurts SEO).The problem is when the user types in http://www.example.com/whatever a blank page is shown in Firefox and in IE it shows the IE 404 page. Firebug shows no status codes being fired, and when I debug the solution, no breakpoints I have set are hit in the global.asax. The odd thing is that a user can enter http://www.example.com/whatever/hmm.aspx and an error will be hit. It seems it's only working on non-existing pages and not paths/directories that don't exist. Below is my web.config code for the Errors and my global.asax code for Application error.I've added the ** to hide info, they have valid .aspx pages in them:Web config: Code: <code>  <httpErrors errorMode=""Custom""> <remove statusCode=""500"" subStatusCode=""-1"" /> <remove statusCode=""404"" subStatusCode=""-1"" /> <error statusCode=""404"" subStatusCode=""-1"" prefixLanguageFilePath="""" path=""/*****.aspx"" responseMode=""ExecuteURL"" /> <error statusCode=""500"" subStatusCode=""-1"" prefixLanguageFilePath="""" path=""/*****.aspx"" responseMode=""ExecuteURL""/> </httpErrors> added this to the global.asax to stop IIS from handling my 500 errors after @Kev's suggestions IIS handled my 500's these lines fixed that HttpApplication myApplication = new HttpApplication(); myApplication.Response.TrySkipIisCustomErrors = true; <customErrors defaultRedirect=""~/******.aspx"" mode=""On"" redirectMode=""ResponseRewrite""> <error statusCode=""500"" redirect=""~/*****.aspx"" /> <error statusCode=""404"" redirect=""~/*****.aspx"" /></customErrors> <httpErrors errorMode=""Custom""> <remove statusCode=""500"" subStatusCode=""-1"" /> <remove statusCode=""404"" subStatusCode=""-1"" /> <error statusCode=""404"" subStatusCode=""-1"" prefixLanguageFilePath="""" path=""/*****.aspx"" responseMode=""ExecuteURL"" /> <error statusCode=""500"" subStatusCode=""-1"" prefixLanguageFilePath="""" path=""/*****.aspx"" responseMode=""ExecuteURL""/> </httpErrors> protected void Application_Error(Object sender, EventArgs e){ // At this point we have information about the error HttpContext ctx = HttpContext.Current; // set the exception to the Context Exception exception = ctx.Server.GetLastError(); // get the status code of the Error int httpCode = ((HttpException)exception).GetHttpCode(); // get the IP Address String strHostName = string.Empty; String ipAddress_s = string.Empty; strHostName = System.Net.Dns.GetHostName(); System.Net.IPHostEntry ipEntry = System.Net.Dns.GetHostByName(strHostName); System.Net.IPAddress[] addr = ipEntry.AddressList; for (int i = 0; i < addr.Length; i++) { ipAddress_s += ""IP Address {"" + (i + 1) + ""} "" + addr[i].ToString() + Environment.NewLine; } // setup the error info one for user display and one for the DB Insert string errorInfo = ""<br /><b>Error Location:</b> "" + ctx.Request.Url.ToString() + ""<br /><br /><b>Error Source:</b> "" + exception.Source + ""<br /><br /><b>Error Try/Catch:</b> "" + exception.InnerException + ""<br /><br /><b>Error Info:</b> "" + exception.Message + ""<br /><br /><b>Status Code:</b> "" + httpCode + ""<br /><br /><b>Stack trace:</b> "" + exception.StackTrace; string errorInfoDB = ""||Error Location: "" + ctx.Request.Url.ToString() + ""||Error Source: "" + exception.Source + ""||Error Try/Catch: "" + exception.InnerException + ""||Error Info: "" + exception.Message + ""||HttpErrorCode: "" + httpCode + ""||Stack trace: "" + exception.StackTrace + ""||IP Address: "" + ipAddress_s; // clean the input befor you put it in the DB char quote = (char)34; char filler = (char)124; char tick = (char)39; char greaterThan = (char)60; char lessThan = (char)62; errorInfo = errorInfo.Replace(quote, filler); errorInfo = errorInfo.Replace(tick, filler); errorInfo = errorInfo.Replace(greaterThan, filler); errorInfo = errorInfo.Replace(lessThan, filler); errorInfoDB = errorInfoDB.Replace(quote, filler); errorInfoDB = errorInfoDB.Replace(tick, filler); errorInfoDB = errorInfoDB.Replace(greaterThan, filler); errorInfoDB = errorInfoDB.Replace(lessThan, filler); string pattern = string.Empty; string replacement = ""sQueEl""; pattern = ""/cookie|SELECT|UPDATE|INSERT|INTO|DELETE|FROM|NOT IN|WHERE|TABLE|DROP|script*/ig""; errorInfoDB = Regex.Replace(errorInfoDB, pattern, replacement); pattern = ""/cookie|select|update|insert|into|delete|from|not in|where|table|drop|script*/ig""; errorInfoDB = Regex.Replace(errorInfoDB, pattern, replacement); if (httpCode == 404) { InSert_To_DB_Class(*****, *****, *****, *****, *****, errorInfoDB); } else { InSert_To_DB_Class(*****, *****, *****, *****, *****, errorInfoDB); } // set the error info to the session variable to display to the allowed users Application[""AppError""] = errorInfo; // clear the error now that is has been stored to a session ctx.Server.ClearError(); ctx.Response.ClearHeaders(); // set the status code so we can return it for SEO ctx.Response.StatusCode = httpCode; ctx.Response.TrySkipIisCustomErrors = true; HttpApplication myApplication = new HttpApplication(); myApplication.Response.TrySkipIisCustomErrors = true; try { if (ctx.Request.RawUrl.Contains(""/*****"")) { // redirect to the error page ctx.Server.Transfer(""~/*****.aspx"", false); } else if(ctx.Request.RawUrl.Contains(""/*****"")) { ctx.Server.Transfer(""~/*****/*****.aspx"", false); } else { // check the httpCode if (httpCode == 404) { // set the page name they were trying to find to a session variable // this will be cleared in the ****** page Application[""404_page""] = exception.Message; // redirect to the 404 page ctx.Server.Transfer(""~/*****"", false); } else { // redirect to the error page ctx.Server.Transfer(""~/*****"", false); } } }}",Custom Error Handling in web.config / Global.asax not handling non-existant directory
ASP.NET Web-forms custom validator not firing.," I have a custom validator on my page for a file upload control. I then also have a button. I have defined my custom validator event like so... This custom validator isn't even getting fired. Everything looks alright to me. If I drop a breakpoint anywhere in the server validation event it does not get hit when I click submit. I can hit breakpoints in the submit button's click event however.Any ideas?EDIT - I have other validation controls, like required field validators, on the page and they fire just fine.EDIT 2 - If you want the full source of the page and its codebehind then follow these links:ASPXCS <code>  <asp:FileUpload ID=""fuVendorBrief"" runat=""server"" /><br /><asp:CustomValidator ID=""cvVendorBriefFile"" Display=""Dynamic"" runat=""server"" ValidationGroup=""EditorValidate"" ControlToValidate=""fuVendorBrief"" OnServerValidate=""cvVendorBriefFile_ServerValidate"" ErrorMessage=""You must upload a vendor brief PDF file.""> </asp:CustomValidator> <asp:Button ID=""btnSubmit"" ValidationGroup=""EditorValidate"" OnClick=""btnSubmit_Click"" runat=""server"" Text=""Add Vendor Brief"" /> protected void cvVendorBriefFile_ServerValidate(object source, ServerValidateEventArgs args){ CustomValidator fileUploadValidator = (CustomValidator)source; FileUpload vendorBriefFileUpload = (FileUpload)fileUploadValidator.Parent.FindControl(fileUploadValidator.ControlToValidate); args.IsValid = vendorBriefFileUpload.HasFile && vendorBriefFileUpload.FileName.ToLower().EndsWith("".pdf"");}",ASP.NET Web-forms custom validator not firing
Entity framework code-first 0 to 1 mapping," I want to create a map of these 2 models, how do I do this in code-first? Payment can be either of type PaymentBank or PaymentCheque. I'm trying to follow a scenario like this. I'd love if I could do inheritance of this if possible, such as: <code>  public class Payment{ public int PaymentId { get; set; }}public class PaymentBank{ public int PaymentId { get; set; }}public class PaymentCheque{ public int PaymentId { get; set; }} public class PaymentCheque : Payment{ public int RoutingNumber {get; set;}} ",Entity Framework Code First 0 to 1 mapping
cosole app with c# - c:\dev>myapp -throw http://example.com," I am writing a url shortener app and I would like to also create a console app with C# to push the URLs to a WCF service which I have also created. WCF app will shorten the url on this URI;http://example.com/shorten/http://exaple.comso what I want is just that.My console exe file will be sitting inside c:\dev folder and on Windows command line, I would like to do this; c:\dev>myapp -throw http://example.comwith this method I would like to talk to that service. there is no problem on talking part. But the problem is how can I supply this -throw thing on the command line and get a response and put that response on the command line and supply a method to copy that to the clipboard. Am I asking too much here? :S I don't know. Could you direct me somewhere that I can find information on that or could u please give me an example code of this?Thanks.EDIT : I have tried the following code; and I received the following error; C:\Apps\ArgsTry\ArgsTry\bin\Debug>ArgsTry -throw man Unhandled Exception: System.Threading.ThreadStateException: Current thread must be set to single thread apartment (STA) mode before OLE calls can be made. Ensur e that your Main function has STAThreadAttribute marked on it. at System.Windows.Forms.Clipboard.SetDataObject(Object data, Boolean copy, In t32 retryTimes, Int32 retryDelay) at System.Windows.Forms.Clipboard.SetDataObject(Object data) at ArgsTry.Program.Main(String[] args) in c:\apps\ArgsTry\ArgsTry\Program.cs: line 14 C:\Apps\ArgsTry\ArgsTry\bin\Debug> <code>  class Program { static void Main(string[] args) { if (args[0] == ""-throw"") { System.Windows.Forms.Clipboard.SetDataObject(args[1]); Console.WriteLine(args[1] + "" has been added to clipboard !""); Console.ReadLine(); } }}",How do I use command line arguments in my C# console app?
Console app with C# ," I am writing a url shortener app and I would like to also create a console app with C# to push the URLs to a WCF service which I have also created. WCF app will shorten the url on this URI;http://example.com/shorten/http://exaple.comso what I want is just that.My console exe file will be sitting inside c:\dev folder and on Windows command line, I would like to do this; c:\dev>myapp -throw http://example.comwith this method I would like to talk to that service. there is no problem on talking part. But the problem is how can I supply this -throw thing on the command line and get a response and put that response on the command line and supply a method to copy that to the clipboard. Am I asking too much here? :S I don't know. Could you direct me somewhere that I can find information on that or could u please give me an example code of this?Thanks.EDIT : I have tried the following code; and I received the following error; C:\Apps\ArgsTry\ArgsTry\bin\Debug>ArgsTry -throw man Unhandled Exception: System.Threading.ThreadStateException: Current thread must be set to single thread apartment (STA) mode before OLE calls can be made. Ensur e that your Main function has STAThreadAttribute marked on it. at System.Windows.Forms.Clipboard.SetDataObject(Object data, Boolean copy, In t32 retryTimes, Int32 retryDelay) at System.Windows.Forms.Clipboard.SetDataObject(Object data) at ArgsTry.Program.Main(String[] args) in c:\apps\ArgsTry\ArgsTry\Program.cs: line 14 C:\Apps\ArgsTry\ArgsTry\bin\Debug> <code>  class Program { static void Main(string[] args) { if (args[0] == ""-throw"") { System.Windows.Forms.Clipboard.SetDataObject(args[1]); Console.WriteLine(args[1] + "" has been added to clipboard !""); Console.ReadLine(); } }}",How do I use command line arguments in my C# console app?
c# Read file into byte array is different to string," I have a file in visual studio with the following contents:""{""Name"":""Pete""}""If I read the file with the following code it appears to create a string with the original value: However, the string is actually different to the version that exists if I use the following code: Why? (The reason I think it is different is because when I pass each version to a json deserializer it behaves differently)Thanks. <code>  byte[] byteArray = System.IO.File.ReadAllBytes(filePath);string jsonResponse = System.Text.Encoding.UTF8.GetString(byteArray); string jsonResponse = ""{\""Name\"":\""Pete\""}"";",Read file into byte array is different to string
Can I somehow mimic multiple inheritence using dynamic objects?," I have just been refactoring nearly all classes in my Services layer to inherit from a ServiceBase, to reduce duplication in initializing data access and other aspects identical to nearly all services, but I was stopped in my tracks when I reached my RoleService, as it has to inherit from RoleProvider so that I can configure it as my web site's 'official' role provider.Now it is a bit late at night, and the caffeine is on form, but I was wondering if there was any way to use a dynamic object in place of a derived object, and add all the members of the base object to the 'derived' object, at runtime, instead of compile time.Is this even remotely possible? <code> ",Can I somehow mimic multiple inheritance using dynamic objects?
List<T> Any or Count ?," When I want to do something with a list I first check it if is not null or contains no elements (not to blow a foreach) and I usually use list.Any() but what is the best option - to use list.Count > 0 , or to use list.Any()? <code> ",List<T> Any or Count?
Write obscure characters in visual basic .NET," I was wondering if it was possible, in a console application, to write characters like using .NET. When I try to write this character, the console outputs a question mark. <code> ",How to write Unicode characters to the console?
How to write unicode chars to console?," I was wondering if it was possible, in a console application, to write characters like using .NET. When I try to write this character, the console outputs a question mark. <code> ",How to write Unicode characters to the console?
make row clickable (selectable) except for first column?," I'm using the following code to make the entire row of my gridview clickable: Which works great, except now I want to add edit ability to the grid. This works, but when I have both the row clickable and editing functions turned on, clicking the ""Edit"" link button often fires the row click event and vice versa. So, how can I keep row clickable, except for specified columns? UPDATE:Here's what I'm using.Based on Justin's solution: <code>  protected void gridMSDS_RowDataBound(object sender, GridViewRowEventArgs e) { if (e.Row.RowType == DataControlRowType.DataRow) { e.Row.Attributes[""onmouseover""] = ""this.style.cursor='pointer';this.style.textDecoration='underline';this.style.backgroundColor='#EEFF00'""; e.Row.Attributes[""onmouseout""] = ""this.style.textDecoration='none';this.style.backgroundColor='White'""; e.Row.Attributes[""onclick""] = ClientScript.GetPostBackClientHyperlink(this.gridMSDS, ""Select$"" + e.Row.RowIndex); } } List<int> notClickable = new List<int>(); { notClickable.Add(0); notClickable.Add(2); } for(int i = 0; i < e.Row.Cells.Count; i++) { if (!notClickable.Contains(i)) { e.Row.Cells[i].Attributes[""onclick""] = Page.ClientScript.GetPostBackClientHyperlink(this.gridMSDS, ""Select$"" + e.Row.RowIndex); } }",Gridview row clickable except for first column?
C# WPF Update a progressbar from another thread," I'm stuck trying to update a progressbar from other threads ran in a different class. To explain what I do I think a picture will be better. I want to update the progressbar in the //HERE point :I've tried using a delegate, tried with ReportProgress and I think i've basically tried to use everything google reported in the first 100 results, without success. I'm still learning WPF and this might be silly way to proceed, i'm looking for a quick and dirty way to get the work done but feel free to tell me what I should redesign for a cleaner application.EDIT : More code.In ExecutorWindow.xaml.cs : In Executor.cs : EDIT 2 : I got it! Simple in fact, but i guess I've been looking too close to find out.In my ExecutorWindow class : And in my Executor class : Thank you ! <code>  public void RunExecutor(){ // CREATE BACKGROUNDWORKER FOR EXECUTOR execBackground.DoWork += new DoWorkEventHandler(execBackground_DoWork); execBackground.RunWorkerCompleted += new RunWorkerCompletedEventHandler(execBackground_RunWorkerCompleted); execBackground.ProgressChanged += new ProgressChangedEventHandler(execBackground_ProgressChanged); execBackground.WorkerReportsProgress = true; execBackground.WorkerSupportsCancellation = true; // RUN BACKGROUNDWORKER execBackground.RunWorkerAsync();}private void execBackground_DoWork(object sender, DoWorkEventArgs e){ myExecutor = new Executor(arg1, arg2); myExecutor.Run(); }private void execBackground_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e){ MessageBox.Show(""RunWorkerCompleted execBackground"");}private void execBackground_ProgressChanged(object sender, ProgressChangedEventArgs e){ ExecutorProgressBar.Value += 1;}// TESTING private void updateProgressBar(int i){ ExecutorProgressBar.Value += i;}public delegate void callback_updateProgressBar(int i); public void Run(){ string[] options = new string[2]; int i = 0; while (LeftToRun > 0) { if (CurrentRunningThreads < MaxThreadsRunning) { BackgroundWorker myThread = new BackgroundWorker(); myThread.DoWork += new DoWorkEventHandler(backgroundWorkerRemoteProcess_DoWork); myThread.RunWorkerCompleted += new RunWorkerCompletedEventHandler(backgroundWorkerRemoteProcess_RunWorkerCompleted); myThread.ProgressChanged += new ProgressChangedEventHandler(backgroundWorkerRemoteProcess_ProgressChanged); myThread.WorkerReportsProgress = true; myThread.WorkerSupportsCancellation = true; myThread.RunWorkerAsync(new string[2] {opt1, opt2}); // HERE ? CurrentRunningThreads++; i++; LeftToRun--; } } while (CurrentRunningThreads > 0) { } logfile.Close(); MessageBox.Show(""All Tasks finished"");}private void backgroundWorkerRemoteProcess_DoWork(object sender, DoWorkEventArgs e){ BackgroundWorker myBackgroundWorker = sender as BackgroundWorker; string[] options = (string[])e.Argument; string machine = options[0]; string script = options[1]; // UPDATE HERE PROGRESSBAR ? RemoteProcess myRemoteProcess = new RemoteProcess(machine, script); string output = myRemoteProcess.TrueExec(); // UPDATE HERE PROGRESSBAR ? this.logfile.WriteLine(output);}private void backgroundWorkerRemoteProcess_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e){ CurrentRunningThreads--;}private void backgroundWorkerRemoteProcess_ProgressChanged(object sender, ProgressChangedEventArgs e){ //myExecWindow.ExecutorProgressBar.Value = e.ProgressPercentage; // TESTING //ExecutorWindow.callback_updateProgressBar(1); // TESTING } private void execBackground_DoWork(object sender, DoWorkEventArgs e){ myExecutor = new Executor(arg1, arg2); myExecutor.Run(sender);}private void execBackground_ProgressChanged(object sender, ProgressChangedEventArgs e){ ExecutorProgressBar.Value += 1;} private BackgroundWorker myExecutorWindow;[...]public void Run(object sender){ myExecutorWindow = sender as BackgroundWorker; string[] options = new string[2]; int i = 0; while (LeftToRun > 0) { if (CurrentRunningThreads < MaxThreadsRunning) { BackgroundWorker myThread = new BackgroundWorker(); myThread.DoWork += new DoWorkEventHandler(backgroundWorkerRemoteProcess_DoWork); myThread.RunWorkerCompleted += new RunWorkerCompletedEventHandler(backgroundWorkerRemoteProcess_RunWorkerCompleted); myThread.ProgressChanged += new ProgressChangedEventHandler(backgroundWorkerRemoteProcess_ProgressChanged); myThread.WorkerReportsProgress = true; myThread.WorkerSupportsCancellation = true; myThread.RunWorkerAsync(new string[2] {opt1, opt2}); CurrentRunningThreads++; i++; LeftToRun--; } }[...]private void backgroundWorkerRemoteProcess_DoWork(object sender, DoWorkEventArgs e) { BackgroundWorker myBackgroundWorker = sender as BackgroundWorker; myBackgroundWorker.ReportProgress(1); // PROCESSING MY STUFF HERE myBackgroundWorker.ReportProgress(1); } private void backgroundWorkerRemoteProcess_ProgressChanged(object sender, ProgressChangedEventArgs e) { myExecutorWindow.ReportProgress(1); }",WPF C# - Update progressbar from another thread
Update a progressbar from another thread," I'm stuck trying to update a progressbar from other threads ran in a different class. To explain what I do I think a picture will be better. I want to update the progressbar in the //HERE point :I've tried using a delegate, tried with ReportProgress and I think i've basically tried to use everything google reported in the first 100 results, without success. I'm still learning WPF and this might be silly way to proceed, i'm looking for a quick and dirty way to get the work done but feel free to tell me what I should redesign for a cleaner application.EDIT : More code.In ExecutorWindow.xaml.cs : In Executor.cs : EDIT 2 : I got it! Simple in fact, but i guess I've been looking too close to find out.In my ExecutorWindow class : And in my Executor class : Thank you ! <code>  public void RunExecutor(){ // CREATE BACKGROUNDWORKER FOR EXECUTOR execBackground.DoWork += new DoWorkEventHandler(execBackground_DoWork); execBackground.RunWorkerCompleted += new RunWorkerCompletedEventHandler(execBackground_RunWorkerCompleted); execBackground.ProgressChanged += new ProgressChangedEventHandler(execBackground_ProgressChanged); execBackground.WorkerReportsProgress = true; execBackground.WorkerSupportsCancellation = true; // RUN BACKGROUNDWORKER execBackground.RunWorkerAsync();}private void execBackground_DoWork(object sender, DoWorkEventArgs e){ myExecutor = new Executor(arg1, arg2); myExecutor.Run(); }private void execBackground_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e){ MessageBox.Show(""RunWorkerCompleted execBackground"");}private void execBackground_ProgressChanged(object sender, ProgressChangedEventArgs e){ ExecutorProgressBar.Value += 1;}// TESTING private void updateProgressBar(int i){ ExecutorProgressBar.Value += i;}public delegate void callback_updateProgressBar(int i); public void Run(){ string[] options = new string[2]; int i = 0; while (LeftToRun > 0) { if (CurrentRunningThreads < MaxThreadsRunning) { BackgroundWorker myThread = new BackgroundWorker(); myThread.DoWork += new DoWorkEventHandler(backgroundWorkerRemoteProcess_DoWork); myThread.RunWorkerCompleted += new RunWorkerCompletedEventHandler(backgroundWorkerRemoteProcess_RunWorkerCompleted); myThread.ProgressChanged += new ProgressChangedEventHandler(backgroundWorkerRemoteProcess_ProgressChanged); myThread.WorkerReportsProgress = true; myThread.WorkerSupportsCancellation = true; myThread.RunWorkerAsync(new string[2] {opt1, opt2}); // HERE ? CurrentRunningThreads++; i++; LeftToRun--; } } while (CurrentRunningThreads > 0) { } logfile.Close(); MessageBox.Show(""All Tasks finished"");}private void backgroundWorkerRemoteProcess_DoWork(object sender, DoWorkEventArgs e){ BackgroundWorker myBackgroundWorker = sender as BackgroundWorker; string[] options = (string[])e.Argument; string machine = options[0]; string script = options[1]; // UPDATE HERE PROGRESSBAR ? RemoteProcess myRemoteProcess = new RemoteProcess(machine, script); string output = myRemoteProcess.TrueExec(); // UPDATE HERE PROGRESSBAR ? this.logfile.WriteLine(output);}private void backgroundWorkerRemoteProcess_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e){ CurrentRunningThreads--;}private void backgroundWorkerRemoteProcess_ProgressChanged(object sender, ProgressChangedEventArgs e){ //myExecWindow.ExecutorProgressBar.Value = e.ProgressPercentage; // TESTING //ExecutorWindow.callback_updateProgressBar(1); // TESTING } private void execBackground_DoWork(object sender, DoWorkEventArgs e){ myExecutor = new Executor(arg1, arg2); myExecutor.Run(sender);}private void execBackground_ProgressChanged(object sender, ProgressChangedEventArgs e){ ExecutorProgressBar.Value += 1;} private BackgroundWorker myExecutorWindow;[...]public void Run(object sender){ myExecutorWindow = sender as BackgroundWorker; string[] options = new string[2]; int i = 0; while (LeftToRun > 0) { if (CurrentRunningThreads < MaxThreadsRunning) { BackgroundWorker myThread = new BackgroundWorker(); myThread.DoWork += new DoWorkEventHandler(backgroundWorkerRemoteProcess_DoWork); myThread.RunWorkerCompleted += new RunWorkerCompletedEventHandler(backgroundWorkerRemoteProcess_RunWorkerCompleted); myThread.ProgressChanged += new ProgressChangedEventHandler(backgroundWorkerRemoteProcess_ProgressChanged); myThread.WorkerReportsProgress = true; myThread.WorkerSupportsCancellation = true; myThread.RunWorkerAsync(new string[2] {opt1, opt2}); CurrentRunningThreads++; i++; LeftToRun--; } }[...]private void backgroundWorkerRemoteProcess_DoWork(object sender, DoWorkEventArgs e) { BackgroundWorker myBackgroundWorker = sender as BackgroundWorker; myBackgroundWorker.ReportProgress(1); // PROCESSING MY STUFF HERE myBackgroundWorker.ReportProgress(1); } private void backgroundWorkerRemoteProcess_ProgressChanged(object sender, ProgressChangedEventArgs e) { myExecutorWindow.ReportProgress(1); }",WPF C# - Update progressbar from another thread
"[C#, ASP.NET] how to do localization without resource file?"," Articles from internet, they all do localization base on resource file xxxx.resxIs there a way we can read resource from database? <code> ",How to do localization without resource file?
"c# design decision, when should I use inheritance over an interface"," I have a number Processor classes that will do two very different things, but are called from common code (an ""inversion of control"" situation).I'm wondering what design considerations I should be cognicent (or cognizant, for you USsers) of when deciding if they should all inherit from BaseProcessor, or implement IProcessor as an interface. <code> ",When should I choose inheritance over an interface when designing C# class libraries?
"after email deleting attachmetn file, error ""The process cannot access the file because it is being used by another process."""," I am doing an email form. Email has attachments and after attaching files email is sent. Next there is requirement to delete file from server. When I tried to get the file it gave me the subject error. I am even calling GC.Collect() before deleting the file but error is still there. My code for deleting file is: For attaching file to email my code is: Edit: My mail sending code is: Plz guide and help. thanks <code>  private void DeleteFiles(DataTable dt){ GC.Collect(); String[] sAttachments = new String[dt.Rows.Count]; try { sAttachments = new String[dt.Rows.Count]; for (Int32 J = 0; J < dt.Rows.Count; J++) { sAttachments[J] = dt.Rows[J][""AttachmentExt""].ToString().Trim(); string workDir = Server.MapPath(""."") + @""\upload\""; if (File.Exists(workDir + sAttachments[J])) File.Delete(workDir + sAttachments[J]); } } catch (Exception ex) { } oMess.Subject = sSubject; string workDir = System.Web.HttpContext.Current.Server.MapPath(""."") + @""\upload\""; if (Attachments != null) { for (Int32 I = 0; I < Attachments.Length; I++) { oatt = new Attachment(workDir+ sAttachments[I]); oMess.Attachments.Add(oatt); } } oMess.IsBodyHtml = IsHtml; oMess.Body = sBody; SendMessageGmail(oMess); private void SendMessageGmail(MailMessage message) { SmtpClient client = new SmtpClient(""smtp.gmail.com""); client.EnableSsl = true; client.UseDefaultCredentials = false; NetworkCredential loginInfo = new NetworkCredential(""myid"", ""mypassword""); client.Credentials = loginInfo; client.Port = 587; client.Send(message); }","after email deleting attachment file, error ""The process cannot access the file because it is being used by another process."""
Console library for C#, Is there any library for .NET which can:output characters/words in colordraw stuff in console like progress bars (similar to wget)other funny beautiful things i might consider using in my glamor console app <code> ,Is there a fancier Console library for C#?
System.Exception.Data Property and its use," The System.Exception class (actually any exception) has Data property which is almost always empty. While throwing exceptions, should this field be of any use? Or does it have some internal use that I am not aware of? <code> ",System.Exception.Data Property
Function imports cannot be created for composable functions., I have generated Entity CodeBlock for my database objects and choose some of my user defined scalar functions. But when i tried to double click on functions in Model.Store to import function i get this error. Function imports cannot be created for composable functions.How can i import my functions? <code> ,Function imports cannot be created for composable functions
how to use solve cross thredding exception in winform," Presently I'm working with WinForms(in C#) and I have to run the application in the background. For this purpose I'm using asynchronous. When I run the application it's showing an exception like ""Cross-thread operation not valid: Control '' accessed from a thread other than the thread it was created on.""How can I solve this error? <code> ",Solve a cross-threading Exception in WinForms
Play a sound in a specific device with Csharp," My problem is if I want to create 3 buttons and I have 3 sound cards and each button is related to a sound card (for example button1 is related to sound card1...) and when I click on button1 I want to hear sound from the speaker which is related to sound card1 (the same for button2 and button3.My friends gave me two codes: the first use Naudio it works but worked for I still cant play sound in the three sound cards. I mean only one sound card work when I install the three sound cards. It's like the program is always choosing a default audio card from the three external sound cards.The second use DirectX and it works for me but I didn't understand how he call the device number. I mean in the code which use NAudio there is ""devicenumber= 1 for example"". I need to know how because I'll specify a device for each button (for example when I click on button1 the sound will be played in sound card1)?I want to know how we can correct one of the two codes and how can I specify a ""Device "" in the second code.This is the Code of Form2 (from the project which use NAudio) you can notices how it specify a device for each button but unfortunately it cause the problem mentioned: And this is the code of Form1 (from the project using DirectX): And this is the code of ClassAudioDevice (from the same project): <code>  using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Windows.Forms;using NAudio.Wave;using NAudio.CoreAudioApi;namespace AudioWithNAudio{ public partial class Form2 : Form { string fileName = null; WaveOut wave = null; private NAudio.Wave.WaveFileReader waveReader = null; private NAudio.Wave.DirectSoundOut output = null; public Form2() { InitializeComponent(); } private void Form2_Load(object sender, EventArgs e) { hideButtons(); fileName = (""alarm.wav""); detectDevices(); } public void hideButtons() { bttnAudioDevice1.Visible = false; bttnAudioDevice2.Visible = false; bttnAudioDevice3.Visible = false; bttnAudioDevice4.Visible = false; bttnAudioDevice5.Visible = false; } public void detectDevices() { int waveOutDevices = WaveOut.DeviceCount; switch (waveOutDevices) { case 1: bttnAudioDevice1.Visible = true; break; case 2: bttnAudioDevice2.Visible = true; bttnAudioDevice1.Visible = true; break; case 3: bttnAudioDevice2.Visible = true; bttnAudioDevice1.Visible = true; bttnAudioDevice3.Visible = true; break; case 4: bttnAudioDevice2.Visible = true; bttnAudioDevice1.Visible = true; bttnAudioDevice3.Visible = true; bttnAudioDevice4.Visible = true; break; case 5: bttnAudioDevice2.Visible = true; bttnAudioDevice1.Visible = true; bttnAudioDevice3.Visible = true; bttnAudioDevice4.Visible = true; bttnAudioDevice5.Visible = true; break; } } private void bttnAudioDevice1_Click(object sender, EventArgs e) { wave = new WaveOut(); wave.DeviceNumber = 0; playSound(); } private void bttnAudioDevice2_Click(object sender, EventArgs e) { wave = new WaveOut(); wave.DeviceNumber = 1; playSound(); } private void bttnAudioDevice3_Click(object sender, EventArgs e) { wave.DeviceNumber = 2; playSound(); } private void bttnAudioDevice4_Click(object sender, EventArgs e) { wave.DeviceNumber = 3; playSound(); } private void bttnAudioDevice5_Click(object sender, EventArgs e) { wave.DeviceNumber = 4; playSound(); } public void playSound() { disposeWave();// stop previous sounds before starting waveReader = new NAudio.Wave.WaveFileReader(fileName); output = new NAudio.Wave.DirectSoundOut(); output.Init(new NAudio.Wave.WaveChannel32(waveReader)); output.Play(); } public void disposeWave() { if (output != null) { if (output.PlaybackState == NAudio.Wave.PlaybackState.Playing) { output.Stop(); output.Dispose(); output = null; } } if (wave != null) { wave.Dispose(); wave = null; } } private void Form2_FormClosing(object sender, FormClosingEventArgs e) { disposeWave(); } private void bttnStop_Click(object sender, EventArgs e) { if (output != null) { if (output.PlaybackState == NAudio.Wave.PlaybackState.Playing) { output.Stop(); } } } }} using System;using System.Windows.Forms;using Microsoft.DirectX.DirectSound;using DirectSound = Microsoft.DirectX.DirectSound;namespace DirectSoundPlay{ public partial class Form1 : Form { public Form1() { InitializeComponent(); ReSizeControls(); } private void playToolStripMenuItem_Click(object sender, EventArgs e) { if (listBox2.SelectedItems.Count == 0) return; if (listBox2.SelectedItems.Count > 1) { MessageBox.Show(""Too many SelectedItems""); return; } ClassAudioDevice ad = listBox2.SelectedItem as ClassAudioDevice; if (ad == null) { MessageBox.Show(""SelectedItem is not a ClassAudioDevice""); return; } DirectSound.Device Device = new DirectSound.Device(ad.DriverGuid); Device.SetCooperativeLevel(this.Handle, DirectSound.CooperativeLevel.Priority); DirectSound.Buffer AudioBuffer = new DirectSound.Buffer(""C:\\Windows\\Media\\notify.wav"", Device); AudioBuffer.Play(0, BufferPlayFlags.Default); } private void exitToolStripMenuItem_Click(object sender, EventArgs e) { Close(); } private void Form1_SizeChanged(object sender, EventArgs e) { ReSizeControls(); } private void ReSizeControls() { int w = ClientSize.Width >> 1; listBox1.Width = w - 1; listBox2.Width = w - 1; listBox1.Height = ClientSize.Height; listBox2.Height = ClientSize.Height; } private void Form1_Load(object sender, EventArgs e) { DirectSound.DevicesCollection DevicesList = new DirectSound.DevicesCollection(); DirectSound.CaptureDevicesCollection CaptureDevicesList = new DirectSound.CaptureDevicesCollection(); ClassAudioDevice ad; // foreach (DirectSound.DeviceInformation di in CaptureDevicesList) { ad = new ClassAudioDevice(); ad.Description = di.Description; ad.DriverGuid = di.DriverGuid; listBox1.Items.Add(ad); } foreach (DirectSound.DeviceInformation di in DevicesList) { ad = new ClassAudioDevice(); ad.Description = di.Description; ad.DriverGuid = di.DriverGuid; listBox2.Items.Add(ad); } } }} using System;using System.Collections.Generic;using System.Linq;using System.Text; namespace DirectSoundPlay{ class ClassAudioDevice { public string Description = """"; public Guid DriverGuid = new Guid(); public override string ToString() { return Description; } }}",Play a sound in a specific device with C#
Best way to initaite RSACryptoServiceProvider from x509Certificate2?, What is the best way to initate a new RSACryptoServiceProvider object from an X509Certificate2 I pulled out of a key store? The certificate is associated with both public (for encryption) and private (for decryption) keys.I'm current using the FromXmlString method but there must be a better way.Thanks <code> ,Best way to initiate RSACryptoServiceProvider from x509Certificate2?
When should i use [Serializable] in C#?, I found out that some classes use the [Serializable] attribute.What is it? When should I use it? What kinds of benefits will I get?  <code> ,What is [Serializable] and when should I use it?
Why cant I cast from a list<MyClass> to List<object>?," I have a List of objects, which are of my type QuoteHeader and I want to pass this list as a list of objects to a method which is able to accept a List<object>.My line of code reads... But I get the following error at design time... Do I need to do anything to my class to allow this? I thought that all classes inherit from object so I can't understand why this wouldn't work? <code>  Tools.MyMethod((List<object>)MyListOfQuoteHeaders); Cannot convert type 'System.Collections.Generic.List<MyNameSpace.QuoteHeader>' to 'System.Collections.Generic.List<object>'",Why can't I cast from a List<MyClass> to List<object>?
debugging raw view content," When inspecting an object in debug mode, there is sometimes, if not always, a Raw View that can be expanded. What is this? Can I access this in my code? <code> ",Debugging raw view content
Entity Insert Data russian encoding problems," I'm using an EDM model in my project.When I insert russian words in the database via a post request I get ?????? Controller: In the database all charset are set to utf-8In the layout page content enc type is utf-8Database code: <code>  [Authorize][HttpPost]public string DescEdit(FormCollection formValues){ var CurrentUserPhoto = User.Identity.Name; string x = Request.Form[""id""]; Int64 id = Convert.ToInt64(x); photos upPhotoDesc = photosRepository.GetPhotosById(id, CurrentUserPhoto); upPhotoDesc.description = Request.Form[""value""]; photosRepository.Save(); return Request.Form[""value""];} CREATE TABLE `photos` ( `id` bigint(255) NOT NULL AUTO_INCREMENT, `done` tinyint(1) NOT NULL DEFAULT '0', `imgsmall` varchar(255) NOT NULL DEFAULT '', `imgcrop` varchar(255) NOT NULL DEFAULT '', `imgmiddle` varchar(255) NOT NULL DEFAULT '', `imgbig` varchar(255) NOT NULL DEFAULT '', `full_size` varchar(255) NOT NULL DEFAULT '', `description` varchar(255) DEFAULT NULL, `name` varchar(255) DEFAULT NULL, `permission` tinyint(1) NOT NULL DEFAULT '0', `userid` int(11) NOT NULL DEFAULT '0', `userlogin` varchar(255) NOT NULL DEFAULT '', `rating` smallint(5) DEFAULT '0', PRIMARY KEY (`id`), KEY `indx_photos_1` (`id`,`userlogin`)) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE utf8_unicode_ci;",Entity Framework C# Insert Data russian encoding problems
Generate Unique Code," I need to generate a nine digit numeric code (random preferably) which is unique for a given day (same number cannot be generated again on the same day). I was thinking of using HHMMSSmmm (hours, minutes, seconds and milliseconds) to generate the unique code but is not really random. This code generation method can be accessed by multiple methods at the same time so I will have to put a lock on the method. But will this ensure that the number is unique as it is possible that number generation may take less than a millisecond and two threads get the same number?Is there a better way to generate a random unique numeric code which is unique for a given day? The number of digits can be from 6 to 9 digits.Edit: The number of random numbers to be generated depends on the number of transactions. Initially the number could be lower but over a period of time it can become very high (multiple transactions per second). Hence, I would not like to compare the number against a used list as this could have performance issues. Randomness is needed as this number will be entered by the user on the phone. This number is the only way to link the online transaction with the phone transaction so I don't want user to enter a different number by mistake.The random number generation needs to take place in a ASP.NET MVC application. <code> ",Generate Random Unique Code
How to SORT WinForms DataGridView bound to EF EntityCollection<T>," I'm trying to bind a WinForms DataGridView to an EntityCollection<T> from an EntityFramework4 object. The trouble is, I can't figure out how to get it to sort (automatically).All I'm doing is setting the BindingSource's DataSource property to the entity's collection. MyBindingSource.DataSource = CurrentItem.InvoiceNotes;I really hope there's a simple configuration I can add to this to get it to work; I really don't want to have to wrap my EF Collection in a new BindingList container. <code> ",How to Sort WinForms DataGridView bound to EF EntityCollection<T>
Performance considerations of inheritance in C#.," Does the compiler produce the same IL if I make a class with public int I; (or any other field) vs making a class that inherits from a base class that has public int I;?Either way the resulting class behaves identically, but does the compiler behave identically?I.e., is the compiler just copy-pasting code from base classes into the derived classes, or is it actually creating two different class objects when you inherit? Now is there any performance difference between the following two DoSomething() calls? Try to ignore any optimizations the compiler might do for this special case. My question is about whether inheritance in C# in general has an associated performance penalty. Most of the time I don't care, but sometimes I want to optimize a piece of high frequency code. <code>  class A{ public int I;}class B : A{} var a = new A();var b = new B();DoSomething(a.I);DoSomething(b.I); // Is this line slower than the above line due to inheritance?",Performance considerations of inheritance in C#
c# to vb: the **default** keyword?," Possible Duplicate: Default value for generics OK, so while translating some code from C# to VB.NET, I came across the default keyword, and I'm simply replacing it with nothing.Is this the proper way to do it, or is there a better ""translation"" for that keyword? <code> ",C# to VB.NET: the **default** keyword?
How to make a checkbox unselectable?, I was wondering how you make a CheckBox unselectable in c#? I thought it would be something like SetSelectable (false) or something but I can't seem to see the method.I found CanSelect but this seems to be a read only property. <code> ,How to make a CheckBox unselectable?
C# reflection question," What would be the way to call some method by name, like ""Method1"", if I've got an Object and it's Type?I want to do something like this: Is this somehow possible? I do realize that this would be slow, it's inconvenient, but unfortunately I've got no other ways to implement this in my case. <code>  Object o;Type t;// At this point I know, that 'o' actually has// 't' as it's type.// And I know that 't' definitely has a public method 'Method1'.// So, I want to do something like:Reflection.CallMethodByName(o, ""Method1"");","How do you call a method by its ""name""?"
A potentially dangerous Request.Path value was detected from the client (*).," I am receiving the rather self explanatory error: A potentially dangerous Request.Path value was detected from the client (*).The issue is due to * in the request URL: This url is used to populate a search page where 'test*' is the search term and the rest of the url relates to various other filters.Is there an easy way to allow these special characters in the URL? I've tried modifying the web.config, to no avail.Should I manually encode / decode the special characters?Or is there a best practice for doing this, I would like to avoid using query strings. - but it may be an option.The application itself is a c# asp.net webforms application that uses routing to produce the nice URL above. <code>  https://stackoverflow.com/Search/test*/0/1/10/1",A potentially dangerous Request.Path value was detected from the client (*)
Can we use Google Adds in .Net Forms application?, Google Ads is used on many websites (and web applications). Can I use Google Ads in .Net Forms application? Does anybody know an API for this? <code> ,Can we use Google Ads in a Window Forms (.Net) application?
Can we use Google Ads in .Net Forms application?, Google Ads is used on many websites (and web applications). Can I use Google Ads in .Net Forms application? Does anybody know an API for this? <code> ,Can we use Google Ads in a Window Forms (.Net) application?
C# Unit testing with Fake database context using a HashSet (pluralsight code)," The short version:In this video, Mr. Scott Allen explains how to test a controller.But he does not show the full code of the class: FakeDbContext.Is there someone who can help me finish it? He shows the class at, 06:15 min in the video for ""testing controllers"".The long versionAt school I have a elective where we learn C#. My exam project is a ASP site using MVC3.To learn it fast, i have seen videos from PluralSight. My question is about some code that are in this videoHe explains how to test controllers. So i tried:I have made a controller which has a simple index method: As you can see i have already tried to make a context.The index method is the one i want to TEST.The next thing he does is to make a class called, FakeDbContext, in the test project.But sadly he only show a part of the code, and i have used a lot of hours trying to figure out how he creates a get method to a HashSet.Here is the code that you can see from the video: To end the long version, my problem is i get a error on _Map.Get.Does not contain a definition or extension method.EDIT! PART 2:After @xelibrion great answer it finally worked.But then another problem come up.The IDbContext class looks like this: When i add this interface to my Entities Class it offcouse expect me to implement the methods.PluralSight implements them like this: But my ""_dbModel.Designer.cs"" class from my entity model does not know what Set and Entry is, and only suggest i make a method stub. There are a lot more code in this class, so if its need just ask for the rest :) I have changed Restaurants to Electives since thats the table name i my DB.Is it a ""using"" i have forgotten? I have seen the video again, and he does not have a method stub in his DB class. <code>  public class Round1Controller : Controller{ IDbContext _db; public Round1Controller() { _db = new Entities(); } public Round1Controller(IDbContext db) { _db = db; } public ActionResult Index() { var model = _db.ELECTIVES.ToList(); return View(model); } using System;using System.Collections.Generic;using System.Linq;using System.Text;using EESS.Models;namespace EESS.Tests{class FakeDbContext : IDbContext{ public IQueryable<Restaurant> Restaurants { get { return _map.Get<Restaurant>().asQueryable(); } set { _map.Use<Restaurant>(value); } } public IQueryable<Review> Reviews { get { return _map.Get<Review>().asQueryable(); } set { _map.Use<Review>(value); } } public int SaveChanges() { ChangesSaved = true; return 0; } public bool ChangesSaved { get; set; } public T Attach<T>(T entity) where T : class { _map.Get<T>().Add(entity); return entity; } public T Add<T>(T entity) where T : class { _map.Get<T>().Add(entity); return entity; } public T Delete<T>(T entity) where T : class { _map.Get<T>().Remove(entity); return entity; } SetMap _map = new SetMap(); class SetMap : KeyedCollection<Type, object> { public HashSet<T> Use<T>(IEnumerable<T> sourceData) { var set = new HashSet<T>(sourceData); if (Contains(typeof(T))) { Remove(typeof(T)); } Add(set); return set; } }}} public interface IDbContext { IQueryable<ELECTIVES> ELECTIVES { get; } int SaveChanges(); T Attach<T>(T entity) where T : class; T Add<T>(T entity) where T : class; T Delete<T>(T entity) where T : class; } public DbSet<ELECTIVES> electives { get; set; } IQueryable<ELECTIVES> IDbContext.ELECTIVES { get { return electives; } } int IDbContext.SaveChanges() { return SaveChanges(); } T IDbContext.Add<T>(T entity) { return Set<T>().Add(entity); } T IDbContext.Delete<T>(T entity) { return Set<T>().Remove(entity); } T IDbContext.Attach<T>(T entity) { var entry = Entry(entity); entry.State = System.Data.EntityState.Modified; return entity; return Set<T>().Add(entity); }",C# Unit testing with Fake database context using a HashSet (pluralsight code)(New Q)
(UPDATED)C# Unit testing with Fake database context using a HashSet (pluralsight code)(New Q)," The short version:In this video, Mr. Scott Allen explains how to test a controller.But he does not show the full code of the class: FakeDbContext.Is there someone who can help me finish it? He shows the class at, 06:15 min in the video for ""testing controllers"".The long versionAt school I have a elective where we learn C#. My exam project is a ASP site using MVC3.To learn it fast, i have seen videos from PluralSight. My question is about some code that are in this videoHe explains how to test controllers. So i tried:I have made a controller which has a simple index method: As you can see i have already tried to make a context.The index method is the one i want to TEST.The next thing he does is to make a class called, FakeDbContext, in the test project.But sadly he only show a part of the code, and i have used a lot of hours trying to figure out how he creates a get method to a HashSet.Here is the code that you can see from the video: To end the long version, my problem is i get a error on _Map.Get.Does not contain a definition or extension method.EDIT! PART 2:After @xelibrion great answer it finally worked.But then another problem come up.The IDbContext class looks like this: When i add this interface to my Entities Class it offcouse expect me to implement the methods.PluralSight implements them like this: But my ""_dbModel.Designer.cs"" class from my entity model does not know what Set and Entry is, and only suggest i make a method stub. There are a lot more code in this class, so if its need just ask for the rest :) I have changed Restaurants to Electives since thats the table name i my DB.Is it a ""using"" i have forgotten? I have seen the video again, and he does not have a method stub in his DB class. <code>  public class Round1Controller : Controller{ IDbContext _db; public Round1Controller() { _db = new Entities(); } public Round1Controller(IDbContext db) { _db = db; } public ActionResult Index() { var model = _db.ELECTIVES.ToList(); return View(model); } using System;using System.Collections.Generic;using System.Linq;using System.Text;using EESS.Models;namespace EESS.Tests{class FakeDbContext : IDbContext{ public IQueryable<Restaurant> Restaurants { get { return _map.Get<Restaurant>().asQueryable(); } set { _map.Use<Restaurant>(value); } } public IQueryable<Review> Reviews { get { return _map.Get<Review>().asQueryable(); } set { _map.Use<Review>(value); } } public int SaveChanges() { ChangesSaved = true; return 0; } public bool ChangesSaved { get; set; } public T Attach<T>(T entity) where T : class { _map.Get<T>().Add(entity); return entity; } public T Add<T>(T entity) where T : class { _map.Get<T>().Add(entity); return entity; } public T Delete<T>(T entity) where T : class { _map.Get<T>().Remove(entity); return entity; } SetMap _map = new SetMap(); class SetMap : KeyedCollection<Type, object> { public HashSet<T> Use<T>(IEnumerable<T> sourceData) { var set = new HashSet<T>(sourceData); if (Contains(typeof(T))) { Remove(typeof(T)); } Add(set); return set; } }}} public interface IDbContext { IQueryable<ELECTIVES> ELECTIVES { get; } int SaveChanges(); T Attach<T>(T entity) where T : class; T Add<T>(T entity) where T : class; T Delete<T>(T entity) where T : class; } public DbSet<ELECTIVES> electives { get; set; } IQueryable<ELECTIVES> IDbContext.ELECTIVES { get { return electives; } } int IDbContext.SaveChanges() { return SaveChanges(); } T IDbContext.Add<T>(T entity) { return Set<T>().Add(entity); } T IDbContext.Delete<T>(T entity) { return Set<T>().Remove(entity); } T IDbContext.Attach<T>(T entity) { var entry = Entry(entity); entry.State = System.Data.EntityState.Modified; return entity; return Set<T>().Add(entity); }",C# Unit testing with Fake database context using a HashSet (pluralsight code)(New Q)
Implementing a property vs. implementing a subclass," I've got a class called List_Field that, as the name suggests, builds list input fields. These list input fields allow users to select a single item per list.I want to be able to build list input fields that would allow users to select multiple items per list, so I have the following dilemma:Should I do that through implementing a multiple_choice_allowed property into the existing List_Field property, or should I implement a Multiple_Choice_List_Field subclass of the List_Field class?What's the engineering principle that I should follow when confronted with dilemmas like this one? <code> ",To implement a property or to implement a subclass
When to implementing a property and when - a subclass," I've got a class called List_Field that, as the name suggests, builds list input fields. These list input fields allow users to select a single item per list.I want to be able to build list input fields that would allow users to select multiple items per list, so I have the following dilemma:Should I do that through implementing a multiple_choice_allowed property into the existing List_Field property, or should I implement a Multiple_Choice_List_Field subclass of the List_Field class?What's the engineering principle that I should follow when confronted with dilemmas like this one? <code> ",To implement a property or to implement a subclass
When to a property and when - a subclass?," I've got a class called List_Field that, as the name suggests, builds list input fields. These list input fields allow users to select a single item per list.I want to be able to build list input fields that would allow users to select multiple items per list, so I have the following dilemma:Should I do that through implementing a multiple_choice_allowed property into the existing List_Field property, or should I implement a Multiple_Choice_List_Field subclass of the List_Field class?What's the engineering principle that I should follow when confronted with dilemmas like this one? <code> ",To implement a property or to implement a subclass
When to implement a subclass instead of a property?," I've got a class called List_Field that, as the name suggests, builds list input fields. These list input fields allow users to select a single item per list.I want to be able to build list input fields that would allow users to select multiple items per list, so I have the following dilemma:Should I do that through implementing a multiple_choice_allowed property into the existing List_Field property, or should I implement a Multiple_Choice_List_Field subclass of the List_Field class?What's the engineering principle that I should follow when confronted with dilemmas like this one? <code> ",To implement a property or to implement a subclass
C# - how can i open a url in web browser (such as IE) and pass credentials, I want to open a page that required Basic authentication.I want to pass the Basic authentication header to the browser along with the URL.How can i do that? <code> ,How can i open a url in web browser (such as IE) and pass credentials
C# Check The Width and Height of a Image," I am able to display the picture in the picture box without checking the file size by the following code: I want to check the image size for example whether it is 2MB or 4MB before displaying in the picture box. i also want to check the width and height of the image. <code>  private void button3_Click_1(object sender, EventArgs e){ try { //Getting The Image From The System OpenFileDialog open = new OpenFileDialog(); open.Filter = ""Image Files(*.jpg; *.jpeg; *.gif; *.bmp)|*.jpg; *.jpeg; *.gif; *.bmp""; if (open.ShowDialog() == DialogResult.OK) { Bitmap img = new Bitmap(open.FileName); pictureBox2.Image = img; } } catch (Exception) { throw new ApplicationException(""Failed loading image""); }}",Check the width and height of an image
What is the regular expression for ...?," I want regular expression that contains at least one alphanumeric character, at least one non alphanumeric character (special character) and at least one digit. Thanks in advance. <code> ","What is the regular expression for this ""password""?"
"What is the regular expression for this ""password""?"," I want regular expression that contains at least one alphanumeric character, at least one non alphanumeric character (special character) and at least one digit. Thanks in advance. <code> ","What is the regular expression for this ""password""?"
"XPath search for all text nodes, not the inner text of any other child node."," I'm using HtmlAgilityPack. I hover over the parent node and its ChildNodes show several #text nodes. The XPath value shows /code[1]/#text[1]. I try to use //#text to get all the text nodes but I get that error:Error: Expression must evaluate to a node-set.I've tried //text and get nothing, but no error. <code> ","XPath search for all text nodes, not the inner text of any other child node"
Azure: Intra-WebRole Communication with Full-IIS," I need to change some configuration settings on-the-fly in a Windows Azure project - and they need to be changed via a web service call (updating the application's configuration either via the platform api or the Azure Management site isn't an option here). The project has multiple web and worker roles - all of which will need to know about the new configuration when it is changed.The configuration is persisted to durable storage, and it's also cached during runtime in a static variable. My solution was to create an internal (tcp) endpoint on my roles, and use that to loop through all of the roles and instances within those roles, create a client on the fly, and tell the instance about the new setting. (pretty much identical to: http://msdn.microsoft.com/en-us/gg457891)At first I started a ServiceHost in the WebRole's RoleEntryPoint... and I was confused why everything seemed to be working fine when I stepped through the communications (the static variables where getting set correctly) - yet when I'd make other webservice calls, the static variable seemed to have ""forgotten"" what I set it to.This was the case both locally, and in the Azure staging environment.At this point I realized that because we're using full-IIS mode, the RoleEntryPoint and the Web Services were running in two separate processes - one in Azure's stub, and one in IIS. ""Not a problem"" I said, I'll simply move the line of code which starts the ServiceHost from my RoleEntryPoint into the global.asax - at which point the ServiceHost will have been started in the same process as the rest of the site - and the static variables would be the same ones. Here's where I'm having a problem; This works great on my local machine running in the dev environment. As soon as I deploy to staging I start getting error emails saying the channel used to connect to the service can't be closed because it's in a ""faulted state"".Question:What's different about Azure vs. Dev environment that is causing this?How can I fix or workaround the problem?Does anyone have any general advice on how I should go about obtaining a more descriptive error... do I have to enable full wcf diagnostics in Azure to get this, or is there some other way I can get at the exception details?Follow-Up: Via remote desktop i've learned several interesting things: Non-HTTP Activation isn't installed by default on Azure WebRoles. I believe this can be overcome via a startup script: start /w pkgmgr /iu:WCF-NonHTTP-Activation;The website created in IIS by the web role doesn't have the net.tcp protocol enabled by default. I also believe this can be overcome with a startup script: %systemroot%\system32\inetsrv\appcmd.exe set app ""Website Name Here"" /enabledProtocols:https,http,net.tcpI haven't had time to take this all the way, as deadlines have forced me to implement some workarounds temporarily.Some useful links related to this topic: http://msdn.microsoft.com/en-us/magazine/cc163357.aspxhttp://forums.iis.net/t/1160443.aspxhttp://msdn.microsoft.com/en-us/library/ms731053.aspxhttp://labs.episerver.com/en/Blogs/Paul-Smith/Dates/2008/6/Hosting-non-HTTP-based-WCF-applications-in-IIS7/ <code> ",Azure: Intra-WebRole Communication (netTcpBinding) with Full-IIS
How to give permissions for folders in c# ???," I need to give the folder ""Temporary ASP.NET Files"" a write permission using c#... and I use this code to give it the access When I checked for the security properties for the folder ""Temporary ASP.NET Files"" after implementing the code, it didn't checked the ""write"" permission check-box, instead of that it checked the ""special permissions"" one... I have noticed that even when I changed the access from write to full control or read , it checked the ""special permissions"" one....This is not the problem :), the problem is its not giving the right access that i give to it... when I give it write, it doesn't act like if I give it the write permission. I don't know why !! Am I doing it the wrong way ??Note:when I'm doing it in the manual way its working, while when using the coding way. it's not working...I hope you can help me with that...Thanks alot <code>  DirectoryInfo d1 = new DirectoryInfo(Path.Combine(RuntimeEnvironment.GetRuntimeDirectory(), ""Temporary ASP.NET Files""));DirectorySecurity md1 = d1.GetAccessControl();string user_1 = fa.TextGuestDomain + ""\\"" + fa.TextGuestUser;md1.AddAccessRule(new FileSystemAccessRule(user_1, FileSystemRights.FullControl,InheritanceFlags.ObjectInherit,PropagationFlags.InheritOnly, AccessControlType.Allow));d1.SetAccessControl(md1);",How to give permissions for folders in c#?
How can I discover current endpoints of my c# application programatically?," How can I code a c# sample for reading my Client endpoint configurations: And the goal is to obtain an array of endpoints address: As result we would have: <code>  <client> <endpoint address=""http://mycoolserver/FinancialService.svc"" binding=""wsHttpBinding"" bindingConfiguration=""WSHttpBinding_IFinancialService"" contract=""IFinancialService"" name=""WSHttpBinding_IFinancialService""> <identity> <dns value=""localhost"" /> </identity> </endpoint> <endpoint address=""http://mycoolserver/HumanResourcesService.svc"" binding=""wsHttpBinding"" bindingConfiguration=""WSHttpBinding_IHumanResourceService"" contract=""IHumanResourceService"" name=""WSHttpBinding_IHumanResourceService""> <identity> <dns value=""localhost"" /> </identity> </endpoint> List<string> addresses = GetMyCurrentEndpoints(); [0] http://mycoolserver/FinancialService.svc [1] http://mycoolserver/HumanResourcesService.svc",How can I discover current endpoints of my c# application programmatically?
.findControl(string id) asp.net c#," I have a html div element containing multiple divs with values that I want to put in an array server side!my html divs look something like: i want the values of these divs to go into an array server side. My current code looks like this: so the div id's are generated by the string format, no problem...but the clientGrid.findControl always = null! even if i put the sting directly into the constructor like clientGrid.findControl(""cell_0_0""); it still returns NULL! How is this possible?It is my understanding the the findControl method finds server control elements with the string id?I can't access the child divs directly like cell_0_0.clientID because the child divs are generated by the server at runtime.on page load, this function is run... test[,] is a 2d array containing integer values. these divs are then put into clientGrid by clientGrid.innerHtml = allMyDivsThe users then edits the values of these divs to whatever they want, and then when the user clicks a button, the values of these divs need to somehow end up back in the serverside code so i can process them.The clientGrid.control.count = 0 ... ??? so obviously... to the asp, these div elements do not exist... to asp.net... there is NOTHING inside the clientGrid div... but... the inspect element on my chrome browser says othervise! Whats Going On?? <code>  <div id=""clientGrid"" runat=""server""> <div id=""cell_0_0"" runat=""server"" class=""box"" onclick=""clicked(this)"">2</div> <div id=""cell_0_1"" runat=""server"" class=""box"" onclick=""clicked(this)"">1</div> <div id=""cell_0_2"" runat=""server"" class=""box"" onclick=""clicked(this)"">3</div> <div id=""cell_0_3"" runat=""server"" class=""box"" onclick=""clicked(this)"">4</div> <div id=""cell_1_0"" runat=""server"" class=""box"" onclick=""clicked(this)"">3</div> <div id=""cell_1_1"" runat=""server"" class=""box"" onclick=""clicked(this)"">2</div> <div id=""cell_1_2"" runat=""server"" class=""box"" onclick=""clicked(this)"">4</div> <div id=""cell_1_3"" runat=""server"" class=""box"" onclick=""clicked(this)"">1</div> <div id=""cell_2_0"" runat=""server"" class=""box"" onclick=""clicked(this)"">4</div> <div id=""cell_2_1"" runat=""server"" class=""box"" onclick=""clicked(this)"">3</div> <div id=""cell_2_2"" runat=""server"" class=""box"" onclick=""clicked(this)"">2</div> <div id=""cell_2_3"" runat=""server"" class=""box"" onclick=""clicked(this)"">1</div></div> for (int i = 0; i < _grid.getGridSize(); i++){ for (int j = 0; j < _grid.getGridSize(); j++) { string divId = string.Format(""cell_{0}_{1}"", i.ToString(), j.ToString()); Control div = clientGrid.findControl(divId); //more code underneath }} for (int i = 0; i < _grid.getGridSize(); i++) { for (int j = 0; j < _grid.getGridSize(); j++) { returnElement += "" <div ""; returnElement += ""id=\""cell_"" + i + ""_"" + j + ""\"" ""; returnElement += ""runat=\""server\"" ""; returnElement += ""tabindex=\""-1\"" ""; returnElement += ""class=\""box\"" ""; returnElement += ""onclick=\""clicked(this);\"" ""; returnElement += ""onkeypress=\""changeValue(event, this);\"" ""; returnElement += ""style=\""top:"" + top + ""%; left:"" + left + ""%;\"">""; returnElement += test[i, j]; returnElement += ""</div>\n ""; left = left + 20; } left = 0; top = top + 20; } return returnElement;",Unsuccessful using .FindControl() on a div
DateTime adding, Is it possible to add dates in C#? I tried this but it doesn't work. <code>  (DateTime.Today.ToLongDateString() + 10),Adding days to a DateTime in C#
Add to DateTime in C#, Is it possible to add dates in C#? I tried this but it doesn't work. <code>  (DateTime.Today.ToLongDateString() + 10),Adding days to a DateTime in C#
DateTime adding, Is it possible to add dates in C#? I tried this but it doesn't work. <code>  (DateTime.Today.ToLongDateString() + 10),Adding days to a DateTime in C#
Adding DateTime in C#, Is it possible to add dates in C#? I tried this but it doesn't work. <code>  (DateTime.Today.ToLongDateString() + 10),Adding days to a DateTime in C#
A Tutorial For Micro$oft Report In WinForm Applications, I am using Microsoft Report in My WinForm Application Project.I am some problem with expressions and group and even filters and many thing else.I am looking for a compelete tutorial for Microsoft Report.But I didn't found any tutorial until now.Can you help me to find a tutorial?I have found this.Tell me if u know better.Thanks <code> ,A Tutorial For Microsoft Report In WinForm Applications
C# regual expression needed," I need a C# regex to delete everything between /* and */ including the /**/.So, basically remove all code comments in the given text. <code> ",regular expression needed to remove C/C# comments
C# regular expression needed," I need a C# regex to delete everything between /* and */ including the /**/.So, basically remove all code comments in the given text. <code> ",regular expression needed to remove C/C# comments
Single vs mutiple MemoryCache instances," MemoryCache comes with a Default cache by default and additional named caches can be created.It seems like there might be advantages to isolating the caching of results of different processes in different instances For example, results of queries against an index could be cached in an ""IndexQueryResult"" cache and result of database queries in a ""DatabaseQueryResult"" cache. That's rather contrived but explains the principle.Does the memory pressure on one cache that results in evictions affect the other caches at all? Are there any differences in the way .Net manages multiple caches compared to how it manages one?Am I wasting my time considering the idea of multiple caches, or is there real value in doing so? <code> ",Single vs multiple MemoryCache instances
ASP.NET MVC 3: Serialize List<T> into google charts json datatable," I'm looking for a generic way of serializing a List of objects into the google charts json data format.This example is quite close, but it's using a datatable..I expect this would involve some reflection and some maybe attrbutes on the model properties.Can anyone point me to a library or something?Even better would be if I could serialize a query like this into the google charts format: <code>  var results = from m in be.cmsMember where m.FirstLogin != null && m.FirstLogin >= BitCoinGoLive group m by new { Year = m.FirstLogin.Value.Year, Month = m.FirstLogin.Value.Month, Day = m.FirstLogin.Value.Day } into grp select new { Year = grp.Key.Year, Month = grp.Key.Month, Day = grp.Key.Day, Count = grp.Count() };",Serialize List<T> into google charts json datatable
A local variable cannot be declared in this scope," Based on this recent question, I don't understand the answer provided. Seems like you should be able to do something like this, since their scopes do not overlap This code fails to compile with the following error: A local variable named 'i' cannot be declared in this scope because it would give a different meaning to 'i', which is already used in a 'child' scope to denote something else  <code>  static void Main(){ { int i; } int i;}",Why can't a duplicate variable name be declared in a nested local scope?
Is it possible to make a generic number parser in C#?," To parse a string to an int, one calls Int32.Parse(string), for double, Double.Parse(string), for long, Int64.Parse(string), and so on..Is it possible to create a method that makes it generic, for example, ParseString<T>(string)? where T can be Int32, Double, etc. I notice the number of types don't implement any common interface, and the Parse methods don't have any common parent. Is there any way to achieve this or something similar to this? <code> ",How to make a generic number parser in C#?
Playing sound byte[] in c#," I realize that you can use SoundPlayer to play a sound in C#; however, I want to be able to play a sound with the OS-default sound player using this method from a sound represented in a byte array. Is this possible? <code> ",Playing sound byte[] in C#
Overhead of using structs as wrappers for primitives for type-safety?," Let's say I want to get extra type-checking for working with primitives that mean different things semantically: The point is we can't compare ""apples to oranges"", so wrapping up the actual int in a struct means we get type checking and some extra readability and documentation by code.My question is: what is the overhead associated with doing this, both in terms of memory and speed? Since structs are value types, would variables containing these structs be 32 bits or larger? What about performance overhead of using these structs instead of primitives - is there a large overhead for the operator overloads?Any other advice on the wisdom of doing this? <code>  public struct Apple{ readonly int value; // Add constructor + operator overloads}public struct Orange{ readonly int value; // Add constructor + operator overloads}",Overhead of using structs as wrappers for primitives for type-checking?
AutoFixture IEnumerable<T> behavior with CreatMany()," When looking at the post here, it looks like I should be able to create several objects using CreateMany(), iterate over them using foreach, and then return them as an array.What I'm seeing is that each iteration seems to create new objects each time. Is this expected behavior?Entity to create: Sample Program.cs: I created an issue here (which can probably be deleted if this is expected behavior).Edit 2011-06-02To get the behavior I was expecting, and if I don't want to modify the AutoFixture behavior, I can use an extension method: <code>  public class TestEntity{ public int Id { get; private set; } public string SomeString { get; set; } public void SetId(int value) { this.Id = value; }} private static int id;static void Main(string[] args){ var fixture = new Fixture(); IEnumerable<TestEntity> testEntities = fixture.Build<TestEntity>().CreateMany(5); Output(testEntities); foreach (var testEntity in testEntities) { testEntity.SetId(id++); Console.WriteLine( string.Format(""CHANGED IN FOREACH:: hash: {0}, id: {1}, string: {2}"", testEntity.GetHashCode(), testEntity.Id, testEntity.SomeString)); } Output(testEntities);}private static void Output(IEnumerable<TestEntity> testEntities){ foreach (var testEntity in testEntities) { Console.WriteLine( string.Format(""hash: {0}, id: {1}, string: {2}"", testEntity.GetHashCode(), testEntity.Id, testEntity.SomeString)); }} var fixture = new Fixture();TestEntity[] testEntities = fixture.Build<TestEntity>().CreateMany(5).ToArray();",AutoFixture IEnumerable<T> behavior with CreateMany()
await immediately moves to next statement (.NET Async CTP)," I am playing with the new Async CTP bits, and I can't get it work with either server-side or just command-line program (and all the examples are either WPF or Silverlight). For example, some trivial code like: returns immediately and prints System.Threading.Tasks.Task1[System.Int32]` instead of waiting for 10 secs and return 7 (as I would expect). Must be something obvious that I am missing. <code>  class Program { static void Main() { Program p = new Program(); var s = p.Ten2SevenAsync(); Console.WriteLine(s); } private async Task<int> Ten2SevenAsync() { await TaskEx.Delay(10000); return 7; }}",await immediately moves to next statement
using streamreader to check if there there contains a string," I have a string that is args[0].Here is my code so far: I would like to check if my list.txt file contains args[0]. If it does, then I will create another process StreamWriter to write a string 1 or 0 into the file. How do I do this? <code>  static void Main(string[] args){ string latestversion = args[0]; // create reader & open file using (StreamReader sr = new StreamReader(""C:\\Work\\list.txt"")) { while (sr.Peek() >= 0) { // code here } }}",Using StreamReader to check if a file contains a string
Using StreamReader to check if a file contains a string.," I have a string that is args[0].Here is my code so far: I would like to check if my list.txt file contains args[0]. If it does, then I will create another process StreamWriter to write a string 1 or 0 into the file. How do I do this? <code>  static void Main(string[] args){ string latestversion = args[0]; // create reader & open file using (StreamReader sr = new StreamReader(""C:\\Work\\list.txt"")) { while (sr.Peek() >= 0) { // code here } }}",Using StreamReader to check if a file contains a string
Custom C Sharp Form Design," I'm kind of stuck on this one, I know it can be done but unsure the steps needed.I want to create a fully custom User Interface design for an application I'm having to create. I can change the form background and all that but this is a bit more complex.An example image is shown below of the kind of change I'm referring to, as you can see its a rather big change compared to the current UI used by most applications. <code> ",Custom C# Form Design
Excluding items selectively from Sitecore's Lucene search index," On a site powered by Sitecore 6.2, I need to give the user the ability to selectively exclude items from search results.To accomplish this, I have added a checkbox field entitled ""Include in Search Results"", and I created a custom database crawler to check that field's value:~\App_Config\Include\Search Indexes\Website.config: ~\Lib\Search\Indexing\CustomCrawler.cs: What's interesting is, if I rebuild the index using the Index Viewer application, everything behaves as normal. Items whose ""Include in Search Results"" checkbox is not checked will not be included in the search index.However, when I use the search index rebuilder in the Sitecore Control Panel application or when the IndexingManager auto-updates the search index, all items are included, regardless of the state of their ""Include in Search Results"" checkbox.I've also set numerous breakpoints in my custom crawler class, and the application never hits any of them when I rebuild the search index using the built-in indexer. When I use Index Viewer, it does hit all the breakpoints I've set.How do I get Sitecore's built-in indexing processes to respect my ""Include in Search Results"" checkbox?  <code>  <search> <configuration type=""Sitecore.Search.SearchConfiguration, Sitecore.Kernel"" singleInstance=""true""> <indexes hint=""list:AddIndex""> <index id=""website"" singleInstance=""true"" type=""Sitecore.Search.Index, Sitecore.Kernel""> ... <locations hint=""list:AddCrawler""> <master type=""MyProject.Lib.Search.Indexing.CustomCrawler, MyProject""> ... </master> <!-- Similar entry for web database. --> </locations> </index> </indexes> </configuration></search> using Lucene.Net.Documents;using Sitecore.Search.Crawlers;using Sitecore.Data.Items;namespace MyProject.Lib.Search.Indexing{ public class CustomCrawler : DatabaseCrawler { /// <summary> /// Determines if the item should be included in the index. /// </summary> /// <param name=""item""></param> /// <returns></returns> protected override bool IsMatch(Item item) { if (item[""include in search results""] != ""1"") { return false; } return base.IsMatch(item); } }}","Excluding items selectively from Sitecore's Lucene search index - works when rebuilding with IndexViewer, but not when using Sitecore's built-in tools"
wait for an ajax call to complete with Selenium 2 web driver," I'm using Selenium 2 WebDriver to test an UI which uses AJAX.Is there a way to make the driver to wait for a bit that the Ajax request will complete.Basically I have this : <code>  d.FindElement(By.XPath(""//div[8]/div[3]/div/button"")).Click();// This click trigger an ajax request which will fill the below ID with content.// So I need to make it wait for a bit.Assert.IsNotEmpty(d.FindElement(By.Id(""Hobbies"")).Text);",Wait for an Ajax call to complete with Selenium 2 WebDriver
ASP.Net Profile save overwritten by old values," I am using the Profile feature of ASP.NET in a website. Updating a profile is working weirdly! A user can't update his/her own profile, neither the web site user nor the administrator, but, the administrator is able to update profiles of other users.In the backend, after Profile's save() is called, SQL Server traces show that aspnet_Profile_SetProperties stored procedure is called twice. First, with new values, then, with old values. The second execution is done after page unload. My code has nothing to do with transactions.Why is it working so weirdly?Could there be an issue with aspnet_regsql's installation as I have installed uninstalled and again installed it!?Codeweb.config Code behind <code>  <authentication mode=""Forms""> <forms name=""FormsAuthentication"" loginUrl=""~/Login.aspx"" defaultUrl=""~/Login.aspx"" timeout=""20""/></authentication><membership defaultProvider=""CustSqlMembershipProvider""> <providers> <add connectionStringName=""connString"" applicationName=""/space_online"" minRequiredPasswordLength=""5"" minRequiredNonalphanumericCharacters=""0"" name=""CustSqlMembershipProvider"" type=""System.Web.Security.SqlMembershipProvider""/> </providers></membership><roleManager enabled=""true"" defaultProvider=""CustSqlRoleProvider""> <providers> <add connectionStringName=""connString"" applicationName=""/space_online"" name=""CustSqlRoleProvider"" type=""System.Web.Security.SqlRoleProvider""/> </providers></roleManager><anonymousIdentification cookieless=""AutoDetect"" enabled=""true""/><profile defaultProvider=""CustSqlProfileProvider"" enabled=""true""> <providers> <add name=""CustSqlProfileProvider"" type=""System.Web.Profile.SqlProfileProvider"" connectionStringName=""connString"" applicationName=""/space_online""/> </providers> <properties> <add name=""FirstName"" type=""System.String""/> <add name=""LastName"" type=""System.String""/> <add name=""Email"" type=""System.String""/> <group name=""Address""> <add name=""Street"" type=""System.String""/> <add name=""City"" type=""System.String""/> <add name=""PostalCode"" type=""System.String""/> </group> <group name=""Contact""> <add name=""Phone"" type=""System.String""/> <add name=""Mobile"" type=""System.String""/> <add name=""Fax"" type=""System.String""/> </group> <add name=""ShoppingCart"" type=""psb.website.BLL.Store.ShoppingCart"" serializeAs=""Binary"" allowAnonymous=""true""/> </properties></profile> private void UpdateProfile(ProfileCommon myprofile){ myprofile.FirstName = tbFirstName.Text.Trim(); myprofile.LastName = tbLastName.Text.Trim(); myprofile.Email = tbEmail.Text.Trim(); myprofile.Address.Street = tbStreetPhysical.Text.Trim(); myprofile.Address.City = tbCity.Text.Trim(); myprofile.Address.PostalCode = tbPostalCode.Text.Trim(); myprofile.Contact.Phone = tbPhone1.Text.Trim(); myprofile.Contact.Mobile = tbMobile.Text.Trim(); myprofile.Save();}private ProfileCommon GetProfile() { ProfileCommon profile = this.Profile; if (Request.QueryString[""UserName""] != null && HttpContext.Current.User.IsInRole(""Admin"")) profile = this.Profile.GetProfile(Request.QueryString[""UserName""].ToString()); else profile = this.Profile.GetProfile(HttpContext.Current.User.Identity.Name); return profile; }protected void tbUpdateProfile_Click(object sender, ImageClickEventArgs e) { UpdateProfile(GetProfile()); }",ASP.NET Profile save overwritten by old values
How to combine where constraint and implementation interface," Case C is the combination of case A and case B. Is that possible?How to make case C right? <code>  class Sample<T> : IDisposable // case A{ public void Dispose() { throw new NotImplementedException(); }}class SampleB<T> where T : IDisposable // case B{}class SampleC<T> : IDisposable, T : IDisposable // case C{ public void Dispose() { throw new NotImplementedException(); }}",How do I define a generic class that implements an interface and constrains the type parameter?
Please help me understand how string assignation works in C#," A few weeks ago, I discovered that strings in C# are defined as reference types and not value types. Initially I was confused about this, but then after some reading, I suddenly understood why it is important to store strings on the heap and not the stack - because it would be very inefficient to have a very large string that gets copied over an unpredictable number of stack frames. I completely accept this.I feel that my understanding is almost complete, but there is one element that I am missing - what language feature do strings use to keep them immutable? To illustrate with a code example: I do not understand what language feature makes a copy of valueA when I assign it to valueB. Or perhaps, the reference to valueA does not change when I assign it to valueB, only valueA gets a new reference to itself when I set the string. As this is an instance type, I do not understand why this works.I understand that you can overload, for example, the == and != operators, but I cannot seem to find any documentation on overloading the = operators. What is the explanation? <code>  string valueA = ""FirstValue"";string valueB = valueA;valueA = ""AnotherValue"";Assert.AreEqual(""FirstValue"", valueB); // Passes",String assignment in C#
"clearing the entire console window, C#"," I am making a console window RPG, yet I'm having problems clearing the entire console window. Is there a way for me to clear the entire console window with one command? <code> ",How to clear the entire console window?
Serializing an IEnumerable trough WCF using Protobug-net and Monotouch for IOS," I'm trying to code a WCF service on Monotouch/Monodevelop for IOS. I was using standard attributes like [DataMember]/[DataContract] for my serializable object and [ServiceContract]/[OperationContract] for my interface. Everything worked fine, but when I tried to implement a method returning an IEnumerable on the interface implementation (server side), it didn't worked.So to solve my problem I tried to use the latest version of protobuf-net being protobuf-net v2 beta r404. But I'm still getting a serialization error from Protobuf-net. Note that the IEnumerable in ""MyObject"" serialize without problem. Here's how my code looks right now:MyObject: My interface (Server side on Windows): My interface (client side on IOS, I can't add ProtoBehavior as attribute becuase it is not in the ISO dll of protobuf): My interface implementation: <code>  [ProtoContract]public class MyObject{ public MyObject () { } [ProtoMember(1)] public int Id {get;set;} [ProtoMember(2)] public IEnumerable<MyObject> myObjects {get;set;}} [ServiceContract]public interface ITouchService{ [OperationContract, ProtoBehavior] MyObject Execute(); [OperationContract, ProtoBehavior] IEnumerable<MyObject> ExecuteENUM ();} [ServiceContract]public interface ITouchService{ [OperationContract] MyObject Execute(); [OperationContract] IEnumerable<MyObject> ExecuteENUM ();} public class TouchService : ITouchService { public MyObject Execute() { var myObject = new MyObject() { Id = 9001 }; var myList = new List<MyObject>(); for (int i = 0; i < 10; i++) { myList.Add(new MyObject() { Id = i }); }// Will serialize myObject.myObjects = myList; return myObject; } public IEnumerable<MyObject> ExecuteENUM() { var myEnum = new List<MyObject>(); for (int i = 0; i < 10; i++) { myEnum.Add(new MyObject() { Id = i }); } return myEnum; } }",Serializing an IEnumerable trough WCF using Protobuf-net and Monotouch for IOS
NHibernate unable to cast PersistentGenericSet to ISet," I get this error: Unable to cast object of type 'NHibernate.Collection.Generic.PersistentGenericSet1[IocWinFormTestEntities.People]' to type 'System.Collections.Generic.ISet1[IocWinFormTestEntities.People]'.The entity: Map override class: Generated hbm from fluent automapper: What's wrong? <code>  public class Event { public Event() { this.People = new HashSet<People>(); } public virtual Guid Id { get; private set; } public virtual ISet<People> People { get; set; }} public class EventMapOverride : IAutoMappingOverride<Event>{ public void Override(AutoMapping<Event> mapping) { mapping.HasMany(c => c.People) .AsSet() .Cascade.AllDeleteOrphan(); }} <set cascade=""all-delete-orphan"" name=""People""> <key> <column name=""Event_id"" /> </key> <one-to-many class=""IocWinFormTestEntities.People, IocWinFormTestEntities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"" /></set>","Getting ""unable to cast PersistentGenericSet to ISet"" error"
ASP.NET Repeater - loop through Items in the Item Template," I have a repeater, which is bound on preRender with items. In the Item template each row has a check box. This works fine.I'm trying to loop through all the checkboxes in the item template after it has been bound. Is there any way of doing this? <code> ",How can I loop through Items in the Item Template from an asp:Repeater?
Can I Add a handler to AppDomain.CurrentDomain.UnhandledException to a class library," I want to subscribe to the AppDomain.CurrentDomain.UnhandledException event to catch any errors as im trying a new design pattern where I dont want to put a try catch on every event.usually in a win forms app there is a main entry point, but this is a class library that is called by another application. Is there a main entry point in a class library where I can hook up this event, or is it just not possible in a class library unless im sure one method will get called before anything else? <code> ",Can I Add a handler to AppDomain.CurrentDomain.UnhandledException in a class library
Does c++ have anything like List<string> in C#, Does C++ has anything like List<> in C#? Something like List<string> for storing an array of strings. <code> ,Does C++ have anything like List<string> in C#?
Best way to wait for something in C#," I was reviewing the code to connect to the DB in one of the applications that I'm working on and I saw this The while loop worries me. Is there a better way to Do Nothing until things are connected?EDIT:The connection is gotten as follows <code>  if (_dbConnection == null) _dbConnection = GetConnection(); while (_dbConnection.State == ConnectionState.Connecting) { //Do Nothing until things are connected. } if (_dbConnection.State != ConnectionState.Open) _dbConnection.Open(); var command = GetCommand(commandType); command.Connection = _dbConnection; return command; private static IDbConnection GetConnection(){ return new SqlConnection(ConfigurationManager.ConnectionStrings[""CoonectionStringName""].ConnectionString);}",Best way to do nothing until things are connected in C#
How can we show progress bar with FtpWebRequest," I am uploading files to ftp using FtpWebRequest. I need to show the status that how much is done.So far my code is: <code>  public void Upload(string filename, string url){ FileInfo fileInf = new FileInfo(filename); string uri = ""ftp://"" + url + ""/"" + fileInf.Name; FtpWebRequest reqFTP; //string uri = ""ftp://"" + Host + ""/public_html/testing/blogtest/"" + fileInf.Name; // Create FtpWebRequest object from the Uri provided reqFTP = (FtpWebRequest)FtpWebRequest.Create(new Uri(uri)); // Provide the WebPermission Credintials reqFTP.Credentials = new NetworkCredential(Username, Password); // By default KeepAlive is true, where the control connection is not closed // after a command is executed. reqFTP.KeepAlive = false; //reqFTP.UsePassive = true; // Specify the command to be executed. reqFTP.Method = WebRequestMethods.Ftp.UploadFile; // Specify the data transfer type. reqFTP.UseBinary = true; // Notify the server about the size of the uploaded file reqFTP.ContentLength = fileInf.Length; // The buffer size is set to 2kb int buffLength = 2048; byte[] buff = new byte[buffLength]; int contentLen; // Opens a file stream (System.IO.FileStream) to read the file to be uploaded FileStream fs = fileInf.OpenRead(); // Stream to which the file to be upload is written Stream strm = reqFTP.GetRequestStream(); // Read from the file stream 2kb at a time contentLen = fs.Read(buff, 0, buffLength); // Till Stream content ends while (contentLen != 0) { // Write Content from the file stream to the FTP Upload Stream strm.Write(buff, 0, contentLen); contentLen = fs.Read(buff, 0, buffLength); } // Close the file stream and the Request Stream strm.Close(); fs.Close();}",How can we show progress bar for upload with FtpWebRequest
ASP.net get the next tuesday.," How can I get the date of next Tuesday? In PHP, it's as simple as strtotime('next tuesday');. How can I achieve something similar in .NET <code> ",Datetime - Get next tuesday
How to modify where MVC thinks the root is for static content," I want to be able to reorganize my ASP.NET MVC site structure to more closely match the way Rails does it (We do both rails and ASP.net at my company). In Rails, there is a ""public"" folder that behaves as the root of the site. For example, I could drop in a ""test.html"" and access the file with the url http://domain.com/test.html which would serve up the static html file.In asp.net MVC there is a ""Content"" folder that I want to behave as the root. So instead of accessing http://domain.com/content/myfile.html, i want to be able to do http://domain.com/myfile.html.I know I can just drop the file in the root of the project, but i need to do this with many files including css, js, html, images, etc and want to share some standardized assets across rails and aspnetmvc.Is there a way to do this? <code> ",How to modify ASP.NET MVC static file root 
WPF Calling method from a DataTriger," Is it possible to use a wild card or call a method to work out if a DataTrigger should be applied?I currently have my DataList bound to an IEnumerable that contains file names and I want the file names to be greyed out if there files extension starts with ""old"" My non-working dream xaml markup looks something like this: The only workable solution I've been able to come up with is to insert a new view model property that contains this logic, but I would like to avoid changing the view model if possible. <code>  <DataTemplate.Triggers> <DataTrigger Binding=""{Binding}"" Value=""*.old*""> <Setter TargetName=""FileName"" Property=""Foreground"" Value=""Gray""/> </DataTrigger></DataTemplate.Triggers>",WPF Calling method from a DataTrigger
Serialization inheritence: Will an exception be thrown if the base class isn't marked [Serializable]?," Taking a practice exam the exam said I got this one wrong. The answer marked in Yellow is the supposed correct answer.In the following quote, the part marked in bold I think is wrong: ""The Serializable attribute is not inherited by the derived classes, so if you only mark the Encyclopedia class with the Serializable attribute, the runtime will throw an exception when trying to serialize the Name field"".I actually created a sample project with an Animal class and a Cat class that derives from it. I marked the Cat class [Serializable] and the Animal class is not.I was able to successfully serialize and deserialize the Cat class, including the Animal properties.Is this a .NET version issue? The exam is 70-536, so it's targeting 2.0. <code> ",Serialization inheritance: Will an exception be thrown if the base class isn't marked [Serializable]?
Stepping through VB6 COM object wrapped by .NET Class, I have a VB6 object that is wrapped by a .NET class. As far as I recall it is possible to step through a VB6 object by simply running the VB6 library and inserting a breakpoint at the desired location.However this does not appear to be working in my case. I have attempted to recompile the VB6 object and re-reference it in my .NET project but this doesn't appear to have helped. Where do I go from here? Is there a way to insert Debugger.Launch() equivalent into a VB6 project? Any help would be appreciated!! <code> ,Stepping through VB6 COM object wrapped by .NET Class
byte[] to byte* c#," I created 2 programs - in C# and C++, both invoke native methods from C dll. C++ works fine, because there are the same data types, C# doesn't work. And native function parameter is unsigned char*. I tried byte[] in C#, it didn't work, then I tried: It also doesn't work. Is it correct to convert byte array to byte* in such way? Is it correct to use byte in C# as unsigned char in C?EDIT:This stuff returns the wrong result: This stuff also returns the wrong result: <code>  fixed(byte* ptr = byte_array) { native_function(ptr, (uint)byte_array.Length);} byte[] byte_array = Encoding.UTF8.GetBytes(source_string);nativeMethod(byte_array, (uint)byte_array.Length); byte* ptr; ptr = (byte*)Marshal.AllocHGlobal((int)byte_array.Length); Marshal.Copy(byte_array, 0, (IntPtr)ptr, byte_array.Length);",byte[] to byte* in C#
Return list using select new in LINQ.," This is my method which gives me error. If i change it with this: Then it works fine with no errors.Can you please let me know that how I can return only ProjectId and ProjectNam? <code>  public List<Project> GetProjectForCombo(){ using (MyDataContext db = new MyDataContext (DBHelper.GetConnectionString())) { var query = from pro in db.Projects select new { pro.ProjectName, pro.ProjectId }; return query.ToList(); }} public List<Project> GetProjectForCombo(){ using (MyDataContext db = new MyDataContext (DBHelper.GetConnectionString())) { var query = from pro in db.Projects select pro; return query.ToList(); }}",Return list using select new in LINQ
Why does the C# runtime add underscores to my string?s," I store my application settings the C# way (Properties.Settings.Default.Save();). The settings are then stored by the C# runtime in the folder: The strange thing is that I entered ""My Company Name"" as the Company-property in Visual Studio ([assembly: AssemblyCompany(""My Company Name"")]).So, where do the underscores come from? I've seen other apps creating folders with blanks... <code>  C:\Users\UserName\AppData\Local\My_Company_Name",Why does the .NET runtime add underscores to my string?
Why does the C# runtime add underscores to my string?," I store my application settings the C# way (Properties.Settings.Default.Save();). The settings are then stored by the C# runtime in the folder: The strange thing is that I entered ""My Company Name"" as the Company-property in Visual Studio ([assembly: AssemblyCompany(""My Company Name"")]).So, where do the underscores come from? I've seen other apps creating folders with blanks... <code>  C:\Users\UserName\AppData\Local\My_Company_Name",Why does the .NET runtime add underscores to my string?
c# string starts with a number regex," I've been searching around for a little while to figure out how to confirm a string begins with a number. I came across a regex statement '/^\d/' which I can confirm says if starts with digit. However I can not seem to get it to work in the code below. Where did I went wrong in the statement if(Regex.Match(info,""/^\d/""))? example data (tab delimited):TicketID Status URL InitCats PostRevCats ListNumClosed555555 Closed http://5555555.com/searcho Malicious Sites 55555 <code>  //String attachbody is the attachment body from an email C read into a stringstring[] data = Regex.Split(attachbody, ""\n"");foreach (String info in data){ if (Regex.Match(info,""/^\d/"")) { string[] tabbedHeaderData = Regex.Split(info, ""\t""); TicketID = tabbedHeaderData[0].ToString(); Status = tabbedHeaderData[1].ToString(); URL = tabbedHeaderData[2].ToString(); InitCats = tabbedHeaderData[3].ToString(); PostRevCats = tabbedHeaderData[4].ToString(); ListNumClosed = tabbedHeaderData[5].ToString(); Console.WriteLine(TicketID); Console.WriteLine(Status); Console.WriteLine(URL); Console.WriteLine(InitCats); Console.WriteLine(PostRevCats); Console.WriteLine(ListNumClosed); Console.ReadLine(); }}",C# string starts with a number regex
How can I receive OutputDebugString from service ?," I'm trying to catch all OutputDebugString messages (including those from services) using the following code. It worked fine until I migrated to Windows 7.The problem is that since Windows Vista services are running in the low level Session #0, some people say that it's impossible to catch them and some that it is. What do you think?Is it possible to modify the following code by increasing some rights to be able to receive OutputDebugString messages from the Session #0? In other words; is it possible to share DBWIN_BUFFER in the session #0 with Session #1?I would say it should be possible because e.g. DebugView can do that, and I can't see any service helper which would send those messages (e.g. through the named pipes) from the Session #0 to Session #1, where the GUI's running.The problem will be IMO in the security settings. Can anyone suggest me how to modify them? I've added the C# tag even if the code is in Delphi because the security attributes are common for the whole Windows API and C# has many followers :) <code>  type TODSThread = class(TThread) protected procedure Execute; override; end;...procedure TODSThread.Execute;var SharedMem: Pointer; SharedFile: THandle; WaitingResult: DWORD; SharedMessage: string; DataReadyEvent: THandle; BufferReadyEvent: THandle; SecurityAttributes: SECURITY_ATTRIBUTES; SecurityDescriptor: SECURITY_DESCRIPTOR;begin SecurityAttributes.nLength := SizeOf(SECURITY_ATTRIBUTES); SecurityAttributes.bInheritHandle := True; SecurityAttributes.lpSecurityDescriptor := @SecurityDescriptor; if not InitializeSecurityDescriptor(@SecurityDescriptor, SECURITY_DESCRIPTOR_REVISION) then Exit; if not SetSecurityDescriptorDacl(@SecurityDescriptor, True, nil, False) then Exit; BufferReadyEvent := CreateEvent(@SecurityAttributes, False, True, 'DBWIN_BUFFER_READY'); if BufferReadyEvent = 0 then Exit; DataReadyEvent := CreateEvent(@SecurityAttributes, False, False, 'DBWIN_DATA_READY'); if DataReadyEvent = 0 then Exit; SharedFile := CreateFileMapping(THandle(-1), @SecurityAttributes, PAGE_READWRITE, 0, 4096, 'DBWIN_BUFFER'); if SharedFile = 0 then Exit; SharedMem := MapViewOfFile(SharedFile, FILE_MAP_READ, 0, 0, 512); if not Assigned(SharedMem) then Exit; while (not Terminated) and (not Application.Terminated) do begin SetEvent(BufferReadyEvent); WaitingResult := WaitForSingleObject(DataReadyEvent, INFINITE); case WaitingResult of WAIT_TIMEOUT: Continue; WAIT_OBJECT_0: begin SharedMessage := String(PAnsiChar(SharedMem) + SizeOf(DWORD)); // here I have what I need and process it in the main thread end; WAIT_FAILED: Continue; end; end; UnmapViewOfFile(SharedMem); CloseHandle(SharedFile);end;",How can I receive OutputDebugString from a service?
How can I receive OutputDebugString from service?," I'm trying to catch all OutputDebugString messages (including those from services) using the following code. It worked fine until I migrated to Windows 7.The problem is that since Windows Vista services are running in the low level Session #0, some people say that it's impossible to catch them and some that it is. What do you think?Is it possible to modify the following code by increasing some rights to be able to receive OutputDebugString messages from the Session #0? In other words; is it possible to share DBWIN_BUFFER in the session #0 with Session #1?I would say it should be possible because e.g. DebugView can do that, and I can't see any service helper which would send those messages (e.g. through the named pipes) from the Session #0 to Session #1, where the GUI's running.The problem will be IMO in the security settings. Can anyone suggest me how to modify them? I've added the C# tag even if the code is in Delphi because the security attributes are common for the whole Windows API and C# has many followers :) <code>  type TODSThread = class(TThread) protected procedure Execute; override; end;...procedure TODSThread.Execute;var SharedMem: Pointer; SharedFile: THandle; WaitingResult: DWORD; SharedMessage: string; DataReadyEvent: THandle; BufferReadyEvent: THandle; SecurityAttributes: SECURITY_ATTRIBUTES; SecurityDescriptor: SECURITY_DESCRIPTOR;begin SecurityAttributes.nLength := SizeOf(SECURITY_ATTRIBUTES); SecurityAttributes.bInheritHandle := True; SecurityAttributes.lpSecurityDescriptor := @SecurityDescriptor; if not InitializeSecurityDescriptor(@SecurityDescriptor, SECURITY_DESCRIPTOR_REVISION) then Exit; if not SetSecurityDescriptorDacl(@SecurityDescriptor, True, nil, False) then Exit; BufferReadyEvent := CreateEvent(@SecurityAttributes, False, True, 'DBWIN_BUFFER_READY'); if BufferReadyEvent = 0 then Exit; DataReadyEvent := CreateEvent(@SecurityAttributes, False, False, 'DBWIN_DATA_READY'); if DataReadyEvent = 0 then Exit; SharedFile := CreateFileMapping(THandle(-1), @SecurityAttributes, PAGE_READWRITE, 0, 4096, 'DBWIN_BUFFER'); if SharedFile = 0 then Exit; SharedMem := MapViewOfFile(SharedFile, FILE_MAP_READ, 0, 0, 512); if not Assigned(SharedMem) then Exit; while (not Terminated) and (not Application.Terminated) do begin SetEvent(BufferReadyEvent); WaitingResult := WaitForSingleObject(DataReadyEvent, INFINITE); case WaitingResult of WAIT_TIMEOUT: Continue; WAIT_OBJECT_0: begin SharedMessage := String(PAnsiChar(SharedMem) + SizeOf(DWORD)); // here I have what I need and process it in the main thread end; WAIT_FAILED: Continue; end; end; UnmapViewOfFile(SharedMem); CloseHandle(SharedFile);end;",How can I receive OutputDebugString from a service?
How to insert an IEnumerable<T> collection with dapper-dot-net," Yep, there are questions here and here about how to insert records with dapper-dot-net. However, the answers, while informative, didn't seem to point me in the right direction. Here is the situation: moving data from SqlServer to MySql. Reading the records into an IEnumerable<WTUser> is easy, but I am just not getting something on the insert. First, the 'moving records code': cnn.Query and cnn.Execute call the dapper extension methods. Now, the WTUser class (note: the column name changed from 'WindowsName' in SqlServer to 'ResourceName' in MySql, thus the two properties pointing to the same field): I am receiving an exception from dapper: ""WTUser is not supported by Dapper."" This method in DataMapper (dapper): At this point OwnerType = System.Collections.Generic.List`1[[CRMBackEnd.WTUser, CRMBE, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089It seems like OwnerType should be CRMBackEnd.WTUser ... not List<CRMBackEnd.WTUser> ... ??? because what is happening is that the collection properties are being iterated: Count, Capacity, etc. What am I missing?Update If I modified session.WriteData as: records are inserted nicely ... but I didn't think this would be necessary given examples like: ... from dapper-dot-net <code>  // moving dataDim session As New Session(DataProvider.MSSql, ""server"", _ ""database"")Dim resources As List(Of WTUser) = session.QueryReader(Of WTUser)(""select * from tbl_resource"")session = New Session(DataProvider.MySql, ""server"", ""database"", _ ""user"", ""p@$$w0rd"")// *edit* - corrected parameter notation with '@'Dim strInsert = ""INSERT INTO tbl_resource (ResourceName, ResourceRate, ResourceTypeID, ActiveYN) "" & _ ""VALUES (@ResourceName, @ResourceRate, @ResourceType, @ActiveYN)""Dim recordCount = session.WriteData(Of WTUser)(strInsert, resources)// session Methods Public Function QueryReader(Of TEntity As {Class, New})(ByVal Command As String) _ As IEnumerable(Of TEntity) Dim list As IEnumerable(Of TEntity) Dim cnn As IDbConnection = dataAgent.NewConnection list = cnn.Query(Of TEntity)(Command, Nothing, Nothing, True, 0, CommandType.Text).ToList() Return list End Function Public Function WriteData(Of TEntity As {Class, New})(ByVal Command As String, ByVal Entities As IEnumerable(Of TEntity)) _ As Integer Dim cnn As IDbConnection = dataAgent.NewConnection // *edit* if I do this I get the correct properties, but no data inserted //Return cnn.Execute(Command, New TEntity(), Nothing, 15, CommandType.Text) // original Return statement Return cnn.Execute(Command, Entities, Nothing, 15, CommandType.Text) End Function Public Class WTUser // edited for brevity - assume the following all have public get/set methods Public ActiveYN As String Public ResourceID As Integer Public ResourceRate As Integer Public ResourceType As Integer Public WindowsName As String Public ResourceName As StringEnd Class private static Action<IDbCommand, object> CreateParamInfoGenerator(Type OwnerType) { string dmName = string.Format(""ParamInfo{0}"", Guid.NewGuid()); Type[] objTypes = new[] { typeof(IDbCommand), typeof(object) }; var dm = new DynamicMethod(dmName, null, objTypes, OwnerType, true); // << - here // emit stuff // dm is instanced, now ... foreach (var prop in OwnerType.GetProperties().OrderBy(p => p.Name)) Public Function WriteData(Of TEntity As {Class, New})(ByVal Command As String, _ ByVal Entities As IEnumerable(Of TEntity)) _ As Integer Dim cnn As IDbConnection = dataAgent.NewConnection Dim records As Integer For Each entity As TEntity In Entities records += cnn.Execute(Command, entity, Nothing, 15, CommandType.Text) Next Return recordsEnd Function connection.Execute(@""insert MyTable(colA, colB) values (@a, @b)"", new[] { new { a=1, b=1 }, new { a=2, b=2 }, new { a=3, b=3 } } ).IsEqualTo(3); // 3 rows inserted: ""1,1"", ""2,2"" and ""3,3"" ","Inserting an IEnumerable<T> collection with Dapper errors out with ""class is not supported by Dapper."""
Multithreaded .NET queue problems (C#)," I'm have a wierd error in my code. It's extremely rare (happens once every few weeks maybe), but it's there and I'm not sure why.We have 2 threads running, 1 thread gets networked messages and adds them to a Queue like this: Another thread takes messages off this queue and handles them, like this: However once every so often I get a NullReferenceException on the line switch (message.messageType) and I can see in the debugger that message is null.It is not possible that a null value was put onto the queue (see the first bit of code), and these are the only 2 things that use the queue.Is Queue not thread-safe, could it be that I'm dequeuing at the exact moment that the other thread is enqueuing and this causes the glitch? <code>  DataMessages.Enqueue(new DataMessage(client, msg)); while (NetworkingClient.DataMessages.Count > 0){ DataMessage message = NetworkingClient.DataMessages.Dequeue(); switch (message.messageType) { ... }}",Multithreaded .NET queue problems
Request.UserHostAddress issu return ::1, I am trying to get client ip address using but it returns ::1.How to solve this? <code>  HttpContext.Request.UserHostAddress;,"Request.UserHostAddress issue with return result ""::1"""
C#: Invoke Windows Magnifier," I'm building a gesture system for the Kinect SDK in a C#/WPF app. I want to add a gesture for Magnifier zoom in and out. I'd prefer to use the built-in Windows Magnifier or its underlying logic, but any way to get a similar effect (multiple-monitor aware) would work.How can I programatically invoke the zoom features of the Windows Magnifier?So far, the only thing I've found with any hope is to start the process and click the button through Win32; but when I do that, it's pulling up a blank, empty window when I call the Magnifier window's handle.I've patched this code together through a combination of what I know of C#, a bunch of Win32 API calls I don't really know that well, and a ton of Googling. <code>  private void ZoomIn(){ // Make sure the Magnifier is running, and get its handle if (Process.GetProcesses().Where(p => p.ProcessName.ToLower() == ""magnify"").Count() == 0) { Process.Start(""magnify.exe""); System.Threading.Thread.Sleep(500); } IntPtr handle = Process.GetProcesses().Where(p => p.ProcessName.ToLower() == ""magnify"").First().Handle; // Figure out what size (""mode"") it's in WINDOWPLACEMENT placement = new WINDOWPLACEMENT(); placement.length = Marshal.SizeOf(placement); GetWindowPlacement(handle, ref placement); // Move the Magnifier to a predetermined location so we know where to click MoveWindow(handle, new Point(0, 0)); // If Magnifier is in small mode, click it to put it in big mode. if (placement.rcNormalPosition.Size.Width == 132) { SetCursorPos(15, 15); mouse_event((int)HardwareEvents.MouseLeftDown, 15, 15, 0, 0); mouse_event((int)HardwareEvents.MouseLeftUp, 15, 15, 0, 0); } // Click the zoom in button. Yeah, I know, hackish. Isn't Win32 awesome? SetCursorPos(25, 25); mouse_event((int)HardwareEvents.MouseLeftDown, 25, 25, 0, 0); mouse_event((int)HardwareEvents.MouseLeftUp, 25, 25, 0, 0);}private void MoveWindow(IntPtr handle, Point point){ // TODO: Figure out how to look up the target window's size SetWindowPos(handle, new IntPtr((int)SpecialWindowHandles.HWND_TOP), (int)point.X, (int)point.Y, 500, 500, SetWindowPosFlags.ShowWindow); }private struct WINDOWPLACEMENT { public int length; public int flags; public int showCmd; public System.Drawing.Point ptMinPosition; public System.Drawing.Point ptMaxPosition; public System.Drawing.Rectangle rcNormalPosition; }[DllImport(""user32.dll"")]static extern bool GetWindowPlacement(IntPtr hWnd, ref WINDOWPLACEMENT lpwndl);[DllImport(""user32.dll"")]static extern bool SetCursorPos(int X, int Y);public static class HardwareEvents{ public static int MouseMove = 0x0001; public static int MouseLeftDown = 0x0002, MouseLeftUp = 0x0004; public static int MouseRightDown = 0x0008, MouseRightUp = 0x0010; // best guess on the 0010 public static int MiddleMouseDown = 0x20, MiddleMouseUp = 0x40; public static int MouseWheel = 0x800;}",Invoke Windows Magnifier
How to force Resharper run test fixtures sequentially?," I have several suites of integration tests implemented in C#/NUNit. Each test suite is a separate class, each fixture setup creates and populates a SQL Server database from scripts. This all used to work just fine prior to Resharper 5.1.Unfortunately, Resharper 5.1 begins to run several fixtures at the same time. This is a breaking change - they are all attempting to create and populate the same database, which obviously ends up in an mess. Is there any way I could have Resharper run my test fixtures serially?If not, what would you suggest to run my NUnit test fixtures serially, one fixture at a time?The order in which individual tests run does not matter. <code> ",How to run NUnit test fixtures serially?
Convert XLS to XLSB Programatically?," I have a customer that needs to convert XLS files to XLSB. Has anyone done this programmatically, (with or without an add-on --- doesn't matter --- just need to be able to automate it)? I'm looking for a way to automate this.As a side note, the customer is asking about this because they use Sharepoint, and it seems it has a way to analyze XLSB files quicker and easier than XLS? I'm working to improve my Sharepoint knowledge, but in the meantime, I'm trying to find an answer to this XLSB issue. <code> ",Convert XLS to XLSB Programmatically?
c# getting ALL the properties of an object, i have object like this: this object has like 1000 properties.i would like to loop through every property like this: is there an easy way to do this? <code>  some_object foreach (property in some_object)//output the property,Getting ALL the properties of an object
The variable 'MyException' is declared but never used (C#), I need to clear this warning : The complier is telling me : The variable 'MyException' is declared but never usedHow can I fix this. <code>  try{ doSomething()}catch (AmbiguousMatchException MyException){ doSomethingElse()},The variable 'MyException' is declared but never used
Retain the user defined sort order of a WPF DataGrid, I have a WPF DataGrid that is populated with data from DataSet. I have CanUserSortColumns set to true.Is it possible to retain the sorting that the user specified when the grid is refreshed? I have it retaining the item that was selected using before the refresh takes place and then placing after the refresh takes place. But I can't seem to get it to retain the specified sort. <code>  object selectedItem = dgInvoiceHeads.SelectedItem; dgInvoiceHeads.SelectedItem = selectedItem;,Retain the user defined sort order in WPF DataGrid
C#: How to cast object[] to a more specifically typed array," This would be pretty straight forward if I knew the types at compile time or if it was a generic parameter, because I could do something like myArray.Cast<T>() But what I actually have is essentially this. I do not have a known type or generic parameter. I have a System.Type variable. Is there some kind of reflection magic I can do to get a string[] reference containing the same data? (where string isn't known at compile time) <code>  // could actually be anything elseType myType = typeof(string); // i already know all the elements are the correct typesobject[] myArray = new object[] { ""foo"", ""bar"" }; ",How to convert object[] to a more specifically typed array
C#: How to convert object[] to a more specifically typed array," This would be pretty straight forward if I knew the types at compile time or if it was a generic parameter, because I could do something like myArray.Cast<T>() But what I actually have is essentially this. I do not have a known type or generic parameter. I have a System.Type variable. Is there some kind of reflection magic I can do to get a string[] reference containing the same data? (where string isn't known at compile time) <code>  // could actually be anything elseType myType = typeof(string); // i already know all the elements are the correct typesobject[] myArray = new object[] { ""foo"", ""bar"" }; ",How to convert object[] to a more specifically typed array
"Widows Phone 7, login screen redirect and a case for .exit?"," I know this has been discussed ad nauseum, but I want to present my case....My start page in my app is login.xaml. The user logs in, the username and password are authenticated through my WCF service, the username is saved in isolated storage, and then the user is redirected to mainpage.xaml.When a user starts my app, and they already have a saved username in isolated storage, they are redirected to mainpage.xamlIf the user hits ""back"" hard button from mainpage.xaml, this redirects to the login screen, which in turn redirects them back to the mainpage.xaml since they already have a saved local username. This is causing my app to fail certification currently since the user cannot hit the ""back"" button to exit the app from mainpage.xaml.My instinct here is to override the BackKeyPress in mainpage.xaml and exit the app somehow. By reading the other posts, I can see that this method is not available. My second idea was to somehow store a property in the app.xaml.cs page that would tell the app to exit when the login page is loaded and that property is set to true, but that seems a bit hacky as well....Any ideas here? UPDATE SOLUTION USED:What ended up working was to make the login page a pivot item inside mainpage.xaml. When a user opened the app without being logged in, the currently selected pivot item would change to the login pivot item. If the user opened the app and WAS logged in, the normal pivot item would be selected.  <code> ","Windows Phone 7, login screen redirect and a case for .exit?"
More than one important path for C# Process," In a project I'm currently working on, I am starting an external process. However, the external process is the EXE of a complex program which loads current-user information from a user folder. The desktop shortcut for the program resolves the matter by setting the ""Target:"" parameter to X:\exepath\prgm.exe and setting the ""Start In"" parameter to the user's path, X:\exepath\users\username.I currently launch the process like this: However, when the process is started, the program it launches ends up looking for all resources in the WorkingDirectory instead of pulling user content from that folder and all other content from the directory the EXE resides in. This suggests that Working Directory and the system shortcut ""Start In:"" parameter behave differently.Is there any way to mimic that behavior with a C# Process? Alternatively, is it possible to create a shortcut in C#, which I could then start with my Process invocation?Please let me know if more info would be helpful.EDIT - After some more trial and error, I decided to use WSH to create a shortcut and run it. WSH uses the name WorkingDirectory for the value of the ""Start In:"" parameter. It behaves identically under the hood as the execution of the process in my code above. I am still getting the error. <code>  Process p = new Process();p.StartInfo = new ProcessStartInfo( ""X:\exepath\prgm.exe"" );p.StartInfo.WorkingDirectory = ""X:\exepath\users\username"";p.Start();while (!p.HasExited) { }",More than one important path for .NET Process
How Create Glossy Button in C# ?," I want create glossy buttons with GDI+ or Silverlight with C#, any ideas or trickery how to create a glossy button? Somethings like images below:I am interesting more in GDI+ solutions. <code> ",How create glossy button in C#?
"C# Stored Procedure doesn't exist, or does it?"," I'm having a problem:I have a db connection where I run stored procedures on. This same connection is used to create said stored procedures earlier on.When I attempt to call a given stored procedure, later on, I get the following message: Could not find stored procedure 'dbo.yaf_prov_upgrade'.The problem is it actually does exist on the database. And there's also the fact that it shows up on the SQL Server Profiler. RPC:Completed exec [dbo].[yaf_prov_upgrade] @PreviousVersion=46,@NewVersion=46 .Net SqlClient Data Provider Nico Matrix\NicoI was wondering what could be the causes a particular query would throw such an exception even when it exists, it's called, and the call reaches the database.It can't be a problem with the connection because it already executed other stored procedures. It can't be a problem with the procedure because it does exist, in fact the very same application, the very same web page, created it and put it there.Update: forgot to mention I'm used integrated security, and I did run the SP on the database with the same user the application connects with, and I had no problem running it.So what can it be? <code> ","Stored Procedure doesn't exist, or does it?"
[ODBC Driver Manager] Data source name not found and no default driver specified," I have been asked to port a WinForms app that uses the MVP pattern over to a webpage. The app, amongst other things, uploads a CSV file to a DataTable and then does some work.The CSV file is uploaded to the server OK and then read with the following code at this point I get the error: ERROR [IM002] [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specifiedNow the code works fine in WinForms but fails on the web. Is there something I need to change in IIS, my config file or something else to get this code to work? Or is there something more fundamental I need to do?UpdateOK so I worked out what was different between my two code versions: The WinForms version was running as 32-bit, as soon as I changed it to 64-bit it threw the same error. See:32-bit Text drivers (Microsoft Access , Microsoft Excel and Text files ) from a 64 bit application on windows 7To fix things I installed the Access 64-bit drivers from http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=13255 but I still get the same error.If I check my ODBC Data Source Administrator I can see ""Microsoft Access Text Driver (*.txt, *.csv) | 14.00.47600.1000 | Microsoft Corporation | ACEODBC.dllSo it looks like they're installed OK, so why would it still be failing? <code>  string connectionString = @""Driver={Microsoft Text Driver (*.txt; *.csv)};Extensions=asc,csv,tab,txt;Persist Security Info=False;Dbq=C:\Temp\"";//check that file exists and in correct formatif (File.Exists(this.WorkingFileName)){ using (OdbcConnection connection = new OdbcConnection(connectionString)) { // Determine number of rows string selectCount = ""select count(*) from [MyFile.csv]""); using (OdbcCommand command = new OdbcCommand(selectCount, connection)) { connection.Open(); } }}",Data source name not found and no default driver specified
"C++ dll/C# ""Exception from HRESULT: 0x800700C1"""," I have 3 projects in one solution.I have :a native C++ dll,a C# Winform,and a proxy C++/CLI without pure mode to do the link between the 2 others projects (and use the native function in the managed code in C#)So when I launch the application all work. But when I push the button ""Generer"" in my winform wich execute the function NativeMethod::Test() of the C++/CLI that it crash and I have this pop-up message :An unhandled exception of type'System.BadImageFormatException'occurred in System.Windows.Forms.dllAdditional information: Could not loadfile or assembly'EngineInterfaceWrapper.dll' or one ofits dependencies. n'est pas uneapplication Win32 valide. (Exceptionfrom HRESULT: 0x800700C1)When I go in project proprieties in Conf. Properties -> Linker -> Advanced : Target Machine, it's set with the value ""MachineX86"" for my C++ native and managed DLL and my WinForm is in X86 too. I tired many configurations but it don't work.Edit:The problem is may be the header ""TradeEngine.h"""" in the C++/CLI header : EngineInterfaceWrapper.h. Because when I unlink the native C++ Dll (and deleting all code in the CLI wrapper) if I build the solution it will work but if ""#include ""TradeEngine.h"""" is always in the CLI header, I will have the same error. Do you have an idea?Code :native C++TradeEngine.h TradeEngine.cpp C++/CLIEngineInterfaceWrapper.h EngineInterfaceWrapper.cpp C# WinformProgram.cs Form1.csgenerer_Click() is the event launched by the button when the user click on Generer. How can I fix that? If you need more info, tell me. <code>  #ifdef TRADEENGINE_EXPORTS#define SYMBOL_DECLSPEC __declspec(dllexport)#define SYMBOL_DEF#else#define SYMBOL_DECLSPEC __declspec(dllimport)#define SYMBOL_DEF __declspec(dllimport)#endifEXTERN_C SYMBOL_DECLSPEC void __stdcall Test(void); SYMBOL_DECLSPEC void __stdcall Test(void){} #pragma once#include ""TradeEngine.h""using namespace System;using namespace System::Runtime::InteropServices;namespace EngineInterfaceWrapper { public ref class NativeMethod { public: static void AjoutColonneDifferenceCourtClotureOuvertureReelle(void); static void Test(); };} #pragma region Includes#include ""stdafx.h""#include ""EngineInterfaceWrapper.h""using namespace EngineInterfaceWrapper;#include <msclr/marshal.h>using namespace msclr::interop;#pragma endregionvoid NativeMethod::Test(){ ::Test();} namespace TradeInterface{ static class Program { /// <summary> /// The main entry point for the application. /// </summary> [STAThread] static void Main() { Application.EnableVisualStyles(); Application.SetCompatibleTextRenderingDefault(false); Application.Run(new Form1()); } }} using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Windows.Forms;using System.Runtime.InteropServices;using EngineInterfaceWrapper;namespace TradeInterface{ public partial class Form1 : Form { public Form1() { InitializeComponent(); } private void generer_Click(object sender, EventArgs e) { NativeMethod.Test(); } }}",C++/CLI Dll with C# interop issue
C++ dll/C# Platform problem," I have 3 projects in one solution.I have :a native C++ dll,a C# Winform,and a proxy C++/CLI without pure mode to do the link between the 2 others projects (and use the native function in the managed code in C#)So when I launch the application all work. But when I push the button ""Generer"" in my winform wich execute the function NativeMethod::Test() of the C++/CLI that it crash and I have this pop-up message :An unhandled exception of type'System.BadImageFormatException'occurred in System.Windows.Forms.dllAdditional information: Could not loadfile or assembly'EngineInterfaceWrapper.dll' or one ofits dependencies. n'est pas uneapplication Win32 valide. (Exceptionfrom HRESULT: 0x800700C1)When I go in project proprieties in Conf. Properties -> Linker -> Advanced : Target Machine, it's set with the value ""MachineX86"" for my C++ native and managed DLL and my WinForm is in X86 too. I tired many configurations but it don't work.Edit:The problem is may be the header ""TradeEngine.h"""" in the C++/CLI header : EngineInterfaceWrapper.h. Because when I unlink the native C++ Dll (and deleting all code in the CLI wrapper) if I build the solution it will work but if ""#include ""TradeEngine.h"""" is always in the CLI header, I will have the same error. Do you have an idea?Code :native C++TradeEngine.h TradeEngine.cpp C++/CLIEngineInterfaceWrapper.h EngineInterfaceWrapper.cpp C# WinformProgram.cs Form1.csgenerer_Click() is the event launched by the button when the user click on Generer. How can I fix that? If you need more info, tell me. <code>  #ifdef TRADEENGINE_EXPORTS#define SYMBOL_DECLSPEC __declspec(dllexport)#define SYMBOL_DEF#else#define SYMBOL_DECLSPEC __declspec(dllimport)#define SYMBOL_DEF __declspec(dllimport)#endifEXTERN_C SYMBOL_DECLSPEC void __stdcall Test(void); SYMBOL_DECLSPEC void __stdcall Test(void){} #pragma once#include ""TradeEngine.h""using namespace System;using namespace System::Runtime::InteropServices;namespace EngineInterfaceWrapper { public ref class NativeMethod { public: static void AjoutColonneDifferenceCourtClotureOuvertureReelle(void); static void Test(); };} #pragma region Includes#include ""stdafx.h""#include ""EngineInterfaceWrapper.h""using namespace EngineInterfaceWrapper;#include <msclr/marshal.h>using namespace msclr::interop;#pragma endregionvoid NativeMethod::Test(){ ::Test();} namespace TradeInterface{ static class Program { /// <summary> /// The main entry point for the application. /// </summary> [STAThread] static void Main() { Application.EnableVisualStyles(); Application.SetCompatibleTextRenderingDefault(false); Application.Run(new Form1()); } }} using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Windows.Forms;using System.Runtime.InteropServices;using EngineInterfaceWrapper;namespace TradeInterface{ public partial class Form1 : Form { public Form1() { InitializeComponent(); } private void generer_Click(object sender, EventArgs e) { NativeMethod.Test(); } }}",C++/CLI Dll with C# interop issue
Platform problem," I have 3 projects in one solution.I have :a native C++ dll,a C# Winform,and a proxy C++/CLI without pure mode to do the link between the 2 others projects (and use the native function in the managed code in C#)So when I launch the application all work. But when I push the button ""Generer"" in my winform wich execute the function NativeMethod::Test() of the C++/CLI that it crash and I have this pop-up message :An unhandled exception of type'System.BadImageFormatException'occurred in System.Windows.Forms.dllAdditional information: Could not loadfile or assembly'EngineInterfaceWrapper.dll' or one ofits dependencies. n'est pas uneapplication Win32 valide. (Exceptionfrom HRESULT: 0x800700C1)When I go in project proprieties in Conf. Properties -> Linker -> Advanced : Target Machine, it's set with the value ""MachineX86"" for my C++ native and managed DLL and my WinForm is in X86 too. I tired many configurations but it don't work.Edit:The problem is may be the header ""TradeEngine.h"""" in the C++/CLI header : EngineInterfaceWrapper.h. Because when I unlink the native C++ Dll (and deleting all code in the CLI wrapper) if I build the solution it will work but if ""#include ""TradeEngine.h"""" is always in the CLI header, I will have the same error. Do you have an idea?Code :native C++TradeEngine.h TradeEngine.cpp C++/CLIEngineInterfaceWrapper.h EngineInterfaceWrapper.cpp C# WinformProgram.cs Form1.csgenerer_Click() is the event launched by the button when the user click on Generer. How can I fix that? If you need more info, tell me. <code>  #ifdef TRADEENGINE_EXPORTS#define SYMBOL_DECLSPEC __declspec(dllexport)#define SYMBOL_DEF#else#define SYMBOL_DECLSPEC __declspec(dllimport)#define SYMBOL_DEF __declspec(dllimport)#endifEXTERN_C SYMBOL_DECLSPEC void __stdcall Test(void); SYMBOL_DECLSPEC void __stdcall Test(void){} #pragma once#include ""TradeEngine.h""using namespace System;using namespace System::Runtime::InteropServices;namespace EngineInterfaceWrapper { public ref class NativeMethod { public: static void AjoutColonneDifferenceCourtClotureOuvertureReelle(void); static void Test(); };} #pragma region Includes#include ""stdafx.h""#include ""EngineInterfaceWrapper.h""using namespace EngineInterfaceWrapper;#include <msclr/marshal.h>using namespace msclr::interop;#pragma endregionvoid NativeMethod::Test(){ ::Test();} namespace TradeInterface{ static class Program { /// <summary> /// The main entry point for the application. /// </summary> [STAThread] static void Main() { Application.EnableVisualStyles(); Application.SetCompatibleTextRenderingDefault(false); Application.Run(new Form1()); } }} using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Windows.Forms;using System.Runtime.InteropServices;using EngineInterfaceWrapper;namespace TradeInterface{ public partial class Form1 : Form { public Form1() { InitializeComponent(); } private void generer_Click(object sender, EventArgs e) { NativeMethod.Test(); } }}",C++/CLI Dll with C# interop issue
Platform problem x86?," I have 3 projects in one solution.I have :a native C++ dll,a C# Winform,and a proxy C++/CLI without pure mode to do the link between the 2 others projects (and use the native function in the managed code in C#)So when I launch the application all work. But when I push the button ""Generer"" in my winform wich execute the function NativeMethod::Test() of the C++/CLI that it crash and I have this pop-up message :An unhandled exception of type'System.BadImageFormatException'occurred in System.Windows.Forms.dllAdditional information: Could not loadfile or assembly'EngineInterfaceWrapper.dll' or one ofits dependencies. n'est pas uneapplication Win32 valide. (Exceptionfrom HRESULT: 0x800700C1)When I go in project proprieties in Conf. Properties -> Linker -> Advanced : Target Machine, it's set with the value ""MachineX86"" for my C++ native and managed DLL and my WinForm is in X86 too. I tired many configurations but it don't work.Edit:The problem is may be the header ""TradeEngine.h"""" in the C++/CLI header : EngineInterfaceWrapper.h. Because when I unlink the native C++ Dll (and deleting all code in the CLI wrapper) if I build the solution it will work but if ""#include ""TradeEngine.h"""" is always in the CLI header, I will have the same error. Do you have an idea?Code :native C++TradeEngine.h TradeEngine.cpp C++/CLIEngineInterfaceWrapper.h EngineInterfaceWrapper.cpp C# WinformProgram.cs Form1.csgenerer_Click() is the event launched by the button when the user click on Generer. How can I fix that? If you need more info, tell me. <code>  #ifdef TRADEENGINE_EXPORTS#define SYMBOL_DECLSPEC __declspec(dllexport)#define SYMBOL_DEF#else#define SYMBOL_DECLSPEC __declspec(dllimport)#define SYMBOL_DEF __declspec(dllimport)#endifEXTERN_C SYMBOL_DECLSPEC void __stdcall Test(void); SYMBOL_DECLSPEC void __stdcall Test(void){} #pragma once#include ""TradeEngine.h""using namespace System;using namespace System::Runtime::InteropServices;namespace EngineInterfaceWrapper { public ref class NativeMethod { public: static void AjoutColonneDifferenceCourtClotureOuvertureReelle(void); static void Test(); };} #pragma region Includes#include ""stdafx.h""#include ""EngineInterfaceWrapper.h""using namespace EngineInterfaceWrapper;#include <msclr/marshal.h>using namespace msclr::interop;#pragma endregionvoid NativeMethod::Test(){ ::Test();} namespace TradeInterface{ static class Program { /// <summary> /// The main entry point for the application. /// </summary> [STAThread] static void Main() { Application.EnableVisualStyles(); Application.SetCompatibleTextRenderingDefault(false); Application.Run(new Form1()); } }} using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Windows.Forms;using System.Runtime.InteropServices;using EngineInterfaceWrapper;namespace TradeInterface{ public partial class Form1 : Form { public Form1() { InitializeComponent(); } private void generer_Click(object sender, EventArgs e) { NativeMethod.Test(); } }}",C++/CLI Dll with C# interop issue
managed C++ Dll / C# problem," I have 3 projects in one solution.I have :a native C++ dll,a C# Winform,and a proxy C++/CLI without pure mode to do the link between the 2 others projects (and use the native function in the managed code in C#)So when I launch the application all work. But when I push the button ""Generer"" in my winform wich execute the function NativeMethod::Test() of the C++/CLI that it crash and I have this pop-up message :An unhandled exception of type'System.BadImageFormatException'occurred in System.Windows.Forms.dllAdditional information: Could not loadfile or assembly'EngineInterfaceWrapper.dll' or one ofits dependencies. n'est pas uneapplication Win32 valide. (Exceptionfrom HRESULT: 0x800700C1)When I go in project proprieties in Conf. Properties -> Linker -> Advanced : Target Machine, it's set with the value ""MachineX86"" for my C++ native and managed DLL and my WinForm is in X86 too. I tired many configurations but it don't work.Edit:The problem is may be the header ""TradeEngine.h"""" in the C++/CLI header : EngineInterfaceWrapper.h. Because when I unlink the native C++ Dll (and deleting all code in the CLI wrapper) if I build the solution it will work but if ""#include ""TradeEngine.h"""" is always in the CLI header, I will have the same error. Do you have an idea?Code :native C++TradeEngine.h TradeEngine.cpp C++/CLIEngineInterfaceWrapper.h EngineInterfaceWrapper.cpp C# WinformProgram.cs Form1.csgenerer_Click() is the event launched by the button when the user click on Generer. How can I fix that? If you need more info, tell me. <code>  #ifdef TRADEENGINE_EXPORTS#define SYMBOL_DECLSPEC __declspec(dllexport)#define SYMBOL_DEF#else#define SYMBOL_DECLSPEC __declspec(dllimport)#define SYMBOL_DEF __declspec(dllimport)#endifEXTERN_C SYMBOL_DECLSPEC void __stdcall Test(void); SYMBOL_DECLSPEC void __stdcall Test(void){} #pragma once#include ""TradeEngine.h""using namespace System;using namespace System::Runtime::InteropServices;namespace EngineInterfaceWrapper { public ref class NativeMethod { public: static void AjoutColonneDifferenceCourtClotureOuvertureReelle(void); static void Test(); };} #pragma region Includes#include ""stdafx.h""#include ""EngineInterfaceWrapper.h""using namespace EngineInterfaceWrapper;#include <msclr/marshal.h>using namespace msclr::interop;#pragma endregionvoid NativeMethod::Test(){ ::Test();} namespace TradeInterface{ static class Program { /// <summary> /// The main entry point for the application. /// </summary> [STAThread] static void Main() { Application.EnableVisualStyles(); Application.SetCompatibleTextRenderingDefault(false); Application.Run(new Form1()); } }} using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Windows.Forms;using System.Runtime.InteropServices;using EngineInterfaceWrapper;namespace TradeInterface{ public partial class Form1 : Form { public Form1() { InitializeComponent(); } private void generer_Click(object sender, EventArgs e) { NativeMethod.Test(); } }}",C++/CLI Dll with C# interop issue
C++ Dll / C# interfacing problem ," I have 3 projects in one solution.I have :a native C++ dll,a C# Winform,and a proxy C++/CLI without pure mode to do the link between the 2 others projects (and use the native function in the managed code in C#)So when I launch the application all work. But when I push the button ""Generer"" in my winform wich execute the function NativeMethod::Test() of the C++/CLI that it crash and I have this pop-up message :An unhandled exception of type'System.BadImageFormatException'occurred in System.Windows.Forms.dllAdditional information: Could not loadfile or assembly'EngineInterfaceWrapper.dll' or one ofits dependencies. n'est pas uneapplication Win32 valide. (Exceptionfrom HRESULT: 0x800700C1)When I go in project proprieties in Conf. Properties -> Linker -> Advanced : Target Machine, it's set with the value ""MachineX86"" for my C++ native and managed DLL and my WinForm is in X86 too. I tired many configurations but it don't work.Edit:The problem is may be the header ""TradeEngine.h"""" in the C++/CLI header : EngineInterfaceWrapper.h. Because when I unlink the native C++ Dll (and deleting all code in the CLI wrapper) if I build the solution it will work but if ""#include ""TradeEngine.h"""" is always in the CLI header, I will have the same error. Do you have an idea?Code :native C++TradeEngine.h TradeEngine.cpp C++/CLIEngineInterfaceWrapper.h EngineInterfaceWrapper.cpp C# WinformProgram.cs Form1.csgenerer_Click() is the event launched by the button when the user click on Generer. How can I fix that? If you need more info, tell me. <code>  #ifdef TRADEENGINE_EXPORTS#define SYMBOL_DECLSPEC __declspec(dllexport)#define SYMBOL_DEF#else#define SYMBOL_DECLSPEC __declspec(dllimport)#define SYMBOL_DEF __declspec(dllimport)#endifEXTERN_C SYMBOL_DECLSPEC void __stdcall Test(void); SYMBOL_DECLSPEC void __stdcall Test(void){} #pragma once#include ""TradeEngine.h""using namespace System;using namespace System::Runtime::InteropServices;namespace EngineInterfaceWrapper { public ref class NativeMethod { public: static void AjoutColonneDifferenceCourtClotureOuvertureReelle(void); static void Test(); };} #pragma region Includes#include ""stdafx.h""#include ""EngineInterfaceWrapper.h""using namespace EngineInterfaceWrapper;#include <msclr/marshal.h>using namespace msclr::interop;#pragma endregionvoid NativeMethod::Test(){ ::Test();} namespace TradeInterface{ static class Program { /// <summary> /// The main entry point for the application. /// </summary> [STAThread] static void Main() { Application.EnableVisualStyles(); Application.SetCompatibleTextRenderingDefault(false); Application.Run(new Form1()); } }} using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Windows.Forms;using System.Runtime.InteropServices;using EngineInterfaceWrapper;namespace TradeInterface{ public partial class Form1 : Form { public Form1() { InitializeComponent(); } private void generer_Click(object sender, EventArgs e) { NativeMethod.Test(); } }}",C++/CLI Dll with C# interop issue
Connection problem between my Dll and the prog," I have 3 projects in one solution.I have :a native C++ dll,a C# Winform,and a proxy C++/CLI without pure mode to do the link between the 2 others projects (and use the native function in the managed code in C#)So when I launch the application all work. But when I push the button ""Generer"" in my winform wich execute the function NativeMethod::Test() of the C++/CLI that it crash and I have this pop-up message :An unhandled exception of type'System.BadImageFormatException'occurred in System.Windows.Forms.dllAdditional information: Could not loadfile or assembly'EngineInterfaceWrapper.dll' or one ofits dependencies. n'est pas uneapplication Win32 valide. (Exceptionfrom HRESULT: 0x800700C1)When I go in project proprieties in Conf. Properties -> Linker -> Advanced : Target Machine, it's set with the value ""MachineX86"" for my C++ native and managed DLL and my WinForm is in X86 too. I tired many configurations but it don't work.Edit:The problem is may be the header ""TradeEngine.h"""" in the C++/CLI header : EngineInterfaceWrapper.h. Because when I unlink the native C++ Dll (and deleting all code in the CLI wrapper) if I build the solution it will work but if ""#include ""TradeEngine.h"""" is always in the CLI header, I will have the same error. Do you have an idea?Code :native C++TradeEngine.h TradeEngine.cpp C++/CLIEngineInterfaceWrapper.h EngineInterfaceWrapper.cpp C# WinformProgram.cs Form1.csgenerer_Click() is the event launched by the button when the user click on Generer. How can I fix that? If you need more info, tell me. <code>  #ifdef TRADEENGINE_EXPORTS#define SYMBOL_DECLSPEC __declspec(dllexport)#define SYMBOL_DEF#else#define SYMBOL_DECLSPEC __declspec(dllimport)#define SYMBOL_DEF __declspec(dllimport)#endifEXTERN_C SYMBOL_DECLSPEC void __stdcall Test(void); SYMBOL_DECLSPEC void __stdcall Test(void){} #pragma once#include ""TradeEngine.h""using namespace System;using namespace System::Runtime::InteropServices;namespace EngineInterfaceWrapper { public ref class NativeMethod { public: static void AjoutColonneDifferenceCourtClotureOuvertureReelle(void); static void Test(); };} #pragma region Includes#include ""stdafx.h""#include ""EngineInterfaceWrapper.h""using namespace EngineInterfaceWrapper;#include <msclr/marshal.h>using namespace msclr::interop;#pragma endregionvoid NativeMethod::Test(){ ::Test();} namespace TradeInterface{ static class Program { /// <summary> /// The main entry point for the application. /// </summary> [STAThread] static void Main() { Application.EnableVisualStyles(); Application.SetCompatibleTextRenderingDefault(false); Application.Run(new Form1()); } }} using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Windows.Forms;using System.Runtime.InteropServices;using EngineInterfaceWrapper;namespace TradeInterface{ public partial class Form1 : Form { public Form1() { InitializeComponent(); } private void generer_Click(object sender, EventArgs e) { NativeMethod.Test(); } }}",C++/CLI Dll with C# interop issue
C++/CLI Dll/C# Connection problem," I have 3 projects in one solution.I have :a native C++ dll,a C# Winform,and a proxy C++/CLI without pure mode to do the link between the 2 others projects (and use the native function in the managed code in C#)So when I launch the application all work. But when I push the button ""Generer"" in my winform wich execute the function NativeMethod::Test() of the C++/CLI that it crash and I have this pop-up message :An unhandled exception of type'System.BadImageFormatException'occurred in System.Windows.Forms.dllAdditional information: Could not loadfile or assembly'EngineInterfaceWrapper.dll' or one ofits dependencies. n'est pas uneapplication Win32 valide. (Exceptionfrom HRESULT: 0x800700C1)When I go in project proprieties in Conf. Properties -> Linker -> Advanced : Target Machine, it's set with the value ""MachineX86"" for my C++ native and managed DLL and my WinForm is in X86 too. I tired many configurations but it don't work.Edit:The problem is may be the header ""TradeEngine.h"""" in the C++/CLI header : EngineInterfaceWrapper.h. Because when I unlink the native C++ Dll (and deleting all code in the CLI wrapper) if I build the solution it will work but if ""#include ""TradeEngine.h"""" is always in the CLI header, I will have the same error. Do you have an idea?Code :native C++TradeEngine.h TradeEngine.cpp C++/CLIEngineInterfaceWrapper.h EngineInterfaceWrapper.cpp C# WinformProgram.cs Form1.csgenerer_Click() is the event launched by the button when the user click on Generer. How can I fix that? If you need more info, tell me. <code>  #ifdef TRADEENGINE_EXPORTS#define SYMBOL_DECLSPEC __declspec(dllexport)#define SYMBOL_DEF#else#define SYMBOL_DECLSPEC __declspec(dllimport)#define SYMBOL_DEF __declspec(dllimport)#endifEXTERN_C SYMBOL_DECLSPEC void __stdcall Test(void); SYMBOL_DECLSPEC void __stdcall Test(void){} #pragma once#include ""TradeEngine.h""using namespace System;using namespace System::Runtime::InteropServices;namespace EngineInterfaceWrapper { public ref class NativeMethod { public: static void AjoutColonneDifferenceCourtClotureOuvertureReelle(void); static void Test(); };} #pragma region Includes#include ""stdafx.h""#include ""EngineInterfaceWrapper.h""using namespace EngineInterfaceWrapper;#include <msclr/marshal.h>using namespace msclr::interop;#pragma endregionvoid NativeMethod::Test(){ ::Test();} namespace TradeInterface{ static class Program { /// <summary> /// The main entry point for the application. /// </summary> [STAThread] static void Main() { Application.EnableVisualStyles(); Application.SetCompatibleTextRenderingDefault(false); Application.Run(new Form1()); } }} using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Windows.Forms;using System.Runtime.InteropServices;using EngineInterfaceWrapper;namespace TradeInterface{ public partial class Form1 : Form { public Form1() { InitializeComponent(); } private void generer_Click(object sender, EventArgs e) { NativeMethod.Test(); } }}",C++/CLI Dll with C# interop issue
C++/CLI Dll with C# Connection problem," I have 3 projects in one solution.I have :a native C++ dll,a C# Winform,and a proxy C++/CLI without pure mode to do the link between the 2 others projects (and use the native function in the managed code in C#)So when I launch the application all work. But when I push the button ""Generer"" in my winform wich execute the function NativeMethod::Test() of the C++/CLI that it crash and I have this pop-up message :An unhandled exception of type'System.BadImageFormatException'occurred in System.Windows.Forms.dllAdditional information: Could not loadfile or assembly'EngineInterfaceWrapper.dll' or one ofits dependencies. n'est pas uneapplication Win32 valide. (Exceptionfrom HRESULT: 0x800700C1)When I go in project proprieties in Conf. Properties -> Linker -> Advanced : Target Machine, it's set with the value ""MachineX86"" for my C++ native and managed DLL and my WinForm is in X86 too. I tired many configurations but it don't work.Edit:The problem is may be the header ""TradeEngine.h"""" in the C++/CLI header : EngineInterfaceWrapper.h. Because when I unlink the native C++ Dll (and deleting all code in the CLI wrapper) if I build the solution it will work but if ""#include ""TradeEngine.h"""" is always in the CLI header, I will have the same error. Do you have an idea?Code :native C++TradeEngine.h TradeEngine.cpp C++/CLIEngineInterfaceWrapper.h EngineInterfaceWrapper.cpp C# WinformProgram.cs Form1.csgenerer_Click() is the event launched by the button when the user click on Generer. How can I fix that? If you need more info, tell me. <code>  #ifdef TRADEENGINE_EXPORTS#define SYMBOL_DECLSPEC __declspec(dllexport)#define SYMBOL_DEF#else#define SYMBOL_DECLSPEC __declspec(dllimport)#define SYMBOL_DEF __declspec(dllimport)#endifEXTERN_C SYMBOL_DECLSPEC void __stdcall Test(void); SYMBOL_DECLSPEC void __stdcall Test(void){} #pragma once#include ""TradeEngine.h""using namespace System;using namespace System::Runtime::InteropServices;namespace EngineInterfaceWrapper { public ref class NativeMethod { public: static void AjoutColonneDifferenceCourtClotureOuvertureReelle(void); static void Test(); };} #pragma region Includes#include ""stdafx.h""#include ""EngineInterfaceWrapper.h""using namespace EngineInterfaceWrapper;#include <msclr/marshal.h>using namespace msclr::interop;#pragma endregionvoid NativeMethod::Test(){ ::Test();} namespace TradeInterface{ static class Program { /// <summary> /// The main entry point for the application. /// </summary> [STAThread] static void Main() { Application.EnableVisualStyles(); Application.SetCompatibleTextRenderingDefault(false); Application.Run(new Form1()); } }} using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Windows.Forms;using System.Runtime.InteropServices;using EngineInterfaceWrapper;namespace TradeInterface{ public partial class Form1 : Form { public Form1() { InitializeComponent(); } private void generer_Click(object sender, EventArgs e) { NativeMethod.Test(); } }}",C++/CLI Dll with C# interop issue
How to programatically set the Image source," When the Image's Source property is set the following way, the picture is taken from /Images/down.png.How would I do the same thing programmatically? The following would not work, since Image.Source property is not of a string type. <code>  <Image x:Name=""myImg"" Source=""/MyProject;component/Images/down.png"" /> myImg.Source = ""/MyProject;component/Images/down.png""; ",How to programmatically set the Image source
how to ignore a property in class if it is null using json.net?," I am using Json.NET to serialize a class to JSON.I have the class like this: I want to add a JsonIgnore() attribute to Test2List property only when Test2List is null. If it is not null then I want to include it in my json. <code>  class Test1{ [JsonProperty(""id"")] public string ID { get; set; } [JsonProperty(""label"")] public string Label { get; set; } [JsonProperty(""url"")] public string URL { get; set; } [JsonProperty(""item"")] public List<Test2> Test2List { get; set; }}","How to ignore a property in class if null, using json.net"
Why does this C# assignment gives an exception?," This does not work: System.NullReferenceException : Object reference not set to an instance of an object.This works: Both compile fine in VS2010. <code>  public class A{ private string _a_string; public string AString { get { return _a_string; } set { _a_string = value; } }}public class B{ private string _b_string; private A _a; public A A { get { return _a; } set { _a = value; } } public string BString { get { return _b_string; } set { _b_string = value; } }} B _b = new B { A = { AString = ""aString"" }, BString = ""bString"" }; B _b = new B { A = new A { AString = ""aString"" }, BString = ""bString"" };",Why does this C# assignment throw an exception?
Asyncronous Invoking - Is EndInvoke required?," Possible Duplicates: Must every BeginInvoke be followed by an EndInvoke? Is EndInvoke() optional, sort-of optional, or definitely not optional? I've got a multithreaded application, and one of the secondary threads needs to get some code to execute on the main thread once every couple of minutes. There isn't any return value, and the second thread doesn't care if it raises any exceptions or fails to run.So far, I've been getting it to run the code via Form.Invoke, but it sometimes takes much longer than usual (a couple of seconds) and blocks the thread until it completes. I need the second thread to be able to continue execution without stalling for several seconds.BeginInvoke sounds like it'd do the job nicely, but I don't really have anywhere to call EndInvoke, since I don't want to wait for it or get a return value. And considering that the code being invoked involves a bunch of native calls, I'm not sure if its a good idea to not EndInvoke.Do I need to call EndInvoke at all, or is there some other way of getting code to run on the main form thread asyncronously that I should be using instead?Thanks =) <code> ",Asynchronous Invoking - Is EndInvoke required?
Get a an item from a IGrouping based on the highest date," In a IEnumerable<Appointment> that contains appointments defined as: which in practice can be like: This collection has to be downsized to a collection that contains only the appointments with the highest date LastModified of each distinct Name. I am a bit confused how to do this. When I tried: It seems to deliver the correct dates, but the whole entity is needed, what am I missing?. UPDATE/note: This is a large collection with about 10.000 unsorted items, delivered by a service I cannot modify. Each distinct group has about 20 elements. <code>  class Appointment{ public string Name { get; set; } public DateTime LastModified { get; set; } public bool IsCancelled { get; set; }} ""Jon S"" | 25-02-2011 16:14:40 | true""Jon S"" | 25-04-2011 22:15:44 | false""Marc G"" | 15-11-2011 16:09:00 | true""Marc G"" | 21-12-2011 16:11:00 | false""Marc G"" | 20-12-2011 16:24:00 | true""Eric L"" | 13-06-2011 19:10:00 | false""Reed C"" | 13-04-2011 09:10:00 | true""Reed C"" | 13-06-2011 19:10:00 | false""John G"" | 04-01-2011 06:12:00 | true""Jon S"" | 25-03-2011 12:24:42 | true ""Jon S"" | 25-04-2011 22:15:44 | false""Marc G"" | 21-12-2011 16:11:00 | false""Eric L"" | 13-06-2011 19:10:00 | false""Reed C"" | 13-06-2011 19:10:00 | false""John G"" | 04-01-2011 06:12:00 | true .GroupBy(n => n.Name) .Select(d => d.Max(t => t.LastModified));",Get an item from a IGrouping based on the highest date
mongodb c# driver - serialization of POCO references?," I'm researching MongoDB at the moment. It's my understanding that the official C# driver can perform serialization and deserialization of POCOs. What I haven't found information on yet is how a reference between two objects is serialized. [I'm talking about something that would be represented as two seperate documents, with ID links, rather than embeded documents.Can the serialization mechanism handle this kind of situation? (1): Or do we have to sacrifice some OOP, and do something like this? (2) : UPDATE:Just a couple of related questions then...a) If the serializer is able to handle situation (1). What is an example of how to do this without using embedding?b) If using embedding, would it be possible to query across all 'Things' regardless of whether they were 'parents' or embedded elements? How would such a query look like? <code>  class Thing { Guid Id {get; set;} string Name {get; set;} Thing RelatedThing {get; set;}} class Thing { Guid Id {get; set;} string Name {get; set;} Guid RelatedThing_ID {get; set;}}",MongoDB  C# driver - serialization of POCO references?
"C# Language Question: static class, protected member"," I'm reading the book ""C# Language"", and hit this note from Vladimir Reshetnikov: If a static class declares a protected or protected internal member, a compile-time error occurs (CS1057).May I know why? What's wrong with a static class having a protected member?Static class can have private member so I guess this CS1057 error is not due to accessibility, but maybe it's due to come compilation issue? as protected member could be overridden in child classes... but I couldn't figure out why. <code> ",Static class declaring a protected member
C# static class declaring a protected member," I'm reading the book ""C# Language"", and hit this note from Vladimir Reshetnikov: If a static class declares a protected or protected internal member, a compile-time error occurs (CS1057).May I know why? What's wrong with a static class having a protected member?Static class can have private member so I guess this CS1057 error is not due to accessibility, but maybe it's due to come compilation issue? as protected member could be overridden in child classes... but I couldn't figure out why. <code> ",Static class declaring a protected member
Resharper template for autoomatic INotifyPropertyChanged implementation," Is it possible to write code template or a snippet which will do following:I have a property declared like this: And I want reshaprer to automatically generate following: Just have read the http://koder.wordpress.com/2010/03/25/resharper-inotifypropertychanged/ article and have created new live template which can insert code for a new property like I want it to be. Is it possible to setup this template in such way, that it can appear in the Alt+Enter menu like a suggestion when cursor on the declaration of a property Like:  <code>  public string String1 {get;set;} private string _string1;public string String1{ get { return _string1; } set { if (_string1 != value) { _string1 = value; RaisePropertyChanged(() => String1); } }} {Access modifiers} **{Type} {Name}** {Possible get;set; statements}",Resharper template for automatic INotifyPropertyChanged implementation
WinForm Scrollviewr," I have an application in WPF that uses ScrollViewr and I want to port it to WinForms, is there an equivalent control for WinForms? Reason:WPF program is slow and I can't seem to learn how to render the program properly (GameOfLife).Code: <code>  <ScrollViewer Name=""displayPlaceHolder"" HorizontalScrollBarVisibility=""Auto""> <Canvas Name=""display"" MouseMove=""display_MouseMove"" MouseDown=""display_MouseDown"" Cursor=""Cross"" KeyDown=""global_KeyDown"" Focusable=""True"" /> </ScrollViewer>",WinForm ScrollViewer
MEF: Inherited Export & MetaData," I have an interface: I have a Meta attribute interface: and an attribute that implements it: I then have two classes: I then try to import the metrics ( i can see both in the cataloge)The following returns be MetricA AND MetricB However the following returns ONLY MetricB and NOT MetricA any idea why? (note the duplicate export on MetricB (it already has it from implementing IMetric))thanksDavid <code>  [InheritedExport(typeof(IMetric))]public interface IMetric { ... } public interface IMetricAttribute { ... } [MetadataAttribute][AttributeUsage(AttributeTargets.Class, AllowMultiple = false)]public class MetricAttribute : ExportAttribute, IMetricAttribute { public string MetricName { get; set; } public string MetricDescription { get; set; } public MetricAttribute(string name, string description) : base(typeof(MetricAttribute)) { this.MetricName = name; this.MetricDescription = description; }} [Metric(""MetricA"",""MetricA"")]public class MetricA: IMetric { ... }[Export(typeof(IMetric))] <<<< THIS IS IMPORTANT[Metric(""MetricB"", ""MetricB"")]public class MetricB: IMetric { ... } var metrics = compositionContainer.GetExports<IMetric>(); var metrics = compositionContainer.GetExports<IMetric, IMetricAttribute>();",How to use MEF Inherited Export & MetaData?
C# DLL Infection," Is it possible to inject a DLL file into a process such as explorer or svchost using C#? I know this is possible in C++ but is it in C#? If so would it matter how the DLL was written, e.g. would it differ betweeen a C++ DLL or a Visual Studio C# .NET DLL? If this is at all possible could someone post the code that I could use to do this. Thank you very much. <code> ",C# DLL Injection
How to avaoid Multiple Child forms shwon in MDIParent C# Win Forms," I want to avoid my child form from appearing many times when a user tries to open the child form which is already open in MDIParent. One way to avoid this is by disabling the Controller (in my case BUTTON) but I have given a shortcut key (Ctrl+L) for this function as well. So if the user types Ctrl+L, the same child Form opens and I can see two child forms are in MDI. I want to avoid this. How can I do this? In the image you can see that a child form Name Online Leads is opened twice as the user opened first time using Menu (LEADS) and second time by Shortcut key. I don't want this to happen. If the form is already opened it should avoid opening another same form ... How to do this? <code>  private void leadsToolStripMenuItem_Click(object sender, EventArgs e) { frmWebLeads formWeblead = new frmWebLeads(); formWeblead.MdiParent = this; formWeblead.WindowState = System.Windows.Forms.FormWindowState.Maximized; formWeblead.Show(); }",How to avoid Multiple Child forms shown in MDIParent C# Win Forms
Standart .NET Side-enum," I often use enums like or Every time I describe the enum again. Is there a standard enum of this kind in .NET? <code>  public enum Side { Left, Top, Right, Bottom }; public enum Direction { Left, Up, Right, Down };",Standard .NET side enum
C# start Windows Service programmatically," I am having an issue with an application that I am creating. I am trying to start a windows service through my C# app. When I click my start button, it looks like everything goes through but when I log into the server, the service still does not show that it is running. However, the second time I run it, I get an exception that says the instance of the service is already running. Again when I log into the server, the service appears to be stopped. Has anyone ever seen this?Here is my code. EDIT: Here is the exception I received on one service: System.InvalidOperationException: Service Logical Disk Manager Administrative Service was not found on computer '.'. ---> System.ComponentModel.Win32Exception: The specified service does not exist as an installed service --- End of inner exception stack traceI know the service exists. Do I need to add something in front of the service to tell it what server to look at? <code>  try{ while (reader.Read()) { int timeoutMilliseconds = 1000; string serviceName = reader[""ServiceName""].ToString(); string permission = reader[""Permission""].ToString(); if (permission == ""E"") { lblServStartSuccess.Visible = true; ServiceController service = new ServiceController(serviceName); TimeSpan timeout = TimeSpan.FromMilliseconds(timeoutMilliseconds); service.Start(); service.WaitForStatus(ServiceControllerStatus.Running, timeout); } else { lblServErrorStart.Visible = true; } }}catch (Exception ex){ Response.Write(ex.ToString());}",Start Windows Service programmatically
C# Get IPV4 ipaddress only," How do I get only Internet Protocol version 4 addresses from Dns.GetHostAddresses()? I have the code below, and it gives me IPv4 and IPv6 addresses.I have to make it work with boxes that have multiple IPv4 addresses. <code>  IPAddress[] localIPs = Dns.GetHostAddresses(Dns.GetHostName());private void get_IPs() { foreach (IPAddress a in localIPs) { server_ip = server_ip + a.ToString() + ""/""; } }",How do I determine the local hosts IPv4 addresses?
Cross-thread operation not valid: Control 'listBox1' accessed from a > thread other than the thread it was created on.," Possible Duplicate: Cross-thread operation not valid: Control accessed from a thread other than the thread it was created on. While I am trying to add items to a ListBox, I'am getting the following error: Cross-thread operation not valid: Control 'listBox1' accessed from a thread other than the thread it was created on.Here is tried code: I am little bit new in C# and also with threading, I googled and checked many articles including SO, But still I don't know how to solve the problem. <code>  private void Form1_Load(object sender, EventArgs e){ Jid jd = new Jid(""USERNAME""); xmpp.Open(jd.User, ""PASSWORD""); xmpp.OnLogin += new ObjectHandler(xmpp_OnLogin); agsXMPP.XmppConnection p; xmpp.OnPresence += new PresenceHandler(xmpp_OnPresence);}void xmpp_OnPresence(object sender, Presence pres){ listBox1.Items.Add(pres.From .User ); --- **HERE I AM GETTING ERROR.**}",Cross-thread operation not valid: Control 'listBox1' accessed from a > thread other than the thread it was created on
Destructors are not guaranteed to be called!!," I came across the following quote ""Desctructors are not guaranteed to be called."" and this scares me a bit.It goes on to say that even a try finally block can be interrupted, causing memory leaks. It does give a solution by either placing your code in CER (constrained execution region) or derive from the CriticalFinalizerObject.My question isWhat are the tradoffs by using CriticalFinalizerObject, if any?Are their any cases were you found deriving from CriticalFinalizerObject was really usefull?Should I only worry about using this when I start running into Memory leaks? <code> ",Destructors are not guaranteed to be called
c# binding failure was detected 'Microsoft.Practices.EnterpriseLibrary.Validation'," The building of this project is working on my friend's computer, but not on mine.On this return line: I am getting the following error:The assembly with display name'Microsoft.Practices.EnterpriseLibrary.Validation' failed to load inthe 'Load' binding context of the AppDomain with ID 1. The cause ofthe failure was: System.IO.FileNotFoundException: Could not load fileor assembly 'Microsoft.Practices.EnterpriseLibrary.Validation' or oneof its dependencies. The system cannot find the file specified. Filename: 'Microsoft.Practices.EnterpriseLibrary.Validation'=== Pre-bind state information === LOG: User = MLABS\agordon LOG: DisplayName = Microsoft.Practices.EnterpriseLibrary.Validation(Partial) LOG: Appbase = file:///C:/Documents and Settings/agordon/MyDocuments/Projects/BulkUploadToLOMDatabase/BulkUploadToLOMDatabase/bin/Debug/LOG: Initial PrivatePath = NULL Calling assembly :Microsoft.Practices.EnterpriseLibrary.Common, Version=5.0.414.0,Culture=neutral, PublicKeyToken=null.=== LOG: This bind starts in default load context. LOG: Using application configuration file: C:\Documents and Settings\agordon\MyDocuments\Projects\BulkUploadToLOMDatabase\BulkUploadToLOMDatabase\bin\Debug\BulkUploadToLOMDatabase.vshost.exe.configLOG: Using machine configuration file fromc:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\config\machine.config.LOG: Policy not being applied to reference at this time (private,custom, partial, or location-based assembly bind). LOG: Attemptingdownload of new URL file:///C:/Documents and Settings/agordon/MyDocuments/Projects/BulkUploadToLOMDatabase/BulkUploadToLOMDatabase/bin/Debug/Microsoft.Practices.EnterpriseLibrary.Validation.DLL.LOG: Attempting download of new URL file:///C:/Documents andSettings/agordon/MyDocuments/Projects/BulkUploadToLOMDatabase/BulkUploadToLOMDatabase/bin/Debug/Microsoft.Practices.EnterpriseLibrary.Validation/Microsoft.Practices.EnterpriseLibrary.Validation.DLL.LOG: Attempting download of new URL file:///C:/Documents andSettings/agordon/MyDocuments/Projects/BulkUploadToLOMDatabase/BulkUploadToLOMDatabase/bin/Debug/Microsoft.Practices.EnterpriseLibrary.Validation.EXE.LOG: Attempting download of new URL file:///C:/Documents andSettings/agordon/MyDocuments/Projects/BulkUploadToLOMDatabase/BulkUploadToLOMDatabase/bin/Debug/Microsoft.Practices.EnterpriseLibrary.Validation/Microsoft.Practices.EnterpriseLibrary.Validation.EXE.Here are all the references I have:I did download the latest enterprise library and installed it, and I replaced all the DLLS in the above picture with all of their updated versions.What am I doing wrong? <code>  protected static Database Connection2{ get { try { return DatabaseFactory.CreateDatabase(""HermesDB""); } catch (Exception e) { //Corpnet.Elmah.Error.Add(e); return null; } }}",Binding failure was detected 'Microsoft.Practices.EnterpriseLibrary.Validation'
T t new T() is using internally Activator.CreateInstance(), If I have a type parameter constraint new(): Is it true that new T() will internally use the Activator.CreateInstance method (i.e. reflection)? <code>  void Foo<T>() where T : new(){ var t = new T();},"Given ""where T : new()"", does ""new T()"" use Activator.CreateInstance internally?"
T t = new T() is using internally Activator.CreateInstance(), If I have a type parameter constraint new(): Is it true that new T() will internally use the Activator.CreateInstance method (i.e. reflection)? <code>  void Foo<T>() where T : new(){ var t = new T();},"Given ""where T : new()"", does ""new T()"" use Activator.CreateInstance internally?"
LINQ serizlization," Somewhere (I wish I knew where), Jon Skeet and Marc Gravel were thinking about working on a tool that translated a LINQ query to XML for transfer over the wire? Does anyone know if they, or someone else has done this and made it public?Scenario: distributed & cross assembly. This is a nice to have feature for me at this stage.Maybe this isn't possible yet.  <code> ",LINQ serialization
Receive http requests from external source, I have a C# form application which I want to have listening for incoming HTTP requests from other computers.How would I go about doing this? <code> ,Listen to HTTP requests
Convert int to a byte in .NET," How can I convert an int to a bit array?If I e.g. have an int with the value 3 I want an array, that has the length 8 and that looks like this: Each of these numbers are in a separate slot in the array that have the size 8. <code>  0 0 0 0 0 0 1 1",Convert int to a bit array in .NET
how do i get latest date from a collection of objects using LINQ, I have a list of objects and each object has a ExpirationDate property which is of type DateTime. I want to retrieve the latest date in the list. Is there an elegant way of doing that through LINQ?Something like: <code>  DateTime latestDate = myCollection.Where(r=>r.ExpirationDate.HasValue).MaxDate(r=>r.ExpirationDate.Value);,How do I get the latest date from a collection of objects using LINQ?
How to join 2 or more .WAV files together programatically?," I need the ability to join 2 or more .wav files together in to one .wav file. I must do this programmatically, using C# (3rd-party products are not an option). I know of the System.Media.SoundPlayer class, but I am not looking to play the the .wav, but only to create it. <code> ",How to join 2 or more .WAV files together programmatically?
WPF Listview Groups. I need some help.," Below is the XAML. The data from the object is populating the listview. I just can't get the groups to display. I want to group on a property called workcenter, which isn't displayed in the listview, but it's still part of the class bound to it. I'm a WPF noob, so forgive me if the answer is right in front of me and I'm missing it. I'm using examples from the web to try to get this to work but it's just not to this point. This is a mock-up for a project I have to do, so ignore the silly form text and namespace. =) Since I can't post images, I'll try to map out how it looks using text skills. What I get is this: What I want is this, with 332, 404 being the groups. Here's the code behind. I don't think it'll help. Most of it is just test data to display in the mock-up.  <code>  <Window x:Class=""Son_of_a_Batching_WPF_Mock_up.Window1"" xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" DataContext=""{Binding RelativeSource={RelativeSource Self}}"" Title=""You Son of a Batch. I'm Detective John Kimble! I'm A Cop You Idiot!"" Height=""600"" Width=""800""> <Window.Resources> <CollectionViewSource Source=""{Binding testDataCollection}"" x:Key=""src""> <CollectionViewSource.GroupDescriptions> <PropertyGroupDescription PropertyName=""workcenter"" /> </CollectionViewSource.GroupDescriptions> </CollectionViewSource> </Window.Resources> <Grid x:Name=""mainGrid"" Background=""White""> <ComboBox x:Name=""cboWorkCenters"" HorizontalAlignment=""Left"" VerticalAlignment=""Top"" Width=""256"" Background=""{x:Null}"" Margin=""12,50,0,0"" SelectedIndex=""0"" FontSize=""12pt"" Height=""27.28""> <ComboBoxItem Content=""Group by work center"" FontSize=""12pt""/> <ComboBoxItem Content=""Group by batch type"" FontSize=""12pt""/> </ComboBox> <Label x:Name=""lblFilter"" FontSize =""12pt"" HorizontalAlignment=""Left"" Margin=""11.473,13.043,0,0"" VerticalAlignment=""Top"" Content=""Filter by work center:"" Width=""252.527"" FontWeight=""Bold""/> <ListView x:Name=""lvBatches"" Margin=""12,83,12,12"" ItemsSource=""{Binding Source = {StaticResource src}}""><!--ItemsSource=""{Binding testDataCollection}"">--> <ListView.GroupStyle> <GroupStyle> <GroupStyle.ContainerStyle> <Style TargetType=""{x:Type GroupItem}""> <Setter Property=""Margin"" Value=""0,0,0,5""/> <Setter Property=""Template""> <Setter.Value> <ControlTemplate TargetType=""{x:Type GroupItem}""> <Expander IsExpanded=""True"" BorderBrush=""#FFA4B97F"" BorderThickness=""0,0,0,1""> <Expander.Header> <DockPanel> <TextBlock FontWeight=""Bold"" Text="" {Binding Path=name}"" Margin=""5,0,0,0"" Width=""100""/> <TextBlock FontWeight=""Bold"" Text="" {Binding Path=itemcount}""/> </DockPanel> </Expander.Header> <Expander.Content> <ItemsPresenter /> </Expander.Content> </Expander> </ControlTemplate> </Setter.Value> </Setter> </Style> </GroupStyle.ContainerStyle> </GroupStyle> </ListView.GroupStyle> <ListView.View> <GridView> <GridViewColumn x:Name=""colID"" Header=""Batch ID"" Width=""200"" DisplayMemberBinding=""{Binding id}""/> <!--<GridViewColumn x:Name=""colWC"" Header=""Work Center"" Width=""100"" DisplayMemberBinding=""{Binding workcenter}""/>--> <GridViewColumn x:Name=""colStart"" Header=""Start Time"" Width=""150"" DisplayMemberBinding=""{Binding start}""/> <GridViewColumn x:Name=""colEnd"" Header=""End Time"" Width=""150"" DisplayMemberBinding=""{Binding end}""/> <GridViewColumn x:Name=""colDur"" Header=""Duration"" Width=""100"" DisplayMemberBinding=""{Binding duration}""/> <GridViewColumn x:Name=""colBatchType"" Header=""Batch Type"" Width=""100"" DisplayMemberBinding=""{Binding batchtype}""/> </GridView> </ListView.View> </ListView> </Grid></Window> **Batch ID Start Time End Time Duration Batch Type**-------- ---------- -------- -------- ----------12344555 7/21/11 7/22/11 100 Loaded54564564 7/21/11 7/23/11 50 Sequential12433555 7/21/11 7/22/11 100 Loaded54564564 7/21/11 7/23/11 50 Sequential12311555 7/21/11 7/22/11 100 Loaded54456564 7/21/11 7/23/11 50 Sequential12344555 7/21/11 7/22/11 100 Loaded57744564 7/21/11 7/23/11 50 Sequential12994555 7/21/11 7/22/11 100 Loaded54500564 7/21/11 7/23/11 50 Sequential **Batch ID Start Time End Time Duration Batch Type**-------- ---------- -------- -------- ----------**332**12344555 7/21/11 7/22/11 100 Loaded12433555 7/21/11 7/22/11 100 Loaded12311555 7/21/11 7/22/11 100 Loaded**404**54564564 7/21/11 7/23/11 50 Sequential54564564 7/21/11 7/23/11 50 Sequential54500564 7/21/11 7/23/11 50 Sequential using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Windows;using System.Windows.Controls;using System.Windows.Data;using System.Windows.Documents;using System.Windows.Input;using System.Windows.Media;using System.Windows.Media.Imaging;using System.Windows.Navigation;using System.Windows.Shapes;using System.Collections.ObjectModel;namespace Son_of_a_Batching_WPF_Mock_up{ /// <summary> /// Interaction logic for Window1.xaml /// </summary> public partial class Window1 : Window { private ObservableCollection<TestData> _testDataCollection = new ObservableCollection<TestData>(); public ObservableCollection<TestData> testDataCollection { get { return _testDataCollection; } } //public System.ComponentModel.ICollectionView source { get; set; } public Window1() { InitializeComponent(); //this.source.GroupDescriptions.Add(new PropertyGroupDescription(""workcenter"")); LoadTestData(); } private void LoadTestData() { //int[] icnt = new int[529]; for (int i = 0; i <= 99; i++) { _testDataCollection.Add(new TestData()); } //for (int i = 0; i < _testDataCollection.Count; i++) //{ // icnt[int.Parse(_testDataCollection[i].workcenter)] ++; //} //this.label1.Content = ""332:"" + icnt[332].ToString() + "","" + ""402:"" + icnt[402].ToString() + "",""+ ""404:"" + icnt[404].ToString() + "","" // + ""522:"" + icnt[522].ToString() + "",""+ ""523:"" + icnt[523].ToString() + "",""+ ""524:"" + icnt[524].ToString() + "","" // + ""527:"" + icnt[527].ToString() + "",""+ ""528:"" + icnt[528].ToString() + "",""; } } public class TestData { private string[] _WCs = new string[] { ""404"", ""527"", ""523"", ""524"", ""332"", ""528"", ""522"", ""402"" }; private string[] _workcenters = new string[1000]; private string _workcenter; private double _duration = 0; public string id { get { return Guid.NewGuid().ToString(); } } public string workcenter { get { return _workcenter; } } public DateTime start { get { return DateTime.Now; } } public DateTime end { get { return DateTime.Now; } } public double duration { get { return _duration; } } public string batchtype { get { switch (workcenter) { case ""332"": case ""402"": case ""527"": return ""Loaded Batch""; case ""404"": case ""524"": return ""Sequential Batch""; case ""522"": case ""528"": case ""523"": return ""Supervisor Batch""; default: return """"; } } } public TestData() { RandomizeWCs(); Random rnd = new Random(); _workcenter = _workcenters[rnd.Next(0, 999)]; rnd = new Random(); _duration = rnd.Next(10, 60); } private void RandomizeWCs() { Random rnd = new Random(); int iIndex, i; while (_workcenters.Contains(null)) { iIndex = rnd.Next(1000); i = rnd.Next(8); if (_workcenters[iIndex] == null) { _workcenters[iIndex] = _WCs[i]; } } } }}",WPF Listview Groups Headers Not Displaying: Any Ideas?
How does linq expression knows that where comes before select ?," I'm trying to create a LINQ provider. I'm using the guide LINQ: Building an IQueryable provider series, and I have added the code up to LINQ: Building an IQueryable Provider - Part IV.I am getting a feel of how it is working and the idea behind it. Now I'm stuck on a problem, which isn't a code problem but more about the understanding.I'm firing off this statement: Somehow the code, or expression, knows that the Where comes before the Select. But how and where?There is no way in the code that sorts the expression, in fact the ToString() in debug mode, shows that the Select comes before the Where.I was trying to make the code fail. Normal I did the Where first and then the Select.So how does the expression sort this? I have not done any change to the code in the guide. <code>  QueryProvider provider = new DbQueryProvider();Query<Customer> customers = new Query<Customer>(provider);int i = 3;var newLinqCustomer = customers.Select(c => new { c.Id, c.Name}).Where(p => p.Id == 2 | p.Id == i).ToList();",How does a LINQ expression know that Where() comes before Select()?
How does LINQ expression knos that Where() comes before Select() ?," I'm trying to create a LINQ provider. I'm using the guide LINQ: Building an IQueryable provider series, and I have added the code up to LINQ: Building an IQueryable Provider - Part IV.I am getting a feel of how it is working and the idea behind it. Now I'm stuck on a problem, which isn't a code problem but more about the understanding.I'm firing off this statement: Somehow the code, or expression, knows that the Where comes before the Select. But how and where?There is no way in the code that sorts the expression, in fact the ToString() in debug mode, shows that the Select comes before the Where.I was trying to make the code fail. Normal I did the Where first and then the Select.So how does the expression sort this? I have not done any change to the code in the guide. <code>  QueryProvider provider = new DbQueryProvider();Query<Customer> customers = new Query<Customer>(provider);int i = 3;var newLinqCustomer = customers.Select(c => new { c.Id, c.Name}).Where(p => p.Id == 2 | p.Id == i).ToList();",How does a LINQ expression know that Where() comes before Select()?
How does LINQ expression know that Where() comes before Select() ?," I'm trying to create a LINQ provider. I'm using the guide LINQ: Building an IQueryable provider series, and I have added the code up to LINQ: Building an IQueryable Provider - Part IV.I am getting a feel of how it is working and the idea behind it. Now I'm stuck on a problem, which isn't a code problem but more about the understanding.I'm firing off this statement: Somehow the code, or expression, knows that the Where comes before the Select. But how and where?There is no way in the code that sorts the expression, in fact the ToString() in debug mode, shows that the Select comes before the Where.I was trying to make the code fail. Normal I did the Where first and then the Select.So how does the expression sort this? I have not done any change to the code in the guide. <code>  QueryProvider provider = new DbQueryProvider();Query<Customer> customers = new Query<Customer>(provider);int i = 3;var newLinqCustomer = customers.Select(c => new { c.Id, c.Name}).Where(p => p.Id == 2 | p.Id == i).ToList();",How does a LINQ expression know that Where() comes before Select()?
Why not using custom class instead of inheriting from EventArgs class, I'm wondering why should I use a class that inherits from the EventArgs class instead of using a custom class that will do the same job for me when passing event data? <code> ,Why to not use a custom class instead of inheriting the EventArgs class
Why not use custom class instead of inheriting from EventArgs class, I'm wondering why should I use a class that inherits from the EventArgs class instead of using a custom class that will do the same job for me when passing event data? <code> ,Why to not use a custom class instead of inheriting the EventArgs class
"ModelMetaData, Custom Class Attributes and an indescribeable question."," What I want to do seems so simple.In my index.cshtml I want to display the WizardStepAttribute ValueSo, a user will see at the top of each page, Step 1: Enter User InformationI have a ViewModel called WizardViewModel. This ViewModel has a property that is IList<IStepViewModel> Stepseach ""step"" implements the Interface IStepViewModel, which is an empty interface.I have a view called Index.cshtml. This view displays EditorFor() the current step.I have a custom ModelBinder, that binds the View to an new instance of the concrete class implementing IStepViewModel based on the WizardViewModel.CurrentStepIndex propertyI have created a custom attribute WizardStepAttribute.Each of my Steps classes are defined like this. I have several problems though.My View is strongly typed to WizardViewModel not each step. I don't want to have to create a view for each concrete implementation of IStepViewModelI thought I could add a property to the interface, but then I have to explicitly implement it in each class. (So this isn't any better)I'm thinking I could implement it using reflection in the interface but, you can't refer to instances in methods in an interface. <code>  [WizardStepAttribute(Name=""Enter User Information"")] [Serializable]public class Step1 : IStepViewModel....","ModelMetaData, Custom Class Attributes and an indescribable question."
How can i export Data to Excel file, I have an Excel file with data in it. I want to write some specific rows of it to another Excel file that I created by code. By the way I have the indexes of these rows in a list. How can i do that? <code> ,How can I export data to an Excel file
How to load a winforms app quickly," I have a WinForms application. the main form is has a lot of controls and that is one of the reasons that makes it load very slow. what I would like to do is to make the form load faster. I have set the beginupdate and endupdate. The form is not being rendered in the background worker thread, because this is the main form. There are no initial forms. When the user clicks the application icon, this is the first form that loads up. Adding a progress bar or any splash form is not a good idea for me. I have checked other questions here on Stack overflow but they do not seem to face the same problem as I do. If there are some examples/ideas you have in mind, it would be nice of you if you can share it with me.  <code> ",How to improve the loading time of winform?
different between lock(this) and lock(Object), Which of the following two code snippets is better to use? or this is an object of the current instance. So why is lock (_locker) always in the books? Related: What is the difference between lock(this) and lock(thisLock)? Why is lock(this) {…} bad?  <code>  static readonly object _locker = new object();lock (_locker) lock (this),Difference between lock(this) and a lock on static object
Linq groupby question," I have a collection called navigationList. This list holds customer objects.A customer has a property called Town.The list holds 5 customers: 2 with town ""New York"", and 5 with town ""Madrid"".I want the list to only hold only 2 customers. 1 with town ""New York"" and one with ""Madrid"". If 2 are from ""New York"", I want the last one. Same for ""Madrid"".What would the LINQ statement look like? <code>  var newList = navigationList.GroupBy(c => c.Town) // ? ",LINQ groupby question
C# How best to read a File into List<string>, I am using a list to limit the file size since the target is limited in disk and ram.This is what I am doing now but is there a more efficient way? <code>  readonly List<string> LogList = new List<string>();...var logFile = File.ReadAllLines(LOG_PATH);foreach (var s in logFile) LogList.Add(s);,How best to read a File into List<string>
Local event listener called even thought object failed to be constructed," In the constructor of an object, Listener, we take an argument and subscribe to one of its events. If an exception is thrown within the constructor after the event is subscribed the OnSomethingChanged() method is still called when the event is raised - even through the object was not successfully constructed and, as far as I'm aware, no instance exists.Now I can fix this by obviously re-factoring the design slightly, however I'm more interested in why an instance method is called even though the constructor did not complete successfully? If the method uses any local variables that have not been initialised before the exception then obviously it goes BOOM! <code>  class Program{ static void Main(string[] args) { Input input = new Input(); try { new Listener(input); } catch (InvalidOperationException) { // swallow } input.ChangeSomething(); // prints ""Something changed!"" }}public class Listener{ public Listener(Input input) { input.SomethingChanged += OnSomethingChanged; // subscibe throw new InvalidOperationException(); // do not let constructor succeed } void OnSomethingChanged(object sender, EventArgs e) { Console.WriteLine(""Something changed!""); }}public class Input{ public event EventHandler SomethingChanged; public void ChangeSomething() { SomethingChanged(this, EventArgs.Empty); }}",Local event listener called even though object failed to be constructed
SnapsToDevicePixels doesn't work," I've encountered a problem with bitmap images in WPF. When the image container starts on a position which is not a whole number, the image seems to not respect the value of SnapsToDevicePixels.Example code: (Note the value of the left margin: 10.333333.)Here the image i16.png is a simple 16x16 bitmap in 96 DPI resolution with thin vertical lines: . (My system resolution is 96 DPI, Windows XP, .NET 4)When I run the program, the first image is sharp, whereas the second one is blurry: Different sources, including some here on stackoverflow, suggest different workarounds. (For example, these posts: [1], [2] and [3].) I tried the workarounds, and them seem to work. Using UseLayoutRounding=""true"" on the main window makes both images sharp. Using RenderOptions.BitmapScalingMode=""NearestNeighbor"" on the image makes it sharp, too.The question is, why doesn't SnapsToDevicePixels=""True"" work without workarounds? Is it a bug in WPF or I am using it in a wrong way? <code>  <Window x:Class=""BlurryImage.MainWindow"" xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" Height=""110"" Width=""200""> <StackPanel Orientation=""Horizontal"" VerticalAlignment=""Center""> <Button SnapsToDevicePixels=""True""> <Image SnapsToDevicePixels=""True"" Source=""i16.png"" Stretch=""None""/> </Button> <Button SnapsToDevicePixels=""True"" Margin=""10.333333,0,0,0""> <Image SnapsToDevicePixels=""True"" Source=""i16.png"" Stretch=""None""/> </Button> </StackPanel></Window>",SnapsToDevicePixels doesn't work with images?
High Performance Event Log C#," So I've been trying various ways to get Event Log data in bulk (1000+ records/second).I need something that can filter out old logs, right now I store the last recorded event record ID and retrieve all records where the event ID is greater than that....I've tried EventLogQuery/EventLogReader, this works fast except when I want to pull message data, in order to get a formatted message for security logs I need to call EventLogRecord.FormattedMessage(), this brings my log speed to about 150/second with easy to format logs, even worse with complicated ones.I've tried System.Diagnoistics.EventLog, this doesn't allow me to build filters, so every time I run this it must load ALL event logs, then I can parse off any duplicates (from the last scan). I have a sever that has 200k event logs over the past two days, memory usage gets terrible due to this, so that is a no-go.I've tried WMI using System.Management.ManagementObjectCollection, this has filtering and can pull message data from the security event log FAST (approaching ~1000/second), however it will go to about 50/60k and start to drag it's feet, down to doing about 1-2/second, eventually I'll get a Quota Violation error. :(So either:Is there a way to avoid the quota violation error, or do I want to use some other method for pulling event logs at this speed?Edit:I wrote a blog post detailing what I've learned about this:http://www.roushtech.net/2013/10/30/high-performance-event-log-reading/Mostly: WINAPI is your best bet, either write C++/CLR or use PInvoke. <code> ",High Performance Event Log
Interop COM Object in ASP .NET Client Side," I am trying to make a simple web application using ASP.NET and Interop COM.The main question is: How to make Interop COM works in client side?I am Using: IIS Windows Server 2008C# Interop COM - Visual Studio 2010Asp .NET - Visual Studio 2010After looking at these articles http://msdn.microsoft.com/en-us/library/aa479302.aspx and http://msdn.microsoft.com/en-us/magazine/cc301832.aspx. I tried to use the component on the client side in two ways:First: Second:in .aspx and in .cs file: In server side I open Internet Explorer and works like a charm. But in client side appears: Object doesn't support this property or method.I also tried: Works for both side, but only call MyApp.dll installed on the server side.Using 'object tag' is the correct way? Is there another way to use COM in client side? How to configure IIS to avoid Object doesn't support this property or method in client side?Thanks in Advance1# UpdateI create ASP.NET C# in Visual Studio 2010 on Windows XP 32bits that uses a C# Interop COM.On my machine ""Windows XP"" I do Start Debugging and IE page opens with my application. This works.So I copied the project to Windows Server 2008 and added the project in IIS. When I run IIS opens IE and this works.After this I tried to make the final test, So I open the IE on Windows XP and type the address that Windows Server generated, fine, I can see the page, but when I click to run the function, Appears: ""Object does not support this property or method"".Server:Windows 2008 R2 64bitsIE version 9Client:Windows XP 32bitsIE version 82# UpdateI tried another testI made a new Component COMIClassTest.cs ClassTest.cs In AssemblyInf.cs has [assembly: ComVisible(true)]I made another asp application: I change IE settings to display ActiveX not trust and run the program.In windows XP works, In Windows Server works. But when try to call the page from windows XP ""Windows XP call Windows 2008 page"" appears: ""Object doesn't support this property or method""If on client side I do regasm /u MyCOM.dll the IE prompted to install the component.The dll is stored in the C:\WINDOWS\Downloaded Program Files, if I try to install more than once, creates a folder called CONFLICT.1.. C:\WINDOWS\Downloaded Program Files\CONFLICT.1 very strange. I also tried to register this downloaded component with regasm MyCOM.dll /codebase.Server .NET: C:\Windows\Microsoft.NET\Framework\v4.0.30319Client .NET: C:\Windows\Microsoft.NET\Framework\v4.0.30319Why not work? It makes no sense.3# UpdateI ran on another machine ""Client"". I change IE settings to run not safe ActiveX. And Works, After this I tried on Windows XP Client I reseted the settings and set up again to run ActiveX not safe. This Works.Now the problem is related to Install Interop COM from ASP. I tried to install but appears: Object doesn't support this property or method. I think it is related to Safe Inicialization. I found this link: http://msdn.microsoft.com/en-us/library/aa751977.aspx#iobjsafe but is for C++, Is there C# examples?4# UpdateI tried to use:public class ClassTest : System.Windows.Forms.UserControl, IClassTestI also tried to do a .cab file but does not work.Have I to make wpf project? Why this does not work? <code>  <object id=""Obj"" codebase=""MyApp.dll#version=1,0,0,0"" classid=""clsid:C6659361-1625-4746-931C-36014B146679"" VIEWASTEXT></object> <script type=""text/javascript"" > function test() { alert('TEst'); Obj.PrintHi(); alert('and'); } </script> <object id=""Obj"" codebase=""MyApp.dll#version=1,0,0,0"" classid=""clsid:C6659361-1625-4746-931C-36014B146679"" VIEWASTEXT></object> RegisterClientScriptBlock(""showSaveMessage"", ""<script language=\""JavaScript\""> Obj.PrintHi(); </script>""); <% set Obj = CreateObject(""MyApp.MyClass"") Obj.PrintHi%> using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Runtime.InteropServices;namespace MyCOM{ [ComVisible(true)] [Guid(""8F388924-7743-4166-993F-CBF897D08A8B"")] public interface IClassTest { string getString(string str); }} using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Runtime.InteropServices;namespace MyCOM{ [ComVisible(true)] [Guid(""1AE4AD64-A951-4E6C-8600-AA1F08810DDD"")] public class ClassTest : IClassTest { public string getString(string str) { return str + ""1""; } }} <%@ Page Title=""Home Page"" Language=""C#"" MasterPageFile=""~/Site.master"" AutoEventWireup=""true"" CodeBehind=""Default.aspx.cs"" Inherits=""asp_test._Default"" %><asp:Content ID=""HeaderContent"" runat=""server"" ContentPlaceHolderID=""HeadContent""><object id=""Obj"" codebase=""MyCOM.dll#version=1,0,0,0"" classid=""clsid:1AE4AD64-A951-4E6C-8600-AA1F08810DDD"" VIEWASTEXT></object> </asp:Content><asp:Content ID=""BodyContent"" runat=""server"" ContentPlaceHolderID=""MainContent""><script type=""text/javascript"" > function test() { var test = Obj.getString('2'); alert(test); } </script> <input name=""btnTest"" value=""Call COM"" onclick=""test()"" style="" width: 400px;"" type=""button""></asp:Content>",Running C# Interop Control ActiveX on Client Side from ASP.NET
C# Interop COM Object in ASP .NET Client Side," I am trying to make a simple web application using ASP.NET and Interop COM.The main question is: How to make Interop COM works in client side?I am Using: IIS Windows Server 2008C# Interop COM - Visual Studio 2010Asp .NET - Visual Studio 2010After looking at these articles http://msdn.microsoft.com/en-us/library/aa479302.aspx and http://msdn.microsoft.com/en-us/magazine/cc301832.aspx. I tried to use the component on the client side in two ways:First: Second:in .aspx and in .cs file: In server side I open Internet Explorer and works like a charm. But in client side appears: Object doesn't support this property or method.I also tried: Works for both side, but only call MyApp.dll installed on the server side.Using 'object tag' is the correct way? Is there another way to use COM in client side? How to configure IIS to avoid Object doesn't support this property or method in client side?Thanks in Advance1# UpdateI create ASP.NET C# in Visual Studio 2010 on Windows XP 32bits that uses a C# Interop COM.On my machine ""Windows XP"" I do Start Debugging and IE page opens with my application. This works.So I copied the project to Windows Server 2008 and added the project in IIS. When I run IIS opens IE and this works.After this I tried to make the final test, So I open the IE on Windows XP and type the address that Windows Server generated, fine, I can see the page, but when I click to run the function, Appears: ""Object does not support this property or method"".Server:Windows 2008 R2 64bitsIE version 9Client:Windows XP 32bitsIE version 82# UpdateI tried another testI made a new Component COMIClassTest.cs ClassTest.cs In AssemblyInf.cs has [assembly: ComVisible(true)]I made another asp application: I change IE settings to display ActiveX not trust and run the program.In windows XP works, In Windows Server works. But when try to call the page from windows XP ""Windows XP call Windows 2008 page"" appears: ""Object doesn't support this property or method""If on client side I do regasm /u MyCOM.dll the IE prompted to install the component.The dll is stored in the C:\WINDOWS\Downloaded Program Files, if I try to install more than once, creates a folder called CONFLICT.1.. C:\WINDOWS\Downloaded Program Files\CONFLICT.1 very strange. I also tried to register this downloaded component with regasm MyCOM.dll /codebase.Server .NET: C:\Windows\Microsoft.NET\Framework\v4.0.30319Client .NET: C:\Windows\Microsoft.NET\Framework\v4.0.30319Why not work? It makes no sense.3# UpdateI ran on another machine ""Client"". I change IE settings to run not safe ActiveX. And Works, After this I tried on Windows XP Client I reseted the settings and set up again to run ActiveX not safe. This Works.Now the problem is related to Install Interop COM from ASP. I tried to install but appears: Object doesn't support this property or method. I think it is related to Safe Inicialization. I found this link: http://msdn.microsoft.com/en-us/library/aa751977.aspx#iobjsafe but is for C++, Is there C# examples?4# UpdateI tried to use:public class ClassTest : System.Windows.Forms.UserControl, IClassTestI also tried to do a .cab file but does not work.Have I to make wpf project? Why this does not work? <code>  <object id=""Obj"" codebase=""MyApp.dll#version=1,0,0,0"" classid=""clsid:C6659361-1625-4746-931C-36014B146679"" VIEWASTEXT></object> <script type=""text/javascript"" > function test() { alert('TEst'); Obj.PrintHi(); alert('and'); } </script> <object id=""Obj"" codebase=""MyApp.dll#version=1,0,0,0"" classid=""clsid:C6659361-1625-4746-931C-36014B146679"" VIEWASTEXT></object> RegisterClientScriptBlock(""showSaveMessage"", ""<script language=\""JavaScript\""> Obj.PrintHi(); </script>""); <% set Obj = CreateObject(""MyApp.MyClass"") Obj.PrintHi%> using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Runtime.InteropServices;namespace MyCOM{ [ComVisible(true)] [Guid(""8F388924-7743-4166-993F-CBF897D08A8B"")] public interface IClassTest { string getString(string str); }} using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Runtime.InteropServices;namespace MyCOM{ [ComVisible(true)] [Guid(""1AE4AD64-A951-4E6C-8600-AA1F08810DDD"")] public class ClassTest : IClassTest { public string getString(string str) { return str + ""1""; } }} <%@ Page Title=""Home Page"" Language=""C#"" MasterPageFile=""~/Site.master"" AutoEventWireup=""true"" CodeBehind=""Default.aspx.cs"" Inherits=""asp_test._Default"" %><asp:Content ID=""HeaderContent"" runat=""server"" ContentPlaceHolderID=""HeadContent""><object id=""Obj"" codebase=""MyCOM.dll#version=1,0,0,0"" classid=""clsid:1AE4AD64-A951-4E6C-8600-AA1F08810DDD"" VIEWASTEXT></object> </asp:Content><asp:Content ID=""BodyContent"" runat=""server"" ContentPlaceHolderID=""MainContent""><script type=""text/javascript"" > function test() { var test = Obj.getString('2'); alert(test); } </script> <input name=""btnTest"" value=""Call COM"" onclick=""test()"" style="" width: 400px;"" type=""button""></asp:Content>",Running C# Interop Control ActiveX on Client Side from ASP.NET
C# Interop COM Object in ASP.NET Client Side," I am trying to make a simple web application using ASP.NET and Interop COM.The main question is: How to make Interop COM works in client side?I am Using: IIS Windows Server 2008C# Interop COM - Visual Studio 2010Asp .NET - Visual Studio 2010After looking at these articles http://msdn.microsoft.com/en-us/library/aa479302.aspx and http://msdn.microsoft.com/en-us/magazine/cc301832.aspx. I tried to use the component on the client side in two ways:First: Second:in .aspx and in .cs file: In server side I open Internet Explorer and works like a charm. But in client side appears: Object doesn't support this property or method.I also tried: Works for both side, but only call MyApp.dll installed on the server side.Using 'object tag' is the correct way? Is there another way to use COM in client side? How to configure IIS to avoid Object doesn't support this property or method in client side?Thanks in Advance1# UpdateI create ASP.NET C# in Visual Studio 2010 on Windows XP 32bits that uses a C# Interop COM.On my machine ""Windows XP"" I do Start Debugging and IE page opens with my application. This works.So I copied the project to Windows Server 2008 and added the project in IIS. When I run IIS opens IE and this works.After this I tried to make the final test, So I open the IE on Windows XP and type the address that Windows Server generated, fine, I can see the page, but when I click to run the function, Appears: ""Object does not support this property or method"".Server:Windows 2008 R2 64bitsIE version 9Client:Windows XP 32bitsIE version 82# UpdateI tried another testI made a new Component COMIClassTest.cs ClassTest.cs In AssemblyInf.cs has [assembly: ComVisible(true)]I made another asp application: I change IE settings to display ActiveX not trust and run the program.In windows XP works, In Windows Server works. But when try to call the page from windows XP ""Windows XP call Windows 2008 page"" appears: ""Object doesn't support this property or method""If on client side I do regasm /u MyCOM.dll the IE prompted to install the component.The dll is stored in the C:\WINDOWS\Downloaded Program Files, if I try to install more than once, creates a folder called CONFLICT.1.. C:\WINDOWS\Downloaded Program Files\CONFLICT.1 very strange. I also tried to register this downloaded component with regasm MyCOM.dll /codebase.Server .NET: C:\Windows\Microsoft.NET\Framework\v4.0.30319Client .NET: C:\Windows\Microsoft.NET\Framework\v4.0.30319Why not work? It makes no sense.3# UpdateI ran on another machine ""Client"". I change IE settings to run not safe ActiveX. And Works, After this I tried on Windows XP Client I reseted the settings and set up again to run ActiveX not safe. This Works.Now the problem is related to Install Interop COM from ASP. I tried to install but appears: Object doesn't support this property or method. I think it is related to Safe Inicialization. I found this link: http://msdn.microsoft.com/en-us/library/aa751977.aspx#iobjsafe but is for C++, Is there C# examples?4# UpdateI tried to use:public class ClassTest : System.Windows.Forms.UserControl, IClassTestI also tried to do a .cab file but does not work.Have I to make wpf project? Why this does not work? <code>  <object id=""Obj"" codebase=""MyApp.dll#version=1,0,0,0"" classid=""clsid:C6659361-1625-4746-931C-36014B146679"" VIEWASTEXT></object> <script type=""text/javascript"" > function test() { alert('TEst'); Obj.PrintHi(); alert('and'); } </script> <object id=""Obj"" codebase=""MyApp.dll#version=1,0,0,0"" classid=""clsid:C6659361-1625-4746-931C-36014B146679"" VIEWASTEXT></object> RegisterClientScriptBlock(""showSaveMessage"", ""<script language=\""JavaScript\""> Obj.PrintHi(); </script>""); <% set Obj = CreateObject(""MyApp.MyClass"") Obj.PrintHi%> using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Runtime.InteropServices;namespace MyCOM{ [ComVisible(true)] [Guid(""8F388924-7743-4166-993F-CBF897D08A8B"")] public interface IClassTest { string getString(string str); }} using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Runtime.InteropServices;namespace MyCOM{ [ComVisible(true)] [Guid(""1AE4AD64-A951-4E6C-8600-AA1F08810DDD"")] public class ClassTest : IClassTest { public string getString(string str) { return str + ""1""; } }} <%@ Page Title=""Home Page"" Language=""C#"" MasterPageFile=""~/Site.master"" AutoEventWireup=""true"" CodeBehind=""Default.aspx.cs"" Inherits=""asp_test._Default"" %><asp:Content ID=""HeaderContent"" runat=""server"" ContentPlaceHolderID=""HeadContent""><object id=""Obj"" codebase=""MyCOM.dll#version=1,0,0,0"" classid=""clsid:1AE4AD64-A951-4E6C-8600-AA1F08810DDD"" VIEWASTEXT></object> </asp:Content><asp:Content ID=""BodyContent"" runat=""server"" ContentPlaceHolderID=""MainContent""><script type=""text/javascript"" > function test() { var test = Obj.getString('2'); alert(test); } </script> <input name=""btnTest"" value=""Call COM"" onclick=""test()"" style="" width: 400px;"" type=""button""></asp:Content>",Running C# Interop Control ActiveX on Client Side from ASP.NET
Running C# Interop COM ActiveX on Client Side from APS.NET," I am trying to make a simple web application using ASP.NET and Interop COM.The main question is: How to make Interop COM works in client side?I am Using: IIS Windows Server 2008C# Interop COM - Visual Studio 2010Asp .NET - Visual Studio 2010After looking at these articles http://msdn.microsoft.com/en-us/library/aa479302.aspx and http://msdn.microsoft.com/en-us/magazine/cc301832.aspx. I tried to use the component on the client side in two ways:First: Second:in .aspx and in .cs file: In server side I open Internet Explorer and works like a charm. But in client side appears: Object doesn't support this property or method.I also tried: Works for both side, but only call MyApp.dll installed on the server side.Using 'object tag' is the correct way? Is there another way to use COM in client side? How to configure IIS to avoid Object doesn't support this property or method in client side?Thanks in Advance1# UpdateI create ASP.NET C# in Visual Studio 2010 on Windows XP 32bits that uses a C# Interop COM.On my machine ""Windows XP"" I do Start Debugging and IE page opens with my application. This works.So I copied the project to Windows Server 2008 and added the project in IIS. When I run IIS opens IE and this works.After this I tried to make the final test, So I open the IE on Windows XP and type the address that Windows Server generated, fine, I can see the page, but when I click to run the function, Appears: ""Object does not support this property or method"".Server:Windows 2008 R2 64bitsIE version 9Client:Windows XP 32bitsIE version 82# UpdateI tried another testI made a new Component COMIClassTest.cs ClassTest.cs In AssemblyInf.cs has [assembly: ComVisible(true)]I made another asp application: I change IE settings to display ActiveX not trust and run the program.In windows XP works, In Windows Server works. But when try to call the page from windows XP ""Windows XP call Windows 2008 page"" appears: ""Object doesn't support this property or method""If on client side I do regasm /u MyCOM.dll the IE prompted to install the component.The dll is stored in the C:\WINDOWS\Downloaded Program Files, if I try to install more than once, creates a folder called CONFLICT.1.. C:\WINDOWS\Downloaded Program Files\CONFLICT.1 very strange. I also tried to register this downloaded component with regasm MyCOM.dll /codebase.Server .NET: C:\Windows\Microsoft.NET\Framework\v4.0.30319Client .NET: C:\Windows\Microsoft.NET\Framework\v4.0.30319Why not work? It makes no sense.3# UpdateI ran on another machine ""Client"". I change IE settings to run not safe ActiveX. And Works, After this I tried on Windows XP Client I reseted the settings and set up again to run ActiveX not safe. This Works.Now the problem is related to Install Interop COM from ASP. I tried to install but appears: Object doesn't support this property or method. I think it is related to Safe Inicialization. I found this link: http://msdn.microsoft.com/en-us/library/aa751977.aspx#iobjsafe but is for C++, Is there C# examples?4# UpdateI tried to use:public class ClassTest : System.Windows.Forms.UserControl, IClassTestI also tried to do a .cab file but does not work.Have I to make wpf project? Why this does not work? <code>  <object id=""Obj"" codebase=""MyApp.dll#version=1,0,0,0"" classid=""clsid:C6659361-1625-4746-931C-36014B146679"" VIEWASTEXT></object> <script type=""text/javascript"" > function test() { alert('TEst'); Obj.PrintHi(); alert('and'); } </script> <object id=""Obj"" codebase=""MyApp.dll#version=1,0,0,0"" classid=""clsid:C6659361-1625-4746-931C-36014B146679"" VIEWASTEXT></object> RegisterClientScriptBlock(""showSaveMessage"", ""<script language=\""JavaScript\""> Obj.PrintHi(); </script>""); <% set Obj = CreateObject(""MyApp.MyClass"") Obj.PrintHi%> using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Runtime.InteropServices;namespace MyCOM{ [ComVisible(true)] [Guid(""8F388924-7743-4166-993F-CBF897D08A8B"")] public interface IClassTest { string getString(string str); }} using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Runtime.InteropServices;namespace MyCOM{ [ComVisible(true)] [Guid(""1AE4AD64-A951-4E6C-8600-AA1F08810DDD"")] public class ClassTest : IClassTest { public string getString(string str) { return str + ""1""; } }} <%@ Page Title=""Home Page"" Language=""C#"" MasterPageFile=""~/Site.master"" AutoEventWireup=""true"" CodeBehind=""Default.aspx.cs"" Inherits=""asp_test._Default"" %><asp:Content ID=""HeaderContent"" runat=""server"" ContentPlaceHolderID=""HeadContent""><object id=""Obj"" codebase=""MyCOM.dll#version=1,0,0,0"" classid=""clsid:1AE4AD64-A951-4E6C-8600-AA1F08810DDD"" VIEWASTEXT></object> </asp:Content><asp:Content ID=""BodyContent"" runat=""server"" ContentPlaceHolderID=""MainContent""><script type=""text/javascript"" > function test() { var test = Obj.getString('2'); alert(test); } </script> <input name=""btnTest"" value=""Call COM"" onclick=""test()"" style="" width: 400px;"" type=""button""></asp:Content>",Running C# Interop Control ActiveX on Client Side from ASP.NET
Running C# Interop COM ActiveX on Client Side from ASP.NET," I am trying to make a simple web application using ASP.NET and Interop COM.The main question is: How to make Interop COM works in client side?I am Using: IIS Windows Server 2008C# Interop COM - Visual Studio 2010Asp .NET - Visual Studio 2010After looking at these articles http://msdn.microsoft.com/en-us/library/aa479302.aspx and http://msdn.microsoft.com/en-us/magazine/cc301832.aspx. I tried to use the component on the client side in two ways:First: Second:in .aspx and in .cs file: In server side I open Internet Explorer and works like a charm. But in client side appears: Object doesn't support this property or method.I also tried: Works for both side, but only call MyApp.dll installed on the server side.Using 'object tag' is the correct way? Is there another way to use COM in client side? How to configure IIS to avoid Object doesn't support this property or method in client side?Thanks in Advance1# UpdateI create ASP.NET C# in Visual Studio 2010 on Windows XP 32bits that uses a C# Interop COM.On my machine ""Windows XP"" I do Start Debugging and IE page opens with my application. This works.So I copied the project to Windows Server 2008 and added the project in IIS. When I run IIS opens IE and this works.After this I tried to make the final test, So I open the IE on Windows XP and type the address that Windows Server generated, fine, I can see the page, but when I click to run the function, Appears: ""Object does not support this property or method"".Server:Windows 2008 R2 64bitsIE version 9Client:Windows XP 32bitsIE version 82# UpdateI tried another testI made a new Component COMIClassTest.cs ClassTest.cs In AssemblyInf.cs has [assembly: ComVisible(true)]I made another asp application: I change IE settings to display ActiveX not trust and run the program.In windows XP works, In Windows Server works. But when try to call the page from windows XP ""Windows XP call Windows 2008 page"" appears: ""Object doesn't support this property or method""If on client side I do regasm /u MyCOM.dll the IE prompted to install the component.The dll is stored in the C:\WINDOWS\Downloaded Program Files, if I try to install more than once, creates a folder called CONFLICT.1.. C:\WINDOWS\Downloaded Program Files\CONFLICT.1 very strange. I also tried to register this downloaded component with regasm MyCOM.dll /codebase.Server .NET: C:\Windows\Microsoft.NET\Framework\v4.0.30319Client .NET: C:\Windows\Microsoft.NET\Framework\v4.0.30319Why not work? It makes no sense.3# UpdateI ran on another machine ""Client"". I change IE settings to run not safe ActiveX. And Works, After this I tried on Windows XP Client I reseted the settings and set up again to run ActiveX not safe. This Works.Now the problem is related to Install Interop COM from ASP. I tried to install but appears: Object doesn't support this property or method. I think it is related to Safe Inicialization. I found this link: http://msdn.microsoft.com/en-us/library/aa751977.aspx#iobjsafe but is for C++, Is there C# examples?4# UpdateI tried to use:public class ClassTest : System.Windows.Forms.UserControl, IClassTestI also tried to do a .cab file but does not work.Have I to make wpf project? Why this does not work? <code>  <object id=""Obj"" codebase=""MyApp.dll#version=1,0,0,0"" classid=""clsid:C6659361-1625-4746-931C-36014B146679"" VIEWASTEXT></object> <script type=""text/javascript"" > function test() { alert('TEst'); Obj.PrintHi(); alert('and'); } </script> <object id=""Obj"" codebase=""MyApp.dll#version=1,0,0,0"" classid=""clsid:C6659361-1625-4746-931C-36014B146679"" VIEWASTEXT></object> RegisterClientScriptBlock(""showSaveMessage"", ""<script language=\""JavaScript\""> Obj.PrintHi(); </script>""); <% set Obj = CreateObject(""MyApp.MyClass"") Obj.PrintHi%> using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Runtime.InteropServices;namespace MyCOM{ [ComVisible(true)] [Guid(""8F388924-7743-4166-993F-CBF897D08A8B"")] public interface IClassTest { string getString(string str); }} using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Runtime.InteropServices;namespace MyCOM{ [ComVisible(true)] [Guid(""1AE4AD64-A951-4E6C-8600-AA1F08810DDD"")] public class ClassTest : IClassTest { public string getString(string str) { return str + ""1""; } }} <%@ Page Title=""Home Page"" Language=""C#"" MasterPageFile=""~/Site.master"" AutoEventWireup=""true"" CodeBehind=""Default.aspx.cs"" Inherits=""asp_test._Default"" %><asp:Content ID=""HeaderContent"" runat=""server"" ContentPlaceHolderID=""HeadContent""><object id=""Obj"" codebase=""MyCOM.dll#version=1,0,0,0"" classid=""clsid:1AE4AD64-A951-4E6C-8600-AA1F08810DDD"" VIEWASTEXT></object> </asp:Content><asp:Content ID=""BodyContent"" runat=""server"" ContentPlaceHolderID=""MainContent""><script type=""text/javascript"" > function test() { var test = Obj.getString('2'); alert(test); } </script> <input name=""btnTest"" value=""Call COM"" onclick=""test()"" style="" width: 400px;"" type=""button""></asp:Content>",Running C# Interop Control ActiveX on Client Side from ASP.NET
c# - Credit Card encryption," I've been tasked with handling some credit card data storage.After reading the PCI compliance questionnaire ( including the NIST 800-57) and some googling ive found few resources that are both (kinda) recent and compliant.Here are some resources ive found:http://www.dijksterhuis.org/creating-salted-hash-values-in-c/http://msdn.microsoft.com/en-us/magazine/cc164054.aspxIs there a best .NET algorithm for credit card encryption?My Question: The basic coding logic for encrypting and decrypting the information seems to boil down to the way Yossi does it here:http://yossi-yakubov.blogspot.com/2010/07/aes-encryption-using-c-short-way.htmlAm i correct ? Any more 'standards compliant' methods ? Any other resources someone can recommend? Thanks alotUPDATEI dont need to transmit the credit card numbers - i need to recieve and encrypt them for storage in the DB.If this data ever gets transmited it is always done over HTTPS ( so im good in that respect right ? )Yes i missed this important information when i first posted - but thanks alot for the quick replys, really. <code> ",Credit Card encryption for storing in SQL DB
c# - Credit Card encryption for storing in SQL DB," I've been tasked with handling some credit card data storage.After reading the PCI compliance questionnaire ( including the NIST 800-57) and some googling ive found few resources that are both (kinda) recent and compliant.Here are some resources ive found:http://www.dijksterhuis.org/creating-salted-hash-values-in-c/http://msdn.microsoft.com/en-us/magazine/cc164054.aspxIs there a best .NET algorithm for credit card encryption?My Question: The basic coding logic for encrypting and decrypting the information seems to boil down to the way Yossi does it here:http://yossi-yakubov.blogspot.com/2010/07/aes-encryption-using-c-short-way.htmlAm i correct ? Any more 'standards compliant' methods ? Any other resources someone can recommend? Thanks alotUPDATEI dont need to transmit the credit card numbers - i need to recieve and encrypt them for storage in the DB.If this data ever gets transmited it is always done over HTTPS ( so im good in that respect right ? )Yes i missed this important information when i first posted - but thanks alot for the quick replys, really. <code> ",Credit Card encryption for storing in SQL DB
How can I just get the base filename from this c# code," I have the following code: When I check the contents of file it has the directory path and extension. Is there a way I can just get the filename out of that? <code>  string[] files = Directory.GetFiles(@""C:\Notes"", ""*.txt"", SearchOption.TopDirectoryOnly);foreach(string file in files)",How can I just get the base filename from this C# code?
convert Ienumerable<byte[]> to byte[]," I understand, this returns IEnumerable<byte[]>, but I looking for LINQ way to convert the whole IEnumerable<byte[]> to byte[]. <code>  var r = from s in tempResult select Encoding.GetEncoding(""iso-8859-1"").GetBytes(s);",Convert IEnumerable<byte[]> to byte[]
find if point lay on line segment," I have line segment defined by these two points: A(x1,y1,z1) and B(x2,y2,z2). I have point p(x,y,z). How can I check if the point lies on the line segment? <code> ",Find if point lies on line segment
Find if point lays on line segment," I have line segment defined by these two points: A(x1,y1,z1) and B(x2,y2,z2). I have point p(x,y,z). How can I check if the point lies on the line segment? <code> ",Find if point lies on line segment
How do I abort a C# task?," Here's the situation, I am writing the framework for a code war contest. As the code runs, for each turn, it calls a method in the library provided by each contestant. The rules of the contest is the method must return in 1 second or we kill the task calling them. We then use a default result for that turn.The method has no support for a cancel because we cannot trust the called code to respond to a cancel. And we need to kill the thread because if we have 10 or 20 ignored background tasks then all calls going forward will provide fewer clock cycles on each call and methods that before took less than 1 second now take more.On the plus side, the method we're killing should have no resources open, etc. so an abort should not leave anything hanging.Update: Two things to keep in mind here. First, this is like a game - so performance is important. Second, the worker thread is unlikely to have any resources open. If one of the called methods goes overlong, I need to abort it and move on quickly. <code> ",How do I abort a .NET task?
C# VS2010EE How can I pre measure a string before is printed?," Hello, I am learning programming with C# VS 2010 EE and Im making an application to fill up a preprinted form. This form has several places in different coordinates. Three of the boxes on the paper are multiline 5 W x 2 H boxes. I already created the windows form with one TextBox for each place on the paper form.The thing is that when entering the info in these multiline TextBoxes I need to know how many lines are left on the paper to enter more text, and also, when to stop typing because there is no more space available in the PrePrinted box.Ive done a lot of search but everything I have found is about measuring on the screen, which does not match the final result on the paper. In other words, I need to know how to find out what are going to be the string dimensions on the paper while is being typed into the TextBoxes and compare it with the space available on the PrePrinted form so I can stop before it goes over the bottom border of the box on the paper.The first box on the paper is 5 in width by 2 in height, starting at new RectangleF(60.0F, 200.0F, 560.0F, 200.0F). I understand those numbers are hundredths of an inch.All of this, taking in to account that I can not limit the TextBoxes by quantity of characters because not all characters occupy the same space, like H != I; M != l; etc.Thank you in advance for your help.Today Sep 05 2011, based on your comments and suggestions Ive changed the code to use Graphics.MeasureString .This is the code I have now with the Graphics.MeasureString and only one richTextBox:Is working perfectly from the printDocument1_PrintPage event, but I have no idea how to make it work from the richTextBox1_TextChanged event. <code>  using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Drawing.Printing;//Needed for the PrintDocument()using System.Linq;using System.Text;using System.Windows.Forms;namespace Printing{ public partial class Form1 : Form { private Font printFont1; string strPrintText; public Form1() { InitializeComponent(); } private void cmdPrint_Click(object sender, EventArgs e) { try { PrintDocument pdocument = new PrintDocument(); pdocument.PrintPage += new PrintPageEventHandler (this.printDocument1_PrintPage); pdocument.Print(); } catch (Exception ex) { MessageBox.Show(ex.Message); } } public void printDocument1_PrintPage (object sender, System.Drawing.Printing.PrintPageEventArgs e) { strPrintText = richTextBox1.Text.ToString(); printFont1 = new Font(""Times New Roman"", 10); //I had to remove this line from the btnPrintAnexo1_Click Graphics g = e.Graphics; StringFormat format1 = new StringFormat(); RectangleF rectfText; int iCharactersFitted, iLinesFitted; rectfText = new RectangleF(60.0F, 200.0F, 560.0F, 200.0F); // The following e.Graphics.DrawRectangle is // just for debuging with printpreview e.Graphics.DrawRectangle(new Pen(Color.Black, 1F), rectfText.X, rectfText.Y, rectfText.Width, rectfText.Height); format1.Trimming = StringTrimming.Word; //Word wrapping //The next line of code ""StringFormatFlags.LineLimit"" was commented so the condition ""iLinesFitted > 12"" could be taken into account by the MessageBox// Use next line of code if you don't want to show last line, which will be clipped, in rectangleF //format1.FormatFlags = StringFormatFlags.LineLimit; //Don't use this next line of code. Some how it gave me a wrong linesFilled //g.MeasureString(strPrintText, font, rectfFull.Size, //StringFormat.GenericTypographic, out iCharactersFitted, out iLinesFilled); //Use this one instead: //Here is where we get the quantity of characters and lines used g.MeasureString(strPrintText, printFont1, rectfText.Size, format1, out iCharactersFitted, out iLinesFitted); if (strPrintText.Length == 0) { e.Cancel = true; return; } if (iLinesFitted > 12) { MessageBox.Show(""Too many lines in richTextBox1.\nPlease reduce text entered.""); e.Cancel = true; return; } g.DrawString(strPrintText, printFont1, Brushes.Black, rectfText, format1); g.DrawString(""iLinesFilled = Lines in the rectangle: "" + iLinesFitted.ToString(), printFont1, Brushes.Black, rectfText.X, rectfText.Height + rectfText.Y); g.DrawString(""iCharactersFitted = Characters in the rectangle: "" + iCharactersFitted.ToString(), printFont1, Brushes.Black, rectfText.X, rectfText.Height + rectfText.Y + printFont1.Height); } private void richTextBox1_TextChanged(object sender, EventArgs e) { //***I dont know what to type here.*** if (iLinesFitted == 13) { MessageBox.Show(""Too many lines in richTextBox1.\nPlease erase some characters.""); } } private void cmdPrintPreview_Click(object sender, EventArgs e) { printPreviewDialog1.ShowDialog(); } private void printDocument1_BeginPrint(object sender, System.Drawing.Printing.PrintEventArgs e) {// strPrintText = richTextBox1.Text; } }}",How can I pre measure a string before is printed?
C# Thread safe timers," I have a function that I want to invoke every x seconds, but I want it to be thread-safe.Can I set up this behavior when I am creating the timer? (I don't mind which .NET timer I use, I just want it to be thread-safe).I know I can implement locks inside my callback function, but I think it would be more elegant if it were in the timer level.My callback function, and environment are not related to a UI.[Edit 1]I just don't want there to be more than one thread inside my callback function.[Edit 2]I want to keep the locking inside the timer level, because the timer is responsible for when to call my callback, and here there is a particular situation when I don't want to call my callback function. So I think when to call is the responsibility of the timer. <code> ",Non-reentrant timers
Thread safe timers," I have a function that I want to invoke every x seconds, but I want it to be thread-safe.Can I set up this behavior when I am creating the timer? (I don't mind which .NET timer I use, I just want it to be thread-safe).I know I can implement locks inside my callback function, but I think it would be more elegant if it were in the timer level.My callback function, and environment are not related to a UI.[Edit 1]I just don't want there to be more than one thread inside my callback function.[Edit 2]I want to keep the locking inside the timer level, because the timer is responsible for when to call my callback, and here there is a particular situation when I don't want to call my callback function. So I think when to call is the responsibility of the timer. <code> ",Non-reentrant timers
How to test effectively a fixed length flat file?," I have this method signature: List<ITMData> Parse(string[] lines)ITMData has 35 properties.How would you effectively test such a parser?Questions:Should I load the whole file (May I use System.IO)? Should I put a line from the file into a string constant?Should I test one or more linesShould I test each property of ITMData or should I test the whole object?What about the naming of my test?EDIT I changed the method signature to ITMData Parse(string line).Test Code: EDIT 2I am still not sure if I should test only one property per class. In my opinion this allows me to give more information for the specification namely that when I parse a single line from index 59 to index 79 I get fldName. If I test all properties within one class I loss this information. Am I overspecifying my tests?My Tests now looks like this: <code>  [Subject(typeof(ITMFileParser))]public class When_parsing_from_index_59_to_79{ private const string Line = "".........""; private static ITMFileParser _parser; private static ITMData _data; private Establish context = () => { _parser = new ITMFileParser(); }; private Because of = () => { _data = _parser.Parse(Line); }; private It should_get_fldName = () => _data.FldName.ShouldBeEqualIgnoringCase(""HUMMELDUMM"");} [Subject(typeof(ITMFileParser))]public class When_parsing_single_line_from_ITM_file{ const string Line = """" static ITMFileParser _parser; static ITMData _data; Establish context = () => { _parser = new ITMFileParser(); }; private Because of = () => { _data = _parser.Parse(Line); }; It should_get_fld??? = () => _data.Fld???.ShouldEqual(???); It should_get_fld??? = () => _data.Fld???.ShouldEqual(???); It should_get_fld??? = () => _data.Fld???.ShouldEqual(???); It should_get_fld??? = () => _data.Fld???.ShouldEqual(???); It should_get_fld??? = () => _data.Fld???.ShouldEqual(???); It should_get_fld??? = () => _data.Fld???.ShouldEqual(???); It should_get_fld??? = () => _data.Fld???.ShouldEqual(???); ...}",How to effectively test a fixed length flat file parser using MSpec?
How to test effectively a fixed length flat file using Machine.Specifications?," I have this method signature: List<ITMData> Parse(string[] lines)ITMData has 35 properties.How would you effectively test such a parser?Questions:Should I load the whole file (May I use System.IO)? Should I put a line from the file into a string constant?Should I test one or more linesShould I test each property of ITMData or should I test the whole object?What about the naming of my test?EDIT I changed the method signature to ITMData Parse(string line).Test Code: EDIT 2I am still not sure if I should test only one property per class. In my opinion this allows me to give more information for the specification namely that when I parse a single line from index 59 to index 79 I get fldName. If I test all properties within one class I loss this information. Am I overspecifying my tests?My Tests now looks like this: <code>  [Subject(typeof(ITMFileParser))]public class When_parsing_from_index_59_to_79{ private const string Line = "".........""; private static ITMFileParser _parser; private static ITMData _data; private Establish context = () => { _parser = new ITMFileParser(); }; private Because of = () => { _data = _parser.Parse(Line); }; private It should_get_fldName = () => _data.FldName.ShouldBeEqualIgnoringCase(""HUMMELDUMM"");} [Subject(typeof(ITMFileParser))]public class When_parsing_single_line_from_ITM_file{ const string Line = """" static ITMFileParser _parser; static ITMData _data; Establish context = () => { _parser = new ITMFileParser(); }; private Because of = () => { _data = _parser.Parse(Line); }; It should_get_fld??? = () => _data.Fld???.ShouldEqual(???); It should_get_fld??? = () => _data.Fld???.ShouldEqual(???); It should_get_fld??? = () => _data.Fld???.ShouldEqual(???); It should_get_fld??? = () => _data.Fld???.ShouldEqual(???); It should_get_fld??? = () => _data.Fld???.ShouldEqual(???); It should_get_fld??? = () => _data.Fld???.ShouldEqual(???); It should_get_fld??? = () => _data.Fld???.ShouldEqual(???); ...}",How to effectively test a fixed length flat file parser using MSpec?
Linq - Equivalent to BETWEEN inside a Join," I've seen this topic BETWEEN EQUIVALENT in LINQMy Original Query in SQL: I need to implement between inside a ""left join"", I tried this:My Classes: My Implementation: WorkAround: If I use a workaround Linq translate to this query: I can put a simple where before ""select new"", but I have to implement by this way, with ""between"" inside the left join, How can I do this ? <code>  SELECT ISNULL(Tcar.name, '') FROM dbo.models modelLEFT JOIN cars Tcar on Tcar.model = model.id AND Tcar.year between model.Start and model.End public class car{ public string name { get; set; } public int model { get; set; } public DateTime year { get; set; }}public class model{ public int id { get; set; } public DateTime Start { get; set; } public DateTime End { get; set; }} var theModel = from model in models join Tcar in cars on new { ID = (int)model.id, DateStart = (DateTime)model.Start, DateEnd = (DateTime)model.End } equals new { ID = (int)Tcar.model, DateStart = (DateTime)Tcar.year, DateEnd = (DateTime)Tcar.year } into tempCar from finalCar in tempCar select new { CAR = (finalCar == null ? String.Empty : finalCar.name) }; var theModel = from model in models join Tcar in cars on model.id equals Tcar.model where model.Start <= Tcar.year && model.End >= Tcar.year select new { CAR = Tcar.name }; SELECT Tcar.name FROM dbo.models modelLEFT JOIN cars Tcar on Tcar.model == model.idWHERE model.Start <= Tcar.year and model.End >= Tcar.year",Linq - Equivalent to BETWEEN inside a Left Join
Microsoft Office Excel cannot access the file 'c:\inetpub\wwwroot\Timesheet\App_Data\Template.xlsx'.," I have my code as follows :- Now for the line :- It gets executed directly from the visual studio (F5) but when i try to access it with IIS it wont work.Throws error as follows:- Microsoft Office Excel cannot access the file 'c:\inetpub\wwwroot\Timesheet\App_Data\Template.xlsx'. There are several possible reasons: The file name or path does not exist. The file is being used by another program. The workbook you are trying to save has the same name as a currently open workbook.I have tried the work around as:- Folder and the file exist, giving access to the IUSR_### (IIS user) and to the ASPNET user in the folder where the file is. At Component Services(DCOM) given access to appropriate user. I have already given all permission's to the folder where the template(.xlsx) existsAny suggestions?? <code>  Microsoft.Office.Interop.Excel.Application oXL = null;Microsoft.Office.Interop.Excel.Sheets sheets;Application excel = new Microsoft.Office.Interop.Excel.Application();excel.Workbooks.Add(System.Reflection.Missing.Value);/* * Here is the complete detail's about Workbook.Open() * * Excel.Workbooks.Open(String Filename, Object UpdateLinks, Object ReadOnly, Object Format, * Object Password, Object WriteResPassword, Object IgnoreReadOnlyRecommended, Object Origin, * Object Delimiter, Object Editable, Object Notify, Object Converter, Object AddToMru, Object Local, Object CorruptLoad) */Workbook workbook = excel.Workbooks.Open( System.Web.HttpContext.Current.Server.MapPath(""~/App_Data/Template.xlsx""), Missing.Value, true, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value);sheets = workbook.Worksheets; workbook = excel.Workbooks.Open( System.Web.HttpContext.Current.Server.MapPath(""~/App_Data/Template.xlsx""), Missing.Value, true, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value);",Microsoft Office Excel cannot access the file 'c:\inetpub\wwwroot\Timesheet\App_Data\Template.xlsx'
not able to display the full image in datagridview cell," I have data grid view with columns product name and product image and I am populating these values coming from database...i am using winforms desktop application.....my problem is I am not able to showing the image in datagridview cell properly ..see the diagram belowi want to display this image in actual product image column for every cell in that column this task is very simple in webforms by using datalist control but i dont know how to display full image in grid view cell can any one help on this....many thanks.......and this is where i am binding the datagridview by using linq query..  <code>  private void EquipmentFinder_Load(object sender, EventArgs e) { var products = from prods in abc.products select new { productid = prods.product_Id, //0 productname = prods.product_Name, //1 productimage = prods.product_Image, //2 productprice = prods.product_Price,//3 productdescr = prods.product_Description, //4 }; productbindingsource.DataSource = products; productgridview.DataSource = productbindingsource; productgridview.Columns[0].Visible = false; productgridview.Columns[3].Visible = false; productgridview.Columns[4].Visible = false; }",Unable to display the full image in datagridview cell
Get application all tcp connections," How to find all tcp connections opened by specific application, maybe by process id or smth. like this? I use C# <code> ",Get all TCP-connections opened by application using C#
field name is 'Type'," table:UserTypesFields:row,name,TypeThis code is not working: But, this code does... dc.ExecuteQuery<UserType >(""update dbo.UserType set Type='personalPage' where row={0}"",user.Row );I get this error: Type the word is a word reserved.i can not user wordTypeEDITdbml <code>  Int64 row = 1;var myType = (from b in dc.UserTypes where b.Row == user.Row select b).Single();myType.Type = ""personalPage"";dc.SubmitChanges(); [Table(Name=""dbo.UserType"")] public partial class UserType { private long _Row; private string _Type; public UserType() { } [Column(Storage=""_Row"", DbType=""BigInt NOT NULL"")] public long Row { get { return this._Row; } set { if ((this._Row != value)) { this._Row = value; } } } [Column(Storage=""_Type"", DbType=""NVarChar(500) NOT NULL"", CanBeNull=false)] public string Type { get { return this._Type; } set { if ((this._Type != value)) { this._Type = value; } } }} ",How do I reference a field in LINQ that is named using a reserved word?
How best to override method in a .NET (C#) class dynamically through configuration," I'm thinking of something along the lines of the ""Inline Task"" in MsBuild. For reference: http://msdn.microsoft.com/en-us/library/dd722601.aspxI'd like to find or create a framework which allows me to override a method via configuration. For example if I have a well known base class which has a method Execute(args), how can I supply an overridden method implementation at deployment time, without requiring new code, build, release cycle? I would like to actually plug in the method body into a config file or preferably a database table.I assume this would be done either with code dom, dynamic language integration, or perhaps something like powershell(?). I'm looking for recommendations or perhaps a library someone has already written.The application is written in C#. Preferably the extension would also be in C#, but I'm open to other ideas as well.Update: Technically I don't even have to actually override a method. It would be sufficient to just be able to dynamically execute some external source code, passing in an arg and returning a result.Update. I ended up writing code to instantiate a PowerShell object and execute a script dynamically to return a value. Here is a snippet of code I used. Then in the calling code, I simply check the first PSObject in the return value, and pull the resulting value from it. It works great. Thanks for all the responses. <code>  public static Collection<PSObject> ExecuteScript(string code, string variableName, object variableValue) { PowerShell ps = PowerShell.Create(); ps.AddScript(code); if (!string.IsNullOrWhiteSpace(variableName)) { ps.Runspace.SessionStateProxy.SetVariable(variableName, variableValue); } var result = ps.Invoke(); return result; }",How best to create and execute a method in a .NET (C#) class dynamically through configuration
C# existing library for parsing drivers license information?," Is there an existing C# library that can be used to parse the information from a driver's license? I'm looking to parse the data directly from a swipe reader, so its a long string that needs to be broken down into it's components. I know that this is a big request, so I'm not interested in the validation of the numbers or even the license ID itself, I really just want to parse out the first and last name. I'm eventually interested in all 50 states but would like to see AZ and CA first. <code> ",existing library for parsing drivers license information?
Specify a username other than dbo in Code First Entity Framework ( C# ASP.NET MVC 3 )," I'm trying to connect to an SQL Server 2008 database in a shared hosting environment from C# from within an ASP.NET MVC 3 application connecting via EF (code first).My problem is that the generated SELECT statement looks like so: which throws the error Invalid object name, but works fine when I do: How do I specify a username other than dbo (e.g. mySQLUserName)?EDIT:The closest articles I have found that are relevant to this issue are:http://weblogs.asp.net/scottgu/archive/2010/08/03/using-ef-code-first-with-an-existing-database.aspxhttp://weblogs.asp.net/scottgu/archive/2010/07/23/entity-framework-4-code-first-custom-database-schema-mapping.aspxwith specific emphasis on the second article, however it doesn't specify how to set a username other than dbo <code>  SELECT ... FROM [dbo].[TableName] SELECT ... FROM [mySQLUserName].[TableName]",Specify an SQL username other than dbo in Code First Entity Framework ( C# ASP.NET MVC 3 )
how to check particular attributes exist or not in xml," Part of the XML content: I want to check in each node and if attribute split exist, try to assign an attribute value in a variable.Inside a loop, I try: But I'm wrong if the condition checks only the value, not the existence of attributes. How should I check for the existence of attributes? <code>  <section name=""Header""> <placeholder name=""HeaderPane""></placeholder></section><section name=""Middle"" split=""20""> <placeholder name=""ContentLeft"" ></placeholder> <placeholder name=""ContentMiddle""></placeholder> <placeholder name=""ContentRight""></placeholder></section><section name=""Bottom""> <placeholder name=""BottomPane""></placeholder></section> foreach (XmlNode xNode in nodeListName){ if(xNode.ParentNode.Attributes[""split""].Value != """") { parentSplit = xNode.ParentNode.Attributes[""split""].Value; }}",How do I check particular attributes exist or not in XML?
"LINQ query to parse perform a projection, skipping cases where the projection would cause an exception"," I'd like a general solution but as an example, assume i have an IEnumerable<string>, where some can be parsed as integers, and some cannot. Obviously if i did Select(s => int.Parse(s, temp)) it'd throw an exception when enumerated.In this case i could do .All(s => int.TryParse(s, out temp)) first, however i want a general solution where i don't have to enumerate the IEnumerable twice.Ideally i'd like to be able to do the following, which calls my magic exception skipping method: How can i write the SkipExceptions() extension method?Some great answers for a SelectSkipExceptions() method, however i wonder if a SkipExceptions() method could be created, along the same lines as AsParallel(). <code>  var strings = new string[] { ""1"", ""2"", ""notint"", ""3"" }; // e.g. parsing stringsvar strings = new string[] { ""1"", ""2"", ""notint"", ""3"" };var numbers = strings.Select(s => int.Parse(s)).SkipExceptions();// e.g. encountering null objectvar objects = new object[] { new object(), new object(), null, new object() }var objecttostrings = objects.Select(o => o.ToString()).SkipExceptions();// e.g. calling a method that could throwvar myClassInstances = new MyClass[] { new MyClass(), new MyClass(CauseMethodToThrow:true) };var myClassResultOfMethod = myClassInstances.Select(mci => mci.MethodThatCouldThrow()).SkipExceptions();","LINQ query to perform a projection, skipping or wrapping exceptions where source throws on IEnumerable.GetNext()"
"LINQ query to perform a projection, skipping cases where the projection would cause an exception"," I'd like a general solution but as an example, assume i have an IEnumerable<string>, where some can be parsed as integers, and some cannot. Obviously if i did Select(s => int.Parse(s, temp)) it'd throw an exception when enumerated.In this case i could do .All(s => int.TryParse(s, out temp)) first, however i want a general solution where i don't have to enumerate the IEnumerable twice.Ideally i'd like to be able to do the following, which calls my magic exception skipping method: How can i write the SkipExceptions() extension method?Some great answers for a SelectSkipExceptions() method, however i wonder if a SkipExceptions() method could be created, along the same lines as AsParallel(). <code>  var strings = new string[] { ""1"", ""2"", ""notint"", ""3"" }; // e.g. parsing stringsvar strings = new string[] { ""1"", ""2"", ""notint"", ""3"" };var numbers = strings.Select(s => int.Parse(s)).SkipExceptions();// e.g. encountering null objectvar objects = new object[] { new object(), new object(), null, new object() }var objecttostrings = objects.Select(o => o.ToString()).SkipExceptions();// e.g. calling a method that could throwvar myClassInstances = new MyClass[] { new MyClass(), new MyClass(CauseMethodToThrow:true) };var myClassResultOfMethod = myClassInstances.Select(mci => mci.MethodThatCouldThrow()).SkipExceptions();","LINQ query to perform a projection, skipping or wrapping exceptions where source throws on IEnumerable.GetNext()"
"C# WCF Certificate Chain, programmatically"," I'm trying to use certificates programmatically, rather than using the store. I'm creating X509Certificate2's with filename and password. This works fine when I have manually added the root certificate to the Certificate Store in Trusted People. However, I'd rather not have to do that on every deployment - I'd rather deal with it programmatically too.When I remove the root certificate from the Certificate Store I get an exception. Everything I have read seems to say that I have to manually added the root certificate to the Certificate Store, or the Trust Chain won't work. Question: Is there a programmatic way to set up the Trust Chain, so I don't have to do it manually? The code looks like: The exception, which occures when I try to use the Client, is: <code>  var serverCert = new X509Certificate2(""FullPathToMyCertificate.cer"", ""Password""); Client.ClientCredentials.ServiceCertificate.DefaultCertificate = serverCert; System.IdentityModel.Tokens.SecurityTokenValidationException The X.509 certificate CN=notrealcertname, OU=TPA, OU=BMP, OU=Projects, O=Somebody, C=US is not in the trusted people store. The X.509 certificate CN=notrealcertname, OU=TPA, OU=BMP, OU=Projects, O=Somebody, C=US chain building failed. The certificate that was used has a trust chain that cannot be verified. Replace the certificate or change the certificateValidationMode. A certificate chain could not be built to a trusted root authority.","WCF Certificate Chain, verify programmatically"
What is void** in c#?," I'm looking through the source of a C# program that uses a library written in C. I came across this line and was unsure what it was: What is an object of type void **? I did some Google searches and could only find information about void*, which is a pointer to a sort of catch all top level type, if I understood correctly. <code>  cvbimUNSAFE.GetImageVPA ((cvbim.IMG)cvImg.Image, 0, (void**)&lpImageBits, &pVPAT);",What is void** in C#?
C# invoke non static method by name," I've been trying to invoke a method by name but the problem is the method I invoke cannot be static and it needs to be of the current class.I've tried the way of doing it like this: This obviously only works for static members so I tried something like this But I get Must specify binding flags describing the invoke operation required (BindingFlags.InvokeMethod CreateInstance GetField SetField GetProperty SetProperty).Parameter name: bindingFlags error...So how can I go about doing this?EDIT:So: Gives a NullReferenceExceptionSolution:No ""this"" in Type.GetType(""this"") <code>  public static void InvokeMenuMethod(string methodName, object sender, EventArgs e) Type calledType = Type.GetType(""MyNamespace.MyClass""); calledType.InvokeMember( methodName, BindingFlags.InvokeMethod | BindingFlags.Public | BindingFlags.Static, null, null, new object[] { sender, e } );} public static void InvokeMenuMethod(string methodName, object sender, EventArgs e) Type calledType = Type.GetType(""this""); calledType.InvokeMember( methodName, BindingFlags.InvokeMethod | BindingFlags.Public, null, null, new object[] { sender, e } );} public void InvokeMenuMethod(string methodName, object sender, EventArgs e) { Type.GetType(""this"").InvokeMember( methodName, BindingFlags.InvokeMethod, null, this, new object[] { sender, e } );}",invoke non static method by name
"WPF, for and datetime problem", I'm trying to make use for on a DateTime like this: But the problem is that d does not increase. Does anyone have an idea of what the problem is? <code>  for (DateTime d = _BookedCheckIn; d <= _BookedCheckOut; d.AddDays(1)){ // ...},For-loop and DateTime Problem
Import Excel data into a DataSet using Microsoft.Office.Interop.Excel," What I want to doI'm trying to use the Microsoft.Office.Interop.Excel namespace to open an Excel file (XSL or CSV, but sadly not XSLX) and import it into a DataSet. I don't have control over the worksheet or column names, so I need to allow for changes to them.What I've triedI've tried the OLEDB method of this in the past, and had a lot of problems with it (buggy, slow, and required prior knowledge of the Excel file's schema), so I want to avoid doing that again. What I'd like to do is use Microsoft.Office.Interop.Excel to import the workbook directly to a DataSet, or loop through the worksheets and load each one into a DataTable.Believe it or not, I've had trouble finding resources for this. A few searches on StackOverflow have found mostly people trying to do the reverse (DataSet => Excel), or the OLEDB technique. Google hasn't been much more helpful.What I've got so far I'm fine with either importing the entire book at once, or looping through one sheet at a time. Can I do this with Interop.Excel? <code>  public void Load(string filename, Excel.XlFileFormat format = Excel.XlFileFormat.xlCSV) { app = new Excel.Application(); book = app.Workbooks.Open(Filename: filename, Format: format); DataSet ds = new DataSet(); foreach (Excel.Worksheet sheet in book.Sheets) { DataTable dt = new DataTable(sheet.Name); ds.Tables.Add(dt); //??? Fill dt from sheet } this.Data = ds; }",How do I import from Excel to a DataSet using Microsoft.Office.Interop.Excel?
WPF application locks Windows 7, I have a .NET 3.5 WPF application on Windows 7 64bit. I am experiencing odd system freeze issue that happens when dragging and moving the main application window. Basically the entire system freezes (UI) and the application stops rendering. Bringing up the task manager (CTRL+ALT+DEL) unfreezes both system and the application. The application itself is a trading application that processes a large amount of messages in background threads.Has anyone experienced this type of issues ? Especially the oddity of task manager unlocking the freeze. What could be the reason for this strange behavior? I am almost certain it has something to do with dispatching certain actions to the UI thread. <code> ,WPF application freezes Windows 7
C#: What is simpliest way to get Line number from char position in String?," What is simpliest way to get Line number from char position in String in C#? (or get Position of line (first char in line) )Is there any built-in function ? If there are no such function is it good solution to write extension like : ?Edited: Added method PosFromLine <code>  public static class StringExt { public static int LineFromPos(this String S, int Pos) { int Res = 1; for (int i = 0; i <= Pos - 1; i++) if (S[i] == '\n') Res++; return Res; } public static int PosFromLine(this String S, int Pos) { .... }}",What is simpliest way to get Line number from char position in String?
C# programming question," I want to get a number from the user, and then multiply that number with Pi. my attempt at this is below. But a contains gibberish. For example, if I insert 22, then a contains 50. What am I doing wrong? I don't get any compiler errors. <code>  double a,b;a = Console.Read();b = a * Math.PI;Console.WriteLine(b);",How can I read user input from the console?
Read user input form console," I want to get a number from the user, and then multiply that number with Pi. my attempt at this is below. But a contains gibberish. For example, if I insert 22, then a contains 50. What am I doing wrong? I don't get any compiler errors. <code>  double a,b;a = Console.Read();b = a * Math.PI;Console.WriteLine(b);",How can I read user input from the console?
Read user input from console," I want to get a number from the user, and then multiply that number with Pi. my attempt at this is below. But a contains gibberish. For example, if I insert 22, then a contains 50. What am I doing wrong? I don't get any compiler errors. <code>  double a,b;a = Console.Read();b = a * Math.PI;Console.WriteLine(b);",How can I read user input from the console?
Acitve Directory COM Exception - An operations error occured (0x80072020)," I am getting an intermittent COM Exception ""An operations error occurred (0x80072020)"" (shown below) when I try and query Active Directory using the method GroupPrincipal.FindByIdentityHere is my code: I am receiving Exception: The code is running from a Windows service on a Windows 2003 SP2 server.I have found another Stack Overflow question, Active Directory, enumerating user's groups, COM exception, suggesting that enabling Kerberos as an option in the PrincipalContext constructor will fix this problem but I am receiving a different hex code than in this question.My questions are:Is this particular COM Exception definitely an authentication issue? I need to be sure that this will 100% fix the problem before releasing the software.Is there a resource somewhere which lists all the possible COM exception hex codes so that I can help myself a bit better in the future? <code>  PrincipalContext ctx = new PrincipalContext(ContextType.Domain, Environment.UserDomainName);GroupPrincipal groupPrincipal = GroupPrincipal.FindByIdentity(ctx, IdentityType.Name, ""Group to find""); Inner Exception: System.Runtime.InteropServices.COMException (0x80072020): An operations error occurred. at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail) at System.DirectoryServices.DirectoryEntry.Bind() at System.DirectoryServices.DirectoryEntry.get_AdsObject() at System.DirectoryServices.PropertyValueCollection.PopulateList() at System.DirectoryServices.PropertyValueCollection..ctor(DirectoryEntry entry, String propertyName) at System.DirectoryServices.PropertyCollection.get_Item(String propertyName) at System.DirectoryServices.AccountManagement.PrincipalContext.DoLDAPDirectoryInitNoContainer() at System.DirectoryServices.AccountManagement.PrincipalContext.DoDomainInit() at System.DirectoryServices.AccountManagement.PrincipalContext.Initialize() at System.DirectoryServices.AccountManagement.PrincipalContext.get_QueryCtx() at System.DirectoryServices.AccountManagement.Principal.FindByIdentityWithTypeHelper(PrincipalContext context, Type principalType, Nullable`1 identityType, String identityValue, DateTime refDate) at System.DirectoryServices.AccountManagement.Principal.FindByIdentityWithType(PrincipalContext context, Type principalType, IdentityType identityType, String identityValue) at System.DirectoryServices.AccountManagement.GroupPrincipal.FindByIdentity(PrincipalContext context, IdentityType identityType, String identityValue)",Active Directory COM Exception - An operations error occurred (0x80072020)
Active Directory COM Exception - An operations error occured (0x80072020)," I am getting an intermittent COM Exception ""An operations error occurred (0x80072020)"" (shown below) when I try and query Active Directory using the method GroupPrincipal.FindByIdentityHere is my code: I am receiving Exception: The code is running from a Windows service on a Windows 2003 SP2 server.I have found another Stack Overflow question, Active Directory, enumerating user's groups, COM exception, suggesting that enabling Kerberos as an option in the PrincipalContext constructor will fix this problem but I am receiving a different hex code than in this question.My questions are:Is this particular COM Exception definitely an authentication issue? I need to be sure that this will 100% fix the problem before releasing the software.Is there a resource somewhere which lists all the possible COM exception hex codes so that I can help myself a bit better in the future? <code>  PrincipalContext ctx = new PrincipalContext(ContextType.Domain, Environment.UserDomainName);GroupPrincipal groupPrincipal = GroupPrincipal.FindByIdentity(ctx, IdentityType.Name, ""Group to find""); Inner Exception: System.Runtime.InteropServices.COMException (0x80072020): An operations error occurred. at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail) at System.DirectoryServices.DirectoryEntry.Bind() at System.DirectoryServices.DirectoryEntry.get_AdsObject() at System.DirectoryServices.PropertyValueCollection.PopulateList() at System.DirectoryServices.PropertyValueCollection..ctor(DirectoryEntry entry, String propertyName) at System.DirectoryServices.PropertyCollection.get_Item(String propertyName) at System.DirectoryServices.AccountManagement.PrincipalContext.DoLDAPDirectoryInitNoContainer() at System.DirectoryServices.AccountManagement.PrincipalContext.DoDomainInit() at System.DirectoryServices.AccountManagement.PrincipalContext.Initialize() at System.DirectoryServices.AccountManagement.PrincipalContext.get_QueryCtx() at System.DirectoryServices.AccountManagement.Principal.FindByIdentityWithTypeHelper(PrincipalContext context, Type principalType, Nullable`1 identityType, String identityValue, DateTime refDate) at System.DirectoryServices.AccountManagement.Principal.FindByIdentityWithType(PrincipalContext context, Type principalType, IdentityType identityType, String identityValue) at System.DirectoryServices.AccountManagement.GroupPrincipal.FindByIdentity(PrincipalContext context, IdentityType identityType, String identityValue)",Active Directory COM Exception - An operations error occurred (0x80072020)
How can i get a part of an image and use it as a separate image?, I have a tileset but all the tiles are in one image. I want to get every tile in some kind of bitmap or image array.Is there some kind of method that does that? <code> ,How to get a part of an image and use it as a separate image?
How do I read a image file in c#," This is how I save images. I don't want to display the image from that location. I want rather to read it first for further processing. How do I read the image file in that case? <code>  [HttpPost]public ActionResult Create(HttpPostedFileBase file){ if (file != null) { var extension = Path.GetExtension(file.FileName); var fileName = Guid.NewGuid().ToString() + extension; var path = Path.Combine(Server.MapPath(""~/Content/Photos""), fileName); file.SaveAs(path); //... }}",How to read an image file to a byte[]?
read an image file," This is how I save images. I don't want to display the image from that location. I want rather to read it first for further processing. How do I read the image file in that case? <code>  [HttpPost]public ActionResult Create(HttpPostedFileBase file){ if (file != null) { var extension = Path.GetExtension(file.FileName); var fileName = Guid.NewGuid().ToString() + extension; var path = Path.Combine(Server.MapPath(""~/Content/Photos""), fileName); file.SaveAs(path); //... }}",How to read an image file to a byte[]?
"Is it possible to know, is file mp3 or not?"," How can I determine that a particular file (which may or may not have an "".mp3"" file extension) is in fact an MP3 file? I wish to do this in C#. <code> ",How can I determine that a particular file is in fact an MP3 file?
Linq to Objects ordering by arbitrary number of paramaters," I have a list of Func defining an ordering: I can order the results with something like... I'm trying to figure how to do the above when the list can contain any number of sequential orderings. Is it possible? <code>  var ordering = new List<Func<Person, IComparable>> { x => x.Surname, x => x.FirstName }; people = people.OrderBy(ordering[0]).ThenBy(ordering[1]);",Linq to Objects ordering by arbitrary number of parameters
WCF & C# - System.InvalidOperationException : XmlSerializer attribute System.Xml.Serialization.XmlChoiceIdentifierAttribute is not valid in Item," I have been trying to connect to some web services using WCF but I keep getting an error when I try to call the function I need.This is the error I'm getting:System.InvalidOperationException : XmlSerializer attribute System.Xml.Serialization.XmlChoiceIdentifierAttribute is not valid in Item. Only XmlElement, XmlArray, XmlArrayItem, XmlAnyAttribute and XmlAnyElement attributes are supported when IsWrapped is true.The error happens before it even gets to calling the actual service and it doesn't even occur because of the method I'm trying to call. The issue is with another method that's defined in the WCF generated class.I have been able to trace the issue to a section of code in the XSD that is used to define the WSDL: The corresponding generated code: When I comment out the above enum and all references to it, the service works. There are other xs:choice statements in the XSD that don't seem to cause any problems. Update:Further investigation revealed that when you have the following:The element is defined directly inside of a sequence element: The proxy generated by svcutil causes the error noted above.When changed to look like this: The error goes away. So it may be a bug with the code the generator (svcutil) generates.I will need to call all the methods in the WSDL, so commenting out the ones that don't work isn't an option. And I need to get it working without changing the WSDL (which is the client's, not ours). Any help would be appreciated.  <code>  <xs:choice minOccurs=""0""><xs:element name=""additionalSocInd"" type=""tns:BinaryExpressionType""/><xs:element name=""skipServiceValidationInd"" type=""tns:BinaryExpressionType""/></xs:choice> [System.CodeDom.Compiler.GeneratedCodeAttribute(""svcutil"", ""4.0.30319.1"")][System.SerializableAttribute()] [System.Xml.Serialization.XmlTypeAttribute(Namespace=""http:integration.sprint.com/interfaces/manageSubscriberServices/v1/manageSubscr"" + ""iberServices.xsd"", IncludeInSchema=false)]public enum ItemChoiceType2{ additionalSocInd, skipServiceValidationInd,} <xs:sequence><xs:element ... />...<xs:choice minOccurs=""0""><xs:element name=""additionalSocInd"" type=""tns:BinaryExpressionType"" /><xs:element name=""skipServiceValidationInd"" type=""tns:BinaryExpressionType"" /></xs:choice>...<xs:element ... /></xs:sequence> <xs:sequence><xs:element ... />...<xs:element minOccurs=""0"" name=""myChoiceType"" type=""tns:MyChoiceType"" />...<xs:element ... /></xs:sequence><xs:complexType name=""MyChoiceType""><xs:choice><xs:element name=""additionalSocInd"" type=""tns:BinaryExpressionType"" /><xs:element name=""skipServiceValidationInd"" type=""tns:BinaryExpressionType"" /></xs:choice></xs:complexType>",System.InvalidOperationException : XmlSerializer attribute System.Xml.Serialization.XmlChoiceIdentifierAttribute is not valid in Item
EF4.1 Log table Included from multiple Entities gets NotSupportedException?," Edit: Updated problem description based on testing - 12 Sep 2011.I have this query that throws a NotSupportedException (""Specified method is not supported."") whenever I call .ToList(). If I comment out either line that I have commented as ""bad"", then the query works. I have also tried including different nested entities in my object model with the same effect. Including any 2 will cause a crash. By nested, I mean a navigation property of a navigation property. I also tried using the .Include methods with a string path: same result.My table structure looks like this:This is using MySQL 5.1 (InnoDB tables obviously) as the database store with MySQL Connector/NET 6.3.4.So my question is: Why doesn't this work?Note: I can get it to work if I explicitly load the related entities like in this link. But I want to know why EF hates my data model.ANSWER: MySQL Connector is apparently not capable of handling the 2nd nested entity include. It throws the NotSupportedException, not .NET EF. This same error was also present when I tried this using EF4.0, but my research at the time led me to believe it was self-tracking entities causing the issue. I tried upgrading to latest Connector, but it started causing an Out of Sync error. This is yet another reason for me to hate MySQL. <code>  IQueryable<FileDefinition> query = db .FileDefinitions .Include(x => x.DefinitionChangeLogs) .Include(x => x.FieldDefinitions.Select(y => y.DefinitionChangeLogs)) // bad .Include(x => x.FieldDefinitions.Select(y => y.FieldValidationTables)) // bad .Where(x => x.IsActive);List<FileDefinition> retval = query.ToList();",EF4.1 multiple nested entity Includes gets NotSupportedException?
Is there a Dictionary preserves entries insertion order order?," Actually I need something like List<KeyValuePair<T, U>> but I want to be able to initialize it like dictionary (i.e. without writing new KeyValuePair every time). Like this: <code>  Dictionary<string, string> dic = new Dictionary<string, string>{ { ""key1"", ""value1""}, { ""key2"", ""value2""}};","Is there a an easier way to initialize a List<KeyValuePair<T, U>>, like a Dictionary<T, U>?"
c# splitting a string and not returning empty string," I have a string: And I would like to split it this way: How can I make sure that I return only 1, 2, 3 and not an 'empty string'?If I split 1;2;3 then I will get what I want. But if I split 1;2;3; then I get an extra 'empty string'. I have taken suggestions and done this: However, I am getting these errors: Error 1 The best overloaded method match for 'string.Split(params char[])' has some invalid arguments C:\Documents and Settings\agordon\My Documents\Visual Studio 2008\Projects\lomdb\EnterData\DataEntry\DAL.cs 18 36 EnterData Error 2 Argument '2': cannot convert from 'System.StringSplitOptions' to 'char' C:\Documents and Settings\agordon\My Documents\Visual Studio 2008\Projects\lomdb\EnterData\DataEntry\DAL.cs 18 68 EnterData <code>  a = ""1;2;3;"" foreach (string b in a.split(';')) string[] batchstring = batch_idTextBox.Text.Split(';', StringSplitOptions.RemoveEmptyEntries);",C#: splitting a string and not returning empty string
Nlog how to Specify the origin of the logging," I have a class that wraps NLog (called NLogger). My logs are saved to my database.The thing I'm having a problem with is how do I show where the logging occured.I have this but this just shows Core.Logging.Loggers.NLogLogger.Log which is my NlogWrapper not the class which calls my wrapper. This is my wrapper method <code>  <parameter name=""@Logger"" layout=""${callsite}""/> public void Log(LogType messageType, Type context, string message, Exception exception) { NLog.Logger logger = NLog.LogManager.GetLogger(context.Name); LogLevel logLevel = LogLevel.Info; // Default level to info switch (messageType) { case LogType.Debug: logLevel = LogLevel.Debug; break; case LogType.Info: logLevel = LogLevel.Info; break; case LogType.Warning: logLevel = LogLevel.Warn; break; case LogType.Error: logLevel = LogLevel.Error; break; case LogType.Fatal: logLevel = LogLevel.Fatal; break; default: throw new ArgumentException(""Log message type is not supported""); } logger.Log(logLevel, message, exception); }",How to retain callsite information when wrapping NLog
How get range of datetime not included in a interval," I have a interval of number [1, 20]. I want a method which returns me range of number available if I decide to ban range [15, 18]. My method should return me a list containing [1,15] and [18, 20]Range object could looks like something like that Any help would be appreciated. <code>  public class Range{ int Start {get;set;} int End {get;set;}}",How get range of numbers
WPF ConverterParameter -- Any way to pass in some delimited list?," Basically, if I have: How would you go about passing in some type of array of items as the ConverterParameter. I figured I could pass in some type of delimited list, but I'm not sure what type of delimiter to use, or if there is a built-in way to pass in an array of parameters? <code>  <TextBlock Text=""{Binding MyValue, Converter={StaticResource TransformedTextConverter}, ConverterParameter=?}"" />",ConverterParameter -- Any way to pass in some delimited list?
cannot drop database because it is currently in use," I want to drop a database. I have used the following code, but to no avail. I am getting Error as cannot drop database because it is currently in use.Please help me out in the above mentioned issue. <code>  public void DropDataBase(string DBName,SqlConnection scon){ try { SqlConnection.ClearAllPools(); SqlCommand cmd = new SqlCommand(""ALTER DATABASE "" + DBName + "" SET SINGLE_USER WITH ROLLBACK IMMEDIATE"", scon); cmd.CommandType = CommandType.Text; scon.Open(); cmd.ExecuteNonQuery(); scon.Close(); SqlCommand cmddrpdb = new SqlCommand(""drop database "" + DBName + """", scon); cmddrpdb.CommandType = CommandType.Text; scon.Open(); cmddrpdb.ExecuteNonQuery(); scon.Close(); } catch (Exception ex) { MessageBox.Show(""DropDataBase : "" +ex.Message); }}",Cannot drop database because it is currently in use
"replace ""\\"" with ""\"" in a string in C#"," I still don't get how to do this. I saw many posts regarding this, but none of the solutions worked for me.I have a string called ""a\\b"". The result I need is ""a\b"". How is this done?I have a text file which has a database connection string pointing to an instance called - Server\DbInstanceMy aim is to do a string replace in the text file -- replace ""Server\DbInstance"" with another value, say ""10.11.12.13, 1200"".So I have: This is where the problem starts. My stringToBeReplaced will always be ""Server\\DbInstance"", and when I search for this string in my text file, the search fails, as the text file doesn't have a string ""Server\\DbInstance""; instead it has only ""Server\DbInstance"". So how do change ""Server\\DbInstance"" to ""Server\DbInstance""? <code>  stringToBeReplaced = @""Server\DbInstance"";newString = @""10.11.12.13, 1200"";","Replace ""\\"" with ""\"" in a string in C#"
Get last 'N' quarters in C#," Suppose the current quater is 3 and the year is 2011. How can I get the last 5 quartersDesired output: The Q and '-' is appended.I am trying as under Thanks <code>  Q3-2011Q2-2011Q1-2011Q4-2010Q3-2010 int generateQuater = 5; int currentQuater = 3;//GetQuarter(DateTime.Now.Month); int currentYear = DateTime.Now.Year; List<string> lstQuaterYear = new List<string>(); lstQuaterYear.Add(string.Concat('Q',currentQuater, '-', currentYear)); for (int i = generateQuater; i > 0; i++) { //code to be placed }",Time operation in C#
How to simplify complex O(n<sup>2</sup>)," I have people and places data as:Person entity hasIList<DateRangePlaces> each havingIList<Place> of possible places Schedule day pattern as ie. 10 days available 4 unavailableWithin a particular DateRangePlaces date range one has to obey to Schedule pattern whether person can go to a particular place or not.Place entity hasIList<DateRangeTiming> each defining opening/closing times within each date rangeOverlapping date ranges work as LIFO. So for each day that has already been defined previously new timing definition takes preference.The problemNow I need to do something like this (in pseudo code): This means that number of steps to execute my task is approx.: ∑(places)( ∑(days) ∑(people) )This to my understanding is O(x yx z)and likely approximates to this algorithm complexity: O(n3) I'm not an expert in theory so you can freely correct my assumptions. What is true is that this kind of complexity is definitely not acceptable especially given the fact that I will be operating over long date ranges with many places and people.From the formula approximation we can see that people set would be iterated lots of times. Hence I would like to optimize at least this part. To ease things a bit I changed to which would give me a faster result whether a person can go to some place on particular date, because I would only check whether Place.Id is present in the dictionary versus IList.Where() LINQ clause that would have to scan the whole list each and every time.QuestionCan you suggest any additional optimizations I could implement into my algorithm to make it faster or even make it less complex in terms of the big O notation?Which memory structure types would you use where and why (lists, dictionaries, stacks, queues...) to improve performance?Addendum: The whole problem is even more complexThere're also additional complexities that I didn't mention since I wanted to simplify my question to make it more clear. So. There's also: So places require particular permissions and people have a limited time permission grants that expire.Additional to that, there's also which tells only particular times that person can go somewhere during particular date range. And Which defines place prioritization for a particular date range.And during this process of getting applicable people I also have to calculate certain factor per every person per every place that's related to the:number of places that a person can visit on particular dayperson's place priority factor on that particular dayAll these are the reasons why I decided to rather manipulate this data in memory than using a very complex stored procedure that would also be doing multiple table scans to get factors per person and place and day.I think such stored procedure would be way to complex to handle and maintain. So I rather get all the data first (put it appropriate memory structures to aid performance) and then mangle with it in memory. <code>  for each Place{ for each Day between minimum and maximum date in IList<DateRangeTiming> { get a set of People applicable for Place and on Day }} Person.IList<DateRangePlaces>.IList<Place> Person.IList<DateRangePlaces>.IDictionary<int, Place> Place.IList<Permission>Person.IList<DateRangePermission> Person.IList<DateRangeTimingRestriction> Person.IList<DateRangePlacePriorities>",Advanced: How to optimize my complex O(n) algorithm
How to simplify complex O(n^2)," I have people and places data as:Person entity hasIList<DateRangePlaces> each havingIList<Place> of possible places Schedule day pattern as ie. 10 days available 4 unavailableWithin a particular DateRangePlaces date range one has to obey to Schedule pattern whether person can go to a particular place or not.Place entity hasIList<DateRangeTiming> each defining opening/closing times within each date rangeOverlapping date ranges work as LIFO. So for each day that has already been defined previously new timing definition takes preference.The problemNow I need to do something like this (in pseudo code): This means that number of steps to execute my task is approx.: ∑(places)( ∑(days) ∑(people) )This to my understanding is O(x yx z)and likely approximates to this algorithm complexity: O(n3) I'm not an expert in theory so you can freely correct my assumptions. What is true is that this kind of complexity is definitely not acceptable especially given the fact that I will be operating over long date ranges with many places and people.From the formula approximation we can see that people set would be iterated lots of times. Hence I would like to optimize at least this part. To ease things a bit I changed to which would give me a faster result whether a person can go to some place on particular date, because I would only check whether Place.Id is present in the dictionary versus IList.Where() LINQ clause that would have to scan the whole list each and every time.QuestionCan you suggest any additional optimizations I could implement into my algorithm to make it faster or even make it less complex in terms of the big O notation?Which memory structure types would you use where and why (lists, dictionaries, stacks, queues...) to improve performance?Addendum: The whole problem is even more complexThere're also additional complexities that I didn't mention since I wanted to simplify my question to make it more clear. So. There's also: So places require particular permissions and people have a limited time permission grants that expire.Additional to that, there's also which tells only particular times that person can go somewhere during particular date range. And Which defines place prioritization for a particular date range.And during this process of getting applicable people I also have to calculate certain factor per every person per every place that's related to the:number of places that a person can visit on particular dayperson's place priority factor on that particular dayAll these are the reasons why I decided to rather manipulate this data in memory than using a very complex stored procedure that would also be doing multiple table scans to get factors per person and place and day.I think such stored procedure would be way to complex to handle and maintain. So I rather get all the data first (put it appropriate memory structures to aid performance) and then mangle with it in memory. <code>  for each Place{ for each Day between minimum and maximum date in IList<DateRangeTiming> { get a set of People applicable for Place and on Day }} Person.IList<DateRangePlaces>.IList<Place> Person.IList<DateRangePlaces>.IDictionary<int, Place> Place.IList<Permission>Person.IList<DateRangePermission> Person.IList<DateRangeTimingRestriction> Person.IList<DateRangePlacePriorities>",Advanced: How to optimize my complex O(n) algorithm
How to simplify complex O(n^2)," I have people and places data as:Person entity hasIList<DateRangePlaces> each havingIList<Place> of possible places Schedule day pattern as ie. 10 days available 4 unavailableWithin a particular DateRangePlaces date range one has to obey to Schedule pattern whether person can go to a particular place or not.Place entity hasIList<DateRangeTiming> each defining opening/closing times within each date rangeOverlapping date ranges work as LIFO. So for each day that has already been defined previously new timing definition takes preference.The problemNow I need to do something like this (in pseudo code): This means that number of steps to execute my task is approx.: ∑(places)( ∑(days) ∑(people) )This to my understanding is O(x yx z)and likely approximates to this algorithm complexity: O(n3) I'm not an expert in theory so you can freely correct my assumptions. What is true is that this kind of complexity is definitely not acceptable especially given the fact that I will be operating over long date ranges with many places and people.From the formula approximation we can see that people set would be iterated lots of times. Hence I would like to optimize at least this part. To ease things a bit I changed to which would give me a faster result whether a person can go to some place on particular date, because I would only check whether Place.Id is present in the dictionary versus IList.Where() LINQ clause that would have to scan the whole list each and every time.QuestionCan you suggest any additional optimizations I could implement into my algorithm to make it faster or even make it less complex in terms of the big O notation?Which memory structure types would you use where and why (lists, dictionaries, stacks, queues...) to improve performance?Addendum: The whole problem is even more complexThere're also additional complexities that I didn't mention since I wanted to simplify my question to make it more clear. So. There's also: So places require particular permissions and people have a limited time permission grants that expire.Additional to that, there's also which tells only particular times that person can go somewhere during particular date range. And Which defines place prioritization for a particular date range.And during this process of getting applicable people I also have to calculate certain factor per every person per every place that's related to the:number of places that a person can visit on particular dayperson's place priority factor on that particular dayAll these are the reasons why I decided to rather manipulate this data in memory than using a very complex stored procedure that would also be doing multiple table scans to get factors per person and place and day.I think such stored procedure would be way to complex to handle and maintain. So I rather get all the data first (put it appropriate memory structures to aid performance) and then mangle with it in memory. <code>  for each Place{ for each Day between minimum and maximum date in IList<DateRangeTiming> { get a set of People applicable for Place and on Day }} Person.IList<DateRangePlaces>.IList<Place> Person.IList<DateRangePlaces>.IDictionary<int, Place> Place.IList<Permission>Person.IList<DateRangePermission> Person.IList<DateRangeTimingRestriction> Person.IList<DateRangePlacePriorities>",Advanced: How to optimize my complex O(n) algorithm
How to simplify complex O(n)," I have people and places data as:Person entity hasIList<DateRangePlaces> each havingIList<Place> of possible places Schedule day pattern as ie. 10 days available 4 unavailableWithin a particular DateRangePlaces date range one has to obey to Schedule pattern whether person can go to a particular place or not.Place entity hasIList<DateRangeTiming> each defining opening/closing times within each date rangeOverlapping date ranges work as LIFO. So for each day that has already been defined previously new timing definition takes preference.The problemNow I need to do something like this (in pseudo code): This means that number of steps to execute my task is approx.: ∑(places)( ∑(days) ∑(people) )This to my understanding is O(x yx z)and likely approximates to this algorithm complexity: O(n3) I'm not an expert in theory so you can freely correct my assumptions. What is true is that this kind of complexity is definitely not acceptable especially given the fact that I will be operating over long date ranges with many places and people.From the formula approximation we can see that people set would be iterated lots of times. Hence I would like to optimize at least this part. To ease things a bit I changed to which would give me a faster result whether a person can go to some place on particular date, because I would only check whether Place.Id is present in the dictionary versus IList.Where() LINQ clause that would have to scan the whole list each and every time.QuestionCan you suggest any additional optimizations I could implement into my algorithm to make it faster or even make it less complex in terms of the big O notation?Which memory structure types would you use where and why (lists, dictionaries, stacks, queues...) to improve performance?Addendum: The whole problem is even more complexThere're also additional complexities that I didn't mention since I wanted to simplify my question to make it more clear. So. There's also: So places require particular permissions and people have a limited time permission grants that expire.Additional to that, there's also which tells only particular times that person can go somewhere during particular date range. And Which defines place prioritization for a particular date range.And during this process of getting applicable people I also have to calculate certain factor per every person per every place that's related to the:number of places that a person can visit on particular dayperson's place priority factor on that particular dayAll these are the reasons why I decided to rather manipulate this data in memory than using a very complex stored procedure that would also be doing multiple table scans to get factors per person and place and day.I think such stored procedure would be way to complex to handle and maintain. So I rather get all the data first (put it appropriate memory structures to aid performance) and then mangle with it in memory. <code>  for each Place{ for each Day between minimum and maximum date in IList<DateRangeTiming> { get a set of People applicable for Place and on Day }} Person.IList<DateRangePlaces>.IList<Place> Person.IList<DateRangePlaces>.IDictionary<int, Place> Place.IList<Permission>Person.IList<DateRangePermission> Person.IList<DateRangeTimingRestriction> Person.IList<DateRangePlacePriorities>",Advanced: How to optimize my complex O(n) algorithm
How to simplify my complex O(n) algorithm," I have people and places data as:Person entity hasIList<DateRangePlaces> each havingIList<Place> of possible places Schedule day pattern as ie. 10 days available 4 unavailableWithin a particular DateRangePlaces date range one has to obey to Schedule pattern whether person can go to a particular place or not.Place entity hasIList<DateRangeTiming> each defining opening/closing times within each date rangeOverlapping date ranges work as LIFO. So for each day that has already been defined previously new timing definition takes preference.The problemNow I need to do something like this (in pseudo code): This means that number of steps to execute my task is approx.: ∑(places)( ∑(days) ∑(people) )This to my understanding is O(x yx z)and likely approximates to this algorithm complexity: O(n3) I'm not an expert in theory so you can freely correct my assumptions. What is true is that this kind of complexity is definitely not acceptable especially given the fact that I will be operating over long date ranges with many places and people.From the formula approximation we can see that people set would be iterated lots of times. Hence I would like to optimize at least this part. To ease things a bit I changed to which would give me a faster result whether a person can go to some place on particular date, because I would only check whether Place.Id is present in the dictionary versus IList.Where() LINQ clause that would have to scan the whole list each and every time.QuestionCan you suggest any additional optimizations I could implement into my algorithm to make it faster or even make it less complex in terms of the big O notation?Which memory structure types would you use where and why (lists, dictionaries, stacks, queues...) to improve performance?Addendum: The whole problem is even more complexThere're also additional complexities that I didn't mention since I wanted to simplify my question to make it more clear. So. There's also: So places require particular permissions and people have a limited time permission grants that expire.Additional to that, there's also which tells only particular times that person can go somewhere during particular date range. And Which defines place prioritization for a particular date range.And during this process of getting applicable people I also have to calculate certain factor per every person per every place that's related to the:number of places that a person can visit on particular dayperson's place priority factor on that particular dayAll these are the reasons why I decided to rather manipulate this data in memory than using a very complex stored procedure that would also be doing multiple table scans to get factors per person and place and day.I think such stored procedure would be way to complex to handle and maintain. So I rather get all the data first (put it appropriate memory structures to aid performance) and then mangle with it in memory. <code>  for each Place{ for each Day between minimum and maximum date in IList<DateRangeTiming> { get a set of People applicable for Place and on Day }} Person.IList<DateRangePlaces>.IList<Place> Person.IList<DateRangePlaces>.IDictionary<int, Place> Place.IList<Permission>Person.IList<DateRangePermission> Person.IList<DateRangeTimingRestriction> Person.IList<DateRangePlacePriorities>",Advanced: How to optimize my complex O(n) algorithm
How to optimize my complex O(n) algorithm," I have people and places data as:Person entity hasIList<DateRangePlaces> each havingIList<Place> of possible places Schedule day pattern as ie. 10 days available 4 unavailableWithin a particular DateRangePlaces date range one has to obey to Schedule pattern whether person can go to a particular place or not.Place entity hasIList<DateRangeTiming> each defining opening/closing times within each date rangeOverlapping date ranges work as LIFO. So for each day that has already been defined previously new timing definition takes preference.The problemNow I need to do something like this (in pseudo code): This means that number of steps to execute my task is approx.: ∑(places)( ∑(days) ∑(people) )This to my understanding is O(x yx z)and likely approximates to this algorithm complexity: O(n3) I'm not an expert in theory so you can freely correct my assumptions. What is true is that this kind of complexity is definitely not acceptable especially given the fact that I will be operating over long date ranges with many places and people.From the formula approximation we can see that people set would be iterated lots of times. Hence I would like to optimize at least this part. To ease things a bit I changed to which would give me a faster result whether a person can go to some place on particular date, because I would only check whether Place.Id is present in the dictionary versus IList.Where() LINQ clause that would have to scan the whole list each and every time.QuestionCan you suggest any additional optimizations I could implement into my algorithm to make it faster or even make it less complex in terms of the big O notation?Which memory structure types would you use where and why (lists, dictionaries, stacks, queues...) to improve performance?Addendum: The whole problem is even more complexThere're also additional complexities that I didn't mention since I wanted to simplify my question to make it more clear. So. There's also: So places require particular permissions and people have a limited time permission grants that expire.Additional to that, there's also which tells only particular times that person can go somewhere during particular date range. And Which defines place prioritization for a particular date range.And during this process of getting applicable people I also have to calculate certain factor per every person per every place that's related to the:number of places that a person can visit on particular dayperson's place priority factor on that particular dayAll these are the reasons why I decided to rather manipulate this data in memory than using a very complex stored procedure that would also be doing multiple table scans to get factors per person and place and day.I think such stored procedure would be way to complex to handle and maintain. So I rather get all the data first (put it appropriate memory structures to aid performance) and then mangle with it in memory. <code>  for each Place{ for each Day between minimum and maximum date in IList<DateRangeTiming> { get a set of People applicable for Place and on Day }} Person.IList<DateRangePlaces>.IList<Place> Person.IList<DateRangePlaces>.IDictionary<int, Place> Place.IList<Permission>Person.IList<DateRangePermission> Person.IList<DateRangeTimingRestriction> Person.IList<DateRangePlacePriorities>",Advanced: How to optimize my complex O(n) algorithm
Enumeration naming conventions in DTO's," I'm creating an application facade in front of my domain model and using dto's for the exchanges between the consumer and the facade.In order to avoid having to fully qualify my namespaces where I'm mapping between dto's and the domain model, I've suffixed all my dto's with Dto. Ie. CustomerDto, AddressDto etc. I need to define an enum type as part of my dto's as well and am struggling with whether I should use the Dto suffix on my enum type. I'm curious what others have done with enum types that reside in their dto's. Any feedback is appreciated.Thank You <code> ",Enum type naming conventions in DTO's
what is the complexity of these Dictionary methods," Can anyone explain what is the complexity of the following Dictionary methods? I'm trying to figure out the complexity of a method I wrote: I assumed that the 2 dictionary methods are of log(n) complexity where n is the number of keys in the dictionary. Is this correct? <code>  ContainsKey(key)Add(key,value); public void DistinctWords(String s){ Dictionary<string,string> d = new Dictionary<string,string>(); String[] splitted = s.split("" ""); foreach ( String ss in splitted) { if (!d.containskey(ss)) d.add(ss,null); } }",What is the complexity of these Dictionary methods?
format XML when using XmlWriter ," I'm trying to write to an XML file to the isolated storage but I would like to format it like this:- but I'm buggered if I can work it out, can anyone help? <code>  <SampleData> <Item Property1=""AliquaXX"" /> <Item Property1=""Integer"" /> <Item Property1=""Quisque"" /> <Item Property1=""Aenean"" /> <Item Property1=""Mauris"" /> <Item Property1=""Vivamus"" /> <Item Property1=""Nullam"" /> <Item Property1=""Nam"" /> <Item Property1=""Sed"" /> <Item Property1=""Class"" /></SampleData>",Writing formatted XML with XmlWriter
Writing formatted XML with XmlWriter ," I'm trying to write to an XML file to the isolated storage but I would like to format it like this:- but I'm buggered if I can work it out, can anyone help? <code>  <SampleData> <Item Property1=""AliquaXX"" /> <Item Property1=""Integer"" /> <Item Property1=""Quisque"" /> <Item Property1=""Aenean"" /> <Item Property1=""Mauris"" /> <Item Property1=""Vivamus"" /> <Item Property1=""Nullam"" /> <Item Property1=""Nam"" /> <Item Property1=""Sed"" /> <Item Property1=""Class"" /></SampleData>",Writing formatted XML with XmlWriter
How to get the type of a property using switch-case in c#?," Possible Duplicate: Is there a better alternative than this to 'switch on type'?I need to iterate through all properties of my class and to check if its type of int the i need to do something, if its string .. then do something. I need it using switch-case. Here i am using switch in the following manner, but it asks for some constant. see the code below: Also i want to know , what check should I use, typeof(int) or typeof(Int32)? <code>  public static bool ValidateProperties(object o){ if(o !=null) { var sourceType = o.GetType(); var properties = sourceType.GetProperties(BindingFlags.Public | BindingFlags.Static); foreach (var property in properties) { var type = property.GetType(); switch (type) { *case typeof(int):* getting error here // d } } }}",How to use switch-case on a Type?
How does C#'s StringBuilder's capacity change?," When I have an empty StringBuilder with a capacity of 5 and I write ""hello, world!"" to it, does the C# standard specify the new capacity of the StringBuilder? I have a vague memory that it's twice the new string's length (to avoid changing the capacity with every new appended string). <code> ",How does StringBuilder's capacity change?
In c# - how to correctly deserialize a JSON string into the class that contains a nested List of another class," I have the following object graph and I'm using Jquery's $.Ajax() to send this identical ""View"" object in JSON (stringified) from the browser to a Page Method on ASP.Net. The JAvascript deserialization works for all of the strings and int's in the View class but My List<DataItem> is empty. What I tried: Using chrome dev tools, I took the stringified JSON, created a unit test and used both the DataContractJsonSerializer and the JavaScriptSerializer. The DataContractJsonSerializer object deserialized my object graph correctly but the JavaScriptSerializer dumped my List. How can I get the correct deserialization on my page method ? Instead of this (the view obj as a param). how can I get this? (the string param) My JSON looks like this. <code>  public class View{ public string Text { get; set; } public string AnotherText { get; set; } public Int SomeInt { get; set; } public List<DataItem> { get; set; }}public class DataItem{ public Person person {get;set}}public class Person{ public int Age {get;set}} var dataa = {mqvm: mqvmJSON }; $.ajax({ type: ""POST"", dataType: ""json"", contentType: ""application/json; charset=utf-8"", data: JSON.stringify( dataa ), url: ""GoHere.aspx/WebMethodName"", success: function(data) { alert(data.d); }, error: function(jqXHR, textStatus, errorThrown) { alert(jqXHR.responseText + ' ' + errorThrown); } }); [ScriptMethod(ResponseFormat = ResponseFormat.Json)] [WebMethod] public static string CreateResponseReview(View mqvm) { return ""Success""; } [ScriptMethod(ResponseFormat = ResponseFormat.Json)] [WebMethod] public static string CreateResponseReview(string mqvm) { //do manual JSON deserialization here. return ""Success""; } { ""Text"": ""6"", ""AnotherText"":""wow"" ""SomeInt"": 5, ""DataItem"":[ { ""person"":{ ""Age"":23 } }, { ""person"":{ ""Age"":42 } } ]}",How to correctly deserialize a JSON string into the class that contains a nested List of another class
C# .Net Find only non-inherited interfaces?," I am trying to perform a query on the interfaces of a class via reflection, however the method Type.GetInterfaces() returns all the inherited interfaces also.etc The code Will return a Type[] containing both ITest and ITesting, where as I only want ITest, is there another method which allows you to specify inheritance?Thanks,Alex.EDIT:From the answers below I gathered this, The above seems to work, correct me in the comments if it does not <code>  public class Test : ITest { }public interface ITest : ITesting { } typeof(Test).GetInterfaces(); Type t;t.GetInterfaces().Where(i => !t.GetInterfaces().Any(i2 => i2.GetInterfaces().Contains(i)));",Find only non-inherited interfaces?
Eval() method not accepting dot(.)," In my SQL Server table there is a column slno. (yes, it contains a dot) that is working fine in SQL Server. However, <%#Eval(""slno."")%> is giving an error: DataBinding: 'System.Data.DataRowView' does not contain a property with the name 'slno'.How can this be solved? I can't change column name in database: I am getting data from stored procedure so I cannot modify it. <code>  <ItemTemplate> <%#Eval(""slno."") %> </ItemTemplate>",How to use Eval() with a column name that contains a dot(.)?
WPF comboxbox auto select first item when data is available," I am looking for way to select the first item when data became available. But if no data in the source , then do not select. How to do it ? I am very new to WPF. <code>  <ComboBox Grid.Row=""5"" Grid.Column=""1"" IsEditable=""False"" ItemsSource=""{Binding Source={x:Static l:DirectXResolution.Resolutions}}"" ToolTip=""Resolutions""> <ComboBox.Resources> <l:ResolutionConverter x:Key=""resolutionConverter""/> </ComboBox.Resources> <ComboBox.Text> <MultiBinding Converter=""{StaticResource resolutionConverter}""> <Binding Path=""GameWidth"" Mode=""OneWayToSource""/> <Binding Path=""GameHeight"" Mode=""OneWayToSource""/> </MultiBinding> </ComboBox.Text></ComboBox>",Comboxbox auto select first item when data is available
"Improving ""shuffle"" effeciency"," Right now, I am using the following code to create a Shuffle extension: I am looking for a way more faster and efficient way to do this. Right now, using the Stopwatch class, it is taking about 20 seconds to shuffle 100,000,000 items. Does anyone have any ideas to make this faster? <code>  public static class SiteItemExtensions{ public static void Shuffle<T>(this IList<T> list) { var rng = new Random(); int n = list.Count; while (n > 1) { n--; int k = rng.Next(n + 1); T value = list[k]; list[k] = list[n]; list[n] = value; } }}","Improving ""shuffle"" efficiency"
How can I debug EF?," How can I debug the Entity Framework? Can I see which queries it is actually trying to execute to the SQL server, to troubleshoot issues? <code> ",How can I debug EF? (analyze SQL queries)
how to know a file is finished copy in C#.net?," I tried to use FileInfo.CreationTime, but it doesn't represent the copy finish time.I am trying to get a list of files in a directory. The problem is that the call also returns files which are not yet finished copying.If I try to use the file, it returns an error stating that the file is in use.How can you query for files that are fully copied?As below code. Directory.GetFiles() returns which are not yet finished copying.my test file size is over 200Mb. <code>  if(String.IsNullOrEmpty(strDirectoryPath)){ txtResultPrint.AppendText(""ERROR : Wrong Directory Name! ""); }else{ string[] newFiles = Directory.GetFiles(strDirectoryPath,""*.epk""); _epkList.PushNewFileList(newFiles); if(_epkList.IsNewFileAdded()){ foreach (var fileName in _epkList.GetNewlyAddedFile()){ txtResultPrint.AppendText(DateTime.Now.Hour + "":"" + DateTime.Now.Minute + "":"" + DateTime.Now.Second + "" => ""); txtResultPrint.AppendText(fileName + Environment.NewLine); this.Visible = true; notifyIconMain.Visible = true; } }else{ } }",querying a directory for files that are complete (not copy-in-progress)
How to make the datagridview line text in bold when i pick any row?, How do I make the datagridview line text in bold when I pick a row? <code> ,How to make the datagridview line text in bold when I pick a row?
Is it possible to 'strip' a C# dll?," I built a simple demo application in C# using a modular approach so it consists of one executable and a couple of DLLs. Suppose I put it in a zip file and hand it over to somebody, with the sole purpose they can try out the demo application simply by extracting the file and doubleclicking the exe.Now, to my understanding everybody that gets the application and the DLLs, can just add a reference to the DLLs in a Visual Studio project, and then start using whatever functions/classes they have as long as they are declared public. And hence, they can get access to a lot more than what I want them to access.Is there a way to disable this, and get a system that is somehwat like with C++ DLLs (e.g. I can give anyone a lot of C++ DLLs and they'll have a rather hard time using the functions/classes in it if they do not have the header files)? Can I somehow strip the DLLs so that they are still usable by the exe, but do not expose references? Or are there attributes or so that I can use in the code that say ""this class is usable only be DLLs/exes built by me""? <code> ",Is it possible to 'strip' a .NET DLL?
WPF - Why Does Binding to a Struct Not Work?," I've recently encountered an issue where I have an ObservableCollection bound to a ListView. People is a structure which I have written. So long as I set the value(s) of the People objects prior to binding, everything seems to work OK. However, when I try to set the values from the GUI at runtime, the underlying objects do not seem to reflect the change.I finally overcame this problem by simply changing People from a structure to a class. No other changes were necessary.Can someone please explain to me why this is? <code> ",Why Does Binding to a Struct Not Work?
retrieve varbinary(MAX) from sql server to byte[] in C#, I'm trying to get a varbinary(MAX) from SQL Server to a byte[] variable in C#.How can I do this? Thanks <code> ,Retrieve varbinary(MAX) from SQL Server to byte[] in C#
Retrieve varbinary(MAX) from sql server to byte[] in C#, I'm trying to get a varbinary(MAX) from SQL Server to a byte[] variable in C#.How can I do this? Thanks <code> ,Retrieve varbinary(MAX) from SQL Server to byte[] in C#
How to specify that HTTP 304 (NotModified) is not an error condition inside the Amazon S3 GetObject API?," BackgroundI am trying to make use of S3 as an 'infinity' large caching layer for some 'fairly' static XML documents. I want to ensure that the client application (which will be running on thousands of machines concurrently and requesting the XML documents many times per hour) only downloads these XML documents if their content has changed since the last time the client application downloaded them.ApproachOn Amazon S3, we can use HTTP ETAG for this. By default Amazon S3 objects have their ETAG set to the MD5 hash of the object. We can then specify the MD5 hash of the XML document inside the GetObjectRequest.ETagToNotMatch property. This ensures that when we make the AmazonS3.GetObject call (or in my case the async version AmazonS3.BeginGetObject and AmazonS3.EndGetObject), that if the document being requested has the same MD5 hash as is contained in the GetObjectRequest.ETagToNotMatch then S3 automatically returns the HTTP Status code 304 (NotModified) and the actual contents of the XML document is not downloaded.ProblemThe problem however is that when calling AmazonS3.GetObject (or it's async equivalent) the Amazon .Net API actually sees the HTTP Status code 304 (NotModified) as an error and it retries the get request three times and then finally throws an Amazon.S3.AmazonS3Exception: Maximum number of retry attempts reached : 3.Obviously I could change this implementation to use AmazonS3.GetObjectMetaData and then compare the ETAG and use AmazonS3.GetObject if they do not match, but then there are two requests to S3 instead of one when the file is stale. I'd prefer to have one request regardless of whether the XML document needs downloaded or not.Any ideas? Is this a bug or am I missing something? Is there even some way I can reduce the number of retries to one and 'process' the exception (although I feel 'yuck' about this route).ImplementationI'm using the AWS SDK for .NET (version 1.3.14).Here is my implementation (reduced slightly to keep it shorter): I then call this like: This then produces this log file output: <code>  public Task<GetObjectResponse> DownloadString(string key, string etag = null) { var request = new GetObjectRequest { Key = key, BucketName = Bucket }; if (etag != null) { request.ETagToNotMatch = etag; } var task = Task<GetObjectResponse>.Factory.FromAsync(_s3Client.BeginGetObject, _s3Client.EndGetObject, request, null); return task;} var dlTask = s3Manager.DownloadString(""new one"", ""d7db7bc318d6eb9222d728747879b52e"");var responseTasks = new[] { dlTask.ContinueWith(x => _log.Error(""Error downloading string."", x.Exception), TaskContinuationOptions.OnlyOnFaulted), dlTask.ContinueWith(x => _log.Warn(""Downloading string was cancelled.""), TaskContinuationOptions.OnlyOnCanceled), dlTask.ContinueWith(x => _log.Info(string.Format(""Done with download: {0}"", x.Result.ETag)), TaskContinuationOptions.OnlyOnRanToCompletion) };try { Task.WaitAny(responseTasks);} catch (AggregateException aex) { _log.Error(""Error while processing download string."", aex);}_log.Info(""Exiting...""); 2011-10-11 13:21:20,376 [11] INFO Amazon.S3.AmazonS3Client - Received response for GetObject (id 2ee99002-d148-4572-b19b-29259534f48f) with status code NotModified in 00:00:01.6140812.2011-10-11 13:21:20,385 [11] INFO Amazon.S3.AmazonS3Client - Request for GetObject is being redirect to https://s3.amazonaws.com/x/new%20one.2011-10-11 13:21:20,789 [11] INFO Amazon.S3.AmazonS3Client - Retry number 1 for request GetObject.2011-10-11 13:21:22,329 [11] INFO Amazon.S3.AmazonS3Client - Received response for GetObject (id 2ee99002-d148-4572-b19b-29259534f48f) with status code NotModified in 00:00:01.1400356.2011-10-11 13:21:22,329 [11] INFO Amazon.S3.AmazonS3Client - Request for GetObject is being redirect to https://s3.amazonaws.com/x/new%20one.2011-10-11 13:21:23,929 [11] INFO Amazon.S3.AmazonS3Client - Retry number 2 for request GetObject.2011-10-11 13:21:26,508 [11] INFO Amazon.S3.AmazonS3Client - Received response for GetObject (id 2ee99002-d148-4572-b19b-29259534f48f) with status code NotModified in 00:00:00.9790314.2011-10-11 13:21:26,508 [11] INFO Amazon.S3.AmazonS3Client - Request for GetObject is being redirect to https://s3.amazonaws.com/x/new%20one.2011-10-11 13:21:32,908 [11] INFO Amazon.S3.AmazonS3Client - Retry number 3 for request GetObject.2011-10-11 13:21:40,604 [11] INFO Amazon.S3.AmazonS3Client - Received response for GetObject (id 2ee99002-d148-4572-b19b-29259534f48f) with status code NotModified in 00:00:01.2950718.2011-10-11 13:21:40,605 [11] INFO Amazon.S3.AmazonS3Client - Request for GetObject is being redirect to https://s3.amazonaws.com/x/new%20one.2011-10-11 13:21:40,621 [11] ERROR Amazon.S3.AmazonS3Client - Error for GetResponseAmazon.S3.AmazonS3Exception: Maximum number of retry attempts reached : 3 at Amazon.S3.AmazonS3Client.pauseOnRetry(Int32 retries, Int32 maxRetries, HttpStatusCode status, String requestAddr, WebHeaderCollection headers, Exception cause) at Amazon.S3.AmazonS3Client.handleHttpResponse[T](S3Request userRequest, HttpWebRequest request, HttpWebResponse httpResponse, Int32 retries, TimeSpan lengthOfRequest, T& response, Exception& cause, HttpStatusCode& statusCode) at Amazon.S3.AmazonS3Client.getResponseCallback[T](IAsyncResult result)2011-10-11 13:21:40,635 [10] INFO Example.Program - Exiting...2011-10-11 13:21:40,638 [19] ERROR Example.Program - Error downloading string.System.AggregateException: One or more errors occurred. ---> Amazon.S3.AmazonS3Exception: Maximum number of retry attempts reached : 3 at Amazon.S3.AmazonS3Client.pauseOnRetry(Int32 retries, Int32 maxRetries, HttpStatusCode status, String requestAddr, WebHeaderCollection headers, Exception cause) at Amazon.S3.AmazonS3Client.handleHttpResponse[T](S3Request userRequest, HttpWebRequest request, HttpWebResponse httpResponse, Int32 retries, TimeSpan lengthOfRequest, T& response, Exception& cause, HttpStatusCode& statusCode) at Amazon.S3.AmazonS3Client.getResponseCallback[T](IAsyncResult result) at Amazon.S3.AmazonS3Client.endOperation[T](IAsyncResult result) at Amazon.S3.AmazonS3Client.EndGetObject(IAsyncResult asyncResult) at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endMethod, TaskCompletionSource`1 tcs) --- End of inner exception stack trace ------> (Inner Exception #0) Amazon.S3.AmazonS3Exception: Maximum number of retry attempts reached : 3 at Amazon.S3.AmazonS3Client.pauseOnRetry(Int32 retries, Int32 maxRetries, HttpStatusCode status, String requestAddr, WebHeaderCollection headers, Exception cause) at Amazon.S3.AmazonS3Client.handleHttpResponse[T](S3Request userRequest, HttpWebRequest request, HttpWebResponse httpResponse, Int32 retries, TimeSpan lengthOfRequest, T& response, Exception& cause, HttpStatusCode& statusCode) at Amazon.S3.AmazonS3Client.getResponseCallback[T](IAsyncResult result) at Amazon.S3.AmazonS3Client.endOperation[T](IAsyncResult result) at Amazon.S3.AmazonS3Client.EndGetObject(IAsyncResult asyncResult) at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endMethod, TaskCompletionSource`1 tcs)<---",How to specify that HTTP Status Code 304 (NotModified) is not an error condition inside the Amazon S3 GetObject API?
C# default(nullable(type)) vs default(type)," In C#, is there a difference between default(Nullable<long>) (or default(long?)) and default(long) ? Long is just an example, it can be any other struct type. <code> ",default(Nullable(type)) vs default(type)
How can I tell whose Sharepoint My Site am I on?," I am building a web part to put on Sharepoint My Sites. I need to get the SPUser whose My Site the web part is on. Currently I simply use but this will not work on my own My Site, and I am not sure it will work all the time either. <code>  Request.QueryString[""accountname""]",Whose My Site am I on? (Programmatically)
Is the Amazon .NET AWS SDK's AmazonS3 client thread safe?, Is the Amazon .NET AWS SDK's AmazonS3 thread safe or should I be creating a new instance of AmazonS3 per request in a multi-threaded system?Specifically for the latest .NET AWS SDK (version 1.3.14). <code> ,Is the Amazon .NET AWS SDK's AmazonS3 thread safe?
c# path with a '$' at the end," what does the $ at the end of a string used for path traversel mean? My google foo is not strong enough to find out. <code>  public static string QueuePrefix = @"".\Private$\"";",Windows path with a '$' at the end
get extension of file," i want get extension file of url .for example get extension http://www.iranfairco.com/download-file/02912bb889cb24.if extension this file is gif.EDIT:for example this url ""http://www.online-convert.com/result/d8b423c3cbc05000cc52ce7015873e72""Please help me how can get extension of this url? <code> ",get extension of file(edit)
How to initialize an array of 2D-arrays?," I have an array of 2D-arrays. For example, it is like: But If I write the compiler will complain ""; expected"".If I write the compiler will complain ""A nested array initializer is expected"".So why does this happen and what is the correct way of initialization? <code>  {{{0, 0, 1}, {1, 0, 0}}{{0, 0, 3}, {2, 1, 2}, {2, 2, 1}, {3, 0, 0}}{{0, 0, 7}, {3, 2, 6}, {6, 2, 3}, {6, 3, 2}, {7, 0, 0}}} int [,][] arrays={{{0, 0, 1}, {1, 0, 0}} {{0, 0, 3}, {2, 1, 2}, {2, 2, 1}, {3, 0, 0}} {{0, 0, 7}, {3, 2, 6}, {6, 2, 3}, {6, 3, 2}, {7, 0, 0}}}; int [,][] arrays={new int[,] {{0, 0, 1}, {1, 0, 0}} new int[,] {{0, 0, 3}, {2, 1, 2}, {2, 2, 1}, {3, 0, 0}} new int[,] {{0, 0, 7}, {3, 2, 6}, {6, 2, 3}, {6, 3, 2}, {7, 0, 0}}};",How to initialize an array of 2D-arrays?
C#: How to initialize an array of 2D-arrays?," I have an array of 2D-arrays. For example, it is like: But If I write the compiler will complain ""; expected"".If I write the compiler will complain ""A nested array initializer is expected"".So why does this happen and what is the correct way of initialization? <code>  {{{0, 0, 1}, {1, 0, 0}}{{0, 0, 3}, {2, 1, 2}, {2, 2, 1}, {3, 0, 0}}{{0, 0, 7}, {3, 2, 6}, {6, 2, 3}, {6, 3, 2}, {7, 0, 0}}} int [,][] arrays={{{0, 0, 1}, {1, 0, 0}} {{0, 0, 3}, {2, 1, 2}, {2, 2, 1}, {3, 0, 0}} {{0, 0, 7}, {3, 2, 6}, {6, 2, 3}, {6, 3, 2}, {7, 0, 0}}}; int [,][] arrays={new int[,] {{0, 0, 1}, {1, 0, 0}} new int[,] {{0, 0, 3}, {2, 1, 2}, {2, 2, 1}, {3, 0, 0}} new int[,] {{0, 0, 7}, {3, 2, 6}, {6, 2, 3}, {6, 3, 2}, {7, 0, 0}}};",How to initialize an array of 2D-arrays?
Get middle point of an ArcSegment in WPF, What is the best solution for getting the middle point of an ArcSegment in a path and label it in WPF? <code> ,How Get The middle point of an ArcSegment in WPF
Check if given executable is digitally signed and valid in C#," In my C#/.NET application I have to check if a given executable is digitally signed (preferably without Exception testing.) Then I need to check if its certificate is valid (based on installed root certificates) and if the files content is valid for the signature.There are so many classes in the BCL, I don't know where to start & what to use, and anything I've found so far doesn't eliminate my confusion...I'd like to do something like this, without P/Invoke if possible: Added clarification:The big problem I currently have is that I don't find a way to obtain the signature of such a file in an easy way. Still hope there is a provided, managed, BCL solution as I would be surprised if exactly that part is missing. (For the certificate this can be done with just X509Certificate.CreateFromSignedFile, validating that is possible, too)I'd prefer not mixing that 50% work done with P/Invoke code or a big different library. I've found a AuthenticodeSignatureInformation class, no information about using that for a given executable though. <code>  bool IsSignedFile(string path); Cert GetCertificateFromSignedFile(string path);bool IsValidCertificate(Cert cert)Sig GetSignatureFromSignedFile(string path);bool IsValidSignature(string path, Sig sig, Cert cert); ",Check whether a given executable is digitally signed and valid?
Why Static Methods cannot have nonstatic methods and variables, Why can't static classes have non-static methods and variables when non-static classes can have static methods and variables?What is the advantage of having static methods and variables in a non static class? Though having a static constructor in a non-static class is understandable. <code> ,Why can't static classes have non-static methods and variables?
Why static classes cannot have nonstatic methods and variables, Why can't static classes have non-static methods and variables when non-static classes can have static methods and variables?What is the advantage of having static methods and variables in a non static class? Though having a static constructor in a non-static class is understandable. <code> ,Why can't static classes have non-static methods and variables?
Calling a STATIC METHOD in C#," How do I call a static method? I want to call this from a class I have created, I want to get the location from IP. I've declared it but what I need to do is call the method... as static...To be honest with you, I'm quite confused here, do I need to instantiate address, city, etc.?I have done this so far;LocationTools.cs Home.cs } <code>  public static class LocationTools { public static void GetLocationFromIP(string address, out string city, out string region, out string country, out double? latitude, out double? longitude) { public string IPAPIKey { get { return WebConfigurationManager.AppSettings[""IPAPIKey""]; } } ////To get the ip address of the machine and not the proxy use the following code static void GetLocationFromIP() { string strIPAddress = Request.UserHostAddress.ToString(); strIPAddress = Request.ServerVariables[""HTTP_X_FORWARDED_FOR""]; if (strIPAddress == null || strIPAddress == """") { strIPAddress = Request.ServerVariables[""REMOTE_ADDR""].ToString(); } }}",Calling a Static method in C#
How can you overload an enum in C#?," This is my code: ShowEnum always displays: Kirk, Spock, Sulu, Scotteven if it was called in the NewGeneration class. Am I missing/misunderstanding something? Is there a way for ShowEnum to use the NewGeneration.Characters instead of StarTrek.Characters? <code>  void Main(){ StarTrek baseClass = new StarTrek(); NewGeneration childClass = new NewGeneration(); baseClass.ShowEnum(); childClass.ShowEnum();}public class StarTrek{ internal enum Characters { Kirk, Spock, Sulu, Scott } public void ShowEnum() { Type reflectedEnum = typeof(Characters); IEnumerable<string> members = reflectedEnum.GetFields() .ToList() .Where(item => item.IsSpecialName == false) .Select(item => item.Name); string.Join("", "", members).Dump(); }}public class NewGeneration : StarTrek{ internal new enum Characters { Picard, Riker, Worf, Geordi } }",How can you override an enum in C#?
"C#, winform -- Stop Hilighting Color of Selected Item in Combobox In Winform (On load)?"," I am using combo box in WinForm but when i was selected any item in combo box then selected item background color is blue. i want to remove this blue background color (particularly on form load, tried to set focus to other control in the form, but combo highlight not removed) but item should be selected . Can anybody help out on this...?  <code> ",Stop color hilighting of selected item in ComboBox?
Asynchronous task in synchronous method," Here is the simple example: Now, everytime I use that method I have to intercept CookinDone event and move on. But how can I simplify that by making return type of the method as Boolean and return result upon the Cookin completion? if I put there something like while (bw.IsBusy) it will screw my ActivityIndicator, freeze the main thread and I feel it would be the lousiest thing to do. There are also some Monitor.Wait stuff and some other stuff like TaskFactory, but all that stuff seems to be too complicated to use in simple scenarios. It might be also different in different environments, like some approach is good for WPF apps, some for something else and whatnot, but there should be a general pattern isn't that right?How do you do that guys? <code>  public event EventHandler CookinDone = delegate{};public void CoockinRequest(){ var indicator = new ActivityIndicator(); ActivityIndicator.Show(""Oooo coockin' something cool""); var bw = new BackgroundWorker(); bw.DoWork += (sender, e) => CockinService.Cook(); bw.RunWorkerCompleted += (sender, e) => { indicator.Hide(); CookinDone.Invoke(this,null); }; bw.RunWorkerAsync();} var cook = new Cook();cook.CookinDone += (sender, e) => MessageBox.Show(""Yay, smells good"");cook.CoockinRequest(); if (CoockinRequest()) MessageBox.Show('Yay, smells even better');",Asynchronous call in synchronous method
Linq query that automatically excluedes duplicates (one-liner)," I have a linq query for project euler problem 243: The problem is, for prime factors 2 and 3, it produces the y = {6, 6} where it needs to just be {6}.Is there a way to do this without calling y.Distinct() or y.Contains() multiple times?I also thought about using two foreach loops, but the problem is - I can't use indexing so it'd just be cumbersome and awkward. <code>  var y = from n in factors from m in factors where m != n select n * m;",Linq query that automatically excludes duplicates (one-liner)
Enumerable.All method returns true when the input sequence has no elements in it," The code creates an empty collection of string, then tries to determine if all the elements in the collection are ""ABC"".If you run it, b will be true.But the collection does not even have any elements in it, let alone any elements that equal to ""ABC"".Is this a bug, or is there a reasonable explanation? <code>  var strs = new Collection<string>();bool b = strs.All(str => str == ""ABC"");",Why does Enumerable.All return true for an empty sequence?
passing value from one form to another," I have two forms named form1 and form2:form1 is made of a label and a button. form2 is made of a textBox and a buttonWhen I click the form1 button, this will show up form2. Any inputs in textBox should be written back to form1.label once I hit the button in form2.I have the code below but it doesn't work. And a screenshot:How can I realize that? <code>  // Code from Form 1public partial class Form1 : Form{ public void PassValue(string strValue) { label1.Text = strValue; } public Form1() { InitializeComponent(); } private void button1_Click(object sender, EventArgs e) { Form2 objForm2 = new Form2(); objForm2.Show(); }}// Code From Form 2public partial class Form2 : Form{ public Form2() { InitializeComponent(); } private void button1_Click(object sender, EventArgs e) { Form1 objForm1 = new Form1(); objForm1.PassValue(textBox1.Text); this.Close(); }}",Passing a value from one form to another form
Validating xml on xsd with the error line numbers," Is there any way to validate an XML file on an XSD schema with the output of the error line numbers?The XmlReader reader doesn't allow line numbers, it shows only the element name. <code> ",Validating XML on XSD with the error line numbers
How to make some text bold in a rich text box C#," I want to create a text editor where I can make text bold, change its color, etc.I found this code to approximately work: But when I type in more letters in the RichTextBox the text is still bold.How can I make it so that only the selected text is bold and the next characters aren't unless I select the text and hit the ""Make Bold"" button? <code>  public static void BoldSelectedText(RichTextBox control){ control.SelectionFont = new Font(control.Font.FontFamily, control.Font.Size, FontStyle.Bold);}",How to make some text bold in a rich text box in C#
"How to replace Straight quotation mark("")"," I would like to replace a straight quotation mark ("") using C#.I might be missing something small, but I can't get it with a normal string.Replace();someWord.Replace(@"""""", ""&amp;"");Can I do it with a normal string.Replace(); or do I need to use Regex? If the latter, what would the Regex replace look like? <code> ","How to replace straight quotation mark ("")"
Changing text color in C# Console Application," I just finished my C# console application code for a project and would like to add some color to my font. I would love to be able to use a custom color - orange. Is there any way to do this?This is the code I have been using to change colors in the past, but it doesn't offer orange: Is there a way to maybe insert a hex value for the color or something similar? <code>  Console.ForegroundColor = ConsoleColor.Magenta(and so on);",Custom text color in C# console application?
Orange text color in C# console application?," I just finished my C# console application code for a project and would like to add some color to my font. I would love to be able to use a custom color - orange. Is there any way to do this?This is the code I have been using to change colors in the past, but it doesn't offer orange: Is there a way to maybe insert a hex value for the color or something similar? <code>  Console.ForegroundColor = ConsoleColor.Magenta(and so on);",Custom text color in C# console application?
How to automatically pull in Win32 API declaraions in C#?," I am searching for a way that will automate adding declarations of Win32 API functions in C# code. For example, I currently have to add: when I want to call LoadLibrary. And similar for every other function that I want to call.Is there some list of all these Win32 declarations already so that I don't have to keep adding them myself? Or some other ""correct"" way of doing this? <code>  [DllImport(""kernel32.dll"")]public static extern IntPtr LoadLibrary(string path);",How to automatically pull in Win32 API declarations in C#?
Why do I need to use get and set? What harm will it do if I declare the variable as public directly," I have a code segment: What is the point here? I could have declared the _myProperty string as public and any of my class objects will be able to directly access them and get or set the value.Instead, we are making _myProperty private and the using get and set to access them, using the class object.In either case, the class object is able to access them and the result is always same.So why use this approach? Is that only because I can implement few constraints in setter?Apart from that what harm will making member variables public cause? In this example I could expose _myProperty as public instead of restricting it to this class only by making it private, as OOP would suggest. <code>  public class MyClass{ private string _myProperty; public string MyProperty { get { return _myProperty; } set { _myProperty = value; } }}",Why do I need to use get and set?
Asp.net-Mvc: Render PartialView from other controller, Is there a way to render inside my view of controller A a partial view from other controller B? Edit: I wrote a partial view that is good for only two controllers and I don't want to copy it to their both Views folder.I want The partial view to be displayed each time the View is rendered not after something happens.  <code> ,Render Partial View from other controller
How to alter column using nhibernat SchemaUpdate functionality," I have entity model which I want to be reflected to database each time I run application but without clearing the data thus I'm using SchemaUdpate with fluent nhibernate mappings method in a way So my entity model gets updated correctly almost all the time. The problem is that when I alter definition of a property, lets say I had such property CustomSqlType is just an attribute that will be applied by a certain convention when mappings are loaded. In this case, Name property would be created as nvarchar(400) field. But if in the future I change the definition to this than correct hbm.xml file would be generated (correct means nvarchar(500) ) but the column in the database is not updated event though such alter is valid from db perspective.Is it possible to alter(generate alter script) existing column with new length/precision/nullable constraint using SchemaUpdate ? <code>  var config = Fluently.Configure().Database(MsSqlConfiguration.MsSql2008.ConnectionString(connectionString));//here I add mappings , apply conventions, build configuration, etc...//new SchemaUpdate(configuBuild).Execute(doUpdate: true, script: true); [CustomSqlType(""nvarchar(400)"")] public virtual string Name { get; set; } [CustomSqlType(""nvarchar(500)"")] public virtual string Name { get; set; }",How to alter column using nhibernate SchemaUpdate functionality
how to get a type from an assembly that is located in another folder?," I use the following code: Even though the assembly was already loaded before this line of code, it always returns null in type.PS: I did pass in the assembly qualified name, including namespace, type name, assembly name, version and public token. <code>  Assembly.LoadFile(""the assembly in another folder"");var type = Type.GetType(""the full name of the type"");",How can I get a type from an assembly that is loaded from within another folder?
why use Ilist iver Ienumerable?, 1) I read some (general) code snippet and saw some places that used IList<T> and some used IEnumerable. What is the pros to use the first over the latter?2) is and as in c#.I understand is does type check and as does casting.But what is exactly casting? forcing data to some sized object? when is and as differ? <code> ,Why use IList over IEnumerable?
Why use Ilist over Ienumerable?, 1) I read some (general) code snippet and saw some places that used IList<T> and some used IEnumerable. What is the pros to use the first over the latter?2) is and as in c#.I understand is does type check and as does casting.But what is exactly casting? forcing data to some sized object? when is and as differ? <code> ,Why use IList over IEnumerable?
Outlook Filter Items - Get all appointments in a week range," I'm trying to get all appointments in outlook in week range, but reoccurring appointments are not showing up.Here is the code: How do I get all of the recurring appointments that are displayed in Outlook for a week range? <code>  var outlook = new Microsoft.Office.Interop.Outlook.Application(); var calendar = outlook.Application.Session.GetDefaultFolder(Outlook.OlDefaultFolders.olFolderCalendar); calendar.Items.IncludeRecurrences = true; string filter = String.Format(""[Start] >= {0} And [End] < {1}"", DateTime.Now.Date.ToString(""ddddd h:nn AMPM""), DateTime.Now.Date.AddDays(5).ToString(""ddddd h:nn AMPM"")); Outlook.AppointmentItem appointment; foreach (var item in calendar.Items.Restrict(filter)) { appointment = item as Outlook.AppointmentItem; if (appointment != null) { MessageBox.Show(appointment.Start.ToString()); } }",Outlook Filter Items - Get all recurring appointments in a week range
Bitmap.GetPixel() returns different color then defined in 32bit .png file," Here is the test i wrote and that will currently fail: If you take a look into the retrievedColor you'll find that it will be the same as Color.FromArgb(13, 19, 19, 19). So the difference will be that the green part has changed from 20 to 19.Any idea why this happens or under which circumstances the constructor of the Bitmap will change a pixel?UpdateSeems to be a deeper nested problem. By replacing the Bitmap constructor by a simple cast of the image variable the problem goes away. This maybe solves the problem, but it doesn't explain it. Further more i was able to reproduce the problem even in Paint.Net by the following procedure:Open Paint.Net and create a new image (size doesn't matter)Select all (Ctrl+A)Remove the selection (Del)Open the color dialog (F8)Enter the above values for RGB (19, 20, 19) and at the bottom the transparency (13).Select the fill tool (F)Fill the color into the empty imageSelect the color selection tool (K)Click somewhere into your fresh image and watch the color dialogSo it seems it is maybe a deeper problem, not caused by the Bitmap or Image class but maybe by some deeper functionality like GDI+ or something similar.Update 2I just wrote a new test to find out all affected colors: Please don't let it run completely on itself, cause it will take a loonng time to finish and it also finds a looots of differences. But what you can see, if you play around with the transparency (setting to 1 or 10) then you'll see that the RGB values use this as some kind of bit depth.So the problem occurs if you create a new Bitmap from an existing one that uses low transparency values. The real root cause seems to be far down in GDI, Kernel or somewhere in this area and can't be solved from .Net.Simply be aware that a color can change by calling the bitmap constructor if the color has a low transparency value. If you really need the original colors to stay alive in a second instance instead use (Bitmap)myBitmap.Clone() or if you load it from disk use (Bitmap)Image.FromFile(filename) cause Image is only an abstract class which will normally instantiated through the Bitmap class. <code>  var unusableColor = Color.FromArgb(13, 19, 20, 19);var retrievedColor = Color.Empty;var tempFile = Path.GetTempFileName();using (var bitmap = new Bitmap(1, 1)){ bitmap.SetPixel(0, 0, unusableColor); bitmap.Save(tempFile, ImageFormat.Png);}using (var image = Image.FromFile(tempFile))// This will lead to the errorusing (var bitmap = new Bitmap(image))// But this will work//using (var bitmap = (Bitmap)image){ retrievedColor = bitmap.GetPixel(0, 0);}Assert.That(retrievedColor, Is.SameAs(unusableColor)); for (int a = 0; a < 256; a++){ for (int r = 0; r < 256; r++) { for (int g = 0; g < 256; g++) { for (int b = 0; b < 256; b++) { using (var bitmap = new Bitmap(1, 1)) { var desiredColor = Color.FromArgb(a, r, g, b); bitmap.SetPixel(0, 0, desiredColor); // This will fail in a lot of colors with a low alpha channel value using (var copiedBitmap = new Bitmap(bitmap)) // This will work, cause the information is entirely copied. //using (var copiedBitmap = (Bitmap)bitmap.Clone()) { var retrievedColor = copiedBitmap.GetPixel(0, 0); if (desiredColor != retrievedColor) { Debug.Print(desiredColor + "" != "" + retrievedColor); } } } } } }",(Bitmap)image behaves differently than new Bitmap(image)
Get DataGridCell from DataGridCellInfo in WPF," I want to know how to get the DataGridCell from DataGridCellInfo. Actually i have a some selected cells in datagrid, and SelectedCells property return DataGridCellInfo's collection, but i want to change the background of those cells at runtime too. so i need the datagrid cell.kindly suggest me how to do so and also how to change the datagrid cell background color dynamically(through code) also.Thanks <code> ",How to extract DataGridCell from DataGridCellinfo class in wpf
LINQ - String.IsNullOrEmpty?," My DBML exposes a record set that has a nullable nvarchar field. This nullable nvarchar field is represented as a string in my C# code. Sometimes this field is null, sometimes it is an empty string, and sometimes it actually has a value. Does String.IsNullOrEmpty() work in LINQ To SQL? For instance, would the following work: <code>  var results = from result in context.Records where String.IsNullOrEmpty(result.Info) == false select result;",String.IsNullOrEmpty in LINQ To SQL query?
Capturing Ctrl-X with the KeyDown event of a textbox in c#," I'm trying to trigger an event when the user presses ctrl-x using the KeyDown event. This works fine for ctrl-D but the event doesn't trigger when ctrl-x is pressed. I'm guessing this is because ctrl-x is the ""cut"" command. Is there any way to trigger an event when ctrl-X is pressed? <code>  private void textBox_KeyDown(object sender, KeyEventArgs e){ if (e.KeyboardDevice.IsKeyDown(Key.LeftCtrl) || e.KeyboardDevice.IsKeyDown(Key.RightCtrl)) { switch (e.Key) { case Key.D: //handle D key break; case Key.X: //handle X key break; } }}",Capturing Ctrl-X with the KeyDown event of a textbox in WPF
conflicts with the imported type, The main.cs of my project returns the following warning: Warning 1 The type 'Extensions.MessageDetails' in 'PATH\Extensions.cs' conflicts with the imported type 'Extensions.MessageDetails' in 'path\lib.dll'. Using the type defined in 'path\Extensions.cs'. path\main.csWhat is wrong with my project? How to get rid of the warning?The code of my project has the following structure:Extensions.cs lib.dll main.cs <code>  namespace Extensions{ public class MessageDetails { public string message { get; set; } public string link { get; set; } public string picture { get; set; } public string name { get; set; } public string caption { get; set; } public string description { get; set; } public string userid { get; set; } public string username { get; set; } public object actions { get; set; } public object privacy { get; set; } public object targeting { get; set; } }} namespace MyClassLib { public class MyClassLibFoo { public void foo(MessageDetails parameters) { /* .. */ } }} using MyClassLib;using Extensions;class Program{ static void Main(string[] args) { MessageDetails md = new MessageDetails(); }},Warning The type X in Y.cs conflicts with the imported type X in Z.dll
Incrementing a hit counta field in the database via WCF Service," I have a WCF Service and I am able to GET from it but I cant work out how to PUT to it. I just want to increment a hits field each time the record is used in the client. Here is some of my code.Interface: Method: Im getting Method not allowed. In IE, can anyone see what Im doing wrong???Cheers,Mike. <code>  [OperationContract][WebInvoke(Method = ""PUT"", ResponseFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.Wrapped, UriTemplate = ""IncSMS"")]void IncSMS(); public void IncSMS(){ var business = (from p in _db.Businesses where p.BusinessID == 1 select p).FirstOrDefault(); business.SMSHits += 1; _db.SaveChanges();}",Getting POST or PUT to work in a WCF REST Service
Incrementing a hit count field in the database via WCF Service," I have a WCF Service and I am able to GET from it but I cant work out how to PUT to it. I just want to increment a hits field each time the record is used in the client. Here is some of my code.Interface: Method: Im getting Method not allowed. In IE, can anyone see what Im doing wrong???Cheers,Mike. <code>  [OperationContract][WebInvoke(Method = ""PUT"", ResponseFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.Wrapped, UriTemplate = ""IncSMS"")]void IncSMS(); public void IncSMS(){ var business = (from p in _db.Businesses where p.BusinessID == 1 select p).FirstOrDefault(); business.SMSHits += 1; _db.SaveChanges();}",Getting POST or PUT to work in a WCF REST Service
ASP.NET MVC3 @Html.RenderPartial throwing CS1502 Error," I'm building an MVC3 app for my dynamic web class, and while attempting to render a partial, I get the following error: CS1502: The best overloaded method match for 'System.Web.WebPages.WebPageExecutingBase.Write(System.Web.WebPages.HelperResult)' has some invalid argumentsNow, the code I'm executing is this: Now, I've googled this, and from what I've seen, the answers are all for older versions of MVC and used the <% %> style syntax and got System.IO errors rather than the System.Web error I'm getting. I did follow their advice though and try with and without the semicolon, which made no difference as I still got the YSOD each time. Any ideas? <code>  <div> <h2>Shipping Address</h2> @Html.RenderPartial(""_AddressPartial"");</div>",ASP.NET MVC3 @Html.RenderPartial is throwing CS1502 Error
Why StringBuilder is slower than string concatenation?," Why is StringBuilder slower when compared to + concatenation? StringBuilder was meant to avoid extra object creation, but why does it penalize performance? EDIT: Moving out of scope variables as suggested: <code>  static void Main(string[] args) { int max = 1000000; for (int times = 0; times < 5; times++) { Console.WriteLine(""\ntime: {0}"", (times+1).ToString()); Stopwatch sw = Stopwatch.StartNew(); for (int i = 0; i < max; i++) { string msg = ""Your total is ""; msg += ""$500 ""; msg += DateTime.Now; } sw.Stop(); Console.WriteLine(""String +\t: {0}ms"", ((int)sw.ElapsedMilliseconds).ToString().PadLeft(6)); sw = Stopwatch.StartNew(); for (int j = 0; j < max; j++) { StringBuilder msg = new StringBuilder(); msg.Append(""Your total is ""); msg.Append(""$500 ""); msg.Append(DateTime.Now); } sw.Stop(); Console.WriteLine(""StringBuilder\t: {0}ms"", ((int)sw.ElapsedMilliseconds).ToString().PadLeft(6)); } Console.Read(); }",Why is StringBuilder slower than string concatenation?
How to compare XML files in C# ?," I know that there has been a lot of questions like this but I couldn't find a reply that would satisfy my needs. I have to write an application that will compare XML files: there will be 2 types of compare, first for 2 files, listing all the differences and second one for multiple XML files listing all the variations from averages. I am looking for some kind of class, library or API that will help me finish this task. Can you suggest some solutions ? And yet, I do not know if I should use DOM or Xpath. Any suggestions ? EDIT: Ok so I have been trying to accomplish this task with XmlDiff tool but this is quite problematic to solve this for multiple Xml files - I have no idea how can I use this XmlDiffDiagram to sort out the differences among for instance 50 Xml files.Is it going to be better with LINQ ?  <code> ",How to compare XML files in C#?
How to draw on screen for Metro Style Apps in C#?," I simply want the user to be able to draw on the screen with some sort of pointer. I already have the code working that captures the pointer's position, but I can't figure out how to place the pixels or shapes or whatever onto the screen. I found this useful tutorial: http://www.dotnetspeaks.com/DisplayArticle.aspx?ID=137 And I've been looking at the documentation here: http://msdn.microsoft.com/en-us/library/windows/apps/hh465055(v=VS.85).aspxNo luck so far. =( The tutorial is for Windows Phone 7, so it's a little bit different. =\ Help, please? =) And this is what I have so far.The drawing part: For reference, stuff elsewhere in the code:  <code>  private void Image_PointerPressed(object sender, PointerEventArgs e) { Debug.WriteLine(""Image_PointerPressed""); isTracing = true; } private void Image_PointerReleased(object sender, PointerEventArgs e) { Debug.WriteLine(""Image_PointerReleased""); isTracing = false; } private void Image_PointerMoved(object sender, PointerEventArgs e) { Debug.WriteLine(""Image_PointerMoved""); Debug.WriteLine(e.GetCurrentPoint(this).Position); if (isTracing) { Debug.WriteLine(""isTracing""); Point pos = e.GetCurrentPoint(this).Position; Color color = Colors.Green; Line line = new Line() { X1 = pos.X, X2 = pos.X + 1, Y1 = pos.Y, Y2 = pos.Y + 1 }; line.Stroke = new SolidColorBrush(color); line.StrokeThickness = 15; //// So how do I draw this line onto the screen?? //// } } using System; using System.Collections.Generic; using System.Diagnostics; using System.IO; using System.Linq; using System.Threading.Tasks; using Multimedia.FFmpeg; using Windows.Foundation; using Windows.Storage; using Windows.Storage.Pickers; using Windows.Storage.Streams; using Windows.UI.Xaml; using Windows.UI.Xaml.Controls; using Windows.UI.Xaml.Shapes; using Windows.UI.Xaml.Media; using Windows.UI.Xaml.Input; using Windows.UI.Input; bool isTracing = false;",How to draw on screen for Windows Metro Style Apps in C#?
wpf datagrid template with rounded corners," I'm creating DataGrid template with rounded corners, but I faced with this problem:Bottom corners are out of the border bounds. How to solve this? I've read this article:http://diptimayapatra.wordpress.com/2010/06/28/rounded-corner-datagrid-in-wpf/I need to do the same, but in Template. Here is my DataGrid Template Code: <code>  <Style TargetType=""{x:Type DataGrid}""> <Setter Property=""Background"" Value=""{StaticResource ControlContentBrush}""/> <Setter Property=""RowDetailsVisibilityMode"" Value=""VisibleWhenSelected""/> <Setter Property=""ScrollViewer.CanContentScroll"" Value=""true""/> <Setter Property=""ScrollViewer.PanningMode"" Value=""Both""/> <Setter Property=""Stylus.IsFlicksEnabled"" Value=""False""/> <Setter Property=""Margin"" Value=""5""/> <Setter Property=""AlternatingRowBackground"" Value=""#282828""/> <Setter Property=""HorizontalGridLinesBrush"" Value=""{StaticResource NormalBorderBrush}""/> <Setter Property=""VerticalGridLinesBrush"" Value=""{StaticResource NormalBorderBrush}""/> <Setter Property=""Template""> <Setter.Value> <ControlTemplate TargetType=""{x:Type DataGrid}""> <Border x:Name=""Border"" BorderBrush=""#282828"" BorderThickness=""2"" CornerRadius=""13"" Background=""#232323"" Padding=""{TemplateBinding Padding}"" SnapsToDevicePixels=""True""> <ScrollViewer x:Name=""DG_ScrollViewer"" Focusable=""false""> <ScrollViewer.Template> <ControlTemplate TargetType=""{x:Type ScrollViewer}""> <Grid> <Grid.ColumnDefinitions> <ColumnDefinition Width=""Auto""/> <ColumnDefinition Width=""*""/> <ColumnDefinition Width=""Auto""/> </Grid.ColumnDefinitions> <Grid.RowDefinitions> <RowDefinition Height=""Auto""/> <RowDefinition Height=""*""/> <RowDefinition Height=""Auto""/> </Grid.RowDefinitions> <DataGridColumnHeadersPresenter x:Name=""PART_ColumnHeadersPresenter"" Grid.Column=""1"" Visibility=""{Binding HeadersVisibility, ConverterParameter={x:Static DataGridHeadersVisibility.Column}, Converter={x:Static DataGrid.HeadersVisibilityConverter}, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}""/> <ScrollContentPresenter x:Name=""PART_ScrollContentPresenter"" CanContentScroll=""{TemplateBinding CanContentScroll}"" Grid.ColumnSpan=""2"" Grid.Row=""1""/> <ScrollBar x:Name=""PART_VerticalScrollBar"" Grid.Column=""2"" Maximum=""{TemplateBinding ScrollableHeight}"" Orientation=""Vertical"" Grid.Row=""1"" Visibility=""{TemplateBinding ComputedVerticalScrollBarVisibility}"" Value=""{Binding VerticalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"" ViewportSize=""{TemplateBinding ViewportHeight}""/> <Grid Grid.Column=""1"" Grid.Row=""2""> <Grid.ColumnDefinitions> <ColumnDefinition Width=""{Binding NonFrozenColumnsViewportHorizontalOffset, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}""/> <ColumnDefinition Width=""*""/> </Grid.ColumnDefinitions> <ScrollBar x:Name=""PART_HorizontalScrollBar"" Grid.Column=""1"" Maximum=""{TemplateBinding ScrollableWidth}"" Orientation=""Horizontal"" Visibility=""{TemplateBinding ComputedHorizontalScrollBarVisibility}"" Value=""{Binding HorizontalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"" ViewportSize=""{TemplateBinding ViewportWidth}""/> </Grid> </Grid> </ControlTemplate> </ScrollViewer.Template> <ItemsPresenter SnapsToDevicePixels=""{TemplateBinding SnapsToDevicePixels}""/> </ScrollViewer> </Border> </ControlTemplate> </Setter.Value> </Setter> <Style.Triggers> <Trigger Property=""IsGrouping"" Value=""true""> <Setter Property=""ScrollViewer.CanContentScroll"" Value=""false""/> </Trigger> </Style.Triggers></Style>",Datagrid template with rounded corners
Resource interpreted as Other but transferred with MIME type undefined. error for IE," WHen I try to download from Chrome it works fine, but in IE 8 it is not downloading it is showing the error above, When I used developer tool in chrome it gave Resource interpreted as Other but transferred with MIME type undefined. error but downloaded the file, but IE is throwing the error shown in the image, what should i do, thanks.I am able to download the file in IE8 when I run the website using Visual studio, but when I try to download it from the website which is uploaded in server I am getting the above error,, The error is only in IE 8.I tried changing the IE browser Compatibility mode on and off, even then I receive same error.This is my head content <code>  protected void btn_ExcelDownload_Click(object sender, EventArgs e){ Grid_UserTable.Columns[0].Visible = false; string subject = lbl_Subj.Text; Response.Buffer = true; Response.Clear(); Response.ClearHeaders(); Response.AddHeader(""Cache-Control"", ""no-store, no-cache""); Response.AddHeader(""content-disposition"", ""attachment;filename="" + subject + ""-Status.xls""); Response.Charset = """"; Response.Cache.SetCacheability(HttpCacheability.NoCache); Response.ContentType = ""application/vnd.ms-excel""; System.IO.StringWriter stringWrite = new System.IO.StringWriter(); System.Web.UI.HtmlTextWriter htmlWrite = new HtmlTextWriter(stringWrite); Grid_UserTable.RenderControl(htmlWrite); rptList.RenderControl(htmlWrite); Response.Write(stringWrite.ToString()); Response.End();} <asp:Content ID=""Content1"" ContentPlaceHolderID=""HeadContent"" runat=""Server""> <meta http-equiv=""X-UA-Compatible"" content=""IE=EmulateIE8"" />",Resource interpreted as Other but transferred with MIME type undefined. error for IE (Asp.net Website)
How to use a CNG (or AES-NI enabled instruction set) in c#," I Currently perform a large amount of encryption/decryption of text in c# using AES.With a pure software system it can take quite a processor hit for a decent amount of time for the lots of datasets required to be decrypted. I know Intel have came out with their AES-NI instruction set and AMD has come out with similar. I'm using .NET 4.0, I know that the windows CNG framework makes use of these instruction sets, but it does not appear that AesManaged in the .NET world does the same. There is a fantastic project ""CLR Security"" which makes a gateway from .NET 3.5 to the windows CNG, however it hasn't been maintained in a year and I'd rather not (if possible) jump on a dying project. There is a CNGProvider class in .NET 4 but there doesn't appear to be adequate documentation to cobble together a working decryption from it for AES.Does anyone have experience with the topic they could point me in the right direction on how to get AES-NI implemented in a pure .NET environment, using pre-made classes, without having to do a p/invoke directly from c#? (It'd be fine if there was a wrapper class doing it, as long as it was maintained). <code> ",How to use a CNG (or AES-NI enabled instruction set) in .NET?
C#: Store hierarchical Const data," I was often wondering about the right way to do this:For example, in my program I have around 100 constants (or enums) that are used in some calculation. They should preferrably be stored in one place. They can be grouped hierarchically, for example: Naturally, I want those values to be accessible while coding, so storing them in some kind of ressource is not really an option.As far as I could tell, this can be done with:very long constant namesnesting classesnamespacesUsing names is quite ugly, and it's not really well maintainable. I find nesting classes a nice way to do it, but some stylecop/fxcop rules forbid that, so this must be ""bad"" in some way. Lastly, I find the suggested alternative, using namespaces, not terribly nice neither. Imho it creates masses of folders and files that each contain almost nothing. And I don't like when 50 sub-namespaces pop up in the assembly reflector.So.. how do you do this kind of task? What would you suggest? <code>  System3 / Rules / Rule7 / ParameterXY / MaxAverageValue",Store hierarchical Const data
Inheritance query," I am learning C# and Java and have a question in regards to inheritance.Is it possible to override private members in a superclass (base class)? In my view, it would not be correct as the access modifier would prevent the member from being accessed. <code> ",Is it possible to override a private member when subclassing in C# or Java?
C# Using Interop.MODI Throws 0x80040154 Exception," I am currently trying to implement the Interop.MODI.dll (From Microsoft Office) to use the Image -> Text features it should Provide.But when doing I get: ""COMException 80040154 with CLSID {40942A6C-1520-4132-BDF8-BDC1F71F547B}"".What have I tried to solve that problem?I registered the DLL using the regasm tool:-Problem still existsI tried setting the BuildPlatform to x86:-Problem still existsI use the Visual Studio 2010 Ultimate with Windows 7 Professional 64Bit & Have Microsoft Office 2007 installedEDIT: I found the Solution: I needed to install the ""MS-Office-Document-Imaging"" feature to MS Office to get it working. (Software -> MS Office (rightclick -> edit) -> Add Features -> Microsoft Office Document Imaging) <code>  var modi = new MODI.DocumentClass();",Using Interop.MODI Throws 0x80040154 Exception
Default value for nullable value in c#," Using C# 2.0, I can specify a default parameter value like so: Since this C# 4.0 syntax isn't available: So, is there a C# 2.0 equivalent for value types? For instance: The following attempts don't compile. <code>  static void Test([DefaultParameterValueAttribute(null)] String x) {} static void Test(String x = null) {} static void Test(int? x = null) {} // error CS1908: The type of the argument to the DefaultValue attribute must match the parameter typestatic void Test([DefaultParameterValueAttribute(null)] int? x) {}// error CS0182: An attribute argument must be a constant expression, typeof expression or array creation expressionstatic void Test([DefaultParameterValueAttribute(new Nullable<int>())] int? x) {}",Default value for nullable value in c# 2.0
C# Get the name of a method using an expression," I know there are a few answers on the site on this and i apologize if this is in any way duplicate, but all of the ones I found does not do what I am trying to do.I am trying to specify method info so I can get the name in a type safe way by not using strings.So I am trying to extract it with an expression.Say I want to get the name of a method in this interface: Currently I can get the name using THIS method: I can call the helper method as follows: But I am looking for the version that I can get the method name without specifying the parameters (null, null)like this: But all attempts fail to compileIs there a way to do this? <code>  public interface IMyInteface{ void DoSomething(string param1, string param2);} MemberInfo GetMethodInfo<T>(Expression<Action<T>> expression) { return ((MethodCallExpression)expression.Body).Method; } var methodInfo = GetMethodInfo<IMyInteface>(x => x.DoSomething(null, null));Console.WriteLine(methodInfo.Name); var methodInfo = GetMethodInfo<IMyInteface>(x => x.DoSomething);",Get the name of a method using an expression
What is equivelant of CRON jobs in Asp.Net," In PHP we have cron jobs, where the hosting server automatically picks up and executes a task as per the schedule given.What would be a good alternative to use for CRON jobs in ASP.NET? I'd like to use a Web service, but that will not work in a shared hosting environment. Any help would be appreciated, and please advise a way to do this specifically in a shared hosting environment. <code> ",What is the equivalent to cron jobs in ASP.NET?
What is equivelant of CRON jobs in ASP.NET - C#," In PHP we have cron jobs, where the hosting server automatically picks up and executes a task as per the schedule given.What would be a good alternative to use for CRON jobs in ASP.NET? I'd like to use a Web service, but that will not work in a shared hosting environment. Any help would be appreciated, and please advise a way to do this specifically in a shared hosting environment. <code> ",What is the equivalent to cron jobs in ASP.NET?
What is the equivalent to CRON jobs in ASP.NET? - C#," In PHP we have cron jobs, where the hosting server automatically picks up and executes a task as per the schedule given.What would be a good alternative to use for CRON jobs in ASP.NET? I'd like to use a Web service, but that will not work in a shared hosting environment. Any help would be appreciated, and please advise a way to do this specifically in a shared hosting environment. <code> ",What is the equivalent to cron jobs in ASP.NET?
how do I add attribute comments for a method in c#," When I use any .NET methods, there is a little hint which explains the methods and their parameters.How do I achieve the same behaviour for my own methods? Is there a Visual Studio feature which allows me to add these in? <code> ",how do I add parameter comments for a method in c#
Static parameters initialization order?," The following code: Will print: I know about the beforefieldinit behavior (with/without static constructor etc.).The thing which I don't understand is why the ctor (in the output) is after _aaa?It doesn't make any sense, what if I want to initialize variables in the constructor?QuestionWhy does the initialization of X is before the ctor? <code>  static void Main(string[] args){ Console.WriteLine(""0""); string h = Foo.X; Console.WriteLine(""2"");}public static class Foo{ public static string X = ((Func<string, string>)delegate(string g) { Console.WriteLine(g); return (g); })(""_aaa""); static Foo() { Console.WriteLine(""ctor""); }} 0_aaactor2",Why static fields initialization occurs before the static constructor?
"Is it acceptable to use Func<in T, out TResult> delegates in constructors when applying Dependency Injection?"," Example: Container setup code utilising same: What do you think? <code>  public class BusinessTransactionFactory<T> where T : IBusinessTransaction{ readonly Func<Type, IBusinessTransaction> _createTransaction; public BusinessTransactionFactory(Func<Type, IBusinessTransaction> createTransaction) { _createTransaction = createTransaction; } public T Create() { return (T)_createTransaction(typeof(T)); }} public class DependencyRegistration : Registry{ public DependencyRegistration() { Scan(x => { x.AssembliesFromApplicationBaseDirectory(); x.WithDefaultConventions(); x.AddAllTypesOf(typeof(Repository<>)); x.ConnectImplementationsToTypesClosing(typeof(IRepository<>)); }); Scan(x => { x.AssembliesFromApplicationBaseDirectory(); x.AddAllTypesOf<IBusinessTransaction>(); For(typeof(BusinessTransactionFactory<>)).Use(typeof(BusinessTransactionFactory<>)); For<Func<Type, IBusinessTransaction>>().Use(type => (IBusinessTransaction)ObjectFactory.GetInstance(type)); }); For<ObjectContext>().Use(() => new ManagementEntities()); }}","Is Func<in T, out TResult> appropriate to use as a ctor arg when applying Dependency Injection?"
How to distinguish in c# event if change was made from code or by user?," I have a simple TextBox that is empty in the beginning. I have a simple event, _TextChanged, to know when the user changed anything in that TextBox. However, the event fires if I do anything with it myself from within code. Like setting textbox.Text = ""Test""; or similar. How do I make the event only fire on user interaction and not code changes? <code>  private void textNazwa_TextChanged(object sender, EventArgs e) { changesToClient = true; }",How to distinguish in a C# event if a change was made from code or by the user?
How can a Windows service impersonate a user?," Is it possible for a C# Windows service running as Local System or Local Service to impersonate another user without needing a password for that user?How would this be done?Note: My motivation for this is to be able to run user specific WMI queries in a service. The WMI calls I'm making (to the OfflineFiles WMI API) are user sensitive, and they only work when I run my service as the user whose data I want to query. I don't want users to have to enter their usernames and passwords when installing the service, so I'd like to just run the service as Local System or something, and impersonate the user I care about. <code> ",Is it possible for a Windows service impersonate a user without a password?
What are the fastest Graphics rendering property?," There is quite a lot of post about rendering high quality graphics, like this oneHigh Quality Image Scaling LibraryI need to render about 6k+ object (line and ellipse) in a graphics with GDI+, at a framerate of around 10fps. So I need the lowest quality property possible for my graphics.Here is what I have done : Did I forgot something, or is this the best possible extremum for the property of Graphics?I'm drawing at 5fps (202ms/image) with the lower mode, and 3fps (330ms/image) with higher mode.I don't feel there is a big difference, but I have reduce my performance problem to drawing only...Some Numbers :1650 call to DrawLine6600 call to FillEllipse <code>  public static class GraphicsExtensions{ public static void ToHighQuality(this Graphics graphics) { graphics.InterpolationMode = InterpolationMode.HighQualityBicubic; graphics.CompositingQuality = CompositingQuality.HighQuality; graphics.SmoothingMode = SmoothingMode.HighQuality; graphics.TextRenderingHint = TextRenderingHint.ClearTypeGridFit; graphics.PixelOffsetMode = PixelOffsetMode.HighQuality; } public static void ToLowQuality(this Graphics graphics) { graphics.InterpolationMode = InterpolationMode.Low; graphics.CompositingQuality = CompositingQuality.HighSpeed; graphics.SmoothingMode = SmoothingMode.HighSpeed; graphics.TextRenderingHint = TextRenderingHint.SystemDefault; graphics.PixelOffsetMode = PixelOffsetMode.HighSpeed; }}",What are the fastest GDI+ rendering settings?
c# Convert derived class to base class," I'm trying to refresh my memory but can't find answers with Google. If I create an instance of derived class, how do I convert it to it's base class so that when DoSomething() is called, it uses the base class's method only?A dynamic cast still calls the derived class's overridden method: Output: ""derived class"" <code>  public class BaseClass{ public virtual void DoSomething() { Trace.Write(""base class""); }}public class DerivedClass : BaseClass{ public override void DoSomething() { Trace.Write(""derived class""); }} DerivedClass dc = new DerivedClass();dc.DoSomething();(dc as BaseClass).DoSomething();",Convert derived class to base class
in a .net 2.0 C# script use String arg to case namespace or type," I need to get some JSON output in a .NET 2.0 C# script. The goal is to use one method to output all the JSON feeds I need. All the models have the same id and name properties so I have about 15 namespaces that have the same parts here. In short: since I'm use castle I can call the function like: Which in castle is calling each method, ie: the get_place_tags(){} but I want to not have to work where I can call one method to get output from each type like this: Does anyone know how to fix this? [EDIT]-- (Newest Idea) Runtime type creation.. This I think is the cleanest idea on a way to get it to work...-----So the goal is really to have at runtime a type used.. right.. so I thought this would work.http://www.java2s.com/Code/CSharp/Development-Class/Illustratesruntimetypecreation.htmand based of that here is the method so far. I'm still having issues getting t to get past the error""The type or namespace name 't' could not be found (are you missing a using directive or an assembly reference?)"" .. not sure where I'm going wrong here. Can't seem to get any of it to work lol.. [EDIT]-- (Older idea) Eval code-----So this attempt to make this happen is to use reflection and stuff to do a eval of sorts based on this http://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=11939 I know it was suggested that the using is not needed.. I know I don't know them off the top and maybe that is level showing.. But here they are for what I think will work just above. <code>  /public/get_place_tags.castle/public/get_place_types.castle/public/get_place_whichEver.castle /public/get_json.castle?wantedtype=place_types namespace campusMap.Controllers{ [Layout(""home"")] public class PublicController : BaseController { /* works and returns */ public void get_pace_type() { CancelView(); CancelLayout(); place_types[] types = ActiveRecordBase<place_types>.FindAll(); List<JsonAutoComplete> type_list = new List<JsonAutoComplete>(); foreach (place_types place_type in types) { JsonAutoComplete obj = new JsonAutoComplete(); obj.id = place_type.place_type_id; obj.label = place_type.name; obj.value = place_type.name; type_list.Add(obj); } string json = JsonConvert.SerializeObject(type_list); RenderText(json); } /* can;t ever find the namespace */ public void get_json(string wantedtype) { CancelView(); CancelLayout(); Type t = Type.GetType(wantedtype); t[] all_tag = ActiveRecordBase<t>.FindAll(); List<JsonAutoComplete> tag_list = new List<JsonAutoComplete>(); foreach (t tag in all_tag) { JsonAutoComplete obj = new JsonAutoComplete(); obj.id = tag.id; obj.label = tag.name; obj.value = tag.name; tag_list.Add(obj); } string json = JsonConvert.SerializeObject(tag_list); RenderText(json); } }} public void get_json(String TYPE){ CancelView(); CancelLayout(); if (String.IsNullOrEmpty(TYPE)) { TYPE = ""place_types""; } // get the current appdomain AppDomain ad = AppDomain.CurrentDomain; // create a new dynamic assembly AssemblyName an = new AssemblyName(); an.Name = ""DynamicRandomAssembly""; AssemblyBuilder ab = ad.DefineDynamicAssembly(an, AssemblyBuilderAccess.Run); // create a new module to hold code in the assembly ModuleBuilder mb = ab.DefineDynamicModule(""RandomModule""); // create a type in the module TypeBuilder tb = mb.DefineType(TYPE, TypeAttributes.Public); // finish creating the type and make it available Type t = tb.CreateType(); t[] all_tag = ActiveRecordBase<t>.FindAll(); List<JsonAutoComplete> tag_list = new List<JsonAutoComplete>(); foreach (t tag in all_tag) { JsonAutoComplete obj = new JsonAutoComplete(); obj.id = tag.id; obj.label = tag.name; obj.value = tag.name; tag_list.Add(obj); } RenderText(JsonConvert.SerializeObject(tag_list)); } namespace EvalCSCode{ /// <summary> /// Interface that can be run over the remote AppDomain boundary. /// </summary> public interface IRemoteInterface { object Invoke(string lcMethod, object[] Parameters); } /// <summary> /// Factory class to create objects exposing IRemoteInterface /// </summary> public class RemoteLoaderFactory : MarshalByRefObject { private const BindingFlags bfi = BindingFlags.Instance | BindingFlags.Public | BindingFlags.CreateInstance; public RemoteLoaderFactory() { } /// <summary> Factory method to create an instance of the type whose name is specified, /// using the named assembly file and the constructor that best matches the specified parameters. </summary> /// <param name=""assemblyFile""> The name of a file that contains an assembly where the type named typeName is sought. </param> /// <param name=""typeName""> The name of the preferred type. </param> /// <param name=""constructArgs""> An array of arguments that match in number, order, and type the parameters of the constructor to invoke, or null for default constructor. </param> /// <returns> The return value is the created object represented as ILiveInterface. </returns> public IRemoteInterface Create(string assemblyFile, string typeName, object[] constructArgs) { return (IRemoteInterface)Activator.CreateInstanceFrom( assemblyFile, typeName, false, bfi, null, constructArgs, null, null, null).Unwrap(); } }}#endregionnamespace campusMap.Controllers{ public class JsonAutoComplete { private int Id; [JsonProperty] public int id { get { return Id; } set { Id = value; } } private string Label; [JsonProperty] public string label { get { return Label; } set { Label = value; } } private string Value; [JsonProperty] public string value { get { return Value; } set { Value = value; } } } [Layout(""home"")] public class publicController : BaseController { #region JSON OUTPUT /* works and returns */ public void get_pace_type() { CancelView(); CancelLayout(); place_types[] types = ActiveRecordBase<place_types>.FindAll(); List<JsonAutoComplete> type_list = new List<JsonAutoComplete>(); foreach (place_types place_type in types) { JsonAutoComplete obj = new JsonAutoComplete(); obj.id = place_type.id; obj.label = place_type.name; obj.value = place_type.name; type_list.Add(obj); } string json = JsonConvert.SerializeObject(type_list); RenderText(json); } /* how I think it'll work to have a dynmaic type */ public void get_json(string type) { CancelView(); CancelLayout(); /*t[] all_tag = ActiveRecordBase<t>.FindAll(); List<JsonAutoComplete> tag_list = new List<JsonAutoComplete>(); foreach (t tag in all_tag) { JsonAutoComplete obj = new JsonAutoComplete(); obj.id = tag.id; obj.label = tag.name; obj.value = tag.name; tag_list.Add(obj); }*/ StringBuilder jsonobj = new StringBuilder(""""); jsonobj.Append(""""+type+""[] all_tag = ActiveRecordBase<""+type+"">.FindAll();\n""); jsonobj.Append(""List<JsonAutoComplete> tag_list = new List<JsonAutoComplete>();{\n""); jsonobj.Append(""foreach (""+type+"" tag in all_tag){\n""); jsonobj.Append(""JsonAutoComplete obj = new JsonAutoComplete();\n""); jsonobj.Append(""obj.id = tag.id;\n""); jsonobj.Append(""obj.label = tag.name;\n""); jsonobj.Append(""obj.value = tag.name;\n""); jsonobj.Append(""tag_list.Add(obj);\n""); jsonobj.Append(""}\n""); CSharpCodeProvider c = new CSharpCodeProvider(); ICodeCompiler icc = c.CreateCompiler(); CompilerParameters cp = new CompilerParameters(); cp.ReferencedAssemblies.Add(""system.dll""); cp.ReferencedAssemblies.Add(""Newtonsoft.Json.Net20.dll""); cp.ReferencedAssemblies.Add(""Castle.ActiveRecord.dll""); cp.CompilerOptions = ""/t:library""; cp.GenerateInMemory = true; StringBuilder sb = new StringBuilder(""""); sb.Append(""namespace CSCodeEvaler{ \n""); sb.Append(""public class CSCodeEvaler{ \n""); sb.Append(""public object EvalCode(){\n""); sb.Append(""return "" + jsonobj + ""; \n""); sb.Append(""} \n""); sb.Append(""} \n""); sb.Append(""}\n""); CompilerResults cr = icc.CompileAssemblyFromSource(cp, sb.ToString()); System.Reflection.Assembly a = cr.CompiledAssembly; object o = a.CreateInstance(""CSCodeEvaler.CSCodeEvaler""); Type t = o.GetType(); MethodInfo mi = t.GetMethod(""EvalCode""); object s = mi.Invoke(o, null); string json = JsonConvert.SerializeObject(s); RenderText(json); }/**/ #endregion } using System;using System.Collections;using System.Collections.Generic;using Castle.ActiveRecord;using Castle.ActiveRecord.Queries;using Castle.MonoRail.Framework;using Castle.MonoRail.ActiveRecordSupport;using campusMap.Models;using MonoRailHelper;using System.IO;using System.Net;using System.Web;using NHibernate.Expression;using System.Xml;using System.Xml.XPath;using System.Text.RegularExpressions;using System.Text;using System.Net.Sockets;using System.Web.Mail;using campusMap.Services;using Newtonsoft.Json;using Newtonsoft.Json.Utilities;using Newtonsoft.Json.Linq;using System.CodeDom;using System.CodeDom.Compiler;using System.Reflection;using Microsoft.CSharp;using System.Reflection.Emit;using System.Runtime.InteropServices;using System.Runtime.Remoting;using System.IO;using System.Threading;using System.Reflection;",How can I use a string argument to case a namespace or type?
"How can I extract the date from the ""Media Created"" column of a video file in C#?"," I need to extract the date from the ""Media Created"" column (highlighted in green in my the example photo below) using C#.In my example, the ""Media Created"" and ""Date"" columns are the exact same. However, there are several instances where they are not. The ""Media Created"" column contains the correct date for when the video was actually recorded.Here is the function I used to get it. Thanks to Aziz for pointing me in the right direction: <code>  Shell shell = new ShellClass();Folder folder = shell.NameSpace(_File.DirectoryName);FolderItem file = folder.ParseName(_File.Name);// These are the characters that are not allowing me to parse into a DateTimechar[] charactersToRemove = new char[] { (char)8206, (char)8207};// Getting the ""Media Created"" label (don't really need this, but what the heck)string name = folder.GetDetailsOf(null, 191);// Getting the ""Media Created"" value as a stringstring value = folder.GetDetailsOf(file, 191).Trim();// Removing the suspect charactersforeach (char c in charactersToRemove) value = value.Replace((c).ToString(), """").Trim();// If the value string is empty, return DateTime.MinValue, otherwise return the ""Media Created"" datereturn value == string.Empty ? DateTime.MinValue : DateTime.Parse(value);","How can I extract the date from the ""Media Created"" column of a video file?"
"How can I extract the date from the ""Media Created"" column of a video file"," I need to extract the date from the ""Media Created"" column (highlighted in green in my the example photo below) using C#.In my example, the ""Media Created"" and ""Date"" columns are the exact same. However, there are several instances where they are not. The ""Media Created"" column contains the correct date for when the video was actually recorded.Here is the function I used to get it. Thanks to Aziz for pointing me in the right direction: <code>  Shell shell = new ShellClass();Folder folder = shell.NameSpace(_File.DirectoryName);FolderItem file = folder.ParseName(_File.Name);// These are the characters that are not allowing me to parse into a DateTimechar[] charactersToRemove = new char[] { (char)8206, (char)8207};// Getting the ""Media Created"" label (don't really need this, but what the heck)string name = folder.GetDetailsOf(null, 191);// Getting the ""Media Created"" value as a stringstring value = folder.GetDetailsOf(file, 191).Trim();// Removing the suspect charactersforeach (char c in charactersToRemove) value = value.Replace((c).ToString(), """").Trim();// If the value string is empty, return DateTime.MinValue, otherwise return the ""Media Created"" datereturn value == string.Empty ? DateTime.MinValue : DateTime.Parse(value);","How can I extract the date from the ""Media Created"" column of a video file?"
how to implement simple search with winforms c#," I want to implement a simple search in my application, based on search query I have.Let's say I have an array containing 2 paragraphs or articles and I want to search in these articles for related subject or related keywords I enter. For example: How can I get the first article based on the search query I provided above? Any idea? <code>  //this is my search querystring mySearchQuery = ""how to play with matches"";//these are my articlesstring[] myarticles = new string[] {""article 1: this article will teach newbies how to start fire by playing with the awesome matches.."", ""article 2: this article doesn't contain anything""};",How to implement a simple String search
Is it generally a slow process reading from a Excel workbook in C#?," was experimenting with reading from an excel workbook and noticed it takes a long time to read a sheet with 3560 rows and 7 columns, about 1 minute and 17 seconds. All I did was loop through the whole sheet and store the values in a list.Is this normal, or am I doing something wrong ? <code>  static void Main(string[] args) { List<string> testList = new List<string>(); Excel.Application excelApp = new Excel.Application(); Excel.Workbook workbook = excelApp.Workbooks.Open(@""C:\Users\rnewell\Desktop\FxData.xlsx""); Excel.Worksheet worksheet = workbook.Sheets[1]; Excel.Range range = worksheet.UsedRange; int rowCount = range.Rows.Count; int colCount = range.Columns.Count; int rowCounter = 1; int colCounter = 1; while (rowCounter < rowCount) { colCounter = 1; while (colCounter <= colCount) { //Console.Write(range.Cells[rowCounter, colCounter].Value2.ToString() + "" ""); testList.Add(range.Cells[rowCounter, colCounter].Value2.ToString()); colCounter++; } Console.WriteLine(); rowCounter++; } Console.ReadKey(); excelApp.Workbooks.Close(); }",Excel Work Book - Read from C# substantially slow ? 
Value cannot be null. Parameter name: dataSource. Editing Datagrid and Save to Databaase," Hello I'm having a problem here. The code looks like this. So what I want is that whenever I edit the values in my Datagrid it will affect my database after I click button1 (save button). ex. If I have roman as the client after I changed his name and I click button1 it should change. However Im getting a value cannot be null error. Please can somebody help. T_T*EDIT: Heres the Updated Code <code>  private void Form3_Load(object sender, EventArgs e){ string connectionString = ""Server=localhost;"" + ""Database=oroderm;"" + ""User ID=root;"" + ""Password=root;"" + ""Pooling=false""; string query = ""Select * from client""; MySqlConnection conn = new MySqlConnection(connectionString); MySqlDataAdapter dAdapter = new MySqlDataAdapter(query, connectionString); conn.Open(); DataSet ds = new DataSet(); MySqlCommandBuilder cBuilder = new MySqlCommandBuilder(dAdapter); dAdapter.Fill(ds, ""client""); BindingSource bSource = new BindingSource(); bSource.DataSource = ds.Tables[""client""]; dataGridView2.DataSource = bSource;}private void button1_Click(object sender, EventArgs e){ DataTable dt = ds.Tables[""client""]; this.dataGridView2.BindingContext[dt].EndCurrentEdit(); this.da.Update(dt);} private MySqlDataAdapter _da; private DataTable _dt; private DataSet _ds; private void Form3_Load(object sender, EventArgs e) { updateClient(); }public void updateClient() { string connectionString = ""Server=localhost;"" + ""Database=oroderm;"" + ""User ID=root;"" + ""Password=root;"" + ""Pooling=false""; string query = ""select * from client""; MySqlConnection conn = new MySqlConnection(connectionString); _da = new MySqlDataAdapter(query, connectionString); conn.Open(); _ds = new DataSet(); MySqlCommandBuilder cBuilder = new MySqlCommandBuilder(_da); _da.Fill(_ds, ""client""); BindingSource bSource = new BindingSource(); bSource.DataSource = _ds.Tables[""client""]; dataGridView2.DataSource = bSource; _da.UpdateCommand = cBuilder.GetUpdateCommand(); }private void button1_Click(object sender, EventArgs e) { _dt = _ds.Tables[""client""]; this.dataGridView2.BindingContext[_dt].EndCurrentEdit(); this._da.Update(_dt); }",Value cannot be null. Parameter name: dataSource. Editing Datagrid and Save to Database
How to avoid spaghetti code when using events?," Somehow I cannot believe that I am the first one to run into that problem (and I don't want to believe that I am the only one stupid enough not to see a solution directly), but my search-fu was not strong enough.I regularly run into a situation, when I need to do a few time-consuming steps one after the other. The workflow looks like I don't want to block the UI during each step, so every method does return immediately, and raises an event once it has finished. Now hilarity ensues, since the above code block mutates into This reads too much like Continuation-passing style for my taste, and there has to be a better way to structure this code. But how? <code>  var data = DataGetter.GetData();var processedData = DataProcessor.Process(data);var userDecision = DialogService.AskUserAbout(processedData);// ... DataGetter.Finished += (data) => { DataProcessor.Finished += (processedData) => { DialogService.Finished(userDecision) => { // .... } DialogService.AskUserAbout(processedData); } DataProcessor.Process(data); };DataGetter.GetData();",How to avoid spaghetti code when using completion events?
Insert Data into database in C#," I am trying to enter data into my database, but it is giving me the following error: Invalid column nameHere's my code  <code>  string connectionString = ""Persist Security Info=False;User ID=sa;Password=123;Initial Catalog=AddressBook;Server=Bilal-PC"";using (SqlConnection connection = new SqlConnection(connectionString)){ SqlCommand cmd = new SqlCommand(); cmd.CommandText = ""INSERT INTO Data (Name,PhoneNo,Address) VALUES ("" + txtName.Text + "","" + txtPhone.Text + "","" + txtAddress.Text + "");""; cmd.CommandType = CommandType.Text; cmd.Connection = connection; connection.Open(); cmd.ExecuteNonQuery();}",Invalid column name sql error
Insert data into Sql Server database [C#]," I am trying to enter data into my database, but it is giving me the following error: Invalid column nameHere's my code  <code>  string connectionString = ""Persist Security Info=False;User ID=sa;Password=123;Initial Catalog=AddressBook;Server=Bilal-PC"";using (SqlConnection connection = new SqlConnection(connectionString)){ SqlCommand cmd = new SqlCommand(); cmd.CommandText = ""INSERT INTO Data (Name,PhoneNo,Address) VALUES ("" + txtName.Text + "","" + txtPhone.Text + "","" + txtAddress.Text + "");""; cmd.CommandType = CommandType.Text; cmd.Connection = connection; connection.Open(); cmd.ExecuteNonQuery();}",Invalid column name sql error
Insert data into Sql Server database," I am trying to enter data into my database, but it is giving me the following error: Invalid column nameHere's my code  <code>  string connectionString = ""Persist Security Info=False;User ID=sa;Password=123;Initial Catalog=AddressBook;Server=Bilal-PC"";using (SqlConnection connection = new SqlConnection(connectionString)){ SqlCommand cmd = new SqlCommand(); cmd.CommandText = ""INSERT INTO Data (Name,PhoneNo,Address) VALUES ("" + txtName.Text + "","" + txtPhone.Text + "","" + txtAddress.Text + "");""; cmd.CommandType = CommandType.Text; cmd.Connection = connection; connection.Open(); cmd.ExecuteNonQuery();}",Invalid column name sql error
"Visual Studio 2005 Error - ' A pro.blem occurred while trying to set the ""References"" parameter for the IDE's in-process compiler. No metadata found'"," I get the following error while trying to build a normal C# application. Error 1 A problem occurred while trying to set the ""References"" parameter for the IDE's in-process compiler. No metadata was found.  <code> ","A problem occurred while trying to set the ""References"" parameter for the IDE's in-process compiler"
"Visual Studio 2005 Error - 'A problem occurred while trying to set the ""References"" parameter for the IDE's in-process compiler. No metadata found'"," I get the following error while trying to build a normal C# application. Error 1 A problem occurred while trying to set the ""References"" parameter for the IDE's in-process compiler. No metadata was found.  <code> ","A problem occurred while trying to set the ""References"" parameter for the IDE's in-process compiler"
"Visual Studio 2005 Error - 'A problem occurred while trying to set the ""References"" parameter for the IDE's in-process compiler. No metadata found'"," I get the following error while trying to build a normal C# application. Error 1 A problem occurred while trying to set the ""References"" parameter for the IDE's in-process compiler. No metadata was found.  <code> ","A problem occurred while trying to set the ""References"" parameter for the IDE's in-process compiler"
"A problem occurred while trying to set the ""References"" parameter for the IDE's in-process compiler"," I get the following error while trying to build a normal C# application. Error 1 A problem occurred while trying to set the ""References"" parameter for the IDE's in-process compiler. No metadata was found.  <code> ","A problem occurred while trying to set the ""References"" parameter for the IDE's in-process compiler"
how to set useUnsafeHeaderParsing in code, I am getting the following exception:The server committed a protocol violation. Section=ResponseHeader Detail=CR must be followed by LFFrom this question: HttpWebRequestError: The server committed a protocol violation. Section=ResponseHeader Detail=CR must be followed by LFI understand that I need to set useUnsafeHeaderParsing to True. Here is my code: useUnsafeHeaderParsing is a property of HttpWebRequestElement class.How do I integrate it in the above code? <code>  HttpWebRequest myReq = (HttpWebRequest)WebRequest.Create(url);WebResponse myResp = myReq.GetResponse(); //exception is thrown here,How to set useUnsafeHeaderParsing in code
C#: Sealing a class, Sealing a class is not something I have taken much notice of in the past however I find myself wondering what is the best practice. If you know a class would not or should not be derived from would you seal it as a matter of precaution of just leave the sealed keyword out knowing that the chances of someone trying to derive from it are slim. I guess what I am asking is should you seal all classes which are not intended for inheritance just as a matter of good practice? <code> ,Sealing a class
Foreach with Extention Method on IEnumerable," Quick Question, See this code: And : Why result.Add(value) not executed?However this not executed, Another question that is have a way do a foreach on a IEnumerable with Extention Method? Except this way: IEnumerable.ToList().Foreach(p=>...) <code>  List<int> result = new List<int>();var list = new List<int> { 1, 2, 3, 4 };list.Select(value => { result.Add(value);//Does not work?? return value; }); result.Count == 0 //true",Foreach with Extension Method on IEnumerable
"In .NET, what are the differences between .ContextMenu and .ContextMenuStrip?"," What are the differences between .ContextMenu and .ContextMenuStrip in Windows Forms?I already know what a ContextMenu is, but how is ContextMenuStrip different from ContextMenu? <code> ",Differences between .ContextMenu and .ContextMenuStrip
C# - DataGridView - At least one of the DataGridView control's columns has no cell template," I'm getting that exception. This is my code: PlayreList is not empty. <code>  System.InvalidOperationException was unhandled Message=At least one of the DataGridView control's columns has no cell template. Source=System.Windows.Forms StackTrace: at System.Windows.Forms.DataGridView.CompleteCellsCollection(DataGridViewRow dataGridViewRow) at System.Windows.Forms.DataGridView.get_RowTemplateClone() at System.Windows.Forms.DataGridView.RefreshRows(Boolean scrollIntoView) at System.Windows.Forms.DataGridView.RefreshColumnsAndRows() at System.Windows.Forms.DataGridView.OnBindingContextChanged(EventArgs e) at System.Windows.Forms.Control.OnParentBindingContextChanged(EventArgs e) at System.Windows.Forms.Control.OnBindingContextChanged(EventArgs e) at System.Windows.Forms.Control.set_BindingContextInternal(BindingContext value) at System.Windows.Forms.ContainerControl.set_BindingContext(BindingContext value) at System.Windows.Forms.ContainerControl.get_BindingContext() at System.Windows.Forms.Control.get_BindingContextInternal() at System.Windows.Forms.Control.get_BindingContext() at System.Windows.Forms.DataGridView.DataGridViewDataConnection.SetDataConnection(Object dataSource, String dataMember) at System.Windows.Forms.DataGridView.set_DataSource(Object value) at Bloowars_Tools.A1_ResultWnd.A1_ResultWnd_Shown(Object sender, EventArgs e) in D:\Documents\Visual Studio 2010\Projects\Bloowars Tools\Bloowars Tools\A1_ResultWnd.cs:line 72 at System.Windows.Forms.Form.OnShown(EventArgs e) at System.Windows.Forms.Form.CallShownEvent() at System.Windows.Forms.Control.InvokeMarshaledCallbackDo(ThreadMethodEntry tme) at System.Windows.Forms.Control.InvokeMarshaledCallbackHelper(Object obj) at System.Threading.ExecutionContext.runTryCode(Object userData) at System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData) at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state) at System.Windows.Forms.Control.InvokeMarshaledCallback(ThreadMethodEntry tme) at System.Windows.Forms.Control.InvokeMarshaledCallbacks() at System.Windows.Forms.Control.WndProc(Message& m) at System.Windows.Forms.ScrollableControl.WndProc(Message& m) at System.Windows.Forms.Form.WndProc(Message& m) at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m) at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m) at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam) at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG& msg) at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(IntPtr dwComponentID, Int32 reason, Int32 pvLoopData) at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context) at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context) at System.Windows.Forms.Application.RunDialog(Form form) at System.Windows.Forms.Form.ShowDialog(IWin32Window owner) at Bloowars_Tools.MainWnd.bt_A1_Wyniki_Click(Object sender, EventArgs e) in D:\Documents\Visual Studio 2010\Projects\Bloowars Tools\Bloowars Tools\Form1.cs:line 165 at System.Windows.Forms.Control.OnClick(EventArgs e) at System.Windows.Forms.Button.OnClick(EventArgs e) at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent) at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks) at System.Windows.Forms.Control.WndProc(Message& m) at System.Windows.Forms.ButtonBase.WndProc(Message& m) at System.Windows.Forms.Button.WndProc(Message& m) at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m) at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m) at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam) at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG& msg) at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(IntPtr dwComponentID, Int32 reason, Int32 pvLoopData) at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context) at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context) at System.Windows.Forms.Application.Run(Form mainForm) at Bloowars_Tools.Program.Main() in D:\Documents\Visual Studio 2010\Projects\Bloowars Tools\Bloowars Tools\Program.cs:line 18 at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args) at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args) at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly() at System.Threading.ThreadHelper.ThreadStart_Context(Object state) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state) at System.Threading.ThreadHelper.ThreadStart() InnerException: public List<Player> PlayerList { get; set; } public A1_ResultWnd() { InitializeComponent(); //GenerateColumns(); } private void GenerateColumns() { Grid.AutoGenerateColumns = false; DataGridViewColumn miejsce = new DataGridViewColumn(); miejsce.DataPropertyName = ""Miejsce""; miejsce.HeaderText = ""Miejsce""; miejsce.Name = ""miejsceCollumn""; DataGridViewColumn imie = new DataGridViewColumn(); miejsce.DataPropertyName = ""Imie""; miejsce.HeaderText = ""Imi""; DataGridViewColumn uid = new DataGridViewColumn(); miejsce.DataPropertyName = ""UID""; miejsce.HeaderText = ""UID""; DataGridViewColumn rasa = new DataGridViewColumn(); miejsce.DataPropertyName = ""Rasa""; miejsce.HeaderText = ""Rasa""; DataGridViewColumn sex = new DataGridViewColumn(); miejsce.DataPropertyName = ""Sex""; miejsce.HeaderText = ""Pe""; DataGridViewColumn klan = new DataGridViewColumn(); miejsce.DataPropertyName = ""Klan""; miejsce.HeaderText = ""Klan""; DataGridViewColumn strefa = new DataGridViewColumn(); miejsce.DataPropertyName = ""Strefa""; miejsce.HeaderText = ""Strefa""; DataGridViewColumn status = new DataGridViewColumn(); miejsce.DataPropertyName = ""Status""; miejsce.HeaderText = ""Status""; Grid.Columns.Add(miejsce); Grid.Columns.Add(imie); Grid.Columns.Add(uid); Grid.Columns.Add(rasa); Grid.Columns.Add(sex); Grid.Columns.Add(klan); Grid.Columns.Add(strefa); Grid.Columns.Add(status); } private void A1_ResultWnd_Shown(object sender, EventArgs e) { GenerateColumns(); Grid.DataSource = PlayerList; //Here the exception occures }",At least one of the DataGridView control's columns has no cell template
difference between the implementation of var in Javascript and C#," I would like to ask a theoretical question. If I have, for example, the following C# code in Page_load: Questions:This code uses the var keyword. What is the benefit of this construct?What is the key difference between the implementation of var in Javascript and C#? <code>  cars = new carsModel.carsEntities();var mftQuery = from mft in cars.Manufacturers where mft.StockHeaders.Any(sh=> sh.StockCount>0) orderby mft.CompanyName select new {mft.CompanyID, mft.CompanyName}; // ...",Difference between the implementation of var in Javascript and C#
Best Practices for ArgumentException vs. ArgumentNullException?," Im refactoring some code and adding a method which will replace a (soon-to-be) deprecated method. The new method has the following signature: The deprecated method contained a growing list of parameters. These parameters are now properties on the FooArgs class. The deprecated method has several guard conditions which checked for null values with the following structure: Now that the parameters have been collapsed into the FooArgs class should I throw an ArgumentNullException for the individual properties of the FooArgs parameter: Or to throw a more general ArgumentException for the entire FooArgs parameter: Thanks! <code>  FooResult Foo(FooArgs args) { ... } if (parameter1 == null) throw new ArgumentNullException(parameter1);if (parameter... == null) throw new ArgumentNullException(parameter...);if (parameterN == null) throw new ArgumentNullException(parameterN); if (args.Property1 == null) throw new ArgumentNullException(args.Property1);if (args.Property... == null) throw new ArgumentNullException(args.Property...);if (args.PropertyN == null) throw new ArgumentNullException(args.PropertyN); if (args.Property1 == null) throw new ArgumentException(Property1 cannot be null., args);if (args.Property... == null) throw new ArgumentException(Property... cannot be null., args);if (args.PropertyN == null) throw new ArgumentException(Property2 cannot be null., args);",ArgumentException vs. ArgumentNullException?
How to parse string[] to string with spaces in between, How to parse string[] to string with spaces in betweenHow would you refactor this code? <code>  internal string ConvertStringArrayToString(string[] array) { StringBuilder builder = new StringBuilder(); builder.Append(array[0]); for (int i = 1; i < array.Length; i++) { builder.Append(' '); builder.Append(array[i]); } return builder.ToString(); },How to combine string[] to string with spaces in between
MouseMove event in PictureBox is fired continously even if the mouse is not moved," Why does MouseMove event of a PictureBox seem to be fired continuously even if the mouse is not moved?I have tried the following codes to prove it (by simply creating a new form with a PictureBox and a Label on it). <code>  private void pictureBox1_MouseMove ( object sender, MouseEventArgs e ){ label1.Text = DateTime.Now.ToLongTimeString ( ) + "": "" + e.X + "","" + e.Y;}",MouseMove event in PictureBox is fired continuously even if the mouse is not moved
"Xelement.XPathSelectElement , C#"," I have the following XPath String which works when I put it in Altova XML Spy and gives me a result.But when I use it directly as it is Xelement.XPathSelectElement(XPath), it does not work, but what works is Xelement.XPathSelectElement(collective, nameSpaceManager) where collective is namesspace prefix (say named ""ns"") plus my XPath string. But the problem is I have to change XPath string to something like this Is there any way to avoid having to put the namespace prefix (ns:) at each node.Sorry for not posting the sample xml earlier,you may replicate the Party tag and its elements and fill up with false data, PartyRoleType gives me what party it is could be borrower,appraiser etc partyroleidentifier gives me a way to differentiate between two party with same partyroletypes for eg there could be 2 borrowers,the partyroleidentifier differentiates them as 1 and 2  <code>  ""(//DEAL_SETS/DEAL_SET/DEALS/DEAL/PARTIES/PARTY[ROLES/ROLE/ ROLE_DETAIL/PartyRoleType='Borrower']) [(ROLES/PARTY_ROLE_IDENTIFIERS/PARTY_ROLE_IDENTIFIER/ PartyRoleIdentifier='1' or position() = 1)]/ROLES/ROLE/BORROWER/ RESIDENCES/RESIDENCE/ADDRESS/PostalCode[../../RESIDENCE_DETAIL/ BorrowerResidencyType='Current']"" ""(//ns:DEAL_SETS/ns:DEAL_SET/ns:DEALS/ns:DEAL/ns:PARTIES/ns:PARTY[ns:ROLES/ ns:ROLE/ns:ROLE_DETAIL/ns:PartyRoleType='Borrower'])[(ns:ROLES/ ns:PARTY_ROLE_IDENTIFIERS/ns:PARTY_ROLE_IDENTIFIER/ ns:PartyRoleIdentifier='1' or position() = 1)]/ns:ROLES/ ns:ROLE/ns:BORROWER/ns:RESIDENCES/ns:RESIDENCE/ ns:ADDRESS/ns:PostalCode[../../ns:RESIDENCE_DETAIL/ ns:BorrowerResidencyType='Current']"" <?xml version=""1.0"" encoding=""utf-8""?><MESSAGE xmlns=""http://www.example.com"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xxxxReferenceModelIdentifier=""3.0.0.263.12"" xsi:schemaLocation=""http://www.example.org/schemas C:\Subversion\xxx_3_0.xsd""> <DEAL_SETS> <DEAL_SET> <DEALS> <DEAL> <PARTIES> <PARTY> <ROLES> <ROLE> <PARTY_ROLE_IDENTIFIERS> <PARTY_ROLE_IDENTIFIER> <PartyRoleIdentifier>1</PartyRoleIdentifier> </PARTY_ROLE_IDENTIFIER> </PARTY_ROLE_IDENTIIERS> <BORROWER> <RESIDENCES> <RESIDENCE> <ADDRESS> <PostalCode>56236</PostalCode> </ADDRESS> </RESIDENCE> </RESIDENCES> </BORROWER> <ROLE_DETAIL> <PartyRoleType>Borrower</PartyRoleType> </ROLE_DETAIL> </ROLE> </ROLES> </PARTY> </PARTIES> </DEAL> </DEALS> </DEAL_SET> </DEAL_SETS></MESSAGE>",Xelement.XPathSelectElement
Generate MULTIPAGE pdf document based on predefined template(Invoce Staement)," I have a requirement to generate invoice reports in PDF using some predefined company templates. I am able to create/generate SINGLE PAGE PDF reports using iTextSharp.Problem: The problem comes when the invoice statement spans MULTIPLE PAGES. I am not able to extend the report(invoice statement) to next(2nd) page. If all the data can not be accommodated on one page it should be written on 2nd page, while still using the company template.The template is present at following path: I am using iTextSharp library to create documents. Below is the code used to generate the PDF: <code>  HostingEnvironment.MapPath(""~/Content/InvoiceTemplate/invoiceTemplate.pdf"") public class pdfStatementController : Controller { Models.DYNAMICS_EXTEntities _db = new Models.DYNAMICS_EXTEntities(); // // GET: /pdfStatement/ public ActionResult SendPdfStatement(string InvoiceNumber) { try { InvoiceNumber = InvoiceNumber.Trim(); ObjectParameter[] parameters = new ObjectParameter[1]; parameters[0] = new ObjectParameter(""InvoiceNumber"", InvoiceNumber); List<Models.Statement> statementList = new List<Models.Statement>(); statementList = _db.ExecuteFunction<Models.Statement>(""uspInvoiceStatement"", parameters).ToList<Models.Statement>(); pdfStatementController.WriteInTemplate(statementList); return RedirectToAction(""Invoice"", ""Invoice"", new { id = statementList.FirstOrDefault().Customer_ID.ToString().Trim() }); } catch (Exception e) { return View(""Error""); } } public static void WriteInTemplate(List<Models.Statement> statementList) { string invoiceNumber = statementList.FirstOrDefault().Invoice.ToString().Trim(); string month = null; string day = null; string year = null; PdfReader pdfReader = new PdfReader( HostingEnvironment.MapPath( ""~/Content/InvoiceTemplate/invoiceTemplate.pdf"")); FileStream fileStream = new FileStream( HostingEnvironment.MapPath( ""~/Content/reports/"" + invoiceNumber + "".pdf""), FileMode.Create); PdfStamper pdfStamper = new PdfStamper(pdfReader, fileStream); AcroFields pdfFields = pdfStamper.AcroFields; pdfFields.SetField(""BillToCompany"", statementList.FirstOrDefault().BillToCompany.ToString().Trim().ToUpper()); pdfFields.SetField(""BillToContact"", statementList.FirstOrDefault().BillToContact.ToString().Trim().ToUpper()); pdfFields.SetField(""CustomerId"", statementList.FirstOrDefault().Customer_ID); pdfFields.SetField(""InvoiceNumber"", statementList.FirstOrDefault().Invoice.ToString().Trim()); pdfFields.SetField(""JobNumber"", statementList.FirstOrDefault().JobNumber.ToString().Trim()); pdfFields.SetField(""Caller"", statementList.FirstOrDefault().Caller.ToString().Trim()); pdfStamper.FormFlattening = true; // generate a flat PDF pdfStamper.Close(); pdfReader.Close(); }}",Multipage PDF document from predefined template
MULTIPAGE pdf document on predefined template," I have a requirement to generate invoice reports in PDF using some predefined company templates. I am able to create/generate SINGLE PAGE PDF reports using iTextSharp.Problem: The problem comes when the invoice statement spans MULTIPLE PAGES. I am not able to extend the report(invoice statement) to next(2nd) page. If all the data can not be accommodated on one page it should be written on 2nd page, while still using the company template.The template is present at following path: I am using iTextSharp library to create documents. Below is the code used to generate the PDF: <code>  HostingEnvironment.MapPath(""~/Content/InvoiceTemplate/invoiceTemplate.pdf"") public class pdfStatementController : Controller { Models.DYNAMICS_EXTEntities _db = new Models.DYNAMICS_EXTEntities(); // // GET: /pdfStatement/ public ActionResult SendPdfStatement(string InvoiceNumber) { try { InvoiceNumber = InvoiceNumber.Trim(); ObjectParameter[] parameters = new ObjectParameter[1]; parameters[0] = new ObjectParameter(""InvoiceNumber"", InvoiceNumber); List<Models.Statement> statementList = new List<Models.Statement>(); statementList = _db.ExecuteFunction<Models.Statement>(""uspInvoiceStatement"", parameters).ToList<Models.Statement>(); pdfStatementController.WriteInTemplate(statementList); return RedirectToAction(""Invoice"", ""Invoice"", new { id = statementList.FirstOrDefault().Customer_ID.ToString().Trim() }); } catch (Exception e) { return View(""Error""); } } public static void WriteInTemplate(List<Models.Statement> statementList) { string invoiceNumber = statementList.FirstOrDefault().Invoice.ToString().Trim(); string month = null; string day = null; string year = null; PdfReader pdfReader = new PdfReader( HostingEnvironment.MapPath( ""~/Content/InvoiceTemplate/invoiceTemplate.pdf"")); FileStream fileStream = new FileStream( HostingEnvironment.MapPath( ""~/Content/reports/"" + invoiceNumber + "".pdf""), FileMode.Create); PdfStamper pdfStamper = new PdfStamper(pdfReader, fileStream); AcroFields pdfFields = pdfStamper.AcroFields; pdfFields.SetField(""BillToCompany"", statementList.FirstOrDefault().BillToCompany.ToString().Trim().ToUpper()); pdfFields.SetField(""BillToContact"", statementList.FirstOrDefault().BillToContact.ToString().Trim().ToUpper()); pdfFields.SetField(""CustomerId"", statementList.FirstOrDefault().Customer_ID); pdfFields.SetField(""InvoiceNumber"", statementList.FirstOrDefault().Invoice.ToString().Trim()); pdfFields.SetField(""JobNumber"", statementList.FirstOrDefault().JobNumber.ToString().Trim()); pdfFields.SetField(""Caller"", statementList.FirstOrDefault().Caller.ToString().Trim()); pdfStamper.FormFlattening = true; // generate a flat PDF pdfStamper.Close(); pdfReader.Close(); }}",Multipage PDF document from predefined template
General programming questions," Possible Duplicate: Difference between object and instance I have couple of questions:Every instance of a class (except an abstract class) is an object?Abstract classes cannot be instantiated, hence they are not objects?Could anyone help me better understand the above concepts as they relate to C#? <code> ",What is the difference between objects and classes in C#?
how to get alert message before redirect a page," I'm using vs 2010. I need to display the message to user and redirect the page.I use the below line. But I didn't get the alert message and the page was directly redirected.How to get alert message? <code>  ScriptManager.RegisterStartupScript(this, this.GetType(), ""alert"", ""<script> alert('User details saved sucessfully');window.open('frmDisplayUsers.aspx');</script>"", true);",How to get alert message before redirect a page
C# Pre- & Post Increment confusions," I am a little confused about how the C# compiler handles pre- and post increments and decrements.When I code the following: x will have the value 10 afterwards. I think this is because the pre-increment sets x to 5, which makes it 5+5 which evaluates to 10. Then the post-increment will update x to 6, but this value will not be used because then 10 will be assigned to x.But when I code: then x will be 2 afterwards. Can anyone explain why this is the case? <code>  int x = 4;x = x++ + ++x; int x = 4;x = x-- - --x;",Pre- & Post Increment in C#
ASP.NET MVC TryValidateModel() Problems," I have a two step form process where the first set of data is stored in session. ... Controller TryValidateModel(modelVM) returns false, saying VideoClip and VideoThumnail are required, despite mapping them from the seesionModel to the viewModel. I have added a breakpoint and checked they are not null.It looks like there is some underlying functionality I am not aware of regarding how ModelState and ValidateModel() work , I just don't know what.UPDATEI wouldn't say I have resolved the issue but figured out a workaround that isn't that pretty, By going into the ModelState it is possible to set the ModelValue using SetModelValue() then manually remove the error from the model state and then call TryValidateModel() - you might not even have to add the values just remove the error I have not tried. Here is my work around. <code>  [IsMp4File][Required(ErrorMessage = ""* Please select a video to upload"")]public HttpPostedFileBase VideoClip { get; set; }[Required(ErrorMessage = ""* Please select a thumbmail image"")]public HttpPostedFileBase VideoThumbnail{ get; set; }public string VideoFileName { get { return VideoClip.FileName; } }public NewsWizardStep CurrentStep { get; set; } public enum NewsWizardStep : int{ One = 1, Two = 2, Three = 3, Four = 4, Five = 5, Six = 6} public ActionResult TvCreate(TvNewsVideoVM modelVM){ if (modelVM.CurrentStep == NewsWizardStep.Two) { var sessionModel = ((TvNewsVideoVM)Session[""TvModelVM""]); modelVM.VideoClip = sessionModel.VideoClip; modelVM.VideoThumbnail = sessionModel.VideoThumbnail; } if (TryValidateModel(modelVM)) { ... }} if (modelVM.CurrentStep == NewsWizardStep.Two){ var sessionModel = ((MtTvNewsVideoVM)Session[""MtTvModelVM""]); modelVM.VideoClip = sessionModel.VideoClip; modelVM.VideoThumbnail = sessionModel.VideoThumbnail; ModelState.SetModelValue(""VideoClip"", new ValueProviderResult(sessionModel.VideoThumbnail, sessionModel.VideoFileName, CultureInfo.CurrentCulture)); ModelState.SetModelValue(""VideoThumbnail"", new ValueProviderResult(sessionModel.VideoClip, sessionModel.VideoFileName, CultureInfo.CurrentCulture)); ModelState[""VideoClip""].Errors.RemoveAt(0); ModelState[""VideoThumbnail""].Errors.RemoveAt(0);}",ASP.NET MVC TryValidateModel() Issues when Model is Modified
"Why will a .NET Task with no instructions or only ""return;"" not complete?"," I cannot understand why the following code will not work: The task status is stuck on ""Running"" after the timeout expires, although there is nothing to be done. Replacing task.Start() with task.RunSynchronously() will work however.Does anyone have an idea of what I may be doing wrong? A test project to replicate the issue is available here: http://erwinmayer.com/dl/TaskTestProject.zip. As far as I can see, it doesn't work if the method with the above code runs within the static constructor. But it works if called directly as a static class method.This recent MSDN blog post seems to highlight related issues with static constructors: http://blogs.msdn.com/b/pfxteam/archive/2011/05/03/10159682.aspx <code>  var task = new Task(() => { });task.Start();if (task.Wait(10000)){ logger.Info(""Works"");}else{ logger.Info(""Doesn't work"");}",Why will an empty .NET Task not complete if started and waited for from a static constructor?
how to get all children of a parent control?, I'm looking for an code example how to get all children of parent control. I have no idea how do it. <code>  foreach (Control control in Controls){ if (control.HasChildren) { ?? }},How to get all children of a parent control?
Plus sign in query string in C#," I few years ago I created a database driven ASP.NET site, which uses a single APSX page to display all site pages. So all the URLs of the site are in the following format: The main.aspx page gets the query string data (Page+Title+One for example) and uses it as a key to pull the appropriate article content from the SQL server database. The actual title of the page is stored in the db with spaces instead of pluses (for example ""Page Title One"").The poor decision to go with the + sign as a word separator in the URL query string is causing lots of issues with search engines lately (duplicate content, etc.), so I want to fix it, but without changing URLs.What I want to do is when search engine or visitor tries to visit the wrong URL missing the + signs and having white spaces instead, for example: I want to do 301 permanent redirect to: To be able to do this I need to check if the query string value has pluses or white spaces, however when I get the value with Request.QueryString[""page""] even if the actual quesry string has pluses in it I still get string with white spaces ""Page Title One"".The site runs on IIS6/Win 2003.How can I do this? <code>  /main.aspx?page=Page+Title+One/main.aspx?page=Another+Article+Title/main.aspx?page=Third+Page /main.aspx?page=Page Title One /main.aspx?page=Page+Title+One",Plus sign in query string for ASP.NET site
What is the benefit of using a RichTextBox over a TextBox? C# .Net," After doing a bit of digging i found some (minor - in my opinion) added benefits in using a RichTextBox. For instance, it is able to detect URLs. What are the major benefits of using a RichTextBox over just using a TextBox?Any input would be great.FYI: (This is purely to help me make a better decision when programming as to which one i should use. Often i simply arbitrarily pick one. However, i want to make a more well thought-out decision) <code> ",What is the benefit of using a RichTextBox over a TextBox?
EF 4.1 : Code First vs. Database First," I created an Entity Framework model based on an existing database, then generated the POCO entities from the model. The connection string in my web.config isn't Entity Framework, it's just the standard connection string (it's missing the CSDL, SSDL, MSL references).I can compile my application, but when I run I get this error: Code generated using the T4 templates for Database First and Model First development may not work correctly if used in Code First mode. To continue using Database First or Model First ensure that the Entity Framework connection string is specified in the config file of executing application. To use these classes, that were generated from Database First or Model First, with Code First add any additional configuration using attributes or the DbModelBuilder API and then remove the code that throws this exceptionMy question is, where in my code does it realize the POCOs came from auto generation, and how can I get it to behave like Code First? I don't want to reference the CSDL etc in my connection string. <code> ",Code First vs. Database First
how to get connection name used by the win adapter?," Is it possible get it using WMI query?my current code: I'm tried get the connections name from: <code>  ManagementObjectSearcher searcher = new ManagementObjectSearcher( ""SELECT * FROM Win32_NetworkAdapte"");foreach (ManagementObject queryObj in searcher.Get()){ Console.WriteLine(queryObj[??]); } Control Panel \ Network and Internet \ Network Connections",How to get connection name used by the Windows Network adapter?
Can I force descendants to have an empty constructor?, I am trying to create a generic factory-pattern-like mechanism.The factory will be like: Descendants of IAction might hide the parameterless constructor and this will cause the factory to fail. <code>  public class APlugin<ActionType> where ActionType : IAction{ // create a new action. Note: ActionType should contain // an empty constructor public ActionType CreateAction() { return Activator.CreateInstance<ActionType>(); }},Can I force descendants to have a parameterless constructor?
IS there a way to protect Unit test names that follows MethodName_Condition_ExpectedBehaviour pattern against refactoring?," I follow the naming convention of MethodName_Condition_ExpectedBehaviourwhen it comes to naming my unit-tests that test specific methods.for example: But when I need to rename the method under test, tools like ReSharper does not offer me to rename those tests.Is there a way to prevent such cases to appear after renaming? Like changing ReSharper settings or following a better unit-test naming convention etc. ? <code>  [TestMethod]public void GetCity_TakesParidId_ReturnsParis(){...}",Is there a way to protect Unit test names that follows MethodName_Condition_ExpectedBehaviour pattern against refactoring?
C# Pass parameter to EventHandler," I have the following EventHandler to which I added a parameter MusicNote music: I need to add the handler to a Timer like so: but get the error: ""Method name expected""EDIT: In this case I just pass e from the method which contains this code snippet, how would I pass the timer's own EventArgs? <code>  public void PlayMusicEvent(object sender, EventArgs e,MusicNote music){ music.player.Stop(); System.Timers.Timer myTimer = (System.Timers.Timer)sender; myTimer.Stop();} myTimer.Elapsed += new ElapsedEventHandler(PlayMusicEvent(this, e, musicNote));",Pass parameter to EventHandler
Read text document within visual studio project c#," I've added a .txt file with a bunch of text to my project,now I need to read that file and print it in a richtextbox.Any clue how to access the file? <code> ",Read text document within visual studio project
Creating extension-method to MessageBox class," it's possible?based in another's examples, as LabelExtesios, StringExtensions, etc.I wrote this: then: gin an error: MessageBox.Foo(); <code>  namespace MessageBoxExtensions{ public static class MessageBoxExtensionsClass { public static void Foo() { } }} using MessageBoxExtensions;// ... MessageBox.Foo(); 'System.Windows.Forms.MessageBox' does not contain a definition for 'Foo'",How to add an extension method to the MessageBox
How to create Visual Studio Solution files including Website projects?," I am working on a code generator project that creates solution with customizable layers.for now I am able to create the .sln file by writing all the elements in code. but the project files don't need this, they can be edited using MSBuild Project class.I want to add a Website project template support and etc, so this way I edit the .sln file is not cool, I wanted to know that is there a better way to do this, like MSBuild or something else ?I saw Programmatically generate Visual Studio Solution that says to use Visual Studio SDK (which is for extending visual studio, writing plugins ...), but there isn't any code sample.thanks in advance <code> ","How to create Visual Studio Solution (.sln) files programmatically, including Website projects?"
How to create readonly textbox in ASP.NET MVC3 Razor, How do I create a readonly textbox in ASP.NET MVC3 with the Razor view engine?Is there an HTMLHelper method available to do that?Something like the following? <code>  @Html.ReadOnlyTextBoxFor(m => m.userCode),How to create a readonly textbox in ASP.NET MVC3 Razor
How can i combine multiple statement in lambda expression," I am new to this LINQ field and one thing am trying to do.I have an action delegate(written below) which i want to convert in lambda expression. What will be the lambda expression for same. I just want to know that can i write multiple statements in lambda if no then Why?Thanks in advance. <code>  Action<string> custom = delegate(string name) { lstCutomers.Add(new Customer(name, coutries[cnt])); name = name + "" Object Created""; };",How can I combine multiple statement in lambda expression
C#: How do I change property names when serializing with Json.net?," I have some data in a C# DataSet object. I can serialize it right now using a Json.net converter like this However, this uses the property names from data when printing to the .json file. I would like to change the property names to be something different (say, change 'foo' to 'bar').In the Json.net documentation, under 'Serializing and Deserializing JSON' 'Serialization Attributes' it says ""JsonPropertyAttribute... allows the name to be customized"". But there is no example. Does anyone know how to use a JsonPropertyAttribute to change the property name to something else?(Direct link to documentation)Json.net's documentation seems to be sparse. If you have a great example I'll try to get it added to the official documentation.Thanks! <code>  DataSet data = new DataSet();// do some work here to populate 'data'string output = JsonConvert.SerializeObject(data);",How can I change property names when serializing with Json.net?
How can I change property names when serializing?," I have some data in a C# DataSet object. I can serialize it right now using a Json.net converter like this However, this uses the property names from data when printing to the .json file. I would like to change the property names to be something different (say, change 'foo' to 'bar').In the Json.net documentation, under 'Serializing and Deserializing JSON' 'Serialization Attributes' it says ""JsonPropertyAttribute... allows the name to be customized"". But there is no example. Does anyone know how to use a JsonPropertyAttribute to change the property name to something else?(Direct link to documentation)Json.net's documentation seems to be sparse. If you have a great example I'll try to get it added to the official documentation.Thanks! <code>  DataSet data = new DataSet();// do some work here to populate 'data'string output = JsonConvert.SerializeObject(data);",How can I change property names when serializing with Json.net?
Resharper formatting code into a single line," I am having an issue with formatting code with ReSharper.I have disabled the option for wrapping lines. With this option, the following code will be formatted to a single line. How can I have ReSharper not format the following code? If I enable line wrapping, the formatted code will come out like this: This formatting is also undesirable. <code>  Mapper.CreateMap<CountryEntity, Country>() .ForMember(dest => dest.CreatedBy, map => map.MapFrom(src => src.CreatedBy)) .ForMember(dest => dest.DateCreated, map => map.MapFrom(src => src.DateCreated)) .ForMember(dest => dest.Id, map => map.MapFrom(src => src.Id)) .ForMember(dest => dest.Name, map => map.MapFrom(src => src.Name)) .ForMember(dest => dest.CountryCodeChar2, map => map.MapFrom(src => src.CountryCodeChar2)) .ForMember(dest => dest.CountryCodeChar3, map => map.MapFrom(src => src.CountryCodeChar3)); Mapper.CreateMap<CountryEntity, Country>().ForMember( dest => dest.CreatedBy, map => map.MapFrom(src => src.CreatedBy)).ForMember( dest => dest.DateCreated, map => map.MapFrom(src => src.DateCreated)).ForMember( dest => dest.Id, map => map.MapFrom(src => src.Id)).ForMember( dest => dest.Name, map => map.MapFrom(src => src.Name)).ForMember( dest => dest.CountryCodeChar2, map => map.MapFrom(src => src.CountryCodeChar2)).ForMember( dest => dest.CountryCodeChar3, map => map.MapFrom(src => src.CountryCodeChar3));",Formatting code into a single line using ReSharper
Round up in C# 4.0," How can I round values to nearest integer?For example: ""Math.Ceiling()"" is not helping me. Any ideas? <code>  1.1 => 11.5 => 21.9 => 2",How to Round to the nearest whole number in C#
How to Round up to the nearest whole number in C#," How can I round values to nearest integer?For example: ""Math.Ceiling()"" is not helping me. Any ideas? <code>  1.1 => 11.5 => 21.9 => 2",How to Round to the nearest whole number in C#
Write Text File - C# Streamwriter," This is probably a pretty simple question. In C# I'm trying to write a simple method, called my ""DebugWrite"" method, to write out any exceptions caught within my program to a text file stored locally. My current code only writes a new file every time, using StreamWriterHow do you program it to check if the file already exists, and if so to append to the current text?. IE: <code>  If(~Exist(debug.txt){ Write new debug.txt.}else if(exist(debug.txt)){ Append new text.}",Append text using StreamWriter
Am I using Automapper's Include functionality correctly?," Either I'm not, or it isn't working... I have a single Source class that I want to map to multiple views that inherit from each other.Basically the base class is the Detail, and the child class is Edit or Update which use all the same data as Detail, plus a couple other fields to manage their own lists or whatever. Here are the maps I'm using: Then if I Mapper.Map(ticket) any of the properties that use MapFrom don't get evaluated, they just end up with the values they'd have had if there was no set mapping.So what's wrong here? <code>  Mapper.CreateMap<Ticket, Detail>() .Include<Ticket, Update>() .Include<Ticket, Edit>() .ForMember(dest => dest.Priority, opt => opt.MapFrom(src => src.Priority.Code)) .ForMember(dest => dest.TicketID, opt => opt.MapFrom(src => src.ID)) .ForMember(dest => dest.Status, opt => opt.MapFrom(src => src.StatusCode)) .ForMember(dest => dest.Category, opt => opt.MapFrom(src => src.ProblemCategoryCode)) .ForMember(dest => dest.crmBusCode, opt => opt.MapFrom(src => src.Company.crmBusCode)) .ForMember(dest => dest.TeamMembers, opt => opt.MapFrom(src => src.Schedules.Where(s => s.CompleteTime == null))); Mapper.CreateMap<Ticket, Update>() .ForMember(m => m.Schedules, opt => opt.MapFrom(t => t.Schedules.Where(s => s.EmployeeID == Util.CurrentUserID() && s.CompleteTime == null))); Mapper.CreateMap<Ticket, Edit>();",Am I using Automapper 2.0's Include functionality correctly?
Creating Zip file using SharpZipLib," I need to combine 3 files into 1 zip file and make it available to download for the user. I am able to achieve my requirement except one thing: it zips the files into the subfolders.For example, my files are located like the following: But in the zip file, it zip the files in the folder by using ""TTCG\WebSites\Health\"" as the path. Please see the attach file.I don't want the folders in the path. I just want 3 files in the zip file without folders. How can I achieve that?My codes to generate the zip file is as below: <code>  C:\TTCG\WebSites\Health\ABC.CSVC:\TTCG\WebSites\Health\XYZ.CSVC:\TTCG\WebSites\Health\123.CSV ZipFile z = ZipFile.Create(Server.MapPath(""~"" + @""\Accident.zip""));//initialize the file so that it can accept updatesz.BeginUpdate();//add the file to the zip file z.Add(Server.MapPath(""~"" + @""\ABC.csv""));z.Add(Server.MapPath(""~"" + @""\XYZ.csv""));z.Add(Server.MapPath(""~"" + @""\123.csv"")); //commit the update once we are donez.CommitUpdate();//close the filez.Close();","Add files to ZIP without paths, using SharpZipLib"
"Difference between ElapsedMilliseconds, ElapsedTicks, Elapsed.TotalMilliseconds and Elapsed.Milliseconds? (C#)"," I'm totally confused between these 4. What is the difference between ElapsedMilliseconds (long), ElapsedTicks (long), Elapsed.TotalMilliseconds (double) and Elapsed.Milliseconds (int)? I have a function How do I get the correct time consumed by my long running process from elapsed property of Stopwatch object in milliseconds?Edit: I tried msdn documentation but it isn't anything detailed there.. <code>  { Stopwatch sw = new Stopwatch(); sw.Start(); MyTimeConsumingAction(); sw.Stop(); sw.//what? }","Difference between ElapsedTicks, ElapsedMilliseconds, Elapsed.Milliseconds and Elapsed.TotalMilliseconds? (C#)"
Fastest way to read many 300 bytes chunks randomly by file offsett from a 2TB file?," I have some 2TB read only (no writing once created) files on a RAID 5 (4 x 7.2k @ 3TB) system.Now I have some threads that wants to read portions of that file.Every thread has an array of chunks it needs.Every chunk is addressed by file offset (position) and size (mostly about 300 bytes) to read from.What is the fastest way to read this data.I don't care about CPU cycles, (disk) latency is what counts.So if possible I want take advantage of NCQ of the hard disks.As the files are highly compressed and will accessed randomly and I know exactly the position, I have no other way to optimize it.Should I pool the file reading to one thread?Should I keep the file open?Should every thread (maybe about 30) keep every file open simultaneously, what is with new threads that are coming (from web server)?Will it help if I wait 100ms and sort my readings by file offsets (lowest first)?What is the best way to read the data? Do you have experiences, tips, hints? <code> ",Fastest way to read many 300 bytes chunks randomly by file offset from a 2TB file?
Is it possible to cast enum to integer?," I got the following enum: then I got a class property of type detallistaDocumentStatus: In the real life the user will send us a number (1, 2, 3 or 4) representing each enum value in the order they are declared.so, is it possible to cast like this? if not, how could I get the enum value using an integer as an index, we are using a lot of enums, so we want to do something generic and reusable <code>  public enum detallistaDocumentStatus { /// <remarks/> ORIGINAL, /// <remarks/> COPY, /// <remarks/> REEMPLAZA, /// <remarks/> DELETE,} public detallistaDocumentStatus documentStatus { get { return this.documentStatusField; } set { this.documentStatusField = value; } } det.documentStatus = (detallistaDocumentStatus)3;",Is it possible to cast integer to enum?
C# checkbox in the header of a DataGridView in any column," Actually I have solved the problem of having checkbox in the header of a DGV, here is the code Actually First I add a column to my DGV which is a DataGridViewCheckBoxColumn and then in the load of the form adding the code above, my problem is as you can see below for the first column it works great since I can set the rect.X in the code for that column but what about the notifier column how can I know where is the position of the header of this column programmatically since the log column can change through maximizing and this stuffs.Finally, How can I know for example what is the position of the header of the column[3] programatically....Thanks in advance <code>  Rectangle rect = dataGridView1.GetCellDisplayRectangle(0, -1, true); rect.Y = 3; rect.X = rect.Location.X + (rect.Width/4); CheckBox checkboxHeader = new CheckBox(); checkboxHeader.Name = ""checkboxHeader""; //datagridview[0, 0].ToolTipText = ""sdfsdf""; checkboxHeader.Size = new Size(18, 18); checkboxHeader.Location = rect.Location; checkboxHeader.CheckedChanged += new EventHandler(checkboxHeader_CheckedChanged); dataGridView1.Controls.Add(checkboxHeader); ",Checkbox in the header of a DataGridView in any column
how to change the grid grow of the control programmatically in wpf," I have the control placed in DataGrid like this: How can I change the Grid.Row and Grid.Column of the control in code behind? <code>  <Label Name=""lblDescription"" HorizontalAlignment=""Left"" Margin=""0,5,0,0"" Grid.Row=""2"" Grid.Column=""2"" /><TextBox Name=""txtDescription"" HorizontalAlignment=""Left"" Width=""200"" Margin=""0,5,0,0"" TextWrapping=""Wrap"" VerticalScrollBarVisibility=""Visible"" AcceptsReturn=""True"" Grid.RowSpan=""2"" Grid.Row=""2"" Grid.Column=""3"" />",How to change the Grid.Row and Grid.Column of the control from code behind in wpf
how to change the grid row of the control from code behind in wpf," I have the control placed in DataGrid like this: How can I change the Grid.Row and Grid.Column of the control in code behind? <code>  <Label Name=""lblDescription"" HorizontalAlignment=""Left"" Margin=""0,5,0,0"" Grid.Row=""2"" Grid.Column=""2"" /><TextBox Name=""txtDescription"" HorizontalAlignment=""Left"" Width=""200"" Margin=""0,5,0,0"" TextWrapping=""Wrap"" VerticalScrollBarVisibility=""Visible"" AcceptsReturn=""True"" Grid.RowSpan=""2"" Grid.Row=""2"" Grid.Column=""3"" />",How to change the Grid.Row and Grid.Column of the control from code behind in wpf
Why C# does not support the intersection of Protected and Internal accesibility?," protected internal:The union of protected and internal accessibility (this is less restrictive than protected or internal alone) The CLR has the concept of intersection of protected and internal accessibility, but C# does not support this.So my question is:What's the meaning of omitting this Access Modifier, is there a concrete reason? So why C# should not support it? <code> ",Why C# does not support the intersection of Protected and Internal accessibility?
II'S Hosted WCF Service & SQL Queries Using Windows Authentication," I'm fairly new to WCF but I have a WCF Service hosted in IIS that has several queries to our SQL Server. I am consuming the WCF service with a WPF application. What I'm trying to do is allow windows authentication to pass from the WPF Client, To The WCF Service, To The SQL Server so that the SQL Queries are executed as the clients user. I've been trying to configure the website and host in various ways with no luck so far.On my WCF Service website, I have Anonymous Authentication=true(for MEX), ASP.NET Impersonation=true and Windows Authentication=true. In my WCF Service Web.config: Then in my WPF client App.Config I have: My service calls are just returning simple queries from SQL using the metadata for allowing impersonation. Every time I run the client and call something from my service i'm just getting an error opening the data connection for ""NT Authority/ANONYMOUS LOGIN"" even with AnonymousAuthentication=false set in IIS??? Any help would be greatly appreciated. Thanks! <code>  <configuration> <system.web> <customErrors mode=""Off""/> <authentication mode=""Windows""/> <compilation debug=""true"" targetFramework=""4.0""> <assemblies> <add assembly=""System.Data.Entity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" /> </assemblies> </compilation> </system.web> <system.serviceModel> <bindings> <wsHttpBinding> <binding maxReceivedMessageSize=""5000000"" name=""WindowsSecurity""> <readerQuotas maxDepth=""200""/> <security mode=""Transport""> <transport clientCredentialType=""Windows"" /> </security> </binding> </wsHttpBinding> </bindings> <services> <service name=""ADATrackingService"" behaviorConfiguration=""ServiceBehavior""> <endpoint address="""" binding=""wsHttpBinding"" bindingConfiguration=""WindowsSecurity"" name=""wsHttpEndpoint"" contract=""IADATrackingService"" /> <endpoint address=""mex"" binding=""mexHttpsBinding"" name=""MexHttpsBindingEndpoint"" contract=""IMetadataExchange"" /> </service> </services> <behaviors> <serviceBehaviors> <behavior name=""ServiceBehavior""> <serviceMetadata httpGetEnabled=""false"" httpsGetEnabled=""true"" /> <serviceDebug includeExceptionDetailInFaults=""true"" /> <serviceAuthorization impersonateCallerForAllOperations=""true"" /> </behavior> </serviceBehaviors> </behaviors> <serviceHostingEnvironment multipleSiteBindingsEnabled=""true"" /> </system.serviceModel> <system.webServer> <modules runAllManagedModulesForAllRequests=""true"" /> </system.webServer> <connectionStrings> <add name=""ADATrackingEntities"" connectionString=""metadata=res://*/EntityModel.ADATrackingModel.csdl|res://*/EntityModel.ADATrackingModel.ssdl|res://*/EntityModel.ADATrackingModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=MYSERVER;initial catalog=ADATracking;integrated security=True;multipleactiveresultsets=True;App=EntityFramework&quot;"" providerName=""System.Data.EntityClient"" /> </connectionStrings></configuration> <configuration> <system.serviceModel> <behaviors> <endpointBehaviors> <behavior name=""WindowsAuthentication""> <clientCredentials> <windows allowedImpersonationLevel=""Delegation""/> </clientCredentials> </behavior> </endpointBehaviors> </behaviors> <bindings> <wsHttpBinding> <binding name=""wsHttpEndpoint"" closeTimeout=""00:01:00"" openTimeout=""00:01:00"" receiveTimeout=""00:10:00"" sendTimeout=""00:01:00"" bypassProxyOnLocal=""false"" transactionFlow=""false"" hostNameComparisonMode=""StrongWildcard"" maxBufferPoolSize=""524288"" maxReceivedMessageSize=""5000000"" messageEncoding=""Text"" textEncoding=""utf-8"" useDefaultWebProxy=""true"" allowCookies=""false""> <readerQuotas maxDepth=""200"" maxStringContentLength=""8192"" maxArrayLength=""16384"" maxBytesPerRead=""4096"" maxNameTableCharCount=""16384"" /> <reliableSession ordered=""true"" inactivityTimeout=""00:10:00"" enabled=""false"" /> <security mode=""Transport""> <transport clientCredentialType=""Windows"" proxyCredentialType=""None"" realm="""" /> <message clientCredentialType=""Windows"" negotiateServiceCredential=""true"" /> </security> </binding> </wsHttpBinding> </bindings> <client> <endpoint address=""https://MyService.svc"" binding=""wsHttpBinding"" behaviorConfiguration=""WindowsAuthentication"" bindingConfiguration=""wsHttpEndpoint"" contract=""ADATrackingService.IADATrackingService"" name=""wsHttpEndpoint""> <identity> <servicePrincipalName value=""host/MyServer.com"" /> </identity> </endpoint> </client> </system.serviceModel></configuration> [OperationBehavior(Impersonation = ImpersonationOption.Required)]public List<IndividualDisability> GetIndividualDisabilities(){ WindowsIdentity callerWindowsIdentity = ServiceSecurityContext.Current.WindowsIdentity; if (callerWindowsIdentity == null) { throw new InvalidOperationException (""The caller cannot be mapped to a Windows identity.""); } using (callerWindowsIdentity.Impersonate()) { using (var context = new ADATrackingEntities()) { return context.IndividualDisabilities.OfType<IndividualDisability>().Include(""ADACode"").Include(""Individual"").Include(""Disability"").ToList(); } }}",IIS Hosted WCF Service & SQL Queries Using Windows Authentication
How can I emulate Autofac Module with SimpleInjector," Autofac has modules, Windsor has Installers and StructureMap Registries ... with Simple Injector how can I pack configuration logic into reusable classes?I have tried: And I use it in the Composition Root: However, FooModule depends on container and maybe in not a good practice...see http://code.google.com/p/autofac/wiki/BestPractices: If components have a dependency on the container, look at how they're using the container to retrieve services, and add those services to the component's (dependency injected) constructor arguments instead.  <code>  public interface IModule { }public class FooModule : IModule{ public FooModule(SimpleInjector.Container container) { container.RegisterSingleton<IBar, Bar>(); container.RegisterSingleton<IFoo, Foo>(); }} public static void Main(string[] args){ var container = new SimpleInjector.Container(); container.RegisterCollection<IModule>(new FooModule(container)); ...}",How can I emulate Modules / Installers / Registries with Simple Injector
How can I emulate Modules / Installers / Registries with SimpleInjector," Autofac has modules, Windsor has Installers and StructureMap Registries ... with Simple Injector how can I pack configuration logic into reusable classes?I have tried: And I use it in the Composition Root: However, FooModule depends on container and maybe in not a good practice...see http://code.google.com/p/autofac/wiki/BestPractices: If components have a dependency on the container, look at how they're using the container to retrieve services, and add those services to the component's (dependency injected) constructor arguments instead.  <code>  public interface IModule { }public class FooModule : IModule{ public FooModule(SimpleInjector.Container container) { container.RegisterSingleton<IBar, Bar>(); container.RegisterSingleton<IFoo, Foo>(); }} public static void Main(string[] args){ var container = new SimpleInjector.Container(); container.RegisterCollection<IModule>(new FooModule(container)); ...}",How can I emulate Modules / Installers / Registries with Simple Injector
RestSharp is loading the whole file into memory," I'm using RestSharp in a Mono project to upload some files and I have noticed that when a large file is uploaded, the memory grows substantially.Looking at RestSharp source code I did notice that FileParameter expects a byte array, which means it is really loading the file into memory.Am I doing something wrong? Is there a way for RestSharp not do this? I might be uploading really large files so, uploading them from memory is not an option.Any help (including telling me to use another HTTP library available on mono) is welcome. <code> ",RestSharp is loading the whole file into memory when uploading. How to avoid it?
WPF DataGrid - how to make column stretch from C# code?," I'm creating the columns of a WPF DataGrid in my C# code. I want one of the columns to stretch to the width of the DataGrid automatically. In XAML, I'd set Width=""*"". How do I do it in code?EDITSome of the answers seem to lead me to the right solution, but I feel I need to elaborate a bit more what I'm trying to do:I'm actually deriving a new class from DataGrid. In its constructor, I add four columns like that: I tried setting the last column's width like user24601 suggested: But this creates a column that is so wide I can scroll and scroll for a very long time... Same problem when I use 0.1 or even smaller values.I seems to me I'm doing it in the wrong place somehow?EDIT 2OK, I may have the problem because I'm actually adding this to a ScrollViewer. I'll run some further tests first...EDIT 3Well, things don't work when having the DataGrid within a ScrollViewer... When I remove the ScrollViewer, things work like user24601 said. <code>  this.IsReadOnly = true;this.AutoGenerateColumns = false;this.ItemsSource = m_dataSource;DataGridTextColumn anColumn = new DataGridTextColumn() { Header = ""Col1"", Binding = new Binding(""B1"") };DataGridTextColumn tpColumn = new DataGridTextColumn() { Header = ""Col2"", Binding = new Binding(""B2"") };DataGridTextColumn txColumn = new DataGridTextColumn() { Header = ""Col3"", Binding = new Binding(""B3"") };DataGridTextColumn mdColumn = new DataGridTextColumn() { Header = ""Col4"", Binding = new Binding(""B4"") };this.Columns.Add(anColumn);this.Columns.Add(tpColumn);this.Columns.Add(txColumn);this.Columns.Add(mdColumn); mdColumn.Width = new DataGridLength(0.5, DataGridLengthUnitType.Star);",How to make DataGrid column stretch from C# code?
yield get called alway," Currently I'm reading a collection of items from a stream. I do this as following: Let say I have a stream which contains two items, and I do the following: Now result1 is 2, while result2 is one.Now I noticed, that my null check is useless? It seems that everytime I call that function it gets yielded anyway. Can someone explain to me why this is? And what would be the best solution for this situation (please tell me if what I'm doing is complete crap :P). <code>  public class Parser{ private TextReader _reader; //Get set in Constructor private IEnumerable<Item> _items; public IEnumerable<Item> Items{ get{ //I >>thought<< this would prevent LoadItems() from being called twice. return _items ?? (_items = LoadItems()); } } public IEnumerable<Item> LoadItems(){ while(_reader.Peek() >= 0){ yield return new Item(_reader.ReadLine()); //Actually it's a little different } }} var textReader = //Load textreader herevar parser = new Parser(textReader);var result1 = parser.Items.Count();var result2 = parser.Items.Count();",yield always gets called
How to run a test method with multiple parameters in MSTest?," NUnit has a feature called Values, like below: This means that the test method will run six times: We're using MSTest now, but is there any equivalent for this so that I can run the same test with multiple parameters? <code>  [Test]public void MyTest( [Values(1,2,3)] int x, [Values(""A"",""B"")] string s){ // ...} MyTest(1, ""A"")MyTest(1, ""B"")MyTest(2, ""A"")MyTest(2, ""B"")MyTest(3, ""A"")MyTest(3, ""B"") [TestMethod]public void Mytest(){ // ...}",How can we run a test method with multiple parameters in MSTest?
"Simulate Tab key pressed, when Return is pressed"," In a WPF application, i have a window that has a lot of fields.When the user uses the TAB key after filling each field, windows understands that it moves on to the next. This is pretty know behavior.Now what I want to to, is make it simulate the TAB key, when in fact the RETURN gets hit.So in my WPF xaml I added imply KeyDown=""userPressEnter""And in the code behind it: Now, obviously this is not working. But what I don't know is, how DO I make this work?EDIT 1 ==> FOUND A SOLUTIONI found something that helped me out =) This way the Focus moves on the the next it can find :) <code>  private void userPressEnter(object sender, KeyEventArgs e){ if (e.Key == Key.Return) { e.Key = Key.Tab // THIS IS NOT WORKING }} private void userPressEnter(object sender, KeyEventArgs e){ if (e.Key == Key.Return) { TraversalRequest request = new TraversalRequest(FocusNavigationDirection.Next); MoveFocus(request); }}",How do I simulate a Tab key press when Return is pressed in a WPF application?
Disassembling Bit Flag Enumerations in MSSQL," I have an INT column in a SQL Server database which stores a value relating to a bit flag enumeration. For instance, if the enum is: then the column in SQL Server might hold a value of 5.What I need to do is select all of the rows from another table holding additional details about the UserType, so using the example of a value of 5, I would want to select the rows from the second table with IDs 1 and 4.Does anyone know a clever way to break the number up in this manner - ideally the method should be recursive to some degree since this is a very simplified example, and the actual tables/enums are much bigger. <code>  [Flags()]public enum UserType{ StandardUser = 1, Admin = 2, SuperUser = 4}",Disassembling Bit Flag Enumerations in SQL Server
Convert absolute path to relative path," For example, how can I make this relative to this folder if the expected result is <code>  ""C:\RootFolder\SubFolder\MoreSubFolder\LastFolder\SomeFile.txt"" ""C:\RootFolder\SubFolder\"" ""MoreSubFolder\LastFolder\SomeFile.txt""",How to make an absolute path relative to a particular folder?
C# - 'deadlock' with only one locked object?," I am having a problem with multi threading in C#.I use an event to update a label in a form from another thread, for which I need to use the Invoke() command of course.That part is also working fine.However, the user can close the form and here the program can crash if the event is sent at an unfortunate time.So, I thought I would simply override the Dispose() method of the form, set a boolean to true within locked code, and also check that boolean and invoke the event in locked code.However, every time I close the form the program freezes completely.Here are the mentioned parts of the code: I hope anyone here has any idea what is wrong with this code.Thank you in advance! <code>  private object dispose_lock = new object();private bool _disposed = false;private void update(object sender, EventArgs e){ if (InvokeRequired) { EventHandler handler = new EventHandler(update); lock (dispose_lock) { if (_disposed) return; Invoke(handler); // this is where it crashes without using the lock } return; } label.Text = ""blah"";}protected override void Dispose(bool disposing){ eventfullObject.OnUpdate -= update; lock (dispose_lock) // this is where it seems to freeze { _disposed = true; // this is never called } base.Dispose(disposing);}",'Deadlock' with only one locked object?
Divide FOR loop for parallel execution in N even parts given constant input data for each iteration," I have a time consuming loop I would like to execute in parallel.Pseudocode: Input data for each iteration is completely the sameOutput for Nth iteration is stored in array with index N.How to divide this loop in C equal parts, where C is CPU core count?What is the best and the most elegant way to do this in C#, .net? <code>  for(int n = 0; n < 2048; n++){ output_data[n] = function(constant_input_data, n)}",How to divide FOR loop in N even parts for parallel execution given constant input data for each iteration?
decimal? convert to toString and specify a culture in string conversion explicitly, I have a property: and Resharper shows me: specify a culture in string conversion explicitlyBut if I use: I always get the message that: ToString method has 0 parameter(s) but it is invoked with 1 argumentsIf I change the decimal property so that it is no longer nullable then it works. How do I use ToString(CultureInfo.CurrentCulture) on nullable property? <code>  public decimal? DejanskaKolicina { get; set; } DejanskaKolicina.ToString(CultureInfo.CurrentCulture) ,Cannot specify a culture in string conversion explicitly when converting nullable decimal (decimal?) to string
How to add user control on run time in ASP .NET?," How do I add a user control on page load dynamically in ASP.NET?I have a div with ID=""contentData"" and few controlsone.ascxtwo.ascxthree.ascxNow I have created a page default.aspx, which may get parameters in query string, in one of the following ways: I am taking the value from Now how do I load specific control in this? <code>  default.aspx?val=one default.aspx?val=two default.aspx?val=three Request.QueryString[""val""] <div ID=""controlData""></div>",How to add user control on run time in ASP.NET?
How to add user control on run time in ASP.NET?," How do I add a user control on page load dynamically in ASP.NET?I have a div with ID=""contentData"" and few controlsone.ascxtwo.ascxthree.ascxNow I have created a page default.aspx, which may get parameters in query string, in one of the following ways: I am taking the value from Now how do I load specific control in this? <code>  default.aspx?val=one default.aspx?val=two default.aspx?val=three Request.QueryString[""val""] <div ID=""controlData""></div>",How to add user control on run time in ASP.NET?
How to add user control on run time in ASP.NET? [solved]," How do I add a user control on page load dynamically in ASP.NET?I have a div with ID=""contentData"" and few controlsone.ascxtwo.ascxthree.ascxNow I have created a page default.aspx, which may get parameters in query string, in one of the following ways: I am taking the value from Now how do I load specific control in this? <code>  default.aspx?val=one default.aspx?val=two default.aspx?val=three Request.QueryString[""val""] <div ID=""controlData""></div>",How to add user control on run time in ASP.NET?
WPF/C#: Inheriting from one baseclass that implements INotifyPropertyChanged?," I have this BaseClass: and a other class: PropertyChanged is here ( 2Times ), red underlined, it says: What I'm doing wrong? I only swept the PropertyChangedEvent to a new class: BaseViewModel.. <code>  public class BaseViewModel : INotifyPropertyChanged{ protected void OnPropertyChanged(string propertyName) { if (PropertyChanged != null) { PropertyChanged(this, new PropertyChangedEventArgs(propertyName)); } } public event PropertyChangedEventHandler PropertyChanged;} public class SchemaDifferenceViewModel : BaseViewModel{ private string firstSchemaToCompare; public string FirstSchemaToCompare { get { return firstSchemaToCompare; } set { firstSchemaToCompare = value; if (PropertyChanged != null) { PropertyChanged(this, new PropertyChangedEventArgs(""FirstSchemaToCompare"")); //StartCommand.RaiseCanExecuteChanged(); } } } Error 1 The event BaseViewModel.PropertyChanged' can only appear on the left hand side of += or -= (except when used from within the type 'SchemaDifferenceFinder.ViewModel.BaseViewModel')",Inheriting from one baseclass that implements INotifyPropertyChanged?
Get propertyinfo value," I'm trying to get the value from a PropertyInfo[], but I can't get it to work: Exception: Object does not match target type.Isn't this how it's supposed to be done? <code>  foreach (var propertyInfo in foo.GetType().GetProperties()){ var value = propertyInfo.GetValue(this, null);}",Get PropertyInfo value
C#: Generics and Implementing IComparable, I am very new to generics and I am trying to write a simple class which will be generic but also allow sorting of some description on a string member variable. At the moment I have a basic class but when I try to implement the interface member CompareTo() I get an error at the top telling me it is not implemented. What is the issue here?  <code>  using System;namespace GenericsPracticeConsole.Types{ class SortableGenericType<T> : IComparable { private T t; private string stringName; public T name { get { return t; } set { t = value; } } public int CompareTo(SortableGenericType<T> ourObject) { return stringName.CompareTo(ourObject.stringName); } }},Generics and Implementing IComparable
Opening a website when a button on the form in clicked," I am creating a windows application using C#, where in a button on the GUI when clicked, should open a website.The web browser will be taken care of by the default settings.I am curious as to how to do that?  <code> ",Opening a website when a button on the form is clicked
read xml file in to xmlDocument, I am very new to C#. I have XML file (text.xml). I want to read that in XmlDocument and store the stream in string variable. <code> ,Read XML file into XmlDocument
C# .NET 4.0 Square bracket Syntax Above Property Declaration," I keep seeing the following syntax when looking at C# code (using .NET 4.0 framework): What is the purpose of the square brackets above the property header? <code>  [XmlIgnore, Bindable(false)] public virtual FieldBase Field {get;set;}",Square bracket Syntax Above Property Declaration
C# WPF Web browser control: How to capture document events?," I am using WPF's WebBrowser control to load a simple web page. On this page I have an anchor or a button. I want to capture the click event of that button in my application's code behind (i.e. in C#). Is there are a way for the WebBrowser control to capture click events on the loaded page's elements?In addition, is it possible to communicate event triggered data between the page and the WebBrowser? All of the above should be possible am I right?Edit: Probable solution:I have found the following link that might be a solution. I haven't tested it yet but it's worth the shot. Will update this question depending on my test results.http://support.microsoft.com/kb/312777 Link taken from: Source <code> ",Web browser control: How to capture document events?
Connecting two UDP clients to one port (Send and Receive) C#," I tried the suggestion from this question with very little success.Please... any help will be greatly appreciated!Here is my code: <code>  static void Main(string[] args){ IPEndPoint localpt = new IPEndPoint(IPAddress.Any, 6000); UdpClient udpServer = new UdpClient(localpt); udpServer.Client.SetSocketOption( SocketOptionLevel.Socket, SocketOptionName.ReuseAddress, true); UdpClient udpServer2 = new UdpClient(); udpServer2.Client.SetSocketOption( SocketOptionLevel.Socket, SocketOptionName.ReuseAddress, true); udpServer2.Client.Bind(localpt); // <<---------- Exception here}",Connecting two UDP clients to one port (Send and Receive) 
How do I check if current user has the right restart a windows service?," How do I check if the user has permission to start/stop a specific windows service, without actually stopping or starting it?The question is not about granting the right to restart the service to the user (with subinacl.exe for example) : I want to check if the user is administrator or if he has already been granted the right to restart the service. <code> ",How do I check if current user has the right to restart a windows service?
Datagridview onselectedindexevent not firing," I am trying to get the selected row of the GridView, and I know that I should be able to get that information based on the OnSelectedIndexChanged event. Whenever I click on the row, the event does not fire. Any help with this would be appreciated. There is no code that I can see that resets its reference to another event, that I can see.  <code>  <asp:GridView ID=""GridView1"" runat=""server"" GridLines=""None"" Width=""930px"" CellPadding=""4"" ForeColor=""#333333"" onselectedindexchanged=""GridView1_SelectedIndexChanged2""> <AlternatingRowStyle BackColor=""White"" /> <EditRowStyle BackColor=""#2461BF"" /> <FooterStyle BackColor=""#507CD1"" Font-Bold=""True"" ForeColor=""White"" /> <HeaderStyle BackColor=""#507CD1"" Font-Bold=""True"" ForeColor=""White"" /> <PagerStyle BackColor=""#2461BF"" ForeColor=""White"" HorizontalAlign=""Center"" /> <RowStyle BackColor=""#EFF3FB"" /> <SelectedRowStyle BackColor=""#D1DDF1"" Font-Bold=""True"" ForeColor=""#333333"" /> <SortedAscendingCellStyle BackColor=""#F5F7FB"" /> <SortedAscendingHeaderStyle BackColor=""#6D95E1"" /> <SortedDescendingCellStyle BackColor=""#E9EBEF"" /> <SortedDescendingHeaderStyle BackColor=""#4870BE"" /></asp:GridView>protected void GridView1_SelectedIndexChanged2(object sender, EventArgs e){ //string company = GridView1.SelectedRow.Cells[0].Text; Response.Redirect(""Client_View.aspx"", false);}",GridView OnSelectedIndexChanged event not firing
In c# how can I create an in memory sqlite database?," I have tried SQLiteConnection("":memory:"") and SQLiteConnection(""sqlite::memory:"") but both of these fail with 'Invalid ConnectionString format' <code> ",How can I create an in memory sqlite database?
C Sharp event not firing when pressing help button on Messagebox," I have a C# app where I'm using Messagebox.Show with a help button, as per Microsoft's example at http://msdn.microsoft.com/en-us/library/szwxe9we.aspxI add the event to the form, but pressing the help button never fires the event - pressing F1 on the form DOES however. Even taking Microsoft's example almost completely does not fire the event. The whole code is below. Any ideas what I'm not doing?There is another post where someone had noticed the same. <code>  using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Windows.Forms;namespace WindowsFormsApplication4{ public partial class Form1 : Form { public Form1() { InitializeComponent(); DialogResult r = AlertMessageWithCustomHelpWindow(); } // Display a message box with a Help button. Show a custom Help window // by handling the HelpRequested event. private DialogResult AlertMessageWithCustomHelpWindow() { // Handle the HelpRequested event for the following message. this.HelpRequested += new System.Windows.Forms.HelpEventHandler(this.Form1_HelpRequested); this.Tag = ""Message with Help button.""; // Show a message box with OK and Help buttons. DialogResult r = MessageBox.Show(""Message with Help button."", ""Help Caption"", MessageBoxButtons.OK, MessageBoxIcon.Question, MessageBoxDefaultButton.Button1, 0, true); // Remove the HelpRequested event handler to keep the event // from being handled for other message boxes. this.HelpRequested -= new System.Windows.Forms.HelpEventHandler(this.Form1_HelpRequested); // Return the dialog box result. return r; } private void Form1_HelpRequested (System.Object sender, System.Windows.Forms.HelpEventArgs hlpevent) { // Create a custom Help window in response to the HelpRequested event. Form helpForm = new Form(); // Set up the form position, size, and title caption. helpForm.StartPosition = FormStartPosition.Manual; helpForm.Size = new Size(200, 400); helpForm.DesktopLocation = new Point(this.DesktopBounds.X + this.Size.Width, this.DesktopBounds.Top); helpForm.Text = ""Help Form""; // Create a label to contain the Help text. Label helpLabel = new Label(); // Add the label to the form and set its text. helpForm.Controls.Add(helpLabel); helpLabel.Dock = DockStyle.Fill; // Use the sender parameter to identify the context of the Help request. // The parameter must be cast to the Control type to get the Tag property. Control senderControl = sender as Control; helpLabel.Text = ""Help information shown in response to user action on the '"" + (string)senderControl.Tag + ""' message.""; // Set the Help form to be owned by the main form. This helps // to ensure that the Help form is disposed of. this.AddOwnedForm(helpForm); // Show the custom Help window. helpForm.Show(); // Indicate that the HelpRequested event is handled. hlpevent.Handled = true; } }}",Event not firing when pressing help button on Messagebox
C# event not firing when pressing help button on Messagebox," I have a C# app where I'm using Messagebox.Show with a help button, as per Microsoft's example at http://msdn.microsoft.com/en-us/library/szwxe9we.aspxI add the event to the form, but pressing the help button never fires the event - pressing F1 on the form DOES however. Even taking Microsoft's example almost completely does not fire the event. The whole code is below. Any ideas what I'm not doing?There is another post where someone had noticed the same. <code>  using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Windows.Forms;namespace WindowsFormsApplication4{ public partial class Form1 : Form { public Form1() { InitializeComponent(); DialogResult r = AlertMessageWithCustomHelpWindow(); } // Display a message box with a Help button. Show a custom Help window // by handling the HelpRequested event. private DialogResult AlertMessageWithCustomHelpWindow() { // Handle the HelpRequested event for the following message. this.HelpRequested += new System.Windows.Forms.HelpEventHandler(this.Form1_HelpRequested); this.Tag = ""Message with Help button.""; // Show a message box with OK and Help buttons. DialogResult r = MessageBox.Show(""Message with Help button."", ""Help Caption"", MessageBoxButtons.OK, MessageBoxIcon.Question, MessageBoxDefaultButton.Button1, 0, true); // Remove the HelpRequested event handler to keep the event // from being handled for other message boxes. this.HelpRequested -= new System.Windows.Forms.HelpEventHandler(this.Form1_HelpRequested); // Return the dialog box result. return r; } private void Form1_HelpRequested (System.Object sender, System.Windows.Forms.HelpEventArgs hlpevent) { // Create a custom Help window in response to the HelpRequested event. Form helpForm = new Form(); // Set up the form position, size, and title caption. helpForm.StartPosition = FormStartPosition.Manual; helpForm.Size = new Size(200, 400); helpForm.DesktopLocation = new Point(this.DesktopBounds.X + this.Size.Width, this.DesktopBounds.Top); helpForm.Text = ""Help Form""; // Create a label to contain the Help text. Label helpLabel = new Label(); // Add the label to the form and set its text. helpForm.Controls.Add(helpLabel); helpLabel.Dock = DockStyle.Fill; // Use the sender parameter to identify the context of the Help request. // The parameter must be cast to the Control type to get the Tag property. Control senderControl = sender as Control; helpLabel.Text = ""Help information shown in response to user action on the '"" + (string)senderControl.Tag + ""' message.""; // Set the Help form to be owned by the main form. This helps // to ensure that the Help form is disposed of. this.AddOwnedForm(helpForm); // Show the custom Help window. helpForm.Show(); // Indicate that the HelpRequested event is handled. hlpevent.Handled = true; } }}",Event not firing when pressing help button on Messagebox
C# pass argument to AsyncCallback function?," I'm learning socket programming and I have the following function: and this is how the callback gets set: The problem is I need to pass another argument to OnDataReceived callback function, how can I do this? I'm trying to make a simple tcp server and I need to track from which client the data is coming from. Any tips? Thanks! <code>  public void OnDataReceived(IAsyncResult asyn) pfnWorkerCallBack = new AsyncCallback(OnDataReceived);",Pass argument to AsyncCallback function?
Is using `new` keyword in method signature generally just for readability?," I've read about new keyword in method signature and have seen the example below on this post, but I still don't get why to write new keyword in method signature. If we'll omit it, it still will do the same things. It will compile. There is gonna be a warning, but it will compile.So, writing new in method signature is just for readability? <code>  public class A{ public virtual void One() { /* ... */ } public void Two() { /* ... */ }}public class B : A{ public override void One() { /* ... */ } public new void Two() { /* ... */ }}B b = new B();A a = b as A;a.One(); // Calls implementation in Ba.Two(); // Calls implementation in Ab.One(); // Calls implementation in Bb.Two(); // Calls implementation in B",Is using new keyword in method signature generally just for readability?
"How to convert class into Dictionary<string,string>?"," Can I convert Class into Dictionary<string, string>?In Dictionary I want my class properties as keys and value of particular a property as the value.Suppose my class is Now suppose my data is Now you can understand my point easily!I want to make a Dictionary! That dictionary should be like: I can get the value! But how can I get property names (not value)?What should I code to create it dynamic? That should work for every class which I want.You can understand this question as:How can I get a list of properties from particular class?Now again I am explaining one of my eagernesses about Dictionary! This question popuped in my mind from answer of my previous question!! <code>  public class Location{ public string city { get; set; } public string state { get; set; } public string country { get; set;} city = Delhistate = Delhicountry = India Dictionary<string,string> dix = new Dictionary<string,string> ();dix.add(""property_name"", ""property_value"");","How can I convert a class into Dictionary<string,string>?"
Drawing a panel from bottom right to top left C#," Download the projectI am trying to make a panel with a background color which should be able to be drawn in runtime when the user holds down left mouse button and moves it around. All works find when the user is starting from top left and go to bottom right just like the image shows:But I want the user to be able to make the panel from bottom right to top left. Just like when you select something on your computer with your mouseHere is my code for now: I think this is where I go wrong, and I simply can't find the right algorithm for it: But if I use a rectangle it works fine, but I want my panel to be able to do it as well. <code>  public void parent_MouseMove(object sender, MouseEventArgs e){ if (e.Button == System.Windows.Forms.MouseButtons.Left) { Point tempLoc = e.Location; this.Location = new Point ( Math.Min(this.Location.X, tempLoc.X), Math.Min(this.Location.Y, tempLoc.Y) ); this.Size = new Size ( Math.Abs(this.Location.X - tempLoc.X), Math.Abs(this.Location.Y - tempLoc.Y) ); this.Invalidate(); }} this.Size = new Size( Math.Abs(this.Location.X - tempLoc.X), Math.Abs(this.Location.Y - tempLoc.Y));",How To Make A Selection Tool In C#
Drawing a panel from bottom right to top left," Download the projectI am trying to make a panel with a background color which should be able to be drawn in runtime when the user holds down left mouse button and moves it around. All works find when the user is starting from top left and go to bottom right just like the image shows:But I want the user to be able to make the panel from bottom right to top left. Just like when you select something on your computer with your mouseHere is my code for now: I think this is where I go wrong, and I simply can't find the right algorithm for it: But if I use a rectangle it works fine, but I want my panel to be able to do it as well. <code>  public void parent_MouseMove(object sender, MouseEventArgs e){ if (e.Button == System.Windows.Forms.MouseButtons.Left) { Point tempLoc = e.Location; this.Location = new Point ( Math.Min(this.Location.X, tempLoc.X), Math.Min(this.Location.Y, tempLoc.Y) ); this.Size = new Size ( Math.Abs(this.Location.X - tempLoc.X), Math.Abs(this.Location.Y - tempLoc.Y) ); this.Invalidate(); }} this.Size = new Size( Math.Abs(this.Location.X - tempLoc.X), Math.Abs(this.Location.Y - tempLoc.Y));",How To Make A Selection Tool In C#
How do I call a stored procedure that doesn't take conventional parameters from C#?," I'm attempting to integrate Red Gate's SQLBackup Pro software into my in-house backup software, written in C#. The natural way to do this is via their Extended Stored Procedure. The problems is that it's called in a format I've never seen before: This works just fine when run via SSMS. Where I run into trouble is trying to call it from C# (using .NET 4 and Dapper Dot Net).My first attempt doesn't work because it interprets the entire cmd string as the name of the stored procedure and throws the error ""Cannot find stored procedure ''"": My second attempt returns immediately and appears (to C#) to succeed, but no backup is actually taken (this also sucks for parameterization): My third attempt also appears to succeed, but no backup is actually taken: What am I missing?UPDATE 1:I overlooked the Red Gate documentation that says the stored proc won't actually raise a SQL error, it just returns errors in an output table. Slick. This might explain why I was getting silent failures in the second and third tests above: some underlying problem and they're not collecting the output to show why.Here's where I am now: When I run this and check those output parameters, I get Exit Code 870: No command passed to SQL Backup. The command is empty.So it's not seeing the empty-named paramater.Update 2:Capturing the above in a trace shows that the empty parameter string ends up replaced with @Parameter1= which explains why the stored procedure doesn't see it. <code>  master..sqlbackup '-SQL ""BACKUP DATABASE pubs TO DISK = [C:\Backups\pubs.sqb]""' var cmd = ""master..sqlbackup '-SQL \""BACKUP DATABASE pubs TO DISK = [C:\\Backups\\pubs.sqb]\""'"";connection.Execute(cmd, commandType: CommandType.StoredProcedure, commandTimeout: 0); var cmd = ""master..sqlbackup"";var p = new DynamicParameters();p.Add("""", ""'-SQL \""BACKUP DATABASE pubs TO DISK = [C:\\Backups\\pubs.sqb]\""'"");connection.Execute(cmd, p, commandType: CommandType.StoredProcedure, commandTimeout: 0); var cmd = ""master..sqlbackup '-SQL \""BACKUP DATABASE pubs TO DISK = [C:\\Backups\\pubs.sqb]\""'"";connection.Execute(cmd, commandTimeout: 0); var cmd = ""master..sqlbackup"";var p = new DynamicParameters();p.Add("""", ""'-SQL \""BACKUP DATABASE pubs TO DISK = [C:\\Backups\\pubs.sqb]\""'"");p.Add(""@exitcode"", DbType.Int32, direction: ParameterDirection.Output);p.Add(""@sqlerrorcode"", DbType.Int32, direction: ParameterDirection.Output);connection.Execute(cmd, p, commandType: CommandType.StoredProcedure, commandTimeout: 0);",How do I call a stored procedure with unconventional parameters?
How do I call a stored procedure that doesn't take conventional parameters?," I'm attempting to integrate Red Gate's SQLBackup Pro software into my in-house backup software, written in C#. The natural way to do this is via their Extended Stored Procedure. The problems is that it's called in a format I've never seen before: This works just fine when run via SSMS. Where I run into trouble is trying to call it from C# (using .NET 4 and Dapper Dot Net).My first attempt doesn't work because it interprets the entire cmd string as the name of the stored procedure and throws the error ""Cannot find stored procedure ''"": My second attempt returns immediately and appears (to C#) to succeed, but no backup is actually taken (this also sucks for parameterization): My third attempt also appears to succeed, but no backup is actually taken: What am I missing?UPDATE 1:I overlooked the Red Gate documentation that says the stored proc won't actually raise a SQL error, it just returns errors in an output table. Slick. This might explain why I was getting silent failures in the second and third tests above: some underlying problem and they're not collecting the output to show why.Here's where I am now: When I run this and check those output parameters, I get Exit Code 870: No command passed to SQL Backup. The command is empty.So it's not seeing the empty-named paramater.Update 2:Capturing the above in a trace shows that the empty parameter string ends up replaced with @Parameter1= which explains why the stored procedure doesn't see it. <code>  master..sqlbackup '-SQL ""BACKUP DATABASE pubs TO DISK = [C:\Backups\pubs.sqb]""' var cmd = ""master..sqlbackup '-SQL \""BACKUP DATABASE pubs TO DISK = [C:\\Backups\\pubs.sqb]\""'"";connection.Execute(cmd, commandType: CommandType.StoredProcedure, commandTimeout: 0); var cmd = ""master..sqlbackup"";var p = new DynamicParameters();p.Add("""", ""'-SQL \""BACKUP DATABASE pubs TO DISK = [C:\\Backups\\pubs.sqb]\""'"");connection.Execute(cmd, p, commandType: CommandType.StoredProcedure, commandTimeout: 0); var cmd = ""master..sqlbackup '-SQL \""BACKUP DATABASE pubs TO DISK = [C:\\Backups\\pubs.sqb]\""'"";connection.Execute(cmd, commandTimeout: 0); var cmd = ""master..sqlbackup"";var p = new DynamicParameters();p.Add("""", ""'-SQL \""BACKUP DATABASE pubs TO DISK = [C:\\Backups\\pubs.sqb]\""'"");p.Add(""@exitcode"", DbType.Int32, direction: ParameterDirection.Output);p.Add(""@sqlerrorcode"", DbType.Int32, direction: ParameterDirection.Output);connection.Execute(cmd, p, commandType: CommandType.StoredProcedure, commandTimeout: 0);",How do I call a stored procedure with unconventional parameters?
How do I call a stored procedure that has an unconventional name?," I'm attempting to integrate Red Gate's SQLBackup Pro software into my in-house backup software, written in C#. The natural way to do this is via their Extended Stored Procedure. The problems is that it's called in a format I've never seen before: This works just fine when run via SSMS. Where I run into trouble is trying to call it from C# (using .NET 4 and Dapper Dot Net).My first attempt doesn't work because it interprets the entire cmd string as the name of the stored procedure and throws the error ""Cannot find stored procedure ''"": My second attempt returns immediately and appears (to C#) to succeed, but no backup is actually taken (this also sucks for parameterization): My third attempt also appears to succeed, but no backup is actually taken: What am I missing?UPDATE 1:I overlooked the Red Gate documentation that says the stored proc won't actually raise a SQL error, it just returns errors in an output table. Slick. This might explain why I was getting silent failures in the second and third tests above: some underlying problem and they're not collecting the output to show why.Here's where I am now: When I run this and check those output parameters, I get Exit Code 870: No command passed to SQL Backup. The command is empty.So it's not seeing the empty-named paramater.Update 2:Capturing the above in a trace shows that the empty parameter string ends up replaced with @Parameter1= which explains why the stored procedure doesn't see it. <code>  master..sqlbackup '-SQL ""BACKUP DATABASE pubs TO DISK = [C:\Backups\pubs.sqb]""' var cmd = ""master..sqlbackup '-SQL \""BACKUP DATABASE pubs TO DISK = [C:\\Backups\\pubs.sqb]\""'"";connection.Execute(cmd, commandType: CommandType.StoredProcedure, commandTimeout: 0); var cmd = ""master..sqlbackup"";var p = new DynamicParameters();p.Add("""", ""'-SQL \""BACKUP DATABASE pubs TO DISK = [C:\\Backups\\pubs.sqb]\""'"");connection.Execute(cmd, p, commandType: CommandType.StoredProcedure, commandTimeout: 0); var cmd = ""master..sqlbackup '-SQL \""BACKUP DATABASE pubs TO DISK = [C:\\Backups\\pubs.sqb]\""'"";connection.Execute(cmd, commandTimeout: 0); var cmd = ""master..sqlbackup"";var p = new DynamicParameters();p.Add("""", ""'-SQL \""BACKUP DATABASE pubs TO DISK = [C:\\Backups\\pubs.sqb]\""'"");p.Add(""@exitcode"", DbType.Int32, direction: ParameterDirection.Output);p.Add(""@sqlerrorcode"", DbType.Int32, direction: ParameterDirection.Output);connection.Execute(cmd, p, commandType: CommandType.StoredProcedure, commandTimeout: 0);",How do I call a stored procedure with unconventional parameters?
Is it possible work in WPF in Mac OS Lion?," Can you work with some C# framework like Windows Presentation Foundation (WPF) in OS X without installing a virtual machine with Windows? For example, using Wine can run .exe and also creates a virtual registry. I can create other partitions on my hard disk using BootCamp and install Windows. I can create a virtual Windows using Parallels Desktop or VMware Fusion, but it's not native working like another application in OS X running just one OS.We can work in C# using MonoDevelop (now XamarinStudio) but can not work with WPF.Then, you can install Microsoft Visual Studio on Mac and work with WPF and/or Silverlight? <code> ",Is it possible to work with something like WPF with C# in OS X?
Is it possible work in WPF in OS X without virtualization?," Can you work with some C# framework like Windows Presentation Foundation (WPF) in OS X without installing a virtual machine with Windows? For example, using Wine can run .exe and also creates a virtual registry. I can create other partitions on my hard disk using BootCamp and install Windows. I can create a virtual Windows using Parallels Desktop or VMware Fusion, but it's not native working like another application in OS X running just one OS.We can work in C# using MonoDevelop (now XamarinStudio) but can not work with WPF.Then, you can install Microsoft Visual Studio on Mac and work with WPF and/or Silverlight? <code> ",Is it possible to work with something like WPF with C# in OS X?
Relative path to unmanaged DLL C#," Possible Duplicate: Specify the search path for DllImport in .NET I have an unmanaged DLL. For clearance, its a C++ dll that I want to use in my c# code.The problem is that its a windows app and user can install it in any directory of their choice. So I can't reference it with a static path and I couldn't find a way to give a relative path. Here is the code I tried : And below is the error I am receiving. Unable to find an entry point named 'SetDllDirectory' in DLL 'mydll.dll'.This question could be a replica of""C++ unmanaged DLL in c#""""Relative Path to DLL in Platform Invoke Statement""Sorry for that but I didn't find any solution in these references. <code>  [DllImport(""mydll.dll"", CharSet = CharSet.Auto, SetLastError = true)] static extern bool SetDllDirectory(string lpPathName); public void SetDllDirectory(string lpPathName) { try { bool r = SetDllDirectory(lpPathName); } catch (Exception ex) { throw ex; } } public void SetDirectoryPath() { try { DirectoryInfo directory = new DirectoryInfo(System.IO.Path.GetDirectoryName(System.Windows.Forms.Application.ExecutablePath)); if (directory.Exists) SetDllDirectory(directory.ToString() + ""\\mydll.dll""); } catch (Exception ex) { throw ex; } }",Relative path to unmanaged DLL
Dynamically adding hyperlinks to a WPF RichTextBox," I'm trying to dynamically add some hyperlinks to a RichTextBox using WPF and C# but am not having much success. My code is summarised below: When I run this the RichTextBox show the link but it is grey and I cannot click on it? Can someone please point out where I might be going wrong.Thanks. <code>  FlowDocument doc = new FlowDocument();richTextBox1.Document = doc;richTextBox1.IsReadOnly = true;Paragraph para = new Paragraph();doc.Blocks.Add(para);Hyperlink link = new Hyperlink();link.IsEnabled = true;link.Inlines.Add(""Hyperlink"");link.NavigateUri = new Uri(""http://www.google.co.uk"");link.Click += new RoutedEventHandler(this.link_Click);para.Inlines.Add(link);....protected void link_Click(object sender, RoutedEventArgs e) { MessageBox.Show(""Clicked link!"");}",Dynamically adding hyperlinks to a RichTextBox
ftp directory partial listing with wildcards, First I asked that: ftp directory listing timeout. Huge number of subdirs. I got the answer.Still because I can have hundred thousands of FTP objects in the directory it could take really long time to scan that. However I thought it might be possible to retrieve all the objects that begin with 'A' and then 'B' and so on... As it retrieves directories it could start processing them on the other thread without waiting till it gets the entire list.Is it possible to do FTP directory listing with wildcards using standard FtpWebRequest? <code> ,FTP directory partial listing with wildcards
Change padding for all cells in a single DataGridView column," I have a DataGridView in my C# application. Using the designer, I have set a AlternatingRowsDefaultCellStyle as well as the DefaultCellStyle properties on the DGV itself. Both of those styles have a padding value of 0, 0, 5, 0. I have not set any custom styles for any of the DGV columns from the Edit Columns menu in the DataGridView Tasks add-in.There is one column in the DGV that is an image column that I draw a small graph in for each row. I would like to remove the padding from all cells in this column so there is no padding applied to the cell which leaves some whitespace at the end of the graph.Each of the following things I have tried do not remove the padding from any cells in the column, but also don't throw any exceptions. I suspect that maybe the DefaultCellStyle padding from the DataGridView itself is overriding the default cell style I am trying to set for the column, but if that is the case, what do I need to do to prevent this?SOLUTION:After following the link provided by jmh_gr I found the problem was that the DefaultCellStyle for the DataGridView itself is inherited LAST on the cell so I had to remove the padding from the DGV properties, and apply it to all the columns except the one I didn't want padding on. <code>  // first attempt// taken from http://social.msdn.microsoft.com/Forums/eu/winforms/thread/a9227253-8bb4-429a-a700-8a3a255afe4ddeviceGrid.Columns[""GProduction""].DefaultCellStyle.Padding = new Padding(0);// second attemptDataGridViewCellStyle style = deviceGrid.Columns[""Graph""].DefaultCellStyle; // also tried Clone()style.Padding = new Padding(0);deviceGrid.Columns[""GProduction""].DefaultCellStyle = style;// third attemptDataGridViewColumn col = deviceGrid.Columns[""Graph""];DataGridViewImageCell icell = new DataGridViewImageCell();icell.Style.Padding = new Padding(0);col.CellTemplate = icell;",Change padding for all cells in a single DataGridView column
Change padding for all cells in a single DataGridView column [resolved]," I have a DataGridView in my C# application. Using the designer, I have set a AlternatingRowsDefaultCellStyle as well as the DefaultCellStyle properties on the DGV itself. Both of those styles have a padding value of 0, 0, 5, 0. I have not set any custom styles for any of the DGV columns from the Edit Columns menu in the DataGridView Tasks add-in.There is one column in the DGV that is an image column that I draw a small graph in for each row. I would like to remove the padding from all cells in this column so there is no padding applied to the cell which leaves some whitespace at the end of the graph.Each of the following things I have tried do not remove the padding from any cells in the column, but also don't throw any exceptions. I suspect that maybe the DefaultCellStyle padding from the DataGridView itself is overriding the default cell style I am trying to set for the column, but if that is the case, what do I need to do to prevent this?SOLUTION:After following the link provided by jmh_gr I found the problem was that the DefaultCellStyle for the DataGridView itself is inherited LAST on the cell so I had to remove the padding from the DGV properties, and apply it to all the columns except the one I didn't want padding on. <code>  // first attempt// taken from http://social.msdn.microsoft.com/Forums/eu/winforms/thread/a9227253-8bb4-429a-a700-8a3a255afe4ddeviceGrid.Columns[""GProduction""].DefaultCellStyle.Padding = new Padding(0);// second attemptDataGridViewCellStyle style = deviceGrid.Columns[""Graph""].DefaultCellStyle; // also tried Clone()style.Padding = new Padding(0);deviceGrid.Columns[""GProduction""].DefaultCellStyle = style;// third attemptDataGridViewColumn col = deviceGrid.Columns[""Graph""];DataGridViewImageCell icell = new DataGridViewImageCell();icell.Style.Padding = new Padding(0);col.CellTemplate = icell;",Change padding for all cells in a single DataGridView column
Parsing if-else if statment algorithm c#," I am trying to create a very simple parser for an if-else type structure that will build and execute a SQL statement.Rather than testing conditions for executing statements, I would be testing conditions to build a string.An example of a statment would be: If VariableA equals Case1 the resulting string should be: select column1 from table1A more complex example would be with nested if statements: This is where I am really having trouble, I can't think of a good way to identify each if-else-end group correctly.Also, I'm not sure what a good way to keep track of if the string in the ""else"" clause should evaluate to true.I have been looking around the net at different types of parsing algorithms, all of them seeming very abstract and complex.Are there any suggestions of a good place to start for this non-computer science major? <code>  select column1from#if(VariableA = Case1)table1#else if(VariableA = Case2)table2#elsedefaultTable#end select column1from#if(VariableA = Case1)#if(VariableB = Case3) table3#else table4#else if(VariableA = Case2)table2#elsedefaultTable#end",Parsing if-else if statement algorithm
Parsing if-else if statment algorithm," I am trying to create a very simple parser for an if-else type structure that will build and execute a SQL statement.Rather than testing conditions for executing statements, I would be testing conditions to build a string.An example of a statment would be: If VariableA equals Case1 the resulting string should be: select column1 from table1A more complex example would be with nested if statements: This is where I am really having trouble, I can't think of a good way to identify each if-else-end group correctly.Also, I'm not sure what a good way to keep track of if the string in the ""else"" clause should evaluate to true.I have been looking around the net at different types of parsing algorithms, all of them seeming very abstract and complex.Are there any suggestions of a good place to start for this non-computer science major? <code>  select column1from#if(VariableA = Case1)table1#else if(VariableA = Case2)table2#elsedefaultTable#end select column1from#if(VariableA = Case1)#if(VariableB = Case3) table3#else table4#else if(VariableA = Case2)table2#elsedefaultTable#end",Parsing if-else if statement algorithm
image data type MS SQL 2008 C# data type," I created a data table I'm trying to write ProductImages class in C# How do i declare property for ProductImage ? <code>  CREATE TABLE [ProductImages]([ProductImageID] [int] IDENTITY(1,1) NOT NULL,[ProductImage] [image] NOT NULL CONSTRAINT [PK_ProductImages] PRIMARY KEY CLUSTERED ( [ProductImageID] ASC ) ) public class ProductImages{ private int productImageID; public int ProductImageID { get { return productImageID; } set { productImageID = value; } } // I need to declare property for ProductImage???}",image data type SQL Server 2008 C# data type
How to put WPF Expander Toggle Button on right," By default the expander has a left aligned toggle button but in my WPF app i want toggle button on the right side of the header without the help of Expression Blend. just plain XAML and/or C#. My expander contains a vertically oriented stackpanel which has labels as its child.I went for its part but here it says ""The Expander control does not have any named parts"".I found an example here. But it overrides the default Expander Style.I think the attached image should convey what i want. How to do. Any link would be helpful. <code> ",How to put Expander ToggleButton on right
Full path with double slash (C#), Is it possible to get a full path with double backslash by using Path.GetFullPath? Something like this: instead of this: Or is there any other method? <code>  C:\\Users\\Mammamia\\Videos\\Documents\\CFD\\geo_msh\\cubeOp.txt C:\Users\Mammamia\Videos\Documents\CFD\geo_msh\cubeOp.txt,Full path with double backslash (C#)
LINQ Except to exclude items, I have 2 IList<T> of the same type of object ItemsDTO. I want to exclude one list from another. However this does not seem to be working for me and I was wondering why? I'm trying to remove items in related from the relating list. <code>  IList<ItemsDTO> related = itemsbl.GetRelatedItems();IList<ItemsDTO> relating = itemsbl.GetRelatingItems().Except(related).ToList();,LINQ Except() Method Does Not Work
How do I write the equivalent to this C++ code in C#?," This C++ code checks if o is a Node * and if so, calls a method on d. What's the shortest and/or most efficient way to write the equivalent in C#? <code>  if (Node * d = dynamic_cast<Node *>(o)) d->do_it();",What's the C# equivalent to C++'s dynamic_cast?
Assign an ICC Color Profile to an image in C# (Dotnet), In short: I want to assign a ICC color profile to an image and not apply it.More info: In my company we need to merge a multiple layered pdf file into one layer. To do this we merge the pdf page into an image and then save the image as a pdf. But in the process of creating the image the color profile of the image gets lost. If we Apply the color profile in C# the profile will transform from Device RGB (default output of .NET) to the sRGB_IEC61966-2-1_no_black_scaling.icc profile. In the transformation some colors change. Instead of applying the color profile we need to assign it. Meaning that no colors are transformed.Does anyone know how to achieve this? Thanks in advance. <code> ,Assign an ICC Color Profile to an image in C#
"Linq to SQL .Equal returns true when comparing int to string --> Id.Equals(""5"") returns true"," We have a new developer that is just now learning LinqToSql. While going over his code, we noticed that he was using .Equals instead of == for a value comparison. On top of that, he is comparing an int with a string. What completely baffled us, was that it worked! After doing some testing it appears to only work with LinqToSql. Linq to objects returns false and just doing int.Equals(string) returns false.Below is a simple test using two sql tables: RESULTS: Any explanation? <code>  Customer Id(PK)(int) Name(varchar) CompanyId(FK)(int)Company Id(PK)(int) Name(varchar) Console.WriteLine(""{0}.Equals(\""{1}\"") returns {2}"", 3, ""3"", 3.Equals(""3"")); using (WrDataClassesDataContext wrDataContext = new WrDataClassesDataContext()) { var customers1 = from c in wrDataContext.Customers where c.CompanyId.Equals(""3"") select c; Console.WriteLine(""int .Equals String Results: ""); foreach (Customer customer in customers1) { Console.WriteLine(customer.Name); } var customers3 = from c in wrDataContext.Customers where c.CompanyId == 3 select c; Console.WriteLine(""int == int Results: ""); foreach (Customer customer in customers3) { Console.WriteLine(customer.Name); } } 3.Equals(""3"") returns Falseint .Equals String Results:MikeJoeCandyint == int Results:MikeJoeCandyPress any key to continue . . .","Linq to SQL .Equals returns true when comparing int to string --> Id.Equals(""5"") returns true"
IronRuby: how to embed a gem into a C# project (and call from embedded ruby script)?," I have a C# project in which I have embedded an IronRuby program. The project (including my ruby script) is compiled to an .exe file in Visual Studio 2010 for distribution. I'm using a pattern similar to this for bootstrapping the IronRuby script: http://pastebin.com/NKes1cyc (and Jimmy Schementi goes into more detail here: http://blog.jimmy.schementi.com/2009/12/ironruby-rubyconf-2009-part-35.html).My problem: I would like to embed a gem (json_pure) in my C# assembly and call it from the ruby script.Some resources I've found:In JRuby, you can easily package a gem into a jar file and then simply require the jar file at runtime - http://blog.nicksieger.com/articles/2009/01/10/jruby-1-1-6-gems-in-a-jarThe irpack tool (at http://github.com/kumaryu/irpack) is capable of compiling Ruby into an .exe (I think it dynamically creates and compiles a C# project) while embedding the ruby standard library. But it looks like it is only embedding the pre-built IronRuby .dlls, not ruby .rb files. The approach this tool uses would work if I could figure out how to compile Ruby source files into a .dll.How do I embed an IronRuby gem into a C# assembly (or compile an IronRuby gem to a .dll)?EDIT: Page 472 of IronRuby In Action (""Using External Libraries"") explains how to require standard ruby libraries from within an embedded ruby file. It involves adding the folder(s) to the runtime search paths collection, as follows (edited for brevity and clarity): This approach assumes the host machine has IronRuby installed, but I want to embed ruby files (from a gem) into the assembly so it can be run without IronRuby pre-installed.EDIT 2 (further research):Reading through the source code of the irpack tool referenced above, I notice that Kumaryu is embedding resources into the final assembly via the System.IO.Packaging.Package class, and then passing the package into the call to msbuild (see https://github.com/kumaryu/irpack/blob/master/lib/irpack/packager.rb). Perhaps some further research into packaging files into an executable would lead to a solution. The problem I see is that ruby files in a gem require other ruby files... can a ruby file in an assembly package require other ruby files in the same package?EDIT 3:I haven't gotten any further to an answer yet, but I'd be interested to hear anyone's feedback, even if it's just a link or a suggestion about where to look. I'm new to msbuild, and the documentation is pretty hefty. An initial web search for ""msbuild embed zip package"" didn't reveal anything relevant. <code>  ScriptEngine engine = IronRuby.Ruby.CreateEngine();var searchPaths = engine.GetSearchPaths().Concat(new[] { ""C:\\Program Files (x86)\\IronRuby 1.1\\Lib\\ruby\\1.9.1"", ""C:\\Program Files (x86)\\IronRuby 1.1\\Lib\\ironruby""});engine.SetSearchPaths(searchPaths)",How to embed a ruby gem into a C# project and require it from an embedded IronRuby script?
How to embed a gem into a C# project (and call from embedded ruby script)?," I have a C# project in which I have embedded an IronRuby program. The project (including my ruby script) is compiled to an .exe file in Visual Studio 2010 for distribution. I'm using a pattern similar to this for bootstrapping the IronRuby script: http://pastebin.com/NKes1cyc (and Jimmy Schementi goes into more detail here: http://blog.jimmy.schementi.com/2009/12/ironruby-rubyconf-2009-part-35.html).My problem: I would like to embed a gem (json_pure) in my C# assembly and call it from the ruby script.Some resources I've found:In JRuby, you can easily package a gem into a jar file and then simply require the jar file at runtime - http://blog.nicksieger.com/articles/2009/01/10/jruby-1-1-6-gems-in-a-jarThe irpack tool (at http://github.com/kumaryu/irpack) is capable of compiling Ruby into an .exe (I think it dynamically creates and compiles a C# project) while embedding the ruby standard library. But it looks like it is only embedding the pre-built IronRuby .dlls, not ruby .rb files. The approach this tool uses would work if I could figure out how to compile Ruby source files into a .dll.How do I embed an IronRuby gem into a C# assembly (or compile an IronRuby gem to a .dll)?EDIT: Page 472 of IronRuby In Action (""Using External Libraries"") explains how to require standard ruby libraries from within an embedded ruby file. It involves adding the folder(s) to the runtime search paths collection, as follows (edited for brevity and clarity): This approach assumes the host machine has IronRuby installed, but I want to embed ruby files (from a gem) into the assembly so it can be run without IronRuby pre-installed.EDIT 2 (further research):Reading through the source code of the irpack tool referenced above, I notice that Kumaryu is embedding resources into the final assembly via the System.IO.Packaging.Package class, and then passing the package into the call to msbuild (see https://github.com/kumaryu/irpack/blob/master/lib/irpack/packager.rb). Perhaps some further research into packaging files into an executable would lead to a solution. The problem I see is that ruby files in a gem require other ruby files... can a ruby file in an assembly package require other ruby files in the same package?EDIT 3:I haven't gotten any further to an answer yet, but I'd be interested to hear anyone's feedback, even if it's just a link or a suggestion about where to look. I'm new to msbuild, and the documentation is pretty hefty. An initial web search for ""msbuild embed zip package"" didn't reveal anything relevant. <code>  ScriptEngine engine = IronRuby.Ruby.CreateEngine();var searchPaths = engine.GetSearchPaths().Concat(new[] { ""C:\\Program Files (x86)\\IronRuby 1.1\\Lib\\ruby\\1.9.1"", ""C:\\Program Files (x86)\\IronRuby 1.1\\Lib\\ironruby""});engine.SetSearchPaths(searchPaths)",How to embed a ruby gem into a C# project and require it from an embedded IronRuby script?
RaiseEvent in C#," (I know the title sounds easy, but hold on—this probably isn't the question you think it is.)In VB.NET I was able to write custom events. For an example, I had a separate thread that would periodically raise an event and on that event the GUI would need to be updated. I didn't want the busy thread to bother with UI calculations and I didn't want to put Me.Invoke(Sub() ...) in the event handler since it was also called from the GUI thread.I came up with this very useful bit of code. The GUI thread would set EventSyncInvoke = Me (the main form). The thread could then simply raise the event TestEvent as usual, no special code, and it would be seamlessly executed on the GUI thread: Now in C# I can do this much: But where is the ability to do custom raising? <code>  Private TestEventDelegate As EventHandlerPublic EventSyncInvoke As System.ComponentModel.ISynchronizeInvokePublic Custom Event TestEvent As EventHandler AddHandler(value As EventHandler) TestEventDelegate = [Delegate].Combine(TestEventDelegate, value) End AddHandler RemoveHandler(value As EventHandler) TestEventDelegate = [Delegate].Remove(TestEventDelegate, value) End RemoveHandler RaiseEvent(sender As Object, e As System.EventArgs) If EventSyncInvoke IsNot Nothing Then EventSyncInvoke.Invoke(TestEventDelegate, {sender, e}) Else TestEventDelegate.Invoke({sender, e}) End If End RaiseEventEnd Event public event EventHandler TestEvent add { testEventDelegate = (EventHandler)Delegate.Combine(testEventDelegate, value); } remove { testEventDelegate = (EventHandler)Delegate.Remove(testEventDelegate, value); }}",Equivalent of VB's custom RaiseEvent blocks in C#?
Equivalent of VB's RaiseEvent in C#?," (I know the title sounds easy, but hold on—this probably isn't the question you think it is.)In VB.NET I was able to write custom events. For an example, I had a separate thread that would periodically raise an event and on that event the GUI would need to be updated. I didn't want the busy thread to bother with UI calculations and I didn't want to put Me.Invoke(Sub() ...) in the event handler since it was also called from the GUI thread.I came up with this very useful bit of code. The GUI thread would set EventSyncInvoke = Me (the main form). The thread could then simply raise the event TestEvent as usual, no special code, and it would be seamlessly executed on the GUI thread: Now in C# I can do this much: But where is the ability to do custom raising? <code>  Private TestEventDelegate As EventHandlerPublic EventSyncInvoke As System.ComponentModel.ISynchronizeInvokePublic Custom Event TestEvent As EventHandler AddHandler(value As EventHandler) TestEventDelegate = [Delegate].Combine(TestEventDelegate, value) End AddHandler RemoveHandler(value As EventHandler) TestEventDelegate = [Delegate].Remove(TestEventDelegate, value) End RemoveHandler RaiseEvent(sender As Object, e As System.EventArgs) If EventSyncInvoke IsNot Nothing Then EventSyncInvoke.Invoke(TestEventDelegate, {sender, e}) Else TestEventDelegate.Invoke({sender, e}) End If End RaiseEventEnd Event public event EventHandler TestEvent add { testEventDelegate = (EventHandler)Delegate.Combine(testEventDelegate, value); } remove { testEventDelegate = (EventHandler)Delegate.Remove(testEventDelegate, value); }}",Equivalent of VB's custom RaiseEvent blocks in C#?
C# Combining Strings using the '%' Operator," I want to do the following in C# (coming from a Python background): How do I replace the token inside the string with the value outside of it? <code>  strVar = ""stack""mystr = ""This is %soverflow"" % (strVar)",How do I interpolate strings?
Interpolate Strings in C# (like the '%' operator in Python)," I want to do the following in C# (coming from a Python background): How do I replace the token inside the string with the value outside of it? <code>  strVar = ""stack""mystr = ""This is %soverflow"" % (strVar)",How do I interpolate strings?
C# List sorting issue," I have List like this The output is coming back as where as I am expecting the results as Any idea why ""a-a"" is not coming before ""a.a"" where as ""a-"" comes before ""a."" <code>  List<string> items = new List<string>(); items.Add(""-""); items.Add("".""); items.Add(""a-""); items.Add(""a.""); items.Add(""a-a""); items.Add(""a.a""); items.Sort(); string output = string.Empty; foreach (string s in items) { output += s + Environment.NewLine; }MessageBox.Show(output); -.a-a.a.aa-a -.a-a.a-aa.a",String sorting issue in C#
"Embeding html,javascript,css as resource and using in web control", I am using a web browser control that display html page in window form now I want to embed html and javascript files and css files as resource. <code> ,"Embedding html,javascript,css as resource and using in web control"
Updating ObservableColllection in WPF MVVM using RX, I've been trying to get a handle on the Rx library and working it out in WPF with MVVM. I broken my application into components such as repository and the ViewModel. My repository in able to provide a Collection of Students one by one but the moment i try to add into the View bound ObservableCollection it throws a thread error. I 'd apreciate some pointer on to get this working for me. <code> ,Updating an ObservableCollection from another thread
Divide a string @ first space," For a chat-bot, if someone says ""!say "" it will recite what you say after the space. Simple.Example input: Desired output: The string can be represented as s for sake of argument. s.Split(' ') yields an array.s.Split(' ')[1] is just the first word after the space, any ideas on completely dividing and getting all words after the first space?I've tried something along the lines of this: The input being: The output: Which is obviously not what I wanted :p(I know there are several answers to this question, but none written in C# from where I searched.) <code>  !say this is a test this is a test s.Split(' ');for (int i = 0; i > s.Length; i++){ if (s[i] == ""!say"") { s[i] = """"; }} !say this is a test !say",Divide a string at first space
"Can Amazon Simple Notification Service ""PUSH"" notifications to a desktop client?"," Can Amazon Simple Notification Service ""push"" notifications to a desktop client? It this possible as a true push without polling? <code> ","Can Amazon Simple Notification Service ""push"" notifications to a desktop client?"
How to get list of running thread in C#," I create dynamic threads in C# and I need to get the status of those running threads. How can you get list of running threads? <code>  List<string>[] list;list = dbConnect.Select();for (int i = 0; i < list[0].Count; i++){ Thread th = new Thread(() =>{ sendMessage(list[0]['1']); //calling callback function }); th.Name = ""SID""+i; th.Start();}for (int i = 0; i < list[0].Count; i++){ // here how can i get list of running thread here.}",How do you get list of running threads in C#?
c# multitasking: use the same lock object at two different code block?," Can I use the same lock object at two methods, accessed by two different threads? Goal is to make task1 and task2 thread safe. <code>  object lockObject = new object();// Thread 1void Method1(){ lock(lockObject) { // task1 }}// Thread 2void Method2(){ lock(lockObject) { // task2 }}",use the same lock object at two different code block?
How to Convert a String to a Nullable Date Type?," I have the below code and I'd need to convert a string to a type which is also specified from String: I get the below error messagE: How would that be nicely possible?I know one ugly way would be to check whether the type is nullable using if: Would there be any better way?Thanks,  <code>  Type t = Type.GetType(""System.Nullable`1[[System.DateTime, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]""); object d = Convert.ChangeType(""2012-02-23 10:00:00"", t); Invalid cast from 'System.String' to 'System.Nullable`1[[System.DateTime, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]'. Type possiblyNullableType = Type.GetType(""System.Nullable`1[[System.DateTime, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]""); var underlyingType = Nullable.GetUnderlyingType(possiblyNullableType); Object result; // if it's null, it means it wasn't nullable if (underlyingType != null) { result = Convert.ChangeType(""2012-02-23 10:00:00"", underlyingType); }",How to Convert a String to a Nullable Type Which is Determined at Runtime?
Socket.IOControl," I tried - for the first time - to control a socket by such a low level wayWalking through tutorial, I faced these lines : I referred to the MSDN documentation, but it's really very ambiguous. Question:What are these 2 bytes' arrays? What are they used in?The documentation says OPTIONS - what options? <code>  byte[] byTrue = new byte [4] {1, 0, 0, 0};byte[] byOut = new byte [4] {1, 0, 0, 0};_Socket.IOControl(IOControlCode.ReceiveAll, byTrue, byOut); ",Socket.IOControl - Ambiguous Documentation 
What happens when I interrupt a C# application with Control-C?," What happens when I interrupt my C# console application with Control-C? Is the process killed? Is memory freed? Are finally blocks executed? What happens to database connections?Does any of this differ if the application is built for debug or release, or run inside/outside Visual Studio? <code> ",What happens when I interrupt a C# console application with Control-C?
How do you parse a JSON file in c# using JSON.net," I am trying to read a JSON file and parse it. I have this code for reading from my file But how do I parse it now from reader so I can search data from the file?I tried reading the documentation but couldn't find anything <code>  StreamReader re = new StreamReader(""artists.json"");JsonTextReader reader = new JsonTextReader(re);",How do you parse a JSON file using JSON.net
Does += operator ensures an EXPLICIT conversion or implicit CASTING in C# ?, The example below compiles: but this one below fails with Error 1 Cannot implicitly convert type 'int' to 'byte'. An explicit conversion exists (are you missing a cast?)Does this mean that for C# += operator provides EXPLICIT conversion? <code>  public static void Main(){ Byte b = 255; b += 100;} public static void Main() { Byte b = 255; b = b + 100; },Does += operator ensures an EXPLICIT conversion or implicit CASTING in C#?
single endpoint multiple servicecontract," How can I write a WCF web service that has single endpoint but multiple service contract?Example: Lets think like IInternetService is my main webs service and i want to implement IwiredService and IWirelessService in it, but i want to do implementation in their classes.Is this possible? How can i solve this problem? <code>  [ServiceContract]public interface IWirelessService{ [OperationContract] void AddWireless();}[ServiceContract]public interface IWiredService { [OperationContract] void AddWired();}[ServiceContract]public interface IInternetService{ [OperationContract] void AddInternet();}",Single endpoint with multiple service contracts
Is it possible to Observable.Buffer on something other then time," I've been looking for examples on how to use Observable.Buffer in rx but can't find anything more substantial than boiler plate time buffered stuff.There does seem to be an overload to specify a ""bufferClosingSelector"" but I can't wrap my mind around it.What I'm trying to do is create a sequence that buffers by time or by an ""accumulation"".Consider a request stream where every request has some sort of weight to it and I do not want to process more than x accumulated weight at a time, or if not enough has accumulated just give me what has come in the last timeframe(regular Buffer functionality)  <code> ",Is it possible to Observable.Buffer on something other than time
How to handle exceptions from asuynchroneous methods within a SelectMany statement," I am trying to process some tasks asynchronously using Rx, e.g. The problem I have with this code is that the exception is not passed to the subscriber. So, after a lot of trying I gave up and decided to ask this simple question:How do you handle the exceptions raised from within asynchronous methods within a SelectMany statement?Just to make it clear, the final implementation is a synchroneous function call that may or may not throw an exception. The goal is to pass it on to the subscriber so that it can be further processed (in the specific case a message will be shown to the user).EditI moved my findings down to an answer, so that I can mark this question as answered. Personally, I do not agree with self answering ... but sometimes there is no other way, so sorry for it. <code>  var list = Enumerable.Range(0, 100) .ToObservable() .SelectMany(x => Observable.Start(() => { Console.WriteLine(""Processing {0} ..."", x); Thread.Sleep(100 * x % 3); if (x > 90) { Console.WriteLine(""Procesing exception {0} > 90"", x); throw new Exception(""Value too large""); } Console.WriteLine(""Processing {0} completed."", x); return x; })) .Subscribe( x => { Console.WriteLine(""Next [{0}]"", x); }, e => { Console.WriteLine(""Exception:""); Console.WriteLine(e.Message); }, () => { Console.WriteLine(""Complete""); } );",How to handle exceptions from asynchronous methods within a SelectMany statement
C# : 'new' keyword in getter > performance hit?," I have the following code: Now somewhere else in my code, I make about 2500 calls in a loop to Character.LevelPosition.This means that per update-cycle, 5000 'new' Vector2s are being made, and on my laptop, it really drops the framerate.I have temporarily fixed it by creating before I initiate the loop, but I kinda feel its ugly code to do this everytime I come across a similar situation. Maybe it -is- the way to go, but I want to make sure.Is there a better or commonly accepted way to do this?I'm using the XNA-Framework, which uses Vector2's. <code>  public class Character{ public Vector2 WorldPixelPosition { get { return Movement.Position; } } public Vector2 WorldPosition { get { return new Vector2(Movement.Position.X / Tile.Width, Movement.Position.Y / Tile.Height); } } public Vector2 LevelPosition { get { return new Vector2(WorldPosition.X % Level.Width, WorldPosition.Y % Level.Height); } }} var levelPosition = Character.LevelPosition;",'new' keyword in getter > performance hit?
'new' keyword in getter > performance hit?," I have the following code: Now somewhere else in my code, I make about 2500 calls in a loop to Character.LevelPosition.This means that per update-cycle, 5000 'new' Vector2s are being made, and on my laptop, it really drops the framerate.I have temporarily fixed it by creating before I initiate the loop, but I kinda feel its ugly code to do this everytime I come across a similar situation. Maybe it -is- the way to go, but I want to make sure.Is there a better or commonly accepted way to do this?I'm using the XNA-Framework, which uses Vector2's. <code>  public class Character{ public Vector2 WorldPixelPosition { get { return Movement.Position; } } public Vector2 WorldPosition { get { return new Vector2(Movement.Position.X / Tile.Width, Movement.Position.Y / Tile.Height); } } public Vector2 LevelPosition { get { return new Vector2(WorldPosition.X % Level.Width, WorldPosition.Y % Level.Height); } }} var levelPosition = Character.LevelPosition;",'new' keyword in getter > performance hit?
How to define Indexer indexer to an Interface?, Is it possible to add the indexer behaviour from an interface?something like this : <code>  interface IIndexable<T>{ T this[string index];},How to define Indexer behaviour to an Interface?
Entity Framework navigation properties and the repository pattern," I am struggling to figure out the ideal implementation of Entity Framework and the repository pattern. I'm using Entity Framework 4.3 code-first and I just can't seem to wrap my head around good proper usage of entity framework.I love the things EF brings to the table such as tracked entities, lazy loading, navigation properties, etc. But some of these don't play nice with the repository pattern as I understand it. Let's look at a few examples and maybe you guys can set me straight.Generic Repository vs Non-generic RepositoryMy initial impression of the generic repository is that I don't like it because I don't need the exact same functionality for every entity. For example, I have a repository that stores simple variables (key/value pairs) in the database. I don't need an Add or Delete method because these are static variables. I only need an Update method and a Get method. The generic repository just doesn't seem very robust and doesn't allow for much custom code in the data layer. I also hate when generic repositories return IQueryable<T> because it gives the upper layers the ability to write expressions directly against the data store, and the upper layers have to assume that the data access technology being used properly implements IQueryable so that it's querying the database and not pulling everything into memory and querying it from there.It just seems like generic repositories, especially ones that return IQueryable, don't really adhere to good separation of concerns. Maybe you guys can clear that one up for me, but right now I'm using explicitly named repositories and only returning IEnumerable or IList.Navigation PropertiesI love the concept of navigation properties, but it seems like I rarely get to use them when implementing the repository pattern. For instance, I have a user with a navigation property called ""Aliases"". If I want to add an Alias for a user it would be super easy to add it via the navigation property. But then where do I call dbContext.SaveChanges()? I had myUser passed to me and I used the navigation property to avoid having to inject my IAliasRepository into the class I'm in. However I now have no way to persist my new alias to the database because my upper layers are unaware of Entity Framework. I now have to inject my IAliasRepository anyway just so I can all _aliasRepository.SaveChanges(). Well now that feels like a complete waste. I feel like I should have just used _aliasRepository.AddAlias(newAlias) instead since I have to have the repository injected anyway.Self-Tracking EntitiesSelf-tracking entities are awesome but they don't lend themselves well to applications where you're trying to hide the data access layer details from the rest of the app. For instance, if I were writing repositories and being totally ignorant that they would be using EF then I would most definitely add an Update(Entity entity) method. However, in EF you don't need to do that because you can simply make changes to an entity and then call SaveChanges(). The entity tracks everything that was modified and persists those changes to the database. This causes me to eliminate my update methods that I would have included had I not been aware that EF doesn't need them. This makes re-factoring harder down the road because I may have to go back and add proper update methods. My only other option would be to include the methods anyway and then just do nothing with them when I implement my repositories. So my code would look like this, even though it's completely unnecessary. I suppose having an empty method isn't terrible if I'm just trying to maintain proper separation of concerns for easy refactoring later, but it still feels funny to do that.Keeping DbContext in syncAnother weird quirk of this pattern is that you have to be extra careful with your DbContext. The same instance of it needs to be injected into all repositories. Otherwise if you pull entities out of one repository and try to associate them with entities from another repository then they won't play nice together because they are from different instances of DbContext. IoC containers make this easier to control, but it's an odd issue for developers just beginning with EF. Not really a problem here so much as just another oddity with Entity Framework and the repository pattern.What is the proper implementation of the repository pattern with EF? How do you overcome these hurdles?  <code>  myUser.Aliases.Add(new Alias { Name=""cls"", Value=""ClearScreen"" }); var myEntity = _entityRepository.GetEntity(""some unique ID"");myEntity.SomeProperty = ""new value"";_entityRepository.SaveChanges(); public void UpdateEntity(Entity entity){ // Do nothing. EF is tracking changes and they will be persisted when // SaveChanges() is called.} var myEntity = _entityRepository.GetEntity(""some unique ID"");myEntity.SomeProperty = ""new value"";_entityRepository.UpdateEntity(myEntity);_entityRepository.SaveChanges();","Entity Framework, Navigation Properties, and the Repository Pattern"
Are Lambda expressions in C# clojures?," Are lambda expressions (and to a degree, anonymous functions) closures?My understanding of closures are that they are functions that are treated as objects, which seems to be an accurate representation of what anonymous functions and Lambda expressions do.And is it correct to call them closures? I understand that closures came about (or became popular) due to the lisp dialect, but is it also a general programming term?Thanks for any clarification that you can provide! <code> ",Are Lambda expressions in C# closures?
"(407) Proxy Authentication Required, in c#"," I am working with a proxy that requires authentication, i.e., in a browser if I try to open a page it will immediately ask for credentials. I supplied same credentials in my program but it fails with HTTP 407 error.Here is my code: I have tried every possible thing but seem like I am missing something.Is it something like, I have to make two requests? First with out credentials and once I hear back from server about need for credentials, make same request with credentials? <code>  HttpWebRequest request = (HttpWebRequest)WebRequest.Create(URL);IWebProxy proxy = WebRequest.GetSystemWebProxy();CredentialCache cc = new CredentialCache();NetworkCredential nc = new NetworkCredential();nc.UserName = ""userName"";nc.Password = ""password"";nc.Domain = ""mydomain"";cc.Add(""http://20.154.23.100"", 8888, ""Basic"", nc);proxy.Credentials = cc;//proxy.Credentials = System.Net.CredentialCache.DefaultCredentials;request.Proxy = proxy;request.Proxy.Credentials = cc;request.Credentials = cc;request.PreAuthenticate = true;",Proxy Basic Authentication in C#: HTTP 407 error
How to get column name from gridview?," I would like to know how can I get a column name from a gridview? by its number not by name.like : Name|Age|Birthday: ( so name=0 , age=1 etc...)thanks. <code> ",Test test test test test test test
How do I make calls to a REST api using c#?," This is the code I have so far: The problem is that I think the exception block is being triggered (because when I remove the try-catch, I get a server error (500) message. But I don't see the Console.Out lines I put in the catch block.My Console: <code>  public class Class1 { private const string URL = ""https://sub.domain.com/objects.json?api_key=123""; private const string DATA = @""{""""object"""":{""""name"""":""""Name""""}}""; static void Main(string[] args) { Class1.CreateObject(); } private static void CreateObject() { HttpWebRequest request = (HttpWebRequest)WebRequest.Create(URL); request.Method = ""POST""; request.ContentType = ""application/json""; request.ContentLength = DATA.Length; StreamWriter requestWriter = new StreamWriter(request.GetRequestStream(), System.Text.Encoding.ASCII); requestWriter.Write(DATA); requestWriter.Close(); try { WebResponse webResponse = request.GetResponse(); Stream webStream = webResponse.GetResponseStream(); StreamReader responseReader = new StreamReader(webStream); string response = responseReader.ReadToEnd(); Console.Out.WriteLine(response); responseReader.Close(); } catch (Exception e) { Console.Out.WriteLine(""-----------------""); Console.Out.WriteLine(e.Message); } } } The thread 'vshost.NotifyLoad' (0x1a20) has exited with code 0 (0x0).The thread '<No Name>' (0x1988) has exited with code 0 (0x0).The thread 'vshost.LoadReference' (0x1710) has exited with code 0 (0x0).'ConsoleApplication1.vshost.exe' (Managed (v4.0.30319)): Loaded 'c:\users\l. preston sego iii\documents\visual studio 11\Projects\ConsoleApplication1\ConsoleApplication1\bin\Debug\ConsoleApplication1.exe', Symbols loaded.'ConsoleApplication1.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Configuration\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Configuration.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.A first chance exception of type 'System.Net.WebException' occurred in System.dllThe thread 'vshost.RunParkingWindow' (0x184c) has exited with code 0 (0x0).The thread '<No Name>' (0x1810) has exited with code 0 (0x0).The program '[2780] ConsoleApplication1.vshost.exe: Program Trace' has exited with code 0 (0x0).The program '[2780] ConsoleApplication1.vshost.exe: Managed (v4.0.30319)' has exited with code 0 (0x0).",How do I make calls to a REST API using C#?
How do I make calls to a REST api using C#?," This is the code I have so far: The problem is that I think the exception block is being triggered (because when I remove the try-catch, I get a server error (500) message. But I don't see the Console.Out lines I put in the catch block.My Console: <code>  public class Class1 { private const string URL = ""https://sub.domain.com/objects.json?api_key=123""; private const string DATA = @""{""""object"""":{""""name"""":""""Name""""}}""; static void Main(string[] args) { Class1.CreateObject(); } private static void CreateObject() { HttpWebRequest request = (HttpWebRequest)WebRequest.Create(URL); request.Method = ""POST""; request.ContentType = ""application/json""; request.ContentLength = DATA.Length; StreamWriter requestWriter = new StreamWriter(request.GetRequestStream(), System.Text.Encoding.ASCII); requestWriter.Write(DATA); requestWriter.Close(); try { WebResponse webResponse = request.GetResponse(); Stream webStream = webResponse.GetResponseStream(); StreamReader responseReader = new StreamReader(webStream); string response = responseReader.ReadToEnd(); Console.Out.WriteLine(response); responseReader.Close(); } catch (Exception e) { Console.Out.WriteLine(""-----------------""); Console.Out.WriteLine(e.Message); } } } The thread 'vshost.NotifyLoad' (0x1a20) has exited with code 0 (0x0).The thread '<No Name>' (0x1988) has exited with code 0 (0x0).The thread 'vshost.LoadReference' (0x1710) has exited with code 0 (0x0).'ConsoleApplication1.vshost.exe' (Managed (v4.0.30319)): Loaded 'c:\users\l. preston sego iii\documents\visual studio 11\Projects\ConsoleApplication1\ConsoleApplication1\bin\Debug\ConsoleApplication1.exe', Symbols loaded.'ConsoleApplication1.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Configuration\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Configuration.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.A first chance exception of type 'System.Net.WebException' occurred in System.dllThe thread 'vshost.RunParkingWindow' (0x184c) has exited with code 0 (0x0).The thread '<No Name>' (0x1810) has exited with code 0 (0x0).The program '[2780] ConsoleApplication1.vshost.exe: Program Trace' has exited with code 0 (0x0).The program '[2780] ConsoleApplication1.vshost.exe: Managed (v4.0.30319)' has exited with code 0 (0x0).",How do I make calls to a REST API using C#?
Using return and yield return in the same method," Why can't we use both return and yield return in the same method?For example, we can have GetIntegers1 and GetIntegers2 below, but not GetIntegers3. <code>  public IEnumerable<int> GetIntegers1(){ return new[] { 4, 5, 6 };}public IEnumerable<int> GetIntegers2(){ yield return 1; yield return 2; yield return 3;}public IEnumerable<int> GetIntegers3(){ if ( someCondition ) { return new[] {4, 5, 6}; // compiler error } else { yield return 1; yield return 2; yield return 3; }}","Why can't ""return"" and ""yield return"" be used in the same method?"
Unity C# calculate correct forward after rotation," I'm starting my development using Unity.I'm doing something like that: So i rotate and i can move, but it moves just in the Z line, i know i'm calling the Z specific movement.But with Javascript i can do something So i don't need to do the new vector process and copy to a separate variable and it works like a charm, using the rotation and using as orientation to himself when it's rotated. <code>  if(Input.GetKey(KeyCode.A))newValues[1]-=this.turnSpeed*(float)Time.deltaTime; if(Input.GetKey(KeyCode.D))newValues[1]+=this.turnSpeed*(float)Time.deltaTime; transform.Rotate(0, newValues[1], 0); if(Input.GetKey(KeyCode.W))newValues[0]+=this.speed*transform.forward.z*(float)Time.deltaTime; if(Input.GetKey(KeyCode.S))newValues[0]-=this.speed*transform.forward.z*(float)Time.deltaTime; transform.position = new Vector3(transform.position.x, transform.position.y, (float)newValues[0]); transform.forward+=this.speed*transform.forward*(float)Time.deltaTime;",Unity3D C# calculate correct forward after rotation
WPF : Failed to create a 'Path' from the text '(RadButtonOnImage:RadButtonImage.Image)'," I create a attach property for my RadButton to set a image inside Button content But i get this exception in design time in Visual Studio 2010. In Blend 4 i does not show any error and at Run time it`s working fine. Attach Property : XAML : Exception Detail : Where i am doing wrong ?Thank `s for help.  <code>  namespace SmartSoft.GTS.RadButton{public class RadButtonImage{ public static readonly DependencyProperty ImagePropery; public static ImageSource GetImage(DependencyObject obj) { return (ImageSource)obj.GetValue(ImagePropery); } public static void SetImage(DependencyObject obj,ImageSource Value) { obj.SetValue(ImagePropery,Value); } static RadButtonImage() { ImagePropery = DependencyProperty.RegisterAttached(""Image"", typeof(ImageSource), typeof(RadButtonImage), new PropertyMetadata((ImageSource)null)); } }} xmlns:RadButtonOnImage=""clr-namespace:SmartSoft.GTS.RadButton"" <Style x:Key=""ImageOnRadButton"" TargetType=""{x:Type telerik:RadButton}""> <Setter Property=""FontSize"" Value=""13.333""/> <Setter Property=""ContentTemplate""> <Setter.Value> <DataTemplate> <StackPanel Orientation=""Horizontal""> <Image Margin=""5,0,5,0"" HorizontalAlignment=""Center"" VerticalAlignment=""Center"" Source=""{Binding (RadButtonOnImage:RadButtonImage.Image), RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type telerik:RadButton}}}""/> <TextBlock Text=""{TemplateBinding Content}"" TextAlignment=""Center"" HorizontalAlignment=""Center"" VerticalAlignment=""Center"" Margin=""0,0,5,0""/> </StackPanel> </DataTemplate> </Setter.Value> </Setter> </Style> <telerik:RadButton Content=""New"" RadButtonOnImage:RadButtonImage.Image=""Images/Buttons/Clear.png"" Style=""{DynamicResource ImageOnRadButton}""/> System.Reflection.TargetInvocationException Exception has been thrown by the target of an invocation. at System.RuntimeMethodHandle._InvokeMethodFast(IRuntimeMethodInfo method, Object target, Object[] arguments, SignatureStruct& sig, MethodAttributes methodAttributes, RuntimeType typeOwner) at System.RuntimeMethodHandle.InvokeMethodFast(IRuntimeMethodInfo method, Object target, Object[] arguments, Signature sig, MethodAttributes methodAttributes, RuntimeType typeOwner) at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture, Boolean skipVisibilityChecks) at System.Delegate.DynamicInvokeImpl(Object[] args) at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs) at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler) System.Windows.Markup.XamlParseException Failed to create a 'Path' from the text '(RadButtonOnImage:RadButtonImage.Image)'. at System.Windows.Markup.XamlReader.RewrapException(Exception e, Uri baseUri) at System.Windows.FrameworkTemplate.LoadTemplateXaml(XamlReader templateReader, XamlObjectWriter currentWriter) at System.Windows.FrameworkTemplate.LoadTemplateXaml(XamlObjectWriter objectWriter) at System.Windows.FrameworkTemplate.LoadOptimizedTemplateContent(DependencyObject container, IComponentConnector componentConnector, IStyleConnector styleConnector, List`1 affectedChildren, UncommonField`1 templatedNonFeChildrenField) at System.Windows.FrameworkTemplate.LoadContent(DependencyObject container, List`1 affectedChildren) at System.Windows.StyleHelper.ApplyTemplateContent(UncommonField`1 dataField, DependencyObject container, FrameworkElementFactory templateRoot, Int32 lastChildIndex, HybridDictionary childIndexFromChildID, FrameworkTemplate frameworkTemplate) at System.Windows.FrameworkTemplate.ApplyTemplateContent(UncommonField`1 templateDataField, FrameworkElement container) at System.Windows.FrameworkElement.ApplyTemplate() at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.Grid.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.Control.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.Grid.MeasureCell(Int32 cell, Boolean forceInfinityV) at System.Windows.Controls.Grid.MeasureCellsGroup(Int32 cellsHead, Size referenceSize, Boolean ignoreDesiredSizeU, Boolean forceInfinityV) at System.Windows.Controls.Grid.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.Grid.MeasureCell(Int32 cell, Boolean forceInfinityV) at System.Windows.Controls.Grid.MeasureCellsGroup(Int32 cellsHead, Size referenceSize, Boolean ignoreDesiredSizeU, Boolean forceInfinityV) at System.Windows.Controls.Grid.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at MS.Internal.Helper.MeasureElementWithSingleChild(UIElement element, Size constraint) at System.Windows.Controls.ContentPresenter.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.Grid.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.Border.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.Control.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Documents.AdornerDecorator.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.Grid.MeasureCell(Int32 cell, Boolean forceInfinityV) at System.Windows.Controls.Grid.MeasureCellsGroup(Int32 cellsHead, Size referenceSize, Boolean ignoreDesiredSizeU, Boolean forceInfinityV) at System.Windows.Controls.Grid.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.Border.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.Border.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.DockPanel.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.Border.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.Grid.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.Control.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.Border.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at MS.Internal.Designer.ZoomableViewPresenter.DesignerBackground.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.Decorator.MeasureOverride(Size constraint) at Microsoft.Windows.Design.Interaction.DesignerView.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at MS.Internal.Designer.Viewport.MeasureOverride(Size availableSize) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at MS.Internal.Helper.MeasureElementWithSingleChild(UIElement element, Size constraint) at System.Windows.Controls.ScrollContentPresenter.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.Grid.MeasureCell(Int32 cell, Boolean forceInfinityV) at System.Windows.Controls.Grid.MeasureCellsGroup(Int32 cellsHead, Size referenceSize, Boolean ignoreDesiredSizeU, Boolean forceInfinityV) at System.Windows.Controls.Grid.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.ScrollViewer.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.Grid.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at MS.Internal.Helper.MeasureElementWithSingleChild(UIElement element, Size constraint) at System.Windows.Controls.ContentPresenter.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Controls.Control.MeasureOverride(Size constraint) at System.Windows.FrameworkElement.MeasureCore(Size availableSize) at System.Windows.UIElement.Measure(Size availableSize) at System.Windows.Interop.HwndSource.SetLayoutSize() at System.Windows.Interop.HwndSource.set_RootVisualInternal(Visual value) at System.Windows.Interop.HwndSource.set_RootVisual(Visual value) at MS.Internal.DeferredHwndSource.ProcessQueue(Object sender, EventArgs e) System.Xaml.XamlParseException Prefix 'RadButtonOnImage' does not map to a namespace. at MS.Internal.Xaml.XamlContext.ResolveXamlType(String qName, Boolean skipVisibilityCheck) at MS.Internal.Xaml.Context.ObjectWriterContext.ServiceProvider_Resolve(String qName) at MS.Internal.Xaml.ServiceProviderContext.System.Windows.Markup.IXamlTypeResolver.Resolve(String qName) at System.Windows.PropertyPath.GetTypeFromName(String name, Object context) at System.Windows.PropertyPath.ResolvePropertyName(String name, Object item, Type ownerType, Object context, Boolean throwOnError) at System.Windows.PropertyPath.ResolvePathParts(ITypeDescriptorContext typeDescriptorContext) at System.Windows.PropertyPath.PrepareSourceValueInfo(ITypeDescriptorContext typeDescriptorContext) at System.Windows.PropertyPath..ctor(String path, ITypeDescriptorContext typeDescriptorContext) at System.Windows.PropertyPathConverter.ConvertFrom(ITypeDescriptorContext typeDescriptorContext, CultureInfo cultureInfo, Object source) at MS.Internal.Xaml.Runtime.ClrObjectRuntime.CreateObjectWithTypeConverter(ServiceProviderContext serviceContext, XamlValueConverter`1 ts, Object value) at MS.Internal.Xaml.Runtime.ClrObjectRuntime.CreateFromValue(ServiceProviderContext serviceContext, XamlValueConverter`1 ts, Object value, XamlMember property) at System.Xaml.XamlObjectWriter.Logic_CreateFromValue(ObjectWriterContext ctx, XamlValueConverter`1 typeConverter, Object value, XamlMember property, String targetName, IAddLineInfo lineInfo)",Failed to create a 'Path' from the text '(RadButtonOnImage:RadButtonImage.Image)'
Writing arbitray type instances into a MemoryStream in C#," In Delphi, one can do the following: This will write the memory contents of i into ms.The .Net version of MemoryStream doesn't have such a feature (neither the managed nor unmanaged versions). I know .Net doesn't work on the same principles as Delphi in this regard.How does one do this in C#? I am interested in the ""best practice"" and the fastest methods. <code>  var ms : TMemoryStream; i : Integer;begin ms := TMemoryStream.Create; i := 1024; ms.Write(@i, SizeOf(Integer)); ms.Free;end;",Writing arbitrary type instances into a MemoryStream in C#
C# Deserialize Xml with empty elements," Consider the following XML: I need to deserialize this xml to an object. So, i wrote the following class. Since i'm using nullables, i was expecting that, when deserialing the above xml, i would get an object A with a null C property.Instead of this, i get an exception telling the document has an error. <code>  <a> <b>2</b> <c></c></a> public class A{ [XmlElement(""b"", Namespace = """")] public int? B { get; set; } [XmlElement(""c"", Namespace = """")] public int? C { get; set; }}",Deserialize Xml with empty elements
Run an exe from c sharp code, I have an EXE file reference in my C# project. How do I invoke that EXE file from my code? <code> ,How can I run an EXE file from my C# code?
Run an exe from C# code, I have an EXE file reference in my C# project. How do I invoke that EXE file from my code? <code> ,How can I run an EXE file from my C# code?
WCF netTCP binding Soap Security Negotiation Failed," I am writing a WCF service requires impersonate and session.It is ok when I tried to call it on my local machine, but on the remote machine it always failed with such error: Security Support Provider Interface (SSPI) authentication failed. The server may not be running in an account with identity 'host/hostname'. If the server is running in a service account (Network Service for example), specify the account's ServicePrincipalName as the identity in the EndpointAddress for the server. If the server is running in a user account, specify the account's UserPrincipalName as the identity in the EndpointAddress for the server.If I provided a upn, it throws an identity failed exception.Here is my config:Server Config(APP): Client Config: Any help would be greatly appreciated. <code>  <system.serviceModel> <behaviors> <serviceBehaviors> <behavior name=""default""> <serviceMetadata httpGetEnabled=""true"" /> <serviceDebug includeExceptionDetailInFaults=""true"" /> <serviceAuthorization impersonateCallerForAllOperations=""true"" /> </behavior> </serviceBehaviors> </behaviors> <bindings> <netTcpBinding> <binding name=""DataService.netTcpBinding""> <readerQuotas maxArrayLength=""65535"" maxBytesPerRead=""2147483647"" maxStringContentLength=""2147483647""/> <reliableSession enabled=""true"" inactivityTimeout=""24:00:00"" ordered=""true""/> <security mode=""TransportWithMessageCredential""> <message clientCredentialType=""Windows"" /> <transport clientCredentialType=""Windows""/> </security> </binding> </netTcpBinding> </bindings> <serviceHostingEnvironment aspNetCompatibilityEnabled=""true"" multipleSiteBindingsEnabled=""true""/> <services> <service behaviorConfiguration=""default"" name=""DataService.DataService""> <endpoint address="""" binding=""netTcpBinding"" bindingConfiguration=""DataService.netTcpBinding"" name=""DataService.DataService"" contract=""DataService.IDataService""/> <endpoint address=""mex"" binding=""mexTcpBinding"" contract=""IMetadataExchange"" /> <host> <baseAddresses> <add baseAddress=""http://address:4504/""/> <add baseAddress=""net.tcp://address:4503/""/> </baseAddresses> </host> </service> </services></system.serviceModel> <?xml version=""1.0"" encoding=""utf-8"" ?><configuration> <system.serviceModel> <bindings> <netTcpBinding> <binding name=""DataService.DataService"" closeTimeout=""00:01:00"" openTimeout=""00:01:00"" receiveTimeout=""00:10:00"" sendTimeout=""00:01:00"" transactionFlow=""false"" transferMode=""Buffered"" transactionProtocol=""OleTransactions"" hostNameComparisonMode=""StrongWildcard"" listenBacklog=""10"" maxBufferPoolSize=""524288"" maxBufferSize=""65536"" maxConnections=""10"" maxReceivedMessageSize=""65536""> <readerQuotas maxDepth=""32"" maxStringContentLength=""8192"" maxArrayLength=""16384"" maxBytesPerRead=""4096"" maxNameTableCharCount=""16384"" /> <reliableSession ordered=""true"" inactivityTimeout=""24.00:00:00"" enabled=""true"" /> <security mode=""TransportWithMessageCredential""> <transport clientCredentialType=""Windows"" protectionLevel=""EncryptAndSign"" /> <message clientCredentialType=""Windows"" algorithmSuite=""Default"" /> </security> </binding> </netTcpBinding> </bindings> <client> <endpoint address=""net.tcp://address:4503/"" binding=""netTcpBinding"" bindingConfiguration=""DataService.DataService"" contract=""ataService.IDataService"" name=""DataService.DataService""> <identity> <dns value=""DOMAIN""/> </identity> </endpoint> </client> </system.serviceModel></configuration>",netTCP binding Soap Security Negotiation Failed
Why IEnumerable<struct> cannot be casted as IEnumerable<object>?," Why is the last line not allowed? Is this because double is a value type that doesn't derive from object, hence the covariance doesn't work?Does that mean that there is no way to make this work: And that I need to write my very own IMyInterface<T>.Cast<U>() to do that? <code>  IEnumerable<double> doubleenumerable = new List<double> { 1, 2 };IEnumerable<string> stringenumerable = new List<string> { ""a"", ""b"" };IEnumerable<object> objects1 = stringenumerable; // OKIEnumerable<object> objects2 = doubleenumerable; // Not allowed public interface IMyInterface<out T>{ string Method(); }public class MyClass<U> : IMyInterface<U>{ public string Method() { return ""test""; }}public class Test{ public static object test2() { IMyInterface<double> a = new MyClass<double>(); IMyInterface<object> b = a; // Invalid cast! return b.Method(); }}",Why cannot IEnumerable<struct> be cast as IEnumerable<object>?
After postback my javascript functions doesnt work in asp.net," I have common functions and I collapse it on CommonFunctions.js in Scripts folder.I include it on my master page and use it on my pages. When I do any post back on a page, my function doesn't work.My CommonFunctions.js: <code>  $(function () { gf(); if (Sys.WebForms.PageRequestManager.getInstance().get_isInAsyncPostBack()) { gf(); } function gf(){ $('.AddNewGeneralPanel').click(function () { if ($(this).find('.AddNewGeneralPanelStyle').text() == """") { $(this).find('.AddNewGeneralPanelStyle').text(""( Gizle )""); lastOpenId = $(this).attr(""codeid""); } else $(this).find('.AddNewGeneralPanelStyle').text(""""); $(this).next('.AddNewGeneralAccordionDiv').slideToggle('slow', function () { }); }); }});",After postback my JavaScript function doesn't work in ASP.NET
Disable all controls within div in asp.net vb," Can someone tell me how I can disable all controls within a div?The div is set to runat=""server""Many thanks for your help. <code> ",Disable all controls within div in asp.net 
How do I iterate an Igrouping<T> Interface?, Ive got ths really annoying issue I have grouped a set of data and I cant get to the data within the group. I can get to the key bit not the data..I have a load of data that is in the form I perform a GroupBy This brings back (according to linq) my hierarchical data which is starting to look how I want it. Id like to iterate through the contents but cant...How do I do this? and how do I...Work how to get to the Data.Adjustment without using a projection. And I dont want to project yet because I have to perform another grouping....help! :-) <code>  Data.Period = xData.Adjustment = y var groupedData = Data.GroupBy(x => x.Period new {x.Period});,How do I iterate an IGrouping<T> Interface?
How use automaticly EF for creating database and repositories in ASP.NET MVC?," I have started to learn ASP.NET MVC, and at this time of studying I wanna create simple blog site. I have decided to use ASP.NET MVC and ORM Entity Framework. Probably you have some useful links about this theme?I tried to start from creating Model code first.i have 3 classes Post, User(User can be admin), Comments.Please I need help to make the relations between the database models. I have code like this right now: These are my classes to create database tables, but I'm not sure how make relations like many-to-one.Is it correct to make List of Comments for Post or just write int CommentID?? I have never use database very deep, just saw a few lessons. Can somebody to advise how make repository or correct my Model code?Thank you very much! <code>  public class Post{ public int PostId { get; set; } public string Title { get; set; } public string Content { get; set; } public List<Comment> Comments { get; set; } public DateTime PublishDate { get; set; }}public class User{ public readonly bool IsAdmin { get; set; } public string FirstName { get; set; } public string SecondName { get; set; } public string Email { get; set; } public string Password { get; set; } public DateTime DateOfBirthday { get; set; } public string Country { get; set; } public string City { get; set; } public List<Post> Posts { get; set; } public List<Comment> Comments { get; set; }}public class Comment{ public int CommentId { get; set; } public string UserName { get; set; } public string Content { get; set; } public DateTime PublishDate { get; set; }}",How do I use EF to automatically create a database and repository in ASP.NET MVC?
Get value fron anonymous object," I have a method as following: And I call it like this: So how can I implement MyMethod() to get myparam value?EditI use this: but the error rise : also I use breakpoint and I see the d have myparam string property.And is there any way to check dynamic type to if contain any property like this: Edit IIThis is my main code: and call it as: And Error is: Edit IIIThis is my AssemblyInfo of HtmlHelper definition: but there is an error yet: 'object' does not contain a definition for 'area'I use different assemblies but how can it possible, when I use breakpoint I can see that my dynamic areaobject have area name property and also I can see the value of that, but the error say: 'object' does not contain a definition for 'area' I can't figure it how it can be possible?EditI change the assembly and now dynamic type is internal but the error remains as before <code>  public void MyMethod(object obj){ // implement} MyMethod(new { myparam= ""waoww""}); dynamic d= obj; string param = d.myparam; 'object' does not contain a definition for 'myparam' if(d.contain(myparam))? public static MvcHtmlString SecureActionLink(this HtmlHelper htmlHelper, string linkText, string actionName, string controllerName, object routeValues, object htmlAttributes) { string areaName = (string)htmlHelper.ViewContext.RouteData.DataTokens[""area""]; dynamic areaObject = routeValues; if(areaObject != null && !string.IsNullOrEmpty(areaObject.area)) areaName = areaObject.area;// more} <p>@Html.SecureActionLink(""Secure Link between Areas"", ""Index"", ""Context"", new { area = ""Settings"" }, null)</p> Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: 'object' does not contain a definition for 'area' Line 303: dynamic areaObject = routeValues; Line 304: Line 305: if(areaObject != null && !string.IsNullOrEmpty(areaObject.area)) Line 306: areaName = areaObject.area; Line 307: Source File: D:\Projects\MyProject\HtmlHelpers\LinkExtensions.cs Line: 305 [assembly: AssemblyTitle(""MyProject.Presentation"")][assembly: InternalsVisibleTo(""cpanel.MyProject.dev"")]",Get value from anonymous type
C# - Split a byte array at a delimiter," I'm having a bit of an issue and, the other questions here didn't help me much.I am a security student and I am trying to write a crypter for a project. For those who don't know what it is you can read up on here.http://www.gamekiller.net/tutorials-guides/17187-tut-making-crypter-vb6-using-rc4.htmlAnyways, a quick explanation, crypters are programs meant to bypass antiviruses by encrypting a program and then affixing a ""stub"" which is a program that decrypts it, on the front. I'm having a very annoying issue with splitting my file up. The big annoyance is that I have to put the crypted executable into a byte array, since strings kill certain characters in my crypted executable, making it unexecutable. To make matters worse I still have to ""split"" the exe and, this is where the trouble begins.The basic idea of the stub is to:Get the current exe pathRead all the bytes through File.ReadAllytesSplit the file at the delimiter, ""EVILDELIMITER""Get the last field (Since thats the crypted EXE)Decrypt it using RC4Run using RunPE.I have everything working except the splitting part which, is the most annoying. How do I split a byte array at the delimiter? Is there an easier way to do this?Here's the code for the stub I have so far. Thanks for any help. <code>  public void main(){ string outpath = RandomString(8) + "".exe""; byte[] key = { 33, 44, 55, 66, 77 }; string apppath = Assembly.GetEntryAssembly(); byte[] exe = File.ReadAllBytes(apppath); string strseperate = ""EVILSEPERATOREVIL""; System.Text.UTF8Encoding encoding = new System.Text.UTF8Encoding(); byte[] seperator = encoding.GetBytes(strseperate); //Split code should go here exe = Decrypt(key, encrypted); Process.Start(outpath);}",Split a byte array at a delimiter
Get type usingreflection," I am trying get type of property of my class by using of reflection but its returning my only RuntimePropertyInfo - as a name of a type.I have object MyObject actualData - it contains property - ""name"" as string and ""Item"" as my type DatumTypeWhen I am debugging I can see, that actualData has 2 properties, first one is type of string and second one is DatumType, but when I use this:string typeName = actualData.getType().getProperty(""Item"").getType().Name - it returns me RuntimePropertyInfo, not DatumTypeCan you see what am I doing wrong? I am using C# - .Net 4.0.Thanks a lot!  <code> ",Get type using reflection
Nhibernate mapping hasMany," In my MSSQL I have two tables, Property and Photo.To make it shorter I will write here just few fields.Property table Photo table Relationship is as follows:FK_Property_Photo As you can imagine one property can have one or many images. One image can belong to one or meny properties. I Tried with this kind of mapping <code>  Id int not nullTitle nvarchar(255) not nullPhotoId int not null Id int not nullImageData varbinary(MAX) nullImageMimeType varchar(50) null Primary Key table Foreign key table--------------------------------------------Photo Property--------------------------------------------Id PhotoId public PropertyMap(){ Table(""Property""); Id(x => x.Id).GeneratedBy.Identity(); Map(x => x.Title).Length(255).Not.Nullable(); HasMany(x => x.Photos).KeyColumn(""Id"");}public PhotoMap() { Table(""Photo""); Id(x => x.Id).GeneratedBy.Identity(); Map(x => x.Version); Map(x => x.ImageData).CustomSqlType(""VARBINARY(MAX)"").Length(160000); Map(x => x.ImageMimeType); }",Fluent Nhibernate mapping hasMany
How to set IIS website's default encoding??," My website is a combination of classic ASP and ASP.NETMy pages' default encoding is currently ISO-8859-1.Even if there's no <meta> tag, the response page will be encoded ISO-8859-1. How to change it to UTF-8? <code> ",How to set IIS website's default encoding?
Showing image in a DataGridViewImageColumn binding text field, I'm working on a WindowsForm project and in my form I have a DataGridView with a DataGridViewImageColumn which must show the status of the row (enabled/disabled) using an image.I have a DataTable that I bind to my datagrid. In this table there is a column that is the status of each row and is a text field.How can I bind this column to the DataGridViewImageColumn showing the right image?  <code> ,Showing image in a DataGridViewImageColumn binding text-field
MVC3 en-GB dates in Get," I'm having a nightmare of a time with Dates. Were based in the UK, so our date format is dd/MM/yyyy. This is what users will type into the form when they want a certain date. I have a form that accepts just such a property. It's obviously a DateTime type. I want to send this form to the controller in a GET, so the user has a nice URL they can save pass on, etc. The view also needs to bind a JQuery UI datepicker to this element also. I also need the form element to have a certain id and class so I really need to render this to the form thus: I've specified a UK culture variant in the web.config: It appears though, as explained here (http://weblogs.asp.net/melvynharbour/archive/2008/11/21/mvc-modelbinder-and-localization.aspx) that when GETing a controller actuion that MVC ignores the culture variant and defaults to US (obviously no one exists outside of the US so this is fine for Microsoft, rant over) The attached doesn't help because it means I would have to set this up for every date in every model!This means that if a user types 01/05/2012 I end up with 05/01/2012 which is wrong!I've looked at various solutions to this issue but none really fit what I need. I need a way so that All dates sent via a GET are in UK format. We are solely based in the UK so no none UK formats will be entered.I don't really want to create and editor unless their is a way that I can do this without a View/Viewmodel attached to this Editor as it will be come unwieldly to use this everywhere we have a date picker.All help will be gratefully recieved! <code>  @Html.TextBoxFor(model => model.ReturnDate, new { Class = ""date"", id = ""ReturnDate"" }) <globalization uiCulture=""en"" culture=""en-GB""/>",Binding en-GB dates in a HTTP GET
Binding en-GB dates in Get," I'm having a nightmare of a time with Dates. Were based in the UK, so our date format is dd/MM/yyyy. This is what users will type into the form when they want a certain date. I have a form that accepts just such a property. It's obviously a DateTime type. I want to send this form to the controller in a GET, so the user has a nice URL they can save pass on, etc. The view also needs to bind a JQuery UI datepicker to this element also. I also need the form element to have a certain id and class so I really need to render this to the form thus: I've specified a UK culture variant in the web.config: It appears though, as explained here (http://weblogs.asp.net/melvynharbour/archive/2008/11/21/mvc-modelbinder-and-localization.aspx) that when GETing a controller actuion that MVC ignores the culture variant and defaults to US (obviously no one exists outside of the US so this is fine for Microsoft, rant over) The attached doesn't help because it means I would have to set this up for every date in every model!This means that if a user types 01/05/2012 I end up with 05/01/2012 which is wrong!I've looked at various solutions to this issue but none really fit what I need. I need a way so that All dates sent via a GET are in UK format. We are solely based in the UK so no none UK formats will be entered.I don't really want to create and editor unless their is a way that I can do this without a View/Viewmodel attached to this Editor as it will be come unwieldly to use this everywhere we have a date picker.All help will be gratefully recieved! <code>  @Html.TextBoxFor(model => model.ReturnDate, new { Class = ""date"", id = ""ReturnDate"" }) <globalization uiCulture=""en"" culture=""en-GB""/>",Binding en-GB dates in a HTTP GET
How to pass my multpile values through command argument c#?," I have ImageButton with CommandArgument attribute which is having multiple Eval value. When I click one of them I want to pass values to ImageButton2_Click event but it does not work because Command arguments is null. This is the code-behind: <code>  <div class=""sag-re-icerik"" id=""icerik2"" runat=""server"">Lorem ipsum dolor sit amet, consectetur commodo et convallis et, auctor viverra metus. Aenean pharetra, arcu nec viverra mollis, turpis neque feugiat massa, non dapibus neque nunc ac orci. </div> <div class=""oy-verme""> <div class=""yildiz""><asp:ImageButton ID=""ImageButton4"" runat=""server"" Height=""19px"" ImageUrl=""~/images/yildiz.png"" onclick=""ImageButton2_Click"" Width=""20px"" style=""position: relative; top: 13px; left:6px; float:left; "" commandArgument='<%#Eval(""sdasdas"") + "",""+Eval(""fafasfa"") %>' /></div> <div class=""yildiz""><asp:ImageButton ID=""ImageButton5"" runat=""server"" Height=""19px"" ImageUrl=""~/images/yildiz.png"" onclick=""ImageButton5_Click"" Width=""20px"" style=""position: relative; top: 13px; left:8px; float:left;"" commandArgument='<%#Eval(""row[0].ToString()"") + "",""+Eval(""row[1].ToString()"") %>'/></div> <div class=""yildiz""><asp:ImageButton ID=""ImageButton6"" runat=""server"" Height=""19px"" ImageUrl=""~/images/yildiz.png"" onclick=""ImageButton2_Click"" Width=""20px"" style=""position: relative; top: 13px; left:10px ; float:left; "" commandArgument='<%#Eval(""row[0].ToString()"") + "",""+Eval(""row[1].ToString()"") %>' /></div> <div class=""yildiz""><asp:ImageButton ID=""ImageButton3"" runat=""server"" Height=""19px"" ImageUrl=""~/images/yildiz.png"" onclick=""ImageButton2_Click"" Width=""20px"" style=""position: relative; top:13px; left:12px ; float:left;"" commandArgument='<%#Eval(""row[0].ToString()"") + "",""+Eval(""row[1].ToString()"") %>' /></div> <div class=""yildiz""> <asp:ImageButton ID=""ImageButton2"" runat=""server"" Height=""19px"" ImageUrl=""~/images/yildiz.png"" onclick=""ImageButton2_Click"" Width=""20px"" style=""position: relative; top: 13px; left: 14px; float:left;"" commandArgument='<%#Eval(""row[0].ToString()"") + "",""+Eval(""row[1].ToString()"") %>' /></div> <div class=""oy-sil""><img src=""images/oy-sil.png"" width=""11"" height=""13"" style=""position: relative; top: 30px; "" /></div> </div></div> protected void ImageButton2_Click(object sender, ImageClickEventArgs e){ ImageButton objImage = (ImageButton)sender; string[] commandArgs = objImage.CommandArgument.ToString().Split(new char[] { ',' }); string id = commandArgs[0]; string text = commandArgs[1]; // string s= Imageid.UniqueID.ToString(); //this.baslik2.Text = s;}",How to pass multiple values through command argument in Asp.net?
How to pass my multiple values through command argument c#?," I have ImageButton with CommandArgument attribute which is having multiple Eval value. When I click one of them I want to pass values to ImageButton2_Click event but it does not work because Command arguments is null. This is the code-behind: <code>  <div class=""sag-re-icerik"" id=""icerik2"" runat=""server"">Lorem ipsum dolor sit amet, consectetur commodo et convallis et, auctor viverra metus. Aenean pharetra, arcu nec viverra mollis, turpis neque feugiat massa, non dapibus neque nunc ac orci. </div> <div class=""oy-verme""> <div class=""yildiz""><asp:ImageButton ID=""ImageButton4"" runat=""server"" Height=""19px"" ImageUrl=""~/images/yildiz.png"" onclick=""ImageButton2_Click"" Width=""20px"" style=""position: relative; top: 13px; left:6px; float:left; "" commandArgument='<%#Eval(""sdasdas"") + "",""+Eval(""fafasfa"") %>' /></div> <div class=""yildiz""><asp:ImageButton ID=""ImageButton5"" runat=""server"" Height=""19px"" ImageUrl=""~/images/yildiz.png"" onclick=""ImageButton5_Click"" Width=""20px"" style=""position: relative; top: 13px; left:8px; float:left;"" commandArgument='<%#Eval(""row[0].ToString()"") + "",""+Eval(""row[1].ToString()"") %>'/></div> <div class=""yildiz""><asp:ImageButton ID=""ImageButton6"" runat=""server"" Height=""19px"" ImageUrl=""~/images/yildiz.png"" onclick=""ImageButton2_Click"" Width=""20px"" style=""position: relative; top: 13px; left:10px ; float:left; "" commandArgument='<%#Eval(""row[0].ToString()"") + "",""+Eval(""row[1].ToString()"") %>' /></div> <div class=""yildiz""><asp:ImageButton ID=""ImageButton3"" runat=""server"" Height=""19px"" ImageUrl=""~/images/yildiz.png"" onclick=""ImageButton2_Click"" Width=""20px"" style=""position: relative; top:13px; left:12px ; float:left;"" commandArgument='<%#Eval(""row[0].ToString()"") + "",""+Eval(""row[1].ToString()"") %>' /></div> <div class=""yildiz""> <asp:ImageButton ID=""ImageButton2"" runat=""server"" Height=""19px"" ImageUrl=""~/images/yildiz.png"" onclick=""ImageButton2_Click"" Width=""20px"" style=""position: relative; top: 13px; left: 14px; float:left;"" commandArgument='<%#Eval(""row[0].ToString()"") + "",""+Eval(""row[1].ToString()"") %>' /></div> <div class=""oy-sil""><img src=""images/oy-sil.png"" width=""11"" height=""13"" style=""position: relative; top: 30px; "" /></div> </div></div> protected void ImageButton2_Click(object sender, ImageClickEventArgs e){ ImageButton objImage = (ImageButton)sender; string[] commandArgs = objImage.CommandArgument.ToString().Split(new char[] { ',' }); string id = commandArgs[0]; string text = commandArgs[1]; // string s= Imageid.UniqueID.ToString(); //this.baslik2.Text = s;}",How to pass multiple values through command argument in Asp.net?
WCF Service application to restful," Hey im not getting anywhere with turning wcf into a restful service. So I was wondering if some one can take the basic code when you start a WCF Service application here: And the Service: All I have did is started this WCF service app and opened another VS2010 soultion with a basic form that has a textbox button and label and copyed the service location of the serviceapp in the other solution so when I type a number I get a response from the service. Really quick and dirty but serves its purpose.Now if any one can help with code how do you turn it into a restful service? End part of my config file: EDIT update with Justins config code:So when ever I touch the config file my usual error is this: Failed to add a service. Service metadata may not be accessible. Make sure your service is running and exposing metadata <code>  using System;using System.Collections.Generic;using System.Linq;using System.Runtime.Serialization;using System.ServiceModel;using System.ServiceModel.Web;using System.Text;namespace WcfService1{ // NOTE: You can use the ""Rename"" command on the ""Refactor"" menu to change the interface name ""IService1"" in both code and config file together. [ServiceContract] public interface IService1 { [OperationContract] string GetData(int value); [OperationContract] CompositeType GetDataUsingDataContract(CompositeType composite); // TODO: Add your service operations here } // Use a data contract as illustrated in the sample below to add composite types to service operations. [DataContract] public class CompositeType { bool boolValue = true; string stringValue = ""Hello ""; [DataMember] public bool BoolValue { get { return boolValue; } set { boolValue = value; } } [DataMember] public string StringValue { get { return stringValue; } set { stringValue = value; } } }} namespace WcfService1{ // NOTE: You can use the ""Rename"" command on the ""Refactor"" menu to change the class name ""Service1"" in code, svc and config file together. public class Service1 : IService1 { public string GetData(int value) { return string.Format(""You entered: {0}"", value); } public CompositeType GetDataUsingDataContract(CompositeType composite) { if (composite == null) { throw new ArgumentNullException(""composite""); } if (composite.BoolValue) { composite.StringValue += ""Suffix""; } return composite; } }} namespace WindowsFormsApplication1{ public partial class Form1 : Form { public Form1() { InitializeComponent(); } private void Form1_Load(object sender, EventArgs e) { } public ServiceReference1.Service1Client testClient = new ServiceReference1.Service1Client(); private void button1_Click(object sender, EventArgs e) { label1.Text = testClient.GetData(Convert.ToInt32(textBox1.Text)); } }} <system.serviceModel> <services> <service name=""WcfService1.Service1"" behaviorConfiguration=""WcfService1.Service1Behavior""> <!-- Service Endpoints --> <endpoint address="""" binding=""wsHttpBinding"" contract=""WcfService1.IService1""> <!-- Upon deployment, the following identity element should be removed or replaced to reflect the identity under which the deployed service runs. If removed, WCF will infer an appropriate identity automatically. --> <identity> <dns value=""localhost""/> </identity> </endpoint> <endpoint address=""mex"" binding=""mexHttpBinding"" contract=""IMetadataExchange""/> </service> </services> <behaviors> <serviceBehaviors> <behavior name=""WcfService1.Service1Behavior""> <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment --> <serviceMetadata httpGetEnabled=""true""/> <!-- To receive exception details in faults for debugging purposes, set the value below to true. Set to false before deployment to avoid disclosing exception information --> <serviceDebug includeExceptionDetailInFaults=""false""/> </behavior> </serviceBehaviors> </behaviors> </system.serviceModel></configuration> Error: Cannot obtain Metadata from http://localhost:26535/Service1.svc If this is a Windows (R) Communication Foundation service to which you have access, please check that you have enabled metadata publishing at the specified address. For help enabling metadata publishing, please refer to the MSDN documentation at http://go.microsoft.com/fwlink/?LinkId=65455.WS-Metadata Exchange Error URI: http://localhost:26535/Service1.svc Metadata contains a reference that cannot be resolved: 'http://localhost:26535/Service1.svc'. The server did not provide a meaningful reply; this might be caused by a contract mismatch, a premature session shutdown or an internal server error.HTTP GET Error URI: http://localhost:26535/Service1.svc There was an error downloading 'http://localhost:26535/Service1.svc'. The request failed with the error message:--<html> <head> <title>Operation 'GetData' in contract 'IService1' has a path variable named 'value' which does not have type 'string'. Variables for UriTemplate path segments must have type 'string'.</title> <style> body {font-family:""Verdana"";font-weight:normal;font-size: .7em;color:black;} p {font-family:""Verdana"";font-weight:normal;color:black;margin-top: -5px} b {font-family:""Verdana"";font-weight:bold;color:black;margin-top: -5px} H1 { font-family:""Verdana"";font-weight:normal;font-size:18pt;color:red } H2 { font-family:""Verdana"";font-weight:normal;font-size:14pt;color:maroon } pre {font-family:""Lucida Console"";font-size: .9em} .marker {font-weight: bold; color: black;text-decoration: none;} .version {color: gray;} .error {margin-bottom: 10px;} .expandable { text-decoration:underline; font-weight:bold; color:navy; cursor:hand; } </style> </head> <body bgcolor=""white""> <span><H1>Server Error in '/' Application.<hr width=100% size=1 color=silver></H1> <h2> <i>Operation 'GetData' in contract 'IService1' has a path variable named 'value' which does not have type 'string'. Variables for UriTemplate path segments must have type 'string'.</i> </h2></span> <font face=""Arial, Helvetica, Geneva, SunSans-Regular, sans-serif ""> <b> Description: </b>An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. <br><br> <b> Exception Details: </b>System.InvalidOperationException: Operation 'GetData' in contract 'IService1' has a path variable named 'value' which does not have type 'string'. Variables for UriTemplate path segments must have type 'string'.<br><br> <b>Source Error:</b> <br><br> <table width=100% bgcolor=""#ffffcc""> <tr> <td> <code>An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.</code> </td> </tr> </table> <br> <b>Stack Trace:</b> <br><br> <table width=100% bgcolor=""#ffffcc""> <tr> <td> <code><pre>[InvalidOperationException: Operation 'GetData' in contract 'IService1' has a path variable named 'value' which does not have type 'string'. Variables for UriTemplate path segments must have type 'string'.] System.ServiceModel.Dispatcher.UriTemplateClientFormatter.Populate(Dictionary`2& pathMapping, Dictionary`2& queryMapping, Int32& totalNumUTVars, UriTemplate& uriTemplate, OperationDescription operationDescription, QueryStringConverter qsc, String contractName) +726 System.ServiceModel.Dispatcher.UriTemplateDispatchFormatter..ctor(OperationDescription operationDescription, IDispatchMessageFormatter inner, QueryStringConverter qsc, String contractName, Uri baseAddress) +94 System.ServiceModel.Description.WebHttpBehavior.GetRequestDispatchFormatter(OperationDescription operationDescription, ServiceEndpoint endpoint) +137 System.ServiceModel.Description.WebHttpBehavior.ApplyDispatchBehavior(ServiceEndpoint endpoint, EndpointDispatcher endpointDispatcher) +659 System.ServiceModel.Description.DispatcherBuilder.InitializeServiceHost(ServiceDescription description, ServiceHostBase serviceHost) +3864 System.ServiceModel.ServiceHostBase.InitializeRuntime() +37 System.ServiceModel.ServiceHostBase.OnBeginOpen() +27 System.ServiceModel.ServiceHostBase.OnOpen(TimeSpan timeout) +49 System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout) +261 System.ServiceModel.HostingManager.ActivateService(String normalizedVirtualPath) +121 System.ServiceModel.HostingManager.EnsureServiceAvailable(String normalizedVirtualPath) +479[ServiceActivationException: The service '/Service1.svc' cannot be activated due to an exception during compilation. The exception message is: Operation 'GetData' in contract 'IService1' has a path variable named 'value' which does not have type 'string'. Variables for UriTemplate path segments must have type 'string'..] System.ServiceModel.AsyncResult.End(IAsyncResult result) +11655726 System.ServiceModel.Activation.HostedHttpRequestAsyncResult.End(IAsyncResult result) +194 System.ServiceModel.Activation.HostedHttpRequestAsyncResult.ExecuteSynchronous(HttpApplication context, Boolean flowContext) +176 System.ServiceModel.Activation.HttpModule.ProcessRequest(Object sender, EventArgs e) +275 System.Web.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +68 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +75</pre></code> </td> </tr> </table> <br> <hr width=100% size=1 color=silver> <b>Version Information:</b>Microsoft .NET Framework Version:2.0.50727.5448; ASP.NET Version:2.0.50727.5456 </font> </body></html><!-- [InvalidOperationException]: Operation 'GetData' in contract 'IService1' has a path variable named 'value' which does not have type 'string'. Variables for UriTemplate path segments must have type 'string'. at System.ServiceModel.Dispatcher.UriTemplateClientFormatter.Populate(Dictionary`2& pathMapping, Dictionary`2& queryMapping, Int32& totalNumUTVars, UriTemplate& uriTemplate, OperationDescription operationDescription, QueryStringConverter qsc, String contractName) at System.ServiceModel.Dispatcher.UriTemplateDispatchFormatter..ctor(OperationDescription operationDescription, IDispatchMessageFormatter inner, QueryStringConverter qsc, String contractName, Uri baseAddress) at System.ServiceModel.Description.WebHttpBehavior.GetRequestDispatchFormatter(OperationDescription operationDescription, ServiceEndpoint endpoint) at System.ServiceModel.Description.WebHttpBehavior.ApplyDispatchBehavior(ServiceEndpoint endpoint, EndpointDispatcher endpointDispatcher) at System.ServiceModel.Description.DispatcherBuilder.InitializeServiceHost(ServiceDescription description, ServiceHostBase serviceHost) at System.ServiceModel.ServiceHostBase.InitializeRuntime() at System.ServiceModel.ServiceHostBase.OnBeginOpen() at System.ServiceModel.ServiceHostBase.OnOpen(TimeSpan timeout) at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout) at System.ServiceModel.ServiceHostingEnvironment.HostingManager.ActivateService(String normalizedVirtualPath) at System.ServiceModel.ServiceHostingEnvironment.HostingManager.EnsureServiceAvailable(String normalizedVirtualPath)[ServiceActivationException]: The service '/Service1.svc' cannot be activated due to an exception during compilation. The exception message is: Operation 'GetData' in contract 'IService1' has a path variable named 'value' which does not have type 'string'. Variables for UriTemplate path segments must have type 'string'.. at System.ServiceModel.AsyncResult.End[TAsyncResult](IAsyncResult result) at System.ServiceModel.Activation.HostedHttpRequestAsyncResult.End(IAsyncResult result) at System.ServiceModel.Activation.HostedHttpRequestAsyncResult.ExecuteSynchronous(HttpApplication context, Boolean flowContext) at System.ServiceModel.Activation.HttpModule.ProcessRequest(Object sender, EventArgs e) at System.Web.HttpApplication.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)-->--.","convert a WCF Service, to a RESTful application?"
"How do I convert a WCF Service, to a RESTful application?"," Hey im not getting anywhere with turning wcf into a restful service. So I was wondering if some one can take the basic code when you start a WCF Service application here: And the Service: All I have did is started this WCF service app and opened another VS2010 soultion with a basic form that has a textbox button and label and copyed the service location of the serviceapp in the other solution so when I type a number I get a response from the service. Really quick and dirty but serves its purpose.Now if any one can help with code how do you turn it into a restful service? End part of my config file: EDIT update with Justins config code:So when ever I touch the config file my usual error is this: Failed to add a service. Service metadata may not be accessible. Make sure your service is running and exposing metadata <code>  using System;using System.Collections.Generic;using System.Linq;using System.Runtime.Serialization;using System.ServiceModel;using System.ServiceModel.Web;using System.Text;namespace WcfService1{ // NOTE: You can use the ""Rename"" command on the ""Refactor"" menu to change the interface name ""IService1"" in both code and config file together. [ServiceContract] public interface IService1 { [OperationContract] string GetData(int value); [OperationContract] CompositeType GetDataUsingDataContract(CompositeType composite); // TODO: Add your service operations here } // Use a data contract as illustrated in the sample below to add composite types to service operations. [DataContract] public class CompositeType { bool boolValue = true; string stringValue = ""Hello ""; [DataMember] public bool BoolValue { get { return boolValue; } set { boolValue = value; } } [DataMember] public string StringValue { get { return stringValue; } set { stringValue = value; } } }} namespace WcfService1{ // NOTE: You can use the ""Rename"" command on the ""Refactor"" menu to change the class name ""Service1"" in code, svc and config file together. public class Service1 : IService1 { public string GetData(int value) { return string.Format(""You entered: {0}"", value); } public CompositeType GetDataUsingDataContract(CompositeType composite) { if (composite == null) { throw new ArgumentNullException(""composite""); } if (composite.BoolValue) { composite.StringValue += ""Suffix""; } return composite; } }} namespace WindowsFormsApplication1{ public partial class Form1 : Form { public Form1() { InitializeComponent(); } private void Form1_Load(object sender, EventArgs e) { } public ServiceReference1.Service1Client testClient = new ServiceReference1.Service1Client(); private void button1_Click(object sender, EventArgs e) { label1.Text = testClient.GetData(Convert.ToInt32(textBox1.Text)); } }} <system.serviceModel> <services> <service name=""WcfService1.Service1"" behaviorConfiguration=""WcfService1.Service1Behavior""> <!-- Service Endpoints --> <endpoint address="""" binding=""wsHttpBinding"" contract=""WcfService1.IService1""> <!-- Upon deployment, the following identity element should be removed or replaced to reflect the identity under which the deployed service runs. If removed, WCF will infer an appropriate identity automatically. --> <identity> <dns value=""localhost""/> </identity> </endpoint> <endpoint address=""mex"" binding=""mexHttpBinding"" contract=""IMetadataExchange""/> </service> </services> <behaviors> <serviceBehaviors> <behavior name=""WcfService1.Service1Behavior""> <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment --> <serviceMetadata httpGetEnabled=""true""/> <!-- To receive exception details in faults for debugging purposes, set the value below to true. Set to false before deployment to avoid disclosing exception information --> <serviceDebug includeExceptionDetailInFaults=""false""/> </behavior> </serviceBehaviors> </behaviors> </system.serviceModel></configuration> Error: Cannot obtain Metadata from http://localhost:26535/Service1.svc If this is a Windows (R) Communication Foundation service to which you have access, please check that you have enabled metadata publishing at the specified address. For help enabling metadata publishing, please refer to the MSDN documentation at http://go.microsoft.com/fwlink/?LinkId=65455.WS-Metadata Exchange Error URI: http://localhost:26535/Service1.svc Metadata contains a reference that cannot be resolved: 'http://localhost:26535/Service1.svc'. The server did not provide a meaningful reply; this might be caused by a contract mismatch, a premature session shutdown or an internal server error.HTTP GET Error URI: http://localhost:26535/Service1.svc There was an error downloading 'http://localhost:26535/Service1.svc'. The request failed with the error message:--<html> <head> <title>Operation 'GetData' in contract 'IService1' has a path variable named 'value' which does not have type 'string'. Variables for UriTemplate path segments must have type 'string'.</title> <style> body {font-family:""Verdana"";font-weight:normal;font-size: .7em;color:black;} p {font-family:""Verdana"";font-weight:normal;color:black;margin-top: -5px} b {font-family:""Verdana"";font-weight:bold;color:black;margin-top: -5px} H1 { font-family:""Verdana"";font-weight:normal;font-size:18pt;color:red } H2 { font-family:""Verdana"";font-weight:normal;font-size:14pt;color:maroon } pre {font-family:""Lucida Console"";font-size: .9em} .marker {font-weight: bold; color: black;text-decoration: none;} .version {color: gray;} .error {margin-bottom: 10px;} .expandable { text-decoration:underline; font-weight:bold; color:navy; cursor:hand; } </style> </head> <body bgcolor=""white""> <span><H1>Server Error in '/' Application.<hr width=100% size=1 color=silver></H1> <h2> <i>Operation 'GetData' in contract 'IService1' has a path variable named 'value' which does not have type 'string'. Variables for UriTemplate path segments must have type 'string'.</i> </h2></span> <font face=""Arial, Helvetica, Geneva, SunSans-Regular, sans-serif ""> <b> Description: </b>An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. <br><br> <b> Exception Details: </b>System.InvalidOperationException: Operation 'GetData' in contract 'IService1' has a path variable named 'value' which does not have type 'string'. Variables for UriTemplate path segments must have type 'string'.<br><br> <b>Source Error:</b> <br><br> <table width=100% bgcolor=""#ffffcc""> <tr> <td> <code>An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.</code> </td> </tr> </table> <br> <b>Stack Trace:</b> <br><br> <table width=100% bgcolor=""#ffffcc""> <tr> <td> <code><pre>[InvalidOperationException: Operation 'GetData' in contract 'IService1' has a path variable named 'value' which does not have type 'string'. Variables for UriTemplate path segments must have type 'string'.] System.ServiceModel.Dispatcher.UriTemplateClientFormatter.Populate(Dictionary`2& pathMapping, Dictionary`2& queryMapping, Int32& totalNumUTVars, UriTemplate& uriTemplate, OperationDescription operationDescription, QueryStringConverter qsc, String contractName) +726 System.ServiceModel.Dispatcher.UriTemplateDispatchFormatter..ctor(OperationDescription operationDescription, IDispatchMessageFormatter inner, QueryStringConverter qsc, String contractName, Uri baseAddress) +94 System.ServiceModel.Description.WebHttpBehavior.GetRequestDispatchFormatter(OperationDescription operationDescription, ServiceEndpoint endpoint) +137 System.ServiceModel.Description.WebHttpBehavior.ApplyDispatchBehavior(ServiceEndpoint endpoint, EndpointDispatcher endpointDispatcher) +659 System.ServiceModel.Description.DispatcherBuilder.InitializeServiceHost(ServiceDescription description, ServiceHostBase serviceHost) +3864 System.ServiceModel.ServiceHostBase.InitializeRuntime() +37 System.ServiceModel.ServiceHostBase.OnBeginOpen() +27 System.ServiceModel.ServiceHostBase.OnOpen(TimeSpan timeout) +49 System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout) +261 System.ServiceModel.HostingManager.ActivateService(String normalizedVirtualPath) +121 System.ServiceModel.HostingManager.EnsureServiceAvailable(String normalizedVirtualPath) +479[ServiceActivationException: The service '/Service1.svc' cannot be activated due to an exception during compilation. The exception message is: Operation 'GetData' in contract 'IService1' has a path variable named 'value' which does not have type 'string'. Variables for UriTemplate path segments must have type 'string'..] System.ServiceModel.AsyncResult.End(IAsyncResult result) +11655726 System.ServiceModel.Activation.HostedHttpRequestAsyncResult.End(IAsyncResult result) +194 System.ServiceModel.Activation.HostedHttpRequestAsyncResult.ExecuteSynchronous(HttpApplication context, Boolean flowContext) +176 System.ServiceModel.Activation.HttpModule.ProcessRequest(Object sender, EventArgs e) +275 System.Web.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +68 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +75</pre></code> </td> </tr> </table> <br> <hr width=100% size=1 color=silver> <b>Version Information:</b>Microsoft .NET Framework Version:2.0.50727.5448; ASP.NET Version:2.0.50727.5456 </font> </body></html><!-- [InvalidOperationException]: Operation 'GetData' in contract 'IService1' has a path variable named 'value' which does not have type 'string'. Variables for UriTemplate path segments must have type 'string'. at System.ServiceModel.Dispatcher.UriTemplateClientFormatter.Populate(Dictionary`2& pathMapping, Dictionary`2& queryMapping, Int32& totalNumUTVars, UriTemplate& uriTemplate, OperationDescription operationDescription, QueryStringConverter qsc, String contractName) at System.ServiceModel.Dispatcher.UriTemplateDispatchFormatter..ctor(OperationDescription operationDescription, IDispatchMessageFormatter inner, QueryStringConverter qsc, String contractName, Uri baseAddress) at System.ServiceModel.Description.WebHttpBehavior.GetRequestDispatchFormatter(OperationDescription operationDescription, ServiceEndpoint endpoint) at System.ServiceModel.Description.WebHttpBehavior.ApplyDispatchBehavior(ServiceEndpoint endpoint, EndpointDispatcher endpointDispatcher) at System.ServiceModel.Description.DispatcherBuilder.InitializeServiceHost(ServiceDescription description, ServiceHostBase serviceHost) at System.ServiceModel.ServiceHostBase.InitializeRuntime() at System.ServiceModel.ServiceHostBase.OnBeginOpen() at System.ServiceModel.ServiceHostBase.OnOpen(TimeSpan timeout) at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout) at System.ServiceModel.ServiceHostingEnvironment.HostingManager.ActivateService(String normalizedVirtualPath) at System.ServiceModel.ServiceHostingEnvironment.HostingManager.EnsureServiceAvailable(String normalizedVirtualPath)[ServiceActivationException]: The service '/Service1.svc' cannot be activated due to an exception during compilation. The exception message is: Operation 'GetData' in contract 'IService1' has a path variable named 'value' which does not have type 'string'. Variables for UriTemplate path segments must have type 'string'.. at System.ServiceModel.AsyncResult.End[TAsyncResult](IAsyncResult result) at System.ServiceModel.Activation.HostedHttpRequestAsyncResult.End(IAsyncResult result) at System.ServiceModel.Activation.HostedHttpRequestAsyncResult.ExecuteSynchronous(HttpApplication context, Boolean flowContext) at System.ServiceModel.Activation.HttpModule.ProcessRequest(Object sender, EventArgs e) at System.Web.HttpApplication.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)-->--.","convert a WCF Service, to a RESTful application?"
IList vs ICollection vs Collection," I am confused about which collection type that I should return from my public API methods and properties.The collections that I have in mind are IList, ICollection and Collection.Is returning one of these types always preferred over the others, or does it depend on the specific situation? <code> ",Returning 'IList' vs 'ICollection' vs 'Collection'
Object and Collection Initializers," I'm using object and collection Initializers in the program and thinking how to get the example below. How can I assign the newly created order to the order item? <code>  Orders.Add(new Order() { id = 123, date = new datetime(2012,03,26) items = new OrderItems() { lineid = 1, quantity = 3, order = ?? // want to assign to current order. } }",Object and Collection Initializers - assign self?
"LINQ, makeing uniq collection of a collection"," I have Edges and Vertexes are collected into listsSome example: So I would like to make IDictionary<Edge, bool> which would hold edges (A-->B and B-->A would be like 1), and bool - if it is two way or no.I need it because when I draw them now, it draws 2 arrows under one another. I would better make 1 arrow.So I'm pretty stuck right here... May anybody help me a bit ? <code>  class Vertex{ Graph _graph; float x; float y; string key; //and some similar atributes public IEnumerable<Edge> Edges{ get{ return _graph.Edges.Where(s => s.Source == this); } }}class Edge{ Graph _graph; Vertex source; Vertex target;}class Graph{ private VertexCollection _vertexCollection; // extends List<Vertex> private EdgeCollection _edgeCollection; //extends List<Edge> public IEnumerable<Vertex> Vertexes { get { return _vertexCollection; } } public IEnumerable<Edge> Edges { get { return _edgeCollection; } } public IDictionary<Edge, bool> DrawableEdges { get { //want to return my uniq dictionary } } A-->B // edge from vertex A to BB-->C // edge from vertex B to CC-->A // edge from vertex C to AA-->C // edge from vertex A to C -- this is two way edge","LINQ, creating unique collection of a collection"
Visual Studio Remote Debugging on Application Startup," As I understand it now, the only way to use the remote debugger is to start the target application, and then attach to it through Visual Studio. Is there a way to capture all of the breakpoints from the very beginning of the program?There is code within my program that I need to debug, and I can never get the debugger attached fast enough to capture that executing code. <code> ",Visual Studio remote debugging on application startup
WPF RichTextBox - space after new line," A RichTextBox puts extra space between lines when a user presses enter or inserts text, and that's what I'm trying to get away from. I searched around and the only decent solution I found is this one: But this still doesn't work. Does anyone have any tips for me? <code>  Setter SetParagraphMargin = new Setter();SetParagraphMargin.Property = Paragraph.MarginProperty;SetParagraphMargin.Value = new Thickness(0);Style style = new Style();style.TargetType = typeof(Paragraph);style.Setters.Add(SetParagraphMargin);rtb.Resources.Add(""Style"", style);",Space After New Lines in RichTextBox 
WPF RichTextBox - Space After New Lines," A RichTextBox puts extra space between lines when a user presses enter or inserts text, and that's what I'm trying to get away from. I searched around and the only decent solution I found is this one: But this still doesn't work. Does anyone have any tips for me? <code>  Setter SetParagraphMargin = new Setter();SetParagraphMargin.Property = Paragraph.MarginProperty;SetParagraphMargin.Value = new Thickness(0);Style style = new Style();style.TargetType = typeof(Paragraph);style.Setters.Add(SetParagraphMargin);rtb.Resources.Add(""Style"", style);",Space After New Lines in RichTextBox 
Confusion over the new C# 5.0 keywords," Two new keywords added to the C# 5.0 language are async and await, both of which work hand in hand to run a C# method asynchronously without blocking the calling thread.My question is, do these methods actually take advantage of multiple cores and run in parallel or does the async method run in the same thread core as the caller?  <code> ",Do the new C# 5.0 'async' and 'await' keywords use multiple cores?
C# - Get Prettified JSON from MVC 3 JsonResult," ContextLanguage: C#Platform Version: Microsoft .Net Framework 4.0Operating System: Windows 7 Professional (64-bit)Constraints: Microsoft MVC.Net 3.0ProblemI find myself looking at JSON a lot in a browser these days, pointing a browser at one Controller Action or another on my local dev server and parsing JSON visually to make sure everything is being formatted the way we want. The JSON returned by the MVC 3 serializer (or the JSON.Net serializer) always return a minified string, so I wind up with something like this: QuestionI'd really like to find a way, at least during debugging, to get the JsonResult to be ""prettified"" so that it looks more like this: I am aware of several online tools that will let you paste and format JSON. The is an extra step, and is costing me a lot of time. I'd prefer a programmatic solution. I'd also like to be able to turn it on/off via configuration or an #if compiler directive.I have already done a cursory search regarding this and come across this post on Stack Overflow. However, the code example given is quite incomplete. There are also a couple of links provided but they appear to be dead.In any case, I'd like to find a way to get ""prettified"" JSON out of an ActionResult. Any help appredciated.The following source code will reproduce the initial un-prettified JSON string I gave as an example. Feel free to copy/pasted/edit. <code>  {""Bars"":[{""Name"":""Ghost Bar"",""Address"":""2440 Victory Park Lane, 33rd Floor, Dallas, TX 75219"",""OpenDate"":""\/Date(1208062800000)\/"",""Status"":""Open""},{""Name"":""M-Street Bar"",""Address"":""5628 Sears Street, Dallas, TX 75206"",""OpenDate"":""\/Date(1064811600000)\/"",""Status"":""Closed""},{""Name"":""Zephyr\u0027s Lounge"",""Address"":""3520 Greenville Avenue, Dallas, TX 75206"",""OpenDate"":""\/Date(981007200000)\/"",""Status"":""Open""}]} { ""Bars"": [ { ""Name"": ""Ghost Bar"", ""Address"": ""2440 Victory Park Lane, 33rd Floor, Dallas, TX 75219"", ""OpenDate"": ""\/Date(1208062800000)\/"", ""Status"": ""Open"" }, { ""Name"": ""M-Street Bar"", ""Address"": ""5628 Sears Street, Dallas, TX 75206"", ""OpenDate"": ""\/Date(1064811600000)\/"", ""Status"": ""Closed"" }, { ""Name"": ""Zephyr\u0027s Lounge"", ""Address"": ""3520 Greenville Avenue, Dallas, TX 75206"", ""OpenDate"": ""\/Date(981007200000)\/"", ""Status"": ""Open"" } ]} using System.Collections.Generic;using System.Text;using System.Web.Mvc;namespace PrettyJsonResult.Controllers{ public class DefaultController : Controller { public JsonResult Index() { var foo = new Foo(); foo.Bars.Add(new Bar { Address = ""2440 Victory Park Lane, 33rd Floor, Dallas, TX 75219"", Name = ""Ghost Bar"", Status = ""Open"" }); foo.Bars.Add(new Bar { Address = ""5628 Sears Street, Dallas, TX 75206"", Name = ""M-Street Bar"", Status = ""Closed"" }); foo.Bars.Add(new Bar { Address = ""3520 Greenville Avenue, Dallas, TX 75206"", Name = ""Zephyr's Lounge"", Status = ""Open"" }); return Json(foo, ""application/json"", Encoding.UTF8, JsonRequestBehavior.AllowGet); } } public class Foo { public Foo() { Bars = new List<Bar>(); } public List<Bar> Bars { get; set; } } public class Bar { public string Name { get; set; } public string Address { get; set; } public string Status { get; set; } }}",Get Prettified JSON from MVC 3 JsonResult
get the maximum value of particual length," I have a number, for example 1234567897865; how do I max it out and create 99999999999999 ?I did this this way: what would be the better, proper and shorter way to approach this task? <code>  int len = ItemNo.ToString().Length; String maxNumString = """"; for (int i = 0; i < len; i++) { maxNumString += ""9""; } long maxNumber = long.Parse(maxNumString);",How to get the maximum number of a particular length
Which framwork version will a library run in, If i have a library which is compiled in .NET 4 and reference it from a .net 4.5 executable which version of the framework will operations defined in the library execute against?I have a cli app which is built in .net 4.5 and references both .net 4 and .net 4.5 projects and im wondering if both will use the same version of the ADO.net components. <code> ,Which .net framework version will a library run in
Building programatically a project," I need to build a project programmatically for a .csproj I am creating on the fly.While searching Google I found the classes and API provided by the MS for the MSBuild Engine. With that information, I create a process which executes msbuild.exe and then reads the output, but now I want to use the namespace Microsoft.Build.Execution to build the project. This is my program: The results show that this is building fine, but I need to know the detailed output from the compile and how to view it. It would be really helpful if someone can give me link to a good tutorial or a book on MSBuild. <code>  public class Compiler{ private static string locationOfMSBuilldEXE = """"; public static void Build(string msbuildFileName) { BuildManager manager = BuildManager.DefaultBuildManager; ProjectInstance projectInstance = new ProjectInstance(msbuildFileName); var result = manager.Build(new BuildParameters() { DetailedSummary = true }, new BuildRequestData(projectInstance, new string[] { ""Build"" })); var buildResult = result.ResultsByTarget[""Build""]; var buildResultItems = buildResult.Items; string s = """"; }}",Building programmatically a project
Fast serialization/deserialization of structs (C#)," I have huge amont of geographic data represented in simple object structure consisting only structs. All of my fields are of value type. The data is chunked up nicely to small portions of Parent[]-s. Each array contains a few thousands Parent instances. I have way too much data to keep all in memory, so I need to swap these chunks to disk back and forth. (One file would result approx. 2-300KB). What would be the most efficient way of serializing/deserializing the Parent[] to a byte[] for dumpint to disk and reading back? Concerning speed, I am particularly interested in fast deserialization, write speed is not that critical.Would simple BinarySerializer good enough?Or should I hack around with StructLayout (see accepted answer)? I am not sure if that would work with array field of Parent.children.UPDATE: Response to comments - Yes, the objects are immutable (code updated) and indeed the children field is not value type. 300KB sounds not much but I have zillions of files like that, so speed does matter. <code>  public struct Child{ readonly float X; readonly float Y; readonly int myField;}public struct Parent{ readonly int id; readonly int field1; readonly int field2; readonly Child[] children;}",Fast serialization/deserialization of structs
cant get c# linq query to compile with joins," Below is a cut down example of some c# code I can't get to compile while doing some linq joins. Does anyone know why this doesn't compile?The error is Type arguments cannot be inferred from the query(In my real code Fetch() returns an IQueryable<T>) <code>  using System.Collections.Generic;using System.Linq;namespace LinqJoin{ public class DataRepository<T> { public IList<T> Fetch() { return new List<T>(); } } internal class SSOUser { public int Id { get; set; } } internal class UserRole { public int SSOUserId { get; set; } public int RoleId { get; set; } } internal class Role { public int RoleId { get; set; } } class Program { static void Main(string[] args) { var users = new DataRepository<SSOUser>().Fetch(); var userroles = new DataRepository<UserRole>().Fetch(); var roles = new DataRepository<Role>().Fetch(); var result = from u in users join ur in userroles on u.Id equals ur.SSOUserId join r in roles on r.RoleId equals ur.RoleId select u; //var x1 = users.Join(userroles, u => u.Id, ur => ur.SSOUserId, (u, ur) => new { User = u, UserRole = ur}).Join(roles, x => x.UserRole.RoleId, r => r.RoleId, res => res.User); } }}",Can't get c# linq query to compile with joins
What is the difference betwenn Dispatcher.BeginInvoke and Tast.Factory.StartNew, In my WPF application I am loading content using Dispatcher.BeginInvoke in the constructor. My question is will it block the UI thread?Or is it better to use Task.Factory.StartNew and then dispatching things back on UI so that application will load first irrespective of the loading content process time?Which is better approach and why? <code> ,What is the difference between Dispatcher.BeginInvoke and Task.Factory.StartNew
What is the difference betwenn Dispatcher.BeginInvoke and Task.Factory.StartNew, In my WPF application I am loading content using Dispatcher.BeginInvoke in the constructor. My question is will it block the UI thread?Or is it better to use Task.Factory.StartNew and then dispatching things back on UI so that application will load first irrespective of the loading content process time?Which is better approach and why? <code> ,What is the difference between Dispatcher.BeginInvoke and Task.Factory.StartNew
What is the difference betwenn Dispatcher.BeginInvoke and Task.Factory.StartNew, In my WPF application I am loading content using Dispatcher.BeginInvoke in the constructor. My question is will it block the UI thread?Or is it better to use Task.Factory.StartNew and then dispatching things back on UI so that application will load first irrespective of the loading content process time?Which is better approach and why? <code> ,What is the difference between Dispatcher.BeginInvoke and Task.Factory.StartNew
TreeView Not Displying Images from ImageList," I have a TreeView that displays CheckBoxes:I want to check if a given directory contains an "".mdf"" database and if it does, check whether it is attached on the selected server instance. If the database is attached I display an image against that node, and a different image if it is not attached. Note: The images are .png format, size 32x32...I populate an ImageList from Properties.Resources I then loop through the tree and add the relevant image The above code goes through the loop with no complaints, finds "".mdf""s and seems to add the relevant ImageIndexes but these do not show up in the TreeView. What am I doing wrong here and can I add the ImageList at design time (something I also can't seem to do)?I have read several posts and ofcourse the MSDN documantation but I still can't seem to get it working. Any help as always, is much appreciated. <code>  mainImageList = new ImageList();mainImageList.Images.Add(Properties.Resources.Database);mainImageList.Images.Add(Properties.Resources.DatabaseGrey); public static void RecursiveAddImage(TreeNode treeNode, List<string> attachedList){ if (String.Compare(Path.GetExtension(treeNode.Text), "".mdf"", true) == 0) { string databaseName = treeNode.Text.Replace("".mdf"", String.Empty); if (attachedList.Contains(databaseName)) { treeNode.ImageIndex = 0; treeNode.SelectedImageIndex = 0; } else { treeNode.ImageIndex = 1; treeNode.SelectedImageIndex = 1; } } foreach (TreeNode node in treeNode.Nodes) RecursiveAddImage(node, attachedList);}",TreeView Not Displaying Images from ImageList
C# Timespan division by a number," I have a code generating a timespan to calculate a duration of some action.What I want to do is to take that result (the duration) and divide it by a number, any number.How can I do that? <code> ",Timespan division by a number
Referenced Assembly Not Found," I'm running a WCF application CoreApplication whose VS project has a reference to AncillaryProject. CoreApplication uses a class Provider from AncillaryProject; however, it is never explicitly referenced - it's invoked via Reflection.My problem is that sometimes CoreApplication fails to find Provider because AncillaryProject does not come up in the call to GetAssemblies(). Sometimes it works fine, but sometimes (I'm guessing it may be after a JIT) it fails.Here's my original code: After looking at this question, I tried using GetReferencedAssemblies(): I realize that the question I referenced solves the problem through dynamically loading all dll files in the bin directory, but that doesn't sound particularly good to me. Is there a better way to do this, or is .NET simply not loading the other Assemblies in at all? How does this work under the hood, and is there anything I can do about it? <code>  var providers = from d in AppDomain.CurrentDomain.GetAssemblies() from c in d.GetTypes() where typeof(BaseProvider).IsAssignableFrom(c) select c; var allAssemblies = AppDomain.CurrentDomain.GetAssemblies();foreach (var a in AppDomain.CurrentDomain.GetAssemblies()){ allAssemblies = allAssemblies.Union( a.GetReferencedAssemblies() .Select(b => System.Reflection.Assembly.Load(b)));}var providers = from d in allAssemblies from c in d.GetTypes() where typeof(BaseProvider).IsAssignableFrom(c) select c;",Referenced Assembly Not Found - How to get all DLLs included in solution
How do I select which project under a solution to debug or run in visual studios 2010?," This one should be easy. I just can't figure out what to search for...For this one solution I created a unit test project, and I've been adding unit tests frantically. When I went back to try to run the original project after making all the unit tests pass I realized that I couldn't figure out how to debug the original project.In other words, every time I try to ""debug"" (e.g., by pressing F5), Visual Studio will run the unit tests. So the question is how do I run various projects in a single solution? How do I select which one will run when I want it to? <code> ",Selecting which project under a solution to debug or run in Visual Studio 2010
C# - Alternating replace of substrings," I was wondering if there is any way that I can replace substrings within a string but alternate between the string to replace them with. I.E, match all occurences of the string ""**"" and replace the first occurence with ""<strong>"" and the next occurence with ""</strong>"" (And then repeat that pattern).The input would be something like this: ""This is a sentence with **multiple** strong tags which will be **strong** upon output""And the output returned would be: ""This is a sentence with <strong>multiple</strong> strong tags which will be <strong>strong</strong> upon output"" <code> ",Alternating replace of substrings
How to set an evenHandler in wpf to all windows (enitre application)?," How can I set an event handler (such as keydown) to entire solution, not a single window? <code> ",How to set an evenHandler in WPF to all windows (entire application)?
"C# use XmlWriterSettings to write short elements aka <element a=""1"" /> instead of <element a=""1""></element>"," I'm using XmlWriterSettings to write Xml to file. I have elements with only attributes, no children. I want them to output as: instead of Can i do it with XmlWriterSettings?EDIT:Code is as follows: here _FM_tve_Mission is a TreeView control which has nodes, each of the nodes has a tag of class MissionNode, which has ToXml method that returns XmlNode containing this MissionNode converted to xml <code>  <element a=""1"" /> <element a=""1""></element> private void Mission_Save(string fileName) { StreamWriter streamWriter = new StreamWriter(fileName, false); streamWriter.Write(Mission_ToXml()); streamWriter.Close(); streamWriter.Dispose(); _MissionFilePath = fileName; }private string Mission_ToXml() { XmlDocument xDoc; XmlElement root; XmlAttribute xAtt; xDoc = new XmlDocument(); foreach (string item in _MissionCommentsBefore) xDoc.AppendChild(xDoc.CreateComment(item)); root = xDoc.CreateElement(""mission_data""); xAtt = xDoc.CreateAttribute(""version""); xAtt.Value = ""1.61""; root.Attributes.Append(xAtt); xDoc.AppendChild(root); //Out the xml's! foreach (TreeNode node in _FM_tve_Mission.Nodes) Mission_ToXml_private_RecursivelyOut(root, xDoc, node); foreach (string item in _MissionCommentsAfter) xDoc.AppendChild(xDoc.CreateComment(item)); //Make this look good StringBuilder sb = new StringBuilder(); XmlWriterSettings settings = new XmlWriterSettings(); settings.Indent = true; settings.IndentChars = "" ""; settings.NewLineChars = ""\r\n""; settings.NewLineHandling = NewLineHandling.Replace; settings.OmitXmlDeclaration = true; using (XmlWriter writer = XmlWriter.Create(sb, settings)) { xDoc.Save(writer); } return sb.ToString(); }private void Mission_ToXml_private_RecursivelyOut(XmlNode root, XmlDocument xDoc, TreeNode tNode) { root.AppendChild(((MissionNode)tNode.Tag).ToXml(xDoc)); foreach (TreeNode node in tNode.Nodes) Mission_ToXml_private_RecursivelyOut(root, xDoc, node); }",Instruct XmlWriterSettings to use self-closing tags
Look at each character in a string C#," I was wondering if anyone knew how to look through a string at each character and then add each character to a new string? Just a really really basic example, I can add the ToUpper and ToLower validation and such. <code> ",Look at each character in a string
How to access page in Main <aster page in Nested Master Page," I have 2 master pages that are nested.this is main master page code for example: and the nested master page: and I create a page based on this nested master page: I want in click of Button1 get text of main master page.How I can do this? <code>  <%@ Master Language=""C#"" AutoEventWireup=""true"" CodeFile=""MasterPageMaster.master.cs"" Inherits=""MasterPageMaster"" %><!DOCTYPE html PUBLIC ""-//W3C//DTD XHTML 1.0 Transitional//EN"" ""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd""><html xmlns=""http://www.w3.org/1999/xhtml""><head runat=""server""> <title></title> <asp:ContentPlaceHolder id=""head"" runat=""server""> </asp:ContentPlaceHolder></head><body><form id=""form1"" runat=""server""><div> <asp:TextBox ID=""txtMasterPageMaster"" ClientIDMode=""Static"" runat=""server""></asp:TextBox> <div style=""background-color:Aqua;height:40px;""> Some Text </div> <asp:ContentPlaceHolder id=""ContentPlaceHolder1"" runat=""server""> </asp:ContentPlaceHolder></div></form> <%@ Master Language=""C#"" MasterPageFile=""~/MasterPageMaster.master"" AutoEventWireup=""true""CodeFile=""MasterPageNested.master.cs"" Inherits=""MasterPageNested"" %><asp:Content ID=""Content1"" ContentPlaceHolderID=""head"" runat=""Server""></asp:Content><asp:Content ID=""Content2"" ContentPlaceHolderID=""ContentPlaceHolder1"" runat=""Server""> <asp:Panel runat=""server"" ID=""panelMain"" BackColor=""lightyellow""> <h2> Child master</h2> <asp:Panel runat=""server"" ID=""panel1"" BackColor=""lightblue""> <p> This is child master content.</p> <asp:ContentPlaceHolder ID=""ChildContent1"" runat=""server"" /> </asp:Panel> <asp:Panel runat=""server"" ID=""panel2"" BackColor=""pink""> <p> This is child master content.</p> <asp:ContentPlaceHolder ID=""ChildContent2"" runat=""server"" /> </asp:Panel> <br /></asp:Panel></asp:Content> <%@ Page Title="""" Language=""C#"" MasterPageFile=""~/MasterPageNested.master"" AutoEventWireup=""true"" CodeFile=""PageMasterPageNested.aspx.cs"" Inherits=""PageMasterPageNested"" %><asp:Content ID=""Content1"" ContentPlaceHolderID=""ChildContent1"" Runat=""Server""></asp:Content> <asp:Content ID=""Content2"" ContentPlaceHolderID=""ChildContent2"" Runat=""Server""> <asp:Button ID=""Button1"" runat=""server"" Text=""Button"" Height=""66px"" onclick=""Button1_Click"" Width=""196px"" /></asp:Content>",How to access controls in Main Master page from content page in Nested Master Page
How to access page in Main Master page in Nested Master Page," I have 2 master pages that are nested.this is main master page code for example: and the nested master page: and I create a page based on this nested master page: I want in click of Button1 get text of main master page.How I can do this? <code>  <%@ Master Language=""C#"" AutoEventWireup=""true"" CodeFile=""MasterPageMaster.master.cs"" Inherits=""MasterPageMaster"" %><!DOCTYPE html PUBLIC ""-//W3C//DTD XHTML 1.0 Transitional//EN"" ""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd""><html xmlns=""http://www.w3.org/1999/xhtml""><head runat=""server""> <title></title> <asp:ContentPlaceHolder id=""head"" runat=""server""> </asp:ContentPlaceHolder></head><body><form id=""form1"" runat=""server""><div> <asp:TextBox ID=""txtMasterPageMaster"" ClientIDMode=""Static"" runat=""server""></asp:TextBox> <div style=""background-color:Aqua;height:40px;""> Some Text </div> <asp:ContentPlaceHolder id=""ContentPlaceHolder1"" runat=""server""> </asp:ContentPlaceHolder></div></form> <%@ Master Language=""C#"" MasterPageFile=""~/MasterPageMaster.master"" AutoEventWireup=""true""CodeFile=""MasterPageNested.master.cs"" Inherits=""MasterPageNested"" %><asp:Content ID=""Content1"" ContentPlaceHolderID=""head"" runat=""Server""></asp:Content><asp:Content ID=""Content2"" ContentPlaceHolderID=""ContentPlaceHolder1"" runat=""Server""> <asp:Panel runat=""server"" ID=""panelMain"" BackColor=""lightyellow""> <h2> Child master</h2> <asp:Panel runat=""server"" ID=""panel1"" BackColor=""lightblue""> <p> This is child master content.</p> <asp:ContentPlaceHolder ID=""ChildContent1"" runat=""server"" /> </asp:Panel> <asp:Panel runat=""server"" ID=""panel2"" BackColor=""pink""> <p> This is child master content.</p> <asp:ContentPlaceHolder ID=""ChildContent2"" runat=""server"" /> </asp:Panel> <br /></asp:Panel></asp:Content> <%@ Page Title="""" Language=""C#"" MasterPageFile=""~/MasterPageNested.master"" AutoEventWireup=""true"" CodeFile=""PageMasterPageNested.aspx.cs"" Inherits=""PageMasterPageNested"" %><asp:Content ID=""Content1"" ContentPlaceHolderID=""ChildContent1"" Runat=""Server""></asp:Content> <asp:Content ID=""Content2"" ContentPlaceHolderID=""ChildContent2"" Runat=""Server""> <asp:Button ID=""Button1"" runat=""server"" Text=""Button"" Height=""66px"" onclick=""Button1_Click"" Width=""196px"" /></asp:Content>",How to access controls in Main Master page from content page in Nested Master Page
C# byte collection based similar with ByteBuffer from java," I need a C# implementation of something similar with ByteBuffer from Java. Methods of interest- .remaining() - returns the number of elements between the current position and the limit.- .array() - .clear()- .put(byte[], int, int)I started something with MemoryStream.. but no clear(), and a lot of improvisationAlso, i found a c# implementation on Koders: http://www.koders.com/csharp/fid2F8CB1B540E646746D3ADCB2B0AC867A0A8DCB06.aspx?s=socket#L2.. which I will use.. but maybe you guys know something better <code> ",byte collection based similar with ByteBuffer from java
Convert xmlstring into XmlNode-C#," i have one xml string like this I also creaated one xml document i need an output like this. How can i achieve this.if we using innerhtml,it will insert.But i want to insert xml string as a xmlnode itself <code>  string stxml=""<Status>Success</Status>""; XmlDocument doc = new XmlDocument(); XmlNode docNode = doc.CreateXmlDeclaration(""1.0"", ""UTF-8"", null); doc.AppendChild(docNode); XmlNode rootNode = doc.CreateElement(""StatusList""); doc.AppendChild(rootNode); <StatusList> <Status>Success</Status> </StatusList>",Convert xmlstring into XmlNode
Comparing date in query using Linq," I have a Linq query that returns to a var type myQry This is a large linq returns all the records that I need to filter further. In one of my if-conditions I have a filter that runs like this to check against date. I need to check if name contains the name entered and matches the birthdate exactly. I tried this which compiled and ran, but did not work correctly Then I tried this which gave threw an exception ""DbArithmeticExpression arguments must have a numeric common type"" For such kind of a situation when I use a where clause on my query, what would be the best way to do a date comparison? What kind of operations are not allowed in the where clause of a LinQ query?Thanks for your time... <code>  var myQry = from ..... myQry.Where(x => x.FirstName.Contains(strName) && DateTime.Compare( x.BirthDt, searchDt)>=0).ToList() myQry.Where(x => x.FirstName.Contains(strName) && (x.BirthDt- searchDt).Days == 0).ToList();",Comparing dates in query using LINQ
"does using ""from"" more than once is equivalent to hav joins?"," I came across following code and don't know what does having from twice mean in this code. Does it mean there is a join between Books and CSBooks? <code>  List<Product> Books = new List<Product>(); List<Product> CSBooks = new List<Product>(); var AllBooks = from Bk in Books from CsBk in CSBooks where Bk != CsBk select new[] { Bk, CsBk };","does using ""from"" more than once is equivalent to have join?"
EF Code First Find vs SingleOrDefault (Eager Loading)," I'm using Entity Framework 4.2 (Code First) to access my database. I was under the assumption that if I queried an entity using SingleOrDefault it would only query the database if the entity was not already being tracked, but this does not appear to be the case. The Find method on the other hand, does appear to be doing this. The problem with Find is that it doesn't appear to allow me to load related data.Is there a way to use the Find method but also eagerly load data ? As an example, I want to load a book and all of its reviews: With SingleOrDefault I can load the Reviews when I get the book using Include: Is there a way to get the behavior of Find with the eager loading of SingleOrDefault ? <code>  // Load book from the databaseBook book = context.Books.Find(1); context.Entry<Book>(book).Collection<Review>.Load(); // Book.Reviews is now populated// Load book from the change tracker// This will include all Reviews as wellBook book2 = context.Books.Find(1); // Load book + reviews from the databaseBook book = Book.Include(""Reviews"").SingleOrDefault(b => b.Id == 1);// Doing the same thing again requeries the databaseBook book2 = Book.Include(""Reviews"").SingleOrDefault(b => b.Id == 1);",Entity Framework Code First Find vs SingleOrDefault (Eager Loading)
SQL C# Execution Time Slower with each Iteration of the same SPROC," Running the same Stored Procedure from C# .Net application over a network gets progressively slower with each subsequent execution. It appears to take twice the amount of time as the previous execution (up to a max value; read on). The execution time becomes progressively slower until 1 of 2 scenarios happens, at which point the first execution of the SPROC is ""fast"" again.If an SqlConnection is opened and remains open during all testing,the SPROC gets progressively slower until any other SPROC or query is run.If an SqlConnection is opened and closed around each execution, theSPROC gets progressively slower until at least 8 minutes has passed.This only happens with a few Stored Procedures. One is a simple SELECT query with 2 JOINs, (SPROC 1) another is a massive 1600+ line SPROC (SPROC 2).The execution times appear to never go beyond exactly 60 seconds for SPROC 1 and 67 seconds for SPROC 2. SPROC 1 takes less than a second to execute initially, and SPROC 2 takes 7 seconds initially.This also only happens if the SPROC is run using the same SqlConnection in the application. As soon as 2 separate SqlConnection objects are used, they behave the same as stated above, but are independent. Running the SPROC multiple times on SqlConnection1 gets progressively slower, but the first time the same SPROC is run on SqlConnection2, it's ""fast"". It will then also get slower when run multiple times on SqlConnection2.This does not happen if the application is run on the same computer with SQL Server 2008 R2 installed (running Windows Server 2008). The execution time is always consistent.Running the Stored Procedure from within Management Studio also does not get slower with each execution; it is always consistent.Clearing the execution plan cache (in SQL Server) has no effect on the observed behavior.It has taken quite a few days to narrow down this issue originally observed in a much larger application, in order to create a test app to easily test/reproduce it.From what I've read here, there is a timeout of between 4 and 8 minutes (after SqlConnection.Close() is called in code) at which point it closes the database connection to the data source. This appears to be in line with the scenario 2 I mentioned above.This leads me to believe it is related to the SqlConnection used (and the underlying database connection to the data source) since connection pooling is enabled in my case, but why am I observing this behavior, and how do I fix it?We are using the .Net 2.0 Framework, if that makes any difference.There are many fine details listed above, so please let me know if I need to clarify anything.The only Stack Overflow question with any similarities is this, but was unrelated to my issue.Edit:The following code is executed in my WinForms test app on startup: I then have 2 buttons; one of which calls SPROC 1 mentioned above, and the other calls a different SPROC which does not have the same slowdown issue. The following code is executed on either button click (only difference being the SPROC name): <code>  SqlConnectionStringBuilder connectionStringBuilder = new SqlConnectionStringBuilder();connectionStringBuilder.DataSource = m_DataSource;connectionStringBuilder.InitialCatalog = m_InitialCatalog;connectionStringBuilder.UserID = m_UserID;connectionStringBuilder.Password = m_Password;connectionStringBuilder.IntegratedSecurity = false;connectionString = connectionStringBuilder.ConnectionString;m_DatabaseConnection = new SqlConnection(connectionString); m_DatabaseConnection.Open();m_DatabaseCommand = new SqlCommand(""GetCompanies"", m_DatabaseConnection);m_DatabaseCommand.Parameters.AddWithValue(""@StatusID"", StatusID);m_DatabaseCommand.CommandType = CommandType.StoredProcedure;m_DatabaseCommand.CommandTimeout = 0;SqlDataAdapter databaseDataAdapter = new SqlDataAdapter(m_DatabaseCommand);DataSet databaseDataSet = new DataSet();databaseDataAdapter.Fill(databaseDataSet);m_DatabaseConnection.Close();",Execution Time Slower with each Iteration of the same SPROC
Call Command from Code Behind WPF," So I've been searching around and cannot find out exactly how to do this. I'm creating a user control using MVVM and would like to run a command on the 'Loaded' event. I realize this requires a little bit of code behind, but I can't quite figure out what's needed. The command is located in the ViewModel, which is set as the datacontext of the view, but I'm not sure exactly how to route this so I can call it from the code behind of the loaded event. Basically what I want is something like this... Looking around I can't seem to find the syntax for this anywhere. Do I need to bind the command in the xaml first to be able to reference it? I notice the command bindings option within a user control will not let you bind commands as you can within something like a button... I'm sure there's a simple way to do this, but I can't for the life of me figure it out.  <code>  private void UserControl_Loaded(object sender, RoutedEventArgs e){ //Call command from viewmodel} <UserControl.CommandBindings> <CommandBinding Command=""{Binding MyCommand}"" /> <!-- Throws compile error --></UserControl.CommandBindings>",Call Command from Code Behind
Interacting with avatar using Kinect and Unity 3d," I want to move the avatar based on the movement the player using kinect and Unity, are there any good tutorials?We are using unity and Kinect interface to create a simple application. Based on the movement of the player we need to move the avatar.We are supposed to use Unity with GAKUNITY, No OpenNI or any third party tools.Are there any good tutorials for GakUnity with Kinect?GAK means Gadget Accelerator KitWe just want to move any avatar with player movement in front of kinect interface. Even help in hand movement also highly appreciated. You can also share useful links or books regarding to unity and kinect programming. <code> ",Interacting with avatar using Kinect and Unity
wrapping content in a stackpanel wpf," is it possible to wrap content in a StackPanel?I know that we can make use of a WrapPanel instead. But for code modifying reasons, I must make use of a StackPanel.So, is there a way to make the items in a StackPanel wrap after say 5 items...Thanks! <code> ",wrapping content in a StackPanel wpf
Upload file on ftp," I want to upload file from one server to another FTP server and following is my code to upload file but it is throwing an error as: The remote server returned an error: (550) File unavailable (e.g., file not found, no access).This my code: Can you please tell me where i am going wrong? <code>  string CompleteDPath = ""ftp URL"";string UName = ""UserName"";string PWD = ""Password"";WebRequest reqObj = WebRequest.Create(CompleteDPath + FileName);reqObj.Method = WebRequestMethods.Ftp.UploadFile;reqObj.Credentials = new NetworkCredential(UName, PWD);FileStream streamObj = System.IO.File.OpenRead(Server.MapPath(FileName));byte[] buffer = new byte[streamObj.Length + 1];streamObj.Read(buffer, 0, buffer.Length);streamObj.Close();streamObj = null;reqObj.GetRequestStream().Write(buffer, 0, buffer.Length);reqObj = null; ",Upload file on FTP
Get elapsed time since Application start in C#, I am porting an app from ActionScript3.0 (Flex) to C# (WPF).AS3.0 has got a handy utility called getTimer() which returns time since Flash Virtual machine start in milliseconds.I was searching in C# through classes as but found nothing like this.It seems a very basic feature to me.For example Unity3D which runs on Mono has something familiar. Do I miss some utility here? Thanks in advance.  <code>  DateTimeDispatcherTimerSystem.Diagnostics.ProcessSystem.Diagnostics.Stopwatch,Get elapsed time since application start
Using Linq to Entity in retrieving rows from huge database," I have the DB that contains billions of rows.I created function that recieve from user number of parameters and cut the DB by those parameters. This works well for me with small DB(30000 rows), but when I try to use this function on big DB I got TIMEOUTEXCEPTION from SQLSERVER.Here is my code: My version of SQL is 2005. I got an exception on p_Datagrid.DataBind(); row.Any suggetions?Thanks <code>  public static IQueryable<LogViewer.EF.InternetEF.Log> ExecuteInternetGetLogsQuery(FilterCriteria p_Criteria, ref GridView p_Datagrid){ IQueryable<LogViewer.EF.InternetEF.Log> internetQuery = null; using (InternetDBConnectionString context = new InternetDBConnectionString()) { internetQuery = context.Logs; if ((p_Criteria.DateTo != null && p_Criteria.DateFrom != null)) { internetQuery = internetQuery.Where(c => c.Timestamp >= p_Criteria.DateFrom && c.Timestamp < p_Criteria.DateTo); } else if (p_Criteria.DateFrom != null && p_Criteria.DateFrom > DateTime.MinValue) { internetQuery = internetQuery.Where(c => c.Timestamp >= p_Criteria.DateFrom); } else if (p_Criteria.DateTo != null && p_Criteria.DateTo > DateTime.MinValue) { internetQuery = internetQuery.Where(c => c.Timestamp < p_Criteria.DateTo); } if (!string.IsNullOrEmpty(p_Criteria.FreeText)) { internetQuery = internetQuery.Where(c => c.FormattedMessage.Contains(p_Criteria.FreeText)); } if (p_Criteria.Titles.Count > 0) { internetQuery = internetQuery.AsEnumerable().Where(c => p_Criteria.Titles.Contains(c.Title)).AsQueryable(); } if (p_Criteria.MachineNames.Count > 0) { internetQuery = internetQuery.AsEnumerable().Where(c => p_Criteria.MachineNames.Contains(c.MachineName)).AsQueryable(); } if (p_Criteria.Severities.Count > 0) { internetQuery = internetQuery.AsEnumerable().Where(c => p_Criteria.Severities.Contains(c.Severity)).AsQueryable(); } internetQuery= internetQuery.OrderByDescending(c=>c.LogID); if (internetQuery.Count() > p_Criteria.TopValue) { internetQuery = internetQuery.Take(p_Criteria.TopValue); } p_Datagrid.DataSource = internetQuery; p_Datagrid.DataBind(); return internetQuery; } }",Optimizing performance of flexible Linq to Entity criteria when retrieving rows from huge database
Extending System.Convert in C# (.Net Framework 4.0)," System.Convert has a really useful utility for converting datatypes from one type to another. In my project, I have many custom types. I want to convert command line arguments to these custom types (some of which are quite complex). It would be nice if these existed within System.Convert so I could just do something like this: I'd like for this to show up in the Visual C# IDE as I type. I know that I could simply create a routine to convert types but I would like the type conversions to be handled in the same manner as what's already built into the framework. Has anyone had success doing this in the past? <code>  Convert.ToMyCustomType(args[1])",Extending System.Convert
Execute lambda expression immediately after its definition," Is there a way to execute a lambda expression immediately after its definition?In other words (Invalid C# code): <code>  (() => { Console.WriteLine(""Hello World""); }).Invoke();",Execute lambda expression immediately after its definition?
c# do you need to check if something has a value and if something is greater than 0?," Working on a project and the coder does this a lot in his checks. First he checks if the nullable int has a value, and then he checks if its greater than 0. Why? Why make two checks if one check - if it is greater than 0 - should be sufficient? Because nulls are not greater than 0 so ...Is that redundant? Wasn't sure if this was something I'd ask here but I wouldn't know how to word it in a google search so maybe I don't know something that this programmer does. <code> ",C# do you need to check if something has a value and if something is greater than 0?
Send email with attchement using System.Net.Mail in c#," I am using System.Net.Mail to send emails through my application. I was trying to send emails with the attachments with following code. When I send the emails with the attachments it throw an exceptions as follows. <code>  Collection<string> MailAttachments = new Collection<string>(); MailAttachments.Add(""C:\\Sample.JPG""); mailMessage = new MailMessage(); foreach (string filePath in emailNotificationData.MailAttachments) { FileStream fileStream = File.OpenWrite(filePath); using (fileStream) { Attachment attachment = new Attachment(fileStream, filePath); mailMessage.Attachments.Add(attachment); } } SmtpClient smtpClient = new SmtpClient(); smtpClient.Host = SmtpHost; smtpClient.Send(mailMessage); Cannot access a closed file.at System.IO.__Error.FileNotOpen()at System.IO.FileStream.Read(Byte[] array, Int32 offset, Int32 count)at System.Net.Mime.MimePart.Send(BaseWriter writer)at System.Net.Mime.MimeMultiPart.Send(BaseWriter writer)at System.Net.Mail.Message.Send(BaseWriter writer, Boolean sendEnvelope)at System.Net.Mail.MailMessage.Send(BaseWriter writer, Boolean sendEnvelope)at System.Net.Mail.SmtpClient.Send(MailMessage message)",Send email with attchement using System.Net.Mail thows exception: Cannot access a closed file
Send email with attchement using System.Net.Mail," I am using System.Net.Mail to send emails through my application. I was trying to send emails with the attachments with following code. When I send the emails with the attachments it throw an exceptions as follows. <code>  Collection<string> MailAttachments = new Collection<string>(); MailAttachments.Add(""C:\\Sample.JPG""); mailMessage = new MailMessage(); foreach (string filePath in emailNotificationData.MailAttachments) { FileStream fileStream = File.OpenWrite(filePath); using (fileStream) { Attachment attachment = new Attachment(fileStream, filePath); mailMessage.Attachments.Add(attachment); } } SmtpClient smtpClient = new SmtpClient(); smtpClient.Host = SmtpHost; smtpClient.Send(mailMessage); Cannot access a closed file.at System.IO.__Error.FileNotOpen()at System.IO.FileStream.Read(Byte[] array, Int32 offset, Int32 count)at System.Net.Mime.MimePart.Send(BaseWriter writer)at System.Net.Mime.MimeMultiPart.Send(BaseWriter writer)at System.Net.Mail.Message.Send(BaseWriter writer, Boolean sendEnvelope)at System.Net.Mail.MailMessage.Send(BaseWriter writer, Boolean sendEnvelope)at System.Net.Mail.SmtpClient.Send(MailMessage message)",Send email with attchement using System.Net.Mail thows exception: Cannot access a closed file
Declaring hex constant in vb.net," How can I convert the following C# hexadecimal into a VB.NET hexadecimal? I tried the following, but it doesn't work. <code>  private const UInt32 temp = 0xE6359A60; Public Const temp As System.UInt32 = 0xE6359A60",Declaring a hex constant in VB.NET
LINQ: How can I group by a List of elements?," I run into this issue again and again: how can I group a list of objects by a containing list of other objects?I have a list of objects of type A and each of these objects has an property (lets call it ListProp) which is a list also. ListProp has elements of the type B. There are multiple elements of type A with identically B-objects in ListProp, but the ListProp property reference differs from element to element. How can I group these A-objects the fastest way, where the B-objects in ListProp are identically?Sample code: <code>  class Program{ static void Main(string[] args) { var exampleList = new List<A> { // Should be in first group new A { ListProp = new List<B> { new B { Prop = new C { Number = 0 }}, new B { Prop = new C { Number = 1 }} }}, // Should be in first group new A { ListProp = new List<B> { new B { Prop = new C { Number = 0 }}, new B { Prop = new C { Number = 1 }} }}, // Should be in second group new A { ListProp = new List<B> { new B { Prop = new C { Number = 0 }}, new B { Prop = new C { Number = 1 }}, new B { Prop = new C { Number = 1 }} }}, // Should be in third group new A { ListProp = new List<B> { new B { Prop = new C { Number = 0 }}, new B { Prop = new C { Number = 0 }} }} }; // Doesn't work because the reference of ListProp is always different var groupedExampleList = exampleList.GroupBy(x => x.ListProp); }}class C{ public int Number { get; set; } public override bool Equals(object o) { if (o is C) return Number.Equals(((C)o).Number); else return false; }}class B{ public C Prop { get; set; }}class A{ public IList<B> ListProp { get; set; }}", How can I group by a list of elements?
can't use HttpServerUtility.HtmlEncode inside a class?," I am trying to use the following code: I am getting the following error: An object reference is required for the nonstatic field, method, or property.Why can't I use HttpServerUtility.HtmlEncode inside a class? <code>  string myString = HttpServerUtility.HtmlEncode(""my link & details"");",Why can't I use HttpServerUtility.HtmlEncode inside a class?
how to make rectangle table as round rectangle in itextsharp using c#," I want to make a round rectangle in itextsharp. Here is the output I have now without rounding:and here is my code that processes that output: What can I change/add to achieve the desired result? <code>  pdftbl = new PdfPTable(3);pdftbl.WidthPercentage = 100;width = new float[3];width[0] = 0.6F;width[1] = 0.2F;width[2] = 0.6F;pdftbl.SetWidths(width);pdfcel = new PdfPCell(new Phrase(Insuredaddress, docFont9));pdfcel.BorderColor = Color.BLACK;pdftbl.AddCell(pdfcel);pdfcel = new PdfPCell(new Phrase("""", docWhiteFont9));pdfcel.Border = 0;pdftbl.AddCell(pdfcel);pdfcel = new PdfPCell(new Phrase(BkrAddrss, docFont9));pdfcel.BorderColor = Color.BLACK;pdftbl.AddCell(pdfcel);objDocument.Add(pdftbl);",How do I round the corners of an iTextSharp table border?
Fast Calculation," Program is receiving approximately 50,000 numbers every second.At ANY given moment, I need to calculate minimum, maximum and average of the values (numbers) that arrived in the last second (regarding to given moment).Is there a way to do this without using array or list (buffer) to store arriving numbers and to calculate results?If I need to use buffer, what would be the efficient way to achieve this?(Note that numbers from buffer also must be efficiently removed from time to time) <code> ","Fast calculation of min, max, and average of incoming numbers"
Sequencing of instructions in .NET C#," Suppose I have the following code: What is the .NET runtime actually doing here? Is it parsing and converting the attributes to integers each of the 100 times, or is it smart enough to figure out that it should cache the parsed values and not repeat the computation for each element in the range?Moreover, how would I go about figuring out something like this myself?Thanks in advance for your help. <code>  var X = XElement.Parse (@"" <ROOT> <MUL v='2' /> <MUL v='3' /> </ROOT>"");Enumerable.Range (1, 100) .Select (s => X.Elements () .Select (t => Int32.Parse (t.Attribute (""v"").Value)) .Aggregate (s, (t, u) => t * u) ) .ToList () .ForEach (s => Console.WriteLine (s));",Does LINQ cache computed values?
Sequencing of instructions," Suppose I have the following code: What is the .NET runtime actually doing here? Is it parsing and converting the attributes to integers each of the 100 times, or is it smart enough to figure out that it should cache the parsed values and not repeat the computation for each element in the range?Moreover, how would I go about figuring out something like this myself?Thanks in advance for your help. <code>  var X = XElement.Parse (@"" <ROOT> <MUL v='2' /> <MUL v='3' /> </ROOT>"");Enumerable.Range (1, 100) .Select (s => X.Elements () .Select (t => Int32.Parse (t.Attribute (""v"").Value)) .Aggregate (s, (t, u) => t * u) ) .ToList () .ForEach (s => Console.WriteLine (s));",Does LINQ cache computed values?
Console.Read is being ignored," I'm new to the C# language, and have only started learning it for use on the XNA Game Studio for X-box.I have some minor experience with Java and C++, so I'm not a TOTAL noob. That's exactly why this problem is so frustrating to me.I have created a simple code designed to add two numbers input from the user. Extremely simple stuff, but a good first step for any new language I feel.I've declared my variables, and was trying to use Console.Read() to get numbers from the user to add. So far, the code outputs the message I want, then stops and reads in a single input from the user. After that, it messes up. The console outputs the next message, reads some random number (no input), then adds them together and outputs that instantly.Here is my code: Sample runs:Please enter the first number to add:2Please enter the second number to add:The total of the two numbers is: 63Please enter the first number to add:3Please enter the second number to add:The total of the two numbers is: 64It continues like that, acting as though the secondNumber is 61.Thanks in advance for any help!  <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;namespace Add{ class Program { static void Main(string[] args) { Console.WriteLine(""Please enter the first number to add: ""); int firstNumber = Console.Read(); Console.WriteLine(""Please enter the second number to add: ""); int secondNumber = Console.Read(); int Sum = firstNumber + secondNumber; Console.WriteLine(""The total of the two numbers is: "" + Sum); } }}",Console.Read is being ignored (Solved)
What is the purpose of isPersistent property?," I'm trying to get my head round the purpose of the isPersistent property found on the FormsAuthenticationTicket class. http://msdn.microsoft.com/en-us/library/kybcs83h.aspxAre there scenarios when setting isPersistent works?In what scenarios would I want to set isPersistent to true and false?The property seems to be redundant since I've found the only way for me to persist my users authentication cookie across browser sessions is to set the Expires property of the cookie created following ticket creation; even if the tickets isPersistent value is set to false.I also found that setting the tickets expiry (not the cookie) to something like 10 seconds with isPersistent set to true has little effect; the ticket expires after 10 seconds. I appreciate that I can change my above code to optionally set expires An example application has been created @ GitHub. https://github.com/chrismoutray/AuthSample This basically shows that even by setting the isPersistent flag to true the cross browser authorization doesn't work. <code>  FormsAuthenticationTicket ticket = new FormsAuthenticationTicket(1, identity.Name, DateTime.Now, DateTime.Now.AddMinutes(FormsAuthentication.Timeout.TotalMinutes), isPersistent, JsonSerializerService.ToJson(identity), FormsAuthentication.FormsCookiePath);string encryptedTicket = FormsAuthentication.Encrypt(ticket);var cookie = new HttpCookie(FormsAuthentication.FormsCookieName, encryptedTicket);cookie.Path = FormsAuthentication.FormsCookiePath;cookie.Expires = DateTime.Now.AddYears(1); // good for one year if (isPersistent) cookie.Expires = DateTime.Now.AddYears(1); // good for one year",What is the purpose of FormsAuthenticationTicket isPersistent property?
How to add image icon for custom button in outlook custom button {Language : c#}," I have a custom button in outlook and I have to add image icon for the same button.Ribbon XML is: I want to write ribbon callback method but how do I write the same and how do I use an image stored in a Resource folder under the Addin project. <code>  <button id=""GoToAppConfiguration"" label=""Application Configuration"" getImage=""GetCustomImage"" onAction=""GoToAppConfigurationClicked"" size=""normal"" />",How do I add an image icon for custom button in outlook
How do I add an image icon for custom button in outlook custom button," I have a custom button in outlook and I have to add image icon for the same button.Ribbon XML is: I want to write ribbon callback method but how do I write the same and how do I use an image stored in a Resource folder under the Addin project. <code>  <button id=""GoToAppConfiguration"" label=""Application Configuration"" getImage=""GetCustomImage"" onAction=""GoToAppConfigurationClicked"" size=""normal"" />",How do I add an image icon for custom button in outlook
Determine if a class implements an very specific interface," There are tons of questions about this topic, but I have a slightly altered version of it.We have the following code: Now, the twist of the story: the method Implements_IFoo should only return true when the Type implements IFoo only and not any of the interfaces derived from IFoo. To illustrate here are some examples of this method: Note that there can be numerous interfaces derived from IFoo and you do not necessarily know about their existence.The obvious method is to find all interfaces derived from IFoo through reflection and then just check the typeof(Bar).GetInterfaces() is any of those are present in there. But I was wondering if someone can come up with a more elegant solution.PS The question originates from some code I found that uses this check on classes (if(obj.GetType() == typeof(BaseClass)) { ... }). We are replacing classes with interfaces now that particular code. Also, just in case - I am implementing this check as a boolean flag, so this question is purely hypothetical. <code>  interface IFoo { }interface IBar : IFoo { }class Foo : IFoo { }class Bar : IBar { }bool Implements_IFoo(Type type) { /* ??? */ } Implements_IFoo(typeof(Foo)); // Should return trueImplements_IFoo(typeof(Bar)); // Should return false as Bar type // implements an interface derived from IFoo",Determine if a class implements a very specific interface
C# Return value from OleDbCommand," I was told that this is how to read data from a SELECT query using Parameters but it's not working. I think I did something wrong.I am using WinForms and Microsoft Access 2007 <code>  sqlQuery = ""SELECT [ID] from [users] WHERE CallerName=@CallerName"";OleDbConnection conn = new OleDbConnection(connectionString);conn.Open();cmd = new OleDbCommand(sqlQuery, conn);cmd.CommandText = sqlQuery;cmd.Parameters.Add(""@CallerName"", OleDbType.VarChar).Value = labelProblemDate.Text.Trim();cmd.Parameters[""@CallerName""].Value = name;cmd.ExecuteNonQuery(); conn.Close();",Return value from OleDbCommand
ImageList: 32-bit Images loose quality," I'm using ImageList for TreeView and ListView. I've first set the image quality to 32 bit and then added images which are semi-transparent. The quality looks OK, but after a couple of minutes coding, compiling and executing the application, the quality looks bad.See screenshot: Used properties There are black pixels behind pixels which were semi-transparent but not fully transparent.Re-adding all images restores the original quality, but after a couple of minutes, it looks like on the right side of the screenshot. <code>  ColorDepth: Depth32BitImageSize: 16; 16TransparentColor: Transparent",ImageList: 32-bit Images lose quality
If file exsist or not, I need to get my code to read if file doesnt exist create else append. Right now it is reading if it does exist create and append. Here is the code: Would I do this? Edit: } <code>  if (File.Exists(path)){ using (StreamWriter sw = File.CreateText(path)) { if (! File.Exists(path)){ using (StreamWriter sw = File.CreateText(path)) { string path = txtFilePath.Text;if (!File.Exists(path)){ using (StreamWriter sw = File.CreateText(path)) { foreach (var line in employeeList.Items) { sw.WriteLine(((Employee)line).FirstName); sw.WriteLine(((Employee)line).LastName); sw.WriteLine(((Employee)line).JobTitle); } }}else{ StreamWriter sw = File.AppendText(path); foreach (var line in employeeList.Items) { sw.WriteLine(((Employee)line).FirstName); sw.WriteLine(((Employee)line).LastName); sw.WriteLine(((Employee)line).JobTitle); } sw.Close();},Create File If File Does Not Exist
Unambiguously resolving MethodInfo of requested action method," I'm trying to peek at any authentication attributes which may be decorating action methods in my controllers in an MVC 3 application. I'm doing this in my own HtmlHelper extension methods which are basically wrappers to ActionLink (to give you the context of what information I have available at runtime). I have a basic solution in place, but overloaded methods have just made it explode. I know that the framework is internally resolving urls to action methods, but after looking through the code for System.Web.Mvc.LinkExtensions, I still haven't found precisely how that is happening, so I'm a bit stuck as to how to tackle this issue.Here's the code I have so far for resolving the relevant method: So my current problem is that when a method is overridden, I get ""ambiguous match found"" exceptions. I'm guessing I need to process the RouteValues to resolve any parameters to the method so I can unambiguously identify the right one. Does anyone have some pointers on how to do this? Alternately, does the framework already provide a means of resolving the exact method needed?Thanks so much! <code>  private static bool _IsUserAuthorized(HtmlHelper html, string controllerName, string actionName){ controllerName = controllerName ?? html.ViewContext.RouteData.GetRequiredString(""controller""); var factory = ControllerBuilder.Current.GetControllerFactory(); var controller = factory.CreateController( html.ViewContext.RequestContext, controllerName); Type controllerType = controller.GetType(); var methodInfo = controllerType.GetMethod(actionName, BindingFlags.IgnoreCase | BindingFlags.Public | BindingFlags.Instance); ... check authentication}",How to retrieve attributes of requested Action Method
"Easiest way to read 2-channel samples into array from WaveStream (NAudio, C#)"," I've been struggling with this for quite some time now and I couldn't find a working solution.I have a wav file (16 bit PCM: 44kHz 2 channels) and I want to extract samples into two arrays for each of the two channels. As far as I know the direct method for this does not exist in NAudio library, so I tried to run the following code to read a few of interlaced samples but the buffer array stays empty (just a bunch of zeros): Any help on this will be much appreciated. <code>  using (WaveFileReader pcm = new WaveFileReader(@""file.wav"")){ byte[] buffer = new byte[10000]; using (WaveStream aligned = new BlockAlignReductionStream(pcm)) { aligned.Read(buffer, 0, 10000); }}",Easiest way to read 2-channel samples into array from WaveStream
C# - count leading zeroes in an Int32," How do I count the leading zeroes in an Int32? So what I want to do is write a function which returns 30 if my input is 2, because in binary I have 000...0000000000010. <code> ",Count leading zeroes in an Int32
Problems reading oracle database," I've just installed an Oracle express database and am trying to read some data from a table I've put in there: On the while (reader.Read()) it just quits since the reader does not hold any data. What is wrong? Connectionstring? I've run the same SELECT in the commandprompt tool that is installed with Oracle express and it works fine. <code>  using (OracleConnection conn = new OracleConnection(""Data Source=localhost:1521/xe;Persist Security Info=True;User ID=SYSTEM;Password=SYSTEMPASSWORD"")){ OracleCommand command = new OracleCommand(""SELECT * FROM Persons WHERE Firstname = 'John'"", conn); conn.Open(); OracleDataReader reader = command.ExecuteReader(); try { while (reader.Read()) { string strResult = reader.GetString(0); } } catch (OracleException oex) { MessageBox.Show(oex.Message, ""Oracle error""); } catch (Exception ex) { MessageBox.Show(ex.Message, ""Error""); } finally { reader.Close(); }} ",Problems reading from Oracle
Create .mdf/.sdf file dynamically," How can I with ""code"" create a new .mdf/.sdf database?I've tried this:http://support.microsoft.com/kb/307283All it does is fail on the ConnectionString. Since I have no connection to a file that exists before I create it, how can I only connect to the SQL Express Server just to create a mdf/sdf database?I want to be able to just connect to the server and create the file, from there it probably will be easier to create the tables and such.Any suggestions? <code> ",Create .mdf/.sdf database dynamically
Linq insert: nullable object must have a value?, On the line: bool travel = fill.travel.Value; I am getting the following error: Nullable object must have a valueand i am not sure why. All I want to do is get the value in the database of travel which is currently false. Any help would be appreciated.  <code>  using (var db = new DataClasses1DataContext()){ var fill = (from f in db.expenseHdrs where f.rptNo == getPkRowReport() select f).FirstOrDefault(); txtReportDesc.Text = fill.description; txtPeriod.Text = fill.period; txtPurpose.Text = fill.purpose; bool travel = fill.travel.Value; chkTravel.Checked = travel },Nullable object must have a value?
How to Convert string to byte in C#," How can I convert this string into a byte? I tried this code, (byte)(a); but it said: Cannot convert type string to byte...And when I tried this code, Convert.ToByte(a); and this byte.Parse(a);, it said: Input string was not in a correct format...What is the proper code for this?But when I am declaring it for example in an array, it is acceptable...For example: <code>  string a = ""0x2B""; byte[] d = new byte[1] = {0x2a};",How do I convert a Hexidecimal string to byte in C#?
How do I convert a string to byte in C#?," How can I convert this string into a byte? I tried this code, (byte)(a); but it said: Cannot convert type string to byte...And when I tried this code, Convert.ToByte(a); and this byte.Parse(a);, it said: Input string was not in a correct format...What is the proper code for this?But when I am declaring it for example in an array, it is acceptable...For example: <code>  string a = ""0x2B""; byte[] d = new byte[1] = {0x2a};",How do I convert a Hexidecimal string to byte in C#?
How to select specfic column in LINQ?," I have to select specific column from my DataTable using linqI am using this code ~But it is giving me all columns and I need only PRODUCTNAME , DESCRIPTION , PRICEHow I can write this query? <code>  ds.Table[0].AsEnumerable().Where<DataRow>(r=>r.Field<int>(""productID"")==23).CopyToDataTable();",How to select specific column in LINQ?
Setting the Style property of a WPF Label in code? C#," In App.xaml, I have the following code: This is meant to provide a generic template for my labels.In the main XAML code, I have the following line of code: However, I'd like to initialize the Style property through code. I have tried: and Neither solution was valid. Any help would be appreciated :). <code>  <Application.Resources> <Style x:Key=""LabelTemplate"" TargetType=""{x:Type Label}""> <Setter Property=""Height"" Value=""53"" /> <Setter Property=""Width"" Value=""130"" /> <Setter Property=""HorizontalAlignment"" Value=""Left"" /> <Setter Property=""Margin"" Value=""99,71,0,0"" /> <Setter Property=""VerticalAlignment"" Value= ""Top"" /> <Setter Property=""Foreground"" Value=""#FFE75959"" /> <Setter Property=""FontFamily"" Value=""Calibri"" /> <Setter Property=""FontSize"" Value=""40"" /> </Style></Application.Resources> <Label Content=""Movies"" Style=""{StaticResource LabelTemplate}"" Name=""label1"" /> label1.Style = new Style(""{StaticResource LabelTemplate}""); label1.Style = ""{StaticResource LabelTemplate}"";",Setting the Style property of a WPF Label in code?
C#: circular enumeration of IEnumerable," There is the command hierarchy in my current application. So, some commands are stateful, some are not.I need to enumerate IEnumerable in the circular way for some command implementation during command execution. Execute is called from time to time, so it is necessary to store the iteration state.How to implement that circular enumeration?I have found two solutions:Using the IEnumerator<T> interface.It looks like: Using the circular IEnumerable<T> (yield forever the same sequence): Implementing A Circular Iterator - HonestIllusion.Com.Maybe, there are more ways to achieve it.What would you recommend to use and why? <code>  public interface ICommand{ void Execute();} public class GetNumberCommand : ICommand{ public GetNumberCommand() { List<int> numbers = new List<int> { 1, 2, 3 }; } public void Execute() { // Circular iteration here. // 1 => 2 => 3 => 1 => 2 => 3 => ... } public void Stop() { // Log current value. (2 for example) }} if (!_enumerator.MoveNext()) { _enumerator.Reset(); _enumerator.MoveNext(); }",C#: Circular enumeration of IEnumerable<T>
Best practice for building file paths," I'm working on a C# project where I must build paths to various files and folders. These are all under one root folder which I have specified in my Web.config file.For example:""start with: ""D:\builds\"" from my Web.configPass to GetRelativePath() to get ""D:\builds\5.2\5.2.9751""Then pass to GetAutoSuitePath() to get ""D:\builds\5.2\5.2.9751\AutoSuite\""Then pass to ParseBrLog which will read ""D:\builds\5.2\5.2.9751\AutoSuite\AASanity.csv""My paths are correct, but I just want to know what the best practice is for incomplete paths. Should I add a ""\"" to the end of every folder (""D:\Builds\5.2\"" + ""test.txt""), or add one to the start of every folder/file I add to the path (""D:\Builds"" + ""\5.2"" + ""\test.txt"")? Currently, I'm, doing it both ways, and want to choose one uniform way of doing it. <code> ",Best practice for building file paths in C#
C# : difference between two dispose implementation?," Is there a difference between these two implementations?1 : 2 : The first one seems to be more correct than the second in regards to memory leaks. But is it really correct? <code>  public class SMSManager : ManagerBase{ private EventHandler<SheetButtonClickEventArgs> _buttonClickevent; public SMSManager(DataBlock smsDataBlock, DataBlock telephonesDataBlock) : base(smsDataBlock) { _buttonClickevent = new EventHandler<SheetButtonClickEventArgs>(OnButtonClick); SheetEvents.ButtonClick += _buttonClickevent; } public override void Dispose() { base.Dispose(); if (_buttonClickevent != null) SheetEvents.ButtonClick -= _buttonClickevent; }} public class SMSManager : ManagerBase{ public SMSManager(DataBlock smsDataBlock, DataBlock telephonesDataBlock) : base(smsDataBlock) { SheetEvents.ButtonClick += new EventHandler<SheetButtonClickEventArgs>(OnButtonClick); } public override void Dispose() { base.Dispose(); SheetEvents.ButtonClick -= new EventHandler<SheetButtonClickEventArgs>(OnButtonClick); }}",Difference between two dispose implementations?
C# : don't understand delegate and event," Delegate : I understand. But when I move to event, many things I don't understand so much. I read book, MSDN and some simple examples on Network, they both have same structures. For example, here is the link : Event Example I take the first example, that the author said it's the most easiest example about C# Event.Here is his code : You can notice line: public event TickHandler Tick. When I change to public TickHandler Tick, program still run the same. But new line I understand because it's just a pure delegate. So, my question is : what is the real purpose of event keyword in line : public event TickHandler Tick. This is very important, because all examples always use like this, but I cannot explain why.Thanks :) <code>  public class Metronome{ public event TickHandler Tick; public EventArgs e = null; public delegate void TickHandler(Metronome m, EventArgs e); public void Start() { while (true) { System.Threading.Thread.Sleep(3000); if (Tick != null) { Tick(this, e); } } }}public class Listener{ public void Subscribe(Metronome m) { m.Tick += new Metronome.TickHandler(HeardIt); } private void HeardIt(Metronome m, EventArgs e) { System.Console.WriteLine(""HEARD IT""); }}class Test{ static void Main() { Metronome m = new Metronome(); Listener l = new Listener(); l.Subscribe(m); m.Start(); }}",I don't understand the difference between pure delegate and event fields
Don't understand delegate and event," Delegate : I understand. But when I move to event, many things I don't understand so much. I read book, MSDN and some simple examples on Network, they both have same structures. For example, here is the link : Event Example I take the first example, that the author said it's the most easiest example about C# Event.Here is his code : You can notice line: public event TickHandler Tick. When I change to public TickHandler Tick, program still run the same. But new line I understand because it's just a pure delegate. So, my question is : what is the real purpose of event keyword in line : public event TickHandler Tick. This is very important, because all examples always use like this, but I cannot explain why.Thanks :) <code>  public class Metronome{ public event TickHandler Tick; public EventArgs e = null; public delegate void TickHandler(Metronome m, EventArgs e); public void Start() { while (true) { System.Threading.Thread.Sleep(3000); if (Tick != null) { Tick(this, e); } } }}public class Listener{ public void Subscribe(Metronome m) { m.Tick += new Metronome.TickHandler(HeardIt); } private void HeardIt(Metronome m, EventArgs e) { System.Console.WriteLine(""HEARD IT""); }}class Test{ static void Main() { Metronome m = new Metronome(); Listener l = new Listener(); l.Subscribe(m); m.Start(); }}",I don't understand the difference between pure delegate and event fields
Don't understand delegate and event," Delegate : I understand. But when I move to event, many things I don't understand so much. I read book, MSDN and some simple examples on Network, they both have same structures. For example, here is the link : Event Example I take the first example, that the author said it's the most easiest example about C# Event.Here is his code : You can notice line: public event TickHandler Tick. When I change to public TickHandler Tick, program still run the same. But new line I understand because it's just a pure delegate. So, my question is : what is the real purpose of event keyword in line : public event TickHandler Tick. This is very important, because all examples always use like this, but I cannot explain why.Thanks :) <code>  public class Metronome{ public event TickHandler Tick; public EventArgs e = null; public delegate void TickHandler(Metronome m, EventArgs e); public void Start() { while (true) { System.Threading.Thread.Sleep(3000); if (Tick != null) { Tick(this, e); } } }}public class Listener{ public void Subscribe(Metronome m) { m.Tick += new Metronome.TickHandler(HeardIt); } private void HeardIt(Metronome m, EventArgs e) { System.Console.WriteLine(""HEARD IT""); }}class Test{ static void Main() { Metronome m = new Metronome(); Listener l = new Listener(); l.Subscribe(m); m.Start(); }}",I don't understand the difference between pure delegate and event fields
Build certificate chain in BouncyCastle," I have a bunch of root and intermediate certificates given as byte arrays, and I also have end user certificate. I want to build a certificate chain for given end user certificate. In .NET framework I can do it like this: How to do it in BouncyCastle? I tried with code below but I get PkixCertPathBuilderException: No certificate found matching targetContraints: Edit: I added the line that fixed my problem. It's commented with all caps. Case closed. <code>  using System.Security.Cryptography.X509Certificates;static IEnumerable<X509ChainElement> BuildCertificateChain(byte[] primaryCertificate, IEnumerable<byte[]> additionalCertificates){ X509Chain chain = new X509Chain(); foreach (var cert in additionalCertificates.Select(x => new X509Certificate2(x))) { chain.ChainPolicy.ExtraStore.Add(cert); } // You can alter how the chain is built/validated. chain.ChainPolicy.RevocationMode = X509RevocationMode.NoCheck; chain.ChainPolicy.VerificationFlags = X509VerificationFlags.IgnoreWrongUsage; // Do the preliminary validation. var primaryCert = new X509Certificate2(primaryCertificate); if (!chain.Build(primaryCert)) throw new Exception(""Unable to build certificate chain""); return chain.ChainElements.Cast<X509ChainElement>();} using Org.BouncyCastle;using Org.BouncyCastle.Pkix;using Org.BouncyCastle.Utilities.Collections;using Org.BouncyCastle.X509;using Org.BouncyCastle.X509.Store;static IEnumerable<X509Certificate> BuildCertificateChainBC(byte[] primary, IEnumerable<byte[]> additional){ X509CertificateParser parser = new X509CertificateParser(); PkixCertPathBuilder builder = new PkixCertPathBuilder(); // Separate root from itermediate List<X509Certificate> intermediateCerts = new List<X509Certificate>(); HashSet rootCerts = new HashSet(); foreach (byte[] cert in additional) { X509Certificate x509Cert = parser.ReadCertificate(cert); // Separate root and subordinate certificates if (x509Cert.IssuerDN.Equivalent(x509Cert.SubjectDN)) rootCerts.Add(new TrustAnchor(x509Cert, null)); else intermediateCerts.Add(x509Cert); } // Create chain for this certificate X509CertStoreSelector holder = new X509CertStoreSelector(); holder.Certificate = parser.ReadCertificate(primary); // WITHOUT THIS LINE BUILDER CANNOT BEGIN BUILDING THE CHAIN intermediateCerts.Add(holder.Certificate); PkixBuilderParameters builderParams = new PkixBuilderParameters(rootCerts, holder); builderParams.IsRevocationEnabled = false; X509CollectionStoreParameters intermediateStoreParameters = new X509CollectionStoreParameters(intermediateCerts); builderParams.AddStore(X509StoreFactory.Create( ""Certificate/Collection"", intermediateStoreParameters)); PkixCertPathBuilderResult result = builder.Build(builderParams); return result.CertPath.Certificates.Cast<X509Certificate>();}",Build certificate chain in BouncyCastle in C#
Copying byte array with Marshal.Copy from IntPtr using C# does'nt work," I'm using an unmanaged library, which generates grayscale images (about 100x200 pixels, more or less). An image is contained within a struct, which looks like this in C: And here my C# wrapper struct: Grabbing the image and marshallign the ABS_IMAGE struct works just fine. In a previous version, I tried using a byte array with fixed length for ImageData, which crashed sometimes. This happened, I think, because the image size is not fix.Now I try to read the image byte array at later time, when I can calulate the real array length before. Here the relevant code: Now my problem: Every time I want to execute Marshal.Copy to read the image bytes, I get an AccessViolationException.Does anyone have an idea? <code>  typedef struct abs_image { ABS_DWORD Width; ABS_DWORD Height; ABS_DWORD ColorCount; ABS_DWORD HorizontalDPI; ABS_DWORD VerticalDPI; ABS_BYTE ImageData[ABS_VARLEN];} ABS_IMAGE typedef unsigned int ABS_DWORD;typedef unsigned char ABS_BYTE; [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)]public struct ABS_IMAGE { public uint Width; public uint Height; public uint ColorCount; public uint HorizontalDPI; public uint VerticalDPI; public IntPtr ImageData;} ABS_Type_Defs.ABS_IMAGE img = (ABS_Type_Defs.ABS_IMAGE)Marshal.PtrToStructure( pImage, typeof(ABS_Type_Defs.ABS_IMAGE));int length = ((int)img.Height - 1) * ((int)img.Width - 1);byte[] data = new byte[length];Marshal.Copy(img.ImageData, data, 0, length);",Copying byte array with Marshal.Copy from IntPtr using C# doesn't work
what's wrong with this croos-domain ajax consuming wcf service?," I'm trying to understand why this ajax called doesn't work The service receive the data is correctly received and the response it's correct. Why am I doing wrong?I tried adding this property to the ajax called but without success crossDomain : true The error that i'm getting it's the common UPDATEI tried to add the header to the response by adding the configuracion in my App.config file but without success <code>  $.ajax({ type: 'GET', url: ""http://localhost:8732/Design_Time_Addresses/InMotionGIT_NT.Address.Service/AddressService/json/capitalize"", data: { streetAddress : JSON.stringify(streetAddress) , consumer : JSON.stringify(consumer)} , datatype: ""jsonp"", success: function (data) { $('body').append('<div>'+data.IDblah+' '+ data.prueba+'</div>'); alert(data.IDblah); } [OperationContract()][WebInvoke(Method=""GET"", RequestFormat=WebMessageFormat.Json, ResponseFormat=WebMessageFormat.Json)]public string Capitalize(StreetAddress streetAddress,ConsumerInformation consumer) XMLHttpRequest cannot load Origin http://localhost:50816 is not allowed by Access-Control-Allow-Origin. <system.webServer><httpProtocol> <customHeaders> <add name=""Access-Control-Allow-Origin"" value=""*"" /> </customHeaders></httpProtocol></system.webServer>",Could not add Access-Control-Allow-Origin to my WCF library Project
What's wrong with this cross-domain AJAX consuming WCF service?," I'm trying to understand why this ajax called doesn't work The service receive the data is correctly received and the response it's correct. Why am I doing wrong?I tried adding this property to the ajax called but without success crossDomain : true The error that i'm getting it's the common UPDATEI tried to add the header to the response by adding the configuracion in my App.config file but without success <code>  $.ajax({ type: 'GET', url: ""http://localhost:8732/Design_Time_Addresses/InMotionGIT_NT.Address.Service/AddressService/json/capitalize"", data: { streetAddress : JSON.stringify(streetAddress) , consumer : JSON.stringify(consumer)} , datatype: ""jsonp"", success: function (data) { $('body').append('<div>'+data.IDblah+' '+ data.prueba+'</div>'); alert(data.IDblah); } [OperationContract()][WebInvoke(Method=""GET"", RequestFormat=WebMessageFormat.Json, ResponseFormat=WebMessageFormat.Json)]public string Capitalize(StreetAddress streetAddress,ConsumerInformation consumer) XMLHttpRequest cannot load Origin http://localhost:50816 is not allowed by Access-Control-Allow-Origin. <system.webServer><httpProtocol> <customHeaders> <add name=""Access-Control-Allow-Origin"" value=""*"" /> </customHeaders></httpProtocol></system.webServer>",Could not add Access-Control-Allow-Origin to my WCF library Project
what is unit of work pattren in EF?," I am learning EF and have seen many examples, and during my learning I came to know about using repository and unit of work patterns. I got why to use repository but I do not have understanding of unit of work really is.Having no understanding is making DAL understanding difficult. Kindly guide me.Thanks <code> ",What is the unit of work pattern in EF?
asp.net c# - retrieving single value from query," I'm attempting to retrieve an integer value from a single table, based on the string field username. I've tried it using a stored proc, and direct text. When I execute the stored proc, I get the proper return value; however, the proper result doesn't come through.Here are both sets of code - Direct text - SQL query: <code>  public int GetUserRole(string CUSER){ try { SQLCON = new SqlConnection(connectionString); SQLCON.Open(); SQLCommand = new SqlCommand(); SQLCommand.CommandType = CommandType.Text; SQLCommand.Parameters.Add(""USUsername"", SqlDbType.VarChar).Value = CUSER; SQLCommand.CommandText = ""SELECT USRole FROM tblUser WHERE USUsername = CUSER""; Int32 USRole = (Int32) SQLCommand.ExecuteScalar(); return USRole; } catch { HttpContext.Current.Response.Redirect(""~/ErrorRedirect.aspx"", false); return 0; }} ALTER PROCEDURE [dbo].[spGetUserRole]-- Add the parameters for the stored procedure here @username VARCHAR(50)ASBEGIN-- Declare the return variable hereDECLARE @USRole as int-- Add the T-SQL statements to compute the return value hereSELECT @USRole = tblUser.USRole FROM tblUser WHERE USUsername = @username-- Return the result of the functionRETURN @USRole END",Retrieving single value from query
Is there a benefit/drawback when one constructor implements another?," If I have a class like this: At some stage I re-factor the class and add a secondary constructor which implements the first one like this: I could have also written it similar to this: Seeing both approaches work in this scenario, is there a benefit or drawback in using one over the other? Is inheriting constrcutors more efficient and making that code execute faster or is there a drawback which I don't know about making the second implementation more efficient instead? <code>  public class Foo{ public IEnumerable<Bar> Bars { get; set; } public Foo() { Bars = new List<Bar>(); }} public class Foo{ public IEnumerable<Bar> Bars { get; set; } // some more properties were added public Foo() { Bars = new List<Bar>(); } public Foo(string parameter): this() { .... some code here }} public class Foo{ public IEnumerable<Bar> Bars { get; set; } // some more properties were added too public Foo() { InitilizeFoo(); } public Foo(string parameter) { InitilizeFoo(); .... some code here } private void InitializeFoo() { Bars = new List<Bar>(); }}",Is there a benefit or drawback when one constructor implements another?
ASP.NET MVC4 Web Api - Passing querystring parameters without using OData conventions?," Is there a way to pass querystring parameters to an ASP.NET MVC4 Web Api controller without using the OData conventions outlined here? http://www.asp.net/web-api/overview/web-api-routing-and-actions/paging-and-queryingI have some repository methods built using Dapper that don't support IQueryable and want to be able to manually paginate them without using the OData conventions, but whenever I try doing it the traditional ASP.NET way I get ""route not found"" errors.For instance, here's a route: And here's the signature to match And whenever I pass the following query: http://localhost/api/v1/category/1?offset=10 I get the following error: No action was found on the controller 'Category' that matches the request.Any suggestions on how to work with querystrings sanely in ASP.NET MVC4 Web Api? <code>  context.Routes.MapHttpRoute( name: ""APIv1_api_pagination"", routeTemplate: ""api/v1/{controller}/{id}"", defaults: new { area = AreaName, controller = ""category"", offset = 0, count = 100}); public class CategoryController : ApiController{ // GET /api/<controller> public HttpResponseMessage Get(int id, int offset = 0, int count = 0)",Passing querystring parameters without using OData conventions?
How to Shedule a task in windows azure worker role," I have a simple Azure Worker role running that performs a task every day at 12 PM. Below is the code that accomplishes this. Here DoSomethingElse() is a method to send an email at every day 12 PM, and also fires once and only once per day.How can I implement a scheduler that fire when the time is 12PM and execute DoSomethingElse().My question is: Is this (above code) is the best method or use any 3rd party tool.  <code>  public override void Run(){ try { while (true) { int time = Convert.ToInt32(DateTime.Now.TimeOfDay); if (time == 12) { DoSomethingElse(); } } } catch (Exception ex) { Log.Add(ex, true); } }",How to Schedule a task in windows azure worker role
How to Schedule a task in windows azure worker role," I have a simple Azure Worker role running that performs a task every day at 12 PM. Below is the code that accomplishes this. Here DoSomethingElse() is a method to send an email at every day 12 PM, and also fires once and only once per day.How can I implement a scheduler that fire when the time is 12PM and execute DoSomethingElse().My question is: Is this (above code) is the best method or use any 3rd party tool.  <code>  public override void Run(){ try { while (true) { int time = Convert.ToInt32(DateTime.Now.TimeOfDay); if (time == 12) { DoSomethingElse(); } } } catch (Exception ex) { Log.Add(ex, true); } }",How to Schedule a task in windows azure worker role
Accessing javascript array from C#," Using WebBrowser on a Form and calling into C# from Javascript with window.external. Passing in a Javascript array of classes in the function: I can successfully get x.length in C# with: My question is how do I get x[0] and x[1]?I've tried and both of which fire off errors within the WebBrowser control.Thanks <code>  var x = [];x.push(classa);x.push(classa);window.external.CSharpFunction(x); int length=(int)x.GetType().InvokeMember(""length"", BindingFlags.GetProperty, null, x, null); x.GetType().InvokeMember(string.Empty, BindingFlags.GetProperty, null, x, new object[1]{1}); x.GetType().InvokeMember(string.Empty, BindingFlags.InvokeMethod | BindingFlags.Default, null, x, new object[1]{0});",Access JavaScript array elements from C# (via WebBrowser)?
How to assign out parameter in function?," I have a method that returns an object and also has an out parameter. The method calls another method that takes in the same out paramter as another out paramter. This gives a build error on the return statement: The out parameter 'param1' must be assigned to before control leaves the current methodThe code looks like: param2 is manipulated in SubMethod(), not in Method1(). Is there something else I need to do? <code>  public TypeA Method1(TypeA param1, out bool param2){ /... some logic here .../ SubMethod(out param2); /... some logic here .../ return param1;}","How to use ""out parameter"" as ""out parameter""?"
where will Debug.WriteLine in C# output to when build release," I put a lot of Debug.WriteLine in my code for debug purposes. When I am ready to build for release, will these Debug.Write influence the release build, and where do they output to? <code> ",Where will Debug.WriteLine in C# output to when build release?
CRYSTAL REPORTS ERROR IN SETDATASOURCE," I am having trouble in VS 2010 sap crystalreports, using c# to make a windows application.I get the following error with the following code:  <code>  CrystalReport1 cr1 = new CrystalReport1(); cr1.SetDataSource(dt1); //Error Could not load file or assembly 'file:///C:\Program Files (x86)\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Common\SAP BusinessObjects Enterprise XI 4.0\win64_x64\dotnet1\crdb_adoplus.dll' or one of its dependencies. The system cannot find the file specified.",Crystal reports error in SetDataSource
SimpleInjector calling commands from within another command Handle() method," Hi I am using the Simple Injector DI library and have been following some really interesting material about an architectural model designed around the command pattern:Meanwhile... on the command side of my architectureMeanwhile... on the query side of my architectureThe container will manage the lifetime of the UnitOfWork, and I am using commands to perform specific functions to the database.My question is if I have a command, for example an AddNewCustomerCommand, which in turn performs another call to another service (i.e. sends a text message), from a design standpoint is this acceptable or should this be done at a higher level and if so how best to do this?Example code is below: <code>  public class AddNewBusinessUnitHandler : ICommandHandler<AddBusinessUnitCommand>{ private IUnitOfWork uow; private ICommandHandler<OtherServiceCommand> otherHandler; AddNewBusinessUnitHandler(IUnitOfWork uow, ICommandHandler<OtherServiceCommand> otherHandler) { this.uow = uow; this.otherHandler = otherHandler; } public void Handle(AddBusinessUnitCommand command) { var businessUnit = new BusinessUnit() { Name = command.BusinessUnitName, Address = command.BusinessUnitAddress }; var otherCommand = new OtherServiceCommand() { welcomePostTo = command.BusinessUnitName }; uow.BusinessUnitRepository.Add(businessUnit); this.otherHandler.Handle(otherCommand); }}",Calling commands from within another command Handle() method
Implementing arithmetic in C# generics?," Is it possible to implement basic arithmetic (at least addition) in C# generics, like you can with C++ templates? I've been trying for a while to get them up and working, but C# doesn't let you declare the same generic type multiple times, like you can with templates.Extensive googling did not provide an answer.EDIT: Thanks, but what I'm looking for is a way to do the arithmetic at compile time, embedding something like Church numerals in generics types. That's why I linked the article that I did. Arithmetic in generic types, not arithmetic on instances of generic types. <code> ",Implementing arithmetic in generics?
SimpleInjector inject same UnitOfWork instance across services of the same graph," I have multiple services, each of which have a UnitOfWork injected into the constructor using the Simple Injector IoC container.Currently I can see each UnitOfWork instance is a separate object, this is bad as i am using Entity Framework and require the same context reference across all units of work.How can I ensure the same UnitOfWork instance is injected into all services per each resolve request? My UnitOfWor will be saved by an external command handler decorator after the command completes.Please note, this is a common library and will be used for both MVC and Windows Forms, it would be nice to have a generic solution for both platforms if possible.Code is below: The desired outcome of the below line is to create a object which has a shared UnitOfWork instance throughout the constructed object graph: Here are my services: <code>  // snippet of code that registers typesvoid RegisterTypes(){ // register general unit of work class for use by majority of service layers container.Register<IUnitOfWork, UnitOfWork>(); // provide a factory for singleton classes to create their own units of work // at will container.RegisterSingle<IUnitOfWorkFactory, UnitOfWorkFactory>(); // register logger container.RegisterSingle<ILogger, NLogForUnitOfWork>(); // register all generic command handlers container.RegisterManyForOpenGeneric(typeof(ICommandHandler<>), AppDomain.CurrentDomain.GetAssemblies()); container.RegisterDecorator(typeof(ICommandHandler<>), typeof(TransactionCommandHandlerDecorator<>)); // register services that will be used by command handlers container.Register<ISynchronisationService, SynchronisationService>(); container.Register<IPluginManagerService, PluginManagerService>();} var handler = Resolve<ICommandHandler<SyncExternalDataCommand>>(); public class PluginManagerService : IPluginSettingsService{ public PluginManagerService(IUnitOfWork unitOfWork) { this.unitOfWork = unitOfWork; } private readonly unitOfWork; void IPluginSettingsService.RegisterPlugins() { // manipulate the unit of work }}public class SynchronisationService : ISynchronisationService{ public PluginManagerService(IUnitOfWork unitOfWork) { this.unitOfWork = unitOfWork; } private readonly unitOfWork; void ISynchronisationService.SyncData() { // manipulate the unit of work }}public class SyncExternalDataCommandHandler : ICommandHandler<SyncExternalDataCommand>{ ILogger logger; ISynchronisationService synchronisationService; IPluginManagerService pluginManagerService; public SyncExternalDataCommandHandler( ISynchronisationService synchronisationService, IPluginManagerService pluginManagerService, ILogger logger) { this.synchronisationService = synchronisationService; this.pluginManagerService = pluginManagerService; this.logger = logger; } public void Handle(SyncExternalDataCommand command) { // here i will call both services functions, however as of now each // has a different UnitOfWork reference internally, we need them to // be common. this.synchronisationService.SyncData(); this.pluginManagerService.RegisterPlugins(); }}",Simple Injector: Inject same UnitOfWork instance across services of the same graph
Enumerate files sorted by its creation date," So I have this routine: and its working but ordering the files by its name and I need to order the files returned by its creation date. How can I sort by that if the item is an string like in the routine. I want to use Enumerate cause files are expected to be more than 1k.Thanks. <code>  public static IEnumerable<string> GetFiles( string path, string[] searchPatterns, SearchOption searchOption = SearchOption.TopDirectoryOnly) { return searchPatterns.AsParallel() .SelectMany(searchPattern => Directory.EnumerateFiles(path, searchPattern, searchOption)) .OrderBy<string, string>( (f) => f) .Distinct<string>();}",Order (and enumerate) directory listing by file creation date?
Enumerate files ordered by its creation date," So I have this routine: and its working but ordering the files by its name and I need to order the files returned by its creation date. How can I sort by that if the item is an string like in the routine. I want to use Enumerate cause files are expected to be more than 1k.Thanks. <code>  public static IEnumerable<string> GetFiles( string path, string[] searchPatterns, SearchOption searchOption = SearchOption.TopDirectoryOnly) { return searchPatterns.AsParallel() .SelectMany(searchPattern => Directory.EnumerateFiles(path, searchPattern, searchOption)) .OrderBy<string, string>( (f) => f) .Distinct<string>();}",Order (and enumerate) directory listing by file creation date?
Html Helpers asp.net mvc 4 razor," I have created HtmlHelper in ASP.NET MVC 4 razor view engine C#. Can I pass view model property to my helper class? For example, I have property Can I pass this property to my helper something like this @Html.Example(model => model.Lastname) and then get data annotations in helper (if this field is required what is display name and etc.)? <code>  [Required][Display(Name = ""Your Lastname"")]public string Lastname { get; set; }",Accessing attributes from Custom Html Helpers in asp.net mvc 4 razor
"Type or namespace definition, or end-of-file expected"," I've searched the internet, all previous answers said that a semicolon is missing. That's not the problem. What else can cause this error? In the third site, several people asked this question but this scenario is different. Error is > Type or namespace definition, or end-of-file expected  <code>  public partial class SeenSMS : System.Web.UI.UserControl { //temp sql connection //public SqlConnection mycon; SqlConnection mycon = new SqlConnection(@""Data Source=ASOFT20\MAMUT;Initial Catalog=ViltraNew;UserID=sa;Password=sa123""); protected void Page_Load(object sender, EventArgs e) { string[] msg_arr = Request.QueryString[""arr""].Split('|'); if (!IsPostBack) { string Moose = Request.QueryString[1]; } if (msg_arr != null) { if ((msg_arr.Length == 3) && (msg_arr[1].ToLower() == ""slett"")) { int Hours = Convert.ToInt32(msg_arr[2]); if (Hours > 0) { string username = msg_arr[0]; SqlCommand com = new SqlCommand(""SELECT count(*) as count FROM Animal Where Hours=@Hours"", mycon); com.Parameters.AddWithValue(""@Hours"",Hours); using (SqlDataReader reader = com.ExecuteReader()) { if(reader.HasRows) { while (reader.Read()) { // int number = Convert.ToInt32(con.ExecuteReader()); int number = Convert.ToInt32(reader[""count""]); } } else{ } } } // if( number == 0) // { // Response.Write(""Improper Plain Summaries.""); // } // else { } } } } public bool number { get; set; } public object Hours { get; set; }} // public System.Collections.Specialized.NameValueCollection Moose { get; set; } // public string Value { get; set; } // public object msg_arr { get; set; }} }","Error Message: Type or namespace definition, or end-of-file expected"
C#: Should I wrap calls to Debugger.Log() in #if (DEBUG)?," Is it necessary to wrap calls to Debugger.Log() in the #if (DEBUG) preprocessor directive for the purpose of code optimization, or will the C# compiler still produce optimized code when building the RELEASE configuration? <code> ",Should I wrap calls to Debugger.Log() in #if (DEBUG)?
c# waiting for a request to finish in c# 4.0, I have a http request in my asp.net 4.0 application. I would like for the thread to wait before it continues on.  <code>  HttpClient client = new HttpClient();HttpResponseMessage responseMsg = client.GetAsync(requesturl).Result;// I would like to wait till complete.responseMsg.EnsureSuccessStatusCode();Task<string> responseBody = responseMsg.Content.ReadAsStringAsync();,C#: Waiting for a request to finish in C# 4.5
C# Help: The invocation of the constructor on type that matches the specified binding constraints threw an exception," I'm trying to make a program that deletes columns in a DataSet that is filled by an excel file. The way it deletes columns is it compares the header in each column with the first element in each row and deletes the column of any string that does not appear in the rows. My problem is that I'm getting a weird error that I can't understand. it says: The invocation of the constructor on type 'Excel_Retriever.MainWindow' that matches the specified binding constraints threw an exception.' Line number '3' and line position '9'.I'm new to C# and XAML and would really appreciate any help with solving this error. Thank you! Here is my code:XAML: C#: <code>  <Window x:Class=""Excel_Retriever.MainWindow"" xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" Title=""MainWindow"" Height=""350"" Width=""525""> <Grid Name=""ExcelGrid""> <DataGrid ItemsSource=""{Binding}"" AutoGenerateColumns=""True"" Height=""289"" HorizontalAlignment=""Left"" Margin=""10,10,0,0"" Name=""dataGrid1"" VerticalAlignment=""Top"" Width=""481"" /> </Grid></Window> namespace Excel_Retriever{ public partial class MainWindow : Window { public MainWindow() { InitializeComponent(); DataSet excel = GetDataTableFromExcel(""C:\\Users\\Sweet Lou\\Desktop\\Adjusted research info.xlsx"", ""Research""); //dataGrid1.DataContext = excel.Tables[0]; DataSet ignoreds = Ignore_Names(excel); dataGrid1.DataContext = ignoreds.Tables[0]; } public DataSet GetDataTableFromExcel(string FilePath, string strTableName) { try { OleDbConnection con = new OleDbConnection(""Provider= Microsoft.ACE.OLEDB.12.0;Data Source="" + FilePath + ""; Extended Properties=\""Excel 12.0;HDR=YES;\""""); OleDbDataAdapter da = new OleDbDataAdapter(""select * from [Sheet1$]"", con); DataSet ds = new DataSet(); da.Fill(ds); return ds; } catch (Exception ex) { MessageBox.Show(ex.Message); } return null; } public DataSet Ignore_Names(DataSet sheet) { DataSet ignoreds = sheet; DataColumn columnNames = sheet.Tables[0].Columns[""Name""]; //first column with names //ignoreds.Tables[0].Columns.Add(columnNames); int j = 1; for (int i = 0; i < 15; i++) //change 15 to variable { while (String.Compare(columnNames.Table.Rows[i].ToString(), sheet.Tables[0].Columns[j].ColumnName, true) != 0) { ignoreds.Tables[0].Columns.RemoveAt(j); j++; } j++; } return ignoreds; } }}",The invocation of the constructor on type that matches the specified binding constraints threw an exception
Simulate Mouse Right Button Double Click for Shape, How I can handle the Mouse Right Button Double Click event for a Shape? <code> ,Handle Mouse Right Button Double Click for Shape
how to set the first 7 characters of a text box to Read-Only?, I have a form with a textbox on it that is used to enter a URL. I need to add (http://) as a predefined value to this textbox and want it to be read only so the user won't be able to remove the http:// but he can write after it. Any help would be highly appreciated. <code> ,How to set the first few characters of a WinForms TextBox to Read-Only?
How to set the first 7 characters of a text box to Read-Only?, I have a form with a textbox on it that is used to enter a URL. I need to add (http://) as a predefined value to this textbox and want it to be read only so the user won't be able to remove the http:// but he can write after it. Any help would be highly appreciated. <code> ,How to set the first few characters of a WinForms TextBox to Read-Only?
How to set the first 7 characters of a WinForms text box to Read-Only?, I have a form with a textbox on it that is used to enter a URL. I need to add (http://) as a predefined value to this textbox and want it to be read only so the user won't be able to remove the http:// but he can write after it. Any help would be highly appreciated. <code> ,How to set the first few characters of a WinForms TextBox to Read-Only?
How to set the first few characters of a WinForms text box to Read-Only?, I have a form with a textbox on it that is used to enter a URL. I need to add (http://) as a predefined value to this textbox and want it to be read only so the user won't be able to remove the http:// but he can write after it. Any help would be highly appreciated. <code> ,How to set the first few characters of a WinForms TextBox to Read-Only?
iTextSharp - set differnt font color same cell same row," I am using the iTextSharp.dll with the following code: Can we set different font colors for title and description, but only using single cell (ie without creating a new table)?Any help in this matter would be greatly appreciated. <code>  var Title = ""This is title"";var Description = ""This is description"";Innertable.AddCell(new PdfPCell(new Phrase(string.Format(""{0} {1}"", Title, Description.Trim()), listTextFont)) { BackgroundColor = new BaseColor(233, 244, 249), BorderWidth = 0, PaddingTop = 4, PaddingLeft = -240, PaddingBottom = 5, HorizontalAlignment = Element.ALIGN_LEFT });",iTextSharp - Is it possible to set a different font color for the same cell and row?
Natvie and managed destructors," I have a native object (C++) that has a gcroot pointer to a managed object (C#). QuestionWhen I delete a native instance of this class in native code delete(someNativeClass) that I previously allocated, will the managedClass instance get garbage collected or should I explicitly delete it (in the native destructor) as well? <code>  class SomeNativeClass { gcroot<SomeManagedClass ^> managedClass;};",Native and managed destructors
How to change z-order of Wpf AdornerLayer childern?," I have an image editing application, and I have custom adorners which get added to an AdornerLayer. When the user clicks on an Adorner, I want to bring it to top - meaning if it is dragged over another adorner, I want the first click to be caught by the topmost adorner.I can't figure out how to change the z-order of the child elements of the AdornerLayer. It doesn't seem to allow me to sort them. Even if I remove and re-add the Adorner, it doesn't get topmost.  <code> ",How to change z-order of Wpf AdornerLayer children?
I need to select particular column based on check box list in linq c#.net," I have a check box list in that user can check or uncheck the check box.Based on the selected check box I used to store that value by comma separated. Now the problem is based on selected check box I need to get that particular column alone. in ""select""** if i select in check box list ActualTime, Subject, it should be like if i select in check box list Subject, FileName, AssignedTo, it should be like the select will be dynamic based on selected check box list. <code>  db.Tasks.OrderBy(t => t.CreatedDate).ToList() .Select(t => new { Id = t.Id, PriorityId = t.ProjectId, Priority = t.Priority, StatusId = t.StatusId, Status = t.Status, EstimatedTime = t.EstimatedTime, ActualTime = t.ActualTime, Subject = t.Subject, FileName = t.FileName, AssignedTo = t.AssignedTo, Project = t.Project }).ToList(); db.Tasks.OrderBy(t => t.CreatedDate).ToList() .Select(t => new { Id = t.Id, ActualTime = t.ActualTime, Subject = t.Subject }).ToList(); db.Tasks.OrderBy(t => t.CreatedDate).ToList() .Select(t => new { Id = t.Id, Subject = t.Subject, FileName = t.FileName, AssignedTo = t.AssignedTo }).ToList();",I need to select particular column based on check box list
How To change name of certain element," I have some set of xml generated via xmlserialization of some WCF messages.Now I want to make a generic method in which I will provide an xml filename and a prefix like mailxml12.Then in xml file those elements that don't have any namespace prefix in their name should be replaced with mailxml12:Like source file is: After the desired method it should be changed into all element name which doesn't have prefix with mailxml:. Like DeliveryApptCreateRequest should become mailxml:DeliveryApptCreateRequestwhile element like d2p1:CompanyName should remain as it is.I have tried with following code only problem with it is that root element remain as it is while all are changed as i needed <code>  <DeliveryApptCreateRequest d2p1:ApptType=""Pallet"" d2p1:PickupOrDelivery=""Delivery"" d2p1:ShipperApptRequestID=""4490660303D5"" d2p1:SchedulerCRID=""234234"" xmlns:d2p1=""http://idealliance.org/Specs/mailxml12.0a/mailxml_defs"" xmlns=""http://idealliance.org/Specs/mailxml12.0a/mailxml_tm""><SubmittingParty d2p1:MailerID6=""123446"" d2p1:CRID=""342343"" d2p1:MaildatUserLicense=""A123"" /><SubmittingSoftware d2p1:SoftwareName=""asds"" d2p1:Vendor=""123"" d2p1:Version=""12"" /><SubmitterTrackingID>2CAD3F71B4405EB16392</SubmitterTrackingID><DestinationEntry>No</DestinationEntry><OneTimeAppt> <PreferredAppt>2012-06-29T09:00:00Z</PreferredAppt></OneTimeAppt> <TrailerInfo> <Trailer> <TrailerNumber>A</TrailerNumber> <TrailerLength>20ft</TrailerLength> </Trailer> <Carrier> <CarrierName>N/A</CarrierName> <URL>http://test.com</URL> </Carrier> <BillOfLadingNumber>N/A</BillOfLadingNumber></TrailerInfo> </DeliveryApptCreateRequest> private void RepalceFile(string xmlfile) { XmlDocument doc = new XmlDocument(); doc.Load(xmlfile); var a = doc.CreateAttribute(""xmlns:mailxml12tm""); a.Value = ""http://idealliance.org/Specs/mailxml12.0a/mailxml_tm""; doc.DocumentElement.Attributes.Append(a); doc.DocumentElement.Prefix = ""mailxml12tm""; foreach (XmlNode item in doc.SelectNodes(""//*"")) { if (item.Prefix.Length == 0) item.Prefix = ""mailxml12tm""; } doc.Save(xmlfile); }",How To change XML namespace of certain element
Linq To Entities Many to Many select, I have two tables Service and Provider. Between them is a joining table ServiceProvider which has only 2 fields - one for each of the two PKs. When added to the edmx the joining many-to-many table is abstracted away and can't be seen (as expected).This is all fine except when I want to get Providers based on a given service. From this question:it looks like the answer would be simply: but this returns ALL providers. What am I doing wrong here? <code>  var query = from p in entities.Providers from s in entities.Services where s.Id == 15 select p;,Many to Many select in LINQ to Entities
Many to Many select, I have two tables Service and Provider. Between them is a joining table ServiceProvider which has only 2 fields - one for each of the two PKs. When added to the edmx the joining many-to-many table is abstracted away and can't be seen (as expected).This is all fine except when I want to get Providers based on a given service. From this question:it looks like the answer would be simply: but this returns ALL providers. What am I doing wrong here? <code>  var query = from p in entities.Providers from s in entities.Services where s.Id == 15 select p;,Many to Many select in LINQ to Entities
Combo Box if statement c#," I am having a problem with a combo box here. What I did is made a combo box, added items using comboBox1.Items.Add(""Something"");. Now I made a text box down there and what I need is when I select something from the combo box the text box changes according to selected item on combo box. What I thought it would do is But it's not working for some reason, I tried both without ToString() and with still it is not working. <code>  if(comboBox1.SelectedItem.ToString() == ""Something""){ textBox1.Text = ""Something"";}",Combo Box if statement
Performance optimization," please help me to identify which of these following is more optimized code? OR In the first case, there happens to be an overhead of always checking the switch case condition in every iteration. In second case, the overhead is not there. I feel the second case is much better. If anyone has any other workaround, please help me out in suggesting it. <code>  for(int i=0;i<count;i++){ switch(way) { case 1: doWork1(i); break; case 2: doWork2(i); break; case 3: doWork3(i); break; }} switch(way){ case 1: for(int i=0;i<count;i++) { doWork1(i); } break; case 2: for(int i=0;i<count;i++) { doWork2(i); } break; case 3: for(int i=0;i<count;i++) { doWork3(i); } break;}",Performance optimization of for-loop / switch-statement
Best way to split an array," Afternoon,I need to split an array into smaller ""chunks"".I am passing over about 1200 items, and need to split these into easier to handle arrays of 100 items each, which I then need to process.Could anyone please make some suggestions? <code> ",How to split an array into chunks of specific size?
Convert this SQL Query into LINQ (OVER (PARTITION BY Date))," Here's the query I'm trying to convert into Linq: Thanks for any help.UPDATE: Here is the Linq code I'm trying it on; I cannot make the OVER PARTITION by Date. <code>  SELECT R.Code, R.FlightNumber, S.[Date], S.Station, R.Liters, SUM(R.Liters) OVER (PARTITION BY Year([Date]), Month([Date]), Day([Date])) AS Total_LitersFROM S INNER JOIN R ON S.ID = R.SIDWHERE (R.Code = 'AC')AND FlightNumber = '124'GROUP BY Station, Code, FlightNumber, [Date], LiterORDER BY R.FlightNumber, [Date] var test = (from record in ent.Records join ship in ent.Ship on record.ShipID equals ship.ID orderby ship.Stationwhere ship.Date > model.StartView && ship.Date < model.EndView && ship.Station == model.Station && record.FlightNumber == model.FlightNumbergroup record by new {ship.Station, record.Code, record.FlightNumber, ship.Date, record.AmountType1} into gselect new { g.Key.Station, g.Key.Code, g.Key.FlightNumber, g.Key.Date, AmmountType1Sum = g.Sum(record => record.AmountType1) });",How can I convert this SQL Query into LINQ (OVER (PARTITION BY Date))
windows phone - pressing multiple buttons at the same time," In my WP 7.1 app I have a page with multiple buttons.I noticed that while any one button is being pressed, no other button can be pressed. How can I overcome this? I need to be able to allow users to press multiple buttons at the same time. <code> ",Pressing multiple buttons simultaneously
Implementing async timer using poor mans async/await constructs in .Net 4.0," MotivationC# 5.0 async/await constructs are awesome, unfortunately yet Microsoft only shown a release candidate of both .NET 4.5 and VS 2012, and it will take some time until these technologies will get widely adopted in our projects.In Stephen Toub's Asynchronous methods, C# iterators, and Tasks I've found a replacement that can be nicely used in .NET 4.0. There are also a dozen of other implementations that make it possible using the approach even in .NET 2.0 though they seem little outdated and less feature-rich.ExampleSo now my .NET 4.0 code looks like (the commented sections show how it is done in .NET 4.5): Looks little ugly though it does the jobThe questionWhen using CancellationTokenSource in .NET 4.5 there is a constructor that takes timespan as a timeout parameter, so that resulting CancellationTokenSource cancels within specified period of time..Net 4.0 is not able to timeout, so what is the correct way of doing that in .Net 4.0? <code>  //private async Task ProcessMessageAsync()private IEnumerable<Task> ProcessMessageAsync(){ //var udpReceiveResult = await udpClient.ReceiveAsync(); var task = Task<UdpAsyncReceiveResult> .Factory .FromAsync(udpClient.BeginReceive, udpClient.EndReceive, null); yield return task; var udpReceiveResult = task.Result; //... blah blah blah if (message is BootstrapRequest) { var typedMessage = ((BootstrapRequest)(message)); // !!! .NET 4.0 has no overload for CancellationTokenSource that // !!! takes timeout parameter :( var cts = new CancellationTokenSource(BootstrapResponseTimeout); // Error here //... blah blah blah // Say(messageIPEndPoint, responseMessage, cts.Token); Task.Factory.Iterate(Say(messageIPEndPoint, responseMessage, cts.Token)); }}",Implementing async timeout using poor mans async/await constructs in .Net 4.0
How do you add a gridview programmatically to an updatepanel," I can't figure out how to programmatically add a GridView with buttons to an UpdatePanel.I can do it with simple controls such as buttons and labels, but when I try to add a GridView with buttons a full Postback() occurs. So how do you add a gridview with buttons programmatically to an UpdatePanel without causing a full PostBack() if the GridView is clicked?Edit: Other things I have tried <code>  <%@ Page Language=""C#"" %><!DOCTYPE html PUBLIC ""-//W3C//DTD XHTML 1.0 Transitional//EN"" ""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd""><script runat=""server"">protected override void OnInit(EventArgs e){UpdatePanel up1 = new UpdatePanel(); up1.ID = ""UpdatePanel1""; Button button1 = new Button(); button1.ID = ""Button1""; button1.Text = ""Submit""; button1.Click += new EventHandler(Button_Click); Label label1 = new Label(); label1.ID = ""Label1""; label1.Text = ""A full page postback occurred.""; GridView gv1 = new GridView(); //Where the xml gets bonded to the data grind XmlDataSource xds = new XmlDataSource(); xds.Data = xml; xds.DataBind(); xds.EnableCaching = false; gv1.DataSource = xds; createButton(gv1, up1); gv1.RowCommand += new GridViewCommandEventHandler(CustomersGridView_RowCommand); gv1.DataBind(); up1.ChildrenAsTriggers = true; up1.ContentTemplateContainer.Controls.Add(button1); up1.ContentTemplateContainer.Controls.Add(label1); up1.ContentTemplateContainer.Controls.Add(gv1); Page.Form.Controls.Add(up1);}protected void Page_Load(object sender, EventArgs e){}public void CustomersGridView_RowCommand(Object sender, GridViewCommandEventArgs e){ if (e.CommandName == ""buttonClicked"") { int index = Convert.ToInt32(e.CommandArgument); }}void createButton(GridView g){ ButtonField tea = new ButtonField(); tea.ButtonType = ButtonType.Image; tea.ImageUrl = ""~/checkdailyinventory.bmp""; tea.CommandName = ""buttonClicked""; tea.HeaderText = ""space""; g.Columns.Add(tea);}protected void Button_Click(object sender, EventArgs e){ ((Label)Page.FindControl(""Label1"")).Text = ""Panel refreshed at "" + DateTime.Now.ToString();}</script><html xmlns=""http://www.w3.org/1999/xhtml""><head id=""Head1"" runat=""server""><title>UpdatePanel Constructor Example</title></head><body> <form id=""form1"" runat=""server""> <div> <asp:Button ID=""Button2"" runat=""server"" Text=""Button"" /> <asp:ScriptManager ID=""ScriptManager1"" runat=""server"" /> </div> </form></body></html> void gv1_RowDataBound(object sender, GridViewRowEventArgs e){ AsyncPostBackTrigger t = new AsyncPostBackTrigger(); t.ControlID = e.Row.Cells[0].ClientID; t.EventName = ""blah""; up1.Triggers.Add(t);}",How do you add a Gridview programmatically to an UpdatePanel
how to get a random youtube video from the api, I need a way of getting a completely random YouTube video. No restriction.How can I do with with the YouTube API?** edit * OK as requested here is what i tried so far:1 - went through the api and examples at youtube dev site. http://www.youtube.com/dev/ no luck finding the correct api or a way of doing it there.2 - google search of course ;) got http://randomyoutubevideo.net/ but they only offer an api from THEM to use in between me and youtube. < this gives me hope that it IS actually possible to do this.3 - even checked the youtube app gallery http://youtube-gallery.appspot.com/ to see if anyone is doing it. and HOW.what i will also do is ask on the youtube discussion pages. perhaps someone there can help. <code> ,How do I get a random YouTube video with the YouTube API?
how to read a specific word of a string of words in a label field," I want to know how to refer to a word of a sentence in a label. For example, I have: I want to say: ""if label1.text contains the word ""pen"" then do something"": How do I do this? <code>  label1.text = ""books pencil pen ruler""; if (label1.text CONTAINS THE WORD ""pen""){ // do something}",Determining whether a sentence contains a specific word
How do I read a specific word of a string of words in a label field?," I want to know how to refer to a word of a sentence in a label. For example, I have: I want to say: ""if label1.text contains the word ""pen"" then do something"": How do I do this? <code>  label1.text = ""books pencil pen ruler""; if (label1.text CONTAINS THE WORD ""pen""){ // do something}",Determining whether a sentence contains a specific word
Overflow excpetion when reading decimal values from MS-SQL server," I'm wondering whether this is a bug or if I'm going something wrong.I'm loading values with a SqlDataReader from a SQL Server 2008 database but under certain circumstances, it fails to convert the SQL values into .net values. (.NET 4.0)I have traced it down to an test-case which demonstrates the actual problem:Working example: Not working exmaple: I have examined the actual values that the SQL Server retured. They differ that the non-working one uses 4 integers to express the value, the working one only 3.I did also check the source code with .net Reflector which unveiled that an exception is thrown if the value exists of more then 3 values, but I dont understand the mechanics behind them.So, I'm wondering whether this is a genuine bug in the .net framework. <code>  ""select convert(decimal(38, 19), 260000 ) as test""rs.GetValue(1);--> returns 260000 (decimal) ""select convert(decimal(36, 26), 260000 ) as test""rs.GetValue(1);--> throws System.OverflowException: Conversion overflows. at System.Data.SqlClient.SqlBuffer.get_Decimal() at System.Data.SqlClient.SqlBuffer.get_Value() at System.Data.SqlClient.SqlDataReader.GetValueInternal(Int32 i) at System.Data.SqlClient.SqlDataReader.GetValues(Object[] values)",Overflow exception when reading decimal values from SQL Server
Overflow exception when reading decimal values from MS-SQL server," I'm wondering whether this is a bug or if I'm going something wrong.I'm loading values with a SqlDataReader from a SQL Server 2008 database but under certain circumstances, it fails to convert the SQL values into .net values. (.NET 4.0)I have traced it down to an test-case which demonstrates the actual problem:Working example: Not working exmaple: I have examined the actual values that the SQL Server retured. They differ that the non-working one uses 4 integers to express the value, the working one only 3.I did also check the source code with .net Reflector which unveiled that an exception is thrown if the value exists of more then 3 values, but I dont understand the mechanics behind them.So, I'm wondering whether this is a genuine bug in the .net framework. <code>  ""select convert(decimal(38, 19), 260000 ) as test""rs.GetValue(1);--> returns 260000 (decimal) ""select convert(decimal(36, 26), 260000 ) as test""rs.GetValue(1);--> throws System.OverflowException: Conversion overflows. at System.Data.SqlClient.SqlBuffer.get_Decimal() at System.Data.SqlClient.SqlBuffer.get_Value() at System.Data.SqlClient.SqlDataReader.GetValueInternal(Int32 i) at System.Data.SqlClient.SqlDataReader.GetValues(Object[] values)",Overflow exception when reading decimal values from SQL Server
issues starting ASP.NET State Service," I get the following error when trying to start the ASP.NET State Service:Windows could not start the ASP.NET State Service service on Local Computer.Error 2: The system cannot find the file specified.Everything I found on google told me to go to the %windir%\Microsoft.NET\Framework\v1.1.4322 folder at the command prompt, and then type the following command: aspnet_regiis.exe -irwhich I did and didn't solve the problem. The path to the executable in my case is 2.0: C:\Windows\Microsoft.NET\Framework\v2.0.50727\aspnet_state.exe.So I tried the same comand on the v2 folder and I get the error:""An attempt was made to load a program with an incorrect format"".thanks in advace for any help <code> ",Error starting ASP.NET State Service
communication with the underlying transaction manager has failed," I am getting error: communication with the underlying transaction manager has failedwhen I am trying to run my application from visual studio 2010. I have search on google for this problem, I have tried all possible solutions to resolve this error.Here i have made change in my DTC properties. Please let me know, if anyone knows the solution for this problem.ThanksManoj Sitapara <code>  -- Network DTC Access-- Allow Inbound-- Allow Outbound-- Allow Remote Administrator-- Allow Remote Clients-- No Authentication Required-- Enable XA Transaction-- Enable SNA LU 6.2 Transaction",MSDTC - Communication with the underlying transaction manager has failed
Entity Framework code first many-to-many mapping table," From examples that I have seen online and in a Programming Entity Framework CodeFirst book, when you have a collection on both classes EF would create a mapping table such as MembersRecipes and the primary key from each class would link to this table.However when I do the below, I instead get a new field in the Recipes table called Member_Id and a Recipe_Id in the Members table.Which only creates two one-to-many relationships, but not a many-to-many so I could have Member 3 linked to Recipes (4,5,6) and Recipe 4 linked to Members (1,2,3) etc.Is there a way to create this mapping table? and if so how do you name it something else such as ""cookbooks"" ?Thanks UPDATE: Below is another approach I have tried which doesn't use the Fluent API and replaces the AuthorId & Author on Recipe with an owner flag, I have also renamed the below example from Cookbooks to MembersRecipes, this also fixes my issue similar to the answer but as mentioned has further implications. and in Recipe & Member classes I changed the collections to <code>  public abstract class Entity { [Required] public int Id { get; set; } } public class Member : Entity { [Required] public string Name { get; set; } public virtual IList<Recipe> Recipes { get; set; } } public class Recipe : Entity { [Required] public string Name { get; set; } [ForeignKey(""Author"")] public int AuthorId { get; set; } public virtual Member Author { get; set; } .... public virtual IList<Member> Members { get; set; } } public class MembersRecipes { [Key, Column(Order = 0)] [ForeignKey(""Recipe"")] public int RecipeId { get; set; } public virtual Recipe Recipe { get; set; } [Key, Column(Order = 1)] [ForeignKey(""Member"")] public int MemberId { get; set; } public virtual Member Member { get; set; } public bool Owner { get; set; }} public virtual IList<MembersRecipes> MembersRecipes { get; set; }",Many-to-many mapping table
C# SendKey.Send() Not working," I'm using WPF and I imported the System.Windows.Form reference. Here's my code: The Windows Media Player do Focus, but no keystroke is Received. Why? <code>  Process[] process = Process.GetProcessesByName(""wmplayer"");SetForegroundWindow(process[0].MainWindowHandle);Thread.Sleep(200);System.Windows.Forms.SendKeys.Send(""^p"");",SendKey.Send() Not working
WPF iamge swipe to change image like in iOS, Can anyone point me to some code samples on how I could implement a gallery like the one in iOS where you can swipe side to side to change the image when using a touchscreen monitor on Windows 7? <code> ,WPF image swipe to change image like in iOS
generic version of HttpResponseMessage gone from asp.net WebApi?," I just finished installing VS 2012 RC and have started working with the ASP.NET Web API. I am basing my work on some tutorials from PluralSight which I've been using as reference.In every tutorial and article which I've used, I notice that they are using a generic version of HttpResponseMessage in the return type of Action, but to my surprise this object was not available to me while coding. I thought perhaps the issue was just an incorrect namespace reference, but that does not seem to be the case.Can anyone point me toward some source code or reference material on how to utilize the generic HttpResponseMessage object that PluralSight uses in their videos? <code> ",Has the generic version of HttpResponseMessage been removed from the ASP.NET WebApi?
C# WPF DataBinding -- Show Enum Description Instead of Name," I had databinding set up like this: and it worked really well. Do to a change in the larger software design I can no longer have anything that generates an INotifyPropertyChanged Event so that type of databinding doesn't work. Instead I am manually setting the selectedIndex and building the options from code like this: which references That works as far as the building of the list options is concerned and the linking of all of my data, but I can't get the comboboxes to show the description tag in the enumeration instead of the actual text. I've tried something like this: but that wasn't correct. How would I go about doing this? EDIT:My Enum:  <code>  ItemsSource=""{Binding Source={my:Enumeration {x:Type credit:OccupationCategory}}}"" DisplayMemberPath=""Description"" SelectedValue=""{Binding EmplType}"" SelectedValuePath=""Value""/> ItemsSource=""{Binding Source={StaticResource ResidenceOwnershipType}}""/> <UserControl.Resources> <ObjectDataProvider x:Key=""ResidenceOwnershipType"" MethodName=""GetValues"" ObjectType=""{x:Type System:Enum}"" > <ObjectDataProvider.MethodParameters> <x:Type TypeName=""credit:ResidenceOwnershipType"" /> </ObjectDataProvider.MethodParameters> </ObjectDataProvider></UserControl.Resources> DisplayMemberPath=""Description"" [DataContract]public enum ResidenceOwnershipType{ [Description("""")] None = 0, [Description(""Owns Home Outright"")] OwnsHomeOutright = 1, [Description(""Buying Home"")] BuyingHome = 2, [Description(""Renting/Leasing"")] //Weird order here reflects RouteOne website RentingLeasing = 4, [Description(""Living w/Relatives"")] LivingWithRelatives = 3, [Description(""Owns/Buying Mobile Home"")] MobileHome = 5, [Description(""Unknown"")] Unknown = 6}",Show Enum Description Instead of Name
C# string.IndexOf with itself returning 1 instead of 0," We have recently upgraded all our projects from .NET 3.5 to .NET 4. I have come across a rather strange issue with respect to string.IndexOf().My code obviously does something slightly different, but in the process of investigating the issue, I found that calling IndexOf() on a string with itself returned 1 instead of 0.In other words: Gave me an index of 1, instead of 0. A couple of things to note about this problem:The problems seems related to these hyphens (the first character is the Unicode soft hyphen, the second is a regular hyphen).I have double checked, this does not happen in .NET 3.5 but does in .NET 4.Changing the IndexOf() to do an ordinal compare fixes the issue, so for some reason that first character is ignored with the default IndexOf.Does anyone know why this happens?EDITSorry guys, made a bit of a stuff up on the original post and got the hidden dash in there twice. I have updated the string, this should return index of 1 instead of 2, as long as you paste it in the correct editor.Update:Changed the original problem string to one where every actual character is clearly visible (using escaping). This simplifies the question a bit. <code>  string text = ""\xAD\x2D""; // problem happens with ""-dely N.China"", too;int index = text.IndexOf(text); // see update note below.",someString.IndexOf(someString) returns 1 instead of 0 under .NET 4
string.IndexOf with itself returning 1 instead of 0," We have recently upgraded all our projects from .NET 3.5 to .NET 4. I have come across a rather strange issue with respect to string.IndexOf().My code obviously does something slightly different, but in the process of investigating the issue, I found that calling IndexOf() on a string with itself returned 1 instead of 0.In other words: Gave me an index of 1, instead of 0. A couple of things to note about this problem:The problems seems related to these hyphens (the first character is the Unicode soft hyphen, the second is a regular hyphen).I have double checked, this does not happen in .NET 3.5 but does in .NET 4.Changing the IndexOf() to do an ordinal compare fixes the issue, so for some reason that first character is ignored with the default IndexOf.Does anyone know why this happens?EDITSorry guys, made a bit of a stuff up on the original post and got the hidden dash in there twice. I have updated the string, this should return index of 1 instead of 2, as long as you paste it in the correct editor.Update:Changed the original problem string to one where every actual character is clearly visible (using escaping). This simplifies the question a bit. <code>  string text = ""\xAD\x2D""; // problem happens with ""-dely N.China"", too;int index = text.IndexOf(text); // see update note below.",someString.IndexOf(someString) returns 1 instead of 0 under .NET 4
How to stop C# console applications of closing automatically?," My console applications on Visual Studio are closing automatically, therefore, I'd like to use something like C's system(""PAUSE"") to ""pause"" the applications at the end of their execution. How can I achieve that? <code> ",How to stop C# console applications from closing automatically?
Demystify events in C#," Basically this has been in my head for a while... and I'd like to read your opinionI read the great book from Jon Skeet called: C# in Depth, Second Edition and there's a recommendation to use something like this when declaring custom events: This declaration will release us from the nullity check statement before firing the event, so instead of this: We can simply call: And our code simply will work.When you declare events like this, the event will be initialized with an empty delegate so we do not have the need to check for null.This is another way to declare events, they are equivalent For more info: http://csharpindepth.com/Articles/Chapter2/Events.aspxI just had a discussion with some fellows, at work and we were discussing this topic, they were arguing that sometimes we would have the need to clear all the subscriptions for the event at once, we can simply do that assigning null to the delegate behind and if we want to keep using the same pattern we would have to re-initialize the event with an empty delegate. They were also asking what would happen in a multi-threading scenario, that's the main reason I placed this questionQuestionI would like to know if there are some hidden implications (perhaps when using multi-threading) when declaring events following this pattern vs checking for nullIf I use this patter I'm effectively removing several if conditions, which result removing jump statements. Wouldn't this be better in overall performance terms?Cheers <code>  public event Action<string> MyEvent = delegate { }; if (this.MyEvent != null) { this.MyEvent(""OMG osh""); } this.MyEvent(""OMG osh""); private Action<string> myDelegate;public event Action<string> MyEvent{ add { this.myDelegate += value; } remove { this.myDelegate -= value; }}",Initializeng events vs checking for null
Enitity FrameWork 4.1 is not adding any row to database SQLExpress .," Working with Entity Framework 4.1 with a SQL Server Express .mdf database .For test purpose I am trying to perform CRUD operations on SQL Server Express database using Entity Model in a WPF application .I am new to this concept, and I followed the video tutorial and done coding according that I created Entity model of single very simple table. And I wrote simple code in cs file to perform adding one row to the database using following code But if I go back check the database no data is added. Please tell me whats going wrong here ??And here is my connection String  <code>  testEntities db = new testEntities();TestTable tb = new TestTable();tb.Name = txtName.Text;tb.Email = txtMail.Text;db.TestTables.AddObject(tb);db.SaveChanges(); <?xml version=""1.0"" encoding=""utf-8""?><configuration> <connectionStrings> <add name=""testEntities"" connectionString=""metadata=res://*/DBModel.csdl|res://*/DBModel.ssdl|res://*/DBModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=.\SQLEXPRESS;attachdbfilename=|DataDirectory|\test.mdf;integrated security=True;connect timeout=30;user instance=True;multipleactiveresultsets=True;App=EntityFramework&quot;"" providerName=""System.Data.EntityClient"" /> </connectionStrings></configuration>",Entity Framework 4.1 is not adding any rows to SQL Server Express database 
Enitity Framework 4.1 is not adding any row to SQL Server Express database ," Working with Entity Framework 4.1 with a SQL Server Express .mdf database .For test purpose I am trying to perform CRUD operations on SQL Server Express database using Entity Model in a WPF application .I am new to this concept, and I followed the video tutorial and done coding according that I created Entity model of single very simple table. And I wrote simple code in cs file to perform adding one row to the database using following code But if I go back check the database no data is added. Please tell me whats going wrong here ??And here is my connection String  <code>  testEntities db = new testEntities();TestTable tb = new TestTable();tb.Name = txtName.Text;tb.Email = txtMail.Text;db.TestTables.AddObject(tb);db.SaveChanges(); <?xml version=""1.0"" encoding=""utf-8""?><configuration> <connectionStrings> <add name=""testEntities"" connectionString=""metadata=res://*/DBModel.csdl|res://*/DBModel.ssdl|res://*/DBModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=.\SQLEXPRESS;attachdbfilename=|DataDirectory|\test.mdf;integrated security=True;connect timeout=30;user instance=True;multipleactiveresultsets=True;App=EntityFramework&quot;"" providerName=""System.Data.EntityClient"" /> </connectionStrings></configuration>",Entity Framework 4.1 is not adding any rows to SQL Server Express database 
"DateTime in C# .net Framework 4.0, Visual Studio 2010 sp1"," I have this simple program: I debugged this and found aux2.AddDays(1); doesn't seem to work, what am I missing here?it should return 25 but the answer is one.What is the problem?also AddHours doesn't work, I guess that the others aren't working too. <code>  DateTime aux = new DateTime(2012, 6, 12, 12, 24, 0); DateTime aux2 = new DateTime(2012, 6, 12, 13, 24, 0); aux2.AddDays(1); Console.WriteLine((aux2 - aux).TotalHours.ToString()); Console.ReadLine();",DateTime.AddDays() not working as expected
PLINQ - Application hangs using PLINQ AsParallel(). No problems with LINQ," I'm new to LINQ and PLINQ, and I'm building a project to test them.Stub: StubCollection: then I have some methods to iterate the stubcollection and count how many stubs have the boolean set to true:foreach: it workslinq: it works (little slower than foreach)plinq: 100% CPU, no resultwhy? the only difference is the AsParallel() <code>  class Stub{ private Boolean mytf; public Stub() { Random generator = new Random(); if (generator.NextDouble() < 0.5) { mytf = false; } else mytf = true; } public Boolean tf { get { return mytf; } }} class StubCollection : IEnumerable{ Stub[] stubs; public StubCollection(int n) { stubs = new Stub[n]; for (int i = 0; i < n; i++) { stubs[i] = new Stub(); } } IEnumerator IEnumerable.GetEnumerator() { return new StubIterator(this); } public class StubIterator : IEnumerator { private StubCollection sc; private int index = -1; public StubIterator(StubCollection _sc) { sc = _sc; } public bool MoveNext() { index++; if (index < sc.stubs.Length) { return true; } else { index = -1; return false; } } public object Current { get { if (index <= -1) { throw new InvalidOperationException(); } return sc.stubs[index]; } } public void Reset() { index = -1; } }} Stopwatch sw = new Stopwatch();Int32 n = 0;sw.Start();foreach (Stub s in sc) if (s.tf) n++;sw.Stop();MessageBox.Show(""n:"" + n.ToString() + "" timer:"" + sw.ElapsedMilliseconds.ToString()); Stopwatch sw = new Stopwatch();Int32 n = 0;sw.Start();var trueStubs = from Stub s in sc where s.tf select s;n = trueStubs.Count();sw.Stop();MessageBox.Show(""n:"" + n.ToString() + "" timer:"" + sw.ElapsedMilliseconds.ToString()); Stopwatch sw = new Stopwatch();Int32 n = 0;sw.Start();var trueStubs = from Stub s in sc.AsParallel() where s.tf select s;n = trueStubs.Count();sw.Stop();MessageBox.Show(""n:"" + n.ToString() + "" timer:"" + sw.ElapsedMilliseconds.ToString());",Application hangs using PLINQ AsParallel(). No problems with LINQ
C# 5.0 async/await vs. Scala/Akka actors?," Both C# and Scala have adopted frameworks for simplifying doing asynchronous/parallel computation, but in different ways. The latest C# (5.0, still in beta) has decided on an async/await framework (using continuation-passing under the hood, but in an easier-to-use way), while Scala instead uses the concept of ""actors"", and has recently taken the actors implementation in Akka and incorporated it into the base library.Here's a task to consider: We receive a series of requests to do various operations -- e.g. from user input, requests to a server, etc. Some operations are fast, but some take awhile. For the slow ones, we'd like to asynchronously do the operation (in another thread) and process it when the thread is done, while still being free to process new requests.A simple synchronous loop might be (pseudo-code): In a basic fork/join framework, you might do something like this (pseudo-code): How would this look expressed using async/await and using actors, and more generally what are the advantages/disadvantages of these approach? <code>  while (1) { val request = waitForAnything(user_request, server_request) val result = do_request(request) if (result needs to be sent back) send_back_result(result)} val threads: Set[Thread]while (1) { val request = waitForAnything(user_request, server_request, termination of thread) if (request is thread_terminate) { threads.delete(request.terminated_thread) val result = request.thread_result if (result needs to be sent back) send_back_result(result) } else if (request is slow) { val thread = new Thread(() => do_request(request)) Threads.add(thread) thread.start() } else { val result = do_request(request) if (result needs to be sent back) send_back_result(result) }}",Examples of C# 5.0 async/await vs. Akka actors vs. basic fork/join?
Do something after a Outlook Appointment was saved," I am writing an Outlook Add-in and want to do something (not relevant here) with the data of an Appointment after (when) it was saved.(i am new to Outlook-Addins)so i found that there is an AfterWrite event where i can register a Method.And there is an ItemLoad event on Application.so my first Efford was something like this: The problem is, that I don't know how to get to the data of the Appointment, that fired the event.Application.ItemLoad registers a function that gets an Object, that can be cast to an Appointment.AfterWrite does not. I'd like something like this: I fear that I am researching in the totally wrong direction..*sorry if my english is a mess - it's not my mother languageedit:i even tried a construct like this: but event doesn't get fired!i am very frustrated now <code>  private void ThisAddIn_Startup(object sender, System.EventArgs e){ // ... this.Application.ItemLoad += new Outlook.ApplicationEvents_11_ItemLoadEventHandler(atItemLoad);}public void atItemLoad(Object item){ Outlook.AppointmentItem aitem = item as Outlook.AppointmentItem; if (aitem != null) { aitem.AfterWrite += new Outlook.ItemEvents_10_AfterWriteEventHandler(afterWrite); }}public void afterWrite(){ // Who was written? MessageBox.Show(""it was written!"");} public void afterWrite(Outlook.AppointmentItem aitem){ // do something with the data from the Appointment MessageBox.Show(aitem.Subject + "" was written!"");} private List<AppointmentEventHolder> holderList = new List<AppointmentEventHolder>();internal class AppointmentEventHolder{ private Outlook.AppointmentItem aitem = null; public AppointmentEventHolder(Outlook.AppointmentItem item) { aitem = item; } public void onWrite() { MessageBox.Show(""write: "" + aitem.Subject); }}public void atItemLoad(Object item){ Outlook.AppointmentItem aitem = item as Outlook.AppointmentItem; if (aitem != null) { AppointmentEventHolder aHolder = new AppointmentEventHolder(aitem); holderList.Add(aHolder); aitem.AfterWrite += aHolder.onWrite; }}",Event after a Outlook Appointment was saved
Asp.net web forms routing to virtual item," I am trying to create a route in route table that routes to a virtual item (using a cms that creates url like example.com/about/company, where there is no physical file called company exists) using system.web.routing (unfortunately i cannot use iis rewriting/routing). I have tried the following but it results in 404. If I were to point to another physical file (tor testing purpose), the routing works fine. So, is it possible to point to an item like that? <code>  void RegisterRoutes(RouteCollection routes){ routes.RouteExistingFiles = true; routes.MapPageRoute(""about"", ""about/us"", ""~/about/company"", false);}",Routing to virtual item
Running a .exe application from Windows forms," I have an application that I run on the command prompt as follows: I want to create a Windows Forms application where the user can specify the location of the executable and also the header file so that the Windows Forms application can do this for him/her, and the user wouldn't have to go to the command line and do it.How can I do this?  <code>  C:\some_location> ""myapplication.exe"" headerfile.h",Running a .exe application from Windows Forms
Use Compiled Lamba expression instead of Activator.CreateInstance to initialize SoapHttpClientProtocol object," I'm working with the code that dynamically instantiates SoapHttpClientProtocol object (proxy class) and uses this object to make a call to WS-Basic I Web Service. Here is the simplified version of my code: I've noticed that in some cases Activator.CreateInstance() call can take significant amount of time, so I'm trying to optimize the code by using a lambda expression: Unfortunately, this code does not create an object of the callingObject type (instead it returns a Func<T> delegate object) and therefore when it tries to set the Url in the next line it throws an exception: System.MissingMethodException: Attempted to access a missing member.Am I missing something in my code?Thanks! <code>  public override object Call(Type callingObject,string method, object[] methodParams, string URL){ MethodInfo requestMethod = callingObject.GetMethod(method); //creates an instance of SoapHttpClientProtocol object instance = Activator.CreateInstance(callingObject); //sets the URL for the object that was just created instance.GetType().InvokeMember(""Url"", BindingFlags.Public | BindingFlags.Instance | BindingFlags.SetProperty, null, instance, new object[1] {URL}); return requestMethod.Invoke(instance, methodParams); } public override object Call(Type callingObject,string method, object[] methodParams, string URL){ MethodInfo requestMethod = callingObject.GetMethod(method); //creates an instance of SoapHttpClientProtocol using compiled Lambda Expression ConstructorInfo constructorInfo = callingObject.GetConstructor(new Type[0]); object instance = Expression.Lambda(Expression.New(constructorInfo)).Compile(); //sets the URL for the object that was just created instance.GetType().InvokeMember(""Url"", BindingFlags.Public | BindingFlags.Instance | BindingFlags.SetProperty, null, instance, new object[1] {URL}); //calls the web service return requestMethod.Invoke(instance, methodParams); }",Use Compiled Lambda expression instead of Activator.CreateInstance to initialize SoapHttpClientProtocol object
Hide Scrollbars in the the webBrowser control," I am working on an HTML display control for windows forms. I am using the webBrowser control as the base for my control and I need to hide the webBrowsers scroll bar, as it looks bad, will never be used, and makes the control look like a webPage which ruins the layout. Currently the scroll bar renders on the control looking all dejected and greyed out. Is there way to simply remove it all together? <code> ",Hide Scrollbars in the webBrowser control
How can I iterate though each child node? in and XML file," I have an XML File and i would like to iterate though each child node gathering information.Here is my C# code it only picks up one node, the FieldData i would like to use a foreach on its child nodes. My XML Looks Something like: <code>  public void LoadXML() { if (File.Exists(""Data.xml"")) { //Reading XML XmlDocument xmlDoc = new XmlDocument(); xmlDoc.Load(""Data.xml""); //Think something needs to reference Child nodes, so i may Foreach though them XmlNodeList dataNodes = xmlDoc.SelectNodes(""//FieldData""); TagContents[] ArrayNode; foreach(XmlNode node in dataNodes) { int Count = 0; //int Max = node.ChildNodes.Count; ArrayNode = new TagContents[Max]; ArrayNode[Count].TagName = node.Name; ArrayNode[Count].TagValue = node.SelectSingleNode(ArrayNode[Count].TagName).InnerText; Count = Count + 1; } } else { MessageBox.Show(""Could not find file Data.xml""); }} <?xml version=""1.0""?><FieldData> <property_details_branch IncludeInPDFExport=""Yes"" Mod=""20010101010101""/> <property_details_inspection_date IncludeInPDFExport=""Yes"" Mod=""20120726200230"">20120727220230+0200</property_details_inspection_date> <property_details_type_of_ownership IncludeInPDFExport=""Yes"" Mod=""20120726134107"">Freehold</property_details_type_of_ownership></FieldData>",How can I iterate though each child node in an XML file?
Looking for a Static Analysis Tool For Concurrency in .NET," I am implementing a concurrent .NET data structures in c# (like ConcurrentDictionary, BlockcingCollection etc.). It's not about just not forgetting to lock an object when accessing from different threads. It requires sophisticated locking strategies to maximize parallel execution time. I know there is a tool, a kind of framework for systematic concurrency testing for .NET named CHESS.Question: Is there also a tool which will find concurrency / threading issues through static code analyses? Something like CheckThread which is for java.  <code> ",Looking for a Static Code Analysis Tool For Concurrency in .NET like CheckThread for java
Looking for a Static Analysis Tool For Concurrency in .NET like CheckThread for java," I am implementing a concurrent .NET data structures in c# (like ConcurrentDictionary, BlockcingCollection etc.). It's not about just not forgetting to lock an object when accessing from different threads. It requires sophisticated locking strategies to maximize parallel execution time. I know there is a tool, a kind of framework for systematic concurrency testing for .NET named CHESS.Question: Is there also a tool which will find concurrency / threading issues through static code analyses? Something like CheckThread which is for java.  <code> ",Looking for a Static Code Analysis Tool For Concurrency in .NET like CheckThread for java
How to modify a foreach iteration variable from within foreach loop? (C#)," When I try to do this... ...I get Cannot assign to 'item' because it is a 'foreach iteration variable'.Still, I'd like to do that.The idea is to assign default Item class values to existing item. <code>  Item[,] array = new Item[w, h]; // Two dimensional array of class Item, // w, h are unknown at compile time.foreach(var item in array){ item = new Item();}",How to modify a foreach iteration variable from within foreach loop?
display how many times an array element appears in C#," I am new to C# and hope I can get some help on this topic. I have an array with elements and I need to display how many times every item appears.For instance, in [1, 2, 3, 4, 4, 4, 3], 1 appears one time, 4 appears three times, and so on.I have done the following but don`t know how to put it in the foreach/if statement... Thanks you, and sorry if this is a very basic one... <code>  int[] List = new int[]{1,2,3,4,5,4,4,3};foreach(int d in List){ if(""here I want to check for the elements"")}",How to display how many times an array element appears
C# Collection to store tree structure," I want to store an organisation chart in a collection. I think a tree data structure will be best suited to my needs, as I need to add multiple nodes to one node.LinkedList only provides adding one node to another node, if I understand it correctly. I have looked at C5 treeset collection, but it doesn't seem to have Add() method to add more than 2 nodes to one node.I have also looked at Treeview class from Windows Forms library, but I do not want to add Windows forms dll to my project, since I am building a service layer application. (or is it fine?)I do not want to write my own tree collection class, if there is already one provided by 3rd party?Any suggestion please?Thanks <code> ",What collection to store a tree structure?
Weird coverage results in iterator (using dotCover)," I'm using dotCover to analyze code coverage of my unit tests, and I'm getting some strange results... I have an iterator method for which the coverage is not complete, but the statements that are not covered are just the closing braces at the end of the method.Here's the method I'm testing: The unit test: And the coverage results:I assume the closing brace of the using block is actually the calls to Dispose on the enumerators; but then, why is it not executed? I first suspected that NUnit wasn't disposing the enumerators, but I get the same result if I do a foreach on actual.As for the second uncovered closing brace, I have no idea what it stands for... I guess it's related to how the compiler transforms the iterator block.Can anyone shed some light on what these two ""statements"" are, and why they are not executed ?EDIT: Peter raised a very good question: the results shown above were obtained when running the tests on a debug build. If I run the tests on a release build, coverage of the CommonPrefixImpl method is 100%, so it's probably related to compiler optimizations. <code>  public static IEnumerable<T> CommonPrefix<T>( this IEnumerable<T> source, IEnumerable<T> other, IEqualityComparer<T> comparer) { source.CheckArgumentNull(""source""); other.CheckArgumentNull(""other""); return source.CommonPrefixImpl(other, comparer); } private static IEnumerable<T> CommonPrefixImpl<T>( this IEnumerable<T> source, IEnumerable<T> other, IEqualityComparer<T> comparer) { comparer = comparer ?? EqualityComparer<T>.Default; using (IEnumerator<T> en1 = source.GetEnumerator(), en2 = other.GetEnumerator()) { while (en1.MoveNext() && en2.MoveNext()) { if (comparer.Equals(en1.Current, en2.Current)) yield return en1.Current; else yield break; } } // not covered } // not covered [Test] public void Test_CommonPrefix_SpecificComparer() { var first = new[] { ""Foo"", ""Bar"", ""Baz"", ""Titi"", ""Tata"", ""Toto"" }; var second = new[] { ""FOO"", ""bAR"", ""baz"", ""tata"", ""Toto"" }; var expected = new[] { ""Foo"", ""Bar"", ""Baz"" }; var actual = first.CommonPrefix(second, StringComparer.CurrentCultureIgnoreCase); Assert.That(actual, Is.EquivalentTo(expected)); }","Weird test coverage results for iterator block, why are these statements not executed?"
"Weird coverage results for iterator block, why are these statements not executed?"," I'm using dotCover to analyze code coverage of my unit tests, and I'm getting some strange results... I have an iterator method for which the coverage is not complete, but the statements that are not covered are just the closing braces at the end of the method.Here's the method I'm testing: The unit test: And the coverage results:I assume the closing brace of the using block is actually the calls to Dispose on the enumerators; but then, why is it not executed? I first suspected that NUnit wasn't disposing the enumerators, but I get the same result if I do a foreach on actual.As for the second uncovered closing brace, I have no idea what it stands for... I guess it's related to how the compiler transforms the iterator block.Can anyone shed some light on what these two ""statements"" are, and why they are not executed ?EDIT: Peter raised a very good question: the results shown above were obtained when running the tests on a debug build. If I run the tests on a release build, coverage of the CommonPrefixImpl method is 100%, so it's probably related to compiler optimizations. <code>  public static IEnumerable<T> CommonPrefix<T>( this IEnumerable<T> source, IEnumerable<T> other, IEqualityComparer<T> comparer) { source.CheckArgumentNull(""source""); other.CheckArgumentNull(""other""); return source.CommonPrefixImpl(other, comparer); } private static IEnumerable<T> CommonPrefixImpl<T>( this IEnumerable<T> source, IEnumerable<T> other, IEqualityComparer<T> comparer) { comparer = comparer ?? EqualityComparer<T>.Default; using (IEnumerator<T> en1 = source.GetEnumerator(), en2 = other.GetEnumerator()) { while (en1.MoveNext() && en2.MoveNext()) { if (comparer.Equals(en1.Current, en2.Current)) yield return en1.Current; else yield break; } } // not covered } // not covered [Test] public void Test_CommonPrefix_SpecificComparer() { var first = new[] { ""Foo"", ""Bar"", ""Baz"", ""Titi"", ""Tata"", ""Toto"" }; var second = new[] { ""FOO"", ""bAR"", ""baz"", ""tata"", ""Toto"" }; var expected = new[] { ""Foo"", ""Bar"", ""Baz"" }; var actual = first.CommonPrefix(second, StringComparer.CurrentCultureIgnoreCase); Assert.That(actual, Is.EquivalentTo(expected)); }","Weird test coverage results for iterator block, why are these statements not executed?"
How to run method in separate thread using Parallel Tasks., here is sample of code for i am looking for code snippet for Parallel Tasks by which i can do the callback and pass argument to function also. can anyone help. <code>  private void MethodStarter(){Task myFirstTask = Task.Factory.StartNew(Method1);Task mySecondTask = Task.Factory.StartNew(Method1);}private void Method1(){ // your code}private void Method2(){ // your code},How to run method with arguments in separate thread using Parallel Tasks
"Gernerics, Compair byte[] to T in C#"," I want to make a list of pointers to locations that contains a certain value in the process memory of another process. The value can be a short, int, long, string, bool or something else. My idea is to use Generics for this. I have one problem with making it, how can I tell the compiler to what type he needs to convert the byte array?This is what I made: How can I tell the compiler that he needs to convert the byte[] to type T? <code>  public List<IntPtr> ScanProccessFor<T>(T ItemToScanFor) { List<IntPtr> Output = new List<IntPtr>(); IntPtr StartOffset = SelectedProcess.MainModule.BaseAddress; int ScanSize = SelectedProcess.MainModule.ModuleMemorySize; for (int i = 0; i < ScanSize; i++) if (ReadMemory(SelectedProcess, StartOffset + i, (UInt16)Marshal.SizeOf(ItemToScanFor)) == ItemToScanFor) Output.Insert(Output.Count,StartOffset + i); return Output; }",Compare byte[] to T
"Generics, Compair byte[] to T in C#"," I want to make a list of pointers to locations that contains a certain value in the process memory of another process. The value can be a short, int, long, string, bool or something else. My idea is to use Generics for this. I have one problem with making it, how can I tell the compiler to what type he needs to convert the byte array?This is what I made: How can I tell the compiler that he needs to convert the byte[] to type T? <code>  public List<IntPtr> ScanProccessFor<T>(T ItemToScanFor) { List<IntPtr> Output = new List<IntPtr>(); IntPtr StartOffset = SelectedProcess.MainModule.BaseAddress; int ScanSize = SelectedProcess.MainModule.ModuleMemorySize; for (int i = 0; i < ScanSize; i++) if (ReadMemory(SelectedProcess, StartOffset + i, (UInt16)Marshal.SizeOf(ItemToScanFor)) == ItemToScanFor) Output.Insert(Output.Count,StartOffset + i); return Output; }",Compare byte[] to T
How to handle SelectedIndexChange event for a compobox?, I have DataGridView which contains two ComboBox columns.The second ComboBox will be filled with data depending on the selected value from first ComboBox.How to handle the SelectedIndexChanged event for the first ComboBox. <code> ,How to handle SelectedIndexChanged event for a ComboBox?
How to handle SelectedIndexChange event for a ComboBox?, I have DataGridView which contains two ComboBox columns.The second ComboBox will be filled with data depending on the selected value from first ComboBox.How to handle the SelectedIndexChanged event for the first ComboBox. <code> ,How to handle SelectedIndexChanged event for a ComboBox?
How to handle SelectedIndexChanged event for a ComboBox?, I have DataGridView which contains two ComboBox columns.The second ComboBox will be filled with data depending on the selected value from first ComboBox.How to handle the SelectedIndexChanged event for the first ComboBox. <code> ,How to handle SelectedIndexChanged event for a ComboBox?
"Cannot detect if a user is running with elevated priviliges, when no UAC popup"," I am developing a C# application that needs to detect whether the user is running as elevated administrator. I tried the solution suggested by Steven.I checked the solution on 5 machines and it works fine on 4 of them.There is one machine that never show the UAC notification message, even though I set the User Account Control to Always notify me.When checking the code on that machine, even if I choose run as administrator, it doesn't work and the method IsProcessElevated returns false.Is something wrong with that specific machine? Is there a way to determine whether a user is elevated or not, on that kind of platform? <code> ","Cannot detect if a user is running with elevated privileges, when no UAC popup"
"Got ""Index out of bounds"" Error on List.Add() in c#"," Here is the code I get the Index out of bounds error around 1 time per hundred run. Is there anyway to prevent the conflict (I assume) caused by threading? <code>  List<string> something = new List<string>();Parallel.ForEach(anotherList, r => { .. do some work something.Add(somedata); });","Got ""Index out of bounds"" Error on List.Add() in c# Parallel.ForEach"
Change datepicker text. Uppercase month," I want to change the date picker by upper-casing the first letter of the month. Currently I'm using the set culture info in the thread and specify the format there, but for my culture the month is always all lowercase: Displays: And I would like to have: How can I change that? <code>  CultureInfo ci = new CultureInfo(""es-MX"");ci.DateTimeFormat.ShortDatePattern = ""ddd dd/MMM/yyyy"";Thread.CurrentThread.CurrentCulture = ci; Dom 19/ago/2012 Dom 19/Ago/2012",Change date picker text: capitalize month
Correct DateTime format in SQL CE?," I have a C# DateTime class and wanted to know how I need to format it in a SQL Server CE query to insert it into the database, I was hoping to have both the date and time inserted in. Currently when I try variations thereof I get invalid format exceptions.Current format I'm using is: dd/MM/yyyy, was hoping to do something like dd/MM/yyyy hh:mm:ss.The way I'm trying to do the insert is like so: Obviously hh:mm:ss isn't working, if that isn't there dd/MM/yyyy executes successfully in the query.I've tried a few formats including what I've found on google but none have worked so far... <code>  ( ( DateTime )_Value ).ToString( ""dd/MM/yyyy hh:mm:ss"" )",Correct DateTime format in SQL Server CE?
Debugging HTML in WebBrowserControl," I need to embed HTML in a Winforms project and call Javascript functions from it. I'm using a webBrowser control in a c# project and calling: How can I debug execution of code when the debugger is in ""myMethod""?There's this article on how to debug HTML from IE:http://www.codeproject.com/Articles/18921/Using-Visual-Studio-to-Debug-JavaScript-in-IEI don't know how relevant it is though. <code>  webBrowser.Navigate(""website"");return webBrowser.Document.InvokeScript(""myMethod"", new object[]{""test""});",Debugging HTML in WebBrowser Control
Thread.Sleep() in c#," I want to make an image viewer in C# Visual Studio 2010 which displays images one by one after seconds: When the program starts, it stops and just shows me the first and last image. <code>  i = 0;if (image1.Length > 0) //image1 is an array string containing the images directory{ while (i < image1.Length) { pictureBox1.Image = System.Drawing.Image.FromFile(image1[i]); i++; System.Threading.Thread.Sleep(2000); }",Thread.Sleep() in C#
How do I resize an EMF (Metafile) in .Net?," I have an EMF file. I want to resize it smaller.How do I do this in .net (or with any tool) without getting a blurry image?The resulting resized image will be converted to another format (png/jpg/whatever), I can handle that (I think).I haven't found a clear example in .Net (or any language platform for the matter) that deals with emf/metafiles. I've looked in the Graphics Programming with GDI+ but it only introduces Metafiles.I've tried Image Magick but you have to convert to another format (which I need to do anyway) and the result is blurry (when shrunk and converted to png for example).I've tried Inkscape, but you can only import an EMF file and Inkscape imports it upside down and out of proportion into an existing drawing.Also, (don't laugh) I've opened it up in Window's Paint (one of the few image editing software programs that will open emf's) and resized the drawing, again it's blurry.Update:Here is the code I'm using to resize.This works, but the resulting image is blurry. The code is just a generic image re-sizing routine, not specific to EMF's Source:http://www.switchonthecode.com/tutorials/csharp-tutorial-image-editing-saving-cropping-and-resizing <code>  private static Image resizeImage(Image imgToResize, Size size){ int sourceWidth = imgToResize.Width; int sourceHeight = imgToResize.Height; float nPercent = 0; float nPercentW = 0; float nPercentH = 0; nPercentW = ((float)size.Width / (float)sourceWidth); nPercentH = ((float)size.Height / (float)sourceHeight); if (nPercentH < nPercentW) nPercent = nPercentH; else nPercent = nPercentW; int destWidth = (int)(sourceWidth * nPercent); int destHeight = (int)(sourceHeight * nPercent); Bitmap b = new Bitmap(destWidth, destHeight); Graphics g = Graphics.FromImage((Image)b); g.InterpolationMode = InterpolationMode.HighQualityBicubic; g.DrawImage(imgToResize, 0, 0, destWidth, destHeight); g.Dispose(); return (Image)b;}",How do I resize (shrink) an EMF (Metafile) in .Net?
How to reuse SqlCommand Parameter trough every iteration," I want to implement a simple delete button for my database. The event method looks something like this: but I get this message: A variable @id has been declared. Variable names must be unique within a query batch or stored procedure.Is there any way to reuse this variable? <code>  private void btnDeleteUser_Click(object sender, EventArgs e){ if (MessageBox.Show(""Are you sure?"", ""delete users"",MessageBoxButtons.OKCancel, MessageBoxIcon.Warning) == DialogResult.OK) { command = new SqlCommand(); try { User.connection.Open(); command.Connection = User.connection; command.CommandText = ""DELETE FROM tbl_Users WHERE userID = @id""; int flag; foreach (DataGridViewRow row in dgvUsers.SelectedRows) { int selectedIndex = row.Index; int rowUserID = int.Parse(dgvUsers[0,selectedIndex].Value.ToString()); command.Parameters.AddWithValue(""@id"", rowUserID); flag = command.ExecuteNonQuery(); if (flag == 1) { MessageBox.Show(""Success!""); } dgvUsers.Rows.Remove(row); } } catch (SqlException ex) { MessageBox.Show(ex.Message, Application.ProductName, MessageBoxButtons.OK, MessageBoxIcon.Information); } finally { if (ConnectionState.Open.Equals(User.connection.State)) User.connection.Close(); } } else { return; }}",How to reuse SqlCommand parameter through every iteration?
mvc 4 not change datetime formate," I will try everything but not working this(dd/MM/yyyy) date format, this always gate mm/dd/yyyy Razor view Using DateTime Template. <code>  [Display(Name = ""Release Date"")][DataType(DataType.DateTime)][DisplayFormat(ApplyFormatInEditMode = true, DataFormatString = ""{0:dd/MM/yyyy}"")]public Nullable<DateTime> release_date { get; set; } @Html.EditorFor(model => model.release_date) @model Nullable<System.DateTime>@if (Model.HasValue){ @Html.TextBox("""", String.Format(""{0:dd/MM/yyyy}"", Model.Value))}else{ @Html.TextBox("""", String.Format(""{0:dd/MM/yyyy}"", DateTime.Now))}@{ string name = ViewData.TemplateInfo.HtmlFieldPrefix; string id = name.Replace(""."", ""_"");}<script type=""text/javascript""> $(document).ready(function () { $(""#@id"").datepicker({ dateFormat: ""dd/mm/yy"", showStatus: true, showWeeks: true, highlightWeek: true, numberOfMonths: 1, showAnim: ""scale"", showOptions: { origin: [""top"", ""left""] } }); });</script>",Unable to set datetime format in MVC 4 using data annotations
WInform different sizes in different environments," For some time now, a few people who have been using my application has complained about some strange behaviour in how the WinForm is being drawn.The form has one splitcontainer with panel1 being fixed.I have not been able to reproduce their problems, until today.I just installed the app on a laptop running a 32 bit version of Win7 enterprise.(app is built and running without problem on my computer running 64 bit version of Win7 ent.)To see what was going on, I copied the project files over to the laptop and opened it with Visual Studio 2012 to see what was going on. However, is has me stunned as I don't know what do do about it.On the dev. machine (my 64 bit win7 ent), the specifications for the form (and split container) sizes are as follows:Form height: 383 Form Width: 707 Split container height: 321 Split container Width: 691 Splitter distance: 380 When I load the project on the laptop, the specifications are changed to this:Form height: 419 Form Width: 859 Split container height: 397 Split container Width: 921 Splitter distance: 380 Now I can finally understand the frustration with some people not being able to see the program as how it is supposed to be seen.On the 32 bit machine, the splitter is partly covering a few buttons, which obviously making the program hard to use since they can't see the text.Is there any reason why this happens?I mean, if the original code is set to a specific size value, isn't that how it should be no matter where the program is run? (Given the user doesn't resize of course).And then most importantly, is there any way I can solve this without having to build two separate versions? <code> ",Winforms different sizes in different environments
why does my application crashes in release mode but not in debug mode?," What is the difference between release mode and debug mode?And how can I debug in release mode to see whats failing? <code>  class Program{ [STAThread] static void Main() { try { Application.EnableVisualStyles(); Application.SetCompatibleTextRenderingDefault(false); Application.Run(new MainWindow()); } catch (Exception ex) { Logger.Error(""Main : ""+ex.Message, typeof(Program)); MessageBox.Show(ex.Message + ex.StackTrace); Environment.Exit(1); } }}",Why does my application crash in release mode but not in debug mode?
Autofac - InstancePerHttpRequest vs InstancePerLifetimeScope in ASP.NET MVC 3," What are the differences between the two scopes?I am building Module(s) in each layer (Repository, Service, MVC App), but in order to have InstancePerHttpRequest you need the Autofac.Mvc assembly.Which scope should I be using in my Repository and Service layer? <code> ",Autofac - InstancePerHttpRequest vs InstancePerLifetimeScope
Acheive strategy pattern when we have different return type," I have SaveManager Abstract class and my concrete classes TVSaveManager, DataSaveManager and VoiceSaveManager implementing SaveManager Abstract class. Factory class will decide which manager to create and send us the list. I will loop thru the list and invoke the common interface 'MapAndSaveProduct' that every concrete classes will adhere. I guess more or like a strategy pattern.But the thing is all the concrete savemanage's MapAndSaveProduct method return type is different. TVResponse for TvSaveManager and DataResponse for DataSaveManager and so on. So i created SaveResponseModel class to club all the return types (I am passing SaveResponseModel to factory so that it will get passed to all concrete savemanager class's constructor. Individual class will set the desired property., like TvSaveManager -> saveResponseModel.TvResponse). I get desired result and code looks clean.Questions are,1) Is it the correct way to use this pattern when we have different type?2) If concrete class have different types, should not we use strategy pattern?3) Should I approach to different design pattern in this case. if yes which one? <code>  List<SaveManager> lstPrdSaveManager; public SaveResponseModel SaveProducts(SaveProductsRequest objSaveProductsRequest) { SaveResponseModel saveResponseModel = new SaveResponseModel(); lstPrdSaveManager = SaveManagerFactory.GetSaveManagers(objSaveProductsRequest, saveResponseModel); lstPrdSaveManager.ForEach(saveManager => { saveResponseModel = saveManager.MapAndSaveProduct(); }); return saveResponseModel; }",Achieve strategy pattern when we have different return type
How can i assign a function or property to all of other classes just like tooltip," When I drag and drop a ToolTip object on my form in C#, every control on the form gets a new property called ToolTip which didn't exist before. I'm trying to create something just like ToolTip so that when I drag and drop it onto my form all of the controls will automatically get its new property.I would also be grateful if anyone could give me a definition for this so that I can edit my question to convey my intention and meaning better. <code> ",How can I assign a function or property to all of other classes just like ToolTip
Downcasting an object to a IEnumerable<>," I am trying to play with Reflection and ran into the following situation. In the following code, let's assume that the 'obj' can be of types IEnumerable<> or ICollection<> or IList<>. I would like to cast this System.Object to IEnumerable<> always (as ICollection<> and IList<> inherit from IEnumerable<> anyway), so that i would like to enumerate over the collection and use reflection to write the individual items.Motivation behind this is I am just trying to see if how would Serializers, in general, serialize data and so I am trying to simulate that situation in the hope to understand Reflection too.I thought of casting the object to non-generic IEnumerable, but thought that this would cause unnecessary boxing of objects, when let's say the actual instance of IEnumerable<int>...am I thinking right? <code>  private void WriteGenericCollection(object obj) { Type innerType = obj.GetType().GetGenericArguments()[0]; //Example: IEnumerable<int> or IEnumerable<Customer> Type generatedType = typeof(IEnumerable<>).MakeGenericType(innerType); //how could i enumerate over the individual items? }",Casting an object to IEnumerable<T> where T is not known
How can you programatically detect if javascript is disabled in Internet Settings using WebBrowser Winforms Control," I have an application which writes HTML to a WebBrowser control in a .NET winforms application.I want to detect somehow programatically if the Internet Settings have Javascript (or Active Scripting rather) disabled.I'm guessing you need to use something like WMI to query the IE Security Settings.EDIT #1: It's important I know if javascript is enabled prior to displaying the HTML so solutions which modify the DOM to display a warning or that use tags are not applicable in my particular case. In my case, if javascript isn't available i'll display content in a native RichTextBox instead and I also want to report whether JS is enabled back to the server application so I can tell the admin who sends alerts that 5% or 75% of users have JS enabled or not. <code> ",How can you programmatically detect if javascript is enabled/disabled in a Windows Desktop Application? (WebBrowser Control)
Read Soap Message without using WCF," I am trying to read the above soap message XmlDocument using C#: The count is always zero and it is not reading the bookingstatus values. <code>  <s:Envelope xmlns:s=""http://schemas.xmlsoap.org/soap/envelope/""> <s:Head> <h:talkId s:mustknow=""1"" xmlns:h=""urn:schemas-test:testgate:hotel:2012-06""> sfasfasfasfsfsf</h:talkId> </s:Head> <s:Body> <bookHotelResponse xmlns=""urn:schemas-test:testgate:hotel:2012-06"" xmlns:d=""http://someURL"" xmlns:i=""http://www.w3.org/2001/XMLSchema-instance""> <d:bookingReference>123456</d:bookingReference> <d:bookingStatus>successful</d:bookingStatus> <d:price xmlns:p=""moreURL""> <d:total>105</d:total> </d:price> </bookHotelResponse> </s:Body></s:Envelope> XmlDocument document = new XmlDocument();document.LoadXml(soapmessage); //loading soap message as stringXmlNamespaceManager manager = new XmlNamespaceManager(document.NameTable);manager.AddNamespace(""d"", ""http://someURL"");XmlNodeList xnList = document.SelectNodes(""//bookHotelResponse"", manager);int nodes = xnList.Count;foreach (XmlNode xn in xnList){ Status = xn[""d:bookingStatus""].InnerText;}",Read Soap Message using C#
Is there a way to expand the current workingset of a process to 1GB?," Possible Duplicate: Is there any way to force the WorkingSet of a process to be 1GB in C++? We would like to increase the WorkingSet of a .NET process to 1GB, in advance, to avoid page faults.Is there a way to do this in .NET?UpdateUnfortunately, it appears that even if we do a call to SetProcessWorkingSetSizeEx, the garbage collection trims the working set down anyway, bypassing MinWorkingSet (see ""Automatic GC.Collect() in the diagram below).In the picture below, is there a way to lock the process WorkingSet (the green line) to 1GB, to avoid the spike in page faults (the red lines) that occur when allocating new memory into the process?The reason this would be awesome is that every time a page fault occurs, it blocks the thread for 250us, which hits application performance badly.UpdateQuote from: ""Windows via C/C++, Fifth Edition, Jeffrey Richter (Wintellect)"" Calls to SetProcessWorkingSetSize by an individual process are ignored unless the process is just trying to empty its working set. To set this limit, specify the JOB_OBJECT_LIMIT_WORKINGSET flag in the LimitFlags member.This book is implying that the only way to set the WorkingSet is by assigning the process to a Job Object and setting JOB_OBJECT_LIMIT_WORKINGSET and MinimumWorkingSetSize.UpdateSetProcessWorkingSetSizeEx has absolutely nothing to do with soft page faults. It only refers to hard page faults, as it prevents memory in the current WorkingSet being paged out to the hard drive.UpdateIt turns out that the only method to increase the WorkingSet is to run .NET using an extremely specialized CLR Host written in C++ (see my answer below). <code> ",Is there a way to expand the current WorkingSet of a process to 1GB?
c# backgroundworker in class," I have create a backgroundworker in an class it works, but if i call and wait until the end run, call it for the second time it will do the same process twicei thinks there is somthing wrong with bw.DoWork += problem solved <code>  private void button1_Click(object sender, EventArgs e){ nptest.test.start(""null"", ""null""); }namespace nptest{ class test { public static void start(string str, string strb) { if (bw.IsBusy != true) { bw.WorkerSupportsCancellation = true; bw.DoWork += (obj, e) => bw_DoWork(str, strb); bw.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bw_RunWorkerCompleted); bw.RunWorkerAsync(); } } private static BackgroundWorker bw = new BackgroundWorker(); private static void bw_DoWork(string str, string strb) { System.Windows.Forms.MessageBox.Show(""initializing BackgroundWorker""); } private static void bw_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e) { if ((e.Cancelled == true)) { Console.WriteLine(""Canceled""); } else if (!(e.Error == null)) { Console.WriteLine(""Error: "" + e.Error.Message); } bw.Dispose(); } }} class test { private static List<object> arguments = new List<object>(); // initializing with program startup public static void bwinitializing() { bw.WorkerSupportsCancellation = true; bw.DoWork += new DoWorkEventHandler(bw_DoWork); bw.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bw_RunWorkerCompleted); } public static void start(string str, string strb) { if (bw.IsBusy != true) { arguments.Clear(); arguments.Add(str); arguments.Add(strb); bw.RunWorkerAsync(arguments); } } private static BackgroundWorker bw = new BackgroundWorker(); private static void bw_DoWork(object sender, DoWorkEventArgs e) { List<object> genericlist = e.Argument as List<object>; System.Windows.Forms.MessageBox.Show(""BackgroundWorker "" + genericlist[0]); }",DoWork of BackgroundWorker is called twice when RunWorkerAsync is called once?
backgroundworker in class," I have create a backgroundworker in an class it works, but if i call and wait until the end run, call it for the second time it will do the same process twicei thinks there is somthing wrong with bw.DoWork += problem solved <code>  private void button1_Click(object sender, EventArgs e){ nptest.test.start(""null"", ""null""); }namespace nptest{ class test { public static void start(string str, string strb) { if (bw.IsBusy != true) { bw.WorkerSupportsCancellation = true; bw.DoWork += (obj, e) => bw_DoWork(str, strb); bw.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bw_RunWorkerCompleted); bw.RunWorkerAsync(); } } private static BackgroundWorker bw = new BackgroundWorker(); private static void bw_DoWork(string str, string strb) { System.Windows.Forms.MessageBox.Show(""initializing BackgroundWorker""); } private static void bw_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e) { if ((e.Cancelled == true)) { Console.WriteLine(""Canceled""); } else if (!(e.Error == null)) { Console.WriteLine(""Error: "" + e.Error.Message); } bw.Dispose(); } }} class test { private static List<object> arguments = new List<object>(); // initializing with program startup public static void bwinitializing() { bw.WorkerSupportsCancellation = true; bw.DoWork += new DoWorkEventHandler(bw_DoWork); bw.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bw_RunWorkerCompleted); } public static void start(string str, string strb) { if (bw.IsBusy != true) { arguments.Clear(); arguments.Add(str); arguments.Add(strb); bw.RunWorkerAsync(arguments); } } private static BackgroundWorker bw = new BackgroundWorker(); private static void bw_DoWork(object sender, DoWorkEventArgs e) { List<object> genericlist = e.Argument as List<object>; System.Windows.Forms.MessageBox.Show(""BackgroundWorker "" + genericlist[0]); }",DoWork of BackgroundWorker is called twice when RunWorkerAsync is called once?
How Use Parallel.ForEach Loop Instead Of Regular Foreach? (Info About Parallel.ForEach), I am a bit of confused about Parallel.ForEach.What is Parallel.ForEach and what does it exactly do?Please don't reference any MSDN link. Here's a simple example : How can I rewrite this example with Parallel.ForEach? <code>  string[] lines = File.ReadAllLines(txtProxyListPath.Text);List<string> list_lines = new List<string>(lines);foreach (string line in list_lines){ //My Stuff},How can I convert this foreach code to Parallel.ForEach?
Using a Parallel.ForEach loop Instead of a regular foreach, I am a bit of confused about Parallel.ForEach.What is Parallel.ForEach and what does it exactly do?Please don't reference any MSDN link. Here's a simple example : How can I rewrite this example with Parallel.ForEach? <code>  string[] lines = File.ReadAllLines(txtProxyListPath.Text);List<string> list_lines = new List<string>(lines);foreach (string line in list_lines){ //My Stuff},How can I convert this foreach code to Parallel.ForEach?
How to use a Parallel.ForEach loop Instead of a regular foreach?, I am a bit of confused about Parallel.ForEach.What is Parallel.ForEach and what does it exactly do?Please don't reference any MSDN link. Here's a simple example : How can I rewrite this example with Parallel.ForEach? <code>  string[] lines = File.ReadAllLines(txtProxyListPath.Text);List<string> list_lines = new List<string>(lines);foreach (string line in list_lines){ //My Stuff},How can I convert this foreach code to Parallel.ForEach?
When to use a Parallel.ForEach loop instead of a regular foreach?, I am a bit of confused about Parallel.ForEach.What is Parallel.ForEach and what does it exactly do?Please don't reference any MSDN link. Here's a simple example : How can I rewrite this example with Parallel.ForEach? <code>  string[] lines = File.ReadAllLines(txtProxyListPath.Text);List<string> list_lines = new List<string>(lines);foreach (string line in list_lines){ //My Stuff},How can I convert this foreach code to Parallel.ForEach?
How to Use GestureRecognizer Class?," Can anyone explain on how to detect simple touch gestures in a WinRT app? I tried using the GestureRecognizer class but it didn't work: <code>  public MainPage() { this.InitializeComponent(); Windows.UI.Input.GestureRecognizer gr = new Windows.UI.Input.GestureRecognizer(); gr.CrossSliding += gr_CrossSliding; gr.Dragging += gr_Dragging; gr.Holding += gr_Holding; gr.ManipulationCompleted += gr_ManipulationCompleted; gr.ManipulationInertiaStarting += gr_ManipulationInertiaStarting; gr.ManipulationStarted += gr_ManipulationStarted; gr.ManipulationUpdated += gr_ManipulationUpdated; gr.RightTapped += gr_RightTapped; gr.Tapped += gr_Tapped; gr.GestureSettings = Windows.UI.Input.GestureSettings.ManipulationRotate | Windows.UI.Input.GestureSettings.ManipulationTranslateX | Windows.UI.Input.GestureSettings.ManipulationTranslateY | Windows.UI.Input.GestureSettings.ManipulationScale | Windows.UI.Input.GestureSettings.ManipulationRotateInertia | Windows.UI.Input.GestureSettings.ManipulationScaleInertia | Windows.UI.Input.GestureSettings.ManipulationTranslateInertia | Windows.UI.Input.GestureSettings.Tap; } void gr_Tapped(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.TappedEventArgs args) { Debug.WriteLine(""gr_Tapped""); } void gr_RightTapped(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.RightTappedEventArgs args) { Debug.WriteLine(""gr_RightTapped""); } void gr_Holding(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.HoldingEventArgs args) { Debug.WriteLine(""gr_Holding""); } void gr_Dragging(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.DraggingEventArgs args) { Debug.WriteLine(""gr_Dragging""); } void gr_CrossSliding(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.CrossSlidingEventArgs args) { Debug.WriteLine(""gr_CrossSliding""); } void gr_ManipulationUpdated(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.ManipulationUpdatedEventArgs args) { Debug.WriteLine(""gr_ManipulationUpdated""); } void gr_ManipulationStarted(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.ManipulationStartedEventArgs args) { Debug.WriteLine(""gr_ManipulationStarted""); } void gr_ManipulationCompleted(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.ManipulationCompletedEventArgs args) { Debug.WriteLine(""gr_ManipulationCompleted""); } void gr_ManipulationInertiaStarting(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.ManipulationInertiaStartingEventArgs args) { Debug.WriteLine(""gr_ManipulationInertiaStarting""); }",Detect Simple Touch Gestures
Detect Simple Touch Gestures," Can anyone explain on how to detect simple touch gestures in a WinRT app? I tried using the GestureRecognizer class but it didn't work: <code>  public MainPage() { this.InitializeComponent(); Windows.UI.Input.GestureRecognizer gr = new Windows.UI.Input.GestureRecognizer(); gr.CrossSliding += gr_CrossSliding; gr.Dragging += gr_Dragging; gr.Holding += gr_Holding; gr.ManipulationCompleted += gr_ManipulationCompleted; gr.ManipulationInertiaStarting += gr_ManipulationInertiaStarting; gr.ManipulationStarted += gr_ManipulationStarted; gr.ManipulationUpdated += gr_ManipulationUpdated; gr.RightTapped += gr_RightTapped; gr.Tapped += gr_Tapped; gr.GestureSettings = Windows.UI.Input.GestureSettings.ManipulationRotate | Windows.UI.Input.GestureSettings.ManipulationTranslateX | Windows.UI.Input.GestureSettings.ManipulationTranslateY | Windows.UI.Input.GestureSettings.ManipulationScale | Windows.UI.Input.GestureSettings.ManipulationRotateInertia | Windows.UI.Input.GestureSettings.ManipulationScaleInertia | Windows.UI.Input.GestureSettings.ManipulationTranslateInertia | Windows.UI.Input.GestureSettings.Tap; } void gr_Tapped(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.TappedEventArgs args) { Debug.WriteLine(""gr_Tapped""); } void gr_RightTapped(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.RightTappedEventArgs args) { Debug.WriteLine(""gr_RightTapped""); } void gr_Holding(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.HoldingEventArgs args) { Debug.WriteLine(""gr_Holding""); } void gr_Dragging(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.DraggingEventArgs args) { Debug.WriteLine(""gr_Dragging""); } void gr_CrossSliding(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.CrossSlidingEventArgs args) { Debug.WriteLine(""gr_CrossSliding""); } void gr_ManipulationUpdated(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.ManipulationUpdatedEventArgs args) { Debug.WriteLine(""gr_ManipulationUpdated""); } void gr_ManipulationStarted(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.ManipulationStartedEventArgs args) { Debug.WriteLine(""gr_ManipulationStarted""); } void gr_ManipulationCompleted(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.ManipulationCompletedEventArgs args) { Debug.WriteLine(""gr_ManipulationCompleted""); } void gr_ManipulationInertiaStarting(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.ManipulationInertiaStartingEventArgs args) { Debug.WriteLine(""gr_ManipulationInertiaStarting""); }",Detect Simple Touch Gestures
"Detect Simple Touch Gestures Like Swipe, Pinch Etc"," Can anyone explain on how to detect simple touch gestures in a WinRT app? I tried using the GestureRecognizer class but it didn't work: <code>  public MainPage() { this.InitializeComponent(); Windows.UI.Input.GestureRecognizer gr = new Windows.UI.Input.GestureRecognizer(); gr.CrossSliding += gr_CrossSliding; gr.Dragging += gr_Dragging; gr.Holding += gr_Holding; gr.ManipulationCompleted += gr_ManipulationCompleted; gr.ManipulationInertiaStarting += gr_ManipulationInertiaStarting; gr.ManipulationStarted += gr_ManipulationStarted; gr.ManipulationUpdated += gr_ManipulationUpdated; gr.RightTapped += gr_RightTapped; gr.Tapped += gr_Tapped; gr.GestureSettings = Windows.UI.Input.GestureSettings.ManipulationRotate | Windows.UI.Input.GestureSettings.ManipulationTranslateX | Windows.UI.Input.GestureSettings.ManipulationTranslateY | Windows.UI.Input.GestureSettings.ManipulationScale | Windows.UI.Input.GestureSettings.ManipulationRotateInertia | Windows.UI.Input.GestureSettings.ManipulationScaleInertia | Windows.UI.Input.GestureSettings.ManipulationTranslateInertia | Windows.UI.Input.GestureSettings.Tap; } void gr_Tapped(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.TappedEventArgs args) { Debug.WriteLine(""gr_Tapped""); } void gr_RightTapped(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.RightTappedEventArgs args) { Debug.WriteLine(""gr_RightTapped""); } void gr_Holding(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.HoldingEventArgs args) { Debug.WriteLine(""gr_Holding""); } void gr_Dragging(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.DraggingEventArgs args) { Debug.WriteLine(""gr_Dragging""); } void gr_CrossSliding(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.CrossSlidingEventArgs args) { Debug.WriteLine(""gr_CrossSliding""); } void gr_ManipulationUpdated(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.ManipulationUpdatedEventArgs args) { Debug.WriteLine(""gr_ManipulationUpdated""); } void gr_ManipulationStarted(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.ManipulationStartedEventArgs args) { Debug.WriteLine(""gr_ManipulationStarted""); } void gr_ManipulationCompleted(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.ManipulationCompletedEventArgs args) { Debug.WriteLine(""gr_ManipulationCompleted""); } void gr_ManipulationInertiaStarting(Windows.UI.Input.GestureRecognizer sender, Windows.UI.Input.ManipulationInertiaStartingEventArgs args) { Debug.WriteLine(""gr_ManipulationInertiaStarting""); }",Detect Simple Touch Gestures
LINQtoSQL and null values, I have the following LINQ to SQL query: Without the ToList call I get the exception below on the Sum() line: The null value cannot be assigned to a member with type System.Double which is a non-nullable value type.If I add a .ToList() before sum (as shown in the comment) I don't get the error.Why do I get the error in the first place? (Shipped_Qty is not null and no null data in that field exists in the db)Why is adding ToList() a fix?The sql query executed is below (there is more to the query than above): No results are returned. <code>  var inTransitStocks = orderHistories.Where(oh => oh.Shipped_Qty > 0) .Select(oh => oh.Shipped_Qty); //.ToList();var inTransitStock = (int)inTransitStocks.Sum(); SELECT [t0].[Shipped Qty]FROM [dbo].[Order History] AS [t0]WHERE ([t0].[Shipped Qty] > @p0) AND ([t0].[CUST_ID] = @p1) AND ([t0].[SHIP_TO_ID] = @p2) AND ([t0].[Item] = @p3) AND (([t0].[DT_LST_SHP] >= @p4) OR (UNICODE([t0].[LN_STA]) = @p5)),LINQ to SQL and null values
How to handle WebBrowser control navigation exception," Let's say that WPF WebBrowser control shows some navigation errors and the page is not showing.So there is an exception of WPF WebBrowser control.I found some similar questions here but it is not what I need.In fact, I need some method and object that has an exception to get it somehow.How do we can handle it?Thank you!P.S. There is some approach for WinForm WebBrowser Control... Can we do something similar to WPF WebBrowser control? P.S. #2 To host WinForm WebBrowser control under WPF App is not an answer I think. <code>  public Form13(){ InitializeComponent(); this.webBrowser1.Navigate(""http://blablablabla.bla""); SHDocVw.WebBrowser axBrowser = (SHDocVw.WebBrowser)this.webBrowser1.ActiveXInstance; axBrowser.NavigateError += new SHDocVw.DWebBrowserEvents2_NavigateErrorEventHandler(axBrowser_NavigateError);}void axBrowser_NavigateError(object pDisp, ref object URL, ref object Frame, ref object StatusCode, ref bool Cancel){ if (StatusCode.ToString() == ""404"") { MessageBox.Show(""Page no found""); }}",How to handle WPF WebBrowser control navigation exception
EntityFrame Entity proxy error," I am working on a system using Entityframework and have been for over 12monts now, and the project has been going well, up until yesterday, where I have now got a strange error which I have no idea why it occurs.I am doing nothing different to what I have done before, but once I load the entity in question and try to access any child entities I get the following error: Can anyone shed any light on what this actually means and what would cause this?Showing my code doesnt really help.Here is a simplified version of the code: The error occurs when accessing DeparturePoint and DestinationPoint but Quote loads correctly, and all properties are loaded.The entity Quote looks a little like this: <code>  The entity wrapper stored in the proxy does not reference the same proxy var quote = new QuoteHelper().GetById(orderId);var updatedQuotes = new Provider().GetExportQuotes(quote.DeparturePoint.Id,quote.DestinationPoint); public class Quote : BaseQuote, ICloneable{ public Guid DeparturePointId { get; set; } public virtual LocationPoint DeparturePoint{ get; set; } public Guid DestinationPointId { get; set; } public virtual LocationPoint DestinationPoint{ get; set; }}",EntityFramework - Entity proxy error
Appending to MemoryStream in C#," I'm trying to append some data to a stream. This works well with FileStream, but not for MemoryStream due to the fixed buffer size.The method which writes data to the stream is separated from the method which creates the stream (I've simplified it greatly in the below example). The method which creates the stream is unaware of the length of data to be written to the stream. An idea I had was to send an expandable MemoryStream to the function, then append the returned data to the existing data. Any better (more efficient) solutions? <code>  public void Foo(){ byte[] existingData = System.Text.Encoding.UTF8.GetBytes(""foo""); Stream s1 = new FileStream(""someFile.txt"", FileMode.Append, FileAccess.Write, FileShare.Read); s1.Write(existingData, 0, existingData.Length); Stream s2 = new MemoryStream(existingData, 0, existingData.Length, true); s2.Seek(0, SeekOrigin.End); //move to end of the stream for appending WriteUnknownDataToStream(s1); WriteUnknownDataToStream(s2); // NotSupportedException is thrown as the MemoryStream is not expandable}public static void WriteUnknownDataToStream(Stream s){ // this is some example data for this SO query - the real data is generated elsewhere and is of a variable, and often large, size. byte[] newBytesToWrite = System.Text.Encoding.UTF8.GetBytes(""bar""); // the length of this is not known before the stream is created. s.Write(newBytesToWrite, 0, newBytesToWrite.Length);} public void ModifiedFoo(){ byte[] existingData = System.Text.Encoding.UTF8.GetBytes(""foo""); Stream s2 = new MemoryStream(); // expandable capacity memory stream WriteUnknownDataToStream(s2); // append the data which has been written into s2 to the existingData byte[] buffer = new byte[existingData.Length + s2.Length]; Buffer.BlockCopy(existingData, 0, buffer, 0, existingData.Length); Stream merger = new MemoryStream(buffer, true); merger.Seek(existingData.Length, SeekOrigin.Begin); s2.CopyTo(merger);}",Appending to MemoryStream
C# Multithreading," I have a list of account numbers. Foreach account number I need to call method ProcessAccount. There will be approximately 150,000 accounts that need to be processed and each account could take between .5 to 2 seconds to process. I'd like to setup threading somehow so I can be processing 4 accounts at a time for example. Is there a simple pattern I can use for this?What I'd like to be able to do is start 4 threads processing the first 4 accounts, and then as each individual thread is finished start another thread with the next account until all the accounts have been processed. <code> ",Easy way to process queue with N threads in C#?
Using caslte windsor factory to end the response in MVC?," I am using a castle windsor factory to instantiate an object based on the request url.Something like: In some cases, I actually want to throw a 404 and stop the request, currently like: However the request doesn't end and it still hits the Action and tries to resolve the view?My Controller would look something like this: Am I thinking about this all wrong? Or is there a way I can achieve this?The alternative I was thinking of is an attribute on the action to check the state of the Foo property? <code>  public FooViewModel Get() { if (HttpContext.Current == null) { return new FooViewModel(); } var currentContext = new HttpContextWrapper(HttpContext.Current); // resolve actual view model. throw new HttpException(404, ""HTTP/1.1 404 Not Found""); currentContext.Response.End(); public class HomeController : Controller{ public FooViewModel Foo { get; set; } public ActionResult Index() { ViewBag.Message = ""Modify this template to jump-start your ASP.NET MVC application.""; return View(); }",How can I end a response and send HTTP code 404 back?
Using castle windsor factory to end the response in MVC?," I am using a castle windsor factory to instantiate an object based on the request url.Something like: In some cases, I actually want to throw a 404 and stop the request, currently like: However the request doesn't end and it still hits the Action and tries to resolve the view?My Controller would look something like this: Am I thinking about this all wrong? Or is there a way I can achieve this?The alternative I was thinking of is an attribute on the action to check the state of the Foo property? <code>  public FooViewModel Get() { if (HttpContext.Current == null) { return new FooViewModel(); } var currentContext = new HttpContextWrapper(HttpContext.Current); // resolve actual view model. throw new HttpException(404, ""HTTP/1.1 404 Not Found""); currentContext.Response.End(); public class HomeController : Controller{ public FooViewModel Foo { get; set; } public ActionResult Index() { ViewBag.Message = ""Modify this template to jump-start your ASP.NET MVC application.""; return View(); }",How can I end a response and send HTTP code 404 back?
Why set has Type when property has Type and what use of ByVal when ByRef cannot be used in VB.Net while no such convention in C#," In C#, a property's setter value keyword will automatically be same as the property's type.For example, in C# ,type of value is string If we convert this snippet to VB.Net we get QuestionsWhy does set have this line Set(ByVal value As String)? Shouldn't value typeautomatically be String. This way. What's the use of that?I cannot change BYVal to ByRef (I tried, it gives error), then what's use of that also? <code>  private string str = string.Empty;public string MyText { get { return str; } set { str = value; }} Private str As String = String.EmptyPublic Property MyText() As String Get Return str End Get Set(ByVal value As String) str = value End SetEnd Property Private str As String = String.EmptyPublic Property MyText() As String Get Return str End Get Set str = value End SetEnd Property",Why does the setter of a VB.NET property require a typed argument and why is it ByVal?
How can I set the task manager description for my program?," I have a CLI program and I'd like to modify the description shown for it in Windows Task Manager.I tried setting Description in the Assembly Info, but this only changes the .exe's Properties > Details. <code> ",How can I set the Task Manager description for my program?
Disabling close button in C#, How can I disable the close button of a form like in the image below? (the image below show a MessageBox window)The MessageBox above was generated by me! I want to disable the close button of a normal form. <code> ,Can I disable the 'close' button of a form using C#?
How can I disable the 'close' button of a form using C#?, How can I disable the close button of a form like in the image below? (the image below show a MessageBox window)The MessageBox above was generated by me! I want to disable the close button of a normal form. <code> ,Can I disable the 'close' button of a form using C#?
hot to get clicked cell column name in Devepress.XtraGrid.GridControl, I can't get column name of clicked cell in GridControl of XtraGrid. How can I do that? I'm handling GridView.Click event. <code> ,How to get clicked cell column in DevExpress XtraGrid
Hot to get clicked cell column in DevExpress XtraGrid, I can't get column name of clicked cell in GridControl of XtraGrid. How can I do that? I'm handling GridView.Click event. <code> ,How to get clicked cell column in DevExpress XtraGrid
how to display a message in windows store apps using c# for windows 8, How to display a message box in windows 8 apps using c# like calling MessageBox.Show() in windows phone 7? <code> ,How to display a message in Windows Store Apps?
Hhow to display a message in windows store apps?, How to display a message box in windows 8 apps using c# like calling MessageBox.Show() in windows phone 7? <code> ,How to display a message in Windows Store Apps?
C# any way to find word in string without split," I have some strings: I have to write a program to find string where preffered word existsE.g: find string where ""on"" is, so I need to get only ""roses on bed"".I used this code: but I get all strings because IndexOf finds ""on"" in all of them.Is there any other solution to find separate word in string without splitting?Maybe it is possible to use Linq or Regex? but I'm not good at using them so would be nice to have any examples. <code>  ""rose with ribbon""""roses in concrete""""roses on bed"" foreach (KeyWord key in cKeyWords){ foreach (string word in userWords) { if (key.keyWord.IndexOf(word) != -1) { ckeyList.Add(key); } }}",Any way to find word in string without split
"Parse String in format ""Name <Email>"""," I have a method which receives a contact in one of the following formats:1 - ""email@domain.com""2 - ""Name <email@domain.com>"" OR ""Name<email@domain.com>"" (Spaces can exist)If it is in format (1) I do nothing. In case of (2) I need to parse the name and email.I never know in which format I will get the emails. But it will be one of the two.How can I do this? <code> ","How To Parse String in format ""Name <Email>"""
How do i use Form.ShowDialog?," When I click the button, I see the new Form and the textBox1 in the new Form. And I can type in the textBox1 something, but I can't see anywhere an OK or CANCEL buttons. Should I add them manualy in the new Form designer? And how to use them then?This is the code in my new Form what I wanted to do is to type something in the new Form textBox1 and pass the text in the textBox1 to Form1 label4. So where are the OK and CANCEL buttons of the Form.ShowDialog? <code>  private void button2_Click(object sender, EventArgs e) { ChangeLink cl = new ChangeLink(); // Show testDialog as a modal dialog and determine if DialogResult = OK. if (cl.ShowDialog() == DialogResult.OK) { // Read the contents of testDialog's TextBox. // cl.AcceptButton.DialogResult = DialogResult.OK; this.label4.Text = cl.textBox1Text; } else { this.label4.Text = ""Cancelled""; } cl.Dispose(); } using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Windows.Forms;namespace GatherLinks{ public partial class ChangeLink : Form { public ChangeLink() { InitializeComponent(); } public string textBox1Text { get { return textBox1Text = textBox1.Text; } set { } } }}",How do I use Form.ShowDialog?
Using predefined list of permissions and custom attributes to manage access-controls," I'm trying to implementing a new permission based access approach for my MVC application; We have several Permission Group and each group contains a list of Permission. for example we have Invoices permission group which contains CreateInvoice,RemoveInvoice,etc permission keys.In this approach each mvc Action should requires a specific permission for execution. I'm trying to do this through CustomAttributes, something like this : To make it easier for developers to remember different Permission Groups and Permission Keys I'm trying to create a pre-defined list of permissions that should be a combination of permission group and permission key. but due to restrictions applied to using attributes arguments in C#I couldn't make it work yet. (I don't want to make an extra large enumurator and put all permission keys in there)my last try was creating an enumerator for each permission group and then define permission keys as enum constants in there : As you can see we have a combination of codes here, the permission group key specified using a PermissionGroup attribute and permission key's code specified as numeral code on each enum constant.the RequirePermission attribute defined as below : but the problem is that objects of type Enum could not be used as Attribute Arguments.Any suggestion/idea is appreciated <code>  public class InvoiceController : Controller { [RequirePermission(Permissions.Invoices.CreateInvoice)] public ActionResult Create() { return View(); } } public class PermissionEnums{ [PermissionGroup(PermissionGroupCode.Invoice)] public enum Invoices { CreateInvoice = 1, UpdateInvoice = 2, RemoveInvoice = 3, ManageAttachments = 4 } [PermissionGroup(PermissionGroupCode.UserAccounts)] public enum UserAccounts { Create = 1, ChangePassword = 2 }} public class RequirePermissionAttribute : Attribute{ private Enum _Permission; public RequirePermissionAttribute(Enum Permission) : base() { _Permission = Permission; }}",C# Attributes : Using enum constants as input parameters
Are `dynamic` COM objects considered managed resources?," I have a dynamic COM object as a private field in my class. I'm not sure whether it is considered managed resource (GC cleans it up), or not. ... When implementing IDispose, should I clean it up as a managed resource (only when Dispose() is called explicitly), or as a native resource (when Dispose(false) is called from the finalizer too)? <code>  private dynamic _comConnector = null; _comConnector = Activator.CreateInstance(Type.GetTypeFromProgID(""SomeProgId"")); private void Dispose(bool disposing){ if (disposing) { // Free managed resources // // --> Should I call Marshal.FinalReleaseComObject(_comConnector) here? } // Free unmanaged resources // // --> Or maybe here?}",Are dynamic COM objects considered managed resources?
Adding metadata to Document uploaded to Sharepoint," I am working on a site that makes use of a web service to upload documents to Sharepoint. I have a web service that works and uploads to Sharepoint. However, I need to add metadata to this file being uploaded, such as first name, last name, date of birth etc from a database record, as well as live data from the site. This data is stuff like a 'Workflow number', 'Agreement number', 'Document Type' which gets generated on the site and is associated to that Member and document.Here is the Code: How can I add metadata to this file being uploaded? <code>  using System;using System.Collections.Generic;using System.IO;using System.Linq;using System.Web;using Microsoft.SharePoint.Client;namespace DCTMAgent{ public class SharePoint { internal void SPUploader(Stream fs, string fn) { ClientContext context = new ClientContext(""http://SharepointSite/Home.aspx""); System.Net.ICredentials creds = System.Net.CredentialCache.DefaultCredentials; context.Credentials = creds; context.RequestTimeout = 60000000; // Time in milliseconds string url = ""/Members/""; string fileName = Path.GetFileName(fn); string fnUrl = url + fn; Microsoft.SharePoint.Client.File.SaveBinaryDirect(context, fnUrl, fs, true); } }}",Adding metadata while uploading documents to Sharepoint
Date Issue Deserializing JSON," I have a javascript function that calls an MVC controller with JSON data: On the server side, within the controller, I can't seem to get past this error: /Date(1347992529530)/ is not a valid value for DateTime.That exception happens when I call Deserialize() (third line in method below): I've been doing some googling, and the above code is my latest attempt to make this work (using the TimeSpanJsonConverter from here). Other approaches show sending only a date to the server, but I have a list of objects that have dates as some properties.Is there an elegant, generally-accepted approach to solving this, or do we still need some kind of ugly work-around? What's the right way to resolve this?=================== End of original question ===================Edit - SOLVED by serializing using JsonConvertSee my answer below (not the crappy work-around in this question).Edit - Crappy work-aroundI created a DTO with the exact same fields as the domain object, except that I made the date fields strings so they would deserialize. Now that I can deserialize it, I'll work on getting the dates into a valid format so I can create domain objects from my DTOs. And I simply just used the DTO for the deserialization: Edit 2 - Converting JavaScript Dates to .NETFor completeness, and in the hopes that I save someone else an hour, this is how I was able to convert the javascript dates: <code>  var specsAsJson = JSON.stringify(specs);$.post('/Home/Save', { jsonData: specsAsJson }); public ActionResult Save(string jsonData) { var serializer = new JavaScriptSerializer(); serializer.RegisterConverters(new[] { new TimeSpanJsonConverter() }); var specs = serializer.Deserialize<List<EquipmentSpecWithParameterlessConstructor>>(jsonData); return View(""Index"", _allTrackerJobs); } public class EquipmentSpecDto{ public string StartTime { get; set; } public string EndTime { get; set; } // more properties here} var specs = serializer.Deserialize<List<EquipmentSpecDto>>(jsonData); foreach (EquipmentSpecDto specDto in specDtos) { // JavaScript uses the unix epoch of 1/1/1970. Note, it's important to call ToLocalTime() // after doing the time conversion, otherwise we'd have to deal with daylight savings hooey. DateTime unixEpoch = new DateTime(1970, 1, 1, 0, 0, 0, DateTimeKind.Utc); Double startMilliseconds = Convert.ToDouble(specDto.StartTime.Substring(6, 13)); Double endMilliseconds = Convert.ToDouble(specDto.EndTime.Substring(6, 13)); DateTime startTime = unixEpoch.AddMilliseconds(startMilliseconds).ToLocalTime(); DateTime endTime = unixEpoch.AddMilliseconds(endMilliseconds).ToLocalTime(); EquipmentSpec spec = new EquipmentSpec(startTime, endTime, specDto.Equipment); specs.Add(spec); }",Proper Way to Convert JSON Date to .NET DateTime During Deserialization
Proper Way to Convert JSON Date to .NET DateTime," I have a javascript function that calls an MVC controller with JSON data: On the server side, within the controller, I can't seem to get past this error: /Date(1347992529530)/ is not a valid value for DateTime.That exception happens when I call Deserialize() (third line in method below): I've been doing some googling, and the above code is my latest attempt to make this work (using the TimeSpanJsonConverter from here). Other approaches show sending only a date to the server, but I have a list of objects that have dates as some properties.Is there an elegant, generally-accepted approach to solving this, or do we still need some kind of ugly work-around? What's the right way to resolve this?=================== End of original question ===================Edit - SOLVED by serializing using JsonConvertSee my answer below (not the crappy work-around in this question).Edit - Crappy work-aroundI created a DTO with the exact same fields as the domain object, except that I made the date fields strings so they would deserialize. Now that I can deserialize it, I'll work on getting the dates into a valid format so I can create domain objects from my DTOs. And I simply just used the DTO for the deserialization: Edit 2 - Converting JavaScript Dates to .NETFor completeness, and in the hopes that I save someone else an hour, this is how I was able to convert the javascript dates: <code>  var specsAsJson = JSON.stringify(specs);$.post('/Home/Save', { jsonData: specsAsJson }); public ActionResult Save(string jsonData) { var serializer = new JavaScriptSerializer(); serializer.RegisterConverters(new[] { new TimeSpanJsonConverter() }); var specs = serializer.Deserialize<List<EquipmentSpecWithParameterlessConstructor>>(jsonData); return View(""Index"", _allTrackerJobs); } public class EquipmentSpecDto{ public string StartTime { get; set; } public string EndTime { get; set; } // more properties here} var specs = serializer.Deserialize<List<EquipmentSpecDto>>(jsonData); foreach (EquipmentSpecDto specDto in specDtos) { // JavaScript uses the unix epoch of 1/1/1970. Note, it's important to call ToLocalTime() // after doing the time conversion, otherwise we'd have to deal with daylight savings hooey. DateTime unixEpoch = new DateTime(1970, 1, 1, 0, 0, 0, DateTimeKind.Utc); Double startMilliseconds = Convert.ToDouble(specDto.StartTime.Substring(6, 13)); Double endMilliseconds = Convert.ToDouble(specDto.EndTime.Substring(6, 13)); DateTime startTime = unixEpoch.AddMilliseconds(startMilliseconds).ToLocalTime(); DateTime endTime = unixEpoch.AddMilliseconds(endMilliseconds).ToLocalTime(); EquipmentSpec spec = new EquipmentSpec(startTime, endTime, specDto.Equipment); specs.Add(spec); }",Proper Way to Convert JSON Date to .NET DateTime During Deserialization
Why am I getting SerialData.Eof," In my SerialPort.DataReceived event handler, I am checking for SerialData.Eof: In my entire development up to this point, I have never hit this exception. But today, when working on a different piece of the protocol, it hit.My question is, what exactly does SerialData.Eof mean? MSDN says: The end of file character was received and placed in the input buffer.I'm dealing with binary data. What is the ""end of file character""?This MSDN Forum Post states that the DCB.EofChar member always gets initialized to 0x1A (Ctrl+Z)In the reference sources for the SerialStream class, at line 1343, we see that indeed: And in Microsoft.Win32.NativeMethods: So does this mean anytime my device sends an 0x1A byte, that I will get a SerialData.Eof event? If that is the case, should I just stop testing for it altogether? <code>  void DataReceived(object sender, SerialDataReceivedEventArgs e) { if (e.EventType == SerialData.Eof) throw new NotImplementedException(""SerialData.Eof""); // ... Read} dcb.EofChar = NativeMethods.EOFCHAR; internal const byte EOFCHAR = (byte) 26; ",SerialData.Eof circumstances
Extension method with constraints on DependencyObject causes WindowsBase to be referenced in dependent assemblies," I created the Class1.GetChild<T>() where T : DependencyObject extension method in lib1.dll assembly. After that, all assemblies that depends on lib1.dll failed to compile with error: The type 'System.Windows.DependencyObject' is defined in an assemebly that is not referenced. You must add a reference to assembly 'WindowsBase' etc...Why dependent assemblies requires WindowsBase even if they don't use GetChild?. To reproduce (vs2010 .net4):lib1.dll (references WindowsBase) lib2.dll (references lib1 but not WindowsBase) .Update:I think there's definitly something when mixing generic methods and extension methods. I tried to demonstrate the issue in the following sample: A, //B, //C -> compile okA, B, //C -> compile ok//A, B, C -> compile okA, //B, C -> raise errorA, B, C -> raise error//A means methodA is commented. As Damien pointed out, type inference might play some role. Still curious to know the ins and outs. <code>  namespace lib1{ public static class Class1 { public static T GetChild<T>(this DependencyObject src) where T : DependencyObject { return default(T); } } public static class Class2 { public static int SomeExtMethod(this string src) { return 0; } }} using lib1;class someClass{ void someFct() { ""foo"".SomeExtMethod(); // error: The type 'System.Windows.DependencyObject' // is defined in an assemebly that is not referenced. // You must add a reference to assembly 'WindowsBase' etc.. }} // lib0.dllnamespace lib0{ public class Class0 { }}// lib1.dllusing lib0;namespace lib1{ public static class Class1 { public static void methodA<T>() where T : Class0 { } // A public static void methodB(Class0 e) { } // B public static void methodC(this int src) { } // C } public static class Class2 { public static void methodD(this String s) { } }}// lib2.dllusing lib1;class someClass{ void someFct() { Class2.methodD(""""); // always compile successfully """".methodD(); // raise the 'must add reference to lib0' error depending on config. see details below. }}",Mixing generic methods and extension methods
Generic extension method with constraint requires extra references," I created the Class1.GetChild<T>() where T : DependencyObject extension method in lib1.dll assembly. After that, all assemblies that depends on lib1.dll failed to compile with error: The type 'System.Windows.DependencyObject' is defined in an assemebly that is not referenced. You must add a reference to assembly 'WindowsBase' etc...Why dependent assemblies requires WindowsBase even if they don't use GetChild?. To reproduce (vs2010 .net4):lib1.dll (references WindowsBase) lib2.dll (references lib1 but not WindowsBase) .Update:I think there's definitly something when mixing generic methods and extension methods. I tried to demonstrate the issue in the following sample: A, //B, //C -> compile okA, B, //C -> compile ok//A, B, C -> compile okA, //B, C -> raise errorA, B, C -> raise error//A means methodA is commented. As Damien pointed out, type inference might play some role. Still curious to know the ins and outs. <code>  namespace lib1{ public static class Class1 { public static T GetChild<T>(this DependencyObject src) where T : DependencyObject { return default(T); } } public static class Class2 { public static int SomeExtMethod(this string src) { return 0; } }} using lib1;class someClass{ void someFct() { ""foo"".SomeExtMethod(); // error: The type 'System.Windows.DependencyObject' // is defined in an assemebly that is not referenced. // You must add a reference to assembly 'WindowsBase' etc.. }} // lib0.dllnamespace lib0{ public class Class0 { }}// lib1.dllusing lib0;namespace lib1{ public static class Class1 { public static void methodA<T>() where T : Class0 { } // A public static void methodB(Class0 e) { } // B public static void methodC(this int src) { } // C } public static class Class2 { public static void methodD(this String s) { } }}// lib2.dllusing lib1;class someClass{ void someFct() { Class2.methodD(""""); // always compile successfully """".methodD(); // raise the 'must add reference to lib0' error depending on config. see details below. }}",Mixing generic methods and extension methods
how to query DBF files date type field in where and between clause," I have a DBF file and I'm trying read it from c# code. I can read files successfully without applying any conditions or applying conditions for varchar type fields.My problem is I have to filter the records from the Date field (type:date). I have tried following ways, above gives a syntax Error: missing operator above gives a data type mismatch error above does not throw any exception, but does not return any records though there are matching records.The same things happens for the where clause as well.What can I do to filter records from a rangeI'm using following code to read it <code>  SELECT * FROM D:\DBFreader\file.dbf where [RDATE] between 2/16/2006 12:00:00 AM and 2/20/2006 12:00:00 AM SELECT * FROM D:\DBFreader\file.dbf where [RDATE] between '2/16/2006 12:00:00 AM' and '2/20/2006 12:00:00 AM' SELECT * FROM D:\DBFreader\file.dbf where [RDATE] between 2/16/2006 and 2/20/2006 OdbcCommand cmd = new OdbcCommand();OdbcDataAdapter da = new OdbcDataAdapter();DataTable dt = new DataTable();using (OdbcConnection connection = new OdbcConnection(connstring)){ connection.Open(); cmd = new OdbcCommand(@""SELECT * FROM D:\DBFreader\file.dbf where [RDATE] between 2/16/2006 12:00:00 AM and 2/20/2006 12:00:00 AM"", connection); cmd.CommandType = CommandType.Text; da.SelectCommand = cmd; da.Fill(dt);}",how to query DBF(dbase) files date type field in where and between clause
Linqpad script take command line arguments," How can I test how my Main method handles command-line arguments in Linqpad? I tried but it errors No overload for method 'Main' takes 0 argumentsEdit: I don't want to run Linqpad from the command-line (that would be tedious), I just want to supply args to the main method somehow (so I can quickly test a Main method). Perhaps like this mock-up: <code>  void Main(string[] args){ args.Dump()}",Give `string[] args` to Linqpad script
"Why is there no ""Local variable might not be initialized before accessing"" compile error on an empty user defined struct?"," The following compiles successfully: Whereas the following yields a ""Use of unassigned local variable"" compile error. It appears that in the first case, the compiler has made some sort of inference that since the struct has no members, they do not need to be initialized. But I'm not sure that this makes sense to me. The compiler could have forced you to initialize the foo variable as new Foo().So, if in C# all local variables must be initialized before accessing, why does the first example compile? <code>  struct Foo {}void Test(){ Foo foo; foo.ToString();} struct Foo{ int i;}void Test(){ Foo foo; foo.ToString();}","Why is there no ""Use of unassigned local variable"" compile error on an empty user defined struct?"
Getting the text from a dialog box spawned by a 3rd party DLL," This is a continuation of my previous question How to supress a dialog box an Inproc COM Server displays.Background:A recap of my situation: I have a Inproc COM Server written in Delphi from a 3rd party. One of the functions I call will display a error message dialog box if it traps a specific type of error. The issue is I am trying to process data in bulk, and the data source I am using is causing that error dialog to pop up a lot (thanks to the answer of my previous question it now auto closes and I was able to run it to completion, it would have shown the dialog box and required someone to press OK 9923 times). The process blocks till the message box is closed.Question:I would like to have better logging of what the error dialog said. However any attempt to get get the body text of the dialog box has failed. I thought I may have been interrupting the dialog before it gets to add the text to it (it is not fully painted yet when I break in the above code). However putting a Application.DoEvents inside StartWindowListener before it starts the enumeration allows the dialog box to fully paint but I still get the same results as I posted with the above code.Doing a Ctrl-C works correctly on the dialog box so I could use that in a pinch, but being that I have to repeat this 9923 times I would like to avoid using that programmatically.Is there any other methods I can try to get the text from the Message box? <code>  //Snipprivate void StartWindowListener(){ //Queue the watcher on the message pump if we are not watching. if (_watcherRunning == false) { _watcherRunning = true; _dummyForm.BeginInvoke(new Action(() => { _watcherRunning = false; //If we are not inside the com object don't enumerate. if (_insideCom == false) return; // Enumerate windows to find dialogs EnumThreadWndProc callback = new EnumThreadWndProc(CheckWindow); EnumThreadWindows(GetCurrentThreadId(), callback, IntPtr.Zero); GC.KeepAlive(callback); })); }}private bool CheckWindow(IntPtr hWnd, IntPtr lp){ // Checks if hWnd is the expected dialog StringBuilder sb = new StringBuilder(260); GetClassName(hWnd, sb, sb.Capacity); if (sb.ToString() == ""TMessageForm"") { //This returns the dialog box's title GetWindowText(hWnd, sb, sb.Capacity); //This returns IntPtr.Zero var hDialogText = GetDlgItem(hWnd, 0xFFFF); if (hDialogText != IntPtr.Zero) GetWindowText(hDialogText, sb, sb.Capacity); //This returns a empty string GetDlgItemText(hWnd, 0xFFFF, sb, sb.Capacity); //Only sees the OK button. IntPtr hCtl = IntPtr.Zero; HashSet<IntPtr> seen = new HashSet<IntPtr>(); while ((hCtl = GetNextDlgGroupItem(hWnd, hCtl, false)) != IntPtr.Zero) { //When we see the same control twice, break out of the loop. if (seen.Add(hCtl) == false) break; GetClassName(hCtl, sb, sb.Capacity); SendMessage(hCtl, WM_GETTEXT, sb.Capacity, sb) //Close the dialog by sending WM_CLOSE to the window SendMessage(hWnd, WM_CLOSE, IntPtr.Zero, IntPtr.Zero); } //Snip... } return true;}//Snip...// P/Invoke declarationsconst int WM_CLOSE = 0x0010;private delegate bool EnumThreadWndProc(IntPtr hWnd, IntPtr lp);[DllImport(""user32.dll"")]private static extern bool EnumThreadWindows(int tid, EnumThreadWndProc callback, IntPtr lp);[DllImport(""user32.dll"")]private static extern int GetClassName(IntPtr hWnd, StringBuilder buffer, int buflen);[DllImport(""user32.dll"")]private static extern IntPtr SendMessage(IntPtr hWnd, int msg, IntPtr wp, IntPtr lp);[DllImport(""kernel32.dll"")]private static extern int GetCurrentThreadId();",Getting the text from a dialog box that does not use a label control?
How to add a group to multiple built-in Ribbon tabs (vsto)," This is VS2010 + Office 2010 add-in. All I want is to add a button (or button group) to multiple built-in tabs. For example, my buttons should be available in both New Mail Message Ribbon and in New Appointment Ribbon. I have tried adding a new tab (in the Visual Designer) but that doesn't seem to work. The button group appears on the New Mail Message tab, but not on the Appointment tab. BTW, I'm using the following IDs: TabNewMailMessage and TabAppointment. <code> ",How to add a group to multiple built-in Ribbon tabs (vsto)?
"How do I properly drop a Milestone onto a Block Timeline in Visio, programmatically"," I'm trying to programmatically create a timeline and markers using the Visio 2010 COM Interops. My code is based off of Chris Castillo's 2 part blog posting (Part 1, Part 2), which is the only semi-complete example I've been able to find on how to do this. However his blog (from 2004) doesn't seem to work right. The milestones are not really connected to the timeline, and updating their date does not get them to move to the right place.Any suggestions or fixes? ... <code>  Imports Microsoft.Office.Interop.VisioImports System.Diagnostics.CodeAnalysisImports System.Runtime.InteropServices Dim VisioApp As New ApplicationDim myDoc As Document = VisioApp.Documents.Add("""")Dim myPage As Page = myDoc.Pages.Item(1)Dim TimelineStencils As Document = VisioApp.Documents.Add(""Timeline Shapes.vss"")Dim theTimeline As ShapeDim theMilestone As ShapeVisioApp.AlertResponse = 1theTimeline = myPage.Drop( TimelineStencils.Masters.ItemU(""Block timeline""), 5.610236, 5.511811)theTimeline.CellsU(""User.visBeginDate"").FormulaU = _ VisioApp.ConvertResult( ""1/1/2004"", VisUnitCodes.visDate, VisUnitCodes.visInches)theTimeline.CellsU(""User.visEndDate"").FormulaU = _ VisioApp.ConvertResult( ""12/31/2004"", VisUnitCodes.visDate, VisUnitCodes.visInches)VisioApp.Addons(""ts"").Run(""/cmd=3"")theMilestone = myPage.Drop( _ TimelineStencils.Masters.ItemU(""Line milestone""), _ 5.610236, 5.511811)theMilestone.CellsU(""User.visMilestoneDate"").FormulaU = _ VisioApp.ConvertResult( ""7/1/2004"", VisUnitCodes.visDate, VisUnitCodes.visInches)VisioApp.AlertResponse = 0",How do I programmatically drop a Milestone onto a Block Timeline in Visio
"How do I drop a Milestone onto a Block Timeline in Visio, programmatically"," I'm trying to programmatically create a timeline and markers using the Visio 2010 COM Interops. My code is based off of Chris Castillo's 2 part blog posting (Part 1, Part 2), which is the only semi-complete example I've been able to find on how to do this. However his blog (from 2004) doesn't seem to work right. The milestones are not really connected to the timeline, and updating their date does not get them to move to the right place.Any suggestions or fixes? ... <code>  Imports Microsoft.Office.Interop.VisioImports System.Diagnostics.CodeAnalysisImports System.Runtime.InteropServices Dim VisioApp As New ApplicationDim myDoc As Document = VisioApp.Documents.Add("""")Dim myPage As Page = myDoc.Pages.Item(1)Dim TimelineStencils As Document = VisioApp.Documents.Add(""Timeline Shapes.vss"")Dim theTimeline As ShapeDim theMilestone As ShapeVisioApp.AlertResponse = 1theTimeline = myPage.Drop( TimelineStencils.Masters.ItemU(""Block timeline""), 5.610236, 5.511811)theTimeline.CellsU(""User.visBeginDate"").FormulaU = _ VisioApp.ConvertResult( ""1/1/2004"", VisUnitCodes.visDate, VisUnitCodes.visInches)theTimeline.CellsU(""User.visEndDate"").FormulaU = _ VisioApp.ConvertResult( ""12/31/2004"", VisUnitCodes.visDate, VisUnitCodes.visInches)VisioApp.Addons(""ts"").Run(""/cmd=3"")theMilestone = myPage.Drop( _ TimelineStencils.Masters.ItemU(""Line milestone""), _ 5.610236, 5.511811)theMilestone.CellsU(""User.visMilestoneDate"").FormulaU = _ VisioApp.ConvertResult( ""7/1/2004"", VisUnitCodes.visDate, VisUnitCodes.visInches)VisioApp.AlertResponse = 0",How do I programmatically drop a Milestone onto a Block Timeline in Visio
Constructor & what feature in .NET," Possible Duplicate: What is the difference between new Thread(void Target()) and new Thread(new ThreadStart(void Target()))? I have a small question about Thread class. This class has 4 constructors: I use the 2nd constructor to create a Thread object: However, I can use a way to create this object without using any constructors I talk above. In this case, ScanDirectory is a void method, it isn't ThreadStart or ParameterizedThreadStart but Thread class still accepts this constructor. Why?I think this is a .NET feature but I don't know how it's implemented. Note: ScanDirectory is a void method. <code>  public Thread(ParameterizedThreadStart start);public Thread(ThreadStart start);public Thread(ParameterizedThreadStart start, int maxStackSize);public Thread(ThreadStart start, int maxStackSize); Thread thread = new Thread(new ThreadStart(ScanDirectory)); Thread thread = new Thread(ScanDirectory);","Why does new Thread() accept a method name, even though none of the constructor overloads seem to allow this?"
download file via jquery ajax web method," I want to download a file using jQuery Ajax web method, but it's not working. Here is my jQuery ajax call to web method: and this is the web method definition: How to get it done?One more thing: I want to download it on client PC, not to save it on server. <code>  function GenerateExcel() { var ResultTable = jQuery('<div/>').append(jQuery('<table/>').append($('.hDivBox').find('thead').clone()).append($('.bDiv').find('tbody').clone())); var list = [$(ResultTable).html()]; var jsonText = JSON.stringify({ list: list }); $.ajax({ type: ""POST"", url: ""GenerateMatrix.aspx/GenerateExcel"", data: jsonText, contentType: ""application/json; charset=utf-8"", dataType: ""json"", success: function (response) { }, failure: function (response) { alert(response.d); } }); } [System.Web.Services.WebMethod()]public static string GenerateExcel(List<string> list){ HttpContext.Current.Response.AppendHeader(""content-disposition"", ""attachment;filename=FileEName.xls""); HttpContext.Current.Response.Charset = """"; HttpContext.Current.Response.Cache.SetCacheability(HttpCacheability.NoCache); HttpContext.Current.Response.ContentType = ""application/vnd.ms-excel""; HttpContext.Current.Response.Write(list[0]); HttpContext.Current.Response.End(); return """";} ",How to download file via jQuery ajax and C#
download file via jquery ajax web method + C#," I want to download a file using jQuery Ajax web method, but it's not working. Here is my jQuery ajax call to web method: and this is the web method definition: How to get it done?One more thing: I want to download it on client PC, not to save it on server. <code>  function GenerateExcel() { var ResultTable = jQuery('<div/>').append(jQuery('<table/>').append($('.hDivBox').find('thead').clone()).append($('.bDiv').find('tbody').clone())); var list = [$(ResultTable).html()]; var jsonText = JSON.stringify({ list: list }); $.ajax({ type: ""POST"", url: ""GenerateMatrix.aspx/GenerateExcel"", data: jsonText, contentType: ""application/json; charset=utf-8"", dataType: ""json"", success: function (response) { }, failure: function (response) { alert(response.d); } }); } [System.Web.Services.WebMethod()]public static string GenerateExcel(List<string> list){ HttpContext.Current.Response.AppendHeader(""content-disposition"", ""attachment;filename=FileEName.xls""); HttpContext.Current.Response.Charset = """"; HttpContext.Current.Response.Cache.SetCacheability(HttpCacheability.NoCache); HttpContext.Current.Response.ContentType = ""application/vnd.ms-excel""; HttpContext.Current.Response.Write(list[0]); HttpContext.Current.Response.End(); return """";} ",How to download file via jQuery ajax and C#
How to download file via jquery ajax and C#," I want to download a file using jQuery Ajax web method, but it's not working. Here is my jQuery ajax call to web method: and this is the web method definition: How to get it done?One more thing: I want to download it on client PC, not to save it on server. <code>  function GenerateExcel() { var ResultTable = jQuery('<div/>').append(jQuery('<table/>').append($('.hDivBox').find('thead').clone()).append($('.bDiv').find('tbody').clone())); var list = [$(ResultTable).html()]; var jsonText = JSON.stringify({ list: list }); $.ajax({ type: ""POST"", url: ""GenerateMatrix.aspx/GenerateExcel"", data: jsonText, contentType: ""application/json; charset=utf-8"", dataType: ""json"", success: function (response) { }, failure: function (response) { alert(response.d); } }); } [System.Web.Services.WebMethod()]public static string GenerateExcel(List<string> list){ HttpContext.Current.Response.AppendHeader(""content-disposition"", ""attachment;filename=FileEName.xls""); HttpContext.Current.Response.Charset = """"; HttpContext.Current.Response.Cache.SetCacheability(HttpCacheability.NoCache); HttpContext.Current.Response.ContentType = ""application/vnd.ms-excel""; HttpContext.Current.Response.Write(list[0]); HttpContext.Current.Response.End(); return """";} ",How to download file via jQuery ajax and C#
MVC4 WebAPI routing based on query string parameter name," I'm trying to configure routing in my MVC4 WebAPI project.I want to be able to search for products based on their name or their type like so:/api/products?name=WidgetX - returns all products named WidgetX/api/products?type=gadget - returns all products of type gadgetThe routes are configured like this: The problem is that the name of the query string parameter seems to be ignored so the first route is always the one used, regardless the name of the query string parameter.How can I modify my route to get it right? <code>  config.Routes.MapHttpRoute( name: ""Get by name"", routeTemplate: ""api/products/{name}"", defaults: new { controller = ""ProductSearchApi"", action = ""GetProductsByName"", name = string.Empty });config.Routes.MapHttpRoute( name: ""Get by type"", routeTemplate: ""api/products/{type}"", defaults: new { controller = ""ProductSearchApi"", action = ""GetProductsByType"", type = string.Empty });",Routing based on query string parameter name
Loading an assembly targetted for .NET 4.5 on a .NET 4.0 app domain," Assuming the system has .NET 4.0 and .NET 4.5 installed.Is it possible to load and work with a .NET 4.5 assembly from an assembly written targeting .NET 4.0?Simply put, can I call Assembly.Load from .NET 4.0 code to load a .NET 4.5 targeting assembly? <code> ",Loading an assembly targeted for .NET 4.5 on a .NET 4.0 app domain
CasteWindsor MVC4 and WEBAPI same application : only if MVC controllers have no dependencies?," This article is a good starting point for doing Web API with Castle Windsor, but what if I create a simple MVC controller? It only works if there is no dependency into the inject.Adding this one, i.e.: Causes the following error : parameterless constructor defined for this objectIs there a way to have MVC and Web API logic in a same application using Castle Windsor?After setting DependencyResolver.SetResolver(...) in application_start, I didn't notice any improvement in my application.As you can see. Implementing the service locator : took me back to the starting point.Finally solved.Here's the solution for someone elseIn application_start... And the registration for both mvc and web api controller <code>  public class HomeController : Controller{ private readonly IValuesRepository repository; public HomeController(IValuesRepository repository) { this.repository = repository; } public ActionResult Index() { return View(); }} internal sealed class WindsorDependencyResolver : ServiceLocatorImplBase, IDependencyResolver{ private readonly IWindsorContainer container; public WindsorDependencyResolver( IWindsorContainer container) { if (container == null) { throw new ArgumentNullException(""container""); } this.container = container; } public object GetService(Type t) { return this.container.Kernel.HasComponent(t) ? this.container.Resolve(t) : null; } public IEnumerable<object> GetServices(Type t) { return this.container.ResolveAll(t) .Cast<object>().ToArray(); } public IDependencyScope BeginScope() { return new WindsorDependencyScope(this.container); } public void Dispose() { } protected override object DoGetInstance( Type serviceType, string key) { if (key != null) return container.Resolve(key, serviceType); return container.Resolve(serviceType); } protected override IEnumerable<object> DoGetAllInstances( Type serviceType) { return (object[])container.ResolveAll(serviceType); } //mvcDependencyResolver.SetResolver( new WindsorMvcDependencyResolver(container));// web api:var httpDependencyResolver = new WindsorHttpDependencyResolver(container);GlobalConfiguration.Configuration.DependencyResolver = httpDependencyResolver;internal class WindsorMvcDependencyResolver : WindsorDependencyScope, IDependencyResolver{ private readonly IWindsorContainer container; public WindsorMvcDependencyResolver( IWindsorContainer container) : base(container) { this.container = container; }}internal sealed class WindsorHttpDependencyResolver : IDependencyResolver{ private readonly IWindsorContainer container; public WindsorHttpDependencyResolver( IWindsorContainer container) { if (container == null) { throw new ArgumentNullException(""container""); } this.container = container; } public object GetService(Type t) { return this.container.Kernel.HasComponent(t) ? this.container.Resolve(t) : null; } public IEnumerable<object> GetServices(Type t) { return this.container.ResolveAll(t) .Cast<object>().ToArray(); } public IDependencyScope BeginScope() { return new WindsorDependencyScope(this.container); } public void Dispose() { }}internal class WindsorDependencyScope : IDependencyScope{ private readonly IWindsorContainer container; private readonly IDisposable scope; public WindsorDependencyScope( IWindsorContainer container) { if (container == null) { throw new ArgumentNullException(""container""); } this.container = container; this.scope = container.BeginScope(); } public object GetService(Type t) { return this.container.Kernel.HasComponent(t) ? this.container.Resolve(t) : null; } public IEnumerable<object> GetServices(Type t) { return this.container.ResolveAll(t) .Cast<object>().ToArray(); } public void Dispose() { this.scope.Dispose(); }} container.Register(Classes .FromAssemblyContaining<HomeController>() .BasedOn<Controller>() .LifestylePerWebRequest());container.Register(Classes .FromAssemblyContaining<ValuesController>() .BasedOn<IHttpController>() .LifestyleScoped());",Castle Windsor ASP.NET MVC 4 and Web API same application. Only if MVC controllers have no dependencies?
Caste Windsor ASP.NET MVC 4 and Web API same application. Only if MVC controllers have no dependencies?," This article is a good starting point for doing Web API with Castle Windsor, but what if I create a simple MVC controller? It only works if there is no dependency into the inject.Adding this one, i.e.: Causes the following error : parameterless constructor defined for this objectIs there a way to have MVC and Web API logic in a same application using Castle Windsor?After setting DependencyResolver.SetResolver(...) in application_start, I didn't notice any improvement in my application.As you can see. Implementing the service locator : took me back to the starting point.Finally solved.Here's the solution for someone elseIn application_start... And the registration for both mvc and web api controller <code>  public class HomeController : Controller{ private readonly IValuesRepository repository; public HomeController(IValuesRepository repository) { this.repository = repository; } public ActionResult Index() { return View(); }} internal sealed class WindsorDependencyResolver : ServiceLocatorImplBase, IDependencyResolver{ private readonly IWindsorContainer container; public WindsorDependencyResolver( IWindsorContainer container) { if (container == null) { throw new ArgumentNullException(""container""); } this.container = container; } public object GetService(Type t) { return this.container.Kernel.HasComponent(t) ? this.container.Resolve(t) : null; } public IEnumerable<object> GetServices(Type t) { return this.container.ResolveAll(t) .Cast<object>().ToArray(); } public IDependencyScope BeginScope() { return new WindsorDependencyScope(this.container); } public void Dispose() { } protected override object DoGetInstance( Type serviceType, string key) { if (key != null) return container.Resolve(key, serviceType); return container.Resolve(serviceType); } protected override IEnumerable<object> DoGetAllInstances( Type serviceType) { return (object[])container.ResolveAll(serviceType); } //mvcDependencyResolver.SetResolver( new WindsorMvcDependencyResolver(container));// web api:var httpDependencyResolver = new WindsorHttpDependencyResolver(container);GlobalConfiguration.Configuration.DependencyResolver = httpDependencyResolver;internal class WindsorMvcDependencyResolver : WindsorDependencyScope, IDependencyResolver{ private readonly IWindsorContainer container; public WindsorMvcDependencyResolver( IWindsorContainer container) : base(container) { this.container = container; }}internal sealed class WindsorHttpDependencyResolver : IDependencyResolver{ private readonly IWindsorContainer container; public WindsorHttpDependencyResolver( IWindsorContainer container) { if (container == null) { throw new ArgumentNullException(""container""); } this.container = container; } public object GetService(Type t) { return this.container.Kernel.HasComponent(t) ? this.container.Resolve(t) : null; } public IEnumerable<object> GetServices(Type t) { return this.container.ResolveAll(t) .Cast<object>().ToArray(); } public IDependencyScope BeginScope() { return new WindsorDependencyScope(this.container); } public void Dispose() { }}internal class WindsorDependencyScope : IDependencyScope{ private readonly IWindsorContainer container; private readonly IDisposable scope; public WindsorDependencyScope( IWindsorContainer container) { if (container == null) { throw new ArgumentNullException(""container""); } this.container = container; this.scope = container.BeginScope(); } public object GetService(Type t) { return this.container.Kernel.HasComponent(t) ? this.container.Resolve(t) : null; } public IEnumerable<object> GetServices(Type t) { return this.container.ResolveAll(t) .Cast<object>().ToArray(); } public void Dispose() { this.scope.Dispose(); }} container.Register(Classes .FromAssemblyContaining<HomeController>() .BasedOn<Controller>() .LifestylePerWebRequest());container.Register(Classes .FromAssemblyContaining<ValuesController>() .BasedOn<IHttpController>() .LifestyleScoped());",Castle Windsor ASP.NET MVC 4 and Web API same application. Only if MVC controllers have no dependencies?
Excel interop MissingmethodException," In my C# program, I am using Excel 2010 interop assembly. With this i am reading & writing data to excel file. And executing fine on dev box (contains Office 2010). On client machine, even though they have Office 2010 and Office PIA, there are seeing below exception, raises at WriteToExcel() method call. Below is my code snippet. <code>  Unhandled Exception: System.MissingMethodException: Method not found: 'System.Type System.Runtime.InteropServices.Marshal.GetTypeFromCLSID(System.GUID)'. [STAThread]static void Main(string[] args){ // read user input, process and write data to Excel WriteToExcel(); }[STAThread]static void WriteToExcel(){ Application xlsApplication = new Application(); Workbook xlsWorkbook = xlsApplication.Workbooks.Open(excelFilePath); // write data to excel // close up }",Excel interop MissingMethodException
Comparing arrays content in c#?," I have 2 arrays : I need to check if they are equal ( not by ref)What is the difference between writing : vs both returns True..When should I use each ?  <code>  int[] arr1 = new int[] { 1, 2, 3 }; int[] arr2 = new int[] { 1, 2, 3 }; Console.WriteLine(arr1.SequenceEqual(arr2)); //true IStructuralEquatable eqArray1 = arr1; Console.WriteLine(eqArray1.Equals(arr2, StructuralComparisons.StructuralEqualityComparer)); //true","Comparing arrays content, difference of SequenceEqual and StructuralComparisons.StructuralEqualityComparer"
Comparing arrays content?," I have 2 arrays : I need to check if they are equal ( not by ref)What is the difference between writing : vs both returns True..When should I use each ?  <code>  int[] arr1 = new int[] { 1, 2, 3 }; int[] arr2 = new int[] { 1, 2, 3 }; Console.WriteLine(arr1.SequenceEqual(arr2)); //true IStructuralEquatable eqArray1 = arr1; Console.WriteLine(eqArray1.Equals(arr2, StructuralComparisons.StructuralEqualityComparer)); //true","Comparing arrays content, difference of SequenceEqual and StructuralComparisons.StructuralEqualityComparer"
Convert string to int in a linq query and handling the parsing exception," I've got this problem, I have a table for purchases I want is to create a new record, so I need the Max(Number), the problem here is that Number is a string, I've tried but it could throw an exception, I've create a custom ToInt() extension so when I use it throws an exception saying that my ToInt() can't be used with linq query same as the famous ToString()so my question is : is there a way to cast a string to int in linq query & handling exceptions at the same time or to integrate custom functions to a linq query !!and this's my extension <code>  Purchases(Date DateTime, Number string) Purchases.Select(X=>int.Parse(X.Number)).Max() Purchases.Select(X=>X.Number.ToInt()).Max() public static int ToInt(this string s) { try { return int.Parse(s); } catch { } return 0; }",Convert string to int in an Entity Framework linq query and handling the parsing exception
Task.WaitAny and Unobserved Exceptions," Let's say I have three tasks, a, b, and c. All three are guaranteed to throw an exception at a random time between 1 and 5 seconds. I then write the following code: This will ultimately throw an exception from whichever task faults first. Since there's no try...catch here, this exception will bubble up to some other place in my code.What happens when the remaining two tasks throw an exception? Aren't these unobserved exceptions, which will cause the entire process to be killed? Does that mean that the only way to use WhenAny is inside of a try...catch block, and then somehow observe the remaining two tasks before continuing on?Follow-up: I'd like the answer to apply both to .NET 4.5 and .NET 4.0 with the Async Targeting Pack (though clearly using TaskEx.WhenAny in that case). <code>  await Task.WhenAny(a, b, c);",Task.WhenAny and Unobserved Exceptions
call main method of a console application from a form application(with a button click event)," How can I access and run a console application from a windows form, which is part of the same project. I have a windows form and a console application. I think that I can publish the console application and then use Process.Start(path to console app) but this is not what I want. I want to access and use the Main method of the console application in my form project. This method would run at a click on a button.This gives the following error. InvalidOperationException was unhandled Cannot read keys when either application does not have a console or when console input has been redirected from a file. Try Console.Read. Here are the methods.ConsoleApp: Form1: <code>  private void buttonApplication_Click(object sender, EventArgs e){ Ch15Extra_2.Program.Main();} namespace Ch15Extra_2{ public class Program { public static void Main() { Console.WriteLine(""Here the app is running""); Console.ReadKey(); } }} private void buttonApplication_Click(object sender, EventArgs e) { }",Calling `Main` method of a console application from a form application (by a button click event)
Why is this Array.BinarySearch() giving negative numbers?," I have some code that isn't making much sense to me. I have an array of strings and I'm using a binary search to count them in a foreach() loop. The code is exactly the same both times I attempt output, other than sorting. I'm not sure why I'm getting the results I'm getting. I assume it should just count the array values the same way both time. Any help?Code: Output: I'm sure it's something entirely stupid, but I can't figure it out. <code>  using System;public class Driver { public static void Main(string [] args) { String [] s = {""Bob"", ""Jane"", ""Will"", ""Bill"", ""Liz""}; Console.WriteLine(""Before Sorting:\n----------""); foreach(string item in s) { Console.WriteLine(""{0}. {1}"", Array.BinarySearch(s, item) + 1, item); } Console.WriteLine(""Will is at position {0}"", Array.BinarySearch(s, ""Will"") + 1); Console.WriteLine(""\n\nAfter Sorting:\n----------""); Array.Sort(s); foreach(string item in s) { Console.WriteLine(""{0}. {1}"", Array.BinarySearch(s, item) + 1, item); } Console.WriteLine(""Will is at position {0}"", Array.BinarySearch(s, ""Will"") + 1); }} Before Sorting:----------1. Bob2. Jane3. Will0. Bill-2. LizWill is at position 3After Sorting:----------1. Bill2. Bob3. Jane4. Liz5. WillWill is at position 5",Why Array.BinarySearch() giving negative numbers?
Pragmatically set TextBlock Foreground Color," Is there a way to do this in Windows Phone 7?I can reference the TextBlock in my C# Code, but I don't know exactly how to then set the foreground color of it. Thanks <code>  myTextBlock.Foreground = //not a clue...",Programmatically set TextBlock Foreground Color
C# How do I make a program which counts the number of comparisons made in a binary search.," I have the task of creating two seperate programs, one linear search program, which I have already completed, and a binary search program. These programs must also count the number of comparisons made during the search process. My linear search program already counts the number of comparisons made while my binary search program cannot. The code for the binary search looks like this: If anybody can tell me how to modify it to count comparisons it would be greatly appreciated. Many thanks, Matthew.  <code>  using System;using System.Collections.Generic;public class Example{public static void Main(){ Console.WriteLine(""Input number you would like to search for""); String Look_for = Console.ReadLine(); int Lookfor; int.TryParse(Look_for, out Lookfor); { List<int> numbers = new List<int>(); numbers.Add(1); numbers.Add(2); numbers.Add(3); numbers.Add(4); numbers.Add(5); numbers.Add(6); numbers.Add(7); numbers.Add(8); Console.WriteLine(); foreach (int number in numbers) { Console.WriteLine(number); } int answer = numbers.BinarySearch(Lookfor); Console.WriteLine(""The numbers was found at:""); Console.WriteLine(answer); } }}",Count number of comparisons made for BinarySearch
Can't connect to localhost on SQL Server Express 2012, I just downloaded the latest version of SQL Express 2012 but I cannot connect to localhost. I tried localhost\SQLExpress and Windows authentication but it gives me an error message saying cannot connect. Am I missing something here? I've used SQL Server 2008 before and I've never had issues connecting to localhost. It seems that it can't even find it. Also in the Services I only see a SQL Server VSS Writer. Is this the way it should be? Or am I missing something? Thanks <code> ,Can't connect to localhost on SQL Server Express 2012 / 2016
List<T> fireing Event on Change," I created a Class EventList inheriting List which fires an Event each time something is Added, Inserted or Removed: At the Moment I use it as a Property like this: Now my Problem is, can I somehow handle if a new Object is referred to it or prevent that, so I do not have to do the event wiring stuff in the setter?Of course, I can change the property to ""private set"" but I would like to be able to use the class as variable as well. <code>  public class EventList<T> : List<T>{ public event ListChangedEventDelegate ListChanged; public delegate void ListChangedEventDelegate(); public new void Add(T item) { base.Add(item); if (ListChanged != null && ListChanged.GetInvocationList().Any()) { ListChanged(); } } ...} public EventList List{ get { return m_List; } set { m_List.ListChanged -= List_ListChanged; m_List = value; m_List.ListChanged += List_ListChanged; List_ListChanged(); }}",List<T> firing Event on Change
"C# - Since WebClient's uploadData doesn't encode data, then what will be the effect of adding a ""Content-Type"", ""multipart/form-data"" header to it"," C#'s uploadData method doesn't encode the data that is being sent. So, if I send a file over (after converting it into bytes) using this method, and the receiving side is looking for a multiform/form-data post, then it will obviously not work. Will adding a header like : make it send the data encrypted as multiform, or will the data be still not encrypted (and hence unparseable by servers expecting multiform data) ?Note that I can't use WebClient's uploadFile, as I don't have permission to get the file path location on the client side (I just have a stream, that I can convert to bytes) <code>  WebClient c = new WebClient();c.Headers.Add(""Content-Type"", ""multipart/form-data"");","Since WebClient's uploadData doesn't encode data, then what will be the effect of adding a ""Content-Type"", ""multipart/form-data"" header to it"
How to automatically update an application without click-once," For the project I am working on, I am not allowed to use ClickOnce. My boss wants the program to look ""real"" (with an installer, etc).I have installed Visual Studio 2012 Professional, and have been playing around with the InstallShield installer, and it definitely makes nice installers, but I can't figure out how to enable the application to ""auto-update"" (that is, when it starts up, checks to make sure that it is using the latest version).I have been asked to make a tiny change to the code - switching an addition to a subtraction, and I don't really want people to have to uninstall the old version, and then have to reinstall the new version every time I make a small change like this.How can I make the application check for updates, and install them? Or is this not possible (or not easy)? <code> ",How to automatically update an application without ClickOnce?
How to determine the effective permissions for a user of a SQL DB through C#?," When I say effective permissions, I'm referring to the permissions listed when you go into the properties of a database in SQL Server Management Studio, click ""Permissions"", and then click the ""Effective"" tab.So far, I have been able to determine the explicit permissions with the following code: However, I still need to obtain the effective permissions. In this scenario, I added a login for a user and gave it the role of db_datareader and db_datawriter for a database through the User Mapping. In the permissions for the database, the effective permissions listed are CONNECT, DELETE, INSERT, SELECT, and UPDATE, but the explicit permissions only list connect (which is the only thing that the above code pulls back). So is there a way to programmatically retrieve the effective permissions as well? Thanks. <code>  using Microsoft.SqlServer.Management.Smo;...DatabasePermissionInfo[] permissions = database.EnumDatabasePermissions(""username"");",How to determine the effective permissions for a user of a SQL Server database through C#?
Working with System.Threading.Timer in C#," I've a timer object. I want it to be run every minute. Specifically, it should run a OnCallBack method and gets inactive while a OnCallBack method is running. Once a OnCallBack method finishes, it (a OnCallBack) restarts a timer.Here is what I have right now: However, it seems to be not working. It runs very fast every 3 second. Even when if raise a period (1000*10). It seems like it turns a blind eye to 1000 * 10What did I do wrong? <code>  private static Timer timer;private static void Main(){ timer = new Timer(_ => OnCallBack(), null, 0, 1000 * 10); //every 10 seconds Console.ReadLine();}private static void OnCallBack(){ timer.Change(Timeout.Infinite, Timeout.Infinite); //stops the timer Thread.Sleep(3000); //doing some long operation timer.Change(0, 1000 * 10); //restarts the timer}",System.Threading.Timer in C# it seems to be not working. It runs very fast every 3 second
MVC3: CompareAttribute for case insensitive comparison," I am using CompareAttribute in MVC3 and its working fine. But I want to use case insensitive classCode. Is there any way to get that workingThanks in Advance <code>  [CompareAttribute(""ClassCode"", ErrorMessageResourceName = ""ClassCode_DontMatch"", ErrorMessageResourceType = typeof(Resources.Class))]public string ConfirmClassCode {get; set; }",CompareAttribute for case insensitive comparison
gridview hyperlink field in c#," Take a look at the following code: It takes only the name id to navigate to the next page. How will I include the two other parameters which are not in the gridview. The navigate URL I'm using has to take the keyword which is already present in the gridview and the other two parameters from the database table. I tried using all these codes. Nothing did work for me. I cant use the above the code because the state and city are not in the GridView but available in my data table.I tried using the following code too, but it doesn't work: I also tried this: .aspx.cs I don't know how to solve this. <code>  <asp:HyperLinkField DataNavigateUrlFields=""NameID"" DataNavigateUrlFormatString=""names.aspx?nameid={0}"" DataTextField=""name"" HeaderText=""Name"" ItemStyle-Width=""100px"" ItemStyle-Wrap=""true"" /> <asp:HyperLinkField DataTextField=""Keyword"" DataNavigateUrlFields=""Keyword"" DataNavigateUrlFormatString=""KeywordSrchSumDtl.aspx?Keyword={0}&State={1}&City={2}"" HeaderStyle-VerticalAlign=""Bottom"" ItemStyle-HorizontalAlign=""center"" /> <asp:TemplateField HeaderText=""Keyword"" ItemStyle-HorizontalAlign=""Center"" FooterStyle-HorizontalAlign=""Center""> <ItemTemplate> <asp:HyperLink ID=""link"" runat=""server"" NavigateUrl='<% # ""KeywordSrchSumDtl.aspx?Keyword=""Eval(""Keyword"")+""&State=""+Request.QueryString[""State""]%>' Text='<%# Eval(""Keyword"") %>'> </asp:HyperLink> </ItemTemplate></asp:TemplateField> <asp:HyperLink ID=""Link1"" runat=""Server"" NavigateUrl='<%#redirectURL()+Server.UrlEncode((Eval(""Keyword"")).ToString())%>' Text='<%# DataBinder.Eval(Container.DataItem,""Keyword"") %>'> </asp:HyperLink> </ItemTemplate></asp:TemplateField> return ""KeywordSrchSumDtl.aspx?Keyword="" + //I DONNO HOW TO CALL THE KEYWORD HERE// + ""&State="" + System.Web.HttpContext.Current.Request.QueryString[""State""] + ""&City="" + System.Web.HttpContext.Current.Request.QueryString[""City""];",GridView HyperLink field in C#
Adding Stored Procedures Complex Types in Entity Framework," I am trying to use a stored procedure in Entity Framework that returns nothing.I did the following:Added a function (right click on stored procedure -> add -> function import-> Complex Type -> Get column information -> create New Complex-Type)My function name: summarySP_Result. After building the project the entity class is not generated in Generated_code (BusinessAccount.web.g.cs)But entity classes for tables and views are all created but nor for stored procedure.Can anybody give the idea why it is not generated entity class in BusinessAccount.web.g.cs?Update : Let me confirm ReturnDataFromTemTable_result entity class created in your XXXXXX.web.g.cs class.Like :  <code>  [DataContract(Namespace=""http://schemas.datacontract.org/2004/07/BizFramework.Web.Model"")]public sealed partial class ReturnDataFromTemTable_Result : Entity{ ------------------- }",Adding stored procedures complex types in Entity Framework
asp.net WebApi + KnockoutJs - post collection of different objects," I have a requirement for users to edit a list of quotes for a lead, the quotes can be different types such as:QuoteForProductTypeA QuoteForProductTypeBAll quote types share a common base class, such as QuoteBase.I have my quotes displaying fine on the front end, and appear to post back the correct data too.However, on the server it doesn't obviously doesn't know which subclass to use, so just uses the base class.I think i need some kind of custom model binder for WebApi to check for a hidden field such as ModelType which contains the type of the object in the collection, the model binder then creates a new object of this type and binds the properties from my posted values to this object.However, i am stuck at this point with very little documentation / blogs on how to do this.I have checked the source code for WebApi to see if i can extend a default model binder, but any defaults are sealed classes.I can only implement IModelBinder by the looks of it, i can create the correct model type by looking for a value called ModelType, but then i'm not sure how to fill the rest of the values in my subclasses, if there was a default model binder i was inheriting from i would just call the base classes bind method. <code> ",Posting a collection of subclasses
Asp.Net WebApi - Posting collection of subclasses," I have a requirement for users to edit a list of quotes for a lead, the quotes can be different types such as:QuoteForProductTypeA QuoteForProductTypeBAll quote types share a common base class, such as QuoteBase.I have my quotes displaying fine on the front end, and appear to post back the correct data too.However, on the server it doesn't obviously doesn't know which subclass to use, so just uses the base class.I think i need some kind of custom model binder for WebApi to check for a hidden field such as ModelType which contains the type of the object in the collection, the model binder then creates a new object of this type and binds the properties from my posted values to this object.However, i am stuck at this point with very little documentation / blogs on how to do this.I have checked the source code for WebApi to see if i can extend a default model binder, but any defaults are sealed classes.I can only implement IModelBinder by the looks of it, i can create the correct model type by looking for a value called ModelType, but then i'm not sure how to fill the rest of the values in my subclasses, if there was a default model binder i was inheriting from i would just call the base classes bind method. <code> ",Posting a collection of subclasses
C# - Sending and Receiving UDP packets," The following code sends a packet on port 15000: However, it's kind of useless if I can't then receive it on another computer. All I need is to send a command to another computer on the LAN, and for it to receive it and do something.Without using a Pcap library, is there any way I can accomplish this? The computer my program is communicating with is Windows XP 32-bit, and the sending computer is Windows 7 64-bit, if it makes a difference. I've looked into various net send commands, but I can't figure them out.I also have access to the computer (the XP one)'s local IP, by being able to physically type 'ipconfig' on it.EDIT: Here's the Receive function I'm using, copied from somewhere: I'm calling ReceiveBroadcast(15000) but there's no output at all. <code>  int port = 15000;UdpClient udp = new UdpClient();//udp.EnableBroadcast = true; //This was suggested in a now deleted answerIPEndPoint groupEP = new IPEndPoint(IPAddress.Broadcast, port);string str4 = ""I want to receive this!"";byte[] sendBytes4 = Encoding.ASCII.GetBytes(str4);udp.Send(sendBytes4, sendBytes4.Length, groupEP);udp.Close(); public void ReceiveBroadcast(int port){ Debug.WriteLine(""Trying to receive...""); UdpClient client = null; try { client = new UdpClient(port); } catch (Exception ex) { Debug.WriteLine(ex.Message); } IPEndPoint server = new IPEndPoint(IPAddress.Broadcast, port); byte[] packet = client.Receive(ref server); Debug.WriteLine(Encoding.ASCII.GetString(packet));}",Sending and Receiving UDP packets
"Detect Two, Three, Four etc. Finger Swipe in WinRT App"," I have the following code: I can handle 1 finger swipe gesture very easily, but I want to handle 2, 3, 4 fingers swipe gestures also. Can anyone tell me how to do that? <code>  private Point initialpoint;private void ManipulationStarted(object sender, ManipulationStartedRoutedEventArgs e){ initialpoint = e.Position;}private void ManipulationDelta(object sender, ManipulationDeltaRoutedEventArgs e){ Point currentpoint = e.Position; if (currentpoint.X - initialpoint.X >= 100) { System.Diagnostics.Debug.WriteLine(""Swipe Right""); e.Complete(); }}","Handling Two, Three, Four Fingers Swipe Gestures in WinRT App"
"Detect Two, Three, Four Fingers Swipe in WinRT App"," I have the following code: I can handle 1 finger swipe gesture very easily, but I want to handle 2, 3, 4 fingers swipe gestures also. Can anyone tell me how to do that? <code>  private Point initialpoint;private void ManipulationStarted(object sender, ManipulationStartedRoutedEventArgs e){ initialpoint = e.Position;}private void ManipulationDelta(object sender, ManipulationDeltaRoutedEventArgs e){ Point currentpoint = e.Position; if (currentpoint.X - initialpoint.X >= 100) { System.Diagnostics.Debug.WriteLine(""Swipe Right""); e.Complete(); }}","Handling Two, Three, Four Fingers Swipe Gestures in WinRT App"
Windows service with timer c#.net," I have created a windows service with timer in c#.net. it works fine while i debug/build the project in visual studio but it does not perform its operation after installation.What might be the reason behind this ?code :  <code>  public partial class Service1 : ServiceBase{ FileStream fs; StreamWriter m_streamWriter; Timer tm = new Timer(); public Service1() { InitializeComponent(); this.ServiceName = ""timerservice""; tm.Interval = 2000; tm.Tick += new EventHandler(PerformOperations); tm.Start(); fs = new FileStream(@""c:\mcWindowsService.txt"", FileMode.OpenOrCreate, FileAccess.Write); m_streamWriter = new StreamWriter(fs); m_streamWriter.BaseStream.Seek(0, SeekOrigin.End); } private void PerformOperations(object sener, EventArgs e) { //StreamWriter swr = new StreamWriter(""c:\\test_from_database.txt"",true); try { OdbcConnection con = new OdbcConnection(""DSN=liquor_data""); OdbcDataAdapter adp = new OdbcDataAdapter("""", con); DataSet ds = new DataSet(); string sql = ""select * from item_group""; adp.SelectCommand.CommandText = sql; adp.Fill(ds, ""item_group""); foreach (DataRow dr in ds.Tables[""item_group""].Rows) { // swr.Write(dr[""group_name""].ToString() + ""\t\t"" + DateTime.Now.TimeOfDay.ToString() + ""\n""); //Console.WriteLine(dr[""group_name""].ToString() + ""\t\t"" + DateTime.Now.TimeOfDay.ToString() + ""\n""); m_streamWriter.WriteLine(dr[""group_name""].ToString() + ""\t\t"" + DateTime.Now.TimeOfDay.ToString() + ""\n""); } m_streamWriter.Flush(); } catch (Exception ex) { // swr.Write(""Error :""+ ex.Message + ""\t\t"" + DateTime.Now.TimeOfDay.ToString() + ""\n""); } } } }",Windows service with timer
web api in mvc solution in seperate project," I am creating a new MVC4 project, and research has lead me to believe that communicating from javascript to the server side is better achieved now through web API framework rather than controller actions. Is my understanding correct on this?I am presuming that I can share all my attributes etc between web API and MVC controllers so on the face it, it does not seem a massive change for me.When I am setting up applications, I like to split components out in to projects. My plan was to have a MVC project and a web API project. But I have ran in to issues. For example I have ended up with 2 apps as such, separate routing set up etc etc.So my question is, in a MVC application should the web API framework sit within the same project, or should the web API be separated into a project of its own and work around the issues? <code> ",Web API in MVC solution in separate project
.NET IL/CIL/MSIL manipulation of evaluation stack," I have this sequence of CIL codes which I injected through the use of Mono.Cecil. However, the modified .NET C# application will not run.Objective: Manually load and pop values from stack to display in Console.WriteLine This is the simple main() program I modified: However, the above code cannnot run. I tried changing blt.s to clt and br_true.s but it doesn't work either. Does anyone know if it is possible to attain my objective? Thanks.EDIT:According to ECMA-335, III.1.7.5, there might be a backward branch constraint. Not sure if this is the case. In particular, if that single-pass analysis arrives at an instruction, call it location X, that immediately follows an unconditional branch, and where X is not the target of an earlier branch instruction, then the state of the evaluation stack at X, clearly, cannot be derived from existing information. In this case, the CLI demands that the evaluation stack at X be empty. <code>  for (int i = 0; i < 3; i++) { int z = some value popped manually from stack; Console.WriteLine(z); } .method private hidebysig static void Main(string[] args) cil managed{ .entrypoint .maxstack 5 .locals init ( [0] int32 num, [1] int32 num2) L_0000: ldc.i4.6 //manually push value 6 to stack L_0001: ldc.i4.5 //manually push value 5 to stack L_0002: ldc.i4.4 //manually push value 4 to stack L_0003: ldc.i4.0 //push int i initial value 0 to stack L_0004: stloc.0 //pop and store to int i variable to variable num L_0005: br.s L_0013 L_0007: nop L_0008: stloc.1 //pop the pushed values 6,5 and 4 to variable num2 L_0009: ldloc.1 //load value of num2 to stack L_000a: call void [mscorlib]System.Console::WriteLine(int32) //pop value of num2 and print L_000f: ldloc.0 //load previous value in variable num to stack L_0010: ldc.i4.1 //load incremental value 1 to stack L_0011: add //pop and add the top 2 values, result is pushed to stack L_0012: stloc.0 //store the new result to variable num. (int i) L_0013: ldloc.0 //push int i variable value to stack L_0014: ldc.i4.3 //push value 3 to stack as number of times to loop L_0015: blt.s L_0007 //branch less than (pop and cmp the top 2 values in stack) L_0017: ret }",.NET CIL manipulation of evaluation stack
Two-Way Data Binding Chosen Multi-select DropDownList," Alright, I have a jQuery version of Chosen applied to a select displaying properly on my page and I've done so with the following code. First I have a BaseController that sets a ViewBag property listing all of the possible categories: Next, when navigating to /Event/View/1 I have the EventController setup (NOTE this controller bases the aforementioned controller) with the following View method. It sets the model, as you can see, to the following model. Finally I have the following markup in the view. Now, as I stated at first, it's displaying properly and listing all of the categories as expected. However, even though the CategoryIds property does list in fact two selected categories, it's not setting them (or showing them for that matter) as selected in the Chosen drop down on load.I am forced to only further assume that if a user selected a value from the Chosen drop down that it would not bind properly on post either because it does not change the HTML when an item is selected.So, my question is this, how do I properly two-way data bind to a Chosen drop down in MVC? <code>  protected override void OnActionExecuted(ActionExecutedContext filterContext){ try { _connection.Open(); this.ViewBag.AvailableCategories = new MultiSelectList(_connection.Query<Category>(""select * from Category""), ""CategoryID"", ""Name""); } catch (Exception ex) { throw new HttpException(500, ex.Message); } finally { _connection.Close(); } base.OnActionExecuted(filterContext);} public ActionResult View(int id){ Event evt = null; try { evt = Event.Where(_connection, id); if (evt == null) { throw new HttpException(404, ""Oops! The event you're looking for does not exist.""); } } catch (Exception ex) { throw new HttpException(500, ex.Message); } return View(evt);} public class Event{ public int EventID { get; set; } public int BusinessID { get; set; } public string Name { get; set; } public string Description { get; set; } public int NeighborhoodID { get; set; } public IEnumerable<int> CategoryIds { get { if (Categories == null) { return new List<int>(); } return Categories.Select(c => c.CategoryID).AsEnumerable(); } } public List<EventCategory> Categories { get; set; } public List<EventHours> Hours { get; set; } public static Event Where(IDbConnection connection, int id) { Event result = null; try { connection.Open(); var sql = @"" select * from Event where EventID = @EventID select * from EventCategory where EventID = @EventID select * from EventHours where EventID = @EventID""; using (var multiResult = connection.QueryMultiple(sql, new { EventID = id })) { result = multiResult.Read<Event>().FirstOrDefault(); if (result != null) { result.Categories = multiResult.Read<EventCategory>().ToList(); result.Hours = multiResult.Read<EventHours>().ToList(); } } } finally { connection.Close(); } return result; }} @Html.DropDownListFor(m => m.CategoryIds, ViewBag.AvailableCategories as MultiSelectList, new { multiple = ""multiple"", @class = ""chzn-container"" })","Two-Way Data Binding using jQuery Driven ""Chosen"" Drop Down"
c# read log file being used by another process," GoalI want to press a button on my GUI and read in the seclog.log file (symantec AV log) from a remote machine and display the contents of the log to a rich text box in my application. Things That Workeverything but reading the log fileError Message code Things I've TriedFile is being used by another processC# The process cannot access the file ''' because it is being used by another processGoogling the issueusing filestreams in multiple ways <code>  System.IO.IOException was unhandledMessage=The process cannot access the file '\\HOSTNAME\C$\Program Files (x86)\Symantec\Symantec Endpoint Protection\seclog.log' because it is being used by another process.Source=mscorlib //possible seclog paths String seclogPath1 = @""\\\\"" + target + ""\\C$\\Program Files (x86)\\Symantec\\Symantec Endpoint Protection\\seclog.log""; String seclogPath2 = @""\\\\"" + target + ""\\C$\\Program Files\\Symantec\\Symantec Endpoint Protection\\seclog.log""; //if seclog exists if (File.Exists(seclogPath1)) { //output.AppendText(""file exists at "" + seclogPath1); //var seclogContent = File.Open(seclogPath1, FileMode.Open, FileAccess.Read, FileShare.ReadWrite); Stream stream = File.OpenRead(seclogPath1); StreamReader streamReader = new StreamReader(stream); string str = streamReader.ReadToEnd(); output.AppendText(str); streamReader.Close(); stream.Close(); }",Read log file being used by another process
Register an implementation of an interface for AutoFixture," I have such a class: A dynamic proxy shall be created around the IPagination interface and the proxy shall be filled with test data.Now is it possible to let AutoFixture create an instance of the ViewModel type?Be aware that I only know the type at runtime (typeof(ViewModel)).By now I know I can do this: <code>  public class ViewModel{ public IPagination<Data> List { get; set; } // interface! public SearchFilter SearchFilter { get; set; } public string Test { get; set; }}public class SearchFilter{ public string Name { get; set; }} var context = new SpecimenContext(fixture.Compose());var value = context.Resolve(new SeededRequest(typeof(ViewModel), null))",How to let Autofixture create an instance of a type that contains properties with an interface type?
Layering project solution in to several projects vs separate from using Namespaces," I work in a .net c# application which contains 2 solutions for client and server. In server side there are 80+ projects that have been used to separate following Architectural layers, Infrastructure Layer Integration Layer (External Systems)Domain Layer Repository Layer Manager LayerService LayerIn addition, almost every layer has test project.Now, the build time of the solution takes 2 to 3 minutes, and many developers (including me :)) feel we need to tackle this problem.Therefore,proposed solution was to reduce the number of projects by merging the projects.In my view, it is probably a good solution to minimize the build time and we could achieve what we want.Proposed solution is that we merge our projects into 3 areas, such as one library for production code, one library for test code, and one for deployment projects (WCF host ,etc) and logically divided layers in same project by separating the namespaces.However, my concerns areCould these separation good for the maintainability ? providing that more that hundread of classes for each namespace appox.If we have common functionality such as helpers, where are we put those ?Is there any other way to layering the solution ? <code> ",Organizing code in separate Projects vs separate Namespaces
"Linq: Concatenating IEnumerable<KeyValuePair<string,string>> values into string"," Given IEnumerable<KeyValuePair<string,string>>, I'm trying to use linq to concatenate the values into one string. My Attempt: This produces the error: Cannot convert expression type 'string' to return type 'KeyValuePair<string,string>'Is there a more effiecient way to do this in linq?The full method... <code>  string path = attributes.Aggregate((current, next) => ""@"" + current.Key + ""="" + current.Value + "" and @"" + next.Key + ""="" + next.Value); public IEnumerable<XmlNode> GetNodes(IEnumerable<KeyValuePair<string,string>> attributes) { StateInfoXmlDocument stateInfoXmlDocument = new StateInfoXmlDocument(); string path = attributes.Aggregate((current, next) => ""@"" + current.Key + ""="" + current.Value + "" and @"" + next.Key + ""="" + next.Value); string schoolTypeXmlPath = string.Format(SCHOOL_TYPE_XML_PATH, path); return stateInfoXmlDocument.SelectNodes(schoolTypeXmlPath).Cast<XmlNode>().Distinct();}","Concatenating IEnumerable<KeyValuePair<string,string>> values into string using Linq"
WinRT XAML - how does a container know when a child has called InvalidateArrange?," I'm trying to learn the basics of creating a custom panel in a WinRT XAML app. I have defined an attached dependency property and it's working as expected except i can't figure out how to get the property's callback for a child element to trigger the arrange or measure of the container.What's the proper way to for a child to let it's container know that arrange and measure should be called again? In my WPF 4 unleashed book they use the FrameworkPropertyMetadataOptions.AffectsParentArrange but that doesn't seem to be available in WinRT. <code>  public class SimpleCanvas : Panel{ #region Variables #region Left Property public static double GetLeft(UIElement element) { if (element == null) { throw new ArgumentNullException(""element""); } object value = element.GetValue(LeftProperty); Type valueType = value.GetType(); return Convert.ToDouble(value); } public static void SetLeft(UIElement element, double value) { if (element == null) { throw new ArgumentNullException(""element""); } element.SetValue(LeftProperty, value); } public static readonly DependencyProperty LeftProperty = DependencyProperty.RegisterAttached(""Left"", typeof(double), typeof(SimpleCanvas), new PropertyMetadata(0, OnLeftPropertyChanged)); public static void OnLeftPropertyChanged(DependencyObject source, DependencyPropertyChangedEventArgs e) { UIElement element = (UIElement)source; // This doesn't cause ArrangeOverride below to be called element.InvalidateArrange(); } #endregion #region Top Property public static double GetTop(UIElement element) { if (element == null) { throw new ArgumentNullException(""element""); } object value = element.GetValue(TopProperty); return (value == null) ? 0 : (double)value; } public static void SetTop(UIElement element, double value) { if (element == null) { throw new ArgumentNullException(""element""); } element.SetValue(TopProperty, value); } public static readonly DependencyProperty TopProperty = DependencyProperty.RegisterAttached(""Top"", typeof(double), typeof(SimpleCanvas), new PropertyMetadata(0, OnTopPropertyChanged)); public static void OnTopPropertyChanged(DependencyObject source, DependencyPropertyChangedEventArgs e) { UIElement element = (UIElement)source; // This doesn't cause ArrangeOverride below to be called element.InvalidateArrange(); } #endregion #endregion public SimpleCanvas() { } #region Methods protected override Size MeasureOverride(Size availableSize) { foreach (UIElement child in this.Children) { child.Measure(new Size(double.PositiveInfinity, double.PositiveInfinity)); } return new Size(0, 0); } protected override Size ArrangeOverride(Size finalSize) { foreach (UIElement child in this.Children) { double x = 0; double y = 0; double left = GetLeft(child); double top = GetTop(child); if (!double.IsNaN(left)) { x = left; } if (!double.IsNaN(top)) { y = top; } child.Arrange(new Rect(new Point(x, y), child.DesiredSize)); } return finalSize; } #endregion}",How does a container know when a child has called InvalidateArrange?
Bitshifting Int16s only works with literals," When I write this code in VS, it doesn't work (""Cannot implicitly convert 'int' to 'short'. An explicit conversion exists. Are you missing a cast?""): Yet this code is absolutely fine: I know I can make the error go away by casting the entire expression as a short, but can anyone tell me why this happens? <code>  short A = 5;short B = 1 << A; short A = 1 << 5;",Bitshifting Int16's only works with literals
Color.FromArgb(...); security message c#," I am defining a Color from argb , ex In visual studio 2012 , winRT application it says that this is tagged with [security critical] . Are there any reasons why? I tried searching, no results. And no idea why this relates to security.Update:Now I notice, not only does FromArgb(...); methods gives this [SECURITY CRITICAL] warning. any of these: Also does. <code>  Color.FromArgb(255,255,0,0); c.A = 255;c.R = 255;c.G = 0;c.B = 0;",Color.FromArgb(...); security message
How to rename a database column in Entity Framework 5 migrations without losing data?," I got the default ASP.NET MVC 4 template successfully running with EF 5.0 Code First Migrations. However, when I update a model property name, the corresponding table column data is dropped by EF 5.0.Is it somehow possible to rename the table column without dropping data in an automated way? <code> ",How to rename a database column in Entity Framework 5 Code First migrations without losing data?
Serializing heavily linked data in .NET," I want to avoid reinventing the wheel when serializing data. I know some ways to serialize objects which are linked to each other, but it ranges from writing some code to writing a lot of code for serialization, and I'd like to avoid that. There must be some generic solutions.Let's say I have a structure like this: I want to serialize data to something like this: Here, links are serialized as just names, with the assumption that names are unique. Links can also be ""family.persons.0"" or generated unique IDs or whatever.Requirements:Format must be human-readable and preferably human-writable too. So, in order of preference: JSON, YAML*, XML, custom. No binary formats.Serialization must support all good stuff .NET offers. Generics are a must, including types like IEnumerable<>, IDictionary<> etc. Dynamic types / untyped objects are desirable.Format must not be executable. No Lua, Python etc. scripts and things like that.If unique IDs are generated, they must be stable (persist through serialization-deserialization), as files will be put into a version control system.* Heard about YAML, but sadly, it seems to be pretty much dead. <code>  Person bro = new Person { name = ""bro"", pos = new Pos { x = 1, y = 5 } }, sis = new Person { name = ""sis"", pos = new Pos { x = 2, y = 6 } }, mom = new Person { name = ""mom"", pos = new Pos { x = 3, y = 7 }, children = new List<Person> { bro, sis } }, dad = new Person { name = ""dad"", pos = new Pos { x = 4, y = 8 }, children = new List<Person> { bro, sis }, mate = mom };mom.mate = dad;Family family = new Family { persons = new List<Person> { mom, dad, bro, sis } }; family: { persons: [ { name: ""bro"", pos: { x: 1, y: 5 } }, { name: ""sis"", pos: { x: 2, y: 6 } }, { name: ""mom"", pos: { x: 3, y: 7 }, mate: ""dad"", children: [ ""bro"", ""sis"" ] }, { name: ""dad"", pos: { x: 4, y: 8 }, mate: ""mom"", children: [ ""bro"", ""sis"" ] }, ]}",Serializing heavily linked data in .NET (customizing JSON.NET references)
c# server - losing bytes," I created a client in Java and I want simply to send some data to my server that is in C#.The problem is that if I write in the client for example hello, I get only the first letter. In the byte array there is only one element.I guess there is some problem with the server side because in my server in JAVA works everything fine so the client in JAVA works fine.Does anybody see any problem?Thank you in advance. <code> ",Client/Server App - Losing bytes
Testing a custom FluentValidator validator," I created a custom validator, which tests that a value is within an enum's range of valid values: And an extension method for chaining validators: I want to use use it like this: My questions:This doesn't work as expected, as I need to speficy ....IsInEnum<T, DayOfWeek>() instead of the desired ....IsInEnum<DayOfWeek>();. How do I achieve this?I want to test this custom validator - not to test my data with this validator, but to test the validator itself. The library's docs explain how to test your data, not how to test a custom validator. There seems to be lots of testing code in the library, is there anything I can reuse? I use NUnit. <code>  public class IsInEnumValidator<T> : PropertyValidator { public IsInEnumValidator() : base(""Property {PropertyName} it not a valid enum value."") { } protected override bool IsValid(PropertyValidatorContext context) { if (!typeof(T).IsEnum) return false; return Enum.IsDefined(typeof(T), context.PropertyValue); }} public static IRuleBuilderOptions<T, TProperty> IsInEnum<T, TProperty>(this IRuleBuilder<T, TProperty> ruleBuilder) { return ruleBuilder.SetValidator(new IsInEnumValidator<TProperty>());} RuleFor(x => x.Day).IsInEnum<DayOfWeek>();",Validating enums with a custom FluentValidator validator
how to add a range of items to the IList variable, There is no AddRange() method for IList<T>.How can I add a list of items to an IList<T> without iterating through the items and using the Add() method? <code> ,How to add a range of items to an IList?
C# Parallel GZip Decompression of Log Files - Tweaking MaxDegreeOfParallelism for the Highest Throughput," We have up to 30 GB of GZipped log files per day. Each file holds 100.000 lines and is between 6 and 8 MB when compressed. The simplified code in which the parsing logic has been stripped out, utilises the Parallel.ForEach loop. The maximum number of lines processed peaks at MaxDegreeOfParallelism of 8 on the two-NUMA node, 32 logical CPU box (Intel Xeon E7-2820 @ 2 GHz): Here's a summary of the results, with a clear peak at MaxDegreeOfParallelism = 8:The CPU load (shown aggregated here, most of the load was on a single NUMA node, even when DOP was in 20 to 30 range):The only way I've found to make CPU load cross 95% mark was to split the files across 4 different folders and execute the same command 4 times, each one targeting a subset of all files.Can someone find a bottleneck? <code>  using System;using System.Collections.Concurrent;using System.Linq;using System.IO;using System.IO.Compression;using System.Threading.Tasks;namespace ParallelLineCount{ public class ScriptMain { static void Main(String[] args) { int maxMaxDOP = (args.Length > 0) ? Convert.ToInt16(args[0]) : 2; string fileLocation = (args.Length > 1) ? args[1] : ""C:\\Temp\\SomeFiles"" ; string filePattern = (args.Length > 1) ? args[2] : ""*2012-10-30.*.gz""; string fileNamePrefix = (args.Length > 1) ? args[3] : ""LineCounts""; Console.WriteLine(""Start: {0}"", DateTime.UtcNow.ToString(""yyyy-MM-ddTHH:mm:ss.fffffffZ"")); Console.WriteLine(""Processing file(s): {0}"", filePattern); Console.WriteLine(""Max MaxDOP to be used: {0}"", maxMaxDOP.ToString()); Console.WriteLine(""""); Console.WriteLine(""MaxDOP,FilesProcessed,ProcessingTime[ms],BytesProcessed,LinesRead,SomeBookLines,LinesPer[ms],BytesPer[ms]""); for (int maxDOP = 1; maxDOP <= maxMaxDOP; maxDOP++) { // Construct ConcurrentStacks for resulting strings and counters ConcurrentStack<Int64> TotalLines = new ConcurrentStack<Int64>(); ConcurrentStack<Int64> TotalSomeBookLines = new ConcurrentStack<Int64>(); ConcurrentStack<Int64> TotalLength = new ConcurrentStack<Int64>(); ConcurrentStack<int> TotalFiles = new ConcurrentStack<int>(); DateTime FullStartTime = DateTime.Now; string[] files = System.IO.Directory.GetFiles(fileLocation, filePattern); var options = new ParallelOptions() { MaxDegreeOfParallelism = maxDOP }; // Method signature: Parallel.ForEach(IEnumerable<TSource> source, Action<TSource> body) Parallel.ForEach(files, options, currentFile => { string filename = System.IO.Path.GetFileName(currentFile); DateTime fileStartTime = DateTime.Now; using (FileStream inFile = File.Open(fileLocation + ""\\"" + filename, FileMode.Open)) { Int64 lines = 0, someBookLines = 0, length = 0; String line = """"; using (var reader = new StreamReader(new GZipStream(inFile, CompressionMode.Decompress))) { while (!reader.EndOfStream) { line = reader.ReadLine(); lines++; // total lines length += line.Length; // total line length if (line.Contains(""book"")) someBookLines++; // some special lines that need to be parsed later } TotalLines.Push(lines); TotalSomeBookLines.Push(someBookLines); TotalLength.Push(length); TotalFiles.Push(1); // silly way to count processed files :) } } } ); TimeSpan runningTime = DateTime.Now - FullStartTime; // Console.WriteLine(""MaxDOP,FilesProcessed,ProcessingTime[ms],BytesProcessed,LinesRead,SomeBookLines,LinesPer[ms],BytesPer[ms]""); Console.WriteLine(""{0},{1},{2},{3},{4},{5},{6},{7}"", maxDOP.ToString(), TotalFiles.Sum().ToString(), Convert.ToInt32(runningTime.TotalMilliseconds).ToString(), TotalLength.Sum().ToString(), TotalLines.Sum(), TotalSomeBookLines.Sum().ToString(), Convert.ToInt64(TotalLines.Sum() / runningTime.TotalMilliseconds).ToString(), Convert.ToInt64(TotalLength.Sum() / runningTime.TotalMilliseconds).ToString()); } Console.WriteLine(); Console.WriteLine(""Finish: "" + DateTime.UtcNow.ToString(""yyyy-MM-ddTHH:mm:ss.fffffffZ"")); } }}",Parallel GZip Decompression of Log Files - Tweaking MaxDegreeOfParallelism for the Highest Throughput
C# Merge Two SortedLists (Union?)," I'm looking to speed up a piece of code that merges two SortedLists. C# 4.0 generic SortedList: http://msdn.microsoft.com/en-us/library/ms132319(v=vs.100).aspx I'm thinking that a union instead of the foreach loop would be faster but I don't know how to implement a union on a SortedList. If someone could help me out with that I would appreciate it.Also, if there is a better way of doing this overall I'm open to suggestions. <code>  public Trait getTrait(decimal thisValue){ if (ParentStructure != null && ParentStructure.RankedTraits.Count > 0) { SortedList<decimal, Trait> tempTraits = this.RankedTraits; // Improve here (union?) foreach (KeyValuePair<decimal, Trait> kvp in (ParentStructure.RankedTraits)) { if (!tempTraits.ContainsKey(kvp.Key)) { tempTraits.Add(kvp.Key, kvp.Value); } } return _getTrait(tempTraits, thisValue); } } return _getTrait(_rankTraits, thisValue);}",Merge Two SortedLists (Union?)
Merge Two SortedLists (Union?)," I'm looking to speed up a piece of code that merges two SortedLists. C# 4.0 generic SortedList: http://msdn.microsoft.com/en-us/library/ms132319(v=vs.100).aspx I'm thinking that a union instead of the foreach loop would be faster but I don't know how to implement a union on a SortedList. If someone could help me out with that I would appreciate it.Also, if there is a better way of doing this overall I'm open to suggestions. <code>  public Trait getTrait(decimal thisValue){ if (ParentStructure != null && ParentStructure.RankedTraits.Count > 0) { SortedList<decimal, Trait> tempTraits = this.RankedTraits; // Improve here (union?) foreach (KeyValuePair<decimal, Trait> kvp in (ParentStructure.RankedTraits)) { if (!tempTraits.ContainsKey(kvp.Key)) { tempTraits.Add(kvp.Key, kvp.Value); } } return _getTrait(tempTraits, thisValue); } } return _getTrait(_rankTraits, thisValue);}",Merge Two SortedLists (Union?)
Outllok Mapi access shared contacts," I want to import contacts from Outllok via Mapi.First step with standard contact is no problem: In a second step I additionally want to import shared contacts. Only thing I found was using but I don't know the name of the file (shared item) I want to open.Does someone know how to access shared contacts and can help me out? TobiUpdate: Thanks for the hint with the vcf-Files. But where do I find them?Update2:I played around with OutlookSpy. I got access to the folder with shared contacts, but only by knowing the id (which is of course different for other users): How do I get access to the folder without knowing the id? <code>  MAPIFolder contactObjects = outlookObj.Session.GetDefaultFolder(OlDefaultFolders.olFolderContacts);foreach (ContactItem contactObject in contactObjects.Items) { ... import contact ...} OpenSharedItem(sharedContacts.vcf) var ns = outlookObj.GetNamespace(""MAPI"");var flr = ns.GetFolderFromID(""00000000176A90DED92CE6439C1CB89AFE3668F90100D1AD8F66B576B54FB731302D9BB9F6C40007E4BAC5020000"");foreach (var contactObject in flr.Items) { ...}",Outlook Mapi access shared contacts
Does Windows Phone 8 NFC support Mifare Ultralight/Classic based tags?," Does Windows Phone 8 NFC support Mifare Ultralight/Classic based tags?I use this code to access NFC device on Nokia Lumia 920 (code example was taken from NDEF Tag Reader NFC NDEF Tag Reader) Is NFC on WP8 defective or is this code wrong?Update:From this document NFC Forum Type Tags you can find that Mifare Ultralight is compatible with NDEF. Android devices can read tags of this type easily. <code>  public partial class MainPage : PhoneApplicationPage{ public MainPage() { InitializeComponent(); ProximityDevice device = ProximityDevice.GetDefault(); device.DeviceArrived += DeviceArrived; device.DeviceDeparted += DeviceDeparted; device.SubscribeForMessage(""NDEF"", MessageReceived); } private void DeviceArrived(ProximityDevice sender) { // this event occurs when I am tapping any of my tags (tried 5 different Mifare Ultralight/Classic) } private void DeviceDeparted(ProximityDevice sender) { // this event occurs when I am moving away any tag } private void MessageReceived(ProximityDevice sender, ProximityMessage message) { // this event is never fired!!! :( }}",Reading a Mifare tag using Windows Phone 8 NFC?
Is NFC on Windows Phone 8 defective?," Does Windows Phone 8 NFC support Mifare Ultralight/Classic based tags?I use this code to access NFC device on Nokia Lumia 920 (code example was taken from NDEF Tag Reader NFC NDEF Tag Reader) Is NFC on WP8 defective or is this code wrong?Update:From this document NFC Forum Type Tags you can find that Mifare Ultralight is compatible with NDEF. Android devices can read tags of this type easily. <code>  public partial class MainPage : PhoneApplicationPage{ public MainPage() { InitializeComponent(); ProximityDevice device = ProximityDevice.GetDefault(); device.DeviceArrived += DeviceArrived; device.DeviceDeparted += DeviceDeparted; device.SubscribeForMessage(""NDEF"", MessageReceived); } private void DeviceArrived(ProximityDevice sender) { // this event occurs when I am tapping any of my tags (tried 5 different Mifare Ultralight/Classic) } private void DeviceDeparted(ProximityDevice sender) { // this event occurs when I am moving away any tag } private void MessageReceived(ProximityDevice sender, ProximityMessage message) { // this event is never fired!!! :( }}",Reading a Mifare tag using Windows Phone 8 NFC?
Build fails without any error or warning," I have a WebApplication which contains reference to WCF services.While building using Visual Studio 2010, Build fails without any error or warning. However building the .csproj using MsBuild is successful.Can't figure out what should I try in Visual Studio, to resolve / diagnose the issue. Can you please help out?EDIT:I find out that the build has been failing,From text displayed in status Bar.From output window :  <code>  ========== Build: 0 succeeded or up-to-date, 1 failed, 0 skipped ==========",How to find reason of failed Build without any error or warning
Dynamically load DLL files in C# project," In my project I need to use plugins. But to use these in my project I need to import an reference of the plugin. Since I can't know how many or which plugins the project uses beforehand I would like to import them dynamically in my project. In this code example I searched all the .dll files and put them into a string list.But how can I now load all these .dll files? Or is there a way to use these .dll files without really importing them? <code>  String path = Application.StartupPath; string[] pluginFiles = Directory.GetFiles(path, ""*.dll""); ipi = new IPlugin[pluginFiles.Length]; Assembly asm; for (int i = 0; i < pluginFiles.Length; i++) { string args = pluginFiles[i].Substring( pluginFiles[i].LastIndexOf(""\\"") + 1, pluginFiles[i].IndexOf("".dll"") - pluginFiles[i].LastIndexOf(""\\"") - 1); asm = Assembly.LoadFile(pluginFiles[i]); Type[] types = asm.GetTypes();",Dynamically load DLL files in C# project - how?
Azure october 2012 sdk - how to delete a table entity if it exists without retrieving it first?," In the previous version we could do this to delete an entity without knowing whether it exists. (source)The new TableOperations doesn't have this syntax. Do I have to use this old method or is there a way? I'd like to be consistent because now all my code use the new classes for version 2.edit: the title was misleading <code>  svc = new TestContext();item = new TestEntity(""item2pk"", ""item2rk"");svc.AttachTo(""TestTable"", item, ""*"");svc.DeleteObject(item);svc.SaveChanges();",Azure october 2012 sdk - how to delete a table entity without retrieving it first?
.any vs .len in c#," To check whether a string is empty I use All the above statements produces the same output. What is the optimal method that I should use? Again, both statements does the same thing. What is the best method to use?I tried debugging and how to benchmark the performance of a C# statement? <code>  var test = string.Empty; if (test.Length == 0) Console.WriteLine(""String is empty!"");if (!(test.Any())) Console.WriteLine(""String is empty!"");if (test.Count() == 0) Console.WriteLine(""String is empty!"");if (String.IsNullOrWhiteSpace(test)) Console.WriteLine(""String is empty!""); var s = Convert.ToString(test); s = test.ToString(CultureInfo.InvariantCulture);",What is the most optimal method of checking if a string is empty?
c# list.add seems to be adding a reference to the original object?," I have created a couple custom classes (NTDropDown and NTBaseFreight) which I use to store data that I retrieve from a DB. I initialize a List of NTBaseFreight and 2 lists for NTDropDown. I can successfully use List.Add to add freights to the freights list, but as I debug the code, my 2 dropdown lists contain only 1 NTDropDown, which always has the same values as NTDropDown (I'm assuming this is a referencing problem, but what am I doing wrong)?To give an example, on the second row, if the carrier and carrier_label were ""001"", ""MyTruckingCompany"" and I put a break on the if statement for frt_carriers, both frt_carriers and frt_modes would contain only 1 item in their list, with the values ""001"", ""MyTruckingCompany""...the same values in NTDropDown.Code: <code>  List<NTDropDown> frt_carriers = new List<NTDropDown>();List<NTDropDown> frt_modes = new List<NTDropDown>();List<NTBaseFreight> freights = new List<NTBaseFreight>();NTDropDown tempDropDown = new NTDropDown();NTBaseFreight tempFreight = new NTBaseFreight();//....Code to grab data from the DB...removedwhile (myReader.Read()){ tempFreight = readBaseFreight((IDataRecord)myReader); //check if the carrier and mode are in the dropdown list (add them if not) tempDropDown.value = tempFreight.carrier; tempDropDown.label = tempFreight.carrier_label; if (!frt_carriers.Contains(tempDropDown)) frt_carriers.Add(tempDropDown); tempDropDown.value = tempFreight.mode; tempDropDown.label = tempFreight.mode_label; if (!frt_modes.Contains(tempDropDown)) frt_modes.Add(tempDropDown); //Add the freight to the list freights.Add(tempFreight);}",list.add seems to be adding a reference to the original object?
Reset / Recover lost password options via email," I am working on a C# ASP.MVC 4 project making use of the DefaultMembershipProvider and I am trying to come up with a user friendly way to recover / reset a lost password. My first attempt was to have the user provide their username (which is a valid email address) the application would then generate a random password (meeting our requirements), that password is then emailed to the user.My ideal solution would be that when a user clicks the forgot password button. They are asked for their username which when provided would cause an email to be sent with a URL (this URL will also have an expiration date attached to it). This solution also resets the users password inside then application (before sending the email). When the user clicks on the URL, they are automatically logged in and sent to the change password form. Are there problems with this solution?For configuration I have the following values set: <code>  <membership defaultProvider=""DefaultMembershipProvider""> <providers> <clear /> <add name=""DefaultMembershipProvider"" type=""System.Web.Providers.DefaultMembershipProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"" connectionStringName=""DefaultConnection"" enablePasswordRetrieval=""false"" enablePasswordReset=""true"" requiresQuestionAndAnswer=""false"" requiresUniqueEmail=""false"" maxInvalidPasswordAttempts=""5"" minRequiredPasswordLength=""6"" minRequiredNonalphanumericCharacters=""0"" passwordAttemptWindow=""10"" applicationName=""/"" /> </providers></membership>",Recover / Reset lost password options via email
the connection was not closed the connection's current state is open," How to fix this problem; connection already closed in my function: <code>  SqlConnection con=new SqlConnection(@""Here is My Connection"");public void run_runcommand(string query) { try { con.Open(); SqlCommand cmd1 = new SqlCommand(query, con); cmd1.ExecuteNonQuery(); con.Close(); } catch (Exception ex) { throw ex; } } //...try { string query=""my query""; db.run_runcommand(query); } catch(Exception ex) { MessageBox.Show(ex.Message); }",The connection was not closed the connection's current state is open
Why do base windows forms with generic types stop the designer loading?," I am trying to have a base Windows Forms form which holds common functionality and controls - but also holds references to a class which requires a type for its methods. Each form will represent a different type, so I thought that I could do something along the lines of this: My designer class declaration also mirrors what my form has. Now when I do my second form which represents the type Foo, I can't access the designer, because I get this error: The designer could not be shown for this file because none of the classes within it can be designed. The designer inspected the following classes in the file: Foo --- The base class 'WindowsFormsApplication1.Base' could not be loaded. Ensure the assembly has been referenced and that all projects have been built. FooClass --- The base class 'WindowsFormsApplication1.BaseClass' cannot be designed. Why does this happen/what am I doing wrong or are there any other methods to do this? <code>  public partial class Base<T> : Form where T : BaseClass{ private GenericHandler handler = new GenericHandler();}public class BaseClass { }public class GenericHandler{ public void DoSomethingWithInstance<T>(T instance) where T : BaseClass { }} public partial class Foo : Base<FooClass>{ public Foo() { InitializeComponent(); }}public class FooClass : BaseClass { }",Why do base Windows Forms form class with generic types stop the designer loading?
How would I design this (C#)," I am working on a database that is maintained by another system, so I am unable to make any drastic changes to the tables. The tables in this database have quite a few fields (upwards of 30+) with no two tables having the same naming convention, types, or same number of fields. These tables also change fairly frequently (fields being added, removed or their types being changed) and to make matters worse new tables are created on a frequent basis as well. Now I do have one table that can be strictly typed which is used as a queue. The problem:I have to get data from a table given the table name and some columns in that table. The column names are supplied as strings. Since these tables change so often it becomes difficult to maintain strictly typed entities for each table.How would I design my classes in a way that they are loosely coupled but allow me to work with these tables?Thanks for the help and sorry if my explanation sucks. <code> ",Designing classes to cope with frequent database schema changes
How would I design this?," I am working on a database that is maintained by another system, so I am unable to make any drastic changes to the tables. The tables in this database have quite a few fields (upwards of 30+) with no two tables having the same naming convention, types, or same number of fields. These tables also change fairly frequently (fields being added, removed or their types being changed) and to make matters worse new tables are created on a frequent basis as well. Now I do have one table that can be strictly typed which is used as a queue. The problem:I have to get data from a table given the table name and some columns in that table. The column names are supplied as strings. Since these tables change so often it becomes difficult to maintain strictly typed entities for each table.How would I design my classes in a way that they are loosely coupled but allow me to work with these tables?Thanks for the help and sorry if my explanation sucks. <code> ",Designing classes to cope with frequent database schema changes
HTML 5 Video now playing from my MVC website," I have a simple MVC action that returns a FilePathResult pointing to a video. For some reason HTML5 video (using js-video.js) is not playing the video. If I change the URL to a URL I know works, the video plays fine. So it must be to do with the way I serve the file.If I browse to the URL in the browser, the video downloads and then plays fine.The video is .mp4 with a returned MIME type of video/mp4.I am using Video Studio 2012, .NET 4, IIS 8 Express and Windows 7 x64 Home Premium.Here is my respective code: Here is a screen shot of what Chrome returns: <code>  [Authorize(Roles = ""File_Read"")]public FileResult Get(int? id){ try { if (id == null) throw new ArgumentNullException(""id""); var fileRepo = FileRepositoryFactory.Repository; var file = fileRepo.GetById(id.Value); if (file == null) throw new InvalidOperationException(String.Format(""Failed to find file with id: {0}"", id)); if (String.IsNullOrWhiteSpace(file.FilePath)) { return this.File(file.Data, file.MIMEType, file.FileName); } else { return this.File(file.FilePath, file.MIMEType, file.FileName); } } catch (Exception ex) { return this.File(""failed.txt"", ""text/plain""); }}",HTML 5 Video not playing from my MVC website
efficient way of inserting bytes into middle of the file (in windows filesystem)," I need a way to insert some file clusters into the middle of a file to insert some data.Normally, I would just read the entire file and write it back out again with the changes, but the files are multiple gigabytes in size, and it takes 30 minutes just to read the file and write it back out again.The cluster size doesn't bother me; I can essentially write out zeroes to the end of my inserted clusters, and it will still work in this file format.How would I use the Windows File API (or some other mechanism) to modify the File Allocation Table of a file, inserting one or more unused clusters at a specified point in the middle of the file? <code> ",Insert bytes into middle of a file (in windows filesystem) without reading entire file (using File Allocation Table)?
Showing a Context Menu for an ITEM in a listView1," I know how to make a contextMenu that pops up when I right click on a listView, what I want is for it to pop up when I right click on an item. I am trying to make a chat server and client, and now... Now I want to view client info when I right click on a connected client's item.How can I do this? <code> ",Showing a Context Menu for an item in a ListView
How to access variables inside script component c# script," How can I access variables inside my C# code which I've used in Data Flow -> Script Component - > My c# Script with my SSIS package?I have tried with which is also not working <code>  IDTSVariables100 varCollection = null;this.VariableDispenser.LockForRead(""User::FilePath"");string XlsFile;XlsFile = varCollection[""User::FilePath""].Value.ToString();",How to access ssis package variables inside script component
How to access ssis package variables inside script component c# script," How can I access variables inside my C# code which I've used in Data Flow -> Script Component - > My c# Script with my SSIS package?I have tried with which is also not working <code>  IDTSVariables100 varCollection = null;this.VariableDispenser.LockForRead(""User::FilePath"");string XlsFile;XlsFile = varCollection[""User::FilePath""].Value.ToString();",How to access ssis package variables inside script component
How to determine type of a variable?," I'm in the immediate window in Visual Studio. There's a variable p. How can I deduce the type of the variable p?I tried p.GetType() but that returns the type of object p. In my case, this is a very specific type (eg. sometimes ChessPlayer, sometimes TennisPlayer). I'd like to know the type of the variable, ie. the type that determines what methods are available on the variable p.Edit: I think this is a reasonable thing to want to do. I am trying to inspect the variable p but I don't know it is! Normally in Visual Studio I just hover the mouse on the variable and it tells me its type, or I type . and the autocomplete lists its methods. However none of that works in the immediate window, all I have is this variable p I don't know what it is or what I can do with it :(  <code> ",How to determine type of a variable? (not the type of the object)
Can derived C# interface proprietes override base interface proprities with the same name?," I'm trying to create an interface inheritance system that uses the same property but always of a further derived type. So the base property should be somehow overridden or hidden by the deriving interface.Take, for instance, two interfaces, Man and Woman, that derive into Husband and Wife, also interfaces. Man and Husband interfaces both have a ""sweetheart"" property, while Woman and Wife have a ""darling"" property. Now, the Man's ""sweetheart"" property is of type Woman, while the Husband's same ""sweetheart"" property should be a Wife (derived from Woman). And the same with the Woman and Wife's ""darling"" property. This code is wrong, it doesn't work. I'm beeing notified that I didn't implement the basic Man.sweetheart and Woman.darling properties, and that the implemented Husband.sweetheart and Wife.darling will not do, because the types don't match. Is there any way of narrowing a property's type to a derived one? How do you attain it in C#? <code>  public interface Man // base interface for Husband{ Woman sweetheart { get; set; }}public interface Woman // base interface for Wife{ Man darling { get; set; }}public interface Husband : Man // extending Man interface{ new Wife sweetheart { get; set; } // narrowing ""sweetheart"" property's type}public interface Wife : Woman // extending Woman interface{ new Husband darling { get; set; } // narrowing ""darling"" property's type}public class RandomHusband : Husband // implementing the Husband interface{ private RandomWife wife; public Wife sweetheart { get { return wife; } set { wife = value; } }}public class RandomWife : Wife // implementing the Wife interface{ private RandomHusband husband; public Husband darling { get { return husband; } set { husband = value; } }}",Can derived C# interface properties override base interface properties with the same name?
How to call extension method which have same name as in original class in C#," I have code like Now if I call MethodA like It will always call Original method. How can I call the extension method. <code>  public class TestA{ public string ColA { get; set; } public string ColB { get; set; } public string ColC { get; set; } public void MethodA() { MessageBox.Show(""Original A1.""); }}static class ExtenstionTest{ public static void MethodA(this TestA A1) { MessageBox.Show(""Extended A1.""); }} TestA a = new TestA(); a.MethodA();",How to call extension method which has the same name as an existing method?
Which exceptions cannot be cought," MSDN states that StackOverflowException can't be caught by try-catch block starting with .NET Framework 2. Starting with the .NET Framework version 2.0, a StackOverflowException object cannot be caught by a try-catch block and the corresponding process is terminated by default.Are there any other exceptions with the same behavior? <code> ",Exceptions that can't be caught by try-catch block in application code
Excpetions that can't be caught by try-catch block in application code," MSDN states that StackOverflowException can't be caught by try-catch block starting with .NET Framework 2. Starting with the .NET Framework version 2.0, a StackOverflowException object cannot be caught by a try-catch block and the corresponding process is terminated by default.Are there any other exceptions with the same behavior? <code> ",Exceptions that can't be caught by try-catch block in application code
Exceptions that can't be caught by try-catch block in application code," MSDN states that StackOverflowException can't be caught by try-catch block starting with .NET Framework 2. Starting with the .NET Framework version 2.0, a StackOverflowException object cannot be caught by a try-catch block and the corresponding process is terminated by default.Are there any other exceptions with the same behavior? <code> ",Exceptions that can't be caught by try-catch block in application code
how to open a service properties dialog in c#," I would like to add a button to my application ( frontend to a service) that will open the service properties dialog (like in services mmc snapin ) for my service.There are numerous examples to open file properties, but that is not what i want. i dont know where to start. <code> ",how to open a service properties dialog
Comparing Flags Enum," Normally when comparing flag enums I use the following format: But sometimes I come across this: Just wondering which is the better to use, or does it come down to personal preference? <code>  (value & flag) == flag; (value & flag) != 0;",Which is the better way to compare Flags Enum?
Visual Studio 2012. Persist Pinned Windows?," Is there anyway to persist pinned windows between visual studio closures?At the moment, if you pin a window, when you close visual studio and open it back up again, the pinned status of said window has been reset and it is lumped in with all the other windows again. <code> ",Visual Studio - Persist Pinned Windows?
Persist Pinned Windows?," Is there anyway to persist pinned windows between visual studio closures?At the moment, if you pin a window, when you close visual studio and open it back up again, the pinned status of said window has been reset and it is lumped in with all the other windows again. <code> ",Visual Studio - Persist Pinned Windows?
Dividing a number closely with out loosing any precision," I am trying to divide a number into multiple parts so the sum of the part are equal to the input number.If I have 3.99 and if I need to divide into two parts, the expected output is 2 and 1.99 (2+1.99=3.99)And if I need to divide 3.99 into 3 parts, the expected output is 1.3, 1.3 and 1.39 (1.3+1.3+1.39=3.99)I was able to output 2.99 and 1 for the first example and I was able to get 1.99, 1 and 1 for the second example. However, in both the cases results are very far from the expected output.I need to split postal charges into separate line items. The result could be equally divided or unequally divided while making sure that the sum of the different parts is equal to the input number.Here are some other examples: <code>  3.99 divided in 3 parts: 1.33, 1.33, 1.333.98 divided in 3 parts: 1.33, 1.33, 1.323.97 divided in 3 parts: 1.32, 1.32, 1.333.96 divided in 3 parts: 1.32, 1.32, 1.323.95 divided in 3 parts: 1.32, 1.32, 1.31",How to divide a number into multiple parts so that the resulting sum is equal to the input?
Dividing a number closely without losing any precision," I am trying to divide a number into multiple parts so the sum of the part are equal to the input number.If I have 3.99 and if I need to divide into two parts, the expected output is 2 and 1.99 (2+1.99=3.99)And if I need to divide 3.99 into 3 parts, the expected output is 1.3, 1.3 and 1.39 (1.3+1.3+1.39=3.99)I was able to output 2.99 and 1 for the first example and I was able to get 1.99, 1 and 1 for the second example. However, in both the cases results are very far from the expected output.I need to split postal charges into separate line items. The result could be equally divided or unequally divided while making sure that the sum of the different parts is equal to the input number.Here are some other examples: <code>  3.99 divided in 3 parts: 1.33, 1.33, 1.333.98 divided in 3 parts: 1.33, 1.33, 1.323.97 divided in 3 parts: 1.32, 1.32, 1.333.96 divided in 3 parts: 1.32, 1.32, 1.323.95 divided in 3 parts: 1.32, 1.32, 1.31",How to divide a number into multiple parts so that the resulting sum is equal to the input?
Paste files from clipboard," Thanks to Stack Overflow question Copy files to clipboard in C#, I was able to use Clipboard.SetFileDropList and end up with: That way I can place an entire directory on the clipboard and paste it where I need it to. I would like to be able to paste it with code though. I don't want to go to the place where I want to paste it and then press Ctrl + V. In other words, I am looking for something like: I know I can get all the files recursively and then paste them one by one. But why reinvent the wheel? It will be nice if the OS can do it for me...  <code>  using System;using System.Collections.Specialized;using System.Windows.Forms;class Program{ [STAThread] static void Main ( string[] args) { StringCollection paths = new StringCollection(); paths.Add( @""C:\Users\Antonio\Desktop\MyDirectory"" ); Clipboard.SetFileDropList( paths); }} Clipboard.Paste(""C:\Users\LocationWhereIWantToPasteTheFolder"")",Paste files from the clipboard
"WPF DataGrid adding extra ""ghost"" row"," Hei,In my application i'm using DataGrid to show some data. To get everything working with threading i'm using AsyncObservableCollection as DataContext of DataGrid. When my application starts it looks for files in some folders and updates AsyncObservableCollection. Finding files is done on a separate thread: Where all the loading logic is in InitAllOrdersCollection() method.Now here's where things go bad, when i start the application for some reason i get 2 rows with same data in DataGrid even if there is one item in collection and only one file in folders. If i add a delay(Thread.Sleep() 50ms minimum) before loading files then DataGrid show everything correctly (no extra row). Delay has to be added to the Thread what is loading the files (The one created with Task.Factory.StartNew()).Have anybody encountered something similar or is there something else i should try? Thanks in advance!EDIT: Adding some code as requested: FilesToOrders() method is the one what adds the new orders to the AsyncObservableCollection.Hope this helps. <code>  Task.Factory.StartNew(() => _cardType.InitAllOrdersCollection()) .ContinueWith((t) => ThrowEvent(), TaskContinuationOptions.None); public AsyncObservableCollection<IGridItem> OrdersCollection = new AsyncObservableCollection<IGridItem>();public void InitAllOrdersCollection(){ // Thread.Sleep(50); <-- this sleep here fixes the problem! foreach (var convention in FileNameConventions) { var namePatterns = convention.NameConvention.Split(','); foreach (var pattern in namePatterns) { var validFiles = CardTypeExtensions.GetFiles(this.InputFolder, pattern, convention); if (validFiles.Any()) { this.FilesToOrders(validFiles, convention); } } }}public static List<string> GetFiles(string inputFolder, string pattern, FileNameConvention convention){ var files = Directory.GetFiles(inputFolder, pattern); return files.Where(file => IsCorrect(file, convention)).AsParallel().ToList();}// Adds new order to OrdersCollection if its not there already!private void FilesToOrders(List<string> dirFiles, FileNameConvention convention){ foreach (var dirFile in dirFiles.AsParallel()) { var order = new Order(dirFile, this, convention); if (!this.OrdersCollection.ContainsOrder(order)) { this.OrdersCollection.Add(order); } }}public static bool ContainsOrder(this ObservableCollection<IGridItem> collection, Order order){ return collection.Cast<Order>().Any(c=>c.Filepath == order.Filepath);}","WPF DataGrid is adding extra ""ghost"" row"
"Timer for close application, C#"," How to make a timer which forces the application to close at a specified time in C#? I have something like this: But in this case, the application will be closed in 120 sec after the timer has ran. And I need a timer, which will close the application for example at 23:00:00. Any suggestions? <code>  void myTimer_Elapsed(object sender, System.Timers.ElapsedEventArgs e){ if (++counter == 120) this.Close();}",Timer to close the application
C# Using XmlReader class to parse XML with elements of the same name," I'm re-writing some code that uses a XmlDocument to parse some XML. I want to use a XmlReader instead to see if I can get some performance improvements.The structure of the XML looks like this: Basically, I need to iterate through all the <item> elements. Like I said, the old code works like this: This works fine, but I think using a XmlReader would be faster. So I've written this: However, this code only reads the first <item> element. The ReadOuterXml() is breaking the loop. Does anybody know how to get around this? Or is this type of parsing not possible with a XmlReader? I've having to do this using .NET version 2 :( So I can't use LINQ.  <code>  <items> <item id=""1"" desc=""one""> <itemBody date=""2012-11-12"" /> </item> <item id=""2"" desc=""two""> <itemBody date=""2012-11-13"" /> </item> <item id=""3"" desc=""three""> <itemBody date=""2012-11-14"" /> </item> <item id=""4"" desc=""four""> <itemBody date=""2012-11-15"" /> </item></items> XmlDocument document = new XmlDocument();// load XML into XmlDocumentdocument.LoadXml(xml);// use xpath to split into individual itemstring xPath = @""items/item"";XmlNodeList nodeList = document.SelectNodes(xPath);// loop through each itemfor (int nodeIndex = 0; nodeIndex < nodeList.Count; nodeIndex++){ // do something with the XmlNode nodeList[nodeIndex];} XmlReader xmlReader = XmlReader.Create(new StringReader(xml));while (xmlReader.Read()){ if (xmlReader.Name.Equals(""item"") && (xmlReader.NodeType == XmlNodeType.Element)) { string id = xmlReader.GetAttribute(""id""); string desc = xmlReader.GetAttribute(""desc""); string elementXml = xmlReader.ReadOuterXml(); }}",Using XmlReader class to parse XML with elements of the same name
Asp.Net Mvc repetitive tasks in specific time intervals?," For example, I want to call a function in specific time intervals (hourly or daily tasks.)I m already using Timer. But it is working as long as my local server is working. For Example: I write weather info to db, in 6 hour intervals. Project is already in Host. Timer event is working as long as my computer local server is running.Question:What is the wrong about my code? (Or logical wrong to using timer in WebProject?) Why timer is only working while local server working?What is the best way to manage time interval tasks? (not need asp.net)I hope, I can explain the problem. Thanks. <code>  public static void StartYahooWeatherManager(){ Timer t = new Timer(1000 * 60 * 60 * 6 /* 6 hours */); t.Elapsed += new ElapsedEventHandler(WriteYahoWeatherRssItemToDb); t.Start();}private static void WriteYahoWeatherRssItemToDb(object o, ElapsedEventArgs e){ YahooWeatherManager.InsertYahooWeatherRssItem(YahooWeatherManager.GetYahooWeatherRssItem());}",Repetitive tasks in specific time intervals?
Repetitive tasks in specific time intervals?," For example, I want to call a function in specific time intervals (hourly or daily tasks.)I m already using Timer. But it is working as long as my local server is working. For Example: I write weather info to db, in 6 hour intervals. Project is already in Host. Timer event is working as long as my computer local server is running.Question:What is the wrong about my code? (Or logical wrong to using timer in WebProject?) Why timer is only working while local server working?What is the best way to manage time interval tasks? (not need asp.net)I hope, I can explain the problem. Thanks. <code>  public static void StartYahooWeatherManager(){ Timer t = new Timer(1000 * 60 * 60 * 6 /* 6 hours */); t.Elapsed += new ElapsedEventHandler(WriteYahoWeatherRssItemToDb); t.Start();}private static void WriteYahoWeatherRssItemToDb(object o, ElapsedEventArgs e){ YahooWeatherManager.InsertYahooWeatherRssItem(YahooWeatherManager.GetYahooWeatherRssItem());}",Repetitive tasks in specific time intervals?
"How Get Cookies Info Inside Of A CookieContainer? (All Of Them, Not For A Specific Domain)"," Please see the code below: How can I get cookies info inside cookieJar? (All of them, not just for a specific domain.)And how can I add or remove a cookie from that?  <code>  CookieContainer cookieJar = new CookieContainer();HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(""http://www.google.com"");request.CookieContainer = cookieJar;HttpWebResponse response = (HttpWebResponse)request.GetResponse();int cookieCount = cookieJar.Count;","How to get cookies info inside of a CookieContainer? (All Of Them, Not For A Specific Domain)"
how to save changed assembly using mono cecil, I have a version of Mono.Cecil which does not have the AssemblyFactory class. Probably it is the 0.9 version of the Cecil class. Is there a way out? <code> ,How to save a changed assembly using Mono.Cecil?
How to save changed assembly using mono cecil, I have a version of Mono.Cecil which does not have the AssemblyFactory class. Probably it is the 0.9 version of the Cecil class. Is there a way out? <code> ,How to save a changed assembly using Mono.Cecil?
How to save changed assembly using mono cecil?, I have a version of Mono.Cecil which does not have the AssemblyFactory class. Probably it is the 0.9 version of the Cecil class. Is there a way out? <code> ,How to save a changed assembly using Mono.Cecil?
"Programmtically get site status from IIS, gets back COM error"," I am trying to programmatically get my site status from IIS to see if it's stopped, but I kept getting the following error, The object identifier does not represent a valid object. (Exception from HRESULT: 0x800710D8)The application is using ServerManager Site class to access the site status. Here is the code, I've test with static site to isolate the issue, making sure that the site is up and running, all configuration are valid, point to the valid application pool...etc.Let me know if you need more details. Is it the COM thing? <code>  //This is fine, gets back the site var serverManager = new Microsoft.Web.Administration.ServerManager(ConfigPath);var site = serverManager.Sites.FirstOrDefault(x => x.Id == 5);if (site == null) return;var appPoolName = site.Applications[""/""].ApplicationPoolName;//error!var state = site.State;","Programmatically get site status from IIS, gets back COM error"
C# library to extract a few specific EXIF data items from JPG images," I need to extract the following pieces of information from any jpg that is uploaded to a website:ApertureFocal LengthISO SettingCamera Make/ModelLens Make/ModelI'm not worried about all of the other EXIF data that is contained within images. I have used an old library in the past which has got the first 4 items in that list without a problem, but I've not located one yet that can get the Lens Make & Model.Does anyone know of a library that I can use within my ASP.NET MVC C# project that handles all of the above? <code> ",C# library to extract Lens Make/Model from EXIF data in JPG images
Disable/supress warning CS0649 in C# for a specific field of class," I have some fields in a C# class which I initialize using reflection. The compiler shows CS0649 warning for them: Field foo' is never assigned to, and will always have its default valuenull' (CS0649) (Assembly-CSharp)I'd like to disable the warning for these specific fields only and still let the warning be shown for other classes and other fields of this class.It is possible to disable CS0649 for the whole project, is there anything more fine-grained? <code> ",Disable/suppress warning CS0649 in C# for a specific field of class
Proper configuration of WCF service exposing 2 endpoints," I have an WCF service which I am trying to configure so that it exposes 2 endpoints, refering to different functionalities, under different URLs.What I want to have is Service1, exposing methods A, B, C, and Service2, exposing methods D, E.I want to be able to browse both localhost/WebServiceName/Service1/Service.svc and localhost/WebServiceName/Service2/Service.svc.Other applications referencing localhost/WebServiceName/Service1/Service.svc should see only the interface containing the methods A, B and C. They should not see anything regarding Service2 interface. And for Service2 likewise.So far I have defined two interfaces in my WCF service, I_Service1 and I_Service2.I have added two endpoints in my web.config like so: The suggestion of using full address in the enpoint comes from here: Multiple endpoints under IISBut still, I can't browse localhost/WebServiceName/Service1/Service.svc. I receive: I can successfully browse localhost/WebServiceName/Service.svc and the wsdl includes methods A, B, C, D, E. But this should be wrong in the behaviour I want.Is there something that I have missed?UPDATE: Following this article http://allen-conway-dotnet.blogspot.ro/2011/09/exposing-multiple-binding-types-for.html I created two different contract services for those endpoints. But currently I am seing only Service1 when I browse it. Service2 apparently does not exist (HTTP 404 error related issues appear).The configuration looks like: <code>  <endpoint address=""http://localhost/WebServiceName/Service1/"" binding=""wsHttpBinding"" contract=""WebServiceName.I_Service1"" bindingConfiguration=""Binding1"" /><endpoint address=""http://localhost/WebServiceName/Service2/"" binding=""wsHttpBinding"" contract=""WebServiceName.I_Service2"" bindingConfiguration=""Binding2"" /> Description: HTTP 404. The resource you are looking for (or one of its dependencies) could have been removed, had its name changed, or is temporarily unavailable. Please review the following URL and make sure that it is spelled correctly. <services> <service behaviorConfiguration=""WebServiceName.ServiceBehavior1"" name=""WebServiceName.Service1""> <endpoint address="""" binding=""wsHttpBinding"" bindingConfiguration=""Binding1"" contract=""WebServiceName.I_Service1"" /> <endpoint address=""mex"" binding=""mexHttpBinding"" contract=""IMetadataExchange"" /> <host> <baseAddresses> <add baseAddress=""http://localhost/WebServiceName/Service1/Service.svc"" /> </baseAddresses> </host> </service> <service behaviorConfiguration=""WebServiceName.ServiceBehavior2"" name=""WebServiceName.Service2""> <endpoint address="""" binding=""wsHttpBinding"" bindingConfiguration=""Binding1"" contract=""WebServiceName.I_Service2"" /> <endpoint address=""mex"" binding=""mexHttpBinding"" contract=""IMetadataExchange"" /> <host> <baseAddresses> <add baseAddress=""http://localhost/WebServiceName/Service2/Service.svc"" /> </baseAddresses> </host> </service> </services>",WCF service exposing 2 endpoints on 2 different service contracts
WCF service exposing 2 endpoints on 2 different URLs," I have an WCF service which I am trying to configure so that it exposes 2 endpoints, refering to different functionalities, under different URLs.What I want to have is Service1, exposing methods A, B, C, and Service2, exposing methods D, E.I want to be able to browse both localhost/WebServiceName/Service1/Service.svc and localhost/WebServiceName/Service2/Service.svc.Other applications referencing localhost/WebServiceName/Service1/Service.svc should see only the interface containing the methods A, B and C. They should not see anything regarding Service2 interface. And for Service2 likewise.So far I have defined two interfaces in my WCF service, I_Service1 and I_Service2.I have added two endpoints in my web.config like so: The suggestion of using full address in the enpoint comes from here: Multiple endpoints under IISBut still, I can't browse localhost/WebServiceName/Service1/Service.svc. I receive: I can successfully browse localhost/WebServiceName/Service.svc and the wsdl includes methods A, B, C, D, E. But this should be wrong in the behaviour I want.Is there something that I have missed?UPDATE: Following this article http://allen-conway-dotnet.blogspot.ro/2011/09/exposing-multiple-binding-types-for.html I created two different contract services for those endpoints. But currently I am seing only Service1 when I browse it. Service2 apparently does not exist (HTTP 404 error related issues appear).The configuration looks like: <code>  <endpoint address=""http://localhost/WebServiceName/Service1/"" binding=""wsHttpBinding"" contract=""WebServiceName.I_Service1"" bindingConfiguration=""Binding1"" /><endpoint address=""http://localhost/WebServiceName/Service2/"" binding=""wsHttpBinding"" contract=""WebServiceName.I_Service2"" bindingConfiguration=""Binding2"" /> Description: HTTP 404. The resource you are looking for (or one of its dependencies) could have been removed, had its name changed, or is temporarily unavailable. Please review the following URL and make sure that it is spelled correctly. <services> <service behaviorConfiguration=""WebServiceName.ServiceBehavior1"" name=""WebServiceName.Service1""> <endpoint address="""" binding=""wsHttpBinding"" bindingConfiguration=""Binding1"" contract=""WebServiceName.I_Service1"" /> <endpoint address=""mex"" binding=""mexHttpBinding"" contract=""IMetadataExchange"" /> <host> <baseAddresses> <add baseAddress=""http://localhost/WebServiceName/Service1/Service.svc"" /> </baseAddresses> </host> </service> <service behaviorConfiguration=""WebServiceName.ServiceBehavior2"" name=""WebServiceName.Service2""> <endpoint address="""" binding=""wsHttpBinding"" bindingConfiguration=""Binding1"" contract=""WebServiceName.I_Service2"" /> <endpoint address=""mex"" binding=""mexHttpBinding"" contract=""IMetadataExchange"" /> <host> <baseAddresses> <add baseAddress=""http://localhost/WebServiceName/Service2/Service.svc"" /> </baseAddresses> </host> </service> </services>",WCF service exposing 2 endpoints on 2 different service contracts
ActionNotSupported error when WCF is created in runtime," I am trying to create a WCF service at runtime. My service interface is: I am serving my service as follows: The ServiceHost is created by this method: Service route creation: When I try to access my service from a web browser using the address http://localhost/Werp.View/wcf.service/InformationService/Get/TestI obtain the following error: Can anyone help me? <code>  [ServiceContract]public interface IInformationService : IService{ [OperationContract] [WebInvoke(Method = ""Get"", ResponseFormat = WebMessageFormat.Json, UriTemplate = ""Test"", RequestFormat = WebMessageFormat.Json)] string Test();} var httpEnumerator = ImplementedContracts.Values.GetEnumerator();httpEnumerator.MoveNext();var httpContractType = httpEnumerator.Current.ContractType;var webBinding = new WebHttpBinding() { Security = { Mode = WebHttpSecurityMode.None } };var httpEndpoint = AddServiceEndpoint( httpContractType, webBinding, baseAddress+/Get"");httpEndpoint.Behaviors.Add(new CustomEndpointBehavior()); protected override ServiceHost CreateServiceHost(Type serviceType, Uri[] baseAddresses){ var host = new WcfServiceHost(serviceType, baseAddresses); if (host.Description.Behaviors.Contains(typeof(ServiceDebugBehavior))) { (host.Description.Behaviors[typeof(ServiceDebugBehavior)] as ServiceDebugBehavior).IncludeExceptionDetailInFaults = true; } else { var debug = new ServiceDebugBehavior { IncludeExceptionDetailInFaults = true }; host.Description.Behaviors.Add(debug); } if (host.Description.Behaviors.Contains(typeof(ServiceMetadataBehavior))) { (host.Description.Behaviors[typeof(ServiceMetadataBehavior)] as ServiceMetadataBehavior).HttpGetEnabled = true; (host.Description.Behaviors[typeof(ServiceMetadataBehavior)] as ServiceMetadataBehavior).HttpsGetEnabled = true; } else { var smb = new ServiceMetadataBehavior { HttpGetEnabled = true, HttpsGetEnabled = true }; host.Description.Behaviors.Add(smb); } host.AddServiceEndpoint( ServiceMetadataBehavior.MexContractName, MetadataExchangeBindings.CreateMexHttpsBinding(), ""mex"" ); host.AddServiceEndpoint( ServiceMetadataBehavior.MexContractName, MetadataExchangeBindings.CreateMexHttpBinding(), ""mex"" ); return host;} var serviceRoute = new ServiceRoute( ""wcf.service/"" + service.Value.Name, new WcfServiceHostFactory(), service.Value);if (!RouteTable.Routes.Contains(serviceRoute)){ RouteTable.Routes.Add(serviceRoute);} <Fault xmlns=""http://schemas.microsoft.com/ws/2005/05/envelope/none""> <Code> <Value>Sender</Value> <Subcode> <Value xmlns:a=""http://schemas.microsoft.com/ws/2005/05/addressing/none""> a:ActionNotSupported </Value> </Subcode> </Code><Reason> <Text xml:lang=""en-US""> The message with Action '' cannot be processed at the receiver, due to a ContractFilter mismatch at the EndpointDispatcher. This may be because of either a contract mismatch (mismatched Actions between sender and receiver) or a binding/security mismatch between the sender and the receiver. Check that sender and receiver have the same contract and the same binding (including security requirements, e.g. Message, Transport, None). </Text></Reason>",ActionNotSupported error when a WCF Service is created at runtime
Simple Injector pass values into constructor," In Simple Injector I can do the following: What I am doing here is saying that when IAuctionContext is found, replace it with this new AuctionContext. The problem is that with the call to RegisterSingle, only a single instance of AuctionContext will be used. What I'd like it to be able to pass in a Uri parameter as above but not have the single instance but allow a new instance each time.How is this possible? <code>  container.RegisterSingle<IAuctionContext>(() => new AuctionContext( new Uri(""http://localhost:60001/AuctionDataService.svc/"")));",Simple Injector pass hard coded values into constructor
Entity frame work code first with T4 template," I am going to create code-first view by using a T4 template like the below mentioned article says:Article hereBut it's causing an run time exceptionlike below. Why's that?My connection string is configured properly in App.config.My application is N-Tier based.So That DbContext driven class is in Data Layer. This is my connection String: I am using EF 4.1 with vs 2010. Running transformation: System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation. ---> System.ArgumentException: The argument 'nameOrConnectionString' cannot be null, empty or contain only white space. at System.Data.Entity.ModelConfiguration.Utilities.RuntimeFailureMethods.ReportFailure(ContractFailureKind contractFailureKind, String userMessage, String conditionText, Exception innerException) at System.Data.Entity.DbContext..ctor(String nameOrConnectionString) at PawLoyalty.Data.DataCatalog..ctor(Boolean allowLazyLoading) in D:\My Blog\Test Projects\PawLoyalty\PawLoyalty\PawLoyalty.Data\DataCatalog.cs:line 31 at PawLoyalty.Data.DataCatalog..ctor() in D:\My Blog\Test Projects\PawLoyalty\PawLoyalty\PawLoyalty.Data\DataCatalog.cs:line 26 --- End of inner exception stack trace --- at System.RuntimeTypeHandle.CreateInstance(RuntimeType type, Boolean publicOnly, Boolean noCheck, Boolean& canBeCached, RuntimeMethodHandleInternal& ctor, Boolean& bNeedSecurityCheck) at System.RuntimeType.CreateInstanceSlow(Boolean publicOnly, Boolean skipCheckThis, Boolean fillCache, StackCrawlMark& stackMark) at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean skipCheckThis, Boolean fillCache, StackCrawlMark& stackMark) at System.Activator.CreateInstance(Type type, Boolean nonPublic) at System.Activator.CreateInstance(Type type) at Microsoft.VisualStudio.TextTemplatingD6E95B37BD0790EBBCC7DB570AD3E2AC.GeneratedTextTransformation.GetEdmx(Type contextType) at Microsoft.VisualStudio.TextTemplatingD6E95B37BD0790EBBCC7DB570AD3E2AC.GeneratedTextTransformation.GenerateViews(String contextTypeName) at Microsoft.VisualStudio.TextTemplatingD6E95B37BD0790EBBCC7DB570AD3E2AC.GeneratedTextTransformation.TransformText() at Microsoft.VisualStudio.TextTemplating.TransformationRunner.RunTransformation(TemplateProcessingSession session, String source, ITextTemplatingEngineHost host, String& result)UpdatedMy DbContext Derived class looks like below. <code>  <add name=""PawLoyalty"" connectionString=""Server=.;database=PawLoyalty;Trusted_connection=true;pooling=true;MultipleActiveResultSets=True"" providerName=""System.Data.SqlClient"" /> [Export(typeof(ISecurityDataCatalog))] [Export(typeof(IMappingDataCatalog))] [Export(typeof(IPawLoyaltyDataCatalog))] [PartCreationPolicy(CreationPolicy.NonShared)] public class DataCatalog : DbContext, IPawLoyaltyDataCatalog, ISecurityDataCatalog, IMappingDataCatalog { public static string ConnectionString { get; set; } public static string AccountToken { get; set; } public DataCatalog() : this(false) { } public DataCatalog(bool allowLazyLoading = false) : base(ConnectionString) { Configuration.LazyLoadingEnabled = allowLazyLoading; } protected override void OnModelCreating(DbModelBuilder modelBuilder) { modelBuilder.ComplexType<DiscountValue>().Property(d => d.Fixed).HasPrecision(18, 2); modelBuilder.ComplexType<DiscountValue>().Property(d => d.Percentage).HasPrecision(18, 4); modelBuilder.Entity<InvoiceFee>().Property(d => d.Fixed).HasPrecision(18, 2); modelBuilder.Entity<InvoiceFee>().Property(d => d.Percentage).HasPrecision(18, 4); modelBuilder.Entity<InvoiceFee>().Property(d => d.Total).HasPrecision(18, 4); modelBuilder.Entity<Invoice>().Property(d => d.Discount).HasPrecision(18, 2); modelBuilder.Entity<Invoice>().HasRequired(i => i.Appointment).WithOptional(a => a.Invoice).WillCascadeOnDelete(false); modelBuilder.Entity<InvoiceItem>().Property(d => d.Price).HasPrecision(18, 2); modelBuilder.Entity<InvoiceItem>().Property(d => d.LatestTotal).HasPrecision(18, 2); modelBuilder.Entity<InvoiceItem>().HasRequired(i => i.Allocation).WithOptional(a => a.InvoiceItem).WillCascadeOnDelete(false); modelBuilder.Entity<InvoicePayment>().Property(d => d.Amount).HasPrecision(18, 4); modelBuilder.Entity<ServicePrice>().Property(d => d.Price).HasPrecision(18, 2); modelBuilder.Entity<ServiceBreedPrice>().Property(d => d.Price).HasPrecision(18, 2); modelBuilder.Entity<ProviderPolicy>().Property(d => d.SalesTax).HasPrecision(18, 4); modelBuilder.Entity<ProviderCredit>().Property(d => d.Balance).HasPrecision(18, 2); modelBuilder.Entity<CombinedServiceDiscountDefinition>().HasRequired(c => c.PrimaryService).WithMany().WillCascadeOnDelete(false); modelBuilder.Entity<CombinedServiceDiscountDefinition>().HasRequired(c => c.SecondaryService).WithMany().WillCascadeOnDelete(false); modelBuilder.Entity<MedicalRecord>().HasRequired(m => m.Pet).WithOptional(p => p.Medical).WillCascadeOnDelete(false); modelBuilder.Entity<BehavioralRecord>().HasRequired(b => b.Pet).WithOptional(p => p.Behavioral).WillCascadeOnDelete(false); modelBuilder.Entity<DietRecord>().HasRequired(d => d.Pet).WithOptional(p => p.Diet).WillCascadeOnDelete(false); modelBuilder.Entity<Provider>().HasOptional(p => p.Profile).WithRequired(p => p.Provider).WillCascadeOnDelete(true); modelBuilder.Entity<ProviderProfile>().HasOptional(p => p.Policy).WithRequired(p => p.Profile).WillCascadeOnDelete(true); modelBuilder.Entity<ProviderProfile>().HasOptional(p => p.CustomerRequirements).WithRequired(p => p.Profile).WillCascadeOnDelete(true); modelBuilder.Entity<ProviderProfile>().HasOptional(p => p.PaymentProfile).WithRequired(p => p.Profile).WillCascadeOnDelete(true); modelBuilder.Entity<Resource>().HasMany(r => r.Availability).WithRequired(a => a.Resource).WillCascadeOnDelete(true); Database.SetInitializer<DataCatalog>(null); base.OnModelCreating(modelBuilder); } public const string ServiceKey = ""PawLoyalty""; public DbSet<StreetAddress> StreetAddresses { get; set; } public DbSet<Appointment> Appointments { get; set; } public DbSet<Invoice> Invoices { get; set; } public DbSet<InsuranceCarrier> InsuranceCarriers { get; set; } public DbSet<PromotionCode> PromotionCodes { get; set; } // Provider Classes public DbSet<Provider> Providers { get; set; } public DbSet<ProviderProfile> ProviderProfiles { get; set; } //public DbSet<ProviderResourceItem> ProviderResourceItems { get; set; } public DbSet<Allocation> ResourceAllocations { get; set; } public DbSet<ResourceAvailability> ResourceAvailabilities { get; set; } public DbSet<Resource> Resources { get; set; } /// <summary> /// Wraps the object context detach method /// </summary> /// <typeparam name=""T""></typeparam> /// <param name=""t""></param> public void Detach<T>(T t) where T : class { // TODO: Is this needed? Hidden behind an interface in CTP5 implying infrequent usage. ((IObjectContextAdapter)this).ObjectContext.Detach(t); } // Owner Classes public DbSet<MedicalRecordOrder> Orders { get; set; } public DbSet<Owner> Owners { get; set; } public DbSet<Pet> Pets { get; set; } public DbSet<Breed> Breeds { get; set; } public DbSet<PetProvider> PetProviders { get; set; } // Security Catalog Items public DbSet<User> Users { get; set; } // Bing Maps Catalog items public DbSet<KnownLocation> KnownLocations { get; set; } public DbSet<KnownPostalCode> KnownPostalCodes { get; set; } public DbSet<QueuedEmail> QueuedEmails { get; set; } public DbSet<InvoicePayment> InvoicePayments { get; set; } public DbSet<Employee> Employees { get; set; } public DbSet<Schedule> Schedules { get; set; } public DbSet<Subscription> Subscriptions { get; set; } public DbSet<EmailSubscription> EmailSubscriptions { get; set; } public DbSet<ResourceAvailabilityUpdate> ResourceAvailabilityUpdates { get; set; } public DbSet<EmployeeAvailabilityUpdate> EmployeeAvailabilityUpdates { get; set; } public DbSet<InvoiceConfiguration> InvoiceConfigurations { get; set; } public DbSet<Vaccine> Vaccines { get; set; } public DbSet<TourEmail> TourEmails { get; set; } public DbSet<ReservationRequest> ReservationRequest { get; set; } //public DbSet<ReservationRequestPets> ReservationRequestPets { get; set; } public DbSet<Vaccination> Vaccinations { get; set; } public DbSet<SpecialInstruction> SpecialInstructions { get; set; } public DbSet<Product> Products { get; set; } public DbSet<ProductCategory> ProductCategories { get; set; } public DbSet<VendorStock> VendorStocks { get; set; } public DbSet<ShoppingCart> ShoppingCarts { get; set; } public DbSet<SaleDetail> SaleDetails { get; set; } public DbSet<Sale> Sales { get; set; } public DbSet<SalePayment> SalePayments { get; set; } public DbSet<PetService> PetServices { get; set; } public DbSet<PetServicePrice> PetServicePrices { get; set; } public DbSet<MiscProperty> MiscProperties { get; set; } public DbSet<ProviderMiscProperty> ProviderMiscProperties { get; set; } public DbSet<ProviderAuthorizedCreditCard> ProviderAuthorizedCreditCards { get; set; } public DbSet<AuthorizedCreditCard> AuthorizedCreditCards { get; set; } public DbSet<ProviderPackage> ProviderPackages { get; set; } public DbSet<ProviderEmailPreference> ProviderEmailPreferences { get; set; } public DbSet<EmailType> EmailTypes { get; set; } public DbSet<RetailSaleReturn> RetailSaleReturns { get; set; } public DbSet<ServiceRefund> ServiceRefunds { get; set; } }",Entity Framework code first with T4 template
C# BulkCopy class error The locale id '1025' of the source column even with Coulmn mapping," Im performing SQL bulk copy using the SqlBulkCopy class. I created my destination table to be exactly the same of my source table. They both have the same table name, columns names, data types and even the same collation. I did also the sql mapping to ensure accuracy. My code as follow: However, every time I execute my code I got the following error: The locale id '1025' of the source column 'CreatedBy' and the locale id '1033' of the destination column 'CreatedBy' do not match.I have searched a lot over the internet but no luck for any solution. I would be so thankful if someone helped me out. <code>  SqlConnection SourceConnection = new SqlConnection(SourceConnectionString);SqlConnection DestinationConnection = new SqlConnection(DestinationConnectionString);DestinationConnection.Open();SourceConnection.Open();SqlCommand commandSourceData = new SqlCommand(""SELECT * FROM Requisitions;"", SourceConnection);SqlDataReader reader = commandSourceData.ExecuteReader(); using (SqlBulkCopy bulkCopy = new SqlBulkCopy(DestinationConnection)) { bulkCopy.DestinationTableName = ""Requisitions""; bulkCopy.ColumnMappings.Add(""RequisitionId"", ""RequisitionId""); bulkCopy.ColumnMappings.Add(""CreatedBy"", ""CreatedBy""); bulkCopy.ColumnMappings.Add(""DateCreated"", ""DateCreated""); bulkCopy.ColumnMappings.Add(""AircraftTailNum"", ""AircraftTailNum""); bulkCopy.ColumnMappings.Add(""JobNumber"", ""JobNumber""); bulkCopy.ColumnMappings.Add(""ShopCode"", ""ShopCode""); bulkCopy.ColumnMappings.Add(""RequestedByName"", ""RequestedByName""); bulkCopy.ColumnMappings.Add(""RequestedById"", ""RequestedById""); bulkCopy.ColumnMappings.Add(""Status"", ""Status""); bulkCopy.ColumnMappings.Add(""IsCancelled"", ""IsCancelled""); bulkCopy.ColumnMappings.Add(""IsProcessed"", ""IsProcessed""); try { // Write from the source to the destination. bulkCopy.WriteToServer(reader); } catch (Exception ex) { Console.WriteLine(ex.Message); } finally { reader.Close(); } }",BulkCopy error: The locale id '1025' of the source column 'CreatedBy' and the locale id '1033' of the destination column 'CreatedBy' do not match
Why do i use volatile get the diffrent result?," Sometimes the result is 0,sometimes the result is -xxxxxx. I don't know why. Can anybody explain it and tell me the correct usage. <code>  private const int Total = 500000; private static volatile int _count = 0; private static void Main() { Task task = Task.Factory.StartNew(Decrement); for (int i = 0; i < Total; i++) { _count++; } task.Wait(); Console.WriteLine(_count); Console.ReadLine(); } private static void Decrement() { for (int i = 0; i < Total; i++) { _count--; } }",Why does using volatile produce a different result?
"return Json, but it includes forward slash ** \ **, whcih i dont want"," I use MVC4 web-api, c#, and want to return Json using Json.net.The problem is it comes with ""backward slashes"".I also added this code to Global.asax.GlobalConfiguration.Configuration.Formatters.XmlFormatter.SupportedMediaTypes.Clear();Here is what it returns: So what I want to see is this:{""cid"":1,""model"":""WT50JB"",""detail"":""sdf??"",""unit"":2,""time_in"":""2012-12-11T19:00:00"",""time_out"":""2012-12-12T13:08:50.5444555+07:00"",""time_used_dd"":0.0,""time_used_hh"":0.0}Here is JsonConvertor <code>  ""{\""cid\"":1,\""model\"":\""WT50JB\"",\""detail\"":\""sdf??\"",\""unit\"":2,\""time_in\"":\""2012-12-11T19:00:00\"",\""time_out\"":\""2012-12-12T13:00:06.2774691+07:00\"",\""time_used_dd\"":0.0,\""time_used_hh\"":0.0}"" string json = JsonConvert.SerializeObject(myObj);","Return Json, but it includes backward slashes ""\"", which I don't want"
"Return Json, but it includes forward slash ""\"", which i don't want"," I use MVC4 web-api, c#, and want to return Json using Json.net.The problem is it comes with ""backward slashes"".I also added this code to Global.asax.GlobalConfiguration.Configuration.Formatters.XmlFormatter.SupportedMediaTypes.Clear();Here is what it returns: So what I want to see is this:{""cid"":1,""model"":""WT50JB"",""detail"":""sdf??"",""unit"":2,""time_in"":""2012-12-11T19:00:00"",""time_out"":""2012-12-12T13:08:50.5444555+07:00"",""time_used_dd"":0.0,""time_used_hh"":0.0}Here is JsonConvertor <code>  ""{\""cid\"":1,\""model\"":\""WT50JB\"",\""detail\"":\""sdf??\"",\""unit\"":2,\""time_in\"":\""2012-12-11T19:00:00\"",\""time_out\"":\""2012-12-12T13:00:06.2774691+07:00\"",\""time_used_dd\"":0.0,\""time_used_hh\"":0.0}"" string json = JsonConvert.SerializeObject(myObj);","Return Json, but it includes backward slashes ""\"", which I don't want"
"Return Json, but it includes backward slashes ""\"", which i don't want"," I use MVC4 web-api, c#, and want to return Json using Json.net.The problem is it comes with ""backward slashes"".I also added this code to Global.asax.GlobalConfiguration.Configuration.Formatters.XmlFormatter.SupportedMediaTypes.Clear();Here is what it returns: So what I want to see is this:{""cid"":1,""model"":""WT50JB"",""detail"":""sdf??"",""unit"":2,""time_in"":""2012-12-11T19:00:00"",""time_out"":""2012-12-12T13:08:50.5444555+07:00"",""time_used_dd"":0.0,""time_used_hh"":0.0}Here is JsonConvertor <code>  ""{\""cid\"":1,\""model\"":\""WT50JB\"",\""detail\"":\""sdf??\"",\""unit\"":2,\""time_in\"":\""2012-12-11T19:00:00\"",\""time_out\"":\""2012-12-12T13:00:06.2774691+07:00\"",\""time_used_dd\"":0.0,\""time_used_hh\"":0.0}"" string json = JsonConvert.SerializeObject(myObj);","Return Json, but it includes backward slashes ""\"", which I don't want"
where is ExecuteStoreCommand in Entity Framework 5?," I'm using EF5 in VS2012, and I trying to delete all data of some table using ExecuteStoreCommand, something like this: but the problem is EF is telling me, method ExecuteStoreCommand not found. I can't understand why?Can you tell me why?, or give me a performant solution remove all data of the table. <code>  ctx.ExecuteStoreCommand(""TRUNCATE TABLE ["" + tableName + ""]"");",Where is the ExecuteStoreCommand method in Entity Framework 5?
ASP C#: Show data into asp html table," I am writing an ASP.NET page which reads data from a database and needs to show it in a table. For some reason, I don't want to use the gridView. How do I show the data in a table on the HTML page?This is my C# code: This is my ASPX page: <code>  SqlConnection thisConnection = new SqlConnection(dbConnection); SqlCommand thisCommand = thisConnection.CreateCommand(); thisCommand.CommandText = ""SELECT * from Test""; thisConnection.Open(); SqlDataReader reader = thisCommand.ExecuteReader(); while (reader.Read()) { int id = reader.GetInt32(0); string Name = reader.GetString(1); string Pass = reader.GetString(2); } thisConnection.Close(); <%@ Page Language=""C#"" AutoEventWireup=""true"" MasterPageFile=""~/test.master"" CodeFile=""test.aspx.cs"" Inherits=""test"" %><asp:Content ID=""BodyContent"" runat=""server"" ContentPlaceHolderID=""ContentPlaceHolder""> <table width=""100%"" align=""center"" cellpadding=""2"" cellspacing=""2"" border=""0"" bgcolor=""#EAEAEA"" > <tr align=""left"" style=""background-color:#004080;color:White;"" > <td> ID </td> <td> Name </td> <td>Pass</td> </tr> **<%--Need the while output into here--%>** </table></asp:Content>",Show data in ASP.NET html table
Using a Microsoft DLL as a reference in class library," I created a windows service to interact with a TFS server, and it is working fine on my local machine. In order to make this work, I had to add references to Microsoft.TeamFoundation.Client.dll - I copied this file from my TFS installation on my local machine, and then added it in a folder and then added the references to the dll from my project. Now I need to deploy on the server, and I thought copying the dll on the server on the same level as the .exe would be enough. But it keeps saying that Could not load file or assembly 'Microsoft.TeamFoundation.ClientWhat do I need to do here?EDIT: OK, so I found that the microsoft dll is 32 bit, while the server is 64 bit. I changed my service target to be 32 bit also, and I still have the same problem... <code> ",Using Team Foundation Server DLL as a reference in class library
How to speed up Silverlight Scroll Viewer + ItemsControl with lots of data," Problem: Displaying large amounts of data in a scrollable area has horrible performance and/or User eXperience.Tried: Basically set a DataTemplate in a ListBox to show a grid of populated data with the VirtualizationMode set to Recycle and a fixed height set on the ListBox iteself. Something like the example below. The ContentControl would be bringing in a standard <Grid> from another view that formats the overall layout of the populated items consisting of around 20 static, and 20 data bound TextBlocks.This works alright, and cut the initial loads in half. HOWEVER, now the problem is I need the ability for the height to NOT be a fixed size so it takes up the space available in its parent and can even be resized. Thanks to @DanFox I found out you have to fix the height in one form or another to invoke the virtualizing or the RenderEngine just thinks it has infinite room anyway.The Question is: Is there a better way to do this, or how can I at least fix the current technique to allow for better UX? I'm generating potentially hundreds of these items so I need the performance enhancement of virtualization. However I also need to allow the user to resize the window and retain the ability to scroll effectively.Any insight is greatly appreciated, thanks and Happy Holidays! <code>  <ListBox x:Name=""Items"" TabNavigation=""Once"" VirtualizingStackPanel.VirtualizationMode=""Recycling"" Height=""500""> <ListBox.ItemTemplate> <DataTemplate> <StackPanel Orientation=""Horizontal"" Margin=""0,5""> <HyperlinkButton Content=""Action"" Margin=""5""/> <ContentControl cal:View.Model=""{Binding}"" VerticalContentAlignment=""Stretch"" HorizontalContentAlignment=""Stretch""/> </StackPanel> </DataTemplate> </ListBox.ItemTemplate> </ListBox>",Virtualization Performance Issue with Large Scrollable Data SL4
removing dynamic controls from the panel with help of tablelayoutpanel," I have dynamically generated controls on the panels of windows form and i have also generated a button for removing the controls, all in rows. Now how do I remove all the controls from a row upon clicking a button from that row? <code>  int c = 0;private void button1_Click(object sender, EventArgs e){ int v; v = c++; panel1.VerticalScroll.Value = VerticalScroll.Minimum; ComboBox combo = new ComboBox(); combo.Name = ""combobox"" + v ; combo.Location = new Point(30, 5 + (30 * v)); ComboBox combo2 = new ComboBox(); combo2.Name = ""combobox2"" + v ; combo2.Location = new Point(170, 5 + (30 * v)); TextBox txt = new TextBox(); txt.Name = ""txtbx"" + v; txt.Location = new Point(300, 5 + (30 * v)); TextBox txt2 = new TextBox(); txt2.Name = ""txtbx2"" + v; txt2.Location = new Point(450, 5 + (30 * v)); TextBox txt3 = new TextBox(); txt3.Name = ""txtbx3"" + v; txt3.Location = new Point(600, 5 + (30 * v)); Button btn = new Button(); btn.Name = ""btn"" + v; btn.Text = ""Remove""; btn.Location = new Point(750, 5 + (30 * v)); panel1.Controls.Add(combo); panel1.Controls.Add(btn); panel1.Controls.Add(txt); panel1.Controls.Add(combo2); panel1.Controls.Add(txt2); panel1.Controls.Add(txt3); btn.Click += new EventHandler(btn_Click); combo.Tag = btn; combo2.Tag = combo; btn.Tag = combo2;} private void btn_Click(object sender, EventArgs e) { ComboBox cb3 = btnh.Tag as ComboBox; ComboBox cb4 = cb3.Tag as ComboBox; panel1.Controls.Remove(cb3); panel1.Controls.Remove(cb4); panel1.Controls.Remove(btnh); }",Removing dynamic controls from panel
c# unit-testing abstract classes and protected methods inside them," how can I test abstract classes and protected methods inside them? I know some of you will suggest that I shouldn't test the abstract class, but rather test the classes that derive from it instead. Thing is, I don't want to do that. I want to strictly test the abstract class itself. Here is the sample class: I'm writing a unit test for it. I know that one of the things I can do is utilize a unit-testing framework (I have Moq), but I have no idea on how to use it for this particular instance.  <code>  public interface IF_SystemMessageHandler{ ...}public interface IF_SystemMessageSender{ ...} public abstract class Component : IF_SystemMessageSender { private eVtCompId mComponentId; private eLayer mLayerId; private IF_SystemMessageHandler mLogger; protected Component(eVtCompId inComponentId, eLayer inLayerId, IF_SystemMessageHandler inMessageHandler) { mLayerId = inLayerId; mComponentId = inComponentId; mLogger = inMessageHandler; } protected void SendSystemMessage(ref eSystemMsgLevel inSystemMsgLevel, ref string inSysMsg) { mLogger.SendSystemMessage(...); } protected void SendSystemMessage(ref eSystemMsgLevel inSystemMsgLevel, ref eTextId inSysMsgID) { mLogger.SendSystemMessage(...); } public void SetMessageHandler(ref IF_SystemMessageHandler InSystemMessageHandler) { mLogger = InSystemMessageHandler; } }",unit-testing abstract classes and protected methods inside them
how to set ip address of client manually in .net socket program," I created a multithreaded client-server chat application and want to test my application with multiple clients. I'm planning to create a simulator in client side which create a random port and IP. By that I mean my client system should run with multiple ports (without running multiple times).I tried to find out the part of the code which gives client IP and port number in the client class, but couldn't figure it out. I only found the part which gives server IP and port.This is my connection establishing part and my data sending part <code>  private void cmdConnect_Click(object sender, System.EventArgs e) { try { //create a new client socket ... m_socWorker = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.IP); String szIPSelected = txtIPAddress.Text; String szPort = txtPort.Text; int alPort = System.Convert.ToInt16 (szPort,10); System.Net.IPAddress remoteIPAddress = System.Net.IPAddress.Parse(szIPSelected); System.Net.IPEndPoint remoteEndPoint = new System.Net.IPEndPoint(remoteIPAddress, alPort); m_socWorker.Connect(remoteEndPoint); } catch (System.Net.Sockets.SocketException se) { MessageBox.Show ( se.Message ); } } private void cmdSendData_Click(object sender, System.EventArgs e) { try { Object objData = txtData.Text; byte[] byData = System.Text.Encoding.ASCII.GetBytes(objData.ToString ()); m_socWorker.Send (byData); } catch(System.Net.Sockets.SocketException se) { MessageBox.Show (se.Message ); } }",How to set IP address of client manually in .net socket program
Stricturemap - Override registration," Is it possible to register an interface in a registry, then ""re-register"" it to override the first registration?I.E.: What I want here on runtime is that my object factory returns SomeClassExtension when I ask for ISomeInterface.Thanks in advance! <code>  For<ISomeInterface>().Use<SomeClass>();For<ISomeInterface>().Use<SomeClassExtension>();",Structuremap - Override registration
How to get the the second to last directory in a path string in C#," For example, I need to get only @""C:\User\Desktop\Drop\Is there any easy way of doing this? <code>  string path = @""C:\User\Desktop\Drop\images\"";",How to get the second to last directory in a path string in C#
Populating the data attribute of an object tag with an action that serves a PDF file result," I have a FileResult action that returns a PDF. I want to embed this PDF in an object tag. When I insert the action into the data attribute of the object tag, like below, no PDF is retrieved or shown in Chrome. (The PDF is shown in Firefox with the Adobe plugin - I don't care about IE.) It all works otherwise - the object tag works with a direct link to a PDF on the file system (e.g., data=""~/Content/test.pdf""), and the Action above, if hard-pasted into the location bar, downloads the PDF.Any thoughts? Thank you! <code>  <object data=""@Url.Action(""GetPDF"", ""PDFCreation"", new {id= Model.DocumentId})"" type=""application/pdf""></object>",Populating the data attribute of an object tag in Chrome with an ASP.NET MVC action that serves a PDF file result
Populating the data attribute of an object tag in Chrome with an action that serves a PDF file result," I have a FileResult action that returns a PDF. I want to embed this PDF in an object tag. When I insert the action into the data attribute of the object tag, like below, no PDF is retrieved or shown in Chrome. (The PDF is shown in Firefox with the Adobe plugin - I don't care about IE.) It all works otherwise - the object tag works with a direct link to a PDF on the file system (e.g., data=""~/Content/test.pdf""), and the Action above, if hard-pasted into the location bar, downloads the PDF.Any thoughts? Thank you! <code>  <object data=""@Url.Action(""GetPDF"", ""PDFCreation"", new {id= Model.DocumentId})"" type=""application/pdf""></object>",Populating the data attribute of an object tag in Chrome with an ASP.NET MVC action that serves a PDF file result
Pattern to get objects detailed difference and statistics or how to create diff tool," Let's say i have such structure So the Form class contains the list of fields, let's say that the Field itself is represented with such structure The Field is basically composite structure, each Field contains the list of child fields. So the structure is hierarchical. Also Field has reference to the FieldType class. And at the end we have reference to the DataType What I want to achieve is to get the difference of such complex structure, let's say if I have some sort of Comparer it will give me structured difference for the whole form as one class, let's say DifferenceResult. When I said structured difference I mean that it should be something like that.Difference for the Form fields (output Form has difference in Version field (different color)Differences for the Fields collection, including the hierarchy of the fields to the edited fieldSame behavior for the FieldType and DataTypeDetect removing and adding the Field into the Form (so probably each Difference will have a Type)What I have right now. I started with generic approach and tried to use ReflectionComparer implementing IEqualityComparer interface And Difference class But probably it's not the way I want to go, because I should compare Field more precisely taking in consideration that each Field has Id, which can be different for different forms as well and I want to take more control of the comparing process. For me it sounds more like a diff tool.So I am looking for good pattern and pretty good structure to publish the Difference to the client code, which can easily visualize it? <code>  public class Form{ #region Public Properties public List<Field> Fields { get; set; } public string Id { get; set; } public string Name { get; set; } public string Version { get; set; } public int Revision { get; set; } #endregion} public class Field{ #region Public Properties public string DisplayName { get; set; } public List<Field> Fields { get; set; } public string Id { get; set; } public FieldKind Type { get; set; } public FieldType FieldType { get; set; } #endregion} public class FieldType{ #region Public Properties public DataType DataType { get; set; } public string DisplayName { get; set; } public string Id { get; set; } #endregion} public class DataType{ #region Public Properties public string BaseType { get; set; } public string Id { get; set; } public string Name { get; set; } public List<Restriction> Restrictions { get; set; } #endregion} public bool Equals(T x, T y){ var type = typeof(T); if (typeof(IEquatable<T>).IsAssignableFrom(type)) { return EqualityComparer<T>.Default.Equals(x, y); } var enumerableType = type.GetInterface(typeof(IEnumerable<>).FullName); if (enumerableType != null) { var elementType = enumerableType.GetGenericArguments()[0]; var elementComparerType = typeof(DifferenceComparer<>).MakeGenericType(elementType); var elementComparer = Activator.CreateInstance(elementComparerType, new object[] { _foundDifferenceCallback, _existedDifference }); return (bool)typeof(Enumerable).GetGenericMethod(""SequenceEqual"", new[] { typeof(IEnumerable<>), typeof(IEnumerable<>), typeof(IEqualityComparer<>) }).MakeGenericMethod(elementType).Invoke(null, new[] { x, y, elementComparer }); } foreach (var propertyInfo in type.GetProperties()) { var leftValue = propertyInfo.GetValue(x); var rightValue = propertyInfo.GetValue(y); if (leftValue != null) { var propertyComparerType = typeof(DifferenceComparer<>).MakeGenericType(propertyInfo.PropertyType); var propertyComparer = Activator.CreateInstance(propertyComparerType, new object[] {_foundDifferenceCallback, _existedDifference}); if (!((bool)typeof(IEqualityComparer<>).MakeGenericType(propertyInfo.PropertyType) .GetMethod(""Equals"") .Invoke(propertyComparer, new object[] { leftValue, rightValue }))) { // Create and publish the difference with its Type } } else { if (!Equals(leftValue, rightValue)) { // Create and publish the difference with its Type } } } //return true if no differences are found} public struct Difference{ public readonly string Property; public readonly DifferenceType Type; public readonly IExtractionable Expected; public readonly IExtractionable Actual;}",Pattern to get objects structured difference and statistics or how to create diff tool
Tips on reducing MonoTouch compilation time," It is well known that If compiling takes even 15 seconds, programmers will get bored while the compiler runs and switch over to reading The Onion, which will suck them in and kill hours of productivity.Our MonoTouch app takes 40 seconds to compile on Macbook Air in Debug/Simulator configuration. We have about 10 assemblies in the solution.We're also linking against some native libraries with gcc_flags.I'm sure there are ways to optimize compilation time that I'm not aware of, which might have to do with references, linker, whatever. I'm asking this question in hope that someone with better knowledge than me will compile (no pun intended) a list of tips and things to check to reduce MonoTouch compilation time for debug builds.Please don't suggest hardware optimizations or optimizations not directly related to MonoTouch.  <code> ",How to speed up MonoTouch compilation time?
How to fix utf encoding for whitespaces?," In my C# code, I am extracting text from a PDF document. When I do that, I get a string that's in UTF-8 or Unicode encoding (I'm not sure which). When I use Encoding.UTF8.GetBytes(src); to convert it into a byte array, I notice that the whitespace is actually two characters with byte values of 194 and 160.For example the string ""CLE action"" looks like in a byte array, where the whitespace is 194 and 160... And because of this src.IndexOf(""CLE action""); is returning -1 when I need it to return 1. How can I fix the encoding of the string? <code>  [67, 76, 69, 194 ,160, 65 ,99, 116, 105, 111, 110]",How to fix UTF encoding for whitespaces?
C# - Using Reflection or Alternative to Create Function Calls Programatically," I'm a bit of a novice with Reflection. I'm hoping that it's possible to do what I'd like it to. I've been working through ProjectEuler to learn the language, and I have a base class called Problem. Every individual PE problem is a separate class, i.e. Problem16. To run my calculations, I use the following code: I have completed 50 problems now, and I want to create a loop to run them all. My base class Problem has a method that appends to a text file the problem number, the answer, and the execution time that's called in each class's default constructor. I could manually change the function call for all 50, but as I continue to complete problems, this will end up being a lot of work.I'd much rather do it programatically. I was hoping for this pseudocode become a reality: <code>  using System;using Euler.Problems;using Euler.Library;namespace Euler{ static class Program { [STAThread] static void Main() { Problem prob = new Problem27(); } }} for (int i = 1; i <= 50; i++){ string statement = ""Problem prob = new Problem"" + i + ""();""; // Execute statement}",How can I use reflection or alternative to create function calls programatically?
csharp: Char object is ignored in string concatenation," I noticed that the fully qualified name of an object I had written was coming back funny. While stepping through my ToString() method, I noticed that when it came to concatenating the string, a character object was consistently being left out of that process.Here's a step through of what's happeningBeforeAfterWhere Char seperator = ':';Here's the code of my tostring function: Where you have And one case may look like this:Already, looking in the locals panel, it seems like VS is getting a string other than what I think it would.I put in another ToString function to handle a call without parameters (which it does by calling the parametrized function with Representation.Colons): Can anyone tell why I'm not getting what I think I should be getting? (Expected result: kuid2:72938:40175:2) <code>  public String ToString(Representaion rep) { String toReturn = ""kuid""; Char separator = ':'; switch (rep) { case Representaion.Colons: break; case Representaion.Underscores: separator = '_'; break; case Representaion.UCROnly: toReturn = userID + "":"" + contentID; toReturn += revision == 0 ? """" : "":"" + revision; return toReturn; } toReturn += version == 0 ? """" : version.ToString(); toReturn += separator + userID + separator + contentID; toReturn += revision == 0 ? """" : separator + revision.ToString(); return toReturn; } private byte version;private int userID;private int contentID;private byte revision; public override string ToString() { return this.ToString(KUID.Representaion.Colons); }",Char object is ignored in string concatenation
Generic List XML Serialization with differenct classes," I have got the following code:BaseContent.cs News.cs Events.cs GenericResponse.cs NewsResponse.cs EventResponse.cs As you can see, I have a base class BaseContent and two classes deriving from it. Next I have a generic response class, since the structure of the xml-files is always the same, but they differ in some properties. I thought I can specify with the [XmlArrayItem] which name to use for a specific class. But now I get the error: System.InvalidOperationException: Unable to generate a temporary class (result=1). error CS0012: The type 'System.Object' is defined in an assembly that is not referenced. You must add a reference to assembly 'System.Runtime, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'.I can not add this reference, because I'm working on a Windows 8 App.If I comment out one of the [XmlArrayItem] it is working well.Anyone got an idea to solve this problem?UpdateI can not use DataContractSerializer, because I have to use XmlAttributes <code>  public class BaseContent{ // Some auto properties} public class News : BaseContent{ // Some more auto properties} public class Event : BaseContent{ // Some more auto properites} public class GenericResponse<T> { [XmlArray(""Content"")] [XmlArrayItem(""NewsObject"", typeof(News)] [XmlArrayItem(""EventObject"", typeof(Event)] public List<T> ContentItems { get; set; }} public class NewsResponse : GenericResponse<News> {} public class EventResponse : GenericResponse<Event> {}",Generic List XML Serialization with different classes
Adaptive layouts in WPF," A website can be designed to adapt to smaller screen sizes using media queries. For example, three columns on a wide screen, one column on a low-resolution phone.Is there a similar technique for WPF to adjust the layout based on available screen space or parent control size?For example, I'd like to have 3 columns displayed horizontally on a large screen, but displayed vertically on smaller screen. Ideally, I'd like to formulate layouts like this: ""If this control's width is less than 400 points, rearrange these controls in that way.""How can I create an adaptive design like this in WPF? That is, define different layouts for controls for specific parent control sizes? Ideally controls should be rearranged instead of duplicated or recreated, to avoid being extremely slow. <code> ",How can I create an adaptive layout in WPF?
C# BigInteger Parse Octal String?," In Java, I could do Then format it as I pleased C#'s BigInteger offers the formatting capabilities shown above but I can't seem to find a way to parse BIIIG (greater than 64 bit, unsigned) Octal values. <code>  //Parsing Octal StringBigInteger b = new BigInteger(""16304103460644701340432043410021040424210140423204"",8); b.toString(2); //2 for binaryb.toString(10); //10 for decimalb.toString(16); //16 for hexadecimal",BigInteger Parse Octal String?
newbie with dapper and c#," The following code when compiling gives the error message below: 'System.Data.SqlClient.SqlConnection' does not contain a definition for 'Query' and no extension method 'Query' accepting a first argument of type 'System.Data.SqlClient.SqlConnection' could be found (are you missing a using directive or an assembly reference?)I have added Dapper using the nuget packager.Any ideas?Thanks,CODE: <code>  using (SqlConnection sqlConnection = new SqlConnection(Connectionstring)){ sqlConnection.Open(); Member customer = sqlConnection.Query<Member>(""SELECT * FROM member""); return customer;}",System.Data.SqlClient.SqlConnection does not contain a definition for Query with dapper and c#
C#/VB.NET Timer," I am aware that in .NET there are three timer types (see Comparing the Timer Classes in the .NET Framework Class Library). I have chosen a threaded timer as the other types can drift if the main thread is busy, and I need this to be reliable.The way this timer works in the control of the timer is put on another thread so it can always tick along with the work begin completed on the parent thread when it is not busy.The issue with this timer in a console application is that while the timer is ticking along on another thread the main thread is not doing anything so the application closes.I tried adding a while true loop, but then the main thread is too busy when the timer does go off. <code> ",How do I get my console application to run a background process on another thread without exiting?
"Polymorphic Overloaded Method ""Fallthrough"""," ProblemI am working with an already existing library, to the source code of which I do not have access. This library represents an AST.I want to copy parts of this AST, but rename references to variables in the process. Since there can be a AssignCommand-Object, which holds an Expression-object, I want to be able to copy each object with its own function, so I can call them recursively. However, since I do not have access to the code of the library, I cannot add a method such as CopyAndRename(string prefix).Thus, my approach was to create a single function Rename with several overloads. Thus, I would have a family functions as follows: A function now consists of a List<Command>, where AssignCommand is a subclass of Command. I assumed that I could just pass a Command to the Rename-function and the runtime would find the most specific one. However, this is not the case and all commands are passed to Command Rename(Command cmd, string prefix). Why is this the case? Is there a way to delegate the call to the correct function without using ugly is-operations?Minimal ExampleI have broken this problem down to the following NUnit-Testcode So my question boils down to: ""How can the test above be fixed in an elegant, polymorphic, object-oriented way without resorting to is-checks?""Extension MethodsI have also tried using extension methods as follows. This did not solve the problem, since they are merely syntactical sugar for the approach above: <code>  public static Command Rename(Command cmd, string prefix)public static AssignCommand Rename(AssignCommand cmd, string prefix)public static AdditionExpressionRename(AdditionExpression expr, string prefix).... using NUnit.Framework;public class TopClass{ public int retVal;}public class SubClassA : TopClass{ }[TestFixture]public class ThrowawayTest { private TopClass Foo (TopClass x) { x.retVal = 1; return x; } private SubClassA Foo (SubClassA x) { x.retVal = 2; return x; } [Test] public void OverloadTest(){ TopClass t = new TopClass(); TopClass t1 = new SubClassA(); SubClassA s1 = new SubClassA(); t = Foo (t); t1 = Foo (t1); s1 = Foo (s1); Assert.AreEqual(1, t.retVal); Assert.AreEqual(2, s1.retVal); Assert.AreEqual(2, t1.retVal); }} using NUnit.Framework;using ExtensionMethods;public class TopClass{ public int retVal;}public class SubClassA : TopClass{ }[TestFixture]public class ThrowawayTest { private TopClass Foo (TopClass x) { x.retVal = 1; return x; } private SubClassA Foo (SubClassA x) { x.retVal = 2; return x; } [Test] public void OverloadTest(){ TopClass t = new TopClass(); TopClass t1 = new SubClassA(); SubClassA s1 = new SubClassA(); t.Foo(); s1.Foo(); t1.Foo(); Assert.AreEqual(1, t.retVal); Assert.AreEqual(2, s1.retVal); Assert.AreEqual(2, t1.retVal); }}namespace ExtensionMethods{ public static class Extensions { public static void Foo (this TopClass x) { x.retVal = 1; } public static void Foo (this SubClassA x) { x.retVal = 2; } }}",Dynamic Dispatch without Visitor Pattern
Dynamic Dispatch in C# without Visitor Pattern," ProblemI am working with an already existing library, to the source code of which I do not have access. This library represents an AST.I want to copy parts of this AST, but rename references to variables in the process. Since there can be a AssignCommand-Object, which holds an Expression-object, I want to be able to copy each object with its own function, so I can call them recursively. However, since I do not have access to the code of the library, I cannot add a method such as CopyAndRename(string prefix).Thus, my approach was to create a single function Rename with several overloads. Thus, I would have a family functions as follows: A function now consists of a List<Command>, where AssignCommand is a subclass of Command. I assumed that I could just pass a Command to the Rename-function and the runtime would find the most specific one. However, this is not the case and all commands are passed to Command Rename(Command cmd, string prefix). Why is this the case? Is there a way to delegate the call to the correct function without using ugly is-operations?Minimal ExampleI have broken this problem down to the following NUnit-Testcode So my question boils down to: ""How can the test above be fixed in an elegant, polymorphic, object-oriented way without resorting to is-checks?""Extension MethodsI have also tried using extension methods as follows. This did not solve the problem, since they are merely syntactical sugar for the approach above: <code>  public static Command Rename(Command cmd, string prefix)public static AssignCommand Rename(AssignCommand cmd, string prefix)public static AdditionExpressionRename(AdditionExpression expr, string prefix).... using NUnit.Framework;public class TopClass{ public int retVal;}public class SubClassA : TopClass{ }[TestFixture]public class ThrowawayTest { private TopClass Foo (TopClass x) { x.retVal = 1; return x; } private SubClassA Foo (SubClassA x) { x.retVal = 2; return x; } [Test] public void OverloadTest(){ TopClass t = new TopClass(); TopClass t1 = new SubClassA(); SubClassA s1 = new SubClassA(); t = Foo (t); t1 = Foo (t1); s1 = Foo (s1); Assert.AreEqual(1, t.retVal); Assert.AreEqual(2, s1.retVal); Assert.AreEqual(2, t1.retVal); }} using NUnit.Framework;using ExtensionMethods;public class TopClass{ public int retVal;}public class SubClassA : TopClass{ }[TestFixture]public class ThrowawayTest { private TopClass Foo (TopClass x) { x.retVal = 1; return x; } private SubClassA Foo (SubClassA x) { x.retVal = 2; return x; } [Test] public void OverloadTest(){ TopClass t = new TopClass(); TopClass t1 = new SubClassA(); SubClassA s1 = new SubClassA(); t.Foo(); s1.Foo(); t1.Foo(); Assert.AreEqual(1, t.retVal); Assert.AreEqual(2, s1.retVal); Assert.AreEqual(2, t1.retVal); }}namespace ExtensionMethods{ public static class Extensions { public static void Foo (this TopClass x) { x.retVal = 1; } public static void Foo (this SubClassA x) { x.retVal = 2; } }}",Dynamic Dispatch without Visitor Pattern
P\Invoke C++ template<T> method from C#," I have defined in C++ function for external calls: I want to use it in C# program. I've tried in this way: But, I'm getting such error:Generic method or method in generic class is internal call, PInvoke, or is defined in a COM Import class.Seems to be, that Generic in C# is managed type and it's rather different stuff by architecture with unmanaged template in C++.How can I use template method in my C# program? <code>  template<typename T>void __declspec(dllexport) SwapMe(T *fisrt, T *second){ std::cout << typeid(T).name() << std::endl; T temp = *first; *first = *second; *second = temp;} unsafe class Program{ [DllImport(""lib1.dll"", EntryPoint = ""SwapMe"")] static extern void SwapMe<T>(T first, T second); ...}",P/Invoke C++ template<T> method from C#
"C#, how to dinamcally specify type of List<> function"," I have some classes that represent database tables, to load the rows of each table on a DataGridView, I've a List<> function that inside a loop gets all rows from that table. And for other tables, some other functions: list_rows_table2, list_rows_table3...My question is: How do I create a only List<> function, where I can dynamically specify the type of List<> returned, or how to convert, for example a List<object> to List<myClass> before returning. <code>  public List<class_Table1> list_rows_table1(){ // class_Table1 contains each column of table as public property List<class_Table1> myList = new List<class_Table1>(); // sp_List_Rows: stored procedure that lists data // from Table1 with some conditions or filters Connection cnx = new Connection; Command cmd = new Command(sp_List_Rows, cnx); cnx.Open; IDataReader dr = cmd.ExecuteReader(); while (dr.Read()) { class_Table1 ct = new class_Table1(); ct.ID = Convert.ToInt32(dr[ID_table1]); ct.Name = dr[name_table1].ToString(); //... all others wanted columns follow here myList.Add(ct); } dr.Close(); cnx.Close(); // myList contains all wanted rows; from a Form fills a dataGridView return myList();}",How to dynamically specify type of List<> function?
How to dinamcally specify type of List<> function," I have some classes that represent database tables, to load the rows of each table on a DataGridView, I've a List<> function that inside a loop gets all rows from that table. And for other tables, some other functions: list_rows_table2, list_rows_table3...My question is: How do I create a only List<> function, where I can dynamically specify the type of List<> returned, or how to convert, for example a List<object> to List<myClass> before returning. <code>  public List<class_Table1> list_rows_table1(){ // class_Table1 contains each column of table as public property List<class_Table1> myList = new List<class_Table1>(); // sp_List_Rows: stored procedure that lists data // from Table1 with some conditions or filters Connection cnx = new Connection; Command cmd = new Command(sp_List_Rows, cnx); cnx.Open; IDataReader dr = cmd.ExecuteReader(); while (dr.Read()) { class_Table1 ct = new class_Table1(); ct.ID = Convert.ToInt32(dr[ID_table1]); ct.Name = dr[name_table1].ToString(); //... all others wanted columns follow here myList.Add(ct); } dr.Close(); cnx.Close(); // myList contains all wanted rows; from a Form fills a dataGridView return myList();}",How to dynamically specify type of List<> function?
How to dynamically specify type of List<> function," I have some classes that represent database tables, to load the rows of each table on a DataGridView, I've a List<> function that inside a loop gets all rows from that table. And for other tables, some other functions: list_rows_table2, list_rows_table3...My question is: How do I create a only List<> function, where I can dynamically specify the type of List<> returned, or how to convert, for example a List<object> to List<myClass> before returning. <code>  public List<class_Table1> list_rows_table1(){ // class_Table1 contains each column of table as public property List<class_Table1> myList = new List<class_Table1>(); // sp_List_Rows: stored procedure that lists data // from Table1 with some conditions or filters Connection cnx = new Connection; Command cmd = new Command(sp_List_Rows, cnx); cnx.Open; IDataReader dr = cmd.ExecuteReader(); while (dr.Read()) { class_Table1 ct = new class_Table1(); ct.ID = Convert.ToInt32(dr[ID_table1]); ct.Name = dr[name_table1].ToString(); //... all others wanted columns follow here myList.Add(ct); } dr.Close(); cnx.Close(); // myList contains all wanted rows; from a Form fills a dataGridView return myList();}",How to dynamically specify type of List<> function?
Entities Framework 6 Alpha 2 Upgrade," I recently upgraded from Entities Framework 5 to Entities Framework 6 Alpha 2 and I am getting the following error: Method not found: 'System.Data.Objects.ObjectContext System.Data.Entity.Infrastructure.IObjectContextAdapter.get_ObjectContext()'.This is getting hit when I call This used to work fine before not sure why it's springing this error. Any suggestions? <code>  if (Membership.ValidateUser(model.UserName, model.Password)) {}",EF 6 System.Data.Objects.ObjectContext Error
About Threading in C#," I wanted to try my luck in threading with C#, I know a few things about threading in C. So I just wanted to ask if i wanted to terminate a thread, I should do it with smt.Abort() or it will ""kill itself"" after the function ends? Also, is there something like pthread_exit() in C in C#? <code> ",How to terminate a thread in C#?
Set Up Unit Test different inputs, I want to test the following method in C# for all code paths. I've seen this pex unit testing where multiple inputs are tested. How can I create a unit test that accepts multiple inputs? I want to avoid creating a test method for each input. I am working with Visual Studio 2010/2012 and .Net 4.0 <code>  public int foo (int x){ if(x == 1) return 1; if(x==2) return 2; else return 0;} [TestMethod()] //some setup here?? public void fooTest() { //some assert },Set Up Test Method with different inputs
Get all keys in Dictionary Containing value x," I have this: I want to select all the items in the dictionary that contain the value abc.Is there an inbuilt function that lets me do this easily? <code>  Dictionary<integer, string> dict = new Dictionary<integer, string>();",Get all keys in Dictionary containing value x
"Error while profiling with VS: Unable to open profiler driver, would you like to upgrade credentials?"," I am running Windows 8 with UAC completely disabled which is possible to do by changing a registry setting (setting it to ""Never notify"" no longer completely disables it in Windows 8).When I try to profile C# code through Visual Studio I get the following error (clicking yes doesn't resolve the problem): Unable to open profiler driver, would you like to upgrade credentials of [username]?Running vsperfcmd /Admin:Driver,START from the command line says: Error VSP1449: Unable to start VSPerfDrv100. This driver has been blocked from loading Try using the /Admin switch of VSPerfCmd from an elevated environment.I obviously am using an elevated environment, since with UAC completely disabled I no longer have two security tokens but only the administrator security token.How can I resolve this problem? <code> ",Error while profiling with VS: Unable to open profiler driver
wpf animate background color," I need help in taking right decision. I need to animate a background color of my user control when some event happens. When it is, I want to change the background just for 1 second and then turn it back. Which way should I go? Use color animation or timer or may by some other way.Solved. Thanks to all! This works good for me: <code>  ColorAnimation animation; animation = new ColorAnimation(); animation.From = Colors.Orange; animation.To = Colors.Gray; animation.Duration = new Duration(TimeSpan.FromSeconds(1)); this.elGrid.Background.BeginAnimation(SolidColorBrush.ColorProperty, animation);",Wpf animate background color
need android in monodroid (c#) translation," Can anybody explain me this Java code in C#, since I use Mono for Android? For example I can't find OnGlobalLayoutListener in Mono for Android.On Android it looks like this: What is the Mono for Android equivalent? <code>  vto.addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() {@Overridepublic void onGlobalLayout() { int newWidth, newHeight, oldHeight, oldWidth; //the new width will fit the screen newWidth = metrics.widthPixels; //so we can scale proportionally oldHeight = iv.getDrawable().getIntrinsicHeight(); oldWidth = iv.getDrawable().getIntrinsicWidth(); newHeight = Math.floor((oldHeight * newWidth) / oldWidth); iv.setLayoutParams(new LinearLayout.LayoutParams(newWidth, newHeight)); iv.setScaleType(ImageView.ScaleType.CENTER_CROP); //so this only happens once iv.getViewTreeObserver().removeGlobalOnLayoutListener(this); }});",OnGlobalLayoutListener in Mono for Android
Using WSDL web service in Windows 8 store C# applcation: The base class or interface could not be resolved," I have written a simple WSDL web service with Java in Eclipse. Here is the Java code prototype of the service: I have generated a proxy class for this WSDL service using the Microsoft wsdl.exe tool and make it a dll by using following commands from the Developer Command Prompt Visual Studio 2012: In my Windows 8 Store application, I then added a reference to this dll, then added following code in MainPage.xaml.cs: When I tried to run the application, I got this error: The type 'System.Web.Services.Protocols.SoapHttpClientProtocol' is defined in an assembly that is not referenced. You must add a reference to assembly 'System.Web.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'. C:\Users...\MainPage.xaml.cs Line 27 Column 13I then added a reference to System.Web.Service and rebuilt the application. Now I am getting the following error: The base class or interface 'System.ComponentModel.Component' in assembly 'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' referenced by type 'System.Web.Services.Protocols.WebClientProtocol' could not be resolved c:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0\System.Web.Services.dll <code>  public static String vriteAnnouncement(String title, String body){ ...} wsdl /l:CS /protocol:SOAP WriteAnnouncement.wsdlcsc /t:library /r:System.Web.Services.dll /r:System.Xml.dll WriteAnnouncementService.cs WriteAnnouncementService was = new WriteAnnouncementService();",Using WSDL web service in Windows 8 store C# application: The base class or interface could not be resolved
"Does anyone know how to display a graph from .NET, using R?"," I'm writing a console app in C#, and I'd like to use the R engine to pop up a graph in a window.Does anyone know if this is possible from Visual Studio 2012? <code> ",Launching an R graph from within C# .NET
Launching an R graph from .NET," I'm writing a console app in C#, and I'd like to use the R engine to pop up a graph in a window.Does anyone know if this is possible from Visual Studio 2012? <code> ",Launching an R graph from within C# .NET
ActiveDirectory - Unable to find User after specifying a container for PrincipalContext," I'm attempting to find a User by username in Active Directory.This works: This does not: I receive the error message: There is no such object on the server.here's a screenshot of my ActiveDirectory setup:I've also tried using the following Container: this was equally unsuccessful. How can I specify my container while accessing the 'Users' container? I'm trying to do this as an initial, simple setup before introducing a lookup with more complicated requirements. So, I'd rather not settle for the simple solution because I am going to have to troubleshoot this anyway, I believe. <code>  const string Domain = ""SLO1.Foo.Bar.biz"";const string Username = ""sanderso"";PrincipalContext principalContext = new PrincipalContext(ContextType.Domain, Domain);UserPrincipal userPrincipal = UserPrincipal.FindByIdentity(principalContext, Username); const string Domain = ""SLO1.Foo.Bar.biz"";const string Container = ""CN=Users,DC=SLO1,DC=Foo,DC=Bar,DC=biz"";const string Username = ""sanderso"";PrincipalContext principalContext = new PrincipalContext(ContextType.Domain, Domain, Container);UserPrincipal userPrincipal = UserPrincipal.FindByIdentity(principalContext, Username); const string Container = ""OU=Users,DC=SLO1,DC=Foo,DC=Bar,DC=biz"";",Unable to find User after specifying a container for PrincipalContext
Unable to find User after specifying a container for PrincipalContext," I'm attempting to find a User by username in Active Directory.This works: This does not: I receive the error message: There is no such object on the server.here's a screenshot of my ActiveDirectory setup:I've also tried using the following Container: this was equally unsuccessful. How can I specify my container while accessing the 'Users' container? I'm trying to do this as an initial, simple setup before introducing a lookup with more complicated requirements. So, I'd rather not settle for the simple solution because I am going to have to troubleshoot this anyway, I believe. <code>  const string Domain = ""SLO1.Foo.Bar.biz"";const string Username = ""sanderso"";PrincipalContext principalContext = new PrincipalContext(ContextType.Domain, Domain);UserPrincipal userPrincipal = UserPrincipal.FindByIdentity(principalContext, Username); const string Domain = ""SLO1.Foo.Bar.biz"";const string Container = ""CN=Users,DC=SLO1,DC=Foo,DC=Bar,DC=biz"";const string Username = ""sanderso"";PrincipalContext principalContext = new PrincipalContext(ContextType.Domain, Domain, Container);UserPrincipal userPrincipal = UserPrincipal.FindByIdentity(principalContext, Username); const string Container = ""OU=Users,DC=SLO1,DC=Foo,DC=Bar,DC=biz"";",Unable to find User after specifying a container for PrincipalContext
Does LINQ to Entities keep its order," I have a List<Person> and instead want to convert them for simple processing to a List<string>, doing the following: Is the .Select() statement on a LINQ to Objects object guaranteed to not change the order of the list members? Assuming no explicit distinct/grouping/ordering is addedAlso, if an arbitrary .Where() clause is used first, is it still guaranteed to keep the relative order, or does it sometimes use non-iterative filtering?As Fermin commented above, this is essentially a duplicate question. I failed on selecting the correct keywords to search stackoverflowPreserving order with LINQ <code>  List<Person> persons = GetPersonsBySeatOrder();List<string> seatNames = persons.Select(x => x.Name).ToList();Console.WriteLine(""First in line: {0}"", seatNames[0]);",Does LINQ to Objects keep its order
DateTime in VB.NET and C#.NET," I have two questions:Date and DateTime : Are they different or same in VB ?DateTime can be assigned Nothing in VB, where as it cannot be assigned null in C#. Being a structure it cannot be null. So why is it being allowed in VB ?---VB.NET----- ---C#.NET----- <code>  Module Module1 Sub Main() Dim d As Date = Nothing Dim dt As DateTime = Nothing d = CType(MyDate, DateTime) End Sub Public ReadOnly Property MyDate As DateTime Get Return Nothing End Get End PropertyEnd Module class Program { static void Main(string[] args) { DateTime dt = null;//compile time error } }",DateTime in VB.NET and C#
How get random values from array," Possible Duplicate: Access random item in list I have an array with numbers and I want to get random elements from this array. For example: {0,1,4,6,8,2}. I want to select 6 and put this number in another array, and the new array will have the value {6,....}. I use random.next(0, array.length), but this gives a random number of the length and I need the random array numbers. <code>  for (int i = 0; i < caminohormiga.Length; i++ ){ if (caminohormiga[i] == 0) { continue; } for (int j = 0; j < caminohormiga.Length; j++) { if (caminohormiga[j] == caminohormiga[i] && i != j) { caminohormiga[j] = 0; } }}for (int i = 0; i < caminohormiga.Length; i++){ int start2 = random.Next(0, caminohormiga.Length); Console.Write(start2);}return caminohormiga;",How to get random values from array in C#
How get random values from array in C#," Possible Duplicate: Access random item in list I have an array with numbers and I want to get random elements from this array. For example: {0,1,4,6,8,2}. I want to select 6 and put this number in another array, and the new array will have the value {6,....}. I use random.next(0, array.length), but this gives a random number of the length and I need the random array numbers. <code>  for (int i = 0; i < caminohormiga.Length; i++ ){ if (caminohormiga[i] == 0) { continue; } for (int j = 0; j < caminohormiga.Length; j++) { if (caminohormiga[j] == caminohormiga[i] && i != j) { caminohormiga[j] = 0; } }}for (int i = 0; i < caminohormiga.Length; i++){ int start2 = random.Next(0, caminohormiga.Length); Console.Write(start2);}return caminohormiga;",How to get random values from array in C#
"how to ""read"" a SWIFT message?"," ""SWIFT"" meaning Society for Worldwide Interbank Financial TelecommunicationI need to read some files and insert the data in a SQL Server database table using C#.NET.The files are downloaded from a banking software (ABN Amro), and they contain (debit & credit) movements on the account.It contains a lot of :61: and :86: ""tags"", it seems almost human readable, but it's not, especially when they're talking amounts, it's impossible to filter those out if you don't have the correct specs.I'm searching like crazy but I can't find enough information, I mean a document that explains how to interprete these messages/files? Not even on swiftcommunity.net... or maybe I'm not looking on the right spot.Does that exists, and where? <code> ","How to ""read"" a SWIFT message?"
C# Asynchronous Programming and await in a loop," I started to learn Asynchronous programming in C# 5 and .Net 4.5 and there is something I don't understand. The result is: So are there different Threads accessing the same loop? is there a Race-Condition on the index variable? <code>  private static int count;public static void Main(){ LoopTest(); Console.ReadKey(false);}static async void LoopTest(){ count = 0; for (var index = 0; index < 10; ++index) { Console.WriteLine( ""({0}) In Loop before await, Index {1}, Thread: {2}"", count++, index, Thread.CurrentThread.ManagedThreadId); await Task.Factory.StartNew(() => Thread.Sleep(10)); }} (0) In Loop before await, Index 0, Thread: 9 (1) In Loop before await, Index 1, Thread: 10 (2) In Loop before await, Index 2, Thread: 11 (3) In Loop before await, Index 3, Thread: 10 (4) In Loop before await, Index 4, Thread: 11 (5) In Loop before await, Index 5, Thread: 10 (6) In Loop before await, Index 6, Thread: 12 (7) In Loop before await, Index 7, Thread: 11 (8) In Loop before await, Index 8, Thread: 10 (9) In Loop before await, Index 9, Thread: 12",Asynchronous Programming and await in a loop
Custom Configuration Section in C#," How would I need to write my custom ConfigurationSection so that it is both a section handler and a configuration element collection?Normally, you have one class that inherits from ConfigurationSection, which then has a property that is of a type that inherits from ConfigurationElementCollection, which then returns elements of a collection of a type that inherits from ConfigurationElement. To configure that, you would then need XML that looks something like this: I want to cut out the <collection> node, and just have: <code>  <customSection> <collection> <element name=""A"" /> <element name=""B"" /> <element name=""C"" /> </collection></customSection> <customSection> <element name=""A"" /> <element name=""B"" /> <element name=""C"" /><customSection>",How do I make my custom config section behave like a collection?
Custom ConfigurationSection in C#," How would I need to write my custom ConfigurationSection so that it is both a section handler and a configuration element collection?Normally, you have one class that inherits from ConfigurationSection, which then has a property that is of a type that inherits from ConfigurationElementCollection, which then returns elements of a collection of a type that inherits from ConfigurationElement. To configure that, you would then need XML that looks something like this: I want to cut out the <collection> node, and just have: <code>  <customSection> <collection> <element name=""A"" /> <element name=""B"" /> <element name=""C"" /> </collection></customSection> <customSection> <element name=""A"" /> <element name=""B"" /> <element name=""C"" /><customSection>",How do I make my custom config section behave like a collection?
Difference between yield and List.AsEnumarable," Yield is something I find tough to understand till now. But now I am getting a hold of it. Now, in a project, if I return List, Microsoft code analysis will give a warning about it. So, normally I'll do all the necessary logical parts and return the list as IEnumerable. I want to know the difference between the two. Means if I am doing yield return or otherwise. Here is a very simple example I am showing, normally the code is a little bit complicated. One significant benefit I can see is fewer lines. But is there any other benefit? Should I change and update my functions which are returning IEnumearble to use yield instead of List? What is the best way or a better way to do things?Here, I can use simple lambda expressions over List, but normally that is not the case, this example is specifically to understand best approach of coding. <code>  private static IEnumerable<int> getIntFromList(List<int> inputList){ var outputlist = new List<int>(); foreach (var i in inputList) { if (i %2 ==0) { outputlist.Add(i); } } return outputlist.AsEnumerable();}private static IEnumerable<int> getIntFromYeild(List<int> inputList){ foreach (var i in inputList) { if (i%2 == 0) { yield return i; } }}",Difference between yield and List.AsEnumerable
Protobuf-net object reference deserialization: A reference-tracked object changed reference during deserialization," I'm having some issues trying to serialize/deserialize a complex object graph using protobuf-net.I'm working on a legacy application and we're using .Net Remoting to connect a GUI client to a C# service. We are seeing poor performance with overseas users due to the serialized size of our object graphs using the default BinaryFormatter, which is exacerbated by the limited bandwidth in-between the client and server (1Mbit/s).As a quick win, I thought I'd put together a proof of concept to see if there were any performance gains to be had by using protobuf-net instead, by implementing ISerializable. As I was testing I ran into an issue whereby object references weren't being maintained.I've put together an example which repros the issue. I'm expecting that the object in the Dictionary (Items[1]) and the object B.A will be the same as I've specified AsReference=true in the ProtoMember attribute.Using protobuf-net 2.0.0.619, I'm seeing an exception thrown when deserializing (A reference-tracked object changed reference during deserialization).If this isn't a supported scenario the please let me know.Test Class definitions <code>  [Test]public void AreObjectReferencesSameAfterDeserialization(){ A a = new A(); B b = new B(); b.A = a; b.Items.Add(1, a); Assert.AreSame(a, b.A); Assert.AreSame(b.A, b.Items[1]); B deserializedB; using (var stream = new MemoryStream()) { Serializer.Serialize(stream, b); stream.Seek(0, SeekOrigin.Begin); deserializedB = Serializer.Deserialize<B>(stream); } Assert.AreSame(deserializedB.A, deserializedB.Items[1]);} [Serializable][ProtoContract]public class A{}[Serializable][ProtoContract]public class B{ [ProtoMember(1, AsReference = true)] public A A { get; set; } [ProtoMember(2, AsReference = true)] public Dictionary<int, A> Items { get; set; } public B() { Items = new Dictionary<int, A>(); }}",Protobuf-net object reference deserialization using Dictionary: A reference-tracked object changed reference during deserialization
"Entity Framework returning old data (UnitOfWork, Unity, MVVM)"," I have a problem with EF not returning the newest data in a 3 layered WPF application, and I suspect it has something to do with how I handle the lifetime of my context. This is the scenario:There are several repositories wrapped inside a UnitOfWork. There is also one service (MyService), which uses the UnitOfWork. This UnitOfWork must also be called from the UI directly, without passing through a service.In the ViewModel of my main window at some point I create a new window (using ViewModel first): This main window ViewModel has a UnitOfWork, which has been injected in the constructor, and that is passed to the DialogViewModel.CarService's constructor also needs a UnitOfWork, which is also injected in its constructor: When CarService is used in DialogViewModel to make a query to retrieve some data and make some updates, it works fine the first time. However, when the same query is made the next time to retrieve that data, instead of returning the newest modified one it returns the old/cached one. The query using UnitOfWork (inside CarService) looks like this: The second time this is called, values doesn't contain the newest version of the data; however it has been updated successfully in the DB.I'm doing DI using Unity, and this is how my container looks like: Why isn't the right data being returned, and how can I fix it? <code>  var dialog = new DialogViewModel(_eventAggregator, _unitOfWork, Container.Resolve<CarService>()); public CarService(IUnitOfWork unitOfWork){ _unitOfWork = unitOfWork;} var values = _unitOfWork.GarageRepository.GetSomeValues();_unitOfWork.GarageRepository.MakeSomeChangesToTheValuesUsingStoredProcedure(); public class Container{ public static UnityContainer Container = new UnityContainer(); // Called once in the AppBoostraper, as soon as the GUI application starts public void BuildUp() { Container.RegisterType<IUnitOfWork, UnitOfWork>(); Container.RegisterType<ICarService, CarService>(); }}",Entity Framework returning old data
"sqlite, how to have an automatic timestamp?"," I have an SQLite database, version 3 and I am using C# to create an application that uses this database.I want to use a timestamp field in a table for concurrency, but I notice that when I insert a new record, this field is not set, and is null.For example, in MS SQL Server if I use a timestamp field this is updated by the database, I have not to set by myself. is this possible in SQLite? <code> ",How to have an automatic timestamp in SQLite?
"does .net provide an easy way convert bytes to KB, MB, GB, etc?"," Just wondering if .NET provides a clean way to do this: etc... <code>  int64 x = 1000000;string y = null;if (x / 1024 == 0) { y = x + "" bytes"";}else if (x / (1024 * 1024) == 0) { y = string.Format(""{0:n1} KB"", x / 1024f);}","Does .NET provide an easy way convert bytes to KB, MB, GB, etc.?"
"xna which is better for performance, remove and re-add component or dont draw"," I'm making a 2d game in XNA.When using drawable game components which one is better for performance?1.When a component is not onscreen remove it from the components list and when its onscreen add it.2.When its offscreen dont run its draw function (by using an ""awake"" bool field and anif statement around everything in the draw function)I'm using method 2 at the moment and it works fine. Its handy cus the draworder of components wont change (if I remove and re-add them it will, and I'll need more code to manage that)In fact it just occured to me that if its not in the components list it wont update and I'll need something else to keep track of whether its onscreen or not..Also I dont have the fancy version of visual studio with the profiler so I'm just asking here what do people think from their experience <code> ",How to prevent drawing XNA component when it is off-screen?
XDocument get XML elemennt by name," I have an XML result like this I want to get a list of objects, and every object will contain the value of ContaFirstname, ContaId, ContaJobTitle and ContaSurnameI tried something like this, but that's not right because I get them all NULL So how can access these elements by name? <code>  <response> <lst name=""responseHeader""> <int name=""status"">0</int> <int name=""QTime"">16</int> </lst> <result name=""response"" numFound=""3"" start=""0"" maxScore=""1.0""> <doc> <str name=""ContaFirstname""> firstname1 </str> <str name=""ContaId"">6557</str> <str name=""ContaJobTitle"">Manager</str> <str name=""ContaSurname"">surname1 </str> </doc> <doc> <str name=""ContaFirstname"">firstname2</str> <str name=""ContaId"">6203</str> <str name=""ContaJobTitle"">Director</str> <str name=""ContaSurname"">surname2</str> </doc> </result></response> var test = from c in xml.Descendants(""doc"") select new { firstname = c.Element(""ContaFirstname""), surnmane = c.Element(""ContaSurname"") }; ",XDocument get XML element by the value of its name attribute
XDocument get XML element by name," I have an XML result like this I want to get a list of objects, and every object will contain the value of ContaFirstname, ContaId, ContaJobTitle and ContaSurnameI tried something like this, but that's not right because I get them all NULL So how can access these elements by name? <code>  <response> <lst name=""responseHeader""> <int name=""status"">0</int> <int name=""QTime"">16</int> </lst> <result name=""response"" numFound=""3"" start=""0"" maxScore=""1.0""> <doc> <str name=""ContaFirstname""> firstname1 </str> <str name=""ContaId"">6557</str> <str name=""ContaJobTitle"">Manager</str> <str name=""ContaSurname"">surname1 </str> </doc> <doc> <str name=""ContaFirstname"">firstname2</str> <str name=""ContaId"">6203</str> <str name=""ContaJobTitle"">Director</str> <str name=""ContaSurname"">surname2</str> </doc> </result></response> var test = from c in xml.Descendants(""doc"") select new { firstname = c.Element(""ContaFirstname""), surnmane = c.Element(""ContaSurname"") }; ",XDocument get XML element by the value of its name attribute
C# Interface Inheritance query," Suppose if I have an Interface as defined below: and I implement this interface for an abstract class as shown below: again I have a concrete class which Inherits from abstract class as below: Now I have the following code, The output which I am getting after execution of this stuff is as following. But what I have been expecting the output to be ""Concrete Stuff"" in all the three cases as what I am doing here is assigning the reference of ConcreteFunctionality to the variables of type AbstractFunctionality and IFunctionality.What is happening internally. Kindly clarify. <code>  public interface IFunctionality{ void Method(); } public abstract class AbstractFunctionality: IFunctionality{ public void Method() { Console.WriteLine(""Abstract stuff"" + ""\n""); } } public class ConcreteFunctionality: AbstractFunctionality{ public void Method() { Console.WriteLine(""Concrete stuff"" + ""\n""); }} ConcreteFunctionality mostDerived = new ConcreteFunctionality();AbstractFunctionality baseInst = mostDerived;IFunctionality interfaceInst = mostDerived;mostDerived.Method();baseInst.Method();interfaceInst.Method(); Concrete stuffAbstract stuffAbstract stuff",C# Interface Inheritance to Abstract class
C# MSSQL DateTime Accept NULL," I've tried to make my code as compact as possible.Using Microsoft SQL Server, .NET 2.0I have a date field in my database which accepts null values I grab the value of the the textbox and convert it to datetime. The problem I'm having is if the form is submitted and the textbox is empty. I get this error back: String was not recognized as a valid DateTime.How do I set my code up so that if the textbox is empty, the row is created in the database with NULL?I've tried initializing my variable to NULL but get an error in Visual Studio Cannot convert null to 'System.DateTime' because it is a non-nullable value type.Here's the Data Access Layer if that helps Thank you <code>  LeaseExpiry(datetime, null) DateTime leaseExpiry = Convert.ToDateTime(tbLeaseExpiry.Text);INSERT_record(leaseExpiry); DateTime leaseExpiry = null; public string INSERT_record(DateTime leaseExpiry){ //Connect to the database and insert a new record string cnn = ConfigurationManager.ConnectionStrings[connname].ConnectionString; using (SqlConnection connection = new SqlConnection(cnn)) { string SQL = string.Empty; SQL = ""INSERT INTO ["" + dbname + ""].[dbo].["" + tblAllProperties + ""] ([LeaseExpiry]) VALUES (@leaseExpiry); using (SqlCommand command = new SqlCommand(SQL, connection)) { command.Parameters.Add(""@leaseExpiry"", SqlDbType.DateTime); command.Parameters[""@leaseExpiry""].Value = leaseExpiry; } try { connection.Open(); command.ExecuteNonQuery(); return ""Success""; } catch (Exception ex) { return ex.Message; } }}",SQL Server DateTime Accept NULL
how to get Attribute Value using linq to xml?," Using the code above, I can get the result below:But I need the column WorkPhone's value 424-555-0545 instead of Home and the column HomePhone's value 423-555-0124 instead of Home. What should I do for that? <code>  <Employees> <Employee> <EmpId>1</EmpId> <Name>Sam</Name> <Sex>Male</Sex> <Phone Type=""Home"">423-555-0124</Phone> <Phone Type=""Work"">424-555-0545</Phone> </Employee></Employees> private void Window_Loaded(object sender, RoutedEventArgs e){ emplyeeDetails = XDocument.Load(Directory.GetParent(Directory.GetCurrentDirectory()).Parent.FullName + ""\\LinqToXml\\Xmls\\"" + ""Employees.xml""); var emplyees = from emp in emplyeeDetails.Descendants(""Employee"").Take(10) orderby emp.Element(""EmpId"").Value ascending select new { Id = emp.Element(""EmpId"").Value, Name = emp.Element(""Name"").Value, Sex = emp.Element(""Sex"").Value, WorkPhone=emp.Element(""Phone"").Attribute(""Type"").Value, HomePhone = emp.Element(""Phone"").Attribute(""Type"").Value, }; DgrdEmployeeDetails.ItemsSource = emplyees.ToList();}",How to get attribute value using LINQ to XML?
C# Get derived type from static method," I want to get derived type from static method. I want to do something like this but in static methodI know that returns base type, but i need derived. <code>  void foo(){ this.getType();} MethodBase.GetCurrentMethod().DeclaringType",Get derived type from static method
How can I set the size of the calendar under a DateTimePicker?," I'm trying to create a DateTimePicker with week numbers displayed, as shown here (Code project example). It works fairly well, except for one minor detail; The calender popping up when trying to select a date is not the right size. As you can see, the calendar area is sort of ""cramped"", especially along the right edge. I can click the bottom right corner here, and drag it out a little - just enough to expand it so that it looks right:I can't seem to find any way to force the calendar to be the correct/full size from the beginning, or to resize it. <code> ",Setting calendar size when overriding DateTimePicker to add week numbers
Web API not returning XML," I have a controller and method that adds user to a DB. I call it from Fiddler with a Request Header as follows - Content-Type: application/xml Accept: application/xml Host: localhost:62236 Content-Length: 39And a request body of - This works as expected, the method is called, the user object processed in the method PostUser. I am performing my Model Validation in it's own class BUT if I post the following The Model is invalid, and a JSON response is returned even though I stated Accept: application/xml.If I perform model validation within the UserController, I get a proper XML response, but when I perform it in ModelValidationFilterAttribute I get JSON.  <code>  <User> <Firstname>John</Firstname> <Lastname>Doe</Lastname></User> public class UserController : ApiController { public HttpResponseMessage PostUser(User user) { // Add user to DB var response = new HttpResponseMessage(HttpStatusCode.Created); var relativePath = ""/api/user/"" + user.UserID; response.Headers.Location = new Uri(Request.RequestUri, relativePath); return response; } } public class ModelValidationFilterAttribute : ActionFilterAttribute{ public override void OnActionExecuting(HttpActionContext actionContext) { if (actionContext.ModelState.IsValid == false) { // Return the validation errors in the response body. var errors = new Dictionary<string, IEnumerable<string>>(); foreach (KeyValuePair<string, ModelState> keyValue in actionContext.ModelState) { errors[keyValue.Key] = keyValue.Value.Errors.Select(e => e.ErrorMessage); } actionContext.Response = actionContext.Request.CreateResponse(HttpStatusCode.BadRequest, errors); } }} <User> <Firstname></Firstname> **//MISSING FIRST NAME** <Lastname>Doe</Lastname></User>",ASP.NET Web API not returning XML
Converting Code To VB.Net For HideMyAss Proxy Grabber," Here is my code in C#: Now here is what codes out after I converted it using this: I am getting an error saying: What should InlineAssingHelper be? <code>  ListBox l = new ListBox(); foreach (string[] s in Regex.Matches(new WebClient().DownloadString(""http://www.hidemyass.com/proxy-list/search-229092""), @""(?:<td class=""""leftborder timestamp""""(?s).+?<style>)((?s).+?)\s*<td>\s+(\d{2,5})</td>"").Cast<Match>().Select(m => new string[] { m.Groups[1].Value, m.Groups[2].Value })) { Regex.Matches(s[0], @""\.([^\{]+)\{([^\}]+)\}"").Cast<Match>().ToList().ForEach(m => s[0] = s[0].Replace(string.Format(@""class=""""{0}"""""", m.Groups[1].Value), string.Format(@""style=""""{0}"""""", m.Groups[2].Value))); Dim l As New ListBox() For Each s As String() In Regex.Matches(New WebClient().DownloadString(""http://www.hidemyass.com/proxy-list/search-229092""), ""(?:<td class=""""leftborder timestamp""""(?s).+?<style>)((?s).+?)\s*<td>\s+(\d{2,5})</td>"").Cast(Of Match)().[Select](Function(m) New String() {m.Groups(1).Value, m.Groups(2).Value}) Regex.Matches(s(0), ""\.([^\{]+)\{([^\}]+)\}"").Cast(Of Match)().ToList().ForEach(Function(m) InlineAssignHelper(s(0), s(0).Replace(String.Format(""class=""""{0}"""""", m.Groups(1).Value), String.Format(""style=""""{0}"""""", m.Groups(2).Value)))) l.Items.Add(String.Concat(Regex.Matches(Regex.Replace(Regex.Replace(s(0), ""<(span|div) style=""""display:none"""">[\d\.]+</\1>"", String.Empty).Remove(0, s(0).IndexOf(""/style>"")), ""class=""""\d+"""""", String.Empty), ""[\d\.]+"").Cast(Of Match)().[Select](Function(m) m.Value)) & "":"" & s(1)) Next Error 1 'InlineAssignHelper' is not declared. It may be inaccessible due to its protection level.",'InlineAssignHelper' is not declared When Converting C# To VB.Net
Can I make my Thread pool create its treads as foreground?," By default the thread pool in .NET works with background threads.I can't change it to run as foreground.How do I change this to run as foreground threads?Edit:I need to use this because I'm changing my App due high volume processing (before it I was manually handling threads, which are Foreground ones by default), and I don't want to change my Application just to adapt it to a background threading scenario..I'm wondering why Thread pool is not Foreground by default <code> ",Can I make my Thread pool create its threads as foreground?
Can I make my Thread pool create its theads as foreground?," By default the thread pool in .NET works with background threads.I can't change it to run as foreground.How do I change this to run as foreground threads?Edit:I need to use this because I'm changing my App due high volume processing (before it I was manually handling threads, which are Foreground ones by default), and I don't want to change my Application just to adapt it to a background threading scenario..I'm wondering why Thread pool is not Foreground by default <code> ",Can I make my Thread pool create its threads as foreground?
How do I return a byte arrray from C++ to C#," So I've been struggling with this for a little bit. I'm trying to make my own AES 128 library to use with one of my programs. The library tests out and works in C++ (well for the encrypt function.. I haven't implemented the others) The 'Encrypt' function is like this:NEW CODE The idea is that if the plainText is not in a 16-byte block increment then I force it to be. So this makes for a variable size byte array. It works in my C++ tests, but when I call it in C# I get a few different errors... This will take a minute to describe. When I call this I get valid pointers to both the array, and the outlength. The way it looks right now causes an access violation, but I can get that structure to work if I change [Out]int OutLength to ref IntPtr. Interestingly, if I do ref int or ref uint it still ""works"". So if I do that I try to read the intptr and then I get an access violation. I am compiling this as a x86 project in .NET 4.0 (since I read somewhere that 3.5 had some bugs with access...)Here is what I've tried in C#. It's a little garbled as I've been playing with it for hours (sorry): The only time this worked is when I just made a static-size array and didn't use ref or marshal copy or anything.. I think my signature was something like this That almost worked, but the problem was that when I did a foreach loop on that array it was always the size that i put.. frustrating to say the least.So what am I doing wrong? how can I get this to work? I am so frustrated with it. Thank youOh and FYI, this is so I cannot be dependent on the cryptlib anymore. I'm trying to recompile a different project, which uses cryptlib, as a static library and not shared, which causes some problems with my compiled options and is too big of a hassle to change back.EDITED to show more codeThis is the tests that I use. I found a webpage that showed a bunch of tests, so this is me implementing this. <code>  void Aes128Class::EncryptBlock(BYTE* outBlock, const BYTE* inBlock, const BYTE* cipherBlock){ BYTE temp[16] = {0x00}; Galois::XorBlock(temp, inBlock); Galois::XorBlock(temp, cipherBlock); BYTE expandedKey[176] = {0x00}; memcpy(expandedKey, Key, 16); Galois::expand_key(expandedKey); Galois::XorBlock(temp, expandedKey); for(int i=16; i<160; i+=16) { Galois::DoRound(temp, &expandedKey[i]); } Galois::SubBytes(temp); Galois::ShiftRows(temp); Galois::XorBlock(temp, &expandedKey[160]); memcpy(outBlock, temp, 16);}void Aes128Class::EncryptData(BYTE* outBlock, size_t& outlen, const BYTE* inBlock, size_t length){ float blockSize = (float)(length/16); blockSize = ceilf(blockSize); int newLength = (int)(blockSize*16); BYTE* temp = (BYTE*)malloc(newLength); BYTE* padd = (BYTE*)malloc(newLength); memset(temp, 0, newLength); memcpy(padd, inBlock, length); EncryptBlock(temp, padd, IV); for (int i=1; i<blockSize; i++) { EncryptBlock(&temp[i*16], &padd[i*16], &temp[(i-1)*16]); } outlen = newLength; memcpy(outBlock, temp, newLength);} [DllImport(""CppAes128.dll"", CallingConvention = CallingConvention.ThisCall, EntryPoint = ""?EncryptData@Aes128Class@@QAEXPAEAAIPBEI@Z"")] static extern void EncryptData(IntPtr pClass, ref IntPtr outblock, [Out]int OutLength, byte[] inBlock, int length); public byte[] EncryptData(byte[] plainText, int length) { byte[] enc = null; int len = 0; IntPtr pArray = IntPtr.Zero; EncryptData(theClass, ref pArray, len, plainText, length); Console.WriteLine(len); //enc = new byte[len]; //Marshal.Copy(pArray, enc, 0, len); //Marshal.Release(pArray); //try //{ // int elementSize = Marshal.SizeOf(typeof(IntPtr)); // //IntPtr unmanagedArray = Marshal.AllocHGlobal(10 * elementSize); // Console.WriteLine(""Reading unmanaged memory:""); // // Print the 10 elements of the C-style unmanagedArray // for (int i = 0; i < 10; i++) // { // Console.WriteLine(""{0:X2}:"", Marshal.ReadByte(pArray, i)); // } // Marshal.FreeHGlobal(pArray); //} //catch (Exception ex) //{ // Console.WriteLine(""{0}\n{1}"", ex.Source, ex.Message); // Console.WriteLine(""Win32({0})"", Marshal.GetLastWin32Error()); //} //Marshal.Release(pArray); return enc; } static extern void EncryptData(IntPtr pClass, byte[] outBlock, byte[] inBlock, int length); void VerifyEncrypt16(const BYTE* expected, const BYTE* key, const BYTE* iv, const BYTE* plainText){ BYTE actual[16] = {0x00}; Aes128Class aes; aes.SetKey(key, 16); aes.SetIV(iv, 16); size_t len = 0; aes.EncryptData(actual, len, plainText, 16); _ASSERT(CompareTwoArrays(expected, actual));}void VerifyEncrypt16String(const char* expected, const char* key, const char* iv, const char* plainText){ BYTE e[16]; BYTE k[16]; BYTE i[16]; BYTE p[16]; ByteUtil::StringToHex(expected, e); ByteUtil::StringToHex(key, k); ByteUtil::StringToHex(iv, i); ByteUtil::StringToHex(plainText, p); VerifyEncrypt16(e, k, i, p);}void CheckEncrypt16(void){ _RPT0(_CRT_WARN, ""Checking Encryption of a 16 byte number IV set to 0\n""); //AESVS GFSbox test data for CBC VerifyEncrypt16String(""0336763e966d92595a567cc9ce537f5e"",""00000000000000000000000000000000"",""00000000000000000000000000000000"",""f34481ec3cc627bacd5dc3fb08f273e6""); VerifyEncrypt16String(""a9a1631bf4996954ebc093957b234589"",""00000000000000000000000000000000"",""00000000000000000000000000000000"",""9798c4640bad75c7c3227db910174e72""); VerifyEncrypt16String(""ff4f8391a6a40ca5b25d23bedd44a597"",""00000000000000000000000000000000"",""00000000000000000000000000000000"",""96ab5c2ff612d9dfaae8c31f30c42168""); VerifyEncrypt16String(""dc43be40be0e53712f7e2bf5ca707209"",""00000000000000000000000000000000"",""00000000000000000000000000000000"",""6a118a874519e64e9963798a503f1d35""); VerifyEncrypt16String(""92beedab1895a94faa69b632e5cc47ce"",""00000000000000000000000000000000"",""00000000000000000000000000000000"",""cb9fceec81286ca3e989bd979b0cb284""); VerifyEncrypt16String(""459264f4798f6a78bacb89c15ed3d601"",""00000000000000000000000000000000"",""00000000000000000000000000000000"",""b26aeb1874e47ca8358ff22378f09144""); VerifyEncrypt16String(""08a4e2efec8a8e3312ca7460b9040bbf"",""00000000000000000000000000000000"",""00000000000000000000000000000000"",""58c8e00b2631686d54eab84b91f0aca1""); //AESVS KeySbox test data for CBC VerifyEncrypt16String(""6d251e6944b051e04eaa6fb4dbf78465"",""10a58869d74be5a374cf867cfb473859"",""00000000000000000000000000000000"",""00000000000000000000000000000000""); //A TON OF MORE TESTS! etc etc etc VerifyEncrypt16String(""5c005e72c1418c44f569f2ea33ba54f3"",""00000000000000000000000000000000"",""00000000000000000000000000000000"",""fffffffffffffffffffffffffffffffe""); VerifyEncrypt16String(""3f5b8cc9ea855a0afa7347d23e8d664e"",""00000000000000000000000000000000"",""00000000000000000000000000000000"",""ffffffffffffffffffffffffffffffff"");}",How do I return a byte array from C++ to C#
c# treeview ignore double click only at checkbox," I have a treeview with checkbox, I'm trying to disable the double click only when this is done in the checkbox.I found a way to totally disable the double click but it was not what I wanted.I appreciate if you can help me. <code> ",TreeView ignore double click only at checkbox
"c# Split a string that has white spaces, unless they are enclosed within ""quotes""?"," To make things simple: I want to be able to save them as two different strings, remove all spaces EXCEPT for the spaces found between quotation marks. Therefore, what I need is: So far what I have found that works is the following code, but it removes the spaces within the quotes. The output of this becomes I have looked into Regular Expression to split on spaces unless in quotes however I can't seem to get regex to work/understand the code, especially how to split them so they are two different strings. All the codes there give me a compiling error (I am using System.Text.RegularExpressions) <code>  string streamR = sr.ReadLine(); // sr.Readline results in: // one ""two two"" string 1 = onestring 2 = two two //streamR.ReadLine only has two strings string[] splitter = streamR.Split(' '); str1 = splitter[0]; // Only set str2 if the length is >1 str2 = splitter.Length > 1 ? splitter[1] : string.Empty; onetwo","Split a string that has white spaces, unless they are enclosed within ""quotes""?"
C# HttpClient not storing cookies in CookieContainer," I'm using VS2010 +.NET 4.0 + System.Net.Http (from Nuget).For a reason which I don't manage to understand, the session cookie which I receive in my HttpResponseMessage is not automatically saved in the HttpClient CookieContainer. Here is what my code looks like: I can see in the response headers that I have the following: However my cookie container remains empty ...why ? <code>  CookieContainer cookies = new CookieContainer();HttpClientHandler handler = new HttpClientHandler();handler.CookieContainer = cookies;HttpClient client = new HttpClient(handler);Uri site = new Uri(""https://www.mywebsite.com"");var response1 = client.SendAsync(new HttpRequestMessage(HttpMethod.Get,site)).Result; Set-Cookie: JSESSIONID=FC8110E434C2C6DAB78B4E335024A639; Path=/member; Secure",HttpClient not storing cookies in CookieContainer
C sharp class without main method," I'm learning C# and I'm very new to it, so forgive me for the seemingly stupid question. I have some experience in Java, and I noticed that C# programs also need a main() method in their main class. What if I want to create a class that isn't a main class, i.e. one that I import into a main class? I tried to do that, and when I compile (via cmd using csc File.cs) the compiler says that the .exe that it will make has no main() method. Does that mean that I was wrong, and every class needs a main() method, or that I'm compiling it wrongly? Maybe the problem's in the code (since I'm relying on my knowledge of Java syntax), which looks like this: EDIT: I'm afraid this is terribly misunderstood. I'm not asking if the file needs a main method, I'm asking how I can import this class into another class, because I realise that if I am to do this I can't have a main (as I said, I have some Java experience), but whenever I try to compile without one the compiler tells me that I need one. <code>  public class Class{ int stuff; public Class(int stuff) { this.stuff = stuff; stuff(); } public void method() { stuff(); }}",C# class without main method
Create list of enums in C# and pass it to a method," I created a method which takes an enum and transforms it in a Dictionary where each int is associated with the name (as string) of the enum (ps. yes, I have a double cast but the application is meant to be a very cheap-and-dirty C#-enum to Javascript-enum converter).This can be easily used like this Now, I was wondering whether I could create a list of enums to use for a series of calls to iterate my calls.This was in the original question: [Why can't I call this?]What should I do to be able to create a call like this one? <code>  // Define like thispublic static Dictionary<int, string> getDictionaryFromEnum<T>(){ List<T> commandList = Enum.GetValues(typeof(T)).Cast<T>().ToList(); Dictionary<int, string> finalList = new Dictionary<int, string>(); foreach (T command in commandList) { finalList.Add((int)(object)command, command.ToString()); } return finalList; } private enum _myEnum1 { one = 1001, two = 1002 };private enum _myEnum2 { one = 2001, two = 2002 };// ... var a = getDictionaryFromEnum<_myEnum1>();var b = getDictionaryFromEnum<_myEnum2>(); List<Type> enumsToConvertList = new List<Type>();enumsToConvertList.Add(typeof(_myEnum1));enumsToConvertList.Add(typeof(_myEnum2));// this'll be a loopvar a = getDictionaryFromEnum<enumsToConvertList.ElementAt(0)>();",Create list of enums and pass it to a method
Dynamics CRM 2011 - Stop a Plugin without Notifying User," Problem: We use the CRM for Outlook plugin to automatically log our support emails, but internal emails between employees (some of which contain sensitive information) are also being logged. Ideal Solution: I am attempting to write a pre-event (the ""create email"" message) plugin to block the automatic logging of internal emails, but (apparently) the only way to stop a message from being executed is to throw an exception in the pre-event phase, but this always results in an error message being shown in outlook (which we obviously can't have). According to the documentation, only the ""InvalidPluginExecutionExeception"" is supposed to show messages to the user, but this is not the case as all exceptions result in an error message in the user's Outlook application.Potential Solution: There is also a ""CheckPromoteEmail"" message that (according to the documentation) determines whether or not an email should be promoted to the CRM (I assume ""promoted to CRM"" means ""make an email entity to store in CRM""), but I couldn't find anything in the context that would let me tell CRM to not promote the email. Is there some flag buried in the context that I can set, or some way to invlaidate the email so the CRM's own logic decides to not store it?Workaround Solution: The only other solution that I am aware of (mentioned here) to just clear the subject and contents of the email after it has been created, but I would rather stop the email from being created in the first place than editing or deleting it after time and resources have been wasted creating the email.Is there a clean way to stop an operation from a plugin? Or from anywhere? If there isn't, does anyone know why Microsoft didn't provide this feature? They already have ironclad rollback functionality under the hood in case an operation fails, why don't they just give me a way to call the rollback?Here's my code in case it's helpful in answering my question:  <code>  public class InternalEmailFilter : IPlugin{ void IPlugin.Execute(IServiceProvider serviceProvider) { IPluginExecutionContext _context = (IPluginExecutionContext)serviceProvider.GetService(typeof(IPluginExecutionContext)); Entity e = (Entity)_context.InputParameters[""Target""]; bool shouldStore = ShouldStoreInCRM(e); if (shouldStore == false) { throw new Exception(); //attempting to stop the operation without an InvalidPluginExecutionException, but still results in error message to user } } protected bool ShouldStoreInCRM(Entity e) { List<Entity> parties = new List<Entity>(); var atttributes = e.Attributes; if (atttributes.ContainsKey(""to"") == true) parties.AddRange((atttributes[""to""] as EntityCollection).Entities); if (atttributes.ContainsKey(""from"") == true) parties.AddRange((atttributes[""from""] as EntityCollection).Entities); if (atttributes.ContainsKey(""cc"") == true) parties.AddRange((atttributes[""cc""] as EntityCollection).Entities); if (atttributes.ContainsKey(""bcc"") == true) parties.AddRange((atttributes[""bcc""] as EntityCollection).Entities); foreach (Entity p in parties) { if (p.LogicalName == ""activityparty"" && p.Attributes.ContainsKey(""addressused"") == true && p.Attributes[""addressused""] != null) { if (p.Attributes[""addressused""].ToString().ToLower().Contains(""@ourdomain.com"") == false) { return true; //someone connected in the email is not an employee, store the email } } } return false; //everyone was an employee, do not store }}",Dynamics CRM 2011 - Block Creation of Entity via Plugin
Server accepting winform client and cmd client c#," I have a weird question.I have written a winform server application and a winform client application.The role of the client is to send commands for running a certain script to the server.The server receives those commands, parses them, and runs them.These two work great.I have written a cmd application which uses some of the functions from my client. This application is supposed to function as a cmd client.The question is this: When I run the winform client, the server runs the commands with no problems at all.When I run the cmd client, when the server attempts to execute the received command, Windows on the server side pops up the security question of whether the script can be run or not (see attached image).Why does it happen on the cmd and not on the winforms.Here is my code: Any ideas? <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using Microsoft.Win32;using System.Net.Sockets;using System.ComponentModel;using System.IO;using System.Management;namespace RemoteBatcher{ class ClientCmdProgram { private static RegistryKey registryKey; private static Socket clientSock; private static string remoteIpAddress = ""192.168.0.1""; private static int remotePort = 8; private static string userName = """"; private static string targetPath = ""Z:\\nBatcher\\""; private static List<string> listOfCommands = new List<string>(); static void Main(string[] args) { var backgroundWorker = new BackgroundWorker(); userName = RemoteUtils.getConnectedUser(); registryKey = Registry.CurrentUser.OpenSubKey(""Key""); if (registryKey == null) { Console.WriteLine(""Error! No Saved Data Was Found In The Registry. Please Run The RemoteBatcherClient App First.""); Environment.Exit(1); } if (!connectToServer(backgroundWorker)) Environment.Exit(1); getCommandsList(); sendCommands(backgroundWorker); } private static bool connectToServer(BackgroundWorker backgroundWorker) { try { clientSock = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp); clientSock.Connect(remoteIpAddress, remotePort); backgroundWorker.DoWork += (sender1, e1) => RemoteUtils.copyDllsToServer(targetPath += userName); backgroundWorker.RunWorkerAsync(); } catch (Exception ex) { Console.Write(ex.Message); return false; } return true; } private static void getCommandsList() { string[] commandsInRegistry = registryKey.GetValueNames(); for (int i = 0; i < commandsInRegistry.Length; i++) { listOfCommands.Add(registryKey.GetValue(commandsInRegistry[i]).ToString()); } } private static void sendCommands(BackgroundWorker backgroundWorker) { int flicker = 100; int counter = 100; try { while (backgroundWorker.IsBusy) { if (counter == flicker) { counter = 1; Console.WriteLine(""Copying Executable Files, Please Wait..""); } else if (counter == 50) { Console.Clear(); } else counter++; } for (int i = 0; i < listOfCommands.Count; i++) { clientSock.Send(Encoding.Default.GetBytes(listOfCommands[i] + "" <eom> "")); } clientSock.Close(); clientSock.Dispose(); } catch (Exception ex) { Console.Write(ex.Message); Environment.Exit(1); } } }}",How to disable Open file  Security warning
"Using HttpClient, how would I prevent automatic redirects and get original status code and forwading Url in the case of 301 - C#"," I have the following method that returns the Http status code of a given Url: It works well for 200/404 etc, however in the case of 301 codes I believe the returned result is the already-redirected (200) result, rather than the actual 301 that should be returned and which would have a header containing where the redirect would be pointed to.I have seen something like this in other .Net web requests classes and the technique there was to set some sort of allowAutoRedirect property to false. If this is along the right lines, can anyone tell me the correct alternative for the HttpClient class?This post has info on the above allowAutoRedirect concept I meanElse, how might I get this method to return 301s rather than 200s for Urls I know to be genuine 301s? <code>  public static async void makeRequest(int row, string url){ string result; Stopwatch sw = new Stopwatch(); sw.Start(); try { using (HttpClient client = new HttpClient()) { HttpResponseMessage response = new HttpResponseMessage(); response = await client.GetAsync(url); // dump contents of header Console.WriteLine(response.Headers.ToString()); if (response.IsSuccessStatusCode) { result = ((int)response.StatusCode).ToString(); } else { result = ((int)response.StatusCode).ToString(); } } } catch (HttpRequestException hre) { result = ""Server unreachable""; } sw.Stop(); long time = sw.ElapsedTicks / (Stopwatch.Frequency / (1000L * 1000L)); requestComplete(row, url, result, time);}","Using HttpClient, how would I prevent automatic redirects and get original status code and forwading Url in the case of 301"
How exactly static fields work? ( Memorywise )," Say you have a class, When you say: I can imagine that in memory, a space is reserved for this object. ...and when you say again: ...well now you have another space available for the object.However, where exactly does the static field live?What I am really trying to learn is:How do the references to the objects reference the same field of the objects they reference?  <code>  class Foo{ public static bar;} new Foo(); new Foo(); ",How exactly do static fields work internally?
How exactly do static fields work?," Say you have a class, When you say: I can imagine that in memory, a space is reserved for this object. ...and when you say again: ...well now you have another space available for the object.However, where exactly does the static field live?What I am really trying to learn is:How do the references to the objects reference the same field of the objects they reference?  <code>  class Foo{ public static bar;} new Foo(); new Foo(); ",How exactly do static fields work internally?
How exactly do static fields work interally?," Say you have a class, When you say: I can imagine that in memory, a space is reserved for this object. ...and when you say again: ...well now you have another space available for the object.However, where exactly does the static field live?What I am really trying to learn is:How do the references to the objects reference the same field of the objects they reference?  <code>  class Foo{ public static bar;} new Foo(); new Foo(); ",How exactly do static fields work internally?
why .net doesn't show which object is null," Regarding this .NET unhandled exception message: Object reference not set to an instance of an object.Why doesn't .NET show which object is null?I know that I can check for null and resolve the error. However, why doesn't .NET help pointing out which object has a null-reference and which expression triggered the NullReferenceException? <code> ",Object reference not set to an instance of an object.Why doesn't .NET show which object is `null`?
Why .net doesn't show which object is `null`," Regarding this .NET unhandled exception message: Object reference not set to an instance of an object.Why doesn't .NET show which object is null?I know that I can check for null and resolve the error. However, why doesn't .NET help pointing out which object has a null-reference and which expression triggered the NullReferenceException? <code> ",Object reference not set to an instance of an object.Why doesn't .NET show which object is `null`?
Why doesn't .NET show which object is `null`?," Regarding this .NET unhandled exception message: Object reference not set to an instance of an object.Why doesn't .NET show which object is null?I know that I can check for null and resolve the error. However, why doesn't .NET help pointing out which object has a null-reference and which expression triggered the NullReferenceException? <code> ",Object reference not set to an instance of an object.Why doesn't .NET show which object is `null`?
Can a static method be overriden in C#?," I was told that static methods are implicitly final and therefore can't be overridden. Is that true? Can someone give a better example of overriding a static method? If static methods are just class methods, what is the real use of having them? <code> ",Can a static method be overridden in C#?
How to find list of events in Debugger (Visual Studio Professional 2012)?," Okay, I can't find any help for my question and stackoverflow doesn't seem to have anything either, or I didn't know how to look for it (please correct me, if I'm wrong and I will close this question).In my program, I have a Grid which has a few events definded in code: Now during my program run, I saw some weird behaviour that can only come from some events, so I set a breakpoint and stopped the program to use the debugger.Is there a list I can find somewhere that lists all the currently defined events of the member _grid so I can check that no unwanted events have not yet been removed? <code>  public Grid _grid = new Grid();_grid.MouseLeftButtonDown += new MouseButtonEventHandler(MyMethod);//and a few more events...",How to find list of events using Debugger (VS Professional 2012)?
byte[] to ushort[] in C#," Here is my question. Bear with me giving a little explanation: I am reading tiff image into buffer; Each pixel of my tiff is represented by a ushort (16 bits data, non-negtive).My image size is 64*64 = 4096. When my tiff is loaded into buffer, the buffer length is therefore 8192 (twice as much as 4096). I guess this is because in my buffer, the computer uses 2 bytes to store a single pixel value. I want to get the value for any particular pixel, in this case should I combine every 2 bytes to 1 ushort?For example: 00000000 11111111 -> 0000000011111111?Here is my code: How do I read the byte[] buffer to ensure that I can get the 16 bits ushort pixel value?Thanks <code>  public static void LoadTIFF(string fileName, int pxlIdx, ref int pxlValue) { using (Tiff image = Tiff.Open(fileName, ""r"")) { if (image == null) return; FieldValue[] value = image.GetField(TiffTag.IMAGEWIDTH); int width = value[0].ToInt(); byte[] buffer = new byte[image.StripSize()]; for (int strip = 0; strip < image.NumberOfStrips(); strip++) image.ReadEncodedStrip(strip, buffer, 0, -1); // do conversion here: //ushort bufferHex = BitConverter.ToUInt16(buffer, 0); image.Close(); } }",byte[] to ushort[]
Can I force all DateTime properties to be modeled as DateTime2?," In Entity Framework 6 Code First, is there a way to force all DateTime properties to be modeled as DateTime2?I know that I can do on each individual DateTime property, but I'm wondering if there's a way to set it as a default for all DateTime properties. <code>  .HasColumnType(""datetime2"")",Is it possible to force all DateTime properties to be modeled as DateTime2?
expressing hex value in 2's complement c#," i have a string hex value, and i need to express it in 2's complement. what i did is, converting it to binary: then inverting it, but i couldn't use the NOT operator.is there any short way to invert the bits and then adding 1 (2's complement operation)? <code>  string hx = ""FF00""; string h = Convert.ToString(Convert.ToInt32(hx, 16), 2 );",expressing hex value in 2's complement
signalR disconnet not being called on internet disconnection/reconnection?," I am using SignalR in my app.I have an app which depends to a very great degree on OnDisconnected() being called correctly. And it is called correctly under the following circumstances: The user refreshes the pageThe user navigates to a new pageThe user closes the browserHowever, it is not called if the network connection suddenly drops. For instance, if I unplug the network cable on the client machine, or disable the client's wireless network, or unplug the router, OnDisconnected() will never get called, even after a several minute wait. <code>  public Task OnDisconnected() { try { DeleteUser(Context.ConnectionId); return null; } catch (Exception ex) { return null; }}",SignalR disconnect not being called on internet disconnection/re-connection
SignalR disconnect not being called on internet disconnection/re-connection.," I am using SignalR in my app.I have an app which depends to a very great degree on OnDisconnected() being called correctly. And it is called correctly under the following circumstances: The user refreshes the pageThe user navigates to a new pageThe user closes the browserHowever, it is not called if the network connection suddenly drops. For instance, if I unplug the network cable on the client machine, or disable the client's wireless network, or unplug the router, OnDisconnected() will never get called, even after a several minute wait. <code>  public Task OnDisconnected() { try { DeleteUser(Context.ConnectionId); return null; } catch (Exception ex) { return null; }}",SignalR disconnect not being called on internet disconnection/re-connection
Why In C# Winform when I press the Ctrl Key and then Mouse-Left-Click the wrong event is executed," When I first press down control key (the left one) and then click the left mouse button, why does the following code gets executed. I am modifying existing code and the below code is already there. I guess no one has tried it before, with control key pressed, it has only been used with left-mouse-clicked and it has always worked for that case. But I want a different code executed when the mouse left key is pressed at the same time that the control key is pressed. I would highly appreciate any hint or help.P.S. I would like to add that in the above case when I inspect e.button value it shows that is equal to Right although I pressed the left mouse button and the Ctrl Key. That is a mystery to me.Dear StackOverflow fellows :I found the problem, since I am using a VM on a MAC I had to disable some Key Mapping on my Virtual Machine preference and now my original code works. Thanks for all your help. <code>  private void treeList1_MouseDown(object sender, System.Windows.Forms.MouseEventArgs e){ TreeList tree = sender as TreeList; if (e.Button == MouseButtons.Right && ModifierKeys == Keys.None && tree.State == TreeListState.Regular) { //the code that is here gets executed MessageBox.Show(""I am here""); }}",Detecting Ctrl+Left (mouse button) in MouseDown event handler
Wrong event is executed," When I first press down control key (the left one) and then click the left mouse button, why does the following code gets executed. I am modifying existing code and the below code is already there. I guess no one has tried it before, with control key pressed, it has only been used with left-mouse-clicked and it has always worked for that case. But I want a different code executed when the mouse left key is pressed at the same time that the control key is pressed. I would highly appreciate any hint or help.P.S. I would like to add that in the above case when I inspect e.button value it shows that is equal to Right although I pressed the left mouse button and the Ctrl Key. That is a mystery to me.Dear StackOverflow fellows :I found the problem, since I am using a VM on a MAC I had to disable some Key Mapping on my Virtual Machine preference and now my original code works. Thanks for all your help. <code>  private void treeList1_MouseDown(object sender, System.Windows.Forms.MouseEventArgs e){ TreeList tree = sender as TreeList; if (e.Button == MouseButtons.Right && ModifierKeys == Keys.None && tree.State == TreeListState.Regular) { //the code that is here gets executed MessageBox.Show(""I am here""); }}",Detecting Ctrl+Left (mouse button) in MouseDown event handler
When I press the Ctrl Key and then Mouse-Left-Click the wrong event is executed," When I first press down control key (the left one) and then click the left mouse button, why does the following code gets executed. I am modifying existing code and the below code is already there. I guess no one has tried it before, with control key pressed, it has only been used with left-mouse-clicked and it has always worked for that case. But I want a different code executed when the mouse left key is pressed at the same time that the control key is pressed. I would highly appreciate any hint or help.P.S. I would like to add that in the above case when I inspect e.button value it shows that is equal to Right although I pressed the left mouse button and the Ctrl Key. That is a mystery to me.Dear StackOverflow fellows :I found the problem, since I am using a VM on a MAC I had to disable some Key Mapping on my Virtual Machine preference and now my original code works. Thanks for all your help. <code>  private void treeList1_MouseDown(object sender, System.Windows.Forms.MouseEventArgs e){ TreeList tree = sender as TreeList; if (e.Button == MouseButtons.Right && ModifierKeys == Keys.None && tree.State == TreeListState.Regular) { //the code that is here gets executed MessageBox.Show(""I am here""); }}",Detecting Ctrl+Left (mouse button) in MouseDown event handler
How to emulate a console in WPF? (C#)," I'd like some tips-in-the-right-direction or even ready solutions to this problem and I'm pretty stuck (I'm just beginner/intermediate):I'm trying to implement a SSH in my application. The SSH-backend works fine and such, but I'm stuck at the frontend. What WPF-Combination would present me with an adequate solution to emulate a console? Put aside a complete terminal-emulation, I'd be happy to simply readline/writeline into something that looks like a console :-)My best approach yet was a 80x50 Grid of single characters resulting in 4000 single cells and that feels like a total overkill.Another idea was to make a console-Appl. bound to a wpf-window in another project. But...is that even possible and how? <code> ",How to emulate a console in WPF?
Try catch exception best practice," while maintaining my colleague's code from even someone who claims to be a senior developer, I often see the following code: or sometimes they write logging information to log files like following try catch block I am just wondering if what they have done is the best practice? It makes me confused because in my thinking users should know what happens with the system. <code>  try{ //do something}catch{ //Do nothing} try{ //do some work}catch(Exception exception){ WriteException2LogFile(exception);}",How using try catch for exception handling is best practice
How to make sure that string is Valid JSON using JSON.NET, I have a raw string. I just want to validate whether the string is valid JSON or not. I'm using JSON.NET. <code> ,How to make sure that string is valid JSON using JSON.NET
c# adding items to a list in a dictionary," I'm trying to put values into a dictionary dependent on the key... For example, if in a list of keys at the index 0 there is a letter ""a"". I want to add the val with index 0 to a list inside of a dictionary with the key ""a"" ( dictionary (key is ""a"" at index 0 , val at index 0) ... dictionary (key is ""b"" at index 2 , val at index 2)) I'm expecting an output like this: in listview lv1: 1,2,4 in listview lv2: 3,5 what I'm getting is 3,4,5 in both listviews Solution:replace the else code section with :testList.Add(key[index], new List { val[index] });thx everybody for your help =) <code>  List<string> key = new List<string>();List<long> val = new List<long>();List<long> tempList = new List<long>();Dictionary<string, List<long>> testList = new Dictionary<string, List<long>>();key.Add(""a"");key.Add(""a"");key.Add(""b"");key.Add(""a"");key.Add(""b"");val.Add(1);val.Add(2);val.Add(3);val.Add(4);val.Add(5); for (int index = 0; index < 5; index++){ if (testList.ContainsKey(key[index])) { testList[key[index]].Add(val[index]); } else { tempList.Clear(); tempList.Add(val[index]); testList.Add(key[index], tempList); }} lv1.ItemsSource = testList[""a""];lv2.ItemsSource = testList[""b""];",adding items to a list in a dictionary
How can i change the cursor (image) in the whole windows OS using c#," I need to change the cursor in all windows, not just in the application, i have try this: And this: But it only changes the cursor in my application.Any idea? <code>  this.Cursor = Cursors.WaitCursor; System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor;",How can i change the cursor (image) in the whole windows OS
MVC Helper TextArea -- PlaceHolder not displaying," I have the following code in my .cshtml: But the placeholder is not displaying at all. Am I missing something?Source: <code>  @Html.TextArea(""txtComments"", new { style = ""width: 450px;"", placeholder = ""Enter Comments here"" }) <textarea cols=""20"" id=""txtComments"" name=""txtComments"" placeholder=""Enter Comments here"" rows=""2"" style=""width: 450px;""></textarea>",MVC Helper TextArea - Placeholder not displaying
Retrieve physical disk size instead of volume size," I use the code below to get the physical disk size, but the size returned is not correct. I've checked the size with other tools. The code below reports Total disk space: 8.249.955.840 bytes and it should be Total disk space: 8.254.390.272 bytesHow can I retrieve the actual/correct physical disk size? Tested on USB drives and normal hard drives. The code is long, here separate it in parts to show. The structure: Native methods: Main entry: <code>  [StructLayout(LayoutKind.Sequential)]internal struct DiskGeometry { public long Cylinders; public int MediaType; public int TracksPerCylinder; public int SectorsPerTrack; public int BytesPerSector;} internal static class NativeMethods { [DllImport(""Kernel32.dll"", SetLastError=true, CharSet=CharSet.Auto)] public static extern SafeFileHandle CreateFile( string fileName, uint fileAccess, uint fileShare, IntPtr securityAttributes, uint creationDisposition, uint flags, IntPtr template ); [DllImport(""Kernel32.dll"", SetLastError=false, CharSet=CharSet.Auto)] public static extern int DeviceIoControl( SafeFileHandle device, uint controlCode, IntPtr inBuffer, uint inBufferSize, IntPtr outBuffer, uint outBufferSize, ref uint bytesReturned, IntPtr overlapped ); internal const uint FileAccessGenericRead=0x80000000; internal const uint FileShareWrite=0x2; internal const uint FileShareRead=0x1; internal const uint CreationDispositionOpenExisting=0x3; internal const uint IoCtlDiskGetDriveGeometry=0x70000;} internal const uint IoCtlDiskGetDriveGeometry=0x70000;public static void Main() { SafeFileHandle diskHandle= NativeMethods.CreateFile( @""\\.\PhysicalDrive0"", NativeMethods.FileAccessGenericRead, NativeMethods.FileShareWrite|NativeMethods.FileShareRead, IntPtr.Zero, NativeMethods.CreationDispositionOpenExisting, 0, IntPtr.Zero ); if(diskHandle.IsInvalid) { Console.WriteLine(""CreateFile failed with error: {0}"", Marshal.GetLastWin32Error()); return; } int geometrySize=Marshal.SizeOf(typeof(DiskGeometry)); Console.WriteLine(""geometry size = {0}"", geometrySize); IntPtr geometryBlob=Marshal.AllocHGlobal(geometrySize); uint numBytesRead=0; if( 0==NativeMethods.DeviceIoControl( diskHandle, NativeMethods.IoCtlDiskGetDriveGeometry, IntPtr.Zero, 0, geometryBlob, (uint)geometrySize, ref numBytesRead, IntPtr.Zero ) ) { Console.WriteLine( ""DeviceIoControl failed with error: {0}"", Marshal.GetLastWin32Error() ); return; } Console.WriteLine(""Bytes read = {0}"", numBytesRead); DiskGeometry geometry=(DiskGeometry)Marshal.PtrToStructure(geometryBlob, typeof(DiskGeometry)); Marshal.FreeHGlobal(geometryBlob); long bytesPerCylinder=(long)geometry.TracksPerCylinder*(long)geometry.SectorsPerTrack*(long)geometry.BytesPerSector; long totalSize=geometry.Cylinders*bytesPerCylinder; Console.WriteLine(""Media Type: {0}"", geometry.MediaType); Console.WriteLine(""Cylinders: {0}"", geometry.Cylinders); Console.WriteLine(""Tracks per Cylinder: {0}"", geometry.TracksPerCylinder); Console.WriteLine(""Sectors per Track: {0}"", geometry.SectorsPerTrack); Console.WriteLine(""Bytes per Sector: {0}"", geometry.BytesPerSector); Console.WriteLine(""Bytes per Cylinder: {0}"", bytesPerCylinder); Console.WriteLine(""Total disk space: {0}"", totalSize);}",Physical disk size not correct (IoCtlDiskGetDriveGeometry)
Post xml to a url .Net C#," I am trying to post an XMLDocument to an URL. This is what I have so far: What I am trying to figure out is how to load this XmlDocument to the WebRequest object so that it can be posted to that URL. <code>  var uri = System.Configuration.ConfigurationManager.AppSettings[""Url""]; var template = System.Configuration.ConfigurationManager.AppSettings[""Template""]; XmlDocument reqTemplateXml = new XmlDocument(); reqTemplateXml.Load(template); reqTemplateXml.SelectSingleNode(""appInfo/appNumber"").InnerText = x; reqTemplateXml.SelectSingleNode(""appInfo/coappNumber"").InnerText = y; WebRequest req = null; WebResponse rsp = null; req = WebRequest.Create(uri); req.Method = ""POST""; req.ContentType = ""text/xml""; rsp = req.GetResponse();",Post XML to a URL
Post XML to a URL .NET C#," I am trying to post an XMLDocument to an URL. This is what I have so far: What I am trying to figure out is how to load this XmlDocument to the WebRequest object so that it can be posted to that URL. <code>  var uri = System.Configuration.ConfigurationManager.AppSettings[""Url""]; var template = System.Configuration.ConfigurationManager.AppSettings[""Template""]; XmlDocument reqTemplateXml = new XmlDocument(); reqTemplateXml.Load(template); reqTemplateXml.SelectSingleNode(""appInfo/appNumber"").InnerText = x; reqTemplateXml.SelectSingleNode(""appInfo/coappNumber"").InnerText = y; WebRequest req = null; WebResponse rsp = null; req = WebRequest.Create(uri); req.Method = ""POST""; req.ContentType = ""text/xml""; rsp = req.GetResponse();",Post XML to a URL
can't reverse list in foreach in c#," I have a problem, I cant reverse the following List: I always get the error: Type void is not enumerableWhats the problem and how to solve it? <code>  foreach (List<Foo> row in Items) { foreach (Foo item in row.Reverse()) { ... }}",How can I reverse a list in foreach?
Filling one byte[] with multiple byte[]'s, I created an application that stores byte arrays in my SQLiteDatabase.This same application also selects the byte arrays from the database every 'x' seconds. The dataflow of my application is as follow: Application - > SQLiteDatabase -> ApplicationMy question is:How do I fill one byte array with all the incoming byte arrays from the SQLiteDatabase?For example: Needs to be filled with the following byte array: IncomingData is constantly being filled by the SQLiteDatabase. Data needs to be filled with IncomingData constantly.Can someone help me out? <code>  Byte[] Data; Byte[] IncomingData;,Filling one byte[] with multiple byte[]s
Filling one byte[] with multiple byte[]s, I created an application that stores byte arrays in my SQLiteDatabase.This same application also selects the byte arrays from the database every 'x' seconds. The dataflow of my application is as follow: Application - > SQLiteDatabase -> ApplicationMy question is:How do I fill one byte array with all the incoming byte arrays from the SQLiteDatabase?For example: Needs to be filled with the following byte array: IncomingData is constantly being filled by the SQLiteDatabase. Data needs to be filled with IncomingData constantly.Can someone help me out? <code>  Byte[] Data; Byte[] IncomingData;,Filling one byte[] with multiple byte[]s
Filling one byte[] with multiple byte[]s, I created an application that stores byte arrays in my SQLiteDatabase.This same application also selects the byte arrays from the database every 'x' seconds. The dataflow of my application is as follow: Application - > SQLiteDatabase -> ApplicationMy question is:How do I fill one byte array with all the incoming byte arrays from the SQLiteDatabase?For example: Needs to be filled with the following byte array: IncomingData is constantly being filled by the SQLiteDatabase. Data needs to be filled with IncomingData constantly.Can someone help me out? <code>  Byte[] Data; Byte[] IncomingData;,Filling one byte[] with multiple byte[]s
how can i prevent launching my app multiple times?," I deployed my C# WinForms application using ClickOnce installation. Everything works fine with it (after a lot of work) :), but now I'm facing a problem: Whenever I click on the application shortcut in the Start menu, a new instance starts. I need to avoid this. What can I do to prevent multiple launches?  <code> ",How can I prevent launching my app multiple times?
WPF DataBinding List<T> to DataGrid," I'm trying to create DataGrid in a separate UserControl whose DataContext is a List of T.In the code behind, I create a List, populate the list, then send it to the constructor for the UserControl on which I have the DataGrid I am trying to populate.The UserControl class is as follows. And the Xaml looks like: I've tried setting the ItemSource as well using I've also tried setting both the data context and the itemsource as well as refreshing: The databinding I have set to listboxes in the rest of my application works perfectly. In the list boxes I have the itemsource set to {Binding} and the ListItems binding set to {Binding Property}. The datacontext for the listboxes set in the code behind.My datagrid here is setup in the same manner, yet for some reason nothing is being displayed inside the grid.When I go through the debugger and watch the flow of information, I can see the List of T, SelectionsList being created and passed to the constructor for the user control where the data grid lies. I can see that the DataContext is indeed being set and shows the items in the list, but when I go back to my appication and try to view the data grid, it's blank.Any help would be greatly appreciated. I've been trying to wrap my mind around this problem for the last day and a half. Thanks!UPDATEThe SelectionList is setup like: and a Selection is then defined by: When the application starts, I build a catalog of existing products (Selections). On different tabs, one for each product family, the datacontext for the products list box is initialized with with available products that it grabs from the catalog. Then pending which product a user selects, the available options or child selections associated with that product are populated into the appropriate list boxes, accessories and warranties.Once a user selects the options they want, a button is clicked to preview the selected items which is supposed to populate the data grid explained above. I can build the list of selected options, however when I try to set the data context of the data grid, nothing appears. The Lists for available selections are built and set to the appropriate data context the same way I am trying to do it for the data grid, however the data grid doesn't want to display my information.UPDATESo after some more debugging, I've narrowed the problem down a bit. The data binding works as it should. I have no real problems there, I don't think. However, the issue I'm running into now is what I believe to be 2 different instances of my User Control, but only the original is being displayed, not the updated copy.Here's a copy of the class from about with a couple lines I added to help debug the problem. The implementation of the default constructor, is called every time the user control / tab, is clicked on. When that happens, _selectionList is set to the data context of the user control, followed by the Loaded Event which adds a line to my data grid.In another user control where I select the options I want to add to my data grid user control, I click a button that creates a list of the options I want to be added and calls the custom constructor I wrote. Once the constructor finishes, it calls a custom Loaded Event method that I created for shits and giggles, that adds the selected options to my _selectionList.Now once I click on the data grid user control again, it goes through the whole default process, and adds another default line.If I go back a tab and say I want these options again and go back to the data grid, it again goes through the default process and adds another default line.Whats most intriguing though is that I can see both of the selectionLists build since I dont clear the in between processes. I see a list build of the options i want to display and a list build of the default options build...Oh, also, SelectionList does implement ObservableCollection. <code>  public partial class QuotePreview : UserControl{ private static SelectionList previewList = new SelectionList(); public SelectionList PreviewList { get { return previewList; } } public QuotePreview() { InitializeComponent(); } public QuotePreview(SelectionList selectedOptions) { InitializeComponent(); previewList = selectedOptions; QuotePreviewDataGrid.DataContext = previewList; }} <DataGrid Name=""QuotePreviewDataGrid"" AutoGenerateColumns=""False"" ItemsSource=""{Binding}""> <DataGrid.Columns> <DataGridTextColumn Header=""Model Number"" Binding=""{Binding ModelNumber}""/> <DataGridTextColumn Header=""Description"" Binding=""{Binding Description}""/> <DataGridTextColumn Header=""List Price per Unit"" Binding=""{Binding Price}""/> </DataGrid.Columns></DataGrid> QuotePreviewDataGrid.ItemsSource = PreviewList; QuotePreviewDataGrid.Items.Refresh(); public class SelectionList : List<Selection>{ public List<Selection> availableSelections = new List<Selection>(); public List<Selection> AvailableSelections { get { return availableSelections; } }} public class Selection : DependencyObject{ public bool IsChecked { get; set; } public string ModelNumber { get; set; } public string Description { get; set; } public string Price { get; set; }} public partial class QuotePreview : UserControl{ private SelectionList _selectionList; private SelectionList temp; public QuotePreview() { InitializeComponent(); _selectionList = (SelectionList)this.DataContext; } private void QuotePreview_Loaded(object sender, RoutedEventArgs e) { _selectionList.SelectedOptions.Add( new Selection { ModelNumber = ""this"", Description = ""really"", Price = ""sucks"" }); } public QuotePreview(SelectionList selectedOptions) { InitializeComponent(); _selectionList = (SelectionList)this.DataContext; temp = selectedOptions; _selectionList.AddRange(selectedOptions); QuotePreview_Loaded(); } private void QuotePreview_Loaded() { foreach (var options in temp.SelectedOptions) { _selectionList.SelectedOptions.Add(options); } QuotePreviewDataGrid.ItemsSource = _selectionList.SelectedOptions; }}",WPF DataBinding ObservableCollection<T> to DataGrid
Is there a quick way to write boldface text using Console.WriteLine (C#) or printfn (F#)?," Is there a quick way to write boldface text using Console.WriteLine (C#) or printfn (F#)?If not boldface, perhaps some other kind of visual differentiator, like underlined text? <code> ",Write boldface text using Console.WriteLine (C#) or printfn (F#)?
SQL query in C# not support hebrew," I have a problem when I do a SQL query with Hebrew: I have TypeOfProduct set, that's have the value '', but the query returns null.If I replace the hebrew word in something like numbers or english words, everything goes fine.How do I use hebrew in SQL queries? <code>  ""select ProductName From Products WHERE TypeOfProduct =''""",SQL query in C# not support Hebrew
C# SQL Hebrew WHERE Statement," I have a problem when I do a SQL query with Hebrew: I have TypeOfProduct set, that's have the value '', but the query returns null.If I replace the hebrew word in something like numbers or english words, everything goes fine.How do I use hebrew in SQL queries? <code>  ""select ProductName From Products WHERE TypeOfProduct =''""",SQL query in C# not support Hebrew
c# 5.0 wait for async method to complete?," I'm writing a WinForms application that transfers data to a USB HID class device. My application uses the excellent Generic HID library v6.0 which can be found here. In a nutshell, when I need to write data to the device, this is the code that gets called: When my code drops out of the while loop, I need to read some data from the device. However, the device isn't able to respond right away so I need to wait for this call to return before I continue. As it currently exists, RequestToGetInputReport() is declared like this: For what it's worth, the declaration for GetInputReportViaInterruptTransfer() looks like this: Unfortunately, I'm not very familiar with the workings of the new async/await technologies in .NET 4.5. I did a little reading earlier about the await keyword and that gave me the impression that the call to GetInputReportViaInterruptTransfer() inside of RequestToGetInputReport() would wait (and maybe it does?) but it doesn't seem like the call to RequestToGetInputReport() itself is waiting because I seem to be re-entering the while loop almost immediately?Can anyone clarify the behavior that I'm seeing? <code>  private async void RequestToSendOutputReport(List<byte[]> byteArrays){ foreach (byte[] b in byteArrays) { while (condition) { // we'll typically execute this code many times until the condition is no longer met Task t = SendOutputReportViaInterruptTransfer(); await t; } // read some data from device; we need to wait for this to return RequestToGetInputReport(); }} private async void RequestToGetInputReport(){ // lots of code prior to this int bytesRead = await GetInputReportViaInterruptTransfer();} internal async Task<int> GetInputReportViaInterruptTransfer()",How to wait for async method to complete?
How to dertimine how and assembly is build," I'm using VS2010/2012 and I was wondering if there is a way (perhaps using reflection) to see how an assembly is build.When I run in Debug, I use the #if DEBUG to write debug information out to the console.However, when you end up with a bunch of assemblies, is there then a way to see how they where build? Getting the version number is easy, but I haven't been able to find out how to check the build type. <code> ",How to determine how an assembly was built
C# serialize a class without a paramaterless constructor," I'm implementing a factory pattern for 3 different cryptography classes. The factory will determine which one to create and then get a serialized instance of the correct class from a database and return it to the requester.Right now I'm working on serializing the classes to store them in the database. I'm writing one for a PGP cryptography class called BouncyCastle. I can create the class and the keys from files but when I try to serialize it, it says that the two member variables, which are objects of class PgpPublicKey, and PgpPrivateKey, cannot be serialized because they do not have parameterless constructors. The class has two member variables that are the problem. This is the public key class. No parameterless constructor. <code>  public void createdBouncyFromFiles(){ var bc = new BouncyCastle(""C:\\TestFiles\\BouncyPublicKey.txt"", ""C:\\TestFiles\\BouncyPrivateKey.txt"", ""Password1""); var xmlSerializer = new XmlSerializer(bc.GetType()); var textWriter = new StringWriter(); xmlSerializer.Serialize(textWriter, bc); var theSerializedClass = textWriter.ToString();} public class BouncyCastle : ICryptographyProvider{ public PgpPublicKey m_publicKey; public PgpPrivateKey m_privateKey; public string m_passPhrase; // cut out the irelevant parts public class PgpPublicKey{ public PgpPublicKey(PublicKeyAlgorithmTag algorithm, AsymmetricKeyParameter pubKey, DateTime time); // cut other methods}",C# serialize a class without a parameterless constructor
C# serialize a class without a parameterless constructor," I'm implementing a factory pattern for 3 different cryptography classes. The factory will determine which one to create and then get a serialized instance of the correct class from a database and return it to the requester.Right now I'm working on serializing the classes to store them in the database. I'm writing one for a PGP cryptography class called BouncyCastle. I can create the class and the keys from files but when I try to serialize it, it says that the two member variables, which are objects of class PgpPublicKey, and PgpPrivateKey, cannot be serialized because they do not have parameterless constructors. The class has two member variables that are the problem. This is the public key class. No parameterless constructor. <code>  public void createdBouncyFromFiles(){ var bc = new BouncyCastle(""C:\\TestFiles\\BouncyPublicKey.txt"", ""C:\\TestFiles\\BouncyPrivateKey.txt"", ""Password1""); var xmlSerializer = new XmlSerializer(bc.GetType()); var textWriter = new StringWriter(); xmlSerializer.Serialize(textWriter, bc); var theSerializedClass = textWriter.ToString();} public class BouncyCastle : ICryptographyProvider{ public PgpPublicKey m_publicKey; public PgpPrivateKey m_privateKey; public string m_passPhrase; // cut out the irelevant parts public class PgpPublicKey{ public PgpPublicKey(PublicKeyAlgorithmTag algorithm, AsymmetricKeyParameter pubKey, DateTime time); // cut other methods}",C# serialize a class without a parameterless constructor
get setup version programatically viusal studio," I am using a setup project to publish my projects. I want the version of each project to be the same as the setup version. I want to change my setup version property in Visual Studio and after building, for all project versions to be updated from this property, is this possible? <code> ",Set AssemblyInfo Version numbers with MSI setup version
Get the setup version programmatically in Visual Studio," I am using a setup project to publish my projects. I want the version of each project to be the same as the setup version. I want to change my setup version property in Visual Studio and after building, for all project versions to be updated from this property, is this possible? <code> ",Set AssemblyInfo Version numbers with MSI setup version
C# parsing JSON array of objects," I'm using JSON.net to parse the object data that I'm getting from a PHP script.I'm able to get it to parse the array and break that down. Then once I try to parse each object within that array I'm getting this error: This is the function that is giving me errors: I just started learning C# last night, so I'm very new at this. Please let me know if you need more info. <code>  Additional information: The best overloaded method match for 'Newtonsoft.Json.JsonConvert.DeserializeObject(string)' has some invalid arguments public void updateSearches() { var bw = new BackgroundWorker(); bw.DoWork += (send, args) => { WebClient client = new WebClient(); JSON = client.DownloadString(""URL""); dynObj = JsonConvert.DeserializeObject(JSON); foreach (var item in dynObj) { dynamic search = JsonConvert.DeserializeObject(item); foreach (var s in search) { joined += string.Join("","", s) + ""END OF THE LINE\r\n""; } } }; bw.RunWorkerCompleted += (send, args) => { this.mainWindow.richTextBox2.Text += ""Got Data!\r\n""; this.mainWindow.richTextBox2.Text += joined; }; bw.RunWorkerAsync(); }","parsing JSON array of objects: ""The best overloaded method match has some invalid arguments"""
Maxium file size allowed by ASP.NET file upload Control," I am using File upload control in ASP.Net, followed the below blogs approach.http://weblogs.asp.net/jgalloway/archive/2008/01/08/large-file-uploads-in-asp-net.aspxThe 4MB default is set in machine.config, but you can override it in you web.config. For instance, to expand the upload limit to 20MB, you'd do this: Question: Till what level(MAX size) i can increase the requested length and what will be performance impact on site if we allowed user to upload 50-60 MB files also. <code>  <system.web> <httpRuntime executionTimeout=""240"" maxRequestLength=""20480"" /></system.web>",Maximum file size allowed by ASP.NET file upload Control
C#: UDP: Read data from all network interfaces," I've the following code to read multicast message coming from the network, for a specified IP+Port I've two network adapter from which I've data coming on this multicast ip+port(confirmed by two instances of wireshark monitoring each network adapter). I see on wireshark a lot of traffic coming on those port+Ip) for both network cards.The problem is that on my console, I only see messages coming from one network card.I double checked with netstat, I don't have any other software listening on my port:So why am I getting traffic from only one of my two network cards?EDIT:I even tried the following: I see the ""Starting to listen on theCorrectIP"" twice(for my two IPs), but it still display only data coming from one network card.EDIT 2I did notice something else that is strange too. If I disable the interface on which I receive all data, and then start the software, I now get data from the other interface. If I activate again the interface and restart the software, I still get the traffic on the non-deactivated card.And I know for sure that I've devices that respond to me, that are connected only to one network(not both)EDIT 3Another thing: if I send a message from me(localhost), on all network card that I've, I see them coming on my two network interfaces. BUT, if I start my program twice, only the first programm get messages, not the second one.Edit 4Additional info, following the first comment:I've two ethernet cards, one with the 10.10.24.78 ip, the other with the 10.9.10.234 ip.It's not me that send data, but network pieces(the port 5353 with this ip is a know multicast address used for mDNS, so I should receive traffic from things like printer, itunes, macs, and some other pieces of software we created). Data are multicasted on the ip 224.0.0.251 and port 5353.Here is a code that you could use to send data on severals IPs, but like I described, if you start it in local it almost works(except that only one local client receive the message). EDIT 5Here is the result of my route print(Didn't know that command), and on my two IPs, I always receive data on the 10.9.10.234Edit 6I tried several other things:Use a socket to receive instead of the UdpClient --> Didn't workedSet some addition socketOption on the reader(DontRoute =1, Broadcast=1) -->Didn't workedSpecify the MulticastInterface that the reader Socket has to use(using socketOption MulticastInterface) --> Didn't work <code>  private static void ReceiveMessages(int port, string ip, CancellationToken token){ Task.Factory.StartNew(() => { using (var mUdpClientReceiver = new UdpClient()) { var mReceivingEndPoint = new IPEndPoint(IPAddress.Any, port); mUdpClientReceiver.ExclusiveAddressUse = false; mUdpClientReceiver.Client.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReuseAddress, true); mUdpClientReceiver.ExclusiveAddressUse = false; mUdpClientReceiver.Client.Bind(mReceivingEndPoint); mUdpClientReceiver.JoinMulticastGroup(IPAddress.Parse(ip), 255); while (!token.IsCancellationRequested) { byte[] receive = mUdpClientReceiver.Receive(ref mReceivingEndPoint); Console.WriteLine(""Message received from {0} "",mReceivingEndPoint); } } });} private static void ReceiveMessages(int port, string ip, CancellationToken token, IEnumerable<IPAddress> ipAddresses){ foreach (IPAddress ipAddress in ipAddresses) { IPAddress ipToUse = ipAddress; Task.Factory.StartNew(() => { using (var mUdpClientReceiver = new UdpClient()) { var mReceivingEndPoint = new IPEndPoint(ipToUse, port); mUdpClientReceiver.ExclusiveAddressUse = false; mUdpClientReceiver.Client.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReuseAddress, true); mUdpClientReceiver.Client.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.Broadcast, 1); mUdpClientReceiver.Client.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.DontRoute, 1); mUdpClientReceiver.ExclusiveAddressUse = false; mUdpClientReceiver.Client.Bind(mReceivingEndPoint); mUdpClientReceiver.JoinMulticastGroup(IPAddress.Parse(ip), 255); Console.WriteLine(""Starting to listen on ""+ipToUse); while (!token.IsCancellationRequested) { byte[] receive = mUdpClientReceiver.Receive(ref mReceivingEndPoint); Console.WriteLine(""Message received from {0} on {1}"", mReceivingEndPoint,ipToUse); } } }); }} private static void SendManuallyOnAllCards(int port, string multicastAddress, IEnumerable<IPAddress> ipAddresses){ foreach (IPAddress remoteAddress in ipAddresses) { IPAddress ipToUse = remoteAddress; using (var mSendSocket = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp)) { mSendSocket.SetSocketOption(SocketOptionLevel.IP, SocketOptionName.AddMembership, new MulticastOption(IPAddress.Parse(multicastAddress))); mSendSocket.SetSocketOption(SocketOptionLevel.IP, SocketOptionName.MulticastTimeToLive, 255); mSendSocket.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReuseAddress, true); var ipep = new IPEndPoint(ipToUse, port); //IPEndPoint ipep = new IPEndPoint(IPAddress.Parse(multicastAddress), port); mSendSocket.Bind(ipep); mSendSocket.Connect(ipep); byte[] bytes = Encoding.ASCII.GetBytes(""This is my welcome message""); mSendSocket.Send(bytes, bytes.Length, SocketFlags.None); } }}",UDP: Read data from all network interfaces
C# - Identify implementations of base class in an array," I have the following problem: I have a set of engines which automaticly (listening to events) controls my model. The following picture shows in general the class diagram:Now I have a client which knows the EngineFacade and i want to set the property Active from Engine2 from the client, but neither the client nor the EngineFacade knows which of the three engines is Engine2.There are two ways, but I dont like any of them:Check if one of the engines is of type Engine2 - if there is another class which does the same task but is named different I have to change it in the EngineBuilder AND in the EngineFacade.Check with an identifier string - I dont really like magic strings.What I know on the client site is that there is or should be an engine which handels the grid. But I dont know more.Maybe I have to choose between the two devils, but maybe one of you has a better solution. <code> ",Identify implementations of base class in an array
Closure captured variable modifies the original as well. How and why?," I have the following simple code: From what I read when closures are involved, a new type is created by the compiler so it can store the captured variable and maintain a reference to it. However, when I run the following code, both printed lines show 3. I was expecting 0 and 3, because the anonymous method has its own variable in the generated class by the compiler. So why does it also modify the outside variable? <code>  static void Main(string[] args){ int j = 0; Func<int> f = () => { for (int i = 0; i < 3; i++) { j += i; } return j; }; int myStr = f(); Console.WriteLine(myStr); Console.WriteLine(j); Console.Read();}",Closure captured variable modifies the original as well
Properly implement comparison two different objects," I've found a similar questionHow to compare two distinctly different objects with similar propertiesthat may implicitly and/or in part reply to my question.Suppose I want compare (without a lot of nested conditions) this object: to a System.String. I'm interested only in equality or inequality (not a range of values about identity).Implementing IEquatable<string> in ObjectA is a proper choice? I don't care of what simply works, I want to identify the proper pattern for such case.As other information, please consider that ObjectA will often be supplied as sequence of IEnumerable<ObjectA>.I don't need to know if ""string"" == or != objectA instance; sorting is not involved.Edit to clarify (and help)Sorry but writing a good question is sometime difficult...Suppose I can't represent ObjectA as string for the purpose of comparison (violating encapsulation is not an option).In context-1 I've to match it against PropertyY.In context-2 I've to match it against an algorithm applied to PropertyY/PropertyZ.@Oliver solution in the end of the question helps me again (and +1 again).I can simply define a custom interface: Since I've also an ObjectB with same logic but different properties, both will implement IContextConverter (or maybe I find a better name) avoiding to violate RAP. <code>  class ObjectA { public string PropertyX { get; set; } public char PropertyY { get; set; } public long PropertyZ { get; set; }} interface IContextConverter { string ToEquatableStringForContext1(); string ToEquatableStringForContext2(); }",Properly implement comparison of two objects with different type but semantically equivalent
Does System.Exception has a build-in thrown timestamp?," Is there a way to extract when an exception was thrown from the exception itself, or will I need to manually add this information to the exception? <code> ",Does System.Exception have a built-in thrown timestamp?
C# Expression tree and AND condition," i'm trying to build a filter expression to filter data from the database.I've wrote the following extension to build expression dynamically depending on the selected filter parameters: I'm using it in such way: It works great with NHibernate, but when i'm using this code with Entity Framework 5 it fails with the following exception message: The LINQ expression node type 'Invoke' is not supported in LINQ to Entities.There is one workaround that fetches the whole collection from the database and then applies filter conditions through the IEnumerable.Where(Func<T1, T2> filterClause), but it dont need all data just to get one record while Expression<Func<T1, T2>> expressions are translated directly into SQL statement.Is there any simple way to make this code work with Entity Framework? <code>  public static Expression<Func<T, bool>> And<T>( this Expression<Func<T, bool>> leftExpression, Expression<Func<T, bool>> rightExpression){ var invocationExpression = Expression.Invoke(rightExpression, leftExpression.Parameters.Cast<Expression>()); var andExpression = Expression.Lambda<Func<T, bool>>( Expression.AndAlso(leftExpression.Body, invocationExpression), leftExpression.Parameters); return andExpression;} Expression<Func<MyObject, bool>> expression = x => true;if(MyFilter.SomeParam) { expression = expression.And(x=>x.MyProperty == MyFilter.SomeParam);}",Expression tree and AND condition
C# saving lists to txt file," I'm trying to save a list to a text file.This is my code: This is what I get in the text file: System.Collections.Generic.List`1[System.String]Do I have to use ConvertAll<>? If so, I'm not sure how to use that. <code>  public void button13_Click(object sender, EventArgs e){ TextWriter tw = new StreamWriter(""SavedLists.txt""); tw.WriteLine(Lists.verbList); tw.Close();}",Saving lists to txt file
combobox refrehses listbox," I have visual studio 2010.I have a ListBox and a ComboBox, if you select a item from the listbox and after you click the combobox, the listbox refresh. It's like clearing the combobox and adding the items again.If you open a new project, add a ListBox, add some items to the ListBox, add a ComboBox, run the project, select one item from the ListBox, click the ComboBox and the ListBox for some reason refreshes.Anyone knows why it happens?If some can try it, to see if it is an issue with VB, or some setting in my program.  <code> ",ComboBox refreshes ListBox
Real life scenarios for using TaskCompletionSource<T>?," AFAIK, all it knows is that at some point, its SetResult or SetException method is being called to complete the Task<T> exposed through its Task property.In other words, it acts as the producer for a Task<TResult> and its completion.I saw here the example:If I need a way to execute a Func<T> asynchronously and have a Task<T>to represent that operation. Which could be used if I didnt have Task.Factory.StartNew -But I do have Task.Factory.StartNew.Question:Can someone please explain by example a scenario related directly to TaskCompletionSourceand not to a hypothetical situation in which I don't have Task.Factory.StartNew? <code>  public static Task<T> RunAsync<T>(Func<T> function) { if (function == null) throw new ArgumentNullException(function); var tcs = new TaskCompletionSource<T>(); ThreadPool.QueueUserWorkItem(_ => { try { T result = function(); tcs.SetResult(result); } catch(Exception exc) { tcs.SetException(exc); } }); return tcs.Task; }",When should TaskCompletionSource<T> be used?
There is any way I can integrate the MS Office Smooth Typing in a C# application?," In my opinion the MS Office Smooth Typing is a very innovative feature in the Office Suite, and I'd like to know if this feature is available for programmers in the .NET Framework, specifically in the C# language.If so, could you please post in your answer a usage example and link to the documentation?Thanks.By ""smooth typing"" I'm referring to the typing animation, that makes the cursor slide during typing. <code> ",Is there any way I can integrate the MS Office Smooth Typing in a C# application?
How to shallow copy List in C#," I want to copy a List of Objects, but i keep getting references between the objects. When i change the value in the copy List, the original List ends up modified also.Is there a way to work around it? <code>  List<MyClass> copy = original;",How to copy List in C#
ASP.NET and MVC multi-tenancy web application with filtered dbContext," I am new to ASP.Net MVC and multi-tenancy web application. I have done lots of reading, but being a beginner I just follow what I understand. So I managed to built a sample scenario web application and need to solve the ending part of it. Hope this scenario will be useful for some other beginners as well, but would welcome any other approach. Thanks in advance1) Database in SQLServer 2008.2) Data layer: C# class library project called MyApplication.Data 3). Business Layer: class library MyApplication.BusinessFollowing FilteredDbSet Class courtesy: Zoran Maksimovic 4) WEB Layer: ASP.NET MVC 4 Internet Application with Ninject DI 5) Controller. Here is the Problem  <code>  public class AppUser{ [Key] public virtual int AppUserID { get; set; } [Required] public virtual int TenantID { get; set; } [Required] public virtual int EmployeeID { get; set; } [Required] public virtual string Login { get; set; } [Required] public virtual string Password { get; set; }}public class Employee{ [Key] public virtual int EmployeeID { get; set; } [Required] public virtual int TenantID { get; set; } [Required] public virtual string FullName { get; set; }}public class Tenant_SYS{ //this is an autonumber starting from 1 [Key] public virtual int TenantID { get; set; } [Required] public virtual string TenantName { get; set; }} public class FilteredDbSet<TEntity> : IDbSet<TEntity>, IOrderedQueryable<TEntity>, IOrderedQueryable, IQueryable<TEntity>, IQueryable, IEnumerable<TEntity>, IEnumerable, IListSource where TEntity : class { private readonly DbSet<TEntity> _set; private readonly Action<TEntity> _initializeEntity; private readonly Expression<Func<TEntity, bool>> _filter; public FilteredDbSet(DbContext context) : this(context.Set<TEntity>(), i => true, null) { } public FilteredDbSet(DbContext context, Expression<Func<TEntity, bool>> filter) : this(context.Set<TEntity>(), filter, null) { } public FilteredDbSet(DbContext context, Expression<Func<TEntity, bool>> filter, Action<TEntity> initializeEntity) : this(context.Set<TEntity>(), filter, initializeEntity) { } public Expression<Func<TEntity, bool>> Filter { get { return _filter; } } public IQueryable<TEntity> Include(string path) { return _set.Include(path).Where(_filter).AsQueryable(); } private FilteredDbSet(DbSet<TEntity> set, Expression<Func<TEntity, bool>> filter, Action<TEntity> initializeEntity) { _set = set; _filter = filter; MatchesFilter = filter.Compile(); _initializeEntity = initializeEntity; } public Func<TEntity, bool> MatchesFilter { get; private set; } public IQueryable<TEntity> Unfiltered() { return _set; } public void ThrowIfEntityDoesNotMatchFilter(TEntity entity) { if (!MatchesFilter(entity)) throw new ArgumentOutOfRangeException(); } public TEntity Add(TEntity entity) { DoInitializeEntity(entity); ThrowIfEntityDoesNotMatchFilter(entity); return _set.Add(entity); } public TEntity Attach(TEntity entity) { ThrowIfEntityDoesNotMatchFilter(entity); return _set.Attach(entity); } public TDerivedEntity Create<TDerivedEntity>() where TDerivedEntity : class, TEntity { var entity = _set.Create<TDerivedEntity>(); DoInitializeEntity(entity); return (TDerivedEntity)entity; } public TEntity Create() { var entity = _set.Create(); DoInitializeEntity(entity); return entity; } public TEntity Find(params object[] keyValues) { var entity = _set.Find(keyValues); if (entity == null) return null; // If the user queried an item outside the filter, then we throw an error. // If IDbSet had a Detach method we would use it...sadly, we have to be ok with the item being in the Set. ThrowIfEntityDoesNotMatchFilter(entity); return entity; } public TEntity Remove(TEntity entity) { ThrowIfEntityDoesNotMatchFilter(entity); return _set.Remove(entity); } /// <summary> /// Returns the items in the local cache /// </summary> /// <remarks> /// It is possible to add/remove entities via this property that do NOT match the filter. /// Use the <see cref=""ThrowIfEntityDoesNotMatchFilter""/> method before adding/removing an item from this collection. /// </remarks> public ObservableCollection<TEntity> Local { get { return _set.Local; } } IEnumerator<TEntity> IEnumerable<TEntity>.GetEnumerator() { return _set.Where(_filter).GetEnumerator(); } IEnumerator IEnumerable.GetEnumerator() { return _set.Where(_filter).GetEnumerator(); } Type IQueryable.ElementType { get { return typeof(TEntity); } } Expression IQueryable.Expression { get { return _set.Where(_filter).Expression; } } IQueryProvider IQueryable.Provider { get { return _set.AsQueryable().Provider; } } bool IListSource.ContainsListCollection { get { return false; } } IList IListSource.GetList() { throw new InvalidOperationException(); } void DoInitializeEntity(TEntity entity) { if (_initializeEntity != null) _initializeEntity(entity); } public DbSqlQuery<TEntity> SqlQuery(string sql, params object[] parameters) { return _set.SqlQuery(sql, parameters); } }public class EFDbContext : DbContext{ public IDbSet<AppUser> AppUser { get; set; } public IDbSet<Tenant_SYS> Tenant { get; set; } public IDbSet<Employee> Employee { get; set; } ///this makes sure the naming convention does not have to be plural ///tables can be anything we name them to be protected override void OnModelCreating(DbModelBuilder modelBuilder) { modelBuilder.Conventions.Remove<PluralizingTableNameConvention>(); } public EFDbContext(int tenantID = 0) //Constructor of the class always expect a tenantID { //Here, the Dbset can expose the unfiltered data AppUser = new FilteredDbSet<AppUser>(this); Tenant = new FilteredDbSet<Tenant_SYS>(this); //From here, add all the multitenant dbsets with filtered data Employee = new FilteredDbSet<Employee>(this, d => d.TenantID == tenantID); }}public interface IEmployeeRepository{ IQueryable<Employee> Employees { get; } void SaveEmployee(Employee Employee); void DeleteEmployee(Employee Employee); List<Employee> GetEmployeesSorted();}public class EFEmployeeRepository : IEmployeeRepository{ private EFDbContext context; public EFEmployeeRepository(int tenantID = 0) { context = new EFDbContext(tenantID); } IQueryable<Employee> IEmployeeRepository.Employees { get { return context.Employee; } } public void SaveEmployee(Employee Employee) { if (Employee.EmployeeID == 0) { context.Employee.Add(Employee); } context.SaveChanges(); } public void DeleteEmployee(Employee Employee) { context.Employee.Remove(Employee); context.SaveChanges(); } public List<Employee> GetEmployeesSorted() { //This is just a function to see the how the results are fetched. return context.Employee.OrderBy(m => m.FullName) .ToList(); //I haven't used where condition to filter the employees since it should be handled by the filtered context }} public class NinjectControllerFactory : DefaultControllerFactory{ private IKernel ninjectKernel; public NinjectControllerFactory() { ninjectKernel = new StandardKernel(); AddBindings(); } protected override IController GetControllerInstance(RequestContext requestContext, Type controllerType) { return controllerType == null ? null : (IController)ninjectKernel.Get(controllerType); } private void AddBindings() { ninjectKernel.Bind<IAppUserRepository>().To<EFAppUserRepository>(); ninjectKernel.Bind<IEmployeeRepository>().To<EFEmployeeRepository>(); }} public class HomeController : Controller{ IEmployeeRepository repoEmployee; public HomeController(IEmployeeRepository empRepository) { //How can I make sure that the employee is filtered globally by supplying a session variable of tenantID //Please assume that session variable has been initialized from Login modules after authentication. //There will be lots of Controllers like this in the application which need to use these globally filtered object repoEmployee = empRepository; } public ActionResult Index() { //The list of employees fetched must belong to the tenantID supplied by session variable //Why this is needed is to secure one tenant's data being exposed to another tenants accidently like, if programmer fails to put where condition List<Employee> Employees = repoEmployee.Employees.ToList(); return View(); }}",Multi-tenancy web application with filtered dbContext
Best design pattern for this situation (Maybe factory method?)," I'm building a flight booking system from a specification for my OOP class in college. The system has to be written in C#. I'm wondering what the best way to tackle the following problem would be The company currently operates a discount scheme. Western Isles residents get a 10% discount. Scotia also records the island of residence of these passengers for marketing purposes. Business travellers get a 25% discount and must supply their company name. Ordinary passengers do not normally receive a discount unless it is part of a current promotion, in which case they receive a 5% discount.Should I have a passenger class, from which each separate type of customer inherits from? Any help on this would be appreciated <code> ",Best design pattern for a conditional booking system
"What's the best way to delay event handling until all ""known"" events have been fired"," In C#, what's the best way to delay handling of all known events until an entity has been fully modified?Say, for example that an entity - MyEntity - has the properties ID, Name and Description... When modifying each of these properties, an event is fired for each modification.Sometimes, the ID is the only property modified and sometimes all properties are modified. I want the registered listeners of the modification event to wait until all properties being modified in the ""batch"" have been modified.What is the best way to accomplish this?In my head, something similar to the UnitOfWork-pattern, where it is possible to wrap a using statement around the method call in the top level of the call stack but have no clue how to implement such a thing...Edit:As a clarification... Listeners are spread out through the application and are executing in other threads. Another actor sets - for example - the name it must call the MyEntity.Name property to set the value. Due to the design, the modification of the Name property can trigger other properties to change, thus the need for listeners to know that the modification of properties have been completed. <code>  public class MyEntity { public Int32 ID { get; set; } public String Name { get; set; } public String Description { get; set; } }",Delay event handling until events have been fired
C# Lambda Expressions : Compiler Behaviour," Well I am going through the 'Lambda Expressions' topic (Chapter 17; Delegates, C# Syntactical Sugar for Delegates). Jeffery states that the C# compiler creates a new non-static class in the background that has the following:Fields to store all the local variables that have been accessed in the Lambda Expression.A method whose body contains the Lambda Expression and whose signature/return type matches the delegate for which the Lambda Expressin has been used.I have the following two questions:I did a little debugging myself and saw that if the Lambda Expression modifies the value of a local variable(defined in a method the lambda Expresison is being used in), the new value is reflected outside the expression body too. How is this possible considering the expression is actually in a different class?Why does the emitted class need to be non-static when the same can be done by Static class perfectly?I hope this is not a very simple concept that I am unable to comprehend.Let me know if I need to provide more details. <code> ",Lambda Expressions : Compiler Behaviour
MVVM in WPF - How to alert ModelView of changes in Model... or should I?," I am going through some MVVM articles, primarily this and this.My specific question is: How do I communicate Model changes from the Model to the ViewModel? In Josh's article, I don't see that he does this. The ViewModel always asks the Model for properties. In Rachel's example, she does have the model implement INotifyPropertyChanged, and raises events from the model, but they are for consumption by the view itself (see her article/code for more detail on why she does this). Nowhere do I see examples where the model alerts the ViewModel of changes to model properties. This has me worried that perhaps it's not done for some reason. Is there a pattern for alerting the ViewModel of changes in the Model? It would seem to be necessary as (1) conceivably there are more than 1 ViewModel for each model, and (2) even if there is just one ViewModel, some action on the model might result in other properties being changed. I suspect that there might be answers/comments of the form ""Why would you want to do that?"" comments, so here's a description of my program. I'm new to MVVM so perhaps my whole design is faulty. I'll briefly describe it.I am programming up something that is more interesting (at least, to me!) than ""Customer"" or ""Product"" classes. I am programming BlackJack. I have a View that doesn't have any code behind and just relies on binding to properties and commands in the ViewModel (see Josh Smith's article). For better or worse, I took the attitude that the Model should contain not just classes such as PlayingCard, Deck, but also the BlackJackGame class that keeps state of the whole game, and knows when the player has gone bust, the dealer has to draw cards, and what the player and dealer current score is (less than 21, 21, bust, etc.). From BlackJackGame I expose methods like ""DrawCard"" and it occurred to me that when a card is drawn, properties such as CardScore, and IsBust should be updated and these new values communicated to the ViewModel. Perhaps that's faulty thinking? One could take the attitude that the ViewModel called the DrawCard() method so he should know to ask for an updated score and find out if he is bust or not. Opinions? In my ViewModel, I have the logic to grab an actual image of a playing card (based on suit,rank) and make it available for the view. The model should not be concerned with this (perhaps other ViewModel would just use numbers instead of playing card images). Of course, perhaps some will tell me that the Model should not even have the concept of a BlackJack game and that should be handled in the ViewModel? <code> ",MVVM in WPF - How to alert ViewModel of changes in Model... or should I?
Store Class name into string variable and create its object," I don't know the thing I am asking is available or not but I just want to know if it exists and how it works. So here is my question: I have 2-3 custom model class of my own. For example, Customer, Employee and Product. Now I have class name in a string. and based on the class name coming in a string, I have to create its object and return to a VIEW. How could I achieve this?I know a option of IF ELSE statement but I want to try a better,""Dynamic"" way... <code> ",Create object instance of a class having its name in string variable
Create object instance of a class having its string name," I don't know the thing I am asking is available or not but I just want to know if it exists and how it works. So here is my question: I have 2-3 custom model class of my own. For example, Customer, Employee and Product. Now I have class name in a string. and based on the class name coming in a string, I have to create its object and return to a VIEW. How could I achieve this?I know a option of IF ELSE statement but I want to try a better,""Dynamic"" way... <code> ",Create object instance of a class having its name in string variable
Best way to authenticate via OAuth in WinRT Windows Store App (c#)," Anybody knows about any tools which I could use to authenticate via OAuth in my Windows Store application written in c# XAML approach?I known about DotNetOpenAuth, and Hammock but these tools are not PCL, and I can not reference it from my app!Only way is to manualy generate requests and send it via HttpClient? Or, is any simpler way? <code> ",Best way to authenticate via OAuth in WinRT Windows Store App
execute method from referenced class library after build .NET application for license checking," I'm developing a class library which should be licensed to specific developer computers. There are no components so that the design time licensing checks can't be done. This check is in fact unavailable for pure class libraries: One has suggested to use Debugger.IsAttached to check if the lib is used on the developer machine:Design-Time validation of libraryBut I'm looking after a solution on the build stage, so that the program won't build if the license is invalid (e.G. this machine is not licensed). Any suggestions? <code>  if( LicenseContext.UsageMode == LicenseUsageMode.Designtime ) ...",execute method from referenced class library before build .NET application for license checking
get and set in c# why?," I'm a newbie and I'm trying to learn the basics of C#. This might sound quite trivial and may be stupid but its a doubt. While going through one of the source codes of an application, I saw a piece of code inside a class Can anyone tell me what it means. I understand that when we declare a class we access fname using an alias FirstName. If it's for some security purpose then what? <code>  private string fname;public string FirstName{ get { return fname } set { fname = value; }}",Understanding Get and Set Accessors
Change dataset rowsstate using c# in asp.net," Given an ADO.Net DataRow, how I can change the row's RowState from Added to Modified or Deleted?I tried setting the property directly: resulting in the following error message from the compiler: <code>  myDataSet.Tables[0].Rows[0].RowState = DataViewRowState.ModifiedOriginal; error CS0200: Property or indexer 'DataRow.RowState' cannot be assigned to -- it is read only",How can I explicitly change the RowState of an ADO.Net DataRow?
How can I explicitly change the RowState?," Given an ADO.Net DataRow, how I can change the row's RowState from Added to Modified or Deleted?I tried setting the property directly: resulting in the following error message from the compiler: <code>  myDataSet.Tables[0].Rows[0].RowState = DataViewRowState.ModifiedOriginal; error CS0200: Property or indexer 'DataRow.RowState' cannot be assigned to -- it is read only",How can I explicitly change the RowState of an ADO.Net DataRow?
Sql Bulk copy performance," I am working to increase the performance of bulk loads; 100's of millions of records + daily. I moved this over to use the IDatareader interface in lieu of the data tables and did get a noticeable performance boost (500,000 more records a minute). The current setup is: A custom cached reader to parse the delimited files. Wrapping the stream reader in a buffered stream. A custom object reader class that enumerates over the objects and implements the IDatareader interface. Then SqlBulkCopy writes to server The bulk of the performance bottle neck is directly in SqlBulkCopy.WriteToServer. If I unit test the process up to but excluding just the WriteToServer the process returns in roughly 1 minute. WriteToServer is taking on an additional 15 minutes +. For the unit test it is on my local machine so the same drive the database lives on so it's not having to copy the data across the network. I am using a heap table (no indexes; clustered or unclustered; I have played around various batch sizes without major differences in performance). There is a need to decrease the load times so I am hoping someone might now a way to squeeze a little more blood out of this turn-up.  <code> ",SqlBulkCopy performance
catch unhandled exeptions from any thread," EditThe answers to this question where helpful thanks I appreciate the help :) but I ended up using: http://code.msdn.microsoft.com/windowsdesktop/Handling-Unhandled-47492d0b#contentOriginal question:I want to show a error message when my application crashes. Currently I have:App.xaml: Code-behind of App.xaml: That solution works great when the error occurs on the main thread. Now my problem is how will I be able to catch errors that happen on a different thread also? In other words: when I press this button I am able to catch the exception: (App_DispatcherUnhandledException gets called!) But I am not able to catch this exception: How will I be able to catch all exceptions regardless if they happen on the main thread or not?  <code>  <Application x:Class=""WpfApplication5.App"" xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation"" xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" DispatcherUnhandledException=""App_DispatcherUnhandledException"" // <---------------- StartupUri=""MainWindow.xaml""> <Application.Resources> </Application.Resources></Application> namespace WpfApplication5{ public partial class App : Application { private void App_DispatcherUnhandledException(object sender, DispatcherUnhandledExceptionEventArgs e) { MessageBox.Show(""Caught Unhandled Exception!""); } }} private void button1_Click(object sender, RoutedEventArgs e) { int.Parse(""lkjdsf""); } private void button1_Click(object sender, RoutedEventArgs e) { Task.Factory.StartNew(() => { int.Parse(""lkjdsf""); }); }",Catch unhandled exceptions from any thread
C# syntax conversion," I'm trying to convert this C# method into PHP. What does the out in the second parameter mean?  <code>  public static bool Foo(string name, out string key)",C# out keyword meaning and does it have an equivalent in PHP?
"What does the ""out"" keyword in C# mean?"," I'm trying to convert this C# method into PHP. What does the out in the second parameter mean?  <code>  public static bool Foo(string name, out string key)",C# out keyword meaning and does it have an equivalent in PHP?
read last 3 characters from string," I want to remove last three characters from a string: Note that the string is dynamic data. <code>  string myString = ""abcdxxx""; ",Remove the last three characters from a string
remove last 3 characters from string in c#," I want to remove last three characters from a string: Note that the string is dynamic data. <code>  string myString = ""abcdxxx""; ",Remove the last three characters from a string
Remove last 3 characters from string," I want to remove last three characters from a string: Note that the string is dynamic data. <code>  string myString = ""abcdxxx""; ",Remove the last three characters from a string
Do Object Initializers make the Test Data Builder pattern obsolete?," I've been reading a bunch of blog posts espousing the virtues of the Test Data Builder Pattern. It seems like a good idea, but all of the posts are years old. When C# introduced Object Initializes, did it make the Test Data Builder pattern obsolete?Before Object Initializers, you would have needed the following code to initialize a person object: At the time, having a builder would have cleaned up the code like this: Now with object initializers, it can look like this without writing any builder methods: In this simple example, it would seem that the builder pattern is not needed. Am I missing something? Do people still use the builder pattern? If so, what are the benefits? <code>  Person p = new Person(""John"", ""Doe"", ""555-555-1234""); Person person = new PersonBuilder() .WithFirstName(""John"") .WithLastName(""Doe"") .WithPhoneNumber(""555-555-1234""); Person p = new Person() {FirstName=""John"", LastName=""Doe"", Phone=""555-555-1234""};",What are the benefits of the Test Data Builder pattern over Object Initializers?
How can I log without polluting method in C#?," I know about AOP and Postsharp but here the constraint is I can't use postsharp and using attributes for logging is having performance overhead. But again right now I have to put log code in everymethod, a lot of copy paste and also it is not part of method. So, my functions are doing more than one work. It is somewhat not looks good to have business logic and log together. Is there anyway out, like to make class open ended and can add log from out side of the class or function. Or I just have to go with traditional way of logging. Please, let me know if any further information needed. Any suggestion of good/ another way of logging is also welcomed.  <code> ",How can I log without polluting method?
Linq to Entities join vs groupjoin, Can someone please explain what a GroupJoin() is?How is it different from a regular Join()?Is it commonly used?Is it only for method syntax? What about query syntax? (A c# code example would be nice) <code> ,Linq-to-Entities Join vs GroupJoin
C# Method overloading and generic inerface," I'm confused by a problem we have in our project. I tried to simplify it to reproduce the effect: To me this looks fine, but the compiler complains on the last call, because it tries to DoTheFoo<T>(T bar), instead of DoTheFoo<T>(IFoo<T> foo) and complains that the argument type does not fit.When I remove the method DoTheFoo<T>(T bar), the last call works!When I change it to DoTheFoo<T>(Foo<T> foo), it works, but I can't use thatIt is not too hard to work around this in our current code. But it is a) strange and b) too bad that we can't have these two overloaded methods.Is there a common rule that explains this behaviour? Is it possible to make it work (except of giving the methods different names)? <code>  interface IBar { }class Bar : IBar {}interface IFoo<T> where T : IBar { }class Foo<T> : IFoo<T> where T : IBar { }class Class1{ public void DoTheFoo<T>(T bar) where T : IBar {} public void DoTheFoo<T>(IFoo<T> foo) where T : IBar {} public void Test() { var bar = new Bar(); var foo = new Foo<Bar>(); DoTheFoo(bar); // works DoTheFoo<Bar>(foo); // works DoTheFoo((IFoo<Bar>)foo); // works DoTheFoo(foo); // complains }}",C# Method overloading and generic interface
Download animated GIF http c#," I'm using the below to grab an animated gif off the web. However, upon saving this to disk, I lose the frames in the gif, and it no longer animates. Not sure whether the problem is in the below method, or whether it's when I'm saving it, but any feedback on why the below wouldn't work appreciated. The method is working - just not creating a proper animated gif file. <code>  public Image getImage(String url){ HttpWebRequest httpWebRequest = (HttpWebRequest)HttpWebRequest.Create(url); HttpWebResponse httpWebReponse = (HttpWebResponse)httpWebRequest.GetResponse(); Stream stream = httpWebReponse.GetResponseStream(); return Image.FromStream(stream, true, true);}Image im = getImage(url)im.Save(pth,ImageFormat.Gif);",Download animated GIF
Can i prevent expiration of session in Session_End?," A website I am working on is very data centric. Some reports take more than an hour to complete. Whenever a user submits a request for a report, a new thread is created which generates the report. The user is then redirected to a page which says that the report in progress, and to please refresh to download the report. If the user again refreshes the page and the report is still in progress, the same message is shown; otherwise a download link is provided.All report/user relations are saved in the application variable. That works fine, except when the user is inactive for more than 20 min (while the report is being processed), and then the user is logged out; if the user logs in again, the report can still be downloaded.I do not want to increase the session expiration time, but I need to stop the expiration if the user has something going in background, like a report being processed.In Session_End I am able to retrieve the the userid and match it in Application[""work""] to see the user has pending work or not.However, I am clueless as to how I can defer the session end in the above case?Edit: Every one has suggested as a workaround from 'maintaining a contact' to 'using query string'. 'Maintaining the contact' looked the most promising to me but it fails in the following scenarios: a. When browser is closed/computed goes in standby mode during lunch, etc. b. When user goes to another non-asp.net section (it's a legacy site).Isn't It possible to cancel the Session_End event itself? <code> ",Prevent expiration of individual sessions based on custom conditions?
Can I prevent expiration of session in Session_End?," A website I am working on is very data centric. Some reports take more than an hour to complete. Whenever a user submits a request for a report, a new thread is created which generates the report. The user is then redirected to a page which says that the report in progress, and to please refresh to download the report. If the user again refreshes the page and the report is still in progress, the same message is shown; otherwise a download link is provided.All report/user relations are saved in the application variable. That works fine, except when the user is inactive for more than 20 min (while the report is being processed), and then the user is logged out; if the user logs in again, the report can still be downloaded.I do not want to increase the session expiration time, but I need to stop the expiration if the user has something going in background, like a report being processed.In Session_End I am able to retrieve the the userid and match it in Application[""work""] to see the user has pending work or not.However, I am clueless as to how I can defer the session end in the above case?Edit: Every one has suggested as a workaround from 'maintaining a contact' to 'using query string'. 'Maintaining the contact' looked the most promising to me but it fails in the following scenarios: a. When browser is closed/computed goes in standby mode during lunch, etc. b. When user goes to another non-asp.net section (it's a legacy site).Isn't It possible to cancel the Session_End event itself? <code> ",Prevent expiration of individual sessions based on custom conditions?
Resize image uielement in WPF," i have a image and i want to re size it and need to save in my temp folder. what i have tried is as below : but when i create image like this it saves part of the image in temp folder. (as shown in the above pic)how can i re size full image? what i missed here?EDIT :As mentioned in the above answer as mentioned by Erti-Chris Eelmaa i have changed the code as below. and it works......  <code>  UIElement uie = CanvasHost.Child;int width = 800;int height = (int)((width / (double)((FrameworkElement)uie).Width) * (int)((FrameworkElement)uie).Height); RenderTargetBitmap rtb = new RenderTargetBitmap(width, height, 96, 96, PixelFormats.Pbgra32);rtb.Render(uie);string dir = Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) + @""\temp\"";if (!Directory.Exists(dir)) Directory.CreateDirectory(dir);long size = 0;string filePath = dir + DateTime.Now.Ticks.ToString() + (isPng ? "".png"" : "".jpg"");BitmapEncoder enc = null;using (FileStream fs = File.Create(filePath)){ if (isPng) enc = new PngBitmapEncoder(); else enc = new JpegBitmapEncoder(); enc.Frames.Add(BitmapFrame.Create(rtb)); enc.Save(fs); size = fs.Length;} UIElement uie = CanvasHost.Child;int width = DataCache.Instance.CurrentProject.MaxPhotoEdgeSize;int height = (int)((width / (double)((FrameworkElement)uie).Width) * (int)((FrameworkElement)uie).Height);RenderTargetBitmap rtb = new RenderTargetBitmap((int)((FrameworkElement)uie).Width, (int)((FrameworkElement)uie).Height, 96, 96, PixelFormats.Pbgra32);rtb.Render(uie);ImageSource im = (ImageSource)rtb.Clone();BitmapFrame bp = CreateResizedImage(im, width, height, 1); //method suggested by Erti-Chris Eelmaastring dir = Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) + @""\temp\"";if (!Directory.Exists(dir)) Directory.CreateDirectory(dir);long size = 0;string filePath = dir + DateTime.Now.Ticks.ToString() + (isPng ? "".png"" : "".jpg"");BitmapEncoder enc = null;using (FileStream fs = File.Create(filePath)){ if (isPng) enc = new PngBitmapEncoder(); else enc = new JpegBitmapEncoder(); enc.Frames.Add(BitmapFrame.Create(bp)); enc.Save(fs); size = fs.Length;}",Resize image in WPF
C#: expose a referenced type (class) without need for additional reference," I have a layered system of .dlls between my application, where the lowest level has a class that provides certain functionality - an instance of this class can be received through a GetClass() function and then I can access its properties (basically, a collection of information of changing objects).Now I noticed that when I want to access that information from the next higher level .dll, the compiler complains that I do not have the lower level .dll referenced (the one defining the class) - which actually I would want to avoid, to have a nice layered structure in my architecture.How to get around this? Can I re-expose the referenced type? Do I really have to write a wrapper of my own, if I want exactly the same functionality? Or do I even need to reference the low level .dll again?DLL 1: DLL 2: EXE:How to access result from calling GetMyClass (DLL 2) without referencing DLL 1? <code>  class myClass;myClass GetMyClass(); myClass GetMyClass();",expose a referenced type (class) without need for additional reference
C# relationship between configuration in app.config or web.config and code in WCF," How does a service host in WCF interact with the configuration from the web.config or app.config. When I create a service host I only specify an url in the service host constructor and the class of the service.But in the app.config or web.config I have another list of endpoints, each with it's own specific url. So how does wcf handle this situation? Which endpoint does it take from the app.config or web.config?  <code> ",relationship between configuration in app.config or web.config and code in WCF
Global.asax - Application_Error - can i get Page data?," I have this code: This is (most of) my code.In a small percentage of cases, I don't get enough information though. I don't know what page the exception originated from. How can I get any kind of information related to the page that the exception originated from?Below is an example of the shortest message: Invalid length for a Base-64 char array. at System.Convert.FromBase64String(String s) at System.Web.UI.ObjectStateFormatter.Deserialize(String inputString) at System.Web.UI.ObjectStateFormatter.System.Web.UI.IStateFormatter.Deserialize(String serializedState) at System.Web.UI.Util.DeserializeWithAssert(IStateFormatter formatter, String serializedState) at System.Web.UI.HiddenFieldPageStatePersister.Load() <code>  using System.Configuration;void Application_Error(object sender, EventArgs e){ Exception ex = Server.GetLastError().GetBaseException(); string ErrorMessage = ex.Message; string StackTrace = ex.StackTrace; string ExceptionType = ex.GetType().FullName; string UserId = Getloggedinuser(); string WebErrorSendEmail = ConfigurationManager.AppSettings[""WebErrorSendEmail""]; // save the exception in DB LogStuffInDbAndSendEmailFromDb();}",Global.asax - Application_Error - How can I get Page data?
Why are Java/C# Generics limited in comparision to C++ Generics?, I read an interesting Article/Thread/Discussion from here and i got following questions:What are the limitations of Java/C# generics?What is possible with C++ Templates that is impossible with Java/C# generics?Edit 1 More recommended questions by Eric LippertWhat are some patterns that are possible with C# generics but impossible with C++ templates?What's the difference between C#'s true generic types and Java's type erasure generic types? <code> ,What are the Differences between C++ Templates and Java/C# Generics and what are the limits?
What are the Differences between C++ Generics and Java/C# Generics and what are the limits?, I read an interesting Article/Thread/Discussion from here and i got following questions:What are the limitations of Java/C# generics?What is possible with C++ Templates that is impossible with Java/C# generics?Edit 1 More recommended questions by Eric LippertWhat are some patterns that are possible with C# generics but impossible with C++ templates?What's the difference between C#'s true generic types and Java's type erasure generic types? <code> ,What are the Differences between C++ Templates and Java/C# Generics and what are the limits?
JSON.NET - how to deserialize collection of interface-instances?," I would like to serialize this code via json.net: I want to serialize/deserialize ClassToSerializeViaJson with json.net. Serialization is working, but deserialization gives me this error: Newtonsoft.Json.JsonSerializationException: Could not create an instance of type ITestInterface. Type is an interface or abstract class and cannot be instantiated.So how can I deserialize the List<ITestInterface> collection? <code>  public interface ITestInterface{ string Guid {get;set;}}public class TestClassThatImplementsTestInterface1{ public string Guid { get;set; }}public class TestClassThatImplementsTestInterface2{ public string Guid { get;set; }}public class ClassToSerializeViaJson{ public ClassToSerializeViaJson() { this.CollectionToSerialize = new List<ITestInterface>(); this.CollectionToSerialize.add( new TestClassThatImplementsTestInterface2() ); this.CollectionToSerialize.add( new TestClassThatImplementsTestInterface2() ); } List<ITestInterface> CollectionToSerialize { get;set; }}",Deserialize collection of interface-instances?
What means symbo <> in MSIL?, I have this code after decompile I don't know what mean operator/symbol <> before some operations. Does somebody know? <code>  SampleClass sampleClass; SampleClass <>g__initLocal0; int y; sampleClass = null;Label_0018: try { <>g__initLocal0 = new SampleClass(); <>g__initLocal0.X = 5; <>g__initLocal0.Y = 10; sampleClass = <>g__initLocal0; goto Label_003A; } catch (Exception) { Label_0035: goto Label_003A; }Label_003A: y = sampleClass.Y;,What does the symbol <> mean in MSIL?
What means symbol <> in MSIL?, I have this code after decompile I don't know what mean operator/symbol <> before some operations. Does somebody know? <code>  SampleClass sampleClass; SampleClass <>g__initLocal0; int y; sampleClass = null;Label_0018: try { <>g__initLocal0 = new SampleClass(); <>g__initLocal0.X = 5; <>g__initLocal0.Y = 10; sampleClass = <>g__initLocal0; goto Label_003A; } catch (Exception) { Label_0035: goto Label_003A; }Label_003A: y = sampleClass.Y;,What does the symbol <> mean in MSIL?
Moq Setup causing Visual Studio Internal Compiler Error," I was trying to mock an interface which takes a DateTimeOffset? as one of its parameters. All of a sudden, Visual Studio started reporting an 'Internal Compiler Error' and that it has 'stopped working'. After a lot of trials, I started removing files one by one, and then code line by line. This reduced to the below code, which reproduces this error: The issue seems to be the line : If I comment it, the compiler works fine. Also, the issues is that I am setting up a new DateTime(), which fits in a DateTimeOffset.Is this a bug in Moq, or VS2012? Anyone ever got this error before?UPDATEThe following code sample also results in a compile error, both with the regular Visual Studio 2012 compiler and with Roslyn CTP September 2012: The error: 1>CSC : error CS0583: Internal Compiler Error (0xc0000005 at address 00D77AFB): likely culprit is 'BIND'.This code has nothing to do with Moq.  <code>  public class testClass{ public interface ITest { void Test(DateTimeOffset? date); } public void test2() { var mock = new Mock<ITest>(); mock.Setup(x => x.Test(new DateTime(2012, 1, 1))); }} mock.Setup(x => x.Test(new DateTime(2012, 1, 1))); using System;using System.Linq.Expressions;public interface ITest{ void Test(DateTimeOffset? date);}public class TestClass{ Expression<Action<ITest>> t = x => x.Test(new DateTime(2012, 1, 1));}",Expression that takes a DateTimeOffset causes Visual Studio Internal Compiler Error
Find MethodInfo for method of generic class using strongly-typed reflection (with Linq)," I'd like to get a MethodInfo of a method from a generic class having a type parameter known only at runtime.Here is how I would get a MethodInfo for a generic method from a non-generic class: Now if I want to try something similar with a generic class: Is it possible? <code>  class MyClass{ public void MyMethod<T> (T arg) { }}static MethodInfo Resolve (Type type){ Expression<Action<MyClass, object>> lambda = (c, a) => c.MyMethod (a); MethodCallExpression call = lambda.Body as MethodCallExpression; return call .Method // Get MethodInfo for MyClass.MyMethod<object> .GetGenericMethodDefinition () // Get MethodInfo for MyClass.MyMethod<> .MakeGenericMethod (type); // Get MethodInfo for MyClass.MyMethod<int>}Resolve (typeof (int)).Invoke (new MyClass (), new object[] {3}); class MyClass<T>{ public void MyMethod (T arg) { }}static MethodInfo Resolve (Type type){ Expression<Action<MyClass<object>, object>> lambda = (c, a) => c.MyMethod (a); MethodCallExpression call = lambda.Body as MethodCallExpression; return call .Method // Get MethodInfo for MyClass<object>.MyMethod .SomeMagicMethod (); // FIXME: how can I get a MethodInfo // for MyClass<T>.MyMethod where typeof (T) == type?}Resolve (typeof (string)).Invoke (new MyClass<string> (), new object[] {""Hello, World!""});",How to find MethodInfo for a method of a generic class using strongly-typed reflection?
Generate random number between 0 and 1 with guassian distributes," I want to write a method in C# to generate a random number with gaussian distributes in range [0:1] ( and in advance in [0-x] ) .I found this code but not work correctly <code>  Random rand = new Random(); //reuse this if you are generating manydouble u1 = rand.NextDouble(); //these are uniform(0,1) random doublesdouble u2 = rand.NextDouble();double randStdNormal = Math.Abs( Math.Sqrt(-2.0 * Math.Log(u1)) * Math.Sin(2.0 * Math.PI * u2));",Generate random number between 0 and 1 with gaussian distributes
"C#: How to convert byte[] to String with no encoding, no loss of data"," I have an array of bytes. The 8-bit value of each byte is what I want as the characters in my String. You can think of my 8-bit values as ASCII, ANSI, UTF-8, ISO-8859-1, daily temperature readings, distance in inches from a point on a line, or whatever you want. It's irrelevant.When I'm done. the char at position N in my String should have the same value as the byte at position N. That is, the high-order 8 bits should be 0 and the low order 8 bits should be the same as the source byte.What Encoding do I use that simply maps bytes to chars with no change? <code> ","How to convert byte[] to String with no encoding, no loss of data"
Any way to set breakpoints in MVC3 ASPX views?," I recall in Scott Gu's Razor announcement mention of full debugger support for Razor views; and I have appreciated being able to set breakpoints in Razor views, also bumped into not being able to set a breakpoint in a view, only to realize quickly that it is an ASPX view. :PSometimes I cannot help/change that an existing view uses the ASPX view engine, though: is there a way I've yet to learn to set breakpoints in an ASPX view? If not, what is the next best thing? Is there a better workaround than Debugger.Break() and reverting after debugging? <code> ",Setting Breakpoints in MVC ASPX Views
How can I pass a username/password in the header to a SOAP WCF C#," I'm trying to consume a third-party web servicehttps://staging.identitymanagement.lexisnexis.com/identity-proofing/services/identityProofingServiceWS/v2?wsdlI already added it as a service reference but I'm not sure how to pass the credentials for the header.How can I make the header request match this format? <code>  <soapenv:Header> <wsse:Security soapenv:mustUnderstand=""1"" xmlns:wsse=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd""> <wsse:UsernameToken wsu:Id=""UsernameToken-49"" xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd""> <wsse:Username>12345/userID</wsse:Username> <wsse:Password Type=""http://docs.oasis-open.org/wss/2004/01/ oasis-200401-wss-username-token-profile-1.0#PasswordText"">password123</wsse:Password> <wsse:Nonce EncodingType=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary"">d+VxCZX1cH/ieMkKEr/ofA==</wsse:Nonce> <wsu:Created>2012-08-04T20:25:04.038Z</wsu:Created> </wsse:UsernameToken> </wsse:Security></soapenv:Header>",How can I pass a username/password in the header to a SOAP WCF Service
Passing IEnumerable parameter to method," I'm playing around with a very simple program to take an array of doubles and return the standard deviation. This part worked but I wanted to make the code more reusable. I would like to make it so the method can accept a parameter of any type that could be considered numeric and return the standard deviation instead of hardcoding a double type (like I initially did in this program). How does one go about this and what is the proper term for it? <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text; namespace ConsoleApplication5 { class Program { static void Main(string[] args) { double[] avg = { 3.4, 55.6, 10.0, 4.5, 2, 2 }; double x = avg.Average(); //first round of testing Console.WriteLine(""The average of the first array is below ""); Console.WriteLine(x); Console.WriteLine(""below should be the standard deviation!""); Console.WriteLine(CalculateStandardDeviation(avg)); Console.ReadLine(); int[] intAvg = { 4, 3, 5, 6, 2 }; double secondAvg = intAvg.Average(); Console.WriteLine(""The average of the second array is below ""); Console.WriteLine(secondAvg); //this is where the error is happening //CalculateStandardDeviation(secondAvg); } //this is where I tried to make the query more reusable public static double CalculateStandardDeviation(IEnumerable<double> values) { double avg = values.Average(); double sum = 0; foreach (double d in values) { sum += Math.Pow((d - avg), 2); } return Math.Pow(sum / (values.Count() - 1),.5); } } }",Passing an IEnumerable of Numeric Values as a parameter to method
Enable Password Char in TextBox except last N character," How to enable Password Char in TextBox except last N character?I already tried this method But it is so hard to manipulate, I will pass original card value in every event like Keypress,TextChange and etc..Is there I way that is more simple and easy to managed? <code>  cardnumber.Select((c, i) => i < cardnumber.Length - 4 ? 'X' : c).ToArray()",Enable Password Char in TextBox except last N character / Limit Masked Char
How to prevent calling virtual function in constructor?," Most (if not all) my Entity Framework POCOs have virtual functions. I need these functions to be virtual so that the entities can be lazy-loaded.If I initialize Accommodations in constructor then I will be calling a virtual function in constructor, which is bad practice.But how can I initialize Accommodations if not in the constructor? <code>  public class Venue{ public Venue() { Accommodations = new HashSet<Accommodation>(); } public virtual ICollection<Accommodation> Accommodations { get; set; }}",How to avoid calling virtual function in constructor?
Can't access build configuration manager or build configurations in Visual Studio 2010," Full StoryTypically, when I install Visual C# 2010 Express, the first thing that I do is switch to Expert Settings. That gives me access to build configurations, and the respective manager. This most recent installation seems to be misbehaving.The first project that I created was an XNA 4.0 (Refresh) project. I imported some old code, switched to Expert Settings, and confirmed that I was able to access both the build configuration manager and the build configuration toolbar. However, when I opened the project properties and switched to the Build tab, the normal Configuration and Platform dropdowns were nowhere to be found. Additionally, the Release settings were clearly in use, even though Debug was selected as active in the toolbar/manager.I tried everything from restarting Visual Studio to manually editing the .csproj XML--which, by the way, marked Debug as the active configuration: not Release. Interestingly, no matter what the order of the build configurations, if Release was present, that would be the configuration actually active in project properties (not selected from the dropdown in the toolbar). Remember, the dropdowns that usually appear on the project properties pages aren't present, for some reason.Having no luck, I created two fresh projects in a separate solution: a console application and a WinForms application. This time, the build configuration manager wasn't even present in the Build menu, and the dropdowns in the toolbar were disabled, as if I didn't even have a solution open.I've searched and searched, but I cannot find an explanation--or a solution--for this behavior.Note: I do have access to Visual Studio 2010 through MSDN, so upgrading is a viable solution, if necessary. tl;drYes, I've switched to Expert Settings.Windows 8 Pro, up-to-dateFresh-ish Visual C# 2010 Express installationXNA 4.0 RefreshProblemsNew XNA project:Switching build configurations has no effect on actual configuration; it is always stuck on Release, despite saying otherwise.In project properties -> Build, dropdowns for build configuration/platform aren't present.New console/WinForms project:Build Configuration Manager isn't in Build menu.Build configuration toolbar has dropdowns disabled, and nothing is selected.Already AttemptedDelete Release configurationEffect: Switches to DebugRecreate Release configurationEffect: Switches to Debug upon deletion, then back to Release upon recreationFiddle with .csproj XML in text editorEffect: None; looked fine to begin withRecreate all configurationsEffect: Always lands on ReleaseRestart Visual C# Express 2010Effect: NoneFiddle with settingsEffect: NoneReload projectEffect: None <code> ",Can't access build configuration manager or build configurations in Visual C# 2010 Express
Extensions Method - try to call protected methods / wrong exhibition of dynamic parameters," I have a class named NIFERepository. It contains a SaveObject method, which returns nothing and performs an operation on a database. 1 . I wish to create a public extension method who calls this SaveObject() method, like this: But the protected scope doesn't allow my extensions method to recognize it.Is there a way for me to get a method of this form to work?2 . I created my extension method with 2 types: T and E. T is the instance who called it, and E is the defined type into my ProductRepository<Product>, for example. When I call this method, the defined type is not shown.Is there a way for me to get this to work? <code>  public class NIFERepository<E>{ protected void SaveObject(object saveObject) { if (saveObject is E) this.RepositorySession.Merge(saveObject); }} public static class NIFERepositoryExtensions { public static T Save<T, E>(this T self, E saveObject) where T : NIFERepository<E> { self.SaveObject(saveObject); return self; } } ",Extensions Method trying to call protected methods / wrong exhibition of dynamic parameters
SOLVED - Extensions Method - try to call protected methods / wrong exhibition of dynamic parameters," I have a class named NIFERepository. It contains a SaveObject method, which returns nothing and performs an operation on a database. 1 . I wish to create a public extension method who calls this SaveObject() method, like this: But the protected scope doesn't allow my extensions method to recognize it.Is there a way for me to get a method of this form to work?2 . I created my extension method with 2 types: T and E. T is the instance who called it, and E is the defined type into my ProductRepository<Product>, for example. When I call this method, the defined type is not shown.Is there a way for me to get this to work? <code>  public class NIFERepository<E>{ protected void SaveObject(object saveObject) { if (saveObject is E) this.RepositorySession.Merge(saveObject); }} public static class NIFERepositoryExtensions { public static T Save<T, E>(this T self, E saveObject) where T : NIFERepository<E> { self.SaveObject(saveObject); return self; } } ",Extensions Method trying to call protected methods / wrong exhibition of dynamic parameters
Performance hit by using Caller Information attributes," I am trying to find ways to log method name in an efficient manner w.r.t. speed and maintainability. I guess, In .NET 4.5 Caller Information attributes are exposed just for this purpose except the speed part. I feel these are just syntactic sugars from using System.Reflection.MethodBase.GetCurrentMethod() or stackTrace.GetFrame(1).GetMethod().Name (Got from here). (or) Are these methods give performance benefits too?In C#, Is there a way to get method name at compile time (as like in C++)? <code> ",Is performance hit by using Caller Information attributes?
EF Just get count of lazy list," I'm having a bit of performance problem with an EF query.We basically have this: Now, I would like to do: The problem is that, from what I can gather, this first causes the entire list being fetched, and then the count of it. When doing this in a loop this creates a performance problem.I assumed that it was due to the object being ""too concrete"", so I've tried to move the Visits.Count call as far back in repository as I can (so that we're sort of working directly with the DbContext). That didn't help.Any suggestions? <code>  public class Article{ public int ID { get; set; } public virtual List<Visit> Visits { get; set; }}public class Visit{ public int? ArticleID { get; set; } public DateTime Date { get; set; }} Article a = ...;vm.Count = a.Visits.Count;",How to get count of lazy list in most efficient way?
hiw to Drag and Drop(copy) from panel 1 to panel 2 in c#," I have two panels on a form.One panel has some controls like buttons or images and second panel is empty. I want to drag a control from panel 1 and drop it to panel 2, but it should create a copy of control, and while dragging a rectangle should be shown of same size as control and when dropped in panel 2 the dragged shape should appear there at mouse positionActually I want to create a simulator like thing. That has some tools in panel 1 and when someone drag and drop a tool on panel 2 it should appear there at mouse position.Language doesn't matter may be C# or VB.NET <code> ",How to Drag and Drop(copy) from one panel to another panel
defining ConnectionString in asp Sqldatasource," I have my database connectivity which I define under <appSettings> in web.comfig: But the problem is that I am unable to access it from my aspx page as I am trying like this In place of <connectionStrings> I want to define it in <appSettings> Plesae tell the correct syntax. <code>  <appSettings> <add key=""ConnStr"" value=""Data Source=dsk-159\SQLEXPRESS;Initial Catalog=master;Integrated Security=True""/></appSettings> <asp:SqlDataSource ID=""SqlDataSource2"" runat=""server"" ConnectionString=""<%$ ConnectionStrings:goldsConnectionString %>"" SelectCommand=""SELECT distinct TechnologyId , [TechnologyName], [ChildId] FROM [TreeTable] where childid is null AND technologyid in(@hid1)""> <SelectParameters> <asp:ControlParameter ControlID=""hid1"" Name=""hid1"" DefaultValue=""23"" /> </SelectParameters>",Defining ConnectionString in asp SqlDataSource
Defining ConnectionString in asp Sqldatasource," I have my database connectivity which I define under <appSettings> in web.comfig: But the problem is that I am unable to access it from my aspx page as I am trying like this In place of <connectionStrings> I want to define it in <appSettings> Plesae tell the correct syntax. <code>  <appSettings> <add key=""ConnStr"" value=""Data Source=dsk-159\SQLEXPRESS;Initial Catalog=master;Integrated Security=True""/></appSettings> <asp:SqlDataSource ID=""SqlDataSource2"" runat=""server"" ConnectionString=""<%$ ConnectionStrings:goldsConnectionString %>"" SelectCommand=""SELECT distinct TechnologyId , [TechnologyName], [ChildId] FROM [TreeTable] where childid is null AND technologyid in(@hid1)""> <SelectParameters> <asp:ControlParameter ControlID=""hid1"" Name=""hid1"" DefaultValue=""23"" /> </SelectParameters>",Defining ConnectionString in asp SqlDataSource
"Why Can't I use File.Exist, Who can i check if a file exists?"," I am trying to see if a file exists before using it in an MVC controller: The File keyword is underlined in red, and the compiler shows an error: System.Web.MVC.Controller.File(string, string, string) is a 'method', witch is not valid in the given context.How can I use File.Exists() in a controller? <code>  string path = ""content/image.jpg"";if (File.Exists(path)){ //Other code}",Why can't I use System.IO.File methods in an MVC controller?
"Why Can't I use File.Exist, how can i check if a file exists?"," I am trying to see if a file exists before using it in an MVC controller: The File keyword is underlined in red, and the compiler shows an error: System.Web.MVC.Controller.File(string, string, string) is a 'method', witch is not valid in the given context.How can I use File.Exists() in a controller? <code>  string path = ""content/image.jpg"";if (File.Exists(path)){ //Other code}",Why can't I use System.IO.File methods in an MVC controller?
How to create a BitmapImage from a pixel byte array," I need to display live images on a WPF control. I'm looking for the fastest way to do this using WPF.I'm capturing images from a camera using its dll API (AVT).The image is writen by the dll and the camera rises a callback with an IntPtr to a Image struct called tFrame (described below). The pixel data is stored at the ImageBuffer propertie with is an InPtr to a byte array.I know how to create a Bitmap from the pixel byte array, but not a BitmapImage. So it is possible to create a Bitmap and then create a BitmapImagem from it.Here there is a way to create a BitmapImage from a Bitmap on the memory. But I want to create the BitmapImage directly from the data source (tFrame). How can I do that?I know that BitmapImage have a CopyPixels method, but it laks of a SetPixels. Here is how I create a Bitmap from a pixel byte array. This was used at the WinForm version of the software. EDIT 1:Thanks to dr.mo, now I'm able to display 60 FPS 1024x1024 images with ~3% CPU usage!What I'm doing is: <code>  public struct tFrame{ public IntPtr AncillaryBuffer; public uint AncillaryBufferSize; public uint AncillarySize; public tBayerPattern BayerPattern; public uint BitDepth; public tFrameCtx Context; public tImageFormat Format; public uint FrameCount; public uint Height; public IntPtr ImageBuffer; public uint ImageBufferSize; public uint ImageSize; public uint RegionX; public uint RegionY; public tErr Status; public uint TimestampHi; public uint TimestampLo; public uint Width;} private void CreateBitmap(tFrame frame){ //This sample is for a 8bpp captured image PixelFormat pxFormat = PixelFormat.Format8bppIndexed; //STRIDE //[https://stackoverflow.com/questions/1983781/why-does-bitmapsource-create-throw-an-argumentexception/1983886#1983886][3] //float bitsPerPixel = System.Drawing.Image.GetPixelFormatSize(format); int bitsPerPixel = ((int)pxFormat >> 8) & 0xFF; //Number of bits used to store the image data per line (only the valid data) int validBitsPerLine = ((int)frame.Width) * bitsPerPixel; //4 bytes for every int32 (32 bits) int stride = ((validBitsPerLine + 31) / 32) * 4; Bitmap bmp = new Bitmap((int)frame.Width, (int)frame.Height, stride, pxFormat, frame.ImageBuffer);} //@ UI Threadpublic WriteableBitmap wbm = new WriteableBitmap(1024, 1024, (double)96, (double)96, System.Windows.Media.PixelFormats.Gray8, null);this.wbBackBuffer = this.wbm.BackBuffer;//This can be called by a timer in the UI thread or at the grab Thread for every image, the CPU usage is almost the same.void UpdateDisplayImage(){wbm.Lock();wbm.AddDirtyRect(new Int32Rect(0, 0, wbm.PixelWidth, wbm.PixelHeight));wbm.Unlock();}//@ Grab Thread//Update the backbuffer with new camera image data.UpdateBackBuffer(...);/// <summary>/// [http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.writeablebitmap.aspx]/// </summary>public void UpdateBackBuffer(IntPtr pData, int w, int h, int ch){ //Can not acess wbm from outside UI thread //CopyMemory(wbm.BackBuffer, pData, (uint)(w * h * ch)); //I dont know if it is safe to write to it buffer like this: CopyMemory(this.wbBackBuffer, pData, (uint)(w * h * ch));}",How to create a BitmapImage from a pixel byte array (live video display)
How to make method call another one in classes C#?, Now I have two classes allmethods.cs and caller.cs.I have some methods in class allmethods.cs. I want to write code in caller.cs in order to call a certain method in the allmethods class.Example on code: How can I achieve that? <code>  public class allmethodspublic static void Method1(){ // Method1}public static void Method2(){ // Method2}class caller{ public static void Main(string[] args) { // I want to write a code here to call Method2 for example from allmethods Class }},How to make method call another one in classes?
WCF service returning 404 on method reqests," I have a WCF service page running only WebGets/WebInvokes over SSL - it works fine on my local machine (self signed cert). On production, however, I can reach service.svc (and it gives me the message about how to consume) but service.svc/AnyRequest returns a 404. Both environments are hosted in IIS 7.5.I've enabled tracing and the service isn't even picking up any of the method requests (e.g. service.svc/SomeRequest), however it is processing service.svc just fine. It's also listening at https://computername.domain.net/path/service.svc - is this normal? Should it normally be pointing to https://publicfacing.com/path/service.svc?Also note that the production server is hosting multiple sites within IIS.Below is the system.serviceModel section of my web.config. The SSLBehave was suggested from here. <code>  <system.serviceModel> <bindings> <webHttpBinding> <binding name=""TransportSecurity""> <security mode=""Transport""> <transport clientCredentialType=""None""></transport> </security> </binding> </webHttpBinding> </bindings> <behaviors> <serviceBehaviors> <behavior name=""SSLBehave""> <useRequestHeadersForMetadataAddress> <defaultPorts> <add scheme=""https"" port=""443""/> </defaultPorts> </useRequestHeadersForMetadataAddress> </behavior> </serviceBehaviors> <endpointBehaviors> <behavior name=""UserManagement.ajaxAspNetAjaxBehavior""> <webHttp defaultOutgoingResponseFormat=""Json"" defaultBodyStyle=""Wrapped"" /> </behavior> </endpointBehaviors> </behaviors> <serviceHostingEnvironment aspNetCompatibilityEnabled=""true"" multipleSiteBindingsEnabled=""true"" /> <services> <service name=""UserManagement.ajax"" behaviorConfiguration=""SSLBehave""> <endpoint address="""" behaviorConfiguration=""UserManagement.ajaxAspNetAjaxBehavior"" binding=""webHttpBinding"" bindingConfiguration=""TransportSecurity"" contract=""UserManagement.ajax"" /> </service> </services> </system.serviceModel>",WCF service returning 404 on method requests
Wpf Datagrid Add new row," I have managed to get DataGrid to show new row for adding new item.Problem i face now is i want data in the rest of wpf DataGrid to be read only and only new row should be editable.Currently this is how my DataGrid looks. But since I have kept the columns read only, a new row also adds as read only which is what I don't want. <code>  <DataGrid AutoGenerateColumns=""False"" Name=""DataGridTest"" CanUserAddRows=""True"" Grid.Row=""2"" ItemsSource=""{Binding TestBinding}"" > <DataGrid.Columns> <DataGridTextColumn Header=""Line"" IsReadOnly=""True"" Binding=""{Binding Path=Test1}"" Width=""50""></DataGridTextColumn> <DataGridTextColumn Header=""Account"" IsReadOnly=""True"" Binding=""{Binding Path=Test2}"" Width=""130""></DataGridTextColumn> </DataGrid.Columns></DataGrid>",I want data in the rest of wpf DataGrid to be read only and only new row should be editable
Wpf DataGrid Add new row," I have managed to get DataGrid to show new row for adding new item.Problem i face now is i want data in the rest of wpf DataGrid to be read only and only new row should be editable.Currently this is how my DataGrid looks. But since I have kept the columns read only, a new row also adds as read only which is what I don't want. <code>  <DataGrid AutoGenerateColumns=""False"" Name=""DataGridTest"" CanUserAddRows=""True"" Grid.Row=""2"" ItemsSource=""{Binding TestBinding}"" > <DataGrid.Columns> <DataGridTextColumn Header=""Line"" IsReadOnly=""True"" Binding=""{Binding Path=Test1}"" Width=""50""></DataGridTextColumn> <DataGridTextColumn Header=""Account"" IsReadOnly=""True"" Binding=""{Binding Path=Test2}"" Width=""130""></DataGridTextColumn> </DataGrid.Columns></DataGrid>",I want data in the rest of wpf DataGrid to be read only and only new row should be editable
Parallel.For C# Stop vs Brake," I have difficulty to understand loopState.Stop() and loopState.Break(). I have read MSDN and several posts about it but I am still confused.What I understand is that every iteration partitioner gives remaining indexes for threads to process and loopState.Stop() stops all threads and loopState.Break() stops the current thread.However lets consider the following situation: For this loop I have following result: I have no idea why in the result there is 10 and 25 numbers.Anyone can help? P.S. I have i5 520M CPU (2 cores => 4 Threads) <code>  Parallel.For(0, 100, (i, loopState) =>{ if (i >= 10) loopState.Break(); Debug.Write(i);}); 0 25 1 2 3 4 5 6 7 8 9 10 ",Stop vs Break in Parallel.For
Stop vs Brake in Parallel.For," I have difficulty to understand loopState.Stop() and loopState.Break(). I have read MSDN and several posts about it but I am still confused.What I understand is that every iteration partitioner gives remaining indexes for threads to process and loopState.Stop() stops all threads and loopState.Break() stops the current thread.However lets consider the following situation: For this loop I have following result: I have no idea why in the result there is 10 and 25 numbers.Anyone can help? P.S. I have i5 520M CPU (2 cores => 4 Threads) <code>  Parallel.For(0, 100, (i, loopState) =>{ if (i >= 10) loopState.Break(); Debug.Write(i);}); 0 25 1 2 3 4 5 6 7 8 9 10 ",Stop vs Break in Parallel.For
work with array in object arrey," How can i work with Array in Object ArrayPlease see picture for more info :I use from forech for get Object and then i want to work with Array in Object but it's not possible I want to get value from array and work with them for example i want to get ""TestCategory_1"" or etc but i can't now how can i work with value like this ?Kind regards <code>  foreach (object element in result)",work with array in object array
How to copy both - html and text to the clipboard?," I'm trying to put in the clipboard piece of HTML and plain text at the same time, so that HTML-capable editors could paste HTML, and other editors could use plain text. But only the last format is actually put to the clipboard. In the sample above, clipboard would contain only plaintext (as shown by Clipboard.GetDataObject().GetFormats()). And if I swap the lines, the clipboard would have only the HTML format.How can I put both formats into the clipboard at the same time? <code>  Clipboard.SetData(DataFormats.Html, htmlWithHeader);Clipboard.SetData(DataFormats.UnicodeText, plainText);",How to copy both - HTML and text to the clipboard?
"IndexSearcher is thread safe, isn't?"," According to this or this, I used the same indexsearcher by multiple thread. But when I switched from FsDirectory to MMapDirectory, I got interesting exceptions.This work fine: But with this: I get various exceptions like: Or The last code work fine, with setting the concurrentTaskCount variable to 1.Am I missing something? I cant figure out what that is.Actually, I dont have the path d:\Lucene.Net\FullRepo\trunk\src\core\Store\BufferedIndexInput.csI don't even have a drive with letter ""d"" <code>  static void Main(string[] args) { DirectoryInfo directoryInfo = new DirectoryInfo(@""C:\Users\Tams\Desktop\new\""); var directory = FSDirectory.Open(directoryInfo); var indexSearcher = new IndexSearcher(directory); const int times = 100; const int concurrentTaskCount = 5; var task = new Task[concurrentTaskCount]; for (int i = 0; i < concurrentTaskCount; i++) { task[i] = new Task(() => Search(indexSearcher, times)); task[i].Start(); } Task.WaitAll(task);}static void Search(IndexSearcher reader, int times) { List<Document> docs = new List<Document>(10000); for (int i = 0; i < times; i++) { var q = new TermQuery(new Term(""title"", ""volume"")); foreach (var scoreDoc in reader.Search(q, 100).ScoreDocs) { docs.Add(reader.Doc(scoreDoc.Doc)); } }} static void Main(string[] args) { DirectoryInfo directoryInfo = new DirectoryInfo(@""C:\Users\Tams\Desktop\new\""); var directory = new MMapDirectory(directoryInfo); // CHANGED var indexSearcher = new IndexSearcher(directory); const int times = 100; const int concurrentTaskCount = 5; var task = new Task[concurrentTaskCount]; for (int i = 0; i < concurrentTaskCount; i++) { task[i] = new Task(() => Search(indexSearcher, times)); task[i].Start(); } Task.WaitAll(task);}static void Search(IndexSearcher reader, int times) { List<Document> docs = new List<Document>(10000); for (int i = 0; i < times; i++) { var q = new TermQuery(new Term(""title"", ""volume"")); foreach (var scoreDoc in reader.Search(q, 100).ScoreDocs) { docs.Add(reader.Doc(scoreDoc.Doc)); } }} System.ArgumentOutOfRangeException: Index was out of range. Must be non-negative and less than the size of the collection.Parameter name: indexat System.ThrowHelper.ThrowArgumentOutOfRangeException()at System.Collections.Generic.List`1.get_Item(Int32 index)at Lucene.Net.Index.FieldInfos.FieldInfo(Int32 fieldNumber) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\FieldInfos.cs:line 378 at Lucene.Net.Index.FieldsReader.Doc(Int32 n, FieldSelector fieldSelector) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\FieldsReader.cs:line 234 at Lucene.Net.Index.SegmentReader.Document(Int32 n, FieldSelector fieldSelector) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\SegmentReader.cs:line 1193at Lucene.Net.Index.DirectoryReader.Document(Int32 n, FieldSelector fieldSelector) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\DirectoryReader.cs:line 686at Lucene.Net.Index.IndexReader.Document(Int32 n) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\IndexReader.cs:line 732at Lucene.Net.Search.IndexSearcher.Doc(Int32 i) in d:\Lucene.Net\FullRepo\trunk\src\core\Search\IndexSearcher.cs:line 162at PerformanceTest.Program.Search(IndexSearcher reader, Int32 times) in c:\Users\Tams\Documents\Visual Studio 2012\Projects\BookCatalog\PerformanceTest\Program.cs:line 28at PerformanceTest.Program.<>c__DisplayClass2.<Main>b__0() in c:\Users\Tams\Documents\Visual Studio 2012\Projects\BookCatalog\PerformanceTest\Program.cs:line 43at System.Threading.Tasks.Task.InnerInvoke()at System.Threading.Tasks.Task.Execute() System.IO.IOException: read past EOFat Lucene.Net.Store.BufferedIndexInput.Refill() in d:\Lucene.Net\FullRepo\trunk\src\core\Store\BufferedIndexInput.cs:line 179at Lucene.Net.Store.BufferedIndexInput.ReadByte() in d:\Lucene.Net\FullRepo\trunk\src\core\Store\BufferedIndexInput.cs:line 41at Lucene.Net.Store.IndexInput.ReadVInt() in d:\Lucene.Net\FullRepo\trunk\src\core\Store\IndexInput.cs:line 88 at Lucene.Net.Index.FieldsReader.Doc(Int32 n, FieldSelector fieldSelector) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\FieldsReader.cs:line 230 at Lucene.Net.Index.SegmentReader.Document(Int32 n, FieldSelector fieldSelector) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\SegmentReader.cs:line 1193at Lucene.Net.Index.DirectoryReader.Document(Int32 n, FieldSelector fieldSelector) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\DirectoryReader.cs:line 686at Lucene.Net.Index.IndexReader.Document(Int32 n) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\IndexReader.cs:line 732 at Lucene.Net.Search.IndexSearcher.Doc(Int32 i) in d:\Lucene.Net\FullRepo\trunk\src\core\Search\IndexSearcher.cs:line 162at PerformanceTest.Program.Search(IndexSearcher reader, Int32 times) in c:\Users\Tams\Documents\Visual Studio 2012\Projects\BookCatalog\PerformanceTest\Program.cs:line 28at PerformanceTest.Program.<>c__DisplayClass2.<Main>b__0() in c:\Users\Tams\Documents\Visual Studio 2012\Projects\BookCatalog\PerformanceTest\Program.cs:line 43at System.Threading.Tasks.Task.InnerInvoke()at System.Threading.Tasks.Task.Execute()",Interesting Lucene.net Exception
"IndexSearcher is thread safe, isn't it?"," According to this or this, I used the same indexsearcher by multiple thread. But when I switched from FsDirectory to MMapDirectory, I got interesting exceptions.This work fine: But with this: I get various exceptions like: Or The last code work fine, with setting the concurrentTaskCount variable to 1.Am I missing something? I cant figure out what that is.Actually, I dont have the path d:\Lucene.Net\FullRepo\trunk\src\core\Store\BufferedIndexInput.csI don't even have a drive with letter ""d"" <code>  static void Main(string[] args) { DirectoryInfo directoryInfo = new DirectoryInfo(@""C:\Users\Tams\Desktop\new\""); var directory = FSDirectory.Open(directoryInfo); var indexSearcher = new IndexSearcher(directory); const int times = 100; const int concurrentTaskCount = 5; var task = new Task[concurrentTaskCount]; for (int i = 0; i < concurrentTaskCount; i++) { task[i] = new Task(() => Search(indexSearcher, times)); task[i].Start(); } Task.WaitAll(task);}static void Search(IndexSearcher reader, int times) { List<Document> docs = new List<Document>(10000); for (int i = 0; i < times; i++) { var q = new TermQuery(new Term(""title"", ""volume"")); foreach (var scoreDoc in reader.Search(q, 100).ScoreDocs) { docs.Add(reader.Doc(scoreDoc.Doc)); } }} static void Main(string[] args) { DirectoryInfo directoryInfo = new DirectoryInfo(@""C:\Users\Tams\Desktop\new\""); var directory = new MMapDirectory(directoryInfo); // CHANGED var indexSearcher = new IndexSearcher(directory); const int times = 100; const int concurrentTaskCount = 5; var task = new Task[concurrentTaskCount]; for (int i = 0; i < concurrentTaskCount; i++) { task[i] = new Task(() => Search(indexSearcher, times)); task[i].Start(); } Task.WaitAll(task);}static void Search(IndexSearcher reader, int times) { List<Document> docs = new List<Document>(10000); for (int i = 0; i < times; i++) { var q = new TermQuery(new Term(""title"", ""volume"")); foreach (var scoreDoc in reader.Search(q, 100).ScoreDocs) { docs.Add(reader.Doc(scoreDoc.Doc)); } }} System.ArgumentOutOfRangeException: Index was out of range. Must be non-negative and less than the size of the collection.Parameter name: indexat System.ThrowHelper.ThrowArgumentOutOfRangeException()at System.Collections.Generic.List`1.get_Item(Int32 index)at Lucene.Net.Index.FieldInfos.FieldInfo(Int32 fieldNumber) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\FieldInfos.cs:line 378 at Lucene.Net.Index.FieldsReader.Doc(Int32 n, FieldSelector fieldSelector) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\FieldsReader.cs:line 234 at Lucene.Net.Index.SegmentReader.Document(Int32 n, FieldSelector fieldSelector) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\SegmentReader.cs:line 1193at Lucene.Net.Index.DirectoryReader.Document(Int32 n, FieldSelector fieldSelector) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\DirectoryReader.cs:line 686at Lucene.Net.Index.IndexReader.Document(Int32 n) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\IndexReader.cs:line 732at Lucene.Net.Search.IndexSearcher.Doc(Int32 i) in d:\Lucene.Net\FullRepo\trunk\src\core\Search\IndexSearcher.cs:line 162at PerformanceTest.Program.Search(IndexSearcher reader, Int32 times) in c:\Users\Tams\Documents\Visual Studio 2012\Projects\BookCatalog\PerformanceTest\Program.cs:line 28at PerformanceTest.Program.<>c__DisplayClass2.<Main>b__0() in c:\Users\Tams\Documents\Visual Studio 2012\Projects\BookCatalog\PerformanceTest\Program.cs:line 43at System.Threading.Tasks.Task.InnerInvoke()at System.Threading.Tasks.Task.Execute() System.IO.IOException: read past EOFat Lucene.Net.Store.BufferedIndexInput.Refill() in d:\Lucene.Net\FullRepo\trunk\src\core\Store\BufferedIndexInput.cs:line 179at Lucene.Net.Store.BufferedIndexInput.ReadByte() in d:\Lucene.Net\FullRepo\trunk\src\core\Store\BufferedIndexInput.cs:line 41at Lucene.Net.Store.IndexInput.ReadVInt() in d:\Lucene.Net\FullRepo\trunk\src\core\Store\IndexInput.cs:line 88 at Lucene.Net.Index.FieldsReader.Doc(Int32 n, FieldSelector fieldSelector) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\FieldsReader.cs:line 230 at Lucene.Net.Index.SegmentReader.Document(Int32 n, FieldSelector fieldSelector) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\SegmentReader.cs:line 1193at Lucene.Net.Index.DirectoryReader.Document(Int32 n, FieldSelector fieldSelector) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\DirectoryReader.cs:line 686at Lucene.Net.Index.IndexReader.Document(Int32 n) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\IndexReader.cs:line 732 at Lucene.Net.Search.IndexSearcher.Doc(Int32 i) in d:\Lucene.Net\FullRepo\trunk\src\core\Search\IndexSearcher.cs:line 162at PerformanceTest.Program.Search(IndexSearcher reader, Int32 times) in c:\Users\Tams\Documents\Visual Studio 2012\Projects\BookCatalog\PerformanceTest\Program.cs:line 28at PerformanceTest.Program.<>c__DisplayClass2.<Main>b__0() in c:\Users\Tams\Documents\Visual Studio 2012\Projects\BookCatalog\PerformanceTest\Program.cs:line 43at System.Threading.Tasks.Task.InnerInvoke()at System.Threading.Tasks.Task.Execute()",Interesting Lucene.net Exception
Interestting Lucene.net Exception," According to this or this, I used the same indexsearcher by multiple thread. But when I switched from FsDirectory to MMapDirectory, I got interesting exceptions.This work fine: But with this: I get various exceptions like: Or The last code work fine, with setting the concurrentTaskCount variable to 1.Am I missing something? I cant figure out what that is.Actually, I dont have the path d:\Lucene.Net\FullRepo\trunk\src\core\Store\BufferedIndexInput.csI don't even have a drive with letter ""d"" <code>  static void Main(string[] args) { DirectoryInfo directoryInfo = new DirectoryInfo(@""C:\Users\Tams\Desktop\new\""); var directory = FSDirectory.Open(directoryInfo); var indexSearcher = new IndexSearcher(directory); const int times = 100; const int concurrentTaskCount = 5; var task = new Task[concurrentTaskCount]; for (int i = 0; i < concurrentTaskCount; i++) { task[i] = new Task(() => Search(indexSearcher, times)); task[i].Start(); } Task.WaitAll(task);}static void Search(IndexSearcher reader, int times) { List<Document> docs = new List<Document>(10000); for (int i = 0; i < times; i++) { var q = new TermQuery(new Term(""title"", ""volume"")); foreach (var scoreDoc in reader.Search(q, 100).ScoreDocs) { docs.Add(reader.Doc(scoreDoc.Doc)); } }} static void Main(string[] args) { DirectoryInfo directoryInfo = new DirectoryInfo(@""C:\Users\Tams\Desktop\new\""); var directory = new MMapDirectory(directoryInfo); // CHANGED var indexSearcher = new IndexSearcher(directory); const int times = 100; const int concurrentTaskCount = 5; var task = new Task[concurrentTaskCount]; for (int i = 0; i < concurrentTaskCount; i++) { task[i] = new Task(() => Search(indexSearcher, times)); task[i].Start(); } Task.WaitAll(task);}static void Search(IndexSearcher reader, int times) { List<Document> docs = new List<Document>(10000); for (int i = 0; i < times; i++) { var q = new TermQuery(new Term(""title"", ""volume"")); foreach (var scoreDoc in reader.Search(q, 100).ScoreDocs) { docs.Add(reader.Doc(scoreDoc.Doc)); } }} System.ArgumentOutOfRangeException: Index was out of range. Must be non-negative and less than the size of the collection.Parameter name: indexat System.ThrowHelper.ThrowArgumentOutOfRangeException()at System.Collections.Generic.List`1.get_Item(Int32 index)at Lucene.Net.Index.FieldInfos.FieldInfo(Int32 fieldNumber) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\FieldInfos.cs:line 378 at Lucene.Net.Index.FieldsReader.Doc(Int32 n, FieldSelector fieldSelector) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\FieldsReader.cs:line 234 at Lucene.Net.Index.SegmentReader.Document(Int32 n, FieldSelector fieldSelector) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\SegmentReader.cs:line 1193at Lucene.Net.Index.DirectoryReader.Document(Int32 n, FieldSelector fieldSelector) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\DirectoryReader.cs:line 686at Lucene.Net.Index.IndexReader.Document(Int32 n) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\IndexReader.cs:line 732at Lucene.Net.Search.IndexSearcher.Doc(Int32 i) in d:\Lucene.Net\FullRepo\trunk\src\core\Search\IndexSearcher.cs:line 162at PerformanceTest.Program.Search(IndexSearcher reader, Int32 times) in c:\Users\Tams\Documents\Visual Studio 2012\Projects\BookCatalog\PerformanceTest\Program.cs:line 28at PerformanceTest.Program.<>c__DisplayClass2.<Main>b__0() in c:\Users\Tams\Documents\Visual Studio 2012\Projects\BookCatalog\PerformanceTest\Program.cs:line 43at System.Threading.Tasks.Task.InnerInvoke()at System.Threading.Tasks.Task.Execute() System.IO.IOException: read past EOFat Lucene.Net.Store.BufferedIndexInput.Refill() in d:\Lucene.Net\FullRepo\trunk\src\core\Store\BufferedIndexInput.cs:line 179at Lucene.Net.Store.BufferedIndexInput.ReadByte() in d:\Lucene.Net\FullRepo\trunk\src\core\Store\BufferedIndexInput.cs:line 41at Lucene.Net.Store.IndexInput.ReadVInt() in d:\Lucene.Net\FullRepo\trunk\src\core\Store\IndexInput.cs:line 88 at Lucene.Net.Index.FieldsReader.Doc(Int32 n, FieldSelector fieldSelector) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\FieldsReader.cs:line 230 at Lucene.Net.Index.SegmentReader.Document(Int32 n, FieldSelector fieldSelector) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\SegmentReader.cs:line 1193at Lucene.Net.Index.DirectoryReader.Document(Int32 n, FieldSelector fieldSelector) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\DirectoryReader.cs:line 686at Lucene.Net.Index.IndexReader.Document(Int32 n) in d:\Lucene.Net\FullRepo\trunk\src\core\Index\IndexReader.cs:line 732 at Lucene.Net.Search.IndexSearcher.Doc(Int32 i) in d:\Lucene.Net\FullRepo\trunk\src\core\Search\IndexSearcher.cs:line 162at PerformanceTest.Program.Search(IndexSearcher reader, Int32 times) in c:\Users\Tams\Documents\Visual Studio 2012\Projects\BookCatalog\PerformanceTest\Program.cs:line 28at PerformanceTest.Program.<>c__DisplayClass2.<Main>b__0() in c:\Users\Tams\Documents\Visual Studio 2012\Projects\BookCatalog\PerformanceTest\Program.cs:line 43at System.Threading.Tasks.Task.InnerInvoke()at System.Threading.Tasks.Task.Execute()",Interesting Lucene.net Exception
Will csharp compiler remove unused local if it is assigned a property?," This might be a silly question. I know that compiler will remove unused locals. But if I write my code like this: I am wondering that if i will be removed by compiler because of optimization. There is logic inside the getter of SomeProperty that I wish to execute. If i will be removed, I have to change SomeProperty to a function.Btw, is there a way to know which line will be optimized by compiler? <code>  class MyClass{ public int SomeProperty { get { ... } } public void SomeFunction () { //will this line be removed if i is never used? int i = SomeProperty; ... }}",Will the C# compiler remove unused local if it is assigned a property?
Accessing MVC's model property from javscript," I have the following model which is wrapped in my view model How do I access one of the above properties from Javascript?I tried this, but I got ""undefined"" <code>  public class FloorPlanSettingsModel{ public int Id { get; set; } public int? MainFloorPlanId { get; set; } public string ImageDirectory { get; set; } public string ThumbnailDirectory { get; set; } public string IconsDirectory { get; set; }} var floorplanSettings = ""@Model.FloorPlanSettings"";alert(floorplanSettings.IconsDirectory);",Accessing MVC's model property from Javascript
How to create a delegate from a MethodInfo?," I need a method that takes a MethodInfo instance representing a non-generic static method with arbitrary signature and returns a delegate bound to that method that could later be invoked using Delegate.DynamicInvoke method. My first nave try looked like this: I hoped that the MethodInfo.CreateDelegate method could figure out the correct delegate type itself. Well, obviously it cannot. So, how do I create an instance of System.Type representing a delegate with a signature matching the provided MethodInfo instance? <code>  using System;using System.Reflection;class Program{ static void Main() { var method = CreateDelegate(typeof (Console).GetMethod(""WriteLine"", new[] {typeof (string)})); method.DynamicInvoke(""Hello world""); } static Delegate CreateDelegate(MethodInfo method) { if (method == null) { throw new ArgumentNullException(""method""); } if (!method.IsStatic) { throw new ArgumentNullException(""method"", ""The provided method is not static.""); } if (method.ContainsGenericParameters) { throw new ArgumentException(""The provided method contains unassigned generic type parameters.""); } return method.CreateDelegate(typeof(Delegate)); // This does not work: System.ArgumentException: Type must derive from Delegate. }}",How to create a delegate from a MethodInfo when method signature cannot be known beforehand?
How to interact with USB HID device (fingerprint reader) on node.js," I'm trying to get a node.js app to interact with a .NET SDK fingerprint reader called U.are.U. The SDK provides .dll (win32 and x64), Java and .NET libraries. I decided to use .NET for the simple of use, having all the interfaces ready to use and all. So, the current problem I'm facing is how to call those .NET functions and still preserve the asynchronous nature of node.js. The application flow (on the .NET example) is pretty straight forward, 3 calls on the library, and the fingerprint is done. How can I change it so it can be usable in node.js, instead of a .NET gui program?It also need to be noted that the node.js isn't always going to call a function on the .NET program to receive a function. The identification part of the program happens asynchronously and is set off when someone places a finger on the fingerprint reader, that means that the node.js part have no idea when that is going to happen. So I cannot rely on asking data on the .NET part all the time, it must call callbacks on the node.js without having been asked. So basically, it's a bidirectional communication, not only on request, since requesting using a webserver would be much easier.I've found a node.js library that can close the gap between .NET and node.js called edge.js would this be of any help?Basically, edge.js can make it work, along with node-webkit (which I'll be shipping my app), I can call the node APIs directly in the page, so I can update the DOM depending on the result from the library. I need to be able to register an async task that CAN notify from inside the CLR to the node.js counterpart either by emitting an event or calling a callback!According to the edge.js author it can be done easily https://github.com/tjanczuk/edge/issues/54#issuecomment-17967082 I just don't have enough .NET skills to do so (from a full fledged module) with all the callbacks. <code>  private IEnumerable<Fmd> CaptureAndExtractFmd(){ while (!reset) { DataResult<Fmd> resultConversion; try { if (count >= 8) { SendMessage(""Enrollment was unsuccessful. Please try again.""); count = 0; break; } Fid fid = null; if (!_sender.CaptureFinger(ref fid)) break; if (fid == null) continue; count++; resultConversion = FeatureExtraction.CreateFmdFromFid(fid, Constants.Formats.Fmd.ANSI); SendMessage(""A finger was captured. \r\nCount: "" + (count)); if (resultConversion.ResultCode != Constants.ResultCode.DP_SUCCESS) break; } catch (Exception) { break; } yield return resultConversion.Data; }}",Fingerprint reader on node.js through .NET SDK
Libusbx on USB HID device (fingerprint reader) on node.js," I'm trying to get a node.js app to interact with a .NET SDK fingerprint reader called U.are.U. The SDK provides .dll (win32 and x64), Java and .NET libraries. I decided to use .NET for the simple of use, having all the interfaces ready to use and all. So, the current problem I'm facing is how to call those .NET functions and still preserve the asynchronous nature of node.js. The application flow (on the .NET example) is pretty straight forward, 3 calls on the library, and the fingerprint is done. How can I change it so it can be usable in node.js, instead of a .NET gui program?It also need to be noted that the node.js isn't always going to call a function on the .NET program to receive a function. The identification part of the program happens asynchronously and is set off when someone places a finger on the fingerprint reader, that means that the node.js part have no idea when that is going to happen. So I cannot rely on asking data on the .NET part all the time, it must call callbacks on the node.js without having been asked. So basically, it's a bidirectional communication, not only on request, since requesting using a webserver would be much easier.I've found a node.js library that can close the gap between .NET and node.js called edge.js would this be of any help?Basically, edge.js can make it work, along with node-webkit (which I'll be shipping my app), I can call the node APIs directly in the page, so I can update the DOM depending on the result from the library. I need to be able to register an async task that CAN notify from inside the CLR to the node.js counterpart either by emitting an event or calling a callback!According to the edge.js author it can be done easily https://github.com/tjanczuk/edge/issues/54#issuecomment-17967082 I just don't have enough .NET skills to do so (from a full fledged module) with all the callbacks. <code>  private IEnumerable<Fmd> CaptureAndExtractFmd(){ while (!reset) { DataResult<Fmd> resultConversion; try { if (count >= 8) { SendMessage(""Enrollment was unsuccessful. Please try again.""); count = 0; break; } Fid fid = null; if (!_sender.CaptureFinger(ref fid)) break; if (fid == null) continue; count++; resultConversion = FeatureExtraction.CreateFmdFromFid(fid, Constants.Formats.Fmd.ANSI); SendMessage(""A finger was captured. \r\nCount: "" + (count)); if (resultConversion.ResultCode != Constants.ResultCode.DP_SUCCESS) break; } catch (Exception) { break; } yield return resultConversion.Data; }}",Fingerprint reader on node.js through .NET SDK
How to return IQueryable<T> for furthur querying," I'm trying the PagedList.Mvc library from herehttps://github.com/TroyGoode/PagedListwhich has this usage sample typical implmentations of MyProductDataSource.FindAllProducts(); are along the lines of which of course has the InvalidOperationException() and DBContext is already disposed messageLooking for best practices on how to return IQueryable which can be used here without issues ? <code>  var products = MyProductDataSource.FindAllProducts(); //returns IQueryable<Product> representing an unknown number of products. a thousand maybe? var pageNumber = page ?? 1; // if no page was specified in the querystring, default to the first page (1) var onePageOfProducts = products.ToPagedList(pageNumber, 25); // will only contain 25 products max because of the pageSize public IQuerable<T> MyProductDataSource.FindAllProducts(){ using ( var ctx = new MyCtx() ) { return ctx.MyList().Where( .... ); }}",How to return IQueryable<T> for further querying
"format currency with no decimal places, a decimal thousands separator, and commas after that"," This is probably a simple question, and I'm sure there's a way to do it with string.format(), NumberFormatInfo, CultureInfo or some combination of them, but I need to display large numeric values with 3 trailing decimal places, a decimal instead of a comma for the thousands separator, and then a comma for the millions separator and up. The input is either a whole number or a number followed by up to three decimal places (20000, 123.456, 12.2)For example: 142650 should display as 142,650.00011200.50 should display as 11,200.500123.456 should remain 123.456I suppose it's the same as dividing the value by 1000 and then using string.format(""{0:f3}"", value), but I was hoping to find something that didn't take arithmetic.String.Format(""{0:#,#.000}"", value) gets me close, but it puts a leading 0 on small numbers, so 1.256 is displaying as 01.256, when I need it to remain just 1.256 <code> ","format number with 3 trailing decimal places, a decimal thousands separator, and commas after that"
Crystal Report in ClickOnce deployment," My application needs to print a Crystal Reports report. It does not show a preview, just takes two parameters and shows a print dialog to set the printer. It works fine on computers that have Crystal Reports installed, but I do not have a way to enforce clients have it already installed. I have read in various places that adding the ClickOnce prerequisite ""SAP Crystal Reports Runtime Engine for .NET Framework"" would allow the required Crystal Reports libraries to be registered on the client. When installing the application on the client, it does download the runtime, and installs the runtime, but the application fails to install stating that various CrystalDecisions and CrystalReports assemblies must be registered in GAC. The first is CrystalDecisions.ReportAppServer.CommonObjectModel. If I add a reference to this in the project and redeploy, then it just gives another message about another assembly. I literally did this 15 times, and never got a seamless install.What am I missing? I followed this guide from the SAP website (zipped, 2.2 MB, contains a Microsoft Compiled HTML Help file, crnet_dg_2010_en.chm). <code> ",Crystal Reports in ClickOnce deployment
What is 'this data_type variable_name' in C# language?," I've read open source c# code and there is a lot of strange grammar (to me).They declare method arguments with the this keyword like this:this object @objectWhat does it mean?If I remove 'this' keyword where is before the data type, then will it work differently? <code> ",What is 'this' used for in C# language?
Form tells wrong size on Windows 8 - how to get real size?," Having a WinForms form with form border style set to Sizable on Windows 8, the DesktopBounds property tells the correct values:In contrast, when having a form border style of FixedDialog, the values are wrong:On Windows XP, the values are always correct:My question is:How to get the real size of a Window including the complete non-client area?Update 1:Seems that it is related to this SO question. I'll try and see whether this would solve my issue here, too.Update 2:Just for completeness, here are the results from a VMware Windows 7:Update 3:Finally found a solution which involves using the DwmGetWindowAttribute function together with the DWMWA_EXTENDED_FRAME_BOUNDS value. I'll post an answer below. <code> ",Form tells wrong size on Windows 8  how to get real size?
How to get number out of string?," I want to retrive the number sequence which is at the end of string. for e.g. gives me result 56 but I want the result as 1234. How should I do this ? <code>  string contentDbIndex = Regex.Match(""ab56cd1234"", @""\d+"").Value;",How to get number at the end of string?
Task that do no operation, I have an interface IAnimation which exposes a method BeginAsync(). That method should start the animation and return when it is completed.What I would like to do is implement a null animation class NoAnimation that just returns when it executes BeginAsync().Is this the right implementation? I suspect that there is a more elegant approach than this. I also considered creating an empty method. But that gives me a warning which I don't like either. <code>  public async Task BeginAsync(){ await Task.Run(() => { });},Asynchronous method that does nothing
"asp:Panel abreast, how can I solve it"," I have two panels. I want to show them abreast, but they don't..aspx: I have used a table outside this two elements, another Panel around them, nothing works.How can I resolve this? <code>  <asp:Panel ID=""treeviewMenu"" Width=""20%"" Height=""500"" runat=""server"" ScrollBars=""Both"" HorizontalAlign=""Left""> <asp:TreeView ID=""treeview"" runat=""server"" ShowLines=""True"" ImageSet=""XPFileExplorer"" OnSelectedNodeChanged=""treeview_SelectedNodeChanged""> </asp:TreeView></asp:Panel><asp:Panel ID=""qvObjektMenu"" Width=""75%"" Height=""500"" runat=""server"" HorizontalAlign=""Right""> <asp:Table runat=""server"" HorizontalAlign=""Right""> <asp:TableRow> <asp:TableCell> <asp:Label runat=""server""> QVObjekt Id: </asp:Label> </asp:TableCell> <asp:TableCell> <asp:Label ID=""qvObjektId"" runat=""server""></asp:Label> </asp:TableCell> </asp:TableRow> </asp:Table></asp:Panel>",How can I display two asp:Panel controls side by side?
".net, C#, binary serialization, Iformatter : Should I use a new one each time or store one in a field?"," Using binary formatting for 1st time in .net C#Code from MSDN is like this: Just wondering should I store an IFormatter in a field in my class and use it over and over again or should I do as above and instantiate a new one every time I save/load something?I noticed it is not IDisposable. <code>  IFormatter formatter = new BinaryFormatter(); Stream stream = new FileStream(""MyFile.lvl"", FileMode.Create, FileAccess.Write,FileShare.None); formatter.Serialize(stream, Globals.CurrentLevel); stream.Close();","Binary serialization, IFormatter: use a new one each time or store one in a field?"
how to download memorystream to a file in C#?," I'm using the below sample code for writing and downloading a memory stream to a file in C#. I am getting the following error: Specified argument was out of the range of valid values. Parameter name: offsetWhat may be the cause? <code>  MemoryStream memoryStream = new MemoryStream();TextWriter textWriter = new StreamWriter(memoryStream);textWriter.WriteLine(""Something""); byte[] bytesInStream = new byte[memoryStream.Length];memoryStream.Write(bytesInStream, 0, bytesInStream.Length);memoryStream.Close(); Response.Clear();Response.ContentType = ""application/force-download"";Response.AddHeader(""content-disposition"", ""attachment; filename=name_you_file.xls"");Response.BinaryWrite(bytesInStream);Response.End();",How to download memorystream to a file?
Why does my application spend 24% of it's life doing a null check?," I've got a performance critical binary decision tree, and I'd like to focus this question on a single line of code. The code for the binary tree iterator is below with the results from running performance analysis against it. BranchData is a field, not a property. I did this to prevent the risk of it not being inlined.The BranchNodeData class is as follows: As you can see, the while loop / null check is a massive hit on performance. The tree is massive, so I would expect searching for a leaf to take a while, but I'd like to understand the disproportionate amount of time spent on that one line.I've tried:Separating the Null check from the while - it's the Null check that's the hit.Adding a boolean field to the object and checking against that, it made no difference. It doesn't matter what's being compared, it's the comparison that's the issue.Is this a branch prediction issue? If so, what can I do about it? If anything?I won't pretend to understand the CIL, but I'll post it for anyone does so they can try to scrape some information from it. Edit: I decided to do a branch prediction test, I added an identical if within the while, so we have and inside that. I then ran performance analysis against that, and it took six times longer to execute the first comparison as it did to execute the second comparison that always returned true. So it looks like it is indeed a branch prediction issue - and I'm guessing there's nothing I can do about it?!Another EditThe above result would also occur if node.BranchData had to be loaded from the RAM for the while check - it would then be cached for the if statement.This is my third question on a similar topic. This time I'm focusing on a single line of code.My other questions on this subject are:Could I use a faster data structure than a tree for this?Micro optimisations iterating through a tree in C# <code>  public ScTreeNode GetNodeForState(int rootIndex, float[] inputs) {0.2% ScTreeNode node = RootNodes[rootIndex].TreeNode;24.6% while (node.BranchData != null) {0.2% BranchNodeData b = node.BranchData;0.5% node = b.Child2;12.8% if (inputs[b.SplitInputIndex] <= b.SplitValue)0.8% node = b.Child1; }0.4% return node; } public sealed class BranchNodeData{ /// <summary> /// The index of the data item in the input array on which we need to split /// </summary> internal int SplitInputIndex = 0; /// <summary> /// The value that we should split on /// </summary> internal float SplitValue = 0; /// <summary> /// The nodes children /// </summary> internal ScTreeNode Child1; internal ScTreeNode Child2;} .method public hidebysiginstance class OptimalTreeSearch.ScTreeNode GetNodeForState ( int32 rootIndex, float32[] inputs) cil managed{ // Method begins at RVA 0x2dc8 // Code size 67 (0x43) .maxstack 2 .locals init ( [0] class OptimalTreeSearch.ScTreeNode node, [1] class OptimalTreeSearch.BranchNodeData b ) IL_0000: ldarg.0 IL_0001: ldfld class [mscorlib]System.Collections.Generic.List`1<class OptimalTreeSearch.ScRootNode> OptimalTreeSearch.ScSearchTree::RootNodes IL_0006: ldarg.1 IL_0007: callvirt instance !0 class [mscorlib]System.Collections.Generic.List`1<class OptimalTreeSearch.ScRootNode>::get_Item(int32) IL_000c: ldfld class OptimalTreeSearch.ScTreeNode OptimalTreeSearch.ScRootNode::TreeNode IL_0011: stloc.0 IL_0012: br.s IL_0039 // loop start (head: IL_0039) IL_0014: ldloc.0 IL_0015: ldfld class OptimalTreeSearch.BranchNodeData OptimalTreeSearch.ScTreeNode::BranchData IL_001a: stloc.1 IL_001b: ldloc.1 IL_001c: ldfld class OptimalTreeSearch.ScTreeNode OptimalTreeSearch.BranchNodeData::Child2 IL_0021: stloc.0 IL_0022: ldarg.2 IL_0023: ldloc.1 IL_0024: ldfld int32 OptimalTreeSearch.BranchNodeData::SplitInputIndex IL_0029: ldelem.r4 IL_002a: ldloc.1 IL_002b: ldfld float32 OptimalTreeSearch.BranchNodeData::SplitValue IL_0030: bgt.un.s IL_0039 IL_0032: ldloc.1 IL_0033: ldfld class OptimalTreeSearch.ScTreeNode OptimalTreeSearch.BranchNodeData::Child1 IL_0038: stloc.0 IL_0039: ldloc.0 IL_003a: ldfld class OptimalTreeSearch.BranchNodeData OptimalTreeSearch.ScTreeNode::BranchData IL_003f: brtrue.s IL_0014 // end loop IL_0041: ldloc.0 IL_0042: ret} // end of method ScSearchTree::GetNodeForState while (node.BranchData != null) if (node.BranchData != null)",Why does my application spend 24% of its life doing a null check?
Decimal? to string conversion issue in C#," I am facing a problem when I try to convert decimal? to string. Scenario is Current Result : value = 12.1100Expected Result : value = 12.11Please let me know, what could be reason for this. <code>  decimal decimalValue = .1211;string value = (decimalValue * 100).ToString();",Decimal ToString() conversion issue in C#
Memory Model: preventing store-release and load-aquire reordering," It is known that, unlike Java's volatiles, .NET's ones allow reordering of volatile writes with the following volatile reads from another location. When it is a problem MemoryBarier is recommended to be placed between them, or Interlocked.Exchange can be used instead of volatile write. It works but MemoryBarier could be a performance killer when used in highly optimized lock-free code. I thought about it a bit and came with an idea. I want somebody to tell me if I took the right way.So, the idea is the following:We want to prevent reordering between these two accesses: From .NET MM we know that : To prevent unwanted reordering between write and read we introduce a dummy volatile read from the variable we've just written to: In such case B cannot be reordered with A as they both access the same variable,C cannot be reordered with B because two volatile reads cannot be reordered with each other, and transitively C cannot be reordered with A.And the question: Am I right? Can that dummy volatile read be used as a lightweight memory barrier for such scenario? <code>  volatile1 write volatile2 read 1) writes to a variable cannot be reordered with a following read from the same variable 2) no volatile accesses can be eliminated 3) no memory accesses can be reordered with a previous volatile read A) volatile1 write B) volatile1 read [to a visible (accessible | potentially shared) location] C) volatile2 read",Memory Model: preventing store-release and load-acquire reordering
Am I able to display my custom error message?," I think that my code should make the ViewBag.test property equal to ""No Match"", but instead it throws an InvalidOperationException.Why is this? <code>  string str = ""Hello1,Hello,Hello2"";string another = ""Hello5"";string retVal = str.Split("","".ToCharArray(), StringSplitOptions.RemoveEmptyEntries) .First(p => p.Equals(another));if (str == another){ ViewBag.test = ""Match"";}else{ ViewBag.test = ""No Match""; //this does not happen when it should}",Why is this code throwing an InvalidOperationException?
Get HTML code from a website C#," How can I get the HTML code from a website, save it, and find some text by using a LINQ expression?I'm using the following code to get the source of a web page: How do I find the text within a div in the source of the web page? <code>  public static String code(string Url){ HttpWebRequest myRequest = (HttpWebRequest)WebRequest.Create(Url); myRequest.Method = ""GET""; WebResponse myResponse = myRequest.GetResponse(); StreamReader sr = new StreamReader(myResponse.GetResponseStream(), System.Text.Encoding.UTF8); string result = sr.ReadToEnd(); sr.Close(); myResponse.Close(); return result;}",How do I find the text within a div in the source of a web page using C#
Get HTML code from website in C#," How can I get the HTML code from a website, save it, and find some text by using a LINQ expression?I'm using the following code to get the source of a web page: How do I find the text within a div in the source of the web page? <code>  public static String code(string Url){ HttpWebRequest myRequest = (HttpWebRequest)WebRequest.Create(Url); myRequest.Method = ""GET""; WebResponse myResponse = myRequest.GetResponse(); StreamReader sr = new StreamReader(myResponse.GetResponseStream(), System.Text.Encoding.UTF8); string result = sr.ReadToEnd(); sr.Close(); myResponse.Close(); return result;}",How do I find the text within a div in the source of a web page using C#
Problem getting HTML from a website using C#," How can I get the HTML code from a website, save it, and find some text by using a LINQ expression?I'm using the following code to get the source of a web page: How do I find the text within a div in the source of the web page? <code>  public static String code(string Url){ HttpWebRequest myRequest = (HttpWebRequest)WebRequest.Create(Url); myRequest.Method = ""GET""; WebResponse myResponse = myRequest.GetResponse(); StreamReader sr = new StreamReader(myResponse.GetResponseStream(), System.Text.Encoding.UTF8); string result = sr.ReadToEnd(); sr.Close(); myResponse.Close(); return result;}",How do I find the text within a div in the source of a web page using C#
Returning the result of a method that takes a parameter throws an exception in NSubstitute," I have run into a weird issue while using NSubstitute a few times and although I know how to work around it I've never been able to explain it. I've crafted what appears to be the minimum required test to prove the problem and it appears to be something to do with using a method to create a substituted return value. When I run the above test I get the following exception: However, if I change the test method to return this: or this: It works.I'm just wondering if anyone can explain why this happens? <code>  public interface IMyObject{ int Value { get; }}public interface IMyInterface{ IMyObject MyProperty { get; }}[TestMethod]public void NSubstitute_ReturnsFromMethod_Test(){ var sub = Substitute.For<IMyInterface>(); sub.MyProperty.Returns(MyMethod());}private IMyObject MyMethod(){ var ob = Substitute.For<IMyObject>(); ob.Value.Returns(1); return ob;} Test method globalroam.Model.NEM.Test.ViewModel.DelayedAction_Test.NSubstitute_ReturnsFromMethod_Test threw exception: NSubstitute.Exceptions.CouldNotSetReturnException: Could not find a call to return from.Make sure you called Returns() after calling your substitute (for example: mySub.SomeMethod().Returns(value)).If you substituted for a class rather than an interface, check that the call to your substitute was on a virtual/abstract member.Return values cannot be configured for non-virtual/non-abstract members. sub.MyProperty.Returns((a) => MyMethod()); var result = MyMethod();sub.MyProperty.Returns(result);",Returning the result of a method that returns another substitute throws an exception in NSubstitute
Ternaery operator in LINQ where caluse," I am using linq for join multiple tables and write complex query. Here when i will have '0' as any parameter i.e. CategoryId, GameId, LimitVariantId, that means user has selected ""All"" from interface.My Sql query, when I will pass parameter values greater than '0' is : When I will pass CategoryId as 0 then My Sql query will be : So I don't need to include that fields in where clause. For that I had written the following LINQ: But this will return all fields from my database. So Can any one help me to write these queries in LINQ with ternary condition that will return my filtered fields' records? <code>  select * from dbo.GameCombinations gcinner join dbo.StakeBuyInByStakeCategories sbscon sbsc.StakeBuyInByStakeCategoryId = gc.StakeBuyInByStakeCategoryIdinner join dbo.GameTables gton gc.GameCombinationId = gt.GameCombinationIdwhere gc.CurrencyId=1 and gc.GameTypeId=2and sbsc.StakeBuyInId=gt.BuyInand gc.CategoryId=4and gc.GameId=7and gc.LimitVariantId=23and gc.StakeCategoryId in (3,5,6) select * from dbo.GameCombinations gcinner join dbo.StakeBuyInByStakeCategories sbscon sbsc.StakeBuyInByStakeCategoryId = gc.StakeBuyInByStakeCategoryIdinner join dbo.GameTables gton gc.GameCombinationId = gt.GameCombinationIdwhere gc.CurrencyId=1 and gc.GameTypeId=2and sbsc.StakeBuyInId=gt.BuyIn--and gc.CategoryId=4and gc.GameId=7and gc.LimitVariantId=23and gc.StakeCategoryId in (3,5,6) ProviderDB db = new ProviderDB();try{ IQueryable<dynamic> query; if (StakeCategoryIdsByStakeBuyIn != null) { query = (from gc in db.GameCombinations.Where(x => x.CurrencyId == CurrencyId && x.GameTypeId == GameTypeId && CategoryId <= 0 ? true : x.CategoryId == CategoryId && GameId <= 0 ? true : x.GameId == GameId && LimitVariantId <= 0 ? true : x.LimitVariantId == LimitVariantId && StakeCategoryIdsByStakeBuyIn.Contains(x.StakeCategoryId) ) join sbsc in db.StakeBuyInByStakeCategories on gc.StakeBuyInByStakeCategoryId equals sbsc.StakeBuyInByStakeCategoryId join gt in db.GameTables on gc.GameCombinationId equals gt.GameCombinationId join gx in db.Games on gc.GameId equals gx.GameId into joined from gx in joined.DefaultIfEmpty() where gt.BuyIn == sbsc.StakeBuyInId select new { GameTableId = gt.GameTableId, Description = gt.Description, BuyIn = gt.BuyIn, Table = gx.GameName, MaxAllowPlayer = gt.MaxAllowPlayer }).Distinct(); } else { query = (from gc in db.GameCombinations.Where(x => x.CurrencyId == CurrencyId && x.GameTypeId == GameTypeId && CategoryId == 0 ? true : x.CategoryId == CategoryId && GameId == 0 ? true : x.GameId == GameId && LimitVariantId == 0 ? true : x.LimitVariantId == LimitVariantId && StakeCategoryIdsByStakeBuyIn == null ) join sbsc in db.StakeBuyInByStakeCategories on gc.StakeBuyInByStakeCategoryId equals sbsc.StakeBuyInByStakeCategoryId join gt in db.GameTables on gc.GameCombinationId equals gt.GameCombinationId join sb in db.StakeBuyIns on gt.BuyIn equals sb.StakeBuyInId join gx in db.Games on gc.GameId equals gx.GameId into joined from gx in joined.DefaultIfEmpty() where gt.BuyIn == sbsc.StakeBuyInId select new { GameTableId = gt.GameTableId, Description = gt.Description, BuyIn = sb.StakeBuyInValue, Table = gx.GameName, MaxAllowPlayer = gt.MaxAllowPlayer }).Distinct(); }",Ternary operator in LINQ where clause
Ternary operator in LINQ where caluse," I am using linq for join multiple tables and write complex query. Here when i will have '0' as any parameter i.e. CategoryId, GameId, LimitVariantId, that means user has selected ""All"" from interface.My Sql query, when I will pass parameter values greater than '0' is : When I will pass CategoryId as 0 then My Sql query will be : So I don't need to include that fields in where clause. For that I had written the following LINQ: But this will return all fields from my database. So Can any one help me to write these queries in LINQ with ternary condition that will return my filtered fields' records? <code>  select * from dbo.GameCombinations gcinner join dbo.StakeBuyInByStakeCategories sbscon sbsc.StakeBuyInByStakeCategoryId = gc.StakeBuyInByStakeCategoryIdinner join dbo.GameTables gton gc.GameCombinationId = gt.GameCombinationIdwhere gc.CurrencyId=1 and gc.GameTypeId=2and sbsc.StakeBuyInId=gt.BuyInand gc.CategoryId=4and gc.GameId=7and gc.LimitVariantId=23and gc.StakeCategoryId in (3,5,6) select * from dbo.GameCombinations gcinner join dbo.StakeBuyInByStakeCategories sbscon sbsc.StakeBuyInByStakeCategoryId = gc.StakeBuyInByStakeCategoryIdinner join dbo.GameTables gton gc.GameCombinationId = gt.GameCombinationIdwhere gc.CurrencyId=1 and gc.GameTypeId=2and sbsc.StakeBuyInId=gt.BuyIn--and gc.CategoryId=4and gc.GameId=7and gc.LimitVariantId=23and gc.StakeCategoryId in (3,5,6) ProviderDB db = new ProviderDB();try{ IQueryable<dynamic> query; if (StakeCategoryIdsByStakeBuyIn != null) { query = (from gc in db.GameCombinations.Where(x => x.CurrencyId == CurrencyId && x.GameTypeId == GameTypeId && CategoryId <= 0 ? true : x.CategoryId == CategoryId && GameId <= 0 ? true : x.GameId == GameId && LimitVariantId <= 0 ? true : x.LimitVariantId == LimitVariantId && StakeCategoryIdsByStakeBuyIn.Contains(x.StakeCategoryId) ) join sbsc in db.StakeBuyInByStakeCategories on gc.StakeBuyInByStakeCategoryId equals sbsc.StakeBuyInByStakeCategoryId join gt in db.GameTables on gc.GameCombinationId equals gt.GameCombinationId join gx in db.Games on gc.GameId equals gx.GameId into joined from gx in joined.DefaultIfEmpty() where gt.BuyIn == sbsc.StakeBuyInId select new { GameTableId = gt.GameTableId, Description = gt.Description, BuyIn = gt.BuyIn, Table = gx.GameName, MaxAllowPlayer = gt.MaxAllowPlayer }).Distinct(); } else { query = (from gc in db.GameCombinations.Where(x => x.CurrencyId == CurrencyId && x.GameTypeId == GameTypeId && CategoryId == 0 ? true : x.CategoryId == CategoryId && GameId == 0 ? true : x.GameId == GameId && LimitVariantId == 0 ? true : x.LimitVariantId == LimitVariantId && StakeCategoryIdsByStakeBuyIn == null ) join sbsc in db.StakeBuyInByStakeCategories on gc.StakeBuyInByStakeCategoryId equals sbsc.StakeBuyInByStakeCategoryId join gt in db.GameTables on gc.GameCombinationId equals gt.GameCombinationId join sb in db.StakeBuyIns on gt.BuyIn equals sb.StakeBuyInId join gx in db.Games on gc.GameId equals gx.GameId into joined from gx in joined.DefaultIfEmpty() where gt.BuyIn == sbsc.StakeBuyInId select new { GameTableId = gt.GameTableId, Description = gt.Description, BuyIn = sb.StakeBuyInValue, Table = gx.GameName, MaxAllowPlayer = gt.MaxAllowPlayer }).Distinct(); }",Ternary operator in LINQ where clause
C# - Finding element attribute with XDocument," I'm trying to get the PurchaseDate from the following XML structure (a receipt from an in-app purchase in Windows Phone): My code goes as follows: This keeps raising an access error, because doc.Root.Element(""ProductReceipt"") is null. Why is XDocument not getting the ProductReceipt element? <code>  <Receipt Version=""1.0"" CertificateId=""..."" xmlns=""http://schemas.microsoft.com/windows/2012/store/receipt""> <ProductReceipt PurchasePrice=""$0"" PurchaseDate=""2013-05-20T19:27:09.755Z"" Id=""..."" AppId=""..."" ProductId=""Unlock"" ProductType=""Consumable"" PublisherUserId=""..."" PublisherDeviceId=""..."" MicrosoftProductId=""..."" /> <Signature xmlns=""http://www.w3.org/2000/09/xmldsig#""> <SignedInfo> <CanonicalizationMethod Algorithm=""http://www.w3.org/TR/2001/REC-xml-c14n-20010315"" /> <SignatureMethod Algorithm=""http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"" /> <Reference URI=""""> <Transforms> <Transform Algorithm=""http://www.w3.org/2000/09/xmldsig#enveloped-signature"" /> </Transforms> <DigestMethod Algorithm=""http://www.w3.org/2001/04/xmlenc#sha256"" /> <DigestValue>...</DigestValue> </Reference> </SignedInfo> <SignatureValue>...</SignatureValue> </Signature></Receipt> XDocument doc = XDocument.Parse(receiptXml);string date = doc.Root.Element(""ProductReceipt"").Attribute(""PurchaseData"").Value;",Finding element attribute with XDocument
how to correctly sign an executable," I have made a little tool. It is a console application that when running on Win7 brings the UAC security prompt.I tried to sign this EXE file in Visual Studio 2010 using the following steps:Project propertiesSigningCreate new key as shown belowThe key file was successfully created, as you can see in the capture below.Issues:File is still being blocked by the UAC security prompt. When I checked the file whether signed or not using the signtool.exe, it tells me, no signature was found.Please correct me if I'm following the wrong steps. <code> ",How to correctly sign an executable
Cannot modify list?," I want to change the money value in my list, but I always get an error message: Cannot modify the return value of 'System.Collections.Generic.List.this[int]' because it is not a variableWhat is wrong? How can I change the value? <code>  struct AccountContainer{ public string Name; public int Age; public int Children; public int Money; public AccountContainer(string name, int age, int children, int money) : this() { this.Name = name; this.Age = age; this.Children = children; this.Money = money; }}List<AccountContainer> AccountList = new List<AccountContainer>();AccountList.Add(new AccountContainer(""Michael"", 54, 3, 512913));AccountList[0].Money = 547885;",Cannot modify struct in a list?
The type `T' must be convertible in order to use it as parameter `T' in the generic type or method," I have these two main classes. First the FSMSystem class: And the second class, FSMState: It leads to the following error: error CS0309: The type 'T' must be convertible to 'FSMSystem<T>' in order to use it as parameter 'T' in the generic type or method 'FSMSystem<T>'Can someone tell me how to resolve this? I see many other posts similar to this one but I'm not seeing the relationship. <code>  public class FSMSystem<T> : MonoBehaviour where T : FSMSystem<T>{ private T m_Owner = default(T); protected FSMState<T> currentState; private Dictionary<int, FSMState<T>> m_states; public FSMSystem(T owner) { m_Owner = GameObject.FindObjectOfType(typeof(T)) as T; //owner; m_states = new Dictionary<int, FSMState<T>>(); } protected void AddState( FSMState<T> state ) { m_states.Add( state.GetStateID(), state ); }} public abstract class FSMState<T>{ public abstract int GetStateID(); public abstract void OnEnter (FSMSystem<T> fsm, FSMState<T> prevState); public abstract void OnUpdate (FSMSystem<T> fsm); public abstract void OnExit (FSMSystem<T> fsm, FSMState<T> nextState);}",The type 'T' must be convertible in order to use it as parameter 'T' in the generic type or method
compact way to transform list in c#?," In my code I frequently have the sequences like: In Python, I can write it as Is there a compact way to write it in C#? <code>  List<type1> list1 = ...;List<type2> list2 = new List<type2>();foreach(type1 l1 in list1){ list2.Add(myTransformFunc(l1));} list2 = [myTransformFunc(l1) for l1 in list1]",How to do lists comprehension (compact way to transform a list into another list) in c#?
"How can I access the ""Documents and Settings"" folder"," I'm using C# .NET 4 with VS 2010. When Iterating over some paths, I'm running this line: I get an exception when the path is the documents and settings folder. How can I access it? And no, I don't want to skip the folder with a try and catch. I want to be able to access it somehow.Edit: I got a follow up question. As I told you, I'm iterating over the paths. Is there a way to use Environment.GetFolderPath but somehow idetifying the correct speical folder according to the path I'm currently checking? <code>  files = Directory.GetFiles(path, searchPattern);","How can I access the ""Documents and Settings"" folder?"
c# { get; set; } shortcut," I am learning C#, and am learning about making fields private to the class, and using Getters and Setters to expose Methods instead of field values.Are the get; set; in Method 1 and Method 2 equivalent? e.g. is one a shorthand of the other? Finally, would Method 2 be used when you want to for example perform a calculation before getting or setting a value? e.g. converting value to a percentage or perform validation? e.g. <code>  class Student{ // Instance fields private string name; private int mark; // Method 1 public string Name { get; set; } // Method 2 public int Mark { get { return mark; } set { mark = value; } }} class Student{ // Instance fields private string name; private double mark; private int maxMark = 50; // Method 1 public string Name { get; set; } // Method 2 public double Mark { get { return mark; } set { if ( mark <= maxMark ) mark = value / maxMark * 100; } }}",Shorthand Accessors and Mutators
converting index of one dimensional array into two dimensional array i. e. row and column," I have one application of WinForms which inside list box I am inserting name and price..name and price are stored in two dimensional array respectively. Now when I select one record from the listbox it gives me only one index from which I can get the string name and price to update that record I have to change name and price at that index for this I want to update both two dimensional array name and price. but the selected index is only one dimensional. I want to convert that index into row and column. How to do that?But I'm inserting record in list box like this. <code>  int row = 6, column = 10;for(int i=0;i<row;i++){ for(int j=0;j<column;j++) { value= row+"" \t ""+ column +"" \t ""+ name[i, j]+"" \t "" +price[i, j]; listbox.items.add(value); }}",Converting index of one dimensional array into two dimensional array i. e. row and column
Fail to call winsat.exe in commad prompt," I'm trying to run the Windows System Assessment Tool (winsat.exe) using the following code: This code works if I only call cmd.exe, and even if I call regedit.exe it still works.However, when I try to call winsat.exe as a argument of cmd.exe, it fails.The command prompt shows this: I tried several ways to call winsat.exe:Call it directly by assigning ""winsat.exe"" to ProcessStartInfo.FileName. It fails with a Win32Exception: The system cannot find the file specifiedAs above, using the full path - @""c:\windows\system32\winsat.exe"". It fails with the same error.Run the code as the System Administrator. It still fails.Call winsat.exe as in the coded example. It failed as I explained earlier.It's interesting that the command prompt launched from the code can only see .dll files in c:\windows\system32.Does anyone have any idea why winsat.exe cannot be launched through System.Diagnostics.Process? Are there any limitations which I've misunderstood?Thanks,Rex <code>  System.Diagnostics.Process WinSPro = new System.Diagnostics.Process();System.Diagnostics.ProcessStartInfo WinSSInfo = new System.Diagnostics.ProcessStartInfo();WinSSInfo.FileName = ""cmd.exe"";WinSSInfo.Arguments = ""/k winsat.exe"";WinSPro.StartInfo = WinSSInfo;WinSPro.Start(); 'winsat.exe' is not recognized as an internal or external command, operable program or batch file.","""File not found"" error launching system32\winsat.exe using Process.Start()"
Fail to call winsat.exe in command prompt," I'm trying to run the Windows System Assessment Tool (winsat.exe) using the following code: This code works if I only call cmd.exe, and even if I call regedit.exe it still works.However, when I try to call winsat.exe as a argument of cmd.exe, it fails.The command prompt shows this: I tried several ways to call winsat.exe:Call it directly by assigning ""winsat.exe"" to ProcessStartInfo.FileName. It fails with a Win32Exception: The system cannot find the file specifiedAs above, using the full path - @""c:\windows\system32\winsat.exe"". It fails with the same error.Run the code as the System Administrator. It still fails.Call winsat.exe as in the coded example. It failed as I explained earlier.It's interesting that the command prompt launched from the code can only see .dll files in c:\windows\system32.Does anyone have any idea why winsat.exe cannot be launched through System.Diagnostics.Process? Are there any limitations which I've misunderstood?Thanks,Rex <code>  System.Diagnostics.Process WinSPro = new System.Diagnostics.Process();System.Diagnostics.ProcessStartInfo WinSSInfo = new System.Diagnostics.ProcessStartInfo();WinSSInfo.FileName = ""cmd.exe"";WinSSInfo.Arguments = ""/k winsat.exe"";WinSPro.StartInfo = WinSSInfo;WinSPro.Start(); 'winsat.exe' is not recognized as an internal or external command, operable program or batch file.","""File not found"" error launching system32\winsat.exe using Process.Start()"
C# Convert Func<T> callback to an await," I have a method that takes a Action<String>. When the method finishes its processing it calls the Action<String> with the return value. I want to use this in a web.api async controller. How do I wrap this method so I can await for this method to complete in an async manner. I cannot modify the method itself, it is in a legacy code base.What I would like to be able to do is this <code>  MethodWithCallback((finalResponse)=> { Console.WriteLine(finalResponse);}); String returnValue = await MyWrapperMethodThatCallsMethodWithCallback();",Convert Action<T> callback to an await
C# Convert Action<T> callback to an await," I have a method that takes a Action<String>. When the method finishes its processing it calls the Action<String> with the return value. I want to use this in a web.api async controller. How do I wrap this method so I can await for this method to complete in an async manner. I cannot modify the method itself, it is in a legacy code base.What I would like to be able to do is this <code>  MethodWithCallback((finalResponse)=> { Console.WriteLine(finalResponse);}); String returnValue = await MyWrapperMethodThatCallsMethodWithCallback();",Convert Action<T> callback to an await
"C# Dictionary - Get key from value - Dictionary<string, List<string>>"," I am having trouble getting the key by specifying a value. What is the best way I can achieve this? <code>  var st1= new List<string> { ""NY"", ""CT"", ""ME"" };var st2= new List<string> { ""KY"", ""TN"", ""SC"" };var st3= new List<string> { ""TX"", ""OK"", ""MO"" };var statesToEmailDictionary = new Dictionary<string, List<string>>();statesToEmailDictionary.Add(""test1@gmail.com"", st1);statesToEmailDictionary.Add(""test2@gmail.com"", st2);statesToEmailDictionary.Add(""test3@gmail.com"", st3);var emailAdd = statesToEmailDictionary.FirstOrDefault(x => x.Value.Where(y => y.Contains(state))).Key;","Get key from value - Dictionary<string, List<string>>"
Changing text box from another class C#," I'm trying to change value of a text box located in from another class. I've tried something like this From another class I'm calling it like And I get blank output. I also tried to add the static keyword to the echo method, but I got the same result. I searched over Stack Overflow and didn't get any solution to work. And one thing that triggers me, if I add cout.Show() the same form pop out with valid textBox1 content. Why is that?Why it is not showing content right away? And how do I fix this? <code>  public partial class Form1 : Form public void echo(string text){ this.textBox1.AppendText(text + Environment.NewLine);} Form1 cout = new Form1();cout.echo(""Does this work?"");",Changing text box from another class
How can I Log Generated Sql from DbContext.SaveChanges() in my Program?," According this thread, we can log the generated SQL via EF, but what about DbContext.SaveChanges()? Is there any easy way to do this job without any extra frameworks? <code> ",How can I log the generated SQL from DbContext.SaveChanges() in my Program?
Creating an JSON array in C#," Ok, so I am trying to send POST commands over an http connection, and using JSON formatting to do so. I am writing the program to do this in C#, and was wondering how I would format an array of values to be passed as JSON to the server. Currently I have this:new {name = ""command"" , index = ""X"", optional = ""0""}Which translates to this in JSON: And I want to make an array, called items, where each element contains these three values. So it would essentially be an array of objects, in which the object contains a name, an index, and an optional field.My guess was that it would be something along the lines of this: Which, if it were correct syntax, would translate to this in JSON: But, evidently I'm doing it wrong. Ideas? Any help is appreciated. <code>  ""name"": ""command"",""index"": ""X"",""optional"": ""0"" new {items = [(name = ""command"" , index = ""X"", optional = ""0""), (name = ""status"" , index = ""X"", optional = ""0"")]} ""items"": [ { ""name"": ""command"", ""index"": ""X"", ""optional"": ""0"" }, { ""name"": ""status"", ""index"": ""X"", ""optional"": ""0"" }]",Creating a JSON array in C#
ASP.NET MVC C# weird unwanted truncating decimal error," My Model: Seeding the Database: Querying the Database to test seeding: Console Output: Am I doing something really silly or something??? Everything is being truncated to 2 decimal places.Solution - Thanks to Patrick: <code>  public class Product{ ... public decimal Fineness { get; set; } ...} new List<Product> { new Product { ..., Fineness = 0.757M, ... }, new Product { ..., Fineness = 0.674M, ... }, new Product { ..., Fineness = 0.475M, ... } }.ForEach(p => context.Products.Add(p)); var products = db.Products.ToList();foreach (var p in products){ S.D.Debug.WriteLine(""ProductList: {0}, {1}"", p.Name, p.Fineness);} ProductList: Test Product, 0.75 ProductList: Test Product, 0.67 ProductList: Test Product, 0.47 protected override void OnModelCreating(DbModelBuilder modelBuilder){ modelBuilder.Entity<Product>().Property(x => x.Fineness).HasPrecision(10, 5);}",Unwanted Decimal Truncation
"Accept the weakest, return the strongest"," Asking myself again and again what good code is, I read the advice ""Accept the weakest, return the strongest"".For me it is obvious why to accept the weakest: The method declares the weakest possible contract with its client. So the clients do not need to be ""specialized"" against a very ""strong"" interface.""Return the strongest"" is not that clear for me. Why should I return the strongest interface possible? What is the strongest interface? How do you quantify the strongness?Assume there is a method returning a sequence of elements. The weakest interface would be of type IEnumerable. Following the guideline we should return someting like IList. But why?I would like to ask for an explanation why to return the strongest interface. <code> ","Accept the weakest, return the strongest. But why?"
C# : Why is dictionary is so faster than list?," I am testing the speed of getting data from Dictionary VS list. I've used this code to test : There is list of students and grades in memory they have StudentId in common. In first way I tried to find Grade of a student using LINQ on a list that takes near 7 seconds on my machine and in another way first I converted List into dictionary then finding grades of student from dictionary using key that takes less than a second .  <code>  internal class Program{ private static void Main(string[] args) { var stopwatch = new Stopwatch(); List<Grade> grades = Grade.GetData().ToList(); List<Student> students = Student.GetStudents().ToList(); stopwatch.Start(); foreach (Student student in students) { student.Grade = grades.Single(x => x.StudentId == student.Id).Value; } stopwatch.Stop(); Console.WriteLine(""Using list {0}"", stopwatch.Elapsed); stopwatch.Reset(); students = Student.GetStudents().ToList(); stopwatch.Start(); Dictionary<Guid, string> dic = Grade.GetData().ToDictionary(x => x.StudentId, x => x.Value); foreach (Student student in students) { student.Grade = dic[student.Id]; } stopwatch.Stop(); Console.WriteLine(""Using dictionary {0}"", stopwatch.Elapsed); Console.ReadKey(); }}public class GuidHelper{ public static List<Guid> ListOfIds=new List<Guid>(); static GuidHelper() { for (int i = 0; i < 10000; i++) { ListOfIds.Add(Guid.NewGuid()); } }}public class Grade{ public Guid StudentId { get; set; } public string Value { get; set; } public static IEnumerable<Grade> GetData() { for (int i = 0; i < 10000; i++) { yield return new Grade { StudentId = GuidHelper.ListOfIds[i], Value = ""Value "" + i }; } }}public class Student{ public Guid Id { get; set; } public string Name { get; set; } public string Grade { get; set; } public static IEnumerable<Student> GetStudents() { for (int i = 0; i < 10000; i++) { yield return new Student { Id = GuidHelper.ListOfIds[i], Name = ""Name "" + i }; } }}",Why is dictionary so much faster than list?
C# : Why is dictionary so much faster than list?," I am testing the speed of getting data from Dictionary VS list. I've used this code to test : There is list of students and grades in memory they have StudentId in common. In first way I tried to find Grade of a student using LINQ on a list that takes near 7 seconds on my machine and in another way first I converted List into dictionary then finding grades of student from dictionary using key that takes less than a second .  <code>  internal class Program{ private static void Main(string[] args) { var stopwatch = new Stopwatch(); List<Grade> grades = Grade.GetData().ToList(); List<Student> students = Student.GetStudents().ToList(); stopwatch.Start(); foreach (Student student in students) { student.Grade = grades.Single(x => x.StudentId == student.Id).Value; } stopwatch.Stop(); Console.WriteLine(""Using list {0}"", stopwatch.Elapsed); stopwatch.Reset(); students = Student.GetStudents().ToList(); stopwatch.Start(); Dictionary<Guid, string> dic = Grade.GetData().ToDictionary(x => x.StudentId, x => x.Value); foreach (Student student in students) { student.Grade = dic[student.Id]; } stopwatch.Stop(); Console.WriteLine(""Using dictionary {0}"", stopwatch.Elapsed); Console.ReadKey(); }}public class GuidHelper{ public static List<Guid> ListOfIds=new List<Guid>(); static GuidHelper() { for (int i = 0; i < 10000; i++) { ListOfIds.Add(Guid.NewGuid()); } }}public class Grade{ public Guid StudentId { get; set; } public string Value { get; set; } public static IEnumerable<Grade> GetData() { for (int i = 0; i < 10000; i++) { yield return new Grade { StudentId = GuidHelper.ListOfIds[i], Value = ""Value "" + i }; } }}public class Student{ public Guid Id { get; set; } public string Name { get; set; } public string Grade { get; set; } public static IEnumerable<Student> GetStudents() { for (int i = 0; i < 10000; i++) { yield return new Student { Id = GuidHelper.ListOfIds[i], Name = ""Name "" + i }; } }}",Why is dictionary so much faster than list?
MS Access C# Sql-Like function query," I have this query for Ms Access and im using C# and Ole DB commands. It works on Ms Access but when I'm passing the query from C# using OleDB, nothing happened. Anyway here's my code: SQL query C# code <code>  SELECT * FROM tblIssue WHERE id LIKE '*2*' AND dateChecque LIKE '**'AND +issueTo LIKE '**' AND byTheName LIKE '**' AND bankName LIKE '**' AND accountNo LIKE '**' +AND checqueNo LIKE '**' AND amount LIKE '**' AND being LIKE '**' AND whoDeleted LIKE '**' +AND whyDeleted LIKE '**' AND dateCreated LIKE '**'; try{ DataTable newDt = new DataTable(); OleDbDataAdapter newSda = new OleDbDataAdapter(sqlQuery , conn); newSda.Fill(newDt); if (newDt.Rows.Count > 0) { dataGridView1.DataSource = newDt.DefaultView; _hasData = true; } else { _hasData = false; }}catch (Exception error){ MessageBox.Show(error.ToString()); conn.Close();}",MS Access SQL LIKE query from C#
Avoid a lot of if - else checks," I'm developing an app with Entity Framework.I've got a combo box with the names of the tables in the database.I have the following code: how can i avoid all these if-else checks?Is it possible to get the name of a class from a string holding the name?example: <code>  string table = cbTables.SelectedItem.ToString();using (var dbContext = new Entities()) { if (table.Equals(""Person"")) { List<Person> list = (from l in dbContext.People select l).ToList(); } else if (table.Equals(""Student"")) { List<Student> list = (from u in dbContext.Student select u).ToList(); } else if (table.Equals(""Grade"")) { List<Grade> list = (from p in dbContext.Grade select p).ToList();} string = ""Person"";var str = //somethingList<str> list = (from u in dbContext.str select u).ToList();",Avoid a lot of if - else checks - Choose table from string using the entity framework
Specified argument was out of the range of valid values asp.net," I'm adding dynamic Rows in ASP.Net GridView Control with TextBoxes. But I'm getting the error below when I click on my Add New Row button. Specified argument was out of the range of valid values. Parameter name: indexWhat could be the error ?Th code in my .aspx file C# code of ButtonAdd_Click() <code>  <div id=""Div1"" class=""divTable""> <asp:gridview id=""Gridview1"" runat=""server"" autogeneratecolumns=""false"" gridlines=""None"" width=""100%"" height=""100%""> <Columns> <asp:TemplateField> <ItemTemplate> <div class=""divRow""> <div class=""divColumn""> <div> <asp:Label ID=""lbl1"" runat=""server"" Text=""Type Name"" CssClass=""formLable""></asp:Label> </div> <div> <asp:TextBox ID=""txt_type"" Width=""200"" runat=""server"" CssClass=""txtbox""></asp:TextBox> </div> <span> <asp:RequiredFieldValidator ID=""TYPE_NAME_VAL"" runat=""server"" ControlToValidate=""txt_type"" ErrorMessage=""Type is required."" Display=""Dynamic"" CssClass=""error""></asp:RequiredFieldValidator> </span> </div> <div class=""divColumn""> <div> <asp:Label ID=""lbl2"" runat=""server"" Text=""Total"" CssClass=""formLable""></asp:Label> </div> <div> <asp:TextBox ID=""txt_total"" Width=""200"" runat=""server"" CssClass=""txtbox""></asp:TextBox> </div> </div> </div> <div class=""divRow""> <div class=""divColumn""> <div> <asp:Label ID=""lbl3"" runat=""server"" Text=""Max"" CssClass=""formLable""></asp:Label> </div> <div> <asp:TextBox ID=""txt_max"" Width=""200"" runat=""server"" CssClass=""txtbox""></asp:TextBox> </div> </div> <div class=""divColumn""> <div> <asp:Label ID=""lbl4"" runat=""server"" Text=""Min"" CssClass=""formLable""></asp:Label> </div> <div> <asp:TextBox ID=""txt_min"" Width=""200"" runat=""server"" CssClass=""txtbox""></asp:TextBox> </div> </div> <div class=""divColumn""> <div> <asp:Label ID=""lbl5"" runat=""server"" Text=""Rate"" CssClass=""formLable""></asp:Label> </div> <div> <asp:TextBox ID=""txt_rate"" Width=""200"" runat=""server"" CssClass=""txtbox""></asp:TextBox> </div> </div> </div> <asp:Button ID=""ButtonAdd"" runat=""server"" Text=""Add New Row"" OnClick=""ButtonAdd_Click"" CausesValidation=""False"" /> </ItemTemplate> </asp:TemplateField> </Columns> </asp:gridview></div> if (ViewState[""CurrentTable""] != null){ DataTable dtCurrentTable = (DataTable)ViewState[""CurrentTable""]; DataRow drCurrentRow = null; if (dtCurrentTable.Rows.Count > 0) { for (int i = 1; i <= dtCurrentTable.Rows.Count; i++) { //extract the TextBox values TextBox box1 = (TextBox)Gridview1.Rows[rowIndex].Cells[1].FindControl(""txt_type""); TextBox box2 = (TextBox)Gridview1.Rows[rowIndex].Cells[2].FindControl(""txt_total""); TextBox box3 = (TextBox)Gridview1.Rows[rowIndex].Cells[3].FindControl(""txt_max""); TextBox box4 = (TextBox)Gridview1.Rows[rowIndex].Cells[4].FindControl(""txt_min""); TextBox box5 = (TextBox)Gridview1.Rows[rowIndex].Cells[5].FindControl(""txt_rate""); drCurrentRow = dtCurrentTable.NewRow(); dtCurrentTable.Rows[i - 1][""Column1""] = box1.Text; dtCurrentTable.Rows[i - 1][""Column2""] = box2.Text; dtCurrentTable.Rows[i - 1][""Column3""] = box3.Text; dtCurrentTable.Rows[i - 1][""Column4""] = box4.Text; dtCurrentTable.Rows[i - 1][""Column5""] = box5.Text; rowIndex++; } dtCurrentTable.Rows.Add(drCurrentRow); ViewState[""CurrentTable""] = dtCurrentTable; Gridview1.DataSource = dtCurrentTable; Gridview1.DataBind(); }}else{ Response.Write(""ViewState is null"");}","""Specified argument was out of the range of valid values"""
C# compiler optimisation when returning strings, If I have and Is this the same? Is the compiler able to remove s?How about ?Thanks. <code>  private string Foo(string decrypted){ return decrypted.Substring(blah);} private string Foo(string decrypted){ string s = decrypted.Substring(blah); return s;} private string Foo(string decrypted){ string s = decrypted.Substring(blah); string t = s; return t;},compiler optimisation when returning strings
"Azure Project package working from VS, failing from command line with error MSB4096"," I have a solution with a Windows Azure Cloud Services project, that compiles fine from VS and command line.If I try to make a package, it works fine from VS, but fails from command line.Here is my command line from Powershell: I have this error: EDITFew interesting things:Here is my csdef file As you can see, I have two websites on one WebRole.Now, let's have a look at the ccproj file: Only two projects are referenced in the ccproj instead of 3.The cloud project has 3 dependencies in the sln.If I had a reference by hand in the ccproj like this: I have this error: Now if I update the reference like this: I have this error: <code>  C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe .\project.sln --% /p:Configuration=""QA"" /p:TargetProfile=""CloudQA"" /p:Platform=""Any CPU"" /target:Publish/nr:false ""C:\CI\project\project.sln"" (Publish target) (1) ->""C:\CI\project\WindowsAzure\WindowsAzure.ccproj.metaproj"" (Publish target) (11) ->""C:\CI\project\WindowsAzure\WindowsAzure.ccproj"" (Publish target) (12) ->(PrepareRoleItems target) -> C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v11.0\Windows Azure Tools\2.0\Microsoft.WindowsAzure.targets(1302,5): error MSB4096: The item ""C:\CI\project\project.WebAPI\project.WebAPI.csproj"" in item list ""ProjectReferenceWithConfiguration"" does not define a value for metadata ""Name"". In order to use this metadata, either qualify it by specifying %(ProjectReferenceWithConfiguration.Name), or ensure that all items in this list define a value forthis metadata. [C:\CI\project\WindowsAzure\WindowsAzure.ccproj] <WorkerRole name=""ProjectWorker"" vmsize=""ExtraSmall""> <Imports> <Import moduleName=""Diagnostics"" /> </Imports> <Endpoints> <InternalEndpoint name=""InternalEndpoint1"" protocol=""http"" /> </Endpoints> <ConfigurationSettings> </ConfigurationSettings></WorkerRole><WebRole name=""Project.Web"" vmsize=""ExtraSmall""> <Sites> <Site name=""Web""> <Bindings> <Binding name=""http"" endpointName=""http"" /> </Bindings> </Site> <Site name=""Api"" physicalDirectory=""..\..\..\Project.WebAPI""> <Bindings> <Binding name=""http"" endpointName=""http81"" /> </Bindings> </Site> </Sites> <Endpoints> <InputEndpoint name=""http"" protocol=""http"" port=""80"" /> <InputEndpoint name=""http81"" protocol=""http"" port=""81"" /> </Endpoints> <Imports> <Import moduleName=""Diagnostics"" /> </Imports></WebRole> <ItemGroup> <ProjectReference Include=""..\Project.Web\Project.Web.csproj""> <Name>Project.Web</Name> <Project>{5d000123-0000-4b6e-b5fa-72525afca7f5}</Project> <Private>True</Private> <RoleType>Web</RoleType> <RoleName>Project.Web</RoleName> <UpdateDiagnosticsConnectionStringOnPublish>True</UpdateDiagnosticsConnectionStringOnPublish> </ProjectReference> <ProjectReference Include=""..\ProjectWorker\ProjectWorker.csproj""> <Name>ProjectWorker</Name> <Project>{22e99999-1000-4559-8507-a948b7e3d1b0}</Project> <Private>True</Private> <RoleType>Worker</RoleType> <RoleName>ProjectWorker</RoleName> <UpdateDiagnosticsConnectionStringOnPublish>True</UpdateDiagnosticsConnectionStringOnPublish> </ProjectReference></ItemGroup> <ProjectReference Include=""..\Project.WebAPI\Project.WebAPI.csproj""> <Name>Project.Web</Name> <Project>{A0F88888-3333-4823-A34F-5F01F0A3FFFF}</Project> <Private>True</Private> <RoleType>Web</RoleType> <RoleName>Project.WebAPI</RoleName> <UpdateDiagnosticsConnectionStringOnPublish>True</UpdateDiagnosticsConnectionStringOnPublish></ProjectReference> C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v11.0\Windows Azure Tools\2.0\Microsoft.WindowsAzure.targets(987,5): error : CloudServices25 : Multiple directories are specified for role Project.Web. [C:\CI\project\WindowsAzure\WindowsAzure.ccproj] <ProjectReference Include=""..\Project.WebAPI\Project.WebAPI.csproj""> <Name>Project.WebAPI</Name> <Project>{A0F88888-3333-4823-A34F-5F01F0A3FFFF}</Project> <Private>True</Private> <RoleType>Web</RoleType> <RoleName>Project.Web</RoleName> <UpdateDiagnosticsConnectionStringOnPublish>True</UpdateDiagnosticsConnectionStringOnPublish></ProjectReference> C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v11.0\Windows Azure Tools\2.0\Microsoft.WindowsAzure.targets(987,5): error : CloudServices26 : Cannot find role named 'Project.WebAPI' in service description file C:\CI\project\WindowsAzure\bin\UAT\ServiceDefinition.csdef. [C:\CI\project\WindowsAzure\WindowsAzure.ccproj]","Azure Project build package working from VS, failing from command line with error MSB4096"
Microsoft Office interop perfomence issue," I am try to exporting datagridview data to excel file in my C# 4.0 Windows application. we used Microsoft.Office.Interop.Excel dll version 12.0.0.0. It's works well and everythingis fine. But i when i try to export more than 1000 datagridview records it's take too longtime.How can i improve the performance.Please see this Excel helper code below. <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.IO;using Microsoft.Office.Interop.Excel;using Microsoft.Office.Core;using System.Runtime.InteropServices; // For COMExceptionusing System.Reflection; // For Missing.Value and BindingFlagsusing System.Diagnostics; // to ensure EXCEL process is really killednamespace Export.Excel{ #region InstanceFields //Instance Fields //public delegate void ProgressHandler(object sender, ProgressEventArgs e); //public event ProgressHandler prg; private System.Data.DataView dv; private Style styleRows; private Style styleColumnHeadings; private Microsoft.Office.Interop.Excel.Application EXL; private Workbook workbook; private Sheets sheets; private Worksheet worksheet; private string[,] myTemplateValues; private int position; private System.Globalization.CultureInfo cl; private Type _ResourceType; #endregion #region Constructor //Constructs a new export2Excel object. The user must //call the createExcelDocument method once a valid export2Excel //object has been instantiated public ExportExcelFormat(string culture, Type type) { cl = new System.Globalization.CultureInfo(culture); _ResourceType = type; } #endregion #region EXCEL : ExportToExcel //Exports a DataView to Excel. The following steps are carried out //in order to export the DataView to Excel //Create Excel Objects //Create Column & Row Workbook Cell Rendering Styles //Fill Worksheet With DataView //Add Auto Shapes To Excel Worksheet //Select All Used Cells //Create Headers/Footers //Set Status Finished //Save workbook & Tidy up all objects //@param dv : DataView to use //@param path : The path to save/open the EXCEL file to/from //@param sheetName : The target sheet within the EXCEL file public void ExportToExcel(System.Data.DataView dv, string path, string sheetName, string[] UnWantedColumns) { try { //Assign Instance Fields this.dv = dv; #region NEW EXCEL DOCUMENT : Create Excel Objects //create new EXCEL application EXL = new Microsoft.Office.Interop.Excel.ApplicationClass(); //index to hold location of the requested sheetName in the workbook sheets //collection int indexOfsheetName; #region FILE EXISTS //Does the file exist for the given path if (File.Exists(path)) { //Yes file exists, so open the file workbook = EXL.Workbooks.Open(path, 0, false, 5, """", """", false, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows, """", true, false, 0, true, false, false); //get the workbook sheets collection sheets = workbook.Sheets; //set the location of the requested sheetName to -1, need to find where //it is. It may not actually exist indexOfsheetName = -1; //loop through the sheets collection for (int i = 1; i <= sheets.Count; i++) { //get the current worksheet at index (i) worksheet = (Worksheet)sheets.get_Item(i); //is the current worksheet the sheetName that was requested if (worksheet.Name.ToString().Equals(sheetName)) { //yes it is, so store its index indexOfsheetName = i; //Select all cells, and clear the contents Microsoft.Office.Interop.Excel.Range myAllRange = worksheet.Cells; myAllRange.Select(); myAllRange.CurrentRegion.Select(); myAllRange.ClearContents(); } } //At this point it is known that the sheetName that was requested //does not exist within the found file, so create a new sheet within the //sheets collection if (indexOfsheetName == -1) { //Create a new sheet for the requested sheet Worksheet sh = (Worksheet)workbook.Sheets.Add( Type.Missing, (Worksheet)sheets.get_Item(sheets.Count), Type.Missing, Type.Missing); //Change its name to that requested sh.Name = sheetName; } } #endregion #region FILE DOESNT EXIST //No the file DOES NOT exist, so create a new file else { //Add a new workbook to the file workbook = EXL.Workbooks.Add(XlWBATemplate.xlWBATWorksheet); //get the workbook sheets collection sheets = workbook.Sheets; //get the new sheet worksheet = (Worksheet)sheets.get_Item(1); //Change its name to that requested worksheet.Name = sheetName; } #endregion #region get correct worksheet index for requested sheetName //get the workbook sheets collection sheets = workbook.Sheets; //set the location of the requested sheetName to -1, need to find where //it is. It will definately exist now as it has just been added indexOfsheetName = -1; //loop through the sheets collection for (int i = 1; i <= sheets.Count; i++) { //get the current worksheet at index (i) worksheet = (Worksheet)sheets.get_Item(i); //is the current worksheet the sheetName that was requested if (worksheet.Name.ToString().Equals(sheetName)) { //yes it is, so store its index indexOfsheetName = i; } } //set the worksheet that the DataView should write to, to the known index of the //requested sheet worksheet = (Worksheet)sheets.get_Item(indexOfsheetName); #endregion #endregion // Set styles 1st SetUpStyles(); //Fill EXCEL worksheet with DataView values fillWorksheet_WithDataView(UnWantedColumns); //Add the autoshapes to EXCEL //AddAutoShapesToExcel(); //Select all used cells within current worksheet SelectAllUsedCells(); try { workbook.Close(true, path, Type.Missing); EXL.UserControl = false; EXL.Quit(); EXL = null; //kill the EXCEL process as a safety measure killExcel(); } catch (COMException cex) { } catch (Exception ex) { } } catch (Exception ex) { } } #endregion #region EXCEL : UseTemplate //Exports a DataView to Excel. The following steps are carried out //in order to export the DataView to Excel //Create Excel Objects And Open Template File //Select All Used Cells //Create Headers/Footers //Set Status Finished //Save workbook & Tidy up all objects //@param path : The path to save/open the EXCEL file to/from public void UseTemplate(string path, string templatePath, string[,] myTemplateValues) { try { this.myTemplateValues = myTemplateValues; //create new EXCEL application EXL = new Microsoft.Office.Interop.Excel.ApplicationClass(); //Yes file exists, so open the file workbook = EXL.Workbooks.Open(templatePath, 0, false, 5, """", """", false, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows, """", true, false, 0, true, false, false); //get the workbook sheets collection sheets = workbook.Sheets; //get the new sheet worksheet = (Worksheet)sheets.get_Item(1); //Change its name to that requested worksheet.Name = ""ATemplate""; //Fills the Excel Template File Selected With A 2D Test Array fillTemplate_WithTestValues(); //Select all used cells within current worksheet SelectAllUsedCells(); try { workbook.Close(true, path, Type.Missing); EXL.UserControl = false; EXL.Quit(); EXL = null; //kill the EXCEL process as a safety measure killExcel(); } catch (COMException) { } } catch (Exception ex) { } } #endregion #region STEP 1 : Create Column & Row Workbook Cell Rendering Styles //Creates 2 Custom styles for the workbook These styles are // styleColumnHeadings // styleRows //These 2 styles are used when filling the individual Excel cells with the //DataView values. If the current cell relates to a DataView column heading //then the style styleColumnHeadings will be used to render the current cell. //If the current cell relates to a DataView row then the style styleRows will //be used to render the current cell. private void SetUpStyles() { // Style styleColumnHeadings try { styleColumnHeadings = workbook.Styles[""styleColumnHeadings""]; } // Style doesn't exist yet. catch { styleColumnHeadings = workbook.Styles.Add(""styleColumnHeadings"", Type.Missing); styleColumnHeadings.Font.Name = ""Arial""; styleColumnHeadings.Font.Size = 12; styleColumnHeadings.Font.Bold = true; } // Style styleRows try { styleRows = workbook.Styles[""styleRows""]; } // Style doesn't exist yet. catch { styleRows = workbook.Styles.Add(""styleRows"", Type.Missing); styleRows.Font.Name = ""Verdana""; styleRows.Font.Size = 9; } } #endregion #region STEP 2 : Fill Worksheet With DataView //Fills an Excel worksheet with the values contained in the DataView //parameter private void fillWorksheet_WithDataView(string[] UnWantedColumns) { position = 0; //Add DataView Columns To Worksheet int row = 1; int col = 1; // Remove unwanted columns in the loop int total = dv.Table.Columns.Count - UnWantedColumns.Count(); // Loop thought the columns for (int i = 0; i < total; i++) { fillExcelCell(worksheet, row, col++, dv.Table.Columns[i].ToString(), styleColumnHeadings.Name, UnWantedColumns); } //Add DataView Rows To Worksheet row = 2; col = 1; for (int i = 0; i < dv.Table.Rows.Count; i++) { for (int j = 0; j < dv.Table.Columns.Count; j++) { fillExcelCell(worksheet, row, col++, dv[i][j].ToString(), styleRows.Name, UnWantedColumns); } col = 1; row++; position = (100 / dv.Table.Rows.Count) * row + 2; } } #endregion #region STEP 3 : Fill Individual Cell and Render Using Predefined Style //Formats the current cell based on the Style setting parameter name //provided here //@param worksheet : The worksheet //@param row : Current row //@param col : Current Column //@param Value : The value for the cell //@param StyleName : The style name to use private void fillExcelCell(Worksheet worksheet, int row, int col, Object Value, string StyleName, string[] UnWantedColumns) { if (!UnWantedColumns.Contains(Value.ToString())) { Range rng = (Range)worksheet.Cells[row, col]; rng.NumberFormat = ""@""; rng.Select(); rng.Value2 = Value.ToString(); rng.Style = StyleName; rng.Columns.EntireColumn.AutoFit(); } } #endregion #region STEP 4 : Add Auto Shapes To Excel Worksheet //Add some WordArt objecs to the Excel worksheet private void AddAutoShapesToExcel() { //Method fields float txtSize = 80; float Left = 100.0F; float Top = 100.0F; //Have 2 objects int[] numShapes = new int[2]; Microsoft.Office.Interop.Excel.Shape[] myShapes = new Microsoft.Office.Interop.Excel.Shape[numShapes.Length]; try { //loop through the object count for (int i = 0; i < numShapes.Length; i++) { //Add the object to Excel myShapes[i] = worksheet.Shapes.AddTextEffect(MsoPresetTextEffect.msoTextEffect1, ""DRAFT"", ""Arial Black"", txtSize, MsoTriState.msoFalse, MsoTriState.msoFalse, (Left * (i * 3)), Top); //Manipulate the object settings myShapes[i].Rotation = 45F; myShapes[i].Fill.Visible = Microsoft.Office.Core.MsoTriState.msoFalse; myShapes[i].Fill.Transparency = 0F; myShapes[i].Line.Weight = 1.75F; myShapes[i].Line.DashStyle = MsoLineDashStyle.msoLineSolid; myShapes[i].Line.Transparency = 0F; myShapes[i].Line.Visible = Microsoft.Office.Core.MsoTriState.msoTrue; myShapes[i].Line.ForeColor.RGB = (0 << 16) | (0 << 8) | 0; myShapes[i].Line.BackColor.RGB = (255 << 16) | (255 << 8) | 255; } } catch (Exception ex) { } } #endregion #region STEP 5 : Select All Used Cells //Selects all used cells for the Excel worksheet private void SelectAllUsedCells() { Microsoft.Office.Interop.Excel.Range myAllRange = worksheet.Cells; myAllRange.Select(); myAllRange.CurrentRegion.Select(); } #endregion #region STEP 6 : Fill Template With Test Values //Fills the Excel Template File Selected With A 2D Test Array parameter private void fillTemplate_WithTestValues() { //Initilaise the correct Start Row/Column to match the Template int StartRow = 3; int StartCol = 2; position = 0; // Display the array elements within the Output window, make sure its correct before for (int i = 0; i <= myTemplateValues.GetUpperBound(0); i++) { //loop through array and put into EXCEL template for (int j = 0; j <= myTemplateValues.GetUpperBound(1); j++) { //update position in progress bar position = (100 / myTemplateValues.Length) * i; //put into EXCEL template Range rng = (Range)worksheet.Cells[StartRow, StartCol++]; rng.Select(); rng.Value2 = myTemplateValues[i, j].ToString(); rng.Rows.EntireRow.AutoFit(); } //New row, so column needs to be reset StartCol = 2; StartRow++; } } #endregion #region Kill EXCEL //As a safety check go through all processes and make //doubly sure excel is shutdown. Working with COM //have sometimes noticed that the EXL.Quit() call //does always do the job private void killExcel() { try { Process[] ps = Process.GetProcesses(); foreach (Process p in ps) { if (p.ProcessName.ToLower().Equals(""excel"")) { p.Kill(); } } } catch (Exception ex) { } } #endregion}",Microsoft Office interop performance issue
Microsoft Office interop perfomance issue," I am try to exporting datagridview data to excel file in my C# 4.0 Windows application. we used Microsoft.Office.Interop.Excel dll version 12.0.0.0. It's works well and everythingis fine. But i when i try to export more than 1000 datagridview records it's take too longtime.How can i improve the performance.Please see this Excel helper code below. <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.IO;using Microsoft.Office.Interop.Excel;using Microsoft.Office.Core;using System.Runtime.InteropServices; // For COMExceptionusing System.Reflection; // For Missing.Value and BindingFlagsusing System.Diagnostics; // to ensure EXCEL process is really killednamespace Export.Excel{ #region InstanceFields //Instance Fields //public delegate void ProgressHandler(object sender, ProgressEventArgs e); //public event ProgressHandler prg; private System.Data.DataView dv; private Style styleRows; private Style styleColumnHeadings; private Microsoft.Office.Interop.Excel.Application EXL; private Workbook workbook; private Sheets sheets; private Worksheet worksheet; private string[,] myTemplateValues; private int position; private System.Globalization.CultureInfo cl; private Type _ResourceType; #endregion #region Constructor //Constructs a new export2Excel object. The user must //call the createExcelDocument method once a valid export2Excel //object has been instantiated public ExportExcelFormat(string culture, Type type) { cl = new System.Globalization.CultureInfo(culture); _ResourceType = type; } #endregion #region EXCEL : ExportToExcel //Exports a DataView to Excel. The following steps are carried out //in order to export the DataView to Excel //Create Excel Objects //Create Column & Row Workbook Cell Rendering Styles //Fill Worksheet With DataView //Add Auto Shapes To Excel Worksheet //Select All Used Cells //Create Headers/Footers //Set Status Finished //Save workbook & Tidy up all objects //@param dv : DataView to use //@param path : The path to save/open the EXCEL file to/from //@param sheetName : The target sheet within the EXCEL file public void ExportToExcel(System.Data.DataView dv, string path, string sheetName, string[] UnWantedColumns) { try { //Assign Instance Fields this.dv = dv; #region NEW EXCEL DOCUMENT : Create Excel Objects //create new EXCEL application EXL = new Microsoft.Office.Interop.Excel.ApplicationClass(); //index to hold location of the requested sheetName in the workbook sheets //collection int indexOfsheetName; #region FILE EXISTS //Does the file exist for the given path if (File.Exists(path)) { //Yes file exists, so open the file workbook = EXL.Workbooks.Open(path, 0, false, 5, """", """", false, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows, """", true, false, 0, true, false, false); //get the workbook sheets collection sheets = workbook.Sheets; //set the location of the requested sheetName to -1, need to find where //it is. It may not actually exist indexOfsheetName = -1; //loop through the sheets collection for (int i = 1; i <= sheets.Count; i++) { //get the current worksheet at index (i) worksheet = (Worksheet)sheets.get_Item(i); //is the current worksheet the sheetName that was requested if (worksheet.Name.ToString().Equals(sheetName)) { //yes it is, so store its index indexOfsheetName = i; //Select all cells, and clear the contents Microsoft.Office.Interop.Excel.Range myAllRange = worksheet.Cells; myAllRange.Select(); myAllRange.CurrentRegion.Select(); myAllRange.ClearContents(); } } //At this point it is known that the sheetName that was requested //does not exist within the found file, so create a new sheet within the //sheets collection if (indexOfsheetName == -1) { //Create a new sheet for the requested sheet Worksheet sh = (Worksheet)workbook.Sheets.Add( Type.Missing, (Worksheet)sheets.get_Item(sheets.Count), Type.Missing, Type.Missing); //Change its name to that requested sh.Name = sheetName; } } #endregion #region FILE DOESNT EXIST //No the file DOES NOT exist, so create a new file else { //Add a new workbook to the file workbook = EXL.Workbooks.Add(XlWBATemplate.xlWBATWorksheet); //get the workbook sheets collection sheets = workbook.Sheets; //get the new sheet worksheet = (Worksheet)sheets.get_Item(1); //Change its name to that requested worksheet.Name = sheetName; } #endregion #region get correct worksheet index for requested sheetName //get the workbook sheets collection sheets = workbook.Sheets; //set the location of the requested sheetName to -1, need to find where //it is. It will definately exist now as it has just been added indexOfsheetName = -1; //loop through the sheets collection for (int i = 1; i <= sheets.Count; i++) { //get the current worksheet at index (i) worksheet = (Worksheet)sheets.get_Item(i); //is the current worksheet the sheetName that was requested if (worksheet.Name.ToString().Equals(sheetName)) { //yes it is, so store its index indexOfsheetName = i; } } //set the worksheet that the DataView should write to, to the known index of the //requested sheet worksheet = (Worksheet)sheets.get_Item(indexOfsheetName); #endregion #endregion // Set styles 1st SetUpStyles(); //Fill EXCEL worksheet with DataView values fillWorksheet_WithDataView(UnWantedColumns); //Add the autoshapes to EXCEL //AddAutoShapesToExcel(); //Select all used cells within current worksheet SelectAllUsedCells(); try { workbook.Close(true, path, Type.Missing); EXL.UserControl = false; EXL.Quit(); EXL = null; //kill the EXCEL process as a safety measure killExcel(); } catch (COMException cex) { } catch (Exception ex) { } } catch (Exception ex) { } } #endregion #region EXCEL : UseTemplate //Exports a DataView to Excel. The following steps are carried out //in order to export the DataView to Excel //Create Excel Objects And Open Template File //Select All Used Cells //Create Headers/Footers //Set Status Finished //Save workbook & Tidy up all objects //@param path : The path to save/open the EXCEL file to/from public void UseTemplate(string path, string templatePath, string[,] myTemplateValues) { try { this.myTemplateValues = myTemplateValues; //create new EXCEL application EXL = new Microsoft.Office.Interop.Excel.ApplicationClass(); //Yes file exists, so open the file workbook = EXL.Workbooks.Open(templatePath, 0, false, 5, """", """", false, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows, """", true, false, 0, true, false, false); //get the workbook sheets collection sheets = workbook.Sheets; //get the new sheet worksheet = (Worksheet)sheets.get_Item(1); //Change its name to that requested worksheet.Name = ""ATemplate""; //Fills the Excel Template File Selected With A 2D Test Array fillTemplate_WithTestValues(); //Select all used cells within current worksheet SelectAllUsedCells(); try { workbook.Close(true, path, Type.Missing); EXL.UserControl = false; EXL.Quit(); EXL = null; //kill the EXCEL process as a safety measure killExcel(); } catch (COMException) { } } catch (Exception ex) { } } #endregion #region STEP 1 : Create Column & Row Workbook Cell Rendering Styles //Creates 2 Custom styles for the workbook These styles are // styleColumnHeadings // styleRows //These 2 styles are used when filling the individual Excel cells with the //DataView values. If the current cell relates to a DataView column heading //then the style styleColumnHeadings will be used to render the current cell. //If the current cell relates to a DataView row then the style styleRows will //be used to render the current cell. private void SetUpStyles() { // Style styleColumnHeadings try { styleColumnHeadings = workbook.Styles[""styleColumnHeadings""]; } // Style doesn't exist yet. catch { styleColumnHeadings = workbook.Styles.Add(""styleColumnHeadings"", Type.Missing); styleColumnHeadings.Font.Name = ""Arial""; styleColumnHeadings.Font.Size = 12; styleColumnHeadings.Font.Bold = true; } // Style styleRows try { styleRows = workbook.Styles[""styleRows""]; } // Style doesn't exist yet. catch { styleRows = workbook.Styles.Add(""styleRows"", Type.Missing); styleRows.Font.Name = ""Verdana""; styleRows.Font.Size = 9; } } #endregion #region STEP 2 : Fill Worksheet With DataView //Fills an Excel worksheet with the values contained in the DataView //parameter private void fillWorksheet_WithDataView(string[] UnWantedColumns) { position = 0; //Add DataView Columns To Worksheet int row = 1; int col = 1; // Remove unwanted columns in the loop int total = dv.Table.Columns.Count - UnWantedColumns.Count(); // Loop thought the columns for (int i = 0; i < total; i++) { fillExcelCell(worksheet, row, col++, dv.Table.Columns[i].ToString(), styleColumnHeadings.Name, UnWantedColumns); } //Add DataView Rows To Worksheet row = 2; col = 1; for (int i = 0; i < dv.Table.Rows.Count; i++) { for (int j = 0; j < dv.Table.Columns.Count; j++) { fillExcelCell(worksheet, row, col++, dv[i][j].ToString(), styleRows.Name, UnWantedColumns); } col = 1; row++; position = (100 / dv.Table.Rows.Count) * row + 2; } } #endregion #region STEP 3 : Fill Individual Cell and Render Using Predefined Style //Formats the current cell based on the Style setting parameter name //provided here //@param worksheet : The worksheet //@param row : Current row //@param col : Current Column //@param Value : The value for the cell //@param StyleName : The style name to use private void fillExcelCell(Worksheet worksheet, int row, int col, Object Value, string StyleName, string[] UnWantedColumns) { if (!UnWantedColumns.Contains(Value.ToString())) { Range rng = (Range)worksheet.Cells[row, col]; rng.NumberFormat = ""@""; rng.Select(); rng.Value2 = Value.ToString(); rng.Style = StyleName; rng.Columns.EntireColumn.AutoFit(); } } #endregion #region STEP 4 : Add Auto Shapes To Excel Worksheet //Add some WordArt objecs to the Excel worksheet private void AddAutoShapesToExcel() { //Method fields float txtSize = 80; float Left = 100.0F; float Top = 100.0F; //Have 2 objects int[] numShapes = new int[2]; Microsoft.Office.Interop.Excel.Shape[] myShapes = new Microsoft.Office.Interop.Excel.Shape[numShapes.Length]; try { //loop through the object count for (int i = 0; i < numShapes.Length; i++) { //Add the object to Excel myShapes[i] = worksheet.Shapes.AddTextEffect(MsoPresetTextEffect.msoTextEffect1, ""DRAFT"", ""Arial Black"", txtSize, MsoTriState.msoFalse, MsoTriState.msoFalse, (Left * (i * 3)), Top); //Manipulate the object settings myShapes[i].Rotation = 45F; myShapes[i].Fill.Visible = Microsoft.Office.Core.MsoTriState.msoFalse; myShapes[i].Fill.Transparency = 0F; myShapes[i].Line.Weight = 1.75F; myShapes[i].Line.DashStyle = MsoLineDashStyle.msoLineSolid; myShapes[i].Line.Transparency = 0F; myShapes[i].Line.Visible = Microsoft.Office.Core.MsoTriState.msoTrue; myShapes[i].Line.ForeColor.RGB = (0 << 16) | (0 << 8) | 0; myShapes[i].Line.BackColor.RGB = (255 << 16) | (255 << 8) | 255; } } catch (Exception ex) { } } #endregion #region STEP 5 : Select All Used Cells //Selects all used cells for the Excel worksheet private void SelectAllUsedCells() { Microsoft.Office.Interop.Excel.Range myAllRange = worksheet.Cells; myAllRange.Select(); myAllRange.CurrentRegion.Select(); } #endregion #region STEP 6 : Fill Template With Test Values //Fills the Excel Template File Selected With A 2D Test Array parameter private void fillTemplate_WithTestValues() { //Initilaise the correct Start Row/Column to match the Template int StartRow = 3; int StartCol = 2; position = 0; // Display the array elements within the Output window, make sure its correct before for (int i = 0; i <= myTemplateValues.GetUpperBound(0); i++) { //loop through array and put into EXCEL template for (int j = 0; j <= myTemplateValues.GetUpperBound(1); j++) { //update position in progress bar position = (100 / myTemplateValues.Length) * i; //put into EXCEL template Range rng = (Range)worksheet.Cells[StartRow, StartCol++]; rng.Select(); rng.Value2 = myTemplateValues[i, j].ToString(); rng.Rows.EntireRow.AutoFit(); } //New row, so column needs to be reset StartCol = 2; StartRow++; } } #endregion #region Kill EXCEL //As a safety check go through all processes and make //doubly sure excel is shutdown. Working with COM //have sometimes noticed that the EXL.Quit() call //does always do the job private void killExcel() { try { Process[] ps = Process.GetProcesses(); foreach (Process p in ps) { if (p.ProcessName.ToLower().Equals(""excel"")) { p.Kill(); } } } catch (Exception ex) { } } #endregion}",Microsoft Office interop performance issue
C# - generic extension method on IQueryable<T>," I've written an extension method on IQueryable which returns the same type of IQueryable, just filtered a bit.Let's say it's something like that: calling the above method is as simple as someLinqResult.Foo(2)I need other method that will return instance of other generic class, but with other base class (not the same as source T above).So, here's the code, let's assume this method is supposed to return a list of given type (other than the input type which IQueryable has!) but the same length [the actual problem is about transforming NHibernate query results, but it doesn't matter): now, given that the strLinqResult is IQueryable<string>, I need to call it strLinqResult.Bar<int,string>();.The point is I have to pass both types, even though the first one is already known as I'm calling the method on already defined IQuerable. Since it was enough to call Foo(2) and not Foo<string>(2) I thought the compiler is able to ""pass/guess"" the type automatically. So why do I need to call the second method Bar<int,string>(); and not just Bar<int>() ?the actual code: ApplyListRequestParams is kind of Foo method from the example code - it just applies pagination & ordering params available in ListRequest object.Items is a public List<T> Items in a class ListResponse<T>. TranslateTo is a method from ServiceStack. The above method called on IQueryable<T> returned by NHibernate (T is Domain Model) takes the request parameters (ordering, pagination), applies them, and then transforms the results list from DomainModel to DTO Object of type TResponse. The list is then wrapped in a generic response class (generic, so it is reusable for many DTO types) <code>  public static IEnumerable<T> Foo<T>(this IEnumerable<T> source, int? howmany = null){ if (howmany.HasValue) return source.Take(howmany.Value); return source;} public static List<TTarget> Bar<TTarget,TSource>(this IEnumerable<TSource> source){ return new List<TTarget>(source.Count());} public static ListResponse<TResponse> BuildListResponse<T,TResponse>(this IQueryable<T> iq, ListRequest request) where TResponse: new() { var result = iq.ApplyListRequestParams(request).ToList().ConvertAll(x => x.TranslateTo<TResponse>()); var tcount = iq.Count(); return new ListResponse<TResponse> { Items = result, _TotalCount = tcount, _PageNumber = request._PageNumber ?? 1, }; }",generic extension method on IQueryable<T>
Why dont changes to database save?," I have following C# code in a console application.Whenever I debug the application and run the query1 (which inserts a new value into the database) and then run query2 (which displays all the entries in the database), I can see the new entry I inserted clearly. However, when I close the application and check the table in the database (in Visual Studio), it is gone. I have no idea why it is not saving. EDIT: Forgot to mention that I am using SQL Server Compact Edition 4 and VS2012 Express. <code>  using System;using System.Collections.Generic;using System.Data.Entity;using System.Linq;using System.Text;using System.Threading.Tasks;using System.Data.SqlServerCe;using System.Data;namespace ConsoleApplication1{ class Program { static void Main(string[] args) { try { string fileName = ""FlowerShop.sdf""; string fileLocation = ""|DataDirectory|\\""; DatabaseAccess dbAccess = new DatabaseAccess(); dbAccess.Connect(fileName, fileLocation); Console.WriteLine(""Connected to the following database:\n""+fileLocation + fileName+""\n""); string query = ""Insert into Products(Name, UnitPrice, UnitsInStock) values('NewItem', 500, 90)""; string res = dbAccess.ExecuteQuery(query); Console.WriteLine(res); string query2 = ""Select * from Products""; string res2 = dbAccess.QueryData(query2); Console.WriteLine(res2); Console.ReadLine(); } catch (Exception e) { Console.WriteLine(e); Console.ReadLine(); } } } class DatabaseAccess { private SqlCeConnection _connection; public void Connect(string fileName, string fileLocation) { Connect(@""Data Source="" + fileLocation + fileName); } public void Connect(string connectionString) { _connection = new SqlCeConnection(connectionString); } public string QueryData(string query) { _connection.Open(); using (SqlCeDataAdapter da = new SqlCeDataAdapter(query, _connection)) using (DataSet ds = new DataSet(""Data Set"")) { da.Fill(ds); _connection.Close(); return ds.Tables[0].ToReadableString(); // a extension method I created } } public string ExecuteQuery(string query) { _connection.Open(); using (SqlCeCommand c = new SqlCeCommand(query, _connection)) { int r = c.ExecuteNonQuery(); _connection.Close(); return r.ToString(); } } }",Why saving changes to a database fails?
How to tell an constructor he should only use primitiv types," I created an Class which is only able to handle primitive (or ICloneable) TypesI want to know if it's possible to say something like: or do I really need to create a constructor for each primitive type like: What I am trying to achieve is to create an object with 3 public properties Value, Original and IsDirty.The Value will be an deep Clone of Original so the Original needs to be primitve or ICloneable <code>  public myobject(primitiv original){...} public myobject(int original){...} public myobject(bool original){...} ...",How to tell a constructor it should only use primitive types
Using my own method with LINQ," I have a project with LINQ and I want to use my own method in it. This NoWhiteSpaces method should return upper string with no spaces. When I want to use this method with LINQ, like this: I get this error message: LINQ to Entities does not recognize the method 'System.String NoWhiteSpaces(System.String)' method, and this method cannot be translated into a store expression.Any solution? Thank you for your time. <code>  public static class LittleExtensions{ public static string NoWhiteSpaces(this String s) { return Regex.Replace(s, @""\s"", string.Empty).ToUpper(); }} static void GetHaendler() { using (var riaService = new gkmRia()) { var hladany = ""someone""; var haendlers = from hndlr in riaService.GetGkmHaendlerOutlet() where hndlr.NameOutlet.NoWhiteSpaces() == hladany.NoWhiteSpaces() select hndlr; Console.Write(haendlers.First().NameOutlet); } }",Using my own method with LINQ to Entities
C# comparing two string[]," Say we have 5 string arrays as such: Is there a method to compare these strings to each other without looping through them in C# such that only a and c would yield the boolean true? In other words, all elements must be equal and the array must be the same size? Again, without using a loop if possible. <code>  string[] a = {""The"",""Big"", ""Ant""};string[] b = {""Big"",""Ant"",""Ran""};string[] c = {""The"",""Big"",""Ant""};string[] d = {""No"",""Ants"",""Here""};string[] e = {""The"", ""Big"", ""Ant"", ""Ran"", ""Too"", ""Far""};",Comparing two string arrays in C#
C# comparing two string arrays," Say we have 5 string arrays as such: Is there a method to compare these strings to each other without looping through them in C# such that only a and c would yield the boolean true? In other words, all elements must be equal and the array must be the same size? Again, without using a loop if possible. <code>  string[] a = {""The"",""Big"", ""Ant""};string[] b = {""Big"",""Ant"",""Ran""};string[] c = {""The"",""Big"",""Ant""};string[] d = {""No"",""Ants"",""Here""};string[] e = {""The"", ""Big"", ""Ant"", ""Ran"", ""Too"", ""Far""};",Comparing two string arrays in C#
Creating a ZIP Archive in Memory Using System.IO.Compression," I'm trying to create a ZIP archive with a simple demo text file using a MemoryStream as follows: If I run this code, the archive file itself is created but foo.txt isn't.However, if I replace the MemoryStream directly with the file stream, the archive is created correctly: Is it possible to use a MemoryStream to create the ZIP archive without the FileStream? <code>  using (var memoryStream = new MemoryStream())using (var archive = new ZipArchive(memoryStream , ZipArchiveMode.Create)){ var demoFile = archive.CreateEntry(""foo.txt""); using (var entryStream = demoFile.Open()) using (var streamWriter = new StreamWriter(entryStream)) { streamWriter.Write(""Bar!""); } using (var fileStream = new FileStream(@""C:\Temp\test.zip"", FileMode.Create)) { stream.CopyTo(fileStream); }} using (var fileStream = new FileStream(@""C:\Temp\test.zip"", FileMode.Create))using (var archive = new ZipArchive(fileStream, FileMode.Create)){ // ...}",Creating a ZIP archive in memory using System.IO.Compression
await works but calling task.Result hangs," I have the following four tests and the last one hangs when I run it. Why does this happen: I use this extension method for restsharp RestClient: Why does the last test hang? <code>  [Test]public void CheckOnceResultTest(){ Assert.IsTrue(CheckStatus().Result);}[Test]public async void CheckOnceAwaitTest(){ Assert.IsTrue(await CheckStatus());}[Test]public async void CheckStatusTwiceAwaitTest(){ Assert.IsTrue(await CheckStatus()); Assert.IsTrue(await CheckStatus());}[Test]public async void CheckStatusTwiceResultTest(){ Assert.IsTrue(CheckStatus().Result); // This hangs Assert.IsTrue(await CheckStatus());}private async Task<bool> CheckStatus(){ var restClient = new RestClient(@""https://api.test.nordnet.se/next/1""); Task<IRestResponse<DummyServiceStatus>> restResponse = restClient.ExecuteTaskAsync<DummyServiceStatus>(new RestRequest(Method.GET)); IRestResponse<DummyServiceStatus> response = await restResponse; return response.Data.SystemRunning;} public static class RestClientExt{ public static Task<IRestResponse<T>> ExecuteTaskAsync<T>(this RestClient client, IRestRequest request) where T : new() { var tcs = new TaskCompletionSource<IRestResponse<T>>(); RestRequestAsyncHandle asyncHandle = client.ExecuteAsync<T>(request, tcs.SetResult); return tcs.Task; }} public class DummyServiceStatus{ public string Message { get; set; } public bool ValidVersion { get; set; } public bool SystemRunning { get; set; } public bool SkipPhrase { get; set; } public long Timestamp { get; set; }}","'await' works, but calling task.Result hangs/deadlocks"
await works but calling task.Result hangs/deadlocks," I have the following four tests and the last one hangs when I run it. Why does this happen: I use this extension method for restsharp RestClient: Why does the last test hang? <code>  [Test]public void CheckOnceResultTest(){ Assert.IsTrue(CheckStatus().Result);}[Test]public async void CheckOnceAwaitTest(){ Assert.IsTrue(await CheckStatus());}[Test]public async void CheckStatusTwiceAwaitTest(){ Assert.IsTrue(await CheckStatus()); Assert.IsTrue(await CheckStatus());}[Test]public async void CheckStatusTwiceResultTest(){ Assert.IsTrue(CheckStatus().Result); // This hangs Assert.IsTrue(await CheckStatus());}private async Task<bool> CheckStatus(){ var restClient = new RestClient(@""https://api.test.nordnet.se/next/1""); Task<IRestResponse<DummyServiceStatus>> restResponse = restClient.ExecuteTaskAsync<DummyServiceStatus>(new RestRequest(Method.GET)); IRestResponse<DummyServiceStatus> response = await restResponse; return response.Data.SystemRunning;} public static class RestClientExt{ public static Task<IRestResponse<T>> ExecuteTaskAsync<T>(this RestClient client, IRestRequest request) where T : new() { var tcs = new TaskCompletionSource<IRestResponse<T>>(); RestRequestAsyncHandle asyncHandle = client.ExecuteAsync<T>(request, tcs.SetResult); return tcs.Task; }} public class DummyServiceStatus{ public string Message { get; set; } public bool ValidVersion { get; set; } public bool SystemRunning { get; set; } public bool SkipPhrase { get; set; } public long Timestamp { get; set; }}","'await' works, but calling task.Result hangs/deadlocks"
How to convert Generic List<anonymous type > to Generic List <Classname>," I have a database, where the CPU usage is inserted for every 'n' seconds and my task is to get the latest CPU entry from the database. I would like to display the latest CPU entry from the database tat belongs to the particular server , and I would like to save the result into a generic list.what I have tried, and I would like to loop through the result cpus to perform further other steps.but I get the following error Cannot implicitly convert type 'System.Collections.Generic.List<AnonymousType#1>' to 'System.Collections.Generic.List<FNC_RAQIT_HM_UI.UsageCPU>'.EDITUPDATEThe following query from Satpal worked for me.. but using var kindly help !!  <code>  string match = ""ServerX"" List<UsageCPU> cpus = (from a in db.UsageCPUs where a.ServerID.Contains(match) group a by a.ServerID into b orderby b.Key select new { ServerID = b.Key, Usage = b.FirstOrDefault() }).ToList(); var cpus = (from a in db.UsageCPUs where a.ServerID.Contains(match) group a by a.ServerID into b orderby b.Key select new { ServerID = b.Key, Usage = b.FirstOrDefault().Usage }).ToList(); foreach (var item in cpus) { if(bla bla..) }",How to convert Generic List<anonymous type > to Generic List <Classname>?
"""Failure loading DAC: CreateDacInstance failed 0x80131c30"" when loading crash dump with ClrMD"," I'm trying the new library from microsoft, ClrMD, to analyze crash-dumps and live process.I've follow the sample in the .NET Framework blog post (using the attached .cs file).I tried to run the sample to analyze a .dmp file which was taken from a program running on the same machine as the sample.When trying to create the run-time object, using the following code: This exception is thrown: Any ideas? <code>  ClrRuntime runtime = target.CreateRuntime(dacLocation); Message: Failure loading DAC: CreateDacInstance failed 0x80131c30 at Microsoft.Diagnostics.Runtime.Desktop.DacLibrary.Init(String dll) at Microsoft.Diagnostics.Runtime.Desktop.DacLibrary..ctor(DbgEngTarget dataTarget, String dll) at Microsoft.Diagnostics.Runtime.DbgEngTarget.CreateRuntime(String dacFilename) at DumpFetch.App..ctor()","""Failure loading DAC: CreateDacInstance failed"" when loading dump file with ClrMD"
Is there a Range attribute for datetime?," I have a Datetime field in my Model and need to validate it so that when it is created it has to fall between Now and 6 Years Prior. I have tried using range like But this throws an error cannot convert system datetime to double. Can anyone suggest a workaround to this in the model itself? <code>  [Range(DateTime.Now.AddYears(-6), DateTime.Now)]public DateTime Datetim { get; set; }",Is there a RangeAttribute for DateTime?
Why can't windows load the assembly PresentationFramework.Aero2?," I recently finished my first WPF application I have been developing using Windows 8. It has worked fine on my machine. A friend of mine ran it in visual studio on his Windows 8 machine as well, and that worked. I install the program using click once on my machine, and it installs fine and runs.I installed Windows 7 on virtual box and attempted to install it using the click once. It fetched .NET 4.5 and SQL Server Compact, the install process seemed flawless. When Windows 7 tried to run the application, nothing useful happened. I installed Visual Studio in virtualbox and was able to get this stack trace.I looked up the PresentationFramework.Aero2 on Google and came across 3 SO questions and one MSDN question. The MSDN question gave me a hint of what I think it might be. If I go to C:\Windows\Microsoft.NET\Framework\4.0\WPF there is no PresentationFramework.Aero2.dll file, whereas on Windows 8 there is... so I copied and pasted it into the windows 7 equivalent place hoping to achieve something, but nothing came of it.Here is the Stack Trace: <code>  System.Windows.Markup.XamlParseException was unhandled HResult=-2146233087 Message='Add value to collection of type 'System.Collections.ObjectModel.ObservableCollection(System.Windows.Controls.DataGridColumn)' threw an exception.' Line number '35' and line position '71'. Source=PresentationFramework LineNumber=35 LinePosition=71 StackTrace: at System.Windows.Markup.WpfXamlLoader.Load(XamlReader xamlReader, IXamlObjectWriterFactory writerFactory, Boolean skipJournaledProperties, Object rootObject, XamlObjectWriterSettings settings, Uri baseUri) at System.Windows.Markup.WpfXamlLoader.LoadBaml(XamlReader xamlReader, Boolean skipJournaledProperties, Object rootObject, XamlAccessLevel accessLevel, Uri baseUri) at System.Windows.Markup.XamlReader.LoadBaml(Stream stream, ParserContext parserContext, Object parent, Boolean closeStream) at System.Windows.Application.LoadBamlStreamWithSyncInfo(Stream stream, ParserContext pc) at System.Windows.Application.LoadComponent(Uri resourceLocator, Boolean bSkipJournaledProperties) at System.Windows.Application.DoStartup() at System.Windows.Application.<.ctor>b__1(Object unused) at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs) at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler) at System.Windows.Threading.DispatcherOperation.InvokeImpl() at System.Windows.Threading.DispatcherOperation.InvokeInSecurityContext(Object state) at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state) at System.Windows.Threading.DispatcherOperation.Invoke() at System.Windows.Threading.Dispatcher.ProcessQueue() at System.Windows.Threading.Dispatcher.WndProcHook(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled) at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled) at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o) at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs) at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler) at System.Windows.Threading.Dispatcher.LegacyInvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Int32 numArgs) at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam) at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG& msg) at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame) at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame) at System.Windows.Threading.Dispatcher.Run() at System.Windows.Application.RunDispatcher(Object ignore) at System.Windows.Application.RunInternal(Window window) at System.Windows.Application.Run(Window window) at System.Windows.Application.Run() at PremierAutoDataExtractor.App.Main() InnerException: System.IO.FileNotFoundException HResult=-2147024894 Message=Could not load file or assembly 'PresentationFramework.Aero2, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The system cannot find the file specified. Source=mscorlib FileName=PresentationFramework.Aero2, PublicKeyToken=31bf3856ad364e35 FusionLog=WRN: Assembly binding logging is turned OFF.To enable assembly bind failure logging, set the registry value [HKLM\Software\Microsoft\Fusion!EnableLog] (DWORD) to 1.Note: There is some performance penalty associated with assembly bind failure logging.To turn this feature off, remove the registry value [HKLM\Software\Microsoft\Fusion!EnableLog]. StackTrace: at System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) at System.Reflection.RuntimeAssembly.nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) at System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, RuntimeAssembly reqAssembly, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) at System.Reflection.Assembly.Load(AssemblyName assemblyRef) at System.Windows.Baml2006.Baml2006SchemaContext.ResolveAssembly(BamlAssembly bamlAssembly) at System.Windows.Baml2006.Baml2006SchemaContext.ResolveBamlTypeToType(BamlType bamlType) at System.Windows.Baml2006.Baml2006SchemaContext.ResolveBamlType(BamlType bamlType, Int16 typeId) at System.Windows.Baml2006.Baml2006SchemaContext.GetXamlType(Int16 typeId) at System.Windows.Baml2006.Baml2006Reader.Process_ElementStart() at System.Windows.Baml2006.Baml2006Reader.Process_OneBamlRecord() at System.Windows.Baml2006.Baml2006Reader.ReadObject(KeyRecord record) at System.Windows.ResourceDictionary.CreateObject(KeyRecord key) at System.Windows.ResourceDictionary.OnGettingValue(Object key, Object& value, Boolean& canCache) at System.Windows.ResourceDictionary.OnGettingValuePrivate(Object key, Object& value, Boolean& canCache) at System.Windows.ResourceDictionary.GetValueWithoutLock(Object key, Boolean& canCache) at System.Windows.ResourceDictionary.GetValue(Object key, Boolean& canCache) at System.Windows.DeferredResourceReference.GetValue(BaseValueSourceInternal valueSource) at System.Windows.DeferredAppResourceReference.GetValue(BaseValueSourceInternal valueSource) at System.Windows.DependencyObject.GetEffectiveValue(EntryIndex entryIndex, DependencyProperty dp, RequestFlags requests) at System.Windows.DependencyObject.GetValueEntry(EntryIndex entryIndex, DependencyProperty dp, PropertyMetadata metadata, RequestFlags requests) at System.Windows.DependencyObject.GetValue(DependencyProperty dp) at System.Windows.Controls.DataGridHelper.GetCoercedTransferPropertyValue(DependencyObject baseObject, Object baseValue, DependencyProperty baseProperty, DependencyObject parentObject, DependencyProperty parentProperty, DependencyObject grandParentObject, DependencyProperty grandParentProperty) at System.Windows.Controls.DataGridColumn.OnCoerceHeaderStyle(DependencyObject d, Object baseValue) at System.Windows.DependencyObject.ProcessCoerceValue(DependencyProperty dp, PropertyMetadata metadata, EntryIndex& entryIndex, Int32& targetIndex, EffectiveValueEntry& newEntry, EffectiveValueEntry& oldEntry, Object& oldValue, Object baseValue, Object controlValue, CoerceValueCallback coerceValueCallback, Boolean coerceWithDeferredReference, Boolean coerceWithCurrentValue, Boolean skipBaseValueChecks) at System.Windows.DependencyObject.UpdateEffectiveValue(EntryIndex entryIndex, DependencyProperty dp, PropertyMetadata metadata, EffectiveValueEntry oldEntry, EffectiveValueEntry& newEntry, Boolean coerceWithDeferredReference, Boolean coerceWithCurrentValue, OperationType operationType) at System.Windows.DependencyObject.CoerceValue(DependencyProperty dp) at System.Windows.Controls.DataGridHelper.TransferProperty(DependencyObject d, DependencyProperty p) at System.Windows.Controls.DataGridColumn.SyncProperties() at System.Windows.Controls.DataGrid.UpdateColumnSizeConstraints(IList list) at System.Windows.Controls.DataGrid.OnColumnsChanged(Object sender, NotifyCollectionChangedEventArgs e) at System.Collections.ObjectModel.ObservableCollection`1.OnCollectionChanged(NotifyCollectionChangedEventArgs e) at System.Windows.Controls.DataGridColumnCollection.OnCollectionChanged(NotifyCollectionChangedEventArgs e) at System.Collections.ObjectModel.ObservableCollection`1.InsertItem(Int32 index, T item) at System.Windows.Controls.DataGridColumnCollection.InsertItem(Int32 index, DataGridColumn item) at System.Collections.ObjectModel.Collection`1.Add(T item) at System.Collections.ObjectModel.Collection`1.System.Collections.IList.Add(Object value) at System.Xaml.Schema.XamlTypeInvoker.AddToCollection(Object instance, Object item) at MS.Internal.Xaml.Runtime.ClrObjectRuntime.Add(Object collection, XamlType collectionType, Object value, XamlType valueXamlType) InnerException: ",Why can't Windows 7 load the assembly PresentationFramework.Aero2?
c# message box with a check box inside," I would like to create a MessageBox that has Yes/No buttons AND a checkbox.The application is a picture resizer and it will be re-sizing a number of pictures at once; in the process it will check if the new location filename exists with the option to overwrite it.The MessageBox will give the user the option to overwrite any new files if desired, while the checkbox will prevent having to click Yes x number of times if they want to overwrite every file.How do I add a checkbox to a MessageBox dialog? <code> ",How to show a MessageBox with a checkbox?
Add X button to a wpf in c#," I'm new in WPF and I need to make a button (X) to simulate the X button in the form. First I set WindowStyle=""None"". Then make a Rectangle: After this I want to change the Background Image OnMousEnter event behind code: Please help as fast as you can. Note: I tried to use a Button but it's leave a border and i don't want that. <code>  <Rectangle Height=""16"" HorizontalAlignment=""Left"" Margin=""482,4,0,0"" Name=""x_btn"" Stroke=""#00000000"" VerticalAlignment=""Top"" Width=""17"" MouseEnter=""x_btn_MouseEnter"" MouseLeftButtonUp=""x_btn_MouseLeftButtonUp""> <Rectangle.Fill> <ImageBrush ImageSource=""/Red%20Crescent;component/Images/x_btn.png"" /> </Rectangle.Fill> </Rectangle> private void x_btn_MouseEnter(object sender, MouseEventArgs e){ }private void x_btn_MouseLeftButtonUp(object sender, MouseButtonEventArgs e){ this.Close();}",Add X Close Button in WPF
why should I disconnect events, I'm working in C# and my workplace has some code standards. One of them is that each event handler we connect (such as KeyDown) must be disconnected in the Dispose method. Is there any good reason for that? <code> ,Should I always disconnect event handlers in the Dispose method?
Is it possible to run a .net 4.5 app on XP?," First, I have read the following:Connect caseVS caseand especially this channel9 postSo, from the last bullet, I really think there is no way around this, but I had to see if I could get a definitive answer as my team would like to upgrade from .NET 4.0 to .NET 4.5. However, we have to support XP.Is there no possibility of going to .NET 4.5 if we want to support XP?The only thing I could think of is creating two separate solutions, but then the codebases would have to diverge if we used .NET 4.5 features.So, I am looking for some amazing workaround that I could not find and others maybe already know. <code> ",Is it possible to run a .NET 4.5 app on XP?
How to identify if a string contains more than one character?, I want to check if a string contains more than one character in the string?If i have a string 12121.23.2 so i want to check if it contains more than one . in the string. <code> ,How to identify if a string contains more than one instance of a specific character?
How to format a decimal without trailing zero's," I've just learned that a decimal somehow remembers how much trailaing zero's were needed to store a number. With other words: it remembers the size of the fraction.For example: I am looking for a formatting string or another trick to get rid of those ""unneeded"" trailing zeros, but keeping the significant digits. So: Removing the zeros at the end of the new string is not a real option for me, because then I have to find out if the string contains a fraction and if so, also have to remove the optional '.' or ',' depending on the culture, etc. <code>  123M.ToString() ==> resuls in: 123123.00M.ToString() ==> resuls in: 123.00123.450M.ToString() ==> resuls in: 123.450 123M.ToString() ==> resuls in: 123123.00M.ToString() ==> resuls in: 123123.450M.ToString() ==> resuls in: 123.45",How to format a decimal without trailing zeros
Find the first Triangular number which is having 50 factors?," -----Modification of code requested --------Question : Count the Fast Triangular Series Number which is having 50 Factors ?Elaborated : Let's say there is a series here 1,3,6,10,15,21,28 are the numbers coming under triangular series.lets see the factors of the number here 6 is the first triangular number which is having 4 factors. even if 10,15,21 also having 4 factors but they are not the 1st one. Like that lets take a number as 2 which is having 2 factors as 1 and 2 same for number 3 also having 2 factors as 1 and 3but as per question 3 will be the answer not 2 because 2 is not coming under Triangular series number list even if it is faster than 3. <code>  1 : 1 3 : 1+2 6 : 1+2+3 10 : 1+2+3+4 15 : 1+2+3+4+5 21 : 1+2+3+4+5+6 28 : 1+2+3+4+5+6+7 Number factors Count 1 : 1 1 3 : 1,3 2 6 : 1,2,3,6 4 10 : 1,2,5,10 4 15 : 1,3,5,15 4 21 : 1,3,7,21 4 28 : 1,2,4,7,14,28 6",Find the first Triangular number which has 50 factors?
"Find the first Triangular number which has 50 factors? (The verb ""has"" should be in this form.)"," -----Modification of code requested --------Question : Count the Fast Triangular Series Number which is having 50 Factors ?Elaborated : Let's say there is a series here 1,3,6,10,15,21,28 are the numbers coming under triangular series.lets see the factors of the number here 6 is the first triangular number which is having 4 factors. even if 10,15,21 also having 4 factors but they are not the 1st one. Like that lets take a number as 2 which is having 2 factors as 1 and 2 same for number 3 also having 2 factors as 1 and 3but as per question 3 will be the answer not 2 because 2 is not coming under Triangular series number list even if it is faster than 3. <code>  1 : 1 3 : 1+2 6 : 1+2+3 10 : 1+2+3+4 15 : 1+2+3+4+5 21 : 1+2+3+4+5+6 28 : 1+2+3+4+5+6+7 Number factors Count 1 : 1 1 3 : 1,3 2 6 : 1,2,3,6 4 10 : 1,2,5,10 4 15 : 1,3,5,15 4 21 : 1,3,7,21 4 28 : 1,2,4,7,14,28 6",Find the first Triangular number which has 50 factors?
select a DataRow from a DataRow [] collection," My code : A row contains TEMPLATE_ID,MIN_AMOUNT,MAX_AMOUNT and DISCOUNTNow I want to select a row where a given amount is between MIN_AMOUNT and MAX_AMOUNTI tried to do this : but this didn't work. <code>  DataRow[] row = ByTotalTemplate.Select(""TEMPLATE_ID="" + DisTemplateID); DataRow amountRow = row.Select(""MIN_AMOUNT<"" + quantity + "" AND MAX_AMOUNT>"" + quantity);",Select a DataRow from a DataRow [] collection
No native ToString allowed, Convert the following int argument into a string without using any native toString functionality. Since everything inherits from Object and Object has a ToString() method how would you convert an int to a string without using the native ToString() method?The problem with string concatenation is that it will call ToString() up the chain until it hits one or hits the Object class.How do you convert an integer to a string in C# without using ToString()? <code>  public string integerToString(int integerPassedIn){ //Your code here},How do I convert an Int to a String in C# without using ToString()?
Using [FromUri] Attribute in MVC 4 (not Web Api) - Bind complex object with nested array," I want to send a complex object with a nested array in the uri to an MVC action method in a GET request.Consider the following code: This works just fine and binds correctly using the default model binder in MVC Web Api.However, switch this to plain MVC not WebApi and the default model binder breaks down and cannot bind the properties on objects in the nested array:Watch List I would like to know why this breaks down in plain MVC and how to make FromUriAttribute bind this object correctly in plain MVC <code>  public ActionResult AutoCompleteHandler([FromUri]PartsQuery partsQuery){ ... } public class PartsQuery { public Part[] Parts {get; set; } public string LastKey { get; set; } public string Term { get; set; } } $.ajax({ url: ""Controller/AutoCompleteHandler"", data: $.param({ Parts: [{ hasLabel: ""label"", hasType: ""type"", hasIndex : 1 }], LastKey : ""Last Key"", Term : ""Term"" }), dataType: ""json"", success: function(jsonData) { ... } }); partsQuery != null //Good--LastKey == ""Last Key"" //Good--Term == ""Term"" //Good--Parts[] != null //Good----hasLabel == null //Failed to bind----hasType == null //Failed to bind----hasIndex == 0 //Failed to bind",Using [FromUri] attribute - bind complex object with nested array
C# - How do I GetType of 'class with generic parameter' in run-time," I have a generic class as shown below: I don't understand why following line of code return null (throwing exception with message : ""Could not load type 'MyClass' from assembly '//assembly details//' "") Is it illegal to use Assembly.GetType(className) with generic class?Can you suggest any alternate method to get type of generic class in run-time?Thanks in advance and Apology if this question is too basic. I am new to c#.EDIT :Forgot to mention. the assembly containing MyClass will be loaded run-time. <code>  using System.Collections.Generic;namespace MyNameSpace{ public class MyClass<T> : MyAnotherClass { public MyClass(); public MyClass(T obj); public T Object { get; set; } }} Type MyClassType = AssemblyContaingMyClass.GetType(""MyNameSpace.MyClass"");",C# - How do I GetType of 'class with generic parameter' in run-time?
How do I GetType of 'class with generic parameter' in run-time?," I have a generic class as shown below: I don't understand why following line of code return null (throwing exception with message : ""Could not load type 'MyClass' from assembly '//assembly details//' "") Is it illegal to use Assembly.GetType(className) with generic class?Can you suggest any alternate method to get type of generic class in run-time?Thanks in advance and Apology if this question is too basic. I am new to c#.EDIT :Forgot to mention. the assembly containing MyClass will be loaded run-time. <code>  using System.Collections.Generic;namespace MyNameSpace{ public class MyClass<T> : MyAnotherClass { public MyClass(); public MyClass(T obj); public T Object { get; set; } }} Type MyClassType = AssemblyContaingMyClass.GetType(""MyNameSpace.MyClass"");",C# - How do I GetType of 'class with generic parameter' in run-time?
How to break nested foreach then go to parent foreach on c#," I have the following code: What I want to do is when I hit the 2nd if statement on the last foreach loop is to return on the first foreach loop. Note: If the 2nd if statement is not true, it should continue the last foreach loop until the condition is not true.Thanks in advance! <code>  foreach(// Some condition here){ while (// Some condition here) { foreach (// Some condition here) { if (// Condition again) { //Do some code } if (// Condition again) { //Stop the first foreach then go back to first foreach } } }}",How to break nested foreach loop then go to parent foreach loop on c#
Return 0 when query returns null," Basically when I do the following query, if no leads were matched the following query throws an exception. In that case I'd prefer to have the sum equalize 0 rather than an exception being thrown.Would this be possible in the query itself - I mean rather than storing the query and checking query.Any() ? <code>  double earnings = db.Leads.Where(l => l.Date.Day == date.Day && l.Date.Month == date.Month && l.Date.Year == date.Year && l.Property.Type == ProtectedPropertyType.Password && l.Property.PropertyId == PropertyId).Sum(l => l.Amount);",How to force LINQ Sum() to return 0 while source collection is empty
c# extend class by adding properties," Is it possible in C# to extend a class not by adding only functions but properties. Ex: i have a standard DLL library I am relying on and the vendor does not want to modify it.Already throughout the code I have used the DataCell class extensively and only now realized that I need to add an extra property to it, as creating a new extension class that inherits from this class just does not look like it would work + a lot of rewriting. DataCell [metadata] Basically I want to add a public int Flags; to this class. So I can do now without rewriting anything, (new DataCell).Flags = 0x10; <code>  public class DataCell : Message{public int Field1;public int Field2;public DataCell(){ ..} ..}",C# Extend class by adding properties
is null in c# value type or reference type," Originally I had this impression that NULL is reference type because it is assigned to references, then encountered this concept called nullable value types, this makes my theory in an awkward situation, so is NULL value type of reference type on earth ? <code> ",Is null in c# value type or reference type
What does this C# attribute mean?," What does this C# attribute mean? I am mostly working with C++,and I do know about the concept of attributes in C#, but not sure about this one:It is in a class. So basically we have a property, and an attribute for it. Thanks <code>  [Option(""h"", ""help"", HelpText = ""Shows this help message"")]public bool Help { get; set; }",What does this [Option(...)] C# attribute mean?
Match only a newline character in C#," I have a text file which has lines of data separated by newlines. What I'm trying to do is count the number of lines in the file, excluding the ones that are only a newline. I'm trying to use a regular expression to look at each line as it is read, and if it starts with a newline character not include it in my line count, but I can't seem to get it to work. I've searched all over the place for how to do this with no results.Here's the method I've written to try to do this: I've tried changing the RegexOptions between Singleline andMultiline, I've tried putting ""\r|\n|\r\n"" into my pattern match, and I've tried removing the ^ from the expression, but I can't seem to get it to work. No matter what I do, my lineCount always ends up being the total number of lines in the file, including the newlines.I'm apparently overlooking something obvious, but I'm not yet familiar enough with the C# language to see what's wrong. Everything looks like it should work to me. Can someone please help me out? <code>  public int LineCounter(){ StreamReader myRead = new StreamReader(@""C:\TestFiles\test.txt""); int lineCount = 0; string line; while ((line = myRead.ReadLine()) != null) { string regexExpression = @""^\r?\n""; RegexOptions myOptions = RegexOptions.Multiline; Match stringMatch = Regex.Match(line, regexExpression, myOptions); if (stringMatch.Success) { } else { lineCount++; } } return lineCount;}",Match only a newline character
LINQ Expression.Call Ignore Case for Contains Method," I am using below code for Generic Filter, any search text passed but the contains method is Case sensitive, how can I write to ignore case. <code>  public static class QueryExtensions{ public static IQueryable<T> Filter<T>(this IQueryable<T> query, string search) { var properties = typeof(T).GetProperties().Where(p => /*p.GetCustomAttributes(typeof(System.Data.Objects.DataClasses.EdmScalarPropertyAttribute),true).Any() && */ p.PropertyType == typeof(String)); var predicate = PredicateBuilder.False<T>(); foreach (var property in properties ) { predicate = predicate.Or(CreateLike<T>(property,search)); } return query.AsExpandable().Where(predicate); } private static Expression<Func<T,bool>> CreateLike<T>( PropertyInfo prop, string value) { var parameter = Expression.Parameter(typeof(T), ""f""); var propertyAccess = Expression.MakeMemberAccess(parameter, prop); var like = Expression.Call(propertyAccess, ""Contains"", null, Expression.Constant(value,typeof(string))); return Expression.Lambda<Func<T, bool>>(like, parameter); }}",Call Ignore Case for Contains Method using a generic LINQ Expression
Call Ignore Case for Contains Method using a generic LINQ Expression.," I am using below code for Generic Filter, any search text passed but the contains method is Case sensitive, how can I write to ignore case. <code>  public static class QueryExtensions{ public static IQueryable<T> Filter<T>(this IQueryable<T> query, string search) { var properties = typeof(T).GetProperties().Where(p => /*p.GetCustomAttributes(typeof(System.Data.Objects.DataClasses.EdmScalarPropertyAttribute),true).Any() && */ p.PropertyType == typeof(String)); var predicate = PredicateBuilder.False<T>(); foreach (var property in properties ) { predicate = predicate.Or(CreateLike<T>(property,search)); } return query.AsExpandable().Where(predicate); } private static Expression<Func<T,bool>> CreateLike<T>( PropertyInfo prop, string value) { var parameter = Expression.Parameter(typeof(T), ""f""); var propertyAccess = Expression.MakeMemberAccess(parameter, prop); var like = Expression.Call(propertyAccess, ""Contains"", null, Expression.Constant(value,typeof(string))); return Expression.Lambda<Func<T, bool>>(like, parameter); }}",Call Ignore Case for Contains Method using a generic LINQ Expression
Simple extension method for string.Join not compiling," Very simple extension method not compiling: I get ""cannot convert from 'System.Collections.Generic.IEnumerable' to 'string[]'""What am I missing? <code>  public static string Join(this string text, params string[] stringsToJoin){ return String.Join("", "", stringsToJoin.Where(s => !string.IsNullOrEmpty(s)));}","string.Join - ""cannot convert from IEnumerable to string[]"""
C# - Remove all XML Attributes with a Given Name," I am editing a series of XML files, and I need to remove all attributes with the name ""foo"". This attribute appears in more than one type of element. An example snippet from the XML might be: The best solution I have uses Regex: I know built-in XML parsers could help, but ideally I want to make simple XML replacements/removals without having to deal with the baggage of an entire XML parser. Is Regex the best solution in this case?Edit:After some research in the XmlDocument class, here is one possible solution I came up with (to remove more than one attribute type stored in the array ""ids""): I don't know if this is as efficient as it possibly could be, but I've tested it and it seems to work fine. <code>  <bodymatter id=""######""> <level1 id=""######""> <pagenum page=""#####"" id=""######"" foo=""######"" /> <h1 id=""#####"" foo=""#####"">Header</h1> <imggroup id=""#######""> . . etc. Regex regex = new Regex(""foo=\"""" + "".*?"" + ""\"""", RegexOptions.Singleline);content = regex.Replace(content, """"); private void removeAttributesbyName(string[] ids){ XmlDocument doc = new XmlDocument(); doc.Load(path); XmlNodeList xnlNodes = doc.GetElementsByTagName(""*""); foreach (XmlElement el in xnlNodes) { for (int i = 0; i <= ids.Length - 1; i++) { if (el.HasAttribute(ids[i])) { el.RemoveAttribute(ids[i]); } if (el.HasChildNodes) { foreach (XmlNode child in el.ChildNodes) { if (child is XmlElement && (child as XmlElement).HasAttribute(ids[i])) { (child as XmlElement).RemoveAttribute(ids[i]); } } } } }}",Remove all XML Attributes with a Given Name
How can I write Take(2) in query syntax, Is it possible to write IQueryable<MyObject> = query.Take(1) or something equivalent in LINQ query syntax. I'm using C# 5 and EF 5. <code> ,How can I write Take(1) in query syntax
When is the signalr hub constructor called?," I'm trying to debug a SignalR hub and noticed that the constructor is getting called multiple times, even with a single client. Is this the expected behaviour? I was expecting the constructor to be called only once for class initialisation, but I'm hitting my breakpoint multiple times. <code> ",When is the SignalR hub constructor called?
find all strings starts with @@ and ends with @@ in long string," I have a quite big string. In that big string, I want to get all UNIQUE words starts with @@ and ends with @@. Between @@ could be text, number or alphanumeric or anything.Once I get all the UNIQUE words starting @@ and ends with @@, I want to replace each word with a value which matches a key in a different array.Looking for the solution in C#. <code> ",Find all words starts with @@ and ends with @@ in long string
"Replace entire ObservableCollection with other ObservableCollection, keeping the reference (and bindings) intact"," How can I replace the whole content of Items with the return value of GetNewItems() without:Breaking the bindings.Having to loop through the items and copy them one by one to the other collection ? <code>  public class Alpha{ public ObservableCollection<Beta> Items { get; set; } public Alpha() { Items = new ObservableCollection<Beta>(); } public void DoSomething() { Items = GetNewItems(); // whenever I do this, Items gets a new referene, // so every WPF binding (e.g. datagrids) are broken } public ObservableCollection<Beta> GetNewItems() { var ret = new ObservableCollection<Beta>(); // some logic for getting some items from somewhere, and populating ret return ret; }}",Replace Entire ObservableCollection with another ObservableCollection
Process.Start() don't work properly," I have program pro1.exe that reads from input file, calculates result and writes it to output file.Now I'm writing program test.exe, that tests it on different tests (fill input, run pro1 using Process.Start() and compares output with supposed)Problem is following: after executing pro1.exe output file is empty. However, if I run it manually, it writes to output file.Here is code how I execute pro1: _applicationName is a full path to exe file.in debug I see, that process is starting, and ending without errors. <code>  ProcessStartInfo processInfo = new ProcessStartInfo(); processInfo.FileName = _applicationName; processInfo.ErrorDialog = true; processInfo.UseShellExecute = false; processInfo.RedirectStandardOutput = true; processInfo.RedirectStandardError = true; Process proc = Process.Start(processInfo);",Process.Start() doesn't work properly
C# Read Picture box mouse coordinates on click," I have a Picture Box with a picture loaded and I want to read the location (as in x,y inside the Picture Box) when I click the image; is this possible ? Even more, can i read these coordinates (Points) when i mouse over ? I know i have to use the events given (Mouse Click and Mouse Over) but don't know how to read the coordinates where the mouse pointer happens to be. <code> ",Read picture box mouse coordinates on click
Specefy how to Serialize my object if its in a list . c#," I have a somewhat complicated Class that may or may not contain a list of items of the same type The class itself is serializeable, however its going to be a giant waste of space to serialize the objects in the list since they are serialized and added to the database prior to being included in the list.Is there a way that I can specify that the list should be represented as a list of integers when its serialized ? Note: These integers will represent primary keys of the rows where the serialized object is located. <code>  Class Items{ List<Items> SubItems ...}",Specify how to Serialize my object if it is in a list
LPCSTR data type equivalent in c#," I have an API that takes three parameters: How can I use this method in C#?What is the equivalence of LPCSTR? And what should be use in place of HANDLE? <code>  HANDLE Connect(LPCSTR MachineName, LPCSTR ServerName, BOOL EnableDLLBuffering); ",LPCSTR data type equivalent in C#
"C# OleDb Exception ""No value given for one or more required parameters"" while trying to delete from Access database"," I have a table with ""SEMESTER, SUBJECT, OFFER, RESULT"" where ""SEMESTER"" & ""SUBJECT"" is PRIMARY KEY. When i use the query""DELETE FROM Course_Information WHERE Semester = 1 AND Subject = 'CSE-414' ; Its working perfectly in access database but i always get exception when i tried to use it in my c# code.Moreover its works if i use ""DELETE FROM Course_Information WHERE Semester = 1 ;I want to use both ""SUBJECT"" & ""SEMESTER"" In the WHERE condition (Because there could be different subject in the same semester)See my code, <code>  connection_string = aConnection.return_connectionString(connection_string); string sql_query = ""DELETE FROM Course_Information WHERE Semester = "" + this.textBox1.Text + "" AND Subject = "" + this.textBox2.Text + "" ;""; OleDbConnection connect = new OleDbConnection(connection_string); OleDbCommand command = new OleDbCommand(sql_query, connect); try { connect.Open(); OleDbDataReader reader = command.ExecuteReader(); MessageBox.Show(""Delete Successful!""); connect.Close(); UpdateDatabase(); } catch (Exception ex) { MessageBox.Show(ex.Message); }","C# OleDb Exception ""No value given for one or more required parameters"" while trying to delete from Access database [SOLVED]"
C# assignment constructor," I apologize for asking something that is probably too basic for C# folks. I'm mostly doing my coding in C++.So if I want to write an assignment constructor for my class, how do I do that? I have this so far, but it doesn't seem to compile: <code>  public class MyClass{ public string s1; public string s2; public int v1; public MyClass() { s1 = """"; s2 = """"; v1 = 0; } public MyClass(MyClass s) { this = s; //Error on this line }}MyClass a = new MyClass();MyClass b = new MyClass(a);",C# copy constructor
"Is Yield return slower than ""old school"" return?"," I'm doing some tests about yield return perfomance, and I found that it is slower than normal return.I tested value variables (int, double, etc.) and some references types (string, etc.)... And yield return were slower in both cases. Why use it then?Check out my example: <code>  public class YieldReturnTeste{ private static IEnumerable<string> YieldReturnTest(int limite) { for (int i = 0; i < limite; i++) { yield return i.ToString(); } } private static IEnumerable<string> NormalReturnTest(int limite) { List<string> listaInteiros = new List<string>(); for (int i = 0; i < limite; i++) { listaInteiros.Add(i.ToString()); } return listaInteiros; } public static void executaTeste() { Stopwatch stopWatch = new Stopwatch(); stopWatch.Start(); List<string> minhaListaYield = YieldReturnTest(2000000).ToList(); stopWatch.Stop(); TimeSpan ts = stopWatch.Elapsed; string elapsedTime = String.Format(""{0:00}:{1:00}:{2:00}.{3:00}"", ts.Hours, ts.Minutes, ts.Seconds, ts.Milliseconds / 10); Console.WriteLine(""Yield return: {0}"", elapsedTime); //**** stopWatch = new Stopwatch(); stopWatch.Start(); List<string> minhaListaNormal = NormalReturnTest(2000000).ToList(); stopWatch.Stop(); ts = stopWatch.Elapsed; elapsedTime = String.Format(""{0:00}:{1:00}:{2:00}.{3:00}"", ts.Hours, ts.Minutes, ts.Seconds, ts.Milliseconds / 10); Console.WriteLine(""Normal return: {0}"", elapsedTime); }}","Is 'yield return' slower than ""old school"" return?"
Converting a method to use async," I'm trying to turn a synchronous method from some old code into an asynchronous method, but I'm having some trouble understand. From all the videos and tutorials I've read they seem to be creating two methods: one the actual function, the other a wrapper and then it's the wrapper called on the UI.Here is my code: For some reason when I try to call the method on the UI thread from a button click, it's asking me to make the button event async. Do I need a wrapper method that is also set to async which makes the call to login? <code>  private async Task<bool> login(String username, String password){ var tcs = new TaskCompletionSource<RestSharp.IRestResponse>(); RestSharp.RestRequest request = new RestSharp.RestRequest(""/accounts/login/"", RestSharp.Method.GET); RestSharp.IRestResponse response = client.Execute(request); // Make the login request request = new RestSharp.RestRequest(""/accounts/login/"", RestSharp.Method.POST); request.AddParameter(""username"", username); request.AddParameter(""password"", password); response = client.Execute(request); // Return loggin status dom = response.Content; return dom[""html""].HasClass(""logged-in""); } txtLog.AppendText(""Before Await"");Task<bool> result = await login("""","""");txtLog.AppendText(""After Await"");txtLog.AppendText(""Result: "" + result.toString());",Turn a sync method into an async one
"I'm trying to turn a synchronous method from some old code into an asynchronous method, but I'm having some trouble understand"," I'm trying to turn a synchronous method from some old code into an asynchronous method, but I'm having some trouble understand. From all the videos and tutorials I've read they seem to be creating two methods: one the actual function, the other a wrapper and then it's the wrapper called on the UI.Here is my code: For some reason when I try to call the method on the UI thread from a button click, it's asking me to make the button event async. Do I need a wrapper method that is also set to async which makes the call to login? <code>  private async Task<bool> login(String username, String password){ var tcs = new TaskCompletionSource<RestSharp.IRestResponse>(); RestSharp.RestRequest request = new RestSharp.RestRequest(""/accounts/login/"", RestSharp.Method.GET); RestSharp.IRestResponse response = client.Execute(request); // Make the login request request = new RestSharp.RestRequest(""/accounts/login/"", RestSharp.Method.POST); request.AddParameter(""username"", username); request.AddParameter(""password"", password); response = client.Execute(request); // Return loggin status dom = response.Content; return dom[""html""].HasClass(""logged-in""); } txtLog.AppendText(""Before Await"");Task<bool> result = await login("""","""");txtLog.AppendText(""After Await"");txtLog.AppendText(""Result: "" + result.toString());",Turn a sync method into an async one
Get native resolution of screen in c#, Is there a way to get the native resolution of a screen in c#?The reason that I ask is that I have some curves and it is very important that they look the same no matter what resolution. When the screen isn't in native resolution they look somewhat different than before and I want to show a warning that that is the case. <code> ,Get native resolution of screen
Why should i use implicit/explicit operator?," Check the code bellow: I don't understand how it would be useful in my code, couldn't I just do a method like: Wouldn't it be easier and clearer to implement? <code>  class Money{ public Money(decimal amount) { Amount = amount; } public decimal Amount { get; set; } public static implicit operator decimal(Money money) { return money.Amount; } public static explicit operator int(Money money) { return (int)money.Amount; }} public static int returnIntValueFrom(Money money){ return (int)money.Amount;}",Why should I use implicit/explicit operator?
Making a list disctinct," In C#, I have an object type 'A' that contains a list of key value pairs.The key value pairs is a category string and a value string.To instantiate object type A, I would have to do the following: Eventually, I will have a List of A object types and I want to manipulate the list so that i only get unique values and I base it only on the country name. Therefore, I want the list to be reduced to only have ONE ""Country"", ""U.S.A"", even if it appears more than once.I was looking into the linq Distinct, but it does not do what I want because it I can't define any parameters and because it doesn't seem to be able to catch two equivalent objects of type A. I know that I can override the ""Equals"" method, but it still doesn't solve the my problem, which is to render the list distinct based on ONE of the key value pairs. <code>  List<KeyValuePair> keyValuePairs = new List<KeyValuePair>();keyValuePairs.Add(new KeyValuePair<""Country"", ""U.S.A"">());keyValuePairs.Add(new KeyValuePair<""Name"", ""Mo"">());keyValuePairs.Add(new KeyValuePair<""Age"", ""33"">());A a = new A(keyValuePairs);",Making a list distinct in C#
Making a list distinc," In C#, I have an object type 'A' that contains a list of key value pairs.The key value pairs is a category string and a value string.To instantiate object type A, I would have to do the following: Eventually, I will have a List of A object types and I want to manipulate the list so that i only get unique values and I base it only on the country name. Therefore, I want the list to be reduced to only have ONE ""Country"", ""U.S.A"", even if it appears more than once.I was looking into the linq Distinct, but it does not do what I want because it I can't define any parameters and because it doesn't seem to be able to catch two equivalent objects of type A. I know that I can override the ""Equals"" method, but it still doesn't solve the my problem, which is to render the list distinct based on ONE of the key value pairs. <code>  List<KeyValuePair> keyValuePairs = new List<KeyValuePair>();keyValuePairs.Add(new KeyValuePair<""Country"", ""U.S.A"">());keyValuePairs.Add(new KeyValuePair<""Name"", ""Mo"">());keyValuePairs.Add(new KeyValuePair<""Age"", ""33"">());A a = new A(keyValuePairs);",Making a list distinct in C#
Making a list distinct," In C#, I have an object type 'A' that contains a list of key value pairs.The key value pairs is a category string and a value string.To instantiate object type A, I would have to do the following: Eventually, I will have a List of A object types and I want to manipulate the list so that i only get unique values and I base it only on the country name. Therefore, I want the list to be reduced to only have ONE ""Country"", ""U.S.A"", even if it appears more than once.I was looking into the linq Distinct, but it does not do what I want because it I can't define any parameters and because it doesn't seem to be able to catch two equivalent objects of type A. I know that I can override the ""Equals"" method, but it still doesn't solve the my problem, which is to render the list distinct based on ONE of the key value pairs. <code>  List<KeyValuePair> keyValuePairs = new List<KeyValuePair>();keyValuePairs.Add(new KeyValuePair<""Country"", ""U.S.A"">());keyValuePairs.Add(new KeyValuePair<""Name"", ""Mo"">());keyValuePairs.Add(new KeyValuePair<""Age"", ""33"">());A a = new A(keyValuePairs);",Making a list distinct in C#
C# functional way to check if array of numbers is sequential," Let's say that an array is sequential when each successful element has the value of previous element + 1. Suppose I have an array of numbers like {5,6,7,8} (sequential) or {1,2,5} (not sequential). Is there a nice functional way to check if the array is sequential? I can do it with the following code: I'm trying to determine if a poker hand is straight. <code>  bool IsSequential(int[] array){ for (int i = 1; i < array.Length; i++) if (array[i] != array[i - 1] + 1) return false; return true;}",Functional way to check if array of numbers is sequential
C# TextBox.AppendText() not autoscrolling," I tried the following to get my Textbox text to automatically scroll:The steps I am using are pretty trivial:Drag textbox onto form.Change textbox to be multiline.Add vertical scroll.Use AppendText() to add text to the textbox.The text does not automatically scroll, despite trying to solutions mentioned here:How do I automatically scroll to the bottom of a multiline text box?What could cause this and how do I fix it?UPDATE: If I create a button and use it to call AppendText() I get the desired behavior. However, if I try to call AppendText from the form's constructor or Load() event then I get the appended text but the TextBox does not scroll. This is NOT a duplicate question as I haven't seen anyone post this problem in the past. <code> ",TextBox.AppendText() not autoscrolling
Parsing CSS in C#: extracting all URLs," I need to get all URLs (url() expressions) from CSS files. For example: I need to get all img* URLs, but not noimg* URLs (invalid syntax or invalid property or inside comments).I've tried using good old regular expressions. After some trial and error I got this: That's one crazy regex, but it still doesn't work -- it matches 3 invalid URLs (namely, 2, 3 and 4). Furthermore, everyone will say that using regex for parsing complex grammar is wrong.Let's try another approach. According to this question, the only viable option is ExCSS (others are either too simple or outdated). With ExCSS I got this: Unlike regex solution, this one doesn't list invalid URLs. But it doesn't list some valid ones! Namely, 9 and 10. Looks like this is known issue with some CSS syntax, and it can't be fixed without rewriting the whole library from scratch. ANTLR rewrite seems to be abandoned.Question: How to extract all URLs from CSS files? (I need to parse any CSS files, not only the one provided as an example above. Please don't heck for ""noimg"" or assume one-line declarations.)N.B. This is not a ""tool recommendation"" question, as any solution will be fine, be it a piece of code, a fix to one of the above solutions, a library or anything else; and I've clearly defined the function I need. <code>  b { background: url(img0) }b { background: url(""img1"") }b { background: url('img2') }b { background: url( img3 ) }b { background: url( ""img4"" ) }b { background: url( 'img5' ) }b { background: url (img6) }b { background: url (""img7"") }b { background: url ('img8') }{ background: url('noimg0) }{ background: url(noimg1') }/*b { background: url(noimg2) }*/b { color: url(noimg3) }b { content: 'url(noimg4)' }@media screen and (max-width: 1280px) { b { background: url(img9) } }b { background: url(img10) } private static IEnumerable<string> ParseUrlsRegex (string source){ var reUrls = new Regex(@""(?nx) url \s* \( \s* ( (?! ['""""] ) (?<Url> [^\)]+ ) (?<! ['""""] ) | (?<Quote> ['""""] ) (?<Url> .+? ) \k<Quote> ) \s* \)""); return reUrls.Matches(source) .Cast<Match>() .Select(match => match.Groups[""Url""].Value);} private static IEnumerable<string> ParseUrlsExCss (string source) { var parser = new StylesheetParser(); parser.Parse(source); return parser.Stylesheet.RuleSets .SelectMany(i => i.Declarations) .SelectMany(i => i.Expression.Terms) .Where(i => i.Type == TermType.Url) .Select(i => i.Value); }",Parsing CSS: extracting all URLs
Call store procedure from dapper which accept list of user defined table type," I have a stored procedure InsertCars which accepts list of user defined table type CarType. I need call this stored procedure from Dapper. I googled it and found some solutions. But I get an error: Procedure or function InsertCars has too many arguments specifiedAlso stored procedure InsertCars returns the count of inserted rows; I need get this value.Where is the root of problem?My problem is also that I have cars in generic list List<Car> Cars and I want pass this list to store procedure. It exist elegant way how to do it ? Thank you for helpEDITEDI found solutionsDoes Dapper support SQL 2008 Table-Valued Parameters?or Does Dapper support SQL 2008 Table-Valued Parameters 2?So I try make own stupid helper class Use I get exception When using the multi-mapping APIs ensure you set the splitOn param if you have keys other than Id.StackTrace: What is wrong?FIXED:Call con.Execute instead con.Query <code>  CREATE TYPE dbo.CarTypeAS TABLE( CARID int null, CARNAME varchar(800) not null,);CREATE PROCEDURE dbo.InsertCars @Cars AS CarType READONLYAS-- RETURN COUNT OF INSERTED ROWSEND var param = new DynamicParameters(new{CARID= 66, CARNAME= ""Volvo""}); var result = con.Query(""InsertCars"", param, commandType: CommandType.StoredProcedure); public class Car{ public CarId { get; set; } public CarName { get; set; }} class CarDynamicParam : Dapper.SqlMapper.IDynamicParameters{ private Car car; public CarDynamicParam(Car car) { this.car = car; } public void AddParameters(IDbCommand command, SqlMapper.Identity identity) { var sqlCommand = (SqlCommand)command; sqlCommand.CommandType = CommandType.StoredProcedure; var carList = new List<Microsoft.SqlServer.Server.SqlDataRecord>(); Microsoft.SqlServer.Server.SqlMetaData[] tvpDefinition = { new Microsoft.SqlServer.Server.SqlMetaData(""CARID"", SqlDbType.Int), new Microsoft.SqlServer.Server.SqlMetaData(""CARNAME"", SqlDbType.NVarChar, 100), }; var rec = new Microsoft.SqlServer.Server.SqlDataRecord(tvpDefinition); rec.SetInt32(0, car.CarId); rec.SetString(1, car.CarName); carList.Add(rec); var p = sqlCommand.Parameters.Add(""Cars"", SqlDbType.Structured); p.Direction = ParameterDirection.Input; p.TypeName = ""CarType""; p.Value = carList; }} var result = con.Query(""InsertCars"", new CarDynamicParam(car), commandType: CommandType.StoredProcedure); at Dapper.SqlMapper.GetDynamicDeserializer(IDataRecord reader, Int32 startBound, Int32 length, Boolean returnNullIfFirstMissing) in c:\Dev\Dapper\Dapper\SqlMapper.cs:line 1308 at Dapper.SqlMapper.GetDeserializer(Type type, IDataReader reader, Int32 startBound, Int32 length, Boolean returnNullIfFirstMissing) in c:\Dev\Dapper\Dapper\SqlMapper.cs:line 1141 at Dapper.SqlMapper.<QueryInternal>d__d`1.MoveNext() in c:\Dev\Dapper\Dapper\SqlMapper.cs:line 819 at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection) at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source) at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in c:\Dev\Dapper\Dapper\SqlMapper.cs:line 770 at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in c:\Dev\Dapper\Dapper\SqlMapper.cs:line 715",Call stored procedure from dapper which accept list of user defined table type
Allow templates to be inferred C#," Say I'm using an external package for storing graphs. A BidirectionalGraph takes two templates: a vertex and an edge type: Unfortunately, this graph package doesn't allow you to get the edges radiating into a vertex in a single line. Instead, you have to provide an IEnumerable, which it will populate with the results. This can disrupt a good coding rhythm by making tasks like ""loop through all vertices that are successors of vertex x"" take far too much code.I wanted to use .NET's extensions to add a one-line solution to the graph class: But when I call graph.IncomingEdges(vertex), for some reason C# (.NET version 4.5) can't infer the template arguments, so I have to say:graph.IncomingEdges<GraphThatInheritsFromBidirectionalGraph<VertexType,EdgeType>,VertexType,EdgeType>(vertex). Not really a great improvement.First, why can't the template types be estimated? I have a feeling it has to do with inheritance, but don't understand. I'm used to using C++, and for some reason feel that gcc could infer the template types.Second, if this can't be prevented, is the correct design choice to make a graph class for actual use, which inherits from BidirectionalGraph? It seems a waste to have to rewrite the constructors, but I'm sure you'd agree that calling the method with explicit template types is inelegant.EDIT:Strangely, the equivalent specification (below) does allow automatic inference of template types. So, even though it solves my initial problem (adding this functionality to the graph), I'd still really like to understand. <code>  var graph = new BidirectionalGraph<Vertex, Edge<Vertex>>(); public static class GraphExtensions{ public static IEnumerable<TEdge> IncomingEdges<TGraphSubtype, TVertex, TEdge>(this TGraphSubtype graph, TVertex n) where TGraphSubtype : BidirectionalGraph<TVertex, TEdge> where TEdge : IEdge<TVertex> { IEnumerable<TEdge> inputEdgesForVertex; graph.TryGetInEdges(n, out inputEdgesForVertex); return inputEdgesForVertex; }} public static class GraphExtensions{ public static IEnumerable<TEdge> IncomingEdges<TVertex, TEdge>(this BidirectionalGraph<TVertex,TEdge> graph, TVertex n) where TEdge : IEdge<TVertex> { IEnumerable<TEdge> inputEdgesForVertex; graph.TryGetInEdges(n, out inputEdgesForVertex); return inputEdgesForVertex; }}",Allow templates to be inferred
MinLength and MaxLength validation don't work (asp.net mvc)," I have this class and this form User class: but my validation works only for Required and RegularExpression and doesn't work for MinLength and MaxLength and I don't get any error message in this case. What can be a reason? <code>  using System.ComponentModel.DataAnnotations;using Argussoft.BI.DAL.Domain.Users;namespace Argussoft.BI.DAL.DTOs.UserDTOs{ public class CreateUserDto { [Required(ErrorMessage = "" "")] [MaxLength(User.EmailLength, ErrorMessage = "" 40 "")] [RegularExpression(User.NameRegularExpression, ErrorMessage = "" , , , "")] public string Name { get; set; } [Required(ErrorMessage = "" Email"")] [MaxLength(User.EmailLength, ErrorMessage = "" 100 "")] [RegularExpression(User.EmailRegularExpression, ErrorMessage = "" "")] public virtual string Email { get; set; } [Required(ErrorMessage = "" "")] [MaxLength(User.FullNameLength, ErrorMessage = "" 100 "")] [RegularExpression(User.NameRegularExpression, ErrorMessage = "" , , , "")] public virtual string FullName { get; set; } public virtual int Role { get; set; } [RegularExpression(User.PhoneRegularExpression, ErrorMessage = "" "")] public virtual string Phone { get; set; } public virtual int Status { get; set; } [Required(ErrorMessage = "" "")] [MinLength(User.PasswordMinLength, ErrorMessage = "" 5 "")] [MaxLength(User.PasswordMaxLength, ErrorMessage = "" 20 "")] [RegularExpression(User.PasswordRegularExpression, ErrorMessage = "" , , , "")] public virtual string Password { get; set; } }} @model Argussoft.BI.DAL.DTOs.UserDTOs.CreateUserDto@using (Ajax.BeginForm(""CreateUser"", ""User"", new AjaxOptions { OnSuccess = ""onSuccessCreateUser"" }, new { id = ""dialog_form"", @class = ""form-horizontal"" })){ <div class=""modal-header""> <button type=""button"" class=""close"" data-dismiss=""modal"" aria-hidden=""true"">&times;</button> <h4> </h4> </div> <div class=""modal-body""> <!-- Name --> <div class=""control-group""> <label class=""control-label"" for=""@Html.NameFor(model => model.Name)""></label> <div class=""controls""> <div class=""input-prepend""> @Html.TextBoxFor(model => model.Name, new { @class = ""span3"", id = ""input_name"" }) <br /> @Html.ValidationMessageFor(model => model.Name) </div> </div> </div> <!-- Email --> <div class=""control-group""> <label class=""control-label"" for=""@Html.NameFor(model => model.Email)"">Email</label> <div class=""controls""> <div class=""input-prepend""> @Html.TextBoxFor(model => model.Email, new { @class = ""span3"", id = ""input_email"" }) <br /> @Html.ValidationMessageFor(model => model.Email) </div> </div> </div> <!-- FullName --> <div class=""control-group""> <label class=""control-label"" for=""@Html.NameFor(model => model.FullName)""> </label> <div class=""controls""> <div class=""input-prepend""> @Html.TextBoxFor(model => model.FullName, new { @class = ""span3"", id = ""input_full_name"" }) <br /> @Html.ValidationMessageFor(model => model.FullName) </div> </div> </div> <!-- Role --> <div class=""control-group""> <label class=""control-label"" for=""@Html.NameFor(model => model.Role)""> </label> <div class=""controls""> <div class=""input-prepend""> @Html.DropDownList(""Role"", (SelectList)ViewBag.Roles,new{id =""input_role""}) <br /> @Html.ValidationMessageFor(model => model.Role) </div> </div> </div> <!-- Phone --> <div class=""control-group""> <label class=""control-label"" for=""@Html.NameFor(model => model.Phone)""> </label> <div class=""controls""> <div class=""input-prepend""> @Html.TextBoxFor(model => model.Phone, new { @class = ""span3"", id = ""input_phone"" }) <br /> @Html.ValidationMessageFor(model => model.Phone) </div> </div> </div> <!-- Status --> <div class=""control-group""> <label class=""control-label"" for=""@Html.NameFor(model => model.Status)""> </label> <div class=""controls""> <div class=""input-prepend""> @Html.DropDownList(""Status"", (SelectList)ViewBag.UserStatuses,new{id =""input_status""}) <br /> @Html.ValidationMessageFor(model => model.Status) </div> </div> </div> <!-- Password --> <div class=""control-group""> <label class=""control-label"" for=""@Html.NameFor(model => model.Password)""> </label> <div class=""controls""> <div class=""input-prepend""> @Html.TextBoxFor(model => model.Password, new { @class = ""span3"", id = ""input_password"" }) <br /> @Html.ValidationMessageFor(model => model.Password) </div> </div> </div> </div> <div class=""modal-footer""> <a href=""@Url.Action(""UserIndex"", ""User"")"" class=""btn""></a> <button type=""submit"" id=""save_button"" class=""btn btn-primary""></button> </div>} public class User : BaseEntity { public const int NameLength = 40; public const int PasswordMinLength = 5; public const int PasswordMaxLength = 20; public const int FullNameLength = 100; public const int EmailLength = 100; public const int PhoneLength = 40; //...}",String MinLength and MaxLength validation don't work (asp.net mvc)
How to Replace Backward slash with forward slash," i have a string /Images/Me.jpg i want to replace forward slashes with backward slashes like this \Images\Me.jpg, iam using string.Replace(""/"",""\""); but the output is \\Images\\Me.jpg please help <code> ",How to replace forward slash with backward slash
Are there any official ways to put code in a property constructor?," Something like this: I realize Select is not intended to be used this way. But yeah, what are some other ways to do the same thing? <code>  var myObject = new MyClass(){ x = "" "".Select(y => { //Do stuff.. if (2 + 2 == 5) return ""I like cookies""; else if (2 + 2 == 3) return ""I like muffins""; //More conditions... else return ""I'm a bitter old man""; })};",Are there any official ways to write an Immediately Invoked Function Expression?
Are there any official ways to write an Immediately Invoked Function Expression in C#?," Something like this: I realize Select is not intended to be used this way. But yeah, what are some other ways to do the same thing? <code>  var myObject = new MyClass(){ x = "" "".Select(y => { //Do stuff.. if (2 + 2 == 5) return ""I like cookies""; else if (2 + 2 == 3) return ""I like muffins""; //More conditions... else return ""I'm a bitter old man""; })};",Are there any official ways to write an Immediately Invoked Function Expression?
How to change Installation Folder Url after publish the Appication, How can I change the Installation Folder Url and Update location of a C# click once application after publish the application using MSBuild.exe <code> ,How to change Installation Folder Url after publish the Application
srange error when parsing string to dateC#?," When I try to parse date like this: It works correctly but when I do thing like this : I get this error : An exception of type 'System.FormatException' occurred in mscorlib.ni.dll but was not handled in user code <code>  DateTime t1 = DateTime.ParseExact(""August 11, 2013, 11:00:00 PM"", ""MMMM dd, yyyy, hh:mm:ss tt"", System.Globalization.CultureInfo.InvariantCulture); string s =""August 11, 2013, 11:00:00 PM"";DateTime t = DateTime.ParseExact(s, ""MMMM dd, yyyy, hh:mm:ss tt"", System.Globalization.CultureInfo.InvariantCulture);",Strange error when parsing string to date?
c# (itextsharp) fill pdf form with unicode characters," I am trying to insert some unicode charaters (arabic) to PDF form with c# I used iTextSharp library but when I insert the characters and save characters in the PDF file the unicode characters not getting displayed until I double click on the position of the chracters that should be appeared. <code>  string pdfTemplate = @""c:\po.pdf"";string newFile = @""g:\test\completed_fw4.pdf"";PdfReader pdfReader = new PdfReader(pdfTemplate);PdfStamper pdfStamper = new PdfStamper(pdfReader, new FileStream(newFile, FileMode.Create));AcroFields pdfFormFields = pdfStamper.AcroFields;pdfFormFields.SetField(""position"", TextBox1.Text);pdfStamper.FormFlattening = false;// close the pdfpdfStamper.Close(); ",fill pdf form with unicode characters
C# Selenium WebDriver: Get HTTP Status Code," I'm using Selenium, C#, NUnit to write automated tests.Is it possible to get the HTTP status code with WebDriver so that tests that fail due to HTTP requests can be alerted to the user? <code> ",Getting HTTP Status Code by Selenium WebDriver C#
Cuase of high UDP package loss on localhost?," In my WPF 4.0 application, I have a UDP listener implemented as shown below. On my Windows 7 PC, I'm running both server and client on localhost.Each received datagram is a scanline of a larger bitmap, so after all scanlines have been received the bitmap is shown on the UI thread. This seems to work. However, occasionally some 1-50% scanlines are missing. I would expect this on a weak network connection, but not when run locally.What may cause UDP package loss with the following piece of code? If I put a System.Diagnostics.Debug.WriteLine in my callback, the package loss increases dramatically. It seems that a small millisecond delay inside this callback causes problems. Still, the same problem is seen in my release build.UPDATEThe error becomes more frequent when I stress the UI a bit. Is the UdpClient instance executed on the main thread? <code>  IPEndPoint endPoint = new IPEndPoint(IPAddress.Any, PORT);udpClient = new UdpClient(endPoint);udpClient.Client.ReceiveBufferSize = 65535; // I've tried many different sizes...var status = new UdpStatus(){ u = udpClient, e = endPoint};udpClient.BeginReceive(new AsyncCallback(UdpCallback), status);private void UdpCallback(IAsyncResult ar){ IPEndPoint endPoint = ((UdpStatus)(ar.AsyncState)).e; UdpClient client = ((UdpStatus)(ar.AsyncState)).u; byte[] datagram = client.EndReceive(ar, ref endPoint); // Immediately begin listening for next packet so as to not miss any. client.BeginReceive(new AsyncCallback(UdpCallback), ar.AsyncState); lock (bufferLock) { // Fast processing of datagram. // This merely involves copying the datagram (scanline) into a larger buffer. // // WHEN READY: // Here I can see that scanlines are missing in my larger buffer. }}",Cause of high UDP package loss on localhost?
How to use public and privarte key encryption technic in C#," I want to encrypt data using public/private key technique. I mean, encrypt with the public key of receiver and the receiver can decrypt with their own private key. How can I do that? Do you have any suggestion or sample code ? <code> ",How to use public and private key encryption technique in C#
Unable to add goto label at end of method," After researching a way to exit a nested loop, I decided to try using goto, But for some reason, if I put a goto label is at the very end of the method, Visual Studio 2012 (Ultimate) complains (and it won't compile),But if I change my code to this, None of the errors appear (and it compiles); I've searched through all the MSDN references that I know of, and I couldn't find anything about this.I know that I could easily solve this problem by using return;; even so, I would still like to find out what's causing this error. <code>  private void example(){ for (int i = 0; i < 100; i++) { for (int ii = 0; ii < 100; ii++) { for (int iii = 0; iii < 100; iii++) { goto exitMethod; } } }exitMethod:} private void example(){ for (int i = 0; i < 100; i++) { for (int ii = 0; ii < 100; ii++) { for (int iii = 0; iii < 100; iii++) { goto exitMethod; } } }exitMethod: int someUnneededVariable; // Just an example, if I add ANY piece of code the error vanishes.}",Why can't I add a goto label at the end of a method?
Unable to add a goto label at the end of a method," After researching a way to exit a nested loop, I decided to try using goto, But for some reason, if I put a goto label is at the very end of the method, Visual Studio 2012 (Ultimate) complains (and it won't compile),But if I change my code to this, None of the errors appear (and it compiles); I've searched through all the MSDN references that I know of, and I couldn't find anything about this.I know that I could easily solve this problem by using return;; even so, I would still like to find out what's causing this error. <code>  private void example(){ for (int i = 0; i < 100; i++) { for (int ii = 0; ii < 100; ii++) { for (int iii = 0; iii < 100; iii++) { goto exitMethod; } } }exitMethod:} private void example(){ for (int i = 0; i < 100; i++) { for (int ii = 0; ii < 100; ii++) { for (int iii = 0; iii < 100; iii++) { goto exitMethod; } } }exitMethod: int someUnneededVariable; // Just an example, if I add ANY piece of code the error vanishes.}",Why can't I add a goto label at the end of a method?
how to get which radio button is checked from groupbox," I have these groupboxes:I want to run some code according to checked true state of a radio button like: Is there any direct way so that I can only get the name of the checked radio button? <code>  string chk = radiobutton.nme; // Name of radio button whose checked is trueswitch(chk){ case ""Option1"": // Some code break; case ""Option2"": // Some code break; case ""Option3"": // Some code break;}",How do I get which radio button is checked from a groupbox?
"Is there a place after the constructor, but before the Loaded event where you can access properties set in XAML?"," We have an issue where our user control is initialized based on what the user sets in XAML when utilizing our control. Currently we were using the 'Loaded' event to act on what the user had set or not.However, the issue with using the Loaded event is another sibling of this control is using their loaded event to set something on ours, which isn't yet fully initialized since our Loaded event hasn't yet fired. (It's a UI race condition if you will.)Again, we can't move our code to the constructor as the WPF system hasn't yet set the properties specified by the XAML of the consumer of our control. We can't use the Loaded event for the reasons stated above. Initialized doesn't seem to work either.I've also looked into ISupportsInitialize, but that's where we would be batch-setting the control's properties, not something externally, so that doesn't seem to be a fit either.Thoughts?UpdateI've since found out this is an anomaly specifically with UserControls. They handle initialization differently. You can find more details in my follow-up question here...How can you access XAML-set properties of a UserControl during initialization?...but the short version is calling InitializeComponent in the constructor actually raises the Initialized event, but does so before the XAML-defined properties have actually been set. Comment it out and the properties are now set when Initialized fires, but of course your control's UI isn't loaded! Kinda frustrating actually.Still looking for a solution. Code examples and more details can be found there. <code> ","Specifically for a User Control, is there a place after the constructor, but before the Loaded event where you can access properties set in XAML?"
C# ASCII in a byte array to string," I seem to be having problems with my string conversions in C#.My application has received a byte array consisting of an ASCII string (one byte per character). Unfortunately it also has a 0 in the first location. So how do I convert this byte array to a c# string? Below is a sample of the data I am trying to convert: I have made several unsuccessful attempts, so thought I would ask for assistance.Eventually I need to add the string to a listbox: The desired output in the listBox: ""RPM = 255,630"" (with or without the linefeed). The byte array will be variable length, but will always be terminated with 0x00  <code>  byte[] exampleByteArray = new byte[] { 0x00, 0x52, 0x50, 0x4D, 0x20, 0x3D, 0x20, 0x32, 0x35, 0x35, 0x2C, 0x36, 0x30, 0x0A, 0x00 };string myString = null; listBox.Items.Add(myString);",Convert ASCII in a byte array to string
LINQ Select from a datarow with apostrophe conflict C#," I recently found when I do a LINQ select under a field that contains an apostrophe, it makes my application to throw an exception. If drData[""Name""] = ""The business's money""I got an exception of ""Syntax error: Missing operand after 'S' operator ""Can anyone tell me how to preserve it and no replace it or remove it, please? <code>  DataRow[] newDr = this.ds.Tables[""TableName""].Select(""Name = '"" + drData[""Name""].ToString() + ""'"");",DataTable select method with single quote conflict C#
How to add a datepicker in WPF," I have a simple DataGrid with a DataGridTextColumn in it. How do I add a Datepicker to my DataGridTextColumn? <code>  <DataGrid Name=""myfirstdg"" Grid.Row=""2"" AutoGenerateColumns=""False"" CanUserSortColumns=""False"" CanUserAddRows=""False"" CanUserDeleteRows=""False"" SelectionUnit=""Cell""> <DataGrid.Columns> <DataGridTextColumn Header=""Date"" Binding=""{Binding Path=date}"" Width=""SizeToCells"" IsReadOnly=""True"" MinWidth=""100""/> </DataGrid.Columns></DataGrid>",How to add a DatePicker to DataGridTextColumn in WPF
Visual Studio - Find All References of a common method name in C#," In Visual Studio 2010, if I right-click a method and choose ""Find All References"", it simply displays use of all methods with the same name rather than use of the method of that actual class.The solution is C# rather than C++, so I can't find a way to switch to accuracy mode. Also, I cannot simply make the method private or comment it out to generate errors as the method is an override: Is there any way of finding all uses of a particular class method in a solution without trawling through every single name match (in this case every instance of ToString() in the solution)? <code>  public override string ToString() { ... }",Finding all references of a common method name in Visual Studio 2010 for a C# solution
How can I find all references of a common method name?," In Visual Studio 2010, if I right-click a method and choose ""Find All References"", it simply displays use of all methods with the same name rather than use of the method of that actual class.The solution is C# rather than C++, so I can't find a way to switch to accuracy mode. Also, I cannot simply make the method private or comment it out to generate errors as the method is an override: Is there any way of finding all uses of a particular class method in a solution without trawling through every single name match (in this case every instance of ToString() in the solution)? <code>  public override string ToString() { ... }",Finding all references of a common method name in Visual Studio 2010 for a C# solution
Proper way to handle the ambersand character in JSON string send to REST web service," OK,I am using the System.Runtime.Serialization and the DataContractJsonSerialization.The problem is that in the request I send a value of a property with the & character. Say, AT&T, and I get a response with error: Invalid JSON Data.I thought that the escaping would be done inside the library but now I see that the serialization is left untouched the ampersand & character.Yes, for a JSON format this is valid. But it will be a problem to my POST request since I need to send this to a server that if contains an ampersand will response with error, hence here I am.HttpUtility.HtmlEncode is in the System.Web library and so the way to go is using Uri.EscapeUriString. I did this to try, but anyway, and without it all requests are working fine, except an ampersand is in a value.EDIT: HttpUtility class is ported to the Windows Phone SDK but the prefer way to encode a string should be still Uri.EscapeUriString.First thought was to get hands dirty and start replacing the special character which would cause a problem in the server, but, I wonder, is there another solution I should do, that it would be efficient and 'proper'?I should tell that I use To convert the JSON to a byte[] and write to the Stream.And, As the WebRequest.ContentType.So, am I messed up for a reason or something I miss?Thank you. <code>  // Convert the string into a byte array.byte[] postBytes = Encoding.UTF8.GetBytes(data); request.ContentType = ""application/x-www-form-urlencoded"";",Proper way to handle the ampersand character in JSON string send to REST web service
Difference between IsNullOrEmpty and IsNullOrWhiteSpace in c#," What are differences between these commands in C# <code>  string text= "" "";1-string.IsNullOrEmpty(text.Trim())2-string.IsNullOrWhiteSpace(text)",Difference between IsNullOrEmpty and IsNullOrWhiteSpace in C#
Concatenating Two Different List in C#," For example I have these two lists: How can I concatenate firstName[0] and lastName[0], firstName[1] and lastName[1], etc and put it in a new list? <code>  List<string> firstName = new List<string>();List<string> lastName = new List<string>();",Merging 2 Lists
Concatenating Two Different List," For example I have these two lists: How can I concatenate firstName[0] and lastName[0], firstName[1] and lastName[1], etc and put it in a new list? <code>  List<string> firstName = new List<string>();List<string> lastName = new List<string>();",Merging 2 Lists
C# Winforms - How to avoid color changes when button is disabled," We have a Windows Forms project with quite a few FlatStyle buttons.When we disable the buttons, the colors of the buttons are changed automatically Frown | :(Is it possible to override this somehow, so we can control the colors ourselves? <code> ",How to avoid color changes when button is disabled?
Complex Math in Code - Okay to hard-code?," Is there a generally accepted best approach to coding complex math? For example: Is this a point where hard-coding the numbers is okay? Or should each number have a constant associated with it? Or is there even another way, like storing the calculations in config and invoking them somehow?There will be a lot of code like this, and I'm trying to keep it maintainable.Note: The example shown above is just one line. There would be tens or hundreds of these lines of code. And not only could the numbers change, but the formula could as well. <code>  double someNumber = .123 + .456 * Math.Pow(Math.E, .789 * Math.Pow((homeIndex + .22), .012));",Is it okay to hard-code complex math logic inside my code?
Is it okay to hard-code Complex Math logic inside my code - ?," Is there a generally accepted best approach to coding complex math? For example: Is this a point where hard-coding the numbers is okay? Or should each number have a constant associated with it? Or is there even another way, like storing the calculations in config and invoking them somehow?There will be a lot of code like this, and I'm trying to keep it maintainable.Note: The example shown above is just one line. There would be tens or hundreds of these lines of code. And not only could the numbers change, but the formula could as well. <code>  double someNumber = .123 + .456 * Math.Pow(Math.E, .789 * Math.Pow((homeIndex + .22), .012));",Is it okay to hard-code complex math logic inside my code?
Using Generics to Create a DataTable from a class," I've just learned about Generics and I'm wondering whether I can use it to dynamically build datatables from my classes.Or I might be missing the point here.Here is my code, what I'm trying to do is create a datatable from my existing class and populate it. However I'm getting stuck in my thought process. Now At the DataTable point it errors. Also, being new to reflection and Generics, how will I actually populate the data with the Killer class? <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Reflection;using System.Data;namespace Generics{ public class Dog { public string Breed { get; set; } public string Name { get; set; } public int legs { get; set; } public bool tail { get; set; } } class Program { public static DataTable CreateDataTable(Type animaltype) { DataTable return_Datatable = new DataTable(); foreach (PropertyInfo info in animaltype.GetProperties()) { return_Datatable.Columns.Add(new DataColumn(info.Name, info.PropertyType)); } return return_Datatable; } static void Main(string[] args) { Dog Killer = new Dog(); Killer.Breed = ""Maltese Poodle""; Killer.legs = 3; Killer.tail = false; Killer.Name = ""Killer""; DataTable dogTable = new DataTable(); dogTable = CreateDataTable(Dog);//How do I continue from here? } }} ",Using Reflection to create a DataTable from a Class?
Visual Studio 2012 - Can't select controls on my form," This has started happening recently (not too sure what caused the change unfortunately), but I can no longer select controls on my form. My reading on this has uncovered some possible explanations including:You're running your program in debug modeYour form is derived from another class where everything is privateYour controls are ""locked"".For (1), no, it's definitely not running and for (2) my form is derived from DevComponents.DotNetBar.RibbonForm. For (3), no, they're not ""locked"" (I tried locking and then unlocking, in case some state was stuck in the designer, but no dice). The controls are on my form, not the base class form and the instances aren't private (I deliberately made them public just to test this one) and they were working fine before.So, what can I do? I can select a control, like a ComboBox, from the Properties window drop-down list, change its properties and so on. But when I choose it nothing gets selected in the designer. I can select the form itself (by its border) and resize it in the designer. I can add a new control, like a label, and interact with it fine in the designer, so this is something that's happened to my existing controls.I'm sure it's either something spectacularly dumb, or Visual Studio 2012 is on the wind-up.Anybody?Edit: Zipped the solution up and brought it home. Cleaned and rebuilt and it's working fine in the designer. I guess there's an issue with my install at work, somehow. <code> ",Can't select controls on my form
WPF - how to made a header for LisBoxItem?," I use ListBox in my application. ListBox has two columns. I want to make a title for the columns. It is layout When a few items in the ListBox are all displayed OK. But when a lot of elements in the list - a vertical scroll bar in ListBox is visible. Then the title and move across the width of the columns.How to align the width of the columns and headers? <code>  <Window.Resources> <Style x:Key=""borderBase"" TargetType=""Border""> <Setter Property=""BorderBrush"" Value=""Black"" /> <Setter Property=""BorderThickness"" Value=""1"" /> </Style></Window.Resources><Grid> <Grid.RowDefinitions> <RowDefinition Height=""1*"" /> <RowDefinition Height=""7*"" /> </Grid.RowDefinitions> <!-- Title --> <Grid> <Grid.ColumnDefinitions> <ColumnDefinition /> <ColumnDefinition /> </Grid.ColumnDefinitions> <Border Style=""{StaticResource borderBase}""> <TextBlock Text=""FirstName"" /> </Border> <Border Grid.Column=""1"" Style=""{StaticResource borderBase}""> <TextBlock Text=""SecondName"" /> </Border> </Grid> <!-- Data --> <ListBox Grid.Row=""1""> <ListBox.ItemTemplate> <DataTemplate> <Grid> <Grid.ColumnDefinitions> <ColumnDefinition /> <ColumnDefinition /> </Grid.ColumnDefinitions> <Border Style=""{StaticResource borderBase}""> <TextBlock Style=""{StaticResource textBlockBase}"" Text=""{Binding FirstName}"" /> </Border> <Border Grid.Column=""1"" Style=""{StaticResource borderRigth}""> <TextBlock Style=""{StaticResource textBlockBase}"" Text=""{Binding SecondName}"" /> </Border> </Grid> </DataTemplate> </ListBox.ItemTemplate> </ListBox></Grid>",How do I make a header for a ListBoxItem?
How to check Whether ASP.NET button is Clicked or Not on Page_Load, How can I check whether a particular button was clicked or not in ASP.NET?I think I need to perform some operation on Page_Load. This shouldn't be entering to Button_Click event to find. Is there any way that I can find where it was clicked or not on Client Side and take it to Page_Load? <code> ,How to check whether ASP.NET button is clicked or not on page load
Pass exception from my class to my main form by open new message box," I'm wondering what the correct way is to pass on an exception from one method to my form. Form: in this way i cannot see my text box. <code>  public void test(){ try { int num = int.Parse(""gagw""); } catch (Exception) { throw; }} try{ test();}catch (Exception ex){ MessageBox.Show(ex.Message);}",Show message box in case of exception
AutoFixture CompositeDataAttribute dose not work with PropertyDataAttribute," I'm trying to create AutoPropertyDataAttribute based on CompositeDataAttribute from this example AutoFixture: PropertyData and heterogeneous parameters.It works with single set of parameters, but fails with more sets of parameters. Here is code: Trying to uncomment the second yield will break test with message: Same happens with ClassDataAttribute <code>  public static IEnumerable<object[]> NumericSequence{ get { yield return new object[] {1}; //yield return new object[] {2}; }}[Theory][AutoPropertyData(""NumericSequence"")]public void Test(int? p1, int? p2, int? p3){ Assert.NotNull(p1); Assert.NotNull(p2);}public class AutoPropertyDataAttribute : CompositeDataAttribute{ public AutoPropertyDataAttribute(string propertyName) : base( new DataAttribute[] { new PropertyDataAttribute(propertyName), new AutoDataAttribute() }) { }} System.InvalidOperationException: Expected 2 parameters, got 1 parameters at Ploeh.AutoFixture.Xunit.CompositeDataAttribute.<GetData>d__0.MoveNext() at Xunit.Extensions.TheoryAttribute.<GetData>d__7.MoveNext() at Xunit.Extensions.TheoryAttribute.EnumerateTestCommands(IMethodInfo method)",AutoFixture CompositeDataAttribute does not work with PropertyDataAttribute
How to write unit-test when return type is ActionResult?," I have written unit test for following action. Test method can access Model properties, only when return type is ViewResult. In above code, I have used RedirectToAction so return type of this action can not be ViewResult. In such scenario how do you unit-test an action? <code>  [HttpPost]public ActionResult/*ViewResult*/ Create(MyViewModel vm){ if (ModelState.IsValid) { //Do something... return RedirectToAction(""Index""); } return View(vm);}","How to unit-test an action, when return type is ActionResult?"
Resharper reformatting String.Format() arguments," I often find myself writing something daft like: or something similar but with far more string placeholders.Is there an automated refactoring in ReSharper to change the order of the placeholders and the arguments? I have a tendency to mess up the mapping if I try to change the order by hand.Obviously, the example above is trivial. What I am doing in reality is often writing something like: and thinking to myself that it would be great if I could move table3Alias up to the front next to the other aliases.(ReSharper 7.1.3) <code>  String.Format(""{1}: {0}"", reason, message); String.Format(""{0}.{2} = {1}.{3} AND {0}.{4} = {1}.{5} AND {6}.{7} = {1}.{8}"", table1Alias, table2Alias, col1A, col2A, col1B, col2B, table3Alias, col3C, col2C);",ReSharper reorder String.Format() arguments
UpdatePanel and controls," I have a gridview inside an UpdatePanel (the gridview is showing in a popup). On click of a select button in that grid, I am trying to set a textbox text in the page. But its not working; if I remove the update panel then it will work.This is my code in aspx: <code>  <div><asp:TextBox ID=""txt"" runat=""server /></div> <asp:UpdatePanel ID=""updLendersearch"" runat=""server"" UpdateMode=""Conditional""> <Triggers> <asp:AsyncPostBackTrigger ControlID=""btnLenderSearch"" EventName=""Click"" /> </Triggers> <ContentTemplate> <div id=""divLender"" runat=""server"" class=""white_content"" style=""height: 450px;top: 20%;width: 57%;""> <asp:Label ID=""lblBenificiary"" runat=""server"" Text=""Beneficiary/Lender :"" Font-Names=""Candara"" ></asp:Label> <asp:TextBox ID=""txtBeneficiaryName"" Style=""border: 1px solid red"" runat=""server"" Width=""80px"" CssClass=""txtboxes"" Font-Names=""Candara"" ></asp:TextBox> <asp:RequiredFieldValidator ID=""reqBeneficiaryName"" runat=""server"" ErrorMessage=""*"" ForeColor=""Red"" ControlToValidate=""txtBeneficiaryName"" ValidationGroup=""lender""></asp:RequiredFieldValidator> <asp:Label ID=""lblLenderState"" runat=""server"" Text=""State :"" Font-Names=""Candara"" ></asp:Label> <asp:DropDownList ID=""ddlLenderState"" runat=""server"" AutoPostBack=""true"" Style=""border: 1px solid red"" AppendDataBoundItems=""true"" CssClass=""drpdown"" OnSelectedIndexChanged=""ddlLenderState_SelectedIndexChanged""> </asp:DropDownList> <asp:RequiredFieldValidator ID=""reqLenderState"" runat=""server"" ErrorMessage=""*"" ForeColor=""Red"" ControlToValidate=""ddlLenderState"" ValidationGroup=""lender""></asp:RequiredFieldValidator> <asp:Label ID=""lblLenderCity"" runat=""server"" Text=""City :"" Font-Names=""Candara"" ></asp:Label> <asp:DropDownList ID=""ddlLenderCity"" runat=""server"" Width=""100px"" AutoPostBack=""true"" AppendDataBoundItems=""true"" CssClass=""drpdown"" OnSelectedIndexChanged=""ddlLenderCity_SelectedIndexChanged""> </asp:DropDownList> <asp:Label ID=""lblBeneficiaryZip"" runat=""server"" Text=""Zip :"" Font-Names=""Candara"" ></asp:Label> <asp:DropDownList ID=""ddlBeneficiaryZip"" runat=""server"" AppendDataBoundItems=""true"" Width=""100px"" AutoPostBack=""true"" CssClass=""drpdown""> </asp:DropDownList> <asp:Button ID=""btnBenefeciary"" ValidationGroup=""lender"" runat=""server"" Text=""Search"" Font-Names=""Candara"" CssClass=""btnBenefeciary"" OnClick=""btnBenefeciary_Click""/> <br><br><br><br> <div> <asp:GridView ID=""grvLenderDetails"" CssClass=""GridViewStyle"" ShowHeaderWhenEmpty=""true"" OnRowCommand=""grvLenderDetails_RowCommand"" runat=""server"" AutoGenerateColumns=""false"" AutoGenerateSelectButton=""true""> <Columns> .. .. .. </Columns> <EmptyDataTemplate> No Records To Display </EmptyDataTemplate> </asp:GridView> </div> </div> <div id=""fadeLender"" class=""black_overlay"" runat=""server""> <asp:ImageButton ID=""imgLenderClose"" ImageUrl=""../Images/closepnlbtn.png"" runat=""server"" align=""right"" Style=""margin-right: 140px; margin-top: 78px; border: 0px"" OnClick=""imgLenderClose_Click"" /> </div> </ContentTemplate></asp:UpdatePanel>",Change text in TextBox outside of UpdatePanel
wpf Datagrid : Textbox Keydown event not firing when Down key press," I have a datagrid with one column as DataGridTemplateColumn as follows : When the cell value change I want to populate some items to the listview ,the TextChanged event is as follows : When the User enter the down key on the keyboard I want to focus on the listview but It won't fire the Keydown event when I press Down,Back,Space etc keys ,But other keys like alphanumeric keys all working fine .My keydown event is as follows : What I did wrong in my code ? <code>  <my:DataGrid Name=""dgvSales"" RowHeight=""23"" SelectionUnit=""Cell"" BeginningEdit=""dgvSales_BeginningEdit"" AutoGenerateColumns=""False"" CellEditEnding=""dgvSales_CellEditEnding"" > <my:DataGrid.Columns> <my:DataGridTemplateColumn Header=""Product Name"" Width=""200""> <my:DataGridTemplateColumn.CellTemplate> <DataTemplate> <TextBlock Text=""{Binding Product_Name}""></TextBlock> </DataTemplate> </my:DataGridTemplateColumn.CellTemplate> <my:DataGridTemplateColumn.CellEditingTemplate> <DataTemplate> <TextBox x:Name=""txtbxProduct"" Text=""{Binding Product_Name}"" TextChanged=""txtbxProduct_TextChanged"" KeyDown=""txtbxProduct_KeyDown""></TextBox> </DataTemplate> </my:DataGridTemplateColumn.CellEditingTemplate> </my:DataGridTemplateColumn> </my:DataGrid.Columns></my:DataGrid> private void txtbxProduct_TextChanged(object sender, TextChangedEventArgs e) { TextBox tb = (TextBox)sender; if (tb.Text.Trim() != """") { string qry = ""select PL.Record_Id as PList_Id,PM.Record_Id as Product_Id,PM.Product_Code,PM.Product_Name,PTM.Product_Type,PL.Purchase_Rate ,PL.Selling_Rate,PL.MRP from dbo.Tbl_Product_Master PM join Tbl_Product_List PL on PL.Product_Id=PM.Record_Id join Tbl_Product_Type_Master PTM on PTM.Record_Id=PM.Product_Category_Id where PL.Batch_Flag=0 and PM.Is_Del='false'and PM.Is_Active='true' and PM.Product_Name like '%"" + tb.Text.Trim() + ""%' order by PM.Product_Name ""; DataSet ds = ObjCommon.GetObject.ExecuteQuery_Select(Connection.ConnectionString, qry); if (ds.Tables[0].Rows.Count > 0) { lstvwProductCode.ItemsSource = ds.Tables[0].DefaultView; lstvwProductCode.Visibility = Visibility.Visible; } else { lstvwProductCode.ItemsSource = null; lstvwProductCode.Visibility = Visibility.Collapsed; } } else { lstvwProductCode.ItemsSource = null; lstvwProductCode.Visibility = Visibility.Collapsed; } } private void txtbxProduct_KeyDown(object sender, KeyEventArgs e) { TextBox tb = (TextBox)sender; if (e.Key == Key.Escape) { tb.Clear(); lstvwProductCode.Visibility = Visibility.Collapsed; tb.Focus(); } else if (e.Key == Key.Down) { if (lstvwProductCode.Items.Count > 0) { lstvwProductCode.SelectedIndex = 0; lstvwProductCode.Focus(); lstvwProductCode.Visibility = Visibility.Visible; } } }",Textbox Keydown event not firing when arrow key press
Textbox Keydown event not firing when Down key press," I have a datagrid with one column as DataGridTemplateColumn as follows : When the cell value change I want to populate some items to the listview ,the TextChanged event is as follows : When the User enter the down key on the keyboard I want to focus on the listview but It won't fire the Keydown event when I press Down,Back,Space etc keys ,But other keys like alphanumeric keys all working fine .My keydown event is as follows : What I did wrong in my code ? <code>  <my:DataGrid Name=""dgvSales"" RowHeight=""23"" SelectionUnit=""Cell"" BeginningEdit=""dgvSales_BeginningEdit"" AutoGenerateColumns=""False"" CellEditEnding=""dgvSales_CellEditEnding"" > <my:DataGrid.Columns> <my:DataGridTemplateColumn Header=""Product Name"" Width=""200""> <my:DataGridTemplateColumn.CellTemplate> <DataTemplate> <TextBlock Text=""{Binding Product_Name}""></TextBlock> </DataTemplate> </my:DataGridTemplateColumn.CellTemplate> <my:DataGridTemplateColumn.CellEditingTemplate> <DataTemplate> <TextBox x:Name=""txtbxProduct"" Text=""{Binding Product_Name}"" TextChanged=""txtbxProduct_TextChanged"" KeyDown=""txtbxProduct_KeyDown""></TextBox> </DataTemplate> </my:DataGridTemplateColumn.CellEditingTemplate> </my:DataGridTemplateColumn> </my:DataGrid.Columns></my:DataGrid> private void txtbxProduct_TextChanged(object sender, TextChangedEventArgs e) { TextBox tb = (TextBox)sender; if (tb.Text.Trim() != """") { string qry = ""select PL.Record_Id as PList_Id,PM.Record_Id as Product_Id,PM.Product_Code,PM.Product_Name,PTM.Product_Type,PL.Purchase_Rate ,PL.Selling_Rate,PL.MRP from dbo.Tbl_Product_Master PM join Tbl_Product_List PL on PL.Product_Id=PM.Record_Id join Tbl_Product_Type_Master PTM on PTM.Record_Id=PM.Product_Category_Id where PL.Batch_Flag=0 and PM.Is_Del='false'and PM.Is_Active='true' and PM.Product_Name like '%"" + tb.Text.Trim() + ""%' order by PM.Product_Name ""; DataSet ds = ObjCommon.GetObject.ExecuteQuery_Select(Connection.ConnectionString, qry); if (ds.Tables[0].Rows.Count > 0) { lstvwProductCode.ItemsSource = ds.Tables[0].DefaultView; lstvwProductCode.Visibility = Visibility.Visible; } else { lstvwProductCode.ItemsSource = null; lstvwProductCode.Visibility = Visibility.Collapsed; } } else { lstvwProductCode.ItemsSource = null; lstvwProductCode.Visibility = Visibility.Collapsed; } } private void txtbxProduct_KeyDown(object sender, KeyEventArgs e) { TextBox tb = (TextBox)sender; if (e.Key == Key.Escape) { tb.Clear(); lstvwProductCode.Visibility = Visibility.Collapsed; tb.Focus(); } else if (e.Key == Key.Down) { if (lstvwProductCode.Items.Count > 0) { lstvwProductCode.SelectedIndex = 0; lstvwProductCode.Focus(); lstvwProductCode.Visibility = Visibility.Visible; } } }",Textbox Keydown event not firing when arrow key press
ServiceStack support for conditional serialization on a per-call basis," <TL;DR>At a minimum, I'm looking for a way to conditionally exclude certain properties on the resource from being included in the response on a per-call basis (See fields below). Ideally, I'd like to implement a REST service with ServiceStack that supports all the major points below. UPDATEWhile I really like ServiceStack's approach in general and would prefer to use it if possible, if it isn't particularly well suited towards these ideas I'd rather not bend over backwards bastardizing it to make it work. If that's the case, can anyone point to another c# framework that might be more appropriate? I'm actively exploring other options myself, of course.</TD;DR>In this talk entitled Designing REST + JSON APIs, the presenter describes his strategy for Resource References (via href property on resources) in JSON. In addition to this, he describes two query parameters (fields and expand) for controlling what data is included the response of a call to a REST service. I've been trying without success to dig into the ServiceStack framework to achieve support for fields in particular but have thus far been unsuccessful. Is this currently possible in ServiceStack? Ideally the solution would be format agnostic and would therefore work across all of ServiceStack's supported output formats. I would imagine expand would follow the same strategy. I'll describe these features here but I think the talk at the link does a better job of explaining them.Lets say we have an Profiles resource with the following properties: givenName, surname, gender, and favColor. The Profiles resource also includes a list of social networks the user belongs to in the socialNetworks property. href - (42:22 in video) Every resource includes a full link to it on the REST service. A call to GET /profiles/123 would return Notice that the socialNetworks property returns an object with just the href value populated. This keeps the response short and focused while also giving the end user enough information to make further requests if desired. The href property, used across the board in this manor, makes it easy (conceptually anyway) to reuse resource data structures as children of other resources.fields - (55:44 in video) Query string parameter that instructs the server to only include the specified properties of the desired resource in the REST response. A normal response from GET /profiles/123 would include all the properties of the resource as seen above. When the fields query param is included in the request, only the fields specified are returned. 'GET /propfiles/123?fields=surname,favColor' would return expand - (45:53 in video) Query string parameter that instructs the server to flesh out the specified child resources in the result. Using our example, if you were to call GET /profiles/123?expand=socialNetworks you might receive something like <code>  { ""href"":""https://host/profiles/123"", ""givenName"":""Bob"", ""surname"":""Smith"", ""gender"":""male"", ""favColor"":""red"", ""socialNetworks"": { ""href"":""https://host/socialNetworkMemberships?profileId=123"" }} { ""href"":""https://host/profiles/123"", ""surname"":""Smith"", ""favColor"":""red""} { ""href"":""https://host/profiles/123"", ""givenName"":""Bob"", ""surname"":""Smith"", ""gender"":""male"", ""favColor"":""red"", ""socialNetworks"": { ""href"":""https://host/socialNetworkMemberships?profileId=123"", ""items"": [ { ""href"":""https://host/socialNetworkMemberships/abcde"", ""siteName"":""Facebook"", ""profileUrl"":""http://www.facebook.com/..."" }, ... ] }}",ServiceStack support for conditionally omitting fields from a REST response on a per-call basis
Enum flags in C#," I am using Enum flags in my application. The Enum can have around 50+ values, so values go up to 2^50. I was just wondering, can I use Math.Pow(2, variable) to calculate these?When I try to do that I get a constant value compile-time error. Is there another way, other than calculating these powers of 2 manually and putting it in?Here's what I am doing: <code>  [Flags]internal enum RiskStates : long { None = 0, AL = Convert.ToInt64(Math.Pow(2,0)), AK = 2, AZ = 4, AR = 8, CA = 16, CO = 32, CT = 64, DC = 128, DE = 256, FL = 512, GA = 1024, HI = 2048, ID = 4096, IL = 8192, IN = 16384, IA = 32768, KS = 65536, KY = 131072, LA = 262144, ME = 524288, MD = 1048576, MA = 2097152, MI = 4194304}",Enum flags over 2^32
How to deal with referncing of separatly stored objects in document DBs like Mongo?," This problem is easily solved in ORMs like Entity Framework or NHibernate, but I do not see any ready-made solution in c# driver for MongoDb. Let's say I have collection of objects of type A referencing objects type B which I need to store in separate collection, so that once specific object B is changed, all A referencing it need to be aware of the change. In other words, I need this object relation being normalized. In the same time I need B being referenced by A inside the class, not by Id, but by type reference like shown below: Do I have to handle all this referencing consistency on my own? If so, which approaches is the best to use? Do I have to keep both B's Id and B reference in the class and somehow take care of sync their values like that: I know somebody may say relational database meets this case the best, I know, but I really have to use document Db like MongoDb, it solves many problems, and in most cases I need to store objects denormalized for my project, however sometimes we might need mixed design inside single storage. <code>  public class A{ public B RefB { get; set; }} public class A{ // Need to implement reference consistency as well public int RefBId { get; set; } private B _refB; [BsonIgnore] public B RefB { get { return _refB; } set { _refB = value; RefBId = _refB.Id } }}",How to deal with referencing of separately stored objects in document DBs like Mongo?
"C# 3.5, notify when thread is complete, without locking calling thread"," I am working on a legacy application that is built on top of NET 3.5. This is a constraint that I can't change. I need to execute a second thread to run a long running task without locking the UI. When the thread is complete, somehow I need to execute a Callback.Right now I tried this pseudo-code: The second option, which does not lock the UI, is the following: Of course the second solution is not good cause it overcharge the UI.What is the correct way to execute a callback when a _thread is complete? Also, how do I know if the thread was cancelled or aborted?*Note: * I can't use the BackgroundWorker and I can't use the Async library, I need to work with the native thread class. <code>  Thread _thread = new Thread(myLongRunningTask) { IsBackground = True };_tread.Start();// wait until it's done_thread.Join();// execute finalizer Thread _thread = new Thread(myLongRunningTask) { IsBackground = True };_tread.Start();// wait until it's donewhile(_thread.IsAlive){ Application.DoEvents(); Thread.Sleep(100);}// execute finalizer","Notify when thread is complete, without locking calling thread"
force to bring excel window to the front ?," i have a small application developed in C# .NET that manipulate excel sheets, I don't know why some users keep telling me that when they open the excel file the window doesn't appear on front/top although I set the visible to true and the window state on maximized.This is the function that reads the excel file: Any ideas ? <code>  public static void OpenExcel(string fileName, bool visibility, FunctionToExecute fn = null){ string addInPath = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData), ""Microsoft\\AddIns\\mDF_XLcalendar.xla""); deleg = fn; app = new Excel.Application(); app.Workbooks.Open(addInPath); app.Workbooks.Open(fileName); app.ScreenUpdating = true; app.DisplayAlerts = true; app.Visible = visibility; app.UserControl = true; app.WindowState = Excel.XlWindowState.xlMaximized; EventDel_BeforeBookClose = new Excel.AppEvents_WorkbookBeforeCloseEventHandler(application_WorkbookBeforeClose); EventSave_BeforeBookClose = new Excel.AppEvents_WorkbookBeforeSaveEventHandler(Open_ExcelApp_WorkbookBeforeSave); app.WorkbookBeforeClose += EventDel_BeforeBookClose; app.WorkbookBeforeSave += EventSave_BeforeBookClose; } ",force to bring excel window to the front?
Force to bring excel window to the front?," i have a small application developed in C# .NET that manipulate excel sheets, I don't know why some users keep telling me that when they open the excel file the window doesn't appear on front/top although I set the visible to true and the window state on maximized.This is the function that reads the excel file: Any ideas ? <code>  public static void OpenExcel(string fileName, bool visibility, FunctionToExecute fn = null){ string addInPath = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData), ""Microsoft\\AddIns\\mDF_XLcalendar.xla""); deleg = fn; app = new Excel.Application(); app.Workbooks.Open(addInPath); app.Workbooks.Open(fileName); app.ScreenUpdating = true; app.DisplayAlerts = true; app.Visible = visibility; app.UserControl = true; app.WindowState = Excel.XlWindowState.xlMaximized; EventDel_BeforeBookClose = new Excel.AppEvents_WorkbookBeforeCloseEventHandler(application_WorkbookBeforeClose); EventSave_BeforeBookClose = new Excel.AppEvents_WorkbookBeforeSaveEventHandler(Open_ExcelApp_WorkbookBeforeSave); app.WorkbookBeforeClose += EventDel_BeforeBookClose; app.WorkbookBeforeSave += EventSave_BeforeBookClose; } ",force to bring excel window to the front?
force to bring excel window to the front ?," i have a small application developed in C# .NET that manipulate excel sheets, I don't know why some users keep telling me that when they open the excel file the window doesn't appear on front/top although I set the visible to true and the window state on maximized.This is the function that reads the excel file: Any ideas ? <code>  public static void OpenExcel(string fileName, bool visibility, FunctionToExecute fn = null){ string addInPath = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData), ""Microsoft\\AddIns\\mDF_XLcalendar.xla""); deleg = fn; app = new Excel.Application(); app.Workbooks.Open(addInPath); app.Workbooks.Open(fileName); app.ScreenUpdating = true; app.DisplayAlerts = true; app.Visible = visibility; app.UserControl = true; app.WindowState = Excel.XlWindowState.xlMaximized; EventDel_BeforeBookClose = new Excel.AppEvents_WorkbookBeforeCloseEventHandler(application_WorkbookBeforeClose); EventSave_BeforeBookClose = new Excel.AppEvents_WorkbookBeforeSaveEventHandler(Open_ExcelApp_WorkbookBeforeSave); app.WorkbookBeforeClose += EventDel_BeforeBookClose; app.WorkbookBeforeSave += EventSave_BeforeBookClose; } ",force to bring excel window to the front?
Entity Framework 5 - INSERT OPERATION MANY TO MANY RELATIONSHIP," I've two model classes: My DbContext name is JobsContext.The above code generates me 3 tables Candidates, Jobs & CandidatesJobs(autogenerated by EF)Now I've records in Jobs table : Id = 1, Name = ""Sales"" : Id = 2, Name = ""Engineer"".I want to associate a new Candidate which I'll be inserting into Candidates table with the 2 records from Jobs table.Before inserting the Candidate I know the Id's of the Jobs table & I don't wish to make a call to the database to get more details from Jobs table.How do I do this using Entity Framework 5? <code>  public class Candidate{ public int Id { get; set; } public string Name { get; set; } public ICollection<Job> Jobs { get; set; }}public class Job{ public int Id { get; set; } public string Name { get; set; } public ICollection<Candidate> Candidates { get; set; }}",Insert operation with many-to-many relationship using EF
Set Print Orientation to LandScape c#," i already can create a print to print a file in my windows forms. However, whenever i add this code: I can't see the Orientation of the page become LandScape, it is still Portrait.How do I make it LandScape as default? So, whenever i click PrintPreview or PrintFile, the Orientation of the page will become LandScape, not Portrait.Here is the code: <code>  printDialog.PrinterSettings.DefaultPageSettings.Landscape = true; private void PrintPreview(object sender, EventArgs e){ PrintPreviewDialog _PrintPreview = new PrintPreviewDialog(); _PrintPreview.Document = printDocument1; ((Form)_PrintPreview).WindowState = FormWindowState.Maximized; _PrintPreview.ShowDialog();}private void PrintFile(object sender, EventArgs e){ PrintDialog printDialog = new PrintDialog(); printDialog.Document = printDocument1; printDialog.UseEXDialog = true; if (DialogResult.OK == printDialog.ShowDialog()) { printDocument1.DocumentName = ""Test Page Print""; printDocument1.Print(); }}",Set print orientation to landscape
C#: use static class by interface?, imagine you have some methods you need to access from your whole application. A static class is ideal for this. But maybe in future I'll add a second implementation of the static methods in another static class. Is there a way to change static class used in my other code without changing the calls from MyStaticClass.MeMethod(); to MyStaticClass2.MyMethod();?I thought about an interface but i have no idea how to implement this... If I'm talking crazy say it and I'll simply change the calls :D <code>  public static class MyStaticClass{ public static void MyMethod() { // Do Something here... }} public static class MyStaticClass2{ public static void MyMethod() { // Do Something here... }},Use static class by interface?
Why does XmlDictionary.Add() returns XmlDictionaryString?, I am wondering why the XmlDictionary.Add() method returns XmlDictionaryString. In what scenario would this object be useful? <code> ,Why does XmlDictionary.Add() return an XmlDictionaryString?
Correctly using LINQ to shuffle a deck," I am attempting to write a simple card game. In an effort to come up with a good shuffling algorithm I came across Jeff Atwood's post on Coding Horror.However When I view the contents of the object after calling the Constructor they are not shuffled.Here is my attempt to use Jeff's Solution: here is the code for Card: What should I change to make the shuffling work? <code>  class MainDeck : List<Card>{ public MainDeck() { this.Add(new Card(1, ""Hearts"")); this.Add(new Card(2, ""Hearts"")); this.Add(new Card(3, ""Hearts"")); ... this.OrderBy(a => Guid.NewGuid()); }} class Card { string suit; int value; public Card(int value, string suit) { this.value = value; this.suit = suit; } bool isFaceCard() { if (value >= 11 || value == 1) return true; else return false; } public override string ToString() { return (value +"", "" + suit); } }",Using LINQ to shuffle a deck
drawing and finding points on a circle," i am currently try to inscribe diagonals of a decagon inside a circle like this in c# my approach would be creating a circle and draw lines inside using after that i would draw a decagon polygon.currently im stuck at how to divide the circle into 10 parts/ finding the correct coordiantes of the points on the circumference of the circles because im not good in math,i want to know how would i know the next point in a circumference of the circle the size of my circle is indicated above.and also i want also to ask a better approach for my problem.Thank you :) <code>  e.Graphics.DrawEllipse(myPen, 0, 0, 100, 100); e.Graphics.DrawLine(myPen, 20, 5, 50, 50);",Transcribing a polygon on a circle
Unable to cast List<int[*]> to List<int[]> instanciated from reflection," I am instantiating a List<T> of single dimensional Int32 arrays by reflection. When I instantiate the list using: I see this strange behavior on the list itself:If I interface with it through reflection it seems to behave normally, however if I try to cast it to its actual type: I get this exception: Unable to cast object of type 'System.Collections.Generic.List`1[System.Int32[*]]' to type 'System.Collections.Generic.List`1[System.Int32[]]'.Any ideas what may be causing this or how to resolve it? I am working in visual studio 2010 express on .net 4.0. <code>  Type typeInt = typeof(System.Int32);Type typeIntArray = typeInt.MakeArrayType(1);Type typeListGeneric = typeof(System.Collections.Generic.List<>);Type typeList = typeListGeneric.MakeGenericType(new Type[] { typeIntArray, });object instance = typeList.GetConstructor(Type.EmptyTypes).Invoke(null); List<int[]> list = (List<int[]>)instance;",Unable to cast List<int[*]> to List<int[]> instantiated with reflection
Find div tag from code behind," I have a div element: I want to control this element from the code-behind page and remove the class ""active""NOTE: Div doesn't contain the runat=""server"" property.This is not the master page file but this is another file named ""AssignImages.aspx"" and it contains ContentPlaceHolder.The div is inside this ContentPlaceHolder: <code>  <div class=""tab-pane active"" id=""portlet_tab1""> <asp:Content ContentPlaceHolderID=""ContentPlaceHolder1"" runat=""server"" ID=""Content1""> ",How to select a div element in the code-behind page?
How do I remove multiple offending characters from my string in C#?," Here's my working code: Here, I am simply removing the parentheses "")"" from my string, if it exists. Now how do I expand the list of offending characters like "")"" to include ""("" and ""-"" as well?I realize I can write 2 more Output-like statements, but I'm wondering if there is a better way... <code>  string Input;string Output;Input = data;Output = Input.Replace(@"")"", """");",How do I remove multiple offending characters from my string?
Implementing Equals," In an example, my professor has implemented Equals as follows: I have no experience with C#, but as far as I know this cannot be null inside a member function (at least this is true in C++ and Java, the languages I know) so the if seems weird to me.Am I right or is there any component in c# I dont know of which makes the test this == null necesary? <code>  public class Person { private string dni; // ... public override bool Equals(object o) { if (o == null) return (this == null); else { return ((o is Person) && (this.dni == (o as Person).dni)); } }}",Is it possible for 'this' keyword to equal null?
Difffrence between Serializable and MarshalByRefObject," I am very confused with [Serializable] and :MarshalByRefObject attribute in .NET Remoting .However i read many article on that. If i am using [Serializable] attribute then all methods are executed entirely in callers domain, it means that different callers should have copy of different methods on their own domain and any alteration done by one caller should not reflect on others.But when the same thing i am implementing in my program, i am not getting the desired result. <code> ",Difference between Serializable and MarshalByRefObject
c# extend a class to conform to an interface?, I have an interface: Can I now extend an existing class to conform to the interface? Say class String. I know I can define the foo() method on strings. But is it possible to go further and tell the compiler that strings can be cast to IFoo? <code>  interface IFoo { int foo(int bar);},extend a class to conform to an interface?
How many tasks are too much?," I'm currently working on an application that relies on many different web services to get data. Since I want to modularize each service and have a bit of dependency in there (service1 must run before service 2 and 3 etc), I'm running each service in its own task.The tasks themselves are either running actively, meaning they're sending their request to the web service and are waiting for a response or processing the responsewaiting (via monitor and timeout) - once a task finishes all waiting tasks wake up and check if their dependencies have finishedNow, the system is running with what I would call good performance (especially since the performance is rather negligible) - however, the application generates quite a number of tasks.So, to my question: are ~200 tasks in this scenario too many? Do they generate that much overhead so that a basically non-threaded approach would be better? <code> ",How many tasks are too many?
What's the best way to parsing this string?," I get the Content-Type of a page trought a WebClient.ResponseHeaders. If I print it with: I get somethings like: so I want to get it (if there is). Else set a default one. This is my actual code: I don't know why, but it looks not so flexible. What can you suggest about? <code>  client.ResponseHeaders[""Content-Type""] Content-Type: text/html; charset=UTF-8 var KeysParsed = HttpUtility.ParseQueryString(client.ResponseHeaders[""Content-Type""].Replace("" "", """").Replace("";"", ""&""));var charset = ((KeysParsed[""charset""] != null) ? KeysParsed[""charset""] : ""UTF-8"");",How to parse encoding from WebClient Response?
WPF how does virtualizingstackpanel calculate child size without instantiating the actual item?," I am following the tutorials presented here:http://blogs.msdn.com/b/dancre/archive/tags/virtualizingtilepanel/and in their implementation they have a dependency property on the virtualizingtilepanel that keeps track of the child size. However, the WPF library's virtualizingstackpanel doesn't require me to set a size for the child elements as a property. However, I don't understand how the virtualizing stack panel can calculate which items in the panel are visible without instancing the items. I would think that they would need a measure pass to know the item containers sizes, but how can they know that without first instantiating the items?My goal is to create a panel to contain treeviewitems and virtualize them, but following the example from virtualizingtilepanel only lets me virtualize the top level items.I need to change the way it calculates what items are visible, but I don't see how it can know what items are visible without knowing the size and actually instantiating the items.edit: wait, maybe it instantiates the objects that go inside the treeviewitem immediately and use those to calculate the size? <code> ",how does virtualizingstackpanel calculate child size without instantiating the actual item?
how to read multiple resultset from SqlDataReader," I have a SP from that I am trying to return 2 result set from, and in my .cs file i am trying something like this: However I am getting an : error:IndexOutOfRange {""EntityName""} <code>  dr = cmd.ExecuteReader();while (dr.Read()){ RegistrationDetails regDetails = new RegistrationDetails() { FName = dr[""FName""].ToString(), LName = dr[""LName""].ToString(), MName = dr[""MName""].ToString(), EntityName = dr[""EntityName""].ToString(),// in 2nd result set Percentage = dr[""Percentage""].ToString()// in 2nd result set };}",How to read multiple resultset from SqlDataReader?
set default format of datetimepicker as dd-MM-yyyy," I have a datetimepicker which on loading of windows form shows me format in 'MM-dd-yyyy',as follows:I would like it in dd-MM-yyyy.I tried the following:set custom format: ""dd-MM-yyyy""But Its not changing.What could be the problem?Please help me. <code> ",Set default format of datetimepicker as dd-MM-yyyy
Reference to type claims it is defined in but it could not be found," I have a solution with 3 projects:ParsersBase, that define an interface IParseRuleParsersLibrary, that have a reference to ParsersBase and define a class HtmlImageUrlParseRule : IParseRuleParsersLibraryTest, that have a reference to ParsersBase and ParsersLibrary and define a test class with some test methodsWhen I'm trying to build it, I get a warning: Reference to type 'AVSoft.ParsersBase.IParseRule' claims it is defined in 'c:\Users\Tim\Dropbox\projects\Image Downloader\ParsersLibrary\bin\Debug\ParsersLibrary.dll', but it could not be foundWhy VS is trying to find AVSoft.ParsersBase.IParseRule in ParsersLibrary.dll? ParsersLibraryTest has a reference to ParsersBase, it just doesn't make any sense. <code> ","Error: Reference to type claims it is defined, but it could not be found"
"Reference to type claims it is defined, but it could not be found"," I have a solution with 3 projects:ParsersBase, that define an interface IParseRuleParsersLibrary, that have a reference to ParsersBase and define a class HtmlImageUrlParseRule : IParseRuleParsersLibraryTest, that have a reference to ParsersBase and ParsersLibrary and define a test class with some test methodsWhen I'm trying to build it, I get a warning: Reference to type 'AVSoft.ParsersBase.IParseRule' claims it is defined in 'c:\Users\Tim\Dropbox\projects\Image Downloader\ParsersLibrary\bin\Debug\ParsersLibrary.dll', but it could not be foundWhy VS is trying to find AVSoft.ParsersBase.IParseRule in ParsersLibrary.dll? ParsersLibraryTest has a reference to ParsersBase, it just doesn't make any sense. <code> ","Error: Reference to type claims it is defined, but it could not be found"
SessionID to user name," Is there a method in C# to retrieve the user name from a given session id?(any session running on the system)The Win API function WTSQuerySessionInformation does this, but I'm searching for this functionality in C#. <code> ",How to get Windows user name from SessionID?
Windows SessionID to user name," Is there a method in C# to retrieve the user name from a given session id?(any session running on the system)The Win API function WTSQuerySessionInformation does this, but I'm searching for this functionality in C#. <code> ",How to get Windows user name from SessionID?
Get Windows user name from SessionID," Is there a method in C# to retrieve the user name from a given session id?(any session running on the system)The Win API function WTSQuerySessionInformation does this, but I'm searching for this functionality in C#. <code> ",How to get Windows user name from SessionID?
Why [Enum].Parse has an ignorecase parametter?," Since an Enumeration in VB.Net cannot contains duplicated values like this: Then why the [Enum].Parse method has a StringCase parameter? http://msdn.microsoft.com/en-us/library/system.enum.parse.aspx Parse(Type, String, Boolean)It really has any sense for me.Which with logic developers of .NET Framework Classes has written that ignorecase flag in that method?I think that the [Enum].Parse logic should be to check automatically for ignorecase value instead of passing a boolean parameter to the method because an enum cannot contains duplicates ...or it can contains? <code>  Enum Test A aEnd Enum [Enum].Parse(GetType(Enum), Value, Ignorecase)",Why [Enum].Parse has an ignoreCase parameter?
File.Copy() Performance if file may already exist," I have a project that runs as a scheduled task every 5 minutes. Among other things, the project runs through hundreds of images and copies them to a network drive in this manner: The ""false"" argument, of course, is telling it NOT to overwrite a file if it already exists.Is this faster/better practice than first checking if the file already exists and then only copying if the file does not exist? (see below) My gut tells me that the first is the better way. However, I'm relatively new to programming and would love to know which is better, faster, more widely accepted, etc..It may or may not be helpful to know that the remote drive/folder I am copying to contains 4TB of image data (millions of images). <code>  foreach (string file in Files){ string Control = Path.GetFileNameWithoutExtension(file); File.SetAttributes(file, FileAttributes.Normal); try { File.Copy(file, destinationFolder + ""\\"" + Control + @"".pdf"", false); } catch (Exception err) { Console.Writeline(err.ToString()); }} foreach (string file in Files){ if (File.Exists(destinationFolder + ""\\"" + ControlNumber + "".pdf"") == false) { File.SetAttributes(file, FileAttributes.Normal); File.Copy(file, destinationFolder + ""\\"" + ControlNumber + @"".pdf""); }}",File.Copy() performance if a file already exists
Converting an int to string by prepending empty string," Recently, I've seen the following statement quite a lot: (Basically the same as return String.Concat(o);)Why would anyone want to do that? Why not just call .ToString() on the object (after checking object is not null, of course)?Sure, the code is shorter and does away with the null check, but I find it confusing to read. Are there any other benefits to this? I've also seen the same statement with regard to integer values.I expect to see above code in loosely typed languages such as JavaScript or PHP but not in C#. <code>  object o;// assign oreturn """" + o;",Converting objects to string by prepending empty string in C#
"In C#, can a CryptoStream leave the base Stream open?"," I create a MemoryStream, pass it to CryptoStream for writing. I want the CryptoStream to encrypt, and leave the MemoryStream open for me to then read into something else. But as soon as CryptoStream is disposed, it disposes of MemoryStream too.Can CryptoStream leave the base MemoryStream open somehow? <code>  using (MemoryStream scratch = new MemoryStream()){ using (AesManaged aes = new AesManaged()) { // <snip> // Set some aes parameters, including Key, IV, etc. // </snip> ICryptoTransform encryptor = aes.CreateEncryptor(); using (CryptoStream myCryptoStream = new CryptoStream(scratch, encryptor, CryptoStreamMode.Write)) { myCryptoStream.Write(someByteArray, 0, someByteArray.Length); } } // Here, I'm still within the MemoryStream block, so I expect // MemoryStream to still be usable. scratch.Position = 0; // Throws ObjectDisposedException byte[] scratchBytes = new byte[scratch.Length]; scratch.Read(scratchBytes,0,scratchBytes.Length); return Convert.ToBase64String(scratchBytes);}",Can a CryptoStream leave the base Stream open?
Cannot Assign because it's in a method group C#?," Cannot Assign ""AppendText"" because it is a ""method group"". The error is on the line ""textBox2.AppendText = text"", inside the button1_Click method. <code>  public partial class Form1 : Form{ String text = """"; public Form1() { InitializeComponent(); } private void button1_Click(object sender, EventArgs e) { String inches = textBox1.Text; text = ConvertToFeet(inches) + ConvertToYards(inches); textBox2.AppendText = text; } private String ConvertToFeet(String inches) { int feet = Convert.ToInt32(inches) / 12; int leftoverInches = Convert.ToInt32(inches) % 12; return (feet + "" feet and "" + leftoverInches + "" inches."" + "" \n""); } private String ConvertToYards(String inches) { int yards = Convert.ToInt32(inches) / 36; int feet = (Convert.ToInt32(inches) - yards * 36) / 12; int leftoverInches = Convert.ToInt32(inches) % 12; return (yards + "" yards and "" + feet + "" feet, and "" + leftoverInches + "" inches.""); }}",Cannot Assign because it is a method group C#?
C# call async method without await," I have an async method: I call this method like this: Can i call the same method from an synchronous method, without using await keyword?Ex: I think this will cause a deadlock.EDITCalling the method like above makes the call never end. (The method doesn't reaches the end anymore) <code>  public async Task<bool> ValidateRequestAsync(string userName, string password){ using (HttpClient client = new HttpClient()) { HttpResponseMessage response = await client.GetAsync(url); string stringResponse = await response.Content.ReadAsStringAsync(); return bool.Parse(stringResponse); }} bool isValid = await ValidateRequestAsync(""user1"", ""pass1""); public bool ValidateRequest(string userName, string password){ return ValidateRequestAsync(userName, password).Result;}",call async method without await #2
How to make picturebox transparent in C#.net, I am making an application in C# .NET. I have 8 picture boxes in it. I used PNG images with transparent background but in my form it is not transparent when it comes above another image.I am using Visual Studio 2012. This is a screenshot of my form:  <code> ,How to make picturebox transparent?
How to make picturebox transparent, I am making an application in C# .NET. I have 8 picture boxes in it. I used PNG images with transparent background but in my form it is not transparent when it comes above another image.I am using Visual Studio 2012. This is a screenshot of my form:  <code> ,How to make picturebox transparent?
generate sequence numbers in asp.net mvc2," I want to create sequence numbers in asp.net mvc2.. Then number should start from { 0 to 1000}. I tried like following, In view: My result is But when getting value in view it is not working... How to generate sequential numbers? <code>  var seq = Enumerable.Range(1, 1000); ViewData[""OrderNo""] = seq; <%:Html.Hidden(""OrderNo"") %> <%:ViewData[""OrderNo""] %> System.Linq.Enumerable+<RangeIterator>d__b8",Generate a sequence of numbers
c# windows form application command line arguments," I have searched through Google and here found many examples but I can't seem to get my Windows Form application to run and take arguments form the command line. I really want to have the option of scheduling the application without having a console version. But every time I setup the cmd line arguments it errors out with a CLR20r3 error. Anytime I try to pass an arg it errors ex myapp.exe ""C:\Backup\"" => CLR20r3 <code>  static void Main(string[] args){ if(args != null && args.Length > 0) { /* * arg[1] = Backup Location *require * arg[2] = Log File - Enable if present *optional * arg[3] = Debug Messages - Enabled if present *optional * arg[4] = Backup Type - Type to perform *required */ } else { Application.EnableVisualStyles(); Application.SetCompatibleTextRenderingDefault(false); Application.SetUnhandledExceptionMode(UnhandledExceptionMode.Automatic); Application.Run(new Form1()); }}",Windows form application command line arguments
Entity framework Dynamic query with OR conditions," I am creating an application that searches the database and allows the user to dynamically add any criteria (around 50 possible), much like the following SO question: Creating dynamic queries with entity framework. I currently have working a search that checks each criteria, and if it is not blank it adds it to the query.C# This code produces something similar to the following in sql server (I simplified for easier understanding)SQL I am now trying to add a way to generate the following SQL with C# through entity framework but with an OR instead of an AND, while still keeping the ability to add criteria dynamically.SQL Usually the criteria wont be larger than two or three items for a query but combining them into one gigantic query is not an option. I have tried concat, union, and intersect and they just all duplicate the query and join them with UNION.Is there a simple and clean way to add ""OR"" conditions to a dynamically generated query using entity framework?Edit with my solution - 9/29/2015Since posting this, I have noticed this has received a little attention, so I decided to post my solution <code>  var query = Db.Names.AsQueryable(); if (!string.IsNullOrWhiteSpace(first)) query = query.Where(q => q.first.Contains(first)); if (!string.IsNullOrWhiteSpace(last)) query = query.Where(q => q.last.Contains(last)); //.. around 50 additional criteria return query.ToList(); SELECT [Id], [FirstName], [LastName], ...etcFROM [dbo].[Names]WHERE [FirstName] LIKE '%first%' AND [LastName] LIKE '%last%' SELECT [Id], [FirstName], [LastName], ...etc FROM [dbo].[Names]WHERE [FirstName] LIKE '%first%' OR [LastName] LIKE '%last%' <-- NOTICE THE ""OR"" // Make sure to add required nuget// PM> Install-Package LinqKitvar searchCriteria = new { FirstName = ""sha"", LastName = ""hill"", Address = string.Empty, Dob = (DateTime?)new DateTime(1970, 1, 1), MaritalStatus = ""S"", HireDate = (DateTime?)null, LoginId = string.Empty,};var predicate = PredicateBuilder.False<Person>();if (!string.IsNullOrWhiteSpace(searchCriteria.FirstName)){ predicate = predicate.Or(p => p.FirstName.Contains(searchCriteria.FirstName));}if (!string.IsNullOrWhiteSpace(searchCriteria.LastName)){ predicate = predicate.Or(p => p.LastName.Contains(searchCriteria.LastName));}// Quite a few more conditions...foreach(var person in this.Persons.Where(predicate.Compile())){ Console.WriteLine(""First: {0} Last: {1}"", person.FirstName, person.LastName);}",Dynamic query with OR conditions in Entity Framework
Need to understand the usage of SemaphoreSlim c#, Here is the code I have but I don't understand what SemaphoreSlim is doing. What do await ss.WaitAsync(); and ss.Release(); do?I guess that if I run 50 threads at a time then write code like SemaphoreSlim ss = new SemaphoreSlim(10); then it will be forced to run 10 active thread at time.When one of 10 threads completes then another thread will start. If I am not right then help me to understand with sample situation.Why is await needed along with ss.WaitAsync();? What does ss.WaitAsync(); do? <code>  async Task WorkerMainAsync(){ SemaphoreSlim ss = new SemaphoreSlim(10); List<Task> trackedTasks = new List<Task>(); while (DoMore()) { await ss.WaitAsync(); trackedTasks.Add(Task.Run(() => { DoPollingThenWorkAsync(); ss.Release(); })); } await Task.WhenAll(trackedTasks);}void DoPollingThenWorkAsync(){ var msg = Poll(); if (msg != null) { Thread.Sleep(2000); // process the long running CPU-bound job }},Need to understand the usage of SemaphoreSlim
Alchemy-Websockets - WebSocketClient throws an NullReferenceException," I have two C# programs that should communicate over WebSockets the server is working perfectly (also using Alchemy) and has been for a while now (with javascript clients). However connecting an Alchemy WebSocketClient results in an NullReferenceException being thrown on the client side.After some debugging I found that the exception is thrown on line 187 of WebSocketClient.cs because of the _context.Connection.Connected call. The _context.Connection is the same instance as the local _client and neither of those are null at that point in time. On the TcpClient.Connected page on msdn.microsoft.com there are no possible exceptions listed (indicating to me that it shouldn't throw any exceptions).Going further back I noticed that the _client class variable is changed on line 176 of WebSocketClient.cs from a normal looking instance to an instance filled with exceptions:BEFORE LINE 176AFTER LINE 176Right after this line the Dispose() method of the Context that was just added on line 187 gets called disconnecting the Connection (which is the same instance as the _client that I mentioned before on line 131 of Context.cs.My question is: Why is this happening and how can I stop it from happening and successfully connect to the desired WebSocketServer?If you need any more information please don't hesitate to ask me in the comments.EDIT 1The exception only occurs when the server is actually listening, if the server is inactive line 176 of WebSocketClient.cs is not reached (this is the correct behavior because OnRunClient() is called when the connection to the server is made).EDIT 2As requested the StackTrace: <code>  System.NullReferenceException was unhandled HResult=-2147467261 Message=Object reference not set to an instance of an object. Source=System StackTrace: at System.Net.Sockets.TcpClient.get_Connected() at Alchemy.WebSocketClient.SetupContext(Context context) in C:\...\Alchemy\WebSocketClient.cs:regel 187 at Alchemy.WebSocketClient.HandleClientThread() in C:\...\Alchemy\WebSocketClient.cs:regel 94 at System.Threading.ThreadHelper.ThreadStart_Context(Object state) at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state) at System.Threading.ThreadHelper.ThreadStart() InnerException:",Alchemy-Websockets - WebSocketClient throws a NullReferenceException
Unity: Automatically Registering All Implementations of a Generic Interface," My current registration code: My generic interface and its implementations: Here is a simplified version of how I would resolve: This doesn't work--listeners and listeners2 are both empty after resolving. This is not unexpected.In Windsor, I could do something like this: How would I register all instances of IDomainEventHandler in Unity? I'd prefer to keep the existing registration code intact (if possible). <code>  Assembly web = Assembly.Load(""MyAssembly"");types.AddRange(web.GetTypes());//etc.foreach (var theInterface in types.Where(t => t.IsInterface)){ var assignableType = types.Where(t => theInterface.IsAssignableFrom(t) && t != theInterface); foreach (var type in assignableType) { container.RegisterType(theInterface, type); }} public interface IDomainEventHandler<in T>{ void Handle(T message);}public class DomainEventHandler1 : IDomainEventHandler<PhilTest1>{ public void Handle(PhilTest1 message) { throw new System.NotImplementedException(); }}public class DomainEventHandler2 : IDomainEventHandler<PhilTest2>{ public void Handle(PhilTest2 message) { throw new System.NotImplementedException(); }}public class DomainEventHandler3 : IDomainEventHandler<PhilTest2>{ public void Handle(PhilTest2 message) { throw new System.NotImplementedException(); }}public class PhilTest1{}public class PhilTest2{} IEnumerable<IDomainEventHandler<PhilTest2>> listeners = Container.ResolveAll<IDomainEventHandler<PhilTest2>>();IEnumerable<IDomainEventHandler<PhilTest1>> listeners2 = Container.ResolveAll<IDomainEventHandler<PhilTest1>>(); container.Register(AllTypes.FromAssemblyNamed(""MyAssembly"").BasedOn(typeof(IDomainEventHandler<>)).WithService.Base());",Automatically Registering All Implementations of a Generic Interface
C# Console application running without program.cs file, I have created a simple console application in c#. Is there any option to run the application without the default program.cs file? <code> ,Console application running without program.cs file
How to use ConfigurationManager.AppSettings?," I need to get ""http://example.com"" from using App.config file.But at the moment I am using: I cannot get the value.Could you point out what I am doing wrong? <code>  string peopleXMLPath = ConfigurationManager.AppSettings[""server""]; <?xml version=""1.0"" encoding=""UTF-8""?><configuration> <configSections> <section name=""device"" type=""System.Configuration.SingleTagSectionHandler"" /> <section name=""server"" type=""System.Configuration.SingleTagSectionHandler"" /> </configSections> <device id=""1"" description=""petras room"" location="""" mall="""" /> <server url=""http://example.com"" /></configuration>",How to use ConfigurationManager.AppSettings with a custom section?
first time working with Nlog," I am using Nlog for the first time. My aim is to just write to a text file.In main.c I have My Nlog.config file is as follows: But I am not able to create a txt file in my current directory. <code>  class Program{ private static Logger logger = LogManager.GetCurrentClassLogger();static void Main(string[] args){ logger.Trace(""Sample trace message""); logger.Debug(""Sample debug message""); logger.Info(""Sample informational message""); logger.Warn(""Sample warning message""); logger.Error(""Sample error message""); logger.Fatal(""Sample fatal error message""); }} <?xml version=""1.0"" encoding=""utf-8"" ?><nlog xmlns=""http://www.nlog-project.org/schemas/NLog.xsd"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""> <targets> <target name=""logfile"" xsi:type=""File"" fileName=""file.txt"" /> </targets> <rules> <logger name=""*"" minlevel=""Info"" writeTo=""logfile"" /> </rules></nlog>",How to create a text file in my current directory with NLog?
Why is the C# compiler happy with Double IEnumerable<T> and foreach T?, I know this code does not work (and have no problems writing it in a way that will work). I was wondering how the compiler can build with out any errors. And you get run time errors if you where to run it? ( assuming data was not null ) <code>  using System;using System.Collections.Generic;public class Class1{ public void Main() { IEnumerable<IEnumerable<Foo>> data = null; foreach(Foo foo in data){ foo.Bar(); } }}public class Foo { public void Bar() { }},Why is the C# compiler happy with double IEnumerable<T> and foreach T?
Struct initialization in C# and 'new' operator," I have two similar structs in C#, each one holds an integer, but the latter has get/set accessors implemented.Why do I have to initialize the Y struct with new operator prior to assigning the a field? Is y still a value type when I init it with new? <code>  public struct X{ public int a;}public struct Y{ public int a { get; set; }}class Program{ static void Main(string[] args) { X x; x.a = 1; Y y; y.a = 2; // << compile error ""unused local variable"" here Y y2 = new Y(); y2.a = 3; }}",Struct initialization and new operator
GetFiles() - Search pattern," I am using the following line to return specific files... But there are other files in the directory with the extension .sbsar, and it is getting them, too. How can I differentiate between .sbs and .sbsar in the search pattern? <code>  FileInfo file in nodeDirInfo.GetFiles(""*.sbs"", option)",How can I make GetFiles() exclude files with extensions that start with the search extension?
Significance of a PATH explined," This is probably a rudimentary question but I am still kinda new to programming and I've wondered for awhile. I've done multiple projects in Python, C#, and Java, and when I try to use new libraries (especially for Python) people always say to make sure its in the right PATH and such. I just followed an online tutorial on how to install Java on a new computer and it rekindled my question of what a path really is. Is the Path just were the programming language looks for a library in the file system? I get kinda confused on what it's significance is. Again, I'm sorry for the wide question, its just something that I've never quite gotten on my own programming.EDIT: I just wanted to thank everyone so much for answering my question. I know it was a pretty dumb one now that I've finally figured out what it is, but it really helped me. I'm slowly working through as many C#, Java and Python tutorials as I can find online, and it's nice to know I have somewhere to ask questions :) <code> ",Significance of a PATH explained
diffrent between set and set all in c#," When I use setall in program : but if i use set for every element of bitarray Why different result in two program when use set result is -1 and when use setall in second program result is 255 ? <code>  BitArray bb = new BitArray(8) ;bb.SetAll( true);int[] dd = new int[1]; bb.CopyTo(dd, 0);for (int i = 0; i < dd.Length; i++) Console.WriteLine(dd[i]);// result is -1 BitArray bb = new BitArray(8) ;bb.Set( 0,true);bb.Set(1, true);bb.Set(2, true);bb.Set(3, true);bb.Set(4, true);bb.Set(5, true);bb.Set(6, true);bb.Set(7, true);int[] dd = new int[1]; bb.CopyTo(dd, 0); for ( int i = 0; i < dd.Length; i++) Console.WriteLine(dd[i]);// result is 255",Difference between set and set all in c#
c# delay between HttpClient requests," I am using HttpClient to send a GET request to a server inside of a while loop and the SearchAsync contains The thing is after every request there is a delay before the next request is started.you can see this in fiddler timeline and also in fiddler there is ""Tunnel To"" example.com:443 before every requestQuestion : Why is there a delay and how to remove it ? <code>  while (cycle < maxcycle){ var searchParameters = new ASearchParameters { Page = cycle++, id = getid }; var searchResponse = await Client.SearchAsync(searchParameters);} public async Task<AuctionResponse> SearchAsync(){ var uriString = ""Contains a https url with parameters"" var searchResponseMessage = await HttpClient.GetAsync(uriString); return await Deserialize<AuctionResponse>(searchResponseMessage); }",How do I remove the delay between HTTP Requests when using Asynchronous actions in ASP.NET?
delay between HttpClient requests," I am using HttpClient to send a GET request to a server inside of a while loop and the SearchAsync contains The thing is after every request there is a delay before the next request is started.you can see this in fiddler timeline and also in fiddler there is ""Tunnel To"" example.com:443 before every requestQuestion : Why is there a delay and how to remove it ? <code>  while (cycle < maxcycle){ var searchParameters = new ASearchParameters { Page = cycle++, id = getid }; var searchResponse = await Client.SearchAsync(searchParameters);} public async Task<AuctionResponse> SearchAsync(){ var uriString = ""Contains a https url with parameters"" var searchResponseMessage = await HttpClient.GetAsync(uriString); return await Deserialize<AuctionResponse>(searchResponseMessage); }",How do I remove the delay between HTTP Requests when using Asynchronous actions in ASP.NET?
asp.net web form upload same data twice in database," I am uploading data to databases but my form upload the same data twice in databases first I was uploading data without checking weather is inserted or not it was working fine it was uploading the data single time now I have put the checked that if data inserted than show the message data inserted successful but this is uploading data twice.Here is my code:  <code>  SqlConnection conn1 = new SqlConnection(""Data Source=ZAZIKHAN\\SQLEXPRESS;Initial Catalog=resume;Integrated Security=True"");conn1.Open();SqlCommand cmd3 = new SqlCommand(""insert into Profile(Id,Name,JobTitle,Phone,Email,Address,Website,Facebook,Twitter,GooglePlus,Skype,Picture,WhyMeText) values('""+ID.Text+""','"" + TextBox1.Text + ""','"" + TextBox2.Text + ""','"" + TextBox3.Text + ""','"" + TextBox4.Text + ""','"" + TextBox5.Text + ""','"" + TextBox6.Text + ""','"" + TextBox7.Text + ""','"" + TextBox8.Text + ""','"" + TextBox9.Text + ""','"" + TextBox10.Text + ""','"" + uploadFolderPath + ""','"" + TextArea1.InnerText + ""')"", conn1);cmd3.ExecuteNonQuery();if (cmd3.ExecuteNonQuery() == 1){ Response.Write(""<script LANGUAGE='JavaScript' >alert('information saved Successful')</script>""); TextBox1.Text = """"; TextBox2.Text = """"; TextBox3.Text = """"; TextBox4.Text = """"; TextBox5.Text = """"; TextBox6.Text = """"; TextBox7.Text = """"; TextBox8.Text = """"; TextBox9.Text = """"; TextBox10.Text = """"; TextArea1.InnerText = """";}else { Response.Write(""<script LANGUAGE='JavaScript' >alert('sorry try again')</script>""); }conn1.Close();",Web form upload same data twice in database
ASP.NET Identity: verify newly entered password of logged in user, User is logged in and wants to do something major and I want them to re-enter their password so I can make sure that they are the user that is logged in. How can I confirm that this password is for the account holder?Would be happy to know how to do it via ASP.NET Identity or how to set up a stored proc to go against the AspNetUsers table or how to do it via Entity Framework. <code> ,Verify newly entered password of logged in user
"Razor syntex error ""Only assignment, call, increment, decrement, await, and new object expressions can be used as a statement"""," I m declaring the following syntax in MVC Razor view: and getting error Only assignment, call, increment, decrement, await, and new object expressions can be used as a statementI am able to correct by adding a @ with speaker.Name; but why it is ? I m sorry, I'm new to Razor but while I'm in code block @ {} why I am required to use @ again. Even I m not mixing it with HTML ?Help please. <code>  @{ foreach (var speaker in Model) { speaker.Name; } }","Razor syntax error ""Only assignment, call, increment, decrement, await, and new object expressions can be used as a statement"""
how to pass parameters to batch file using c#," I have a console file, which takes 6 argumentsTo run this exe, I create one batch file,Now, I need to send this parameter to the batch file from my one Windows application. This is the code: But its not working. I tried to change my Batch file like,@echo off %1 %2 %3 %4 %5 %6 %7@echo offbut that didn't work either. Error Image: <code>  string consolepath = @""E:\SqlBackup_Programs\console-backup\Backup_Console_App""; string Pc = ""VARUN-PC""; string database = ""Smart_Tracker""; string UserName = ""sa""; string Password = ""admin@12""; string bacPath = @""D:\TEST""; System.Diagnostics.Process proc = new System.Diagnostics.Process(); proc.StartInfo.FileName = System.Configuration.ConfigurationManager.AppSettings[""BATCH_FULLBACKUP""].ToString().Trim(); proc.StartInfo.Arguments = String.Format(consolepath,Pc,database,UserName,Password,""F"",bacPath); //set the rest of the process settings proc.Start();",How to pass parameters to a batch file using c#
how to include Javascipt in master page," I am building an ASP.NET Webform application with C# in VS 2012, .NET framework 4.5I have a MasterPage in root of application, JavaScript files are in folder named js.Here is the problem: If page are in root folder then everything is working fine (css+js), if I put any pages in subfolder then css is worked but those JavaScripts are not working at all, obviously the reference path is wrong.So the Css reference path is fine, but for the script no matter what I used they all are not worked (js/script.js or ~/js/script.js or /js/script.js or ../ ResolveUrl, ResolClientveUrl ... or all of method in this http://yobriefca.se/blog/2010/10/19/%3C-head-%3Eache-including-javascript-in-asp-dot-net-master-pages/ ) they all refer to root/SUB-FOLDER/js/script.js instead of root/js/script.jsin root: a single MasterPage, Default.aspx, test.aspx, js folder, css folder and Pages folder. Default and test pages are working file, but all pages in Pages folder is not display .js SO OBLIVIOUSLY the path is wrong whenever pages is not in root In my master page: the script.js is somthing like: ERROR in developer tool (Console) of web browser: <code>  <head runat=""server""><title></title><link rel=""stylesheet"" href=""~/css/style.css"" /><%-- tried these and lot more but NOT workkkkkkkkkkk --%><%--<script src=""~/js/jquery-1.7.1.min.js"" ></script><script src=""~/js/script.js"" ></script>--%><%--<script src='<%=ResolveUrl(""~/js/jquery-1.7.1.min.js"") %>' ></script><script src='<%=ResolveUrl(""~/js/script.js"") %>' type=""text/javascript""></script>--%><%--<script src='<%=ResolveClientUrl(""~/js/jquery-1.7.1.min.js"") %>' type=""text/javascript""></script><script src='<%=ResolveClientUrl(""~/js/script.js"") %>' type=""text/javascript""></script>--%><asp:ContentPlaceHolder ID=""Head"" runat=""server""></asp:ContentPlaceHolder> .... $.include('js/superfish.js')$.include('js/FF-cash.js')$.include('js/tms-0.4.x.js')$.include('js/uCarausel.js')$.include('js/jquery.easing.1.3.js')$.include('js/jquery.tools.min.js')$.include('js/jquery.jqtransform.js')$.include('js/jquery.quicksand.js')$.include('js/jquery.snippet.min.js')$.include('js/jquery-ui-1.8.17.custom.min.js')$.include('js/jquery.cycle.all.min.js')$.include('js/jquery.cookie.js')$(function(){ if($('.tweet').length)$.include('js/jquery.tweet.js'); if($('.lightbox-image').length)$.include('js/jquery.prettyPhoto.js'); if($('#contact-form').length||$('#contact-form2').length)$.include('js/forms.js'); if($('.kwicks').length)$.include('js/kwicks-1.5.1.pack.js'); if($('#counter').length)$.include('js/jquery.countdown.js'); if($('.fixedtip').length||$('.clicktip').length||$('.normaltip').length)$.include('js/jquery.atooltip.pack.js')// Slider $('.main-slider')._TMS({..... Failed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/tms-0.4.x.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/uCarausel.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/jquery.jqtransform.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/jquery.quicksand.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/jquery.snippet.min.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/FF-cash.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/superfish.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/jquery.tools.min.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/jquery-ui-1.8.17.custom.min.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/jquery.cycle.all.min.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/jquery.easing.1.3.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/jquery.cookie.jsUncaught TypeError: Object [object Object] has no method '_TMS' script.js:22event.returnValue is deprecated. Please use the standard event.preventDefault() instead.",How do you include JavaScript in MasterPage?
how to include Javascript in master page," I am building an ASP.NET Webform application with C# in VS 2012, .NET framework 4.5I have a MasterPage in root of application, JavaScript files are in folder named js.Here is the problem: If page are in root folder then everything is working fine (css+js), if I put any pages in subfolder then css is worked but those JavaScripts are not working at all, obviously the reference path is wrong.So the Css reference path is fine, but for the script no matter what I used they all are not worked (js/script.js or ~/js/script.js or /js/script.js or ../ ResolveUrl, ResolClientveUrl ... or all of method in this http://yobriefca.se/blog/2010/10/19/%3C-head-%3Eache-including-javascript-in-asp-dot-net-master-pages/ ) they all refer to root/SUB-FOLDER/js/script.js instead of root/js/script.jsin root: a single MasterPage, Default.aspx, test.aspx, js folder, css folder and Pages folder. Default and test pages are working file, but all pages in Pages folder is not display .js SO OBLIVIOUSLY the path is wrong whenever pages is not in root In my master page: the script.js is somthing like: ERROR in developer tool (Console) of web browser: <code>  <head runat=""server""><title></title><link rel=""stylesheet"" href=""~/css/style.css"" /><%-- tried these and lot more but NOT workkkkkkkkkkk --%><%--<script src=""~/js/jquery-1.7.1.min.js"" ></script><script src=""~/js/script.js"" ></script>--%><%--<script src='<%=ResolveUrl(""~/js/jquery-1.7.1.min.js"") %>' ></script><script src='<%=ResolveUrl(""~/js/script.js"") %>' type=""text/javascript""></script>--%><%--<script src='<%=ResolveClientUrl(""~/js/jquery-1.7.1.min.js"") %>' type=""text/javascript""></script><script src='<%=ResolveClientUrl(""~/js/script.js"") %>' type=""text/javascript""></script>--%><asp:ContentPlaceHolder ID=""Head"" runat=""server""></asp:ContentPlaceHolder> .... $.include('js/superfish.js')$.include('js/FF-cash.js')$.include('js/tms-0.4.x.js')$.include('js/uCarausel.js')$.include('js/jquery.easing.1.3.js')$.include('js/jquery.tools.min.js')$.include('js/jquery.jqtransform.js')$.include('js/jquery.quicksand.js')$.include('js/jquery.snippet.min.js')$.include('js/jquery-ui-1.8.17.custom.min.js')$.include('js/jquery.cycle.all.min.js')$.include('js/jquery.cookie.js')$(function(){ if($('.tweet').length)$.include('js/jquery.tweet.js'); if($('.lightbox-image').length)$.include('js/jquery.prettyPhoto.js'); if($('#contact-form').length||$('#contact-form2').length)$.include('js/forms.js'); if($('.kwicks').length)$.include('js/kwicks-1.5.1.pack.js'); if($('#counter').length)$.include('js/jquery.countdown.js'); if($('.fixedtip').length||$('.clicktip').length||$('.normaltip').length)$.include('js/jquery.atooltip.pack.js')// Slider $('.main-slider')._TMS({..... Failed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/tms-0.4.x.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/uCarausel.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/jquery.jqtransform.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/jquery.quicksand.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/jquery.snippet.min.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/FF-cash.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/superfish.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/jquery.tools.min.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/jquery-ui-1.8.17.custom.min.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/jquery.cycle.all.min.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/jquery.easing.1.3.jsFailed to load resource: the server responded with a status of 404 (Not Found) http://ApplicationRoot/Pages/js/jquery.cookie.jsUncaught TypeError: Object [object Object] has no method '_TMS' script.js:22event.returnValue is deprecated. Please use the standard event.preventDefault() instead.",How do you include JavaScript in MasterPage?
idisposable objects as ref param to method," I was doing a refactoring of class and thought of moving 100 lines in a separate method. Like this: At calling method of Compiler throws exception : Readonly local variable cannot be used as an assignment target for doc and mem.Edit: here only i adding content in pdf document in another method. so i need to pass same doc object, right ? so why can't i use ref or out param.Technically using defies the purpose of ref param here. Tried to look on MSDN: How the objects become read only at calling of Method? Within the scope object is alive and you can do whatever you want.  <code>  using iTextSharp.text;using iTextSharp.text.pdf; class Program{ private static void Main(string[] args) { Document doc = new Document(iTextSharp.text.PageSize.LETTER, 10, 10, 42, 35); using (var mem = new MemoryStream()) { using (PdfWriter wri = PdfWriter.GetInstance(doc, mem)) { doc.Open(); AddContent(ref doc, ref wri); doc.Close(); File.WriteAllBytes(@""C:\testpdf.pdf"", mem.ToArray()); } } } public static void AddContent(ref Document doc, ref PdfWriter writer) { var header = new Paragraph(""My Document"") { Alignment = Element.ALIGN_CENTER }; var paragraph = new Paragraph(""Testing the iText pdf.""); var phrase = new Phrase(""This is a phrase but testing some formatting also. \nNew line here.""); var chunk = new Chunk(""This is a chunk.""); doc.Add(header); doc.Add(paragraph); doc.Add(phrase); doc.Add(chunk); }} A ReadOnly property has been found in a context that assigns a value to it. Only writable variables, properties, and array elements can have values assignedto them during execution.",IDisposable objects as ref param to method
Always success on ajax post with HttpResponseMessage," I always get statusCode=200 on ajax post at client side, while servers answers with HttpStatusCode.Unauthorized. My controller code: My ajax code: Result: alert with text Success: 200 : OKand output window with: So, I can get text error message, but i need to get HttpStatusCode to handle error statements. Help me, please.More information about this issue and elegant solution from Brock Allen:http://brockallen.com/2013/10/27/using-cookie-authentication-middleware-with-web-api-and-401-response-codes/ <code>  public class AccountApiController : ApiController{ public HttpResponseMessage Login(HttpRequestMessage request, [FromBody]LoginViewModel loginModel) { return request.CreateErrorResponse(HttpStatusCode.Unauthorized, ""Unauthorized login.""); }} $.ajax({ url: '/api/accountapi/login', type: 'POST', data: data }) .done(function (object, status, xhr) { alert(""Success: "" + xhr.status + "" : "" + xhr.statusText); }) .always(function (object) { $(""#output"").text(JSON.stringify(object, null, 4)); }); { ""Message"": ""Unauthorized login.""}",Always success on ajax post with HttpResponseMessage 401
Tasks and STA - what am I doing wrong?," I am trying to use tasks in a little .net 4.0 application (written using Visual Studio 2010 if that matters) that needs to work on Windows 2003 and use a WriteableBitmap with the palette parameter.The code using said class must, therefore, be running as an STA thread to avoid it throwing an invalid cast exception (see here for why I need an STA thread if you are interested, but it is not the thrust of my question).I, therefore, checked on Stack overflow and came across How to create a task (TPL) running a STA thread? and The current SynchronizationContext may not be used as a TaskScheduler - perfect, so now I know what to do, except...Here's a little console application: And here is its output: What the!?! Yup, it is back to an MTA thread on the Action<Task> passed into the ContinueWith method.I am passing the same scheduler into the task and the continue but somehow in the continue it seems to be being ignored.I'm sure it is something stupid, so how would I make sure that my callback passed into the ContinueWith uses an STA thread? <code>  using System;using System.Threading;using System.Threading.Tasks;namespace TaskPlayingConsoleApplication{ class Program { [STAThread] static void Main() { Console.WriteLine(""Before Anything: "" + Thread.CurrentThread.GetApartmentState()); SynchronizationContext.SetSynchronizationContext( new SynchronizationContext()); var cts = new CancellationTokenSource(); var scheduler = TaskScheduler.FromCurrentSynchronizationContext(); var task = Task.Factory.StartNew( () => Console.WriteLine( ""In task: "" + Thread.CurrentThread.GetApartmentState()), cts.Token, TaskCreationOptions.None, scheduler); task.ContinueWith(t => Console.WriteLine( ""In continue: "" + Thread.CurrentThread.GetApartmentState()), scheduler); task.Wait(); } }} Before Anything: STA In task: STA In continue: MTA",Tasks - how to ensure the ContinueWith action is an STA thread?
WCF service hosting in IIS 7.5," Whenever I publish WCF service to IIS. It is almost I have become habituated to get this error: HTTP Error 404.3 - Not Found The page you are requesting cannot be served because of the extension configuration. If the page is a script, add a handler. If the file should be downloaded, add a MIME map.The practice I have maintained: is to change application pool for the website to classic mode.But this time I am out of luck. Q.1. Can you please help?Q.2. As the error suggests: Should I configure .svc MIME map somewhere in IIS?Q.3. For WCF to operate in integrated pipeline mode, Is there any specificconfiguration required? <code> ",WCF service hosting in IIS 7.5 - The page you are requesting cannot be served because of the extension configuration
Reading in a filter type from a query string," I'm plan to make a page that displays info about user's in the form of a table. Each column will be a property of the table. I want someone viewing the table to be able to choose ways to filter the users. There will be two check boxes: 1 for reported users and 1 for creation date. I'm planning to make an enum called UserFilter like so: If I need to add another type it's value will be set to 4 so that I can tell which enums are selected through a bitwise or (3 would be both 1 and 2). The problem I'm having is with reading in an enum from the query string. I guess I could do something like posting back with an int (0 for none, 1 for date, 2 for report, 3 for both) but I would like to try posting back with the actual string. I'm not sure how I would parse ""Date|Reported"" into an enum value that doesn't exist in UserFilter.In a nutshell: Is there a clean way to parse ""Date|Reported"" into the value 3 without adding another value to my enum? <code>  public enum UserFilter{ None = 0, Date = 1, Reported = 2}",Parsing multiple enum values (Flagged): Reading in a filter type from a query string
C# SQL How can I get SQL result into a STRING variable?," I'm trying to get the SQL result in a C# string variable or string array. Is it possible? Do I need to use SqlDataReader in some way? I'm very new to C# functions and all, used to work in PHP, so please give a working example if you can (If relevant I can already connect and access the database, insert and select.. I just don't know how to store the result in a string variable). <code> ",How can I get SQL result into a STRING variable?
c# LINQ join two DataTables," Hi I have a problem joining two DataTables using LINQ. Tables have columns like this: I used linq to join like this: Problem is, result only shows IDs which are in the table2. I need to show also the missing items. This is the wanted result: I believe I should do left outer join, but I do not have enough knowledge about linq. Help appreciated. Thank you! <code>  table1 table2ID, name ID, stock1, item1 1, 1002, item2 3, 503, item3 DataTable dtResult = new DataTable();dtResult.Columns.Add(""ID"", typeof(string));dtResult.Columns.Add(""name"", typeof(string));dtResult.Columns.Add(""stock"", typeof(int));var result = from dataRows1 in table1.AsEnumerable() join dataRows2 in table2.AsEnumerable() on dataRows1.Field<string>(""ID"") equals dataRows2.Field<string>(""ID"") select dtResult.LoadDataRow(new object[] { dataRows1.Field<string>(""ID""), dataRows1.Field<string>(""name""), dataRows2.Field<int>(""stock""), }, false);result.CopyToDataTable(); dtResultID, name, stock1, item1, 1003, item3, 50 dtResultID, name, stock1, item1, 1002, item2, 0 //Prefer if it is ""0"", otherwise can be left ""null""3, item3, 50",LINQ join two DataTables
c# parse byte array to json with Json.Net," I'm trying to parse byte[] array to Dictionary<String,Object> using Json.Net but with no success Actually I'm in doubt about its possibility. So is it possible? with this library or with anyother library?here is what I have tried but DeserializeObject excepts only string as parameter afaik <code>  public static Dictionary<String, Object> parse(byte[] json){ Dictionary<String, Object> values = JsonConvert.DeserializeObject<Dictionary<String, Object>>(json); return values;}",Parse byte array to json with Json.Net
"Finding duplicates intgeres in an array and display how many times they occured,c# console"," I'm working on a code that prints out duplicated integers from an array with the number of their occurrence. I'm not allowed to use LINQ, just a simple code. I think I'm so close but confused about how to get a correct output:  <code>  class Program{ static void Main(string[] args) { int[] array = { 10, 5, 10, 2, 2, 3, 4, 5, 5, 6, 7, 8, 9, 11, 12, 12 }; int count = 1; for (int i = 0; i < array.Length; i++) { for (int j = i; j < array.Length - 1 ; j++) { if(array[j] == array[j+1]) count = count + 1; } Console.WriteLine(""\t\n "" + array[i] + ""occurse"" + count); Console.ReadKey(); } }}",How do I find duplicates in an array and display how many times they occurred?
Finding duplicate integers in an array and display how many times they occurred," I'm working on a code that prints out duplicated integers from an array with the number of their occurrence. I'm not allowed to use LINQ, just a simple code. I think I'm so close but confused about how to get a correct output:  <code>  class Program{ static void Main(string[] args) { int[] array = { 10, 5, 10, 2, 2, 3, 4, 5, 5, 6, 7, 8, 9, 11, 12, 12 }; int count = 1; for (int i = 0; i < array.Length; i++) { for (int j = i; j < array.Length - 1 ; j++) { if(array[j] == array[j+1]) count = count + 1; } Console.WriteLine(""\t\n "" + array[i] + ""occurse"" + count); Console.ReadKey(); } }}",How do I find duplicates in an array and display how many times they occurred?
"C# - Getting the type of another nested class from the same ""parent"" class"," I'm attempting to make a namespace for the first time while learning programming. I am hoping there is a way around the problem I've run into that isn't particularly messy, but essentially I have a class object that keeps two dictionaries of two nested class objects. I need to be able to pass the Dictionary of NestedClassA to NestedClassB or to allow NestedClassB to access it in some way... Here is an example of what I'm trying to do: My problem seems to be that I can't typecast ""NestedClassA"" within ""NestedClassB"" because it doesn't recognize the type. Is it possible to access the ""NestedClassA"" type within B? Nothing I've tried has worked. Do I have to pass the instance of ""BossClass"" so I can reference type by ""Dictionary<int, MyFirstNamespace.BossClassInstance.NestedClassA>""?Any help would be appreciated. To be clear, I want a REFERENCE variable passed to NestedClassB of a Dictionary of all NestedClassA members so they can be manipulated by NestedClassB. It can't be a clone. I know this seems like ridiculous implementation, but it seems the most effective, if it's possible, for what I'm trying to do.EDIT: maybe I shouldn't be nesting them at all, but it would make them much easier to serialize, which is why I really wanted to do it this way.(EDIT - fixed typo where I forgot to insert ""public"" before constructors.) <code>  namespace MyFirstNamespace { public class BossClass { public Dictionary<int, NestedClassA> DictionaryA = new Dictionary<int, NestedClassA>(); public Dictionary<int, NestedClassB> DictionaryB = new Dictionary<int, NestedClassB>(); public class NestedClassA { ...arbitrary class definition... } public class NestedClassB { public Dictionary<int, NestedClassA> PassedDictionary; public NestedClassB() { } public NestedClassB(Dictionary<int, NestedClassA> tempDic)) { PassedDictionary = tempDic; } } public BossClass() { ... arbitrary constructor ... } ...arbitrary dictionary population methods... function void CreateAClassBInstance() { DictionaryB[n] = new NestedClassB(n, DictionaryA); } }}","Getting the type of another nested class from the same ""parent"" class"
How to create a SaaS application for existing software in asp.net c# mvc," I'm looking to offer a software product using the SaaS model. This of course will require that I build a web site where customers can sign up, log in, manage their membership and billing options. Now suppose i have a software like calculator (just an example) which is basically an asp.net WPF application. Now i want to offer this software (application) as a service for my customers. So now upto this point i have :A website having above mentioned functionality (developed in Asp.Net MVC-5).A software which i want to offer as an SaaS (develop in asp.net WPF, desktop application)Now i want to know how i will integrate these two things to create a good multi-tenant SaaS service? How to publish this? Which platform should i use to publish this Window Azure, Amazon etc.?OrWhat i am thinking is not possible, i have to develop a software (which i want to offer as SaaS) by using web technologies ? Is this the case?I am learning multi-tenancy, so please let me know if i am totally on a wrong path and guide me on correct path. Thanks! <code> ",How to create a SaaS application for existing software in asp.net c# mvc
How to create a SaaS application for existing software in asp.net c# mvc?," I'm looking to offer a software product using the SaaS model. This of course will require that I build a web site where customers can sign up, log in, manage their membership and billing options. Now suppose i have a software like calculator (just an example) which is basically an asp.net WPF application. Now i want to offer this software (application) as a service for my customers. So now upto this point i have :A website having above mentioned functionality (developed in Asp.Net MVC-5).A software which i want to offer as an SaaS (develop in asp.net WPF, desktop application)Now i want to know how i will integrate these two things to create a good multi-tenant SaaS service? How to publish this? Which platform should i use to publish this Window Azure, Amazon etc.?OrWhat i am thinking is not possible, i have to develop a software (which i want to offer as SaaS) by using web technologies ? Is this the case?I am learning multi-tenancy, so please let me know if i am totally on a wrong path and guide me on correct path. Thanks! <code> ",How to create a SaaS application for existing software in asp.net c# mvc
how to set row number in grid view c#, I need to set number of row in data grid view (like identity in sql) in winforms. i am dynamically adding columns and rows in grid view. any idea. <code> ,how to set row number in grid view
C# ReadKey while key is not pressed do something (Console)," I am trying to run my code until Esc was pressed. Therefore I am using ReadKey in my Console but at ""ConsoleKey"" it says that, ConsoleKey isn't possible in 'bool'. How can I fix that? Or what shall I use instead? <code>  var input = Console.ReadKey();do{} while (input.Key != ConsoleKey.Escape);",ReadKey while key is not pressed do something
Lambda/LINQ Select Minimum - C#," I'm writing a function using the .NET GeoCoordinate class. We have an Airport class and a City class, both of which define their own GeoCoordinate.I need to select the nearest airport relative to the city, and I am trying to do so using the GetDistanceTo() method.What I have right now looks something like this: Another (working) function that retrieves a list of nearest airports by distance uses: I've seen examples of doing things like this in a single line with LINQ & lambdas, but I'm not entirely sure how to execute this one...any pointers? <code>  Airport a = Airports.GetAllActiveAirports().Min(this.Coordinates.GetDistanceTo(n.Profile.Coordinates)); List<Airports> airports = Airports.GetAllActiveAirports();var nearby = from a in airports where this.Coordinates.GetDistanceTo(a.Profile.Coordinates) > d select a;foreach(Airport a in nearby){ airports.Remove(a); }",Lambda/LINQ Select Minimum
Using Neural Network to solve Y = mX + B type formula," Update 1/6/2014: I've updated the question so that I'm trying to solve a non-linear equation. As many of you pointed out I didn't need the extra complexity (hidden-layer, sigmoid function, etc) in order to solve a non-linear problem.Also, I realize I could probably solve even non-linear problems like this using other means besides neural networks. I'm not trying to write the most efficient code or the least amount of code. This is purely for me to better learn neural networks.I've created my own implementation of back propagated neural network.It is working fine when trained to solve simple XOR operations.However now I want to adapt it & train it to solve Y = X * X + B type formulas, but I'm not getting expected results. After training the network does not calculate the correct answers. Are neural networks well-suited for solving algebra equations like this? I realize my example is trivial I'm just trying to learn more about neural networks and their capabilities.My hidden layer is using a sigmoid activation function and my output layer is using an identity function.If you could analyze my code and point out any errors I'd be grateful.Here is my full code (C# .NET): <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;namespace NeuralNetwork{ class Program { static void Main(string[] args) { Console.WriteLine(""Training Network...""); Random r = new Random(); var network = new NeuralNetwork(1, 5, 1); for (int i = 0; i < 100000; i++) { int x = i % 15; int y = x * x + 10; network.Train(x); network.BackPropagate(y); } //Below should output 20, but instead outputs garbage Console.WriteLine(""0 * 0 + 10 = "" + network.Compute(0)[0]); //Below should output 110, but instead outputs garbage Console.WriteLine(""10 * 10 + 10 = "" + network.Compute(10)[0]); //Below should output 410, but instead outputs garbage Console.WriteLine(""20 * 20 + 10 = "" + network.Compute(20)[0]); } } public class NeuralNetwork { public double LearnRate { get; set; } public double Momentum { get; set; } public List<Neuron> InputLayer { get; set; } public List<Neuron> HiddenLayer { get; set; } public List<Neuron> OutputLayer { get; set; } static Random random = new Random(); public NeuralNetwork(int inputSize, int hiddenSize, int outputSize) { LearnRate = .9; Momentum = .04; InputLayer = new List<Neuron>(); HiddenLayer = new List<Neuron>(); OutputLayer = new List<Neuron>(); for (int i = 0; i < inputSize; i++) InputLayer.Add(new Neuron()); for (int i = 0; i < hiddenSize; i++) HiddenLayer.Add(new Neuron(InputLayer)); for (int i = 0; i < outputSize; i++) OutputLayer.Add(new Neuron(HiddenLayer)); } public void Train(params double[] inputs) { int i = 0; InputLayer.ForEach(a => a.Value = inputs[i++]); HiddenLayer.ForEach(a => a.CalculateValue()); OutputLayer.ForEach(a => a.CalculateValue()); } public double[] Compute(params double[] inputs) { Train(inputs); return OutputLayer.Select(a => a.Value).ToArray(); } public double CalculateError(params double[] targets) { int i = 0; return OutputLayer.Sum(a => Math.Abs(a.CalculateError(targets[i++]))); } public void BackPropagate(params double[] targets) { int i = 0; OutputLayer.ForEach(a => a.CalculateGradient(targets[i++])); HiddenLayer.ForEach(a => a.CalculateGradient()); HiddenLayer.ForEach(a => a.UpdateWeights(LearnRate, Momentum)); OutputLayer.ForEach(a => a.UpdateWeights(LearnRate, Momentum)); } public static double NextRandom() { return 2 * random.NextDouble() - 1; } public static double SigmoidFunction(double x) { if (x < -45.0) return 0.0; else if (x > 45.0) return 1.0; return 1.0 / (1.0 + Math.Exp(-x)); } public static double SigmoidDerivative(double f) { return f * (1 - f); } public static double HyperTanFunction(double x) { if (x < -10.0) return -1.0; else if (x > 10.0) return 1.0; else return Math.Tanh(x); } public static double HyperTanDerivative(double f) { return (1 - f) * (1 + f); } public static double IdentityFunction(double x) { return x; } public static double IdentityDerivative() { return 1; } } public class Neuron { public bool IsInput { get { return InputSynapses.Count == 0; } } public bool IsHidden { get { return InputSynapses.Count != 0 && OutputSynapses.Count != 0; } } public bool IsOutput { get { return OutputSynapses.Count == 0; } } public List<Synapse> InputSynapses { get; set; } public List<Synapse> OutputSynapses { get; set; } public double Bias { get; set; } public double BiasDelta { get; set; } public double Gradient { get; set; } public double Value { get; set; } public Neuron() { InputSynapses = new List<Synapse>(); OutputSynapses = new List<Synapse>(); Bias = NeuralNetwork.NextRandom(); } public Neuron(List<Neuron> inputNeurons) : this() { foreach (var inputNeuron in inputNeurons) { var synapse = new Synapse(inputNeuron, this); inputNeuron.OutputSynapses.Add(synapse); InputSynapses.Add(synapse); } } public virtual double CalculateValue() { var d = InputSynapses.Sum(a => a.Weight * a.InputNeuron.Value) + Bias; return Value = IsHidden ? NeuralNetwork.SigmoidFunction(d) : NeuralNetwork.IdentityFunction(d); } public virtual double CalculateDerivative() { var d = Value; return IsHidden ? NeuralNetwork.SigmoidDerivative(d) : NeuralNetwork.IdentityDerivative(); } public double CalculateError(double target) { return target - Value; } public double CalculateGradient(double target) { return Gradient = CalculateError(target) * CalculateDerivative(); } public double CalculateGradient() { return Gradient = OutputSynapses.Sum(a => a.OutputNeuron.Gradient * a.Weight) * CalculateDerivative(); } public void UpdateWeights(double learnRate, double momentum) { var prevDelta = BiasDelta; BiasDelta = learnRate * Gradient; // * 1 Bias += BiasDelta + momentum * prevDelta; foreach (var s in InputSynapses) { prevDelta = s.WeightDelta; s.WeightDelta = learnRate * Gradient * s.InputNeuron.Value; s.Weight += s.WeightDelta + momentum * prevDelta; } } } public class Synapse { public Neuron InputNeuron { get; set; } public Neuron OutputNeuron { get; set; } public double Weight { get; set; } public double WeightDelta { get; set; } public Synapse(Neuron inputNeuron, Neuron outputNeuron) { InputNeuron = inputNeuron; OutputNeuron = outputNeuron; Weight = NeuralNetwork.NextRandom(); } }}",Using Neural Network to solve Y = X * X + b type formula
Get folder path by its handle in win32," I have a pointer to an opened Explorer Window and i want to know its full path.For Example: But now, how to obtain the directory full path like ""C:\Users\mm\Documents\Directory"" <code>  int hWnd = FindWindow(null, ""Directory"");",Get folder path from Explorer window
Does ICollection.CopyTo() enumerate the collection," Through the travels in StackOverflow there are many usages of the ToList() extension method for an ICollection (or classes that derive from ICollection<T>).I have pulled out the good ol' decompiler to have a look at how the ToList() extension method is executed and does it enumerate the collection at anytime. Going through the source I came across: Now this is pretty straight forward, so the ToList() extension method just creates a new List<T> with the source object. Digging deeper into the List constructor shows this line. As you would, you would dig into the CopyTo method. This is where I got stuck. After all the digging through method calls we get to the final extern method call My question is (although I cant seem to find it) does the ToList() extension method (ICollection<T>.CopyTo()) iterate through all objects of the Collection (Array) when executed?Subquestion: Where can I find the source for the extern void Copy() above?Edit: I have edited the question directly as I realized after that I am trying to get a specification on an Interface and not implementation. Sorry <code>  [__DynamicallyInvokable]public static List<TSource> ToList<TSource>(this IEnumerable<TSource> source){ if (source == null) { throw Error.ArgumentNull(""source""); } return new List<TSource>(source);} ICollection<T> ts = collection as ICollection<T>;//.. ommited codets.CopyTo(this._items, 0); [ReliabilityContract(Consistency.MayCorruptInstance, Cer.MayFail)][SecurityCritical]internal static extern void Copy(Array sourceArray, int sourceIndex, Array destinationArray, int destinationIndex, int length, bool reliable);",Does List<T>.ToList() enumerate the collection
Leverage browser caching in IIS," There are several questions about leveraging browser caching but I didn't find anything useful for how to do this in an ASP.NET application. Google's Pagespeed tells this is performance biggest problem.So far I did this in my web.config: Commented code works. I can set expire header to be some particular time in future but I was not able to set cacheControlMaxAge to set how many days from now static content would be cached. It does not work. My questions is:How can I do that?I know it is possible to set caching only for specific folder which would be good solution, but it isn't working also. Application is hosted on Windows Server 2012,on IIS8, application pool is set to classic.After I set this code in web config I got pagespeed of 72 (before was 71). 50 files were not cached. (Now 49) I was wondering why and I just realized that one file was actually cached (svg file). Unfortunately png and jpg file were not.This is my web.config EDIT:If I set exact expiry date, caching is working, but not for jpg,gif....only for pngEDIT2:If I set cacheControlCustom=""public"" like here: caching is working but still not for jpegs and gifs; it only works for svgs and pngs. <code>  <system.webServer> <staticContent> <!--<clientCache cacheControlMode=""UseExpires"" httpExpires=""Fri, 24 Jan 2014 03:14:07 GMT"" /> --> <clientCache cacheControlMode=""UseMaxAge"" cacheControlMaxAge=""7.24:00:00"" /> </staticContent></system.webServer> <?xml version=""1.0"" encoding=""utf-8""?><configuration> <configSections> <section name=""exceptionManagement"" type=""Microsoft.ApplicationBlocks.ExceptionManagement.ExceptionManagerSectionHandler,Microsoft.ApplicationBlocks.ExceptionManagement"" /> <section name=""jsonSerialization"" type=""System.Web.Configuration.ScriptingJsonSerializationSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E34"" requirePermission=""false"" allowDefinition=""Everywhere"" /> <sectionGroup name=""elmah""> <section name=""security"" requirePermission=""false"" type=""Elmah.SecuritySectionHandler, Elmah"" /> <section name=""errorLog"" requirePermission=""false"" type=""Elmah.ErrorLogSectionHandler, Elmah"" /> <section name=""errorMail"" requirePermission=""false"" type=""Elmah.ErrorMailSectionHandler, Elmah"" /> <section name=""errorFilter"" requirePermission=""false"" type=""Elmah.ErrorFilterSectionHandler, Elmah"" /> </sectionGroup> </configSections> <exceptionManagement mode=""off""> <publisher mode=""off"" assembly=""Exception"" type=""blabla.ExceptionHandler.ExceptionDBPublisher"" connString=""server=188......;database=blabla;uid=blabla;pwd=blabla; "" /> </exceptionManagement> <location path=""."" inheritInChildApplications=""false""> <system.web> <httpHandlers> <add verb=""GET,HEAD"" path=""ScriptResource.axd"" type=""System.Web.Handlers.ScriptResourceHandler,System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e34"" validate=""false"" /> <add verb=""GET"" path=""Image.ashx"" type=""blabla.WebComponents.ImageHandler, blabla/>"" <add verb=""*"" path=""*.aspx"" type=""System.Web.UI.PageHandlerFactory"" /> <add verb=""*"" path=""*.jpg"" type=""System.Web.StaticFileHandler"" /> <add verb=""GET"" path=""*.js"" type=""System.Web.StaticFileHandler"" /> <add verb=""*"" path=""*.gif"" type=""System.Web.StaticFileHandler"" /> <add verb=""GET"" path=""*.css"" type=""System.Web.StaticFileHandler"" /> </httpHandlers> <compilation defaultLanguage=""c#"" targetFramework=""4.5.1"" /> <trace enabled=""false"" requestLimit=""100"" pageOutput=""true"" traceMode=""SortByTime"" localOnly=""true""/> <authentication mode=""Forms""> <forms loginUrl=""~/user/login.aspx""> <credentials passwordFormat=""Clear""> <user name=""blabla"" password=""blabla"" /> </credentials> </forms> </authentication> <authorization> <allow users=""*"" /> </authorization> <sessionState mode=""InProc"" stateConnectionString=""tcpip=127.0.0.1:42424"" sqlConnectionString=""data source=127.0.0.1;Trusted_Connection=yes"" cookieless=""false"" timeout=""20"" /> <globalization requestEncoding=""utf-8"" responseEncoding=""utf-8"" culture=""en-GB"" uiCulture=""en-GB"" /> <xhtmlConformance mode=""Transitional"" /> <pages controlRenderingCompatibilityVersion=""4.5"" clientIDMode=""AutoID""> <namespaces> </namespaces> <controls> <add assembly=""Microsoft.AspNet.Web.Optimization.WebForms"" namespace=""Microsoft.AspNet.Web.Optimization.WebForms"" tagPrefix=""webopt"" /> </controls> </pages> <webServices> <protocols> <add name=""HttpGet"" /> <add name=""HttpPost"" /> </protocols> </webServices> </system.web> </location> <appSettings> </appSettings> <connectionStrings> </connectionStrings> <system.web.extensions> <scripting> <webServices> <jsonSerialization maxJsonLength=""200000"" /> </webServices> </scripting> </system.web.extensions> <startup> <supportedRuntime version=""v2.0.50727"" /> <supportedRuntime version=""v1.1.4122"" /> <supportedRuntime version=""v1.0.3705"" /> </startup> <system.webServer> <rewrite> <providers> <provider name=""ReplacingProvider"" type=""ReplacingProvider, ReplacingProvider, Version=1.0.0.0, Culture=neutral, PublicKeyToken=5ab632b1f332b247""> <settings> <add key=""OldChar"" value=""_"" /> <add key=""NewChar"" value=""-"" /> </settings> </provider> <provider name=""FileMap"" type=""DbProvider, Microsoft.Web.Iis.Rewrite.Providers, Version=7.1.761.0, Culture=neutral, PublicKeyToken=0525b0627da60a5e""> <settings> <add key=""ConnectionString"" value=""server=;database=blabla;uid=blabla;pwd=blabla;App=blabla""/> <add key=""StoredProcedure"" value=""Search.GetRewriteUrl""/> <add key=""CacheMinutesInterval"" value=""0""/> </settings> </provider> </providers> <rewriteMaps configSource=""rewritemaps.config"" /> <rules configSource=""rewriterules.config"" /> </rewrite> <modules> <remove name=""ScriptModule"" /> <add name=""ScriptModule"" preCondition=""managedHandler"" type=""System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3456AD264E35"" /> <add name=""ErrorLog"" type=""Elmah.ErrorLogModule, Elmah"" preCondition=""managedHandler"" /> <add name=""ErrorMail"" type=""Elmah.ErrorMailModule, Elmah"" preCondition=""managedHandler"" /> <add name=""ErrorFilter"" type=""Elmah.ErrorFilterModule, Elmah"" preCondition=""managedHandler"" /> </modules> <handlers> <add name=""Web-JPG"" path=""*.jpg"" verb=""GET,HEAD,POST"" modules=""IsapiModule"" scriptProcessor=""C:\Windows\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll"" resourceType=""Unspecified"" preCondition=""classicMode,runtimeVersionv4.0,bitness64"" /> <add name=""Web-CSS"" path=""*.css"" verb=""GET,HEAD,POST"" modules=""IsapiModule"" scriptProcessor=""C:\Windows\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll"" resourceType=""Unspecified"" preCondition=""classicMode,runtimeVersionv4.0,bitness64"" /> <add name=""Web-GIF"" path=""*.gif"" verb=""GET,HEAD,POST"" modules=""IsapiModule"" scriptProcessor=""C:\Windows\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll"" resourceType=""Unspecified"" preCondition=""classicMode,runtimeVersionv4.0,bitness64"" /> <add name=""Web-JS"" path=""*.js"" verb=""GET,HEAD,POST,DEBUG"" modules=""IsapiModule"" scriptProcessor=""C:\Windows\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll"" resourceType=""Unspecified"" preCondition=""classicMode,runtimeVersionv4.0,bitness64"" /> </handlers> <validation validateIntegratedModeConfiguration=""false"" /> <httpErrors errorMode=""DetailedLocalOnly"" existingResponse=""Auto""> <remove statusCode=""404"" subStatusCode=""-1""/> <remove statusCode=""500"" subStatusCode=""-1""/> <error statusCode=""404"" path=""error404.htm"" responseMode=""File""/> <error statusCode=""500"" path=""error.htm"" responseMode=""File""/> </httpErrors> </system.webServer> <system.serviceModel> <bindings> <basicHttpBinding> <binding name=""soapBinding_AdriagateService"" closeTimeout=""00:01:00"" openTimeout=""00:01:00"" receiveTimeout=""00:10:00"" sendTimeout=""00:01:00"" allowCookies=""false"" bypassProxyOnLocal=""false"" hostNameComparisonMode=""StrongWildcard"" maxBufferPoolSize=""2147483647"" maxBufferSize=""2147483647"" maxReceivedMessageSize=""2147483647"" textEncoding=""utf-8"" transferMode=""Buffered"" useDefaultWebProxy=""true"" messageEncoding=""Text""> <readerQuotas maxDepth=""2147483647"" maxStringContentLength=""2147483647"" maxArrayLength=""2147483647"" maxBytesPerRead=""2147483647"" maxNameTableCharCount=""2147483647"" /> <security mode=""None"" /> </binding> </basicHttpBinding> <netTcpBinding> <binding name=""NetTcpBinding_ITravellerService"" closeTimeout=""00:10:00"" openTimeout=""00:10:00"" sendTimeout=""00:10:00"" maxReceivedMessageSize=""2147483647"" maxBufferPoolSize=""2147483647""> <readerQuotas maxDepth=""2147483647"" maxStringContentLength=""2147483647"" maxArrayLength=""2147483647"" maxBytesPerRead=""2147483647"" maxNameTableCharCount=""2147483647"" /> <security mode=""None"" /> </binding> </netTcpBinding> </bindings> <client> <endpoint address=""blabla"" bindingConfiguration=""soapBinding_blabla"" contract="""" Address=""blabla"" name=""blabla"" /> <endpoint address=""blabla"" binding=""basicHttpBinding"" bindingConfiguration=""soapBinding_IImagesService"" contract=""ImagesService.IImagesService"" name=""soapBinding_IImagesService""/> <identity> <servicePrincipalName value=""blabla""/> </identity> </endpoint> </client> </system.serviceModel> <runtime> <assemblyBinding xmlns=""urn:schemas-microsoft-com:asm.v1""> <dependentAssembly> <assemblyIdentity name=""WebGrease"" publicKeyToken=""31bf3856ad364e35"" culture=""neutral"" /> <bindingRedirect oldVersion=""0.0.0.0-1.5.2.14234"" newVersion=""1.5.2.14234"" /> </dependentAssembly> <dependentAssembly> <assemblyIdentity name=""Newtonsoft.Json"" publicKeyToken=""30ad4fe6b2a6aeed"" culture=""neutral"" /> <bindingRedirect oldVersion=""0.0.0.0-4.5.0.0"" newVersion=""4.5.0.0"" /> </dependentAssembly> </assemblyBinding> </runtime> <system.web> <httpModules> <add name=""ErrorLog"" type=""Elmah.ErrorLogModule, Elmah"" /> <add name=""ErrorMail"" type=""Elmah.ErrorMailModule, Elmah"" /> <add name=""ErrorFilter"" type=""Elmah.ErrorFilterModule, Elmah"" /> </httpModules> </system.web> <elmah> <security allowRemoteAccess=""false"" /> </elmah> <location path=""elmah.axd"" inheritInChildApplications=""false""> <system.web> <httpHandlers> <add verb=""POST,GET,HEAD"" path=""elmah.axd"" type=""Elmah.ErrorLogPageFactory, Elmah"" /> </httpHandlers> </system.web> <system.webServer> <handlers> <add name=""ELMAH"" verb=""POST,GET,HEAD"" path=""elmah.axd"" type=""Elmah.ErrorLogPageFactory, Elmah"" preCondition=""integratedMode"" /> </handlers> </system.webServer> </location></configuration> <clientCache cacheControlCustom=""public"" cacheControlMode=""UseMaxAge"" cacheControlMaxAge=""7.00:00:00"" /> ",Leverage browser caching in IIS (google pagespeed issue)
"Surface Controller in Umbraco, the route is working, but resulting in not found"," My Question Is ThisWhat configuration step have I missed to make Mvc Surface Controllers work in Umbraco? My theory is that since there is a folder in the default Umbraco install called /umbraco/ which is used to connect to the CMS that the physical path is interfiering with the route /umbraco/surface/{Controller}/{Action} thus resulting in the ASP.NET YSOD (and an IIS 404 when I try to access a controller on that route that isn't defined.)Background InformationI have added this class to my App_Code folder in a freshly downloaded copy of Umbraco 6.1.6: When I navigate to what I think should be the route for my Index() method, I get a YSOD that says the resource could not be found:the code is not executed and the above error is displayed; however, if I change the Uri to garbage I get an IIS 404 error:I started getting this in an existing site, thinking my site was screwed up I tried it in a new copy of Umbraco 6.1.6 and got the exact same results. For the record, I have also tried MembersSurfaceController and its associated Uri, which has the exact same result as above. YSOD when I hit the valid route, and IIS 404 when I don't.I have changed my umbracoSettings.config to MVC in the /config/ directory as well.updateI'm using the out-of-the-box web.config file, which has this: On my default Umbraco site I don't have any rewrite rules defined; but on my actual site I have several rewrite rules in place. I'm thinking that's not causing it since I'm seeing the same behavior on both sites though...I have tried removing UrlRewrite completely I get the same results. <code>  public class MembersController : SurfaceController{ public ActionResult Index() { return Content(""Hello, Member!""); }} <system.webServer> <validation validateIntegratedModeConfiguration=""false"" /> <modules runAllManagedModulesForAllRequests=""true""> <remove name=""UrlRewriteModule"" /> <add name=""UrlRewriteModule"" type=""UrlRewritingNet.Web.UrlRewriteModule, UrlRewritingNet.UrlRewriter"" /> . .. ...",Why am I getting the Yellow Screen Of Death on an Umbraco SurfaceController on a default/OOTB Umbraco installation?
"Surface Controller in Umbraco, visiting the route results in YSOD (other uris that match the route but don't have controller result in IIS 404)"," My Question Is ThisWhat configuration step have I missed to make Mvc Surface Controllers work in Umbraco? My theory is that since there is a folder in the default Umbraco install called /umbraco/ which is used to connect to the CMS that the physical path is interfiering with the route /umbraco/surface/{Controller}/{Action} thus resulting in the ASP.NET YSOD (and an IIS 404 when I try to access a controller on that route that isn't defined.)Background InformationI have added this class to my App_Code folder in a freshly downloaded copy of Umbraco 6.1.6: When I navigate to what I think should be the route for my Index() method, I get a YSOD that says the resource could not be found:the code is not executed and the above error is displayed; however, if I change the Uri to garbage I get an IIS 404 error:I started getting this in an existing site, thinking my site was screwed up I tried it in a new copy of Umbraco 6.1.6 and got the exact same results. For the record, I have also tried MembersSurfaceController and its associated Uri, which has the exact same result as above. YSOD when I hit the valid route, and IIS 404 when I don't.I have changed my umbracoSettings.config to MVC in the /config/ directory as well.updateI'm using the out-of-the-box web.config file, which has this: On my default Umbraco site I don't have any rewrite rules defined; but on my actual site I have several rewrite rules in place. I'm thinking that's not causing it since I'm seeing the same behavior on both sites though...I have tried removing UrlRewrite completely I get the same results. <code>  public class MembersController : SurfaceController{ public ActionResult Index() { return Content(""Hello, Member!""); }} <system.webServer> <validation validateIntegratedModeConfiguration=""false"" /> <modules runAllManagedModulesForAllRequests=""true""> <remove name=""UrlRewriteModule"" /> <add name=""UrlRewriteModule"" type=""UrlRewritingNet.Web.UrlRewriteModule, UrlRewritingNet.UrlRewriter"" /> . .. ...",Why am I getting the Yellow Screen Of Death on an Umbraco SurfaceController on a default/OOTB Umbraco installation?
Uri for an Umbraco Surface Controller results in the YSOD and other uris that match the route but don't have controller result in IIS 404," My Question Is ThisWhat configuration step have I missed to make Mvc Surface Controllers work in Umbraco? My theory is that since there is a folder in the default Umbraco install called /umbraco/ which is used to connect to the CMS that the physical path is interfiering with the route /umbraco/surface/{Controller}/{Action} thus resulting in the ASP.NET YSOD (and an IIS 404 when I try to access a controller on that route that isn't defined.)Background InformationI have added this class to my App_Code folder in a freshly downloaded copy of Umbraco 6.1.6: When I navigate to what I think should be the route for my Index() method, I get a YSOD that says the resource could not be found:the code is not executed and the above error is displayed; however, if I change the Uri to garbage I get an IIS 404 error:I started getting this in an existing site, thinking my site was screwed up I tried it in a new copy of Umbraco 6.1.6 and got the exact same results. For the record, I have also tried MembersSurfaceController and its associated Uri, which has the exact same result as above. YSOD when I hit the valid route, and IIS 404 when I don't.I have changed my umbracoSettings.config to MVC in the /config/ directory as well.updateI'm using the out-of-the-box web.config file, which has this: On my default Umbraco site I don't have any rewrite rules defined; but on my actual site I have several rewrite rules in place. I'm thinking that's not causing it since I'm seeing the same behavior on both sites though...I have tried removing UrlRewrite completely I get the same results. <code>  public class MembersController : SurfaceController{ public ActionResult Index() { return Content(""Hello, Member!""); }} <system.webServer> <validation validateIntegratedModeConfiguration=""false"" /> <modules runAllManagedModulesForAllRequests=""true""> <remove name=""UrlRewriteModule"" /> <add name=""UrlRewriteModule"" type=""UrlRewritingNet.Web.UrlRewriteModule, UrlRewritingNet.UrlRewriter"" /> . .. ...",Why am I getting the Yellow Screen Of Death on an Umbraco SurfaceController on a default/OOTB Umbraco installation?
ASP.Net Identity - HttpContext has no extension method for GetOwinContext," I have downloaded, and successfully ran the ASP.NET Identity sample from here:https://github.com/rustd/AspnetIdentitySampleI am now in the middle of implementing the ASP.NET Identity framework in my project and have ran into a problem, that has driven me mad all day... GetOwinContext() does not exist as an extension method on my HttpContextI am implementing the identity framework in class library. I have installed all the latest (pre-release version) of the Identity framework and everything - apart from this - is working fine.I have tried implementing the same code as the same direct in my controller, and find the same problem.I'm clearly missing a reference somewhere, though I have no idea what..!..The code-block that is killing me is: I have added references to the following - tried these both in my class library and also direct on the controller, none of them work for me... ... this is driving me up the wall....any idea?UPDATEI have checked the versions of Identity & OWIN in the sample, and I have made sure I have the same versions in my solution.More so, if I search the object browser on the sample for GetOwinContext I can find the method, however when I search for it in my solution it is nowhere to be found... I must have some library out of date, but I can't find it! <code>  private IAuthenticationManager AuthenticationManager{ get { return HttpContext.GetOwinContext().Authentication; }} using Microsoft.AspNet.Identity;using Microsoft.AspNet.Identity.EntityFramework;using Microsoft.Owin.Security;using Microsoft.Owin;using System.Web;",ASP.NET Identity - HttpContext has no extension method for GetOwinContext
Get IP address using c#, I am trying to get the IP address of client machine using C#. I am using the below code to get the IP address : But it is giving me the response in encoded format i.e fe80::ed13:dee2:127e:1264%13How can I get the actual IP address? Any one faced this issue please share some idea. <code>  string IPAddress = HttpContext.Current.Request.UserHostAddress;,Get IP address of client machine
How to rename Exe file and config from release folder in WinForms app?," I have a solution with ""Name1"". When I do a build, I get ""Name1.exe"" and ""Name1.exe.config"" in the bin folder.Now I want to make some changes in this application and get ""Name2.exe"" and ""Name2.exe.config"".I renamed the project and solution, but when I do a build I still have ""Name1.exe"".How can I get another name for my EXE file? <code> ",How do I rename an EXE file and configuration from the release folder in a Windows Forms application?
How to set up .net teradata connenction in c#?," I am trying to connect to Teradata with c#. I am using the sample code from this website (I have also tried DSN , UID , PWD However, I am getting exception that either my userid , account or password not correct ...But I am able to login using SQL Assistant easily. So , I rule out incorrect userid or password Here I found a possible solution for my problemBut I do not know what exactly I need to change in my sample code.So, I have no idea how to implement that solution.Can anybody give me a working sample code? <code>  using System;using System.Collections.Generic;using System.Text;using Teradata.Client.Provider;namespace Teradata.Client.Provider.HelloWorld{ class HelloWorld { static void Main(string[] args) { using (TdConnection cn = new TdConnection(""Data Source = x;User ID = y;Password = z;"")) { cn.Open(); TdCommand cmd = cn.CreateCommand(); cmd.CommandText = ""SELECT DATE""; using (TdDataReader reader = cmd.ExecuteReader()) { reader.Read(); DateTime date = reader.GetDate(0); Console.WriteLine(""Teradata Database DATE is {0}"", date); } } } }}",How to set up .net teradata connection in c#?
"""A namespace cannot directly contain members such as fields or methods"" in Net.Reflector"," I am trying to use this code for NET.reflector using Reflexil. I am trying to replace code with this: }But it gives me an error when I try to compile: This is Unity code I think. I am not that experienced. Could anyone fix this for me? Or tell me what to do? Thanks! <code>  if(Input.GetKeyDown(KeyCode.Keypad5)) { int i = 0; Character localPlayer = PlayerClient.GetLocalPlayer().controllable.GetComponent<Character>(); foreach (UnityEngine.Object obj2 in UnityEngine.Object.FindObjectsOfType(typeof(LootableObject))) { if (obj2 != null) { i++; LootableObject loot = (LootableObject) obj2; Debug.Log(""Loot ""+i+"": ""+loot.transform.position.ToString()); CCMotor ccmotor = localPlayer.ccmotor; if(ccmotor != null && tpPos1 != Vector3.zero) { ccmotor.Teleport(loot.transform.position); Notice.Popup("""", ""Teleported to ""+loot.name, 1.5f); } break; } } Line: 1 Column: 1 Error Number: CS0116 Error Message: ""A namespace does not directly contain members such as fields or methods""","""A namespace cannot directly contain members such as fields or methods"""
"Exception handling inside ""async void"" command handlers"," I'm reviewing some WPF code of my colleagues, which is a library of UserControl-based components with a lot of async void event and command handlers. These methods currently do not implement any error handling internally.The code in a nutshell: Exceptions thrown but not observed inside NewCommand_Executed can only be handled on a global level (e.g., with AppDomain.CurrentDomain.UnhandledException). Apparently, this is not a good idea.I could handle exceptions locally: However, in this case the host app's ViewModel would be unaware of errors inside NewCommand_Executed. Not an ideal solution either, plus the error reporting UI shouldn't always be a part of the library code.Another approach is to handle them locally and fire a dedicated error event: I like the last one the most, but I'd appreciate any other suggestions as my experience with WPF is somewhat limited.Is there an established WPF pattern to propagate errors from async void command handlers to ViewModal?Is it generally a bad idea to do async work inside WPF command handlers, as perhaps they're intended for quick synchronous UI updates?I'm asking this question in the context of WPF, but I think it may as well apply to async void event handlers in WinForms. <code>  <Window.CommandBindings> <CommandBinding Command=""ApplicationCommands.New"" Executed=""NewCommand_Executed""/></Window.CommandBindings> private async void NewCommand_Executed(object sender, ExecutedRoutedEventArgs e){ // do some fake async work (and may throw if timeout < -1) var timeout = new Random(Environment.TickCount).Next(-100, 100); await Task.Delay(timeout);} private async void NewCommand_Executed(object sender, ExecutedRoutedEventArgs e){ try { // do some fake async work (throws if timeout < -1) var timeout = new Random(Environment.TickCount).Next(-100, 100); await Task.Delay(timeout); } catch (Exception ex) { // somehow log and report the error MessageBox.Show(ex.Message); }} public class AsyncErrorEventArgs: EventArgs{ public object Sender { get; internal set; } public ExecutedRoutedEventArgs Args { get; internal set; } public ExceptionDispatchInfo ExceptionInfo { get; internal set; }}public delegate void AsyncErrorEventHandler(object sender, AsyncErrorEventArgs e);public event AsyncErrorEventHandler AsyncErrorEvent;private async void NewCommand_Executed(object sender, ExecutedRoutedEventArgs e){ ExceptionDispatchInfo exceptionInfo = null; try { // do some fake async work (throws if timeout < -1) var timeout = new Random(Environment.TickCount).Next(-100, 100); await Task.Delay(timeout); } catch (Exception ex) { // capture the error exceptionInfo = ExceptionDispatchInfo.Capture(ex); } if (exceptionInfo != null && this.AsyncErrorEvent != null) this.AsyncErrorEvent(sender, new AsyncErrorEventArgs { Sender = this, Args = e, ExceptionInfo = exceptionInfo });}","Exception handling inside ""async void"" WPF command handlers"
C#: Why public event cannot be invoked outside directly?," Consider we have a class with event declared: Despite of ""publicness"" of the event, we cannot call FooBarEvent.Invoke from outside.This is overcame by modyfing a class with the following approach: Why accessing public events outside is limited by adding and removing listeners only? <code>  public class FooBar{ public event EventHandler FooBarEvent;} public class FooBar{ public event EventHandler FooBarEvent; public void RaiseFooBarEvent(object sender, EventArgs eventArguments) { FooBarEvent.Invoke(sender, eventArguments); }}",Why public event cannot be invoked outside directly?
Deference between == and Equals in C#," Consider this code: Both int and short are primitive types, but a comparison with == returns true and a comparison with Equals returns false.Why? <code>  int age = 25;short newAge = 25;Console.WriteLine(age == newAge);//trueConsole.WriteLine(newAge.Equals(age));//falseConsole.ReadLine();",What is the difference between == and Equals() for primitives in C#?
Difference between == and Equals() in C#," Consider this code: Both int and short are primitive types, but a comparison with == returns true and a comparison with Equals returns false.Why? <code>  int age = 25;short newAge = 25;Console.WriteLine(age == newAge);//trueConsole.WriteLine(newAge.Equals(age));//falseConsole.ReadLine();",What is the difference between == and Equals() for primitives in C#?
Equals() with primitive types in C#," Consider this code: Both int and short are primitive types, but a comparison with == returns true and a comparison with Equals returns false.Why? <code>  int age = 25;short newAge = 25;Console.WriteLine(age == newAge);//trueConsole.WriteLine(newAge.Equals(age));//falseConsole.ReadLine();",What is the difference between == and Equals() for primitives in C#?
"Difference between == and Equals() in C#, for primitives"," Consider this code: Both int and short are primitive types, but a comparison with == returns true and a comparison with Equals returns false.Why? <code>  int age = 25;short newAge = 25;Console.WriteLine(age == newAge);//trueConsole.WriteLine(newAge.Equals(age));//falseConsole.ReadLine();",What is the difference between == and Equals() for primitives in C#?
How can I do a deep compare of two objects with LINQ?, I have three classes: I have two lists: The following LINQ gives me a new list of ObjectiveDetail objects where: the Number or the Text fields for any ObjectiveDetail object in the list differ between oldObj and newObj. How can I modify this so the LINQ gives me a new list of ObjectiveDetail objects where: the Number or the Text fields or the SubTopic collections for any ObjectiveDetail object in the list differ between oldObj and newObj. In other words I want an ObjectiveDetail to be added to the upd list if:It has Text in oldObj that's different from Text in newObjIt has a Number in oldObj that's different from the Number in newObjIt has a SubTopics collection with three elements in oldObj and 4 elements in newObjIt has a SubTopics collection with no elements in oldObj and 2 elements in newObjIt has a SubTopics collection with 2 elements in oldObj and no elements in newObjIt has a SubTopics collection with elements with SubTopicId of 1 and 2 in oldObj and 1 and 3 in newObjI hope someone can come up with just some additional line in the LINQ statement that I already have. <code>  public partial class Objective{ public Objective() { this.ObjectiveDetails = new List<ObjectiveDetail>(); } public int ObjectiveId { get; set; } public int Number { get; set; } public virtual ICollection<ObjectiveDetail> ObjectiveDetails { get; set; }}public partial class ObjectiveDetail { public ObjectiveDetail() { this.SubTopics = new List<SubTopic>(); } public int ObjectiveDetailId { get; set; } public int Number { get; set; } public string Text { get; set; } public virtual ICollection<SubTopic> SubTopics { get; set; }}public partial class SubTopic { public int SubTopicId { get; set; } public string Name { get; set; }} IList<ObjectiveDetail> oldObj;IList<ObjectiveDetail> newObj; IList<ObjectiveDetail> upd = newObj .Where(wb => oldObj .Any(db => (db.ObjectiveDetailId == wb.ObjectiveDetailId) && (db.Number != wb.Number || !db.Text.Equals(wb.Text)))) .ToList();,Using LINQ. With two different lists. How can I identify objects that do not match
How Do I Make JSON.NET Ignore Object Relationships," I'm working on an Entity Framework project. I want to serialize a bunch of entity class instances. I've bound these together into a container class: Etcetera... it is an instance of this class that I'm attempting to serialize. I want JSON.NET to serialize the members of each entity class instance that are actually columns in the underlying database. I do not want it to even attempt to serialize object references.In particular, my entity classes have virtual members that allow me to write C# code that navigates all my inter-entity relationships without worrying about actual key values, joins, etc., and I want JSON.NET to ignore the associated parts of my entity classes.On the surface, there seems to be a JSON.NET configuration option that does exactly what I'm talking about: Unfortunately, JSON.NET seems to be ignoring the second statement above.I actually found a web page (http://json.codeplex.com/workitem/24608) where someone else brought the same issue to the attention of James Newton-King himself, and his response (in its entirety) was ""Write a custom contract resolver.""As inadequate as I find that response to be, I have been attempting to follow its guidance. I would very much like to be able to write a ""contract resolver"" that ignored everything except primitive types, strings, DateTime objects, and my own Pseudocontext class along with the Lists it contains directly. If someone has an example of something that at least resembles that, it might be all I need. This is what I came up with on my own: When I attempt to use the above (by setting serializer.ContractResolver to an instance of WhatDecadeIsItAgain prior to serialization), I get OutOfMemory errors during serialization that indicate that JSON.NET is encountering reference loops that never terminate (in spite of my efforts to make JSON.NET just ignore object references).I feel like my ""custom contract resolver"" may be wrong. As shown above, it's built around the premise that I should return the default ""contract"" for the types I do want to serialize, and a ""contract"" that simply returns ""null"" for all other types.I have no idea how correct these assumptions are, though, and it's not easy to tell. The JSON.NET design is very much based on implementation inheritance, method overriding, etc.; I'm not much of an OOP guy, and I find that sort of design to be pretty obscure. Were there a ""custom contract resolver"" interface that I could implement, Visual Studio 2012 would be able to stub out the required methods very quickly, and I imagine I'd have little trouble filling the stubs in with real logic.I'd have no problem writing, for example, a method that returns ""true"" if I want to serialize an object of a supplied type and ""false"" otherwise. Perhaps I'm missing something, but I've found no such method to override, nor have I been able to find the hypothetical interface (ICustomContractResolver ?) that would tell me what I'm actually supposed to be doing in the last code snippet inserted above.Also, I realize that there are JSON.NET attributes ([JsonIgnore]?) that are designed to deal with situations like this. I can't really use that approach, since I'm using ""model first"". Unless I decide to tear up my entire project architecture, my entity classes will be automatically generated, and they will not contain JsonIgnore attributes, nor do I feel comfortable editing the automated classes to contain these attributes.Incidentally, for a while I did have things set up to serialize object references, and I was just ignoring all the superfluous ""$ref"" and ""$id"" data that JSON.NET was returning in its serialization output. I've abandoned that approach for the moment at least, because (rather suddenly) serialization started taking an inordinate amount of time (~45 minutes to get ~5 MB of JSON).I haven't been able to tie that sudden change in performance back to anything specific that I did. If anything, the volume of data in my database is lower now than it was when serialization was actually completing in reasonable time. But I'd be more than happy with a return to the status quo ante (in which I was just having to ignore ""$ref"", ""$id"", etc.) if that could be achieved.At this point, I'm also open to the prospect of using some other JSON library, or a different strategy altogether. I feel like I could just use StringBuilder, System.Reflection, etc. and come of with my own, homemade solution... but isn't JSON.NET supposed to be able to handle this sort of thing pretty easily?? <code>  public class Pseudocontext{ public List<Widget> widgets; public List<Thing> things; JsonSerializer serializer = new JsonSerializer();serializer.PreserveReferencesHandling = PreserveReferencesHandling.None; public class WhatDecadeIsItAgain : DefaultContractResolver{ protected override JsonContract CreateContract(Type objectType) { JsonContract contract = base.CreateContract(objectType); if (objectType.IsPrimitive || objectType == typeof(DateTime) || objectType == typeof(string) || objectType == typeof(Pseudocontext) || objectType.Name.Contains(""List"")) { contract.Converter = base.CreateContract(objectType).Converter; } else { contract.Converter = myDefaultConverter; } return contract; } private static GeeThisSureTakesALotOfClassesConverter myDefaultConverter = new GeeThisSureTakesALotOfClassesConverter();}public class GeeThisSureTakesALotOfClassesConverter : Newtonsoft.Json.Converters.CustomCreationConverter<object>{ public override object Create(Type objectType) { return null; }}",How do I make JSON.NET ignore object relationships?
C# equivalent of vbnet interface implementations," I am taking a web service written in VB and rewriting it in C#.The service class implements two interfaces that have four methods each.Three of the four methods have the same signatures method name and parameter list. The 4th method has the same name, but a different parameter list.In VB, you explicitly identify the interface methods associated with the public service class methods. So for the methods that are the same, implementation looks like this: Can you do this in C#?I know you can explicitly define the methods in the web service class with Interface.Method2(Id as Int64, ...) and Interface2.Method2(In as...). But that will mean changing the names of these methods and consequently any application that uses these methods will have to be updated.I could also change the names of the interface methods to match the web service methods but any application that uses these interfaces will have to be changed.Is there any any to explicitly identify the interface method in the web service class, but keeping the web service class methods the same name and signature as the original? <code>  class WebServiceClass{ Public Function Method1(result as Int32) As String Implements Interface1.Method1, Interface2.Method1 Public Sub Method2(Id as Int64, P3 as Int32) Implements Interface1.Method2 Public Sub Method3(In as Int64) Implements Interface2.Method2}",C# equivalent of VB.NET interface implementations
Task.ConfigureAwait(false) in Xamarin - save to use / recommended to use?," Rule of thumb says: if it's not a UI related method, use Task.ConfigureAwait(false).What if I have a PCL core library which accepts an interface IUIAccess.The view model in the core library then has a method: IUIAccess would show a UIAlertView on iOS. My assumption would now be: if I call ViewModelLoginAsync from my UIViewController I should not configure await to FALSE. It clearly is UI code.However the call to ServiceLoginAsync could use configure await false. Is this correct?Is it just good practice or really recommended because of performance, memory usage, ...? <code>  public Task ViewModelLoginAsync(){ bool success = await loginService.ServiceLoginAsync(); if(!success) { uiAccess.ShowInfoDialog(""Login failed.""); }}",Task.ConfigureAwait(false) in Xamarin - safe to use / recommended to use?
SignalR 2.0.2 and Owin 2.0.0 dependancy conflict," I'm trying to get SignalR working in an MVC5 project with individual accounts. The MVC project has by default Owin 2.0.0 and all of the Owin.* components are also 2.0.0.So I used NuGet to get all the SignalR packages, it automatically resolved dependancies and downloaded v 2.0.2. The project throws an error on startup with the following message: Could not load file or assembly 'Microsoft.Owin, Version=2.0.1.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'I also tried upgrading Owin to 2.1.0 but that didn't help either. Has anyone faced the same problem and what was the solution? <code> ",SignalR 2.0.2 and Owin 2.0.0 dependency conflict
C# httpWebRequest (The underlying connection was closed: The connection was closed unexpectedly.)," I am developing an C# application which logs data from a webserver. It sends the following post request to the webserver and awaits for the response. I am getting the error I have tried to debug the error, and I have used fiddler in order to check the post request as given from Firefox. To my surprise whenever Fiddler was my program was working perfectly. When I close fiddler I am having the same error. I suspect that since Fiddler is acting as a proxy it may change some of the settings. I have tried using webclient and the result was the same. When I tried coding the request in python, everything worked as it should without no problem. Of cource I have the option of installing IronPython and wrapping that particular function, however I consider this overkill and lacking elegance, so I am pursuing a leaner approach. I suspect this is nothing more that a setting adjustment.I have tried modifying and in my case it is indifferent. With or without the above adjustments the code works when Fiddler is capturing data.Also it might be noteworthy that the program yields the error at UPDATE:Following @EricLaw suggestions I looked into Latency.I found this article HttpWebRequest gets slower when adding an Intervalwhich suggested turning of the Nagle Algorithm. Now there are no closed connections, although there is a small lag in the overall response (when I use winforms, and not async). <code>  /// <summary> /// Function for obtaining testCgi data /// </summary> /// <param name=""Parameters""></param> /// <returns></returns> private string HttpmyPost(string Parameters) { string str = ""No response""; HttpWebRequest request = (HttpWebRequest)WebRequest.Create(uriTestCGI); request.Method = ""POST""; byte[] bytes = Encoding.UTF8.GetBytes(Parameters); request.ContentLength = bytes.Length; Stream requestStream = request.GetRequestStream(); requestStream.Write(bytes, 0, bytes.Length); requestStream.Close(); WebResponse response = request.GetResponse(); Stream stream = response.GetResponseStream(); StreamReader reader = new StreamReader(stream); try { var result = reader.ReadToEnd(); stream.Dispose(); str = result.ToString(); reader.Dispose(); } catch (WebException ex) { //System.Windows.Forms.MessageBox.Show(ex.Message); System.Diagnostics.Trace.WriteLine(ex.Message); } finally { request.Abort(); } return str; } > ""The underlying connection was closed: The connection was closed> unexpectedly"" request.Accept request.ReadWriteTimeout request.Timeout request.UserAgent request.Headersrequest.AutomaticDecompression request.Refererrequest.AllowAutoRedirect//request.TransferEncoding request.Expectrequest.ServicePoint.Expect100Continue request.PreAuthenticate request.KeepAlive request.ProtocolVersion request.ContentType WebResponse response = request.GetResponse();",httpWebRequest (The underlying connection was closed: The connection was closed unexpectedly.)
Refactoring Code to Avoid Type Casting," I have following C# code in .Net 4.0. It requires a type casting of IBusiness to IRetailBusiness. Business Scenario:I am designing a software system for and Investment Holding Company. The company has Retail business and IntellectualRights business. BookShop and AudioCDShop are examples of Retail business. EngineDesignPatent and BenzolMedicinePatent are examples of IntellectualRights business. These two business types are totally unrelated.The investment company has a concept called InvestmentReturn (But each individual business is totally ignorant about this concept). InvestmentReturn is the profit gained from each business and it is calulated using ProfitElement. For each Business Type (Retail, IntellectualRights ), the ProfitElement used is different.QUESTIONHow to refactor this class design to avoid this type casting and type checking?Abstract Investment Extensions Client Business Domain Entities REFERENCESRefactor my code : Avoiding casting in derived classCast to generic type in C#How a Visitor implementation can handle unknown nodesOpen Closed Principle and Visitor pattern implementation in C# <code>  //Type checkingif (bus is IRetailBusiness){ //Type casting investmentReturns.Add(new RetailInvestmentReturn((IRetailBusiness)bus));}if (bus is IIntellectualRights){ investmentReturns.Add(new IntellectualRightsInvestmentReturn((IIntellectualRights)bus));} public abstract class InvestmentReturn{ public double ProfitElement { get; set; } public IBusiness Business{ get; set; } public abstract double GetInvestmentProfit(); public double CalculateBaseProfit() { double profit = 0; if (ProfitElement < 5) { profit = ProfitElement * 5 / 100; } else if (ProfitElement < 20) { profit = ProfitElement * 7 / 100; } else { profit = ProfitElement * 10 / 100; } return profit; }} public class RetailInvestmentReturn : InvestmentReturn{ public RetailInvestmentReturn(IRetailBusiness retail) { Business = retail; } public override double GetInvestmentProfit() { //GrossRevenue is the ProfitElement for RetailBusiness ProfitElement = ((IRetailBusiness)Business).GrossRevenue; return base.CalculateBaseProfit(); } }public class IntellectualRightsInvestmentReturn : InvestmentReturn{ public IntellectualRightsInvestmentReturn(IIntellectualRights intellectual) { Business = intellectual; } public override double GetInvestmentProfit() { //Royalty is the ProfitElement for IntellectualRights Business ProfitElement = ((IIntellectualRights)Business).Royalty; return base.CalculateBaseProfit(); }} class Program{ static void Main(string[] args) { #region MyBusines List<IBusiness> allMyProfitableBusiness = new List<IBusiness>(); BookShop bookShop1 = new BookShop(75); AudioCDShop cd1Shop = new AudioCDShop(80); EngineDesignPatent enginePatent = new EngineDesignPatent(1200); BenzolMedicinePatent medicinePatent = new BenzolMedicinePatent(1450); allMyProfitableBusiness.Add(bookShop1); allMyProfitableBusiness.Add(cd1Shop); allMyProfitableBusiness.Add(enginePatent); allMyProfitableBusiness.Add(medicinePatent); #endregion List<InvestmentReturn> investmentReturns = new List<InvestmentReturn>(); foreach (IBusiness bus in allMyProfitableBusiness) { //Type checking if (bus is IRetailBusiness) { //Type casting investmentReturns.Add(new RetailInvestmentReturn((IRetailBusiness)bus)); } if (bus is IIntellectualRights) { investmentReturns.Add(new IntellectualRightsInvestmentReturn((IIntellectualRights)bus)); } } double totalProfit = 0; foreach (var profitelement in investmentReturns) { totalProfit = totalProfit + profitelement.GetInvestmentProfit(); Console.WriteLine(""Profit: {0:c}"", profitelement.GetInvestmentProfit()); } Console.ReadKey(); }} public interface IBusiness{}public abstract class EntityBaseClass{}public interface IRetailBusiness : IBusiness{ double GrossRevenue { get; set; }}public interface IIntellectualRights : IBusiness{ double Royalty { get; set; }}#region Intellectualspublic class EngineDesignPatent : EntityBaseClass, IIntellectualRights{ public double Royalty { get; set; } public EngineDesignPatent(double royalty) { Royalty = royalty; }}public class BenzolMedicinePatent : EntityBaseClass, IIntellectualRights{ public double Royalty { get; set; } public BenzolMedicinePatent(double royalty) { Royalty = royalty; }}#endregion#region Retailspublic class BookShop : EntityBaseClass, IRetailBusiness{ public double GrossRevenue { get; set; } public BookShop(double grossRevenue) { GrossRevenue = grossRevenue; }}public class AudioCDShop : EntityBaseClass, IRetailBusiness{ public double GrossRevenue { get; set; } public AudioCDShop(double grossRevenue) { GrossRevenue = grossRevenue; }}#endregion",Refactoring Code to avoid Type Casting
c# split strings into many strings by newline?," i have incoming data that needs to be split into multiple values...ie. 2345\n564532\n345634\n234 234543\n1324 2435\nThe length is inconsistent when i receive it, the spacing is inconsistent when it is present, and i want to analyze the last 3 digits before each \n. how do i break off the string and turn it into a new string? like i said, this round, it may have 3 \n commands, next time, it may have 10, how do i create 3 new strings, analyze them, then destroy them before the next 10 come in?  <code>  string[] result = x.Split('\r');result = x.Split(splitAtReturn, StringSplitOptions.None);string stringToAnalyze = null;foreach (string s in result){ if (s != ""\r"") { stringToAnalyze += s; } else { how do i analyze the characters here? }}",split strings into many strings by newline?
C# async / await 'Cannot await on Task<string>' (PCL Xamarin Studio)," I'm trying to write the following method: I get an error at compilation time. I don't think the problem is the syntax. I think is a dependencies issue. My references are:I added them using Nuget. Any ideas about what could be the issue? Thanks in advance.UPDATESuggested by Selman22: Suggested by Kenneth: <code>  public async Task<string> GetJson(string url, Dictionary<string,string> parameters = null){ // parameters? if (parameters != null) { if (parameters.Count > 0) { url += ""?""; foreach(var key in parameters.Keys){ // add parameter to url url += String.Format(""{0}={1}"", key, parameters[key]); // more parameters? if(!parameters.Keys.Last ().Equals(key)){ url += ""&""; } } } } // send request var uri = new Uri(url); var req = new HttpClient(); Task<string> getJsonTask = req.GetStringAsync(uri); // EXCEPTION : 'Cannot await on Task<string>' return await getJsonTask; } public async Task<string> GetJson(string url, Dictionary<string,string> parameters = null){ // ... return await req.GetStringAsync(uri); // Same exception } public Task<string> GetJson(string url, Dictionary<string,string> parameters = null){ // ... return req.GetStringAsync(uri); // no problems here } // Later when trying to invoke GetJson public async Task<List<Station>> GetStations(){ var url = String.Format( ""?{0}_id{1}&_render=json"", DublinBikeDataProvider.BASE_URL, DublinBikeDataProvider.STATIONS ); var json = await this._httpClient.GetJson(url); // same exception return this.ParseStations(json); }",'Cannot await on Task<string>' (PCL Xamarin Studio)
WCF Rest: Is it possible to use both GET and POST in a same method?," I would like to know, in a wcf rest service is it possible to use both HTTP POST and HTTP Get in same method? I mean to say that a client page can either use post or get to invoke my method.My client wants me to implement a method in this way. As our API is a ""RESTful"" service we should be able to use both GET and POST with this method. The parameter can be placed in the URL of a GET request and also in the Header section of the GET request. When using a HTTP POST with this method the parameter can be stored in the header section or the body.Is it possible? <code> ",Is it possible to use both GET and POST in a same method?
"How to dismiss all WPF menus, list/combo box drop downs, etc programmatically?"," I want it to behave such as you clicked somewhere on application. (which collapses all menus, drop downs, etc)Actually, I'm trying to get around the interoperability related focus issue you get when you are hosting Windows Forms controls in a WPF application using WindowsFormsHost: If a WPF menu/popup by DevExpress is open and you click on a Windows Forms control, the menu/popup doesn't get dismissed automatically.Now I have a lot of Windows Forms controls in the WindowsFormsHost and also a lot of DevExpress controls in the WPF area. To get around this easily, I have added a message filter to hook all clicks in application and then I see if the clicked control was a Windows Forms control. Then I need to do something to make all WPF menus, etc. by DevExpress dismissed if they were open. GlobalMouseHandler: <code>  GlobalMouseHandler globalClick = new GlobalMouseHandler();System.Windows.Forms.Application.AddMessageFilter( globalClick ); public class GlobalMouseHandler : System.Windows.Forms.IMessageFilter{ private const int WM_LBUTTONDOWN = 0x201; private const int WM_RBUTTONDOWN = 0x204; public bool PreFilterMessage( ref System.Windows.Forms.Message m ) { if( m.Msg == WM_LBUTTONDOWN || m.Msg == WM_RBUTTONDOWN ) { var c = System.Windows.Forms.Control.FromHandle( m.HWnd ); if( c != null ) // TODO: CLOSE ALL WPF MENUS ETC // Didn't work: MainWindow.Instance.ARandomControl.Focus(); } return false; }}","How to dismiss all WPF menus, popups, etc. by DevExpress programmatically to get around WindowsFormsHost related issue?"
"How to dismiss all WPF menus, etc. programmatically to get around WindowsFormsHost related issue?"," I want it to behave such as you clicked somewhere on application. (which collapses all menus, drop downs, etc)Actually, I'm trying to get around the interoperability related focus issue you get when you are hosting Windows Forms controls in a WPF application using WindowsFormsHost: If a WPF menu/popup by DevExpress is open and you click on a Windows Forms control, the menu/popup doesn't get dismissed automatically.Now I have a lot of Windows Forms controls in the WindowsFormsHost and also a lot of DevExpress controls in the WPF area. To get around this easily, I have added a message filter to hook all clicks in application and then I see if the clicked control was a Windows Forms control. Then I need to do something to make all WPF menus, etc. by DevExpress dismissed if they were open. GlobalMouseHandler: <code>  GlobalMouseHandler globalClick = new GlobalMouseHandler();System.Windows.Forms.Application.AddMessageFilter( globalClick ); public class GlobalMouseHandler : System.Windows.Forms.IMessageFilter{ private const int WM_LBUTTONDOWN = 0x201; private const int WM_RBUTTONDOWN = 0x204; public bool PreFilterMessage( ref System.Windows.Forms.Message m ) { if( m.Msg == WM_LBUTTONDOWN || m.Msg == WM_RBUTTONDOWN ) { var c = System.Windows.Forms.Control.FromHandle( m.HWnd ); if( c != null ) // TODO: CLOSE ALL WPF MENUS ETC // Didn't work: MainWindow.Instance.ARandomControl.Focus(); } return false; }}","How to dismiss all WPF menus, popups, etc. by DevExpress programmatically to get around WindowsFormsHost related issue?"
CsvHelper mapping," I have a CSV file with several rows and each row has a work order number under column titled ""W.O.No.""Here's what I'm doing:I created a class called Job, with a single field. Then I created a JobMap class And finally, this is my main code For whatever reason I'm getting an error saying Fields 'workOrder' do not exist in the CSV file.What am I doing wrong here?  <code>  class Job{ public int workOrder { get; set; }} class JobMap : CsvClassMap<Job>{ public override void CreateMap() { Map(m => m.workOrder).Name(""W.O.No.""); }} StreamReader file = new StreamReader(filePath);var csv = new CsvReader(file);var record = csv.GetRecords<Job>().ToList();",Fields 'workOrder' do not exist in the CSV file
System.Web.Http reference defaults to 4.0 version no matter how i try," I am using the BreezeApi NuGet package in my project. It is in Visual Studio 2013.I get this error. Error 41 Assembly 'Breeze.WebApi2, Version=1.4.0.0, Culture=neutral, PublicKeyToken=f6085f1a45e2ac59' uses 'System.Web.Http, Version=5.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' which has a higher version than referenced assembly 'System.Web.Http, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'I don't know why my project keeps referencing the 4.0 version. Things I tried:I removed the reference of system.web.http 4.0 from my project and browsed to the 5.0 DLL file location. As soon as I add it and come back to Solution Explorer, right click on the system.web.http dll, it is showing 4.0.0.0.I added assembly binding in web.config like below How do I resolve this? <code>  <dependentAssembly> <assemblyIdentity name=""System.Web.Http"" publicKeyToken=""31bf3856ad364e35"" culture=""neutral"" /> <bindingRedirect oldVersion=""0.0.0.0-5.1.0.0"" newVersion=""5.1.0.0"" /></dependentAssembly>",System.Web.Http reference defaults to 4.0 version no matter how I try
Application Singleton bring already collapsed window back to view," Sorry it the title is hard to understand. I wasn't sure how to word it.I have an application that should only be allowed to run one instance per user session.If the user clicks to launch the application again, I want to bring the one already to focus.The window will likely have Visibility to collapsed.If it's visible I know I can use but if the window is collapsed, is there a way for me to bring it back to visible? <code>  if (IsIconic(hWnd)){ ShowWindowAsync(hWnd, swRestore);}SetForegroundWindow(hWnd);",How to create single instance WPF Application that restores the open window when an attempt is made to open another instance?
C#: What happens when calling an async void method without await?," I wonder what happens if I call a method that is marked as async without using await. Consider this example: I know that this will produce a compile warning, but my question is if the awaited method calls in Initialize() will still work as one would expect. As you can see it is not necessary for the setter to await Initialize() as there is no return value and it's the last call of the property's setter. It's kind of fire and forget.The reason I would like to do this is that I would like to combine MVVM and a data backend that forces me to use async methods.In the example above, the user selects an entry from a list and the program should display detailed information about the entry in another part of the view.I would like to bind the currently selected entry of the list to DataId, which updates the detail view whenever the user changes the selection. Of course, it would be possible to do the async method calls from an event handler but I would like to avoid event handlers for the sake of a cleaner MVVM implementation (using mostly databinding). <code>  private int id = 0;async Task Initialize(){ var content = await LoadFromDisk(id); await Process(content); return;}DataId{ get { return id; } set { id = value; Initialize(); }}",What happens when calling an async method without await?
What happens when calling an async void method without await?," I wonder what happens if I call a method that is marked as async without using await. Consider this example: I know that this will produce a compile warning, but my question is if the awaited method calls in Initialize() will still work as one would expect. As you can see it is not necessary for the setter to await Initialize() as there is no return value and it's the last call of the property's setter. It's kind of fire and forget.The reason I would like to do this is that I would like to combine MVVM and a data backend that forces me to use async methods.In the example above, the user selects an entry from a list and the program should display detailed information about the entry in another part of the view.I would like to bind the currently selected entry of the list to DataId, which updates the detail view whenever the user changes the selection. Of course, it would be possible to do the async method calls from an event handler but I would like to avoid event handlers for the sake of a cleaner MVVM implementation (using mostly databinding). <code>  private int id = 0;async Task Initialize(){ var content = await LoadFromDisk(id); await Process(content); return;}DataId{ get { return id; } set { id = value; Initialize(); }}",What happens when calling an async method without await?
.NET Web API 2 Authorize Attribute," My application is setup where all requests except login must be 'authorized' using the authorization attribute in Web API. E.g. and only the login needs to not authorize since thats where you get the token ;) instead of having to add the [Authorize] attribute to ALL my routes, is there a way to set it globally? <code>  [Authorize] [HttpGet, Route(""api/account/profile"")] public ApplicationUser Profile() { return userModel; } [AllowAnonymous][HttpPost, Route(""api/account/login"")]public async Task<IHttpActionResult> Login(LoginViewModel model){ ....}",Apply [Authorize] attribute implicitly to all Web API controllers
Apply [Autohorize] attribute implicitly to all Web API controllers," My application is setup where all requests except login must be 'authorized' using the authorization attribute in Web API. E.g. and only the login needs to not authorize since thats where you get the token ;) instead of having to add the [Authorize] attribute to ALL my routes, is there a way to set it globally? <code>  [Authorize] [HttpGet, Route(""api/account/profile"")] public ApplicationUser Profile() { return userModel; } [AllowAnonymous][HttpPost, Route(""api/account/login"")]public async Task<IHttpActionResult> Login(LoginViewModel model){ ....}",Apply [Authorize] attribute implicitly to all Web API controllers
ASP.Net MVC 4 DataAnnotaion to compare two properties," Is there any way of using data annotations to compare two form field (eg. to confirm an email address) are the same, before allowing the form to be posted?eg. can the regular expression data annotation use the match function to reference another property in a ViewModel? <code> ",DataAnnotation to compare two properties
ASP.Net MVC 4 DataAnnotation to compare two properties," Is there any way of using data annotations to compare two form field (eg. to confirm an email address) are the same, before allowing the form to be posted?eg. can the regular expression data annotation use the match function to reference another property in a ViewModel? <code> ",DataAnnotation to compare two properties
Change the font style in code behind," How can I change the FontStyle in the code-behind in WPF. I tried this: and I got error, any idea? <code>  listBoxItem.FontStyle = new FontStyle(""Italic""); ",Change the FontStyle in code behind in WPF
How to populate a treeview recursively using c#," Well, I have a table in a database called departments and it has the following fields: Id, Parent, Name, IsActive.What is the best way to fill a TreeView with this data? <code> ",How to populate a TreeView recursively
c# How to handle json that returns both a string and a string array?," I'm using the Yahoo fantasy sports api. I'm getting a result like this: How is it that I can deserialize this? My code looks like this: And in my JSONResponse.cs file: When I run this, since eligible_positions can return both a string and a string array, I keep getting the error ""Type 'System.String' is not supported for deserialization of an array"". I've also tried turning public string position { get; set; } to public string[] position { get; set; } but I still get an error. How should I handle this?  <code>  ""player"": [ { ... ""eligible_positions"": { ""position"": ""QB"" }, ... }, { ... ""eligible_positions"": { ""position"": [ ""WR"", ""W/R/T"" ] }, ... }, var json = new JavaScriptSerializer();if (response != null){ JSONResponse JSONResponseObject = json.Deserialize<JSONResponse>(response); return JSONResponseObject;} public class Player{ public string player_key { get; set; } public string player_id { get; set; } public string display_position { get; set; } public SelectedPosition selected_position { get; set; } public Eligible_Positions eligible_positions { get; set; } public Name name { get; set; } }public class Eligible_Positions{ public string position { get; set; }}",How to handle json that returns both a string and a string array?
Can i achieve the same performance for SqlDataReader in .NET 4.0 asynchronously," I'm working on a large project that runs on .NET 4.0. This framework uses ADO.NET for database calls and we're currently adding asynchronous API methods. The SqlCommand class has the APM methods SqlCommand.BeginExecuteReader() and SqlCommand.EndExecuteReader(), but SqlDataReader does not have asynchronous implementations.When the SqlCommand.ExecuteReader() is finished I want to iterate through the results using SqlDataReader. Microsoft introduces asynchronous methods for SqlDataReader in .NET 4.5, so I can't use those in 4.0. Question: Should we upgrade to be able to use the asynchronous (TAP) methods of SqlDataReader?If we do, why? I searched the web and stackoverflow alot for answers, but I only seem to find implementations for this. It doesn't tell me what benefit those new implementations give..NET 4.0 implementationHere we use the asynchronous methods of SqlCommand, but we can't use the new asynchronous methods for SqlDataReader, like SqlDataReader.ReadAsync(). .NET 4.5 implementationIn .NET 4.5 we can use the async/await keywords, and we can use the new asynchronous methods for SqlDataReader, like SqlDataReader.ReadAsync(). <code>  private Task<IDataReader> ExecuteReaderAsync(IDbCommand dbCommand){ var sqlCommand = CheckIfSqlCommand(dbCommand); PrepareExecuteReader(dbCommand); return Task<IDataReader> .Factory .FromAsync(sqlCommand.BeginExecuteReader, sqlCommand.EndExecuteReader, null);}private void ReadAll(Task<IDataReader> readerTask){ var reader = readerTask.Result; while (reader.Read()) // Should this be asynchronously? { // Do something }}public Task<IDataReader> Foo(IDbCommand dbCommand) { return ExecuteReaderAsync(dbCommand) .ContinueWith(readerTask => ReadAll(readerTask));} private async Task<SqlDataReader> ExecuteReaderAsync(SqlCommand dbCommand){ PrepareExecuteReader(dbCommand); return await dbCommand.ExecuteReaderAsync();}private async Task ReadAll(SqlDataReader reader){ while (await reader.ReadAsync()) // Should this be asynchronously? { // Do something }}public async Task<IDataReader> Foo(SqlCommand dbCommand){ var reader = await ExecuteReaderAsync(dbCommand); await ReadAll(reader); return reader;}",Should I upgrade to be able to use the new async methods for SqlDataReader?
Can I achieve the same performance for SqlDataReader in .NET 4.0 asynchronously," I'm working on a large project that runs on .NET 4.0. This framework uses ADO.NET for database calls and we're currently adding asynchronous API methods. The SqlCommand class has the APM methods SqlCommand.BeginExecuteReader() and SqlCommand.EndExecuteReader(), but SqlDataReader does not have asynchronous implementations.When the SqlCommand.ExecuteReader() is finished I want to iterate through the results using SqlDataReader. Microsoft introduces asynchronous methods for SqlDataReader in .NET 4.5, so I can't use those in 4.0. Question: Should we upgrade to be able to use the asynchronous (TAP) methods of SqlDataReader?If we do, why? I searched the web and stackoverflow alot for answers, but I only seem to find implementations for this. It doesn't tell me what benefit those new implementations give..NET 4.0 implementationHere we use the asynchronous methods of SqlCommand, but we can't use the new asynchronous methods for SqlDataReader, like SqlDataReader.ReadAsync(). .NET 4.5 implementationIn .NET 4.5 we can use the async/await keywords, and we can use the new asynchronous methods for SqlDataReader, like SqlDataReader.ReadAsync(). <code>  private Task<IDataReader> ExecuteReaderAsync(IDbCommand dbCommand){ var sqlCommand = CheckIfSqlCommand(dbCommand); PrepareExecuteReader(dbCommand); return Task<IDataReader> .Factory .FromAsync(sqlCommand.BeginExecuteReader, sqlCommand.EndExecuteReader, null);}private void ReadAll(Task<IDataReader> readerTask){ var reader = readerTask.Result; while (reader.Read()) // Should this be asynchronously? { // Do something }}public Task<IDataReader> Foo(IDbCommand dbCommand) { return ExecuteReaderAsync(dbCommand) .ContinueWith(readerTask => ReadAll(readerTask));} private async Task<SqlDataReader> ExecuteReaderAsync(SqlCommand dbCommand){ PrepareExecuteReader(dbCommand); return await dbCommand.ExecuteReaderAsync();}private async Task ReadAll(SqlDataReader reader){ while (await reader.ReadAsync()) // Should this be asynchronously? { // Do something }}public async Task<IDataReader> Foo(SqlCommand dbCommand){ var reader = await ExecuteReaderAsync(dbCommand); await ReadAll(reader); return reader;}",Should I upgrade to be able to use the new async methods for SqlDataReader?
View State in C#.NET," I have a separate class under my App_Code folder (.NET project) called ""StateBag.cs""using System;using System.Text; Now I want to be able to update the MemberID value from any page of my web project.example:-Default.aspx.cs:- On my Default.aspx.cs Page I am trying to set the value of memberID into MyStateBag:- However I get a conflict:-'System.Web.UI.StateBag' does not contain a definition for 'MemberID' and no extension method 'MemberID' accepting a first argument of type 'System.Web.UI.StateBag' could be found (are you missing a using directive or an assembly reference?)Do I have to reference something on my Default.aspx.cs page that I am missing out on??and how can i access it back...say I am on a different page,""About.aspx.cs"".I want to be able to say :-memberinfo = StateBag[""MemberID""]Can anyone help me understand this? <code>  [Serializable()]public class MyStateBag{ public MyStateBag(){} private string _MemberID = string.Empty; public string MemberID { get { return _MemberID; } set { _MemberID = value; } }} public partial class _Default : System.Web.UI.Page { public StateBag MyStateBag { get { return (StateBag)Session[""MyStateBag""]; } set { Session[""MyStateBag""] = value; } } protected void Page_Init(object sender, EventArgs e) { this.MyStateBag = (StateBag)Session[""MyStateBag""]; } .... } if (HttpContext.Current.Session[""MyStateBag""] == null) { HttpContext.Current.Session[""MyStateBag""] = new StateBag(); } ((StateBag)HttpContext.Current.Session[""MyStateBag""]).MemberID = memID;",Storing a Complex Object in Session State
why Simple Injector's source code all in one .cs file," like this https://github.com/seesharper/LightInject/blob/master/LightInject/LightInject.csIt's hard to reading, is there any deep meaning? <code> ",why Light Inject's source code all in one .cs file
BroadcastBlock with Guaranteed Delivery in TPL Dataflow," I have a stream of data that I process in several different ways... so I would like to send a copy of each message I get to multiple targets so that these targets may execute in parallel... however, I need to set BoundedCapacity on my blocks because the data is streamed in way faster than my targets can handle them and there is a ton of data. Without BoundedCapacity I would quickly run out of memory.However the problem is BroadcastBlock will drop messages if a target cannot handle it (due to the BoundedCapacity).What I need is a BroadcastBlock that will not drop messages, but will essentially refuse additional input until it can deliver messages to each target and then is ready for more.Is there something like this, or has anybody written a custom block that behaves in this manner? <code> ",BroadcastBlock with guaranteed delivery in TPL Dataflow
"How does the C# class called ""convert"" fits OO conventions?"," Aren't classes supposed to be called after objects and not actions? It just does not sit along with OO theory I learned.One thought was that maybe since Convert holds only static methods then no instances of it are supposed to be created at all, which might make it an acceptable exception. <code> ",How does System.Convert fit OO conventions?
Any reason not to enabling CODE_ANALYSIS in production builds?," Are there any performance costs when static code analysis is enabled in a production (release) build?Our CI server runs code analysis on a debug build of our C# projects, whereas the release build has static code analysis disabled (i.e. CODE_ANALYSIS not defined). If there's no reason to disable code analysis on production builds, then I'm wasting time with the debug build.Reflector shows me that SuppressMessage attributes are excluded if code analysis is disabled, but I don't expect the extra attribute to affect run-time performance. Is that the only effect of enabling static code analysis (in Visual Studio 2013)? <code> ",Any reason not to enable CODE_ANALYSIS in production builds?
Transfering large files: combining streamed transfer and content-length," TL;DR: How can I stream large files with a known size using WCF, and still show progress (Content-Length) to the final user (a web browser)?I have a WCF REST service which downloads and then serves very large files (1-20Gb) to a web browser. To simplify, think of my service as a proxy. This obliges me to set TransferMode = Streamed or TransferMode = StreamedResponse on the Binding, or the end client will have to wait for the source files to be downloaded to the webserver before the actual download begins. Also, buffered transfer mode kills the server for large files (RAM usage). Intermediate disk storage is not an option. From TransferMode man page: (...) Buffered transfers hold the entire message in a memory buffer until the transfer is complete.But when setting TransferMode to Streamed or StreamedResponse, WCF no longer returns the header Content-length to the client, and a new header Transfer-Encoding: chunked is added. This is consistent with wikipedias article on chunked transfer: (...) uses the Transfer-Encoding HTTP header in place of the Content-Length header (...)But I always know the size of the data to be transferred beforehand, and for the end user, it's very frustrating not to know the size of the download. So:(How) can I configure the WCF binding to use a ""streaming"" Transfer mode (more specifically, not buffering the entire message before sending) and still use the Content-Length header? Some leads:This q/a states that the http standard disallows both Transfer-Encoding and Content-length: 123456 in the same message, so I guess that's not an option? I have tried modifying the headers using an inspector in IDispatchMessage.BeforeSendReply but at this point the Content-Length header has not yet been removed, and Transfer-Encoding has not yet been set, so it's ""too early"". I have later read that chunked transfer encoding is on TCP level, so changing the header at this point probably wont work even if I could.I have tried setting aspNetCompatibilityEnabled=""true"", setting wcf transfer mode to buffered output (default) and then set System.Web.HttpContext.Current.Response.BufferOutput = false;. This is ignored by wcf though, the message is clearly buffered.It seems to be a missing feature, according to this link. But there may still be a quirky workaround somewhere.. <code> ",Transferring large files: combining streamed transfer and content-length
Passing Output parameters to sproc using dapper in c# code," I have a stored procedure in this format I am calling this stored procedure from C# code using dapper. My question is: how do I pass in the output parameter to the stored procedure while using dapper? <code>  CREATE PROCEDURE SP_MYTESTpROC @VAR1 VARCHAR(10), @VAR2 VARCHAR(20), @BASEID INT , @NEWID INT OUTPUTAs Begin INSERT INTO TABLE_NAME(username, firstname) select @VAR1, @VAR2 WHERE ID = @BASEID SET @NEWID = SCOPE_IDENTITY() AS INTEND",Passing Output parameters to stored procedure using dapper in c# code
"Getting ""The entity type <model> is not part of the model for the current context."" asp.net"," I am having this issue updating my database 1 column at a time in asp.net using web api. I am trying to query a PUT to just update one value in the row instead of updating that one and setting the rest to null. I made a separate model outside of the controller to take in the update so I could do one at a time. When I hit this line db.Entry(user).State = EntityState.Modified; in the controller that is where it is erroring out. Any advice how I can fix this?This is my separate ViewModel I am taking in in the put method: This is my controller calling in the method with the ViewModel in my parameter: This is my DBContext file: <code>  namespace WebAPI.Models.ViewModels{ public class UserViewModel { public string FirstName { get; set; } public string LastName { get; set; } }} public HttpResponseMessage PutUser(int id, UserViewModel user) { HttpResponseMessage response; if (db.User.IsInRole(""Admin"")) { try { db.Entry(user).State = EntityState.Modified; db.SaveChanges(); } catch (DbUpdateConcurrencyException) { if (!UserExists(id)) { response = new HttpResponseMessage(HttpStatusCode.NotFound); return response; } else { throw; } } response = new HttpResponseMessage(HttpStatusCode.NoContent); return response; } public partial class Entities : DbContext { public Entities() : base(""name=Entities"") { } protected override void OnModelCreating(DbModelBuilder modelBuilder) { throw new UnintentionalCodeFirstException(); } public virtual DbSet<User> Users { get; set; } }}","Getting ""The entity type <model> is not part of the model for the current context."""
JSON.NET ignore root-element when deserializing object," I have a problem with deserializing a Json-string to an object.This is a sample json i receive from a webservice: And I have a class CityData that looks like this I try to deserialize the json with a call of the method DeserializeObject but the root element seems to make problems...Do you guys know how I can fix it, so that I receive a CityData-object with the data filled in? <code>  { ""GetDataResult"": ""{ \""id\"":1234, \""cityname\"":\""New York\"", \""temperature\"":300, }""} [JsonObject(""GetDataResult"")]public class CityData{ [JsonProperty(""id"")] public int Id { get; set; } [JsonProperty(""cityname"")] public string CityName { get; set; } [JsonProperty(""temperature"")] public int Temperature { get; set; }} var cityData = JsonConvert.DeserializeObject<CityData>(response);",How can I deserialize JSON containing delimited JSON?
Deserialize partial JSON," I have a problem with deserializing a Json-string to an object.This is a sample json i receive from a webservice: And I have a class CityData that looks like this I try to deserialize the json with a call of the method DeserializeObject but the root element seems to make problems...Do you guys know how I can fix it, so that I receive a CityData-object with the data filled in? <code>  { ""GetDataResult"": ""{ \""id\"":1234, \""cityname\"":\""New York\"", \""temperature\"":300, }""} [JsonObject(""GetDataResult"")]public class CityData{ [JsonProperty(""id"")] public int Id { get; set; } [JsonProperty(""cityname"")] public string CityName { get; set; } [JsonProperty(""temperature"")] public int Temperature { get; set; }} var cityData = JsonConvert.DeserializeObject<CityData>(response);",How can I deserialize JSON containing delimited JSON?
IEqualityComparer GetHasCode being called but Equals not," I have two lists that I am trying to compare. So I have created a class that implements the IEqualityComparer interface, please see below in the bottom section of code. When I step through my code, the code goes through my GetHashCode implementation but not the Equals? I do not really understand the GetHashCode method, despite reading around on the internet and what exactly it is doing. So in the two lines of code above the two lists return me every item, telling me that the two lists do not contain any items that are the same. This is not true, there is only row that is different. I'm guessing this is happening because the Equals method is not getting called which in turns makes me wonder if my GetHashCode method is working as its supposed to? <code>  List<FactorPayoffs> missingfactorPayoffList = factorPayoffList.Except( factorPayoffListOrg, new FactorPayoffs.Comparer()).ToList();List<FactorPayoffs> missingfactorPayoffListOrg = factorPayoffListOrg.Except( factorPayoffList, new FactorPayoffs.Comparer()).ToList(); class FactorPayoffs { public string FactorGroup { get; set; } public string Factor { get; set; } public DateTime dtPrice { get; set; } public DateTime dtPrice_e { get; set; } public double Ret_USD { get; set; } public class Comparer : IEqualityComparer<FactorPayoffs> { public bool Equals(FactorPayoffs x, FactorPayoffs y) { return x.dtPrice == y.dtPrice && x.dtPrice_e == y.dtPrice_e && x.Factor == y.Factor && x.FactorGroup == y.FactorGroup; } public int GetHashCode(FactorPayoffs obj) { int hash = 17; hash = hash * 23 + (obj.dtPrice).GetHashCode(); hash = hash * 23 + (obj.dtPrice_e).GetHashCode(); hash = hash * 23 + (obj.Factor ?? """").GetHashCode(); hash = hash * 23 + (obj.FactorGroup ?? """").GetHashCode(); hash = hash * 23 + (obj.Ret_USD).GetHashCode(); return hash; } } }",IEqualityComparer GetHashCode being called but Equals not
Calling unsafe method using expresion trees, I need to call unsafe method that takes raw pointers. For that I need to construct Expression that represents pointer to value represented by VariableExpression or ParameterExpression. How to do that? <code> ,Calling unsafe method using expression trees
difference between string str ; and string str=null ;," I want to know what exactly happens inside when we declare a variable, like this: While debugging, I noticed for both values that it was showing null only. But when using ref tr without initializing null it will give error while the second line doesn't.Please help me to know about it in depth <code>  string tr;string tr = null;",Difference between string str and string str=null
Expossing Entity Framework over WCF Service," I need some help here! I'm trying to create my first application using Entity Framework, WCF, MVVM and WPF technologies. I'm new to all of them. So I create a model for my database using Entity Framework. Then I create my WCF service class. I have read close to 50 articles about EF and WCF services and I'm all about confusion right now. I know that I'm not supposed to expose my model directly. Currently I'm using this code as service contract: My questions:The problem with it is that don't suppose to expose my data model directly, right? So here I'm returning detached entity of class vw_Pedidos. Is this a bad practice?I have read a lot about DTO's and POCO's object, which should I use instead of the above code?If I use DTO or POCO to transfer over WCF, do I have to manually create a DTO for each database object? Do I have to manually create all the properties (fields) for each DB object?If I add a new field to a database object and need to show it on client, do I have to update my EF model, add the new field manually to the DTO or POCO object? This sounds like a maintenance nightmare!Is using EntitiesToDTOs a good option for automatic create DTOs based on EF objects?Can I use DTO to update data back to database?Sorry for the multiple questions. Please help me out here! I'm searching for a pattern that lead me to an easy to maintain, concern separated code. Thanks!UPDATEFollowing TomTom suggestions, i read a lot about POCOs, EF and Linq to Entities. After that i re-write my whole app. I divide my code on 5 projects:1)DataLayer2)ModelLayer3)BusinessLyer4)WCF Service Layer5)WPF ClientFor comunications on layers 1 to 5 I use POCO classes mapped to Entity Framework using POCO T4 Template. To comunicate layer 4 and 5 over WCF I want to use a custom class to hide some field from client (I don't want to expose the whole POCO class) so I re-write filter function using linq to entities and projection to IEnumerable: Is this the best way to do this? Can i make the projection AFTER the filter? Thanks! <code>  namespace Ohmio.DataService{ [ServiceContract] public class OhmioService { [OperationContract] public IEnumerable<vw_Pedidos> ListarPedidos(string IDComprobante, bool bEntregados, int Numero = -1, int IDCliente = -1) { using (var context = new OhmioTestNet()) { string sqlString=""SELECT VALUE cs FROM OhmioTestNet.vw_Pedidos AS cs WHERE cs.ID_Comprobante=='"" + IDComprobante + ""' AND ""; if (Numero != -1) sqlString += ""cs.Numero==""+ Numero.ToString() +"" AND ""; if (IDCliente != -1) sqlString += ""cs.ID_Cliente==""+ IDCliente.ToString()+"" AND ""; if (!bEntregados) sqlString += ""cs.Entregado==false AND ""; sqlString =sqlString.Substring(0,sqlString.Length-4); ObjectQuery<vw_Pedidos> Pedidos = context.CreateQuery<vw_Pedidos>(sqlString); var result = Pedidos.ToList(); result.ForEach(e => context.Detach(e)); return result; } } [OperationContract] public IEnumerable<Clientes> GetClientes() { using (var context = new OhmioTestNet()) { var result = context.Clientes.Where(f => f.Activo == true).ToList(); result.ForEach(e => context.Detach(e)); return result; } } }} public IEnumerable<PedidosList> Pedidos_Listar(string sComprobante, Clientes MyCliente = null, DateTime? dDesde = null, DateTime? dHasta = null, bool bCumplidos = false) { using (var context = new OhmioEntities()) { IEnumerable<PedidosList> query = from Pedidos in context.Pedidos join Clientes in context.Clientes on Pedidos.ID_Cliente equals Clientes.ID_Cliente where Pedidos.ID_Comprobante == sComprobante select new PedidosList {ID_Pedido = Pedidos.ID_Pedido, Fecha=Pedidos.Fecha, Aprobado=Pedidos.Aprobado, Bruto=Pedidos.Bruto, Cliente=Clientes.RazonFantasia, FechaEntrega=Pedidos.FechaEntrega, Neto=Pedidos.Neto, Numero=Pedidos.Numero, Observaciones=Pedidos.Observaciones, Entregado=Pedidos.Entregado, ID_Cliente=Pedidos.ID_Cliente }; if (MyCliente != null) query = query.Where(i => i.ID_Cliente == MyCliente.ID_Cliente); if (MyCliente != null) query = query.Where(i => i.ID_Cliente == MyCliente.ID_Cliente); if (dDesde != null && dHasta != null) query = query.Where(i => i.Fecha >= dDesde && i.Fecha <= dHasta); if (bCumplidos == false) query = query.Where(i => i.Entregado == false); return query.ToList(); } }",Exposing Entity Framework over WCF Service
C# unsafe. What is the difference between referencing a value using pointer and ref keyword," I have the following code: What's the difference between passing a pointer and a ref keyword as a parameter in the method? <code>  class Program{ private unsafe static void SquarePtrParam(int* input) { *input *= *input; } private static void SquareRefParam(ref int input) { input *= input; } private unsafe static void Main() { int value = 10; SquarePtrParam(&value); Console.WriteLine(value); int value2 = 10; SquareRefParam(ref value2); Console.WriteLine(value2); //output 100, 100 Console.ReadKey(); }}",What is the difference between referencing a value using a pointer and a ref keyword
What is the difference between referencing a value using pointer and ref keyword," I have the following code: What's the difference between passing a pointer and a ref keyword as a parameter in the method? <code>  class Program{ private unsafe static void SquarePtrParam(int* input) { *input *= *input; } private static void SquareRefParam(ref int input) { input *= input; } private unsafe static void Main() { int value = 10; SquarePtrParam(&value); Console.WriteLine(value); int value2 = 10; SquareRefParam(ref value2); Console.WriteLine(value2); //output 100, 100 Console.ReadKey(); }}",What is the difference between referencing a value using a pointer and a ref keyword
WPF Windows 8 Compatability Issue," Given a button (or a combobox, or any control for that matter): With the style: It looks very different in Windows 8 than it does in Windows 7.Now, the strange part is that in the DESIGNER, everything looks perfect on a Windows 8 machine as if it were Windows 7... But at runtime, the style isn't ""applied.""On the other hand, it looks perfect on Windows 7 in both the designer and runtime. Is there a way to fix this?Additional Details:With the RD in the Style: The result looks like: With the RD in the Application scope: The result looks like: I'd like to apply the visuals of the second one to just a single style, not the entire application. <code>  <Button x:Name=""button"" Command=""{Binding DoStuff}"" Margin=""10,0,5,5"" Content=""Do Stuff!"" Style=""{StaticResource buttonDefaults}""/> <Style x:Key=""buttonDefaults"" TargetType=""Button"" BasedOn=""{StaticResource {x:Type Button}}""> <Style.Resources> <ResourceDictionary Source=""/PresentationFramework.Aero;component/themes/Aero.NormalColor.xaml""/> </Style.Resources> <Setter Property=""Background""> <Setter.Value> <RadialGradientBrush> <GradientStop Color=""#F4083268"" Offset=""1""/> <GradientStop Color=""#FE5C9247""/> </RadialGradientBrush> </Setter.Value> </Setter> <Setter Property=""BorderBrush"" Value=""Transparent""/> <Setter Property=""Foreground"" Value=""White""/> <Setter Property=""FontFamily"" Value=""Arial""/> <Setter Property=""FontSize"" Value=""16""/> <Setter Property=""Focusable"" Value=""False""/> </Style> <Style x:Key=""buttonDefaults"" TargetType=""Button"" BasedOn=""{StaticResource {x:Type Button}}""> <Style.Resources> <ResourceDictionary Source=""/PresentationFramework.Aero,Version=4.0.0.0,Culture=Neutral,PublicKeyToken=31bf3856ad364e35,processorArchitecture=MSIL;component/themes/Aero.NormalColor.xaml""/> </Style.Resources> <Setter Property=""Background""> <Setter.Value> <RadialGradientBrush> <GradientStop Color=""#F4083268"" Offset=""1""/> <GradientStop Color=""#FE5C9247""/> </RadialGradientBrush> </Setter.Value> </Setter> <Setter Property=""BorderBrush"" Value=""Transparent""/> <Setter Property=""Foreground"" Value=""White""/> <Setter Property=""FontFamily"" Value=""Arial""/> <Setter Property=""FontSize"" Value=""16""/> <Setter Property=""Focusable"" Value=""False""/> </Style> <Application.Resources> <ResourceDictionary> <ResourceDictionary.MergedDictionaries> <ResourceDictionary Source=""/PresentationFramework.Aero,Version=4.0.0.0,Culture=Neutral,PublicKeyToken=31bf3856ad364e35,processorArchitecture=MSIL;component/themes/Aero.NormalColor.xaml""/> </ResourceDictionary.MergedDictionaries> <Style x:Key=""buttonDefaults"" TargetType=""Button"" BasedOn=""{StaticResource {x:Type Button}}""> <Setter Property=""Background""> <Setter.Value> <RadialGradientBrush> <GradientStop Color=""#F4083268"" Offset=""1""/> <GradientStop Color=""#FE5C9247""/> </RadialGradientBrush> </Setter.Value> </Setter> <Setter Property=""BorderBrush"" Value=""Transparent""/> <Setter Property=""Foreground"" Value=""White""/> <Setter Property=""FontFamily"" Value=""Arial""/> <Setter Property=""FontSize"" Value=""16""/> <Setter Property=""Focusable"" Value=""False""/> </Style> </ResourceDictionary></Application.Resources>",WPF Windows 8 Compatibility Issue
INotifyPropertyChanged : is [CallerMemberName] slow compared to alternatives?," There are good articles that suggest different ways for implementing INotifyPropertyChanged.Consider the following basic implementation: I'd like to replace it with this one: But sometimes I read that the [CallerMemberName] attribute has poor performances compared to alternatives. Is that true and why? Does it use reflection? <code>  class BasicClass : INotifyPropertyChanged{ public event PropertyChangedEventHandler PropertyChanged; private void FirePropertyChanged(string propertyName) { var handler = PropertyChanged; if (handler != null) handler(this, new PropertyChangedEventArgs(propertyName)); } private int sampleIntField; public int SampleIntProperty { get { return sampleIntField; } set { if (value != sampleIntField) { sampleIntField = value; FirePropertyChanged(""SampleIntProperty""); // ouch ! magic string here } } }} using System.Runtime.CompilerServices;class BetterClass : INotifyPropertyChanged{ public event PropertyChangedEventHandler PropertyChanged; // Check the attribute in the following line : private void FirePropertyChanged([CallerMemberName] string propertyName = null) { var handler = PropertyChanged; if (handler != null) handler(this, new PropertyChangedEventArgs(propertyName)); } private int sampleIntField; public int SampleIntProperty { get { return sampleIntField; } set { if (value != sampleIntField) { sampleIntField = value; // no ""magic string"" in the following line : FirePropertyChanged(); } } }}",Is [CallerMemberName] slow compared to alternatives when implementing INotifyPropertyChanged?
Roughly distance between 2 points in c#," I am trying to sort out a method to calculate the distance between 2 points in c#.This is the code I have been trying though I fear the answer I get is not correct. this was adapted from a response found on this site hereDistance between addressesAny thoughts on what is going wrong/ThanksRyan <code>  static void Main() { //postcode australia 2600 -> 3000 float latA = -31.997976f; float longA = 115.762877f; float latB = -31.99212f; float longB = 115.763228f; decimal distance = (DistanceBetween(latA, latB, longA, longB)); Console.WriteLine(""Distance is"" + distance); Console.ReadLine(); } static decimal DistanceBetween(float latA, float longA, float latB, float longB) { var RadianLatA = Math.PI * latA / 180; var RadianLatb = Math.PI * latB / 180; var RadianLongA = Math.PI * longA / 180; var RadianLongB = Math.PI * longB / 180; double theDistance = (Math.Sin(RadianLatA)) * Math.Sin(RadianLatb) + Math.Cos(RadianLatA) * Math.Cos(RadianLatb) * Math.Cos(RadianLongA - RadianLongB); return Convert.ToDecimal(((Math.Acos(theDistance) * (180.0 / Math.PI)))) * 69.09M * 1.6093M; }",Calculating the distance between 2 points in c#
ASP.NET MVC - ViewModel is Null in HttpPost method," I'm using ASP.NET MVC 4 and I built these ViewModels : My View : My HttpGet method populates my ViewModel and returns it. However, when I want to save the changes, I got a ViewModel which is null and I don't understand why. Any idea guys?EDIT : My post method : HTML generated :  <code>  public class NotificationViewModel{ public string GroupDesc { get; set; } public bool AM { get; set; } public bool PM { get; set; } public int MaxNotif { get; set; }}public class SettingsViewModel{ public List<NotificationViewModel> ListNotification { get; set; } public SettingsViewModel() { ListNotification = new List<NotificationViewModel>(); }} @model PortailT2A.Models.SettingsViewModel@{ ViewBag.Title = ""Preferences""; Layout = ""~/Views/Shared/_LayoutAdmin.cshtml"";}<h2>Preferences</h2>@using(Html.BeginForm(""Preferences"", ""Administrateur"", FormMethod.Post)){ <table id=""settingsTable""> <tr> <th>Groupe</th> <th></th> <th>AM</th> <th>PM</th> <th>Limite de notifications</th> </tr> @for (int i = 0; i < Model.ListNotification.Count(); i++ ) { var notif = Model.ListNotification[i]; <tr> <td>@notif.GroupDesc </td> <td>Heure de notification</td> <td>@Html.CheckBoxFor(u => notif.AM) </td> <td>@Html.CheckBoxFor(u => notif.PM) </td> <td>@Html.TextBoxFor(u => notif.MaxNotif)</td> </tr> <tr/> } </table> <input type =""submit"" value=""Sauvegarder"" />} [HttpGet] public ActionResult Preferences(long idUser) { context = new MainDatabaseEntities(); List<NotificationViewModel> notifications = new List<NotificationViewModel>(); SettingsViewModel settings = new SettingsViewModel(); //Population... return View(settings); } [HttpPost] public ActionResult Preferences(SettingsViewModel sm) { //since here my ViewModel is null context = new MainDatabaseEntities(); Utilisateur user = (from u in context.Utilisateurs where u.Username == User.Identity.Name select u).FirstOrDefault(); //operations...} <tr> <td>Groupe B </td> <td>Heure de notification</td> <td><input id=""notif_AM"" name=""notif.AM"" type=""checkbox"" value=""true"" /><input name=""notif.AM"" type=""hidden"" value=""false"" /> </td> <td><input checked=""checked"" id=""notif_PM"" name=""notif.PM"" type=""checkbox"" value=""true"" /><input name=""notif.PM"" type=""hidden"" value=""false"" /> </td> <td><input id=""notif_MaxNotif"" name=""notif.MaxNotif"" type=""text"" value=""10"" /></td> </tr>",ViewModel is Null in HttpPost method
"System.IO.FileLoadException: Could not load file or assembly 'log4net,"," I added an existing project to my solution. When I run all unit tests with MSTest runner, I get the following error on a couple of tests: Message: Test method soandso threw exception: System.IO.FileLoadException: Could not load file or assembly 'log4net, Version 1.2.12.0, Culture=neutral, PublicKeyToken=669e0ddf0bb1aa2a' or one of it's dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT:0x80131040)I know others have had the same problem and there is other questions and answers about this topic. But I tried many things, but nothing helped.The version of log4net we use is 1.2.13.0.I checked with FUSLOGVW.exe for binding errors. The log4net shows up with the added assembly and some Unknown assembly. The reference of log4net in the assembly shows version 1.2.13.0 which was added with NuGet. So it is probably a dependent assembly that is causing all this trouble.I tried changing log4net back to version 1.2.12.0, but I still get the same error message.When I run all the tests with MSTest testrunner, these errors show up. When I only run the failed tests, they pass. When I run them individually, they also pass.I tried binding redirection, but I did it for the assembly that is tested not the testing assembly. I did not know how to do that for a test assembly - there is no config.When I run the tests with Resharper test runner they also pass (but other tests fail). The TFS Build server runs the MSTest-runner, therefore I need to get it working with MSTest.Does anyone know how I can get this resolved? <code> ",System.IO.FileLoadException: Could not load file or assembly Log4net
How to navigate links by button in Modern UI in C#," I am using ModernUI. I have one issue with Button and link.I am trying to navigate by Button Click event and my code in ""Home.xaml"" is as follow mui:Link works fine in MainWindows.xaml for navigation. but I want to navigate to AddGame.xaml from Home.xaml Page by a Button, which is in Home.xaml page.My file structure is as below, for reference. So please let me know, where am i doing wrong? <code>  private void addGameButton_Click(object sender, RoutedEventArgs e){ BBCodeBlock bs = new BBCodeBlock(); try { bs.LinkNavigator.Navigate(new Uri(""pack://application:/Pages/AddGame.xaml""), null); } catch (Exception error) { ModernDialog.ShowMessage(error.Message, FirstFloor.ModernUI.Resources.NavigationFailed, MessageBoxButton.OK); }}",How to navigate links by button in WPF Modern UI in C#?
How to navigate links by button in WPF Modern UI in C#," I am using ModernUI. I have one issue with Button and link.I am trying to navigate by Button Click event and my code in ""Home.xaml"" is as follow mui:Link works fine in MainWindows.xaml for navigation. but I want to navigate to AddGame.xaml from Home.xaml Page by a Button, which is in Home.xaml page.My file structure is as below, for reference. So please let me know, where am i doing wrong? <code>  private void addGameButton_Click(object sender, RoutedEventArgs e){ BBCodeBlock bs = new BBCodeBlock(); try { bs.LinkNavigator.Navigate(new Uri(""pack://application:/Pages/AddGame.xaml""), null); } catch (Exception error) { ModernDialog.ShowMessage(error.Message, FirstFloor.ModernUI.Resources.NavigationFailed, MessageBoxButton.OK); }}",How to navigate links by button in WPF Modern UI in C#?
Deserialize XML to object (C# .NET)," I have requirement to process certain xml, having trouble deserializing a list of objects from it. Following is the xml: Following is my class And finally, calling to deserialize It doesn't return any errors, just empty item in the catalog object.  <code>  <catalog><item> <id>18338517</id> <note label=""Name "">Gear xyz</note> <note label=""Size "">10</note> <note label=""Source"">Store xyz</note> <relation weight=""100""> <type>External</type> <id>123</id> <name>Mcday</name> </relation> <relation weight=""99""> <type>Internal</type> <id>234</id> <name>Mcnight</name> </relation></item> <item> ..... </item></catalog> [XmlRoot(""catalog"")]public class Catalog{ [XmlArray(""item"")] [XmlArrayItem(""item"", typeof(Item))] public Item[] item{ get; set; }}[XmlRoot(""item"")]public class Item{ [XmlElement(""id"")] public string id { get; set; } [XmlArrayItem(""note"", typeof(Note))] public Note[] note { get; set; } [XmlArrayItem(""relation"", typeof(Relation))] public Relation[] relation { get; set; }}[Serializable]public class Note{ [XmlAttribute(""label"")] public string label { get; set; } [XmlText] public string Value { get; set; }}[Serializable]public class Relation{ [XmlAttribute(""weight"")] public string weight { get; set; } [XmlText] public string Value { get; set; } [XmlElement(""id"")] public string id { get; set; } [XmlElement(""type"")] public string type { get; set; } [XmlElement(""name"")] public string name { get; set; }} Catalog catalog = null;XmlSerializer mySerializer = new XmlSerializer(typeof(Catalog));using (TextReader reader = new StreamReader(@""D:\TEMP\deserialize xml\catalog.xml"")){ catalog = (Catalog)mySerializer.Deserialize(reader);}",Missing child nodes when deserializing XML to object
Binding Validation.HasError property on another property in my viewmodel," I am currently implementing a ValidationRule to check if some invalid character are in a TextBox. I am happy that setting the class I have implemented that inherits ValidationRule on my TextBox sets it in red when such characters are found, but I would also like to use the Validation.HasError property or the Validation.Errors property to pop a messagebox telling the user that there are errors in the various textboxes in the page. Is there a way to bind a property in my ViewModel to the Validation.HasError and/or to the Validation.Errors properties in order for me to have access to them in my ViewModel?Here is my error style for the TextBox: Here is how I declare my TextBox (OneTextBox encapsulates the regular WPF TextBox) in my XAML: <code>  <Style x:Key=""ErrorValidationTextBox"" TargetType=""{x:Type pres:OneTextBox}""> <Setter Property=""Validation.ErrorTemplate""> <Setter.Value> <ControlTemplate> <DockPanel LastChildFill=""True""> <TextBlock DockPanel.Dock=""Right"" Foreground=""Red"" FontSize=""12pt"" Text=""{Binding ElementName=MyAdorner, Path=AdornedElement.(Validation.Errors)[0].ErrorContent}""> </TextBlock> <AdornedElementPlaceholder x:Name=""MyAdorner""/> </DockPanel> </ControlTemplate> </Setter.Value> </Setter></Style> <pres:OneTextBox Watermark=""Name..."" Margin=""85,12,0,0"" Style=""{StaticResource ErrorValidationTextBox}"" AcceptsReturn=""False"" MaxLines=""1"" Height=""22"" VerticalAlignment=""Top"" HorizontalAlignment=""Left"" Width=""300"" > <pres:OneTextBox.Text> <Binding Path=""InterfaceSpecification.Name"" UpdateSourceTrigger=""PropertyChanged""> <Binding.ValidationRules> <interfaceSpecsModule:NoInvalidCharsRule/> </Binding.ValidationRules> </Binding> </pres:OneTextBox.Text> </pres:OneTextBox>",Binding Validation.HasError property in MVVM
C# How to do Network discovery using UDP Broadcast, I want to to do network discovery using UDP Broadcast in C#. I don't know how to do this. Can you give me advice on how to do it?I want to do like this tutorial. <code> ,How to do Network discovery using UDP broadcast
.NET C# Deserializing Data from Web service," I'm receiving data from a web service. The data are in the following format: I need to parse the input.Can you advise me what format is this and what is the easiest way to parse them?...I can parse by splitting the string by ';' and to search the individual elements for the wanted key and the following value. (possible, but bad solution)Probably the data are serialized in a standard format and can be deserialized in a dictionary. <code>  a:5:{s:7:""request"";s:14:""94.190.179.118"";s:6:""status"";i:206;s:12:""currencyCode"";s:3:""BGL"";}",Deserializing PHP Data from Web service
Deserializing Data from Web service," I'm receiving data from a web service. The data are in the following format: I need to parse the input.Can you advise me what format is this and what is the easiest way to parse them?...I can parse by splitting the string by ';' and to search the individual elements for the wanted key and the following value. (possible, but bad solution)Probably the data are serialized in a standard format and can be deserialized in a dictionary. <code>  a:5:{s:7:""request"";s:14:""94.190.179.118"";s:6:""status"";i:206;s:12:""currencyCode"";s:3:""BGL"";}",Deserializing PHP Data from Web service
WPF Datagrid Selected Items Binding for Multiple Items, How can I select multiple items from a DataGrid in an MVVM WPF project? <code> ,Select multiple items from a DataGrid in an MVVM WPF project
WPF Binding SelectedItems in MVVM, How can I select multiple items from a DataGrid in an MVVM WPF project? <code> ,Select multiple items from a DataGrid in an MVVM WPF project
C#: Must be a non abstract type with public parameterless constructor," I read the answers to some similar questions to mine but couldn't find a good explanation to my case. Please, correct me, if I'm wrong :)I have three classes - a base abstract class, called EmailData, and two other classes that derive from the base class. I have not included one of the inheriting classes and most of the members of the other classes to make the example more obvious. I have a generic class, that uses one of the two classes that derive from the base class EmailData, and looks like this: If I decide to make a new instance of the Email class: I get the following error: When I add a parameterless constructor to both the base and derived classes, the error no longer shows up. The problem is that I don't need a parameterless constructor, but one that receives a DataTable object.So, does anyone know what is wrong with this? <code>  private abstract class EmailData { public EmailData(DataRow emailDataRow) { vehicleOwner = emailDataRow[""owner""].ToString(); } public string VehicleOwner { get { return vehicleOwner; } } private string vehicleOwner; } private class DeliveryEmailData : EmailData { public DeliveryEmailData(DataRow deliveryData) : base(deliveryData) { orderNumber = deliveryData[""ordernumber""].ToString(); } public string OrderNumber { get { return orderNumber; } } private string orderNumber; } private class Email<T> where T : EmailData, new() { public Email(DataTable emailDataTable) { // Get the number of rows. int rowsNumber = emailDataTable.Rows.Count; emailsData = new T[rowsNumber]; for (int i = 0; i < rowsNumber; i++) { // Store the appropriate data in the arrays. emailsData[i] = (T)Activator.CreateInstance(typeof(T), emailDataTable.Rows[i]); } // Get the email of the recipient. recipientEmail = emailDataTable.Rows[0][""delivery_email""].ToString(); } public T[] EmailsData { get { return emailsData; } } public string RecipientEmail { get { return recipientEmail; } } private T[] emailsData; private string recipientEmail; } Email<DeliveryEmailData> email = new Email<DeliveryEmailData>(someDataTableObject); 'DeliveryEmailData' must be a non-abstract type with a public parameterless constructor in order to use it as parameter 'T'",Must be a non abstract type with public parameterless constructor
lambda expression join multiple tables with select and where cluser," I have three table many to many relationship I have joined the three table and select the value I want but now I need to select one row from the query result by where by specifying the id this is my three table And this is the query using LINQ lambda expression : the result will be like that using sql query sql query result of the sql query now i use anther sql query to filter the result of previews sql query by where and set the condition to where u.UserId = 1 to only give me back the user with the id 1 like that and the result of this sql query so how can i add the where clause to my lambda expression to give me the same result as the result of the sql query and thanks for any help  <code>  DataBaseContext db = new DataBaseContext();public ActionResult Index(){ var UserInRole = db.UserProfiles. Join(db.UsersInRoles, u => u.UserId, uir => uir.UserId, (u, uir) => new { u, uir }). Join(db.Roles, r => r.uir.RoleId, ro => ro.RoleId, (r, ro) => new { r, ro }) .Select(m => new AddUserToRole { UserName = m.r.u.UserName, RoleName = m.ro.RoleName }); return View(UserInRole.ToList());} select * from UserProfile u join webpages_UsersInRoles uir on u.UserId = uir.UserId join webpages_Roles r on uir.RoleId = r.RoleId select * from UserProfile u join webpages_UsersInRoles uir on u.UserId = uir.UserId join webpages_Roles r on uir.RoleId = r.RoleId where u.UserId = 1",lambda expression join multiple tables with select and where clause
lambda expression join multiple tables with select and where cluser," I have three table many to many relationship I have joined the three table and select the value I want but now I need to select one row from the query result by where by specifying the id this is my three table And this is the query using LINQ lambda expression : the result will be like that using sql query sql query result of the sql query now i use anther sql query to filter the result of previews sql query by where and set the condition to where u.UserId = 1 to only give me back the user with the id 1 like that and the result of this sql query so how can i add the where clause to my lambda expression to give me the same result as the result of the sql query and thanks for any help  <code>  DataBaseContext db = new DataBaseContext();public ActionResult Index(){ var UserInRole = db.UserProfiles. Join(db.UsersInRoles, u => u.UserId, uir => uir.UserId, (u, uir) => new { u, uir }). Join(db.Roles, r => r.uir.RoleId, ro => ro.RoleId, (r, ro) => new { r, ro }) .Select(m => new AddUserToRole { UserName = m.r.u.UserName, RoleName = m.ro.RoleName }); return View(UserInRole.ToList());} select * from UserProfile u join webpages_UsersInRoles uir on u.UserId = uir.UserId join webpages_Roles r on uir.RoleId = r.RoleId select * from UserProfile u join webpages_UsersInRoles uir on u.UserId = uir.UserId join webpages_Roles r on uir.RoleId = r.RoleId where u.UserId = 1",lambda expression join multiple tables with select and where clause
Exception at initialization of DateTime in C#," I am initialiting DateTime variable in the parameters of a controller action as below There is no error at compile time but an exception occurred during runtime. Stack Trace: <code>  public ActionResult ForFahrzeug(DateTime initDat = default(DateTime), long id = 0, long days = 0, string ExpGnr = """") { //body } Server Error in '/' Application.Encountered an invalid type for a default value.Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.Exception Details: System.FormatException: Encountered an invalid type for a default value. [FormatException: Encountered an invalid type for a default value.]System.Reflection.MdConstant.GetValue(MetadataImport scope, Int32 token, RuntimeTypeHandle fieldTypeHandle, Boolean raw) +10764128System.Reflection.RuntimeParameterInfo.GetDefaultValueInternal(Boolean raw) +413System.Reflection.RuntimeParameterInfo.GetDefaultValue(Boolean raw) +31System.Reflection.RuntimeParameterInfo.get_DefaultValue() +6System.Web.Mvc.ParameterInfoUtil.TryGetDefaultValue(ParameterInfo parameterInfo, Object& value) +64System.Web.Mvc.ReflectedParameterDescriptor.get_DefaultValue() +59System.Web.Mvc.ControllerActionInvoker.GetParameterValue(ControllerContext controllerContext, ParameterDescriptor parameterDescriptor) +541System.Web.Mvc.ControllerActionInvoker.GetParameterValues(ControllerContext controllerContext, ActionDescriptor actionDescriptor) +199System.Web.Mvc.Async.<>c__DisplayClass25.<BeginInvokeAction>b__1e(AsyncCallback asyncCallback, Object asyncState) +978System.Web.Mvc.Async.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout) +161System.Web.Mvc.Async.AsyncResultWrapper.Begin(AsyncCallback callback, Object state, BeginInvokeDelegate beginDelegate, EndInvokeDelegate`1 endDelegate, Object tag, Int32 timeout) +92System.Web.Mvc.Async.AsyncResultWrapper.Begin(AsyncCallback callback, Object state, BeginInvokeDelegate beginDelegate, EndInvokeDelegate`1 endDelegate, Object tag) +53System.Web.Mvc.Async.AsyncControllerActionInvoker.BeginInvokeAction(ControllerContext controllerContext, String actionName, AsyncCallback callback, Object state) +538System.Web.Mvc.<>c__DisplayClass1d.<BeginExecuteCore>b__17(AsyncCallback asyncCallback, Object asyncState) +83System.Web.Mvc.Async.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout) +161System.Web.Mvc.Async.AsyncResultWrapper.Begin(AsyncCallback callback, Object state, BeginInvokeDelegate beginDelegate, EndInvokeDelegate`1 endDelegate, Object tag, Int32 timeout) +92System.Web.Mvc.Async.AsyncResultWrapper.Begin(AsyncCallback callback, Object state, BeginInvokeDelegate beginDelegate, EndInvokeDelegate endDelegate, Object tag, Int32 timeout) +97System.Web.Mvc.Async.AsyncResultWrapper.Begin(AsyncCallback callback, Object state, BeginInvokeDelegate beginDelegate, EndInvokeDelegate endDelegate, Object tag) +53System.Web.Mvc.Controller.BeginExecuteCore(AsyncCallback callback, Object state) +531System.Web.Mvc.Async.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout) +161System.Web.Mvc.Async.AsyncResultWrapper.Begin(AsyncCallback callback, Object state, BeginInvokeDelegate beginDelegate, EndInvokeDelegate`1 endDelegate, Object tag, Int32 timeout) +92System.Web.Mvc.Async.AsyncResultWrapper.Begin(AsyncCallback callback, Object state, BeginInvokeDelegate beginDelegate, EndInvokeDelegate endDelegate, Object tag, Int32 timeout) +97System.Web.Mvc.Async.AsyncResultWrapper.Begin(AsyncCallback callback, Object state, BeginInvokeDelegate beginDelegate, EndInvokeDelegate endDelegate, Object tag) +53System.Web.Mvc.Controller.BeginExecute(RequestContext requestContext, AsyncCallback callback, Object state) +447System.Web.Mvc.Controller.System.Web.Mvc.Async.IAsyncController.BeginExecute(RequestContext requestContext, AsyncCallback callback, Object state) +49System.Web.Mvc.<>c__DisplayClass8.<BeginProcessRequest>b__2(AsyncCallback asyncCallback, Object asyncState) +127System.Web.Mvc.Async.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout) +161System.Web.Mvc.Async.AsyncResultWrapper.Begin(AsyncCallback callback, Object state, BeginInvokeDelegate beginDelegate, EndInvokeDelegate`1 endDelegate, Object tag, Int32 timeout) +92 System.Web.Mvc.Async.AsyncResultWrapper.Begin(AsyncCallback callback, Object state, BeginInvokeDelegate beginDelegate, EndInvokeDelegate endDelegate, Object tag, Int32 timeout) +97System.Web.Mvc.Async.AsyncResultWrapper.Begin(AsyncCallback callback, Object state, BeginInvokeDelegate beginDelegate, EndInvokeDelegate endDelegate, Object tag) +53System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContextBase httpContext, AsyncCallback callback, Object state) +388System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContext httpContext, AsyncCallback callback, Object state) +88System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.BeginProcessRequest(HttpContext context, AsyncCallback cb, Object extraData) +50System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +301System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +155",Exception at initialization of DateTime
using inheritance and generic constrain in C#," I have this scenario: I want a constrain of type Person like and I want A to inherit from B too.example: or how can I do it? <code>  class A<T> class A<T> where T: Person class A<T> : B : where T: Person class A<T> where T: Person, B",Both a generic constraint and inheritance
Using OR with generic constraints," I have this scenario: I want a constrain of type Person like and I want A to inherit from B too.example: or how can I do it? <code>  class A<T> class A<T> where T: Person class A<T> : B : where T: Person class A<T> where T: Person, B",Both a generic constraint and inheritance
MSMQ via C# - ACK that operation has succeed?," I'm sending a message to a private queue via c# : It does work and I do see the message in the queue.However, is there any way to get an ACK whether the message got to the queue with success ?psBeginPeek and PeekCompleted is an event which is raised when a message becomes available in the queue or when the specified interval of time has expired. it is not helping me because I need to know if the message that I sent was received by msmq. BeginPeek will be raised also if someone else entered a message to the queue. and the last thing I want is to check via BeginPeek - from who this message comes from.How can I do that?ps2Or maybe I don't have to worry since msgQ.Send(msg); will raise an exception if a message wasn't inserted....? <code>  MessageQueue msgQ = new MessageQueue(@"".\private$\aaa"");msgQ.Formatter = new XmlMessageFormatter(new[] { typeof (String) });msgQ.Send(msg);",MSMQ via C# - ACK that message received?
MSMQ via C# - ACK that message recieved?," I'm sending a message to a private queue via c# : It does work and I do see the message in the queue.However, is there any way to get an ACK whether the message got to the queue with success ?psBeginPeek and PeekCompleted is an event which is raised when a message becomes available in the queue or when the specified interval of time has expired. it is not helping me because I need to know if the message that I sent was received by msmq. BeginPeek will be raised also if someone else entered a message to the queue. and the last thing I want is to check via BeginPeek - from who this message comes from.How can I do that?ps2Or maybe I don't have to worry since msgQ.Send(msg); will raise an exception if a message wasn't inserted....? <code>  MessageQueue msgQ = new MessageQueue(@"".\private$\aaa"");msgQ.Formatter = new XmlMessageFormatter(new[] { typeof (String) });msgQ.Send(msg);",MSMQ via C# - ACK that message received?
"SignalR only works on localhost, even when using asterisk in URL: ERR_NETWORK_CHANGED"," Edit/SummaryAfter a lot of trial and error, Paul Kearney - pk helped lead me to the answer, although I still don't know why this happens, at least I know how to get it to work.Quick Summary: Clients can connect to port 8080 on my laptop when I'm directly connected to my network at work. Clients cannot connect to port 8080 when I'm on a home network. To solve this, I created a firewall rule (on my laptop) to allow inbound traffic on 8080. I'd really like to know why this is the case. Does my laptop's Windows Firewall service actually change its settings based on the network I'm connected to?Note: This all works when I'm on my network at work, but it doesn't work on my home network, or someone else's home network. The host computer (my laptop) is the same at both locations.I have a web app that uses SignalR. Everything works when I run the web app on the same machine as where the SignalR host is running. When I try to connect from a different machine, I get this error: That error comes from my index.html page: From the research that I've done, I know that I shouldn't be using localhost in my SignalR URL. So I used an asterisk. This is in my self-hosted SignalR app: And this is my JavaScript to connect: Like I said, this all works locally. But it doesn't work from another machine. I do not have Windows Firewall enabled, so that's not the issue. Any ideas?HTTPS didn't work. It works when I'm on my network at work, but not at home. The configuration is the same. Must have something to do with my home network.Also, this is what the page looks like when it's working properly:And this is what happens when it's not working: <code>  > GET http://10.0.0.13:8080/signalr/hubs net::ERR_CONNECTION_TIMED_OUT. Cannot read property 'client' of undefined. <script src=""http://10.0.0.13:8080/signalr/hubs""></script> class Program{ static void Main(string[] args) { string url = ""http://*:8080""; using (WebApp.Start(url)) { Console.WriteLine(""Server running on {0}"", url); Console.ReadLine(); } }}class Startup{ public void Configuration(IAppBuilder app) { app.UseCors(CorsOptions.AllowAll); app.MapSignalR(); }}public class RaceHub : Hub{ public void Send(string name, string message) { Clients.All.addMessage(name, message); }} var signalRUrl = 'http://10.0.0.13:8080/signalr'; $.connection.hub.url = signalRUrl; var hub = $.connection.raceHub; // proxy reference to hub // Create a function that the hub can call to broadcast messages. hub.client.addMessage = function (name, message) { receiveSignalRMessage(name, message); }; $.connection.hub.start(); // Start the connection.",SignalR on Home Network
Why can't I give a default value my optional parameter except null?," I want to have a optional parameter and set it to default value that I determine, when I do this: I'm getting the following error (Foo is a class): 'f' is type of Foo, A default parameter of a reference type other than string can only be initialized with null.If I change Foo to struct then it works but with only default parameterless constructor.I read the documentation and it's clearly states that I cannot do this but it doesn't mention why?, Why is this restriction exists and why string is excluded from this? Why the value of an optional parameter has to be compile-time constant? If that wouldn't be a constant then what would be the side-effects ? <code>  private void Process(Foo f = new Foo()){}",Why can't I give a default value as optional parameter except null?
Create a dynamic alert box in ASP.net C# using a database listener without a button click," How to create dynamic alert box in ASP.net C# using a database listener which can be triggered without using a button click?I have a ASP.NET web site and I need to create a custom alert box which can be triggered without using a button click but using a database listener.(I'm using PostgreSQL database.) since I'm new to ASP.NET C# i have no idea how to create it. this alert box should pop up while we are browsing through the website and whenever database updated by a particular value which is updated in the database by a external process. What I want to know is how to create a database listener in ASP.NET, if you have example codes, please be kind enough to share that. <code> ",Dynamic alert box in ASP.net C#
Create a dynamic alert box in ASP.net C# using a database listener which can be triggered without using a button click," How to create dynamic alert box in ASP.net C# using a database listener which can be triggered without using a button click?I have a ASP.NET web site and I need to create a custom alert box which can be triggered without using a button click but using a database listener.(I'm using PostgreSQL database.) since I'm new to ASP.NET C# i have no idea how to create it. this alert box should pop up while we are browsing through the website and whenever database updated by a particular value which is updated in the database by a external process. What I want to know is how to create a database listener in ASP.NET, if you have example codes, please be kind enough to share that. <code> ",Dynamic alert box in ASP.net C#
What is tracepoint used for?, They can only be placed on method names. How are they used and what are they for? <code> ,What are tracepoints used for?
Entity Framework: Are your code-first classes your domain classes?," I'm not sure I can even articulate this properly but...I'm starting to architect a solution using code-first Entity Framework and am beginning to get the feeling I'm polluting my domain classes (the classes EF will use to generate the DB) with too much DB-specific information: I have to make certain methods virtual in order that lazy loading can occur, I'm adding attributes clearly aimed at DB configuration to my properties, and so on. I'm also concerned about how pervasive these classes are going to be throughout the project.Firstly, am I making sense and/or am I fundamentally misunderstanding how EF should be used? Secondly, if I'm understanding this right, my question is: does anyone else make a distinction between their code-first classes used to generate their DB and their domain classes (perhaps using an auto-mapper to populate one from the other)? <code> ",Are your code-first classes your domain classes?
.NET Where() and ToList(). What does it do?," I was wondering what exactly the Where() and ToList() methods are doing. Specifically I was wondering if the Where() will create a new object in memory or return a new object. Ok, looking at the following code, say I have a skeleton log class. In my business logic, say I only want logs created or modified by a certain user. This is going to be accomplished with a method: FilterLogsAccordingToUserId(). In this situation, is Where() modifying the IEnumerable<Log> by removing all objects that don't match the condition, or is it grabbing all objects, casting that object to a list in memory, and then return that new object?If it is the second possibility, am I right to be concerned about performance if a sufficiently large list of logs is passed to the function? <code>  public class Log(){ public string Log {get;set;} public string CreatedByUserId {get;set;} public string ModifiedUserId {get;set;}} public IEnumerable<Log> FilterLogsAccordingToUserId(IEnumerable<Log> logs, string userId){ int user = int.Parse(userId); return logs.Where(x => x.CreatedByUserId.Equals(user) || x.ModifiedByUserId.Equals(user)).ToList();}",IEnumerable Where() and ToList() - What do they really do?
WPF Listbox remove selection by clicking on a blank spot," I have a wpf listbox with a custom item template which contains a rectangle.The each item in the listbox can be selected (only one at a time).I want to add a behavior in which when a user clicks on a place which isn't the item (for instance, a blank spot on the listbox, which is not an item), the selected item will become deselected.Any ideas?Thanks.For example with a simple listbox: item 1 item 2 The behavior that I'm looking for is when the user clicks on pixel 500 (which is a part of the listbox but not on an item), the currently selected item will be deselected.  <code> ",WPF Listbox remove selection by clicking on blank space
AssemblyTitle attribute (.NET Framework)," What is the practical use of the AssemblyTitle attribute? MSDN says that it specifies a description for an assembly and that the assembly title is a friendly name which can include spaces.Visual Studio asks for the assembly name in the properties window of the project along with the default namespace. There is an AssemblyName attribute but it describes an assembly's unique identity in full (i.e., culture, etc.). I don't see how AssemblyTitle differs from AssemblyProduct.I used the IL Disassembler to see how Microsoft uses AssemblyTitle. I discovered that in mscorlib.dll, AssemblyTitle, AssemblyProduct and AssemblyDefaultAlias are all set to ""mscorlib.dll"".In conclusion, what I really would like to see are practical examples of the use of AssemblyTitle. <code> ",'AssemblyTitle' attribute in the .NET Framework
C# Nested Using statements best practice," I have a code block as follows and I'm using 3 nested using blocks. I found that using try finally blocks I can avoid this but if there are more than two using statements, what is the best approach? <code>  private FileStream fileStream = null;private Document document = null;private PdfWriter pdfWriter = null;using (fileStream = new FileStream(""ABC.pdf"", FileMode.Create)){ using (document = new Document(PageSize.A4, marginLeft, marginRight, marginTop, marginBottom)) { using (pdfWriter = PdfWriter.GetInstance(document, fileStream)) { document.AddAuthor(metaInformation[""author""]); document.AddCreator(metaInformation[""creator""]); document.AddKeywords(""Report Generation using I Text""); document.AddSubject(""Document subject""); document.AddTitle(""The document title""); } }}",Best practice for nested using statements?
Using PHP SOAP webservice in C#," I am working on windows phone project in visual studio 2012 for windows phone.I am trying use PHP NuSOAP webservice by adding Service reference.Here I followed this sample app. In general the VS will create Reference.cs file while adding webservice. You can see reference.cs file contents of dictionary(Sample) app HEREThe Reference.cs of my webservice of my project HERE. In my Reference.cs file the interface SomeMobileServicePortType is empty. In Line 19. Because of this I not getting any methods of webservice to access in my project. But while adding reference in Add service Refernce dialogue it is showing the methods contains in PHP NuSOAP webservice. I created new instance of webservice class.. What is the wrong with PHP webservice. I tried some more webservices [in particular asmx, I didn't get any sample PHP NuSOAP webservice to try] which are working fine. Can any one tell me How to use PHP NuSOAP service using C#.==================================================================================Edit:We are using NuSOAP PHP webservice. I believe that there is no problem with Webservice. I can't share the WSDL file right now.Here I got the sample that explains using PHP NuSOAP in C#. I tried with this webservice link. This reference also not giving any methods. The interface is empty like this. So my guess is while using NuSOAP service it is not working in IDE Visual Studio.Here is my sample windows phone project. Please try this & suggest me what I am doing wrong. <code>  public interface SomeMobileServicePortType {} ServiceReference1.SomeMobileServicePortTypeClient client = new ServiceReference1.SomeMobileServicePortTypeClient(); public interface HirdWebExamplePortType { }",Using PHP nuSOAP webservice in C#
ASP.NET Error: Parser Error Message: Could not load type 'webmarketing'," After finishing the web application and publishing it online no matter I try I keep getting the following error, keep in mind that it runs locally as it should... Parser Error Message: Could not load type 'webmarketing'.I ran through that solution though supposedly I'm doing the same as the solution, yet I'm still facing the same issue...ASP.NET Parser Error Cannot load code behindHere is the code behind: <code>  using System;using System.Collections.Generic;using System.Linq;using System.Web;using System.Web.UI;using System.Web.UI.WebControls;namespace webmarketing{ public partial class Masterpage : System.Web.UI.MasterPage { protected void Page_Load(object sender, EventArgs e) { string admin = (string)Session[""Admin""]; if (string.IsNullOrEmpty(admin)) { logout.Visible = false; } else { } } }}",Parser Error Message: Could not load type 'webmarketing'
In C# why does using parameterized queries or entity framework prevent sql injection," I've got a good grasp on SQL injection. It's when a SQL query that is supposed to be something like Gets turned into a query like When the user inserts a malicious value into your app, website, client, whatever.. I'm also aware that instead of just dropping the DB the attacker can try to discover the names of tables and get info out of them.I also know some things that help prevent this are:Using stored procedures which take parameters (SQL Server)Using parametrized SQL queriesUsing Entity Framework / LINQ to Entities (C#, maybe F#?)How do these things actually prevent SQL injection from occurring? Why can't the attacker just pass the same malicious value into whatever input he or she is already using and have the same result. <code>  SELECT FirstName, LastName FROM Customers WHERE CustomerId = @valueFromApplication SELECT FirstName, LastName FROM Customers WHERE CustomerId = '' ; DROP DATABASE Foo --",Why does using parameterized queries or entity framework prevent sql injection?
C# Download from fake(?) URL," I'm working on batch downloader but some URLs are not sending data correctly.For example, this page: http://i.imgbox.com/absMQK6A.pngIn any internet browser, this page shows an image, but in my program, downloads strange data.I think this URL is fake or protected (I don't know HTML well.)BTW, in IE, I can download that image normally with right click and save as image.so I want to emulate that behavior in my program.How can I do this?Below is part of my program's code. UserAgent is string that has informations of browser.such as IE, Firefox etc.Thanks. <code>  HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(DownloadAddress);if (Proxy != null){ request.Proxy = Proxy;}if (!string.IsNullOrWhiteSpace(UserAgent)){ request.UserAgent = UserAgent;}HttpWebResponse response = (HttpWebResponse)request.GetResponse();Stream downloadHttpStream = response.GetResponseStream();int read = downloadHttpStream.Read(buffer, 0, buffer.Length);// output codes",C# Download Image from unknown format
Extendind List<T> and Violating The Open/Closed Principle," I just created the following method in one of my classes And a friend of mine, reviewing my code, said that I shouldn't create methods that 'extend the List class', since that violates the open/closed principle.If I want to extend the class List I should create a new class that inherits from List and implement my ""merge"" method in that new class.Is he right? Extending the List class violates the Open/Closed principle? <code>  public static bool Assimilate(this List<Card> first, List<Card> second){ // Trivial if (first.Count == 0 || second.Count == 0) { return false; } // Sort the lists, so I can do a binarySearch first.Sort(); second.Sort(); // Copia only the new elements int index; for (int i = 0; i < second.Count; i++) { index = first.BinarySearch(second[i]); if (index < 0) { first.Insert(~index, second[i]); } } // Edit second = null; return true;}",Extending List<T> and Violating The Open/Closed Principle
C# Type confusion," I'm currently working through the Pluralsight C# 5.0 course, and I'm relatively new to programming.I previously thought I understood the concept of Data Types on a basic level, Int/Array/Strings etc.In this course it starts to introduce C#'s huge emphasis on Types, and creating your own custom types.One of the course code snippets which I've included below, is refusing to sink in and I was hopingsomeone could provide some clarity or a different way of thinking about it.Program.cs: GradeStatistics.cs: Grades: I'm finding it particularly difficult to understand what exactly GradeStatistics is.In the course it is referred to as not only a class, but as a variable, and furthermore alsobeing returned as an object in Grades.Any clarity is appreciated, as I'm finding it a little difficult to follow with all of the above terms being thrown around. <code>  GradeStatistics stats = book.ComputeStatistics(); namespace Grades { public class GradeStatistics { public GradeStatistics() { HighestGrade = 0; LowestGrade = float.MaxValue; } public float AverageGrade; public float HighestGrade; public float LowestGrade; } } public GradeStatistics ComputeStatistics() { GradeStatistics stats = new GradeStatistics(); float sum = 0f; foreach (float grade in grades) { stats.HighestGrade = Math.Max(grade, stats.HighestGrade); stats.LowestGrade = Math.Min(grade, stats.LowestGrade); sum += grade; } stats.AverageGrade = sum / grades.Count; return stats; }","Type confusion: A type is class, a variable and an object?"
How to use filter of SaveFileDialoge," I have created Filter with this code: The problem is that every time I select any filter (Other than the selected one) it adds extension in the previous one. See Picture below: <code>  saveFileDialog1.FileName = ""SimplifiedLog"";saveFileDialog1.Filter = ""RichTextFormate | *.rtf |Text Files | *.txt |All Files| *.*"";saveFileDialog1.Title = ""Save Simplified KL File"";saveFileDialog1.ShowDialog();",How to use filter of SaveFileDialog
What is the difference of Stream and MemoryStream in C#, What is the main difference between Stream and MemoryStream in C#?If I need to create a Stream without a file shall I use a MemoryStream instead? <code> ,What is the difference of Stream and MemoryStream
C# Deserialize JSON with dynamic objects," I have a JSON object that comes with a long list of area codes. Unfortunately each area code is the object name on a list in the Data object. How do I create a class that will allow RestSharp to deserialize the content?Here's how my class looks now: And here's the JSON content: <code>  public class phaxioResponse{ public string success { get; set; } public string message { get; set; } public List<areaCode> data { get; set; } public class areaCode { public string city { get; set; } public string state { get; set; } }} { success: true message: ""277 area codes available."" data: { 201: { city: ""Bayonne, Jersey City, Union City"" state: ""New Jersey"" } 202: { city: ""Washington"" state: ""District Of Columbia"" } [...]}",Deserialize JSON with dynamic objects
C# random generation with very low chances, I'm trying to get a random bool in C# for a scientific project. The problem is that the chance of the bool being true must be around 10^-12 to 10^-14; the default random function only generates ints and a value between 0 and [u]int.max is far to small. How can I generate a random boolean value with such a low chance of being true? <code> ,Random generation with very low chances
Peformance between Iterating through IEnumerable<T> and List<T>," Today, I faced a problem with performance while iterating through a list of items. After done some diagnostic, I finally figured out the reason which slowed down performance. It turned out that iterating through an IEnumerable<T> took much more time than iterating through a List<T>. Please help me understand why IEnumerable<T> is slower than List<T>.UPDATE benchmark context:I'm using NHibernate to fetch a collection of items from a database into an IEnumerable<T> and sum its property's value. This is just a simple entity without any reference type: <code>  public SimpleEntity{ public int Id {get;set} public string Name {get;set} public decimal Price {get;set}}Public Test{ void Main() { //this query get a list of about 200 items IEnumerable<SimpleEntity> entities = from entity in Session.Query<SimpleEntity> select entity; decimal value = 0.0; foreach(SimpleEntity item in entities) { //this for loop took 1.5 seconds value += item.Price; } List<SimpleEntity> lstEntities = entities.ToList(); foreach(SimpleEntity item in lstEntities) { //this for loop took less than a milisecond value += item.Price; } }}",Performance between Iterating through IEnumerable<T> and List<T>
VB.NET equivalent of C# object initializer," I'm not experienced with advanced features of .NET type system. I cannot find out of what type is zz (what can be written instead of var. Or is var the best choice here?) but most importantly, how the equivalent can be achieved in VB.NET code (this is what I actually need). I have searched several C# sources, used code watches and learned about how zz looks internally but I'm unable to make next step.(The purpose of my effort is something like this in VB.NET.) <code>  string foo = ""Bar"";int cool = 2;var zz = new { foo, cool }; // Watches show this is Anonymous Type Dim Foo As String = ""Bar""Dim Cool As Integer = 2Dim zz = {Foo, Cool} 'This is not an equivalent of above, I'm getting an array",VB.NET equivalent of C# object initializer of an anonymous type
"C#, How to disable the aero shake for whole system?"," I created a simple WPF application for enable and disable the aero shake behavior. My code is like this: Why my code does not function?What this application do now:When I shake my window, the others windows are minimized.What I want to do:When I shake my window, or I shake any window, no window should be minimized. <code>  using System.Windows;using System.Runtime.InteropServices;namespace TestDisableShaking{ public partial class MainWindow : Window { const uint DWM_EC_DISABLECOMPOSITION = 0; const uint DWM_EC_ENABLECOMPOSITION = 1; [DllImport(""dwmapi.dll"", EntryPoint = ""DwmEnableComposition"")] extern static uint DwmEnableComposition(uint compositionAction); [DllImport(""dwmapi.dll"", EntryPoint = ""DwmEnableComposition"")] protected static extern uint Win32DwmEnableComposition(uint uCompositionAction); public MainWindow() { InitializeComponent(); DwmEnableComposition(DWM_EC_DISABLECOMPOSITION); Win32DwmEnableComposition(DWM_EC_DISABLECOMPOSITION); } }}",How to disable the aero shake for whole system?
Returning two strings in a function in c#," Consider: I want to return both strings: text and color, but I am not sure what the problem is.Error @ return statement:(parameter) ? text/color Cannot convert lambda expression to type 'string' because it is not a delegate type <code>  protected string Active_Frozen(string text, string color){ connection(); string query = ""SELECT CustomerInfo FROM ActiveSubscription WHERE UserName=@UserName""; SqlCommand cmd = new SqlCommand(query, conn); if(query==""true"") { text = ""Active""; color = ""Green""; } else { text = ""Frozen""; color= ""Red""; } return (text, color);}",Returning two strings in a function in C#
MVC 5 C# application with EF 6.1 can't scaffold items," I created an MVC 5 application in VS 2013 Professional and then used EF 6.1 code first with an existing DB on SQL Server Express. When I try to create the views Im using the New scaffolded item then selecting the MVC 5 controller with views, using Entity Framework. I select the model and context classes and click OK. Then the following error message appears and no code is created. Ive uninstalled EF Power Tools with the same error.Error There was an error running the selected code generator: Exception has been thrown by the target of an invocation.I've also tried uninstalling/reinstalling VS 2013 and SQL Server with no changes.Any other ideas about what might cause this error? <code> ",Application can't scaffold items
JSON Serialize Properties With Data Only," Is it possible to serialize an object to JSON but only those properties with data?For example: The employee object will be serialized as: The boss object will be serialized as: Thanks! <code>  public class Employee{ [JsonProperty(PropertyName = ""name"")] public string Name { get; set; } [JsonProperty(PropertyName = ""id"")] public int EmployeeId { get; set; } [JsonProperty(PropertyName = ""supervisor"")] public string Supervisor { get; set; }}var employee = new Employee { Name = ""John Doe"", EmployeeId = 5, Supervisor = ""Jane Smith"" };var boss = new Employee { Name = ""Jane Smith"", EmployeeId = 1 }; { ""id"":""5"", ""name"":""John Doe"", ""supervisor"":""Jane Smith"" } { ""id"":""1"", ""name"":""Jane Smith"" }",Ignore Null Values When Serializing JSON
Batchify long Linq operations in C#?," I asked a question and got answered here about performance issues which I had a with a large collection of data. (created with linq)ok , let's leave it aside.But one of the interesting (and geniusly) optimization - suggested by Marc - was to Batchify the linq query. Here, the purpose of Batchify is to ensure that we aren't helping the server too much by taking appreciable time between each operation - the data is invented in batches of 1000 and each batch is made available very quickly.Now , I understand what it is doing , but I can't tell the difference since I might be missing the way it actually works. ( sometimes you think you know something...till...)OK , back to basics :AFAIK , Linq works like this chain : So, we can't start enumerating till the result of select in : was accomplished.So basically i'm waiting for select to have all correct data (after where , after orderby), and only then - my code can touch those values. (yielded from the select)But according to my understanding of Marc's answer , it seems that there is a gap between those yields which allows other resources to do something... (?)If so , then between each iteration of #4 , after line#9 , there is a time for CPU to do something else ? QuestionCan someone shed a light please ? how does this work ?nbI already know that( for example) select is nothing but: But if so , my code can't touch it till all values ( after where , orderby) were calculated... edit :For those who ask if there's difference: http://i.stack.imgur.com/19Ojw.jpg2 seconds for 1M items. 9 seconds for 5M items.(ignore the second line of time , (extra console.write line).)here it is for 5m list : http://i.stack.imgur.com/DflGR.jpg ( the first one is withBatchify , the other is not) <code>  /*1*/ static IEnumerable<T> Batchify<T>(this IEnumerable<T> source, int count)/*2*/ {/*3*/ var list = new List<T>(count);/*4*/ foreach(var item in source)/*5*/ {/*6*/ list.Add(item);/*7*/ if(list.Count == count)/*8*/ {/*9*/ foreach (var x in list) yield return x;/*10*/ list.Clear();/*11*/ }/*12*/ }/*13*/ foreach (var item in list) yield return item;/*14*/ } Where-->OrderBy-->Select public static IEnumerable<TResult> Select<TSource,TResult> (this IEnumerable<TSource> source, Func<TSource,TResult> selector){ foreach (TSource element in source) yield return selector (elem![enter image description here][3]ent);}",Batchify long Linq operations?
How can I make SQLite return a proper DateTime?," TLDR: The following code is run in the different databases, Oracle: select sysdate from dual SQLite select datetime('now') When doing Session.CreateSQLQuery(cmd).UniqueResult<DateTime>() the result is a DateTime when working against Oracle but a string when working against SQLite. It feels like a bug in the SQLite driver and a hack to check the returned type and do a DateTime.Parse() if it is a string. I could do that but are there any ways to have NHibernate return the correct type?I am trying to fetch current database time from the database. It works fine when using Oracle but when I try to do it against SQLite (in my unit tests) it breaks as the date returned is not a DateTime but a string.I've seen solutions using custom IUserType but I cannot see how I should use that in this case. Any suggestions? And I use the code above like this: <code>  using System;using System.Collections.Generic;using NHibernate;using NHibernate.Criterion;using NHibernate.Dialect.Function;namespace My.Common.Types { public class MyNHibernateDialectException : Exception { public MyNHibernateDialectException(string message) : base(message) { } } /// <summary> /// Define all custom functions here by name. It is important that when adding a new custom sql function, that function will work /// in all dialects supported. /// </summary> public static class MyDatabaseDialects { public enum Query { SysDate } /// <summary> /// Dialect implementations will use this function to verify that they all implement the same functions. /// </summary> /// <param name=""dialect""></param> public static void VerifyRegistrations(this NHibernate.Dialect.Dialect dialect) { // Verify that the required function are there foreach (var func in Enum.GetValues(typeof(Function))) { var enumName = func.ToString(); if (!dialect.Functions.ContainsKey(enumName)) { throw new MyNHibernateDialectException( string.Format(""The custom function '{0}' is not defined. Did you forget it in factory '{1}'?"", enumName, dialect)); } } } } /// <summary> /// An interface to reveal more advanced functionality that is database specific /// </summary> public interface IDialectExtensions { /// <summary> /// Fetch a query specfic for the current database. /// </summary> ISQLQuery GetQuery(ISession session, MyDatabaseDialects.Query query); /// <summary> /// Fetch a parameterized query specfic for the current database. /// </summary> ISQLQuery GetQuery(ISession session, MyDatabaseDialects.Query query, params object[] queryParams); } /// <summary> /// Class to store database specific objects except functions (which are supported by NHibernate). /// </summary> class DialectExtension { private readonly Dictionary<MyDatabaseDialects.Query, string> queryDictionary = new Dictionary<MyDatabaseDialects.Query, string>(); public ISQLQuery GetQuery(ISession session, MyDatabaseDialects.Query query) { return this.GetQuery(session, query, null); } public ISQLQuery GetQuery(ISession session, MyDatabaseDialects.Query query, params object[] queryParams) { var cmd = (queryParams == null) ? queryDictionary[query] : string.Format(queryDictionary[query], queryParams); return session.Session.CreateSQLQuery(cmd); } public void RegisterQuery(MyDatabaseDialects.Query query, string hqlString) { queryDictionary.Add(query, hqlString); } public void VerifyQueryRegistrations() { foreach (var query in Enum.GetValues(typeof(MyDatabaseDialects.Query))) { if (!queryDictionary.ContainsKey((MyDatabaseDialects.Query)query)) { throw new MyNHibernateDialectException(string.Format(""The custom query '{0}' is not defined."", query.ToString())); } } } } public class MyOracle10gDialect : NHibernate.Dialect.Oracle10gDialect, IDialectExtensions { private readonly DialectExtension dialectExtension = new DialectExtension(); public MyOracle10gDialect() { #region Dialect extensions dialectExtension.RegisterQuery(MyDatabaseDialects.Query.SysDate, @""select sysdate from dual""); dialectExtension.VerifyQueryRegistrations(); #endregion Dialect extensions } public ISQLQuery GetQuery(ISession session, MyDatabaseDialects.Query query) { return dialectExtension.GetQuery(session, query); } public ISQLQuery GetQuery(ISession session, MyDatabaseDialects.Query query, params object[] queryParams) { return dialectExtension.GetQuery(session, query, queryParams); } } public class MySqliteDialect : NHibernate.Dialect.SQLiteDialect, IDialectExtensions { private readonly DialectExtension dialectExtension = new DialectExtension(); public MySqliteDialect() { #region Dialect extensions dialectExtension.RegisterQuery(MyDatabaseDialects.Query.SysDate, @""select datetime('now')""); dialectExtension.VerifyQueryRegistrations(); #endregion Dialect extensions } public ISQLQuery GetQuery(ISession session, MyDatabaseDialects.Query query) { return dialectExtension.GetQuery(session, query); } public ISQLQuery GetQuery(ISession session, MyDatabaseDialects.Query query, params object[] queryParams) { return dialectExtension.GetQuery(session, query, queryParams); } }} /// <summary>/// Fetches a DialectExtensions object allowing us to have more advanced functionality that is database specific/// </summary>public static IDialectExtensions GetDialectExtensions(this IOperationContext operationContext) { return Session.GetSessionImplementation().Factory.Dialect as IDialectExtensions;}/// <summary>/// Get the database time by executing a raw SQL statement./// </summary>public static DateTime? GetDatabaseTime() { DateTime? result = null; try { result = GetDialectExtensions() .GetQuery(Session, MyDatabaseDialects.Query.SysDate) .UniqueResult<DateTime>(); } catch { // SQLite will throw exception here as the result is returned as a string instead of a DateTime } return result;}",How can I make SQLite return a proper DateTime when doing ISQLQuery.UniqueResult<DateTime>()?
Readonly Set-like interface," I am wondering if there is any set-like readonly interface that declares a Contains method in C#. I don't want to just implement the ISet interface because it has too many unnecessary methods.My idea implementation would be like thi: I can define my own IReadOnlySet, but want to ensure there is no built-in one before I do. <code>  public class PositiveInt : IReadOnlySet<Int32>{ public bool Contains(Int32 n){ return n > 0; }}public class CraEmployeeNames:IReadOnlySet<String>{ public bool Contains(String n){ return !String.IsNullOrWhiteSpace(n) && n.StartsWith(""Cra""); }} ",Is there a readonly ISet-like interface?
How to convert string to HTML safe string (C#)," I am creating a some dynamically generated HTML How can I ensure that whatever the company's name is, will appear as it should, but also if they try to inject any HTML in thier name it will simply appear in plain text.For instance if they tried to use the name ""<script>alert(""Do Bad!"")</script>"" that's exactly what will appear on the page, in plain text.But I also want to avoid ""A & C"" translating to ""A \u0026 C"", which is what happens when I use <code>  bldr.AppendLine(""<a>"");string userText = user.Company;bldr.AppendLine(userText);bldr.AppendLine(""</a>""); HttpUtility.JavaScriptStringEncode(user.Company);",How to convert string to HTML safe string
WPF merge grid columns, Hi I've been searching for a solution with no success ...I want a grid that resembles: Thank you in advance! <code>  +-------+----------------+| | |+-------+----------------+| || || |+-------+----------------+| | | +-------+----------------+,Merge grid columns
merge grid columns, Hi I've been searching for a solution with no success ...I want a grid that resembles: Thank you in advance! <code>  +-------+----------------+| | |+-------+----------------+| || || |+-------+----------------+| | | +-------+----------------+,Merge grid columns
How to ignore case sensitive in StartWith for LINQ FindAll?," I have the following code: If DeptName=""test"" and optAlpha.SelectedItem.Value=""T"", it doesn't work.I tried with the following code, still doesn't work. <code>  ContactList = ContactList.FindAll(p => p.DeptName.StartsWith(optAlpha.SelectedItem.Value)).ToList(); ContactList = ContactList.FindAll(p => p.DeptName.ToLower().StartsWith(optAlpha.SelectedItem.Value.ToLower())).ToList();",How to ignore case sensitivity in StartsWith for LINQ FindAll?
Capturing iteration variables," When you capture the iteration variable of a for loop, C# treats that variable as though it was declared outside the loop. This means that the same variable is captured in each iteration. The following program writes 333 instead of writing 012: I'm reading C# in a Nutshell (5th Edition) and today i came across this but i can't get my head over it, i don't get why the output is 333 and not 012. Is it because the value of i that's getting printed is the value after the loop? How is that possible? i is supposed to be disposed after the loop, isn't it? <code>  Action[] actions = new Action[3];for (int i = 0; i < 3; i++) actions [i] = () => Console.Write (i);foreach (Action a in actions) a(); // 333",How do you capture iteration variables?
Are methods in a controller thread safe?," I have a MVC controller accessible at a specific URL, which when called, runs a series of time consuming process (post-processing data from a db).I need to make sure that when the method is being called by an User, the process start once. If any other Users access that specific URL when the post-processing is running no simultaneously post-processing occurs.My questions:Should I use locks in C#?Should I use some like inProgress flag in DB, so I can mark when the processing start and end?Any other solutions? <code> ",How to prevent concurrent access in MVC Controller?
How to get all possible combinations for n arrays with diferrent number of elements?," I have some number of arrays which is unknown at programming time, maybe it is 3 or 4 or 7 ... each array has some elements, i.e, I want to get get all possible combinations by sampling one number from each array for example one case is that I pick up ""1"" from a, ""7"" from b, first ""8"" from c, d[3], e[5],... to make ""1,7,8,d[3],e[5],..."". It's not possible to use nested for loops because I don't know the number of arrays at compile time. If it was known for example 4 arrays (a,b,c,d) I could use 4 loops: but for different number of arrays, I don't have any idea. <code>  a={1 2 3 4}b={6 7 5 2 1}c={22 4 6 8 4 8 5 4}d={....}e, f, g, ... for (int i = 0; i <= a.Length-1; i++){ for (int j = 0; i <= b.Length-1; j++) { for (int k = 0; i <= c.Length-1; k++) { for (int m = 0; i <= d.Length-1; m++) { Response[f++] = a[i].toString()+"",""+b[j].toString()+"",""+c[k].toString()+"",""+d[m].toString(); } } }}",How to get all possible combinations for n arrays with different number of elements?
How to force Invalid berer token in web api?," I had to delete over 90 users in my web api.I am using web api 2 individual account.But after deleting this users, they still can use my web-api, because access token are cached somewhere.How to prevent that? <code> ",How to force Invalid Bearer token in web api?
C# get file paths of just files with no extentions," I am wanting to get a string array of paths of files that do not have extensions. They are binary files with no extensions if that helps.For example, I am loading a group of file paths out of a folder /test/I want just the path and filenames that do not have a extension (so no .txt, no .csv, no .*)/test/dontWant.txt/test/dontWant.csv/test/doWantif i do: I of course get everything in those directories.if I then try: I will still get everything in that directory.Is there a way to just get the files of those that have no extension?using ""*."" did work, and I don't know why I didn't try that to start with.I should have been using EnumerateFiles to start with. <code>  String[] paths = Directory.GetFiles(fDir, ""*.*"", SearchOption.AllDirectories); String[] paths= Directory.GetFiles(fDir, ""*"", SearchOption.AllDirectories); ",C# get file paths of just files with no extensions
ASP.NET Identity 2.0 - Impersonate a user, I'm migrating a ASP.NET MVC 5.1 application from MembershipProvider to ASP.NET Identity v2.0. One of the features I have in the application is user impersonation: Administrators can be logged in as any other user registered on the site without knowing passwords.I used this code to implement user impersonation for the MembershipProvider and this does not work with Identity library.How do I implement user impersonation (not IIS impersonation) in ASP.NET Identity? <code> ,How do I use ASP.NET Identity 2.0 to allow a user to impersonate another user?
Replace string value with '0' when string is empty C#," I'm taking a value from a textbox and converting it to decimal. But, the textbox value could be empty. So, how could I handle empty strings from the textbox?Unfortunately I have around 50 textboxes to deal with, so answers like 'check for null with IF condition' won't help me. My code will look ugly if I use all those IF conditions.I have this To handle nulls, I did this But, the above code is displaying '0' in the textbox. User does not want to see '0'. Another solution is to take text box value into a variable and convert the variable like below. But again, I do not want to define around 50 variables. I am looking for some piece of code that handles null values during conversion without adding the extra line of code. <code>  Convert.ToDecimal(txtSample.Text) Convert.ToDecimal(txtSample.Text = string.IsNullOrEmpty(txtSample.Text) ? ""0"" : txtSample.Text) string variable = txtSample.Text;Convert.ToDecimal(variable = string.IsNullOrEmpty(variable) ? ""0"" : variable)",Replace string value with '0' when string is empty
Serializing array of objects with JSON.NET," I try to serialize multiple items to json, and formats them as an array.It's event based, cause it's lot of data which could not be hold in memory as a whole collection. But I need to serialize each item into a file and format it like an array. Currently this outputs following: Since the serializer serializes each item as an object an does not know its an array.So how can I tell the JSON.Net serializer to handle each item as an item of an array and formats the data like so: Thanks for any hints! <code>  _jsonWriter = new JsonTextWriter(new StreamWriter(""Output.json"")));DataGatherer.ItemGathered += item =>{ _jsonSerializer.Serialize(_jsonWriter, item); _jsonWriter.Flush();}; { ""Id"": 218515, ""Name"": ""A""}{ ""Id"": 118647, ""Name"": ""B""} [{ ""Id"": 218515, ""Name"": ""A""},{""Id"": 118647,""Name"": ""B""}]",Serializing an array of objects one at a time with JSON.NET
Why can't JSON .Net serialize static or const member variables?," I haven't been able to find the answer to this anywhere, but when I try to serialize a struct or class with static or const member variables, they don't serialize by default. If I try to force serialization by setting MemberSerialization.OptIn, I get an error.ex. If I try to serialize this class with: I get the error Error getting value from 'y' on 'Test'. The same happens if y is const.My theory is that static and const values are stored somewhere special in memory, and for some reason the Json serializer dies trying to access them. That's entirely a hunch though, and I see nothing in the C# Reference for Static that's of any help. I'm relatively new to C# - and this is really a curiosity question more than anything at this point. <code>  [JsonObject(MemberSerialization.OptIn)]public class Test{ [JsonProperty] public int x = 1; [JsonProperty] public static int y = 2;} Test t = new Test();string s = JsonConvert.SerializeObject( t );",How to serialize static or const member variables using JSON.NET?
C#: Immutable local 'variables'," I'm new to C# (C++ programmer mainly, with Java as a strong second, and some others I use less often); I'm using C# with Unity, but I have a question that seems to be C# related rather than Unity.I've been moving somewhat towards functional-style programming, i.e. instead of I'd do something like this Now, I'd like to do that in C#, but I've tried this But Mono complains, saying maxGrowth isn't being assigned a 'constant value' - so I'm assuming C#'s const keyword is actually equivalent to 'constexpr' from C++11?If so, is there a way of doing what I want in C#? Preferably without invoking some container class (unless the compiler is good at making that efficient?).I assume from what I've read C# is much closer to Java overall than C++ in language; immutable classes rather than const-member functions? <code>  // C++int someFunction(int a) { int someCalculatedValue = a * a; someCalculatedValue /= 2; return someCalculatedValue * 3;} // Again C++int someFunction(int a) { const int inputSquared = a * a; const int inputSquaredHalved = inputSquared / 2; return inputSquaredHalved * 3;} // C#const float maxGrowth = GrowthRate * Time.deltaTime;",Immutable local 'variables' in C#
GZipStream Read returns 0," I've got a pesky problem with gzipstream targeting .Net 3.5. This is my first time working with gzipstream, however I have modeled after a number of tutorials including here and I'm still stuck.My app serializes a datatable to xml and inserts into a database, storing the compressed data into a varbinary(max) field as well as the original length of the uncompressed buffer. Then, when I need it, I retrieve this data and decompress it and recreates the datatable. The decompress is what seems to fail.EDIT: Sadly after changing the GetBuffer to ToArray as suggested, my issue remains. Code Updated belowCompress code: Decompress Code: Note the comment above... bytesdecompressed is always 0. Any ideas? Am I doing it wrong?EDIT 2:So this is weird. I added the following debug code to the decompression routine: When debugging, sometimes that loop would complete, but other times it would hang. When I'd stop the debugging, it would be at byte 1600 out of 1616. I'd continue, but it wouldn't move at all.EDIT 3: The bug appears to be in the compress code. For whatever reason, it is not saving all of the data. When I try to decompress the data using a third party gzip mechanism, I only get part of the original data.I'd start a bounty, but I really don't have much reputation to give as of now :-( <code>  DataTable dt = new DataTable(""MyUnit"");//do stuff with dt//okay... now compress the tableusing (MemoryStream xmlstream = new MemoryStream()){ //instead of stream, use xmlwriter? System.Xml.XmlWriterSettings settings = new System.Xml.XmlWriterSettings(); settings.Encoding = Encoding.GetEncoding(1252); settings.Indent = false; System.Xml.XmlWriter writer = System.Xml.XmlWriter.Create(xmlstream, settings); try { dt.WriteXml(writer); writer.Flush(); } catch (ArgumentException) { //likely an encoding issue... okay, base64 encode it var base64 = Convert.ToBase64String(xmlstream.ToArray()); xmlstream.Write(Encoding.GetEncoding(1252).GetBytes(base64), 0, Encoding.GetEncoding(1252).GetBytes(base64).Length); } using (MemoryStream zipstream = new MemoryStream()) { GZipStream zip = new GZipStream(zipstream, CompressionMode.Compress); log.DebugFormat(""Compressing commands...""); zip.Write(xmlstream.GetBuffer(), 0, xmlstream.ToArray().Length); zip.Flush(); float ratio = (float)zipstream.ToArray().Length / (float)xmlstream.ToArray().Length; log.InfoFormat(""Resulting compressed size is {0:P2} of original"", ratio); using (SqlCommand cmd = new SqlCommand()) { cmd.CommandText = ""INSERT INTO tinydup (lastid, command, compressedlength) VALUES (@lastid,@compressed,@length)""; cmd.Connection = db; cmd.Parameters.Add(""@lastid"", SqlDbType.Int).Value = lastid; cmd.Parameters.Add(""@compressed"", SqlDbType.VarBinary).Value = zipstream.ToArray(); cmd.Parameters.Add(""@length"", SqlDbType.Int).Value = xmlstream.ToArray().Length; cmd.ExecuteNonQuery(); } } /* This is an encapsulation of what I get from the database public class DupUnit{ public uint lastid; public uint complength; public byte[] compressed;}*/ //I have already retrieved my list of work to do from the database in a List<Dupunit> dupunitsforeach (DupUnit unit in dupunits){ DataSet ds = new DataSet(); //DataTable dt = new DataTable(); //uncompress and extract to original datatable try { using (MemoryStream zipstream = new MemoryStream(unit.compressed)) { GZipStream zip = new GZipStream(zipstream, CompressionMode.Decompress); byte[] xmlbits = new byte[unit.complength]; //WHY ARE YOU ALWAYS 0!!!!!!!! int bytesdecompressed = zip.Read(xmlbits, 0, unit.compressed.Length); MemoryStream xmlstream = new MemoryStream(xmlbits); log.DebugFormat(""Uncompressed XML against {0} is: {1}"", m_source.DSN, Encoding.GetEncoding(1252).GetString(xmlstream.ToArray())); try{ ds.ReadXml(xmlstream); }catch(Exception) { //it may have been base64 encoded... decode first. ds.ReadXml(Encoding.GetEncoding(1254).GetString( Convert.FromBase64String( Encoding.GetEncoding(1254).GetString(xmlstream.ToArray()))) ); } xmlstream.Dispose(); } } catch (Exception e) { log.Error(e); Thread.Sleep(1000);//sleep a sec! continue; } GZipStream zip = new GZipStream(zipstream, CompressionMode.Decompress); byte[] xmlbits = new byte[unit.complength]; int offset = 0; while (zip.CanRead && offset < xmlbits.Length) { while (zip.Read(xmlbits, offset, 1) == 0) ; offset++; }",GZipStream - write not writing all compressed data even with flush?
parsing a awkward json string in c#," I have been using NewtonSoft JSON Convert library to parse and convert JSON string to C# objects. But now I have came across a really awkward JSON string and I am unable to convert it into C# object because I cant make a C# class out of this JSON string.Here is the JSON string The C# class required to parse this JSON string should be like this: But it cant be a true C# class because we know that Class names cannot start with a number.It will be really great if anyone can suggest how to parse such type of json string. <code>  {""1"": { ""fajr"": ""04:15"", ""sunrise"": ""05:42"", ""zuhr"": ""12:30"", ""asr"": ""15:53"", ""maghrib"": ""19:18"", ""isha"": ""20:40""},""2"": { ""fajr"": ""04:15"", ""sunrise"": ""05:42"", ""zuhr"": ""12:30"", ""asr"": ""15:53"", ""maghrib"": ""19:18"", ""isha"": ""20:41"" } } public class 1 { public string fajr { get; set; } public string sunrise { get; set; } public string zuhr { get; set; } public string asr { get; set; } public string maghrib { get; set; } public string isha { get; set; }}public class 2 { public string fajr { get; set; } public string sunrise { get; set; } public string zuhr { get; set; } public string asr { get; set; } public string maghrib { get; set; } public string isha { get; set; }}",How can I parse a JSON string that would cause illegal C# identifiers?
Get print page count without printing," This is somewhat similar to question about Is there a better way to get the page count from a PrintDocument than this?But in my case I have a web-browser control with formatted html. At the moment I have option which calls ShowPrintPreviewDialog() so user can see how many pages going to be printed.Is there anyway to get the no of pages which going to be printed, without launching the PrintPreview? I am trying to create a method which will call OnTextChange and display print-page count automatically?I have use PrintPage event <code>  private void PrintDocumentOnPrintPage(object sender, PrintPageEventArgs e) { e.Graphics.DrawString(this.webBrowser1.DocumentText, this.webBrowser1.Font, Brushes.Black, 10, 25); }",Get print page count without printing the document
Having Separate Domain Model and Persitance Model in DDD," I have been reading about domain driven design and how to implement it while using code first approach for generating a database. From what I've read and researched there are two opinions around this subject:Have 1 class that serves both as a domain model and a persistence modelHave 2 different classes, one implementing the domain logic and one used for a code-first approachNow I know opinion 1) is said to simplify small solutions that do not have many differences between the domain and persistence models but I think it breaks the single responsibility principle and by that introduces a lot of issues when an ORM's conventions interfere with DDD.What is a surprise to me is there are numerous code examples of how to implement opinion 1). But a haven't found a single example of how to implement opinion 2) and how to map the 2 objects. (Probably there are such examples but I failed to find a C# one)So I tried to implement an example on my own but I am not sure if that's a good way to do it.Let's say I have a ticketing system and tickets have expiration date. My domain model will look like this: The persistence model using Entity Framework as ORM will look almost the same but as the solution grows this might not be the case Everything looking great so far. Now what I am not sure about is which is the best place to get a Ticket persistence model from the repository and how to map it to the TicketEntity domain modelI have done this in an application/service layer. My questions are:Are there any reasons opinion 1) would be preferred to opinion 2) other than speeding up development and reusing code.Are there any issues in my approach of mapping the models? Is there something I missed that would bring up issues when a solution grows? <code>  /// <summary>/// Domain Model/// </summary>public class TicketEntity{ public int Id { get; private set; } public decimal Cost { get; private set; } public DateTime ExpiryDate { get; private set; } public TicketEntity(int id, decimal cost, DateTime expiryDate) { this.Id = id; this.Cost = cost; this.ExpiryDate = expiryDate; } public bool IsTicketExpired() { if (DateTime.Now > this.ExpiryDate) { return true; } else { return false; } }} /// <summary>/// ORM code first Persistence Model/// </summary>public class Ticket{ [Key] public int Id { get; set; } public decimal Cost { get; set; } public DateTime ExpiryDate { get; set; }} public class ApplicationService{ private ITicketsRepository ticketsRepository; public ApplicationService(ITicketsRepository ticketsRepository) { this.ticketsRepository = ticketsRepository; } public bool IsTicketExpired(int ticketId) { Ticket persistanceModel = this.ticketsRepository.GetById(ticketId); TicketEntity domainModel = new TicketEntity( persistanceModel.Id, persistanceModel.Cost, persistanceModel.ExpiryDate); return domainModel.IsTicketExpired(); }}",Having Separate Domain Model and Persistence Model in DDD
"How to ""Pop"" Element from a List in C#?"," I have a List of cards called _deck: And then I want to remove a card from the List and save into a variable. I'm trying to do: but I'm getting the errorCannot convert type void to StringIn C# List is there something like push/pop but which does that at the ""head"" or ""start"" of the List? (Push/pop works at the ""tail"" or ""end"" of the list.)If not, how should I do remove the first element but save it in a variable? <code>  private List<String> _deck = new List<String> {""2h"", ""3h"", ""4h"", ... } String p1FirstCard = _deck.RemoveAt(0);","How to ""Dequeue"" Element from a List?"
"How to ""Pop"" Element from a List?"," I have a List of cards called _deck: And then I want to remove a card from the List and save into a variable. I'm trying to do: but I'm getting the errorCannot convert type void to StringIn C# List is there something like push/pop but which does that at the ""head"" or ""start"" of the List? (Push/pop works at the ""tail"" or ""end"" of the list.)If not, how should I do remove the first element but save it in a variable? <code>  private List<String> _deck = new List<String> {""2h"", ""3h"", ""4h"", ... } String p1FirstCard = _deck.RemoveAt(0);","How to ""Dequeue"" Element from a List?"
How to get date time value from data row in C#," I'm trying to get the date of birth of employees from the DataRows of the DataTable, but I'm getting the exception: String was not recognized as a valid DateTime.Please help me to get the value of type DateTime from the DataRow. The following is the my code. <code>  List employeeList = new List();foreach (DataRow dr in dt.Rows){ DateTime t = DateTime.Now; employeeObject.EmployeeID = Convert.ToInt64(dr[""empId""]); employeeObject.EmployeeFirstName = Convert.ToString(dr[""empFirstName""]); employeeObject.EmployeeMiddleName = Convert.ToString(dr[""empMiddleName""]); employeeObject.EmployeeLastName = Convert.ToString(dr[""emptLastName""]); employeeObject.EmployeeGenderStr = Convert.ToString(dr[""empGender""]); employeeObject.EmployeeDateOfBirth = Convert.ToDateTime(dr[""empDOB""]); //employeeObject.EmployeeDateOfBirth = DateTime.ParseExact(dr[""empDOB""].ToString().Replace("";"", "" ""), ""m/d/yyyy hh:mm:ss"", CultureInfo.InvariantCulture);// DateTime.Parse(dr[""empDOB""].ToString()); // employeeObject.EmployeeDateOfBirth = Convert.ToDateTime(dr[""empDOB""].ToString().Replace("";"", "" ""), System.Globalization.CultureInfo.GetCultureInfo(""hi-IN"").DateTimeFormat); ; employeeObject.EmployeeContactno = Convert.ToDouble(dr[""empContactNo""]); employeeObject.EmployeeEmailId = Convert.ToString(dr[""empEmailId""]); employeeObject.EmployeeAddress = Convert.ToString(dr[""empAddress""]); employeeObject.EmployeeDesignation = Convert.ToString(dr[""empDesgnation""]); employeeList.Add(employeeObject);}",How to get DateTime value from DataRow in C#
windows forms focus textboxes inside a panel," I have a Form with many TextBoxes. I need some TextBoxes inside one group, and other text boxes inside another group. By group, I just need a way to make these TextBoxes appear to belong with each other.I made two Panels and added the TextBoxes to them. Then, I placed a border around these Panels.However, my problem is that when I press Tab, the focus doesn't go to the next TextBox, but rather it goes in a random order to another TextBox. Sometimes the next TextBox is inside the first Panel, other times it is in the second Panel. How can I control the focus order?This is an image to illustrate my point: <code> ",How do I control the focus order for TextBoxes inside a panel?
How do I control the focus order for textboxes inside a panel?," I have a Form with many TextBoxes. I need some TextBoxes inside one group, and other text boxes inside another group. By group, I just need a way to make these TextBoxes appear to belong with each other.I made two Panels and added the TextBoxes to them. Then, I placed a border around these Panels.However, my problem is that when I press Tab, the focus doesn't go to the next TextBox, but rather it goes in a random order to another TextBox. Sometimes the next TextBox is inside the first Panel, other times it is in the second Panel. How can I control the focus order?This is an image to illustrate my point: <code> ",How do I control the focus order for TextBoxes inside a panel?
StringBuilder.ToString() thorws OutOfMemory Exception," I have a created a StringBuilder of length ""132370292"", when I try to get the string using the ToString() method it throws OutOfMemoryException. What is the reason for the OOM while creating a new string and why it doesn't throw OOM while writing to a file?Machine Details: 64-bit, Windows-7, 2GB RAM, .NET version 2.0 <code>  StringBuilder SB = new StringBuilder();for(int i =0; i<=5000; i++){ SB.Append(""Some Junk Data for testing. My Actual Data is created from different sources by Appending to the String Builder."");}try{ string str = SB.ToString(); // Throws OOM mostly Console.WriteLine(""String Created Successfully"");}catch(OutOfMemoryException ex){ StreamWriter sw = new StreamWriter(@""c:\memo.txt"", true); sw.Write(SB.ToString()); //Always writes to the file without any error Console.WriteLine(""Written to File Successfully"");}",StringBuilder.ToString() throws OutOfMemoryException
StringBuilder.ToString() throws OutOfMemory Exception," I have a created a StringBuilder of length ""132370292"", when I try to get the string using the ToString() method it throws OutOfMemoryException. What is the reason for the OOM while creating a new string and why it doesn't throw OOM while writing to a file?Machine Details: 64-bit, Windows-7, 2GB RAM, .NET version 2.0 <code>  StringBuilder SB = new StringBuilder();for(int i =0; i<=5000; i++){ SB.Append(""Some Junk Data for testing. My Actual Data is created from different sources by Appending to the String Builder."");}try{ string str = SB.ToString(); // Throws OOM mostly Console.WriteLine(""String Created Successfully"");}catch(OutOfMemoryException ex){ StreamWriter sw = new StreamWriter(@""c:\memo.txt"", true); sw.Write(SB.ToString()); //Always writes to the file without any error Console.WriteLine(""Written to File Successfully"");}",StringBuilder.ToString() throws OutOfMemoryException
how to create the c# maping class to csvhelper," I have a csv file with 40 columns and I want to load it to a datatable using csvhelper.After installing the library, I did this: and as you see, I have a console statement and it works perfectly.However, the csvReader has a constructor that takes a custom class to load the data directly to it. I tried this: but I got this exception because the CSVFileDefinitionis an empty class.my question is how to fill that class.This is the library: http://joshclose.github.io/CsvHelper/Many thanksUpdate 2The solution that works for me is: <code>  using (TextReader reader = File.OpenText(fileName)) { var csv = new CsvReader(reader); while (csv.Read()) { var farmID = csv.GetField(0); Console.WriteLine(farmID); }} var record = csv.GetRecord<CSVFileDefinition>(); No properties are mapped for type 'MyProjectName.CSVFileDefinition'. sealed class CSVFileDefinitionMap : CsvClassMap<CSVFileDefinition>{ public CSVFileDefinitionMap() { Map(m => m.FRM_ID).Name(""FARM ID""); Map(m => m.FRM_OWNER).Name(""FARM OWNER ""); }}class CSVFileDefinition{ public string FRM_ID { get; set; } public string FRM_OWNER { get; set; }}using (TextReader reader = File.OpenText(fileName)) { var csv = new CsvReader(reader); csv.Configuration.RegisterClassMap<CSVFileDefinitionMap>(); while (csv.Read()) { var record = csv.GetRecord<CSVFileDefinition>(); }}",How to create the C# mapping class to csvhelper
How do I left pad a byte array efficently," Assuming I have an array I would like to create an array of an arbitrary length and left pad it with 0x00 I have my current snippet here Is there a more efficient way to do this? <code>  LogoDataBy{byte[0x00000008]} [0x00000000]: 0x41 [0x00000001]: 0x42 [0x00000002]: 0x43 [0x00000003]: 0x44 [0x00000004]: 0x31 [0x00000005]: 0x32 [0x00000006]: 0x33 [0x00000007]: 0x34 newArray{byte[0x00000010]} [0x00000000]: 0x00 [0x00000001]: 0x00 [0x00000002]: 0x00 [0x00000003]: 0x00 [0x00000004]: 0x00 [0x00000005]: 0x00 [0x00000006]: 0x00 [0x00000007]: 0x00 [0x00000008]: 0x41 [0x00000009]: 0x42 [0x0000000a]: 0x43 [0x0000000b]: 0x44 [0x0000000c]: 0x31 [0x0000000d]: 0x32 [0x0000000e]: 0x33 [0x0000000f]: 0x34 string test = ""ABCD1234""; byte[] LogoDataBy = ASCIIEncoding.ASCII.GetBytes(test); var newArray = new byte[16]; var difference = newArray.Length - LogoDataBy.Length; for (int i = 0; i < LogoDataBy.Length; i++) { newArray[difference + i] = LogoDataBy[i]; }",How do I left pad a byte array efficiently
"How to demonstrate where a c sharp variable is stored, stack or heap"," I know c#, like Java, translating the source into bytecode and run by VM, for C# case is CIL stored in assembly and executed by CLR. Developers scarcely need to care about where the variable is on stack or on heap(handled by GC) as c++, right? Is their any quick and straightforward way to demonstrate that a variable is stored on stack or on heap? For example, if I tell someone the reference type variables are stored on heap or the local value type variable on stack(right?). How can I show that explicitly? In C++, I can get a variable's memory address and view its value stored in stack or heap memory by VS memory window. <code> ","How to demonstrate where a c# variable is stored, stack or heap"
Selecting multiple columns with linq query and lamda expression," I'm new to C# ASP.NET, and am working on my first application.I'm trying to create a linq statment that return an arrary.I have a table of products. I want to be able to select name, id, and price, for each product where the status == 1.I am struggling with crating a way to do this.I have only been able to return individual items/columns. I have been stuck on this wayyy to long.This is what I have so far: If you look in the screen shot below, you can see I have 2 errors, Select = Type object can not be refered from it's usageToArray = cant resolve symbol to array <code>  try{ using (UserDataDataContext db = new UserDataDataContext()) { return db.mrobProducts.Select(x => x.Name).OrderBy(x => x).ToArray(); }}",Selecting multiple columns with linq query and lambda expression
Can the C# JsonDeserializer deserialize this Json format response?," I am getting this JSON response from a system I am connecting to and trying to figure out the best way to deserialize it into a C# object. I am currently using RestSharp which seems pretty straight forward to use but the format of the JSON is baffling me a bit. Here is the format that its coming in as: Here is my current code: but as stated above I am trying to figure out the correct way to model the TicketResults object to support deserializing this message above.Ideally I would like something like this: and in this example above would get three entries in the Tickets collection.Also, is the above JSON format normal as i have never seen this broken out into separate schema and data section (I can see where it might save some space but in this case the messages are not that big) <code>  [ {""name"": ""Tickets:"", ""schema"": [ {""dataType"": ""string"", ""colName"": ""First"", ""idx"": 0}, {""dataType"": ""string"", ""colName"": ""Second"", ""idx"": 1}, {""dataType"": ""string"", ""colName"": ""Name"", ""idx"": 2} ], ""data"": [ [""bill"", ""test"", ""joe""], [""bill2"", ""test2"", ""joe2""], [""bill3"", ""test3"", ""joe3""] ] }] var url = ""http://myUrl:10111"";var client = new RestClient { BaseUrl = url };var request = new RestRequest { Method = Method.GET, Resource = ""/search?fmt=Json"", RequestFormat = DataFormat.Json };request.AddHeader(""accept"", ""application/json"");var response = client.Execute(request);var wptResponse = new JsonDeserializer().Deserialize<TicketResults>(response);return wptResponse; public class TicketResults { public List<Ticket> Tickets {get;set;} } public class Ticket { public string First {get;set;} public string Second {get;set;} public string Name {get;set;} }","In C#, how do I model a JSON object with multiple nested arrays?"
What is the correct way in C# to deserialize this Json response into a C# object?," I am getting this JSON response from a system I am connecting to and trying to figure out the best way to deserialize it into a C# object. I am currently using RestSharp which seems pretty straight forward to use but the format of the JSON is baffling me a bit. Here is the format that its coming in as: Here is my current code: but as stated above I am trying to figure out the correct way to model the TicketResults object to support deserializing this message above.Ideally I would like something like this: and in this example above would get three entries in the Tickets collection.Also, is the above JSON format normal as i have never seen this broken out into separate schema and data section (I can see where it might save some space but in this case the messages are not that big) <code>  [ {""name"": ""Tickets:"", ""schema"": [ {""dataType"": ""string"", ""colName"": ""First"", ""idx"": 0}, {""dataType"": ""string"", ""colName"": ""Second"", ""idx"": 1}, {""dataType"": ""string"", ""colName"": ""Name"", ""idx"": 2} ], ""data"": [ [""bill"", ""test"", ""joe""], [""bill2"", ""test2"", ""joe2""], [""bill3"", ""test3"", ""joe3""] ] }] var url = ""http://myUrl:10111"";var client = new RestClient { BaseUrl = url };var request = new RestRequest { Method = Method.GET, Resource = ""/search?fmt=Json"", RequestFormat = DataFormat.Json };request.AddHeader(""accept"", ""application/json"");var response = client.Execute(request);var wptResponse = new JsonDeserializer().Deserialize<TicketResults>(response);return wptResponse; public class TicketResults { public List<Ticket> Tickets {get;set;} } public class Ticket { public string First {get;set;} public string Second {get;set;} public string Name {get;set;} }","In C#, how do I model a JSON object with multiple nested arrays?"
"In C#, is there a clean way to deserialize this Json into an object?"," I am getting this JSON response from a system I am connecting to and trying to figure out the best way to deserialize it into a C# object. I am currently using RestSharp which seems pretty straight forward to use but the format of the JSON is baffling me a bit. Here is the format that its coming in as: Here is my current code: but as stated above I am trying to figure out the correct way to model the TicketResults object to support deserializing this message above.Ideally I would like something like this: and in this example above would get three entries in the Tickets collection.Also, is the above JSON format normal as i have never seen this broken out into separate schema and data section (I can see where it might save some space but in this case the messages are not that big) <code>  [ {""name"": ""Tickets:"", ""schema"": [ {""dataType"": ""string"", ""colName"": ""First"", ""idx"": 0}, {""dataType"": ""string"", ""colName"": ""Second"", ""idx"": 1}, {""dataType"": ""string"", ""colName"": ""Name"", ""idx"": 2} ], ""data"": [ [""bill"", ""test"", ""joe""], [""bill2"", ""test2"", ""joe2""], [""bill3"", ""test3"", ""joe3""] ] }] var url = ""http://myUrl:10111"";var client = new RestClient { BaseUrl = url };var request = new RestRequest { Method = Method.GET, Resource = ""/search?fmt=Json"", RequestFormat = DataFormat.Json };request.AddHeader(""accept"", ""application/json"");var response = client.Execute(request);var wptResponse = new JsonDeserializer().Deserialize<TicketResults>(response);return wptResponse; public class TicketResults { public List<Ticket> Tickets {get;set;} } public class Ticket { public string First {get;set;} public string Second {get;set;} public string Name {get;set;} }","In C#, how do I model a JSON object with multiple nested arrays?"
C# Set Timeout On Remote WMI when RPC Server Is Unavailable," I have the following code that checks the status of a service on a remote computer. The problem is that if the remote computer can't be found (it's down or something), then the ManagementObjectSearcher.Get() method takes 20 seconds to throw an error of ""The RPC Server Is Unavailable"". In cases where the server is unavailable, I want to explicitly state that I only want it to try for a short period of time (like 3 seconds). I have followed the post here, but it states to use the Timeout option on ManagementObjectSearcher, but my code seems to ignore that value (as it states it's not relevant on collections). Is there something I'm overlooking on these options? I have tried using the ReturnImmediatly property as well to no avail. <code>  public static void WmiServiceCheck() { try { var computerName = ""SomeInvalidComputer""; var serviceName = ""Power""; var managementScope = new ManagementScope(string.Format(@""\\{0}\root\cimv2"", computerName)); var objectQuery = new ObjectQuery(string.Format(""SELECT * FROM Win32_Service WHERE Name = '{0}'"", serviceName)); var searcher = new ManagementObjectSearcher(managementScope, objectQuery); searcher.Options.Timeout = new TimeSpan(0, 0, 0, 3); // Timeout of 3 seconds var managementObjectCollection = searcher.Get(); var serviceState = managementObjectCollection.Cast<ManagementObject>().ToList().Single()[""State""].ToString(); /// Other stuff here } catch (Exception ex) { } }",Set Timeout On Remote WMI when RPC Server Is Unavailable
How can I access a property from an ActionFilterAttribute in my controller?, I have a custom ActionFilterAttribute. For the sake of this question let's assume it's as follows: My controller is then decorated with CustomActionFilter. What I am looking for is a way (in my controller method) to do something like: If there is a more accepted way of doing this please let me know.  <code>  public class CustomActionFilterAttribute : ActionFilterAttribute { public bool success { get; private set }; public override void OnActionExecuting(HttpActionContext actionContext) { //Do something and set success success = DoSomething(actionContext); }} [CustomActionFilter]public class MyController : ApiController { public ActionResult MyAction() { //How do I get the 'success' from my attribute? }},How can I access a property from an ActionFilterAttribute in my ApiController?
Exception desctructuring in Serilog," Serilog has a convenient way of destructuring objects as shown in this example: The first line causes the logger to log an exception as plain text (by calling ToString()), and the second line causes the logger to write exception properties as separate fields. But what about this overload: This one takes an exception as its first argument, and it is always written as a string. What I would like to make possible is to enable logging exception in a structured way. Is it possible to configure Serilog to achieve this?UPDATE. I guess this question leads to another aspect of logging exceptions: how can I ensure that messages are enriched with exception properties (so they are logged in a structured way to the rich sinks like Elasticsearch) without writing all exception properties to the rendered text message (so plain text loggers are not filled with huge piles of exception details). <code>  logger.Debug(exception, ""This is an {Exception} text"", exception);logger.Debug(exception, ""This is an {@Exception} structure"", exception); logger.Debug(exception, ""This is an exception"", exception);",Exception destructuring in Serilog
Mouse input realiability. (Unity)," I am developing a 2D game in unity. One of the features in the game is to shoot projectiles using the left click of the mouse. Upon releasing the left click the projectile gets fired with certain amount of force that depends on how long the player held the left click. The problem is that sometimes when I release the left click the game doesnt seem to detect it and the release portion of the code doesnt get executed until I click and release again. I may not sound like a big problem but input reliability will play a fundamental role in this game. So, is there any way to make mouse input more realiable? I have already tried using Input.GetMouseButtonDown and different kinds of conditionals in order to make it more reliable, but it hasnt worked out. Thank you in advance!Here is the code I am using: <code>  using UnityEngine;using System.Collections;public class ShootPlasma : MonoBehaviour { //prefab public Transform bulletPrefab; //Reloading variables: public int numberOfBullets; private int numberOfBulletsRecord; private bool canShoot=true; public float timeToReload; private float timeToReloadRecord; //direction and bullet Speed variables: Transform sightPosition; public Vector3 SpawnRiseVector; private Vector2 direction; public float bulletBoost; private float bulletBoostRecord; public float MAX_BOOST; //Arrow Guide public Transform aimingArrow; //Helper variables; private CharacterController2D charControllerScript; void Start () { timeToReloadRecord = timeToReload; numberOfBulletsRecord = numberOfBullets; charControllerScript = transform.parent.GetComponent<CharacterController2D> (); bulletBoostRecord = bulletBoost; sightPosition = GetComponent<Transform> (); aimingArrow.GetComponentInChildren<Renderer>().enabled=false; } // Update is called once per frame void FixedUpdate () { if(numberOfBullets<=0){ canShoot=false; if(!canShoot){ timeToReload-=Time.deltaTime; //if the waiting time has ended restart variables. if(timeToReload<=0.0f){ canShoot=true; timeToReload=timeToReloadRecord; numberOfBullets=numberOfBulletsRecord; } } } ////////////////////////////////// SHOOTING CODE //////////////////////////////////////////// /// /// MOUSE DOWN ///////////////////////////////////////////////////////////////////////////////////////// else if(Input.GetMouseButton(0)&& canShoot && !Input.GetMouseButtonUp(0)){ //show the Arrow Guide: if(aimingArrow.GetComponentInChildren<Renderer>().enabled!=true){ aimingArrow.GetComponentInChildren<Renderer>().enabled=true; } //calculate the distance between the mouse and the sight; Vector3 mousePositionRelative=Camera.main.ScreenToWorldPoint(Input.mousePosition); direction= new Vector2(mousePositionRelative.x- sightPosition.position.x, mousePositionRelative.y- sightPosition.position.y).normalized; //If Y is less or equal 0: if(direction.y<=0.0f && direction.x>=0.0f){ direction=new Vector2(1.0f,0.0f); } else if(direction.y<=0.0f && direction.x<0.0f){ direction=new Vector2(-1.0f,0.0f); } //Rotate the aiming arrow if(charControllerScript.facingFront){ if(direction.x>=0.0f){ aimingArrow.rotation=Quaternion.Euler(new Vector3(0.0f,0.0f,(Mathf.Asin(direction.y/direction.magnitude))*Mathf.Rad2Deg)); } else if(direction.x<0.0f){ aimingArrow.rotation=Quaternion.Euler(new Vector3(0.0f,180.0f,(Mathf.Asin(direction.y/direction.magnitude))*Mathf.Rad2Deg)); } } else if(!charControllerScript.facingFront){ if(direction.x>=0.0f){ aimingArrow.rotation=Quaternion.Euler(new Vector3(0.0f,180.0f,(Mathf.Asin(direction.y/direction.magnitude))*Mathf.Rad2Deg)); } else if(direction.x<0.0f){ aimingArrow.rotation=Quaternion.Euler(new Vector3(0.0f,0.0f,(Mathf.Asin(direction.y/direction.magnitude))*Mathf.Rad2Deg)); } } Debug.Log(direction); //Charge bulletBoost+=Time.deltaTime*bulletBoost; if(bulletBoost>=MAX_BOOST){ bulletBoost=MAX_BOOST; } } /////////////////////////////////////////////////////////////////////////////////////////////////// /// MOUSE UP /// /////////////////////////////////////////////////////////////////////////////////////////////// else if(Input.GetMouseButtonUp(0)&& canShoot && !Input.GetMouseButton(0)){ //Hide the Arrow Guide: if(aimingArrow.GetComponentInChildren<Renderer>().enabled!=false){ aimingArrow.GetComponentInChildren<Renderer>().enabled=false; } //Fire var shootPrefab= Instantiate(bulletPrefab,sightPosition.position+SpawnRiseVector,Quaternion.identity) as Transform; shootPrefab.GetComponent<Rigidbody2D>().AddForce(direction*bulletBoost); bulletBoost=bulletBoostRecord; //Reduce the Ammo by one: numberOfBullets-=1; } }}",Input.GetMouseButtonUp is not reliable. (Unity)
C# Generic Linked List Sorting," I have everything in a Generic Linked list done except for sorting.And I don't know how to use IComparable or how I would go about doing this because it's generic. I don't know what I would even be comparing or sorting? So It is also against the instructions to convert it to an array and then sort it, then convert it back. <code>  public class Node<T> : IComparable<T>{ private Node<T> next; private T item;} public int CompareTo( T other ){ // TODO: Find out how to do it properly throw new NotImplementedException();}",Sorting generic linked list
Handling excessive members when deserializing with C# Json.net," Suppose I want to deserialize a set of Json data into a Person object. But if I have the Json data like the one below: The fields ""birthdate"" and ""birthplace"" are not part of the Person class. But I still want to retain those fields, so is it possible to use Json.net or other libraries that can store those extra fields into one of the fields of Person such as ""unused"" as declared above? <code>  class Person{ [DataMember] string name; [DataMember] int age; [DataMember] int height; object unused;} { ""name"":""Chris"", ""age"":100, ""birthplace"":""UK"", ""height"":170, ""birthdate"":""08/08/1913"",}",Handling extra members when deserializing with Json.net
Partial classes with different access modifier," According to MSDN Documentation for partial classes : All the parts must have the same accessibility, such as public, private, and so on.but if you create a WindowsForm application, you will have the default Form class in two partial classes.The code behind : and the designer : Access modifiers are different, but it will compile.Am I missing something here? <code>  public partial class Form1 : Form{ ...} partial class Form1{ ...}",Partial classes and access modifier issue
Asp.NET - Identity 2 - Invalid Token Error," I'm using Asp.Net-Identity-2 and I'm trying to verify email verification code using the below method. But I am getting an ""Invalid Token"" error message. My Application's User Manager is like this: My Action to generate the token is (and even if I check the token here, I get ""Invalid token"" message): My Action to check the token is (here, I always get ""Invalid Token"" when I check the result): I don't know what could be missing or what's wrong... <code>  public class AppUserManager : UserManager<AppUser>{ public AppUserManager(IUserStore<AppUser> store) : base(store) { } public static AppUserManager Create(IdentityFactoryOptions<AppUserManager> options, IOwinContext context) { AppIdentityDbContext db = context.Get<AppIdentityDbContext>(); AppUserManager manager = new AppUserManager(new UserStore<AppUser>(db)); manager.PasswordValidator = new PasswordValidator { RequiredLength = 6, RequireNonLetterOrDigit = false, RequireDigit = false, RequireLowercase = true, RequireUppercase = true }; manager.UserValidator = new UserValidator<AppUser>(manager) { AllowOnlyAlphanumericUserNames = true, RequireUniqueEmail = true }; var dataProtectionProvider = options.DataProtectionProvider; //token life span is 3 hours if (dataProtectionProvider != null) { manager.UserTokenProvider = new DataProtectorTokenProvider<AppUser> (dataProtectionProvider.Create(""ConfirmationToken"")) { TokenLifespan = TimeSpan.FromHours(3) }; } manager.EmailService = new EmailService(); return manager; } //Create } //class} //namespace [AllowAnonymous][HttpPost][ValidateAntiForgeryToken]public ActionResult ForgotPassword(string email){ if (ModelState.IsValid) { AppUser user = UserManager.FindByEmail(email); if (user == null || !(UserManager.IsEmailConfirmed(user.Id))) { // Returning without warning anything wrong... return View(""../Home/Index""); } //if string code = UserManager.GeneratePasswordResetToken(user.Id); string callbackUrl = Url.Action(""ResetPassword"", ""Admin"", new { Id = user.Id, code = HttpUtility.UrlEncode(code) }, protocol: Request.Url.Scheme); UserManager.SendEmail(user.Id, ""Reset password Link"", ""Use the following link to reset your password: <a href=\"""" + callbackUrl + ""\"">link</a>""); //This 2 lines I use tho debugger propose. The result is: ""Invalid token"" (???) IdentityResult result; result = UserManager.ConfirmEmail(user.Id, code); } // If we got this far, something failed, redisplay form return View();} //ForgotPassword [AllowAnonymous]public async Task<ActionResult> ResetPassword(string id, string code){ if (id == null || code == null) { return View(""Error"", new string[] { ""Invalid params to reset password."" }); } IdentityResult result; try { result = await UserManager.ConfirmEmailAsync(id, code); } catch (InvalidOperationException ioe) { // ConfirmEmailAsync throws when the id is not found. return View(""Error"", new string[] { ""Error to reset password:<br/><br/><li>"" + ioe.Message + ""</li>"" }); } if (result.Succeeded) { AppUser objUser = await UserManager.FindByIdAsync(id); ResetPasswordModel model = new ResetPasswordModel(); model.Id = objUser.Id; model.Name = objUser.UserName; model.Email = objUser.Email; return View(model); } // If we got this far, something failed. string strErrorMsg = """"; foreach(string strError in result.Errors) { strErrorMsg += ""<li>"" + strError + ""</li>""; } //foreach return View(""Error"", new string[] { strErrorMsg });} //ForgotPasswordConfirmation","Asp.NET Identity 2 giving ""Invalid Token"" error"
How to create ApplicatiionUser by UserManager in Seed method of ASP .NET MVC 5 Web application," I can create users in the old way: but I want to do it the ASP.NET MVC 5.1 way using UserManager. I peeked how the Register POST method looks in AccountController: so I tried do the same: but I get this:also If I just type UserManager. VS2013 does not shows any methods on the list.So how to add user in this way?EDIT1: <code>  var users = new List<ApplicationUser> { new ApplicationUser{PasswordHash = hasher.HashPassword(""TestPass44!""), Email = ""informatyka4444@wp.pl"", UserName = ""informatyka4444@wp.pl"", SecurityStamp = Guid.NewGuid().ToString()}, new ApplicationUser{PasswordHash = hasher.HashPassword(""TestPass44!""), Email = ""informatyka4445@wp.pl"", UserName = ""informatyka4445@wp.pl"", SecurityStamp = Guid.NewGuid().ToString()} };users.ForEach(user => context.Users.AddOrUpdate(user));context.SaveChanges(); public async Task<ActionResult> Register(RegisterViewModel model) { if (ModelState.IsValid) { var user = new ApplicationUser() { UserName = model.Email, Email = model.Email }; IdentityResult result = await UserManager.CreateAsync(user, model.Password); if (result.Succeeded) { [...] var user = new ApplicationUser() { Email = ""informatyka4444@wp.pl"", UserName = ""informatyka4444@wp.pl""};IdentityResult result = UserManager.CreateAsync(user, ""abcwq12312!P"");",How to create ApplicationUser by UserManager in Seed method of ASP .NET MVC 5 Web application
How to read a PDF file line by line in c#? (ITextSharp)," In my windows 8 application, I would like to read a PDF line by line then I would like to assign a String array. How can I do it? <code>  public StringBuilder addd= new StringBuilder(); string[] array; private async void btndosyasec_Click(object sender, RoutedEventArgs e) { FileOpenPicker openPicker = new FileOpenPicker(); openPicker.ViewMode = PickerViewMode.List; openPicker.SuggestedStartLocation = PickerLocationId.PicturesLibrary; openPicker.FileTypeFilter.Add("".pdf""); StorageFile file = await openPicker.PickSingleFileAsync(); if (file != null) { PdfReader reader = new PdfReader((await file.OpenReadAsync()).AsStream()); for (int page = 1; page <= reader.NumberOfPages; page++) { addd.Append(PdfTextExtractor.GetTextFromPage(reader, page)); string tmp= PdfTextExtractor.GetTextFromPage(reader, page); array[page] = tmp.ToString(); reader.Close(); } } }",How to read a PDF file line by line in c#?
Mouse Event Binding," I need to trigger an event when the left mouse button gets released. I've tried this: and this These both work. The problem with both cases is that the event fires when the button gets pressed. I need it to fire only when the button gets released. The MouseBinding does not seem to support this. Is there a way to do this with Interaction? What is the best way to handle this? Thanks. <code>  <i:Interaction.Triggers> <i:EventTrigger EventName=""MouseClick"" > <i:InvokeCommandAction Command=""{Binding OnBarGroupChangeCommand}"" CommandParameter=""{Binding ElementName=ReportsBarGroup, Path=Key}"" /> </i:EventTrigger></i:Interaction.Triggers> <igWPF:OutlookBarGroup.InputBindings> <MouseBinding MouseAction=""LeftClick"" Command=""{Binding OnBarGroupChangeCommand}"" CommandParameter=""{Binding ElementName=ReportsBarGroup, Path=Key}""/> </igWPF:OutlookBarGroup.InputBindings>",How can I trigger an event when the left mouse button gets released in WPF?
WPF Mouse Event Binding," I need to trigger an event when the left mouse button gets released. I've tried this: and this These both work. The problem with both cases is that the event fires when the button gets pressed. I need it to fire only when the button gets released. The MouseBinding does not seem to support this. Is there a way to do this with Interaction? What is the best way to handle this? Thanks. <code>  <i:Interaction.Triggers> <i:EventTrigger EventName=""MouseClick"" > <i:InvokeCommandAction Command=""{Binding OnBarGroupChangeCommand}"" CommandParameter=""{Binding ElementName=ReportsBarGroup, Path=Key}"" /> </i:EventTrigger></i:Interaction.Triggers> <igWPF:OutlookBarGroup.InputBindings> <MouseBinding MouseAction=""LeftClick"" Command=""{Binding OnBarGroupChangeCommand}"" CommandParameter=""{Binding ElementName=ReportsBarGroup, Path=Key}""/> </igWPF:OutlookBarGroup.InputBindings>",How can I trigger an event when the left mouse button gets released in WPF?
Why can't I set my system time to a time near daylight savings transition," My times, they are changing, that is, because I need them to.I am testing some cases involving a scheduler I use and this involves behavior around transitions to and from daylight saving time.The CodeFrom this post I got a working method that enables me to change the system date programmatically (reposting most of the code): and for my own convenience I am just wrapping that in this function that I actually call: The additional conversion to Universal Time is necessary, otherwise I don't get to see the date I passed to the method in my clock (down in the task bar).Now this works fine considering this code for example: The method GetNetworkTime is actually just grabbed from over here, so I can set my clock back to the ""real"" time after testing, you can ignore it for this question's sake.Example output #1That does, what you'd expect (German DateTime formatting, don't get confused):And in the task bar I also see what I expect:Example output #2 (Transitioning to daylight saving time)But now to the weird part:Switch the first line of the calling code for Now the command line output actually seems to satisfy what we'd expect to see:But then we take a look down to the right of our task bar and enter frowny land and see a time that should actually not exist for that day:Example output #3 (Transitioning out of daylight saving time)Now, the funny thing is, when I try the same thing for the second before the transition out of daylight saving time, the change gets ""accepted"" (switching first calling code line again): We see what we'd expect in the command line output:also in the task bar clock:But this story also has a sad ending, let one second pass and you would expect the clock to show 2 'o clock, but instead:Which is a time that should actually occur one hour later on that particular day (if you switch the time manually in windows this transitions as expected).The QuestionNow, what am I missing here, why can't I target the second before transition to daylight saving time and why don't I see the transition out of daylight saving time when I do the DateTime-changes programmatically this way?What do I need to add/set so I can? <code>  [StructLayout(LayoutKind.Sequential)]public struct SYSTEMTIME{ public short wYear; public short wMonth; public short wDayOfWeek; public short wDay; public short wHour; public short wMinute; public short wSecond; public short wMilliseconds;}[DllImport(""kernel32.dll"", SetLastError = true)]public static extern bool SetSystemTime(ref SYSTEMTIME st); public static void SetSytemDateTime(DateTime timeToSet){ DateTime uniTime = timeToSet.ToUniversalTime(); SYSTEMTIME setTime = new SYSTEMTIME() { wYear = (short)uniTime.Year, wMonth = (short)uniTime.Month, wDay = (short)uniTime.Day, wHour = (short)uniTime.Hour, wMinute = (short)uniTime.Minute, wSecond = (short)uniTime.Second, wMilliseconds = (short)uniTime.Millisecond }; SetSystemTime(ref setTime);} DateTime timeToSet = new DateTime(2014, 3, 10, 1, 59, 59, 0);Console.WriteLine(""Attemting to set time to {0}"", timeToSet);SetSytemDateTime(timeToSet);Console.WriteLine(""Now time is {0}, which is {1} (UTC)"", DateTime.Now, DateTime.UtcNow);Thread.Sleep(TimeSpan.FromSeconds(5));DateTime actualSystemTime = GetNetworkTime();SetSytemDateTime(actualSystemTime); // one second before transition to daylight saving time in BerlinDateTime timeToSet = new DateTime(2015, 3, 29, 1, 59, 59, 0); // one second before transition out of daylight saving time in BerlinDateTime timeToSet = new DateTime(2014, 10, 26, 2, 59, 59, 0);",Why can't I set my system time to a time near daylight saving transition
How to obtain form's inner width and width," As per title.I am writing a program that all components can adjust size automatically by form's size.When I using this.Width and this.Height properties, its return value is the width and height of whole form (red frame).How to get the form's width and height of its inner area (green frame)? <code> ",How to obtain form's inner width and height
SessionState memory management," We're using an out-of-proc session state service/ASP.Net Session state. We know were having problems with this as it's been abused in the past, too much stored in session state too often, so were in the process of moving onto a more scalable system.In the meantime, though, we're trying to get our heads around how a session state service manages it's memory and what limits do we have. But none of the Microsoft docs seem to go into any details. Specifically I want to know:What are the limits to how much ""the standard"" out of proc session state service (installed along with IIS in the windows management console) can store?(x64)Is there a per user limit?by standard service, I mean this one: <code> ",Out of proc SessionState memory management
Why best practices vary for Static classes in C# and Java?," I'm currently reading about Java best practices and I found that according to this book we must Favor static classes over nonstatic. I've remembered that in C# best practices we must avoid such according to Coding Guidelines for C# 3.0, 4.0 and 5.0 by Dennis Doomen: AV1008 - Avoid static classes With the exception of extension method containers static classes very often lead to badly designed code. They are also very difficult, if not impossible, to test in isolation unless youre willing to use some very hacky tools. Note If you really need that static class, mark it as static so that the compiler can prevent instance members and instantiating your class. This relieves you of creating an explicit private constructor.I found these two for C# answer and Java answer when to use and avoid static classes, but just by curiosity - both C# and Java are OOP languages, why it's this complete difference then in best practices?Update:I can't copy so much pages here from the Java book, but bottom line is: If you declare a member class that does not require access to an enclosing instance, always put the static modifier in its declaration, making it a static rather than a nonstatic member class. If you omit this modifier, each instance will have an extraneous reference to its enclosing instance. Storing this reference costs time and space, and can result in the enclosing instance being retained when it would otherwise be eligible for garbage collection (Item 6). And should you ever need to allocate an instance without an enclosing instance, youll be unable to do so, as nonstatic member class instances are required to have an enclosing instance. A common use of private static member classes is to represent components of the object represented by their enclosing class.So is it about performance only? Please note that this question is more about Static classes and OOP, not difeerences between Java and C#. <code> ",Why best practices vary for Static classes in OOP?
HTML Agility pack get all URLs on page," I am trying to add links extracted from an HTML file to a CheckBoxList (cbl_items).It works so far but instead of the link, the item's name is displayed as HtmlAgilityPack.HtmlNode.I tried using DocumentElement instead of Node but it said that it does not exist or similar.How can I get the URL to be displayed instead of HtmlAgilityPack.HtmlNode?This is what I've tried so far: <code>  HtmlWeb hw = new HtmlWeb();HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();doc = hw.Load(tb_url.Text);foreach (HtmlNode link in doc.DocumentNode.SelectNodes(""//a[@href]"")){ cbl_items.Items.Add(link);}",HTML Agility Pack get all anchors' href attributes on page
C# Select query to get data from Sql server," I am trying to run the SQL Select query in my C# code. But I always get the -1 output on However, the same table if I use for delete or insert works... ConnectString is also fine.Please check below code The query works fine on SQL Server, but I am not getting why only select query is not working. All other queries are working. <code>  int result = command.ExecuteNonQuery(); SqlConnection conn = new SqlConnection(""Data Source=;Initial Catalog=;Persist Security Info=True;User ID=;Password="");conn.Open();SqlCommand command = new SqlCommand(""Select id from [table1] where name=@zip"", conn);//command.Parameters.AddWithValue(""@zip"",""india"");int result = command.ExecuteNonQuery();// result gives the -1 output.. but on insert its 1using (SqlDataReader reader = command.ExecuteReader()){ // iterate your results here Console.WriteLine(String.Format(""{0}"",reader[""id""]));}conn.Close();",Select query to get data from SQL Server
C# Select query to get data from SQL Server," I am trying to run the SQL Select query in my C# code. But I always get the -1 output on However, the same table if I use for delete or insert works... ConnectString is also fine.Please check below code The query works fine on SQL Server, but I am not getting why only select query is not working. All other queries are working. <code>  int result = command.ExecuteNonQuery(); SqlConnection conn = new SqlConnection(""Data Source=;Initial Catalog=;Persist Security Info=True;User ID=;Password="");conn.Open();SqlCommand command = new SqlCommand(""Select id from [table1] where name=@zip"", conn);//command.Parameters.AddWithValue(""@zip"",""india"");int result = command.ExecuteNonQuery();// result gives the -1 output.. but on insert its 1using (SqlDataReader reader = command.ExecuteReader()){ // iterate your results here Console.WriteLine(String.Format(""{0}"",reader[""id""]));}conn.Close();",Select query to get data from SQL Server
Converting a delegate to IObservable," I have an delegate that looks like this: And an event that looks like this: Is there some easy way to create an IObservable sequence for this event? I'd like to do something like this (but it doesn't compile): .... <code>  public delegate void MyDelegate(int arg1, int arg2); public event MyDelegate SomethingHappened; var obs = Observable.FromEventPattern<int, int>(this, ""SomethingHappened"");var subscription = obs.Subscribe(x,y => DoSomething(x, y)); private void DoSomething(int value1, int value2){...}",How to convert an event to an IObservable when it doesn't conform to the standard .NET event pattern
C# Insert integer to Arabic String it Start," I am trying to add integer to Arabic string but no success output : -1Desired output: I want the integer on the right side .Update : Am displaying this result in ListBox in visual studio by using Items.Insert() Method , so if anyone know to tweak ListBox then kindly share I mean if ListBox display Numbers 1 2 3 4 with each row ? <code>  // Arabic String Astr = "" "";// String with Integer -1num = ""-""+1;// Adding Stringsr = Astr + num; r = num + Astr; -1",Insert integer to Arabic String in Start
Insert integer to Arabic String it Start," I am trying to add integer to Arabic string but no success output : -1Desired output: I want the integer on the right side .Update : Am displaying this result in ListBox in visual studio by using Items.Insert() Method , so if anyone know to tweak ListBox then kindly share I mean if ListBox display Numbers 1 2 3 4 with each row ? <code>  // Arabic String Astr = "" "";// String with Integer -1num = ""-""+1;// Adding Stringsr = Astr + num; r = num + Astr; -1",Insert integer to Arabic String in Start
Byte Order Mark in signed file," I am using iTextSharp 5.5.1 in order to sign PDF files digitally with a detached signature (obtained from a third party authority). Everything seems to work fine, the file is valid and e.g. Adobe Reader reports no problems, displays the signatures as valid etc.The problem is that the Java Clients have apparently some problems with those files - the file can be neither opened nor parsed.The files have a byte order mark in the header which seems to cause the behavior (\x00EF\x00BB\x00BF).I could identify the BOM like this: How can I either remove the BOM (without losing the validity of the signature), or force the iTextSharp library not to append these bytes into the files? <code>  PdfReader reader = new PdfReader(path);byte[] metadata = reader.Metadata;// metadata[0], metadata[1], metadata[2] contain the BOM",Remove Byte Order Mark from signed PDF file?
how to calculate total Sum in Excel using c# WPF?," I am producing last report for my venture. I need to ascertain the Sum of aggregate cells in my excel sheet. I have done the accompanying code. Be that as it may, its not computing the qualities.. Here is my code: I need to figure the Cell No 16's Sum esteem and I will show it into Cells[20,16]. Its not working. Anybody help me to settle this? <code>  Worksheet.Cells[20, 16].Formula = ""Sum("" + Worksheet.Cells[6, 16].Value + "":"" + Worksheet.Cells[rowIndex, 16].Value + "")"";",how to calculate total Sum in Excel
how to calculate total Sum in Excel using c# 4.5?," I am producing last report for my venture. I need to ascertain the Sum of aggregate cells in my excel sheet. I have done the accompanying code. Be that as it may, its not computing the qualities.. Here is my code: I need to figure the Cell No 16's Sum esteem and I will show it into Cells[20,16]. Its not working. Anybody help me to settle this? <code>  Worksheet.Cells[20, 16].Formula = ""Sum("" + Worksheet.Cells[6, 16].Value + "":"" + Worksheet.Cells[rowIndex, 16].Value + "")"";",how to calculate total Sum in Excel
C#.NET How to safely convert a string containign escaped JSON to valid JSON," I am communicating with a third party API that returns JSON responses as follows: It is kind of JSON... but as a String. Note the first and ending double quotes and of course all the escape slashes.Currently, I solve this by String.Replacing the backslashes and the first and end quote. After that, I am able to parse it. However, what if one of the attributes actually has an backslash as a value? For example: In that case, I would accidentally remove the backslash that should be there in the value.Does anyone have a bright idea on how to parse this JSON String properly? <code>  ""{\""SomeResponse\"":{\""FIrstAttribute\"":8,\""SecondAttribute\"":\""On\"",\""ThirdAttribute\"":{\""Id\"":2,\""FirstName\"":\""Okkie\"",\""Name\"":\""Bokkie\"",\""Street\"":\""\"",\""StreetNumber\"":null,\""PostCode\"":\""\"",\""City\"":\""\"",\""Country\"":\""}}}"" mystring.Replace(""\\"", """"); \""SecondAttribute\"":\""My Super Back Slash: \\ . That was it.\""",How to safely convert a string containing escaped JSON to valid JSON?
How to safely convert a string containign escaped JSON to valid JSON?," I am communicating with a third party API that returns JSON responses as follows: It is kind of JSON... but as a String. Note the first and ending double quotes and of course all the escape slashes.Currently, I solve this by String.Replacing the backslashes and the first and end quote. After that, I am able to parse it. However, what if one of the attributes actually has an backslash as a value? For example: In that case, I would accidentally remove the backslash that should be there in the value.Does anyone have a bright idea on how to parse this JSON String properly? <code>  ""{\""SomeResponse\"":{\""FIrstAttribute\"":8,\""SecondAttribute\"":\""On\"",\""ThirdAttribute\"":{\""Id\"":2,\""FirstName\"":\""Okkie\"",\""Name\"":\""Bokkie\"",\""Street\"":\""\"",\""StreetNumber\"":null,\""PostCode\"":\""\"",\""City\"":\""\"",\""Country\"":\""}}}"" mystring.Replace(""\\"", """"); \""SecondAttribute\"":\""My Super Back Slash: \\ . That was it.\""",How to safely convert a string containing escaped JSON to valid JSON?
"How to configure simple injector container and lifestylse in a MVC web app with WebAPI, WCF, SignalR and Background Taks"," The simple injector documentation provides great examples on how to setup the container for WebRequest, Web API, WCF, ... but the examples are specific to one technology/lifestyle at a time. Our web application uses most of them together!It is not clear to me how to configure the container to work with several lifestyles.Let's say I have a MVC project with Web API. I have the following objects:MyDbContext : My entity code first db contextIMyDataProvider implemented by MyDataProvider : Contains query logic and uses MyDbContextMyController : MVC controller that uses IMyDataProviderMyApiController : WebApi controller that uses IMyDataProviderShould I create and configure one container for each type of lifestyle ?When I register everything with RegisterPerWebRequest<T> is works in both types of controllers. Is this safe ? Or will I run into trouble when using async/await in a Web API controller?What is the best configuration when I have both MVC and Web API controllers who get injected the same instances ?Should I use a hybrid lifestyle ?Now to complicate things... our application also uses background tasks and SignalR.Both of these will sometimes occur outside of a WebRequest and need access to the same objects as described above.The best solution would be to use a Lifetime scope ?Would I need to create a new container for that lifestyle? or can I reuse/reconfigure my MVC/Web API container ?Is there a triple lifestyle? <code> ","How to configure simple injector container and lifestylse in a MVC web app with WebAPI, WCF, SignalR and Background Task"
Is it possible to ignore Excel warning when generate spreadsheet using EPPlus, I'm storing mix of numeric and non-numeric values in a single column in spreadsheet using C# and EPPlus. When I open spreadsheet with Excel it shows green triangles in the cells with numeric values giving warning that 'Number Stored as Text' and giving option to ignore it for particular cell. Can I do it from code or is it some Excel specific feature? <code> ,Is it possible to ignore Excel warnings when generating spreadsheets using EPPlus?
which is the difference between WaitAll and WhenAll? One case give me results and the other doesn't," I have this code: If I use Task.WhenAll, misClasificaciones does not have any element but when I use awit all I get all the elements that I request to the database.When to use WhenAll and when to use WaitAll? <code>  List<ComponentesClasificaciones> misClasificaciones = new List<ComponentesClasificaciones>(); Task tskClasificaciones = Task.Run(() => { misClasificaciones = VariablesGlobales.Repositorio.buscarComponentesClasificacionesTodosAsync().Result; });Task.WhenAll(tskClasificaciones);List<ComponentesClasificaciones> misVClasificacionesParaEstructuras = new List<ComponentesClasificaciones>(misClasificaciones);",What is the difference between WaitAll and WhenAll?
How to declare an anonymous type member with a simple name," When you try to compile this: You will get the compiler error ""Invalid anonymous type member declarator. Anonymous type members must be declared with a member assignment, simple name or member access."" because the compiler is not able to infer the name of the properties from the respective expressions. That makes total sense.What makes me curious is that the error message implies three valid ways to declare a type member. Member assignment and member access are obvious: What would be an example of declaring with a simple name? Googling and the related questions on SO result in examples of member assignment and member access only. <code>  var car = new { ""toyota"", 5000 }; // member assignmentvar v = new { Amount = 108, Message = ""Hello"" };// member accessvar productQuery = from prod in products select new { prod.Color, prod.Price };",Declaring an anonymous type member with a simple name
LINQ with Lambda expression TakeWhile," I'm learning LINQ using the 101 LINQ Samples in the MSDN page and I came across this code: The purpose of this function is to ""use TakeWhile to return elements starting from the beginning of the array until a number is hit that is less than its position in the array.""How exactly the n and index know which parameter to take? (i.e. how does n know it will take 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 and how does index know it will do an increment of 0, 1, 2, 3...)? <code>  int[] numbers = { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 };var firstSmallNumbers = numbers.TakeWhile((n, index) => n >= index);foreach (var n in firstSmallNumbers){ Console.WriteLine(n);}",How do lambda parameters map in TakeWhile?
C# floating point literals : Why compiler does not DEFAULTS to the right hand side variable type," To declare float numbers we need to put 'f' for floats and 'd' for doubles. Example: It is said that C# defaults to double if a floating point literal is omitted.My question, is what prevents a modern language like 'C#' to 'DEFAULTS' to the left hand side variable type? After all, the compiler can see the entire line of code.Is this for historic reasons in compiler design? or Is there something I'm not getting.  <code>  float num1 = 1.23f; // float stored as floatfloat num2 = 1.23; // double stored as float. The code won't compile in C#.",C# floating point literals : Why compiler does not DEFAULTS to the left hand side variable type
"Azure DocumentDb error ""Query must evalutate to IEnumerable"""," I am having issues in trying to query my Azure DocumentDb storage account when attempting to retrieve a single record. This is my WebAPI code: It is this FindById method which causes the following issue:An exception of type 'Microsoft.Azure.Documents.Linq.DocumentQueryException' occurred in Microsoft.Azure.Documents.Client.dll but was not handled in user codeAdditional information: Query expression is invalid, expression return typeFoo.Models.DocumentDbEntities.UserDetail is unsupported. Query must evaluate to IEnumerable.I don't understand what this error means, or how I fix it. I don't wish to return an IEnumerable or any descendant class as this method will return either 0 or 1 records. It works if I remove the SingleOrDefault clause, and change the return type to an IQueryable, however this is not what I want. <code>  // Controller...public AccountController : ApiController { // other actions... [HttpGet] [Route(""Profile"")] public HttpResponseMessage Profile() { var userId = User.Identity.GetUserId(); var rep = new DocumentRepository<UserDetail>(); var profile = rep.FindById(userId); if (profile == null) return Request.CreateErrorResponse(HttpStatusCode.NotFound, ""Profile not found""); return Request.CreateResponse(HttpStatusCode.OK, profile); }}// Repositorypublic class DocumentRepository<TEntity> : IDocumentRepository<TEntity> where TEntity : IIdentifiableEntity{ private static DocumentClient _client; private static string _databaseName; private static string _documentsLink; private static string _selfLink; public DocumentRepository() { _client = new DocumentClient(new Uri(ConfigurationManager.AppSettings[""DocumentDbEndpointUrl""]), ConfigurationManager.AppSettings[""DocumentDbAuthKey""]); _databaseName = ConfigurationManager.AppSettings[""DocumentDbDatabaseName""]; var _database = ReadOrCreateDatabase(); var collection = InitialiseCollection(_database.SelfLink, EntityName); _documentsLink = collection.DocumentsLink; _selfLink = collection.SelfLink; } // other methods... public TEntity FindById(string id) { return _client.CreateDocumentQuery<TEntity>(_documentsLink).SingleOrDefault(u => u.Id.ToString() == id); }}","Azure DocumentDb error ""Query must evaluate to IEnumerable"""
C# wcf - (413) Request Entity Too Large," I have WCF service, and I have a method when I want to pass parameter as big string (over 1mb)I run this wcf and in WCF Test Client I changed configuration as is shown below: And when I try invoke this method I still have 413 request entity too large. <code>  <?xml version=""1.0"" encoding=""utf-8""?><configuration> <system.serviceModel> <bindings> <basicHttpBinding> <binding name=""BasicHttpBinding_IMyService"" sendTimeout=""00:05:00"" maxBufferSize=""2147483647"" maxReceivedMessageSize=""2147483647""> <readerQuotas maxDepth=""2147483647"" maxStringContentLength=""2147483647"" maxArrayLength=""2147483647"" maxBytesPerRead=""2147483647"" maxNameTableCharCount=""2147483647"" /> </binding> </basicHttpBinding> </bindings>",(413) Request Entity Too Large
Calculating Integer Percentage in C#, So I would like to calculate the percentage progress of my program as the nearest integer valueIn my examples lets take So First I tried: This returned TotalProgress = 0Then I tried This gives compiler error saying Cannot implicitly convert type decimal to intIve tried and get The call is ambiguous between decimal and doubleand so now I've come here for help? <code>  int FilesProcessed = 42;int TotalFilesToProcess = 153; Int TotalProgress = ((FilesProcessed / TotalFilesToProcess) * 100) Int TotalProgress = (int)((FilesProcessed / TotalFilesToProcess) * 100) Int TotalProgress = Math.Round((FilesProcessed / TotalFilesToProcess) * 100),Calculating Integer Percentage
Why does Enumerable.Empty() returns an empty array?," I expected the implementation of Enumerable.Empty() to be just this: But the implementation is something like this: Why does the implementation is more complex than just one line of code? Is there an advantage to return a cached array and not (yield) return no elements?Note: I will never rely on the implementation details of a method, but I am just curious. <code>  public static IEnumerable<TResult> Empty<TResult>(){ yield break;} public static IEnumerable<TResult> Empty<TResult>(){ return EmptyEnumerable<TResult>.Instance;}internal class EmptyEnumerable<TElement>{ private static volatile TElement[] instance; public static IEnumerable<TElement> Instance { get { if (EmptyEnumerable<TElement>.instance == null) EmptyEnumerable<TElement>.instance = new TElement[0]; return (IEnumerable<TElement>)EmptyEnumerable<TElement>.instance; } }}",Why does Enumerable.Empty() return an empty array?
C#6 ref keyword error," I tried VS2015 with my exisiting solution and I get some valid new errors (like unreachable code that the compiler didn't catch before), but I also get an error for example on this line: I get the following error: Error CS1503 Argument 3: cannot convert from 'ref bool [mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]' to 'ref bool [mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]'I cannot see why it would throw that error, obviously the types do match. Is this a bug in the new compiler or has the behaviour of the ref keyword changed?The function in this case is a C++ function which is imported to C# using a c# class derived from the c++ class. It's signature is this: It might be good to mention that I opted to use the VS2013 c++ compiler for the c++ sources in the solution for now, so the c++ side should be the same as before. My guess is that something in the interop between c# and c++ changed. <code>  bool bWasAlreadyLocked = false;oEnv.LockDoc(oWarnings, oEventDoc, ref bWasAlreadyLocked); void CBkgDocEnvX::LockDoc(CFIWarningList ^oWarnings,CBaseDoc ^oBaseDoc,// Outputbool %rbWasAlreadyLocked)",C#6/C++ ref keyword error
Prism EvenAggregator difference between PubSubEvent<TPayload> Class and CompositePresentationEvent<TPayload> Class, Im trying to get my EventAggregator in Prism working based on this example MSDN.After having some problems that where caused by mixing up class references i would like to know the difference of:PubSubEvent Class MSDNand CompositePresentationEvent Class MSDNI couldnt find a more detailed information. And both references say Defines a class that manages publication and subscription to events. So far so good. But when to use them or which of them?What is the difference?Maybe somebody can help me on this. <code> ,Prism EventAggregator difference between PubSubEvent<TPayload> Class and CompositePresentationEvent<TPayload> Class
WIX - custom action with value," I'm trying to create a custom action with ""Value"" attribute, I want to pass parameters to the C# code (the TARGETDIR and the version).However, I get an error stating that DLLENtry and Value cannot coexist. But the custom action without dllentry is invalid.This is the code: And for it I get this error: Error 9 ICE68: Invalid custom action type for action 'SetMAWPrefferences'. Any ideas how to do it? <code>  <CustomAction Id=""SetMAWPrefferences"" Value=""InstallDir=[TARGETDIR];Version=2.0.0.1"" Return=""check"" Execute=""commit"" BinaryKey=""ImportExportBinary"" />",How to pass parameters to the custom action?
"How do you ignore Whitespace or Empty lines when using CsvHelper, CsvReader.Read()?"," When using the CsvHelper library and in particular the CsvReader.Read() function, is there a way to ignore blank records and/or whitespace?I need to return the raw string[] but was hoping, I could do some cleanup functions when parsing with the library.I've checked Github and CsvReader.Read() seems to use SkipEmptyRecords but this doesn't work for me as I have whitespace.Here's my csv file, its encoded in UTF8 without BOM.I've tried ASCII encoding, just in case I missed something but that didn't work either.If no one knows I'll chat to Josh and submit a git request with a fix.Reference: http://joshclose.github.io/CsvHelper/ <code> ","How do you ignore Whitespace when using CsvHelper, CsvReader.Read()?"
What is the idea behind IIdentity and IPrincipal in .Net," So, what is the purpose for existence of both IIdentity and IPrincipal, and not some IIdentityMergedWithPrincipal? When is it not enough to implement both in same class?Also, to understand purpose, I'd like to know where this concept comes from:It is originated in .NetThere is concept of Identity/Principal as design pattern, which System.Security.Principal implemented in those interfacesIt is originated somewhere else and supported for compatibilityTherefore, does UserPrincipal from System.DirectoryServices act similarly to IPrincipal but not implement it by accident or by intention?P.S. I'm looking for reasoning behind idea, not benefits/controversies comparison, so please try not to start opinion-based discussion <code> ",What is the idea behind IIdentity and IPrincipal in .NET
Xamarin.Forms - LstView does not update when data changes," Problem: Data changes but ListView does not updateI have a ListView whose ItemsSource is set to On click of a button I update the query to only return records that contain the letters ""Je"". I can see that the right thing is being returned, and that ContactsGrouped is being updated, but the UI does not change. where Grouping looks like this: Given that I'm using ObservableCollections, I'd expect the list to redraw. Am I missing something obvious? <code>  <ListView ItemsSource=""{Binding ContactsGrouped}"" public ObservableCollection<Grouping<string, Contact>> ContactsGrouped { get; set; } public class Grouping<K, T> : ObservableCollection<T>{ public K Key { get; private set; } public Grouping ( K key, IEnumerable<T> items ) { Key = key; foreach ( var item in items ) this.Items.Add( item ); }}",Xamarin.Forms - ListView does not update when data changes
Save As when Returning FileStreamResult from MVC Controller," I am attempting to download a file from Azure Storage in the form of an CloudBlockBlob. I want to allow the user to select where to put the downloaded file, so I have written the following code to do this This downloads the file from the blob storage fine, but when the controller returns to the view using FileStreamResult, the browser is launching the save file dialog as expected but the file size is 0 bytes. The Stream shows that the correct file size, but when I do the data does not seem to be passed to the save dialog.How can I get the file to save properly?Thanks for your time. <code>  [AllowAnonymous]public async Task<ActionResult> DownloadFile(string displayName){ ApplicationUser user = null; if (ModelState.IsValid) { user = await UserManager.FindByIdAsync(User.Identity.GetUserId()); // Retrieve storage account and blob client. CloudStorageAccount storageAccount = CloudStorageAccount.Parse( ConfigurationManager.AppSettings[""StorageConnectionString""]); CloudBlobClient blobClient = storageAccount.CreateCloudBlobClient(); CloudBlobContainer container = blobClient.GetContainerReference( VisasysNET.Utilities.Constants.ContainerName); // If the container does not exist, return error. if (container.Exists()) { foreach (IListBlobItem item in container.ListBlobs(null, false)) { if (item.GetType() == typeof(CloudBlockBlob)) { CloudBlockBlob blob = (CloudBlockBlob)item; if (blob.Name.CompareNoCase(displayName)) { string contentType = String.Format( ""application/{0}"", Path.GetExtension(displayName).TrimStart('.')); // No need to dispose, FileStreamResult will do this for us. Stream stream = new MemoryStream(); await blob.DownloadRangeToStreamAsync(stream, null, null); return File(stream, contentType, displayName); } } } return RedirectToAction(""Index"", ""Tools""); } } return new HttpStatusCodeResult(HttpStatusCode.ServiceUnavailable);} return File(stream, contentType, displayName);",File Size Goes to Zero when Returning FileStreamResult from MVC Controller
Reworking PDF signer to work with MemoryStreams in c# using itextsharp," It came to me to rework old code which signs PDF files into new one, which signs MemoryStreams (byte arrays) that come and are sent by web services. Simple, right? Well, that was yesterday. Today I just can't get it to work.This is the old code, which uses FileStreams and it works: Below is what I've redone myself which throws System.ObjectDisposedException: Cannot access a closed Stream. and if I comment out it creates an empty document. What am I doing wrong? <code>  public static string OldPdfSigner(PdfReader pdfReader, string destination, string password, string reason, string location, string pathToPfx) { using (FileStream pfxFile = new FileStream(pathToPfx, FileMode.Open, FileAccess.Read)) { ... using (PdfStamper st = PdfStamper.CreateSignature(pdfReader, new FileStream(destination, FileMode.Create, FileAccess.Write), '\0')) { PdfSignatureAppearance sap = st.SignatureAppearance; sap.SetCrypto(key, chain, null, PdfSignatureAppearance.WINCER_SIGNED); sap.Reason = reason; sap.Location = location; return destination; } } } public static byte[] PdfSigner(PdfReader pdfReader, string password, string reason, string location, string pathToPfx) { using (FileStream pfxFile = new FileStream(pathToPfx, FileMode.Open, FileAccess.Read)) { ... MemoryStream outputStream = new MemoryStream(); using (PdfStamper st = PdfStamper.CreateSignature(pdfReader, outputStream, '\0')) { st.Writer.CloseStream = false; PdfSignatureAppearance sap = st.SignatureAppearance; sap.SetCrypto(key, chain, null, PdfSignatureAppearance.WINCER_SIGNED); sap.Reason = reason; sap.Location = location; st.Close(); outputStream.Position = 0; return outputStream.ToArray(); } } } st.Close();","Getting PdfStamper to work with MemoryStreams (c#, itextsharp)"
Making PDF signer to work with MemoryStreams in c# using itextsharp," It came to me to rework old code which signs PDF files into new one, which signs MemoryStreams (byte arrays) that come and are sent by web services. Simple, right? Well, that was yesterday. Today I just can't get it to work.This is the old code, which uses FileStreams and it works: Below is what I've redone myself which throws System.ObjectDisposedException: Cannot access a closed Stream. and if I comment out it creates an empty document. What am I doing wrong? <code>  public static string OldPdfSigner(PdfReader pdfReader, string destination, string password, string reason, string location, string pathToPfx) { using (FileStream pfxFile = new FileStream(pathToPfx, FileMode.Open, FileAccess.Read)) { ... using (PdfStamper st = PdfStamper.CreateSignature(pdfReader, new FileStream(destination, FileMode.Create, FileAccess.Write), '\0')) { PdfSignatureAppearance sap = st.SignatureAppearance; sap.SetCrypto(key, chain, null, PdfSignatureAppearance.WINCER_SIGNED); sap.Reason = reason; sap.Location = location; return destination; } } } public static byte[] PdfSigner(PdfReader pdfReader, string password, string reason, string location, string pathToPfx) { using (FileStream pfxFile = new FileStream(pathToPfx, FileMode.Open, FileAccess.Read)) { ... MemoryStream outputStream = new MemoryStream(); using (PdfStamper st = PdfStamper.CreateSignature(pdfReader, outputStream, '\0')) { st.Writer.CloseStream = false; PdfSignatureAppearance sap = st.SignatureAppearance; sap.SetCrypto(key, chain, null, PdfSignatureAppearance.WINCER_SIGNED); sap.Reason = reason; sap.Location = location; st.Close(); outputStream.Position = 0; return outputStream.ToArray(); } } } st.Close();","Getting PdfStamper to work with MemoryStreams (c#, itextsharp)"
Getting Type of (fnptr)*," The following IL code creates a Type instance named (fnptr)* (token 0x2000000 - invalid, module mscorlib.dll). What's the purpose of this type? Is it possible to create this type instance in C# without writing any IL code, maybe with reflection? Module.ResolveType on the token throws ArgumentOutOfRangeException.Edit:It's clear the (fnptr) type is an internal CLR type representation of an IL method pointer type, though when removing the last *, it simply returns IntPtr.Edit #2:The (fnptr) comes from a function that can be seen in the SSCLI typestring.cpp: Why basic fnptr returns IntPtr can be seen in typehandle.cpp: [...] So it looks they've forgotten to fix it. <code>  ldtoken method void* ()*call class [mscorlib]System.Type [mscorlib]System.Type::GetTypeFromHandle(valuetype [mscorlib]System.RuntimeTypeHandle) // ...or function pointerelse if (ty.IsFnPtrType()){ // Don't attempt to format this currently, it may trigger GC due to fixups. tnb.AddName(L""(fnptr)"");} OBJECTREF TypeHandle::GetManagedClassObject() const{ switch(GetInternalCorElementType()) { case ELEMENT_TYPE_ARRAY: case ELEMENT_TYPE_SZARRAY: case ELEMENT_TYPE_BYREF: case ELEMENT_TYPE_PTR: return ((ParamTypeDesc*)AsTypeDesc())->GetManagedClassObject(); case ELEMENT_TYPE_VAR: case ELEMENT_TYPE_MVAR: return ((TypeVarTypeDesc*)AsTypeDesc())->GetManagedClassObject(); // for this release a function pointer is mapped into an IntPtr. This result in a loss of information. Fix next release case ELEMENT_TYPE_FNPTR: return TheIntPtrClass()->GetManagedClassObject(); default: _ASSERTE(!""Bad Element Type""); return NULL; } }}",What is the (fnptr)* type and how to create it?
What is the (fnptr)* type?," The following IL code creates a Type instance named (fnptr)* (token 0x2000000 - invalid, module mscorlib.dll). What's the purpose of this type? Is it possible to create this type instance in C# without writing any IL code, maybe with reflection? Module.ResolveType on the token throws ArgumentOutOfRangeException.Edit:It's clear the (fnptr) type is an internal CLR type representation of an IL method pointer type, though when removing the last *, it simply returns IntPtr.Edit #2:The (fnptr) comes from a function that can be seen in the SSCLI typestring.cpp: Why basic fnptr returns IntPtr can be seen in typehandle.cpp: [...] So it looks they've forgotten to fix it. <code>  ldtoken method void* ()*call class [mscorlib]System.Type [mscorlib]System.Type::GetTypeFromHandle(valuetype [mscorlib]System.RuntimeTypeHandle) // ...or function pointerelse if (ty.IsFnPtrType()){ // Don't attempt to format this currently, it may trigger GC due to fixups. tnb.AddName(L""(fnptr)"");} OBJECTREF TypeHandle::GetManagedClassObject() const{ switch(GetInternalCorElementType()) { case ELEMENT_TYPE_ARRAY: case ELEMENT_TYPE_SZARRAY: case ELEMENT_TYPE_BYREF: case ELEMENT_TYPE_PTR: return ((ParamTypeDesc*)AsTypeDesc())->GetManagedClassObject(); case ELEMENT_TYPE_VAR: case ELEMENT_TYPE_MVAR: return ((TypeVarTypeDesc*)AsTypeDesc())->GetManagedClassObject(); // for this release a function pointer is mapped into an IntPtr. This result in a loss of information. Fix next release case ELEMENT_TYPE_FNPTR: return TheIntPtrClass()->GetManagedClassObject(); default: _ASSERTE(!""Bad Element Type""); return NULL; } }}",What is the (fnptr)* type and how to create it?
How to do a registration in SimpleInjector after a GetInstance call / Alternate solution?," Consider the following example: Problem:While performing registrations (using SimpleInjector), I need to provide values that are obtained from an instance of SetingsManager and fill ServerSettings instance (concrete type for IServerSettings) but if I call GetInstance<ISettingsManager> before registering CommunicationClient, it gives me an error that I cannot do thatError: The container can't be changed after the first call to GetInstance, GetAllInstances and Verify.)One solution could be to inject ISettingsManager as a dependency to CommunicationClient but I really don't want to pass it as it would provide more than required information to it.EDIT: Container Registration Any suggestions/alternative solutions on how to achieve above in a cleaner way? Thanks. <code>  public class CommunicationClient : IClient{ public CommunicationClient(IServerSettings settings) { ... } // Code }public class SettingsManager : ISettingsManager{ SettingsManager(IDbSettingManager manager) // Code public IDictionary<string, string> GetSettings() { ... }} container.Register(typeof(ICommunicationClient), typeof(CommunicationClient));ISettingsManager settingsManager = container.GetInstance<ISettingsManager>();string url = settingsManager.GetSetting(""url"");string userName = settingsManager.GetSetting(""username"");string password = settingsManager.GetSetting(""password"");container.Register(typeof(IServerConfiguration), () => new ServerConfiguration(url, userName, password);",How to do a registration in Simple Injector after a GetInstance call / Alternate solution?
C# XNA/Monogame - get display resolution," How to get display resolution in XNA/Monogame ? I tried these on my monitor (1600x900):The below give me 800,600 <code>  //1.GraphicsDevice.DisplayMode.WidthGraphicsDevice.DisplayMode.Height//2.GraphicsDeviceManager graphics = new GraphicsDeviceManager(this);graphics.GraphicsDevice.DisplayMode.Widthgraphics.GraphicsDevice.DisplayMode.Height//3.GraphicsAdapter.DefaultAdapter.CurrentDisplayMode.WidthGraphicsAdapter.DefaultAdapter.CurrentDisplayMode.Height//4.foreach (DisplayMode dm in GraphicsAdapter.DefaultAdapter.SupportedDisplayModes){ Console.WriteLine(dm.Width); Console.WriteLine(dm.Height);}",How to get display resolution (screen size)?
get display resolution," How to get display resolution in XNA/Monogame ? I tried these on my monitor (1600x900):The below give me 800,600 <code>  //1.GraphicsDevice.DisplayMode.WidthGraphicsDevice.DisplayMode.Height//2.GraphicsDeviceManager graphics = new GraphicsDeviceManager(this);graphics.GraphicsDevice.DisplayMode.Widthgraphics.GraphicsDevice.DisplayMode.Height//3.GraphicsAdapter.DefaultAdapter.CurrentDisplayMode.WidthGraphicsAdapter.DefaultAdapter.CurrentDisplayMode.Height//4.foreach (DisplayMode dm in GraphicsAdapter.DefaultAdapter.SupportedDisplayModes){ Console.WriteLine(dm.Width); Console.WriteLine(dm.Height);}",How to get display resolution (screen size)?
ASp.NET - Postback Fails On Default Document," So I've created a Web Application (not Web Site) with ASP.NET (C#) and it compiles just fine in the VS13 environment. But when I publish it on IIS, the Postback on the Default Document fails. The Default Document is called LoginPage.aspx. As soon as I click the <asp:Button> to run my code behind, all it does is refresh the page. This project has been published on my local 127.0.0.1 IP address for the time being.I know this has been a documented issue, but I've tried many solutions and have not come across a resolution. Some solutions I have attempted:Creating a brand new Web App with minimal code to attempt accessing any Postback with no success.I tried the first solution presented here with no success: https://stackoverflow.com/a/7367076/4204026I also tried URL mappings: I'm honestly at a loss as to what's happening here. One thing I did notice is when the application is being run through Visual Studio, the <form> tag on the LoginPage.aspx appears in Chrome as: Through IIS: Not sure if that's a problem either. I tried hard-coding the action to login to see what would happen and it does redirect to the correct page, but as suspected no Postback was fired - My Session variable returned null and no query string was used.Here's the related LoginPage.aspx front-end code (trimmed out a bunch of unrelated HTML): And the LoginBtn_Click method in LoginPage.aspx.cs: Final pieces of info:Running IIS 8.0Application created with 4.5 Framework, Application Pool is also 4.5 FrameworkI have ensured that ASP.NET is installed on IISI do have URL ReWriting in the global.asax file, though I'm not sure if that is related in any way (I don't see how).I have no Default.aspx pageEDIT:Just tested the project through 127.0.0.1 on IE11 and FF with the same result.EDIT #2:Additional things I have tried with no success:I tried removing my URL RewritingI tried adding an empty URL Rewrite rule, i.e. (""Empty URL"", """", ""~/Views/LoginPage.aspx"")Additional notes:I do not use TelerikI do not use ISAPIThe project in Visual Studio was set to debug and not release <code>  <urlMappings> <add url=""~/login"" mappedUrl=""~/Views/LoginPage.aspx"" /> <add url=""~/login/"" mappedUrl=""~/Views/LoginPage.aspx"" /></urlMappings> <form method=""post"" action=""LoginPage"" id=""ct101"" class="".myForm""> <form method=""post"" action=""./"" id=""ct101"" class="".myForm""> <%@ Page Title=""DREW KENNEDY | WELCOME"" Language=""C#"" MasterPageFile=""Site.Master"" AutoEventWireup=""true"" CodeBehind=""LoginPage.aspx.cs"" Inherits=""MyMedia.Views.LoginPage"" %><asp:Content ID=""BodyContent"" ContentPlaceHolderID=""MainContent"" runat=""server""> <!-- form is located on Site.Master --> <asp:Button OnClick=""LoginBtn_Click"" CssClass=""login"" runat=""server"" name=""submit"" Text=""Sign In"" /></asp:Content> protected void LoginBtn_Click(object sender, EventArgs e) { //Tried the following line while commenting out everything else to make sure Postback is being ignored //Response.Write(""<script>alert('Test');</script>""); try { AbstractPersistenceDecorator decorator = new PersistenceDecorator(); string uname = username.Text.Trim();//username is a TextBox Control string pass = password.Text.Trim();//password is a TextBox control bool isCookieRequested = CheckBox.Checked; if (decorator.authenticate(uname, pass)) {//calling SQL Server for authentication User AuthenticatedUser = (User)Session[""User""] ?? decorator.getUserInfo(uname); if (Session[""User""] == null) Session[""User""] = AuthenticatedUser; if (isCookieRequested) { HttpCookie cookie = new HttpCookie(""username"", AuthenticatedUser.Username); cookie.Expires.AddDays(7); Response.Cookies.Add(cookie); } else { Session.Timeout = 15; } Thread.Sleep(1600); //string redirect = string.Format(""dashboard?username={0}"", AuthenticatedUser.Username); Response.Redirect(""dashboard?username="" + AuthenticatedUser.Username); } } catch (Exception ex) { //who cares? } }",Postback Fails On Default Document
ASP.NET - Postback Fails On Default Document," So I've created a Web Application (not Web Site) with ASP.NET (C#) and it compiles just fine in the VS13 environment. But when I publish it on IIS, the Postback on the Default Document fails. The Default Document is called LoginPage.aspx. As soon as I click the <asp:Button> to run my code behind, all it does is refresh the page. This project has been published on my local 127.0.0.1 IP address for the time being.I know this has been a documented issue, but I've tried many solutions and have not come across a resolution. Some solutions I have attempted:Creating a brand new Web App with minimal code to attempt accessing any Postback with no success.I tried the first solution presented here with no success: https://stackoverflow.com/a/7367076/4204026I also tried URL mappings: I'm honestly at a loss as to what's happening here. One thing I did notice is when the application is being run through Visual Studio, the <form> tag on the LoginPage.aspx appears in Chrome as: Through IIS: Not sure if that's a problem either. I tried hard-coding the action to login to see what would happen and it does redirect to the correct page, but as suspected no Postback was fired - My Session variable returned null and no query string was used.Here's the related LoginPage.aspx front-end code (trimmed out a bunch of unrelated HTML): And the LoginBtn_Click method in LoginPage.aspx.cs: Final pieces of info:Running IIS 8.0Application created with 4.5 Framework, Application Pool is also 4.5 FrameworkI have ensured that ASP.NET is installed on IISI do have URL ReWriting in the global.asax file, though I'm not sure if that is related in any way (I don't see how).I have no Default.aspx pageEDIT:Just tested the project through 127.0.0.1 on IE11 and FF with the same result.EDIT #2:Additional things I have tried with no success:I tried removing my URL RewritingI tried adding an empty URL Rewrite rule, i.e. (""Empty URL"", """", ""~/Views/LoginPage.aspx"")Additional notes:I do not use TelerikI do not use ISAPIThe project in Visual Studio was set to debug and not release <code>  <urlMappings> <add url=""~/login"" mappedUrl=""~/Views/LoginPage.aspx"" /> <add url=""~/login/"" mappedUrl=""~/Views/LoginPage.aspx"" /></urlMappings> <form method=""post"" action=""LoginPage"" id=""ct101"" class="".myForm""> <form method=""post"" action=""./"" id=""ct101"" class="".myForm""> <%@ Page Title=""DREW KENNEDY | WELCOME"" Language=""C#"" MasterPageFile=""Site.Master"" AutoEventWireup=""true"" CodeBehind=""LoginPage.aspx.cs"" Inherits=""MyMedia.Views.LoginPage"" %><asp:Content ID=""BodyContent"" ContentPlaceHolderID=""MainContent"" runat=""server""> <!-- form is located on Site.Master --> <asp:Button OnClick=""LoginBtn_Click"" CssClass=""login"" runat=""server"" name=""submit"" Text=""Sign In"" /></asp:Content> protected void LoginBtn_Click(object sender, EventArgs e) { //Tried the following line while commenting out everything else to make sure Postback is being ignored //Response.Write(""<script>alert('Test');</script>""); try { AbstractPersistenceDecorator decorator = new PersistenceDecorator(); string uname = username.Text.Trim();//username is a TextBox Control string pass = password.Text.Trim();//password is a TextBox control bool isCookieRequested = CheckBox.Checked; if (decorator.authenticate(uname, pass)) {//calling SQL Server for authentication User AuthenticatedUser = (User)Session[""User""] ?? decorator.getUserInfo(uname); if (Session[""User""] == null) Session[""User""] = AuthenticatedUser; if (isCookieRequested) { HttpCookie cookie = new HttpCookie(""username"", AuthenticatedUser.Username); cookie.Expires.AddDays(7); Response.Cookies.Add(cookie); } else { Session.Timeout = 15; } Thread.Sleep(1600); //string redirect = string.Format(""dashboard?username={0}"", AuthenticatedUser.Username); Response.Redirect(""dashboard?username="" + AuthenticatedUser.Username); } } catch (Exception ex) { //who cares? } }",Postback Fails On Default Document
.net operator overloading vb vs c#, I have a VB class which overloads the Not operator; this doesn't seem to be usable from C# applications. I can use this in VB.NET: I am trying to us this in a C# application but it won't build. I get the error Operator '!' cannot be applied to operand of type 'MyClass'Can anyone tell me what I am missing? <code>  Public Shared Operator Not(item As MyClass) As Boolean Return FalseEnd Operator If Not MyClassInstance Then ' Do somethingEnd If if (!MyClassInstance) { // do something},Using overloaded VB.NET Not operator from C#
"ReSharper 9 ""File Layout / Type Member Layout"" not working on Cleanup"," I switched from R# 8 to R# 9. When I import my type members layout and then choose ReSharper -> Tools -> Cleanup Code... it will apply the ordering but no regions are visible. It simply reorders the items. So, how can I get my regions back? <code> ","ReSharper 9 ""File Layout / Type Member Layout"" without regions"
creating a zip file from an object directly," I am writing a REST API which will take in a JSON request object. The request object will have to be serialized to a file in JSON format; the file has to be compressed into a zip file and the ZIP file has to be posted to another service, for which I would have to deserialize the ZIP file. All this because the service I have to call expects me to post data as ZIP file. I am trying to see if I can avoid disk IO. Is there a way to directly convert the object into a byte array representing ZIP content in-memory instead of all the above steps?Note : I'd prefer accomplishing this using .net framework libraries (as against external libraries) <code> ",creating a zip file from an object directly without disk IO
Progress<T> doesn't has Report function," I have windows form app this is my code: I get compilation error that ""System.Progress' does not contain a definition for 'Report' and no extension method 'Report' accepting a first argument of type 'System.Progress' could be found (are you missing a using directive or an assembly reference?)""butIf you look at Progress class: and the interface IProgress has function Report: What am I missing?  <code>  private async void btnGo_Click(object sender, EventArgs e) { Progress<string> labelVal = new Progress<string>(a => labelValue.Text = a); Progress<int> progressPercentage = new Progress<int>(b => progressBar1.Value = b); // MakeActionAsync(labelVal, progressPercentage); await Task.Factory.StartNew(()=>MakeActionAsync(labelVal,progressPercentage)); MessageBox.Show(""Action completed""); } private void MakeActionAsync(Progress<string> labelVal, Progress<int> progressPercentage) { int numberOfIterations=1000; for(int i=0;i<numberOfIterations;i++) { Thread.Sleep(10); labelVal.Report(i.ToString()); progressPercentage.Report(i*100/numberOfIterations+1); } } public class Progress<T> : IProgress<T> public interface IProgress<in T>{ // Summary: // Reports a progress update. // // Parameters: // value: // The value of the updated progress. void Report(T value);}",Progress<T> doesn't have Report function
Weird behaviour with fi statement containing exception," Given this gem of code: Given the this.IsAdmin yields true - I would expect the debugger to not enter that if statement. In reality it does - and it steps over the throw but does not actually throw!Now this only happens when you have an exception inside an if statement followed by a try/catch block, on Visual Studio 2013, targeting .NET Framework 4, 64 bit, ""Prefer 32 bit"" unchecked. I have confirmed this oddity with colleagues on different machines. Step though the following code and the debugger will seem to step into the if branch, but no exception is thrown:I am in debug mode, I have tried compiling and cleaning the project multiple times.Can anyone explain why this is happening? <code>  class Program{ private static bool IsAdmin = true; static void Main(string[] args) { if (!IsAdmin) { throw new Exception(); } try { var x = 2342342; var y = 123132; } catch (Exception) { throw; } }}",Debugger stepping into if() block where condition is false
Weird behaviour with if statement containing exception," Given this gem of code: Given the this.IsAdmin yields true - I would expect the debugger to not enter that if statement. In reality it does - and it steps over the throw but does not actually throw!Now this only happens when you have an exception inside an if statement followed by a try/catch block, on Visual Studio 2013, targeting .NET Framework 4, 64 bit, ""Prefer 32 bit"" unchecked. I have confirmed this oddity with colleagues on different machines. Step though the following code and the debugger will seem to step into the if branch, but no exception is thrown:I am in debug mode, I have tried compiling and cleaning the project multiple times.Can anyone explain why this is happening? <code>  class Program{ private static bool IsAdmin = true; static void Main(string[] args) { if (!IsAdmin) { throw new Exception(); } try { var x = 2342342; var y = 123132; } catch (Exception) { throw; } }}",Debugger stepping into if() block where condition is false
Namespace vs parent class," I am considering these two scenarios: and The thing is that inside ""StructuralCase"" I won't be declaring any instance variables, e.g., it will function as a ""parent"" for the rest of classes.This lead me to consider converting StructuralClass to a namespace. What do you think about that? Is there any hard rule? <code>  class StructuralCase{ class Structure { ... } class Material { ... } class Forces { ... }} namespace StructuralCase{ class Structure { ... } class Material { ... } class Forces { ... }}",Namespace vs nesting class
Can Sessions conflict when encapsulated in a static class static property," I have an ASP.NET application that is accessed by 120-140 users at the same time on average. I use Session to get and set user specific info. To make things easy I've got a static a class called CurrentSession and it has a property called UserInfo: And whenever I needed current user's info I just used to do: Recently I've come across situations when wrong user info is retrieved. Is there a problem in my approach that can cause Session conflicts? <code>  public static class CurrentSession{ public static UserInfo{ get{return HttpContext.Current.Session[""userInfo""]!=null?(UserInfo)HttpContext.Current.Session[""userInfo""]:null;} set{HttpContext.Current.Session[""userInfo""]=value;} } //And other properties} CurrentSession.UserInfo;",Can Sessions conflict when encapsulated in a static class static property?
Popukate the textbox value based on another textbox from database in mvc," i'm trying to populate textbox value based on another textbox but i cannot populate the the other textbox. i'm sharing my code please guide me with best solutionAction Method: Script: It Throwing the error like:Conversion failed when converting the nvarchar value '' to data type int. <code>  public JsonResult AgreementNo(string id){ string no; string _str = id; SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings[""constr""].ToString()); SqlCommand cmd = new SqlCommand(""SELECT top(1) num from loan where id=@str"", con); cmd.Parameters.AddWithValue(""@str"",id); cmd.CommandType = CommandType.Text; DataSet ds = new DataSet(); SqlDataAdapter da = new SqlDataAdapter(cmd); da.Fill(ds); no = ds.Tables[0].Rows[0][""num""].ToString(); return Json(new { no = no }, JsonRequestBehavior.AllowGet); } $(""#BarrowerName"").blur(function () { $.ajax({ url: '@Url.Action(""AgreementNo"", ""Home"")', // url: '@Url.Action(""AgreementNo"", ""Home"")', dataType: ""json"", data: JSON.stringify({ id: $(""#BarrowerName"").val() }), type:""POST"", async: false, contentType: 'application/json,charset=utf-8', sucess: function (data) { $(""#AgreementNo"").val(data.no) response(data);}}); });",Populate the textbox value based on another textbox from database
Populate textbox value based on another textbox from database," i'm trying to populate textbox value based on another textbox but i cannot populate the the other textbox. i'm sharing my code please guide me with best solutionAction Method: Script: It Throwing the error like:Conversion failed when converting the nvarchar value '' to data type int. <code>  public JsonResult AgreementNo(string id){ string no; string _str = id; SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings[""constr""].ToString()); SqlCommand cmd = new SqlCommand(""SELECT top(1) num from loan where id=@str"", con); cmd.Parameters.AddWithValue(""@str"",id); cmd.CommandType = CommandType.Text; DataSet ds = new DataSet(); SqlDataAdapter da = new SqlDataAdapter(cmd); da.Fill(ds); no = ds.Tables[0].Rows[0][""num""].ToString(); return Json(new { no = no }, JsonRequestBehavior.AllowGet); } $(""#BarrowerName"").blur(function () { $.ajax({ url: '@Url.Action(""AgreementNo"", ""Home"")', // url: '@Url.Action(""AgreementNo"", ""Home"")', dataType: ""json"", data: JSON.stringify({ id: $(""#BarrowerName"").val() }), type:""POST"", async: false, contentType: 'application/json,charset=utf-8', sucess: function (data) { $(""#AgreementNo"").val(data.no) response(data);}}); });",Populate the textbox value based on another textbox from database
Populate the textbox value based on another textbox from database in mvc," i'm trying to populate textbox value based on another textbox but i cannot populate the the other textbox. i'm sharing my code please guide me with best solutionAction Method: Script: It Throwing the error like:Conversion failed when converting the nvarchar value '' to data type int. <code>  public JsonResult AgreementNo(string id){ string no; string _str = id; SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings[""constr""].ToString()); SqlCommand cmd = new SqlCommand(""SELECT top(1) num from loan where id=@str"", con); cmd.Parameters.AddWithValue(""@str"",id); cmd.CommandType = CommandType.Text; DataSet ds = new DataSet(); SqlDataAdapter da = new SqlDataAdapter(cmd); da.Fill(ds); no = ds.Tables[0].Rows[0][""num""].ToString(); return Json(new { no = no }, JsonRequestBehavior.AllowGet); } $(""#BarrowerName"").blur(function () { $.ajax({ url: '@Url.Action(""AgreementNo"", ""Home"")', // url: '@Url.Action(""AgreementNo"", ""Home"")', dataType: ""json"", data: JSON.stringify({ id: $(""#BarrowerName"").val() }), type:""POST"", async: false, contentType: 'application/json,charset=utf-8', sucess: function (data) { $(""#AgreementNo"").val(data.no) response(data);}}); });",Populate the textbox value based on another textbox from database
"Extend Microsoft.AspNet.Identity.IdentityExtensions eg: User.Identity.GetUserPhoneNumber(), User.Identity.GetUserById(int i)"," See this similar question: Need access more user properties in User.IdentityI would like to create custom authentication methods to use with my Razor Views that allows easy access IdentityUser properties relational to the User.Identity object but I am not sure how to go about it. I want to create several custom extensions similar to User.Identity.GetUserName(), User.Identity.GetUserById(), etc... instead of using this ViewContextExtension method. My Authentication type is currently the default type DefaultAuthenticationTypes.ApplicationCookie from VS2013 MVC5 template. As Shoe stated, I need this claim to be inserted after the user signs in.My questions is:How and where do you create a custom claim that has an out parameter of this IIdentity under IPrincipal?This would allow me to access User properties via CookieAuthentication in a View for entities in a DDD setting where I have multiple DbContexts in a single app using Identity 2.0. I will eventually use WebAPI, but for now I want to keep it as simple as possible. I have found this SO Q&A but it is geared towards Web Forms using Tickets. Not sure the difference between tickets and tokens either?This is the current approach that uses ViewContext from a base controller:View: BaseController.cs Extensions.cs What I am looking for is but where & how?View: SOLUTIONI simply edited the Extension.cs file and used inheritance for the Base controller which is used for the _LoginPartial.cshtml & edited the ViewContextExtension class: <code>  @using Microsoft.AspNet.Identity @using Globals.Helpers @using Identity //custom Identity for Domain @using Microsoft.AspNet.Identity.Owin @if (Request.IsAuthenticated) { var url = @ViewContext.BaseController().GetAvatarUrlById(User.Identity.GetUserId<int>()); //... } public string GetAvatarUrlById(int id) { var user = UserManager.FindById(id); return ""../../"" + user.ImageUrl; } public static class ViewContextExtension { public static BaseController BaseController(this ViewContext view) { var baseController = (BaseController)view.Controller; return baseController; } } <img src=""@User.Identity.GetAvatarUrl()"" alt=""User.Identity.GetAvatarUrl()"" /> #region ViewContextExt public static class ViewContextExtension { public static BaseController BaseController(this ViewContext view) { var baseController = (BaseController)view.Controller; return baseController; } public static string GetAvatarUrl(this IIdentity identity) { return ((ClaimsIdentity)identity).Claims.First(c => c.Type == ""AvatarUrl"").Value; } }}# endregion",Identity 2.0: Creating custom ClaimsIdentity eg: User.Identity.GetUserById<int>(int id) for Per Request Validation
Identity 2.0: Extending Microsoft.AspNet.Identity.IdentityExtensions eg: User.Identity.GetUserById(int i)," See this similar question: Need access more user properties in User.IdentityI would like to create custom authentication methods to use with my Razor Views that allows easy access IdentityUser properties relational to the User.Identity object but I am not sure how to go about it. I want to create several custom extensions similar to User.Identity.GetUserName(), User.Identity.GetUserById(), etc... instead of using this ViewContextExtension method. My Authentication type is currently the default type DefaultAuthenticationTypes.ApplicationCookie from VS2013 MVC5 template. As Shoe stated, I need this claim to be inserted after the user signs in.My questions is:How and where do you create a custom claim that has an out parameter of this IIdentity under IPrincipal?This would allow me to access User properties via CookieAuthentication in a View for entities in a DDD setting where I have multiple DbContexts in a single app using Identity 2.0. I will eventually use WebAPI, but for now I want to keep it as simple as possible. I have found this SO Q&A but it is geared towards Web Forms using Tickets. Not sure the difference between tickets and tokens either?This is the current approach that uses ViewContext from a base controller:View: BaseController.cs Extensions.cs What I am looking for is but where & how?View: SOLUTIONI simply edited the Extension.cs file and used inheritance for the Base controller which is used for the _LoginPartial.cshtml & edited the ViewContextExtension class: <code>  @using Microsoft.AspNet.Identity @using Globals.Helpers @using Identity //custom Identity for Domain @using Microsoft.AspNet.Identity.Owin @if (Request.IsAuthenticated) { var url = @ViewContext.BaseController().GetAvatarUrlById(User.Identity.GetUserId<int>()); //... } public string GetAvatarUrlById(int id) { var user = UserManager.FindById(id); return ""../../"" + user.ImageUrl; } public static class ViewContextExtension { public static BaseController BaseController(this ViewContext view) { var baseController = (BaseController)view.Controller; return baseController; } } <img src=""@User.Identity.GetAvatarUrl()"" alt=""User.Identity.GetAvatarUrl()"" /> #region ViewContextExt public static class ViewContextExtension { public static BaseController BaseController(this ViewContext view) { var baseController = (BaseController)view.Controller; return baseController; } public static string GetAvatarUrl(this IIdentity identity) { return ((ClaimsIdentity)identity).Claims.First(c => c.Type == ""AvatarUrl"").Value; } }}# endregion",Identity 2.0: Creating custom ClaimsIdentity eg: User.Identity.GetUserById<int>(int id) for Per Request Validation
Identity 2.0: Extending Microsoft.AspNet.Identity.IdentityExtensions eg: User.Identity.GetUserById(int i) for Per Request Validation," See this similar question: Need access more user properties in User.IdentityI would like to create custom authentication methods to use with my Razor Views that allows easy access IdentityUser properties relational to the User.Identity object but I am not sure how to go about it. I want to create several custom extensions similar to User.Identity.GetUserName(), User.Identity.GetUserById(), etc... instead of using this ViewContextExtension method. My Authentication type is currently the default type DefaultAuthenticationTypes.ApplicationCookie from VS2013 MVC5 template. As Shoe stated, I need this claim to be inserted after the user signs in.My questions is:How and where do you create a custom claim that has an out parameter of this IIdentity under IPrincipal?This would allow me to access User properties via CookieAuthentication in a View for entities in a DDD setting where I have multiple DbContexts in a single app using Identity 2.0. I will eventually use WebAPI, but for now I want to keep it as simple as possible. I have found this SO Q&A but it is geared towards Web Forms using Tickets. Not sure the difference between tickets and tokens either?This is the current approach that uses ViewContext from a base controller:View: BaseController.cs Extensions.cs What I am looking for is but where & how?View: SOLUTIONI simply edited the Extension.cs file and used inheritance for the Base controller which is used for the _LoginPartial.cshtml & edited the ViewContextExtension class: <code>  @using Microsoft.AspNet.Identity @using Globals.Helpers @using Identity //custom Identity for Domain @using Microsoft.AspNet.Identity.Owin @if (Request.IsAuthenticated) { var url = @ViewContext.BaseController().GetAvatarUrlById(User.Identity.GetUserId<int>()); //... } public string GetAvatarUrlById(int id) { var user = UserManager.FindById(id); return ""../../"" + user.ImageUrl; } public static class ViewContextExtension { public static BaseController BaseController(this ViewContext view) { var baseController = (BaseController)view.Controller; return baseController; } } <img src=""@User.Identity.GetAvatarUrl()"" alt=""User.Identity.GetAvatarUrl()"" /> #region ViewContextExt public static class ViewContextExtension { public static BaseController BaseController(this ViewContext view) { var baseController = (BaseController)view.Controller; return baseController; } public static string GetAvatarUrl(this IIdentity identity) { return ((ClaimsIdentity)identity).Claims.First(c => c.Type == ""AvatarUrl"").Value; } }}# endregion",Identity 2.0: Creating custom ClaimsIdentity eg: User.Identity.GetUserById<int>(int id) for Per Request Validation
Identity 2.0: Creating custom ClaimsIdentity eg: User.Identity.GetUserById(int i) for Per Request Validation," See this similar question: Need access more user properties in User.IdentityI would like to create custom authentication methods to use with my Razor Views that allows easy access IdentityUser properties relational to the User.Identity object but I am not sure how to go about it. I want to create several custom extensions similar to User.Identity.GetUserName(), User.Identity.GetUserById(), etc... instead of using this ViewContextExtension method. My Authentication type is currently the default type DefaultAuthenticationTypes.ApplicationCookie from VS2013 MVC5 template. As Shoe stated, I need this claim to be inserted after the user signs in.My questions is:How and where do you create a custom claim that has an out parameter of this IIdentity under IPrincipal?This would allow me to access User properties via CookieAuthentication in a View for entities in a DDD setting where I have multiple DbContexts in a single app using Identity 2.0. I will eventually use WebAPI, but for now I want to keep it as simple as possible. I have found this SO Q&A but it is geared towards Web Forms using Tickets. Not sure the difference between tickets and tokens either?This is the current approach that uses ViewContext from a base controller:View: BaseController.cs Extensions.cs What I am looking for is but where & how?View: SOLUTIONI simply edited the Extension.cs file and used inheritance for the Base controller which is used for the _LoginPartial.cshtml & edited the ViewContextExtension class: <code>  @using Microsoft.AspNet.Identity @using Globals.Helpers @using Identity //custom Identity for Domain @using Microsoft.AspNet.Identity.Owin @if (Request.IsAuthenticated) { var url = @ViewContext.BaseController().GetAvatarUrlById(User.Identity.GetUserId<int>()); //... } public string GetAvatarUrlById(int id) { var user = UserManager.FindById(id); return ""../../"" + user.ImageUrl; } public static class ViewContextExtension { public static BaseController BaseController(this ViewContext view) { var baseController = (BaseController)view.Controller; return baseController; } } <img src=""@User.Identity.GetAvatarUrl()"" alt=""User.Identity.GetAvatarUrl()"" /> #region ViewContextExt public static class ViewContextExtension { public static BaseController BaseController(this ViewContext view) { var baseController = (BaseController)view.Controller; return baseController; } public static string GetAvatarUrl(this IIdentity identity) { return ((ClaimsIdentity)identity).Claims.First(c => c.Type == ""AvatarUrl"").Value; } }}# endregion",Identity 2.0: Creating custom ClaimsIdentity eg: User.Identity.GetUserById<int>(int id) for Per Request Validation
Get real type of generic method," In my logging module I have the line:MethodBase methodBase = new StackFrame(2, false).GetMethod();The method I inspect is a generic method and defined as T[] MyMethod<T>(). Is there a way to get its real type instead of T from methodBase? <code> ",Get real type of generic method from StackFrame
XAML: How to change textblock background?," This is my xaml structure Stackpanel, It can loop to generate more same structures.How can I change background color of texblock when I click it?UPDATE: I just want change on xaml file not using C#.Default I has yellow, but when I click a textblock, Its background will change to Blue.UPDATE 2: If click A, A will change to blue until I click another.Detail:I click A(A is yellow), A will change to be blue ==> A is blueI click B(B is yellow and A is blue), B will change to be blue and A will change to be yellow.UPDATE 3: How about this? The question is same aboveThanks! <code>  <stackpanel> <textblock Text=""A""></textblock> <textblock Text=""B""></textblock></stackpanel> <stackpanel> <textblock Text=""A""></textblock></stackpanel><stackpanel> <textblock Text=""A""></textblock></stackpanel><stackpanel> <textblock Text=""A""></textblock></stackpanel>",How to change textblock background?
order by (asc|desc) in linq to sqlserver handles DateTime differently," I am currently trying to add an order by to a LINQ query that will order by a datetime field in an EF object: When the SortingDirection is set to desc it works fine. But when set to asc I get no records!Upon looking at SQL Server Profiler, it turns out that DateTime objects are being formatted differently! For DESC: and for ASC: Days and months have been swapped, causing the sql query to return no results. This to me suggests that the IQueryable.OrderBy() method is not using the correct local format / different format to OrderByDescending(), could this be a bug in EF?Is there something in my connection string I could add to enforce this or another way I could sort by these dates?My setup:.NET 4.5Entity Framework 5.0.0SQL Server 2012 Standard Many thanks <code>  return this.SortingDirection.Equals(""asc"", StringComparison.InvariantCultureIgnoreCase) ? entities.OrderBy(e => e.ProcessStartTime) : entities.OrderByDescending(e => e.ProcessStartTime); ORDER BY [Project1].[StartTime] DESC',N'...@p__linq__22='2015-01-07 09:00:23',@p__linq__23='2015-01-07 09:00:23',@p__linq__24='2015-01-07 09:05:30',@p__linq__25='2015-01-07 09:05:30' ORDER BY [Project1].[StartTime] ASC',N'...@p__linq__22='2015-07-01 09:00:23',@p__linq__23='2015-07-01 09:00:23',@p__linq__24='2015-07-01 09:05:30',@p__linq__25='2015-07-01 09:05:30'",Order by (asc|desc) in linq to SQL Server handles DateTime differently
Handle Multiple Values in Case?," How to handle multiple values inside one case? So if I want to execute the same action for value ""first option"" and ""second option""?Is this the right way? <code>  switch(text){ case ""first option"": { } case ""second option"": { string a=""first or Second""; break; }}",How to handle multiple values inside one case?
"c# Environment.PermissionAccess does not always return the full number of Logical Processor, why?"," On my machine, windows 7 - Enterprise with 1 x Intel Xeon E5-1660 0 @ 3.30Ghz (6 cores/cpu with Hyper Threading activated), Environment.ProcessorCount return 12 which is exact.On a Windows Server 2012 with 2 x Intel Xeon E5-2697 v3 @ 2.60GHz (14 cores/cpu with Hyper Threading activated(I think because task manager show: 2 sockets, 28 cores, 56 logical processors)), Environment.ProcessorCount return 28 which appears to us as wrong because 2x14x2 = 56.Why on Windows Server 2012 c# method Environment.ProcessorCount does not return the proper number of logical processors?As Additional information, environment variables are as follows:NUMBER_OF_PROCESSORS=28Update 2015-05-26:There is a more details/reasons of this related bug in my other question: Unable to use more than one processor group for my threads in a C# app. Mainly I think that C# does only use one processor group. What's werid was that on our server, there was 2 processor groups although there was only 56 logical processors. But this HP CUSTOMER ADVISORY explain why our server bios configuration were inducing windows in error. <code> ","c# Environment.ProcessorCount does not always return the full number of Logical Processor, why?"
Comparing images of same resolution, Is there a good and reliable way to compare images of same format and same resolution and get difference between them? In the best-case scenario I am looking for some numerical representation of image that can be then compared because I have to compare many images. <code> ,Can we programmatically compare different images of same resolutions?
Can we programatically compare different images of same resolutions?, Is there a good and reliable way to compare images of same format and same resolution and get difference between them? In the best-case scenario I am looking for some numerical representation of image that can be then compared because I have to compare many images. <code> ,Can we programmatically compare different images of same resolutions?
how to add space between string for every 4 characters?," The string displays value as: I need it like: There should be space between every 4 characters in this string. How do I do that? <code>  123456789012 1234 5678 9012 displaynum_lbl.Text = Regex.Replace(printClass.mynumber.ToString(), "".{4}"", ""$0"");","How to insert a space into a string, between every 4 characters?"
Test that task is being awaited," I have the following code which i'd like to test: It is important that the EndSession Task only ends once the `_keepAliveTask' ended. However, I'm struggling to find a way to test it reliably.Question: How do i unit test the EndSession method and verify that the Task returned by EndSession awaits the _keepAliveTask.For demonstration purposes, the unit test could look like that: Further criterias: - reliable test (always passes when implementation is correct, always fails when implementation is wrong) - cannot take longer than a few milliseconds (it's a unit test, after all).I have already taken several alternatives into considerations which i'm documenting below:non-async methodIf there wouldn't be the call to _logOutCommand.LogOutIfPossible() it would be quite simple: i'd just remove the async and return _keepAliveTask instead of awaiting it: The unit test would look (simplified): However, there's two arguments against this:i have multiple task which need awaiting (i'm considering Task.WhenAll further down)doing so only moves the responsibility to await the task to the caller of EndSession. Still will have to test it there.non-async method, sync over asyncOf course, I could do something similar: But that is a no-go (sync over async). Plus it still has the problems of the previous approach.non-async method using Task.WhenAll(...)Is a (valid) performance improvement but introduces more complexity: - difficult to get right without hiding a second exception (when both fail) - allows parallel execution Since performance isn't key here i'd like to avoid the extra complexity. Also, previously mentioned issue that it just moves the (verification) problem to the caller of the EndSession method applies here, too.observing effects instead of verifying callsNow of course instead of ""unit"" testing method calls etc. I could always observe effects. Which is: As long as _keepAliveTask hasn't ended the EndSession Task mustn't end either. But since I can't wait indefinite one has to settle for a timeout. The tests should be fast so a timeout like 5 seconds is a no go. So what I've done is: But I really really dislike this approach:hard to understandunreliableor - when it's quite reliable - it takes a long time (which unit tests shouldn't). <code>  private Task _keepAliveTask; // get's assigned by object initializerpublic async Task EndSession(){ _cancellationTokenSource.Cancel(); // cancels the _keepAliveTask await _logOutCommand.LogOutIfPossible(); await _keepAliveTask;} public async Task EndSession_MustWaitForKeepAliveTaskToEnd(){ var keepAliveTask = new Mock<Task>(); // for simplicity sake i slightly differ from the other examples // by passing the task as method parameter await EndSession(keepAliveTask); keepAliveTask.VerifyAwaited(); // this is what i want to achieve} public Task EndSession(){ _cancellationTokenSource.Cancel(); return _keepAliveTask;} public void EndSession_MustWaitForKeepAliveTaskToEnd(){ var keepAliveTask = new Mock<Task>(); // for simplicity sake i slightly differ from the other examples // by passing the task as method parameter Task returnedTask = EndSession(keepAliveTask); returnedTask.Should().be(keepAliveTask);} public Task EndSession(){ _cancellationTokenSource.Cancel(); // cancels the _keepAliveTask _logOutCommand.LogOutIfPossible().Wait(); return _keepAliveTask;} [Test]public void EndSession_MustWaitForKeepAliveTaskToEnd(){ var keepAlive = new TaskCompletionSource<bool>(); _cancelableLoopingTaskFactory .Setup(x => x.Start(It.IsAny<ICancelableLoopStep>(), It.IsAny<CancellationToken>())) .Returns(keepAlive.Task); _testee.StartSendingKeepAlive(); _testee.EndSession() .Wait(TimeSpan.FromMilliseconds(20)) .Should().BeFalse();}",Verify that task is being awaited
Identifying an array for a property value - JSON.NET," I have a JSON file: I want to determine if the value of any property has a structure of an array. The best I can come up with so far is: To determine whether or not a property value has an array, I used the condition: I'm just wondering if there is a better way of doing this check? <code>  { ""abn"":""63119059513"", ""acn"":""119059513"", ""business_structure"":""Private Company"", ""ngr_number"":""1231231"", ""cbh_number"":""1231231"", ""main_name"":""Brickworks Building Products Pty Ltd"", ""trading_name"":""Brickworks"", ""other_trading_names"":""Austral Bricks"", ""directors"":[ { ""ID"":""12114"", ""ae_forms_filled_in_ID"":""22739"", ""name"":""John Smith"", ""dob"":""1983-10-29"", ""address_line_1"":""123 Fake Street"", ""address_line_2"":"""", ""address_line_city"":""Fakeland"", ""address_line_postcode"":""2000"", ""address_line_state"":""New South Wales"", ""address_line_country"":""Australia"", ""order_extract_id"":null, ""director_found"":null, ""drivers_lic"":"""", ""home_mortgage"":"""", ""phone"":"""", ""mobile"":"""", ""director_email"":"""", ""director_title"":""Mr"", ""director_position"":""Director"", ""dir_pdf_url"":null } ],} StreamReader streamrr = new StreamReader(""C:\\temp\\agfarm_example_udate.json"", Encoding.UTF8);string JSON = streamrr.ReadToEnd();JObject CWFile = JObject.Parse(JSON);foreach (JProperty property in CWFile.Properties()){ // Do something if (property.Value.ToString().Contains(""["")) { // Do something with the array JArray items = (JArray)CWFile[property.Name]; foreach (JObject o in items.Children<JObject>()) { foreach (JProperty p in o.Properties()) { // Do something } } }} if (property.Value.ToString().Contains(""[""))",Identifying that a property's value is an array
How to set time out for http client request in windows phone 8.1/Windows 8.1," How to set Timeout property to Windows.Web.Http.HttpClient operation. The code sample I used is below. <code>  public HttpClient httpClient;public CancellationTokenSource cts;public void SendRequest(addressUri,postrequestbody){ HttpHelper.CreateHttpClient(ref httpClient); cts = new CancellationTokenSource(); HttpRequestMessage msg = new HttpRequestMessage(new HttpMethod(""POST""), new Uri(addressUri)); msg.Content = new HttpStringContent(postrequestbody); msg.Content.Headers.ContentType = new HttpMediaTypeHeaderValue(""application/json""); HttpResponseMessage response = await httpClient.SendRequestAsync(msg).AsTask(); if (response.StatusCode == HttpStatusCode.Ok) { }}",How to set time out for http client request operation in windows phone 8.1/Windows 8.1
Thinktexture Identity Server v3 How to keep Claims from external providers?," I'm trying to follow the simple guide mvcGettingStarted.Now, I've implemented both GoogleAuthentication and FacebookAuthentication providers, and everything is working as expected, I actually can log-in, and if I sign in with my identity server I also got the Role claims per user.I was wondering, what if I want to keep all the claims given from the external providers?Simple example.This is how my Facebook provider setup looks like: In the for each loop I'm trying to store all the Facebook claims in the Identity, but when I get back in the SecurityTokenValidated callback, my Identity hasn't them. Is it because I'm manipulating two different Identities? Is there a right way to achieve what I am trying to do?Thank you.  <code>  var facebookOptions = new FacebookAuthenticationOptions() { AuthenticationType = ""Facebook"", Caption = ""Sign in with Facebook"", AppId = ""*****"", AppSecret = ""****"", SignInAsAuthenticationType = signInAsType, Provider = new FacebookAuthenticationProvider() { OnAuthenticated = (context) => { foreach (var x in context.User) { context.Identity.AddClaim(new Claim(x.Key, x.Value.ToString())); } return Task.FromResult(context); } }, }; facebookOptions.Scope.Add(""email""); facebookOptions.Scope.Add(""public_profile""); facebookOptions.Scope.Add(""user_friends""); app.UseFacebookAuthentication(facebookOptions); app.UseOpenIdConnectAuthentication(new OpenIdConnectAuthenticationOptions() { Authority = ""https://localhost:44302/identity/"", ClientId = ""my_client"", Scope = ""openid profile roles email"", RedirectUri = ""https://localhost:44302/"", ResponseType = ""id_token token"", SignInAsAuthenticationType = ""Cookies"", UseTokenLifetime = false, Notifications = new OpenIdConnectAuthenticationNotifications() { SecurityTokenValidated = async context => { //let's clean up this identity //context.AuthenticationTicket.Identity doesn't have the claims added in the facebook callback var nid = new ClaimsIdentity( context.AuthenticationTicket.Identity.AuthenticationType, Constants.ClaimTypes.GivenName, Constants.ClaimTypes.Role); ........",Thinktecture Identity Server v3 How to keep Claims from external providers?
Random Numbers C#?," What I found was how to create random numbers. Great. This solution, however, was not working in other functions. To create a random number, I used inside of a function called enemyWalk(){};However, this caused an error: Type 'UnityEngine.Random' does not contain a definition for 'Next' and no extension method 'Next' of type 'UnityEngine.Random' could be found (are you missing a using directive or an assembly reference?)This error does not appear when I take the random integer generator out of the function. Any solutions to fix this problem?I'm hoping to use this code to make my enemy wander around when not doing anything by randomly choosing an integer that decides which direction he walks (up, left, right, or down), then using a random double generator to determine the distance it walks. However I need a random number generated whenever enemyWalk(){}; is called. <code>  Random randomDirection = new Random();int directionChoice = randomDirection.Next(1, 4); ",Random Numbers in Unity3D?
What construction can i use instead of Contains?," I have a list with ids: I want to select all objects from db with ids from myList: But when myList.Count > 8000 i get an error: The query processor ran out of internal resources and could not produce a query plan. This is a rare event and only expected for extremely complex queries or queries that reference a very large number of tables or partitions. Please simplify the query. If you believe you have received this message in error, contact Customer Support Services for more information.I think that it's because i used Contains(). What can I use instead of Contains? <code>  var myList = new List<int>(); var objList= myContext.MyObjects.Where(t => myList.Contains(t.Id)).ToList();",What construction can I use instead of Contains?
xmlSerializer.Deserialize(xmlReader.ReadSubtree()) does not recognise XML namespace prefix," I am attempting to process a large XML document (using a XmlReader) in a single pass, and deserialize only certain elements in it using an XmlSerializer.Below is some code and a tiny mock XML document showing how I have attempted to do this. Rationale for using XmlReader: 1. I am dealing with very large XML documents (10–250 MB), which for this reason I do not want to load into memory. So XmlDocument is out of the question. 2. I want to extract only certain elements. Typically I will be able to ignore most other content. XmlReader appears to give me an efficient means of skipping irrelevant content. 3. I do not know in advance whether any and all elements that I can deal with will be present; therefore I am not using a bunch of Xpath/XQuery or LINQ to XML-based queries, because I want to make only a single pass over the XML files (due to their size). The last line of code throws the following inner exception: InvalidOperationException: ""Namespace prefix ex is not defined.""Obviously, the XmlSerializer doesn't recognise the ex namespace prefix inside the xsi:type attribute's value.This is just one error I am having, but frankly, the larger problem is that I have no idea how to go about the whole namespace issue. I am simply looking for a convenient way to de-serialize just a single node out of the XML document, but that seems to entail having to manually register/manage namespaces, and to somehow forward them from the XmlReader to the XmlSerializer.Can someone demonstrate how to deserialize a single node from a XML document read with an XmlReader, either by pointing out the error in my code, or by showing an alternative approach? <code>  public class ElementOfInterest { }var xml = @""<?xml version='1.0' encoding='utf-8' ?> <Root xmlns:ex='urn:stakx:example' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'> <ElementOfInterest xsi:type='ex:ElementOfInterest' /> </Root>"";var reader = System.Xml.XmlReader.Create(new System.IO.StringReader(xml));reader.ReadToFollowing(""ElementOfInterest"");var serializer = new System.Xml.Serialization.XmlSerializer(typeof(ElementOfInterest));serializer.Deserialize(reader.ReadSubtree());",Deserializing a single element in a large XML document: xmlSerializer.Deserialize(xmlReader.ReadSubtree()) fails due to namespace issues
"Newtonsoft.Json, Web service, The length of the string exceeds the value set on the maxJsonLength property"," I have a .Net Web service (.asmx) which will return a Json string to my client. However, some of my data is really large and I get this error occasionally. The length of the string exceeds the value set on the maxJsonLength property.I've changed the maxJsonLength property to 2147483644, but it still doesn't work. Please help... Thank you. <code>  <system.web.extensions> <scripting> <webServices> <jsonSerialization maxJsonLength=""2147483644""/> </webServices> </scripting> </system.web.extensions>[WebMethod] [ScriptMethod(UseHttpGet = true, ResponseFormat = ResponseFormat.Json)] public void GetData(string login) { // throw an error on this line... string result = new JavaScriptSerializer().Serialize(service.GetData(login)); Context.Response.Write(result); }",length of the string exceeds the value set on the maxJsonLength property
"C# httplistener server, with multiple connections simultaneously"," In the application that I build, there is a need for webserver that can serve, simultaneously, multiple clients.For that I use the HttpListener object. with its Async methods\events BeginGetContext and EndGetContext.In the delegated method, there is a call for the listener to start listening again, and it works.. mostly.The code provided is a mix of code that i found here and there, and a delay, to simulate a data processing bottleneck.The problem is, it starts to manage the next connection only AFTER the last one was served.. no use for me. edit the output is <code>  public class HtServer { public void startServer(){ HttpListener HL = new HttpListener(); HL.Prefixes.Add(""http://127.0.0.1:800/""); HL.Start(); IAsyncResult HLC = HL.BeginGetContext(new AsyncCallback(clientConnection),HL); } public void clientConnection(IAsyncResult res){ HttpListener listener = (HttpListener)res.AsyncState; HttpListenerContext context = listener.EndGetContext(res); HttpListenerRequest request = context.Request; // Obtain a response object. HttpListenerResponse response = context.Response; // Construct a response. // add a delay to simulate data process String before_wait = String.Format(""{0}"", DateTime.Now); Thread.Sleep(4000); String after_wait = String.Format(""{0}"", DateTime.Now); string responseString = ""<HTML><BODY> BW: "" + before_wait + ""<br />AW:"" + after_wait + ""</BODY></HTML>""; byte[] buffer = System.Text.Encoding.UTF8.GetBytes(responseString); // Get a response stream and write the response to it. response.ContentLength64 = buffer.Length; System.IO.Stream output = response.OutputStream; // You must close the output stream. output.Write(buffer, 0, buffer.Length); output.Close(); listener.BeginGetContext(new AsyncCallback(clientConnection), listener); }} private static void OnContext(IAsyncResult ar) { var ctx = _listener.EndGetContext(ar); _listener.BeginGetContext(OnContext, null); Console.WriteLine(DateTime.UtcNow.ToString(""HH:mm:ss.fff"") + "" Handling request""); var buf = Encoding.ASCII.GetBytes(""Hello world""); ctx.Response.ContentType = ""text/plain""; // prevent thread from exiting. Thread.Sleep(3000); // moved these lines here.. to simulate process delay ctx.Response.OutputStream.Write(buf, 0, buf.Length); ctx.Response.OutputStream.Close(); Console.WriteLine(DateTime.UtcNow.ToString(""HH:mm:ss.fff"") + "" completed""); }",How to process multiple connections simultaneously with HttpListener?
ASP.NET MVC - SmtpClient.SendMailAsync causes deadlock when throwing a specific exception," I'm trying to set up email confirmation for an ASP.NET MVC5 website, based on the example AccountController from the VS2013 project template. I've implemented the IIdentityMessageService using SmtpClient, trying to keep it as simple as possible: The controller code that is calling it is straight from the template (extracted into a separate action since I wanted to exclude other possible causes): However I'm getting odd behavior when the mail fails to send, but only in one specific instance, when the host is somehow unreachable. Example config: In that case, the request appears to deadlock, never returning anything to the client. If the mail fails to send for any other reason (e.g. host actively refuses connection) the exception is handled normally and I get a YSOD.Looking at the Windows event logs, it seems that an InvalidOperationException is thrown around the same timeframe, with the message ""An asynchronous module or handler completed while an asynchronous operation was still pending.""; I get that same message in a YSOD if I try to catch the SmtpException in the controller and return a ViewResult in the catch block. So I figure the await-ed operation fails to complete in either case.As far as I can tell, I am following all the async/await best practices as outlined in other posts on SO (e.g. HttpClient.GetAsync(...) never returns when using await/async), mainly ""using async/await all the way up"". I've also tried using ConfigureAwait(false), with no change. Since the code deadlocks only if a specific exception is thrown, I figure the general pattern is correct for most cases, but something is happening internally that makes it incorrect in that case; but since I'm pretty new to concurrent programming, I've a feeling I could be wrong.Is there something I'm doing wrong ? I can always use a synchronous call (ie. SmtpClient.Send()) in the SendAsync method, but it feels like this should work as is. <code>  public class EmailService : IIdentityMessageService{ public async Task SendAsync(IdentityMessage message) { using(var client = new SmtpClient()) { var mailMessage = new MailMessage(""some.guy@company.com"", message.Destination, message.Subject, message.Body); await client.SendMailAsync(mailMessage); } }} public async Task<ActionResult> TestAsyncEmail(){ Guid userId = User.Identity.GetUserId(); string code = await UserManager.GenerateEmailConfirmationTokenAsync(userId); var callbackUrl = Url.Action(""ConfirmEmail"", ""Account"", new { userId = userId, code = code }, protocol: Request.Url.Scheme); await UserManager.SendEmailAsync(userId, ""Confirm your account"", ""Please confirm your account by clicking <a href=\"""" + callbackUrl + ""\"">here</a>""); return View();} <system.net> <mailSettings> <smtp deliveryMethod=""Network""> <network host=""unreachablehost"" defaultCredentials=""true"" port=""25"" /> </smtp> </mailSettings></system.net>",SmtpClient.SendMailAsync causes deadlock when throwing a specific exception
How to handle exceptions within the actor in Akka.net?," Is there a standard pattern to deal with exceptions within actors in Akka.NET?I saw some patterns to create supervisors, but it seems the SupervisorStrategy is a way to deal with things that cannot be resolved by the actor.I have an actor that receives lots of data and needs to store it in an external server. The external database may be unreachable. If it is, the server may be restarting or the network may be down. I don't need to restart the actor or anything, I just want to notify the sender with some information about what is happening, so he can persist the message on disk and reschedule for later.The sender is not a parent of this actor connecting to the database. Should I create a supervisor just to handle this as well? Or should I encapsulate my receive handlers in try/catch blocks and just use Tell to notify the senders a with a custom response as if it was a normal message?I know there is a Failure class, but I'm not sure if I'm suppose to use that for this situation. <code> ",How to handle exceptions within the actor?
Correct string DateTime foramt," I'm trying to figure-out the right string format of the following given date-time literal: Using MSDN, I managed to composed the following format:""d'-'MMM'-'y'T'h'.'m'.'s'.'fff""But when using the DateTime.ParseExact, the parsing fails with a FormatException: String was not recognized as a valid DateTime.My code: <code>  18-JUN-13 12.17.36.000000000 DateTime.ParseExact(""18-JUN-13 12.17.36.000000000"", ""d'-'MMM'-'y'T'h'.'m'.'s'.'fff"", null);",How to parse string with long milliseconds (nanoseconds) part to DateTime?
Correct string DateTime format," I'm trying to figure-out the right string format of the following given date-time literal: Using MSDN, I managed to composed the following format:""d'-'MMM'-'y'T'h'.'m'.'s'.'fff""But when using the DateTime.ParseExact, the parsing fails with a FormatException: String was not recognized as a valid DateTime.My code: <code>  18-JUN-13 12.17.36.000000000 DateTime.ParseExact(""18-JUN-13 12.17.36.000000000"", ""d'-'MMM'-'y'T'h'.'m'.'s'.'fff"", null);",How to parse string with long milliseconds (nanoseconds) part to DateTime?
How to parse string with long milliseconds part to DateTime?," I'm trying to figure-out the right string format of the following given date-time literal: Using MSDN, I managed to composed the following format:""d'-'MMM'-'y'T'h'.'m'.'s'.'fff""But when using the DateTime.ParseExact, the parsing fails with a FormatException: String was not recognized as a valid DateTime.My code: <code>  18-JUN-13 12.17.36.000000000 DateTime.ParseExact(""18-JUN-13 12.17.36.000000000"", ""d'-'MMM'-'y'T'h'.'m'.'s'.'fff"", null);",How to parse string with long milliseconds (nanoseconds) part to DateTime?
Convert String[] arrary to RedisKey[] array," Trying to use I have array of string[] ,I am not seeing any examples out there when I search for converting these data types. I am not even sure how to create a new RedisKey.Tried above does not work, any suggestions? <code>  KeyDelete(RedisKey[] keys, CommandFlags flags = CommandFlags.None); RedisKey redisKey = new RedisKey(""d"");",Convert String[] array to RedisKey[] array
Most efficient way of coverting a DataTable to CSV," I'm working with DataTable's and I need to convert them to a CSV file format. Most of the tables I am working with have over 50,000 records so I'm trying to minimize the time it takes to convert them.Here is my current method: Is there any way I can improve the efficiency of this method? I'm welcome to any modifications and ideas that you have! <code>  public static string table_to_csv(DataTable table) { string file = """"; foreach (DataColumn col in table.Columns) file = string.Concat(file, col.ColumnName, "",""); file = file.Remove(file.LastIndexOf(','), 1); file = string.Concat(file, ""\r\n""); foreach (DataRow row in table.Rows) { foreach (object item in row.ItemArray) file = string.Concat(file, item.ToString(), "",""); file = file.Remove(file.LastIndexOf(','), 1); file = string.Concat(file, ""\r\n""); } return file; }",Most efficient way of converting a DataTable to CSV
Using SetFields with MongoDb C# driver 2.0, With the old driver I could specify the fields I wanted to return from a query as follows: How do I accomplish this with the 2.0 driver? <code>  var cursor = Collection.Find(query). SetFields(Fields<MealPlan>.Exclude (plan => plan.Meals));,Using SetFields with MongoDB C# driver 2.0
Test private method throws exception," I have this class: Now I am implementing unit test for it. Since the method is private, I have following code: An exception of type 'System.MissingMethodException' occurred in mscorlib.dll but was not handled in user codeAdditional information: Attempted to access a missing member.What Am I doing wrong? The method exists.. <code>  public class MyClass{ private static int GetMonthsDateDiff(DateTime d1, DateTime d2) { // implementatio }} MyClass myClass = new MyClass();PrivateObject testObj = new PrivateObject(myClass);DateTime fromDate = new DateTime(2015, 1, 1);DateTime toDate = new DateTime(2015, 3, 17);object[] args = new object[2] { fromDate, toDate };int res = (int)testObj.Invoke(""GetMonthsDateDiff"", args); //<- exception",Test private static method throws MissingMethodException
Linq Lambda vs Query Syntax Performance," I saw a LINQ query syntax in my project today which was counting items with a specific condition from a List like this: I thought of refactoring it by rewriting it using Count(Func) to make it more readable. I thought it would also be good performance-wise, so I wrote: But when I check using StopWatch, the time elapsed by the lambda expression is always more than the query syntax: Can somebody explain why it is so? <code>  int temp = (from A in pTasks where A.StatusID == (int)BusinessRule.TaskStatus.Pending select A).ToList().Count(); int UnassignedCount = pTasks.Count(x => x.StatusID == (int)BusinessRule.TaskStatus.Pending); Stopwatch s = new Stopwatch();s.Start();int UnassignedCount = pTasks.Count(x => x.StatusID == (int)BusinessRule.TaskStatus.Pending);s.Stop();Stopwatch s2 = new Stopwatch();s2.Start();int temp = (from A in pTasks where A.StatusID == (int)BusinessRule.TaskStatus.Pending select A).ToList().Count();s2.Stop();",LINQ Lambda vs Query Syntax Performance
DateTimeInvalidLocalFormat occured," I am trying to get the local datetime with reference to UTC time gap and I am executing this code below. but every time it return me an exception as Why this exception is there, how to get this fixed? <code>  var dtString =DateTime.UtcNow.ToString(@""yyyy-MM-ddTHH\:mm\:ss.fzzz""); ",DateTimeInvalidLocalFormat occurred
Anonymous type can't be passed into method as ref object parameter," I'd like to know why the first call to Bar(ref object) doesn't work and the second one does. Seems silly considering I'm passing in a type object either way, and passing in an anonymous type to Foo(object) works fine. Why would ref, something that has to do with memory location influence the calls to Bar()?Consider the following snippet: I see in the answers below suggestions on how to make the code compile, but that's not what I'm after. I'd like to know specifically why making it a ref parameter prevents compilation when passing in an anonymous type to Foo() worked fine. <code>  static void Foo(object obj){ }static void Bar(ref object obj){ }static void Main(){ // Compiles var a = new { }; Foo(a); // Does not compile var b = new { }; Bar(ref b); // Compiles object c = new { }; Bar(ref c);}",Can I pass an anonymous object into a method that expects a reference parameter of type object?
Generate combinations of elements held in multiple list of strings," I'm trying to automate the nested foreach provided that there is a Master List holding List of strings as items for the following scenario.Here for example I have 5 list of strings held by a master list lstMaster I want to automate the below for loop regardless of the number of list items held by the master list lstMaster <code>  List<string> lst1 = new List<string> { ""1"", ""2"" }; List<string> lst2 = new List<string> { ""-"" }; List<string> lst3 = new List<string> { ""Jan"", ""Feb"" }; List<string> lst4 = new List<string> { ""-"" }; List<string> lst5 = new List<string> { ""2014"", ""2015"" }; List<List<string>> lstMaster = new List<List<string>> { lst1, lst2, lst3, lst4, lst5 }; List<string> lstRes = new List<string>(); foreach (var item1 in lst1) { foreach (var item2 in lst2) { foreach (var item3 in lst3) { foreach (var item4 in lst4) { foreach (var item5 in lst5) { lstRes.Add(item1 + item2 + item3 + item4 + item5); } } } } }",Generate combinations of elements held in multiple list of strings in C#
How to make make a .NET.COM object to be apartment-threaded?," .NET objects are free-threaded by default. If marshaled to another thread via COM, they always get marshaled to themselves, regardless of whether the creator thread was STA or not, and regardless of their ThreadingModel registry value. I suspect, they aggregate the Free Threaded Marshaler (more details about COM threading could be found here).I want to make my .NET COM object use the standard COM marshaller proxy when marshaled to another thread. The problem: Output: Note I use CoMarshalInterThreadInterfaceInStream/CoGetInterfaceAndReleaseStream to marshal ComObject from one STA thread to another. I want both Test() calls to be invoked on the same original thread, e.g. 11, as it would have been the case with a typical STA COM object implemented in C++.One possible solution is to disable IMarshal interface on the .NET COM object: Output (as desired): This works, but it feels like an implementation-specific hack. Is there a more decent way to get this done, like some special interop attribute I might have overlooked? Note that in real life ComObject is used (and gets marshaled) by a legacy unmanaged application. <code>  using System;using System.Runtime.InteropServices;using System.Threading;using System.Threading.Tasks;using System.Windows.Threading;namespace ConsoleApplication{ class Program { static void Main(string[] args) { var apt1 = new WpfApartment(); var apt2 = new WpfApartment(); apt1.Invoke(() => { var comObj = new ComObject(); comObj.Test(); IntPtr pStm; NativeMethods.CoMarshalInterThreadInterfaceInStream(NativeMethods.IID_IUnknown, comObj, out pStm); apt2.Invoke(() => { object unk; NativeMethods.CoGetInterfaceAndReleaseStream(pStm, NativeMethods.IID_IUnknown, out unk); Console.WriteLine(new { equal = Object.ReferenceEquals(comObj, unk) }); var marshaledComObj = (IComObject)unk; marshaledComObj.Test(); }); }); Console.ReadLine(); } } // ComObject [ComVisible(true)] [Guid(""00020400-0000-0000-C000-000000000046"")] // IID_IDispatch [InterfaceType(ComInterfaceType.InterfaceIsIDispatch)] public interface IComObject { void Test(); } [ComVisible(true)] [ClassInterface(ClassInterfaceType.None)] [ComDefaultInterface(typeof(IComObject))] public class ComObject : IComObject { // IComObject methods public void Test() { Console.WriteLine(new { Environment.CurrentManagedThreadId }); } } // WpfApartment - a WPF Dispatcher Thread internal class WpfApartment : IDisposable { Thread _thread; // the STA thread public System.Threading.Tasks.TaskScheduler TaskScheduler { get; private set; } public WpfApartment() { var tcs = new TaskCompletionSource<System.Threading.Tasks.TaskScheduler>(); // start the STA thread with WPF Dispatcher _thread = new Thread(_ => { NativeMethods.OleInitialize(IntPtr.Zero); try { // post a callback to get the TaskScheduler Dispatcher.CurrentDispatcher.InvokeAsync( () => tcs.SetResult(System.Threading.Tasks.TaskScheduler.FromCurrentSynchronizationContext()), DispatcherPriority.ApplicationIdle); // run the WPF Dispatcher message loop Dispatcher.Run(); } finally { NativeMethods.OleUninitialize(); } }); _thread.SetApartmentState(ApartmentState.STA); _thread.IsBackground = true; _thread.Start(); this.TaskScheduler = tcs.Task.Result; } // shutdown the STA thread public void Dispose() { if (_thread != null && _thread.IsAlive) { InvokeAsync(() => System.Windows.Threading.Dispatcher.ExitAllFrames()); _thread.Join(); _thread = null; } } // Task.Factory.StartNew wrappers public Task InvokeAsync(Action action) { return Task.Factory.StartNew(action, CancellationToken.None, TaskCreationOptions.None, this.TaskScheduler); } public void Invoke(Action action) { InvokeAsync(action).Wait(); } } public static class NativeMethods { public static readonly Guid IID_IUnknown = new Guid(""00000000-0000-0000-C000-000000000046""); public static readonly Guid IID_IDispatch = new Guid(""00020400-0000-0000-C000-000000000046""); [DllImport(""ole32.dll"", PreserveSig = false)] public static extern void CoMarshalInterThreadInterfaceInStream( [In, MarshalAs(UnmanagedType.LPStruct)] Guid riid, [MarshalAs(UnmanagedType.IUnknown)] object pUnk, out IntPtr ppStm); [DllImport(""ole32.dll"", PreserveSig = false)] public static extern void CoGetInterfaceAndReleaseStream( IntPtr pStm, [In, MarshalAs(UnmanagedType.LPStruct)] Guid riid, [MarshalAs(UnmanagedType.IUnknown)] out object ppv); [DllImport(""ole32.dll"", PreserveSig = false)] public static extern void OleInitialize(IntPtr pvReserved); [DllImport(""ole32.dll"", PreserveSig = true)] public static extern void OleUninitialize(); }} { CurrentManagedThreadId = 11 }{ equal = True }{ CurrentManagedThreadId = 12 } [ComVisible(true)][ClassInterface(ClassInterfaceType.None)][ComDefaultInterface(typeof(IComObject))]public class ComObject : IComObject, ICustomQueryInterface{ // IComObject methods public void Test() { Console.WriteLine(new { Environment.CurrentManagedThreadId }); } public static readonly Guid IID_IMarshal = new Guid(""00000003-0000-0000-C000-000000000046""); public CustomQueryInterfaceResult GetInterface(ref Guid iid, out IntPtr ppv) { ppv = IntPtr.Zero; if (iid == IID_IMarshal) { return CustomQueryInterfaceResult.Failed; } return CustomQueryInterfaceResult.NotHandled; }} { CurrentManagedThreadId = 11 }{ equal = False }{ CurrentManagedThreadId = 11 }",How to make make a .NET COM object apartment-threaded?
How to change backGround colr in Xamarin forms NavigationPage, I'm trying to change the background color of navigationBar in navigationPage I'm using this code: how can I do it? <code>  using System;using System;using Xamarin.Forms;using System.Collections.Generic;using System.Text;using System.Linq;using System.Threading.Tasks;namespace P{public class App : Application{ public App () { MainPage = new NavigationPage(new LoginPage()); } protected override void OnStart () { } protected override void OnSleep () { } protected override void OnResume () { // Handle when your app resumes } } },How to change backGround color in Xamarin forms NavigationPage
Retrieve the Current App verion from Package," While I can get the assembly version using the following code I would like to retrieve the Version from Package.appxmanifest in this case 1.0.0.4 I expected to have access to Windows.ApplicationModel, but this is not available to me <code>  var assembly = typeof(App).GetTypeInfo().Assembly; var assemblyVersion = assembly.GetCustomAttribute<AssemblyFileVersionAttribute>().Version; <?xml version=""1.0"" encoding=""utf-8""?><Package xmlns=""http://schemas.microsoft.com/appx/2010/manifest"" xmlns:m2=""http://schemas.microsoft.com/appx/2013/manifest""> <Identity Name=""zzz"" Publisher=""CN=zzz"" Version=""1.0.0.4"" />",Retrieve the Current App version from Package
How do I get client IP address in ASP.NET 5 MVC 6?," Can you please let me know how to get client IP address in ASP.NET when using MVC 6. Request.ServerVariables[""REMOTE_ADDR""] does not work. <code> ",How do I get client IP address in ASP.NET CORE?
Working with locally built web page in CEFSharp," I have a CefSharp browser created in my Winform and I need to dynamically build an HTML page in memory and then have CefSharp render it.Ideally I would like to pass the constructor a string with the HTML in it but it is expecting a URL. The answer is probably no, but is there a directive you can prepend the string with to let CefSharp know it is a string that contains a web page? Then CefSharp will create a temp file?If not, where is the Chromium temp folder set to? Will it work if I write a file to there and then pass that as a fully qualified path? I know Chrome will support something like file:///Users/dmacdonald/Documents/myFile.htm as a URL but not sure how to form a URL if using the temp structure.Here is my new code but my browser object doesn't have a ResourceHandler property. I see it has a ResourceHandlerFactory <code>  using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Threading.Tasks;using System.Windows.Forms;using CefSharp.WinForms;using CefSharp;namespace DanCefWinForm{ public partial class Form1 : Form { public const string TestResourceUrl = ""http://maps/resource/load""; public Form1() { InitializeComponent(); } private void Form1_Load(object sender, EventArgs e) { ChromiumWebBrowser browser = new ChromiumWebBrowser(""http://maps/resource/load"") { Dock = DockStyle.Fill, }; var handler = browser.ResourceHandler; browser.Location = new Point(20, 20); browser.Size = new Size(100, 100); this.Controls.Add(browser); } }}",Working with locally built web page in CefSharp
Entitfy Framework Code First Child Navigation Property null," I have a project using Entity Framework Code First version 6 with Lazy loading. At the model level it has a Course which has Modules. The course class is declared as follows: My Module class is declared as follows: The BaseEntity class they both inherit from is just to reduce code duplication for common application properties. It declares the primary key for all entities as such: I can include more details on it if relevant but I can't see how they'd interfere and there is a bunch of off topic framework stuff there.When I load the view to edit a Course that already exists in the database the Modules property of the Course is always null when consumed in an MVC view even when there should be records. For example editing course with id 3 has a null Modules property despite the fact there are several modules with a Course ID of 3.The inverse navigation of the relationship DOES however work. If I go to the view to edit Module id 5 it's Course property is set as expected and I can access the Course values. This module is linked to Course ID 3.My Entity Framework Code First is using default configuration i.e. Lazy Loading is enabled. I have verified this by inspecting the debugger values of the DBContext but also that explains why the Course property is working from the Module to the Course automatically.What are the possible causes of the relationship working from the Module to the Course but not from the Course to the Modules collection?As you can see from the commented code in the Course class, I had it handling the null situation previously by ensuring the Modules property was never null but that only matters when there are no Modules for a course which isn't the case here so I have tried changing this back to the basic ICollection property to rule it out as a problem.I have also debugged when the DBContext is being disposed and it is definitely after the view code has run so there is no danger of the DBContext being disposed before the Collection is accessed.I am not interested in explicitly using Include statements. I want to use lazy loading and EF to automatically get the data and I am aware of the implications this has on performance etc.Ideally I don't want to have to describe the relationship to Entity Framework beyond the use of the properties above. If I have to I can, but please explain why as I'm sure I have successfully done this simple parent - Child, 1 - many relationship before without problem.UPDATE 1Controller action code is as follows If I debug after the following line and inspect the property it gets automically populated as expected. As @Zaphod commented it looks like the DB connection is closed before the view starts rendering. I don't understand why that happens since we're still server side and haven't yet returned the markup to the browser. Is there a way to enable lazy loading within views and only close the connection when the controller is disposed?Update 2The actual GetID code: DbSet is correspondingly set in the constructor of the Controller to point to the DbSet on the DbContext: I can't see how the DbSet would somehow break queries between the last line of the controller action calling the view and the view starting to run.Update 3I should have included details of where the DbContext is created which is in the inherited controller constructor: This is only disposed once in the inherited controller's Dispose method which is not being called until AFTER the view has rendered: I still don't understand why the inverse relationship scenario would work fine as it should be lazy loading in the view for it as it all uses the same framework. <code>  public class Course : BaseEntity{ public String Title { get; set; } public String Description { get; set; } public int Revision { get; set; } //private IList<Module> _modules; //public virtual IList<Module> Modules //{ // get { return _modules ?? (_modules = new List<Module>()); } // set { _modules = value; } //} public virtual ICollection<Module> Modules { get; set; }} public class Module : BaseEntity{ [ForeignKey(""Course"")] public Int64 CourseID { get; set; } public virtual Course Course { get; set; } public String Title { get; set; } public Int32 SequenceNo { get; set; } public override string HumanDisplay { get { return Title; } } private IList<ModuleItem> _items; public virtual IList<ModuleItem> Items { get { return _items ?? (_items = new List<ModuleItem>()); } set { _items = value; } }} [Key][DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]public Int64 Id { get; set; } public virtual ActionResult Edit(long id = 0) { if (Session.GetUser().GetCombinedPrivilegeForEntity(Entity).CanRead) { String saveSuccess = TempData[""successMessage""] as String; currentModel = GetID(id); if (currentModel == null) throw new RecordNotFoundException(id, typeof(Model).Name); currentVM = Activator.CreateInstance<ViewModel>(); currentVM.Model = currentModel; currentVM.DB = DB; currentVM.ViewMode = ViewMode.Edit; currentVM.SuccessMessage = saveSuccess; SetViewModelPermissions(); //Cache.AddEntry(Session.SessionID, Entity, currentVM.Model.Id, currentVM); if (currentModel == null) { return HttpNotFound(); } if (ForcePartial || Request.IsAjaxRequest()) return PartialView(GetViewName(""Edit""), currentVM); else return View(GetViewName(""Edit""), MasterName, currentVM); } else { throw new PermissionException(""read"", Entity); } } currentModel = GetID(id); protected virtual Model GetID(long id = 0) { return DbSet.Find(id); } public CourseController() : base() { this.DbSet = DB.Courses; } public ApplicationCRUDController() : base() { this.DB = eLearn.Models.DbContext.CreateContext(Session); } protected override void Dispose(bool disposing) { if (DB != null) DB.Dispose(); base.Dispose(disposing); }",Entity Framework Code First Child Navigation Property null
Token Based Authentication in ASP.NET 5 (vNext)," I'm working with ASP.NET Core application. I'm trying to implement Token Based Authentication but can not figure out how to use new Security System for my case.I went through examples but they didn't help me much, they are using either cookie authentication or external authentication (GitHub, Microsoft, Twitter). What my scenario is: angularjs application should request /token url passing username and password. WebApi should authorize user and return access_token which will be used by angularjs app in following requests.I've found great article about implementing exactly what I need in current version of ASP.NET - Token Based Authentication using ASP.NET Web API 2, Owin, and Identity. But it is not obvious for me how to do the same thing in ASP.NET Core.My question is: how to configure ASP.NET Core WebApi application to work with token based authentication? <code> ",Token Based Authentication in ASP.NET Core
Repostory and query objects pattern. How to implement complex queries," I have read a lot of posts of the repository pattern but there are a few practical problems that they doesn't seem to solve or explain. This is what I understand about this two patterns:The repository and the query pattern are complementary: Query objects represents business logic (WHERE clauses) and the repository pattern has a Get(IPredicate) method that takes a query object and returns a SELECT WHERE resultThe repository should not have business logic: All the business logic must go on the query objectsCurrently I have a class that wraps each logical object (which almost always is a single entity object) that implements multiple ""Get"" methods that implement most complex queries (joins, groupBy, etc...), this isn't a good pattern because classes tend to grow a lot because of boilerplate code for similar queries and its public methods are dependent on context that this class will be used, thus, making this classes unusable for multiple projects that depends on the same database, which is my primary goal for this project refactoring.How queries that are more complex than a single SELECT WHERE are implemented with this two patterns without leaking business logic into the repository?Or if this business logic doesn't fit into the repository nor the query objectswhere does this logic fit? <code> ",Repository and query objects pattern. How to implement complex queries
Intercept c# HttpClient GetAsync," I have a web project (C#, MVC5 but no WebAPI) and a simple HTTP REST client that is calling an external REST service and acquires an accessToken etcing.I want to check the response from all my Get/PostAsync calls for statusCode 401 but I see that I can only override the SendAsync method when implementing the DelegatingHandler. Is there something else I can do so as not to change the implementation of all my async calls to use SendAsync?(What I really really want to do is refresh the accessToken.) <code>  class CustomDelegatingHandler : DelegatingHandler{ async protected override Task<HttpResponseMessage> SendAsync( HttpRequestMessage request, CancellationToken cancellationToken) { HttpResponseMessage response = await base.SendAsync(request, cancellationToken); if (response.StatusCode == HttpStatusCode.Unauthorized) {",Intercept C# HttpClient GetAsync
C# If Statement," I have this if statement: When the user types 'day' it should be so that the console writes the data in that array. It works fine but is there anyway to get it to work if the user types 'DaY' or 'dAy' etc. I know I could do: But is there anyway to make it shorter and tidier?Thanks. <code>  if (input == 'day') Console.Write({0}, dayData); if (input == 'day' || input == 'dAy' || input == 'DaY') Console.WriteLine({0}, dayData);",C# ignoring letter case for if statement
Why aren't all events available?," In the Visual Studio form designer, you can add an event handler on the Properties window in the ""Events"" list by double-clicking it. You can also add an event handler — at least in VB.NET — in the code view by selecting the associated ""Events"" item in the left-hand drop-down and then the desired event in the right-hand drop-down. My question is: how is it that some events that are only available via the latter technique and not the former? For example, the HandleCreated event is available in the code view:But not in the designer:This is fine in VB.NET because I can always use the first technique to quickly generate the event handlers. However, in C#, the first technique is not possible, yet the problem still exists; that is, some events are not present in the designer list in the Properties window. The only other way I know of creating the event handler is to manually add it, which includes manually wiring up the event handler.Is there something technical that makes it so that some events are missing from the designer Events list in the Properties window? Given that that is true, how can I quickly generate event handlers in C# like I can in VB.NET? <code> ","What makes it so that not every event is available in the designer, and how can I quickly generate handlers in C# like in VB.NET?"
"Why aren't all events available, and how can I quickly generate handlers in C# like in VB.NET?"," In the Visual Studio form designer, you can add an event handler on the Properties window in the ""Events"" list by double-clicking it. You can also add an event handler — at least in VB.NET — in the code view by selecting the associated ""Events"" item in the left-hand drop-down and then the desired event in the right-hand drop-down. My question is: how is it that some events that are only available via the latter technique and not the former? For example, the HandleCreated event is available in the code view:But not in the designer:This is fine in VB.NET because I can always use the first technique to quickly generate the event handlers. However, in C#, the first technique is not possible, yet the problem still exists; that is, some events are not present in the designer list in the Properties window. The only other way I know of creating the event handler is to manually add it, which includes manually wiring up the event handler.Is there something technical that makes it so that some events are missing from the designer Events list in the Properties window? Given that that is true, how can I quickly generate event handlers in C# like I can in VB.NET? <code> ","What makes it so that not every event is available in the designer, and how can I quickly generate handlers in C# like in VB.NET?"
"What makes it so that NOT all events are available, and how can I quickly generate handlers in C# like in VB.NET?"," In the Visual Studio form designer, you can add an event handler on the Properties window in the ""Events"" list by double-clicking it. You can also add an event handler — at least in VB.NET — in the code view by selecting the associated ""Events"" item in the left-hand drop-down and then the desired event in the right-hand drop-down. My question is: how is it that some events that are only available via the latter technique and not the former? For example, the HandleCreated event is available in the code view:But not in the designer:This is fine in VB.NET because I can always use the first technique to quickly generate the event handlers. However, in C#, the first technique is not possible, yet the problem still exists; that is, some events are not present in the designer list in the Properties window. The only other way I know of creating the event handler is to manually add it, which includes manually wiring up the event handler.Is there something technical that makes it so that some events are missing from the designer Events list in the Properties window? Given that that is true, how can I quickly generate event handlers in C# like I can in VB.NET? <code> ","What makes it so that not every event is available in the designer, and how can I quickly generate handlers in C# like in VB.NET?"
"What makes it so that NOT all events are available in the designer, and how can I quickly generate handlers in C# like in VB.NET?"," In the Visual Studio form designer, you can add an event handler on the Properties window in the ""Events"" list by double-clicking it. You can also add an event handler — at least in VB.NET — in the code view by selecting the associated ""Events"" item in the left-hand drop-down and then the desired event in the right-hand drop-down. My question is: how is it that some events that are only available via the latter technique and not the former? For example, the HandleCreated event is available in the code view:But not in the designer:This is fine in VB.NET because I can always use the first technique to quickly generate the event handlers. However, in C#, the first technique is not possible, yet the problem still exists; that is, some events are not present in the designer list in the Properties window. The only other way I know of creating the event handler is to manually add it, which includes manually wiring up the event handler.Is there something technical that makes it so that some events are missing from the designer Events list in the Properties window? Given that that is true, how can I quickly generate event handlers in C# like I can in VB.NET? <code> ","What makes it so that not every event is available in the designer, and how can I quickly generate handlers in C# like in VB.NET?"
How can I quickly generate handlers in C# like in VB.NET for all events which are not available in the designer?," In the Visual Studio form designer, you can add an event handler on the Properties window in the ""Events"" list by double-clicking it. You can also add an event handler — at least in VB.NET — in the code view by selecting the associated ""Events"" item in the left-hand drop-down and then the desired event in the right-hand drop-down. My question is: how is it that some events that are only available via the latter technique and not the former? For example, the HandleCreated event is available in the code view:But not in the designer:This is fine in VB.NET because I can always use the first technique to quickly generate the event handlers. However, in C#, the first technique is not possible, yet the problem still exists; that is, some events are not present in the designer list in the Properties window. The only other way I know of creating the event handler is to manually add it, which includes manually wiring up the event handler.Is there something technical that makes it so that some events are missing from the designer Events list in the Properties window? Given that that is true, how can I quickly generate event handlers in C# like I can in VB.NET? <code> ","What makes it so that not every event is available in the designer, and how can I quickly generate handlers in C# like in VB.NET?"
"What makes it so that NOT all events are available in the designer, and how can I quickly generate handlers in C# like in VB.NET?"," In the Visual Studio form designer, you can add an event handler on the Properties window in the ""Events"" list by double-clicking it. You can also add an event handler — at least in VB.NET — in the code view by selecting the associated ""Events"" item in the left-hand drop-down and then the desired event in the right-hand drop-down. My question is: how is it that some events that are only available via the latter technique and not the former? For example, the HandleCreated event is available in the code view:But not in the designer:This is fine in VB.NET because I can always use the first technique to quickly generate the event handlers. However, in C#, the first technique is not possible, yet the problem still exists; that is, some events are not present in the designer list in the Properties window. The only other way I know of creating the event handler is to manually add it, which includes manually wiring up the event handler.Is there something technical that makes it so that some events are missing from the designer Events list in the Properties window? Given that that is true, how can I quickly generate event handlers in C# like I can in VB.NET? <code> ","What makes it so that not every event is available in the designer, and how can I quickly generate handlers in C# like in VB.NET?"
Cancelling a Task - why is TaskCanceledException.CancellationToken.IsCancellationRequested false?," Given the following code: I would expect ex.CancellationToken.IsCancellationRequested to be true inside the catch block, but it is not. Am I misunderstanding something? <code>  var cts = new CancellationTokenSource();try { // get a ""hot"" task var task = new HttpClient().GetAsync(""http://www.google.com"", cts.Token); // request cancellation cts.Cancel(); await task; // pass: Assert.Fail(""expected TaskCanceledException to be thrown"");}catch (TaskCanceledException ex) { // pass: Assert.IsTrue(cts.Token.IsCancellationRequested, ""expected cancellation requested on original token""); // fail: Assert.IsTrue(ex.CancellationToken.IsCancellationRequested, ""expected cancellation requested on token attached to exception"");}",Cancelling an HttpClient Request - Why is TaskCanceledException.CancellationToken.IsCancellationRequested false?
"SQL query times out when run from C#, fast in SQL Studio"," I have a C# program that executes a SQL query, using the code listed below. I've been using this code for a while with no problems until the other day. I'm passing a query string to SQL that includes a list of strings, which are stock identifiers. A few days ago I ran it and the query timed out, and will run more than an hour if I let it. I've spent the past few days trying to debug this. In my original query, there were about 900 identifiers. I've tried changing everything I can think of, and I get results I can't explain. For example:the query works with one list of stocks, but not with another list of the same length in terms of number of string and total lengthit works with one list but not with the same list in reverse orderwith one list, it works if there are exactly 900 identifiers but not if there are 899 or 901, and I can include or exclude different identifiers and get the same results, so it isn't something funky with one of the identifiers. In each of these cases, I captured the query string that is being passed by my program and copied into SQL Server Management Studio, and in every case, the query runs in 1 second.I have read everything I can on this and other forums about queries that work in SQL Server Management Studio but time out when run from a program, but this seems different in that I can find cases where it fails and similar cases where it doesn't work.I would appreciate suggestions about where I might look to see what might be going on. Here is my query. In this version, I include 65 stocks and it doesn't work (<=64 does work). <code>  using (SqlConnection conn = new SqlConnection(_connectString)){ conn.Open(); using (SqlCommand cmd = new SqlCommand(queryString, conn)) { cmd.Parameters.Clear(); cmd.CommandTimeout = _timeout; SqlParameter param; if (parms != null) { foreach (string parm in parms.Keys) { param = cmd.Parameters.AddWithValue(parm, parms[parm]); } } SqlDataReader reader = cmd.ExecuteReader(); while (reader.Read()) { QueryResult record = new QueryResult(); record.Fields = new List<object>(); for (int i = 0; i < returnColumns; ++i) { object value = reader.GetValue(i); if (value == DBNull.Value) record.Fields.Add(null); else record.Fields.Add(value); } result.Add(record); } reader.Close(); } conn.Close();} select distinct a.Cusip, d.Value_ / f.CumAdjFactor as split_adj_valfrom qai.prc.PrcScChg ajoin qai.dbo.SecMapX b on a.Code = b.venCode and b.VenType = 1 and b.exchange = 1 and b.Rank = (select Min(Rank) from qai.dbo.SecMapX where VenCode = a.Code and VenType = 1 and Exchange = 1)join qai.dbo.SecMapX b2 on b2.seccode = b.seccode and b2.ventype = 40 and b2.exchange = 1 and b2.Rank = (select Min(Rank) from qai.dbo.SecMapX where SecCode = b.SecCode and VenType = 40 and Exchange = 1)join qai.dbo.SecMapX b3 on b3.seccode = b.seccode and b3.ventype = 33 and b3.exchange = 1 and b3.Rank = (select Min(Rank) from qai.dbo.SecMapX where SecCode = b.SecCode and VenType = 33 and Exchange = 1)join qai.dbo.DXLSecInfo c on b2.VenCode = c.Codejoin qai.dbo.DXLAmData d on c.Code = d.Code and d.Date_ = @Date and d.Item = 6left JOIN qai.dbo.DS2Adj f ON f.InfoCode = b3.VenCode AND f.AdjType = 2 and f.AdjDate <= @Date and ( f.EndAdjDate >= @Date or f.EndAdjDate is null )where a.cusip in ('00101J10', '00105510', '00120410', '00130H10', '00206R10', '00282410', '00287Y10', '00289620', '00724F10', '00817Y10', '00846U10', '00915810', '00936310', '00971T10', '01381710', '01535110', '01741R10', '01849010', '02000210', '02144110', '02209S10', '02313510', '02360810', '02553710', '02581610', '02687478', '03027X10', '03073E10', '03076C10', '03110010', '03116210', '03209510', '03251110', '03265410', '03741110', '03748R10', '03783310', '03822210', '03948310', '04621X10', '05276910', '05301510', '05329W10', '05333210', '05348410', '05361110', '05430310', '05493710', '05722410', '05849810', '06050510', '06405810', '06738310', '07181310', '07373010', '07588710', '07589610', '08143710', '08467070', '08651610', '09062X10', '09247X10', '09367110', '09702310', '09972410')","SQL query times out when run from C#, fast in SQL Server Management Studio"
SqlDependency fires immediatly," I want to use SqlDependency to get notifications when some datas are changed by others applications using the database. So, with a single line i can register an event handler : But my problem is that the notification is immediatly fired : That's why I commented AbonnementChanges in my event handler OnChanges (or it will loop infinitely).I don't know where the problem comes from because I reset the notifications ({ Notification = null }) and my request respect the requirements (https://msdn.microsoft.com/en-us/library/ms181122.aspx).Edit : I want to add that select * from sys.dm_qn_subscriptions returns nothing.Edit : It looks like it comes from database configuration, and not from my implemention, as i tried another implemention which result in the same behaviour : http://www.codeproject.com/Articles/144344/Query-Notification-using-SqlDependency-and-SqlCach Edit : I don't see where it comes from since i use SA which is sysadmin and have all rights, isn't it ?Edit : I tried to define another connection to the database following this tutorial : http://www.codeproject.com/Articles/12862/Minimum-Database-Permissions-Required-for-SqlDepenSo i created 2 roles : and then i added the user (production) to this roles :-- Making sure that my users are member of the correct role. But with this connection i have the same behaviour than before. Notification are fired imediatly : Edit : I tried with simpler requests like : SELECT Nom, Prenom FROM dbo.Utilisateur.Here are the details of the table which should be inspected : As we can see there are some columns which can't be requested. That's why i don't use it.Now let's check with SELECT Nom, Prenom FROM dbo.Utilisateur : The projected columns in the SELECT statement must be explicitlystated, and table names must be qualified with two-part names. Noticethat this means that all tables referenced in the statement must bein the same database. OKThe statement may not use the asterisk () or table_name. syntax tospecify columns. OKThe statement may not use unnamed columns or duplicate column names. OKThe statement must reference a base table. OKThe projected columns in the SELECT statement may not containaggregate expressions unless the statement uses a GROUP BYexpression. When a GROUP BY expression is provided, the select listmay contain the aggregate functions COUNT_BIG() or SUM(). However,SUM() may not be specified for a nullable column. OKThe statement may not specify HAVING, CUBE, or ROLLUP. A projectedcolumn in the SELECT statement that is used as a simple expressionmust not appear more than once. OKThe statement must not include PIVOT or UNPIVOT operators. OKThe statement must not include the INTERSECT or EXCEPT operators. OKThe statement must not reference a view. OKThe statement must not contain any of the following: DISTINCT,COMPUTE or COMPUTE BY, or INTO. OKThe statement must not reference server global variables(@@variable_name). OKThe statement must not reference derived tables, temporary tables, ortable variables. OKThe statement must not reference tables or views from other databasesor servers. OKThe statement must not contain subqueries, outer joins, orself-joins. OKThe statement must not reference the large object types: text, ntext,and image. OKThe statement must not use the CONTAINS or FREETEXT full-textpredicates. OKThe statement must not use rowset functions, including OPENROWSET andOPENQUERY. OKThe statement must not use any of the following aggregate functions:AVG, COUNT(*), MAX, MIN, STDEV, STDEVP, VAR, or VARP. OKThe statement must not use any nondeterministic functions, includingranking and windowing functions. OKThe statement must not contain user-defined aggregates. OKThe statement must not reference system tables or views, includingcatalog views and dynamic management views. OKThe statement must not include FOR BROWSE information. OKThe statement must not reference a queue. OKThe statement must not contain conditional statements that cannotchange and cannot return results (for example, WHERE 1=0). OKBut that still doesn't works ... =(Final edit - Solution : As Jon Tirjan said, it was caused by my computed column NomComplet which is not valid with the Service Broker (even when I don't ask to be notified on changes on this column, which is strange to me). <code>  public class DatabaseChangesNotification : IDisposable{ private static string chaineDeConnexion = ConfigurationManager.ConnectionStrings[""TransfertContext""].ConnectionString; private static readonly Lazy<DatabaseChangesNotification> _instance = new Lazy<DatabaseChangesNotification>(() => new DatabaseChangesNotification()); private DatabaseChangesNotification() { System.Diagnostics.Trace.WriteLine(""--- SqlDependency START ---""); SqlDependency.Start(chaineDeConnexion); } public void Dispose() { System.Diagnostics.Trace.WriteLine(""--- SqlDependency STOP ---""); SqlDependency.Stop(chaineDeConnexion); } public static DatabaseChangesNotification Instance { get { return _instance.Value; } } public void AbonnerNotification(string requete, OnChangeEventHandler eventhandler) { using (SqlConnection connection = new SqlConnection(chaineDeConnexion)) { using (SqlCommand command = new SqlCommand(requete, connection) { Notification = null }) // clear existing notifications { connection.Open(); var sqlDependency = new SqlDependency(command); OnChangeEventHandler delegateAutoRemove = null; delegateAutoRemove = (sender, e) => { var dependency = sender as SqlDependency; dependency.OnChange -= delegateAutoRemove; eventhandler(sender, e); }; sqlDependency.OnChange += delegateAutoRemove; command.ExecuteNonQuery(); } } }} DatabaseChangesNotification.Instance.AbonnerNotification(@""SELECT IdUtilisateur, Code, Nom, Prenom, NomComplet, Login, Synchroniser FROM dbo.Utilisateur"", OnChanges); public void OnChanges(object sender, SqlNotificationEventArgs e){ System.Diagnostics.Trace.WriteLine(""------------------------------ UPDATTEEEE -------------------------""); System.Diagnostics.Trace.WriteLine(""Info: "" + e.Info.ToString()); System.Diagnostics.Trace.WriteLine(""Source: "" + e.Source.ToString()); System.Diagnostics.Trace.WriteLine(""Type: "" + e.Type.ToString()); GlobalHost.ConnectionManager.GetHubContext<TransfertClientHub>().Clients.All.hello(""users modified !""); //AbonnementChanges(); } --- ABONNEMENT --------------------------------- UPDATTEEEE -------------------------Info: QuerySource: StatementType: Subscribe EXEC sp_addrole 'sql_dependency_subscriber' EXEC sp_addrole 'sql_dependency_starter' -- Permissions needed for [sql_dependency_starter]GRANT CREATE PROCEDURE to [sql_dependency_starter] GRANT CREATE QUEUE to [sql_dependency_starter]GRANT CREATE SERVICE to [sql_dependency_starter]GRANT REFERENCES on CONTRACT::[http://schemas.microsoft.com/SQL/Notifications/PostQueryNotification] to [sql_dependency_starter] GRANT VIEW DEFINITION TO [sql_dependency_starter] -- Permissions needed for [sql_dependency_subscriber] GRANT SELECT to [sql_dependency_subscriber] GRANT SUBSCRIBE QUERY NOTIFICATIONS TO [sql_dependency_subscriber] GRANT RECEIVE ON QueryNotificationErrorsQueue TO [sql_dependency_subscriber] GRANT REFERENCES on CONTRACT::[http://schemas.microsoft.com/SQL/Notifications/PostQueryNotification] to [sql_dependency_subscriber] EXEC sp_addrolemember 'sql_dependency_starter', 'production'EXEC sp_addrolemember 'sql_dependency_subscriber', 'production' ------------------------------ UPDATTEEEE -------------------------Info: QuerySource: StatementType: Subscribe SET ANSI_NULLS ONGOSET QUOTED_IDENTIFIER ONGOSET ANSI_PADDING ONGOCREATE TABLE [dbo].[Utilisateur]( [IdUtilisateur] [uniqueidentifier] ROWGUIDCOL NOT NULL CONSTRAINT [DF_Utilisateur_IdUtilisateur] DEFAULT (newid()), [Code] [varchar](10) NOT NULL, [Nom] [varchar](100) NOT NULL, [Prenom] [varchar](100) NULL, [NomComplet] AS (([Prenom]+' ')+[Nom]), [Login] [varchar](50) NULL, [Synchroniser] [bit] NOT NULL CONSTRAINT [DF_Utilisateur_Synchroniser] DEFAULT ((1)), [DATE_CREATION] [datetime] NOT NULL CONSTRAINT [DF__Utilisate__DATE___2AA1E7C7] DEFAULT (getdate()), [DATE_DERNIERE_MODIF] [datetime] NOT NULL CONSTRAINT [DF__Utilisate__DATE___2B960C00] DEFAULT (getdate()), [Desactive] [bit] NOT NULL CONSTRAINT [DF_Utilisateur_Desactive] DEFAULT ((0)), CONSTRAINT [PK_Utilisateur] PRIMARY KEY CLUSTERED ( [IdUtilisateur] ASC)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]) ON [PRIMARY]GOSET ANSI_PADDING OFFGO",SqlDependency fires immediately
Datatable containing SqlGeometry is causing Stored Proc execution to fail... Why?," I'm trying to save a series of SqlGeometry values to a SQL Server 2008 database.Basically I have a tabletype in a SQL Server stored procedure which looks like this: I then build a datatable in C# and send it like this: This works fine for all my other datatables but this one contains a SqlGeometry column and it falls over with the error message: An exception of type 'System.ArgumentException' occurred in System.Data.dll but was not handled in user code Additional information: The type of column 'geom' is not supported. The type is 'SqlGeometry'This doesn't make any sense to me as that datatype seems supported by what I'm reading in the documentation.Any thoughts?Edit:The comments below and the article I've linked: https://viswaug.wordpress.com/2008/09/29/inserting-spatial-data-in-sql-server-2008/ seem to suggest that I need to change the datattype of SqlGeometry to SqlDbType.Udt. Sadly as I'm using a datatable I've got no way of defining UdtTypeName = GEOMETRY; as this is set on the parameter. <code>  CREATE TYPE [dbo].[TableType_Example] AS TABLE( [SpatialID] [bigint] NOT NULL, [RecordID] [bigint] NOT NULL, [geom] [geometry] NOT NULL) public static bool SaveSpatialDataElements(long recordID, List<BOSpatial> featureList){ //Setup features datatable DataTable dtFeatures = new DataTable(); dtFeatures.Columns.Add(""SpatialID"", typeof(SqlInt64)); dtFeatures.Columns.Add(""RecordID"", typeof(SqlInt64)); dtFeatures.Columns.Add(""geom"", typeof(SqlGeometry)); foreach(var curFeature in featureList) { object[] curRowObjects = new object[dtFeatures.Columns.Count]; curRowObjects[0] = curFeature.SpatialID; curRowObjects[1] = recordID; using (var reader = new StringReader(curFeature.ToGML())) { using (var xmlreader = new XmlTextReader(reader)) { curRowObjects[2] = SqlGeometry.GeomFromGml(new SqlXml(xmlreader), 0); } } DataRow row = dtFeatures.NewRow(); row.ItemArray = curRowObjects; dtFeatures.Rows.Add(row); } DbConn conn = new DbConn(); conn.Connect(); conn.ExecuteStoredProcedure(false, ""USP_tblSpatialLocation_Update"", recordID, dtFeatures); conn.Disconnect(); return true; }",Datatable containing SqlGeometry is causing stored procedure execution to fail... Why?
Emulate touch events with windows 7," I'm currently trying to develop a touch screen application with:Windows 7Visual Studio 2013C# - WPFThe place I'm working at is going to receive a touch screen (actually a layer to put on a flat screen). I would like to be able to generate touch inputs in order to develop and test the application without the screen.All the resources I find, are either quite old or complicated.What is the best way today to develop and test touch screen applications, without the touch screen ? <code> ",How do I Emulate touch events without using touch screen
Why are those two string comparaison return different result?," Here is a small piece of code : Why ?  <code>  String a = ""abc"";Console.WriteLine(((object)a) == (""ab"" + ""c"")); // true Console.WriteLine(((object)a) == (""ab"" + 'c')); // false ",Why do these two string comparisons return different results?
Why are those two string comparison return different result?," Here is a small piece of code : Why ?  <code>  String a = ""abc"";Console.WriteLine(((object)a) == (""ab"" + ""c"")); // true Console.WriteLine(((object)a) == (""ab"" + 'c')); // false ",Why do these two string comparisons return different results?
Why does those string comparisons returning different results?," Here is a small piece of code : Why ?  <code>  String a = ""abc"";Console.WriteLine(((object)a) == (""ab"" + ""c"")); // true Console.WriteLine(((object)a) == (""ab"" + 'c')); // false ",Why do these two string comparisons return different results?
Why does these two string comparisons return different results?," Here is a small piece of code : Why ?  <code>  String a = ""abc"";Console.WriteLine(((object)a) == (""ab"" + ""c"")); // true Console.WriteLine(((object)a) == (""ab"" + 'c')); // false ",Why do these two string comparisons return different results?
What happens with Directory.EnumerateFiles is directory content changes during iteration?," I've read discussions about difference between Directory.EnumerateFiles and Directory.GetFiles.I understand that internally they both useSystem.IO.FileSystemEnumerableFactory.CreateFileNameIterator()The difference is that EnumerateFiles might use deferred execution (lazy), while GetFiles() does a ToArray, so the function is already executed.But what happens if files and folders are added to the dictionary during the iteration. Will the iteration only iterate over the items that were present during the EnumerateFiles()?Even worse: what happens if files are removed during iterations: will they still be iterated?  <code> ",What happens with Directory.EnumerateFiles if directory content changes during iteration?
MVC 5.2.3 - Globalization driving me crazy..... DateTime and Decimal with Range," Long story short, I started a new project using MVC 5.2.3 (with all updated JS frameworks) expecting that many of the issues I had with validations from MVC 2 were solved, how wrong was I.Basically I am driving myself crazy trying to provide validation to DateTime and Decimal.With the decimal field, using browsers in EN and DE (cultures) I am getting problems with comma and point (decimal division) and with the range that I am setting.With the DateTime I even tried a DisplayFormat just to display the Date and not the time, and anyway the order of day/month/year with separations with . or / or - are simply failing.Examples:In DE - Type: 999,999 --> Result: ERROR ""Das Feld ""D1 DE"" muss zwischen 0 und 999,9999 liegen. "" - should be accepted.In EN - Type: 999.999 --> Result: is accepted as it should be (correct)The same applies to the datetime display format and similar JS validations....I share with you guys what I have at the moment:TestObject view.cshtml _layout.cshtml DecimalModelBinder }Global.asax web.config <code>  public class TestObject{ .... [Display(Name = ""D2"", ResourceType = typeof(WebApplication1.Models.Res.TestObject))] [Range(0, 999.9999)] public decimal? D1 { get; set; } // On DBContext I have defined the range/precision // modelBuilder.Entity<TestObject>().Property(x => x.D2).HasPrecision(7, 4); [Display(Name = ""Date1"", ResourceType = typeof(WebApplication1.Models.Res.TestObject))] //[DisplayFormat(ApplyFormatInEditMode = true, DataFormatString = @""{0:dd\/MM\/yyyy}"")] public DateTime Date1 { get; set; } ....} <div class=""form-group""> @Html.LabelFor(model => model.D2, htmlAttributes: new { @class = ""control-label col-md-2"" }) <div class=""col-md-10""> @Html.EditorFor(model => model.D2, new { htmlAttributes = new { @class = ""form-control"" } }) @Html.ValidationMessageFor(model => model.D2, """", new { @class = ""text-danger"" }) </div> </div> <div class=""form-group""> @Html.LabelFor(model => model.Date1, htmlAttributes: new { @class = ""control-label col-md-2"" }) <div class=""col-md-10""> @Html.EditorFor(model => model.Date1, new { htmlAttributes = new { @class = ""form-control"" } }) @Html.ValidationMessageFor(model => model.Date1, """", new { @class = ""text-danger"" }) </div> </div> <script src=""~/Scripts/globalize/globalize.js"" type=""text/javascript""></script></script> <script src=""~/Scripts/globalize/cultures/globalize.culture.de.js"" type=""text/javascript""></script> <script src=""~/Scripts/globalize/cultures/globalize.culture.en-US.js"" type=""text/javascript""></script> <script> $.validator.methods.number = function (value, element) { return this.optional(element) || !isNaN(Globalize.parseFloat(value)); } $.validator.methods.date = function (value, element) { return this.optional(element) || Globalize.parseDate(value); } $(document).ready(function () { Globalize.culture('@System.Threading.Thread.CurrentThread.CurrentCulture'); });</script> public class DecimalModelBinder : DefaultModelBinder{public override object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext){ object result = null; // Don't do this here! // It might do bindingContext.ModelState.AddModelError // and there is no RemoveModelError! // // result = base.BindModel(controllerContext, bindingContext); string modelName = bindingContext.ModelName; string attemptedValue = bindingContext.ValueProvider.GetValue(modelName).AttemptedValue; // Depending on CultureInfo, the NumberDecimalSeparator can be "","" or ""."" // Both ""."" and "","" should be accepted, but aren't. string wantedSeperator = NumberFormatInfo.CurrentInfo.NumberDecimalSeparator; string alternateSeperator = (wantedSeperator == "","" ? ""."" : "",""); if (attemptedValue.IndexOf(wantedSeperator) == -1 && attemptedValue.IndexOf(alternateSeperator) != -1) { attemptedValue = attemptedValue.Replace(alternateSeperator, wantedSeperator); } try { if (bindingContext.ModelMetadata.IsNullableValueType && string.IsNullOrWhiteSpace(attemptedValue)) { return null; } result = decimal.Parse(attemptedValue, NumberStyles.Any); } catch (FormatException e) { bindingContext.ModelState.AddModelError(modelName, e); } return result;} public class MvcApplication : System.Web.HttpApplication{ protected void Application_Start() { ... ModelBinders.Binders.Add(typeof(decimal), new DecimalModelBinder()); ModelBinders.Binders.Add(typeof(decimal?), new DecimalModelBinder()); ... } private void Application_BeginRequest(Object source, EventArgs e) { HttpApplication application = (HttpApplication)source; HttpContext context = application.Context; string culture = null; if (context.Request.UserLanguages != null && Request.UserLanguages.Length > 0) { culture = Request.UserLanguages[0]; Thread.CurrentThread.CurrentCulture = new System.Globalization.CultureInfo(culture); Thread.CurrentThread.CurrentUICulture = Thread.CurrentThread.CurrentCulture; } }} <globalization culture=""auto"" uiCulture=""auto"" enableClientBasedCulture=""true"" />",MVC 5.2.3 - Globalization - DateTime & Decimal with Range
MVC 5.2.3 - Globalization's driving me crazy..... DateTime and Decimal with Range," Long story short, I started a new project using MVC 5.2.3 (with all updated JS frameworks) expecting that many of the issues I had with validations from MVC 2 were solved, how wrong was I.Basically I am driving myself crazy trying to provide validation to DateTime and Decimal.With the decimal field, using browsers in EN and DE (cultures) I am getting problems with comma and point (decimal division) and with the range that I am setting.With the DateTime I even tried a DisplayFormat just to display the Date and not the time, and anyway the order of day/month/year with separations with . or / or - are simply failing.Examples:In DE - Type: 999,999 --> Result: ERROR ""Das Feld ""D1 DE"" muss zwischen 0 und 999,9999 liegen. "" - should be accepted.In EN - Type: 999.999 --> Result: is accepted as it should be (correct)The same applies to the datetime display format and similar JS validations....I share with you guys what I have at the moment:TestObject view.cshtml _layout.cshtml DecimalModelBinder }Global.asax web.config <code>  public class TestObject{ .... [Display(Name = ""D2"", ResourceType = typeof(WebApplication1.Models.Res.TestObject))] [Range(0, 999.9999)] public decimal? D1 { get; set; } // On DBContext I have defined the range/precision // modelBuilder.Entity<TestObject>().Property(x => x.D2).HasPrecision(7, 4); [Display(Name = ""Date1"", ResourceType = typeof(WebApplication1.Models.Res.TestObject))] //[DisplayFormat(ApplyFormatInEditMode = true, DataFormatString = @""{0:dd\/MM\/yyyy}"")] public DateTime Date1 { get; set; } ....} <div class=""form-group""> @Html.LabelFor(model => model.D2, htmlAttributes: new { @class = ""control-label col-md-2"" }) <div class=""col-md-10""> @Html.EditorFor(model => model.D2, new { htmlAttributes = new { @class = ""form-control"" } }) @Html.ValidationMessageFor(model => model.D2, """", new { @class = ""text-danger"" }) </div> </div> <div class=""form-group""> @Html.LabelFor(model => model.Date1, htmlAttributes: new { @class = ""control-label col-md-2"" }) <div class=""col-md-10""> @Html.EditorFor(model => model.Date1, new { htmlAttributes = new { @class = ""form-control"" } }) @Html.ValidationMessageFor(model => model.Date1, """", new { @class = ""text-danger"" }) </div> </div> <script src=""~/Scripts/globalize/globalize.js"" type=""text/javascript""></script></script> <script src=""~/Scripts/globalize/cultures/globalize.culture.de.js"" type=""text/javascript""></script> <script src=""~/Scripts/globalize/cultures/globalize.culture.en-US.js"" type=""text/javascript""></script> <script> $.validator.methods.number = function (value, element) { return this.optional(element) || !isNaN(Globalize.parseFloat(value)); } $.validator.methods.date = function (value, element) { return this.optional(element) || Globalize.parseDate(value); } $(document).ready(function () { Globalize.culture('@System.Threading.Thread.CurrentThread.CurrentCulture'); });</script> public class DecimalModelBinder : DefaultModelBinder{public override object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext){ object result = null; // Don't do this here! // It might do bindingContext.ModelState.AddModelError // and there is no RemoveModelError! // // result = base.BindModel(controllerContext, bindingContext); string modelName = bindingContext.ModelName; string attemptedValue = bindingContext.ValueProvider.GetValue(modelName).AttemptedValue; // Depending on CultureInfo, the NumberDecimalSeparator can be "","" or ""."" // Both ""."" and "","" should be accepted, but aren't. string wantedSeperator = NumberFormatInfo.CurrentInfo.NumberDecimalSeparator; string alternateSeperator = (wantedSeperator == "","" ? ""."" : "",""); if (attemptedValue.IndexOf(wantedSeperator) == -1 && attemptedValue.IndexOf(alternateSeperator) != -1) { attemptedValue = attemptedValue.Replace(alternateSeperator, wantedSeperator); } try { if (bindingContext.ModelMetadata.IsNullableValueType && string.IsNullOrWhiteSpace(attemptedValue)) { return null; } result = decimal.Parse(attemptedValue, NumberStyles.Any); } catch (FormatException e) { bindingContext.ModelState.AddModelError(modelName, e); } return result;} public class MvcApplication : System.Web.HttpApplication{ protected void Application_Start() { ... ModelBinders.Binders.Add(typeof(decimal), new DecimalModelBinder()); ModelBinders.Binders.Add(typeof(decimal?), new DecimalModelBinder()); ... } private void Application_BeginRequest(Object source, EventArgs e) { HttpApplication application = (HttpApplication)source; HttpContext context = application.Context; string culture = null; if (context.Request.UserLanguages != null && Request.UserLanguages.Length > 0) { culture = Request.UserLanguages[0]; Thread.CurrentThread.CurrentCulture = new System.Globalization.CultureInfo(culture); Thread.CurrentThread.CurrentUICulture = Thread.CurrentThread.CurrentCulture; } }} <globalization culture=""auto"" uiCulture=""auto"" enableClientBasedCulture=""true"" />",MVC 5.2.3 - Globalization - DateTime & Decimal with Range
MVC 5.2.3 - Globalization - driving me crazy..... DateTime & Decimal with Range," Long story short, I started a new project using MVC 5.2.3 (with all updated JS frameworks) expecting that many of the issues I had with validations from MVC 2 were solved, how wrong was I.Basically I am driving myself crazy trying to provide validation to DateTime and Decimal.With the decimal field, using browsers in EN and DE (cultures) I am getting problems with comma and point (decimal division) and with the range that I am setting.With the DateTime I even tried a DisplayFormat just to display the Date and not the time, and anyway the order of day/month/year with separations with . or / or - are simply failing.Examples:In DE - Type: 999,999 --> Result: ERROR ""Das Feld ""D1 DE"" muss zwischen 0 und 999,9999 liegen. "" - should be accepted.In EN - Type: 999.999 --> Result: is accepted as it should be (correct)The same applies to the datetime display format and similar JS validations....I share with you guys what I have at the moment:TestObject view.cshtml _layout.cshtml DecimalModelBinder }Global.asax web.config <code>  public class TestObject{ .... [Display(Name = ""D2"", ResourceType = typeof(WebApplication1.Models.Res.TestObject))] [Range(0, 999.9999)] public decimal? D1 { get; set; } // On DBContext I have defined the range/precision // modelBuilder.Entity<TestObject>().Property(x => x.D2).HasPrecision(7, 4); [Display(Name = ""Date1"", ResourceType = typeof(WebApplication1.Models.Res.TestObject))] //[DisplayFormat(ApplyFormatInEditMode = true, DataFormatString = @""{0:dd\/MM\/yyyy}"")] public DateTime Date1 { get; set; } ....} <div class=""form-group""> @Html.LabelFor(model => model.D2, htmlAttributes: new { @class = ""control-label col-md-2"" }) <div class=""col-md-10""> @Html.EditorFor(model => model.D2, new { htmlAttributes = new { @class = ""form-control"" } }) @Html.ValidationMessageFor(model => model.D2, """", new { @class = ""text-danger"" }) </div> </div> <div class=""form-group""> @Html.LabelFor(model => model.Date1, htmlAttributes: new { @class = ""control-label col-md-2"" }) <div class=""col-md-10""> @Html.EditorFor(model => model.Date1, new { htmlAttributes = new { @class = ""form-control"" } }) @Html.ValidationMessageFor(model => model.Date1, """", new { @class = ""text-danger"" }) </div> </div> <script src=""~/Scripts/globalize/globalize.js"" type=""text/javascript""></script></script> <script src=""~/Scripts/globalize/cultures/globalize.culture.de.js"" type=""text/javascript""></script> <script src=""~/Scripts/globalize/cultures/globalize.culture.en-US.js"" type=""text/javascript""></script> <script> $.validator.methods.number = function (value, element) { return this.optional(element) || !isNaN(Globalize.parseFloat(value)); } $.validator.methods.date = function (value, element) { return this.optional(element) || Globalize.parseDate(value); } $(document).ready(function () { Globalize.culture('@System.Threading.Thread.CurrentThread.CurrentCulture'); });</script> public class DecimalModelBinder : DefaultModelBinder{public override object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext){ object result = null; // Don't do this here! // It might do bindingContext.ModelState.AddModelError // and there is no RemoveModelError! // // result = base.BindModel(controllerContext, bindingContext); string modelName = bindingContext.ModelName; string attemptedValue = bindingContext.ValueProvider.GetValue(modelName).AttemptedValue; // Depending on CultureInfo, the NumberDecimalSeparator can be "","" or ""."" // Both ""."" and "","" should be accepted, but aren't. string wantedSeperator = NumberFormatInfo.CurrentInfo.NumberDecimalSeparator; string alternateSeperator = (wantedSeperator == "","" ? ""."" : "",""); if (attemptedValue.IndexOf(wantedSeperator) == -1 && attemptedValue.IndexOf(alternateSeperator) != -1) { attemptedValue = attemptedValue.Replace(alternateSeperator, wantedSeperator); } try { if (bindingContext.ModelMetadata.IsNullableValueType && string.IsNullOrWhiteSpace(attemptedValue)) { return null; } result = decimal.Parse(attemptedValue, NumberStyles.Any); } catch (FormatException e) { bindingContext.ModelState.AddModelError(modelName, e); } return result;} public class MvcApplication : System.Web.HttpApplication{ protected void Application_Start() { ... ModelBinders.Binders.Add(typeof(decimal), new DecimalModelBinder()); ModelBinders.Binders.Add(typeof(decimal?), new DecimalModelBinder()); ... } private void Application_BeginRequest(Object source, EventArgs e) { HttpApplication application = (HttpApplication)source; HttpContext context = application.Context; string culture = null; if (context.Request.UserLanguages != null && Request.UserLanguages.Length > 0) { culture = Request.UserLanguages[0]; Thread.CurrentThread.CurrentCulture = new System.Globalization.CultureInfo(culture); Thread.CurrentThread.CurrentUICulture = Thread.CurrentThread.CurrentCulture; } }} <globalization culture=""auto"" uiCulture=""auto"" enableClientBasedCulture=""true"" />",MVC 5.2.3 - Globalization - DateTime & Decimal with Range
Copying a dataset from one project to another in VisualStudio 2013," I want to do a very simple thing: move some code in VS13 from one project in to another one and I'm facing the strange problem with datasets. For simplicity let's say that in my source project I have one dataset named MyDataSet which consists from 5 files: MyDataSet.cs, MyDataSet.Designer.cs, MyDataSet.xsc, MyDataSet.xsd, MyDataSet.xss.Then I copy these files to my destination project folder using standard windows functionality and use Include in Project menu option in VS13. After that I see that one extra file was added: MyDataSet1.Designer.cs.I tried to check cproj files and they are different.Source (only parts different from target are shown): Target (only part different from source are shown): Also I noticed that in MyDataSet.cs and MyDataSet1.Designer.cs namespaces were automatically changed to correct ones.I'm using ReSharper, and first I thought that it can be a reason of that, but I disabled ReSharper and the same behavior continues to happen.Probably I can fix that by removing newly created files and modifying cproj files, but actually there are a lot of datasets that I need to copy and I really don't like that kind of work.Does anyone have any ideas what can be a reason of such problem and how can it be solved? <code>  <Compile Include=""MyDataSet.Designer.cs""> <AutoGen>True</AutoGen> <DesignTime>True</DesignTime> <DependentUpon>MyDataSet.xsd</DependentUpon></Compile><None Include=""MyDataSet.xsd""> <SubType>Designer</SubType> <Generator>MSDataSetGenerator</Generator> <LastGenOutput>MyDataSet.Designer.cs</LastGenOutput></None> <Compile Include=""MyDataSet.Designer.cs""> <DependentUpon>MyDataSet.cs</DependentUpon></Compile><Compile Include=""MyDataSet1.Designer.cs""> <AutoGen>True</AutoGen> <DesignTime>True</DesignTime> <DependentUpon>MyDataSet.xsd</DependentUpon></Compile><None Include=""MyDataSet.xsd""> <Generator>MSDataSetGenerator</Generator> <LastGenOutput>MyDataSet1.Designer.cs</LastGenOutput> <SubType>Designer</SubType></None>","""Include in Project"" strange behavior for dataset in VisualStudio 2013"
EF7 configuring an identity column, How do I create an Auto increment identity column in Entity Framework Core?Obviously I can do it using fluent API for EF6 for example. <code> ,How to configure an Identity column using Entity Framework Core?
Is code that disposes CancellationTokenSource while tasks are canceling," I see this code in front of me and I am suspicious: Is it safe to call _cts.Dispose() straight after cancel? Wouldn't that dispose of underlying resources of the CancellationTokenSource that are needed for the task being cancelled to successfully Wait on the CancellationToken, if it wanted to do so? <code>  CancellationTokenSource _cts;public void Dispose();{ _cts.Cancel(); _cts.Dispose(); _task.Wait(); //wait for the task to be canceled!?}",Is code that disposes CancellationTokenSource while tasks are canceling correct?
Decorator pattern in c# without Inheritance. Is this correct?," If this is the decorator pattern. What is the difference between the decorator pattern and composition? I have seen examples of this pattern where inheritance is used. For instance the Java example on Wikipedia.I don't see the need to use inheritance at all, or am I missing something? <code>  public interface IMovable { void Move(); } public interface IUnloadable { void Unload(); } public class Vehicle : IMovable { public void Move() { Console.Write(""moving""); } } public class Truck : IMovable, IUnloadable { private Vehicle Veh; public Truck(Vehicle veh) { this.Veh = veh; } public void Move() { Veh.Move(); Console.Write(""reverse with beepy noise as well""); } public void Unload() { Console.Write(""Unload""); } }",Decorator pattern in C# without Inheritance. Is this correct?
What should i do if i want to create multiple overloads of CRUD methods?," If I have a class which represent a mapping to a specific table in my db in somehow.This class contains about 30 properties.I have created the CRUD Methods.And find myself need to another (UPDATE) method which should update just two fields.What should I do in a good manner with simple example?Using my exist method, Filling the whole object and update all the fields including my intended two fields? (Useless work)Create static Method with another name (but I want to keep my method name because it's expressive)! And takes two parameters? <code> ",How do I create multiple overloads of CRUD methods?
Check if a string contains particualr characters in any order, The best way that I can explain what I'm trying to do is by giving an example:I have a string StackOverflow in my database and when a user types OAW I would like to return that string and any other word that contains those three characters in any order.I've tried playing with various LINQ/Lambda expressions but to no avail. I found a post here on SO that looks similar to mine but it's in Java. I feel what I'm trying to do is extremely simple to implement but I'm just missing it. Any help will be greatly appreciated. <code>  query.Where(a => a.SerialNumber.Contains(a));,Check if a string contains particular characters in any order
System.Data.SqlClient.SqlException: Cannot open database <database> requested by the login. The login failed," I am developing an application in C# using Visual Studio 2013 and want to connect to my database.I've attempted to do this the code and connection string below. I get the error message: System.Web.Services.Protocols.SoapException: Servern kunde inte behandla begran. ---> System.Data.SqlClient.SqlException: Cannot open database ""[Demo Database Nav (5-0)]"" requested by the login. The login failed. Login failed for user 'us'.I have opened SQL Server and added the login 'us' with the password 'id'. I have made this login a db_owner and associated it with the right Database. I have tried this with several logins but none of them have worked. Is there something wrong with my connection string? <code>  SqlConnection con = new SqlConnection(); con.ConnectionString = ""server=.;database=[Demo Database Nav (5-0)];user=us;password=id"";",SqlException: Cannot open database <database> requested by the login. The login failed
c# target all labels with a particulair name," For a school project we are creating a C# application where children can learn.I made a template in the windows form and want to change the placeholder with the choice of the child, so it can become 1x choice, 2x choice, etc.I gave every label a name that starts with tafel_noemer_ - tafel_noemer_1, tafel_noemer_2, etc.Now I want to select all those labels up to label 10 and change the placeholder text. I tried this.Name.StartsWith(""tafel_noemer_"") but can't get it to work with foreach.Is there a better way to accomplish this? <code> ",Get all controls with names that start with specific string
Extreme execution time difference b/t c# & python," Below is a simple piece of process coded in C# and Python respectively (for those of you curious about the process, it's the solution for Problem No. 5 of Project Euler).My question is, the C# code below takes only 9 seconds to iterate, while completion of Python code takes 283 seconds (to be exact, 283 seconds on Python 3.4.3 - 64 bits and 329 seconds on Python 2.7.9 - 32 bits).So far, I've coded similar processes both in C# and Python and the execution time differences were comparable. This time however, there is an extreme difference between the elapsed times.I think, some part of this difference arise from the flexible variable type of python language (I suspect, python converts some part of variables into double) but this much is still hard to explain.What am I doing wrong?My system: Windows-7 64 bits,C# - VS Express 2012 (9 seconds)Python 3.4.3 64 bits (283 seconds)Python 2.7.9 32 bits (329 seconds)c-sharp code: and python code: <code>  using System;namespace bug_vcs { class Program { public static void Main(string[] args) { DateTime t0 = DateTime.Now; int maxNumber = 20; bool found = false; long start = maxNumber; while (!found) { found = true; int i = 2; while ((i < maxNumber + 1) && found) { if (start % i != 0) { found = false; } i++; } start++; } Console.WriteLine(""{0:d}"", start - 1); Console.WriteLine(""time elapsed = {0:f} sec."", (DateTime.Now - t0).Seconds); Console.ReadLine(); } }} from datetime import datetimet0 = datetime.now()max_number = 20found = Falsestart = max_numberwhile not found: found = True i = 2 while ((i < max_number + 1) and found): if (start % i) != 0: found = False i += 1 start += 1print(""number {0:d}\n"".format(start - 1))print(""time elapsed = {0:f} sec.\n"".format((datetime.now() - t0).seconds))",Why is my computation so much faster in C# than Python
Extreme execution time difference b/w C# & Python," Below is a simple piece of process coded in C# and Python respectively (for those of you curious about the process, it's the solution for Problem No. 5 of Project Euler).My question is, the C# code below takes only 9 seconds to iterate, while completion of Python code takes 283 seconds (to be exact, 283 seconds on Python 3.4.3 - 64 bits and 329 seconds on Python 2.7.9 - 32 bits).So far, I've coded similar processes both in C# and Python and the execution time differences were comparable. This time however, there is an extreme difference between the elapsed times.I think, some part of this difference arise from the flexible variable type of python language (I suspect, python converts some part of variables into double) but this much is still hard to explain.What am I doing wrong?My system: Windows-7 64 bits,C# - VS Express 2012 (9 seconds)Python 3.4.3 64 bits (283 seconds)Python 2.7.9 32 bits (329 seconds)c-sharp code: and python code: <code>  using System;namespace bug_vcs { class Program { public static void Main(string[] args) { DateTime t0 = DateTime.Now; int maxNumber = 20; bool found = false; long start = maxNumber; while (!found) { found = true; int i = 2; while ((i < maxNumber + 1) && found) { if (start % i != 0) { found = false; } i++; } start++; } Console.WriteLine(""{0:d}"", start - 1); Console.WriteLine(""time elapsed = {0:f} sec."", (DateTime.Now - t0).Seconds); Console.ReadLine(); } }} from datetime import datetimet0 = datetime.now()max_number = 20found = Falsestart = max_numberwhile not found: found = True i = 2 while ((i < max_number + 1) and found): if (start % i) != 0: found = False i += 1 start += 1print(""number {0:d}\n"".format(start - 1))print(""time elapsed = {0:f} sec.\n"".format((datetime.now() - t0).seconds))",Why is my computation so much faster in C# than Python
"C# Compare two System.Enum of type T where T : X, Y, Z"," I am pretty close to understand Generics now (I think).However, just figured that System.Enum is not easy to implement as a generic type.I have this class: and An InputDevice might look like that: The compiler throws a compile error right here: I believe I cannot compare these two TEnums because they are not actually known to be Enums. And thus no comparison method is available.I used this resource:Create Generic method constraining T to an EnumI appreciate any better solution or fix.(But I want to keep the Enum entry as a parameter to GetButton(EnumEntry)) <code>  public class Button<TEnum> where TEnum : struct, IConvertible, IComparable, IFormattable { public TEnum Identifier { get; private set; //Set in the ctor }} public abstract class AbstractInputDevice<TEnum> where TEnum : struct, IConvertible, IComparable, IFormattable { private List<Button<TEnum>> _buttons = new List<Button<TEnum>>(); public Button<TEnum> GetButton(TEnum Identifier){ foreach(Button<TEnum> button in _buttons){ if(button.Identifier == Identifier) //<- compiler throws return button; } Debug.Log(""'"" + GetType().Name + ""' cannot return an <b>unregistered</b> '"" + typeof(Button<TEnum>).Name + ""' that listens to '"" + typeof(TEnum).Name + ""."" + Identifier.ToString() + ""'.""); return null; }} public class Keyboard : AbstractInputDevice<KeyCode> { private void Useless(){ Button<KeyCode> = GetButton(KeyCode.A); }} if(button.Identifier == Identifier) //In AbstractInputDevice above",Compare two System.Enum of type T
"Compare two System.Enum of type T where T : X, Y, Z"," I am pretty close to understand Generics now (I think).However, just figured that System.Enum is not easy to implement as a generic type.I have this class: and An InputDevice might look like that: The compiler throws a compile error right here: I believe I cannot compare these two TEnums because they are not actually known to be Enums. And thus no comparison method is available.I used this resource:Create Generic method constraining T to an EnumI appreciate any better solution or fix.(But I want to keep the Enum entry as a parameter to GetButton(EnumEntry)) <code>  public class Button<TEnum> where TEnum : struct, IConvertible, IComparable, IFormattable { public TEnum Identifier { get; private set; //Set in the ctor }} public abstract class AbstractInputDevice<TEnum> where TEnum : struct, IConvertible, IComparable, IFormattable { private List<Button<TEnum>> _buttons = new List<Button<TEnum>>(); public Button<TEnum> GetButton(TEnum Identifier){ foreach(Button<TEnum> button in _buttons){ if(button.Identifier == Identifier) //<- compiler throws return button; } Debug.Log(""'"" + GetType().Name + ""' cannot return an <b>unregistered</b> '"" + typeof(Button<TEnum>).Name + ""' that listens to '"" + typeof(TEnum).Name + ""."" + Identifier.ToString() + ""'.""); return null; }} public class Keyboard : AbstractInputDevice<KeyCode> { private void Useless(){ Button<KeyCode> = GetButton(KeyCode.A); }} if(button.Identifier == Identifier) //In AbstractInputDevice above",Compare two System.Enum of type T
Why these operators work?," I have got a struct: And now I can do: It seems the compiler is smart enough to convert Decibel to double, and then use the < operator for doubles? I had different struct named Duration, which was wrapping TimeSpan. It had implicit conversions for TimeSpan to/from Duration, but the < and > operators are not working for it.Does c# only recognize conversion between primitive types? <code>  public struct Decibel{ public readonly double Value; public Decibel (double value) { Value = value; } public static implicit operator Decibel (double decibels) { return new Decibel (decibels); } public static implicit operator double (Decibel decibels) { return decibels.Value; }} bool x = new Decibel (0) < new Decibel (1);",What implicit conversions are supported when using < and > operators?
convert string Persian date to datetime for convert to miladi date," To convert a string Persian date to gregorian DateTime, I use date time picker and it sends me a string like ""//"" and my function that converts is It gives DateTime how can I send correct DateTime when it wants to convert shows this error: Input string was not in a correct format. <code>  PersianCalendar p = new PersianCalendar(); string[] d = start.Split('/'); DateTime dt = new DateTime(int.Parse(d[0]), int.Parse(d[1]), int.Parse(d[2]), new HijriCalendar()); public static DateTime ToGregorianDate(this DateTime dt){ PersianCalendar pc = new PersianCalendar(); return pc.ToDateTime(dt.Year, dt.Month, dt.Day, dt.Hour, dt.Minute, 0, 0); }",Convert string Persian date to Gregorian DateTime
Convert string Persian date to datetime for convert to miladi date," To convert a string Persian date to gregorian DateTime, I use date time picker and it sends me a string like ""//"" and my function that converts is It gives DateTime how can I send correct DateTime when it wants to convert shows this error: Input string was not in a correct format. <code>  PersianCalendar p = new PersianCalendar(); string[] d = start.Split('/'); DateTime dt = new DateTime(int.Parse(d[0]), int.Parse(d[1]), int.Parse(d[2]), new HijriCalendar()); public static DateTime ToGregorianDate(this DateTime dt){ PersianCalendar pc = new PersianCalendar(); return pc.ToDateTime(dt.Year, dt.Month, dt.Day, dt.Hour, dt.Minute, 0, 0); }",Convert string Persian date to Gregorian DateTime
Object instanciation fails when using overloaded constructor," I recently stumbled upon an odd issue which I could not explain and I would be glad if someone could clarify why it happens.The issue I've encountered is as follows:I have an interface which is implemented, like so: And another interface which is implemented in a different project, like so: I have an object which uses those interfaces in it's constructors, like so: And finally, I have a class which aggregates the above object, like so: Oddly, this code won't compile with the following error: The type 'InterfaceOne.IB' is defined in an assembly that is not referenced. You must add a reference to assembly 'InterfaceOne, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null'. c:\users\harry.baden\documents\visual studio 2013\Projects\ReferenceTest\ReferenceTest\ReferenceTest.cs 11 13 ReferenceTestI also found that if I change one of the overloads to contain an extra parameter - it does compile... What got me thinking that the problem might be related to some sort of reflection issue which the compiler is running.Thanks,Barak. <code>  namespace InterfaceTwo{ public interface IA { }}namespace InterfaceTwo{ public class A : IA { }} namespace InterfaceOne{ public interface IB { }}namespace InterfaceOne{ public class B : IB { }} using InterfaceOne;using InterfaceTwo;namespace MainObject{ public class TheMainObject { public TheMainObject(IA iaObj) { } public TheMainObject(IB iaObj) { } }} using InterfaceTwo;using MainObject;namespace ReferenceTest{ public class ReferenceTest { public void DoSomething() { var a = new A(); var theMainObject = new TheMainObject(a); } }}",Object instantiation fails when using overloaded constructor
Out of memory exception while updating zip in c#.net," I am getting OutofMemoryException while trying to add files to a .zip file. I am using 32-bit architecture for building and running the application. I am unable to understand the reason behind it. <code>  string[] filePaths = Directory.GetFiles(Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) + ""\\capture\\capture"");System.IO.Compression.ZipArchive zip = ZipFile.Open(filePaths1[c], ZipArchiveMode.Update);foreach (String filePath in filePaths){ string nm = Path.GetFileName(filePath); zip.CreateEntryFromFile(filePath, ""capture/"" + nm, CompressionLevel.Optimal);}zip.Dispose();zip = null;",Out of memory exception while updating zip
Parse and modify a query string in DNX," I am given an absolute URI that contains a query string. I'm looking to safely append a value to the query string, and change an existing parameter.I would prefer not to tack on &foo=bar, or use regular expressions, URI escaping is tricky. Rather I want to use a built-in mechanism that I know will do this correctly and handle the escaping.I've found a ton of answers that all use HttpUtility. However this being ASP.NET Core, there is no more System.Web assembly anymore, thus no more HttpUtility.What is the appropriate way to do this in ASP.NET Core while targeting the core runtime? <code> ",Parse and modify a query string in .NET Core
Merging custom configuration files at runtime in .NET," My question is about working with standard .NET configuration objects and custom configuration elements as well, (which one can define by extending the System.Configuration.ConfigurationSection class). We usually obtain these from the System.Configuration.ConfigurationManager class's methods, GetSection(...) being an example.The loaded configuration object appears to be a merged configuration object containing the setup present in the application config file (the the app.config or web.config file which a developer may have created) and what is defined in the machine.config file (the latter coming with the .NET Framework installation).So, we can assume that the configuration is loaded in hierarchical manner with the machine.config first, and any user-defined configuration overlaying that default setup, and could be looked at like this:machine.configapp.config (overrides / merges with respective elements found in machine.config )My goal is to create multiple layers of configuration, so that there might be other config files between (and if possible, after) the machine.config and the app.config file:machine.configcustom.config (a custom config interfering between the machine.config and the app.config file)app.config - now app.config is merged with both machine.config and custom.configUpdate The point with that is - if I have defined the configuration section in both custom.config and app.config, I need to get a merged version of both configs when I call ConfigurationManager.GetSection(""MyCustomSection""). Ideally, it will be great if I am able to perform merging as describe in this MSDN article.Normally, I would write my own configuration manager class and will try to get as far as I could to get the desired result, but assuming the .NET framework has this working for machine.config and app.config, I thought I might benefit from the built-in functionality of the framework. In addition, I do not know how to manually trigger such merging, if I am indeed supposed to resort to a config manager implementation of my own.So, is it possible to leverage the built-in mechanisms of configuration section/element merging with custom configuration files? I am especially interested in developing and supporting this for custom configuration sections. The System.Configuration namespace contains base objects to build configuration section and elements, and those allow some settings related to the merging (like setting the appropriate ConfigurationElementCollectionType for example). Are these related to only merging with machine.config (or multiple layers of web.config files in a web application), or is it possible to manually trigger the merging of pre-loaded config files? I am trying to avoid having to support custom merging in any of my custom configuration objects and probably forget about supporting the existing settings from the System.Configuration...UpdateThere is an important clarification to I'd like to make, in response to the existing answers and comments. I am capable of loading the ConfigurationSection objects from the current application setup (app.config / web.config) and from a physical file that is my custom.config. I need to know if there is a chance to merge these objects without resorting to reflection and property-by-property comparison, by some built-in means in the framework.Note: I would appreciate better a solution that would work on .NET 3.0+. Please add a note if your answer targets a higher version of the framework. <code> ",Merging custom configuration sections at runtime in .NET
C# async/await and higher-order functions," There are lots of guidelines for when to use ConfigureAwait(false), when using await/async in C#.It seems the general recommendation is to use ConfigureAwait(false) in library code, as it rarely depends on the synchronization context.However, assume we are writing some very generic utility code, which takes a function as input. A simple example could be the following (incomplete) functional combinators, to make simple task-based operations easier:Map: FlatMap: The question is, should we use ConfigureAwait(false) in this case? I am unsure how the context capture works wrt. closures.On one hand, if the combinators are used in a functional way, the synchronization context should not be necessary. On the other hand, people might misuse the API, and do context dependent stuff in the provided functions.One option would be to have separate methods for each scenario (Map and MapWithContextCapture or something), but it feels ugly.Another option might be to add the option to map/flatmap from and into a ConfiguredTaskAwaitable<T>, but as awaitables don't have to implement an interface this would result in a lot of redundant code, and in my opinion be even worse.Is there a good way to switch the responsibility to the caller, such that the implemented library doesn't need to make any assumptions on whether or not the context is needed in the provided mapping-functions? Or is it simply a fact, that async methods don't compose too well, without various assumptions?EDITJust to clarify a few things:The problem does exist. When you execute the ""callback"" inside the utility function, the addition of ConfigureAwait(false) will result in a null sync. context.The main question is how we should tackle the situation. Should we ignore the fact that someone might want to use the sync. context, or is there a good way to shift the responsibility out to the caller, apart from adding some overload, flag or the like?As a few answers mention, it would be possible to add a bool-flag to the method, but as I see it, this is not too pretty either, as it will have to be propagated all the way through the API's (as there are more ""utility"" functions, depending on the ones shown above). <code>  public static async Task<TResult> Map<T, TResult>(this Task<T> task, Func<T, TResult> mapping){ return mapping(await task);} public static async Task<TResult> FlatMap<T, TResult>(this Task<T> task, Func<T, Task<TResult>> mapping){ return await mapping(await task);}",Should we use ConfigureAwait(false) in libraries that call async callbacks?
C# Define base class by <T>," I am trying to find a way to derive a class from a generic base class. Say: In C# this does not seem to be possible.Is there any other solution to achieve something similar to this?I found this StackOverflow question, but it doesn't seem to solve the issue, or at least I do not understand how it should.EDIT:The result I'd like to get is to be able to do something like that: <code>  sealed public class Final : Base<Something>{}public class Base<T> : T where T : Anything // <-- Generics do not allow this{} Anything[] anything;//Assign some Instances to anything foreach(Final final in anything){ //do something with final}",C# Derive From Generic Base Class (T : U<T>)
.NET RegEx get group syntax from RegEx object," Let's say I have the following regex: Then I have the string: Here is my program: What I want to know is if there is any way to to get the regular expression part that matched? In this case: I can't find it anywhere in the object, but one would think it would be accessible. <code>  var r = new Regex(""Space(?<entry>[0-9]{1,3})""); ""Space123"" void Main(){ Regex r = new Regex(""Space(?<entry>[0-9]{1,3})"", RegexOptions.ExplicitCapture); foreach (Match m in r.Matches(""Space123"")){ m.Groups[""entry""].Dump(); //Dump() is linqpad to echo the object to console }} (?<entry>[0-9]{1,3})",Get named group subpattern from .NET regex object
Get group subpattern from .NET regex object," Let's say I have the following regex: Then I have the string: Here is my program: What I want to know is if there is any way to to get the regular expression part that matched? In this case: I can't find it anywhere in the object, but one would think it would be accessible. <code>  var r = new Regex(""Space(?<entry>[0-9]{1,3})""); ""Space123"" void Main(){ Regex r = new Regex(""Space(?<entry>[0-9]{1,3})"", RegexOptions.ExplicitCapture); foreach (Match m in r.Matches(""Space123"")){ m.Groups[""entry""].Dump(); //Dump() is linqpad to echo the object to console }} (?<entry>[0-9]{1,3})",Get named group subpattern from .NET regex object
How to see the elements of IEnumeralbe while dbbuging?," I am using an IEnumerable and in the debugger I would like to see the items that it has, but I can't because there is not any property neither items.Is it possible to see the items that has the IEnumerable? <code> ",How to see the elements of IEnumerable while debugging?
jQuery to call C# method," I have tried for hours to get this working, and I am really hoping one of you knows (a heck of a lot) more about this than I. When the client keys up in a textbox, I would like to call the MVC C# controller method called updateOrder(). Ideally, I would like to access form elements with a FormCollection (the form is called ""createOrder""). In the controller, I have:C# The string declaration above is breakpointed. In the view, I have a method I basically copy and pasted that I found on stackoverflow:JavaScript The event is simply:JavaScript The updateOrderJS() method fires (checked with an alert), but the breakpoint does not. <code>  [WebMethod]public static void updateOrder(){ string s = ""asdf"";} function updateOrderJS() { var $form = $('form[id=""createOrder""]'); $.ajax({type : ""POST"", url : $form.attr('action'), data : $form.serialize(), error : function(xhr, status, error) {}, success : function(response) { updateOrder(); } }); return false;} updateOrderJS();",jQuery to call Action Method in ASP.NET MVC C# by Ajax
List<dynamic> elements has fields but I cannot access them. Why?," I need to loop over a List<dynamic> objects.The list's objects all have values, but for some reason, I am not able to access any of the dynamic object fields. Below is a screenshot of my debug window:There you can see the object contains fields (such Alias, Id, Name, etc).I tried both casting it to a IDictionary<string, object> and ExpandoObject, to no avail. I did not face such a thing before: failing to access existing fields in a dynamic object when they exist.What is wrong here?The code is throwing a Microsoft.CSharp.RuntimeBinder.RuntimeBinderException with a message stating {""'object' does not contain a definition for 'Name'""}.The list was created adding anonymously-typed objects, like this: where fields is an ICollection<Field>, a strongly-typed collection. <code>  return new List<dynamic>(fields.Select(field => new { Id = field.Id, Alias = field.Alias, Name = field.Name, Type = field.Type, Value = field.Value, SortOrder = field.SortOrder }));",List<dynamic> elements have fields but I cannot access them. Why?
get information from a simple xml string," I have done the below many times using a xmlDocument approach, but I wanted to use the more powerful linq to xml approach.However, I seem to have run into a wall.I am getting data back from a restful API from twillio / crmText.Here is a link to their site where their docs live:http://crmtext.com/api/docsHere is my XML string: I need to find out the optinStatus. It should return 3.I am using the below, which return the above xml I have tried about 4000 different things, including: All of which returns no results.Please help, I know this is something simple I am missing.Thank you in advance -- Joe <code>  <response op=""getcustomerinfo"" status=""200"" message=""ok"" version=""1.0""> <customer> <totalMsg>3</totalMsg> <custId>9008281</custId> <custName></custName> <timestamp>2015-04-30 16:17:19</timestamp> <optinStatus>3</optinStatus> <custMobile>6185551212</custMobile> <subacct>1st Choice Courier</subacct> </customer></response> XDocument xdoc = XDocument.Parse(result1); IEnumerable<XElement> otinStatus = from el in xdoc.Elements(""customer"") select el; IEnumerable<XElement> otinStatus2 = from el in xdoc.Elements(""cusotmer.optinStatus"") select el; IEnumerable<XElement> otinStatus3 = from el in xdoc.Elements(""optinStatus"") select el;",Extract data from a XML string using linq vs xmlDocument
How do I reference method parameters in a method summary when writing xml documentation?," Suppose I have a method as follows: When I publish my XML documentation using Sandcastle, the cref: gets converted to [!:personId].The warning in Sandcastle is:Unknown reference link targetAny advice? <code>  /// <summary> /// Here I want to reference the parameter <see cref=""personId""/>. /// </summary> /// <param name=""personId""> /// The person id. /// </param> /// <returns> /// The <see cref=""Person""/>. /// </returns> public Person GetPerson(int personId) { } <see cref=""personId""/>",How do I reference method parameters in a method summary when writing XML documentation?
C# Check if a string contains a list of substrings and save the matching ones," This is my situation: I have a string representing a text And a list of words to search for in it I'd want to know the most efficient method, if exists, to get the list of the words contained in the text, something like that: <code>  string myText = ""Text to analyze for words, bar, foo""; List<string> words = new List<string> {""foo"", ""bar"", ""xyz""}; List<string> matches = myText.findWords(words)",Check if a string contains a list of substrings and save the matching ones
Webmethods with HttpContext.Current.User.Identity.IsAuthenticated stop working after inactivity," I'm testing the Azure server with pages that use Ajax(json)/Webmethod functions. Some of those functions check HttpContext.Current.User.Identity.IsAuthenticated before they run code. Unfortunately, if a user is logged in and the page doesn't make a full postback request to the server, only those webmethods functions that check HttpContext.Current.User.Identity.IsAuthenticated stop running completely after couple of minutes without giving any error. They don't even run the else code block (see below). I've tested those pages on a local server and everything worked fine as it should, even after a long period of inactivity. Here is an example of a webmethod I'm calling the webmethod as follows: This behavior occurs only if the user is logged in. Now if the user is not logged in then all functions work properly even on Azure. As a matter of fact, when the webmethods stop running and I refresh the page the user is still logged in and the webmethods start running again but for couple of minutes only and then the same behavior occurs again. What's going wrong? <code>  [WebMethod]public static string serviceMenu(int IDservice){ StringBuilder SBphotoMenu = new StringBuilder(); if (HttpContext.Current.User.Identity.IsAuthenticated) { // Do stuff } else { // Do other stuff } return SBphotoMenu.ToString();} function serviceMenu(IDservice) {$.ajax({ type: ""POST"", url: ""/UserControls/serviceMenu"", data: ""{ IDservice: "" + IDservice }"", contentType: ""application/json; charset=utf-8"", dataType: ""json"", success: function (data) { // Do Stuff }})}",Webmethods with HttpContext.Current.User.Identity.IsAuthenticated stop working after inactivity on Azure
tooltip computed links for asp button," As you can notice the tooltip text is static. In code behind, I do calculate and get some integers ( IDs ) every time the above button is clicked ( protected void showIds(object sender, CommandEventArgs e) { .... }) contained as a List<ExpressionListDictionary>. ( the asp:LinkButton is contained inside an asp:ListView )What I want to do, is to change the tooltip into a dynamic one, containing all the already obtained IDs as links. ( Something like this: http://jsfiddle.net/IrvinDominin/jLkcs/5/ - but in my case I do need firstly to click the button for calculating the IDs, and after this I would need to change the tooltip text from code as it needs to show the respective IDs, as links if it is possible)How can I achieve this? <code>  <ItemTemplate> <tr> <asp:LinkButton ID=""btnID"" runat=""server"" ToolTip='The calculated IDs are: ' OnCommand=""showIds"" CommandArgument='<%# Convert.ToInt32(Eval(""Year"")) + "","" + Convert.ToInt32(Eval(""Month"")) %>'> <%# Convert.ToInt32(Eval(""Count"")) - Convert.ToInt32(Eval(""LittleCount""))%> </asp:LinkButton> </tr> </ItemTemplate>",tooltip computed links for asp button after button is clicked
Cutomized DisplayFormatAttribute only setting once," I am setting NullDisplayText in the DisplayFormat from resource through the following code My default culture used is ""en-US"",Once I change the culture to es-AR and load the pages its working fine, but when I change the culture back to en-US fields are not getting converted back. I change the culture throught the following way I use DisplayFormat attribute in ViewModel as <code>  public class LocalizedDisplayFormatAttribute : DisplayFormatAttribute{ private readonly PropertyInfo _propertyInfo; public LocalizedDisplayFormatAttribute(string resourceKey, Type resourceType) : base() { this._propertyInfo = resourceType.GetProperty(resourceKey, BindingFlags.Static | BindingFlags.Public); if (this._propertyInfo == null) { return; } base.NullDisplayText = (string)this._propertyInfo.GetValue(this._propertyInfo.DeclaringType, null); } public new string NullDisplayText { get { return base.NullDisplayText; } set { base.NullDisplayText = value; } }} protected void Application_AcquireRequestState(object sender, EventArgs e) { try { HttpCookie cookie = HttpContext.Current.Request.Cookies.Get(""CurrentCulture""); string culutureCode = cookie != null && !string.IsNullOrEmpty(cookie.Value) ? cookie.Value : ""en""; CultureInfo ci = new CultureInfo(culutureCode); System.Threading.Thread.CurrentThread.CurrentUICulture = ci; System.Threading.Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture(ci.Name); } catch { } } public class AlarmCodeDetailsViewModel { /// <summary> /// Gets or sets the alarm code ID /// </summary> public int AlarmCodeID { get; set; } /// <summary> /// Gets or sets the alarm code /// </summary> [LocalizedDisplayName(""Label_AlarmCode"")] [LocalizedDisplayFormatAttribute(""Warning_NullDisplayText"", typeof(Properties.Resources), HtmlEncode = false)] public string Code { get; set; } /// <summary> /// Gets or sets the Description /// </summary> [LocalizedDisplayName(""Label_Description"")] [LocalizedDisplayFormatAttribute(""Warning_NullDisplayText"", typeof(Properties.Resources), HtmlEncode = false)] public string Description { get; set; } /// <summary> /// Gets or sets the Notes /// </summary> [LocalizedDisplayName(""Label_Notes"")] [LocalizedDisplayFormatAttribute(""Warning_NullDisplayText"", typeof(Properties.Resources), HtmlEncode = false)] public string Notes { get; set; } }",Customized DisplayFormatAttribute only setting once
get all documents from mongoDB collection," I need to retrieve all the documents that are in my collection in MongoDB, but I cannot figure out how. I have declared my 'collection' like this- And I followed what is explained in this MongoDB tutorial. I adjusted it for my needs, like- However, I keep having the following error- MongoDB.Driver.IMongoCollection does not have a definition for 'Find' and the best override of the extension method [superlong stuff]. Find contains non valid arguments. <code>  private static IMongoCollection<Project> SpeCollection = db.GetCollection<Project>(""collection_Project""); var documents = await SpeCollection.Find(new Project()).ToListAsync();",Get All 'documents' from MongoDB 'collection'
Unit Testing Dapper Inline Queries," I know there are several question similar to mine.Dapper: Unit Testing SQL QueriesTesting Dapper Queries butI don't think both of above question has clear answer that fit my requirement.Right now I develop a new WebAPI project and split between WebAPI project and DataAccess technology. I not have a problem test the Controller for WebAPI since I can mock the data access class.But for DataAccess class that's a different stories, since I'm using Dapper with inline queries in it, I'm a bit confuse how can I test it by using Unit Test. I've asked some of my friends and they prefer to do Integration test instead of Unit Test.What I want to know is, is it possible to unit test the DataAccess class that use Dapper and Inline queries in it.Let's say I have a class like this (this is a generic repository class, since a lot of the codes have similar queries differentiate by table name and field) And the implementation for above code is like <code>  public abstract class Repository<T> : SyncTwoWayXI, IRepository<T> where T : IDatabaseTable{ public virtual IResult<T> GetItem(String accountName, long id) { if (id <= 0) return null; SqlBuilder builder = new SqlBuilder(); var query = builder.AddTemplate(""SELECT /**select**/ /**from**/ /**where**/""); builder.Select(string.Join("","", typeof(T).GetProperties().Where(p => p.CustomAttributes.All(a => a.AttributeType != typeof(SqlMapperExtensions.DapperIgnore))).Select(p => p.Name))); builder.From(typeof(T).Name); builder.Where(""id = @id"", new { id }); builder.Where(""accountID = @accountID"", new { accountID = accountName }); builder.Where(""state != 'DELETED'""); var result = new Result<T>(); var queryResult = sqlConn.Query<T>(query.RawSql, query.Parameters); if (queryResult == null || !queryResult.Any()) { result.Message = ""No Data Found""; return result; } result = new Result<T>(queryResult.ElementAt(0)); return result; } // Code for Create, Update and Delete } public class ProductIndex: IDatabaseTable{ [SqlMapperExtensions.DapperKey] public Int64 id { get; set; } public string accountID { get; set; } public string userID { get; set; } public string deviceID { get; set; } public string deviceName { get; set; } public Int64 transactionID { get; set; } public string state { get; set; } public DateTime lastUpdated { get; set; } public string code { get; set; } public string description { get; set; } public float rate { get; set; } public string taxable { get; set; } public float cost { get; set; } public string category { get; set; } public int? type { get; set; }}public class ProductsRepository : Repository<ProductIndex>{ // ..override Create, Update, Delete method}",Unit Testing Dapper with Inline Queries
"If JavaScript's Number and C#'s double are specified the same (IEEE 754), why are numbers with many significant digits handled differently?"," If JavaScript's Number and C#'s double are specified the same (IEEE 754), why are numbers with many significant digits handled differently? I am not concerned with the fact that IEEE 754 cannot represent the number 1234123412341234123. I am concerned with the fact that the two implementations do not act the same for numbers that cannot be represented with full precision. This may be because IEEE 754 is under specified, one or both implementations are faulty or that they implement different variants of IEEE 754. This problem is not related to problems with floating point output formatting in C#. I'm outputting 64-bit integers. Consider the following: long x = 1234123412341234123; Console.WriteLine(x); // Prints 1234123412341234123 double y = 1234123412341234123; x = Convert.ToInt64(y); Console.WriteLine(x); // Prints 1234123412341234176The same variable prints different strings because the values are different. <code>  var x = (long)1234123412341234123.0; // 1234123412341234176 - C#var x = 1234123412341234123.0; // 1234123412341234200 - JavaScript",Why are numbers with many significant digits handled differently in C# and JavaScript?
"Can't use an ""inline"" array in c#?"," Imagine you have this somewhere or even just this Then, of course you can do this... ... which is great. BUT. It would appear you can NOT do this: or indeed perhaps this or anything else I tried.In fact (1) why can one not do that? and (2) am I missing something, how would you do that if there is a way? <code>  public static T AnyOne<T>(this T[] ra) where T:class { int k = ra.Length; int r = Random.Range(0,k); return ra[r]; } public static string OneOf(this string[] strings) { return ""a""; } string[] st = {""a"",""b"",""c""};string letter = st.AnyOne(); string letter = {""a"",""b"",""c""}.AnyOne(); string letter = ( {""a"",""b"",""c""} ).AnyOne();","Can't use an ""inline"" array in C#?"
How regular expression OR operator is evaluated?," In T-SQL I have generated UNIQUEIDENTIFIER using NEWID() function. For example: Then, all dashes (-) are removed and it looks like this: Now, I need to turn the string above to a valid UNIQUEIDENTIFIER using the following format xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx and setting the dashes again.To achieve this, I am using SQL CLR implementation of the C# RegexMatches function with this ^.{8}|.{12}$|.{4} regular expression which gives me this: Using the above, I can easily build again a correct UNIQUEIDENTIFIER but I am wondering how the OR operator is evaluated in the regular expression. For example, the following will not work: Is it sure that the first regular expression will first match the start and the end of the string, then the other values and is always returning the matches in this order (I will have issues if for example, 96C6 is matched after 421F). <code>  723952A7-96C6-421F-961F-80E66A4F29D2 723952A796C6421F961F80E66A4F29D2 SELECT *FROM [dbo].[RegexMatches] ('723952A796C6421F961F80E66A4F29D2', '^.{8}|.{12}$|.{4}') SELECT *FROM [dbo].[RegexMatches] ('723952A796C6421F961F80E66A4F29D2', '^.{8}|.{4}|.{12}$')",How regular expression OR operator is evaluated
How to change IHttpHandler and ApiControllers priority," I have a legacy project that has a single IHttpHandler implementing class that routes all the requests using a huge switch statement etc.. I am trying to introduce Attribute Routing with ApiControllers but the first one always has the priority. Is it possible to configure the system (either code or IIS) so that Web ApiControllers have priority over my single IHttpHandler implementing class? In IIS, I put my AttributeRouting first and then there are all the aspx ones but still the Web Api Controller is not getting processed first..no matter what I do (having them under the same project). I don't want to introduce a separate project.Edit: There is a IHttpModule that decides based on what is after api/ to route it to specific ashx file. One of them is the one described..Edit 2: More specifically: If the uri doesn't have a list of filtered things [file,message,property ...] it is routed to Resource.aspxso api/file, api/message, api/property would be handle from other .ashx files - otherwise the traffic goes to Resource.ashx...As a result the requests that have api/endpoint1, api/endpoint2, api/endpoint3 will all go to Resource.aspx. The question is how to route api/endpoint3 to the API Controller described below.ThanksSimplified Code Architecture:  <code>  //SolutionName/Api/MyModule.cs (Legacy Code) //this routes based on what is after api/ to Resource.ashx or other ashx files public class MyModule : IHttpModule { //if url doesn't contain [file,message,property ...] route to Resource.ashx } //SolutionName/API/Resource.ashx (Legacy Code)//this is hit at any request solutionname/api/anythingpublic class DefaultHandler : IHttpHandler { public void ProcessRequest(HttpContext context) { String APIBranch = parse(context); switch(APIBranch) { case ""endpoint1"": methodOne(); break; case ""endpoint2"": methodTwo(); break; [...] default: throw Exception(); break; } }} //SolutionName/API/App_Start/AttributeRoutingHttpConfig.cspublic static class AttributeRoutingHttpConfig{ public static void RegisterRoutes(HttpRouteCollection routes) { // See http://github.com/mccalltd/AttributeRouting/wiki for more options. // To debug routes locally using the built in ASP.NET development server, go to /routes.axd routes.MapHttpAttributeRoutes(); } public static void Start() { RegisterRoutes(GlobalConfiguration.Configuration.Routes); }} //SolutionName/API/Controllers/MyController.cs//this should have been hit for a GET on solutionname/api/endpoint3/id[RoutePrefix(""endpoint3"")]public class MyController : ApiController{ private IModelDao modelDao; MyController(IModelDao modelDao){ this.modelDao = modelDao; } [Route(""{id}"")] [HttpGet] public Model GetSomething(int id) { Model model = modelDao.GetSomething(id); return model; }}",How to prioritize Web Api Controllers over IHttpHandler?
How to prioritize ApiControllers over IHttpHandler?," I have a legacy project that has a single IHttpHandler implementing class that routes all the requests using a huge switch statement etc.. I am trying to introduce Attribute Routing with ApiControllers but the first one always has the priority. Is it possible to configure the system (either code or IIS) so that Web ApiControllers have priority over my single IHttpHandler implementing class? In IIS, I put my AttributeRouting first and then there are all the aspx ones but still the Web Api Controller is not getting processed first..no matter what I do (having them under the same project). I don't want to introduce a separate project.Edit: There is a IHttpModule that decides based on what is after api/ to route it to specific ashx file. One of them is the one described..Edit 2: More specifically: If the uri doesn't have a list of filtered things [file,message,property ...] it is routed to Resource.aspxso api/file, api/message, api/property would be handle from other .ashx files - otherwise the traffic goes to Resource.ashx...As a result the requests that have api/endpoint1, api/endpoint2, api/endpoint3 will all go to Resource.aspx. The question is how to route api/endpoint3 to the API Controller described below.ThanksSimplified Code Architecture:  <code>  //SolutionName/Api/MyModule.cs (Legacy Code) //this routes based on what is after api/ to Resource.ashx or other ashx files public class MyModule : IHttpModule { //if url doesn't contain [file,message,property ...] route to Resource.ashx } //SolutionName/API/Resource.ashx (Legacy Code)//this is hit at any request solutionname/api/anythingpublic class DefaultHandler : IHttpHandler { public void ProcessRequest(HttpContext context) { String APIBranch = parse(context); switch(APIBranch) { case ""endpoint1"": methodOne(); break; case ""endpoint2"": methodTwo(); break; [...] default: throw Exception(); break; } }} //SolutionName/API/App_Start/AttributeRoutingHttpConfig.cspublic static class AttributeRoutingHttpConfig{ public static void RegisterRoutes(HttpRouteCollection routes) { // See http://github.com/mccalltd/AttributeRouting/wiki for more options. // To debug routes locally using the built in ASP.NET development server, go to /routes.axd routes.MapHttpAttributeRoutes(); } public static void Start() { RegisterRoutes(GlobalConfiguration.Configuration.Routes); }} //SolutionName/API/Controllers/MyController.cs//this should have been hit for a GET on solutionname/api/endpoint3/id[RoutePrefix(""endpoint3"")]public class MyController : ApiController{ private IModelDao modelDao; MyController(IModelDao modelDao){ this.modelDao = modelDao; } [Route(""{id}"")] [HttpGet] public Model GetSomething(int id) { Model model = modelDao.GetSomething(id); return model; }}",How to prioritize Web Api Controllers over IHttpHandler?
MemberdataTests get executed together," When you use [Theory] together with [InlineData] it will create a test for each item of inline data that is provided. However, if you use [MemberData] it will just show up as one test.Is there a way to make [MemberData] tests show up as multiple tests? <code> ",MemberData tests show up as one test instead of many
xunit Memberdata tests get grouped together; any way to separate them?," When you use [Theory] together with [InlineData] it will create a test for each item of inline data that is provided. However, if you use [MemberData] it will just show up as one test.Is there a way to make [MemberData] tests show up as multiple tests? <code> ",MemberData tests show up as one test instead of many
xUnit MemberData tests show up as one test instead of many," When you use [Theory] together with [InlineData] it will create a test for each item of inline data that is provided. However, if you use [MemberData] it will just show up as one test.Is there a way to make [MemberData] tests show up as multiple tests? <code> ",MemberData tests show up as one test instead of many
C# Generate SignatureValue," I digitally sign XML files, but need the signature tags contain the namespace prefix ""ds"". I researched quite the google and found many of the same questions, but no satisfactory answer.I tried to put the ""ds"" manually in the file, but the signature becomes invalid. The tag ""SignatureValue"" signs the tag ""SignedInfo"" so the signature becomes invalid.Could somebody show me how I generate the value of the tag ""SignatureValue"" so I can replace the signature after adding the prefix ""ds""? <code> ","Generate Digital Signature but with a Specific Namespace Prefix (""ds:"")"
ModelState not validating nested models," I have nested ViewModels like these two: If I put month = 13; and then call ModelState.IsValid (in the controller) the validation is always true.Edit:This is the Controller: I'm making an abstraction of the problem, those aren't the real variables. <code>  public class FirstViewModel{ public SecondViewModel SecondViewModel { get; set; }}public class SecondViewModel{ [Range(1, 12)] public int month { get; set; }} public ActionResult Create(){ return PartialView(new FirstViewModel); }public HttpStatusCodeResult Create (FirstViewModel viewModel){ viewModel.SecondViewModel = new SecondViewModel(); viewModel.SecondViewModel.month = 13; if (ModelState.IsValid) { return new HttpStatusCodeResult(200); } else { return new HttpStatusCodeResult(304); }}",ModelState not validating nested models after editing in controller
How can character's body be continously rotated when its head is already turned by 60`?," After some experimenting I parented an empty (HeadCam) to the character's neck.This snippet allow rotation of the head synchronously to the CardboardHead/Camera. The character's arms shouldn't move when only the head rotates as long in the range -60 to 60 after that I would like to move the whole character with the arms still visible. The following method works as long the character isn't rotated by more than 180 after that the characters flips by 180 how could I achieve constant rotation? A java applet for testing the algorithm standalone: https://github.com/3dbug/blender/blob/master/HeadCamRot.java <code>  void LateUpdate() { neckBone.transform.rotation = Camera.transform.rotation * Quaternion.Euler( 0,0,-90); Camera.transform.position = HeadCam.transform.position;} void LateUpdate() { Quaternion camRot = Camera.transform.rotation * Quaternion.Euler( 0,0,-90); neckBone.transform.rotation = camRot; float yrot = camRot.eulerAngles.y; float ydelta = 0; if ( yrot < 300f && yrot > 180 ) { ydelta = yrot - 300f; } if ( yrot > 60f && yrot < 180 ) { ydelta = yrot - 60; } playerObj.transform.rotation = Quaternion.Euler(0, ydelta, 0); Camera.transform.position = HeadCam.transform.position;}",How can character's body be continuously rotated when its head is already turned by 60`?
Error: this template attempted to load component assembly 'Microsoft.VisualStudio.SmartDevice'," I installed Visual studio 2015 and I'm trying to create a test application for Windows Phone 8.1. When I create a new project, I get this message:Any suggestions on how to solve this problem? <code> ",Error: This template attempted to load component assembly 'Microsoft.VisualStudio.SmartDevice'
Why `Int32` uses `int` in it's source code?," Why does Int32 use int in its source code? Doesn't Int32 equal int in C#? So what is the original source code for int? I'm confused.. there is the same issue between Boolean and bool too.  <code>  [Serializable][System.Runtime.InteropServices.StructLayout(LayoutKind.Sequential)] [System.Runtime.InteropServices.ComVisible(true)]#if GENERICS_WORK public struct Int32 : IComparable, IFormattable, IConvertible , IComparable<Int32>, IEquatable<Int32>/// , IArithmetic<Int32>#else public struct Int32 : IComparable, IFormattable, IConvertible#endif { internal int m_value; // Here???? public const int MaxValue = 0x7fffffff; public const int MinValue = unchecked((int)0x80000000); ... }",Why does `Int32` use `int` in its source code?
cancel task.delay without exception or use exeption to controll flow?," I'm unsure about two possibilities to react to an event in my code. Mostly I'm concerned about which one needs less resources.I have a method with an observer registered to an eventproducer. If the eventproducer returns something, the method exits and the caller of the method starts the method again (you can think of it as a kind of a long polling).The eventproducer sometimes fires lots of events per seconds and sometimes rests for minutes. The first approach was to await a delay of 500ms and then check if there is something to return or otherwise (until a timeout of 5 minutes) again delay for 500ms. The second approach was to use a CancellationToken. If the eventproducer produces something, the CancellationTokenSource cancels the source. And in the method I wait for Task.Delay(5min, cancellationToken). The advantages of the second approach are that the method immediately returns if the producer produces something and that we don't have to await and awake in a loop.But with the second approach every time the producer produces something, a TaskCanceledException is thrown. I'm concerned that this could affect system load more than the awake and await every 500ms especially i times when the eventproducer produces lots of events. Am I overestimating the cost of throwing and catching an exception? And is there a way to cancel Task.Delay with a CancellationToken but without throwing a TaskCanceledException? I.E. something like task.setComplete? <code>  eventProducer.RegisterListener((events)=>{evList.Add(events)});while(evList.Count=0 && !TimeOut){ await Task.Delay(500);}eventProducer.UnRegister(...);// return evList, method gets recalled immediately eventProducer.RegisterListener((events)=>{evList.Add(events); cancelSource.Cancel();}try{ await Task.Delay(5min, cancellationToken)}catch(TaskCanceledException){//nothing to do};eventProducer.UnRegister(...);// return evList, method gets recalled immediately",Cancel task.delay without exception or use exception to control flow?
Cancel task.delay without exception or use exception to controll flow?," I'm unsure about two possibilities to react to an event in my code. Mostly I'm concerned about which one needs less resources.I have a method with an observer registered to an eventproducer. If the eventproducer returns something, the method exits and the caller of the method starts the method again (you can think of it as a kind of a long polling).The eventproducer sometimes fires lots of events per seconds and sometimes rests for minutes. The first approach was to await a delay of 500ms and then check if there is something to return or otherwise (until a timeout of 5 minutes) again delay for 500ms. The second approach was to use a CancellationToken. If the eventproducer produces something, the CancellationTokenSource cancels the source. And in the method I wait for Task.Delay(5min, cancellationToken). The advantages of the second approach are that the method immediately returns if the producer produces something and that we don't have to await and awake in a loop.But with the second approach every time the producer produces something, a TaskCanceledException is thrown. I'm concerned that this could affect system load more than the awake and await every 500ms especially i times when the eventproducer produces lots of events. Am I overestimating the cost of throwing and catching an exception? And is there a way to cancel Task.Delay with a CancellationToken but without throwing a TaskCanceledException? I.E. something like task.setComplete? <code>  eventProducer.RegisterListener((events)=>{evList.Add(events)});while(evList.Count=0 && !TimeOut){ await Task.Delay(500);}eventProducer.UnRegister(...);// return evList, method gets recalled immediately eventProducer.RegisterListener((events)=>{evList.Add(events); cancelSource.Cancel();}try{ await Task.Delay(5min, cancellationToken)}catch(TaskCanceledException){//nothing to do};eventProducer.UnRegister(...);// return evList, method gets recalled immediately",Cancel task.delay without exception or use exception to control flow?
How to add a space between the rows on Custom Cell?," In this question on Xamarin Forums,Craig Dunn teaches how to create a cell with frame.I want to Add a space between each cell.At present the cells seems glued, and the ViewCell doesn`t have a space property.How can I add a separator space between rows on custom Xamarin.Forms ViewCell? <code> ",How to add a separator space between rows on custom Xamarin.Forms ViewCell?
Why doesn't == implementation call Equals?," I've seen in the souce code of the GUID type in the .NET Framework that the implementation of Equals and the == operator execute very similar code. Why doesn't the == operator call the Equals method on the firts argument? Something like this: <code>  public static bool operator ==(Guid a, Guid b){ return a.Equals(b); }",Why doesn't == implementation call Equals for Guid?
"MVC Comilation Error, using WebApplication1 in Temporary ASP.NET Files"," I got this wierd error today and I can't solve it, obviously.I've created an entire ASP.NET API, which works just fine, no trouble. Now I want to add some MVC pages to the application. ASP.NET API automatically gives you one controller, (home controller) with the default asp.net page.Now when I try to open this page, I browse to http://localhost:26264/home.First I got the error with System.Web.MVC reference:Could not load file or assembly 'System.Web.Mvc, Version=5.2.2.0... I solved this by going to nuget manager and update MVC, which updated it to version 5.2.3.0 as stated in my web.config file (below).Now I get another error when browsing to the same address.I get a compilation error:Description: An error occurred during the compilation of a resource required to service this request. Please review the following specific error details and modify your source code appropriately. Source File: c:\Users\%USERNAME%\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\App_Web_index.cshtml.a8d08dba.t8kfgnmp.0.cs Line: 28 My application name is not WebApplication1 to begin with. Re-building didn't work, deleting the temp folder didn't work. deleting the debug, release and bin folder didn't work.I can't find it anywhere in my references of my project or in my web.config file.Deleting any projects that were not used anymore from the solution.Running it on my laptop, where I never compiled the project, gives the same error.Other, newly created, mvc application do work.I went through every .cs file and nowhere I've made this using. Like I said, the rest runs fine, but I can't open any MVC page, even when creating a empty one.Only thing I can think of is that it should be something with versions, like I got at first with MVC. Because I've downloaded a template for this API from a website (for correct external login behavior in an API). So the project dates from 13-07-2014.My Web.Config file: Show Detailed Compiler Output: The source file is a bit long but if it helps: <code>  Compiler Error Message: CS0246: The type or namespace name 'WebApplication1' could not be found (are you missing a using directive or an assembly reference?)Source Error:Line 26: using System.Web.Optimization;Line 27: using System.Web.Routing;Line 28: using WebApplication1;Line 29: Line 30: <configuration> <configSections> <!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 --> <section name=""entityFramework"" type=""System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" requirePermission=""false""/> </configSections> <connectionStrings> <add name=""AuthContext"" connectionString=""some database"" providerName=""System.Data.SqlClient""/> </connectionStrings> <appSettings> <add key=""webpages:Version"" value=""3.0.0.0""/> <add key=""webpages:Enabled"" value=""false""/> <add key=""ClientValidationEnabled"" value=""true""/> <add key=""UnobtrusiveJavaScriptEnabled"" value=""true""/> </appSettings> <system.web> <compilation debug=""true"" targetFramework=""4.5""/> <httpRuntime targetFramework=""4.5""/> <machineKey validationKey=""confidential I guess"" decryptionKey=""confidential I guess"" validation=""SHA1"" decryption=""AES""/> </system.web> <system.webServer> <handlers> <remove name=""ExtensionlessUrlHandler-Integrated-4.0""/> <remove name=""OPTIONSVerbHandler""/> <remove name=""TRACEVerbHandler""/> <add name=""ExtensionlessUrlHandler-Integrated-4.0"" path=""*."" verb=""*"" type=""System.Web.Handlers.TransferRequestHandler"" preCondition=""integratedMode,runtimeVersionv4.0""/> </handlers> </system.webServer> <runtime> <assemblyBinding xmlns=""urn:schemas-microsoft-com:asm.v1""> <dependentAssembly> <assemblyIdentity name=""System.Web.Http"" publicKeyToken=""31bf3856ad364e35"" culture=""neutral""/> <bindingRedirect oldVersion=""0.0.0.0-5.1.0.0"" newVersion=""5.1.0.0""/> </dependentAssembly> <dependentAssembly> <assemblyIdentity name=""System.Net.Http.Formatting"" publicKeyToken=""31bf3856ad364e35"" culture=""neutral""/> <bindingRedirect oldVersion=""0.0.0.0-5.1.0.0"" newVersion=""5.1.0.0""/> </dependentAssembly> <dependentAssembly> <assemblyIdentity name=""Microsoft.Owin"" publicKeyToken=""31bf3856ad364e35"" culture=""neutral""/> <bindingRedirect oldVersion=""0.0.0.0-3.0.1.0"" newVersion=""3.0.1.0""/> </dependentAssembly> <dependentAssembly> <assemblyIdentity name=""Newtonsoft.Json"" publicKeyToken=""30ad4fe6b2a6aeed"" culture=""neutral""/> <bindingRedirect oldVersion=""0.0.0.0-6.0.0.0"" newVersion=""6.0.0.0""/> </dependentAssembly> <dependentAssembly> <assemblyIdentity name=""Microsoft.Owin.Security"" publicKeyToken=""31bf3856ad364e35"" culture=""neutral""/> <bindingRedirect oldVersion=""0.0.0.0-3.0.1.0"" newVersion=""3.0.1.0""/> </dependentAssembly> <dependentAssembly> <assemblyIdentity name=""WebGrease"" publicKeyToken=""31bf3856sad364e35"" culture=""neutral""/> <bindingRedirect oldVersion=""0.0.0.0-1.5.2.14234"" newVersion=""1.5.2.14234""/> </dependentAssembly> <dependentAssembly> <assemblyIdentity name=""System.Web.Helpers"" publicKeyToken=""31bf3856ad364e35""/> <bindingRedirect oldVersion=""1.0.0.0-3.0.0.0"" newVersion=""3.0.0.0""/> </dependentAssembly> <dependentAssembly> <assemblyIdentity name=""System.Web.WebPages"" publicKeyToken=""31bf3856ad364e35""/> <bindingRedirect oldVersion=""1.0.0.0-3.0.0.0"" newVersion=""3.0.0.0""/> </dependentAssembly> <dependentAssembly> <assemblyIdentity name=""System.Web.Mvc"" publicKeyToken=""31bf3856ad364e35""/> <bindingRedirect oldVersion=""1.0.0.0-5.2.3.0"" newVersion=""5.2.3.0""/> </dependentAssembly> </assemblyBinding> </runtime> <entityFramework> <defaultConnectionFactory type=""System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework""/> <providers> <provider invariantName=""System.Data.SqlClient"" type=""System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer""/> </providers> </entityFramework></configuration> C:\Program Files (x86)\IIS Express> ""C:\Windows\Microsoft.NET\Framework\v4.0.30319\csc.exe"" /t:library /utf8output /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.ComponentModel.DataAnnotations\v4.0_4.0.0.0__31bf3856ad364e35\System.ComponentModel.DataAnnotations.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\Microsoft.CSharp\v4.0_4.0.0.0__b03f5f7f11d50a3a\Microsoft.CSharp.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.IdentityModel\v4.0_4.0.0.0__b77a5c561934e089\System.IdentityModel.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Activities\v4.0_4.0.0.0__31bf3856ad364e35\System.Activities.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Xml\v4.0_4.0.0.0__b77a5c561934e089\System.Xml.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Xml.Linq\v4.0_4.0.0.0__b77a5c561934e089\System.Xml.Linq.dll"" /R:""C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorlib.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.WorkflowServices\v4.0_4.0.0.0__31bf3856ad364e35\System.WorkflowServices.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Data.DataSetExtensions\v4.0_4.0.0.0__b77a5c561934e089\System.Data.DataSetExtensions.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Core\v4.0_4.0.0.0__b77a5c561934e089\System.Core.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\33a25be8\00298484_2fe1cf01\EntityFramework.SqlServer.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\e4e456f0\80a7fc09_c7a6d001\System.Web.WebPages.Deployment.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\Microsoft.VisualStudio.Web.PageInspector.Loader\v4.0_1.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.Web.PageInspector.Loader.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\5e13637a\0064da67_6c98d001\WebGrease.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\556b9ea4\80bf1a60_6c98d001\System.Web.Optimization.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\b004c4ba\00298484_2fe1cf01\Microsoft.AspNet.Identity.Core.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Web.Services\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Web.Services.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.ServiceModel\v4.0_4.0.0.0__b77a5c561934e089\System.ServiceModel.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\d053c54a\00298484_2fe1cf01\Microsoft.AspNet.Identity.EntityFramework.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Web.DynamicData\v4.0_4.0.0.0__31bf3856ad364e35\System.Web.DynamicData.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\c00cea1f\00298484_2fe1cf01\EntityFramework.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\8a259b50\80a7fc09_c7a6d001\System.Web.Helpers.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\Microsoft.Web.Infrastructure\v4.0_1.0.0.0__31bf3856ad364e35\Microsoft.Web.Infrastructure.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\697894d0\80a7fc09_c7a6d001\System.Web.WebPages.Razor.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Web.ApplicationServices\v4.0_4.0.0.0__31bf3856ad364e35\System.Web.ApplicationServices.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Drawing\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Drawing.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\5b891fac\00298484_2fe1cf01\Owin.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.ServiceModel.Activation\v4.0_4.0.0.0__31bf3856ad364e35\System.ServiceModel.Activation.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\20287057\00298484_2fe1cf01\Microsoft.Owin.Host.SystemWeb.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.ServiceModel.Activities\v4.0_4.0.0.0__31bf3856ad364e35\System.ServiceModel.Activities.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\9e3324b2\00298484_2fe1cf01\Microsoft.AspNet.Identity.Owin.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\f5e62a40\0037a966_6c98d001\Antlr3.Runtime.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\df949ad9\00298484_2fe1cf01\System.Web.Http.Owin.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.ServiceModel.Web\v4.0_4.0.0.0__31bf3856ad364e35\System.ServiceModel.Web.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\2de213fd\00298484_2fe1cf01\System.Web.Http.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\b76d5c10\00298484_2fe1cf01\System.Web.Cors.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\e4698f0d\00298484_2fe1cf01\Microsoft.Owin.Security.Cookies.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_32\System.EnterpriseServices\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.EnterpriseServices.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\42f17822\00db2a40_2c8ed001\Microsoft.Owin.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\492af3ed\80a7fc09_c7a6d001\System.Web.Mvc.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_32\System.Data\v4.0_4.0.0.0__b77a5c561934e089\System.Data.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Runtime.Serialization\v4.0_4.0.0.0__b77a5c561934e089\System.Runtime.Serialization.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Configuration\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Configuration.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\56706741\80a7fc09_c7a6d001\System.Web.WebPages.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Web.Extensions\v4.0_4.0.0.0__31bf3856ad364e35\System.Web.Extensions.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\d26ced0e\00db2a40_2c8ed001\Microsoft.Owin.Security.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\6c6c0552\8071c340_2c8ed001\Microsoft.Owin.Security.Facebook.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Web.WebPages.Deployment\v4.0_2.0.0.0__31bf3856ad364e35\System.Web.WebPages.Deployment.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_32\System.Web\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Web.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\bbcc5165\80a7fc09_c7a6d001\System.Web.Razor.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\0be6b9ea\00298484_2fe1cf01\Microsoft.Owin.Security.OAuth.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\App_global.asax.wzkby3d1.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\18153ac5\00298484_2fe1cf01\System.Net.Http.Formatting.dll"" /R:""C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System\v4.0_4.0.0.0__b77a5c561934e089\System.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\96b61974\00298484_2fe1cf01\Microsoft.Owin.Cors.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\995618f0\00db2a40_2c8ed001\Newtonsoft.Json.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\1742251e\7fa56e65_d0a6d001\AngularJSAuthentication.API.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\06b74cb9\8052b946_2c8ed001\Microsoft.Owin.Security.Google.dll"" /R:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\assembly\dl3\c5202dd8\00298484_2fe1cf01\System.Web.Http.WebHost.dll"" /out:""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\App_Web_index.cshtml.6373d792.i9ntk24m.dll"" /D:DEBUG /debug+ /optimize- /w:4 /nowarn:1659;1699;1701;612;618 /warnaserror- ""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\App_Web_index.cshtml.6373d792.i9ntk24m.0.cs"" ""C:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\App_Web_index.cshtml.6373d792.i9ntk24m.1.cs""Microsoft (R) Visual C# Compiler version 4.0.30319.18408for Microsoft (R) .NET Framework 4.5Copyright (C) Microsoft Corporation. All rights reserved.c:\Users\Ruud\AppData\Local\Temp\Temporary ASP.NET Files\root\46ca8dc5\51ac0d57\App_Web_index.cshtml.6373d792.i9ntk24m.0.cs(28,11): error CS0246: The type or namespace name 'WebApplication1' could not be found (are you missing a using directive or an assembly reference?) #pragma checksum ""[pathToProject]\AngularJSAuthentication\AngularJSAuthentication.API\Views\home\Index.cshtml"" ""{ff1816ec-a....""//------------------------------------------------------------------------------// <auto-generated>// This code was generated by a tool.// Runtime Version:4.0.30319.18444//// Changes to this file may cause incorrect behavior and will be lost if// the code is regenerated.// </auto-generated>//------------------------------------------------------------------------------namespace ASP { using System; using System.Collections.Generic; using System.IO; using System.Linq; using System.Net; using System.Web; using System.Web.Helpers; using System.Web.Security; using System.Web.UI; using System.Web.WebPages; using System.Web.Mvc; using System.Web.Mvc.Ajax; using System.Web.Mvc.Html; using System.Web.Optimization; using System.Web.Routing; using WebApplication1; public class _Page_Views_home_Index_cshtml : System.Web.Mvc.WebViewPage<dynamic> {#line hidden public _Page_Views_home_Index_cshtml() { } protected ASP.global_asax ApplicationInstance { get { return ((ASP.global_asax)(Context.ApplicationInstance)); } } public override void Execute() {BeginContext(""~/Views/home/Index.cshtml"", 0, 4, true);WriteLiteral(""<div"");EndContext(""~/Views/home/Index.cshtml"", 0, 4, true);BeginContext(""~/Views/home/Index.cshtml"", 4, 18, true);WriteLiteral("" class=\""jumbotron\"""");EndContext(""~/Views/home/Index.cshtml"", 4, 18, true);BeginContext(""~/Views/home/Index.cshtml"", 22, 31, true);WriteLiteral("">\r\n <h1>ASP.NET</h1>\r\n <p"");EndContext(""~/Views/home/Index.cshtml"", 22, 31, true);BeginContext(""~/Views/home/Index.cshtml"", 53, 13, true);WriteLiteral("" class=\""lead\"""");EndContext(""~/Views/home/Index.cshtml"", 53, 13, true);BeginContext(""~/Views/home/Index.cshtml"", 66, 130, true);WriteLiteral("">ASP.NET is a free web framework for building great Web sites and Web application"" +""s using HTML, CSS, and JavaScript.</p>\r\n <p><a"");EndContext(""~/Views/home/Index.cshtml"", 66, 130, true);BeginContext(""~/Views/home/Index.cshtml"", 196, 22, true);WriteLiteral("" href=\""http://asp.net\"""");EndContext(""~/Views/home/Index.cshtml"", 196, 22, true);BeginContext(""~/Views/home/Index.cshtml"", 218, 31, true);WriteLiteral("" class=\""btn btn-primary btn-lg\"""");EndContext(""~/Views/home/Index.cshtml"", 218, 31, true);BeginContext(""~/Views/home/Index.cshtml"", 249, 41, true);WriteLiteral("">Learn more &raquo;</a></p>\r\n</div>\r\n<div"");EndContext(""~/Views/home/Index.cshtml"", 249, 41, true);BeginContext(""~/Views/home/Index.cshtml"", 290, 12, true);WriteLiteral("" class=\""row\"""");EndContext(""~/Views/home/Index.cshtml"", 290, 12, true);BeginContext(""~/Views/home/Index.cshtml"", 302, 11, true);WriteLiteral("">\r\n <div"");EndContext(""~/Views/home/Index.cshtml"", 302, 11, true);BeginContext(""~/Views/home/Index.cshtml"", 313, 17, true);WriteLiteral("" class=\""col-md-4\"""");EndContext(""~/Views/home/Index.cshtml"", 313, 17, true);BeginContext(""~/Views/home/Index.cshtml"", 330, 359, true);WriteLiteral(@""> <h2>Getting started</h2> <p> ASP.NET Web API is a framework that makes it easy to build HTTP services that reach a broad range of clients, including browsers and mobile devices. ASP.NET Web API is an ideal platform for building RESTful applications on the .NET Framework. </p> <p><a"");EndContext(""~/Views/home/Index.cshtml"", 330, 359, true);BeginContext(""~/Views/home/Index.cshtml"", 689, 24, true);WriteLiteral("" class=\""btn btn-default\"""");EndContext(""~/Views/home/Index.cshtml"", 689, 24, true);BeginContext(""~/Views/home/Index.cshtml"", 713, 53, true);WriteLiteral("" href=\""http://go.microsoft.com/fwlink/?LinkId=301870\"""");EndContext(""~/Views/home/Index.cshtml"", 713, 53, true);BeginContext(""~/Views/home/Index.cshtml"", 766, 49, true);WriteLiteral("">Learn more &raquo;</a></p>\r\n </div>\r\n <div"");EndContext(""~/Views/home/Index.cshtml"", 766, 49, true);BeginContext(""~/Views/home/Index.cshtml"", 815, 17, true);WriteLiteral("" class=\""col-md-4\"""");EndContext(""~/Views/home/Index.cshtml"", 815, 17, true);BeginContext(""~/Views/home/Index.cshtml"", 832, 202, true);WriteLiteral("">\r\n <h2>Get more libraries</h2>\r\n <p>NuGet is a free Visual Studio "" +""extension that makes it easy to add, remove, and update libraries and tools in V"" +""isual Studio projects.</p>\r\n <p><a"");EndContext(""~/Views/home/Index.cshtml"", 832, 202, true);BeginContext(""~/Views/home/Index.cshtml"", 1034, 24, true);WriteLiteral("" class=\""btn btn-default\"""");EndContext(""~/Views/home/Index.cshtml"", 1034, 24, true);BeginContext(""~/Views/home/Index.cshtml"", 1058, 53, true);WriteLiteral("" href=\""http://go.microsoft.com/fwlink/?LinkId=301871\"""");EndContext(""~/Views/home/Index.cshtml"", 1058, 53, true);BeginContext(""~/Views/home/Index.cshtml"", 1111, 49, true);WriteLiteral("">Learn more &raquo;</a></p>\r\n </div>\r\n <div"");EndContext(""~/Views/home/Index.cshtml"", 1111, 49, true);BeginContext(""~/Views/home/Index.cshtml"", 1160, 17, true);WriteLiteral("" class=\""col-md-4\"""");EndContext(""~/Views/home/Index.cshtml"", 1160, 17, true);BeginContext(""~/Views/home/Index.cshtml"", 1177, 175, true);WriteLiteral("">\r\n <h2>Web Hosting</h2>\r\n <p>You can easily find a web hosting com"" +""pany that offers the right mix of features and price for your applications.</p>\r"" +""\n <p><a"");EndContext(""~/Views/home/Index.cshtml"", 1177, 175, true);BeginContext(""~/Views/home/Index.cshtml"", 1352, 24, true);WriteLiteral("" class=\""btn btn-default\"""");EndContext(""~/Views/home/Index.cshtml"", 1352, 24, true);BeginContext(""~/Views/home/Index.cshtml"", 1376, 53, true);WriteLiteral("" href=\""http://go.microsoft.com/fwlink/?LinkId=301872\"""");EndContext(""~/Views/home/Index.cshtml"", 1376, 53, true);BeginContext(""~/Views/home/Index.cshtml"", 1429, 51, true);WriteLiteral("">Learn more &raquo;</a></p>\r\n </div>\r\n</div>\r\n\r\n"");EndContext(""~/Views/home/Index.cshtml"", 1429, 51, true); } }}","MVC Compilation Error, using WebApplication1 in Temporary ASP.NET Files"
Restrict/Apply Bearer Token Authentication to certain url routes using Identity Server?," I am trying to use both OpenId and Bearer token authentication on my application through Identity Server.The problem currently is that once I have authenticated the user, I still need to get a bearer token to be able to call any action methods for my Asp.Net MVC application.Here is my startup file for the application I would like to restrict bearer token authentication to my api urls only, and use openID auth for everthing else. Is there a way to do that? <code>  public class Startup{ public void Configuration(IAppBuilder app) { AntiForgeryConfig.UniqueClaimTypeIdentifier = Constants.ClaimTypes.Subject; JwtSecurityTokenHandler.InboundClaimTypeMap = new Dictionary<string, string>(); app.UseCookieAuthentication(new CookieAuthenticationOptions { AuthenticationType = ""Cookies"" }); app.UseOpenIdConnectAuthentication(new OpenIdConnectAuthenticationOptions { Authority = ""https://localhost:44301/identity"", ClientId = ""baseballStats"", Scope = ""openid profile roles baseballStatsApi"", RedirectUri = ""https://localhost:44300/"", ResponseType = ""id_token token"", SignInAsAuthenticationType = ""Cookies"", UseTokenLifetime = false, Notifications = new OpenIdConnectAuthenticationNotifications { SecurityTokenValidated = async n => { var userInfoClient = new UserInfoClient( new Uri(n.Options.Authority + ""/connect/userinfo""), n.ProtocolMessage.AccessToken); var userInfo = await userInfoClient.GetAsync(); // create new identity and set name and role claim type var nid = new ClaimsIdentity( n.AuthenticationTicket.Identity.AuthenticationType, Constants.ClaimTypes.GivenName, Constants.ClaimTypes.Role); userInfo.Claims.ToList().ForEach(c => nid.AddClaim(new Claim(c.Item1, c.Item2))); // keep the id_token for logout nid.AddClaim(new Claim(""id_token"", n.ProtocolMessage.IdToken)); // add access token for sample API nid.AddClaim(new Claim(""access_token"", n.ProtocolMessage.AccessToken)); // keep track of access token expiration nid.AddClaim(new Claim(""expires_at"", DateTimeOffset.Now.AddSeconds(int.Parse(n.ProtocolMessage.ExpiresIn)).ToString())); // add some other app specific claim nid.AddClaim(new Claim(""app_specific"", ""some data"")); n.AuthenticationTicket = new AuthenticationTicket( nid, n.AuthenticationTicket.Properties); } } }); app.UseResourceAuthorization(new AuthorizationManager()); app.UseIdentityServerBearerTokenAuthentication(new IdentityServerBearerTokenAuthenticationOptions { Authority = ""https://localhost:44301/identity"", RequiredScopes = new[] { ""baseballStatsApi"" } }); var config = new HttpConfiguration(); config.MapHttpAttributeRoutes(); app.UseWebApi(config); }}",Use Bearer Token Authentication for API and OpenId authentication for MVC on the same application project
"Use Bearer Token Authentication and OpenId connect on the same application project, but for different purposes"," I am trying to use both OpenId and Bearer token authentication on my application through Identity Server.The problem currently is that once I have authenticated the user, I still need to get a bearer token to be able to call any action methods for my Asp.Net MVC application.Here is my startup file for the application I would like to restrict bearer token authentication to my api urls only, and use openID auth for everthing else. Is there a way to do that? <code>  public class Startup{ public void Configuration(IAppBuilder app) { AntiForgeryConfig.UniqueClaimTypeIdentifier = Constants.ClaimTypes.Subject; JwtSecurityTokenHandler.InboundClaimTypeMap = new Dictionary<string, string>(); app.UseCookieAuthentication(new CookieAuthenticationOptions { AuthenticationType = ""Cookies"" }); app.UseOpenIdConnectAuthentication(new OpenIdConnectAuthenticationOptions { Authority = ""https://localhost:44301/identity"", ClientId = ""baseballStats"", Scope = ""openid profile roles baseballStatsApi"", RedirectUri = ""https://localhost:44300/"", ResponseType = ""id_token token"", SignInAsAuthenticationType = ""Cookies"", UseTokenLifetime = false, Notifications = new OpenIdConnectAuthenticationNotifications { SecurityTokenValidated = async n => { var userInfoClient = new UserInfoClient( new Uri(n.Options.Authority + ""/connect/userinfo""), n.ProtocolMessage.AccessToken); var userInfo = await userInfoClient.GetAsync(); // create new identity and set name and role claim type var nid = new ClaimsIdentity( n.AuthenticationTicket.Identity.AuthenticationType, Constants.ClaimTypes.GivenName, Constants.ClaimTypes.Role); userInfo.Claims.ToList().ForEach(c => nid.AddClaim(new Claim(c.Item1, c.Item2))); // keep the id_token for logout nid.AddClaim(new Claim(""id_token"", n.ProtocolMessage.IdToken)); // add access token for sample API nid.AddClaim(new Claim(""access_token"", n.ProtocolMessage.AccessToken)); // keep track of access token expiration nid.AddClaim(new Claim(""expires_at"", DateTimeOffset.Now.AddSeconds(int.Parse(n.ProtocolMessage.ExpiresIn)).ToString())); // add some other app specific claim nid.AddClaim(new Claim(""app_specific"", ""some data"")); n.AuthenticationTicket = new AuthenticationTicket( nid, n.AuthenticationTicket.Properties); } } }); app.UseResourceAuthorization(new AuthorizationManager()); app.UseIdentityServerBearerTokenAuthentication(new IdentityServerBearerTokenAuthenticationOptions { Authority = ""https://localhost:44301/identity"", RequiredScopes = new[] { ""baseballStatsApi"" } }); var config = new HttpConfiguration(); config.MapHttpAttributeRoutes(); app.UseWebApi(config); }}",Use Bearer Token Authentication for API and OpenId authentication for MVC on the same application project
Do I need to create two identical extension methods for IEnumerable and IQueryable or?," Let's say I need an extension method which selects only required properties from different sources. The source could be the database or in-memory collection. So I have defined such extension method: This works fine for IQueryables. But, I have to call this function also for IEnumerables.And in that case, I can call it with the help of .AsQueryable(): Both work fine. And if both work fine, in which conditions I have to create two different extension methods for the same purpose, one for IEnumerable and another one for IQueryable?My method has to send query to the database in case of Queryable.For example, here is the source of .Select extension method inside System.Linq namespace:.Select for IEnumerable.Select for IQueryableI am repeating my main question again:My method must send query to the database in case of Queryable, but not when working with IEnumerable. And for now, I am using AsQueryable() for the enumerables. Because, I dont want to write same code for the Enumerable. Can it have some side effects?  <code>  public IQueryable<TResult> SelectDynamic<TResult>( this IQueryable<T> source, ...) myEnumerable.AsQueryable() .SelectDynamic(...) .ToList();",In which cases do I need to create two different extension methods for IEnumerable and IQueryable?
In which cases do I need to create two identical extension methods for IEnumerable and IQueryable or?," Let's say I need an extension method which selects only required properties from different sources. The source could be the database or in-memory collection. So I have defined such extension method: This works fine for IQueryables. But, I have to call this function also for IEnumerables.And in that case, I can call it with the help of .AsQueryable(): Both work fine. And if both work fine, in which conditions I have to create two different extension methods for the same purpose, one for IEnumerable and another one for IQueryable?My method has to send query to the database in case of Queryable.For example, here is the source of .Select extension method inside System.Linq namespace:.Select for IEnumerable.Select for IQueryableI am repeating my main question again:My method must send query to the database in case of Queryable, but not when working with IEnumerable. And for now, I am using AsQueryable() for the enumerables. Because, I dont want to write same code for the Enumerable. Can it have some side effects?  <code>  public IQueryable<TResult> SelectDynamic<TResult>( this IQueryable<T> source, ...) myEnumerable.AsQueryable() .SelectDynamic(...) .ToList();",In which cases do I need to create two different extension methods for IEnumerable and IQueryable?
In which cases do I need to create two identical extension methods for IEnumerable and IQueryable?," Let's say I need an extension method which selects only required properties from different sources. The source could be the database or in-memory collection. So I have defined such extension method: This works fine for IQueryables. But, I have to call this function also for IEnumerables.And in that case, I can call it with the help of .AsQueryable(): Both work fine. And if both work fine, in which conditions I have to create two different extension methods for the same purpose, one for IEnumerable and another one for IQueryable?My method has to send query to the database in case of Queryable.For example, here is the source of .Select extension method inside System.Linq namespace:.Select for IEnumerable.Select for IQueryableI am repeating my main question again:My method must send query to the database in case of Queryable, but not when working with IEnumerable. And for now, I am using AsQueryable() for the enumerables. Because, I dont want to write same code for the Enumerable. Can it have some side effects?  <code>  public IQueryable<TResult> SelectDynamic<TResult>( this IQueryable<T> source, ...) myEnumerable.AsQueryable() .SelectDynamic(...) .ToList();",In which cases do I need to create two different extension methods for IEnumerable and IQueryable?
Formatting large numbers in C#," I am using Unity to make an ""Incremental Game"" also known as an ""Idle Game"" and I am trying to format large numbers. For example, when gold gets to say 1000 or more, it will display as Gold: 1k instead of Gold: 1000. I have tried other examples while searching online, which is where gold.ToString (""#,#""); came from, however none of them worked.  <code>  using UnityEngine;using System.Collections;public class Click : MonoBehaviour { public UnityEngine.UI.Text GoldDisplay; public UnityEngine.UI.Text GPC; public double gold = 0.0; public int gpc = 1; void Update(){ GoldDisplay.text = ""Gold: "" + gold.ToString (""#,#""); //Following is attempt at changing 10,000,000 to 10.0M if (gold >= 10000000) { GoldDisplay.text = ""Gold: "" + gold.ToString (""#,#M""); } GPC.text = ""GPC: "" + gpc; } public void Clicked(){ gold += gpc; }}",Formatting large numbers in C#
Formatting large numbers in C# [Answered]," I am using Unity to make an ""Incremental Game"" also known as an ""Idle Game"" and I am trying to format large numbers. For example, when gold gets to say 1000 or more, it will display as Gold: 1k instead of Gold: 1000. I have tried other examples while searching online, which is where gold.ToString (""#,#""); came from, however none of them worked.  <code>  using UnityEngine;using System.Collections;public class Click : MonoBehaviour { public UnityEngine.UI.Text GoldDisplay; public UnityEngine.UI.Text GPC; public double gold = 0.0; public int gpc = 1; void Update(){ GoldDisplay.text = ""Gold: "" + gold.ToString (""#,#""); //Following is attempt at changing 10,000,000 to 10.0M if (gold >= 10000000) { GoldDisplay.text = ""Gold: "" + gold.ToString (""#,#M""); } GPC.text = ""GPC: "" + gpc; } public void Clicked(){ gold += gpc; }}",Formatting large numbers in C#
C# - Create a subset of an object based off an array of property names," I have a class and an array of property names defined as follows: I also have a method that returns a list of dog objects: Is there an way I can return a subset of dogs that only contain the properties defined within the desiredProperties array? Eventually, this resulting list will be serialized to JSON.I have been struggling with this problem for some time now, considering that the user will be allowed to specify any combination of properties (assuming they are all valid) as the output within the array. Some more examples: <code>  public class Dog { public string Name { get; set; } public string Breed { get; set; } public int Age { get; set; }}var desiredProperties = new [] {""Name"", ""Breed""}; List<Dog> dogs = GetAllDogs(); var desiredProperties = new [] {""Name"", ""Age""};// Sample output, when serialized to JSON:// [// { Name: ""Max"", Age: 5 },// { Name: ""Spot"", Age: 2 }// ]var desiredProperties = new [] {""Breed"", ""Age""};// [// { Breed: ""Scottish Terrier"", Age: 5 },// { Breed: ""Cairn Terrier"", Age: 2 }// ]",Create a subset of an object based off an array of property names
Setting the SQL connection string for ASP.NET 5 web app in Azure," I have created a new ASP.NET Core web application in Visual Studio 2015. I've also set up an Azure web app to pull in the app from GitHub and run it. This works fine, but I'm having trouble connecting to the database on Azure.Locally, this works, and it uses config.json and in code Data:DefaultConnection:ConnectionString for the connection string.How can I leave the code as it is, and have it work in Azure too? I've tried setting the Application Settings in the portal, both the Connection Strings and the App Settings. And using both ""SQLCONNSTR_DefaultConnection"" and ""Data:DefaultConnection:ConnectionString"" as the key. (Setting the App Settings doesn't seem to work by the way. I think the value I provide is too long).So how can I provide the connection string for my Azure database to my Azure web app (ASP.NET 5), without checking it in in source control?UpdateMy Startup.cs looks like this (see the full file on GitHub): In the ConfigureServices method, there is also: and, also in the ConfigureServices method: <code>  public Startup(IHostingEnvironment env){ var configuration = new Configuration() .AddJsonFile(""config.json"") .AddJsonFile($""config.{env.EnvironmentName}.json"", optional: true); if (env.IsEnvironment(""Development"")) { configuration.AddUserSecrets(); } configuration.AddEnvironmentVariables(); Configuration = configuration;} services.Configure<AppSettings>(Configuration.GetSubKey(""AppSettings"")); services.AddEntityFramework() .AddSqlServer() .AddDbContext<ApplicationDbContext>(options => options.UseSqlServer(Configuration[""Data:DefaultConnection:ConnectionString""])) .AddDbContext<InvoicesDbContext>(options => options.UseSqlServer(Configuration[""Data:DefaultConnection:ConnectionString""]));// So this is where I want my app in Azure to use the connection string I// provide in the portal",Setting the SQL connection string for ASP.NET Core web app in Azure
Performance - double await operations in a c# HttpClient POST," Using c# HttpClient to POST data, hypothetically I'm also concerned with the returned content. I'm optimizing my app and trying to understand the performance impact of two await calls in the same method. The question popped up from the following code snippet, Assume I have error handling in there :)I know await calls are expensive so the double await caught my attention.After the first await completes the POST response is in memory would it be more efficient to return the result directly, like var response = post.Content.ReadAsStringAsync().Result;What are the performance considerations when making two await/async calls in the same method?Will the above code result in a thread per await (2 threads), or 1 thread for the returned Task that will handle both await calls? <code>  public static async Task<string> AsyncRequest(string URL, string data = null){ using (var client = new HttpClient()) { var post = await client.PostAsync(URL, new StringContent(data, Encoding.UTF8, ""application/json"")).ConfigureAwait(false); post.EnsureSuccessStatusCode(); var response = await post.Content.ReadAsStringAsync(); return response; }}",Double await operations during POST
C# release build started without debugging behaves differently to when started with debugging," I'm new to C# and have run into a problem with the following code (I have the target framework as 4.5 and I've added a reference to System.Numerics): When the release build is started with debugging (F5 in Visual Studio - and a break-point at the end of program so I can see the output), I get the following output: However, when the release build is started without debugging (Ctrl-F5), I get the following: Strangely if I add a Console.ReadLine() at the end of the program it works as expected!Any ideas what is causing this? Thanks. <code>  using System;using System.Numerics;namespace Test{ class Program { static BigInteger Gcd(BigInteger x, BigInteger y) { Console.WriteLine(""GCD {0}, {1}"", x, y); if (x < y) return Gcd(y, x); if (x % y == 0) return y; return Gcd(y, x % y); } static void Main(string[] args) { BigInteger a = 13394673; BigInteger b = 53578691; Gcd(a, b); } }} GCD 13394673, 53578691GCD 53578691, 13394673GCD 13394673, 13394672GCD 13394672, 1 GCD 13394673, 53578691GCD 53578691, 53578691",C# 64 bit release build started without debugging behaves differently to when started with debugging (BigInteger)
Release build started without debugging behaves differently to when started with debugging," I'm new to C# and have run into a problem with the following code (I have the target framework as 4.5 and I've added a reference to System.Numerics): When the release build is started with debugging (F5 in Visual Studio - and a break-point at the end of program so I can see the output), I get the following output: However, when the release build is started without debugging (Ctrl-F5), I get the following: Strangely if I add a Console.ReadLine() at the end of the program it works as expected!Any ideas what is causing this? Thanks. <code>  using System;using System.Numerics;namespace Test{ class Program { static BigInteger Gcd(BigInteger x, BigInteger y) { Console.WriteLine(""GCD {0}, {1}"", x, y); if (x < y) return Gcd(y, x); if (x % y == 0) return y; return Gcd(y, x % y); } static void Main(string[] args) { BigInteger a = 13394673; BigInteger b = 53578691; Gcd(a, b); } }} GCD 13394673, 53578691GCD 53578691, 13394673GCD 13394673, 13394672GCD 13394672, 1 GCD 13394673, 53578691GCD 53578691, 53578691",C# 64 bit release build started without debugging behaves differently to when started with debugging (BigInteger)
Custom parsing C# string," When parsing FTX (free text) string, I need to split it using + as a delimiter, but only when it's not preceded by escape character (say, ?).So this string nika ?+ marry = love+sandra ?+ alex = love should be parsed to two strings: nika + marry = love and sandra + alex = love.Using String.Split('+') is obviously not enough. Can I achieve it somehow?One way, it seems to me, is to replace occurrences of ?+ with some unique character (or a succession of characters), say, @#@, split using ""+"" as a delimiter and then replace @#@ back to +, but that's unreliable and wrong in any possible way I can think of.? is used as an escape character only in combination with either : or +, in any other case it's viewed as a regular character. <code> ",Custom parsing string
How to dynamicaly create a lambda expression," Let's suppose I have the following class: Based on this information, my goal is to create a lambda expression like this: lang and name are local variables I would like to add as constant values when creating the expression.As you can see, the compiled function would be of type Func<Genre, bool>To help you understand more clearly, I would like to achieve something similar to this: I am aware of the existence of expression trees but I'm pretty much new to this topic so I don't even know how to start.Can this problem be solved? How can I create such expression dynamically? <code>  public class Show{ public string Language { get; set; } public string Name { get; set; }} g => g.Language == lang && g.Name == name string lang = ""en"";string name = ""comedy"";Genre genre = new Genre { Language = ""en"", Name = ""comedy"" };Expression<Func<Genre, bool>> expression = CreateExpression(genre, lang, name);// expression = (g => g.Language == ""en"" && g.Name == ""comedy"")",How to dynamically create a lambda expression
What's the implementation of List in C#?," I read this code: But I jumped to the definition(use VS2012) of List (in System.Collections.Generic), I found: It's not Interface or Abstract, but it doesn't have function body(for any method in that class). I know ArrayList and LinkedList, but for List, I have no idea about its implementation.My question:Where is the implementation of List?If List equals ArrayList or something, why .net will allow two class which equals function but different name? If List doesn't equal any other class in .NET, so why give it such an ambiguous name?MSDN states: The List class is the generic equivalent of the ArrayList class. It implements the IList generic interface by using an array whose size is dynamically increased as required.So, I think it's a bad name... <code>  List<long> userIdList = new List<long>(); public class List<T> : IList<T>, ICollection<T>, IEnumerable<T>, IList, ICollection, IEnumerable{ // Summary: // Initializes a new instance of the System.Collections.Generic.List<T> class // that is empty and has the default initial capacity. [TargetedPatchingOptOut(""Performance critical to inline across NGen image boundaries"")] public List(); // // Summary: // Initializes a new instance of the System.Collections.Generic.List<T> class // that contains elements copied from the specified collection and has sufficient // capacity to accommodate the number of elements copied. // // Parameters: // collection: // The collection whose elements are copied to the new list. // // Exceptions: // System.ArgumentNullException: // collection is null. public List(IEnumerable<T> collection); // // Summary: // Initializes a new instance of the System.Collections.Generic.List<T> class // that is empty and has the specified initial capacity. // // Parameters: // capacity: // The number of elements that the new list can initially store. // // Exceptions: // System.ArgumentOutOfRangeException: // capacity is less than 0. [TargetedPatchingOptOut(""Performance critical to inline across NGen image boundaries"")] public List(int capacity); // Summary: // Gets or sets the total number of elements the internal data structure can // hold without resizing. // // Returns: // The number of elements that the System.Collections.Generic.List<T> can contain // before resizing is required. // // Exceptions: // System.ArgumentOutOfRangeException: // System.Collections.Generic.List<T>.Capacity is set to a value that is less // than System.Collections.Generic.List<T>.Count. // // System.OutOfMemoryException: // There is not enough memory available on the system. public int Capacity { get; set; } // // Summary: // Gets the number of elements actually contained in the System.Collections.Generic.List<T>. // // Returns: // The number of elements actually contained in the System.Collections.Generic.List<T>. public int Count { get; } // Summary: // Gets or sets the element at the specified index. // // Parameters: // index: // The zero-based index of the element to get or set. // // Returns: // The element at the specified index. // // Exceptions: // System.ArgumentOutOfRangeException: // index is less than 0.-or-index is equal to or greater than System.Collections.Generic.List<T>.Count. public T this[int index] { get; set; } // Summary: // Adds an object to the end of the System.Collections.Generic.List<T>. // // Parameters: // item: // The object to be added to the end of the System.Collections.Generic.List<T>. // The value can be null for reference types. public void Add(T item); ...",What's the implementation of List?
language specific dlls copied to bin directory," I am using visual studio 2013 & Fluent Validation 5.6.2 I see that after build in the bin folder it copies all the culture specific FluentValidation.resources.dll which seems to be mentioned it in .nuspec file But I do not need these in bin folder, because project does not support any culture specific messages.So how can I tell vs-build to ignore these culture specific dlls? <code>  > <file src=""lib\NET35\de\FluentValidation.resources.dll""> target=""lib\NET35\de\FluentValidation.resources.dll"" />> <file src=""lib\NET35\es\FluentValidation.resources.dll"" target=""lib\NET35\es\FluentValidation.resources.dll"" />> <file src=""lib\NET35\fr\FluentValidation.resources.dll"" target=""lib\NET35\fr\FluentValidation.resources.dll"" />> <file src=""lib\NET35\it\FluentValidation.resources.dll"" target=""lib\NET35\it\FluentValidation.resources.dll"" />> <file src=""lib\NET35\nl\FluentValidation.resources.dll"" target=""lib\NET35\nl\FluentValidation.resources.dll"" />> <file src=""lib\NET35\pt\FluentValidation.resources.dll"" target=""lib\NET35\pt\FluentValidation.resources.dll"" />> <file src=""lib\NET35\sv\FluentValidation.resources.dll"" target=""lib\NET35\sv\FluentValidation.resources.dll"" />",unwanted culture specific dlls copied to bin directory
System.Net.Http.HttpClient vs Windows.Web.Http.HttpClient," When developing .NET 4.5 desktop apps for Windows I have been used to use System.Net.Http.HttpClient for all communication with a backend Web API. I am now developing a Windows Store app and has noticed the existence of Windows.Web.Http.HttpClient. I have looked for information on what the main differences are between the two clients but without any luck.From MSDN I know that I should start using Windows.Web.Http.HttpClient in my Windows Store app since System.Net.Http.HttpClient might be removed from the API: Note The System.Net.Http and System.Net.Http.Headers namespace might not be available in future versions of Windows for use by Windows Store apps. Starting with Windows 8.1 and Windows Server 2012 R2, use Windows.Web.Http.HttpClient in the Windows.Web.Http namespace and the related Windows.Web.Http.Headers and Windows.Web.Http.Filters namespaces instead for Windows Runtime apps.But apart from this information, I have a hard time figuring out what are the main differences and what is the main benefit of using Windows.Web.Http.HttpClient? What does it add that we don't already got in System.Net.Http.HttpClient?Answers backed by official documentation are greatly appreciated. <code> ",System.Net.Http.HttpClient vs Windows.Web.Http.HttpClient - What are the main differences?
Reversal and removing of duplicates in a sentence c#," I am preparing for a interview question.One of the question is to revert a sentence. Such as ""its a awesome day"" to ""day awesome a its. After this,they asked if there is duplication, can you remove the duplication such as ""I am good, Is he good"" to ""good he is, am I"". for reversal of the sentence i have written following method But i am not getting ideas on removing of duplication.Can i get some help here. <code>  public static string reversesentence(string one){ StringBuilder builder = new StringBuilder(); string[] split = one.Split(' '); for (int i = split.Length-1; i >= 0; i--) { builder.Append(split[i]); builder.Append("" ""); } return builder.ToString();}",Reversal and removing of duplicates in a sentence
Downloading files from an FTP folder locally - receiving Apache data when using previous exmaples," I'm trying to download the contents of an FTP folder to a local folder using a this example on StackOverflow:Downloading a list of files from ftp to local folder using c#?The code I have at the moment is: I'm receiving a path not supported exception and when I inspect the values of my variables path and trnsfrpth they appear to be including Apache information. path: ftp://hostname/data/resourceOrders/-rw-r--r-- 1 apache apache 367 Jul 16 14:07 resource-orders-1437019656813-893.jsonAnd trnsfrpth: V:\code.runner\local\orders-rw-r--r-- 1 apache apache 367 Jul 16 14:07 resource-orders-1437019656813-893.jsonHow can I capture just the filename, resource-orders-1437019656813-893.json without a hacky (rightof(), for example) approach? <code>  public void DownloadFilesFromFTP(string localFilesPath, string remoteFTPPath){ remoteFTPPath = ""ftp://"" + Hostname + remoteFTPPath; var request = (FtpWebRequest)WebRequest.Create(remoteFTPPath); request.Method = WebRequestMethods.Ftp.ListDirectoryDetails; request.Credentials = new NetworkCredential(Username, Password); request.Proxy = null; FtpWebResponse response = (FtpWebResponse)request.GetResponse(); Stream responseStream = response.GetResponseStream(); StreamReader reader = new StreamReader(responseStream); List<string> directories = new List<string>(); string line = reader.ReadLine(); while (!string.IsNullOrEmpty(line)) { directories.Add(line); line = reader.ReadLine(); } reader.Close(); using (WebClient ftpClient = new WebClient()) { ftpClient.Credentials = new System.Net.NetworkCredential(Username, Password); for (int i = 0; i <= directories.Count - 1; i++) { if (directories[i].Contains(""."")) { string path = remoteFTPPath + @""/"" + directories[i].ToString(); string trnsfrpth = localFilesPath + @""\"" + directories[i].ToString(); ftpClient.DownloadFile(path, trnsfrpth); } } } response.Close();}","Retrieving list of FTP file names only, without additional details"
How to return a string from async - c#," My method is calling a web service and working asynchronusly.When getting response, everything works fine and I am getting my response.The problem starts when I need to return this response.here is the code of my method: and I am calling it this way: but when printing result I am seeing something like this: System.Threading.Tasks.Taskhow can I get the result string as I did with data inside my method. <code>  public async Task<string> sendWithHttpClient(string requestUrl, string json) { try { Uri requestUri = new Uri(requestUrl); using (var client = new HttpClient()) { client.DefaultRequestHeaders.Clear(); ...//adding things to header and creating requestcontent var response = await client.PostAsync(requestUri, requestContent); if (response.IsSuccessStatusCode) { Debug.WriteLine(""Success""); HttpContent stream = response.Content; //Task<string> data = stream.ReadAsStringAsync(); var data = await stream.ReadAsStringAsync(); Debug.WriteLine(""data len: "" + data.Length); Debug.WriteLine(""data: "" + data); return data; } else { Debug.WriteLine(""Unsuccessful!""); Debug.WriteLine(""response.StatusCode: "" + response.StatusCode); Debug.WriteLine(""response.ReasonPhrase: "" + response.ReasonPhrase); HttpContent stream = response.Content; var data = await stream.ReadAsStringAsync(); return data; } } } catch (Exception ex) { Debug.WriteLine(""ex: "" + ex.Message); return null; } Task <string> result = wsUtils.sendWithHttpClient(fullReq, """"); Debug.WriteLine(""result:: "" + result); ",How to return a string from async
Visual Studio 2015 / C# 6 can't compile XML comments in PCL project," I just installed the fresh released Community Edition of Visual Studio 2015 (RTM) and I'm trying to get my open source project working under VS2015 and C# 6.0. Some of my .cs are shared across projects. This way I'm able to build both a PCL version (with limited functionality) and a 'full' version of the core library.For some reason however, some code files build properly in the full project, but fail when built in the PCL project (where everything compiles under C# 5 and Visual Studio 2013). The compiler seems to be unable to resolve a cref in an XML comment when building the PCL version. Here is a simplified code example that fails on my machine: The compile error I'm getting is: CS1580 Invalid type for parameter Type in XML comment cref attribute: 'Y(Type)' SimpleInjector.PCLWeird thing is though that the IntelliSense support in the XML comments (Wow! we have IntelliSense in XML comments now!) actually works, and the method Y(Type) is selectable through the drop down list. But after selecting this, a compile error is generated (in PCL only).My question of course is how to fix this? Is this a common problem? Could project's configuration have anything to do with this? Is this a known bug? <code>  /// <summary></summary>public class A{ // Compile error on next line: /// <summary><see cref=""Y(Type)""/>.</summary> public void X() { } /// <summary></summary> /// <param name=""x""></param> public void Y(Type x) { } /// <summary></summary> /// <param name=""i""></param> public void Y(int i) { }}",Visual Studio 2015 / C# 6 / Roslyn can't compile XML comments in PCL project
C# Avoiding out of range issues in generic functions," I come from the Wild Wild West of PHP and Javascript where you can return anything from a function. While I do hate that lack of accountability, I also face a new challenge in my effort to keep my code ""perfect"". I made this generic function to pick a random element from a list But I want to protect myself from using it on a list with 0 values. Obviously I cannot return anything from this function other than T, such as false or -1. I can of course do this However there are so many crazy things in C# that I don't know about, and for this app I am creating I very, very often have to choose a random element from a list that could be constantly decrementing in its Count. Is there a better way? <code>  public static T PickRandom<T>(this IList<T> list) { Random random = new Random(); int rnd = random.Next(list.Count); return list[rnd];} if(myList.Count > 0) foo = Utilites.PickRandom(myList);",Avoiding out of range issues in generic functions
Why i cant create Shared Porject in Visual Studio 2015?," I downloaded visual studio community 2015. I tried to create a Shared Project and am getting an error:Content from Microsoft.Windows.UI.Xaml.CSharp.targets I do not have folder with name 8.1 <code>  <Project xmlns=""http://schemas.microsoft.com/developer/msbuild/2003""> <PropertyGroup Condition=""'$(TargetPlatformVersion)'==''""> <TargetPlatformVersion>8.0</TargetPlatformVersion> </PropertyGroup> <PropertyGroup Condition=""'$(TargetPlatformIdentifier)' == 'UAP'""> <RedirectionTarget>8.2</RedirectionTarget> </PropertyGroup> <PropertyGroup Condition=""'$(RedirectionTarget)' == ''""> <RedirectionTarget>$(TargetPlatformVersion)</RedirectionTarget> </PropertyGroup> <!-- Direct 8.0 projects to 8.1 targets to enable retargeting --> <PropertyGroup Condition=""'$(RedirectionTarget)' == '8.0'""> <RedirectionTarget>8.1</RedirectionTarget> </PropertyGroup> <Import Project=""$(RedirectionTarget)\Microsoft.Windows.UI.Xaml.CSharp.targets"" /></Project>",Why can't I create Shared Project in Visual Studio 2015?
Why i cant create Shared Poroject in Visual Studio 2015?," I downloaded visual studio community 2015. I tried to create a Shared Project and am getting an error:Content from Microsoft.Windows.UI.Xaml.CSharp.targets I do not have folder with name 8.1 <code>  <Project xmlns=""http://schemas.microsoft.com/developer/msbuild/2003""> <PropertyGroup Condition=""'$(TargetPlatformVersion)'==''""> <TargetPlatformVersion>8.0</TargetPlatformVersion> </PropertyGroup> <PropertyGroup Condition=""'$(TargetPlatformIdentifier)' == 'UAP'""> <RedirectionTarget>8.2</RedirectionTarget> </PropertyGroup> <PropertyGroup Condition=""'$(RedirectionTarget)' == ''""> <RedirectionTarget>$(TargetPlatformVersion)</RedirectionTarget> </PropertyGroup> <!-- Direct 8.0 projects to 8.1 targets to enable retargeting --> <PropertyGroup Condition=""'$(RedirectionTarget)' == '8.0'""> <RedirectionTarget>8.1</RedirectionTarget> </PropertyGroup> <Import Project=""$(RedirectionTarget)\Microsoft.Windows.UI.Xaml.CSharp.targets"" /></Project>",Why can't I create Shared Project in Visual Studio 2015?
Why i cant create Shared Project in Visual Studio 2015?," I downloaded visual studio community 2015. I tried to create a Shared Project and am getting an error:Content from Microsoft.Windows.UI.Xaml.CSharp.targets I do not have folder with name 8.1 <code>  <Project xmlns=""http://schemas.microsoft.com/developer/msbuild/2003""> <PropertyGroup Condition=""'$(TargetPlatformVersion)'==''""> <TargetPlatformVersion>8.0</TargetPlatformVersion> </PropertyGroup> <PropertyGroup Condition=""'$(TargetPlatformIdentifier)' == 'UAP'""> <RedirectionTarget>8.2</RedirectionTarget> </PropertyGroup> <PropertyGroup Condition=""'$(RedirectionTarget)' == ''""> <RedirectionTarget>$(TargetPlatformVersion)</RedirectionTarget> </PropertyGroup> <!-- Direct 8.0 projects to 8.1 targets to enable retargeting --> <PropertyGroup Condition=""'$(RedirectionTarget)' == '8.0'""> <RedirectionTarget>8.1</RedirectionTarget> </PropertyGroup> <Import Project=""$(RedirectionTarget)\Microsoft.Windows.UI.Xaml.CSharp.targets"" /></Project>",Why can't I create Shared Project in Visual Studio 2015?
ASP.NET MVC Web API Cache-Control headers not sent in response despite being configured on response object," I'm trying to set cache headers in ASP.NET MVC Web API, but the response from IIS suggests that the CacheControl values set are being ignored.My original assumption was that I was using the EnableCorsAttribute in System.Web.Http.Cors, which is necessary in this use case. However, even without that attribute, the response Cache-Control header is still 'private'.Is there something I am doing wrong here? Response <code>  // GET api/<version>/content // [EnableCors(origins: ""*"", headers: ""*"", methods: ""*"")] public HttpResponseMessage Get(HttpRequestMessage request) { int cacheMaxAgeSeconds; string cacheMaxAgeString = request.GetQueryString(""cache-max-age"") ?? request.GetQueryString(""cache-max-age-seconds""); string rawUri = request.RequestUri.ToString(); try { cacheMaxAgeSeconds = cacheMaxAgeString == null ? Config.ApiCacheControlMaxSeconds : int.Parse(cacheMaxAgeString); } catch (Exception ex) { cacheMaxAgeSeconds = Config.ApiCacheControlMaxSeconds; //... } try { //... var response = new HttpResponseMessage(HttpStatusCode.OK) { Content = new StringContent(""..."", Encoding.UTF8, ""application/json"") }; response.Headers.CacheControl = new CacheControlHeaderValue { Public = true, MaxAge = TimeSpan.FromSeconds(cacheMaxAgeSeconds) }; return response; } catch (Exception apiEx) { //... } } HTTP/1.1 200 OKCache-Control: privateContent-Type: application/json; charset=utf-8Date: Thu, 23 Jul 2015 10:53:17 GMTServer: Microsoft-IIS/7.5Set-Cookie: ASP.NET_SessionId=knjh4pncbrhad30kjykvwxyz; path=/; HttpOnlyX-AspNet-Version: 4.0.30319X-Powered-By: ASP.NETContent-Length: 2367Connection: keep-alive",Cache-Control headers not sent in response despite being configured on response object
What are the different heaps in C#?, I was profiling the memory usage of a Windows Forms application in dotmemory and I noticed that for my application there were 0-4 heaps all of varying sizes as well as the large object heap.I was just wondering if anyone had a good explanation of what each heap is for and what is typically stored in each heap? <code> ,What are the different heaps in .net?
What are the different heaps in .net, I was profiling the memory usage of a Windows Forms application in dotmemory and I noticed that for my application there were 0-4 heaps all of varying sizes as well as the large object heap.I was just wondering if anyone had a good explanation of what each heap is for and what is typically stored in each heap? <code> ,What are the different heaps in .net?
Limited search in text files," I'm writing a program to help me search for a keyword inside thousands of files. Each of these files has unnecessary lines that i need to ignore because they mess with the results. Luckily they're all located after a specific line inside those files.What i've already got is a search, without ignoring the lines after that specific line, returning an Enumerable of the file names containing the keyword. Is there a simple and fast way to implement this functionality? It doesn't necessarily have to be in Linq as i'm not even sure if this would be possible.Edit:An example to make it clearer.This is how the text files are structured:xxxxxxstringyyyyyyI want to search the xxx lines until either the keyword is found or the string and then skip to the next file. The yyy lines i want to ignore in my search. <code>  var searchResults = files.Where(file => File.ReadLines(file.FullName) .Any(line => line.Contains(keyWord))) .Select(file => file.FullName);",Searching in text files for a keyword until a string is encountered
Examples of Immutable 'Entities' in .Net, We know the concept of immutability but need to know few immutable types other thanStringDateTimeAre there more? <code> ,Examples of Immutable Types in .Net
DotMemory: snapshot seems to be causing gc, I'm using dotMemory to profile asp.net mvc application running on IIS.And I suspect that 'get snapshot' causes GC gen2 to run. Why?Here is the picture:Question is: is it normal behaivour? Why can't I get snapshot showing me all this uncollected by GC stuff? Every time I gets snapshot: memory usage falls down. <code> ,Memory snapshot triggers Garbage collection in dotMemory
Memory snapshot triggers Garbage collection, I'm using dotMemory to profile asp.net mvc application running on IIS.And I suspect that 'get snapshot' causes GC gen2 to run. Why?Here is the picture:Question is: is it normal behaivour? Why can't I get snapshot showing me all this uncollected by GC stuff? Every time I gets snapshot: memory usage falls down. <code> ,Memory snapshot triggers Garbage collection in dotMemory
How to return recent n number of tweets using Tweetsharp?," I am trying to get recent 200 tweets using TweetSharp but it is returning 12 for some reason. Any ideas why would that be? ThanksUpdateFollowing How to fetch maximum 800 tweets from ListTweetOnHomeTimeline() method of TweetSharp? tweet2 is empty. <code>  var service = new TwitterService( _consumerKey, _consumerSecret, tokenClaim, tokenSecret );IAsyncResult result = service.BeginListTweetsOnUserTimeline(new ListTweetsOnUserTimelineOptions { Count = 200}IEnumerable<TwitterStatus> tweets = service.EndListTweetsOnUserTimeline(result); IAsyncResult result = _twitterService.BeginListTweetsOnUserTimeline(new ListTweetsOnUserTimelineOptions { Count = 200 }); IEnumerable<TwitterStatus> tweets = _twitterService.EndListTweetsOnUserTimeline(result).ToArray(); var tweet2 = _twitterService.ListTweetsOnUserTimeline(new ListTweetsOnUserTimelineOptions { Count = 200, MaxId = tweets.Last().Id }); return tweet2;",Return recent n number of tweets using TweetSharp
Load nuget dependencies at runtime," I'm looking for a way to run code by executing the following steps:Receiving a list of NuGet packages (a list of tuples (""package name"", ""package version"", ""path to main class"").Retrieving them in a local directory (cf code sample #1)Loading them in my program at run-timeRunning the main classes by introspection (cf code sample #2)By now I am struggling with the third step. I can't find out how to load my package at run-time.My main question are:How can I find out in which folders were stored the retrieved packages?How can I load the content of those directories into my program?Code Sample #1: Code sample #2: <code>  private static void getPackageByNameAndVersion(string packageID, string version){ IPackageRepository repo = PackageRepositoryFactory.Default .CreateRepository(""https://packages.nuget.org/api/v2""); string path = ""C:/tmp_repo""; PackageManager packageManager = new PackageManager(repo, path); Console.WriteLine(""before dl pkg""); packageManager.InstallPackage(packageID, SemanticVersion.Parse(version));} private static void loadByAssemblyNameAndTypeName(string assemblyName, string typeName){ AppDomain isolationAppDomain = AppDomain.CreateDomain(""tmp""); object a = isolationAppDomain.CreateInstanceAndUnwrap(assemblyName, typeName); Type x = a.GetType(); MethodInfo m = x.GetMethod(""Main""); m.Invoke(a, new object[] { });}",Load NuGet dependencies at runtime
How to Resolve Instance Inside ConfigureServices in ASP.NET 5, Is it possible to resolve an instance of IOptions<AppSettings> from the ConfigureServices method in Startup? The documentation explicitly says:Don't use IOptions<TOptions> or IOptionsMonitor<TOptions> in Startup.ConfigureServices. An inconsistent options state may exist due to the ordering of service registrations.You can manually create a service provider using serviceCollection.BuildServiceProvider() but this results in the warning:Calling 'BuildServiceProvider' from application code results in an additional copy of singleton services being created. Consider alternatives such as dependency injecting services as parameters to 'Configure'.How can I achieve this? <code>  public void ConfigureServices(IServiceCollection services){ services.Configure<AppSettings>( configuration.GetConfigurationSection(nameof(AppSettings))); // How can I resolve IOptions<AppSettings> here?},How to resolve IOptions instance inside ConfigureServices?
How to Resolve Instance Inside ConfigureServices in ASP.NET Core, Is it possible to resolve an instance of IOptions<AppSettings> from the ConfigureServices method in Startup? The documentation explicitly says:Don't use IOptions<TOptions> or IOptionsMonitor<TOptions> in Startup.ConfigureServices. An inconsistent options state may exist due to the ordering of service registrations.You can manually create a service provider using serviceCollection.BuildServiceProvider() but this results in the warning:Calling 'BuildServiceProvider' from application code results in an additional copy of singleton services being created. Consider alternatives such as dependency injecting services as parameters to 'Configure'.How can I achieve this? <code>  public void ConfigureServices(IServiceCollection services){ services.Configure<AppSettings>( configuration.GetConfigurationSection(nameof(AppSettings))); // How can I resolve IOptions<AppSettings> here?},How to resolve IOptions instance inside ConfigureServices?
Can't connect to SQL Express 14," I'm having trouble connecting to a freshly installed instance of SQL Server 2014 Express. I'm not even totally sure what information you would need to help, so please bear with me as I'm very much an amateur. If I can provide anymore information to help, I'd be glad to.The error I get is always the same, ""A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error:40 - Could not open a connection to SQL Server)""The server currently running SQL Server 2014 Express is Windows Server 2008 R2, with all patches sent out by Microsoft. This is a personal server at my home, so I can do whatever needs to be done with it to make this work.To connect, I've tried using Visual Studio Community 2013, as well as the System.Data.SqlClient namespace in C# and in PowerShell.I've made sure it isn't the firewall causing the problem. I set the rules properly, and when it still didn't work, I turned the firewall off completely. Same issue, no connection.Here are a few examples of connection strings I've tried in .NET. I've removed the server, instance, userid, and password from these strings, and I'm sure I have those correct If anyone has the time and patience to help a newbie sort this out, I'd really appreciate it. I'm using this setup to teach myself some SQL and ASP.NET MVC 5 development, and having a minilab at home would be awesome.Thank you for your time. <code>  Data Source=SERVERNAME\INSTANCENAME;Initial Catalog=Requests;Integrated Security=False;User ID=USERID;Password=PASSWORDData Source=SERVERNAME;Initial Catalog=Requests;Integrated Security=False;User ID=USERID;Password=PASSWORDServer=SERVERNAME\INSTANCENAME; Database=DATABASE; User ID=USERID; Password=PASSWORDServer=SERVERNAME; Database=DATABASE; User ID=USERID; Password=PASSWORD",Can't connect to SQL Server 2014 Express
Injection with the SimpleInjector," I am using Simple Injector for test purpose but pretty new on OOP. I am trying to create loosely couple classes. Here is the my scenario.I have User repo and interface like this. My TestInjectedClass Class and interface are something like this which I am planning to use in Program Main. And My console program looks like this: }BootStrap class here: My problem when I run program, I am getting a value exception on the _userRepository inside TestInjectionClass.How can I properly inject TestInjectionClass and UserRepository to Main Program. Thanks <code>  public class UserRepository : IUserRepository{ public void Add(Model.User user) { Console.WriteLine(""Name:""+user.Name+""\n""+""SurName:""+user.SurName); } public void Delete(int id) { throw new NotImplementedException(); }}public interface IUserRepository{ void Add(User user); void Delete(int id);} public class TestInjectedClass : ITestInjectedClass{ private readonly IUserRepository _userRepository; public TestInjectedClass(IUserRepository userRepository) { _userRepository = userRepository; } public void UserRepoRun() { var user = new User() {Id = 1,Name = ""ada"",SurName = ""stack""}; _userRepository.Add(user); }}public interface ITestInjectedClass{ void UserRepoRun();} class Program { static ITestInjectedClass _testInjectedClass; private static IUserRepository _userRepository; static void Main(string[] args) { _testInjectedClass= new TestInjectedClass(_userRepository); _testInjectedClass.UserRepoRun(); Console.ReadLine(); } public Program() { Bootstrap.Start(); } class Bootstrap{ public static void Start() { var container = new Container(); // Register your types, for instance: container.Register<IUserRepository, UserRepository>(Lifestyle.Singleton); container.Register<ITestInjectedClass, TestInjectedClass>(Lifestyle.Singleton); //container.Register<IUserRepository, TestInjectedClass>(Lifestyle.Singleton); //container.Register<IUserContext, WinFormsUserContext>(); container.Register<TestInjectedClass>(); // Optionally verify the container. container.Verify(); }}",Injection into Console Application with the Simple Injector
How to run desktop application with databse locally with out installing any Databse Server?," I wanted to create a desktop application with database, am using Visual Studio 2013 and C# , Can anybody suggest me what server I used to create my database, in order to run my application in my client's system locally with out installing any database server in client's system [ie, with out installing MsSql server or MySql server or Acess], I want my app works properly when installing my own application's exe file ?And Now am using MSSQL server with my application , Is there any way run this application in client's system locally with out installing MSSQL Server? [my application front end works when I install .Net FrameWork 4.5 , I need something like this for my .mdf databse in Sql Server]somebody says about SQL Server Compact ,but i don't know how to use it <code> ",How to run desktop application with database locally without installing any database Server?
"C# Deserializing xml, including namespace"," I am trying to deserialize some XML and I can't get the namespace / xsi:type=""Model"" to work. If xsi:type=""Model"" is left out of the XML it works, but it has to be there. If I leave the namespace out of my Model, I get an error, if I rename it, I get an empty list.XML Model Deserializing The example above returns an empty list, because the namespace is wrong, as far as I know - how do I get it to return an actual list?EDITI don't have any control over the XML, I'm getting that from a different provider, so I will have to change the rest of the code accordingly. <code>  <Vehicles xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""> <Vehicle xsi:type=""Model""> <Id>238614402</Id> </Vehicle> <Vehicle xsi:type=""Model""> <Id>238614805</Id> </Vehicle></Vehicles> [XmlRootAttribute(""Vehicles"")]public class Vehicles{ public Vehicles() { Vehicle = new List<Vehicle>(); } [XmlElement(ElementName = ""Vehicle"", Namespace = ""http://www.w3.org/2001/XMLSchema-instance"")] public List<Vehicle> Vehicle { get; set; }}public class Vehicle{ [XmlElement(""Id"")] public int Id { get; set; }} XmlSerializer serializer = new XmlSerializer(typeof(Vehicles));string carXML = ""<Vehicles xmlns:xsd=\""http://www.w3.org/2001/XMLSchema\"" xmlns:xsi=\""http://www.w3.org/2001/XMLSchema-instance\""><Vehicle xsi:type=\""Model\""> <Id>238614402</Id> </Vehicle><Vehicle xsi:type=\""Model\""> <Id>238614805</Id> </Vehicle></Vehicles>"";var cars = (Vehicles)serializer.Deserialize(new StringReader(carXML));","Deserializing xml, including namespace"
Is it possible to serve static files from outside the wwwroot folder in ASP.NET vNext?," I have an ASP.NET MVC 6 project with the following structure: I want to serve files from custom as it if was a virtual folder into http://localhost/custom without having to copy them during development.Is it possible to do this in vNext without a virtual folder from IIS (say, using the StaticFile middleware)? <code>  project/ wwwroot/ custom/ project.json",Is it possible to serve static files from outside the wwwroot folder?
Is there a simple and fast way to get Excel range as array of texts in C#?," Array operations are way faster than range operations in VSTO, so currently I'm using with pretty good effect. Sadly, I have some inconsistent data. Sometimes there is 0.45, and sometimes 0.45%, and of course later i see it as 0.0045 in code. Sadly, from ""business"" point of view, both values means 0.45. I cannot force consistency, files come from various sources I don't have any authority over. It's something I need to deal with.The way, of course, would be to look at format, or at display text, and see if there is a % sign in it. If there is, I just need to multiply value by 100. Sadly, if I try: I get message that cannot convert DBNull to object[,]. So is there any way that would allow me to load texts or formats all at once, without going thorough code <-> worksheet border at each step of mu loop? <code>  object[,] RangeValues = wsh.get_Range(""A1:"" + lastCell.Address).Value2; object[,] RangeValues = wsh.get_Range(""A1:"" + lastCell.Address).Text;",Fast way to get Excel range as array of texts or cell formats in C#?
EF 7 set initial seed value," I need to be able to set a DateTime column's initial value.When I specify ""getutcdate() or DateTime.UtcNow and then run dnx . ef migration add InitialMigration EF generates a migration snapshot with: when I use DateTime.UtcNow... and an initial migration: when I use DateTime.UtcNow... It would seem like it has to work, but when I insert data into the table, the default value for the column is the 'instant' in which the timestamp was created.Am I missing something?ALSO, since in the same vein, how to specify the IDENTITY SEED in EF7?ThanksUPDATEAfter generating the sql script , with both options I get:If using ""getutcdate()"": which does not work because of the quotesor if using DateTime.utcNow: which explains the static value I was getting.I guess I can manage with this.Is this is a bug or is there a correct way of doing this?Thanks <code>  entity.Property(e => e.ShipDate).DefaultValue(""getutcdate()"")entity.Property(e => e.ShipDate).DefaultValue(DateTime.UtcNow) b.Property<DateTime?>(""ShipDate"") .Required() .Annotation(""Relational:ColumnDefaultValue"", ""getutcdate()"") .Annotation(""Relational:ColumnDefaultValueType"", ""System.String""); b.Property<DateTime?>(""ShipDate"") .Annotation(""Relational:ColumnDefaultValue"", ""635754129448768827"") .Annotation(""Relational:ColumnDefaultValueType"", ""System.DateTime""); ShipDate = table.Column( type: ""datetime2"", nullable: false, defaultValue: ""getutcdate()""), ShipDate = table.Column( type: ""datetime2"", nullable: true, defaultValue: new DateTime(2015, 8, 17, 12, 55, 44, 876, DateTimeKind.Unspecified)), [ShipDate] datetime2 DEFAULT 'getutcdate()', [ShipDate] datetime2 DEFAULT '2015-08-17 12:55:44.8760000'",EF 7 set initial default value for DateTime column
Programmatically enable (install) IIS in C#," Sometimes there is a PC that doesn't have IIS. Either it disabled or either it not installed. In this case I need to enable it myself according to those steps. I'm trying to create application that will check if IIS is enabled (installed), and if not it will enable (install) it. I tried to install IIS using .msi files from here, but it asking me to follow those stpes before the installation.I tried to use Advanced Installer but apparently it installing the IIS 8.0 Express but still it keeps the IIS disabled.What I need to do to enable IIS programmatically? It is also acceptable if I'll need to run an IIS installation file to make it done (I didn't find the right one). <code> ",Programmatically enable (install) IIS
What is the purposes of exe files in the MVC4 projects?," In MVC5 Project there are 3 exe files:My web-hosting provider is not letting me to publish exe files, and he told me to delete them. During web-deploy I remove selection for this 3 files and publish the rest of the project. When the publishing process finish and I try to access my website I got the error message that the csc.exe is missing :)Can I do something to not publish exe files and also my website to run as expected?Edit - I changed MVC4 with MVC5!Edit - I discuss with my web-hosting provider and he allowed me to read/write exe files and now my project is running as expected.  <code> ",What is the purposes of exe files in the MVC5 projects?
Buidler Design Pattern : Accessing/Passing model data to/in Concrete classes," Here is my builder interface: And this is my ConcreteBuilder: And the Director is here: And that's how I am calling it from default page: Now the problem / confusion I am having is how do I pass the Model Data to the concrete classes? The reason I am confused/stuck is there could be number of different containers (could be more than 20-30). Does each different type of container has to go and grab data from the model or is there a better approach for it?The second thing I am confused with is, my Model is in a different Library. Do I need to create a copy of the model in my web project and populate my local model from that master model, or should I directly query the Master Model for Concrete Class Properties? As you can see, my SingleContainer contains BaseProperties, which are local declaration of the properties that are already in the Master Model. I don't see or understand the point of local Model and I am not sure I am right here or not.Sorry I am new to Design Patterns. Any help will be really appreciated, Thanks <code>  public interface IContainerBuilder { void SetSections(); void SetSides(); void SetArea(); WebControl GetContainer();} public class SingleContainerBuilder:BaseProperties, IContainerBuilder { Panel panel = new Panel(); public void SetSections() { //panel.Height = value coming from model //panel.Width = value coming from model } public void SetSides() { //panel.someproperty = //value coming from model, //panel.someotherproperty = //value coming from model, } public void SetArea() { throw new NotImplementedException(); } public System.Web.UI.WebControls.WebControl GetContainer() { return panel; }} public class ContainerBuilder { private readonly IContainerBuilder objBuilder; public Builder(IContainerBuilder conBuilder) { objBuilder = conBuilder; } public void BuildContainer() { objBuilder.SetArea(); objBuilder.SetSections(); objBuilder.SetSides(); } public WebControl GetContainer() { return this.objBuilder.GetContainer(); }} var conBuilder = new ContainerBuilder(new SingleContainerBuilder());conBuilder.BuildContainer();var container = conBuilder.GetContainer();",Builder Design Pattern : Accessing/Passing model data to/in Concrete classes
how to validate in c# if user enters any value in the Query string?," For example, if a query string has 2 expected parameters , say. param1 = ""abc"" & param2 = ""def"".I know that Request.QuerySring[""abc""] will check for ""abc"" in query string. But is there any way to validate if user enters anything else other than param1 or param2?Thanks. <code> ",How to check if an 'unknown' parameter is supplied in a Request's Query String?
`await` does not resume context after `async` operation?," I've read this question from Noseratio which shows a behaviour where TaskScheduler.Current is not the same after an awaitable has finished its operation.The answer states that : If there is no actual task being executed, then TaskScheduler.Current is the same as TaskScheduler.DefaultWhich is true . I already saw it here : TaskScheduler.Default Returns an instance of the ThreadPoolTaskScheduler TaskScheduler.Current If called from within an executing task will return the TaskScheduler of the currently executing task If called from any other place will return TaskScheduler.Default But then I thought , If so , Let's do create an actual Task (and not just Task.Yield()) and test it : First Messagebox is ""True"" , second is ""False""Question:As you can see , I did created an actual task.I can understand why the first MessageBox yield True. Thats becuase of the : If called from within an executing task will return the TaskScheduler of the currently executing taskAnd that task does have ts which is the sent TaskScheduler.FromCurrentSynchronizationContext()But why the context is not preserved at the second MessageBox ? To me , It wasn't clear from Stephan's answer.Additional information : If I write instead (of the second messagebox ) : It does yield true . But why ?  <code>  async void button1_Click_1(object sender, EventArgs e){ var ts = TaskScheduler.FromCurrentSynchronizationContext(); await Task.Factory.StartNew(async () => { MessageBox.Show((TaskScheduler.Current == ts).ToString()); //True await new WebClient().DownloadStringTaskAsync(""http://www.google.com""); MessageBox.Show((TaskScheduler.Current == ts).ToString());//False }, CancellationToken.None, TaskCreationOptions.None,ts).Unwrap();} MessageBox.Show((TaskScheduler.Current == TaskScheduler.Default).ToString());",await does not resume context after async operation?
Win Form change its size when I create a WPF Window," I have a System.Window.Forms.Form where I handle every button click. When I receive the first event I create a new WPF System.Windows.Window object. On my computer this code works as expected, but if I run it on another computer (both Windows 10) when I click the Windows Forms window changes its size (decreasing its dimensions).How is it possible? How can I avoid this behavior? <code>  class WPF_Window : Window{}public partial class Form1 : Form{ WPF_Window wnd = null; public Form1() { InitializeComponent(); } private void Form1_MouseClick(object sender, MouseEventArgs e) { if (wnd == null) { wnd = new WPF_Window(); } }}",Windows Forms window changes its size when I create a WPF window
what is the meaning of @* operator in asp.net.mvc?, I am a newbie to ASP.NET MVC razor engine. I would like to know the meaning/purpose of using @* before the html fragment in cshtml code? <code> ,What is the meaning of @* operator in asp.net.mvc?
Cannot programmaticlly peek into a remote (private) msmq: Access to Message Queuing system is denied," I've got a very simple console app that is having trouble peeking at a message in a remote private queue. The Peek call fails with a MessageQueueException of ""Access to Message Queuing system is denied"".Using the same client machine and user I am able to view the queue using Queue Explorer and with the Message Queuing Snap In.Experimenting with a local queue I am only able to reproduce the error by taking away the Peek permission on the queue but that also stops it in the other tools.I've seen lots of information that points me to the issues outlined here.However, it seems like if any of those things was the issue, I wouldn't be able to do it using the other tools as well.EDITI have been able to get this to work using the MSMQQueueInfo/MSMQQueue COM objects without changing any credentials.It would be nice if I could make it work using the .NET libraries but at least I have a workaround. <code>  var queues = MessageQueue.GetPrivateQueuesByMachine(machineName);var queue = queues.Where(x=>x.FormatName == queueName).Single();Message message = queue.Peek();",Cannot programmatically peek into a remote (private) msmq: Access to Message Queuing system is denied
"How do I use a Local IIS with .NET 5, C# 6 and Visual studio 2015?"," Previously when working with .net 4.5 and Visual Studio 2013, I could just right click the project, select Web and choose Local IIS like this:Here I could select a URL for my application and stuff like that.However, in Visual studio 2015 it looks like this:How do I use a local IIS? I dont want to start IIS express everytime, I just want to build and then refresh the page like I always have done... :) <code> ","How do I use a Local IIS with .NET Core, C# 6 and Visual studio 2015?"
Azure Webjobs: Is it possible to retrieve the Host Url programmatically in the console app?," I would like to invoke a REST call from my WebJob, I am wondering if it is possible to programmatically retrieve the Host Url (http://<something>.azurewebsites.net) from inside my WebJob, instead of hard-coding the URL. <code> ",Azure WebJobs: Is it possible to retrieve the Host Url programmatically in the console app?
How does if(attributes & FileAttributes.Hidden) { } work?," On this page, I see the following code: But I don't understand why it is the way it is.Why attributes & FileAttributes.Hidden)? What does the singular check on attributes actually do? Does it check if it's not null? I have a feeling I know, but it seems weird. Random and weird. <code>  if ((attributes & FileAttributes.Hidden) == FileAttributes.Hidden)",How does if((attributes & FileAttributes.Hidden) == FileAttributes.Hidden) { } work?
Get user input from textbox in WPF application.," I am trying to get user input from the textbox in a WPF application I am building. The user will enter a numeric value and I would like to store it in a variable. I am just starting on C#. How can I do it? Currently I am opening the textbox and letting the user enter the value. After that the user has to press a button upon which the text from textbox is stored in a variable. I know this isn't right. What is the right way? <code>  private void TextBox_TextChanged(object sender, TextChangedEventArgs e){}private void Button_Click(object sender, RoutedEventArgs e){ var h = text1.Text;}",Get user input from a textbox in a WPF application
Get user input from textbox in WPF application," I am trying to get user input from the textbox in a WPF application I am building. The user will enter a numeric value and I would like to store it in a variable. I am just starting on C#. How can I do it? Currently I am opening the textbox and letting the user enter the value. After that the user has to press a button upon which the text from textbox is stored in a variable. I know this isn't right. What is the right way? <code>  private void TextBox_TextChanged(object sender, TextChangedEventArgs e){}private void Button_Click(object sender, RoutedEventArgs e){ var h = text1.Text;}",Get user input from a textbox in a WPF application
What is the best way to handle validation with different culture using C#," I am trying to build a multilingual MVC application. I have a form in my application and I have field to enter a cost. I am able to create a record using the spanish culture.But on trying to update the record I am getting jquery validation false. and I am getting a default error message as: The field must be numeric.In my view model I have set the following attributes. I have set in my Gobal.asax file with following and the above method works as expected at server side in changing the culture . But the client side validation breaks on non-english cultures as javascript recognizes only decimal literals. I'd like to know the best way to extend the mvc client side validation with culture specific validation.EDITWith reference to Mike's url I have made following changes in Js bundle. Js bundle is as follows In the layout page I have implemented as follows <code>  [LocalizedDisplayName(""Label_Cost"")][RegularExpression(""^[^<>,<|>]+$"", ErrorMessage = null, ErrorMessageResourceName = ""Error_Message_Html_Tags_Prevented"", ErrorMessageResourceType = typeof(Resources))][Range(0, 9999.99, ErrorMessage = null, ErrorMessageResourceName = ""Error_Message_Cost_Not_Valid"", ErrorMessageResourceType = typeof(Resources))]public decimal? Cost { get; set; } protected void Application_AcquireRequestState(object sender, EventArgs e){ try { HttpCookie cookie = HttpContext.Current.Request.Cookies.Get(""CurrentCulture""); string culutureCode = cookie != null && !string.IsNullOrEmpty(cookie.Value) ? cookie.Value : ""en""; CultureInfo ci = new CultureInfo(culutureCode); System.Threading.Thread.CurrentThread.CurrentUICulture = ci; System.Threading.Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture(ci.Name); } catch(Exception ex) { // Code }} public static void RegisterBundles(BundleCollection bundles){ BundleTable.EnableOptimizations = true; bundles.Add(new ScriptBundle(""~/bundles/jquery"").Include( ""~/Scripts/jquery-{version}.js""));bundles.Add(new ScriptBundle(""~/bundles/globalisation"").Include( ""~/Scripts/globalize.js"", ""~/Scripts/globalize/currency.js"", ""~/Scripts/globalize/date.js"", ""~/Scripts/globalize/message.js"", ""~/Scripts/globalize/number.js"", ""~/Scripts/globalize/plural.js"", ""~/Scripts/globalize/relative-time.js"")); bundles.Add(new ScriptBundle(""~/bundles/globalisationEN"").Include( ""~/Scripts/GlobalisationCulture/globalize.culture.en-AU.js"")); bundles.Add(new ScriptBundle(""~/bundles/globalisationES"").Include( ""~/Scripts/GlobalisationCulture/globalize.culture.es-AR.js"")); bundles.Add(new ScriptBundle(""~/bundles/jqueryuiEN"").Include( ""~/Scripts/jquery-ui-1.10.3.js"")); bundles.Add(new ScriptBundle(""~/bundles/jqueryuiES"").Include( ""~/Scripts/jquery-ui-1.10.3.js"")); bundles.Add(new ScriptBundle(""~/bundles/jqueryval"").Include( ""~/Scripts/jquery.validate.js"", ""~/Scripts/jquery.validate.unobtrusive.js"", ""~/Scripts/jquery.unobtrusive-ajax.js"", ""~/Scripts/jquery.validate.globalize.js""));} HttpCookie cookie = HttpContext.Current.Request.Cookies.Get(""CurrentCulture""); string culutureCode = cookie != null && !string.IsNullOrEmpty(cookie.Value) ? cookie.Value : ""en""; if (culutureCode.Equals(""en-AU"", StringComparison.OrdinalIgnoreCase)) { culutureCode = ""EN""; } else if (culutureCode.Equals(""es-AR"", StringComparison.OrdinalIgnoreCase)) { culutureCode = ""ES""; } else { culutureCode = ""EN""; }@Scripts.Render(""~/bundles/jquery"", ""~/bundles/globalisation"", string.Format(""~/bundles/globalisation{0}"", culutureCode), ""~/bundles/jqueryval"", string.Format(""~/bundles/jqueryui{0}"", culutureCode))",What is the best way to handle validation with different culture
How to get html output in Postal," I'm running Postal from a service. My @Message has html. @Html.Raw is not available. When Postal runs my templated view, I get HtmlEncoded html. does anyone know how to fix this? <code> ",What's the equivalent of @Html.Raw in Postal?
Java best equivalent for C# linq," Let's see this example C# code: I'm insterested in cloesest equivalent in Java, obviously without need to write fancy for/foreach loops to iterate in collection.As far as I know, there is no exact linq equivalnet in Java, however I'm still beginner in Java programming, so is there anything you could recommend for me? I'm actually looking for most compact and elegant way to achieve the same result in Java[added]So, thanks for all reponses. However, I need to use it on Android and it seem I can't. Is there any solution for that?(sorry it it's duplicate)[added]Have anybody tried this?http://sourceforge.net/projects/streamsupport/ <code>  List<int> numbers = new List<int>() { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 };int numCount = numbers.Where(n => n < 3 || n > 7).Count();",Java/Android best equivalent for C# linq
When does AOT compilation happen?," I'm using C#.NET for a web application. I've read that JIT compilation happens at run-time, which means(correct me if I'm wrong) that the compilation will happen when the request hits IIS.Another compilation happens using csc.exe during the build phase of the solution using MSBuild to convert high-level code to CIL.If there was no JIT and we wanted to use AOT, where would AOT fit in all this?My question is at what point in the entire phase from building code to the first request, AOT compilation happens? (The platform/framework does not matter) <code> ",When does ahead-of-time (AOT) compilation happen?
c# WPF SizeChanged event of the window doesn't update the width and height when going maximized," I was trying to update my controls when the size of the form changed using SizeChanged. It worked perfectly, except when going full screen.I searched the grid events but couldn't find any events that occur when the user maximizes the window (goes full screen). <code> ",C# WPF SizeChanged event doesn't update width and height when maximized
Validate Currency textbox in C#," I'm using WinForm. I have a textbox and a button. Goal: The button should validate if the textbox is a currency format. If the textbox is a currency format, a message should display currency format. If not then a message should display Error wrong format. Example of currency format: $1,234.00$12,345.00$123,000.00$1.00Update:This is what i had, but this is wrong. Test cases: $12.00 - OK$12,000 - OK$12,3,00 - OK - (Invalid)$12,3,00# - Wrong <code>  Private void button3_Click(object sender, EventArgs e) { currencyTextbox = Convert.ToString(textBox4.Text); string money = currencyTextbox; string s = currencyTextbox; float f; if (float.TryParse(s, NumberStyles.AllowCurrencySymbol | NumberStyles.AllowDecimalPoint | NumberStyles.AllowThousands, CultureInfo.GetCultureInfo(""en-US""), out f)) { MessageBox.Show(""Ok""); } else { MessageBox.Show(""Wrong""); } }",Validate currency textbox
Cut a string in c# after reading first and last alphabet," I want to cut a string in c# after reading first and last alphabet.string name = ""20150910000549659ABCD000007348summary.pdf""; After reading 1234 ""A"" comes and at last ""s"" comes so I want ""ABCD000007348"" <code>  string result = ""ABCD000007348""; // Something like thisstring name = ""1234 ABCD000007348 summary.pdf"";",Parse a string in c# after reading first and last alphabet
Is Async/Await using Start.Run starting a new thread asynchronously?," I have read a lot of articles and still cant get understand this part.Consider this code : First question: When I click the button, it will Call DoSomething and await a Task that creates a Thread from the threadpool by calling Task.Run ( if I am not mistaken ) and all of this runs asynchronously. So I achieved creating a thread that does my work but doing it asynchronously? But consider that I don't need any result back, i just want the work to be done without getting any result back, is there really a need to use async/await , and if so, how?Second question:When running a thread asynchronously, how does that work? Is it running on the main UI but on a separate thread or is it running on a separate thread and separate is asynchronously inside that method?  <code>  private async void button1_Click(object sender, EventArgs e) { await Dosomething(); } private async Task<string> Dosomething() { await Task.Run((() => ""Do Work"")); return ""I am done""; }",Is Async/Await using Task.Run starting a new thread asynchronously?
Debugging startup exceptions with service hosted in IIS., I have my service running in IIS. I have a non fatal exception occurring and being logged on startup.How do I attach Visual Studio to IIS so that it also debugs the startup?I know I can attached visual studio to the w3wp.exe to debug while its running.  <code> ,How to debug startup exceptions with service hosted in IIS?
When should I insert a Windows.Forms component from the designer and when from code?, In C# (and Visual Basic) you can add several non-UI components (those that don't inherit from System.Windows.Forms.Control) directly from the form designer. Examples of those components are System.Windows.Forms.FolderBrowserDialog and System.Windows.Forms.Timer.But what's the benefit from adding non-UI controls with the UI designer instead of instancing them directly from code? There's a rationale behind that? <code> ,Why should I insert a non-UI Windows.Forms component from the designer?
How can you manually re-trigger a binding when the underlying DependencyProperty hasn't changed?," NOTE: Before reading the subject and instantly marking this as a duplicate, please read the entire question to understand what we are after. The other questions which describe getting the BindingExpression, then calling UpdateTarget() method does not work in our use-case. Thanks!TL:DR VersionUsing INotifyPropertyChanged I can make a binding re-evaluate even when the associated property hasn't changed simply by raising a PropertyChanged event with that property's name. How can I do the same if instead the property is a DependencyProperty and I don't have access to the target, only the source?OverviewWe have a custom ItemsControl called MembershipList which exposes a property called Members of type ObservableCollection<object>. This is a separate property from the Items or ItemsSource properties which otherwise behave identical to any other ItemsControl. It's defined like such... What we are trying to do is style all members from Items/ItemsSource which also appear in Members differently from those which don't. Put another way, we're trying to highlight the intersection of the two lists.Note that Members may contain items which are not in Items/ItemsSource at all. That fact is why we can't simply use a multi-select ListBox where SelectedItems has to be a subset of Items/ItemsSource. In our usage, that is not the case.Also note we do not own either the Items/ItemsSource, or the Members collections, therefore we can't simply add an IsMember property to the items and bind to that. Plus, that would be a poor design anyway since it would restrict the items to belonging to one single membership. Consider the case of ten of these controls, all bound to the same ItemsSource, but with ten different membership collections.That said, consider the following binding (MembershipListItem is a container for the MembershipList control)... It's pretty straight forward. When the Members property changes, that value is passed through the MembershipTest converter and the result is stored in the IsMember property on the target object.However, if items are added to or removed from the Members collection, the binding of course does not update because the collection instance itself hasn't changed, only its contents.In our case, we do want it to re-evaluate for such changes.We considered adding an additional binding to Count as such... ...which was close since additions and removals are now tracked, but this doesn't work if you replace one item for another since the count doesn't change.I also attempted to create a MarkupExtension that internally subscribed to the CollectionChanged event of the Members collection before returning the actual binding, thinking I could use the aforementioned BindingExpression.UpdateTarget() method call in the event handler, but the problem there is I don't have the target object from which to get the BindingExpression to call UpdateTarget() on from within the ProvideValue() override. In other words, I know I have to tell someone, but I don't know who to tell.But even if I did, using that approach you quickly run into issues where you would be manually subscribing containers as listener targets to the CollectionChanged event which would cause issues when the containers start to get virtualized, which is why it's best to just use a binding which automatically and correctly gets re-applied when a container is recycled. But then you're right back to the start of this problem of not being able to tell the binding to update in response to the CollectionChanged notifications.Solution A - Using Second DependencyProperty for CollectionChanged eventsOne possible solution which does work is to create an arbitrary property to represent the CollectionChanged, adding it to the MultiBinding, then changing it whenever you want to refresh the binding.To that effect, here I first created a boolean DependencyProperty called MembersCollectionChanged. Then in the Members_PropertyChanged handler, I subscribe (or unsubscribe) to the CollectionChanged event, and in the handler for that event, I toggle the MembersCollectionChanged property which refreshes the MultiBinding.Here's the code... Note: To avoid a memory leak, the code here really should use a WeakEventManager for the CollectionChanged event. However I left it out because of brevity in an already long post.And here's the binding to use it... This did work but to someone reading the code isn't exactly clear of its intent. Plus it requires creating a new, arbitrary property on the control (MembersCollectionChanged here) for each similar type of usage, cluttering up your API. That said, technically it does satisfy the requirements. It just feels dirty doing it that way.Solution B - Use INotifyPropertyChangedAnother solution using INotifyPropertyChanged is show below. This makes MembershipList also support INotifyPropertyChanged. I changed Members to be a standard CLR-type property instead of a DependencyProperty. I then subscribe to its CollectionChanged event in the setter (and unsubscribe the old one if present). Then it's just a matter of raising a PropertyChanged event for Members when the CollectionChanged event fires.Here is the code... Again, this should be changed to use the WeakEventManager.This seems to work fine with the first binding at the top of the page and is very clear what it's intention is.However, the question remains if it's a good idea to have a DependencyObject also support the INotifyPropertyChanged interface in the first place. I'm not sure. I haven't found anything that says it's not allowed and my understanding is a DependencyProperty actually raises its own change notification, not the DependencyObject it's applied/attached to so they shouldn't conflict. Coincidentally that's also why you can't simply implement the INotifyCollectionChanged interface and raise a PropertyChanged event for a DependencyProperty. If a binding is set on a DependencyProperty, it isn't listening to the object's PropertyChanged notifications at all. Nothing happens. It falls on deaf ears. To use INotifyPropertyChanged, you have to implement the property as a standard CLR property. That's what I did in the code above, which again, does work.I'd just like to find out how you can do the equivalent of raising a PropertyChanged event for a DependencyProperty without actually changing the value, if that's even possible. I'm starting to think it isn't. <code>  public static readonly DependencyProperty MembersProperty = DependencyProperty.Register( ""Members"", typeof(ObservableCollection<object>), typeof(MembershipList), new PropertyMetadata(null));public ObservableCollection<object> Members{ get { return (ObservableCollection<object>)GetValue(MembersProperty); } set { SetValue(MembersProperty, value); }} <Style TargetType=""{x:Type local:MembershipListItem}""> <Setter Property=""IsMember""> <Setter.Value> <MultiBinding Converter=""{StaticResource MembershipTest}""> <Binding /> <!-- Passes the DataContext to the converter --> <Binding Path=""Members"" RelativeSource=""{RealtiveSource AncestorType={x:Type local:MembershipList}}"" /> </MultiBinding> </Setter.Value> </Setter></Style> <Style TargetType=""{x:Type local:MembershipListItem}""> <Setter Property=""IsMember""> <Setter.Value> <MultiBinding Converter=""{StaticResource MembershipTest}""> <Binding /> <!-- Passes the DataContext to the converter --> <Binding Path=""Members"" RelativeSource=""{RealtiveSource AncestorType={x:Type local:MembershipList}}"" /> <Binding Path=""Members.Count"" FallbackValue=""0"" /> </MultiBinding> </Setter.Value> </Setter></Style> public static readonly DependencyProperty MembersCollectionChangedProperty = DependencyProperty.Register( ""MembersCollectionChanged"", typeof(bool), typeof(MembershipList), new PropertyMetadata(false));public bool MembersCollectionChanged{ get { return (bool)GetValue(MembersCollectionChangedProperty); } set { SetValue(MembersCollectionChangedProperty, value); }}public static readonly DependencyProperty MembersProperty = DependencyProperty.Register( ""Members"", typeof(ObservableCollection<object>), typeof(MembershipList), new PropertyMetadata(null, Members_PropertyChanged)); // Added the change handlerpublic int Members{ get { return (int)GetValue(MembersProperty); } set { SetValue(MembersProperty, value); }}private static void Members_PropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e){ var oldMembers = e.OldValue as ObservableCollection<object>; var newMembers = e.NewValue as ObservableCollection<object>; if(oldMembers != null) oldMembers.CollectionChanged -= Members_CollectionChanged; if(newMembers != null) oldMembers.CollectionChanged += Members_CollectionChanged;}private static void Members_CollectionChanged(object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e){ // 'Toggle' the property to refresh the binding MembersCollectionChanged = !MembersCollectionChanged;} <Style TargetType=""{x:Type local:MembershipListItem}""> <Setter Property=""IsMember""> <Setter.Value> <MultiBinding Converter=""{StaticResource MembershipTest}""> <Binding /> <!-- Passes in the DataContext --> <Binding Path=""Members"" RelativeSource=""{RealtiveSource AncestorType={x:Type local:MembershipList}}"" /> <Binding Path=""MembersCollectionChanged"" RelativeSource=""{RealtiveSource AncestorType={x:Type local:MembershipList}}"" /> </MultiBinding> </Setter.Value> </Setter></Style> private ObservableCollection<object> _members;public ObservableCollection<object> Members{ get { return _members; } set { if(_members == value) return; // Unsubscribe the old one if not null if(_members != null) _members.CollectionChanged -= Members_CollectionChanged; // Store the new value _members = value; // Wire up the new one if not null if(_members != null) _members.CollectionChanged += Members_CollectionChanged; RaisePropertyChanged(nameof(Members)); }}private void Members_CollectionChanged(object sender, NotifyCollectionChangedEventArgs e){ RaisePropertyChanged(nameof(Members));}",Is it possible to force a binding based on a DependencyProperty to re-evaluate programmatically?
How can you manually re-trigger a binding on a DependencyProperty holding an ObservableCollection when either it or its contents have changed?," NOTE: Before reading the subject and instantly marking this as a duplicate, please read the entire question to understand what we are after. The other questions which describe getting the BindingExpression, then calling UpdateTarget() method does not work in our use-case. Thanks!TL:DR VersionUsing INotifyPropertyChanged I can make a binding re-evaluate even when the associated property hasn't changed simply by raising a PropertyChanged event with that property's name. How can I do the same if instead the property is a DependencyProperty and I don't have access to the target, only the source?OverviewWe have a custom ItemsControl called MembershipList which exposes a property called Members of type ObservableCollection<object>. This is a separate property from the Items or ItemsSource properties which otherwise behave identical to any other ItemsControl. It's defined like such... What we are trying to do is style all members from Items/ItemsSource which also appear in Members differently from those which don't. Put another way, we're trying to highlight the intersection of the two lists.Note that Members may contain items which are not in Items/ItemsSource at all. That fact is why we can't simply use a multi-select ListBox where SelectedItems has to be a subset of Items/ItemsSource. In our usage, that is not the case.Also note we do not own either the Items/ItemsSource, or the Members collections, therefore we can't simply add an IsMember property to the items and bind to that. Plus, that would be a poor design anyway since it would restrict the items to belonging to one single membership. Consider the case of ten of these controls, all bound to the same ItemsSource, but with ten different membership collections.That said, consider the following binding (MembershipListItem is a container for the MembershipList control)... It's pretty straight forward. When the Members property changes, that value is passed through the MembershipTest converter and the result is stored in the IsMember property on the target object.However, if items are added to or removed from the Members collection, the binding of course does not update because the collection instance itself hasn't changed, only its contents.In our case, we do want it to re-evaluate for such changes.We considered adding an additional binding to Count as such... ...which was close since additions and removals are now tracked, but this doesn't work if you replace one item for another since the count doesn't change.I also attempted to create a MarkupExtension that internally subscribed to the CollectionChanged event of the Members collection before returning the actual binding, thinking I could use the aforementioned BindingExpression.UpdateTarget() method call in the event handler, but the problem there is I don't have the target object from which to get the BindingExpression to call UpdateTarget() on from within the ProvideValue() override. In other words, I know I have to tell someone, but I don't know who to tell.But even if I did, using that approach you quickly run into issues where you would be manually subscribing containers as listener targets to the CollectionChanged event which would cause issues when the containers start to get virtualized, which is why it's best to just use a binding which automatically and correctly gets re-applied when a container is recycled. But then you're right back to the start of this problem of not being able to tell the binding to update in response to the CollectionChanged notifications.Solution A - Using Second DependencyProperty for CollectionChanged eventsOne possible solution which does work is to create an arbitrary property to represent the CollectionChanged, adding it to the MultiBinding, then changing it whenever you want to refresh the binding.To that effect, here I first created a boolean DependencyProperty called MembersCollectionChanged. Then in the Members_PropertyChanged handler, I subscribe (or unsubscribe) to the CollectionChanged event, and in the handler for that event, I toggle the MembersCollectionChanged property which refreshes the MultiBinding.Here's the code... Note: To avoid a memory leak, the code here really should use a WeakEventManager for the CollectionChanged event. However I left it out because of brevity in an already long post.And here's the binding to use it... This did work but to someone reading the code isn't exactly clear of its intent. Plus it requires creating a new, arbitrary property on the control (MembersCollectionChanged here) for each similar type of usage, cluttering up your API. That said, technically it does satisfy the requirements. It just feels dirty doing it that way.Solution B - Use INotifyPropertyChangedAnother solution using INotifyPropertyChanged is show below. This makes MembershipList also support INotifyPropertyChanged. I changed Members to be a standard CLR-type property instead of a DependencyProperty. I then subscribe to its CollectionChanged event in the setter (and unsubscribe the old one if present). Then it's just a matter of raising a PropertyChanged event for Members when the CollectionChanged event fires.Here is the code... Again, this should be changed to use the WeakEventManager.This seems to work fine with the first binding at the top of the page and is very clear what it's intention is.However, the question remains if it's a good idea to have a DependencyObject also support the INotifyPropertyChanged interface in the first place. I'm not sure. I haven't found anything that says it's not allowed and my understanding is a DependencyProperty actually raises its own change notification, not the DependencyObject it's applied/attached to so they shouldn't conflict. Coincidentally that's also why you can't simply implement the INotifyCollectionChanged interface and raise a PropertyChanged event for a DependencyProperty. If a binding is set on a DependencyProperty, it isn't listening to the object's PropertyChanged notifications at all. Nothing happens. It falls on deaf ears. To use INotifyPropertyChanged, you have to implement the property as a standard CLR property. That's what I did in the code above, which again, does work.I'd just like to find out how you can do the equivalent of raising a PropertyChanged event for a DependencyProperty without actually changing the value, if that's even possible. I'm starting to think it isn't. <code>  public static readonly DependencyProperty MembersProperty = DependencyProperty.Register( ""Members"", typeof(ObservableCollection<object>), typeof(MembershipList), new PropertyMetadata(null));public ObservableCollection<object> Members{ get { return (ObservableCollection<object>)GetValue(MembersProperty); } set { SetValue(MembersProperty, value); }} <Style TargetType=""{x:Type local:MembershipListItem}""> <Setter Property=""IsMember""> <Setter.Value> <MultiBinding Converter=""{StaticResource MembershipTest}""> <Binding /> <!-- Passes the DataContext to the converter --> <Binding Path=""Members"" RelativeSource=""{RealtiveSource AncestorType={x:Type local:MembershipList}}"" /> </MultiBinding> </Setter.Value> </Setter></Style> <Style TargetType=""{x:Type local:MembershipListItem}""> <Setter Property=""IsMember""> <Setter.Value> <MultiBinding Converter=""{StaticResource MembershipTest}""> <Binding /> <!-- Passes the DataContext to the converter --> <Binding Path=""Members"" RelativeSource=""{RealtiveSource AncestorType={x:Type local:MembershipList}}"" /> <Binding Path=""Members.Count"" FallbackValue=""0"" /> </MultiBinding> </Setter.Value> </Setter></Style> public static readonly DependencyProperty MembersCollectionChangedProperty = DependencyProperty.Register( ""MembersCollectionChanged"", typeof(bool), typeof(MembershipList), new PropertyMetadata(false));public bool MembersCollectionChanged{ get { return (bool)GetValue(MembersCollectionChangedProperty); } set { SetValue(MembersCollectionChangedProperty, value); }}public static readonly DependencyProperty MembersProperty = DependencyProperty.Register( ""Members"", typeof(ObservableCollection<object>), typeof(MembershipList), new PropertyMetadata(null, Members_PropertyChanged)); // Added the change handlerpublic int Members{ get { return (int)GetValue(MembersProperty); } set { SetValue(MembersProperty, value); }}private static void Members_PropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e){ var oldMembers = e.OldValue as ObservableCollection<object>; var newMembers = e.NewValue as ObservableCollection<object>; if(oldMembers != null) oldMembers.CollectionChanged -= Members_CollectionChanged; if(newMembers != null) oldMembers.CollectionChanged += Members_CollectionChanged;}private static void Members_CollectionChanged(object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e){ // 'Toggle' the property to refresh the binding MembersCollectionChanged = !MembersCollectionChanged;} <Style TargetType=""{x:Type local:MembershipListItem}""> <Setter Property=""IsMember""> <Setter.Value> <MultiBinding Converter=""{StaticResource MembershipTest}""> <Binding /> <!-- Passes in the DataContext --> <Binding Path=""Members"" RelativeSource=""{RealtiveSource AncestorType={x:Type local:MembershipList}}"" /> <Binding Path=""MembersCollectionChanged"" RelativeSource=""{RealtiveSource AncestorType={x:Type local:MembershipList}}"" /> </MultiBinding> </Setter.Value> </Setter></Style> private ObservableCollection<object> _members;public ObservableCollection<object> Members{ get { return _members; } set { if(_members == value) return; // Unsubscribe the old one if not null if(_members != null) _members.CollectionChanged -= Members_CollectionChanged; // Store the new value _members = value; // Wire up the new one if not null if(_members != null) _members.CollectionChanged += Members_CollectionChanged; RaisePropertyChanged(nameof(Members)); }}private void Members_CollectionChanged(object sender, NotifyCollectionChangedEventArgs e){ RaisePropertyChanged(nameof(Members));}",Is it possible to force a binding based on a DependencyProperty to re-evaluate programmatically?
Is it possible to force a binding based on a DependencyProperty to re-evaluate even though the value itself hasn't changed?," NOTE: Before reading the subject and instantly marking this as a duplicate, please read the entire question to understand what we are after. The other questions which describe getting the BindingExpression, then calling UpdateTarget() method does not work in our use-case. Thanks!TL:DR VersionUsing INotifyPropertyChanged I can make a binding re-evaluate even when the associated property hasn't changed simply by raising a PropertyChanged event with that property's name. How can I do the same if instead the property is a DependencyProperty and I don't have access to the target, only the source?OverviewWe have a custom ItemsControl called MembershipList which exposes a property called Members of type ObservableCollection<object>. This is a separate property from the Items or ItemsSource properties which otherwise behave identical to any other ItemsControl. It's defined like such... What we are trying to do is style all members from Items/ItemsSource which also appear in Members differently from those which don't. Put another way, we're trying to highlight the intersection of the two lists.Note that Members may contain items which are not in Items/ItemsSource at all. That fact is why we can't simply use a multi-select ListBox where SelectedItems has to be a subset of Items/ItemsSource. In our usage, that is not the case.Also note we do not own either the Items/ItemsSource, or the Members collections, therefore we can't simply add an IsMember property to the items and bind to that. Plus, that would be a poor design anyway since it would restrict the items to belonging to one single membership. Consider the case of ten of these controls, all bound to the same ItemsSource, but with ten different membership collections.That said, consider the following binding (MembershipListItem is a container for the MembershipList control)... It's pretty straight forward. When the Members property changes, that value is passed through the MembershipTest converter and the result is stored in the IsMember property on the target object.However, if items are added to or removed from the Members collection, the binding of course does not update because the collection instance itself hasn't changed, only its contents.In our case, we do want it to re-evaluate for such changes.We considered adding an additional binding to Count as such... ...which was close since additions and removals are now tracked, but this doesn't work if you replace one item for another since the count doesn't change.I also attempted to create a MarkupExtension that internally subscribed to the CollectionChanged event of the Members collection before returning the actual binding, thinking I could use the aforementioned BindingExpression.UpdateTarget() method call in the event handler, but the problem there is I don't have the target object from which to get the BindingExpression to call UpdateTarget() on from within the ProvideValue() override. In other words, I know I have to tell someone, but I don't know who to tell.But even if I did, using that approach you quickly run into issues where you would be manually subscribing containers as listener targets to the CollectionChanged event which would cause issues when the containers start to get virtualized, which is why it's best to just use a binding which automatically and correctly gets re-applied when a container is recycled. But then you're right back to the start of this problem of not being able to tell the binding to update in response to the CollectionChanged notifications.Solution A - Using Second DependencyProperty for CollectionChanged eventsOne possible solution which does work is to create an arbitrary property to represent the CollectionChanged, adding it to the MultiBinding, then changing it whenever you want to refresh the binding.To that effect, here I first created a boolean DependencyProperty called MembersCollectionChanged. Then in the Members_PropertyChanged handler, I subscribe (or unsubscribe) to the CollectionChanged event, and in the handler for that event, I toggle the MembersCollectionChanged property which refreshes the MultiBinding.Here's the code... Note: To avoid a memory leak, the code here really should use a WeakEventManager for the CollectionChanged event. However I left it out because of brevity in an already long post.And here's the binding to use it... This did work but to someone reading the code isn't exactly clear of its intent. Plus it requires creating a new, arbitrary property on the control (MembersCollectionChanged here) for each similar type of usage, cluttering up your API. That said, technically it does satisfy the requirements. It just feels dirty doing it that way.Solution B - Use INotifyPropertyChangedAnother solution using INotifyPropertyChanged is show below. This makes MembershipList also support INotifyPropertyChanged. I changed Members to be a standard CLR-type property instead of a DependencyProperty. I then subscribe to its CollectionChanged event in the setter (and unsubscribe the old one if present). Then it's just a matter of raising a PropertyChanged event for Members when the CollectionChanged event fires.Here is the code... Again, this should be changed to use the WeakEventManager.This seems to work fine with the first binding at the top of the page and is very clear what it's intention is.However, the question remains if it's a good idea to have a DependencyObject also support the INotifyPropertyChanged interface in the first place. I'm not sure. I haven't found anything that says it's not allowed and my understanding is a DependencyProperty actually raises its own change notification, not the DependencyObject it's applied/attached to so they shouldn't conflict. Coincidentally that's also why you can't simply implement the INotifyCollectionChanged interface and raise a PropertyChanged event for a DependencyProperty. If a binding is set on a DependencyProperty, it isn't listening to the object's PropertyChanged notifications at all. Nothing happens. It falls on deaf ears. To use INotifyPropertyChanged, you have to implement the property as a standard CLR property. That's what I did in the code above, which again, does work.I'd just like to find out how you can do the equivalent of raising a PropertyChanged event for a DependencyProperty without actually changing the value, if that's even possible. I'm starting to think it isn't. <code>  public static readonly DependencyProperty MembersProperty = DependencyProperty.Register( ""Members"", typeof(ObservableCollection<object>), typeof(MembershipList), new PropertyMetadata(null));public ObservableCollection<object> Members{ get { return (ObservableCollection<object>)GetValue(MembersProperty); } set { SetValue(MembersProperty, value); }} <Style TargetType=""{x:Type local:MembershipListItem}""> <Setter Property=""IsMember""> <Setter.Value> <MultiBinding Converter=""{StaticResource MembershipTest}""> <Binding /> <!-- Passes the DataContext to the converter --> <Binding Path=""Members"" RelativeSource=""{RealtiveSource AncestorType={x:Type local:MembershipList}}"" /> </MultiBinding> </Setter.Value> </Setter></Style> <Style TargetType=""{x:Type local:MembershipListItem}""> <Setter Property=""IsMember""> <Setter.Value> <MultiBinding Converter=""{StaticResource MembershipTest}""> <Binding /> <!-- Passes the DataContext to the converter --> <Binding Path=""Members"" RelativeSource=""{RealtiveSource AncestorType={x:Type local:MembershipList}}"" /> <Binding Path=""Members.Count"" FallbackValue=""0"" /> </MultiBinding> </Setter.Value> </Setter></Style> public static readonly DependencyProperty MembersCollectionChangedProperty = DependencyProperty.Register( ""MembersCollectionChanged"", typeof(bool), typeof(MembershipList), new PropertyMetadata(false));public bool MembersCollectionChanged{ get { return (bool)GetValue(MembersCollectionChangedProperty); } set { SetValue(MembersCollectionChangedProperty, value); }}public static readonly DependencyProperty MembersProperty = DependencyProperty.Register( ""Members"", typeof(ObservableCollection<object>), typeof(MembershipList), new PropertyMetadata(null, Members_PropertyChanged)); // Added the change handlerpublic int Members{ get { return (int)GetValue(MembersProperty); } set { SetValue(MembersProperty, value); }}private static void Members_PropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e){ var oldMembers = e.OldValue as ObservableCollection<object>; var newMembers = e.NewValue as ObservableCollection<object>; if(oldMembers != null) oldMembers.CollectionChanged -= Members_CollectionChanged; if(newMembers != null) oldMembers.CollectionChanged += Members_CollectionChanged;}private static void Members_CollectionChanged(object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e){ // 'Toggle' the property to refresh the binding MembersCollectionChanged = !MembersCollectionChanged;} <Style TargetType=""{x:Type local:MembershipListItem}""> <Setter Property=""IsMember""> <Setter.Value> <MultiBinding Converter=""{StaticResource MembershipTest}""> <Binding /> <!-- Passes in the DataContext --> <Binding Path=""Members"" RelativeSource=""{RealtiveSource AncestorType={x:Type local:MembershipList}}"" /> <Binding Path=""MembersCollectionChanged"" RelativeSource=""{RealtiveSource AncestorType={x:Type local:MembershipList}}"" /> </MultiBinding> </Setter.Value> </Setter></Style> private ObservableCollection<object> _members;public ObservableCollection<object> Members{ get { return _members; } set { if(_members == value) return; // Unsubscribe the old one if not null if(_members != null) _members.CollectionChanged -= Members_CollectionChanged; // Store the new value _members = value; // Wire up the new one if not null if(_members != null) _members.CollectionChanged += Members_CollectionChanged; RaisePropertyChanged(nameof(Members)); }}private void Members_CollectionChanged(object sender, NotifyCollectionChangedEventArgs e){ RaisePropertyChanged(nameof(Members));}",Is it possible to force a binding based on a DependencyProperty to re-evaluate programmatically?
Why does running a hundred a async tasks take longer than running a hundred threads?," Why does running a hundred async tasks take longer than running a hundred threads?I have the following test class: As far as can tell, TestMethod1 and TestMethod2 should do exactly the same. One uses TPL, two uses plain vanilla threads. One takes 1:30 minutes, two takes 0.54 seconds.Why? <code>  public class AsyncTests{ public void TestMethod1() { var tasks = new List<Task>(); for (var i = 0; i < 100; i++) { var task = new Task(Action); tasks.Add(task); task.Start(); } Task.WaitAll(tasks.ToArray()); } public void TestMethod2() { var threads = new List<Thread>(); for (var i = 0; i < 100; i++) { var thread = new Thread(Action); threads.Add(thread); thread.Start(); } foreach (var thread in threads) { thread.Join(); } } private void Action() { var task1 = LongRunningOperationAsync(); var task2 = LongRunningOperationAsync(); var task3 = LongRunningOperationAsync(); var task4 = LongRunningOperationAsync(); var task5 = LongRunningOperationAsync(); Task[] tasks = {task1, task2, task3, task4, task5}; Task.WaitAll(tasks); } public async Task<int> LongRunningOperationAsync() { var sw = Stopwatch.StartNew(); await Task.Delay(500); Debug.WriteLine(""Completed at {0}, took {1}ms"", DateTime.Now, sw.Elapsed.TotalMilliseconds); return 1; }}",Why does running a hundred async tasks take longer than running a hundred threads?
selectively pull data from JSON request using JsonSerializer and populate a c# object," I connect to a 3rd party webservice that returns a complex JSON object that only contains a few bits of information I actually need.Basically, I just need the array in ""value"". From that array, I just need the ""Id"", ""Title"" and ""Status"" properties.I want to put those attributes into a c# class called Project. This is my class: I'm trying to use this code to read the JSON and do the transform: Example JSON: I just get a null object back. But in the debugger, I can see that it's pulling all the JSON data from the webservice. How can I get what I need from the JSON, build my c# objects, and ignore all the rest? <code>  public class Project{ public String Id { get; set; } public String Title { get; set; } public String Status { get; set; }} using (WebResponse response = request.GetResponse()){ using (StreamReader reader = new StreamReader(response.GetResponseStream())) { var serializer = new JsonSerializer(); var jsonTextReader = new JsonTextReader(reader); returnValue = serializer.Deserialize<Project>(jsonTextReader); }} { ""odata.metadata"":""http://school.edu/Api/1/$metadata#Projects"", ""odata.count"":""3"", ""value"":[ { ""odata.id"":""http://school.edu/Api/1/Projects('123')"", ""RelatedProjects@odata.navigationLinkUrl"":""http://school.edu/Api/1/Projects('123')/RelatedProjects"", ""Tags@odata.navigationLinkUrl"":""http://school.edu/Api/1/Projects('123')/Tags"", ""TimedEvents@odata.navigationLinkUrl"":""http://school.edu/Api/1/Projects('123')/Categories"", ""ep@odata.navigationLinkUrl"":""http://school.edu/Api/1/Projects('123')/ep"", ""#CreateLike"":{ ""target"":""http://school.edu/Api/1/Projects('123')/CreateLike"" }, ""#CreateShortcut"":{ ""target"":""http://school.edu/Api/1/Projects('123')/CreateShortcut"" }, ""#Play"":{ ""target"":""http://school.edu/Play/123"" }, ""#SendInvitation"":{ ""target"":""http://school.edu/Api/1/Projects('123')/SendInvitation"" }, ""#CopyProject"":{ ""target"":""http://school.edu/Api/1/Projects('123')/CopyProject"" }, ""#AddVideoPodcast"":{ ""target"":""http://school.edu/Api/1/Projects('123')/AddVideoPodcast"" }, ""#AddEP"":{ ""target"":""http://school.edu/Api/1/Projects('123')/AddEP"" }, ""Id"":""123"", ""Title"":""Test Title 1"", ""Status"":""Viewable"" }, { ""odata.id"":""http://school.edu/Api/1/Projects('456')"", ""RelatedProjects@odata.navigationLinkUrl"":""http://school.edu/Api/1/Projects('456')/RelatedProjects"", ""Tags@odata.navigationLinkUrl"":""http://school.edu/Api/1/Projects('456')/Tags"", ""TimedEvents@odata.navigationLinkUrl"":""http://school.edu/Api/1/Projects('456')/Categories"", ""ep@odata.navigationLinkUrl"":""http://school.edu/Api/1/Projects('456')/ep"", ""#CreateLike"":{ ""target"":""http://school.edu/Api/1/Projects('456')/CreateLike"" }, ""#CreateShortcut"":{ ""target"":""http://school.edu/Api/1/Projects('456')/CreateShortcut"" }, ""#Play"":{ ""target"":""http://school.edu/Play/456"" }, ""#SendInvitation"":{ ""target"":""http://school.edu/Api/1/Projects('456')/SendInvitation"" }, ""#CopyProject"":{ ""target"":""http://school.edu/Api/1/Projects('456')/CopyProject"" }, ""#AddVideoPodcast"":{ ""target"":""http://school.edu/Api/1/Projects('456')/AddVideoPodcast"" }, ""#AddEP"":{ ""target"":""http://school.edu/Api/1/Projects('456')/AddEP"" }, ""Id"":""456"", ""Title"":""Test Title 2"", ""Status"":""Viewable"" }, { ""odata.id"":""http://school.edu/Api/1/Projects('789')"", ""RelatedProjects@odata.navigationLinkUrl"":""http://school.edu/Api/1/Projects('789')/RelatedProjects"", ""Tags@odata.navigationLinkUrl"":""http://school.edu/Api/1/Projects('789')/Tags"", ""TimedEvents@odata.navigationLinkUrl"":""http://school.edu/Api/1/Projects('789')/Categories"", ""ep@odata.navigationLinkUrl"":""http://school.edu/Api/1/Projects('789')/ep"", ""#CreateLike"":{ ""target"":""http://school.edu/Api/1/Projects('789')/CreateLike"" }, ""#CreateShortcut"":{ ""target"":""http://school.edu/Api/1/Projects('789')/CreateShortcut"" }, ""#Play"":{ ""target"":""http://school.edu/Play/789"" }, ""#SendInvitation"":{ ""target"":""http://school.edu/Api/1/Projects('789')/SendInvitation"" }, ""#CopyProject"":{ ""target"":""http://school.edu/Api/1/Projects('789')/CopyProject"" }, ""#AddVideoPodcast"":{ ""target"":""http://school.edu/Api/1/Projects('789')/AddVideoPodcast"" }, ""#AddEP"":{ ""target"":""http://school.edu/Api/1/Projects('789')/AddEP"" }, ""Id"":""789"", ""Title"":""Test Title 3"", ""Status"":""Viewable"" } ], ""odata.nextLink"":""http://school.edu/Api/1/Folders('xyz')/Projects?$skip=10&$top=10""}",Selectively read part of JSON data using JsonSerializer and populate a c# object
How can i parse an Arabic Umm Al-Qura date string into a .NET DateTime object?," I have the following Arabic date in the Umm Al-Qura calendar that I want to parse into a .NET DateTime object: 17 1436This date is equivalent to September 30th 2015 in the Gregorian calendar.I've been trying the following ""standard"" C# code to parse this date, but without success: No matter what I do, the result of TryParseExact is always false. How do I parse this string properly in .NET?By the way, if I start from a DateTime object, I can create the exact date string above using ToString()'s overloads on DateTime without problems. I just can't do it the other way around apparently. <code>  var cultureInfo = new CultureInfo(""ar-SA"");cultureInfo.DateTimeFormat.Calendar = new UmAlQuraCalendar(); // the default one anywayvar dateFormat = ""dddd dd MMMM yyyy""; //note the instead of ,var dateString = "" 17 1436"";DateTime date;DateTime.TryParseExact(dateString, dateFormat, cultureInfo.DateTimeFormat, DateTimeStyles.AllowWhiteSpaces, out date);",How can I parse an Arabic Umm Al-Qura date string into a .NET DateTime object?
C# - Change button style in Universal Windows Platform," I've tried to make a simple C# UWP application and I don't know how to remove the gray background when my mouse is over the button. How I do that? (remember: it's an UWP for Windows 10 platform , not Windows Phone 8.1 or WPF) <code> ",Change button style in Universal Windows Platform
How to reference System.Data in Visual Studio 2015 targeting .Net Core?," I am trying to access the IDbConnection interface in a class library in order to make a connection object that connects and fetches data from the database, but I just cannot access the IDbConnection interface which was supposed to by in System.Data.dll.I can't find it anywhere in NuGet either. So, how do I go about it?Has Microsoft changed the way we make connections to a database as well, or is there any new interface introduced in .NET Core? <code> ",How to reference System.Data in Visual Studio 2015 targeting .NET Core?
ASP 5 MVC 6 detect mobile browser," How is it possible in Asp.Net 5 MVC 6 to detect if the user is on a mobile device?In previous version of Asp MVC it could be done like this: The problem is that the namespace System.Web is not used by Asp.Net 5. The Request variable in the controller actions is now of type Microsoft.AspNet.Http.HttpRequest, the old version was of type System.Web.HttpRequestBase. Microsoft.AspNet.Http.HttpRequest does not contain the Browser property. I tried looking through other properties, but didn't find anything. EDIT: as requested some resources that prove that Asp.Net 5 does not use System.Web anymore.From the Asp.Net documentation ASP.NET 5 is no longer based on System.Web.dll, but is instead based on a set of granular and well factored NuGet packages allowing you to optimize your app to have just what you need. <code>  Request.Browser.IsMobileDevice",Asp.Net 5 MVC 6 detect mobile browser
Icon button layout C# winform," I'm working on Windows 8, VS 2012. I added a round icon to my button: Also my form has background image: But I'm getting ugly form, where my icon button is square: the round image in the middle and gray color in the corners.The question is how can I display form background instead of gray color?Thank you for your attention <code>  this.btn.Image = Properties.Resources.icon;this.btn.Size = Properties.Resources.icon.Size; this.BackgroundImage = Properties.Resources.sunset;",Icon button layout in winform
c# get set and different varibles," I have this simple code: So when I'm creating a Data class: The list was filled with strings ""1"", ""2"", ""3"", ""4"" even if it had no set.Why is this happening? <code>  public static void Main(String[] args){ Data data = new Data { List = { ""1"", ""2"", ""3"", ""4"" } }; foreach (var str in data.List) Console.WriteLine(str); Console.ReadLine();}public class Data{ private List<String> _List = new List<String>(); public List<String> List { get { return _List; } } public Data() { }} Data data = new Data { List = { ""1"", ""2"", ""3"", ""4"" } };",Why am I allowed to modify properties which are readonly with object initializers?
Why am i allowed to modify properties which are readonly with object initializers?," I have this simple code: So when I'm creating a Data class: The list was filled with strings ""1"", ""2"", ""3"", ""4"" even if it had no set.Why is this happening? <code>  public static void Main(String[] args){ Data data = new Data { List = { ""1"", ""2"", ""3"", ""4"" } }; foreach (var str in data.List) Console.WriteLine(str); Console.ReadLine();}public class Data{ private List<String> _List = new List<String>(); public List<String> List { get { return _List; } } public Data() { }} Data data = new Data { List = { ""1"", ""2"", ""3"", ""4"" } };",Why am I allowed to modify properties which are readonly with object initializers?
How to get execution assembly location?," I am trying to access a file from an ASP.Net vNext class library using a relative path. The file is (should be) located in the installation folder of the application, and to build the full path I need to get that folder path.Using System.Reflection.Assembly.GetExecutingAssembly(), the Location property is empty. The CodeBase property contains the following: CodeBase = ""file:///C:/Users/username/.dnx/runtimes/dnx-clr-win-x86.1.0.0-beta7/bin/Microsoft.Dnx.Loader.dll""How can I get the actual folder where the files being executed are located?EDIT:The answers here are not valid for ASP.Net 5 as I explained already. - just for the duplicate flagging. <code> ",How to get executing assembly location?
How to install NUnit for C# with NuGet Package Manager on Visual Studio 2015?," I have Visual Studio 2015. I want to add NUnit's tests for C# project with NuGet Package Manager, and I want to have possibility of running tests with Visual Studio and in Visual Studio.First I create new C# project:menu File → New → Project → Installed → Templates → Visual C# → Console Application → OK.Then I install NUnit:menu Tools → NuGet Package Manager → Manage NuGet Packages for Solution... Then I install packages:NUnitNUnit.RunnerNUnitTestAdapterIn the output I see: The next step I do is adding new class with code:Right click on project → Add → Class → Visual C# Items → Classname Tests.cs → AddThen I use below code: And finally when I press RunAll on Test Explorer I see: The strange thing is that I found no tutorial when anybody uses NuGet to install NUnit in Visual Studio 2015 and run tests in Visual Studio. <code>  Successfully installed 'NUnit 3.0.0-beta-4' to Tmp.Successfully installed 'NUnit.Runners 2.6.4' to Tmp.Successfully installed 'NUnitTestAdapter 2.0.0' to Tmp. namespace NUnit.Tests{ using System; using NUnit.Framework; [TestFixture] public class Tests { [Test] public void t1() { } [Test] public void t2() { } }} ------ Discover test started ------NUnit VS Adapter 2.0.0.0 discovering tests is startedAttempt to load assembly with unsupported test framework in C:\Users\Grzegorz\Desktop\Tmp\Tmp\bin\Debug\Tmp.exeNUnit VS Adapter 2.0.0.0 discovering test is finished========== Discover test finished: 0 found (0:00:00,0720041) ==========No tests are being discovered.",How to install NUnit for C# with NuGet Package Manager on Visual Studio 2015
JSON Deserialize Child Attribute," There is some code (which I can't change) that uses Newtonsoft.Json's DeserializeObject<T>(strJSONData) to take data from a web request and convert it to a class object (I can change the class). By decorating my class properties with [DataMember(Name = ""raw_property_name"")] I can map the raw JSON data to the correct property in my class. Is there a way I can map the child property of a JSON complex object to a simple property? Here's an example: I don't care about any of the rest of the picture object except for URL, and so don't want to setup a complex object in my C# class. I really just want something like: Is this possible? <code>  { ""picture"": { ""id"": 123456, ""data"": { ""type"": ""jpg"", ""url"": ""http://www.someplace.com/mypicture.jpg"" } }} [DataMember(Name = ""picture.data.url"")]public string ProfilePicture { get; set; }",Can I specify a path in an attribute to map a property in my class to a child property in my JSON?
auto numbering in linq query," I have list of string as this: What I have is: What I need is: The problem is that the number of topScores is dynamic, how can i achive the above list? <code>  var TopScores= list.Where(s => s.Score>2500) .OrderBy(s => s.Score) .Select(s => s.name) .ToList();var text= $""{""this is name of top score students""}\n{string.Join(""\n"", topScores)}"" this is name of top score studentsjimjohnmary this is name of top score students1-jim2-john3-mary",Auto numbering in linq query
Does model maintains its structure when received data in controller?," I am not sure whether I've framed the question properly above in subject but I will try to explain to my best about the question I have.I have below ContactUsModel which is a part of HomeViewModel, better say Nested Model Class in a single model and I am getting this Model referred in HomeViewModel as below: Now in Index.cshtml view I strongly create a form view as below: I do ajax Post as below: and in Controller I tried to receive it as below: For some reason the above model is always null. But this works if I refer the model as HomeViewModel model instead of ContactUsDataModel model in controller parameter like below: My question here is even though I fill model of type ContactUsDataModel in the view I am getting it as null if I refer directly, but ContactUsModel which is inside HomeViewModel gets filled. Doesn't type of model matter here. Is the hierarchy its referred is necessary while fetching in controller? <code>  public class ContactUsDataModel{ public string ContactName { get; set; } public string ContactEmail { get; set; } public string ContactMessage { get; set; } public string ContactPhone { get; set; }} public class HomeViewModel{ /*My other models goes here*/ public ContactUsDataModel CUDModel { get; set; }} @model ProjectName.Models.HomeViewModel<!--I have other views for other models-->@using (Html.BeginForm(""ContactPost"", ""Home"", FormMethod.Post, new { id = ""contactform"" })){ @Html.TextBoxFor(m => m.CUDModel.ContactName, new { @class=""contact col-md-6 col-xs-12"", placeholder=""Your Name *"" }) @Html.TextBoxFor(m => m.CUDModel.ContactEmail, new { @class = ""contact noMarr col-md-6 col-xs-12"", placeholder = ""E-mail address *"" }) @Html.TextBoxFor(m => m.CUDModel.ContactPhone, new { @class = ""contact col-md-12 col-xs-12"", placeholder = ""Contact Number (optional)"" }) @Html.TextAreaFor(m=>m.CUDModel.ContactMessage, new { @class = ""contact col-md-12 col-xs-12"", placeholder = ""Message *"" }) <input type=""submit"" id=""submit"" class=""contact submit"" value=""Send message""> } $('#contactform').on('submit', function (e) { e.preventDefault(); var formdata = new FormData($('.contact form').get(0)); $.ajax({ url: $(""#contactform"").attr('action'), type: 'POST', data: formdata, processData: false, contentType: false, //success success: function (result) { //Code here }, error: function (xhr,responseText,status) { //Code here } });}); public JsonResult ContactPost(ContactUsDataModel model){ var name=model.ContactName; //null /*Fetch the data and save it and return Json*/ //model is always null} public JsonResult ContactPost(HomeViewModel model){ var name=model.CUDModel.ContactName; //gets value /*Fetch the data and save it and return Json*/ //Model is filled.}",Does model maintains its structure when data is received in controller?
UWP net_http_client_execution_error after installing app," I wrote a UWP-App and after generating and installing the .appxbundle, every time I start the App I get a net_http_client_execution_error. The App is starting and running fine, when started in Visual Studio 2015. So there is no chance for me to get the problem, if I debug the app. Update: By default Windows restricts apps to reach the localhost (127.0.0.1). I have running a couch database there. This couch database should run there for our costumers as well. Is it possible to allow a App to reach the localhost (enable local network loopback)? <code> ",UWP Enable local network loopback
how to add new columns in Entity Framework without changing model," I am new to Entity Framework. I started with database first approach which created my classes corresponding to the tables I selected. I am using MVC. One of my tables has a Date column in it. My requirement is I want to display the Day in my gridview(Grid MVC) i.e. if Date for that particular record fetched is 10/27/2015, then Day should show Tues. I want to do this without adding an extra column for the day in my database.Is there a way for this. Any help will be greatly appreciated.My model class generated is as below:- <code>  public partial class QnsNew1 { public int Id { get; set; } public Nullable<System.DateTime> Date { get; set; } public Nullable<int> PersonelID { get; set; } public string CType { get; set; } public string Comments { get; set; } //public string Day { get; set; }//I want to avoid doing this public virtual Personnel Personnel { get; set; } public virtual Type Type { get; set; } }",How to add new entity properties in Entity Framework without changing database model
how to get only the type of Enumarable?," I want to separate IEnumerable variables by their types. My code is like this: When I use type.GetType().GetGenericTypeDefinition().Name, the listGenericType is like List`1 or HashSet`1 but I want it like List or HashSet. Thus, I used Substring to handle this issue!Is there anyway to handle this problem without postProcessing string type? I mean something like below code: <code>  if (type is IEnumerable){ var listGenericType = type.GetType().GetGenericTypeDefinition().Name; listGenericType = listGenericType.Substring(0, listGenericType.IndexOf('`')); if (listGenericType == ""List"") { //do something } else if (listGenericType == ""HashSet"") { //do something }} if (type is IEnumerable){ var listGenericType = type.GetType().GetGenericTypeDefinitionWithoutAnyNeedForPostProcessing(); if (listGenericType == ""List"") { //do something } else if (listGenericType == ""HashSet"") { //do something }}",how to get only the type of Enumerable?
How to implement a clean Custom Object Initializer for a matrix class," I have a custom Matrix class that I would like to implement a custom object initializer similar to what a double[,] can use but can not seem to figure out how to implement it. Ideally I would like to have it look like this as of now I have a regular constructor with a signature of that accepts a call like this and an object intializer that accepts the following using by inheriting the IEnumerable<double[]> interface and implementing an public void Add(double[] doubleVector) method when I try using the object intializer I would like to I get a compiler error of not having an overload for Add that takes X number of arguments where X is the number of columns I am trying to create (i.e. in my provided examples 3). How can I set up my class to take in an argument like I provided? <code>  var m1 = new Matrix { { 1.0, 3.0, 5.0 }, { 7.0, 1.0, 5.0 } }; public Matrix(double[,] inputArray){...} var m1 = new Matrix(new double[,] { { 1.0, 3.0, 5.0 }, { 7.0, 1.0, 5.0 } }); var m2 = new Matrix { new [] { 1.0, 3.0, 5.0 }, new [] { 7.0, 1.0, 5.0 } };",How to implement a clean Custom Object Initializer for a Matrix class
asp.net mvc @html.editfor datetime time can not display when set a default value to it," I'd like to set a default value to my model in Controller, But It cannot display in create page.TestModel code: Controller code: View page: But the display is not correct that it is has no default datetime value, but the description default value is display correct: <code>  public class TestModel{ [DataType(DataType.DateTime), Required] [DisplayFormat(DataFormatString = ""yyyy/MM/dd"", ApplyFormatInEditMode = true)] public DateTime StartTime { get; set; } [DataType(DataType.DateTime), Required] [DisplayFormat(DataFormatString = ""yyyy/MM/dd"", ApplyFormatInEditMode = true)] public DateTime EndTime { get; set; } public string Description { get; set; }} public ActionResult Create(){ var model = new TestModel(); model.StartTime = DateTime.Now; model.EndTime = DateTime.Now.AddDays(10); model.Description = ""This is a default value""; return View(model);} <div class=""form-group""> @Html.LabelFor(model => model.StartTime, htmlAttributes: new { @class = ""control-label col-md-2"" }) <div class=""col-md-10""> @Html.EditorFor(model => model.StartTime) @Html.ValidationMessageFor(model => model.StartTime) </div></div>",@Html.EditorFor DateTime not displaying when set a default value to it
T4 identation in generated C# code," When using T4 to generate C# code, I can't get correct identation with TABS scattered around: I'm using a seemingly correctly indented .TT code similar to the following: This code snippet reflects what I've already tried to do: make control statements and blocks to a single line as much as possible. <code>  public partial class Foo : Base{ public int C { get; set; } [MappedProperty(""A.B[{C}].Foo"")] public int Foo { get; set; }} public partial class <#= ViewModelName #>{ <# foreach(var property in ViewModelProperties) { #> <# if(property.Mapping != null) { #> [MappedProperty(""<#= property.Mapping #>"")] <# } #> public <#= property.TypeDeclaration #> <#= property.MemberName #> { get; set; } <# } #>}",T4 indentation in generated C# code
Per-request scope with ASP.NET vnext and built-in DI container," I'm investigating the topic of DI in ASP.NET 5, and I faced such a problem - I don't understand how to create a new instance of a service per request.I use the code: And inside my middlewares I grab the value: Full code is available hereAnd my problem is: while I expect this service to be renewed on each request, it doesn't happen, and it behaves as if it was registered as AddSingleton().Am I doing anything wrong? <code>  services.AddScoped<ValueStore>(); var someValueStore = app.ApplicationServices.GetService<ValueStore>();",Per-request scope with ASP.NET 5 and built-in DI container
How to decerialize byte[] into generic object to be cast at method call," I am working on an object encryption class. I have everything worked out but I want to be able to encrypt/decrypt any object type with one deserialize method. As of now the only thing holding me up is the deserialize method. I have the function returning type(object) in the hopes of returning a weak typed object. It works as long as I cast the type during the return value assignment, but If I deserialize into type 'object' the result is byte[]. This means that I have to write a deserialize method for every object(T) i want to operate on. What I want to do is pass Type(T) as a parameter to the deserialize method so I can deserialize into object(T), then return the typed object.The problem is that using a typed parameter is apparently not allowed. If I do obj = (type.GetType())br.Deserialize(ms);I get ; expected between '(object(T)) and br.'.If I do obj = (br.Deserialize(ms) as type); I get The type of namespace ""type"" could not be found. (are you missing a using directive or an assembly reference?)or I get a symbol can not be resolved error. Any help is appreciated. Full code is below. <code>  private byte[] serialize(object param) { byte[] encMsg = null; using (MemoryStream ms = new MemoryStream()) { IFormatter br = new BinaryFormatter(); br.Serialize(ms, param); encMsg = ms.ToArray(); } return encMsg; } private object deserialize(byte[] param) { object obj = null; using (MemoryStream ms = new MemoryStream(param)) { IFormatter br = new BinaryFormatter(); obj = (br.Deserialize(ms) as myObject); } return obj; } private byte[] encrypt(byte[] param) { byte[] encMsg = null; using (Aes myAes = Aes.Create()) { myAes.Padding = PaddingMode.ANSIX923; ICryptoTransform autoBot = myAes.CreateEncryptor(myAes.Key, myAes.IV); using (MemoryStream ms = new MemoryStream()) { using (CryptoStream cs = new CryptoStream(ms, autoBot, CryptoStreamMode.Write)) { cs.Write(param, 0, (int)param.Length); } encMsg = ms.ToArray(); } } return encMsg; } private byte[] decrypt(byte[] key, byte[] iv, byte[] param) { byte[] dcparam = null; using (Aes myAes = Aes.Create()) { myAes.Padding = PaddingMode.ANSIX923; ICryptoTransform autoBot = myAes.CreateDecryptor(key, iv); using (MemoryStream ms = new MemoryStream()) { using (CryptoStream cs = new CryptoStream(ms, autoBot, CryptoStreamMode.Write)) { cs.Write(param, 0, (int)param.Length); } dcparam = ms.ToArray(); } } return dcparam; }",How to deserialize byte[] into generic object to be cast at method call
Error on add reference to SQlite.Interop.dll," I'm needing read some cookies of a specific site and I found a code on internet that probably can help me. This code uses some methods specifics of SQLite and for make this is necessary add references to some SQLite dlls, but the trouble is, when I will go add SQlite.Interop.dll, this generates a error that says: A reference to 'C:\Program Files\System.Data.SQLite\2012\bin\SQLite.Interop.dll' could not be added. Please make sure that the file is accessible, and that it is a valid assembly or COM component.So, someone can help me to solve this trouble. I already saw in several sites on internet somethings relative to it but until now, I don't had sucess.This is code that I found, and he have need of SQLite dll file reference, like I said above. <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading.Tasks;namespace ConsoleApplication1{ class Program { static public IEnumerable<Tuple<string, string>> ReadCookies(string hostName) { if (hostName == null) throw new ArgumentNullException(hostName); var dbPath = Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) + @""\Google\Chrome\User Data\Default\Cookies""; if (!System.IO.File.Exists(dbPath)) throw new System.IO.FileNotFoundException(""Cant find cookie store"", dbPath); var connectionString = ""Data Source="" + dbPath + "";pooling=false""; using (var conn = new System.Data.SQLite.SQLiteConnection(connectionString)) using (var cmd = conn.CreateCommand()) { var prm = cmd.CreateParameter(); prm.ParameterName = hostName; prm.Value = hostName; cmd.Parameters.Add(prm); cmd.CommandText = ""SELECT name,encrypted_value FROM cookies WHERE host_key = "" + hostName; conn.Open(); using (var reader = cmd.ExecuteReader()) { while (reader.Read()) { var encryptedData = (byte[])reader[1]; var decodedData = System.Security.Cryptography.ProtectedData.Unprotect(encryptedData, null, System.Security.Cryptography.DataProtectionScope.CurrentUser); var plainText = Encoding.ASCII.GetString(decodedData); yield return Tuple.Create(reader.GetString(0), plainText); } } conn.Close(); } } static void Main(string[] args) { var list = ReadCookies(""facebook.com""); foreach (var item in list) Console.WriteLine(""{0} | {1}"", item.Item1, item.Item2); Console.WriteLine(); Console.ReadLine(); } }}",Error on add reference to SQLite.Interop.dll
How do I set up dragging by touch in Windows Universal Apps?," I have successfully set my Grid up for dragging with a mouse with However, this is not draggable on a Windows Phone (Windows 10) by touching. How do I set that up?Also I assume once I get the Grid dragging, the drop sequence will be the same as with a mouse? This is my drop code: Also on tablet, it is hard to, but it will drag by touch. Do I need to enable it on the phone somewhere?I'm now thinking touch drag may be disabled until a future update or the actual release on Windows 10 on Windows Phone.UPDATE Based on Answers:I set my listView's CanDragItems and IsSwipeEnabled to True, but this did not change anything. I applied the manipulation rectangle with some strange results. On Phone, I am able to drag the rectangle, but when I bring it into my ListViews, it disappears. Shown by these pictures:Full Rect:Dragged it Down out of Framework element- It is dragged behind the listView.On Desktop, The rectangle is dragged in front of the listView, but after being dragged out of the original Framework Element, it is undraggable. <code>  <Grid x:Name=""SourceGrid13"" CanDrag=""True"" DragStarting=""SourceGrid_DragStarting"" Margin=""0,20,0,0""> <ListView HorizontalAlignment=""Center"" AllowDrop=""True"" Drop=""Image_Drop"" DragEnter=""TargetImage_DragEnter"" DragLeave=""TargetImage_DragLeave"" CanDragItems=""True"" IsSwipeEnabled=""True"" MinHeight=""124"" Grid.Row=""4"" Grid.Column=""1""> <Image Height=""224""/> </ListView>",How do I set up dragging by touch in Windows Universal Apps on Windows 10 Phone?
Not In in Entity Framework, I have the following Entity and have a list List<Person> badGuys what I want to do is select from all persons except those in badGuys ListMy Code but I get an error Only primitive types or enumeration types are supported in this context.How to fix this? <code>  public class Person{ public int PersonId { get; set; } public string FirstName { get; set; } public string LastName { get; set; }} context.Persons .where(p => !badGuys.Contain(p)) .ToList(),"""Not In"" in Entity Framework"
ASP.NET MVC Route Doesn't Work," I develop a web application with ASP.NET MVC. I have problem with route.I need a route like this.http://localhost/content-name/23.htmlI've defined a route for this as follows But the route doesn't work. IIS is showing me 404 page. When i remove .html extension so the route works. How can i solve this? Thank you <code>  //i need this route but it's not workroutes.MapRoute(""GetContent"",""{sefLink}/{contentId}.html"",new { controller = ""Content"", action = ""GetContent"" },new[] { ""CanEcomm.Controllers"" }); //this route is working. i just remove "".html"" extensionroutes.MapRoute( ""GetContent"", ""{sefLink}/{contentId}"", new { controller = ""Content"", action = ""GetContent"" }, new[] { ""CanEcomm.Controllers"" });",ASP.NET MVC Route Doesn't Work With .html Extension
Service Fabric and Unit Testing," I can't test a Reliable Service/Actor by just calling it's constructor and then test it's methods. var testService = new SomeService(); throws a NullReferenceException. So what can I do with deployed Service..I understand that deployed SF Reliable Services/Actors are not standard .NET classes, and unit testing of deployed S/A maybe a strange idea.Anyway now I'm trying to give it a try.For example. I've just deployed a Service, than in the test I've created a Proxy object and added item into input queue of Service. Then I need to assert that input queue count = 1. And it works if I've just deployed a Service and no other Clients/Services/Actors have used it's input queue. But next time this test will be failed that's the problem. I need make the Service to stop operatating with other consumers, drop it's queue and than test it. For this purpose I can create some TestMode property and some methods like PropareoForTests/TestingCompleted and call them from test client before and after testing.Is this is a bad idea to do it like that. Maybe are there some guidelines for unit testing SF? Thanks.UPDATE:While investigating Service Fabric Web Reference Application example I've found this TODO string: Does it mean that SF Services will improve it's DI support? What about actors? <code>  /// TODO: Temporary property-injection for an IServiceProxyWrapper until constructor injection is available.",Service Fabric Unit Testing and Dependency Injection
How to store pfx certificate in Azure Key Vault ?," I have a bunch of strings and pfx certificates, which I want to store in Azure Key vault, where only allowed users/apps will be able to get them. It is not hard to do store a string as a Secret, but how can I serialize a certificate in such way that I could retrieve it and deserialize as an X509Certificate2 object in C#?I tried to store it as a key. Here is the Azure powershell code But when I tried to get it with GetKeyAsync method, I couldn't use it. <code>  $securepfxpwd = ConvertTo-SecureString -String 'superSecurePassword' -AsPlainText -Force$key = Add-AzureKeyVaultKey -VaultName 'UltraVault' -Name 'MyCertificate' -KeyFilePath 'D:\Certificates\BlaBla.pfx' -KeyFilePassword $securepfxpwd",How to serialize and deserialize a PFX certificate in Azure Key Vault?
How to store pfx certificate in Azure Key Vault?," I have a bunch of strings and pfx certificates, which I want to store in Azure Key vault, where only allowed users/apps will be able to get them. It is not hard to do store a string as a Secret, but how can I serialize a certificate in such way that I could retrieve it and deserialize as an X509Certificate2 object in C#?I tried to store it as a key. Here is the Azure powershell code But when I tried to get it with GetKeyAsync method, I couldn't use it. <code>  $securepfxpwd = ConvertTo-SecureString -String 'superSecurePassword' -AsPlainText -Force$key = Add-AzureKeyVaultKey -VaultName 'UltraVault' -Name 'MyCertificate' -KeyFilePath 'D:\Certificates\BlaBla.pfx' -KeyFilePassword $securepfxpwd",How to serialize and deserialize a PFX certificate in Azure Key Vault?
Is Task.Run considered bad practise in an ASP .NET MVC Web Application?," BackgroundWe are currently developing a web application, which relies on ASP .NET MVC 5, Angular.JS 1.4, Web API 2 and Entity Framework 6. For scalability reasons, the web application heavility relies on the async/await pattern. Our domain requires some cpu-intensive calculations, which can takes some seconds (<10s). In the past some team members used Task.Run, in order to speed up the calculations.Since starting an extra thread inside ASP .NET MVC or Web API controllers is considered a bad practise (the thread is not known by the IIS, so not considered on AppDomain Recycle => See Stephen Cleary's blog post), they used ConfigureAwait(false).Example QuestionsIs there any performance benefit in using Task.Run in an async Web API Controller for cpu-bound operations? Does ConfigureAwait(false) really avoid the creation of an extra thread? <code>  public async Task CalculateAsync(double param1, double param2){ // CalculateSync is synchronous and cpu-intensive (<10s) await Task.Run(() => this.CalculateSync(param1, param2))).ConfigureAwait(false);}",Is Task.Run considered bad practice in an ASP .NET MVC Web Application?
How are .NET compilers able to construct O(1) lookups for any T in a HashShet<T>?, I don't understand how a compiler can be smart enough to construct an O(1) lookup for MyObject where I can put anything inside I understand how this can be done for a limited number of non-primitives such as but how can it possibly know how to do this for any implementation of MyObject? <code>  public class MyObject{ // ... } public class MyObject{ int i { get; set; } char c { get; set; }},How are .NET compilers able to construct O(1) lookups for any T in a HashSet<T>?
caching a la AsyncLazy with correct retry behavior," UPDATE: Heavily revised after @usr pointed out I'd incorrectly assumed Lazy<T>'s default thread safety mode was LazyThreadSafetyMode.PublicationOnly...I want to lazily compute a value via an async Factory Method (i.e. it returns Task<T>) and have it cached upon success. On exception, I want to have that be available to me. I do not however, want to fall prey to the exception caching behavior that Lazy<T> has in its default mode (LazyThreadSafetyMode.ExecutionAndPublication)Exception caching: When you use factory methods, exceptions are cached. That is, if the factory method throws an exception the first time a thread tries to access the Value property of the Lazy object, the same exception is thrown on every subsequent attempt. This ensures that every call to the Value property produces the same result and avoids subtle errors that might arise if different threads get different results. The Lazy stands in for an actual T that otherwise would have been initialized at some earlier point, usually during startup. A failure at that earlier point is usually fatal. If there is a potential for a recoverable failure, we recommend that you build the retry logic into the initialization routine (in this case, the factory method), just as you would if you werent using lazy initialization.Stephen Toub has an AsyncLazy class and writeup that seems just right: however that's effectively the same behavior as a default Lazy<T> - if there's a problem, there will be no retries.I'm looking for a Task<T> compatible equivalent of Lazy<T>(Func<T>, LazyThreadSafetyMode.PublicationOnly), i.e. it should behave as that is specified:-Alternative to locking In certain situations, you might want to avoid the overhead of the Lazy object's default locking behavior. In rare situations, there might be a potential for deadlocks. In such cases, you can use the Lazy(LazyThreadSafetyMode) or Lazy(Func,LazyThreadSafetyMode) constructor, and specify LazyThreadSafetyMode.PublicationOnly. This enables the Lazy object to create a copy of the lazily initialized object on each of several threads if the threads call the Value property simultaneously. The Lazy object ensures that all threads use the same instance of the lazily initialized object and discards the instances that are not used. Thus, the cost of reducing the locking overhead is that your program might sometimes create and discard extra copies of an expensive object. In most cases, this is unlikely. The examples for the Lazy(LazyThreadSafetyMode) and Lazy(Func,LazyThreadSafetyMode) constructors demonstrate this behavior.IMPORTANTWhen you specify PublicationOnly, exceptions are never cached, even if you specify a factory method.Is there any FCL, Nito.AsyncEx or similar construct that might fit in nicely here? Failing this, can anyone see an elegant way to gate the ""attempt in progress"" bit (I'm OK with each caller making its own attempt in the same way that a Lazy<T>( ..., (LazyThreadSafetyMode.PublicationOnly) does) and yet still have that and the cache management encapsulated neatly? <code>  public class AsyncLazy<T> : Lazy<Task<T>>{ public AsyncLazy(Func<Task<T>> taskFactory) : base(() => Task.Factory.StartNew(() => taskFactory()).Unwrap()) { } public TaskAwaiter<T> GetAwaiter() { return Value.GetAwaiter(); }}",caching the result from a [n async] factory method iff it doesn't throw
caching the result from a factory method iff it doesn't throw," UPDATE: Heavily revised after @usr pointed out I'd incorrectly assumed Lazy<T>'s default thread safety mode was LazyThreadSafetyMode.PublicationOnly...I want to lazily compute a value via an async Factory Method (i.e. it returns Task<T>) and have it cached upon success. On exception, I want to have that be available to me. I do not however, want to fall prey to the exception caching behavior that Lazy<T> has in its default mode (LazyThreadSafetyMode.ExecutionAndPublication)Exception caching: When you use factory methods, exceptions are cached. That is, if the factory method throws an exception the first time a thread tries to access the Value property of the Lazy object, the same exception is thrown on every subsequent attempt. This ensures that every call to the Value property produces the same result and avoids subtle errors that might arise if different threads get different results. The Lazy stands in for an actual T that otherwise would have been initialized at some earlier point, usually during startup. A failure at that earlier point is usually fatal. If there is a potential for a recoverable failure, we recommend that you build the retry logic into the initialization routine (in this case, the factory method), just as you would if you werent using lazy initialization.Stephen Toub has an AsyncLazy class and writeup that seems just right: however that's effectively the same behavior as a default Lazy<T> - if there's a problem, there will be no retries.I'm looking for a Task<T> compatible equivalent of Lazy<T>(Func<T>, LazyThreadSafetyMode.PublicationOnly), i.e. it should behave as that is specified:-Alternative to locking In certain situations, you might want to avoid the overhead of the Lazy object's default locking behavior. In rare situations, there might be a potential for deadlocks. In such cases, you can use the Lazy(LazyThreadSafetyMode) or Lazy(Func,LazyThreadSafetyMode) constructor, and specify LazyThreadSafetyMode.PublicationOnly. This enables the Lazy object to create a copy of the lazily initialized object on each of several threads if the threads call the Value property simultaneously. The Lazy object ensures that all threads use the same instance of the lazily initialized object and discards the instances that are not used. Thus, the cost of reducing the locking overhead is that your program might sometimes create and discard extra copies of an expensive object. In most cases, this is unlikely. The examples for the Lazy(LazyThreadSafetyMode) and Lazy(Func,LazyThreadSafetyMode) constructors demonstrate this behavior.IMPORTANTWhen you specify PublicationOnly, exceptions are never cached, even if you specify a factory method.Is there any FCL, Nito.AsyncEx or similar construct that might fit in nicely here? Failing this, can anyone see an elegant way to gate the ""attempt in progress"" bit (I'm OK with each caller making its own attempt in the same way that a Lazy<T>( ..., (LazyThreadSafetyMode.PublicationOnly) does) and yet still have that and the cache management encapsulated neatly? <code>  public class AsyncLazy<T> : Lazy<Task<T>>{ public AsyncLazy(Func<Task<T>> taskFactory) : base(() => Task.Factory.StartNew(() => taskFactory()).Unwrap()) { } public TaskAwaiter<T> GetAwaiter() { return Value.GetAwaiter(); }}",caching the result from a [n async] factory method iff it doesn't throw
Convert datetime string with this format: (yyyy-MM-dd'T'hh:mm:ss-hh:mm)," I am receiving a JSON string that contains a date that looks like this: 2015-07-09T08:38:49-07:00 where the last part is the timezone. Is there a standard way to convert this to a DateTimeOffset? Here is what I have so far: This doesn't deserialize any of the dates. I've tried using -Z and hh:mm for the timezone data, but I can't seem to deserialize any of the dates.For reference, this is from OneLogin, a SSO provider. Here's a link to the user documentation. Notice the bit about the dates at the top. <code>  var olu = JsonConvert.DeserializeObject<OneLoginUser>(jToken.ToString(), new IsoDateTimeConverter { DateTimeFormat = ""yyyy-MM-dd'T'HH:mm:sszzz"" });",Convert datetime string with this format: (yyyy-MM-dd'T'hh:mm:ss-zzz)
How can i scale up the hatchstyle drawn in a rectangle?," I'm using .Net drawing to draw a diagram. It is essentially a stacked bar chart.The issue I have is that I want to reduce the amount of lines in the hatch style so in a way scale it up to make it clearer. I've looked around but didn't come across anything that could help me. I draw a rectangle and then use a hatchbrush to fill it but due to image size the hatchfill becomes less clearer. Thank you for any suggestions.The hatchStyles and brush types are stored in the db and I use a helper function to return them. So I draw the rectangle and after getting the brush I fill the rectangle. Essentially I want to scale up the hatch fill if that can be done. And the getBrush function; the brush type, hatch style and colour are stored in the db and used to create the returned brush: Function to return the hatch style: As you can see in the image below the hatch style is not clear. <code>  g.DrawRectangle(gridpen, startX, startY, BOREHOLE_RECT_WIDTH, layerRectHeight); brush = GetBoreholeBrush(l.SoilTypeMatrixLevel1Id.PrimaryBrushType, l.SoilTypeMatrixLevel1Id.PrimaryFillStyle, l.SoilTypeMatrixLevel1Id.PrimaryColour); g.FillRectangle(brush, startX, startY, BOREHOLE_RECT_WIDTH, layerRectHeight); //=================================== private Brush GetBoreholeBrush(string BrushType, string HatchStyle, string Colour) //=================================== { //Decide on what brush type has been chosen. Brush brush; if (BrushType.ToLower() == BrushTypes.HatchBrush.ToString().ToLower()) { brush = new HatchBrush(GetHatchStyle(HatchStyle), Color.Black, ColorTranslator.FromHtml(Colour)); } else if (BrushType.ToLower() == BrushTypes.SolidBrush.ToString().ToLower()) { brush = new HatchBrush(GetHatchStyle(HatchStyle), Color.Black, ColorTranslator.FromHtml(Colour)); } else if (BrushType.ToLower() == BrushTypes.TextureBrush.ToString().ToLower()) { brush = new HatchBrush(GetHatchStyle(HatchStyle), Color.Black, ColorTranslator.FromHtml(Colour)); } else { brush = new HatchBrush(GetHatchStyle(HatchStyle), Color.Black, ColorTranslator.FromHtml(Colour)); } return brush; } //=================================== private HatchStyle GetHatchStyle(string FillStyle) //=================================== { //Loop through each hatch tyle and return the correct one. foreach (HatchStyle style in Enum.GetValues(typeof(HatchStyle))) { if (style.ToString().ToLower() == FillStyle.ToLower()) { return style; } } return HatchStyle.Vertical; }",How can I scale up the hatchstyle drawn in a rectangle?
C# Array Initialisation," I can do this with an integer: But I can't do this with an integer array: Why not?To clarify, I am not looking for the correct syntax. That I can look up. I know that this works: Which would be the equivalent of: What I am trying to understand is, why does the code fail for arrays? What is the reason behind the code failing to be recognised as valid.  <code>  int a;a = 5; int[] a;a = { 1, 2, 3, 4, 5 }; int[] a = { 1, 2, 3, 4, 5 }; int a = 5;",Why can't I use array initialisation syntax separate from array declaration?
Form won't show C#," Details form doesn't show anything even when it is called from the Welcome form.here's all the code (its like login-signup project):Details Form Welcome Form any help/advice would be really a big legit help <code>  namespace D{ public partial class Details : Form { public string dtext1; public string orform = string.Empty; public string orform2 = string.Empty; public string orform3 = string.Empty; public string orform4 = string.Empty; public Details(string incomform,string incomform2,string incomform3,string incomform4) { InitializeComponent(); orform = incomform; orform2 = incomform2; orform3 = incomform3; orform4 = incomform4; } public Details() { } private void Details_Load(object sender, EventArgs e) { textBox1.Text = orform; textBox2.Text = orform2; textBox3.Text = orform3; textBox4.Text = orform4; } private void button1_Click(object sender, EventArgs e) { this.Hide(); } }} namespace D{ public partial class Welcome : Form { public Welcome() { InitializeComponent(); } private void button1_Click(object sender, EventArgs e) { Details Det = new Details(); Det.ShowDialog(); this.Close(); } }}","Form doesn't show controls, It shows an empty form"
OWIN OpenID connect authorization fails to create authorization ticket," I am working on a project where a third party provider will act as an Oauth2 based Authorization Server. An Asp.net MVC 5 based client which will send the user to the authorization server to authenticate (using login / password) and the auth server will return an access token back to the MVC client. Any further calls to resource servers (APIs) will be made using the access token.To achieve this I am using Microsoft.Owin.Security.OpenIdConnect and the UseOpenIdConnectAuthentication extension. I am able to successfully redirect and get the access token from the auth server but the client is not creating an Authentication Cookie. Every time I try to access a secured page, I get the callback page with access token. What am I missing here? My current code is below.The secured controller action: The Startup Class: <code>  namespace MvcWebApp.Controllers{ public class SecuredController : Controller { // GET: Secured [Authorize] public ActionResult Index() { return View((User as ClaimsPrincipal).Claims); } }} public class Startup{ public void Configuration(IAppBuilder app) { app.SetDefaultSignInAsAuthenticationType(""ClientCookie""); app.UseCookieAuthentication(new CookieAuthenticationOptions { AuthenticationMode = AuthenticationMode.Active, AuthenticationType = ""ClientCookie"", CookieName = CookieAuthenticationDefaults.CookiePrefix + ""ClientCookie"", ExpireTimeSpan = TimeSpan.FromMinutes(5) }); // *************************************************************************** // Approach 1 : ResponseType = ""id_token token"" // *************************************************************************** app.UseOpenIdConnectAuthentication(new OpenIdConnectAuthenticationOptions { AuthenticationMode = AuthenticationMode.Active, AuthenticationType = OpenIdConnectAuthenticationDefaults.AuthenticationType, SignInAsAuthenticationType = app.GetDefaultSignInAsAuthenticationType(), Authority = ""https://thirdparty.com.au/oauth2"", ClientId = ""_Th4GVMa0JSrJ8RKcZrzbcexk5ca"", ClientSecret = ""a3GVJJbLHkrn9nJRj3IGNvk5eGQa"", RedirectUri = ""http://mvcwebapp.local/"", ResponseType = ""id_token token"", Scope = ""openid"", Configuration = new OpenIdConnectConfiguration { AuthorizationEndpoint = ""https://thirdparty.com.au/oauth2/authorize"", TokenEndpoint = ""https://thirdparty.com.au/oauth2/token"", UserInfoEndpoint = ""https://thirdparty.com.au/oauth2/userinfo"", }, Notifications = new OpenIdConnectAuthenticationNotifications { SecurityTokenValidated = n => { var token = n.ProtocolMessage.AccessToken; // persist access token in cookie if (!string.IsNullOrEmpty(token)) { n.AuthenticationTicket.Identity.AddClaim( new Claim(""access_token"", token)); } return Task.FromResult(0); }, AuthenticationFailed = notification => { if (string.Equals(notification.ProtocolMessage.Error, ""access_denied"", StringComparison.Ordinal)) { notification.HandleResponse(); notification.Response.Redirect(""/""); } return Task.FromResult<object>(null); } } }); // *************************************************************************** // Approach 2 : ResponseType = ""code"" // *************************************************************************** //app.UseOpenIdConnectAuthentication(new OpenIdConnectAuthenticationOptions //{ // AuthenticationMode = AuthenticationMode.Active, // AuthenticationType = OpenIdConnectAuthenticationDefaults.AuthenticationType, // SignInAsAuthenticationType = app.GetDefaultSignInAsAuthenticationType(), // Authority = ""https://thirdparty.com.au/oauth2"", // ClientId = ""_Th4GVMa0JSrJ8RKcZrzbcexk5ca"", // ClientSecret = ""a3GVJJbLHkrn9nJRj3IGNvk5eGQa"", // RedirectUri = ""http://mvcwebapp.local/"", // ResponseType = ""code"", // Scope = ""openid"", // Configuration = new OpenIdConnectConfiguration // { // AuthorizationEndpoint = ""https://thirdparty.com.au/oauth2/authorize"", // TokenEndpoint = ""https://thirdparty.com.au/oauth2/token"", // UserInfoEndpoint = ""https://thirdparty.com.au/oauth2/userinfo"", // }, // Notifications = new OpenIdConnectAuthenticationNotifications // { // AuthorizationCodeReceived = async (notification) => // { // using (var client = new HttpClient()) // { // var configuration = await notification.Options.ConfigurationManager.GetConfigurationAsync(notification.Request.CallCancelled); // var request = new HttpRequestMessage(HttpMethod.Get, configuration.TokenEndpoint); // request.Content = new FormUrlEncodedContent(new Dictionary<string, string> // { // {OpenIdConnectParameterNames.ClientId, notification.Options.ClientId}, // {OpenIdConnectParameterNames.ClientSecret, notification.Options.ClientSecret}, // {OpenIdConnectParameterNames.Code, notification.ProtocolMessage.Code}, // {OpenIdConnectParameterNames.GrantType, ""authorization_code""}, // {OpenIdConnectParameterNames.ResponseType, ""token""}, // {OpenIdConnectParameterNames.RedirectUri, notification.Options.RedirectUri} // }); // var response = await client.SendAsync(request, notification.Request.CallCancelled); // response.EnsureSuccessStatusCode(); // var payload = JObject.Parse(await response.Content.ReadAsStringAsync()); // // Add the access token to the returned ClaimsIdentity to make it easier to retrieve. // notification.AuthenticationTicket.Identity.AddClaim(new Claim( // type: OpenIdConnectParameterNames.AccessToken, // value: payload.Value<string>(OpenIdConnectParameterNames.AccessToken))); // } // } // } //}); }} ",OWIN OpenID connect authorization fails to authorize secured controller / actions
powershell c# process set-execution policy," I'm doing a VSTO add in for Outlook in C# that calls PowerShell scripts to interact with the Exchange Online of Office 365. It all works perfectly on my windows 10 machine with a machine level unrestricted PowerShell execution policy. However, I can't get this to run on the client's Windows 7 machine. I think there are two issues. One that possibly his windows 7 PowerShell needs to be updated to work with my code, and second that I'm not properly setting the process execution policy. Here was my best effort to get the execution policy set to unrestricted (would bypass be better?). Could someone point me the right direction? I know this doesn't work, as if I set the machine policy to restricted the other really exciting stuff doesn't happen, but if I set it to unrestricted then everything works.  <code>  using (PowerShell PowerShellInstance = PowerShell.Create()){ StringBuilder OSScript = new StringBuilder(""Set-ExecutionPolicy -Scope Process -ExecutionPolicy Unrestricted;""); OSScript.Append(@""other really exciting stuff""); PowerShellInstance.AddScript(OSScript.ToString()); PowerShellInstance.Invoke();} ",Set-Execution Policy from process
Await and Synce blocking the UI (winform)," I wrote a little winforms application that search for files on the disk (what file is not that important for the sake of the question). the problem is the that it can be even 100,000 files or so. so this operation takes time.What I want to achieve is to do the search operation as an async operation and not to block the UI thread so the form won't get stuck.I can do this with the backgroundWorker but for some reason not with the async\await mechanism.Here is my code: Why is the UI thread get stuck and not displaying the MessageBox immediately?what am I missing ? <code>  private async void button_FindFiles_Click(object sender, EventArgs e){ await SearchFilesUtil.SearchPnrFilesAsync(this.textBox_mainDirectory.Text); MessageBox.Show(""After SearchPnrFilesAsync"");}public async static Task SearchPnrFilesAsync(string mainDir){ foreach (string file in Directory.EnumerateFiles(mainDir, "".xml"", SearchOption.AllDirectories)) { var fileContenet = File.ReadAllText(file); var path = Path.Combine(@""C:\CopyFileHere"", Path.GetFileName(file)); using (StreamWriter sw = new StreamWriter(path)) { await sw.WriteAsync(fileContenet); } }}",await and async blocking the UI
Why is typeof(string).FullName giving System.String?," Why typeof(string).FullName is giving System.String and not string? The same is with all other ""simple"" types like int, float, double, ...I understand that typeof is returning the System.Type object for the given type, but why is string not also be an System.Type object ?Is it because string is part of the c# language, and System.Typeis part of the system libraries? <code> ",Why 'typeof(string).FullName' is giving 'System.String' and not 'string'?
C# WPF - How to combie datatrigger and trigger?," I don't know if need to combine DataTrigger & Trigger, if there's better way please tell me.My goal is, to create a menu(with icons), icons will change while meet hover or selected event.Here's an enum define all menu types: Then I created a MenuItemModel represent each menu item: Ok, then I begin to create UI. till now everything is very easy, but when I try to make mouseOver and Selected effect, problem comes. for example, if mouse over home_normal.png, it should change to home_hover.png, if IsSelected property is TRUE, image should be ignore hover trigger then use home_selected.png. But there's 3 image, how do I know what image should change? If you can see the question mark in ""MY PLAN"" comment, that would be my question: what should I do in the Value field? <code>  public enum PageTypes:byte{ NotSet = 0, HomePage = 1, ShopPage = 2, AboutPage = 3} public class MenuItemModel : INotifyPropertyChanged{ private PageTypes _menuItemType = PageTypes.NotSet; public PageTypes MenuItemType { get { return _menuItemType; } set { if (value != _menuItemType) { _menuItemType = value; RaisePropertyChanged(() => MenuItemType); } } } private bool _isSelected = false; public bool IsSelected { get { return _isSelected; } set { if (value != _isSelected) { _isSelected = value; RaisePropertyChanged(() => IsSelected); } } }} <!-- MenuItem Template --><DataTemplate x:Key=""MenuTemplate""> <Button Command=""{Binding ClickCommand}"" CommandParameter=""{Binding}""> <Image> <Image.Style> <Style TargetType=""Image""> <Setter Property=""Source"" Value=""/Image/Home_normal.png""/> <Style.Triggers> <DataTrigger Binding=""{Binding MenuItemType}"" Value=""ShopPage""> <Setter Property=""Source"" Value=""/Image/Shop_normal.png""/> </DataTrigger> <DataTrigger Binding=""{Binding MenuItemType}"" Value=""AboutPage""> <Setter Property=""Source"" Value=""/Image/About_normal.png""/> </DataTrigger> </Style.Triggers> </Style> </Image.Style> </Image> </Button></DataTemplate> <!-- MenuItem Template --><DataTemplate x:Key=""MenuTemplate""> <Button Command=""{Binding ClickCommand}"" CommandParameter=""{Binding}""> <Image> <Image.Style> <Style TargetType=""Image""> <Setter Property=""Source"" Value=""/Image/Home_normal.png""/> <Style.Triggers> <DataTrigger Binding=""{Binding MenuItemType}"" Value=""ShopPage""> <Setter Property=""Source"" Value=""/Image/Shop_normal.png""/> </DataTrigger> <DataTrigger Binding=""{Binding MenuItemType}"" Value=""AboutPage""> <Setter Property=""Source"" Value=""/Image/About_normal.png""/> </DataTrigger> <!-- MY PLAN --> <Trigger Property=""IsMouseOver"" Value=""True""> <Setter Property=""Source"" Value=""?_hover.png""/> </Trigger> <DataTrigger Binding=""{Binding IsSelected}"" Value=""True""> <Setter Property=""Source"" Value=""?_selected.png""/> </DataTrigger> </Style.Triggers> </Style> </Image.Style> </Image> </Button></DataTemplate>",C# WPF - How to Combine datatrigger and trigger?
Why can't readonly use properties with," Why properties in C# cannot be readonly ?When I try to have a property readonly it states that: a modifier 'readonly' is not valid for this itemSimmilar question was asked here:Why can't properties be readonly?But the question was asked 5 years ago, and the answer provided then was: Because they didn't think it thru. Is this still the case after 5 years?edit:Code example: <code>  public class GreetingClass{ public readonly string HelloText { get; set; }}",Why can't readonly be used with properties
WPF Converter throwing Object reference not set to an instance of an object in XAML at design time," I'm having an error at design time in my xaml: Object not set to an instance of an object.It's only happening at design time and runs perfectly in run time. The error is coming from my converter, the code which I have below. I thought it might be due to not checking if value was null or I had it returning null if it was null, but I changed both and it has made no difference. And ideas are appreciated. Thanks XAML: Stack Trace: <code>  public class CouponDataSplitterConverter : IValueConverter{ public object Convert(object value, Type targetType, object parameter, CultureInfo culture) { if (value != null) { List<SelectionArea> selectionAreasList = new List<SelectionArea>((ObservableCollection<SelectionArea>) value); foreach (var area in selectionAreasList) { if (area.AreaName.Contains(parameter.ToString())) { return area.SelectionRows; } } return selectionAreasList; } return """"; } public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture) { throw new NotImplementedException(); }} ItemsSource=""{Binding Coupon.SelectionAreas, ConverterParameter='Test Parameter', Converter={StaticResource CouponDataSplitterConverter} at App.UI.Converters.CouponDataSplitterConverter.Convert(Object value, Type targetType, Object parameter, CultureInfo culture)at System.Windows.Data.BindingExpression.TransferValue(Object newValue, Boolean isASubPropertyChange)at System.Windows.Data.BindingExpression.Activate(Object item)at System.Windows.Data.BindingExpression.AttachToContext(AttachAttempt attempt)at System.Windows.Data.BindingExpression.AttachOverride(DependencyObject target, DependencyProperty dp)at System.Windows.Data.BindingExpressionBase.OnAttach(DependencyObject d, DependencyProperty dp)at System.Windows.StyleHelper.GetInstanceValue(UncommonField`1 dataField, DependencyObject container, FrameworkElement feChild, FrameworkContentElement fceChild, Int32 childIndex, DependencyProperty dp, Int32 i, EffectiveValueEntry& entry)at System.Windows.StyleHelper.GetChildValueHelper(UncommonField`1 dataField, ItemStructList`1& valueLookupList, DependencyProperty dp, DependencyObject container, FrameworkObject child, Int32 childIndex, Boolean styleLookup, EffectiveValueEntry& entry, ValueLookupType& sourceType, FrameworkElementFactory templateRoot)at System.Windows.StyleHelper.GetChildValue(UncommonField`1 dataField, DependencyObject container, Int32 childIndex, FrameworkObject child, DependencyProperty dp, FrugalStructList`1& childRecordFromChildIndex, EffectiveValueEntry& entry, ValueLookupType& sourceType, FrameworkElementFactory templateRoot)at System.Windows.StyleHelper.GetValueFromTemplatedParent(DependencyObject container, Int32 childIndex, FrameworkObject child, DependencyProperty dp, FrugalStructList`1& childRecordFromChildIndex, FrameworkElementFactory templateRoot, EffectiveValueEntry& entry)at System.Windows.StyleHelper.ApplyTemplatedParentValue(DependencyObject container, FrameworkObject child, Int32 childIndex, FrugalStructList`1& childRecordFromChildIndex, DependencyProperty dp, FrameworkElementFactory templateRoot)at System.Windows.StyleHelper.InvalidatePropertiesOnTemplateNode(DependencyObject container, FrameworkObject child, Int32 childIndex, FrugalStructList`1& childRecordFromChildIndex, Boolean isDetach, FrameworkElementFactory templateRoot)at System.Windows.FrameworkTemplate.InvalidatePropertiesOnTemplate(DependencyObject container, Object currentObject)at System.Windows.FrameworkTemplate.HandleBeforeProperties(Object createdObject, DependencyObject& rootObject, DependencyObject container, FrameworkElement feContainer, INameScope nameScope)at System.Windows.FrameworkTemplate.<>c__DisplayClass0.<LoadOptimizedTemplateContent>b__5(Object sender, XamlObjectEventArgs args)at System.Xaml.XamlObjectWriter.OnBeforeProperties(Object value)at System.Xaml.XamlObjectWriter.Logic_CreateAndAssignToParentStart(ObjectWriterContext ctx)at System.Xaml.XamlObjectWriter.WriteStartMember(XamlMember property)at System.Xaml.XamlWriter.WriteNode(XamlReader reader)at System.Windows.FrameworkTemplate.LoadTemplateXaml(XamlReader templateReader, XamlObjectWriter currentWriter)at System.Windows.FrameworkTemplate.LoadTemplateXaml(XamlObjectWriter objectWriter)at System.Windows.FrameworkTemplate.LoadOptimizedTemplateContent(DependencyObject container, IComponentConnector componentConnector, IStyleConnector styleConnector, List`1 affectedChildren, UncommonField`1 templatedNonFeChildrenField)at System.Windows.FrameworkTemplate.LoadContent(DependencyObject container, List`1 affectedChildren)at System.Windows.StyleHelper.ApplyTemplateContent(UncommonField`1 dataField, DependencyObject container, FrameworkElementFactory templateRoot, Int32 lastChildIndex, HybridDictionary childIndexFromChildID, FrameworkTemplate frameworkTemplate)at System.Windows.FrameworkTemplate.ApplyTemplateContent(UncommonField`1 templateDataField, FrameworkElement container)at System.Windows.FrameworkElement.ApplyTemplate()at System.Windows.FrameworkElement.MeasureCore(Size availableSize)at System.Windows.UIElement.Measure(Size availableSize)at System.Windows.ContextLayoutManager.UpdateLayout()at System.Windows.UIElement.UpdateLayout()",WPF Converter throwing Object reference not set at design time
C# two class with common methods and properties, I have two classes.Class A: And Class B: They don't share the same interface or abstract class.A and B have two distinct hierarcy and I can't change that at the moment.I want to write a single procedute that works for A and B and use QQ and WW methods.Can I do that? Can you suggest any document I can study?Tanks <code>  class A() { public void QQ() {} public void WW() {}} class B() { public void QQ() {} public void WW() {}},two class with common methods and properties
Converting JSON to CSV in C#," I need to convert JSON data that I get from a REST API and convert them to CSV for some analytic. The problem is that the JSON data do not necessarily follow the same content, so I can't define a type for mapping. This has become a challenge that is taking too much of my time. I have already created some code, but of course it is not working as it throws exception on this line The error is: Additional information: Cannot deserialize the current JSON object (e.g. {""name"":""value""}) into type 'System.Collections.Generic.List`1[System.Object]' because the type requires a JSON array (e.g. [1,2,3]) to deserialize correctly. To fix this error either change the JSON to a JSON array (e.g. [1,2,3]) or change the deserialized type so that it is a normal .NET type (e.g. not a primitive type like integer, not a collection type like an array or List) that can be deserialized from a JSON object. JsonObjectAttribute can also be added to the type to force it to deserialize from a JSON object. Path 'data', line 2, position 10.please let me know what I can do to get this going. A sample of data would be like this, the fields of data can change very often, for example a new field can be added the next day, so I don't have the liberty to create a .Net class to map the data.  <code>  var data = JsonConvert.DeserializeObject<List<object>>(jsonData); { ""data"": [ { ""ID"": ""5367ab140026875f70677ab277501bfa"", ""name"": ""Happiness Initiatives - Flow of Communication/Process & Efficiency"", ""objCode"": ""PROJ"", ""percentComplete"": 100.0, ""plannedCompletionDate"": ""2014-08-22T17:00:00:000-0400"", ""plannedStartDate"": ""2014-05-05T09:00:00:000-0400"", ""priority"": 1, ""projectedCompletionDate"": ""2014-12-05T08:10:21:555-0500"", ""status"": ""CPL"" }, { ""ID"": ""555f452900c8b845238716dd033cf71b"", ""name"": ""UX Personalization Think Tank and Product Strategy"", ""objCode"": ""PROJ"", ""percentComplete"": 0.0, ""plannedCompletionDate"": ""2015-12-01T09:00:00:000-0500"", ""plannedStartDate"": ""2015-05-22T09:00:00:000-0400"", ""priority"": 1, ""projectedCompletionDate"": ""2016-01-04T09:00:00:000-0500"", ""status"": ""APR"" }, { ""ID"": ""528b92020051ab208aef09a4740b1fe9"", ""name"": ""SCL Health System - full Sitecore implementation (Task groups with SOW totals in Planned hours - do not bill time here)"", ""objCode"": ""PROJ"", ""percentComplete"": 100.0, ""plannedCompletionDate"": ""2016-04-08T17:00:00:000-0400"", ""plannedStartDate"": ""2013-11-04T09:00:00:000-0500"", ""priority"": 1, ""projectedCompletionDate"": ""2013-12-12T22:30:00:000-0500"", ""status"": ""CPL"" } ]}namespace BusinessLogic{ public class JsonToCsv { public string ToCsv(string jsonData, string datasetName) { var data = JsonConvert.DeserializeObject<List<object>>(jsonData); DataTable table = ToDataTable(data); StringBuilder result = new StringBuilder(); for (int i = 0; i < table.Columns.Count; i++) { result.Append(table.Columns[i].ColumnName); result.Append(i == table.Columns.Count - 1 ? ""\n"" : "",""); } foreach (DataRow row in table.Rows) { for (int i = 0; i < table.Columns.Count; i++) { result.Append(row[i].ToString()); result.Append(i == table.Columns.Count - 1 ? ""\n"" : "",""); } } return result.ToString().TrimEnd(new char[] {'\r', '\n'}); } private DataTable ToDataTable<T>( IList<T> data ) { PropertyDescriptorCollection props = TypeDescriptor.GetProperties(typeof(T)); DataTable table = new DataTable(); for (int i = 0 ; i < props.Count ; i++) { PropertyDescriptor prop = props[i]; table.Columns.Add(prop.Name, prop.PropertyType); } object[] values = new object[props.Count]; foreach (T item in data) { for (int i = 0 ; i < values.Length ; i++) { values[i] = props[i].GetValue(item); } table.Rows.Add(values); } return table; } }}",Error when deserializing JSON to Object
Can two identical strings can be two separate instances in C#?," In C#, strings are interned. That is, if I create the string foobar and use it a second time, C# will only have one instance of the string in memory and although I will have two references, they both will be pointing to the very same string instance. This is one reason why strings are and have to be immutable in C#.Now, my question is, whether it is possible to somehow create two identical strings so that they are not being interned, but that we end up with two different string instances in memory, with two different addresses, that contain the very same text?If so, how?And, is this something than can happen accidentally, or do you need to construct a scenario explicitly for this case?And, finally: Supposed there are two separate string instances in memory with the same value, are they equal (in terms of ==)? If so, how does == work? First compare by reference, then by value, or? <code> ",Can two identical strings be two separate instances in C#?
C# Selection sort with strings," Okay, I've been using this code to do a selection sort on integers: but now I want to run the same algorithm on a string list instead.How could that be accomplished? It feels really awkward and like you would need additional loops to compare multiple chars of different strings..?I tried a lot, but I couldn't come up with anything useful. :/ Note:I know, selection sort isn't very efficient. This is for learning purposes only. I'm not looking for alternative algorithms or classes that are already part of C#. ;) <code>  public void selectSort(int [] arr){ //pos_min is short for position of min int pos_min,temp; for (int i=0; i < arr.Length-1; i++) { pos_min = i; //set pos_min to the current index of array for (int j=i+1; j < arr.Length; j++) { if (arr[j] < arr[pos_min]) { //pos_min will keep track of the index that min is in, this is needed when a swap happens pos_min = j; } } //if pos_min no longer equals i than a smaller value must have been found, so a swap must occur if (pos_min != i) { temp = arr[i]; arr[i] = arr[pos_min]; arr[pos_min] = temp; } }}",Selection sort with strings
MS SQL conditional aggregate ;," I have a table that looks like this: And I need to perform a conditional aggregate that results in a new column. The conditions are as follows:If the value is negative then the aggregation starts and doesn't stop until the value is positive. Then nothing until the value is negative again... The result will look like this: This udf is as close as I have gotten: I am ok with an answer in c# if that would be easier but prefer SQL. The issue with the function I made is I need to be able to grab the results from the previous row to add to value when the value is positive.I was up all night on here searching for clues and no joy...EDIT: So think of these as CPI values for the year to be applied to your cellphone bill by your carrier... They are only going to increase your bill by the CPI, and never decrease it (if CPI is negative)... but they will offset the previous years negative CPI by the current years CPI if the Current year CPI is positive (or the sum results in a positive)...That may or may not help but that is the situation lol. <code>  Year Value ----------------- 2013 -0.0016 2014 -0.0001 2015 0.0025 2016 -0.0003 2017 0.0023 2018 0.0002 Year Value AggCol 2013 -0.0016 -0.0016 2014 -0.0001 -0.0017 2015 0.0025 0.0008 2016 -0.0003 -0.0003 2017 0.0023 0.002 2018 0.0002 0.0002 create function dbo.fn(@cYear numeric, @rate float)returns floatas begin declare @pYear numeric declare @return float set @pYear = @cYear - 1 set @return = (select case when Value < 0 and @rate > 0 then null when Value < 0 then Value + @rate else @rate end from Table1 where [year] = @pYear) return @returnend",SQL Server : conditional aggregate ;
convert a part of jsonresult to a list of c# objects," So, here I have JsonResult jr, it looks like this(the output is one single line, I format it here): Here is my object User: I'm trying to use Deserializing Partial JSON Fragments to map the json to my object: http://www.newtonsoft.com/json/help/html/SerializingJSONFragments.htmI followed the example, but I got an error: A first chance exception of type 'Newtonsoft.Json.JsonReaderException' occured in Newtonsoft.Json.dll.Many people online saying it's caused by bad json. I checked mine, didn't find anything wrong by myself. Below is my code: The first result output looks like this: Not sure why this exception happens, wondering how to fix it.. <code>  string jr = {""Results"": [ {""Code"":""DEMO"", ""Id"":""1285"", ""Office"":""9881"", ""Customers"": [ 2713, 94204 ], ""Account"":196, ""Appointments"": [ 14, 58 ], ""Role"":0, ""UserName"":""demo"", ""UserId"":3669, ""FirstName"":""Peter"", ""LastName"":""Pan"", ""Phones"": [ ""(888) 888-8888"" ], ""Fax"":null, ""Email"":""test@test.com"", ""SMS"":null, ""RecordStatus"":""1""}, {""Code"":""DEMO"", ""Id"":""9292"", ""Office"":""9881"", ""Customers"": [ 13, 904 ], ""Account"":196, ""Appointments"": [ 14, 58 ], ""Role"":0, ""UserName"":""berry"", ""UserId"":302, ""FirstName"":""Jimmy"", ""LastName"":""White"", ""Phones"": [ ""(888) 888-8888"" ], ""Email"":""test@test.com"", ""SMS"":null, ""RecordStatus"":""1""} ],""TotalResults"":2,""MilliSeconds"":4} public class User{ public string FirstName { get; set; } public string LastName { get; set; } public string Id { get; set; } public string Office { get; set; } public string Email { get; set; } public string Code { get; set; }} JObject response = JObject.Parse(jr);IList<JToken> results = response[""Results""].Children().ToList();IList<User> searchResults = new List<User>();foreach(JToken result in results){ System.Diagnostics.Debug.WriteLine(result); //just to check my json data. User searchResult = JsonConvert.DeserializeObject<User>(results.ToString()); //get exception on this line. searchResults.Add(searchResult);} { ""Code"":""DEMO"", ""Id"":""1285"", ""Office"":""9881"", ""Customers"": [ 2713, 94204 ], ""Account"":196, ""Appointments"": [ 14, 58 ], ""Role"":0, ""UserName"":""demo"", ""UserId"":3669, ""FirstName"":""Peter"", ""LastName"":""Pan"", ""Phones"": [ ""(888) 888-8888"" ], ""Fax"":null, ""Email"":""test@test.com"", ""SMS"":null, ""RecordStatus"":""1""}",A first chance exception of type 'Newtonsoft.Json.JsonReaderException' occurred while convert partial json to c# object
JsonReaderException when Deserializing Partial JSON Fragments," So, here I have JsonResult jr, it looks like this(the output is one single line, I format it here): Here is my object User: I'm trying to use Deserializing Partial JSON Fragments to map the json to my object: http://www.newtonsoft.com/json/help/html/SerializingJSONFragments.htmI followed the example, but I got an error: A first chance exception of type 'Newtonsoft.Json.JsonReaderException' occured in Newtonsoft.Json.dll.Many people online saying it's caused by bad json. I checked mine, didn't find anything wrong by myself. Below is my code: The first result output looks like this: Not sure why this exception happens, wondering how to fix it.. <code>  string jr = {""Results"": [ {""Code"":""DEMO"", ""Id"":""1285"", ""Office"":""9881"", ""Customers"": [ 2713, 94204 ], ""Account"":196, ""Appointments"": [ 14, 58 ], ""Role"":0, ""UserName"":""demo"", ""UserId"":3669, ""FirstName"":""Peter"", ""LastName"":""Pan"", ""Phones"": [ ""(888) 888-8888"" ], ""Fax"":null, ""Email"":""test@test.com"", ""SMS"":null, ""RecordStatus"":""1""}, {""Code"":""DEMO"", ""Id"":""9292"", ""Office"":""9881"", ""Customers"": [ 13, 904 ], ""Account"":196, ""Appointments"": [ 14, 58 ], ""Role"":0, ""UserName"":""berry"", ""UserId"":302, ""FirstName"":""Jimmy"", ""LastName"":""White"", ""Phones"": [ ""(888) 888-8888"" ], ""Email"":""test@test.com"", ""SMS"":null, ""RecordStatus"":""1""} ],""TotalResults"":2,""MilliSeconds"":4} public class User{ public string FirstName { get; set; } public string LastName { get; set; } public string Id { get; set; } public string Office { get; set; } public string Email { get; set; } public string Code { get; set; }} JObject response = JObject.Parse(jr);IList<JToken> results = response[""Results""].Children().ToList();IList<User> searchResults = new List<User>();foreach(JToken result in results){ System.Diagnostics.Debug.WriteLine(result); //just to check my json data. User searchResult = JsonConvert.DeserializeObject<User>(results.ToString()); //get exception on this line. searchResults.Add(searchResult);} { ""Code"":""DEMO"", ""Id"":""1285"", ""Office"":""9881"", ""Customers"": [ 2713, 94204 ], ""Account"":196, ""Appointments"": [ 14, 58 ], ""Role"":0, ""UserName"":""demo"", ""UserId"":3669, ""FirstName"":""Peter"", ""LastName"":""Pan"", ""Phones"": [ ""(888) 888-8888"" ], ""Fax"":null, ""Email"":""test@test.com"", ""SMS"":null, ""RecordStatus"":""1""}",A first chance exception of type 'Newtonsoft.Json.JsonReaderException' occurred while convert partial json to c# object
A first chance exception of type 'Newtonsoft.Json.JsonReaderException' occurred in Newtonsoft.Json.dll," So, here I have JsonResult jr, it looks like this(the output is one single line, I format it here): Here is my object User: I'm trying to use Deserializing Partial JSON Fragments to map the json to my object: http://www.newtonsoft.com/json/help/html/SerializingJSONFragments.htmI followed the example, but I got an error: A first chance exception of type 'Newtonsoft.Json.JsonReaderException' occured in Newtonsoft.Json.dll.Many people online saying it's caused by bad json. I checked mine, didn't find anything wrong by myself. Below is my code: The first result output looks like this: Not sure why this exception happens, wondering how to fix it.. <code>  string jr = {""Results"": [ {""Code"":""DEMO"", ""Id"":""1285"", ""Office"":""9881"", ""Customers"": [ 2713, 94204 ], ""Account"":196, ""Appointments"": [ 14, 58 ], ""Role"":0, ""UserName"":""demo"", ""UserId"":3669, ""FirstName"":""Peter"", ""LastName"":""Pan"", ""Phones"": [ ""(888) 888-8888"" ], ""Fax"":null, ""Email"":""test@test.com"", ""SMS"":null, ""RecordStatus"":""1""}, {""Code"":""DEMO"", ""Id"":""9292"", ""Office"":""9881"", ""Customers"": [ 13, 904 ], ""Account"":196, ""Appointments"": [ 14, 58 ], ""Role"":0, ""UserName"":""berry"", ""UserId"":302, ""FirstName"":""Jimmy"", ""LastName"":""White"", ""Phones"": [ ""(888) 888-8888"" ], ""Email"":""test@test.com"", ""SMS"":null, ""RecordStatus"":""1""} ],""TotalResults"":2,""MilliSeconds"":4} public class User{ public string FirstName { get; set; } public string LastName { get; set; } public string Id { get; set; } public string Office { get; set; } public string Email { get; set; } public string Code { get; set; }} JObject response = JObject.Parse(jr);IList<JToken> results = response[""Results""].Children().ToList();IList<User> searchResults = new List<User>();foreach(JToken result in results){ System.Diagnostics.Debug.WriteLine(result); //just to check my json data. User searchResult = JsonConvert.DeserializeObject<User>(results.ToString()); //get exception on this line. searchResults.Add(searchResult);} { ""Code"":""DEMO"", ""Id"":""1285"", ""Office"":""9881"", ""Customers"": [ 2713, 94204 ], ""Account"":196, ""Appointments"": [ 14, 58 ], ""Role"":0, ""UserName"":""demo"", ""UserId"":3669, ""FirstName"":""Peter"", ""LastName"":""Pan"", ""Phones"": [ ""(888) 888-8888"" ], ""Fax"":null, ""Email"":""test@test.com"", ""SMS"":null, ""RecordStatus"":""1""}",A first chance exception of type 'Newtonsoft.Json.JsonReaderException' occurred while convert partial json to c# object
Control.DisplayRectangle vs Control.ClientRectangle," I understand the concept of Client Rectangle regarding a Form/Control,yet I don't understand what the difference is betweenControl.ClientRectangle and Control.DisplayRectangle..After reading the MSDN pages for both of these properties, it is not clear when one of them would return a different value from the other..The MSDN page for .ClientRectangle says: The client area of a control is the bounds of the control, minus the nonclient elements, such as: Title Bar, Border, Scroll Bars, and Menu.That's pretty clear.Yet the MSDN page for .DisplayRectangle says: For the base control class, this is equal to the client rectangle. However, inheriting controls might want to change this if their client area differs from their display area.That's not so clear now..Where, in an inheriting control, would I want to make the .DisplayRectangle value different from the .ClientRectangle one?Control.ClientRectangle:https://msdn.microsoft.com/en-us/library/system.windows.forms.control.clientrectangle.aspxControl.DisplayRectangle:https://msdn.microsoft.com/en-us/library/system.windows.forms.control.displayrectangle.aspx <code> ",Control.ClientRectangle vs Control.DisplayRectangle
C# Private-ish method?," Within my projects I often want to have a method (or function if you prefer) that is private, however I also want to access it from ONE other class. Is this a possibility?To clarify, this method can be accessed from ClassA, its own class but not any other. <code> ",Private-ish method?
EF6 HasRequired WithMany partially working," So after going crazy for 3 hours and looking everywhere on the web I forced myself to ask here. I have been using Entity Framework for more than 5 years and I never had the kind of problem that I describe belowI have two POCO classes (edited): And in my ""BusinessUnit"" configuration I declare: The following works:Individually query the 2 entities through their DbSetsAccessing the N to 1 ""Company"" navigation property on my ""BusinessUnit"" retrieved entityThe following does not work:The 1 to N ""BusinessUnits"" navigation property on the retrieved ""Company"" entity is always NULL, even if using ""Include"" to do eager loadingWhat I am already doing that, according to EF guides and my experience, is correct:Lazy loading is enabled (the 1 navigation works indeed)Proxies are enabled (same as above)The ICollection is virtual so lazy loading is enabled for itThe ""HasRequired"" part of the mapping is working, I can access the ""Company"" proxy on the ""BusinessUnit"" entityI have tried changing the property setters to public, but still does not work/fix the problemThis has no apparent reason to misbehave. I am clearly missing something but I can't figure out what.Entitfy Framerowk version in use is 6.1.3 on .Net 4.6, installed through NuGet package. <code>  public class Company{ public virtual ICollection<BusinessUnit> BusinessUnits { get; protected set; } = new List<BusinessUnit>(); public int Id { get; protected set; }}public class BusinessUnit{ public virtual Company Company { get; protected set; } = new Company(); public int CompanyId { get; protected set; } public string Description { get; protected set; }} this .HasRequired(c => c.Company) .WithMany(c => c.BusinessUnits) .HasForeignKey(c => c.CompanyId);","Entity Framework 6 ""HasRequired"" and ""WithMany"" partially working - not working as expected"
"ASP.NET MVC, create View method with custom parameters"," Is there a way to create a View() method that would return multiple objects, for example, I would like to call it something like this: <code>  public class HomeController : Controller{ public ActionResult Index() { return View(CustomObject1 customObject1, CustomObject2 customObject2); }}","ASP.NET MVC, create View method that would return multiple objects to the view"
byte array to int C#," I am triyng to convert byte array into an int valuehowever I am getting an exception: ""Destination array is not long enough to copy all the items in the collection. Check array index and length.""the exception is on line: byte _length contain the value (0x00,0x09);here is my code: <code>  int length = BitConverter.ToInt32(bytes_length, 0); byte[] bytes_length = new byte[Value_of_length]; //copy the byte byte array to the correct length.Array.Copy(data, Place_of_length, bytes_length, 0,bytes_length.Lengthint length = BitConverter.ToInt32(bytes_length, 0);",Byte array to int C#
"Dapper giving ""Invalid attempt to call FieldCount when reader is closed."" when tying to use ""QueryMultiple"""," I have a wrapper method for Dapper.NET's QueryMultiple method. It successfully gets data from a Stored Procedure, which has 3 queries, all of them are SELECT queries. But after getting the data, I cannot use Read or ReadAsync to assign data to class variables. I'm attaching my code below. <code>  public Tuple<IEnumerable<T1>, IEnumerable<T2>, IEnumerable<T3>> QueryMultiple<T1, T2, T3>() { try { var data = MultiQuery(""[App].[USP_GetAllCategories]""); var category = data.Read<T1>(); var subcategory = data.Read<T2>(); var subSubcategory = data.Read<T3>(); return new Tuple<IEnumerable<T1>, IEnumerable<T2>, IEnumerable<T3>>( category, subcategory, subSubcategory); } catch (Exception) { return null; } } public SqlMapper.GridReader MultiQuery(string storedProcedureName) { using (var connection = LocalConnection()) { try { return connection.QueryMultiple( sql: storedProcedureName, commandType: CommandType.StoredProcedure); } catch (Exception) { return null; } finally { CloseConnection(connection); } } }","Dapper giving ""Invalid attempt to call FieldCount when reader is closed."" when trying to use ""QueryMultiple"""
Parse Json object in c# without using class," I have two string values in a JSON object. I want to call this method in same class and use the values without using class.I am using the following method: I need to use this data and result value in another method.I am getting the value like: My output is: How do I get the data and result value from this? <code>  public JsonResult Details(){ return Json(new { Data = ""DisplayName"", result = ""UniqueName"" });} var Details = JsonConvert.SerializeObject(Details()); { \""ContentEncoding\"": null, \""ContentType\"": null, \""Data\"": { \""Data\"": \""DisplayName\"", \""result\"": \""UniqueName\"" }, \""JsonRequestBehavior\"": 1, \""MaxJsonLength\"": null, \""RecursionLimit\"": null}",Parse JSON object in C# without using class
C# suffix behind value," I am new to C# and want to understand how values work. If I look at a normal integer value, it has 3 important parts in it: the type, name and value. But when I see a float value it confuses me a bit because of the suffix F. Now there are two types in it, and without the F suffix the value would be a double. But why is this happening when I can declare the double variable with The double as the first word should be enough, shouldn't it? The same goes for the decimal value with the suffix M: Then it starts really confusing me when it comes to the other suffixes: I used ulong in a test before and know that the u is for ""unsigned"" and lets the value be twice as high as normal. Then you get the U again as suffix and the L for literal as google said. As I understand it, ""literals"" are value types that contain numbers. But what I don't understand is, why does this ulong work even without the suffix? Then I tried something different to understand the importance of the suffix This didn't work because the value is too high for byte (254) and the suffix does not convert it to an long variable.Why isn't the first word (type) not enough for a declaration? The first word should be enough to tell the type. Is the best practice to always give the values a suffix? <code>  int testInt = 3; | | |Type Name Value float testFloat = 3.0F; | | | | Type Name Value Type double testDouble = 3.0D; decimal testDecimal = 3.0M; ulong bigOne = 2985825802805280508UL; ulong bigOne = 2985825802805280508; byte testLong = 12312UL;",C# suffix behind numeric literal
Cast a IQueryable type to interface in SQL to Entities," I have the following method in my generic class: This is the interface: Basically, TEntity is an Entity (POCO) class, that can implement IActivable if they have Active property. I want to the method to return all records that have Active value true. However, I have this error: Unable to cast the type 'WebTest.Models.Entities.Product' to type 'Data.IActivable'. LINQ to Entities only supports casting EDM primitive or enumeration types.I understand why this error occurs. But the articles on SO does not have any valid solution for my case. Is it achievable with Cast, or any other way? Note: I do not want to convert to IEnumerable, I want to keep IQueryable. <code>  // This is the class declarationpublic abstract class BaseService<TEntity, TKey> : IBaseService<TEntity, TKey> where TEntity : class, IEntity<TKey>// The Methodpublic IQueryable<TEntity> GetActive(){ if (typeof(IActivable).IsAssignableFrom(typeof(TEntity))) { return this.repository.Get().Cast<IActivable>() .Where(q => q.Active) .Cast<TEntity>(); } else { return this.Get(); }} public interface IActivable{ bool Active { get; set; }}",Cast a IQueryable type to interface in Linq to Entities
One weird linq issue," I am not good at Linq expression, today I am running into one weird issue as the below of inner join statement, While I traced the linq statement, I am confused of that Entity Framework will convert the linq statement to the below sql statment Do you know why the below SQL segment did automatically append?OR (([Extent1].[billNum] IS NULL) AND ([Extent2].[billNum] IS NULL)""I don't expect that the above automatically append, since it did slow down SQL performance. Any suggestions? <code>  var orders = (from q in dao.CurrentDBContext.New_OrderForm join d in dao.CurrentDBContext.New_OrderGoodsDetail on q.billNum equals d.billNum select new { q.billNum, q.orderSource, q.sourceOddNum d.PPT } SELECT [Extent1].[billNum] AS [billNum], [Extent1].[orderSource] AS [orderSource], [Extent1].[sourceOddNum] AS [sourceOddNum], [Extent2].[PPT] AS [PPT]FROM [dbo].[New_OrderForm] AS [Extent1]INNER JOIN [dbo].[New_OrderGoodsDetail] AS [Extent2] ON ([Extent1].[billNum] = [Extent2].[billNum]) OR (([Extent1].[billNum] IS NULL) AND ([Extent2].[billNum] IS NULL))",LINQ to SQL join generates SQL which joins on IS NULL
c# dynamic does not respect return type, I am pretty new to C# dynamic keyword. In one of my projects I tried to play with it and encountered some unexpected behavior. I managed to reproduce the situation with the following code: I get a RuntimeBinderException saying 'System.DateTime' does not contain a definition for 'Value'.So the variable date is treated as DateTime instead of DateTime?.It looks like dynamic somehow ignores the return type declaration.Should I avoid using var with dynamic? <code>  class Program{ static DateTime? DateOnly(DateTime? time) { return time.HasValue ? (System.DateTime?)time.Value.Date : null; } static void Main(string[] args) { dynamic now = System.DateTime.Now; var date = DateOnly(now); Console.WriteLine(date.Value); // error thrown here Console.Read(); }},Dynamic does not respect return type
Visual studio Javascript Default directory," I need some help with organizing js files in VS. So my problem is, that VS(MVC) put all js files by default into the script directory, but i also have js created by me, in a sub directory, like this:Now my problem is that when i open the scripts folder, the js files installed by NuGet take 2-3 screens in length, so i either have to open/close it every time, or scroll trought like there is no tomorrow. So my question is, is there any good solutions to it? Like moving all the files into a subdirectory, and change every bundles, and NuGet config, or should i create a separate script directory for my custom js files? Any good ideas? <code> ",Visual Studio javaScript default directory with NuGet
Specifing ON DELTE NO ACTION in Entity Framework 7?," In Entity Framework 7 when I am trying to apply a migration I get the error Introducing FOREIGN KEY constraint 'FK_ChangeOrder_User_CreatedByID' on table 'ChangeOrder' may cause cycles or multiple cascade paths. Specify ON DELETE NO ACTION or ON UPDATE NO ACTION, or modify other FOREIGN KEY constraints. Could not create constraint. See previous errors.I know in older versions of Entity Framework you would deal with this by adding to the DbContext but in EF7 modelBuilder does not seem to have a .Conventions to it and google is only returning older EF 4 though EF 6 results.How do I specific the ON DELETE NO ACTION constraint in Entity Framework 7?Edit:The answer provided by Oleg will apparently do it per Foreign Key but I would like to do it globally as it will much easier to use one line of code to declare this globally then have to specify code it out for every single one of the hundreds of relationships I will end up having.Edit 2: Code for Oleg  <code>  modelBuilder.Conventions.Remove<OneToManyCascadeDeleteConvention>(); public class ChangeOrder{ [DatabaseGenerated(DatabaseGeneratedOption.Identity)] public int ID { get; set; } public Int16? ApprovedByID { get; set; } public Byte ApprovalStatusID { get; set; } public Int16 AssignedToID { get; set; } public Int16 CreatedByID { get; set; } public Byte CurrentStatusID { get; set; } public DateTime? DateApproved { get; set; } public DateTime? EndDate { get; set; } public Byte ImpactID { get; set; } public Byte PriorityID { get; set; } public DateTime? StartDate { get; set; } public Byte TypeID { get; set; } [Required] public string Name { get; set; } [Required] public string ReasonForChange { get; set; } [ForeignKey(""ApprovedByID"")] public User ApprovedBy { get; set; } [ForeignKey(""ApprovalStatusID"")] public ChangeApprovalStatus ApprovalStatus { get; set; } [ForeignKey(""AssignedToID"")] public User AssignedTo { get; set; } [ForeignKey(""CreatedByID"")] public User CreatedBy { get; set; } [ForeignKey(""ImpactID"")] public ChangeImpact Impact { get; set; } [ForeignKey(""PriorityID"")] public ChangePriority Priority { get; set; } [ForeignKey(""TypeID"")] public ChangeType ChangeType { get; set; } [ForeignKey(""CurrentStatusID"")] public ChangeStatus CurrentStatus { get; set; }} public class JobSightDBContext : DbContext{ protected override void OnModelCreating(ModelBuilder modelbuilder) { base.OnModelCreating(modelbuilder); } DbSet<ChangeApprovalStatus> ChangeApprovalStatus { get; set; } DbSet<ChangeImpact> ChangeImapct { get; set; } DbSet<ChangeOrder> ChangeOrders { get; set; } DbSet<ChangePriority> ChangePriorities { get; set; } DbSet<ChangeStatus> ChangeStatus { get; set; } DbSet<ChangeType> ChangeTypes { get; set; } DbSet<User> Users { get; set; }}",Specifying ON DELETE NO ACTION in Entity Framework 7?
System.Xml.XPath extensions in Universal Windows Platform," According to MSDN, Extensions class in System.Xml.XPath should be available for Universal Windows Platform (Windows 10):https://msdn.microsoft.com/en-us/library/system.xml.xpath.extensions(v=vs.110).aspxHowever in default configuration not even the System.Xml.XPath namespace is available.The compiler and IntelliSense doesn't find it and even Resharper is unable to find the missing reference - although according to MSDN it should be in System.Xml.Linq.dll. (I can use LINQ without any problem)Also in the reference manager I was unable to find a fitting assembly.With some research I've found this official System.Xml.XPath package on NuGet:https://www.nuget.org/packages/System.Xml.XPath/However this does not contain the Extension class (and thus the XPathSelectElement extension method) either. (But at least the other XPath classes)Am I doing something wrong or this is an error in the documentation and none of these classes are available for Windows 10?Edit:Things I've already done:Visual Studio restartWindows restartTest on a different computer <code> ",System.Xml.XPath in Universal Windows Platform
C# Is there an await statement for threads?," Hi I would like to know if there is something similiar to the await statement, which is used with tasks, which I can implement with threads in c#?What I want to do is: Start Thread A, compute some data and put the result on variable x.After that variable x is transferred to another thread B and at the same timeThread A starts again to compute some data, while thread B starts another calculation with the result x.UPDATE: Ok there seems to be some confusion so I will be more accurate in my description:I use two sensors which produce data. The data needs to be retrieved in such a way that SensorA data is retrieved (which takes a long time) and immediately after that the data from SensorB must be retrieved in another Thread, while SensorA continues retrieving another data block. The problem is i cant queue the data of both sensors in the same queue, but I need to store the data of both sensor in ONE data structure/object. My idea was like that:Get Data from Sensor A in Thread A.Give result to Thread B and restart Thread A.While Thread A runs again Thread B gets Data from Sensor B and computes the data from Sensor A and BYou can assume that Thread A always needs a longer time than Thread B <code> ",Is there an await statement for threads?
"Hot to suppress ""An application is requesting access to a protected item"" popup"," I'm getting a pop-up when trying to use a certificate to decrypt data.I'm creating a self-signed certificate, and I'm using it to encrypt some data, but I'm getting the following confirmation pop-up when trying to decrypt the data:How can I programatically grant access to use the certificate?  <code> ","How to suppress ""An application is requesting access to a protected item"" popup"
Calls from windows server to a proxy server just stop working in browser and applications," Odd situation I have here and unfortunately I don't understand a lot about the Windows network side of things outside of netstat:So I have a proxy that I have configured in my browser (Firefox 42) and am running a simple application that loops through URLs to call them via that proxy. This proxy has credentials in order to use it and I know the proxy works. This is a Windows 7 box.So at some point during this process, the following happens:Browser calls just time out. It doesn't ask for credentials at all. (when the issue goes away, it starts to ask for credentials again).Calls in the application timeout no matter what the timeout is (7 seconds, 20 seconds, etc)I've confirmed the following:In my .net application, I 100% know I am closing every networkobject and am even aborted the request object after I read theresponse.After a certain amount of time, without any calls, theproblem goes away. When I use this proxy on another server, it100% works. So I know it's related to the server I am using and thatproxy IP address.I've looked at the resource manager and there aren't a lot of active TCP connections open. Although I don't know if that means anything.If I use another proxy, THAT proxy works. It's like it's IP specific, which is baffling me because it's just a web proxy object in the code.What would cause this? It usually happens after 4-7 calls with the proxy and releases the issue after 30-40 minutes.Edit 7:Also happens with AWS instances. Tried that approach. zzz...Edit 6:Doesn't go away with a server restart either. You can restart and 15 minutes later SAME proxy times out. Eventually works again.Edit 5:Wrote a similar test with Java and Python. Same result.Edit 4: This is how it works: Edit 3: These questions appears to be very similar: Http Post WebRequest getting timed outHttpWebRequest and GetResponse hangs after 1 request; other solutions doesn't work for meWebRequest.GetResponse locks up?HttpWebRequest times out on second callEdit 2: Looking at Wireshark, I'm seeing a TCP transmission in the info for the proxy affected. But doesn't that happen with other proxies at the same time? So is that coming from the proxy server itself? It doesn't make sense to me since I am not even getting a response back and the request isn't even being processed.Edit: Adding code for calls in code. This method is called in a while loop over and over again: <code>  Call to Proxy 1... Good!Call to Proxy 2... Good!Call to Proxy 3... Good!Call to Proxy 4... Good!Call to Proxy 1... Good!Call to Proxy 2... Good!Call to Proxy 3... Good!Call to Proxy 4... Good!Call to Proxy 1... Timeout...Call to Proxy 2... Good!Call to Proxy 3... Good!Call to Proxy 4... Good!Call to Proxy 1... Timeout...Call to Proxy 2... Good!Call to Proxy 3... Good!Call to Proxy 4... Good!Call to Proxy 1... Timeout...Call to Proxy 2... Good!Call to Proxy 3... Good!Call to Proxy 4... Good!Call to Proxy 1... Timeout...Call to Proxy 2... Good!Call to Proxy 3... Good!Call to Proxy 4... Good!Call to Proxy 1... Timeout...Call to Proxy 2... Good!Call to Proxy 3... Good!Call to Proxy 4... Good!Call to Proxy 1... Timeout...Call to Proxy 2... Good!Call to Proxy 3... Good!Call to Proxy 4... Good!Call to Proxy 1... Timeout...Call to Proxy 2... Good!Call to Proxy 3... Good!Call to Proxy 4... Good!Call to Proxy 1... Timeout...Call to Proxy 2... Good!Call to Proxy 3... Good!Call to Proxy 4... Good!Call to Proxy 1... Timeout...Call to Proxy 2... Good!Call to Proxy 3... Good!Call to Proxy 4... Good!Call to Proxy 1... Timeout...Call to Proxy 2... Good!Call to Proxy 3... Good!Call to Proxy 4... Good!Call to Proxy 1... Good!Call to Proxy 2... Good!Call to Proxy 3... Good!Call to Proxy 4... Good! String html = null; HttpWebRequest request = null; WebProxy webProxy = null; try { request = (HttpWebRequest)WebRequest.Create(url); webProxy = new WebProxy(proxyIP, proxyPort); webProxy.Credentials = new NetworkCredential(proxyUser, proxyPass); request.Proxy = webProxy; request.KeepAlive = false; request.Timeout = 5000; request.ReadWriteTimeout = 5000; request.Method = ""GET""; request.UserAgent = generateAgentString(); using (WebResponse resp = (WebResponse)request.GetResponse()) { using (Stream strm = resp.GetResponseStream()) { StreamReader reader = new StreamReader(strm, Encoding.UTF8); try { html = reader.ReadToEnd(); } catch { Console.WriteLine(""Failed""); html = null; } finally { strm.Flush(); reader.BaseStream.Dispose(); reader.Dispose(); strm.Dispose(); resp.Dispose(); } } } if (request != null) { request.Abort(); } } catch(Exception e) { Console.WriteLine(e); }",HttpWebRequests using WebProxy work and then fail after time
What will happened when we access the ' Length ' property of string in C#?," The sample code like this: If the Length property of string will be accessed more than once, is the first snippet code better than the second? Why?When we access the length of string in the way of hi.Length, the CLR will count the number of character in hi and return it or just return a 10 cause the Length property has been assigned a value of 10 at the time hi is initialized or something else?How about in Java? <code>  string hi = ""HelloWorld"";int length = hi.Length;Console.WriteLine(length);Console.WriteLine(length);...string hi = ""HelloWorld"";int length = hi.Length;Console.WriteLine(hi.Length);Console.WriteLine(hi.Length);...",What will happen when we access the ' Length ' property of string in C#?
ASP.NET MVC: Programaticaly set HTTP headers on static content," I have an ASP.NET application with a filter wired up in RegisterGlobalFilters that performs the following: Looking in Fiddler, I can see that views returned from the webserver include this header. Static files however, such as JavaScript do not include this header in the HTTP response.How do I get ASP.NET MVC to also apply this filter to any static files the web server returns? <code>  public class XFrameOptionsAttribute : ActionFilterAttribute{ public override void OnResultExecuting(System.Web.Mvc.ResultExecutingContext filterContext) { filterContext.HttpContext.Response.AddHeader(""X-FRAME-OPTIONS"", ""SAMEORIGIN""); }}",ASP.NET MVC: Programmatically set HTTP headers on static content
How to drop all tables and reset an SQL Azure Database," I have an ASP.NET MVC 5 project that works local and whenever I need to blow away the DB, I just open a new query on it, change the available database dropdown to master, then close the connection on my local db and run the query ""drop database [name]"". Then I build the project, go into the package manager console and run ""Update-Database"". This seems to rebuild a fresh local database and runs the seed method in my configuration.cs file.The problem is when I need to test things in a live environment so I can test API's and such better, I will do a deploy to an Azure Website and the accompanying Azure DB, which is nice and easy to do. I check off the ""Execute code first migrations"" in the publish wizard and most of the time it works and I can run and debug my live version. Sometimes I need to blow away that db and start from scratch again, but the only way I've really found to do it is to go into the Azure portal, delete the database, and then re-create it with the same name. This takes some time for Azure to process, so this is a slow testing cycle.Is there a quick way to just drop/reset a Azure SQL DB to it's fresh, empty, virgin state and then re-publish with ""execute code first migrations"" to have it re-create the tables and re-seed the data?I've seen some talk of creating an initial migration after I create the db, and then trying to use the Powershell to do some sort of roll-back to that initial state, but I haven't had luck getting it to work, and I want to delete all the data at the same time. Maybe I've just got the wrong syntax or haven't found a good enough tutorial. While I can run a query on the Azure DB to ""drop database [x]"" it literally kills the SQL Azure DB instance as you'd expect and you need to go back into the portal to recreate it. Sometimes that initial state is no good as the model has since been updated, so this may not be useful anyway.I feel like there should be some easier quicker way to test changes on a live environment as there all these great tools and shortcuts provided by MS, but did they just drop the ball here for this phase of development or am I missing something? <code> ",How to drop all tables and reset an Azure SQL Database
"How to: ""from the IIS Express install directory, run appcmd migrate config ""Default Web Site/"""," I'm learnig about Http modules and during last try I received: HTTP Error 500.22 - Internal Server Error An ASP.NET setting has been detected that does not apply in Integrated managed pipeline mode.One of the suggested solution is: from the IIS Express install directory, run appcmd migrate config ""Default Web Site/"".So from Command prompt I went to C\Program Files\IIS Express and then I executed: appcmd migrate config ""Default Web Site/""I received command ""Migrate"" is not supported on object config. How to do it properly? <code> ",How to fix HTTP Error 500.22 - Internal Server Error An ASP.NET setting has been detected that does not apply in Integrated managed pipeline mode
c# - OrderBy ignoring accented letters," I want a method like OrderBy() that always orders ignoring accented letters and to look at them like non-accented. I already tried to override OrderBy() but seems I can't do that because that is a static method.So now I want to create a custom lambda expression for OrderBy(), like this: However, I'm getting this error: Error 2 The type arguments for method 'System.Linq.Enumerable.OrderBy<TSource,TKey>(System.Collections.Generic.IEnumerable<TSource>, System.Func<TSource,TKey>, System.Collections.Generic.IComparer<TKey>)' cannot be inferred from the usage. Try specifying the type arguments explicitly.Seems it doesn't like StringComparer. How can I solve this? Note:I already tried to use RemoveDiacritics() from here but I don't know how to use that method in this case. So I tried to do something like this which seems nice too. <code>  public static IOrderedEnumerable<TSource> ToOrderBy<TSource, TKey>( this IEnumerable<TSource> source, Func<TSource, TKey> keySelector){ if(source == null) return null; var seenKeys = new HashSet<TKey>(); var culture = new CultureInfo(""pt-PT""); return source.OrderBy(element => seenKeys.Add(keySelector(element)), StringComparer.Create(culture, false));} ",OrderBy ignoring accented letters
".NET: How to synchronize TPL Tasks, by using Monitor / Mutex / Semaphore? Or should one use something else entirely?"," I'm trying to move some of my old projects from ThreadPool and standalone Thread to TPL Task, because it supports some very handy features, like continuations with Task.ContinueWith (and from C# 5 with async\await), better cancellation, exception capturing, and so on. I'd love to use them in my project. However I already see potential problems, mostly with synchronization.I've written some code which shows a Producer / Consumer problem, using a classic stand-alone Thread: In this example, ProduceNumber generates a sequence of increasing integers, while ConsumeNumber writes them to the Console. If producing runs faster, numbers will be queued for consumption later. If consumption runs faster, the consumer will wait until a number is available. All synchronization is done using Monitor and lock (internally also Monitor).When trying to 'TPL-ify' similar code, I already see a few issues I'm not sure how to go about. If I replace new Thread().Start() with Task.Run():TPL Task is an abstraction, which does not even guarantee that the code will run on a separate thread. In my example, if the producer control method runs synchronously, the infinite loop will cause the consumer to never even start. According to MSDN, providing a TaskCreationOptions.LongRunning parameter when running the task should hint the TaskScheduler to run the method appropriately, however I didn't find any way to ensure that it does. Supposedly TPL is smart enough to run tasks the way the programmer intended, but that just seems like a bit of magic to me. And I don't like magic in programming.If I understand how this works correctly, a TPL Task is not guaranteed to resume on the same thread as it started. If it does, in this case it would try to release a lock it doesn't own while the other thread holds the lock forever, resulting in a deadlock. I remember a while ago Eric Lippert writing that it's the reason why await is not allowed in a lock block. Going back to my example, I'm not even sure how to go about solving this issue.These are the few issues that crossed my mind, although there may be (probably are) more. How should I go about solving them?Also, this made me think, is using the classical approach of synchronizing via Monitor, Mutex or Semaphore even the right way to do TPL code? Perhaps I'm missing something that I should be using instead? <code>  class ThreadSynchronizationTest{ private int CurrentNumber { get; set; } private object Synchro { get; set; } private Queue<int> WaitingNumbers { get; set; } public void TestSynchronization() { Synchro = new object(); WaitingNumbers = new Queue<int>(); var producerThread = new Thread(RunProducer); var consumerThread = new Thread(RunConsumer); producerThread.Start(); consumerThread.Start(); producerThread.Join(); consumerThread.Join(); } private int ProduceNumber() { CurrentNumber++; // Long running method. Sleeping as an example Thread.Sleep(100); return CurrentNumber; } private void ConsumeNumber(int number) { Console.WriteLine(number); // Long running method. Sleeping as an example Thread.Sleep(100); } private void RunProducer() { while (true) { int producedNumber = ProduceNumber(); lock (Synchro) { WaitingNumbers.Enqueue(producedNumber); // Notify consumer about a new number Monitor.Pulse(Synchro); } } } private void RunConsumer() { while (true) { int numberToConsume; lock (Synchro) { // Ensure we met out wait condition while (WaitingNumbers.Count == 0) { // Wait for pulse Monitor.Wait(Synchro); } numberToConsume = WaitingNumbers.Dequeue(); } ConsumeNumber(numberToConsume); } }}","How to synchronize TPL Tasks, by using Monitor / Mutex / Semaphore? Or should one use something else entirely?"
How can i publish a website with smarterasp.net with csc.exe file," I am using Microsoft Visual Studio 2015, I built a simple website with a C# contact form.When I compile and run on localhost it works perfectly fine. However, when I try to publish it (on smarterasp.net) I am getting an error:[Win32Exception (0x80004005): Access is denied][ExternalException (0x80004005): Cannot execute a program. The command being executed was ""..\bin\roslyn\csc.exe""I have contacted smarterasp.net and they said they dont allow .exe files. I tried to delete csc.exe with ftp from the server but when I do that I am getting the error:Could not find file ""..\bin\roslyn\csc.exe"".How can I solve this issue with the csc.exe that is trying to get included in my project so I can get my this website published? <code> ",Problems publishing a website on smarterasp.net with csc.exe file included?
ASP.NET vNext Kestrel shutdown function in Startup.cs," Is there a shutdown function when using Microsoft.AspNet.Server.Kestrel? ASP.NET Core (formerly ASP.NET vNext) clearly has a Startup sequence, but no mention of shutdown sequence and how to handle clean closure. <code> ",Kestrel shutdown function in Startup.cs in ASP.NET Core
C# Can I use a normal foreach on a ConcurrentBag?," In a parallel section of my code, I save the results from each thread to a ConcurrentBag. However, when this is complete, I need to iterate through each of these results and run them through my evaluation algorithm. Will a normal foreach actually iterate through all members, or do I need special code? I've also thought about using something like a queue instead of a bag, but I don't know which would be best. The bag will typically contain only 20 or so items at the end of the parallel code.ie, will actually access and run foreach for ALL members of the ConcurrentBag? <code>  ConcurrentBag futures = new ConcurrentBag();foreach(move in futures){ // stuff}",Can I use a normal foreach on a ConcurrentBag?
java equivalent to c# ExpandoObject," C# code example: Java: ?Any ideas why java doesn't have support for this scenario? <code>  dynamic MyDynamic = new System.Dynamic.ExpandoObject();MyDynamic.A = ""A"";MyDynamic.B = ""B"";MyDynamic.C = ""C"";MyDynamic.Number = 12;MyDynamic.MyMethod = new Func<int>(() => { return 55; });Console.WriteLine(MyDynamic.MyMethod());",java equivalent to C# ExpandoObject
Generating the Shortest Regex Dynamically from an Source List of Strings," I have a bunch of SKUs (stock keeping units) that represent a series of strings that I'd like to create a single Regex to match for.So, for example, if I have SKUs: ...I'd like to automatically generate the Regex to recognize any one of the SKUs.I know that I could do simply do ""BATPAG003|BATTWLP03|BATTWLP04|BATTWSP04|SPIFATB01"", but list of SKUs can be quite lengthy and I'd like to compress the resulting Regex to look like ""BAT(PAG003|TW(LP0(3|4)|SP04))|SPIFATB01""So this is a combinatorics exercise. I want to generate the all of the possible Regex to match any of my input strings, with the view that the shortest is probably the best.I could, for example, produce any of these: Any of those would work, but the shortest is probably the one I'd choose.To start with I've tried to implement this function: This takes my source skus and results in a list of possible Regex's, but it's not working. This is the current output: It feels very close, and I think I'm slightly doing something wrong. <code>  var skus = new[] { ""BATPAG003"", ""BATTWLP03"", ""BATTWLP04"", ""BATTWSP04"", ""SPIFATB01"" }; BATPAG003|BATTWLP03|BATTWLP04|BATTWSP04|SPIFATB01BAT(PAG003|TW(LP0(3|4)|SP04))|SPIFATB01BAT(PAG003|TW(LP(03|04)|SP04))|SPIFATB01B(ATPAG003|ATTW(LP0(3|4)|ATSP04))|SPIFATB01 Func<IEnumerable<string>, IEnumerable<string>> regexify = null;regexify = xs => from n in Enumerable.Range(1, 10) let g = xs.ToArray().Where(s => !String.IsNullOrWhiteSpace(s)).GroupBy(x => new String(x.Take(n).ToArray()), x => new String(x.Skip(n).ToArray())) let parts = g.SelectMany(x => x.Count() > 1 ? regexify(x).Select(y => x.Key + ""("" + String.Join(""|"", y) + "")"") : new [] { x.Key + String.Join("""", x) }) let regex = String.Join(""|"", parts) orderby regex.Length select regex; BATPAG003|BATTWLP03|BATTWLP04|BATTWSP04|SPIFATB01 BATPAG003|BATTWLP03|BATTWLP04|BATTWSP04|SPIFATB01 BATPAG003|BATTWLP0(3|4)|BATTWLP0(3|4)|BATTWLP0(3|4)|BATTWLP0(3|4)|BATTWLP0(3|4)|BATTWLP0(3|4)|BATTWLP0(3|4)|BATTWLP0(3|4)|BATTWLP0(3|4)|BATTWLP0(3|4)|BATTWSP04|SPIFATB01 BATPAG003|BATTWLP(03|04)|BATTWLP(03|04)|BATTWLP(03|04)|BATTWLP(03|04)|BATTWLP(03|04)|BATTWLP(03|04)|BATTWLP(03|04)|BATTWLP(03|04)|BATTWLP(03|04)|BATTWLP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|BATTWSP04|SPIFATB01 BATPAG003|BATTWL(P03|P04)|BATTWL(P03|P04)|BATTWL(P03|P04)|BATTWL(P03|P04)|BATTWL(P03|P04)|BATTWL(P03|P04)|BATTWL(P03|P04)|BATTWL(P03|P04)|BATTWL(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|BATTWL(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|BATTWSP04|SPIFATB01 BATPAG003|BATTW(LP03|LP04|SP04)|BATTW(LP03|LP04|SP04)|BATTW(LP03|LP04|SP04)|BATTW(LP03|LP04|SP04)|BATTW(LP03|LP04|SP04)|BATTW(LP03|LP04|SP04)|BATTW(LP03|LP04|SP04)|BATTW(LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|SP04)|BATTW(LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|SP04)|BATTW(L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|L(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|SP04)|SPIFATB01 BATPAG003|BATT(WLP03|WLP04|WSP04)|BATT(WLP03|WLP04|WSP04)|BATT(WLP03|WLP04|WSP04)|BATT(WLP03|WLP04|WSP04)|BATT(WLP03|WLP04|WSP04)|BATT(WLP03|WLP04|WSP04)|BATT(WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WSP04)|BATT(WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|WSP04)|BATT(WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|WL(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|WSP04)|BATT(W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|SP04)|W(LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|SP04)|W(L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|L(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|SP04))|SPIFATB01 BAT(PAG003|TWLP03|TWLP04|TWSP04)|BAT(PAG003|TWLP03|TWLP04|TWSP04)|BAT(PAG003|TWLP03|TWLP04|TWSP04)|BAT(PAG003|TWLP03|TWLP04|TWSP04)|BAT(PAG003|TWLP03|TWLP04|TWSP04)|BAT(PAG003|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWSP04)|BAT(PAG003|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|TWSP04)|BAT(PAG003|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|TWL(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|TWSP04)|BAT(PAG003|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|SP04)|TW(LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|SP04)|TW(L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|L(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|SP04))|BAT(PAG003|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WSP04)|T(WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|WSP04)|T(WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|WL(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|WSP04)|T(W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|SP04)|W(LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|SP04)|W(L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|L(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|SP04)))|SPIFATB01 BA(TPAG003|TTWLP03|TTWLP04|TTWSP04)|BA(TPAG003|TTWLP03|TTWLP04|TTWSP04)|BA(TPAG003|TTWLP03|TTWLP04|TTWSP04)|BA(TPAG003|TTWLP03|TTWLP04|TTWSP04)|BA(TPAG003|TTWLP0(3|4)|TTWLP0(3|4)|TTWLP0(3|4)|TTWLP0(3|4)|TTWLP0(3|4)|TTWLP0(3|4)|TTWLP0(3|4)|TTWLP0(3|4)|TTWLP0(3|4)|TTWLP0(3|4)|TTWSP04)|BA(TPAG003|TTWLP(03|04)|TTWLP(03|04)|TTWLP(03|04)|TTWLP(03|04)|TTWLP(03|04)|TTWLP(03|04)|TTWLP(03|04)|TTWLP(03|04)|TTWLP(03|04)|TTWLP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|TTWSP04)|BA(TPAG003|TTWL(P03|P04)|TTWL(P03|P04)|TTWL(P03|P04)|TTWL(P03|P04)|TTWL(P03|P04)|TTWL(P03|P04)|TTWL(P03|P04)|TTWL(P03|P04)|TTWL(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|TTWL(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|TTWSP04)|BA(TPAG003|TTW(LP03|LP04|SP04)|TTW(LP03|LP04|SP04)|TTW(LP03|LP04|SP04)|TTW(LP03|LP04|SP04)|TTW(LP03|LP04|SP04)|TTW(LP03|LP04|SP04)|TTW(LP03|LP04|SP04)|TTW(LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|SP04)|TTW(LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|SP04)|TTW(L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|L(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|SP04))|BA(TPAG003|TT(WLP03|WLP04|WSP04)|TT(WLP03|WLP04|WSP04)|TT(WLP03|WLP04|WSP04)|TT(WLP03|WLP04|WSP04)|TT(WLP03|WLP04|WSP04)|TT(WLP03|WLP04|WSP04)|TT(WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WSP04)|TT(WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|WSP04)|TT(WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|WL(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|WSP04)|TT(W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|SP04)|W(LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|SP04)|W(L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|L(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|SP04)))|BA(T(PAG003|TWLP03|TWLP04|TWSP04)|T(PAG003|TWLP03|TWLP04|TWSP04)|T(PAG003|TWLP03|TWLP04|TWSP04)|T(PAG003|TWLP03|TWLP04|TWSP04)|T(PAG003|TWLP03|TWLP04|TWSP04)|T(PAG003|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWSP04)|T(PAG003|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|TWSP04)|T(PAG003|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|TWL(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|TWSP04)|T(PAG003|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|SP04)|TW(LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|SP04)|TW(L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|L(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|SP04))|T(PAG003|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WSP04)|T(WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|WSP04)|T(WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|WL(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|WSP04)|T(W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|SP04)|W(LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|SP04)|W(L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|L(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|SP04))))|SPIFATB01 B(ATPAG003|ATTWLP03|ATTWLP04|ATTWSP04)|B(ATPAG003|ATTWLP03|ATTWLP04|ATTWSP04)|B(ATPAG003|ATTWLP03|ATTWLP04|ATTWSP04)|B(ATPAG003|ATTWLP0(3|4)|ATTWLP0(3|4)|ATTWLP0(3|4)|ATTWLP0(3|4)|ATTWLP0(3|4)|ATTWLP0(3|4)|ATTWLP0(3|4)|ATTWLP0(3|4)|ATTWLP0(3|4)|ATTWLP0(3|4)|ATTWSP04)|B(ATPAG003|ATTWLP(03|04)|ATTWLP(03|04)|ATTWLP(03|04)|ATTWLP(03|04)|ATTWLP(03|04)|ATTWLP(03|04)|ATTWLP(03|04)|ATTWLP(03|04)|ATTWLP(03|04)|ATTWLP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|ATTWSP04)|B(ATPAG003|ATTWL(P03|P04)|ATTWL(P03|P04)|ATTWL(P03|P04)|ATTWL(P03|P04)|ATTWL(P03|P04)|ATTWL(P03|P04)|ATTWL(P03|P04)|ATTWL(P03|P04)|ATTWL(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|ATTWL(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|ATTWSP04)|B(ATPAG003|ATTW(LP03|LP04|SP04)|ATTW(LP03|LP04|SP04)|ATTW(LP03|LP04|SP04)|ATTW(LP03|LP04|SP04)|ATTW(LP03|LP04|SP04)|ATTW(LP03|LP04|SP04)|ATTW(LP03|LP04|SP04)|ATTW(LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|SP04)|ATTW(LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|SP04)|ATTW(L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|L(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|SP04))|B(ATPAG003|ATT(WLP03|WLP04|WSP04)|ATT(WLP03|WLP04|WSP04)|ATT(WLP03|WLP04|WSP04)|ATT(WLP03|WLP04|WSP04)|ATT(WLP03|WLP04|WSP04)|ATT(WLP03|WLP04|WSP04)|ATT(WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WSP04)|ATT(WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|WSP04)|ATT(WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|WL(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|WSP04)|ATT(W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|SP04)|W(LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|SP04)|W(L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|L(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|SP04)))|B(AT(PAG003|TWLP03|TWLP04|TWSP04)|AT(PAG003|TWLP03|TWLP04|TWSP04)|AT(PAG003|TWLP03|TWLP04|TWSP04)|AT(PAG003|TWLP03|TWLP04|TWSP04)|AT(PAG003|TWLP03|TWLP04|TWSP04)|AT(PAG003|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWSP04)|AT(PAG003|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|TWSP04)|AT(PAG003|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|TWL(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|TWSP04)|AT(PAG003|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|SP04)|TW(LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|SP04)|TW(L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|L(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|SP04))|AT(PAG003|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WSP04)|T(WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|WSP04)|T(WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|WL(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|WSP04)|T(W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|SP04)|W(LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|SP04)|W(L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|L(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|SP04))))|B(A(TPAG003|TTWLP03|TTWLP04|TTWSP04)|A(TPAG003|TTWLP03|TTWLP04|TTWSP04)|A(TPAG003|TTWLP03|TTWLP04|TTWSP04)|A(TPAG003|TTWLP03|TTWLP04|TTWSP04)|A(TPAG003|TTWLP0(3|4)|TTWLP0(3|4)|TTWLP0(3|4)|TTWLP0(3|4)|TTWLP0(3|4)|TTWLP0(3|4)|TTWLP0(3|4)|TTWLP0(3|4)|TTWLP0(3|4)|TTWLP0(3|4)|TTWSP04)|A(TPAG003|TTWLP(03|04)|TTWLP(03|04)|TTWLP(03|04)|TTWLP(03|04)|TTWLP(03|04)|TTWLP(03|04)|TTWLP(03|04)|TTWLP(03|04)|TTWLP(03|04)|TTWLP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|TTWSP04)|A(TPAG003|TTWL(P03|P04)|TTWL(P03|P04)|TTWL(P03|P04)|TTWL(P03|P04)|TTWL(P03|P04)|TTWL(P03|P04)|TTWL(P03|P04)|TTWL(P03|P04)|TTWL(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|TTWL(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|TTWSP04)|A(TPAG003|TTW(LP03|LP04|SP04)|TTW(LP03|LP04|SP04)|TTW(LP03|LP04|SP04)|TTW(LP03|LP04|SP04)|TTW(LP03|LP04|SP04)|TTW(LP03|LP04|SP04)|TTW(LP03|LP04|SP04)|TTW(LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|SP04)|TTW(LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|SP04)|TTW(L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|L(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|SP04))|A(TPAG003|TT(WLP03|WLP04|WSP04)|TT(WLP03|WLP04|WSP04)|TT(WLP03|WLP04|WSP04)|TT(WLP03|WLP04|WSP04)|TT(WLP03|WLP04|WSP04)|TT(WLP03|WLP04|WSP04)|TT(WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WSP04)|TT(WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|WSP04)|TT(WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|WL(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|WSP04)|TT(W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|SP04)|W(LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|SP04)|W(L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|L(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|SP04)))|A(T(PAG003|TWLP03|TWLP04|TWSP04)|T(PAG003|TWLP03|TWLP04|TWSP04)|T(PAG003|TWLP03|TWLP04|TWSP04)|T(PAG003|TWLP03|TWLP04|TWSP04)|T(PAG003|TWLP03|TWLP04|TWSP04)|T(PAG003|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWLP0(3|4)|TWSP04)|T(PAG003|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(03|04)|TWLP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|TWSP04)|T(PAG003|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P03|P04)|TWL(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|TWL(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|TWSP04)|T(PAG003|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP03|LP04|SP04)|TW(LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|SP04)|TW(LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|SP04)|TW(L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|L(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|SP04))|T(PAG003|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP03|WLP04|WSP04)|T(WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WLP0(3|4)|WSP04)|T(WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(03|04)|WLP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|WSP04)|T(WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P03|P04)|WL(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|WL(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|WSP04)|T(W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP03|LP04|SP04)|W(LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|LP0(3|4)|SP04)|W(LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(03|04)|LP(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4))|SP04)|W(L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P03|P04)|L(P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4)|P0(3|4))|L(P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(03|04)|P(0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)|0(3|4)))|SP04)))))|SPIFATB01 ",Generating the Shortest Regex Dynamically from a source List of Strings
Unable to check null for header value in request c#," I tried to get header value like below - If header value is null or not present it is throwing error - InvalidOperationExceptionThe null check for GetValues doesn't serve any value as it will never return null. If the header doesn't exist you will get an InvalidOperationExceptionAny trick to do so? <code>  IEnumerable<string> headerValues = request.Headers.GetValues(""MyCustomerId"");var id = headerValues.FirstOrDefault();",Unable to check null for header value in request
What is faster in finding element with property of maximum value in," Commonly, to find element with property of max value I do like this But is it good way from performance point of view? Maybe I should do something like this? <code>  var itemWithMaxPropValue = collection.OrderByDescending(x => x.Property).First(); var maxValOfProperty = collection.Max(x => x.Property);var itemWithMaxPropValue = collection .Where(x => x.Property == maxValueOfProperty).First();",What is faster in finding element with property of maximum value
Boost the Performance when Advancing to the Next Page Using .tif Images," I'm using WinForms. In my forms I have an open and a next button. My application opens .tif images into a picturebox. All the .tif images I work with have multiple pages. The next button is for going to the next page in the tif image. These .tif images I work with are very large.Example: Dimensions: 2600 x 3300 (.tif images)Question: How do I optimize the performance of my application? I've read/researched that I might have to load the images directly from the computers memory and some other methods. How would i go about this or is there a better way of coding this?That is the code I have so far, but my application lags a little when i go to the next page.Below is a link of a large TIFF image with multiple pages for testing. Linkhttp://www.filedropper.com/tiftestingdoc  <code>  FileStream _stream; Image _myImg; // setting the selected tiff string _fileName; private Image _Source = null; private int _TotalPages = 0; private int intCurrPage = 0; private void Clone_File() { // Reads file, then copys the file and loads it in the picture box as a temporary image doc. That way files are not locked in users directory when in use by this application. try { if (_myImg == null) { try { _fileName = Path.Combine(Path.GetTempPath(), Guid.NewGuid().ToString(""N"")); File.Copy(@""C:\Picture_Doc\The_Image.tif"", _fileName); _stream = new FileStream(_fileName, FileMode.Open, FileAccess.Read); this._Source = Image.FromStream(_stream); } catch (Exception ex) { } } _TotalPages = _Source.GetFrameCount(System.Drawing.Imaging.FrameDimension.Page); intCurrPage = 1; Display_Page(intCurrPage); }catch(Exception ex) { MessageBox.Show(ex.Message); } } private void Show_Processing_Image_Label() { Application.DoEvents(); } private void Display_Page(int PageNumber, RotateFlipType Change) { if (pictureBox1.Image != null && pictureBox1.Image != _Source) { //Release memory for old rotated image pictureBox1.Image.Dispose(); } // set the variable to null for easy Garbage Collection cleanup pictureBox1.Image = null; _Source.SelectActiveFrame(System.Drawing.Imaging.FrameDimension.Page, PageNumber - 1); pictureBox1.Image = new Bitmap(_Source); pictureBox1.Image.RotateFlip(Change); pictureBox1.Refresh(); //Refresh() Calls Invalidate and then Update to refresh synchronously. } private void Display_Page(int PageNumber) { Show_Processing_Image_Label(); //You could adjust the PictureBox size here for each frame OR adjust the image to fit the picturebox nicely if (pictureBox1.Image != _Source) { if (pictureBox1.Image != null) { //Release memory for old copy and set the variable to null for easy GC cleanup pictureBox1.Image.Dispose(); pictureBox1.Image = null; } pictureBox1.Image = _Source; } pictureBox1.Image.SelectActiveFrame(System.Drawing.Imaging.FrameDimension.Page, PageNumber - 1); pictureBox1.Refresh(); } private void Next_btn_Click(object sender, EventArgs e) { intCurrPage++; Display_Page(intCurrPage); } private void Open_btn_Click(object sender, EventArgs e) { if (_stream != null) { _myImg = null; //dispose the copy image } if (openFileDialog1.ShowDialog() == DialogResult.OK) { Clone_File(); } pictureBox1.Size = new Size(850, 1100); } ",Boost the performance when advancing to the next page using .tif images
ISNULL equialant in Linq," I have a table with a column IsActive now I want to get a list of records with given status but I want to deal with IsActive with null values as false.In SQL we used: How can in do this with LINQ?P.S.: I'm using LINQ to Entities so I can't use a function to cast the value like: The way I could think of is: But this solution seems to be very poor and I think there should be a better way. <code>  SELECT * FROM dbo.Table c WHERE ISNULL(IsActive, 0) = @act Table.Where(t=> Parse(t.IsActive) == act)bool Parse(bool? val){ return val == true? true : false;} Table.Where(t=> (t.IsActive==null || t.IsActive == false) && act == false) || (t.IsActive==true && act == true));",ISNULL equivalent in Linq
ISNULL equivalent inLinq," I have a table with a column IsActive now I want to get a list of records with given status but I want to deal with IsActive with null values as false.In SQL we used: How can in do this with LINQ?P.S.: I'm using LINQ to Entities so I can't use a function to cast the value like: The way I could think of is: But this solution seems to be very poor and I think there should be a better way. <code>  SELECT * FROM dbo.Table c WHERE ISNULL(IsActive, 0) = @act Table.Where(t=> Parse(t.IsActive) == act)bool Parse(bool? val){ return val == true? true : false;} Table.Where(t=> (t.IsActive==null || t.IsActive == false) && act == false) || (t.IsActive==true && act == true));",ISNULL equivalent in Linq
ASP.Net Core (MVC6) Repository Pattern Unexpectedly disposing," When I try to add a comment, I get the following error: ObjectDisposedException: Cannot access a disposed object.When the code runs the second line: Why is the context being disposed? If move the the TryAddComment method into the controller, it doesn't call Dispose early.Here is what my Controller and Repository class look like (simplified).CommentsController.cs: CommentRepository.cs: Edit:If I use a local CommentRepository, it works as expected. For example: Edit2:In Startup.cs, I registered the IcommentRepository as Scoped and works as expected. Originally it was Singleton. Why would a singleton cause this issue? Edit3:ApplicationDbContext.cs: <code>  m_context.Comments.Add(comment);m_context.SaveChanges(); public class CommentsController : Controller{ private ICommentRepository m_commentRepository; public CommentsController(ICommentRepository commentRepository) { m_commentRepository = commentRepository; } // POST: api/Comments [HttpPost] public async Task<IActionResult> PostComment([FromBody] CommentAddViewModel commentVM) { Comment comment = new Comment { ApplicationUserId = User.GetUserId(), PostId = commentVM.PostId, Text = commentVM.Text }; bool didAdd = m_commentRepository.TryAddComment(comment); if (!didAdd) { return new HttpStatusCodeResult(StatusCodes.Status409Conflict); } return CreatedAtRoute(""GetComment"", new { id = comment.CommentId }, comment); }} public class CommentRepository : ICommentRepository, IDisposable{ public ApplicationDbContext m_context; public CommentRepository(ApplicationDbContext context) { m_context = context; } public bool TryAddComment(Comment comment) { m_context.Comments.Add(comment); m_context.SaveChanges(); return true; } private bool disposed = false; protected virtual void Dispose(bool disposing) { if (!this.disposed) { if (disposing) { m_context.Dispose(); } } this.disposed = true; } public void Dispose() { Dispose(true); GC.SuppressFinalize(this); }} CommentRepository localCommentRepo = new CommentRepository(m_context); bool didAdd = localCommentRepo.TryAddComment(comment); services.AddSingleton<ICommentRepository, CommentRepository>(); //breaksservices.AddScoped<ICommentRepository, CommentRepository>(); //works public class ApplicationDbContext : IdentityDbContext<ApplicationUser>{ protected override void OnModelCreating(ModelBuilder builder) { base.OnModelCreating(builder); // Customize the ASP.NET Identity model and override the defaults if needed. // For example, you can rename the ASP.NET Identity table names and more. // Add your customizations after calling base.OnModelCreating(builder); } public DbSet<Post> Posts { get; set; } public DbSet<Comment> Comments { get; set; }}",ASP.Net Core MVC Repository Pattern Unexpectedly disposing
WPF: Pass parameter with a command into the viewmodel," I have trouble sending a parameter from my view to my viewmodel.View.xaml:In my view, I have the following: View.xaml.cs: MyViewModel.cs: Any suggestions to, how I can pass the InputId when I click the button to my viewmodel? <code>  <TextBox MinWidth=""70"" Name=""InputId""/><Button Command=""{Binding ButtonCommand}"" CommandParameter=""{Binding ElementName=InputId}"" Content=""Add""/> public MyView(){ InitializeComponent();}public MyView(MyViewModel viewModel) : this(){ DataContext = viewModel;} public class MyViewModel : BindableBase{ public ICommand ButtonCommand { get; private set; } public MyViewModel() { ButtonCommand = new DelegateCommand(ButtonClick); } private void ButtonClick() { //Read 'InputId' somehow. //But DelegateCommand does not allow the method to contain parameters. }}",Pass parameter with a command into the viewmodel
AutoMapper - How to use AfterMap to map properties on collection property," I have two entities and two DTOs. I am mapping the entities to the DTOs. Simplified versions of the DTOs look like: The Foo and Bar classes are: The MappingI am mapping this in a method as: AutoMapper already has mappings configured for Foo to FooDto and Bar to BarDto which are working fine. I need to update each BarDto in FooDto with a total using a service (the reasons for which are too lengthy to go into - suffice to say it needs to happen this way).What syntax do I need to use in AfterMap to map each Total property of BarDto using the _barTotalService.CalculateTotal(bar) method, where bar is the Bar in question? Note that the _barTotalService.CalculateTotal method takes an instance of Bar not BarDto. <code>  public class FooDto { // Other properties removed for clarity. public string Description { get; set; } public decimal Total { get; set; } public ICollection<BarDto> Bars { get; set; }}public class BarDto { // Other properties removed for clarity. public decimal Total { get; set; }} public class Foo { public ICollection<Bar> Bars { get; set; }}public class Bar { // Unimportant properties} public FooDto Map(IMapper mapper, Foo foo) { // _fooTotalService and _barTotalService injected elsewhere by DI. return mapper.Map<Foo, FooDto>(foo, opt => { opt.AfterMap((src, dest) => { dest.Total = _fooTotalService.GetTotal(src); dest.Bars.Total = ?????? // Needs to use _barTotalService.CalculateTotal(bar) }); });}",How to use AfterMap to map properties on collection property
"Which suffix of ""ToString()"" displays the float as is?"," I have a float of about 27 significant figures, when I call ""ToString()"" I get ""6.8248054E+26"", how do I get the exact normal value? <code> ",Which format string to displays the float as is?
Azure Mobile Apps Custom API .Net backend," I have had a MobileService running on Azure, and have decided to create a new service and migrate the code myself. The new service is of the new type called: Azure Mobile App Service.Currently I have Authentication working, and can do migrations/update-database. I am following the TodoItem example. I now want to create my own Custom API, which easily worked on MobileService, but I cannot get it working on Azure Mobile App :/I have followed these two links web-Api-routing and app-service-mobile-backend. And I now have the following:I have created a new controller: In the mobileApp.cs I have added the below code according to backend: Additionally I have installed the below package according to web-api-routing: and the call from the client: Debug shows, that it is the correct URL: {Method: POST, RequestUri: 'https://xxxxxxx.azurewebsites.net/api/Test/completeAll', Version: 1.1, Content: System.Net.Http.StringContent, Headers:{ X-ZUMO-FEATURES: AT X-ZUMO-INSTALLATION-ID: e9b359df-d15e-4119-a4ad-afe3031d8cd5 X-ZUMO-AUTH: xxxxxxxxxxx Accept: application/json User-Agent: ZUMO/2.0 User-Agent: (lang=Managed; os=Windows Store; os_version=--; arch=Neutral; version=2.0.31125.0) X-ZUMO-VERSION: ZUMO/2.0 (lang=Managed; os=Windows Store; os_version=--; arch=Neutral; version=2.0.31125.0) ZUMO-API-VERSION: 2.0.0 Content-Type: application/json; charset=utf-8 Content-Length: 3}}But keep getting: 404 (Not Found)Debug Message ""The request could not be completed. (Not Found)""What am I missing :/ ?UpdateI have tried expanding the code in The mobileApp.cs, with: based on app-service-backend, however still no access :/UpdateI used fiddler2 to access the endpoint through a browser and got the following results:Update AgainI have tried to create another minimal solution, but still get the same error. Are there any great tutorials that I can follow to achieve this functionality? The positive feeling is slowly evaporating . . . The question is also running now on msdn, I will update here if any information is shown there.UpdateTested Lindas comment, and I can in fact access the value converter: This I access using the both the post and get function: or But the code I pasted has no route so why can I access it using values? What would the path be to the original controller if did not use the route parameter?Extra InformationI have now created a support ticket with Microsoft and will update with additional information. . . Hopefully.Update Info from MSDN Forum: try MS_SkipVersionCheck Reading about the attribute here, it does not seem applicable. But I tried it. Still Not Found for my API but the original one is still working. So it did not have an impact on this issue. <code>  [MobileAppController]public class TestController : ApiController{ // GET api/Test [Route(""api/Test/completeAll"")] [HttpPost] public async Task<ihttpactionresult> completeAll(string info) { return Ok(info + info + info); }} HttpConfiguration config = new HttpConfiguration();config.MapHttpAttributeRoutes(); Microsoft.AspNet.WebApi.WebHost string t = await App.MobileService.InvokeApiAsync<string,string>(""Test/completeAll"", ""hej""); HttpConfiguration config = new HttpConfiguration(); new MobileAppConfiguration() .UseDefaultConfiguration().MapApiControllers() .ApplyTo(config); config.MapHttpAttributeRoutes(); app.UseWebApi(config); // Use the MobileAppController attribute for each ApiController you want to use // from your mobile clients [MobileAppController]public class ValuesController : ApiController{ // GET api/values public string Get() { MobileAppSettingsDictionary settings = this.Configuration.GetMobileAppSettingsProvider().GetMobileAppSettings(); ITraceWriter traceWriter = this.Configuration.Services.GetTraceWriter(); string host = settings.HostName ?? ""localhost""; string greeting = ""Hello from "" + host; traceWriter.Info(greeting); return greeting; } // POST api/values public string Post() { return ""Hello World!""; }} string t = await App.MobileService.InvokeApiAsync<string, string>(""values"", null, HttpMethod.Post, null); string t = await App.MobileService.InvokeApiAsync<string, string>(""values"", null, HttpMethod.Get, null);",Azure Custom Controller / API .Net backend
C# async await in Button_Click still freezes GUI," I would like to handle long running operation in separate thread and return control back to GUI thread ASAP using async/await pattern as follows: The problem is, it freezes GUI anyway for 3 seconds (it becomes unresponsive until Done! is displayed after 3 seconds). What am I doing wrong?EDIT:I am trying to replace the following logic: In actual project I have different long running logic than just Sleep, and it still freezes GUI, so replacing it with Task.Delay does not solve anything. Besides, I don't get why you should use yet another command for Sleep? How is this required by async/await design? <code>  private async void Button_Click(object sender, RoutedEventArgs e){ await Test(); txtResult.Text = ""Done!"";}private Task Test(){ Thread.Sleep(3000); return Task.FromResult(0);} private void Button_Click(object sender, RoutedEventArgs e){ var thread = new Thread(() => Test(Callback)); thread.Start();}private void Callback(){ Dispatcher.Invoke(() => txtResult.Text = ""Done!"");}private void Test(Action callback){ Thread.Sleep(3000); //long running operation, not necessarily pause callback();}",Using async await still freezes GUI
How to use Automapper to map objects by order defined in the class?," Given this two objects (I use a very different objects to clarify better): AutoMapper defines the projection that allows mapping properties with different name: This should work but:Is there any way to map directly the properties in the order they are defined in the class?: I am using AutoMapper 4.2.1 <code>  public class Car{ public string Brand {get;set;} public int Speed {get;set;}}public class Apple{ public string Variety {get;set;} public int Production {get;set;}} var config = new MapperConfiguration(cfg => { cfg.CreateMap<Car, Apple>() .ForMember(dest => dest.Variety, opt => opt.MapFrom( src => src.Brand)) .ForMember(dest => dest.Production, opt => opt.MapFrom(src => src.Speed)) }); Brand -> VarietySpeed -> Production",How to use AutoMapper to map objects by order defined in the class?
How to detect arrow keys in gtk# c#," I am trying to make a game in Monodevelop using Gtk#-C# where the player moves a character around with arrow keys. However, arrow key presses are not being registered.Is there a way to manually detect key presses, bypassing the default handler?Multiple searches on both Google and Stack Overflow have not given an answer as to how to detect arrow keys using Gtk-C#.This is the code I've been using to try and detect the arrow keys: And here is a basic program I made to attempt to figure out how to detect arrow keys: <code>  protected void Key_Press (object obj, KeyPressEventArgs args){ //Let the rest of the program know what keys were pressed. if (pressedKeys.Contains (args.Event.Key)) return; pressedKeys.Add (args.Event.Key, args.Event.Key);} public MainWindow (): base (Gtk.WindowType.Toplevel){ Build (); this.KeyPressEvent += new KeyPressEventHandler (KeyPress);}protected void KeyPress (object sender, KeyPressEventArgs args){ if (args.Event.Key == Gdk.Key.Up) return; label1.Text = args.Event.Key.ToString ();}",How to manually detect arrow keys in gtk# c#
How to delete a list of objects in EF6, OK I can delete a single item in EF6 like this: If this method changed from passing a single instance of MY_GROUPS to a List<MY_GROUPS> how would I handle the delete?Would there be a more efficient way then just doing a foreach and setting the state one at a time?UPDATE:I am already using a similar method as above utilizing the RemoveRange method.However I am getting an error: The object cannot be deleted because it was not found in the ObjectStateManager.I'm looking for the best way to attach a list of objects to the context so that I can delete them. <code>  public void DeleteUserGroup(MY_GROUPS ug){ using (var context = new MYConn()) { var entry = context.Entry(ug); if (entry.State == EntityState.Detached) { context.MY_GROUPS.Attach(ug); } context.MY_GROUPS.Remove(ug); context.SaveChanges(); }},How to delete a list of objects in EF6 when the object is detached from the context
json.net : how to avoid deserializing a string value to a float property," The JSON looks like this: And the class looks like this: And when using No exception is thrown, JSON.NET just converts the string value ""50"" into a float value 50.0.This question is raised in the the context of input-validation. I want to get an exception, because the JSON string does not comply to the contract (the x field should be a real float).And I don't want to use property annotations in the 'Test' class.Is there a JsonSerializerSettings which can be be used to avoid this? <code>  { ""x"": ""50""} public class Test{ public float? x { get; set; }} var test = JsonConvert.DeserializeObject<Test>(json);",Avoid deserializing a JSON string token to a numeric property
Force a child class to inicializate a variable," I have a class Foo that has a field _customObject that must be initialized. I also have a class Bar that inherits from Foo: I can not initialize the object _customObject in Foo because every child inherited contains a different child of CustomObject, so it must be initialized in every child class: Other people are going to implement new classes that inherit from Foo, so I was wondering if there is a way that an error in build time is shown, similar to when an abstract method is not implemented. If CustomObject is not initialized, a NullReferenceException will be thrown due to the use of the _customObject variable, ending in an application crash. <code>  public abstract class Foo{ protected CustomObject _customObject; public Foo() { // Do stuff } // Other methods that use _customObject}public class Bar : Foo{ // Constructor and other methods} public class Bar : Foo{ public Bar() { _customObject = new CustomObjectInherited1(); }}public class Baz : Foo{ public Baz() { _customObject = new CustomObjectInherited2(); }}",Force a child class to initialize a variable
ASP.Net MVC 6 when I want to update with appended columns it give error?," I have a model: My controller's Edit function: and I get the error below:The instance of entity type 'UNTest.ViewModels.VR' cannot be tracked because another instance of this type with the same key is already being tracked. For new entities consider using an IIdentityGenerator to generate unique key values. <code>  public class VR{ [Key] public int ID { get; set; } public string FullName { get; set; } public string CreatedBy { get; set; } public DateTime? Created { get; set; } public string ModifiedBy { get; set; } public DateTime? Modified { get; set; }} // POST: VRs/Edit/5 [HttpPost] [ValidateAntiForgeryToken] public IActionResult Edit(VR vR) { if (ModelState.IsValid) { var Result = (from c in _context.MyVR.Where(c => c.ID == vR.ID) select c).Single(); vR.Created = Result.Created; vR.CreatedBy = Result.CreatedBy; vR.ModifiedBy = User.Identity.Name; vR.Modified = DateTime.Now; _context.Update(vR); _context.SaveChanges(); return RedirectToAction(""Index""); } return View(vR); }",Update specific fields in Entity Framework
Does the .NET TypeSystem Initialize Differently on Different Threads?," This is a very strange problem that I have spent the day trying to track down. I am not sure if this is a bug, but it would be great to get some perspective and thoughts on why this is happening.I am using xUnit (2.0) to run my unit tests. The beauty of xUnit is that it automatically runs tests in parallel for you. The problem that I have found, however, is that Constructor.GetParameters appears to not be thread-safe when the ConstructorInfo is marked as being a thread-safe type. That is, if two threads reach Constructor.GetParameters at the same time, two results are produced, and subsequent calls to this method returns the second result that was created (regardless of the thread that calls it).I have created some code to demonstrate this unexpected behavior (I also have it hosted on GitHub if you would like to download and try the project locally).Here is the code: The two test classes ensure that two threads are created and run in parallel. Upon running these tests, you should get results that look like the following: (NOTE: I've added ""<---- Different!"" to denote the unexpected value. You will not see this in the test results.)As you can see, the result from the very first call to the GetParameters returns a different value than all subsequent calls.I have had my nose in .NET for quite a while now, but have never seen anything quite like this. Is this expected behavior? Is there a preferred/known way of initializing the .NET type system so that this does not happen?Finally, if anyone is interested, I ran into this problem while using xUnit with MEF 2, where a ParameterInfo being used as a key in a dictionary is not returning as equal to the ParameterInfo being passed in from a previously saved value. This, of course, results in unexpected behavior and resulting in failed tests when run concurrently.EDIT: After some good feedback from the answers, I have (hopefully) clarified this question and scenario. The core of the issue is ""Thread-Safety"" of a ""Thead-Safe"" type, and acquiring better knowledge of what exactly this means.ANSWER: This issue ended up being being due to several factors, one of which is due to me never-ending ignorance to multi-threaded scenarios, which it seems I am forever learning with no end for the foreseeable future. I am again appreciative of xUnit for being designed in such a way to learn this territory in such an effective manner.The other issue does appear to be inconsistencies with how the .NET type system initializes. With the TypeInfo/Type, you get the same type/reference/hashcode no matter which thread accesses it however many times. For MemberInfo/MethodInfo/ParameterInfo, this is not the case. Thread access beware.Finally, it seems I am not the only person with this confusion and this has indeed been recognized as an invalid assumption on a submitted issue to .NET Core's GitHub repository.So, problem solved, mostly. I would like to send my thanks and appreciation to all involved in dealing with my ignorance in this matter, and helping me learn (what I am finding is) this very complex problem space. <code>  public class OneClass{ readonly ITestOutputHelper output; public OneClass( ITestOutputHelper output ) { this.output = output; } [Fact] public void OutputHashCode() { Support.Add( typeof(SampleObject).GetTypeInfo() ); output.WriteLine( ""Initialized:"" ); Support.Output( output ); Support.Add( typeof(SampleObject).GetTypeInfo() ); output.WriteLine( ""After Initialized:"" ); Support.Output( output ); }}public class AnotherClass{ readonly ITestOutputHelper output; public AnotherClass( ITestOutputHelper output ) { this.output = output; } [Fact] public void OutputHashCode() { Support.Add( typeof(SampleObject).GetTypeInfo() ); output.WriteLine( ""Initialized:"" ); Support.Output( output ); Support.Add( typeof(SampleObject).GetTypeInfo() ); output.WriteLine( ""After Initialized:"" ); Support.Output( output ); }}public static class Support{ readonly static ICollection<int> Numbers = new List<int>(); public static void Add( TypeInfo info ) { var code = info.DeclaredConstructors.Single().GetParameters().Single().GetHashCode(); Numbers.Add( code ); } public static void Output( ITestOutputHelper output ) { foreach ( var number in Numbers.ToArray() ) { output.WriteLine( number.ToString() ); } }}public class SampleObject{ public SampleObject( object parameter ) {}} Initialized:39053774 <---- Different!45653674After Initialized:39053774 <---- Different!456536744565367445653674",Is ConstructorInfo.GetParameters Thread-Safe?
How to add `+` in Variable name in C#?," How do I declare a property or variable name as fg+ in C#? I am getting fg+ as a field in a response from JSON as ""fg+"": ""103308076644479658279"".I am deserializing it using a class. How do I read it from JSON? <code>  public string fg+ { get; set; }",How do I add `+` to a property name in C#?
How do I add `+` to a variable name in C#?," How do I declare a property or variable name as fg+ in C#? I am getting fg+ as a field in a response from JSON as ""fg+"": ""103308076644479658279"".I am deserializing it using a class. How do I read it from JSON? <code>  public string fg+ { get; set; }",How do I add `+` to a property name in C#?
Xamarin.forms Exception while loading assemblies Xamarin.Android.Support.v4," I am working on visual studio with Xamarin.Forms, I get the following Error: Exception while loading assemblies: System.IO.FileNotFoundException: Could not load assembly 'Xamarin.Android.Support.v4, Version=1.0.0.0, Culture=neutral, PublicKeyToken='. Perhaps it doesn't exist in the Mono for Android profile? File name: 'Xamarin.Android.Support.v4.dll' at Xamarin.Android.Tuner.DirectoryAssemblyResolver.Resolve(AssemblyNameReference reference, ReaderParameters parameters) at Xamarin.Android.Tasks.ResolveAssemblies.AddAssemblyReferences(ICollection`1 assemblies, AssemblyDefinition assembly, Boolean topLevel) at Xamarin.Android.Tasks.ResolveAssemblies.Execute() SportBook.DroidWhat should I do?  <code> ",Exception while loading assemblies Xamarin.Android.Support.v4
"C# WinForms - How can I display a loading control while a process is waiting for be finished. Im using ""LoadingCircle"" and a Thread"," I decided to use this third-party component to make a simple loading control in my windows form.http://www.codeproject.com/Articles/14841/How-to-write-a-loading-circle-animation-in-NETThis works fine when turns on and off changing the property ""Active"" to true or false in a single request (one per time). The problem is when a process is waiting to be served, and I pretend to Active the loadingControl before the process starts and turn off when I ""think"" that the process has to be finished. When I do it, the image loading is shown as a static image. (Without animation). I'm sorry for this question, I'm new in C#. But I think that I need to use Threads or something similar.So my general code is this: But Always the Loading shows as a static image without the animation. <code>  using [libraries here]...;namespace [namespace here]{ Public partial class Form1 : Form { public Form1() { InitializeComponent(); this.loadingCircle1.Visible = false; } private void button1_Click(object sender, EventArgs e) { Thread t = new Thread(new ThreadStart(showLoading)); this.loadingCircle1.Visible = true; t.Start(); //Import an Excel t.Abort(); } public void showLoading() { loadingCircle1.Active = true; loadingCircle1.RotationSpeed = 10; } }}",How can I display a loading control while a process is waiting for be finished?
C#: The console is outputting infinte ()," I'm using Visual Studio 2015 on Windows 10, I'm still a new coder, I've just started to learn C#, and while I was in the process, I discovered the Math class and was just having fun with it, till the console outputted: "" ""It's a Console ApplicationHere's the code: Why is this happening? using normal calculator the result is: 96985953901866.7 <code>  var k = Math.Sqrt((Math.Pow(Math.Exp(5), Math.E)));var l = Math.Sqrt((Math.Pow(Math.PI, Math.E)));Console.WriteLine(""number 1 : "" + k);Console.WriteLine(""number 2 : "" + l);Console.ReadKey();var subject = Math.Pow(Math.Sqrt((Math.Pow(Math.PI, Math.E))), Math.Sqrt((Math.Pow(Math.Exp(5), Math.E))));Console.WriteLine(k + "" ^ "" + l + "" = "" + subject);Console.ReadKey();//output :/*number 1 : 893.998923601492 number 2 : 4.73910938029088 893.998923601492 ^ 4.73910938029088 = */",C#: The console is outputting infinite ()
visual studio 2015 update 2 rc debugging context not available, Update 1:After Updating visual studio to version 2015 update 2 RTM the problem still exist.Update 2 patch available 4/12/2016 :Thanks to Patrick Nelson.a patch has been releasedYou can download the patch here.Update 3 8/16/2016:Latest vs 2015 update 3 KB3165756 has the same problem do not updateVersion Used: Latest stable version on visual studio update 2 rcDisabled all my extensions and also restarted my all settingsSteps to Reproduce:Install visual studio update 2 rcCreate new project using asp.net mvc core templateDebug the appExpected Behavior:To be able to debug the asp.net application Actual Behaviour:I can't explore context of variable inside visual studio editor or immediate windows i get the following error in immediate windowserror CS0103: The name 'myvariable' does not exist in the current context <code> ,visual studio 2015 update 2 RTM and RC debugging context not available
Printing a binary tree in Console," I have simple binary search tree where I can insert values like I want to display my tree within my console application. I have a btr.Print(); which displays my tree from left to right (6 is the root) - but I'm not happy with it. Question: Is there a better way to display this tree within a console application? Even a improvement of this Print() would help me. <code>  public class BNode{ public int item; public BNode right; public BNode left; public BNode(int item) { this.item = item; }}public class BTree{ private BNode _root; private int _count; private IComparer<int> _comparer = Comparer<int>.Default; public BTree() { _root = null; _count = 0; } public bool Add(int Item) { if (_root == null) { _root = new BNode(Item); _count++; return true; } else { return Add_Sub(_root, Item); } } private bool Add_Sub(BNode Node, int Item) { if (_comparer.Compare(Node.item, Item) < 0) { if (Node.right == null) { Node.right = new BNode(Item); _count++; return true; } else { return Add_Sub(Node.right, Item); } } else if (_comparer.Compare(Node.item, Item) > 0) { if (Node.left == null) { Node.left = new BNode(Item); _count++; return true; } else { return Add_Sub(Node.left, Item); } } else { return false; } } public void Print() { Print(_root, 4); } public void Print(BNode p, int padding) { if (p != null) { if (p.right != null) { Print(p.right, padding + 4); } if (padding > 0) { Console.Write("" "".PadLeft(padding)); } if (p.right != null) { Console.Write(""/\n""); Console.Write("" "".PadLeft(padding)); } Console.Write(p.item.ToString() + ""\n ""); if (p.left != null) { Console.Write("" "".PadLeft(padding) + ""\\\n""); Print(p.left, padding + 4); } } }} BTree btr = new BTree();btr.Add(6);btr.Add(2);btr.Add(3);btr.Add(11);btr.Add(30);btr.Add(9);btr.Add(13);btr.Add(18);",C# Display a Binary Search Tree in Console
Display a Binary Search Tree in Console," I have simple binary search tree where I can insert values like I want to display my tree within my console application. I have a btr.Print(); which displays my tree from left to right (6 is the root) - but I'm not happy with it. Question: Is there a better way to display this tree within a console application? Even a improvement of this Print() would help me. <code>  public class BNode{ public int item; public BNode right; public BNode left; public BNode(int item) { this.item = item; }}public class BTree{ private BNode _root; private int _count; private IComparer<int> _comparer = Comparer<int>.Default; public BTree() { _root = null; _count = 0; } public bool Add(int Item) { if (_root == null) { _root = new BNode(Item); _count++; return true; } else { return Add_Sub(_root, Item); } } private bool Add_Sub(BNode Node, int Item) { if (_comparer.Compare(Node.item, Item) < 0) { if (Node.right == null) { Node.right = new BNode(Item); _count++; return true; } else { return Add_Sub(Node.right, Item); } } else if (_comparer.Compare(Node.item, Item) > 0) { if (Node.left == null) { Node.left = new BNode(Item); _count++; return true; } else { return Add_Sub(Node.left, Item); } } else { return false; } } public void Print() { Print(_root, 4); } public void Print(BNode p, int padding) { if (p != null) { if (p.right != null) { Print(p.right, padding + 4); } if (padding > 0) { Console.Write("" "".PadLeft(padding)); } if (p.right != null) { Console.Write(""/\n""); Console.Write("" "".PadLeft(padding)); } Console.Write(p.item.ToString() + ""\n ""); if (p.left != null) { Console.Write("" "".PadLeft(padding) + ""\\\n""); Print(p.left, padding + 4); } } }} BTree btr = new BTree();btr.Add(6);btr.Add(2);btr.Add(3);btr.Add(11);btr.Add(30);btr.Add(9);btr.Add(13);btr.Add(18);",C# Display a Binary Search Tree in Console
Plotting 2D heat map in c#," I have a chart on which I want to plot a heat map; the only data I have is humidity and temperature, which represent a point in the chart. How do I get the rectangular type of heat map on the chart in c#?What I want is similar to picture below : What I really want is a rectangular region in the chart which is plotted in different color based on the point that i get from the list of points and form the colorful section in the chart. <code> ",Plotting 2D heat map
there is a better way to determinate the number of lines in a huge txt file(1-2 GB)?," I am trying to count all the lines in a txt file, I am using the StreamReader: Is there a more efficient way to count the number of lines?  <code>  public int countLines(string path){ var watch = System.Diagnostics.Stopwatch.StartNew(); int nlines=0; string line; StreamReader file = new StreamReader(path); while ((line = file.ReadLine()) != null) { nlines++; } watch.Stop(); var elapsedMs = watch.ElapsedMilliseconds; Console.Write(elapsedMs) // elapsedMs = 3520 --- Tested with a 1.2 Mill txt return nlines;}",Is there a better way to determine the number of lines in a large txt file(1-2 GB)?
Is there a better way to determinate the number of lines in a large txt file(1-2 GB)?," I am trying to count all the lines in a txt file, I am using the StreamReader: Is there a more efficient way to count the number of lines?  <code>  public int countLines(string path){ var watch = System.Diagnostics.Stopwatch.StartNew(); int nlines=0; string line; StreamReader file = new StreamReader(path); while ((line = file.ReadLine()) != null) { nlines++; } watch.Stop(); var elapsedMs = watch.ElapsedMilliseconds; Console.Write(elapsedMs) // elapsedMs = 3520 --- Tested with a 1.2 Mill txt return nlines;}",Is there a better way to determine the number of lines in a large txt file(1-2 GB)?
Using EntityFramework 6 w\ Fabric Service," I have an Actor that upon receiving a request from a WebAPI project, the Actor queries a table using Entity Framework 6. The DB was successfuly created using the ""Add-Migration"" .. ""Update-Database"" commands, and has the following connection string: When I run the fabric service and the actor tries to access the context, I get the following exception: A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 50 - Local Database Runtime error occurred. Cannot create an automatic instance. See the Windows Application event log for error details.)and the event viewer error is: Cannot get a local application data path. Most probably a user profile is not loaded. If LocalDB is executed under IIS, make sure that profile loading is enabled for the current user.I looked for a way to load the user's profile, but I only found solutions for IIS.Please help :) <code>  using (var context = new MetadataContext()){ var userStorageAccountId = context.Set<UsersToStorageAccounts>() .Find(userId).StorageAccountId;} @""Data Source=(LocalDB)\MSSQLLocalDB;AttachDbFileName=C:\Users\xxxx\Metadata.mdf;Connect Timeout=30;Initial Catalog=Metadata;Integrated Security=True;""",Using LocalDB with Service Fabric
Using EntityFramework 6 w\ Service Fabric," I have an Actor that upon receiving a request from a WebAPI project, the Actor queries a table using Entity Framework 6. The DB was successfuly created using the ""Add-Migration"" .. ""Update-Database"" commands, and has the following connection string: When I run the fabric service and the actor tries to access the context, I get the following exception: A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 50 - Local Database Runtime error occurred. Cannot create an automatic instance. See the Windows Application event log for error details.)and the event viewer error is: Cannot get a local application data path. Most probably a user profile is not loaded. If LocalDB is executed under IIS, make sure that profile loading is enabled for the current user.I looked for a way to load the user's profile, but I only found solutions for IIS.Please help :) <code>  using (var context = new MetadataContext()){ var userStorageAccountId = context.Set<UsersToStorageAccounts>() .Find(userId).StorageAccountId;} @""Data Source=(LocalDB)\MSSQLLocalDB;AttachDbFileName=C:\Users\xxxx\Metadata.mdf;Connect Timeout=30;Initial Catalog=Metadata;Integrated Security=True;""",Using LocalDB with Service Fabric
Using EntityFramework 6 with Service Fabric," I have an Actor that upon receiving a request from a WebAPI project, the Actor queries a table using Entity Framework 6. The DB was successfuly created using the ""Add-Migration"" .. ""Update-Database"" commands, and has the following connection string: When I run the fabric service and the actor tries to access the context, I get the following exception: A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 50 - Local Database Runtime error occurred. Cannot create an automatic instance. See the Windows Application event log for error details.)and the event viewer error is: Cannot get a local application data path. Most probably a user profile is not loaded. If LocalDB is executed under IIS, make sure that profile loading is enabled for the current user.I looked for a way to load the user's profile, but I only found solutions for IIS.Please help :) <code>  using (var context = new MetadataContext()){ var userStorageAccountId = context.Set<UsersToStorageAccounts>() .Find(userId).StorageAccountId;} @""Data Source=(LocalDB)\MSSQLLocalDB;AttachDbFileName=C:\Users\xxxx\Metadata.mdf;Connect Timeout=30;Initial Catalog=Metadata;Integrated Security=True;""",Using LocalDB with Service Fabric
Can not read turkish characters from text file to string array c#," I am trying to do some kind of sentence processing in turkish, and I am using text file for database. But I can not read turkish characters from text file, because of that I can not process the data correctly. Output: <code>  string[] Tempdatabase = File.ReadAllLines(@""C:\Users\dialogs.txt"");textBox1.Text = Tempdatabase[5];",Can not read turkish characters from text file to string array
arithmetic operation resulted in an overflow c#," I am getting the following error when unlocking a fileArithmetic operation resulted in an overflowSystem.IntPtr.ToInt32I suspect it is the following line to pBuffer.ToInt32() : I am unable to reproduce the error myself and the error is not displaying the correct line number. I am looking for a way to reproduce this or any feedback on the possible cause. Thanks UpdateI added the win32 apis code.The below answers look correct and the machine is 64 bit. But I am unable to reproduce it on the dev server despite the dev environment being 64 bit. Any ideas to reproduce the error? <code>  IntPtr iPtr = new IntPtr(pBuffer.ToInt32() + (i * Marshal.SizeOf(fi3))); public void Close(){ const int MAX_PREFERRED_LENGTH = -1; int readEntries; int totalEntries; IntPtr pBuffer = IntPtr.Zero; FILE_INFO_3 fi3 = new FILE_INFO_3(); int iStatus = NetFileEnum(this.HostName, this.HostPathToShare + this.FileNameFromShare, null, 3, ref pBuffer, MAX_PREFERRED_LENGTH, out readEntries, out totalEntries, pBuffer); if (iStatus == 0) { for (int i = 0; i < readEntries; i++) { IntPtr iPtr = new IntPtr(pBuffer.ToInt32() + (i * Marshal.SizeOf(fi3))); fi3 = (FILE_INFO_3)Marshal.PtrToStructure(iPtr, typeof(FILE_INFO_3)); NetFileClose(this.HostName, fi3.fi3_id); } } NetApiBufferFree(pBuffer);}[DllImport(""netapi32.dll"", SetLastError=true, CharSet = CharSet.Unicode)]static extern int NetFileClose( string servername, int id);[DllImport(""Netapi32.dll"", SetLastError=true)]static extern int NetApiBufferFree(IntPtr Buffer);[DllImport(""netapi32.dll"", SetLastError=true, CharSet=CharSet.Unicode)]static extern int NetFileEnum( string servername, string basepath, string username, int level, ref IntPtr bufptr, int prefmaxlen, out int entriesread, out int totalentries, IntPtr resume_handle);",Arithmetic operation resulted in an overflow c#
if statement always true with enum in comparaison c#," I'm having a problem. I'm making a utility to do procedural generated maps.I have a room pool and each rooms are disposed in a table of room. I have a method to connect all the room together which walk in the table and connect adjacent rooms. I have an enum which contains the type of rooms : In the connection method I check the neighborhood to see what kind of room it is : But when i check if the type of room is Start, it's always true and the connection is added. I don't know why this happens. where i set the TypeOfRoom : img3 <code>  public enum RoomType{ Default = 0, Building, Boss, Item, Standard, Start,} if (neighbourhood[2, 1] != null){ if (firstLevel.isOn) { if (neighbourhood[2,1].TypeOfRoom == RoomType.Start) { roomGrid[x, y].AddConnection(neighbourhood[2, 1], Location.RIGHT) } } else if (neighbourhood[2,1].TypeOfRoom != RoomType.Boss) roomGrid[x, y].AddConnection(neighbourhood[2, 1], Location.RIGHT);}",If statement always true with enum in comparison
Developing with Xamarin for Linux," Is it possible to develop and build Linux applications with Xamarin with the same code base?After a few years with Ubuntu, my main OS right now is Windows again. But it's not impossible that I could switch to Mac.Right now I have a bit of experience with Qt and no experience with Xamarin.With Qt you can develop on Windows, Linux, and Mac and for Windows, Linux, Mac, iOS, Android, Windows Mobile, ... They are pretty clear about that.Since Xamarin is free and open source now and I still don't have much experience in Qt, I'm considering trying out Xamarin for cross platform development instead of Qt.Not being able to release my software for Linux would be a deal breaker for me. Being able to develop on Linux would be nice, but is optional.But after all my Google research, I could only find information and people asking for support to develop on Linux and not for Linux.As far as I know, this shouldn't be a problem with Mono alone. But as far as I know Xamarin > Mono and I don't get everything in Mono I could get in Xamarin.I'm also not sure how well-supported Mono will be in the future. For me it looks like Xamarin is much more important for Microsoft than Mono itself.I'm not sure if it's even possible, since Xamarin is based on Mono, but is it possible that Microsoft will at some point decide not to support Mono with .NET compatibility in the same way as Xamarin, or even cancel Mono as standalone completely?So I'm looking for one single framework for all desktop and mobile platforms I can rely on, and I want to know if Xamarin and/or Mono and and/or Xamarin + Mono could be an alternative to Qt before I go deeper into any of those solutions. <code> ",Can you develop Linux applications with Xamarin?
Porting Windows 8 app to Windows 10 in Xamarin," I'm trying to run one of samples from this site. The problem is: projects were made for Windows 8. When I open solution in Visual Studio, it tells me that I need to install Windows 8 SDK to proceed.I'm using now Windows 10 SDK and I will no longer use SDK 8, so I'd rather not install this SDK and use new one intead. Can I somehow port this project to Windows 10 app?How it looks like right now: <code> ",Porting Xamarin Windows 8 app to Windows 10 SDK
Paging in ASP.Net; the number of pages never changes after filtering," The issue comes when you open a page with only one record. It fills the NavMenu with three links; ""First"", ""1"" and ""Last"".For some reason, when you run a search query that will return more than one page, it still only displays ""First"", ""1"" and ""Last"". Similarly, if you start with four pages and your subsequent search query only returns two records, it still shows ""First"", ""1"", ""2"", ""3"", ""4"" and ""Last"". So, for some reason, however many pages you start with, you'll always get. How can you reset the page counter/display?Here's my C# code-behind: And on the aspx page: I did try NavMenu.Items.Clear(), but it didn't like that because it also cleared out the hard-coded item on the aspx side. <code>  public void RunTheSearch(){ //Run the Stored Procedure first SqlConnection connection2 = new SqlConnection(strCon1); SqlCommand cmd2 = new SqlCommand(); cmd2.CommandType = CommandType.StoredProcedure; cmd2.CommandText = ""sp_Search""; cmd2.Connection = connection2; //--- A bunch of code that returns a dataset. Lengthy and unnecessary to my issue connection2.Open(); SqlDataAdapter adp = new SqlDataAdapter(cmd2); DataSet ds = new DataSet(); adp.Fill(ds, ""OLDPages""); //Pagination code so only a set number of records loads at a time. // Done to speed up the loading, since this list gets really long. PagedDataSource pds = new PagedDataSource(); pds.DataSource = ds.Tables[""OLDPages""].DefaultView; pds.AllowPaging = true; pds.PageSize = 10; //NavMenu.Items.Clear(); int currentPage; if (Request.QueryString[""page""] != null) { currentPage = Int32.Parse(Request.QueryString[""page""]); } else { currentPage = 1; } pds.CurrentPageIndex = currentPage - 1; //Label1.Text = ""Page "" + currentPage + "" of "" + pds.PageCount; if (!pds.IsFirstPage) { MenuItem itemMessage = NavMenu.FindItem(""First""); itemMessage.NavigateUrl = Request.CurrentExecutionFilePath + ""?page=1""; } AcctRepeater.DataSource = pds; AcctRepeater.DataBind(); CreatePagingControl(pds.PageCount, pds.CurrentPageIndex); // End of Pagination code connection2.Close();}private void CreatePagingControl(int PCount, int PIndex){ int PIndex2 = 0; int SCounter = PIndex + 1; int RowCount = PCount; //Allow the pagination menu to always start 5 less than the current page you're on if (PIndex < 5) { PIndex2 = 0; } else { PIndex2 = PIndex - 5; } // Show 10 total page numbers. You can increase or shrink that range by changing the 10 to whatever number you want for (int i = PIndex2; i < PIndex2 + 10 && i < PCount; i++) { NavMenu.Items.Add(new MenuItem { Text = (i + 1).ToString(), NavigateUrl = Request.CurrentExecutionFilePath + ""?page="" + (i + 1).ToString() }); // Now determine the selected item so the proper CSS can be applied foreach (MenuItem item in NavMenu.Items) { item.Selected = item.Text.Equals(SCounter.ToString()); } } NavMenu.Items.Add(new MenuItem { Text = ""Last"", NavigateUrl = Request.CurrentExecutionFilePath + ""?page="" + (PCount) });} <asp:Menu ID=""NavMenu"" runat=""server"" CssClass=""menu"" IncludeStyleBlock=""false"" Orientation=""Horizontal"" width=""703px"" BackColor=""#CC3300"" EnableViewState=""true""> <Items> <asp:MenuItem NavigateUrl=""~/Default.aspx"" Text=""First"" Selectable=""true"" /> </Items></asp:Menu>",Paging in ASP.NET; the number of pages never changes after filtering
Run NUnit tests in dotnet core," I am trying to run unit tests for my C# project with .NET Core.I am using a Docker container for the runtime.Dockerfile ""NUnit"" and ""NUnit.Runners"" have been added into project.json Run dotnet restore successfully with the following output I tried to run the tests with:dotnet nunitdotnet nunit-consoleBut it doesn't work.How am I going to call the runner? Or is there another unit testing framework that works with the current version of .NET Core? <code>  FROM microsoft/dotnet:0.0.1-alphaRUN mkdir /srcWORKDIR /srcADD . /srcRUN dotnet restore ""version"": ""1.0.0-*"",""compilationOptions"": { ""emitEntryPoint"": true},""dependencies"": { ""NETStandard.Library"": ""1.0.0-rc2-23811"", ""NUnit"": ""3.2.0"", ""NUnit.Runners"": ""3.2.0""},""frameworks"": { ""dnxcore50"": { }} ...log : Installing NUnit.ConsoleRunner 3.2.0.log : Installing NUnit.Extension.NUnitV2ResultWriter 3.2.0.log : Installing NUnit.Extension.NUnitV2Driver 3.2.0.log : Installing NUnit.Extension.VSProjectLoader 3.2.0.log : Installing NUnit.Extension.NUnitProjectLoader 3.2.0.log : Installing NUnit.Runners 3.2.0.info : Committing restore...log : Restore completed in 4352ms.",Run NUnit tests in .NET Core
why use C# Decimal ( int [ ] ) constructor," I am maintaining a C# desktop application, on windows 7, using Visual Studio 2013. And somewhere in the code there is the following line, that tries to create a 0.01 decimal value, using a Decimal(Int32[]) constructor: First question is, is it different from the following? If it is not different, why the developer has gone through the trouble of coding like that?I need to change this line in order to create dynamic values. Something like: Am I going to cause some unwanted behavior this way? <code>  decimal d = new decimal(new int[] { 1, 0, 0, 131072 }); decimal d = 0.01M; decimal d = (decimal) (1 / Math.Pow(10, digitNumber));",Why use decimal(int [ ]) constructor?
entity framework : map multiple classes to one table," I think this is possible in nhiberate, but my question is about Entity Framework.In my database model - which I cannot modify - I have redundant columns that I would like to store in different classes.Example : And then I would use them in some of my models : What I would like to achieve is having something like this I could use inheritance to solve this, but C# does not allow multiple inheritance. <code>  public class DateParams{ public DateTime CreationDate { get; set; } public DateTime ModificationDate { get; set; } // some methods}public class Localization{ public String EnglishLabel { get; set; } public String FrenchLabel { get; set; } // some methods} public class Account // Localization && DateParams { public int ID { get; set; } public String Name { get; set; } public Localization Localization { get; set; } public DateParams DateParams { get; set; }}public class Lead // DateParams only{ public int ID { get; set; } public String Name { get; set; } public DateParams DateParams { get; set; }} public class LocalizationMap : EntityTypeConfiguration<Localization>{ public LocalizationMap() { Property(e => e.EnglishLabel).HasColumnName(""en""); Property(e => e.FrenchLabel).HasColumnName(""fr""); }}public class AccountMap : EntityTypeConfiguration<Account>{ public AccountMap() { HasKey(x => x.ID); Property(e => e.Name).HasColumnName(""Name""); HasSubMapping(new LocalizationMap()); HasSubMapping(new DateParamsMap()); ToTable(""Account""); }}",Entity Framework : map multiple classes to one table
Send a HTTP POST request with C#," I'm try to Send Data Using the WebRequest with POST But my problem is No data has be streamed to the server. here the result  <code>  string user = textBox1.Text;string password = textBox2.Text; ASCIIEncoding encoding = new ASCIIEncoding();string postData = ""username"" + user + ""&password"" + password;byte[] data = encoding.GetBytes(postData);WebRequest request = WebRequest.Create(""http://localhost/s/test3.php"");request.Method = ""POST"";request.ContentType = ""application/x-www-form-urlencoded"";request.ContentLength = data.Length;Stream stream = request.GetRequestStream();stream.Write(data, 0, data.Length);stream.Close();WebResponse response = request.GetResponse();stream = response.GetResponseStream();StreamReader sr99 = new StreamReader(stream);MessageBox.Show(sr99.ReadToEnd());sr99.Close();stream.Close();",Send an HTTP POST request with C#
Created a program for sending Whatsapp message Using WhatsappAPI," https://github.com/mgp25/WARTI have downloaded the Password generator from this Link.But i am getting an error during Generation like this using my Number. I searched online and found this link http://www.17educations.com/whatsapp/how-to-get-whatsapp-id-and-password/Even then I am getting same error.I don't know why? Is there any other way to generate password? <code>  **Could not request code using either SMS or voice** `SMS: {""status"":""fail"",""reason"":""bad_token""}` `Voice: {""status"":""fail"",""reason"":""bad_token""}`",Error while generating a password for my number when using Password generated software for whatsapp API
Error while generating an password for my number when using Password generated software for whatsappAPI," https://github.com/mgp25/WARTI have downloaded the Password generator from this Link.But i am getting an error during Generation like this using my Number. I searched online and found this link http://www.17educations.com/whatsapp/how-to-get-whatsapp-id-and-password/Even then I am getting same error.I don't know why? Is there any other way to generate password? <code>  **Could not request code using either SMS or voice** `SMS: {""status"":""fail"",""reason"":""bad_token""}` `Voice: {""status"":""fail"",""reason"":""bad_token""}`",Error while generating a password for my number when using Password generated software for whatsapp API
Make UserControl editable via Designer," Short description: I have a UserControl with a DataGridView on it. I want to expose the DataGridView Columns collection to the designer, so I can change the columns on my User Control at design time.Question: Which designer attributes do I need for this?For those interested in the longer version: I have a UserControl with the following features:a DataGridView that shows ""pages"" of items from a collection.a NumericUpdown control to select which page to show.page up / page down buttons that will disable when the first / last page is shownChanges to the displayed items are visually markedButtons to save / discard the changes.This user control can work autonomic. It has one function to be used by the parent control:Show page (collection of items to show)The UserControl raises two events:Event Page changed (with a page number). Should result in loading a new pageEvent Save items (with the collection of changed items)I have to show this user control on several forms. The only difference is that the collection of DataGridViewColumn differs per form.I could add the columns programmatically, but it would be easier to create them using the designer. <code> ",Expose Columns property of a DataGridView in UserControl and make it editable via Designer
Adding all of the dates between two dates MVC/C#," I would like to get dates between two dates. Instead of expected 9 different dates, I get 875287 and run out of memory. What would be the problem with the code below?StartDate value is 01/04/2016 00:00:00EndDate value is 10/04/2016 00:00:00 <code>  var selectedDates = new List<DateTime?>();for (var date = StartDate; date <= EndDate; date.Value.AddDays(1)){ selectedDates.Add(date);}",How to get dates between two dates in C#
Adding all of the dates between two dates C#," I would like to get dates between two dates. Instead of expected 9 different dates, I get 875287 and run out of memory. What would be the problem with the code below?StartDate value is 01/04/2016 00:00:00EndDate value is 10/04/2016 00:00:00 <code>  var selectedDates = new List<DateTime?>();for (var date = StartDate; date <= EndDate; date.Value.AddDays(1)){ selectedDates.Add(date);}",How to get dates between two dates in C#
Storing all dates between two specific dates C#," I would like to get dates between two dates. Instead of expected 9 different dates, I get 875287 and run out of memory. What would be the problem with the code below?StartDate value is 01/04/2016 00:00:00EndDate value is 10/04/2016 00:00:00 <code>  var selectedDates = new List<DateTime?>();for (var date = StartDate; date <= EndDate; date.Value.AddDays(1)){ selectedDates.Add(date);}",How to get dates between two dates in C#
How to get all dates between two specific dates in C#," I would like to get dates between two dates. Instead of expected 9 different dates, I get 875287 and run out of memory. What would be the problem with the code below?StartDate value is 01/04/2016 00:00:00EndDate value is 10/04/2016 00:00:00 <code>  var selectedDates = new List<DateTime?>();for (var date = StartDate; date <= EndDate; date.Value.AddDays(1)){ selectedDates.Add(date);}",How to get dates between two dates in C#
Why does HttpClientHandler have both - Proxy and UseProxy properties?," Why is it that having a Proxy property would not be enough? If it is null, then don't use the proxy, if it is non-null, then use the provided proxy. <code> ",Why does HttpClientHandler have both Proxy and UseProxy properties?
how to add edit and delete," Hi I have used gridview to create a table. Is there a way to implement edit and delete. I have done it in PHP before. The method I would like to use is create two more columns in the table with edit and delete buttons on each row. Then when the buttons are click it passes the 'id' through the URL and able to edit or delete. Not really sure how to do this in asp.net webforms. Below is my code for the table. Thank you.  <code>  <asp:GridView ID=""GridView1"" runat=""server"" AutoGenerateColumns=""false""><Columns> <asp:BoundField HeaderText=""Surgery"" DataField=""surgery"" /> <asp:BoundField HeaderText=""PatientID"" DataField=""patientID"" /> <asp:BoundField HeaderText=""Location"" DataField=""location"" /></Columns> SqlCommand cmd = new SqlCommand(""select surgery, patientID, location from details"", conn);SqlDataAdapter sda = new SqlDataAdapter(cmd);DataTable dt = new DataTable();sda.Fill(dt);conn.Close();GridView1.DataSource = dt;GridView1.DataBind();",ASP.NET GridView: How to edit and delete data records
Can't get simple C# http listener to run / listen on port," (Please remove the close votes. IMHO this is a valid question, all necessary information is provided and yet tried to brief with all necessary information that's required to identify the possible source of the problem).I'm new to C# coming from the Java world. I try to get a simple http server to listen on a port (in my case 8080) on localhost.I followed this blog post https://codehosting.net/blog/BlogEngine/post/Simple-C-Web-Server.aspx.When I run the program, it says but I cannot reach http://localhost:8080/test/ via browser and netstat does not show port 8888 either.The port is also not blocked by firewall.Generally, I can run other servers, such as Tomcat, on that port, without a problem. The port is not blocked or used by other applications when I run the C# http server program.The code:Program.cs: WebServer.cs: =========== Update ===========I changed the port to 8080 all try-catch-blocks in the code areremoved I made sure that the port is not an issue: I tested to runTomcat servlet container on port 8080 and it works fine (of course,now it's stopped again) Port 8080 is not blocked by any otherapplication nor FirewallThis is what happens when I start the application:netstat -na | find ""8080"" I don't understand why nothing is listening at 0.0.0.0:8080 (as it is the case for example when I run Tomcat on port 8080), but on those other IPs.However, I cannot access the http server via localhost.....or when I try to access via those IP addresses, it's return a ""Bad Request"" response but not I also tried other ports such as 7777 or higher ones 10888. ipconfig: VirtualBox Adapters should not be a problem for that program, right?============= Just to compare it - running a Tomcat on port 8080 on my PC works fine, just like this: =========== Update 2 ===========I changed the hostname from localhost to the FQDN: This way it works. But why would it not work via localhost (such as Tomcat?)  <code>  static void Main(string[] args){ WebServer ws = new WebServer(); ws.Run(); Console.WriteLine(""A simple webserver. Press a key to quit.""); Console.ReadKey(); ws.Stop(); } namespace WebServerTest{ public class WebServer { private readonly HttpListener _listener = new HttpListener(); private readonly Func<HttpListenerRequest, string> _responderMethod; public WebServer() { if (!HttpListener.IsSupported) throw new NotSupportedException( ""Needs Windows XP SP2, Server 2003 or later.""); _listener.Prefixes.Add(""http://localhost:8080/test/""); _responderMethod = SendResponse; _listener.Start(); } public static string SendResponse(HttpListenerRequest request) { return string.Format(""<HTML><BODY>My web page.<br>{0}</BODY></HTML>"", DateTime.Now); } public void Run() { ThreadPool.QueueUserWorkItem((o) => { Console.WriteLine(""Webserver running...""); while (_listener.IsListening) { ThreadPool.QueueUserWorkItem((c) => { var ctx = c as HttpListenerContext; string rstr = _responderMethod(ctx.Request); byte[] buf = Encoding.UTF8.GetBytes(rstr); ctx.Response.ContentLength64 = buf.Length; ctx.Response.OutputStream.Write(buf, 0, buf.Length); }, _listener.GetContext()); } }); } public void Stop() { _listener.Stop(); _listener.Close(); } }} C:\>netstat -na | find ""8080"" TCP 10.10.1.177:8080 0.0.0.0:0 LISTENING TCP 192.168.56.1:8080 0.0.0.0:0 LISTENING TCP 192.168.99.1:8080 0.0.0.0:0 LISTENING C:\>ipconfigWindows-IP-KonfigurationEthernet-Adapter Ethernet: Verbindungsspezifisches DNS-Suffix: mycompany.ch Verbindungslokale IPv6-Adresse . : fe80::5511:3eb5:408a:2562%4 IPv4-Adresse . . . . . . . . . . : 10.10.1.177 Subnetzmaske . . . . . . . . . . : 255.255.254.0 Standardgateway . . . . . . . . . : 10.10.0.1Drahtlos-LAN-Adapter WiFi: Medienstatus. . . . . . . . . . . : Medium getrennt Verbindungsspezifisches DNS-Suffix: mycompany.chEthernet-Adapter VirtualBox Host-Only Network: Verbindungsspezifisches DNS-Suffix: Verbindungslokale IPv6-Adresse . : fe80::b4b0:6fc5:d0fc:1c77%24 IPv4-Adresse . . . . . . . . . . : 192.168.56.1 Subnetzmaske . . . . . . . . . . : 255.255.255.0 Standardgateway . . . . . . . . . :Ethernet-Adapter VirtualBox Host-Only Network #2: Verbindungsspezifisches DNS-Suffix: Verbindungslokale IPv6-Adresse . : fe80::b0e6:32c8:fc0a:af52%25 IPv4-Adresse . . . . . . . . . . : 192.168.99.1 Subnetzmaske . . . . . . . . . . : 255.255.255.0 Standardgateway . . . . . . . . . : C:\>netstat -na | find ""8080"" TCP 0.0.0.0:8080 0.0.0.0:0 LISTENING TCP [::]:8080 [::]:0 LISTENING _listener.Prefixes.Add(""http://devml-nb01-81.mycompany.ch:8080/test/""); C:\>ping localhostPing wird ausgefhrt fr devml-nb01-81.mycompany.ch [::1] mit 32 Bytes Daten:Antwort von ::1: Zeit<1msAntwort von ::1: Zeit<1msAntwort von ::1: Zeit<1msAntwort von ::1: Zeit<1msPing-Statistik fr ::1: Pakete: Gesendet = 4, Empfangen = 4, Verloren = 0 (0% Verlust),Ca. Zeitangaben in Millisek.: Minimum = 0ms, Maximum = 0ms, Mittelwert = 0ms","C# http listener not listening on localhost, only works with FQDN"
Can't get simple C# http listener to run / listen on port via localhost," (Please remove the close votes. IMHO this is a valid question, all necessary information is provided and yet tried to brief with all necessary information that's required to identify the possible source of the problem).I'm new to C# coming from the Java world. I try to get a simple http server to listen on a port (in my case 8080) on localhost.I followed this blog post https://codehosting.net/blog/BlogEngine/post/Simple-C-Web-Server.aspx.When I run the program, it says but I cannot reach http://localhost:8080/test/ via browser and netstat does not show port 8888 either.The port is also not blocked by firewall.Generally, I can run other servers, such as Tomcat, on that port, without a problem. The port is not blocked or used by other applications when I run the C# http server program.The code:Program.cs: WebServer.cs: =========== Update ===========I changed the port to 8080 all try-catch-blocks in the code areremoved I made sure that the port is not an issue: I tested to runTomcat servlet container on port 8080 and it works fine (of course,now it's stopped again) Port 8080 is not blocked by any otherapplication nor FirewallThis is what happens when I start the application:netstat -na | find ""8080"" I don't understand why nothing is listening at 0.0.0.0:8080 (as it is the case for example when I run Tomcat on port 8080), but on those other IPs.However, I cannot access the http server via localhost.....or when I try to access via those IP addresses, it's return a ""Bad Request"" response but not I also tried other ports such as 7777 or higher ones 10888. ipconfig: VirtualBox Adapters should not be a problem for that program, right?============= Just to compare it - running a Tomcat on port 8080 on my PC works fine, just like this: =========== Update 2 ===========I changed the hostname from localhost to the FQDN: This way it works. But why would it not work via localhost (such as Tomcat?)  <code>  static void Main(string[] args){ WebServer ws = new WebServer(); ws.Run(); Console.WriteLine(""A simple webserver. Press a key to quit.""); Console.ReadKey(); ws.Stop(); } namespace WebServerTest{ public class WebServer { private readonly HttpListener _listener = new HttpListener(); private readonly Func<HttpListenerRequest, string> _responderMethod; public WebServer() { if (!HttpListener.IsSupported) throw new NotSupportedException( ""Needs Windows XP SP2, Server 2003 or later.""); _listener.Prefixes.Add(""http://localhost:8080/test/""); _responderMethod = SendResponse; _listener.Start(); } public static string SendResponse(HttpListenerRequest request) { return string.Format(""<HTML><BODY>My web page.<br>{0}</BODY></HTML>"", DateTime.Now); } public void Run() { ThreadPool.QueueUserWorkItem((o) => { Console.WriteLine(""Webserver running...""); while (_listener.IsListening) { ThreadPool.QueueUserWorkItem((c) => { var ctx = c as HttpListenerContext; string rstr = _responderMethod(ctx.Request); byte[] buf = Encoding.UTF8.GetBytes(rstr); ctx.Response.ContentLength64 = buf.Length; ctx.Response.OutputStream.Write(buf, 0, buf.Length); }, _listener.GetContext()); } }); } public void Stop() { _listener.Stop(); _listener.Close(); } }} C:\>netstat -na | find ""8080"" TCP 10.10.1.177:8080 0.0.0.0:0 LISTENING TCP 192.168.56.1:8080 0.0.0.0:0 LISTENING TCP 192.168.99.1:8080 0.0.0.0:0 LISTENING C:\>ipconfigWindows-IP-KonfigurationEthernet-Adapter Ethernet: Verbindungsspezifisches DNS-Suffix: mycompany.ch Verbindungslokale IPv6-Adresse . : fe80::5511:3eb5:408a:2562%4 IPv4-Adresse . . . . . . . . . . : 10.10.1.177 Subnetzmaske . . . . . . . . . . : 255.255.254.0 Standardgateway . . . . . . . . . : 10.10.0.1Drahtlos-LAN-Adapter WiFi: Medienstatus. . . . . . . . . . . : Medium getrennt Verbindungsspezifisches DNS-Suffix: mycompany.chEthernet-Adapter VirtualBox Host-Only Network: Verbindungsspezifisches DNS-Suffix: Verbindungslokale IPv6-Adresse . : fe80::b4b0:6fc5:d0fc:1c77%24 IPv4-Adresse . . . . . . . . . . : 192.168.56.1 Subnetzmaske . . . . . . . . . . : 255.255.255.0 Standardgateway . . . . . . . . . :Ethernet-Adapter VirtualBox Host-Only Network #2: Verbindungsspezifisches DNS-Suffix: Verbindungslokale IPv6-Adresse . : fe80::b0e6:32c8:fc0a:af52%25 IPv4-Adresse . . . . . . . . . . : 192.168.99.1 Subnetzmaske . . . . . . . . . . : 255.255.255.0 Standardgateway . . . . . . . . . : C:\>netstat -na | find ""8080"" TCP 0.0.0.0:8080 0.0.0.0:0 LISTENING TCP [::]:8080 [::]:0 LISTENING _listener.Prefixes.Add(""http://devml-nb01-81.mycompany.ch:8080/test/""); C:\>ping localhostPing wird ausgefhrt fr devml-nb01-81.mycompany.ch [::1] mit 32 Bytes Daten:Antwort von ::1: Zeit<1msAntwort von ::1: Zeit<1msAntwort von ::1: Zeit<1msAntwort von ::1: Zeit<1msPing-Statistik fr ::1: Pakete: Gesendet = 4, Empfangen = 4, Verloren = 0 (0% Verlust),Ca. Zeitangaben in Millisek.: Minimum = 0ms, Maximum = 0ms, Mittelwert = 0ms","C# http listener not listening on localhost, only works with FQDN"
Asp.Net Web Api : json property names," I have LoginModel: and I have the Web api method And it's return 200 and body: But I want to get with lower first letter in property like And I have Json contract resolver for correcting How I can apply this? <code>  public class LoginModel : IData{ public string Email { get; set; } public string Password { get; set; }} public IHttpActionResult Login([FromBody] LoginModel model){ return this.Ok(model);} { Email: ""dfdf"", Password: ""dsfsdf""} { email: ""dfdf"", password: ""dsfsdf""} public class FirstLowerContractResolver : DefaultContractResolver{ protected override string ResolvePropertyName(string propertyName) { if (string.IsNullOrWhiteSpace(propertyName)) return string.Empty; return $""{char.ToLower(propertyName[0])}{propertyName.Substring(1)}""; }}",Return json with lower case first letter of property names
How to make a ReadOnlyCollection from a HashSet?, I have a private HashSet<string> which is the backing field of a read-only property which should return a read-only collection such that callers cannot modify the collection. So I tried to: This does not compile as ReadOnlyCollection accepts a IList<T> which is not implememted by HashSet<T>. Is there another wrapper I can use to save me from copy the items? For my purpose it is enough to just return something implementing ICollection<T> (instead of IList<T>) which is implemented by the HashSet<T>. <code>  public class MyClass{ private readonly HashSet<string> _referencedColumns; public ICollection<string> ReferencedColumns { get { return new ReadOnlyCollection<string>(_referencedColumns); } },How to make a ReadOnlyCollection from a HashSet without copying the elements?
DateTime.AddMinutes not working," I am using the settings plugin and I have it working to store some booleans. Now I wanted to add managing a DateTime object. I added the following to Settings.cs: Originally I used the following in my code: When I added some logging I had this: It prints out:1/1/0001 12:00:00 AM1/1/0001 12:30:00 AM1/1/0001 12:00:00 AMWhy does this behavior occur? <code>  private const string TimeRemainingKey = ""time_remaining"";private static readonly DateTime TimeRemainingDefault = DateTime.Now;public static DateTime TimeRemaining{ get { return AppSettings.GetValueOrDefault(TimeRemainingKey, TimeRemainingDefault); } set { AppSettings.AddOrUpdateValue(TimeRemainingKey, value); }} Settings.TimeRemaining = new DateTime().AddMinutes(30); DateTime dt = new DateTime();Debug.WriteLine(dt.ToString());dt = dt.AddMinutes(30);Debug.WriteLine(dt.ToString());Settings.TimeRemaining = dt;Debug.WriteLine(Settings.TimeRemaining.ToString());",Settings plugin not working properly with DateTime property
DateTime.AddMinutes not saved in Xamarin Settings Plugin," I am using the settings plugin and I have it working to store some booleans. Now I wanted to add managing a DateTime object. I added the following to Settings.cs: Originally I used the following in my code: When I added some logging I had this: It prints out:1/1/0001 12:00:00 AM1/1/0001 12:30:00 AM1/1/0001 12:00:00 AMWhy does this behavior occur? <code>  private const string TimeRemainingKey = ""time_remaining"";private static readonly DateTime TimeRemainingDefault = DateTime.Now;public static DateTime TimeRemaining{ get { return AppSettings.GetValueOrDefault(TimeRemainingKey, TimeRemainingDefault); } set { AppSettings.AddOrUpdateValue(TimeRemainingKey, value); }} Settings.TimeRemaining = new DateTime().AddMinutes(30); DateTime dt = new DateTime();Debug.WriteLine(dt.ToString());dt = dt.AddMinutes(30);Debug.WriteLine(dt.ToString());Settings.TimeRemaining = dt;Debug.WriteLine(Settings.TimeRemaining.ToString());",Settings plugin not working properly with DateTime property
c# switch with enum and multiple return," I have two objects: and And I would like to create a switch case where depending on the BugReportFilter choose my output will be a specific BugReportStaus.So I created a method CheckFilter The problem is that in the case of a BugReportFilter.Open option I should return BugReportStatus.OpenAssigned AND BugReportStatus.OpenUnassigned, is there a way to concat this two options in a single return ? <code>  public enum BugReportStatus{ OpenUnassigned = 0, OpenAssigned = 1, ClosedAsResolved = 2, ClosedAsRejected = 3} public enum BugReportFilter{ Open = 1, ... Closed = 4,} private BugReportStatus Checkfilter(BugReportFilter filter){ switch (filter) { case BugReportFilter.Open: return BugReportStatus.OpenAssigned; case BugReportFilter.Closed: return BugReportStatus.ClosedAsResolved; }};",Switch with enum and multiple return
How do read from .NET SslStream with a timeout?," I just need to read up to N bytes from a SslStream but if no byte has been received before a timeout, cancel, while leaving the stream in a valid state in order to try again later. (*)This can be done easily for non-SSL streams i.e. NetworkStream simply by using its ReadTimeout property which will make the stream throw an exception on timeout. Unfortunately this approach doesn't work on SslStream per the official docs: SslStream assumes that a timeout along with any other IOException when one is thrown from the inner stream will be treated as fatal by its caller. Reusing a SslStream instance after a timeout will return garbage. An application should Close the SslStream and throw an exception in these cases.[Updated 1] I tried a different approach like this: But this doesn't work if Wait() returned false: when calling ReadAsync() again later it throws an exception: Exception thrown: 'System.NotSupportedException' in System.dll Tests.exe Warning: 0 : Failed reading from socket: System.NotSupportedException: The BeginRead method cannot be called when another read operation is pending.[Update 2] I tried yet another approach to implement timeouts by calling Poll(timeout, ...READ) on the underlying TcpClient socket: if it returns true, then call Read() on the SSlStream, or if it returns false then we have a timeout. This doesn't work either: because SslStream presumably uses its own internal intermediary buffers, Poll() can return false even if there's data left to be read in the SslStream.[Update 3] Another possibility would be to write a custom Stream subclass that would sit between NetworkStream and SslStream and capture the timeout exception and return 0 bytes instead to SslStream. I'm not sure how to do this, and more importantly, I have no idea if returning a 0 bytes read to SslStream would still not corrupt it somehow.(*) The reason I'm trying to do this is that reading synchronously with a timeout from a non-secure or secure socket is the pattern I'm already using on iOS, OS X, Linux and Android for some cross-platform code. It works for non-secure sockets in .NET so the only case remaining is SslStream. <code>  task = stream->ReadAsync(buffer, 0, buffer->Length);if (task->Wait(timeout_ms)) { count = task->Result; ...}",How to (repeatedly) read from .NET SslStream with a timeout?
What has happened to `UseStaticFiles` in ASP.NET Core 1 vs. ASP.NET 5?," I can't find many proper Core 1.0 tutorials yet, but when I google the method name, I get umpteen examples that say to include in Startup.cs: Yet I get compile errors that neither method exists on app, which is type IApplicationBuilder. Are these calls no longer required, or named totally different, or set somewhere else? <code>  app.UseDefaultFiles();app.UseStaticFiles();",How to use UseStaticFiles in ASP.NET Core 1.0
How to use UseStaticFiles in ASP.NET Core 1," I can't find many proper Core 1.0 tutorials yet, but when I google the method name, I get umpteen examples that say to include in Startup.cs: Yet I get compile errors that neither method exists on app, which is type IApplicationBuilder. Are these calls no longer required, or named totally different, or set somewhere else? <code>  app.UseDefaultFiles();app.UseStaticFiles();",How to use UseStaticFiles in ASP.NET Core 1.0
My desktop application get hang on web api service call with async and await," I am getting lots of delay when saving data in database. I have one exe (Deskptop Application) which reads data from serial port and push that entry in to database through web API service but my application get hangs on this line: This exe is responsible to call my web API service method and save data to my database.This is my code: My web api method: I haven't work much on Windows application so I am not understanding why my application is hanging.Note: data will be continuously coming to my serial port so saving data through web service should not disturb _serialPort_DataReceived event. <code>  httpClient.PostAsync(""api/MyController/Save"", httpConent).Result; void _serialPort_DataReceived(object sender, SerialDataReceivedEventArgs e) { int dataLength = _serialPort.BytesToRead; byte[] data = new byte[dataLength]; int nbrDataRead = _serialPort.Read(data, 0, dataLength); if (nbrDataRead == 0) return; // Send data to whom ever interested if (NewSerialDataRecieved != null) { NewSerialDataRecieved(this, new SerialDataEventArgs(data)); } } void _spManager_NewSerialDataRecieved(object sender, SerialDataEventArgs e) { if (this.InvokeRequired) { // Using this.Invoke causes deadlock when closing serial port, and BeginInvoke is good practice anyway. //// Fired-off asynchronously; let the current thread continue. this.BeginInvoke(new EventHandler<SerialDataEventArgs>(_spManager_NewSerialDataRecieved), new object[] { sender, e }); return; } //data is converted to text string str = Encoding.ASCII.GetString(e.Data); if (!string.IsNullOrEmpty(str)) { CallWebservice(str) } }public void CallWebservice(string xmlRequest) { using (var httpClient = new HttpClient()) { httpClient.BaseAddress = new Uri(""WebService Url""); httpClient.DefaultRequestHeaders.Accept.Clear(); httpClient.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue(""application/json"")); StringContent httpConent = new StringContent(xmlRequest, Encoding.UTF8); HttpResponseMessage responseMessage = null; try { responseMessage = httpClient.PostAsync(""api/MyController/Save"", httpConent).Result; } catch (Exception ex) { if (responseMessage == null) { responseMessage = new HttpResponseMessage(); } responseMessage.StatusCode = HttpStatusCode.InternalServerError; responseMessage.ReasonPhrase = string.Format(""RestHttpClient.SendRequest failed: {0}"", ex); } } } public async Task<HttpResponseMessage> Save(HttpRequestMessage request) { var requestdata = request.Content.ReadAsStringAsync().Result;//extract Users Id's from this var users=context.User.Where(t => (t.Stats == userId1) || (t.Stats == userId2)).ToList(); var objUsersMapping= new UsersMapping(); objUsersMapping.Work1 = users[0].Work1; objUsersMapping.Work2 = users[1].Work1; await this.SaveUsersMapping(objUsersMapping); } public async Task<UsersMapping> SaveUsersMapping(UsersMapping objUsersMapping) { using (var context = new MyEntities()) { try { context.UsersMapping.Add(objUsersMapping); await context.SaveChangesAsync(); return objUsersMapping; } catch (Exception foExe) { return null; } } }",My desktop application hangs on web API service call with async and await
Adding DirectoryServices to ASPNET Core RC2," I am upgrading my ASP.NET Core RC1 application to RC2. I have some references to System.DirectoryServices and System.DirectoryServices.AccountManagement in some *.cs files so that I can query LDAP. But I have no idea how to add references to it in RC2 in the Project.json file. Everything that I try just gives me more errors. Any help is appreciated. <code>  { ""version"": ""1.0.0-*"", ""buildOptions"": { ""emitEntryPoint"": true, ""preserveCompilationContext"": true }, ""dependencies"": { ""Microsoft.NETCore.App"": { ""version"": ""1.0.0-rc2-3002702"", ""type"": ""default"" }, ""Microsoft.AspNetCore.Diagnostics"": ""1.0.0-rc2-final"", ""Microsoft.AspNetCore.Server.IISIntegration"": ""1.0.0-rc2-final"", ""Microsoft.AspNetCore.Mvc"": ""1.0.0-rc2-final"", ""Microsoft.AspNetCore.Mvc.TagHelpers"": ""1.0.0-rc2-final"", ""Microsoft.AspNetCore.Server.Kestrel"": ""1.0.0-rc2-final"", ""Microsoft.AspNetCore.StaticFiles"": ""1.0.0-rc2-final"", ""Microsoft.AspNetCore.Razor.Tools"": ""1.0.0-preview1-final"", ""Microsoft.EntityFrameworkCore"": ""1.0.0-rc2-final"", ""Microsoft.EntityFrameworkCore.SqlServer"": ""1.0.0-rc2-final"", ""Microsoft.EntityFrameworkCore.Tools"": ""1.0.0-preview1-final"", ""Microsoft.EntityFrameworkCore.SqlServer.Design"": ""1.0.0-rc2-final"", ""Microsoft.Extensions.Configuration.FileExtensions"": ""1.0.0-rc2-final"", ""Microsoft.Extensions.Configuration.EnvironmentVariables"": ""1.0.0-rc2-final"", ""Microsoft.Extensions.Configuration.Json"": ""1.0.0-rc2-final"", ""Newtonsoft.Json"": ""8.0.3"", ""Microsoft.Extensions.Logging"": ""1.0.0-rc2-final"", ""Microsoft.Extensions.Logging.Console"": ""1.0.0-rc2-final"", ""Microsoft.Extensions.Logging.Debug"": ""1.0.0-rc2-final"", ""Microsoft.VisualStudio.Web.BrowserLink.Loader"": ""14.0.0-rc2-final"", ""System.Linq"": ""4.0.1-beta-23516"", ""System.Linq.Queryable"": ""4.0.1-beta-23516"" }, ""tools"": { ""Microsoft.AspNetCore.Razor.Tools"": { ""version"": ""1.0.0-preview1-final"", ""imports"": ""portable-net45+win8+dnxcore50"" }, ""Microsoft.AspNetCore.Server.IISIntegration.Tools"": { ""version"": ""1.0.0-preview1-final"", ""imports"": ""portable-net45+win8+dnxcore50"" }, ""Microsoft.EntityFrameworkCore.Tools"": { ""version"": ""1.0.0-preview1-final"", ""imports"": [ ""portable-net45+win8+dnxcore50"", ""portable-net45+win8"" ] }, ""Microsoft.Extensions.SecretManager.Tools"": { ""version"": ""1.0.0-preview1-final"", ""imports"": ""portable-net45+win8+dnxcore50"" }, ""Microsoft.VisualStudio.Web.CodeGeneration.Tools"": { ""version"": ""1.0.0-preview1-final"", ""imports"": [ ""portable-net45+win8+dnxcore50"", ""portable-net45+win8"" ] } }, ""frameworks"": { ""netcoreapp1.0"": { ""imports"": [ ""dotnet5.6"", ""dnxcore50"", ""portable-net45+win8"" ] } }, ""publishOptions"": { ""include"": [ ""wwwroot"", ""Views"", ""appsettings.json"", ""web.config"" ] }, ""scripts"": { ""prepublish"": [ ""npm install"", ""bower install"", ""gulp clean"", ""gulp min"" ] }}",Working with DirectoryServices in ASP.NET Core
What is faster? Regex or EndsWith?," What would be faster? Or I'm currently using a really long if-statement list full with regexes to check if an int ends with doubles, triples, quads, quints, etc... so I would like to know which one is faster before I change all of it. <code>  public String Roll(){ Random rnd = new Random(); int roll = rnd.Next(1, 100000); if (Regex.IsMatch(roll.ToString(), @""(.)\1{1,}$"")) { return ""doubles""; } return ""none"";} public String Roll(){ Random rnd = new Random(); int roll = rnd.Next(1, 100000); if (roll.ToString().EndsWith(""11"") || roll.ToString().EndsWith(""22"") || roll.ToString().EndsWith(""33"") || roll.ToString().EndsWith(""44"") || roll.ToString().EndsWith(""55"") || roll.ToString().EndsWith(""66"") || roll.ToString().EndsWith(""77"") || roll.ToString().EndsWith(""88"") || roll.ToString().EndsWith(""99"") || roll.ToString().EndsWith(""00"")) { return ""doubles""; } return ""none"";}",Which one is faster? Regex or EndsWith?
Convert 12 hours to 24 hours in C#, How to convert 12-hour format to 24-hour format in DateTime format.I already tried to convert the DateTime to string (24-hour format) and convert it back to Datetime format but it is not working. <code> ,Convert 12-hour format to 24-hour format in C#
Convert from 12-hour format to 24-hour format in C#, How to convert 12-hour format to 24-hour format in DateTime format.I already tried to convert the DateTime to string (24-hour format) and convert it back to Datetime format but it is not working. <code> ,Convert 12-hour format to 24-hour format in C#
Jon skeet singleton implementation with static constructor," Jon Skeet suggests in his singleton implementation that if you require the maximum laziness for your singleton you should add a static constructor which will make the compiler mark the type as beforefieldinit.However, I did some testing and it seems that it's more lazy without the beforefieldinit.Code sample (the private constructor call outputs to console and verifies that the fields were initialized: When I call Singleton.Stub() the private constructor is not being hit, and when I uncomment the static constructor, the private constructor is always called.This is the only difference I could track made by the static constructor.In my attempts to understand what difference will the beforefieldinit do I've also read Skeet's answer in this post tried it with passing false to DoSomething() - with or without the static constructor the private constructor is not being called. <code>  public sealed class Singleton{ private static readonly Singleton instance = new Singleton(); public static string Stub() { return ""123""; } // Explicit static constructor to tell C# compiler // not to mark type as beforefieldinit //static Singleton() //{ //} private Singleton() { Console.WriteLine(""private ctor""); } public static Singleton Instance { get { return instance; } }} public static void DoSomething(bool which){ if (which) { var a = Singleton.Stub(); } else { Faketon.Stub(); }}",Singleton implementation laziness with static constructor
Using ADAL C# as Confidential User - Unauthorized," Refering to not answered Questions:401- Unauthorized authentication using REST API Dynamics CRM with Azure ADandDynamics CRM Online 2016 - Daemon / Server application Azure AD authentication error to Web ApiandDynamics CRM 2016 Online Rest API with client credentials OAuth flowI need a communication between an Web-Service in azure cloud and Dynamics CRM Online 2016 WITHOUT any loginscreen! The service will have a REST api which triggers CRUD operations on the CRM (also I will implement an authentification)I think this is called ""Confidential Client"" or ""Daemon Server"" or just ""Server-to-Server""I set up my Service properly in Azure AD (with ""delegate permission = access dynamics online as organization user"", there are no other options)I created a ASP.NET WEB API project in VS which created my WebService in Azure and also the entry ofr the ""Application"" within Azure AD of the CRMMy Code looks like this (pls ignore the EntityType and returnValue): When calling my GET request I get the 401 Unauthorized although I got and send the AccessToken.Any Ideas?EDIT:I also tried the code adviced in this blog (only source which seemed to solve the problem, didnt work either):https://samlman.wordpress.com/2015/06/04/getting-an-azure-access-token-for-a-web-application-entirely-in-code/With this code: <code>  public class WolfController : ApiController { private static readonly string Tenant = ""xxxxx.onmicrosoft.com""; private static readonly string ClientId = ""dxxx53-42xx-43bc-b14e-c1e84b62752d""; private static readonly string Password = ""j+t/DXjn4PMVAHSvZGd5sptGxxxxxxxxxr5Ki8KU=""; // client secret, valid for one or two years private static readonly string ResourceId = ""https://tenantname-naospreview.crm.dynamics.com/""; public static async Task<AuthenticationResult> AcquireAuthentificationToken() { AuthenticationContext authenticationContext = new AuthenticationContext(""https://login.windows.net/""+ Tenant); ClientCredential clientCredentials = new ClientCredential(ClientId, Password); return await authenticationContext.AcquireTokenAsync(ResourceId, clientCredentials); } // GET: just for calling the DataOperations-method via a GET, ignore the return public async Task<IEnumerable<Wolf>> Get() { AuthenticationResult result = await AcquireAuthentificationToken(); await DataOperations(result); return new Wolf[] { new Wolf() }; } private static async Task DataOperations(AuthenticationResult authResult) { using (HttpClient httpClient = new HttpClient()) { httpClient.BaseAddress = new Uri(ResourceId); httpClient.Timeout = new TimeSpan(0, 2, 0); //2 minutes httpClient.DefaultRequestHeaders.Add(""OData-MaxVersion"", ""4.0""); httpClient.DefaultRequestHeaders.Add(""OData-Version"", ""4.0""); httpClient.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue(""application/json"")); httpClient.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue(""Bearer"", authResult.AccessToken); Account account = new Account(); account.name = ""Test Account""; account.telephone1 = ""555-555""; string content = String.Empty; content = JsonConvert.SerializeObject(account, new JsonSerializerSettings() {DefaultValueHandling = DefaultValueHandling.Ignore}); //Create Entity///////////////////////////////////////////////////////////////////////////////////// HttpRequestMessage request = new HttpRequestMessage(HttpMethod.Post, ""api/data/v8.1/accounts""); request.Content = new StringContent(content); request.Content.Headers.ContentType = MediaTypeHeaderValue.Parse(""application/json""); HttpResponseMessage response = await httpClient.SendAsync(request); if (response.IsSuccessStatusCode) { Console.WriteLine(""Account '{0}' created."", account.name); } else //Getting Unauthorized here { throw new Exception(String.Format(""Failed to create account '{0}', reason is '{1}'."",account.name, response.ReasonPhrase)); } ... and more code public class WolfController : ApiController { private static readonly string Tenant = System.Configuration.ConfigurationManager.AppSettings[""ida:Tenant""]; private static readonly string TenantGuid = System.Configuration.ConfigurationManager.AppSettings[""ida:TenantGuid""]; private static readonly string ClientId = System.Configuration.ConfigurationManager.AppSettings[""ida:ClientID""]; private static readonly string Password = System.Configuration.ConfigurationManager.AppSettings[""ida:Password""]; // client secret, valid for one or two years private static readonly string ResourceId = System.Configuration.ConfigurationManager.AppSettings[""ida:ResourceID""]; // GET: api/Wolf public async Task<IEnumerable<Wolf>> Get() { AuthenticationResponse authenticationResponse = await GetAuthenticationResponse(); String result = await DoSomeDataOperations(authenticationResponse); return new Wolf[] { new Wolf() { Id = 1, Name = result } }; } private static async Task<AuthenticationResponse> GetAuthenticationResponse() { //https://samlman.wordpress.com/2015/06/04/getting-an-azure-access-token-for-a-web-application-entirely-in-code/ //create the collection of values to send to the POST List<KeyValuePair<string, string>> vals = new List<KeyValuePair<string, string>>(); vals.Add(new KeyValuePair<string, string>(""grant_type"", ""client_credentials"")); vals.Add(new KeyValuePair<string, string>(""resource"", ResourceId)); vals.Add(new KeyValuePair<string, string>(""client_id"", ClientId)); vals.Add(new KeyValuePair<string, string>(""client_secret"", Password)); vals.Add(new KeyValuePair<string, string>(""username"", ""someUser@someTenant.onmicrosoft.com"")); vals.Add(new KeyValuePair<string, string>(""password"", ""xxxxxx"")); //create the post Url string url = string.Format(""https://login.microsoftonline.com/{0}/oauth2/token"", TenantGuid); //make the request HttpClient hc = new HttpClient(); //form encode the data were going to POST HttpContent content = new FormUrlEncodedContent(vals); //plug in the post body HttpResponseMessage hrm = hc.PostAsync(url, content).Result; AuthenticationResponse authenticationResponse = null; if (hrm.IsSuccessStatusCode) { //get the stream Stream data = await hrm.Content.ReadAsStreamAsync(); DataContractJsonSerializer serializer = new DataContractJsonSerializer(typeof (AuthenticationResponse)); authenticationResponse = (AuthenticationResponse) serializer.ReadObject(data); } else { authenticationResponse = new AuthenticationResponse() {ErrorMessage = hrm.StatusCode +"" ""+hrm.RequestMessage}; } return authenticationResponse; } private static async Task<String> DoSomeDataOperations(AuthenticationResponse authResult) { if (authResult.ErrorMessage != null) { return ""problem getting AuthToken: "" + authResult.ErrorMessage; } using (HttpClient httpClient = new HttpClient()) { httpClient.BaseAddress = new Uri(ResourceId); httpClient.Timeout = new TimeSpan(0, 2, 0); //2 minutes httpClient.DefaultRequestHeaders.Add(""OData-MaxVersion"", ""4.0""); httpClient.DefaultRequestHeaders.Add(""OData-Version"", ""4.0""); httpClient.DefaultRequestHeaders.Add(""OData-Version"", ""4.0""); httpClient.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue(""application/json"")); httpClient.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue(""Bearer"", authResult.access_token); //Retreive Entity///////////////////////////////////////////////////////////////////////////////////// var retrieveResponse = await httpClient.GetAsync(""/api/data/v8.0/feedback?$select=title,rating&$top=10""); //var retrieveResponse = await httpClient.GetAsync(""/api/data/v8.0/$metadata""); if (!retrieveResponse.IsSuccessStatusCode) { return retrieveResponse.ReasonPhrase; } return ""it worked!""; } }",Using ADAL C# as Confidential User /Daemon Server /Server-to-Server - 401 Unauthorized
Using ADAL C# as Confidential User /Daemon Server /Server-toServer - 401 Unauthorized," Refering to not answered Questions:401- Unauthorized authentication using REST API Dynamics CRM with Azure ADandDynamics CRM Online 2016 - Daemon / Server application Azure AD authentication error to Web ApiandDynamics CRM 2016 Online Rest API with client credentials OAuth flowI need a communication between an Web-Service in azure cloud and Dynamics CRM Online 2016 WITHOUT any loginscreen! The service will have a REST api which triggers CRUD operations on the CRM (also I will implement an authentification)I think this is called ""Confidential Client"" or ""Daemon Server"" or just ""Server-to-Server""I set up my Service properly in Azure AD (with ""delegate permission = access dynamics online as organization user"", there are no other options)I created a ASP.NET WEB API project in VS which created my WebService in Azure and also the entry ofr the ""Application"" within Azure AD of the CRMMy Code looks like this (pls ignore the EntityType and returnValue): When calling my GET request I get the 401 Unauthorized although I got and send the AccessToken.Any Ideas?EDIT:I also tried the code adviced in this blog (only source which seemed to solve the problem, didnt work either):https://samlman.wordpress.com/2015/06/04/getting-an-azure-access-token-for-a-web-application-entirely-in-code/With this code: <code>  public class WolfController : ApiController { private static readonly string Tenant = ""xxxxx.onmicrosoft.com""; private static readonly string ClientId = ""dxxx53-42xx-43bc-b14e-c1e84b62752d""; private static readonly string Password = ""j+t/DXjn4PMVAHSvZGd5sptGxxxxxxxxxr5Ki8KU=""; // client secret, valid for one or two years private static readonly string ResourceId = ""https://tenantname-naospreview.crm.dynamics.com/""; public static async Task<AuthenticationResult> AcquireAuthentificationToken() { AuthenticationContext authenticationContext = new AuthenticationContext(""https://login.windows.net/""+ Tenant); ClientCredential clientCredentials = new ClientCredential(ClientId, Password); return await authenticationContext.AcquireTokenAsync(ResourceId, clientCredentials); } // GET: just for calling the DataOperations-method via a GET, ignore the return public async Task<IEnumerable<Wolf>> Get() { AuthenticationResult result = await AcquireAuthentificationToken(); await DataOperations(result); return new Wolf[] { new Wolf() }; } private static async Task DataOperations(AuthenticationResult authResult) { using (HttpClient httpClient = new HttpClient()) { httpClient.BaseAddress = new Uri(ResourceId); httpClient.Timeout = new TimeSpan(0, 2, 0); //2 minutes httpClient.DefaultRequestHeaders.Add(""OData-MaxVersion"", ""4.0""); httpClient.DefaultRequestHeaders.Add(""OData-Version"", ""4.0""); httpClient.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue(""application/json"")); httpClient.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue(""Bearer"", authResult.AccessToken); Account account = new Account(); account.name = ""Test Account""; account.telephone1 = ""555-555""; string content = String.Empty; content = JsonConvert.SerializeObject(account, new JsonSerializerSettings() {DefaultValueHandling = DefaultValueHandling.Ignore}); //Create Entity///////////////////////////////////////////////////////////////////////////////////// HttpRequestMessage request = new HttpRequestMessage(HttpMethod.Post, ""api/data/v8.1/accounts""); request.Content = new StringContent(content); request.Content.Headers.ContentType = MediaTypeHeaderValue.Parse(""application/json""); HttpResponseMessage response = await httpClient.SendAsync(request); if (response.IsSuccessStatusCode) { Console.WriteLine(""Account '{0}' created."", account.name); } else //Getting Unauthorized here { throw new Exception(String.Format(""Failed to create account '{0}', reason is '{1}'."",account.name, response.ReasonPhrase)); } ... and more code public class WolfController : ApiController { private static readonly string Tenant = System.Configuration.ConfigurationManager.AppSettings[""ida:Tenant""]; private static readonly string TenantGuid = System.Configuration.ConfigurationManager.AppSettings[""ida:TenantGuid""]; private static readonly string ClientId = System.Configuration.ConfigurationManager.AppSettings[""ida:ClientID""]; private static readonly string Password = System.Configuration.ConfigurationManager.AppSettings[""ida:Password""]; // client secret, valid for one or two years private static readonly string ResourceId = System.Configuration.ConfigurationManager.AppSettings[""ida:ResourceID""]; // GET: api/Wolf public async Task<IEnumerable<Wolf>> Get() { AuthenticationResponse authenticationResponse = await GetAuthenticationResponse(); String result = await DoSomeDataOperations(authenticationResponse); return new Wolf[] { new Wolf() { Id = 1, Name = result } }; } private static async Task<AuthenticationResponse> GetAuthenticationResponse() { //https://samlman.wordpress.com/2015/06/04/getting-an-azure-access-token-for-a-web-application-entirely-in-code/ //create the collection of values to send to the POST List<KeyValuePair<string, string>> vals = new List<KeyValuePair<string, string>>(); vals.Add(new KeyValuePair<string, string>(""grant_type"", ""client_credentials"")); vals.Add(new KeyValuePair<string, string>(""resource"", ResourceId)); vals.Add(new KeyValuePair<string, string>(""client_id"", ClientId)); vals.Add(new KeyValuePair<string, string>(""client_secret"", Password)); vals.Add(new KeyValuePair<string, string>(""username"", ""someUser@someTenant.onmicrosoft.com"")); vals.Add(new KeyValuePair<string, string>(""password"", ""xxxxxx"")); //create the post Url string url = string.Format(""https://login.microsoftonline.com/{0}/oauth2/token"", TenantGuid); //make the request HttpClient hc = new HttpClient(); //form encode the data were going to POST HttpContent content = new FormUrlEncodedContent(vals); //plug in the post body HttpResponseMessage hrm = hc.PostAsync(url, content).Result; AuthenticationResponse authenticationResponse = null; if (hrm.IsSuccessStatusCode) { //get the stream Stream data = await hrm.Content.ReadAsStreamAsync(); DataContractJsonSerializer serializer = new DataContractJsonSerializer(typeof (AuthenticationResponse)); authenticationResponse = (AuthenticationResponse) serializer.ReadObject(data); } else { authenticationResponse = new AuthenticationResponse() {ErrorMessage = hrm.StatusCode +"" ""+hrm.RequestMessage}; } return authenticationResponse; } private static async Task<String> DoSomeDataOperations(AuthenticationResponse authResult) { if (authResult.ErrorMessage != null) { return ""problem getting AuthToken: "" + authResult.ErrorMessage; } using (HttpClient httpClient = new HttpClient()) { httpClient.BaseAddress = new Uri(ResourceId); httpClient.Timeout = new TimeSpan(0, 2, 0); //2 minutes httpClient.DefaultRequestHeaders.Add(""OData-MaxVersion"", ""4.0""); httpClient.DefaultRequestHeaders.Add(""OData-Version"", ""4.0""); httpClient.DefaultRequestHeaders.Add(""OData-Version"", ""4.0""); httpClient.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue(""application/json"")); httpClient.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue(""Bearer"", authResult.access_token); //Retreive Entity///////////////////////////////////////////////////////////////////////////////////// var retrieveResponse = await httpClient.GetAsync(""/api/data/v8.0/feedback?$select=title,rating&$top=10""); //var retrieveResponse = await httpClient.GetAsync(""/api/data/v8.0/$metadata""); if (!retrieveResponse.IsSuccessStatusCode) { return retrieveResponse.ReasonPhrase; } return ""it worked!""; } }",Using ADAL C# as Confidential User /Daemon Server /Server-to-Server - 401 Unauthorized
Compiling and Running code at runtime in .Net Core 1.0," Is it possible to compile and run C# code at runtime in the new .NET Core (better .NET Standard Platform)?I have seen some examples (.NET Framework), but they used NuGet packages that are not compatible with netcoreapp1.0 (.NETCoreApp,Version=v1.0) <code> ",Compiling and running code at runtime in .NET Core 1.0
WPF DataGridCheckBoxColumn loses IsReadOnly state when applying Elementstyle," I need to vertically center a DataGridCheckBoxColumn. Since I did not find a Property inside DataGridCheckBoxColumn, I applied an ElementStyle. However, when this style is applied, my CheckBox becomes checkable again, although it is set to ReadOnly in my DataGrid (the whole Datagrid is ReadOnly), and in DataGridCheckBoxColumn itself.How can I create a vertically centered CheckBox that keeps its ReadOnly state? Here is my code: <code>  <DataGrid IsReadOnly=""True""> <DataGrid.Columns> <DataGridCheckBoxColumn Header=""Test"" IsReadOnly=""True"" Binding=""{Binding MyBinding}""> <DataGridCheckBoxColumn.ElementStyle> <Style> <Setter Property=""FrameworkElement.Margin"" Value=""0,1,0,0"" /> <Setter Property=""FrameworkElement.VerticalAlignment"" Value=""Center"" /> <Setter Property=""FrameworkElement.HorizontalAlignment"" Value=""Center"" /> </Style> </DataGridCheckBoxColumn.ElementStyle> </DataGridCheckBoxColumn> </DataGrid.Columns></DataGrid>",DataGridCheckBoxColumn loses IsReadOnly state when applying ElementStyle
Xamarin BroadcastReceiver not receiving broadcast (Android)," My BroadcastReceiver does not receive anything. Most likely its my setup that is wrong, because I was not able to find any good examples on this. I need my receiver to receive something in my MainActivity, and change a View. I have almost the same code in an Android project, and here it is working, however BroadcastReceivers seems to be implemented a tiny bit differently in Xamarin (in Android, I can make a new BroadcastReceiver almost like an object, but in Xamarin, or C#, it seems I must make my own class and thus do not have the same possibilities to directly reference the views). If I get this to work, I will post a full working example for everyone too.Here is how I have tried to set it up: And in my IntentService I have this method that actually runs, but never arrives at my receiver. This is pretty much the same code as I have in my working Android (only tweaked the BroadcastReceiver and minor adjustments to make it compile). Can anyone see whats wrong??EDITFinally got this whole thing to work. You can see my answer for a full, clean example. <code>  [Activity(Label = ""GetLocation.Droid"", MainLauncher = true, Icon = ""@drawable/icon"")]public class MainActivity : Activity{ Button button; protected override void OnCreate(Bundle bundle) { // ... various OnCreate() code LocationBroadcastReciever lbr = new LocationBroadcastReciever(); RegisterReceiver(lbr, new IntentFilter(""test"")); } public void SetButtonText(string text) { button.Text = text; }}[BroadcastReceiver]public class LocationBroadcastReciever : BroadcastReceiver{ public override void OnReceive(Context context, Intent intent) { /* My program never get this far, so I have not been able to confirm if the bellow code works or not (its from another example I saw). */ //EDIT: It does NOT work. See my answer for a working example string text = intent.GetStringExtra(""title""); ((MainActivity)context).SetButtonText(text); InvokeAbortBroadcast(); }} private void SendBroadcast(double lat, double lng, string activity) { Intent intent = new Intent(""test""); intent.PutExtra(""title"", ""Updated""); LocalBroadcastManager.GetInstance(this).SendBroadcast(intent); }",BroadcastReceiver does not receive broadcast
How to change a shape's positioning depending on the mouse position?," The title for this post was quite hard to think of, so if you can think of a more descriptive title please tell me. Anyway, my problem is quite specific and requires some simple maths knowledge. I am writing a C# WinForms application which is a bit like the old 'xeyes' Linux application. It basically is a set of eyes which follow around your mouse cursor. This may sound easy at first, however can get rather complicated if you're a perfectionist like me :P. This is my code so far (only the paint method, that is called on an interval of 16). Now this does work at a basic level, however sometimes this can happen if the user puts the cursor at 0,0.Now my question is how to fix this? What would the IF statement be to check where the mouse pointer is, and then reduce the pupil X depending on that?Thanks.Edit: This is where I get the mouse positions (my and mx): The timer is started in the eyes_Load event and the interval is 16.Edit 2: Final solution: http://pastebin.com/fT5HfiQR <code>  int lx = 35;int ly = 50;int rx;int ry;int wx = Location.X + Width / 2;int wy = Location.Y + Height / 2;Rectangle bounds = Screen.FromControl(this).Bounds;// Calculate Xfloat tempX = (mx - wx) / (float)(bounds.Width / 2);// Calculate Yfloat tempY = (my - wy) / (float)(bounds.Height / 2);// Draw eyese.Graphics.FillEllipse(Brushes.LightGray, 10, 10, 70, 100);e.Graphics.FillEllipse(Brushes.LightGray, 90, 10, 70, 100);// Draw pupils (this only draws the left one)e.Graphics.FillEllipse(Brushes.Black, lx += (int)(25 * tempX), ly += (int)(40 * tempY), 20, 20); private void timer_Tick(object sender, EventArgs e){ mx = Cursor.Position.X; my = Cursor.Position.Y; Invalidate();}",How to bound a circle inside an ellipse?
C# - Ftp - Check is a file has arrived," I want to loop on a FTP folder for check if a file has arrivedI do: But at the second iteration I get an exception: The stream cannot be read <code>  FtpWebRequest request = (FtpWebRequest)WebRequest.Create(""ftp://localhost:8080"");request.Credentials = new NetworkCredential(""anonymous"", """");request.Method = WebRequestMethods.Ftp.ListDirectoryDetails;while(true){ using (FtpWebResponse response = (FtpWebResponse)request.GetResponse()) using (Stream responseStream = response.GetResponseStream()) using (StreamReader reader = new StreamReader(responseStream)) { Console.WriteLine(reader.ReadToEnd()); reader.Close(); response.Close(); }}",C# - FtpWebRequest - Multiple requests over the same connection/login
C# getting the calling variable name of a parameter," In relation to the question Get the name of parameters from a calling method and Finding the Variable Name passed to a Function in C# I'm still looking for a way to define theWhatDoesTheAnimalSay_WANTED method: I want to know the name of the variable that's used as a parameter: In real life I need this while implementing the IXmlSerializable interface in my classes with custom reader.Read... and writer.Write.... methods.So, unfortunately, I cannot introduce a new wrapper class, interface or change where the name of the animal or what it says is saved. Meaning it has to work with classes and with a plain string, int, decimal, ... variables, fields or properties as well.In other words (not in a rude way): Don't change how are the animals defined, just change the WhatDoesTheAnimalSay_WANTED method...EDIT:As some of you wanted to know a real use case for this example I'm giving you here an idea how I store & read data in an xml-file. The real Database object is of course way bigger and all sub-classes (like Fitter) implement the IXmlSerializable interface as well using the same extensions methods. <code>  public class Farm{ public readonly string Cow = ""Muuuuhh""; public string Cat { get; set; } public void MainFunction() { var dog = ""WauWau""; var kiwi = new Bird(""QueeeekQueeek""); Cat = ""Miiiaaauuuu""; // This one works but looks kinda ugly and is cumbersome when used WhatDoesTheAnimalSay(nameof(dog), dog); WhatDoesTheAnimalSay(nameof(Cow), Cow); WhatDoesTheAnimalSay(nameof(Cat), Cat); WhatDoesTheAnimalSay(nameof(kiwi), kiwi); WhatDoesTheAnimalSay_WRONG1(dog); WhatDoesTheAnimalSay_WRONG2(dog); WhatDoesTheAnimalSay_WANTED(dog); WhatDoesTheAnimalSay_WANTED(Cow); } public void WhatDoesTheAnimalSay<T>(string name, T says) { MessageBox.Show(""The "" + name + "" says: "" + says); // Shows i.e.: The dog says: WauWau } public void WhatDoesTheAnimalSay_WRONG1<T>(T says) { MessageBox.Show(""The "" + nameof(says) + "" says: "" + says); // Shows: The says says: WauWau } public void WhatDoesTheAnimalSay_WRONG2<T>(T says, [CallerMemberName] string name = null) { MessageBox.Show(""The "" + name + "" says: "" + says); // Shows: The MainFunction says: WauWau } public void WhatDoesTheAnimalSay_WANTED<T>(T says /*, ?????*/) { MessageBox.Show(""The "" /*+ ?????*/ + "" says: "" + says); // Shows: The dog says: WauWau }}// Just here to show it should work with a class as well.public class Bird{ public string Says { get; } //readonly public Bird(string says) { Says = says; } public override string ToString() { return Says; }} // This is the Database Class which stores all the data public class Database : IXmlSerializable { // The list of all building sites managed public List<BuildingSite> BuildingSites { get; set; } // The list of all fitters working for the company public List<Fitter> Fitters { get; set; } private readonly int DatabaseVersion = 1; // Write implementation of the IXmlSerializable inteface public void WriteXml(XmlWriter writer) { // Writing all Data into the xml-file writer.WriteElementInt(nameof(DatabaseVersion), DatabaseVersion); writer.WriteElementList(nameof(BuildingSites), BuildingSites); writer.WriteElementList(nameof(Fitters), Fitters); } public void ReadXml(XmlReader reader) { // Do the reading here } public XmlSchema GetSchema() { return null; } } public class XmlExtensions { // Writing a list into the xml-file public static void WriteElementList<T>(this XmlWriter writer, string elementName, IEnumerable<T> items) { var list = items is List<T> ? items : items.ToList(); // The XML-Element should have the name of the variable in Database!!! writer.WriteStartElement(elementName); writer.WriteAttributeString(""count"", list.Count().ToString()); var serializer = new XmlSerializer(typeof(T)); list.ForEach(o => serializer.Serialize(writer, o, XmlHelper.XmlNamespaces)); writer.WriteEndElement(); } public static void WriteElementInt(this XmlWriter writer, string elementName, int toWrite) { // The XMLElement should have the name of the variable in Database!!! writer.WriteElementString(elementName, toWrite.ToString(CultureInfo.InvariantCulture)); } // More here.... }}",Getting the calling variable name of a parameter
C# gRPC server side SSL," New to gRPC and couldn't really find any example on how to enable SSL on the server side. I generated a key pair using openssl but it complains that the private key is invalid. Here's my code <code>  D0608 16:18:31.390303 Grpc.Core.Internal.UnmanagedLibrary Attempting to load native library ""...\grpc_csharp_ext.dll""D0608 16:18:31.424331 Grpc.Core.Internal.NativeExtension gRPC native library loaded successfully.E0608 16:18:43.307324 0 ..\src\core\lib\tsi\ssl_transport_security.c:644: Invalid private key.E0608 16:18:43.307824 0 ..\src\core\lib\security\security_connector.c:821: Handshaker factory creation failed with TSI_INVALID_ARGUMENT.E0608 16:18:43.307824 0 ..\src\core\ext\transport\chttp2\server\secure\server_secure_chttp2.c:188: Unable to create secure server with credentials of type Ssl. var keypair = new KeyCertificatePair( File.ReadAllText(@""root-ca.pem""), File.ReadAllText(@""ssl-private.key""));SslServerCredentials creds = new SslServerCredentials(new List<KeyCertificatePair>() {keypair});Server server = new Server{ Services = { GrpcTest.BindService(new GrpcTestImpl()) }, Ports = { new ServerPort(""127.0.0.1"", Port, creds) }};",How to enable server side SSL for gRPC?
Vertical table in nocacode docx without border," Heyy i am new to novacode docx webapi i want to print a vertical type table without borders, i am have these line of codes through which i be able to print a vertical table i have screen shots also which maybe helpful to u to save my problem but i want this type of result i want verticle style table with no borders This is cuurrent input Thanks in advance <code>  private void Document_3_SecondaryDetail(DocX document, string dist, System.Data.DataTable Doc3_SecondaryDetail){ try { string headlineText = """"; string paraOne = """"; var headLineFormat = new Formatting(); headLineFormat.FontFamily = new System.Drawing.FontFamily(""Arial Black""); headLineFormat.Size = 18D; headLineFormat.Position = 12; var paraFormat = new Formatting(); paraFormat.FontFamily = new System.Drawing.FontFamily(""Calibri""); paraFormat.Size = 10D; Novacode.Table SecondaryDetailDoc3 = document.AddTable(Doc3_SecondaryDetail.Select(""District = '"" + dist + ""'"").Count() + 1, Doc3_SecondaryDetail.Columns.Count); SecondaryDetailDoc3.Alignment = Alignment.left; SecondaryDetailDoc3.Design = TableDesign.LightGridAccent1; int columnNumber = 0; foreach (DataColumn columns in Doc3_SecondaryDetail.Columns) { SecondaryDetailDoc3.Rows[0].Cells[columnNumber].Paragraphs.First().Append(char.ToUpper(columns.ColumnName[0]) + columns.ColumnName.Substring(1).Replace(""_"", "" "")); columnNumber++; } int rowIndex = 1; foreach (DataRow row in Doc3_SecondaryDetail.Select(""District = '"" + dist + ""'"")) { int colIndex = 0; foreach (var item in row.ItemArray) { SecondaryDetailDoc3.Rows[rowIndex].Cells[colIndex].Paragraphs.First().Append(item.ToString()); colIndex++; } rowIndex++; } document.InsertParagraph(headlineText, false, headLineFormat); document.InsertParagraph(paraOne, false, paraFormat); document.InsertTable(SecondaryDetailDoc3); document.InsertParagraph(""""); document.Save(); } catch (Exception ex) { }} enter code here",Vertical table in novacode docx without border
"Can you use the extern keyword in C#, without using the [DllImport] attribute to define the external method?"," I was re-reading through some .Net documentation today when I noticed that the first portion of the extern keywords documentation claims: The extern modifier is used to declare a method that is implemented externally. A common use of the extern modifier is with the DllImport attribute when you are using Interop services to call into unmanaged code.What caught my attention was that the document states that ""a common use"" of extern is that it is used with the DllImport attribute. This implies that there are other use-cases where DllImport is not required. I've not had to integrate many external, non-managed libraries into my applications but in all cases the linked methods were defined with DllImport.I've searched multiple queries through Google and MSDN and I can't find a case or explanation of when the extern keyword would be used without defining the method as an external method import from an unmanaged dll.How, and when, would you use the extern keyword without defining the [DllImport(...)] attribute on the method definition? Please note, this is not specific to using extern when defining aliases. That is a different use of the keyword and that case is outlined in a different article within the MSDN C# language reference. <code> ",When is it appropriate to use the extern keyword without using the [DllImport] attribute?
alert message from C#," Is there any other way to display alert message from back end in asp.net web application rather than this. I have included using System.Web.UI namespace also, but still am getting these 2 errors with this code:First error: The best overloaded method match for 'System.Web.UI.ScriptManager.RegisterStartupScript(System.Web.UI.Page, System.Type, string, string, bool)' has some invalid arguments D:\my_backup\Demos\NewShop\NewShop\API\ProductAPIController.cs 85 17 NewShopSecond error: Argument 1: cannot convert from 'NewShop.API.ProductAPIController' to 'System.Web.UI.Page' D:\my_backup\Demos\NewShop\NewShop\API\ProductAPIController.cs 85 53 NewShop <code>  ScriptManager.RegisterStartupScript(this, GetType(), ""alertMessage"",""alert('Called from code-behind directly!');"", true);",Alert message from C#
"FFmpeg ""movflags"" > ""faststart"" causes av_write_trailer() to return -2"," I'm setting up the format layout for the video as follows: This is how I am setting up the Codec Context: I'm using the following code to setup the ""movflags"" > ""faststart"" option for the header of the video: The file is opened and the header is written as follows: After this, I write each video frame as follows: After that, I write the trailer: The file finishes writing and everything closes and frees up correctly. However, the MP4 file is unplayable (even VLC cant play it). AtomicParsley.exe won't show any information about the file either.The DLLs used for the AutoGen library are: <code>  AVOutputFormat* outputFormat = ffmpeg.av_guess_format(null, ""output.mp4"", null);AVCodec* videoCodec = ffmpeg.avcodec_find_encoder(outputFormat->video_codec);AVFormatContext* formatContext = ffmpeg.avformat_alloc_context();formatContext->oformat = outputFormat;formatContext->video_codec_id = videoCodec->id;ffmpeg.avformat_new_stream(formatContext, videoCodec); AVCodecContext* codecContext = ffmpeg.avcodec_alloc_context3(videoCodec);codecContext->bit_rate = 400000;codecContext->width = 1280;codecContext->height = 720;codecContext->gop_size = 12;codecContext->max_b_frames = 1;codecContext->pix_fmt = videoCodec->pix_fmts[0];codecContext->codec_id = videoCodec->id;codecContext->codec_type = videoCodec->type;codecContext->time_base = new AVRational{ num = 1, den = 30}; AVDictionary* options = null;int result = ffmpeg.av_dict_set(&options, ""movflags"", ""faststart"", 0);int writeHeaderResult = ffmpeg.avformat_write_header(formatContext, &options); if ((formatContext->oformat->flags & ffmpeg.AVFMT_NOFILE) == 0){ int ioOptionResult = ffmpeg.avio_open(&formatContext->pb, ""output.mp4"", ffmpeg.AVIO_FLAG_WRITE);}int writeHeaderResult = ffmpeg.avformat_write_header(formatContext, &options); outputFrame->pts = frameIndex;packet.flags |= ffmpeg.AV_PKT_FLAG_KEY;packet.pts = frameIndex;packet.dts = frameIndex;int encodedFrame = 0;int encodeVideoResult = ffmpeg.avcodec_encode_video2(codecContext, &packet, outputFrame, &encodedFrame);if (encodedFrame != 0){ packet.pts = ffmpeg.av_rescale_q(packet.pts, codecContext->time_base, m_videoStream->time_base); packet.dts = ffmpeg.av_rescale_q(packet.dts, codecContext->time_base, m_videoStream->time_base); packet.stream_index = m_videoStream->index; if (codecContext->coded_frame->key_frame > 0) { packet.flags |= ffmpeg.AV_PKT_FLAG_KEY; } int writeFrameResult = ffmpeg.av_interleaved_write_frame(formatContext, &packet);} int writeTrailerResult = ffmpeg.av_write_trailer(formatContext); avcodec-56.dllavdevice-56.dllavfilter-5.dllavformat-56.dllavutil-54.dllpostproc-53.dllswresample-1.dllswscale-3.dll","FFmpeg ""movflags"" > ""faststart"" causes invalid MP4 file to be written"
C# grouping static classes with the same behavior," I have groups of logic that consist of static classes such as: In this case, A and B are static classes that implement the same behavior via a group of functions (e.g. mutate). I would like to use something like an interface for this pattern, however since static classes cannot implement interfaces I am not sure what to do. What is the best way to implement this type of behavior cleanly?EDIT:Here is an example of what I am currently doing. The classes have no state so normally I would make them static. <code>  static class A { static int mutate(int i) { /**implementation*/ }; static double prop(double a, double b) { /**implementation*/ }; }static class B { static int mutate(int i) { /**implementation*/ }; static double prop(double a, double b) { /**implementation*/ }; } Interface IMutator { int mutate(int i);}class A : IMutator { int mutate(int i) { /**implementation*/ };}class B : IMutator { int mutate(int i) { /**implementation*/ };}class C { public List<IMutator> Mutators; public C(List<IMutator> mutators) { Mutators = mutators; }}//Somewhere else...//The new keyword for A and B is what really bothers me in this case.var Cinstance = new C(new List<IMutator>() {new A(), new B() /**...*/});",grouping static classes with the same behavior
grouping static classes with the same behavior," I have groups of logic that consist of static classes such as: In this case, A and B are static classes that implement the same behavior via a group of functions (e.g. mutate). I would like to use something like an interface for this pattern, however since static classes cannot implement interfaces I am not sure what to do. What is the best way to implement this type of behavior cleanly?EDIT:Here is an example of what I am currently doing. The classes have no state so normally I would make them static. <code>  static class A { static int mutate(int i) { /**implementation*/ }; static double prop(double a, double b) { /**implementation*/ }; }static class B { static int mutate(int i) { /**implementation*/ }; static double prop(double a, double b) { /**implementation*/ }; } Interface IMutator { int mutate(int i);}class A : IMutator { int mutate(int i) { /**implementation*/ };}class B : IMutator { int mutate(int i) { /**implementation*/ };}class C { public List<IMutator> Mutators; public C(List<IMutator> mutators) { Mutators = mutators; }}//Somewhere else...//The new keyword for A and B is what really bothers me in this case.var Cinstance = new C(new List<IMutator>() {new A(), new B() /**...*/});",grouping static classes with the same behavior
C# DateTime.Today for a specific time zone," I need to check whether a certain time zone is still within a specified date. Something like DateTime.Today == DateTime.Parse(""2016-06-30"") but for certain time zone. What is the best way to do it? <code> ",DateTime.Today for a specific time zone
Crossplatform filename handling in .NET Core," How to handle file name in System.IO classes in a cross-platform manner to make it work on Windows and Linux?For example, I write this code that works perfectly on Windows, however it doesn't create a file on Ubuntu Linux: <code>  var tempFilename = $@""..\Data\uploads\{filename}"";using (FileStream fs = System.IO.File.Create(tempFilename)){ file.CopyTo(fs); fs.Flush(); }",Cross-platform file name handling in .NET Core
A reference to could not be added . An assembly must have a dll or exe extension in order to be refrerenced," I have plain c# console application (.NET 4.6) where I want to reference a .NET Core Class Library: And I get the following exception: <code>  { ""version"": ""1.0.0-*"", ""dependencies"": { ""NETStandard.Library"": ""1.6.0"", ""Newtonsoft.Json"": ""9.0.1"" }, ""frameworks"": { ""netstandard1.4"": { ""imports"": ""dnxcore50"" } }}",A reference to could not be added . An assembly must have a dll or exe extension in order to be referenced
C# String interpolation with database values," We would like to maintain the emails that are sent from our ASP.NET Web Application in a database. The idea was that the format of emails are stored in a database.The problem is that emails should include order specific information, e.g.: Thank you for your order John Smith, your order 1234 has been receivedWhat I'm trying to achieve is that I have used string verbatims in the database column values where it would be stored like this: Thank you for your order {o.customer}, your order {o.id} has been receivedI'm curious as to whether it is possible to do string interpolation where the values are already in the string that is formatted. If I try to use String.Format(dbEmailString) it throws me exception: An exception of type 'System.FormatException' occurred in mscorlib.dll but was not handled in user code Additional information: Input string was not in a correct format. <code> ",Interpolating a string stored in a database
"how to convert enum between (string ,list of flags ,enum with flags)"," How do I convert from enums to strings and vice versa?And taking the case that enums can contain multiple flags, how can I get a list of all the flags an enum contains?  <code> ","How do I convert an enum between (string, list of flags, enum with flags)?"
Check whether a List<double> contains the same value multiple times; C#," ProblemCheck collection contains the same number multiple times. If it does contain the same numbers more than once, then I want to keep the first number and give a new value to the rest of the numbers, which are the same as the first one.list newFitnessList does contain These numbers: To achieve the solution explained above I tried the following code, but nothing is happening. The Output of the list is the same as before: I would really appreciate it if someone has any idea what's wrong with my code. And maybe it would be better not to hide, that I'm a newbie with programming. After reading the explanations: I tried out two idea's explained. First one was the idea of @Tim Schmelter and the second idea was from @user3185569. And here you can take a look at what i was tyring to achieve: Here the suggestion of Tim: Here the Suggestion of user3185569:  <code>  0. 4054.230995 --> after code= 4054.2309951. 4041.416004 --> after code= 4041.4160042. 3926.227397 --> after code= 3926.2273973. 4722.250903 --> after code= 4722.2509034. 4722.250903 --> after code= 05. 4226.636776 --> after code= 4226.6367766. 4061.499026 --> after code= 4061.4990267. 3876.278254 --> after code= 3876.2782548. 4041.416004 --> after code= 09. 4779.468077 --> after code= 4779.46807710. 4226.636776 --> after code= 011. 3876.278254 --> after code= 012. 4779.468077 --> after code= 013. 3926.227397 --> after code= 0 public List<double> sortDoppelganger(List<double> inputFitnessList){ List<double> newFitnessList = inputFitnessList.ToList(); for(int i = 0; i < newFitnessList.Count; i++) { double Nothing=0; double actual = newFitnessList[i]; for(int j = newFitnessList.Count-1; j >= 0; j--) { double next = newFitnessList[j]; if(actual == next) { next = Nothing; } } } return newFitnessList;}",Check a List contains the same value multiple times
Extension Method to count number of properties, I have about 1000 classes in which i need to count the number of properties of. I have the following code: I could copy and paste this in to each class changing the typeof parameter but this seems a bit tedious.Is there anyway to make an extensions method to do this by just doing var nop = C507.NumberOfProperties();? <code>  public static int NumberOfProperties() { Type type = typeof(C507); return type.GetProperties().Count(); },How can I add an extension method to many classes?
User login not being authenticated," I'm working with an MVC app. The login is handle by Web API. The issue I'm facing is when I click on Login button in the MVC app the API is generating the token along with the user info. However I can't display the user information in the view. The following code is in the AccountController of MVC App Then in the View I have The API looks like this Can someone tell me why the request is not being Authenticated? What am I missing  <code>  [HttpPost][AllowAnonymous][ValidateAntiForgeryToken]public async Task<ActionResult> Login(LoginViewModel model){ string token = Token.GetToken(Token.GRANT_TYPE, model.Email, model.Password, Token.CLIENT_ID, Token.CLIENT_SECRET); //token has the appropriate data if I debug it if (!string.IsNullOrEmpty(token)) return RedirectToAction(""Index"", ""Home""); return View(model);} @if (Request.IsAuthenticated){ <p>@User.Identity.GetUserName()</p> //this line is always blank} public override async Task GrantResourceOwnerCredentials(OAuthGrantResourceOwnerCredentialsContext context){ var allowedOrigin = context.OwinContext.Get<string>(""as:clientAllowedOrigin""); if (allowedOrigin == null) allowedOrigin = ""*""; context.OwinContext.Response.Headers.Add(""Access-Control-Allow-Origin"", new[] { allowedOrigin }); using (AuthRepository _repo = new AuthRepository()) { ApplicationUser user = await _repo.FindUser(context.UserName, context.Password); if (user == null) { context.SetError(""invalid_grant"", ""The user name or password is incorrect.""); return; } } var identity = new ClaimsIdentity(context.Options.AuthenticationType); identity.AddClaim(new Claim(ClaimTypes.Name, context.UserName)); identity.AddClaim(new Claim(ClaimTypes.Role, ""user"")); identity.AddClaim(new Claim(""sub"", context.UserName)); var props = new AuthenticationProperties(new Dictionary<string, string> { { ""as:client_id"", (context.ClientId == null) ? string.Empty : context.ClientId }, { ""userName"", context.UserName }, { ""email"", context.UserName }, }); var ticket = new AuthenticationTicket(identity, props); context.Validated(ticket);}",User login not being authenticated using OWIN bearer tokens
C#: Why is using a Tuple faster than a List in this example?," I wrote a C# class that is populating a ""List of List of doubles"" with some data (doesn't matter what the data is, for now it can just be some garbage:)), for testing purposes:Here is the code: I compared the speed of execution of this code with the following: (replacing the List of double by a Tuple) Turns out that using the Tuple seems to be considerably faster. I ran this piece of code for different List sizes (from 200,000 elements -> 5 millions elements in the list) and here are the results I get: I cannot really get my head around this one. How come I get such a significant difference? Using a Tuple that stores object of the same type (doubles here) doesn't make much sense. I'd rather use a List/array to do that: what am I doing wrong? Is there a way I can make case #1 run as fast/faster than case #2? Thanks!  <code>  class test { public test() { _myListOfList = new List<List<double>>(1000000); } public void Run() { for (int i = 0; i < _myListOfList.Capacity; i++) { _myListOfList.Add( new List<double>(3) { i, 10*i, 100*i} ); //Populate the list with data } } private List<List<double>> _myListOfList;} class test { public test() { _myListOfTuple = new List<Tuple<double, double, double>>(1000000); } public void Run() { for (int i = 0; i < _myListOfTuple.Capacity; i++) { _myListOfTuple.Add( new Tuple<double, double, double>(i, 10 * i, 100 * i) ); //Populate the list with data } } private List<Tuple<double, double, double>> _myListOfTuple;}",Why is using a Tuple faster than a List in this example?
Telegram bot C# keyboard message different from text," I need my bot to print a different message than its caption (which shows by telegram client on keyboard button element).My custom button has this text: ""Where am I?"" and when I click on it, it prints on the screen ""Where am I?"" also.I want the button to print ""/location"".(something different from its text field)How can I achieve it? I'm using C# and Telegram Bot APIEDIT:What I want:When the user clicks this button, telegram client send a messages with /age [as his typed message] but NOT send show my age (which is that button text field )So: I want a button with a text . when the user clicks the button I want the message sent to be different from that text. <code> ",How to make Keyboard Button message text different from its caption in Telegram bot API using C#
Array of parameters in the WebAPI service," Having issue while passing the array of parameters in the WEB API service Now while calling the API as http://localhost:35432/api/Sample?id=1&id=83 it throws an error saying on var queryResult = dbConn.Query(strQuery); {""ORA-00907: missing right parenthesis""}Checked all the parenthesis and everything looks good  <code>  public class SampleController : ApiController{ public string Getdetails([FromUri] int[] id) { var inconditions = id.Distinct().ToArray(); using (var dbConn = new OracleConnection(""DATA SOURCE=h;PASSWORD=C;PERSIST SECURITY INFO=True;USER ID=T"")) { dbConn.Open(); var strQuery = ""SELECT PRIO_CATEGORY_ID AS PRIO, LANG_ID AS LANG, REC_DATE AS REC, REC_USER AS RECUSER, DESCR, COL_DESCR AS COL, ROW_DESCR AS DROW, ABBR FROM STCD_PRIO_CATEGORY_DESCR WHERE REC_USER IN (:p)""; var queryResult = dbConn.Query<SamModel>(strQuery, new { p = inconditions }); return JsonConvert.SerializeObject(queryResult); }}",Collection parameters querying oracle with dapper
Collection parameters quering oracle with dapper," Having issue while passing the array of parameters in the WEB API service Now while calling the API as http://localhost:35432/api/Sample?id=1&id=83 it throws an error saying on var queryResult = dbConn.Query(strQuery); {""ORA-00907: missing right parenthesis""}Checked all the parenthesis and everything looks good  <code>  public class SampleController : ApiController{ public string Getdetails([FromUri] int[] id) { var inconditions = id.Distinct().ToArray(); using (var dbConn = new OracleConnection(""DATA SOURCE=h;PASSWORD=C;PERSIST SECURITY INFO=True;USER ID=T"")) { dbConn.Open(); var strQuery = ""SELECT PRIO_CATEGORY_ID AS PRIO, LANG_ID AS LANG, REC_DATE AS REC, REC_USER AS RECUSER, DESCR, COL_DESCR AS COL, ROW_DESCR AS DROW, ABBR FROM STCD_PRIO_CATEGORY_DESCR WHERE REC_USER IN (:p)""; var queryResult = dbConn.Query<SamModel>(strQuery, new { p = inconditions }); return JsonConvert.SerializeObject(queryResult); }}",Collection parameters querying oracle with dapper
How to create temporary table and use it in the same connection with entity framework?," I am trying to execute a three raw queries with Entity Framework.The first query will basically create a temporary table. The second query will add an index on the temporary table. Finally, the second query will join to the temporary table to other table to get a final dataset.But every time I run my code, get the following error invalid #allRecords object.Here is what I have done how can I correctly create temporary table with Entity Framework?UPDATEDHere is the query that is returned by this.GetQuery() <code>  using (BaseContextdb = new BaseContext()){ using (var dbContextTransaction = db.Database.BeginTransaction()) { try { db.Database.ExecuteSqlCommand(""SELECT col1, col2, col3 "" + ""INTO #allRecords "" + ""FROM someTable "" + ""WHERE col5 = 'blab' "" + ""CREATE INDEX d ON #allRecords(col1, col2); ""); var results = db.Database.SqlQuery<ResuleModel>(this.GetQuery()).ToList(); db.SaveChanges(); dbContextTransaction.Commit(); } catch (Exception) { dbContextTransaction.Rollback(); } }} SELECT b.*, c.* FROM bINNER JOIN #allRecords AS a ON a.col1 = v.col1 AND a.col2 = b.col2INNER JOIN c ON c.Id= b.Id.........",How to create a temporary table and use it in the same connection with Entity Framework?
How to create a temporary table and use it in the same connection with entity framework?," I am trying to execute a three raw queries with Entity Framework.The first query will basically create a temporary table. The second query will add an index on the temporary table. Finally, the second query will join to the temporary table to other table to get a final dataset.But every time I run my code, get the following error invalid #allRecords object.Here is what I have done how can I correctly create temporary table with Entity Framework?UPDATEDHere is the query that is returned by this.GetQuery() <code>  using (BaseContextdb = new BaseContext()){ using (var dbContextTransaction = db.Database.BeginTransaction()) { try { db.Database.ExecuteSqlCommand(""SELECT col1, col2, col3 "" + ""INTO #allRecords "" + ""FROM someTable "" + ""WHERE col5 = 'blab' "" + ""CREATE INDEX d ON #allRecords(col1, col2); ""); var results = db.Database.SqlQuery<ResuleModel>(this.GetQuery()).ToList(); db.SaveChanges(); dbContextTransaction.Commit(); } catch (Exception) { dbContextTransaction.Rollback(); } }} SELECT b.*, c.* FROM bINNER JOIN #allRecords AS a ON a.col1 = v.col1 AND a.col2 = b.col2INNER JOIN c ON c.Id= b.Id.........",How to create a temporary table and use it in the same connection with Entity Framework?
Why is UserAgent propery missing from my HttpWebRequest class?," I was trying to set the value to something from PCL, when I realized that it's missing. This is how my HttpWebRequest class looks like: I don't even know what detail to add to the question. Please tell me so I can. <code>  #region Assembly System.Net.Requests, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a// C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETPortable\v4.5\Profile\Profile111\System.Net.Requests.dll#endregionusing System.IO;namespace System.Net{ // // Summary: // Provides an HTTP-specific implementation of the System.Net.WebRequest class. public class HttpWebRequest : WebRequest { // // Summary: // Gets or sets the value of the Accept HTTP header. // // Returns: // The value of the Accept HTTP header. The default value is null. public string Accept { get; set; } // // Summary: // Gets or sets a value that indicates whether to buffer the received from the Internet // resource. // // Returns: // Returns System.Boolean.true to enable buffering of the data received from the // Internet resource; false to disable buffering. The default is true. public virtual bool AllowReadStreamBuffering { get; set; } public override string ContentType { get; set; } // // Summary: // Gets or sets a timeout, in milliseconds, to wait until the 100-Continue is received // from the server. // // Returns: // Returns System.Int32.The timeout, in milliseconds, to wait until the 100-Continue // is received. public int ContinueTimeout { get; set; } // // Summary: // Gets or sets the cookies associated with the request. // // Returns: // A System.Net.CookieContainer that contains the cookies associated with this request. public virtual CookieContainer CookieContainer { get; set; } // // Summary: // Gets or sets authentication information for the request. // // Returns: // An System.Net.ICredentials that contains the authentication credentials associated // with the request. The default is null. public override ICredentials Credentials { get; set; } // // Summary: // Gets a value that indicates whether a response has been received from an Internet // resource. // // Returns: // true if a response has been received; otherwise, false. public virtual bool HaveResponse { get; } // // Summary: // Specifies a collection of the name/value pairs that make up the HTTP headers. // // Returns: // A System.Net.WebHeaderCollection that contains the name/value pairs that make // up the headers for the HTTP request. // // Exceptions: // T:System.InvalidOperationException: // The request has been started by calling the System.Net.HttpWebRequest.GetRequestStream, // System.Net.HttpWebRequest.BeginGetRequestStream(System.AsyncCallback,System.Object), // System.Net.HttpWebRequest.GetResponse, or System.Net.HttpWebRequest.BeginGetResponse(System.AsyncCallback,System.Object) // method. public override WebHeaderCollection Headers { get; set; } // // Summary: // Gets or sets the method for the request. // // Returns: // The request method to use to contact the Internet resource. The default value // is GET. // // Exceptions: // T:System.ArgumentException: // No method is supplied.-or- The method string contains invalid characters. public override string Method { get; set; } // // Summary: // Gets the original Uniform Resource Identifier (URI) of the request. // // Returns: // A System.Uri that contains the URI of the Internet resource passed to the System.Net.WebRequest.Create(System.String) // method. public override Uri RequestUri { get; } // // Summary: // Gets a value that indicates whether the request provides support for a System.Net.CookieContainer. // // Returns: // Returns System.Boolean.true if a System.Net.CookieContainer is supported; otherwise, // false. public virtual bool SupportsCookieContainer { get; } // // Summary: // Gets or sets a System.Boolean value that controls whether default credentials // are sent with requests. // // Returns: // true if the default credentials are used; otherwise false. The default value // is false. // // Exceptions: // T:System.InvalidOperationException: // You attempted to set this property after the request was sent. public override bool UseDefaultCredentials { get; set; } // // Summary: // Cancels a request to an Internet resource. public override void Abort(); // // Summary: // Begins an asynchronous request for a System.IO.Stream object to use to write // data. // // Parameters: // callback: // The System.AsyncCallback delegate. // // state: // The state object for this request. // // Returns: // An System.IAsyncResult that references the asynchronous request. // // Exceptions: // T:System.Net.ProtocolViolationException: // The System.Net.HttpWebRequest.Method property is GET or HEAD.-or- System.Net.HttpWebRequest.KeepAlive // is true, System.Net.HttpWebRequest.AllowWriteStreamBuffering is false, System.Net.HttpWebRequest.ContentLength // is -1, System.Net.HttpWebRequest.SendChunked is false, and System.Net.HttpWebRequest.Method // is POST or PUT. // // T:System.InvalidOperationException: // The stream is being used by a previous call to System.Net.HttpWebRequest.BeginGetRequestStream(System.AsyncCallback,System.Object)-or- // System.Net.HttpWebRequest.TransferEncoding is set to a value and System.Net.HttpWebRequest.SendChunked // is false.-or- The thread pool is running out of threads. // // T:System.NotSupportedException: // The request cache validator indicated that the response for this request can // be served from the cache; however, requests that write data must not use the // cache. This exception can occur if you are using a custom cache validator that // is incorrectly implemented. // // T:System.Net.WebException: // System.Net.HttpWebRequest.Abort was previously called. // // T:System.ObjectDisposedException: // In a .NET Compact Framework application, a request stream with zero content length // was not obtained and closed correctly. For more information about handling zero // content length requests, see Network Programming in the .NET Compact Framework. public override IAsyncResult BeginGetRequestStream(AsyncCallback callback, object state); // // Summary: // Begins an asynchronous request to an Internet resource. // // Parameters: // callback: // The System.AsyncCallback delegate // // state: // The state object for this request. // // Returns: // An System.IAsyncResult that references the asynchronous request for a response. // // Exceptions: // T:System.InvalidOperationException: // The stream is already in use by a previous call to System.Net.HttpWebRequest.BeginGetResponse(System.AsyncCallback,System.Object)-or- // System.Net.HttpWebRequest.TransferEncoding is set to a value and System.Net.HttpWebRequest.SendChunked // is false.-or- The thread pool is running out of threads. // // T:System.Net.ProtocolViolationException: // System.Net.HttpWebRequest.Method is GET or HEAD, and either System.Net.HttpWebRequest.ContentLength // is greater than zero or System.Net.HttpWebRequest.SendChunked is true.-or- System.Net.HttpWebRequest.KeepAlive // is true, System.Net.HttpWebRequest.AllowWriteStreamBuffering is false, and either // System.Net.HttpWebRequest.ContentLength is -1, System.Net.HttpWebRequest.SendChunked // is false and System.Net.HttpWebRequest.Method is POST or PUT.-or- The System.Net.HttpWebRequest // has an entity body but the System.Net.HttpWebRequest.BeginGetResponse(System.AsyncCallback,System.Object) // method is called without calling the System.Net.HttpWebRequest.BeginGetRequestStream(System.AsyncCallback,System.Object) // method. -or- The System.Net.HttpWebRequest.ContentLength is greater than zero, // but the application does not write all of the promised data. // // T:System.Net.WebException: // System.Net.HttpWebRequest.Abort was previously called. public override IAsyncResult BeginGetResponse(AsyncCallback callback, object state); // // Summary: // Ends an asynchronous request for a System.IO.Stream object to use to write data. // // Parameters: // asyncResult: // The pending request for a stream. // // Returns: // A System.IO.Stream to use to write request data. // // Exceptions: // T:System.ArgumentNullException: // asyncResult is null. // // T:System.IO.IOException: // The request did not complete, and no stream is available. // // T:System.ArgumentException: // asyncResult was not returned by the current instance from a call to System.Net.HttpWebRequest.BeginGetRequestStream(System.AsyncCallback,System.Object). // // T:System.InvalidOperationException: // This method was called previously using asyncResult. // // T:System.Net.WebException: // System.Net.HttpWebRequest.Abort was previously called.-or- An error occurred // while processing the request. public override Stream EndGetRequestStream(IAsyncResult asyncResult); // // Summary: // Ends an asynchronous request to an Internet resource. // // Parameters: // asyncResult: // The pending request for a response. // // Returns: // A System.Net.WebResponse that contains the response from the Internet resource. // // Exceptions: // T:System.ArgumentNullException: // asyncResult is null. // // T:System.InvalidOperationException: // This method was called previously using asyncResult.-or- The System.Net.HttpWebRequest.ContentLength // property is greater than 0 but the data has not been written to the request stream. // // T:System.Net.WebException: // System.Net.HttpWebRequest.Abort was previously called.-or- An error occurred // while processing the request. // // T:System.ArgumentException: // asyncResult was not returned by the current instance from a call to System.Net.HttpWebRequest.BeginGetResponse(System.AsyncCallback,System.Object). public override WebResponse EndGetResponse(IAsyncResult asyncResult); }}",Why is UserAgent property missing from my HttpWebRequest class?
Video- Full Window (Windows phone 8.1)," Below is my design containing media element, play, pause, full window and seeker. If I click the full window icon on the right hand side, the video shows as full window with play, pause, seeker and full window button. The video plays in full window, but play, pause and seeker are hiding when I set the IsWindowFull property. How to show those controls when the media element is in full window? <code>  <MediaElement x:Name=""VideosMediaElement"" VerticalAlignment=""Top"" Height=""250"" Width=""355"" Margin=""0,20,0,0"" BufferingProgressChanged=""VideosMediaElement_BufferingProgressChanged"" RealTimePlayback=""True"" /><Grid x:Name=""mediaGrid""> <Border VerticalAlignment=""Bottom"" Height=""60"" Background=""Black"" Opacity=""0.1""> </Border> <Image x:Name=""PlayIcon"" Source=""Assets/Play-icon.png"" Height=""35"" HorizontalAlignment=""Left"" VerticalAlignment=""Bottom"" Margin=""3,0,0,10"" Visibility=""Collapsed"" Tapped=""PlayIcon_Tapped""> </Image> <Image x:Name=""PauseIcon"" Source=""Assets/Pause.png"" Height=""35"" HorizontalAlignment=""Left"" VerticalAlignment=""Bottom"" Margin=""3,0,0,10"" Tapped=""PauseIcon_Tapped"" Visibility=""Visible""> </Image> <TextBlock x:Name=""duration"" Foreground=""White"" VerticalAlignment=""Bottom"" Margin=""43,0,0,20""> </TextBlock> <ProgressBar x:Name=""videoProgressBar"" VerticalAlignment=""Bottom"" Margin=""15 0 10 25"" Foreground=""DarkBlue"" Background=""Gray"" Width=""180"" Height=""10"" Minimum=""0"" Maximum=""{Binding Path=NaturalDuration.TimeSpan.TotalSeconds, Mode=TwoWay, ElementName=VideosMediaElement}"" Value=""{Binding Path=Position.TotalSeconds, Mode=TwoWay, ElementName=VideosMediaElement}"" Tapped=""videoProgressBar_Tapped"" /> <TextBlock x:Name=""maximumDuration"" Foreground=""White"" Margin=""0,0,40,20"" VerticalAlignment=""Bottom"" HorizontalAlignment=""Right""> </TextBlock> <Image x:Name=""ExpandEnabled"" Source=""Assets/Fullscreen.png"" Tapped=""Zoom_Tapped"" Height=""35"" Margin=""0 0 3 10"" HorizontalAlignment=""Right"" VerticalAlignment=""Bottom""> </Image></Grid> VideosMediaElement.IsFullWindow = true; <MediaElement x:Name=""VideosMediaElement"" VerticalAlignment=""Top"" Height=""300"" Width=""360"" BufferingProgressChanged=""VideosMediaElement_BufferingProgressChanged"" AreTransportControlsEnabled=""True""> <MediaElement.TransportControls> <MediaTransportControls IsCompact=""True"" IsZoomButtonVisible=""False"" IsZoomEnabled=""False"" IsPlaybackRateButtonVisible=""True"" IsPlaybackRateEnabled=""True"" /> </MediaElement.TransportControls></MediaElement>",Keep elements displayed in fullscreen UWP application
Video- Full Window in Windows UWP," Below is my design containing media element, play, pause, full window and seeker. If I click the full window icon on the right hand side, the video shows as full window with play, pause, seeker and full window button. The video plays in full window, but play, pause and seeker are hiding when I set the IsWindowFull property. How to show those controls when the media element is in full window? <code>  <MediaElement x:Name=""VideosMediaElement"" VerticalAlignment=""Top"" Height=""250"" Width=""355"" Margin=""0,20,0,0"" BufferingProgressChanged=""VideosMediaElement_BufferingProgressChanged"" RealTimePlayback=""True"" /><Grid x:Name=""mediaGrid""> <Border VerticalAlignment=""Bottom"" Height=""60"" Background=""Black"" Opacity=""0.1""> </Border> <Image x:Name=""PlayIcon"" Source=""Assets/Play-icon.png"" Height=""35"" HorizontalAlignment=""Left"" VerticalAlignment=""Bottom"" Margin=""3,0,0,10"" Visibility=""Collapsed"" Tapped=""PlayIcon_Tapped""> </Image> <Image x:Name=""PauseIcon"" Source=""Assets/Pause.png"" Height=""35"" HorizontalAlignment=""Left"" VerticalAlignment=""Bottom"" Margin=""3,0,0,10"" Tapped=""PauseIcon_Tapped"" Visibility=""Visible""> </Image> <TextBlock x:Name=""duration"" Foreground=""White"" VerticalAlignment=""Bottom"" Margin=""43,0,0,20""> </TextBlock> <ProgressBar x:Name=""videoProgressBar"" VerticalAlignment=""Bottom"" Margin=""15 0 10 25"" Foreground=""DarkBlue"" Background=""Gray"" Width=""180"" Height=""10"" Minimum=""0"" Maximum=""{Binding Path=NaturalDuration.TimeSpan.TotalSeconds, Mode=TwoWay, ElementName=VideosMediaElement}"" Value=""{Binding Path=Position.TotalSeconds, Mode=TwoWay, ElementName=VideosMediaElement}"" Tapped=""videoProgressBar_Tapped"" /> <TextBlock x:Name=""maximumDuration"" Foreground=""White"" Margin=""0,0,40,20"" VerticalAlignment=""Bottom"" HorizontalAlignment=""Right""> </TextBlock> <Image x:Name=""ExpandEnabled"" Source=""Assets/Fullscreen.png"" Tapped=""Zoom_Tapped"" Height=""35"" Margin=""0 0 3 10"" HorizontalAlignment=""Right"" VerticalAlignment=""Bottom""> </Image></Grid> VideosMediaElement.IsFullWindow = true; <MediaElement x:Name=""VideosMediaElement"" VerticalAlignment=""Top"" Height=""300"" Width=""360"" BufferingProgressChanged=""VideosMediaElement_BufferingProgressChanged"" AreTransportControlsEnabled=""True""> <MediaElement.TransportControls> <MediaTransportControls IsCompact=""True"" IsZoomButtonVisible=""False"" IsZoomEnabled=""False"" IsPlaybackRateButtonVisible=""True"" IsPlaybackRateEnabled=""True"" /> </MediaElement.TransportControls></MediaElement>",Keep elements displayed in fullscreen UWP application
.NET core replacement for TcpCient," So in the old .NET you were able to initialize a new instance of the TcpClient class and connect to the specified port on the specified host using TcpClient(string, int). That no longer works for TcpClient in .NET core and I'm wondering if there is a replacement or some other way to do the same thing in core. I read the documentation, but maybe I'm missing something or there is a new, better way of going about this.Also I'm going to use the GetStream method that works for both versions of TcpClient to load the stream into a NetworkStream. <code> ",.NET core replacement for TcpClient
Why the order execution of inner finally and outer when swapped in C# 6.0," I've seen this example: Which produces the next output: This sounds weird to me, and I'm looking for a good explanation of this order to wrap it up in my head. I was expecting the finally block to be executed before when: The documentation states that this execution order is correct, but it does not elaborate on why it is done like that and what exactly are the rules of the execution order here. <code>  static void Main(string[] args){ Console.WriteLine(""Start""); try { SomeOperation(); } catch (Exception) when (EvaluatesTo()) { Console.WriteLine(""Catch""); } finally { Console.WriteLine(""Outer Finally""); }}private static bool EvaluatesTo(){ Console.WriteLine($""EvaluatesTo: {Flag}""); return true;}private static void SomeOperation(){ try { Flag = true; throw new Exception(""Boom""); } finally { Flag = false; Console.WriteLine(""Inner Finally""); }} StartEvaluatesTo: TrueInner FinallyCatchOuter Finally StartInner FinallyEvaluatesTo: TrueCatchOuter Finally",Why is the execution order of inner 'finally' and outer 'when' swapped in C# 6.0?
Why the execution order of inner finally and outer when swapped in C# 6.0," I've seen this example: Which produces the next output: This sounds weird to me, and I'm looking for a good explanation of this order to wrap it up in my head. I was expecting the finally block to be executed before when: The documentation states that this execution order is correct, but it does not elaborate on why it is done like that and what exactly are the rules of the execution order here. <code>  static void Main(string[] args){ Console.WriteLine(""Start""); try { SomeOperation(); } catch (Exception) when (EvaluatesTo()) { Console.WriteLine(""Catch""); } finally { Console.WriteLine(""Outer Finally""); }}private static bool EvaluatesTo(){ Console.WriteLine($""EvaluatesTo: {Flag}""); return true;}private static void SomeOperation(){ try { Flag = true; throw new Exception(""Boom""); } finally { Flag = false; Console.WriteLine(""Inner Finally""); }} StartEvaluatesTo: TrueInner FinallyCatchOuter Finally StartInner FinallyEvaluatesTo: TrueCatchOuter Finally",Why is the execution order of inner 'finally' and outer 'when' swapped in C# 6.0?
Web API on ASP.NET Core returning improperly cased JSON," I'm running through a WintellectNOW course on ASP.NET Core/Web API/Angular 2. I have the API portion implemented, but for whatever reason, the JSON that is being returned has the variable names being lowercased.The returned JSON is formatted like... I'm expecting... Based on the C# model of... I even went as far as decorating the properties with [DataMember(Name = ""Id"")] just to make sure and it still didn't matter. On the off chance, it's relevant the Action and instance variable in the controller... How do I turn off the camelCase functionality, so that ASP.NET Core returns the property names without changing them? <code>  [ {""id"":1,""name"":""Bowler"",""color"":""black"",""count"":1}, {""id"":2,""name"":""Fedora"",""color"":""red"",""count"":1}, {""id"":3,""name"":""Baseball Cap"",""color"":""blue"",""count"":3}] [ {""Id"":1,""Name"":""Bowler"",""Color"":""black"",""Count"":1}, {""Id"":2,""Name"":""Fedora"",""Color"":""red"",""Count"":1}, {""Id"":3,""Name"":""Baseball Cap"",""Color"":""blue"",""Count"":3}] namespace HatCollection.Models{ public class Hat { public int Id { get; set; } public string Name { get; set; } public string Color { get; set; } public int Count { get; set; } }} private static readonly List<Hat> MyHats = new List<Hat>{ new Hat {Id = 1, Name = ""Bowler"", Color = ""black"", Count = 1 }, new Hat {Id = 2, Name = ""Fedora"", Color = ""red"", Count = 1 }, new Hat {Id = 3, Name = ""Baseball Cap"", Color = ""blue"", Count = 3 }};[HttpGet]public IEnumerable<Hat> Get(){ return MyHats;}",How to turn off or handle camelCasing in JSON response ASP.NET Core?
How to turn off camelCasing in ASP.NET Core?," I'm running through a WintellectNOW course on ASP.NET Core/Web API/Angular 2. I have the API portion implemented, but for whatever reason, the JSON that is being returned has the variable names being lowercased.The returned JSON is formatted like... I'm expecting... Based on the C# model of... I even went as far as decorating the properties with [DataMember(Name = ""Id"")] just to make sure and it still didn't matter. On the off chance, it's relevant the Action and instance variable in the controller... How do I turn off the camelCase functionality, so that ASP.NET Core returns the property names without changing them? <code>  [ {""id"":1,""name"":""Bowler"",""color"":""black"",""count"":1}, {""id"":2,""name"":""Fedora"",""color"":""red"",""count"":1}, {""id"":3,""name"":""Baseball Cap"",""color"":""blue"",""count"":3}] [ {""Id"":1,""Name"":""Bowler"",""Color"":""black"",""Count"":1}, {""Id"":2,""Name"":""Fedora"",""Color"":""red"",""Count"":1}, {""Id"":3,""Name"":""Baseball Cap"",""Color"":""blue"",""Count"":3}] namespace HatCollection.Models{ public class Hat { public int Id { get; set; } public string Name { get; set; } public string Color { get; set; } public int Count { get; set; } }} private static readonly List<Hat> MyHats = new List<Hat>{ new Hat {Id = 1, Name = ""Bowler"", Color = ""black"", Count = 1 }, new Hat {Id = 2, Name = ""Fedora"", Color = ""red"", Count = 1 }, new Hat {Id = 3, Name = ""Baseball Cap"", Color = ""blue"", Count = 3 }};[HttpGet]public IEnumerable<Hat> Get(){ return MyHats;}",How to turn off or handle camelCasing in JSON response ASP.NET Core?
Access DB in Startup file in ASP.net Core API," I have recently been working on a .NET Core web API. I have just attempted authentication using JWT, by following the guide on https://stormpath.com/blog/token-authentication-asp-net-core.All was going well until I had to replace the hard-coded username and passwords in the GetIdentity method with a DB query and realized I do not know how to access the DB from within this file!The method I am referring to is shown in the link below on line 70.https://github.com/nbarbettini/SimpleTokenProvider/blob/master/test/SimpleTokenProvider.Test/Startup.Auth.csMy questions are as follows.Can I access the database here? If so how?Should this be where the GetIdentity method is, or is there a better way? <code> ",Can I access a database during startup in ASP.NET Core?
How do I overcome error 'there is no argument given that corresponds to required formal parameter'?," I have following code where I'm getting error while compiling in C# visual Studio 2015. <code>  class Oval:Shape{ private double major_axis, minor_axis; public Oval(double Major_Axis, double Minor_Axis) { major_axis = Major_Axis; minor_axis = Minor_Axis; } //Constructor}class Circle:Oval{ private double radius; public Circle(double Circle_Radius) // Getting Error on this line { radius = Circle_Radius; } //constructor}",Resolve error 'there is no argument given that corresponds to required formal parameter'?
"objDataTable.Columns.Add(""Student Id"", typeof(int));"," am already tried many ways but i can'tin c# how to set primary key to this line , friends please helpthanks in Advance <code>  objDataTable.Columns.Add(""Student Id"", typeof(int));objDataTable.PrimaryKey = ""Student Id"";",Setting DataTable primary key
How is a stream disposed when using StreamContent," I'm attempting to return a stream from my webapi endpoint, and then clean up by disposing the stream.I expected this to be the correct way, but the stream is of course disposed before returning. What will be the correct way of disposing the stream?(Since MSDN says nothing about the behaviour of StreamContent or its methods, my temporary solution is to copy the contents of the stream to a byte array and return that.) <code>  using(var stream = GetStream()){ var response = new HttpResponseMessage(); response.Content = new StreamContent(stream); return response;}",How to properly dispose the stream when using StreamContent
Use JWT (Authorization: Bearer) in Swagger in ASP.NET Core 1.0, I'm creating a REST api in ASP.NET Core 1.0. I was using Swagger to test but now I added JWT authorization for some routes. (with UseJwtBearerAuthentication)Is it possible to modify the header of the Swagger requests so the routes with the [Authorize] attribute can be tested? <code> ,Use JWT (Authorization: Bearer) in Swagger in ASP.NET Core
How to extract custom header value in Web API message handler in .NET Core?," I have this exact code from the accepted answer in my project which I need to migrate into ASP.NET Core MVP.How to extract custom header value in Web API message handler? How can I implement this in .NET Core?I hope this is not considered to be a duplicate question because I am trying to do this with the new system rather than the old one. I would also be fine if someone adds an answer to the link regarding the current version.Edit: Where all types for http headers gone in ASP.NET 5? I tried this link but API may have changed. I don't think this is a duplicate for that question either. <code>  var env = Request.Headers.GetValues(""environment"").First();",How to extract custom header value?
Trouble mixing ASP NET Core with NET Core class library," I'm having a hard time trying to migrate from a regular Windows desktop development to ASP.NET Core MVC. One issue I'm coming across is to create my solution. I would like to remove everything that is not UI related from the default project that ships with VS 2015 and put into a separate project.I noticed that ASP MVC Core references to .NETCoreApp and the Class Library project references to .NETStandard.My problem is that I need to use the dynamic keyword in the class library and it does not support it. The MVC project supports without any problem. I guess it's because of the different .NET versions.What is the difference between NETStandard and NETCoreApp?Can I create a class library that uses the same reference as the MVC project so I can use the dynamic keyword on it?Or should I stick with a one project solution with all domain, infrastructure, etc in the same place? <code> ",Can I use dynamic in a .NET Standard class library?
How to return 401 instead of 302 in asp.net core?," I'm trying to get ASP.NET Core Identity to return 401 when a user isn't logged in. I've added an [Authorize] attribute to my method and instead of returning 401 it returns 302. I've tried a ton of suggestions but nothing seems to work, including services.Configure and app.UseCookieAuthentication setting LoginPath to null or PathString.Empty. <code> ",How to return 401 instead of 302 in ASP.NET Core?
Get first part from url(first root directory value only) in c#," I have this url (www.site.com/folder1/sub-folder).Now I just want to get only folder1 from this url. How can I do that? I'm getting Last root url from below code but I want only first root url. Please help me to get only first directory value. <code>  string s = Page.Request.Url.AbsolutePath;s = s.Substring(s.LastIndexOf(""/"")+1);",Get first part from url(first root directory value only) in C#
Unable to update CalendarFolder," I am very new to EWS and Exchange in general, so not really sure what is the best approach.BackgroundI am trying to set configuration information about a room. I was hoping that the EWS API provided me with a Room object that I can add ExtendedProperties on, however, it appears that rooms are just an email address.I then saw that each room had a CalendarFolder associated with it, so I am now trying to set the room configuration in the CalendarFolder, which is what the original question below refers to.Original QuestionI am trying to do a simple update of a CalendarFolder using: However, when I call .Update() I get ""The folder save operation failed due to invalid property values.""I believe that the problem might have something to do with myCalendar not having all of the properties that the calendar folder has on the server. So when I update the object it is only sending a partial object which is causing validation errors.How would I go about updating a CalendarFolder?After further researchI also stumbled across the following, which does work: I'm sure there is a difference between the two approaches, but I don't understand the differences between the folder that I get using the different query methods: and Which approach would give me the correct CalendarFolder where I can set the ExtendedProperties for the room? <code>  var folderId = new FolderId(WellKnownFolderName.Calendar, new Mailbox(roomEmail.Address));var myCalendar = CalendarFolder.Bind(service, folderId, PropertySet.FirstClassProperties);myCalendar.DisplayName += ""Updated"";myCalendar.Update(); FindFoldersResults root = service.FindFolders(WellKnownFolderName.Calendar, new FolderView(500));foreach (var folder in root.Folders){ folder.DisplayName = ""confRoom1""; folder.Update();} new FolderId(WellKnownFolderName.Calendar, new Mailbox(roomEmail.Address));var myCalendar = CalendarFolder.Bind(service, folderId, PropertySet.FirstClassProperties); service.FindFolders(WellKnownFolderName.Calendar, new FolderView(500));",Setting ExtendedProperties related to a Room
c# xamarin circular progrss bar - Android," created a circular progress bar which is working fine with the animation. but while trying to display it using dynamic data progress bar is not updating.Below code is working and AXML code is But when I tried something like in the loop the progress bar is not updating with the data. Basically progress bar is not updating in circle. Any help will be appreciated. <code>  progrssBarObj = FindViewById<ProgressBar>(Resource.Id.progressBarSync); ObjectAnimator animation = ObjectAnimator.OfInt(progrssBarObj, ""progress"", 0, 100); // see this max value coming back here, we animale towards that value animation.SetDuration(3000); //in milliseconds animation.SetInterpolator(new DecelerateInterpolator()); animation.Start(); <ProgressBar style=""?android:attr/progressBarStyleHorizontal"" android:layout_column=""2"" android:id=""@+id/progressBarSync"" android:layout_width=""300dp"" android:layout_height=""300dp"" android:progressDrawable=""@drawable/circular_progress_bar"" android:background=""@drawable/progress_bar_background"" /> for (int i = 0; i <= 100; i++) { int cnt = 0; cnt = cnt + i; progrssBarObj.Progress = cnt; }",c# xamarin circular progress bar - Android
.NET Core - Routing doesn't work without attributes," EDIT: An issue has been opened on GitHub to clarify the docs with the information in the answer.I'm trying to set up routing in my .NET Core MVC app (for an API). I believe I have everything configured correctly, but no routes work (all return 404) unless the action has a routing attribute explicitly set. This same problem is mentioned here, but he doesn't know what fixed the problem. I put the attributes back on, it worked. I removed them, it didn't. Eventually through some magical incantation of removing and re-adding route configuration - switching it off and back on again in other words - UseMvcWithDefaultRoute() worked without routing attributes. Not sure what happened there.Here is a simplified version of what I have. What's the problem? Why isn't routing working without attributes set?In this example, I'm attempting to POST to /login/register.Startup.cs: I also tried specifying the route manually: Login controller: <code>  public void ConfigureServices(IServiceCollection services){ services.AddMvc(config => { var policy = new AuthorizationPolicyBuilder() .RequireAuthenticatedUser() .Build(); config.Filters.Add(new AuthorizeFilter(policy)); }) .AddJsonOptions(options => options.SerializerSettings.ContractResolver = new CamelCasePropertyNamesContractResolver());public void Configure(IApplicationBuilder app, IHostingEnvironment env, ILoggerFactory loggerFactory){ if (env.IsDevelopment()) { app.UseDeveloperExceptionPage(); } app.UseDefaultFiles(); app.UseStaticFiles(); app.UseMvcWithDefaultRoute();} app.UseMvc(routes =>{ routes.MapRoute( ""default"", ""{controller=Home}/{action=Index}/{id?}"");}); [Route(""[controller]"")][AllowAnonymous]public class LoginController : Controller{ [HttpPost] [Route(""register"")] // only works with this here public IActionResult Register([FromBody]RegisterModel model) { return Ok(); }}",Routing doesn't work without attributes
Castle Dynamic Proxy replace virtual function with interface," Is it possible to replace public virtual int Div(int a,int b) with interface How then should look like proxy declaration? <code>  namespace DynamicInterception{ public class Calculator { public virtual int Div(int a, int b) { try { return a / b; } catch (Exception ex) { Console.WriteLine(ex.Message.ToString()); return 0; } } } [Serializable] public abstract class Interceptor : IInterceptor { public void Intercept(IInvocation invocation) { ExecuteBefore(invocation); invocation.Proceed(); ExecuteAfter(invocation); } protected abstract void ExecuteAfter(IInvocation invocation); protected abstract void ExecuteBefore(IInvocation invocation); } public class CalculatorInterceptor : Interceptor { protected override void ExecuteBefore(Castle.DynamicProxy.IInvocation invocation) { Console.WriteLine(""Start: {0}"", invocation.Method.Name); } protected override void ExecuteAfter(Castle.DynamicProxy.IInvocation invocation) { Console.WriteLine(""End: {0}"", invocation.Method.Name); } } class Program { static void Main(string[] args) { ProxyGenerator generator = new ProxyGenerator(); Calculator c = generator.CreateClassProxy<Calculator>(new CalculatorInterceptor()); var r = c.Div(11, 0); Console.ReadKey(); } }} interface ICalculator{ int Div(int a, int b);} ProxyGenerator generator = new ProxyGenerator();Calculator c = generator.CreateClassProxy<Calculator>(new CalculatorInterceptor());",Castle Dynamic Proxy of Interface and not Derived Class
"ASP,NET MVC. How use NameFor and DisplayFor ir order to create a table heading and body"," How get a property display name using DisplayNameFor()to build a table header. for instance: what should I write in the question marks?  <code>  @model IEnumerable<Item> <table class=""table""> <thead> <tr> <td>@Html.DisplayNameFor(? => ?.prop1)</td> <td>@Html.DisplayNameFor(? => ?.prop2)</td> <td>@Html.DisplayNameFor(? => ?.prop3)</td> </tr> </thead> <tbody> @foreach (Item item in Model) { <tr> <td>@Html.DisplayFor(i => item.prop1)</td> <td>@Html.DisplayFor(i => item.prop2)</td> <td>@Html.DisplayFor(i => item.prop3)</td> </tr> } </tbody> </table>",ASP.NET MVC. How use DisplayNameFor in order to create a table heading and body?
Calling Oracle StoreProcedure using EntityFramework with output parameter?," I have a simple Oracle stored procedure that gets three parameters passed in, and has one output parameter: I am trying to use Entity Framework 6.1 to get back the OutAssetRegistered value, however, I get a null after calling SqlQuery with no exception: //------------------------------------------------------------ I have been battling to get this to work to no avail, have checked different blogs, all the other crud operations work, can anyone please assist and direct me where I am going wrong? <code>  CREATE OR REPLACE PROCEDURE RA.RA_REGISTERASSET( INPROJECTNAME IN VARCHAR2 ,INCOUNTRYCODE IN VARCHAR2 ,INLOCATION IN VARCHAR2 ,OUTASSETREGISTERED OUT VARCHAR2)ASBEGIN SELECT INPROJECTNAME || ', ' || INLOCATION || ', ' || INCOUNTRYCODE INTO OUTASSETREGISTERED FROM DUAL; END RA_REGISTERASSET; public class CmdRegisterAssetDto{ public string inProjectName { get; set; } public string inCountryCode { get; set; } public string inLocation { get; set; } public string OutAssetRegistered { get; set; }} string projectName = ""EXCO"";string location = ""ANYWHERE"";string countryCode = ""XX"";using (var ctx = new RAContext()){ var projectNameParam = new OracleParameter(""inProjectName"", OracleDbType.Varchar2, projectName, ParameterDirection.Input); var countryCodeParam = new OracleParameter(""inCountryCode"", OracleDbType.Varchar2, countryCode, ParameterDirection.Input); var locationParam = new OracleParameter(""inLocation"", OracleDbType.Varchar2, location, ParameterDirection.Input); var assetRegisteredParam = new OracleParameter(""OutAssetRegistered"", OracleDbType.Varchar2, ParameterDirection.Output); var sql = ""BEGIN RA.RA_RegisterAsset(:inProjectName, :inCountryCode, :inLocation, :OutAssetRegistered); END;""; var query = ctx.Database.SqlQuery<CmdRegisterAssetDto>(sql, projectNameParam, countryCodeParam, locationParam, assetRegisteredParam ); assetRegistered = (string)assetRegisteredParam.Value;}",Calling Oracle stored procedure using Entity Framework with output parameter?
EPPlus Cell from ExcelRange," This problem has me completely puzzled. I have a Excel document which loads in just fine.It has rows, columns and data and I want to iterate through the rows.But EPPLus is odd. I take the second row: Which gives me {A2:D2} Splendid! so far so good but then I want the first cell of the row: Which give me {A1} and to make matter worse, the value of range1 has also changed to {A1} instead of the row I selected.How can I resolve this issue and take a ExcelRange from an ExcelRange?This has me completely puzzled .... thanks for anyhelp <code>  ExcelRange range1 = worksheet.Cells[2, worksheet.Dimension.Start.Column, 2, worksheet.Dimension.End.Column]; ExcelRange range2 = range1[1,1];",Cell from ExcelRange
get the ApplicationDbContext in the ManageController, I am trying all day to figure out to get the ApplicationDbContext in the ManageController.cs of a default MVC 6 project.I went online and Googled a lot but no one seems to have the same problem as I have with it. It is probably simple but I can't figure it out. Anyone has an idea?Here is what I tried: <code>  IServiceProvider service = new IServiceProvider();var _context = service.GetService<ApplicationDbContext>();,How to get the database context in a controller
ASP.NET Core dependency injection resolving by name," How can I inject different implementation of object for a specific class?For example, in Unity, I can define two implementations of IRepository and call the needed implementation <code>  container.RegisterType<IRepository, TestSuiteRepositor(""TestSuiteRepository"");container.RegisterType<IRepository, BaseRepository>(); public BaselineManager([Dependency(""TestSuiteRepository"")]IRepository repository)",Dependency injection resolving by name
MVC 6 View Component - Suitable constructor for type not found," View Component: In the view ~/Views/Employees/Details.cshtml The view component is located at ~Views/Shared/Components/Widget/Default.cshtmlThe error I receive is below: InvalidOperationException: A suitable constructor for type 'MyApp.ViewComponents.WidgetViewComponent' could not be located. Ensure the type is concrete and services are registered for all parameters of a public constructor. <code>  public class WidgetViewComponent : ViewComponent{ private readonly IWidgetService _WidgetService; private WidgetViewComponent(IWidgetService widgetService) { _WidgetService = widgetService; } public async Task<IViewComponentResult> InvokeAsync(int widgetId) { var widget = await _WidgetService.GetWidgetById(widgetId); return View(widget); }} @await Component.InvokeAsync(""Widget"", new { WidgetId = Model.WidgetId } )",Suitable constructor for type not found (View Component)
FFT Convolution isn't working," I have written some routines to sharpen a Grayscale image using a 3x3 kernel, The following code is working well in case of non-FFT (spatial-domain) convolution, but, not working in FFT-based (frequency-domain) convolution.The output image seems to be blurred.I have several problems:(1) This routine is not being able to generate desired result. It also freezes the application. (2) This routine gives good result. But, as slow as hell. (3) The following is my GUI code. SharpenFilter.ApplyWithPadding() works properly if I use an image as a mask. But, doesn't work if I use a, say, 3x3 kernel. Output:Source Code :You can download the entire solution from here in this link. <code>  -1 -1 -1 -1 9 -1 -1 -1 -1 public static Bitmap ApplyWithPadding(Bitmap image, Bitmap mask) { if(image.PixelFormat == PixelFormat.Format8bppIndexed) { Bitmap imageClone = (Bitmap)image.Clone(); Bitmap maskClone = (Bitmap)mask.Clone(); ///////////////////////////////////////////////////////////////// Complex[,] cPaddedLena = ImageDataConverter.ToComplex(imageClone); Complex[,] cPaddedMask = ImageDataConverter.ToComplex(maskClone); Complex[,] cConvolved = Convolution.Convolve(cPaddedLena, cPaddedMask); return ImageDataConverter.ToBitmap(cConvolved); } else { throw new Exception(""not a grascale""); } } public static Bitmap Apply(Bitmap sourceBitmap) { Sharpen filter = new Sharpen(); BitmapData sourceData = sourceBitmap.LockBits(new Rectangle(0, 0, sourceBitmap.Width, sourceBitmap.Height), ImageLockMode.ReadOnly, PixelFormat.Format32bppArgb); byte[] pixelBuffer = new byte[sourceData.Stride * sourceData.Height]; byte[] resultBuffer = new byte[sourceData.Stride * sourceData.Height]; Marshal.Copy(sourceData.Scan0, pixelBuffer, 0, pixelBuffer.Length); sourceBitmap.UnlockBits(sourceData); double blue = 0.0; double green = 0.0; double red = 0.0; int filterWidth = filter.FilterMatrix.GetLength(1); int filterHeight = filter.FilterMatrix.GetLength(0); int filterOffset = (filterWidth - 1) / 2; int calcOffset = 0; int byteOffset = 0; for (int offsetY = filterOffset; offsetY < sourceBitmap.Height - filterOffset; offsetY++) { for (int offsetX = filterOffset; offsetX < sourceBitmap.Width - filterOffset; offsetX++) { blue = 0; green = 0; red = 0; byteOffset = offsetY * sourceData.Stride + offsetX * 4; for (int filterY = -filterOffset; filterY <= filterOffset; filterY++) { for (int filterX = -filterOffset; filterX <= filterOffset; filterX++) { calcOffset = byteOffset + (filterX * 4) + (filterY * sourceData.Stride); blue += (double)(pixelBuffer[calcOffset]) * filter.FilterMatrix[filterY + filterOffset, filterX + filterOffset]; green += (double)(pixelBuffer[calcOffset + 1]) * filter.FilterMatrix[filterY + filterOffset, filterX + filterOffset]; red += (double)(pixelBuffer[calcOffset + 2]) * filter.FilterMatrix[filterY + filterOffset, filterX + filterOffset]; } } blue = filter.Factor * blue + filter.Bias; green = filter.Factor * green + filter.Bias; red = filter.Factor * red + filter.Bias; if (blue > 255) { blue = 255; } else if (blue < 0) { blue = 0; } if (green > 255) { green = 255; } else if (green < 0) { green = 0; } if (red > 255) { red = 255; } else if (red < 0) { red = 0; } resultBuffer[byteOffset] = (byte)(blue); resultBuffer[byteOffset + 1] = (byte)(green); resultBuffer[byteOffset + 2] = (byte)(red); resultBuffer[byteOffset + 3] = 255; } } Bitmap resultBitmap = new Bitmap(sourceBitmap.Width, sourceBitmap.Height); BitmapData resultData = resultBitmap.LockBits(new Rectangle(0, 0, resultBitmap.Width, resultBitmap.Height), ImageLockMode.WriteOnly, PixelFormat.Format32bppArgb); Marshal.Copy(resultBuffer, 0, resultData.Scan0, resultBuffer.Length); resultBitmap.UnlockBits(resultData); return resultBitmap; } string path = @""E:\lena.png""; string path2 = @""E:\mask.png""; Bitmap _inputImage; Bitmap _maskImage; private void LoadImages_Click(object sender, EventArgs e) { _inputImage = Grayscale.ToGrayscale(Bitmap.FromFile(path) as Bitmap); /* _maskImage = Grayscale.ToGrayscale(Bitmap.FromFile(path2) as Bitmap); */ SharpenFilter filter = new SharpenFilter(); double[,] mask = new double[,] { { -1, -1, -1, }, { -1, 9, -1, }, { -1, -1, -1, }, }; _maskImage = ImageDataConverter.ToBitmap(mask); inputImagePictureBox.Image = _inputImage; maskPictureBox.Image = _maskImage; } Bitmap _paddedImage; Bitmap _paddedMask; private void padButton_Click(object sender, EventArgs e) { Bitmap lena = Grayscale.ToGrayscale(_inputImage); Bitmap mask = Grayscale.ToGrayscale(_maskImage); ////Not working... //int maxWidth = (int)Math.Max(lena.Width, mask.Width); //int maxHeight = (int)Math.Max(lena.Height, mask.Height); ////This is working correctly in case if I use a png image as a mask. int maxWidth = (int)Tools.ToNextPow2(Convert.ToUInt32(lena.Width + mask.Width)); int maxHeight = (int)Tools.ToNextPow2(Convert.ToUInt32(lena.Height + mask.Height)); _paddedImage = ImagePadder.Pad(lena, maxWidth, maxHeight); _paddedMask = ImagePadder.Pad(mask, maxWidth, maxHeight); paddedImagePictureBox.Image = _paddedImage; paddedMaskPictureBox.Image = _paddedMask; } private void filterButton_Click(object sender, EventArgs e) { // Not working properly. // Freezes the application. Bitmap sharp = SharpenFilter.ApplyWithPadding(_paddedImage, _paddedMask); ////Works well. But, very slow. //Bitmap sharp = SharpenFilter.Apply(_paddedImage); filteredPictureBox.Image = sharp as Bitmap; }",FFT Convolution - 3x3 kernel
Image Sharpening through FFT Convolution," I have written some routines to sharpen a Grayscale image using a 3x3 kernel, The following code is working well in case of non-FFT (spatial-domain) convolution, but, not working in FFT-based (frequency-domain) convolution.The output image seems to be blurred.I have several problems:(1) This routine is not being able to generate desired result. It also freezes the application. (2) This routine gives good result. But, as slow as hell. (3) The following is my GUI code. SharpenFilter.ApplyWithPadding() works properly if I use an image as a mask. But, doesn't work if I use a, say, 3x3 kernel. Output:Source Code :You can download the entire solution from here in this link. <code>  -1 -1 -1 -1 9 -1 -1 -1 -1 public static Bitmap ApplyWithPadding(Bitmap image, Bitmap mask) { if(image.PixelFormat == PixelFormat.Format8bppIndexed) { Bitmap imageClone = (Bitmap)image.Clone(); Bitmap maskClone = (Bitmap)mask.Clone(); ///////////////////////////////////////////////////////////////// Complex[,] cPaddedLena = ImageDataConverter.ToComplex(imageClone); Complex[,] cPaddedMask = ImageDataConverter.ToComplex(maskClone); Complex[,] cConvolved = Convolution.Convolve(cPaddedLena, cPaddedMask); return ImageDataConverter.ToBitmap(cConvolved); } else { throw new Exception(""not a grascale""); } } public static Bitmap Apply(Bitmap sourceBitmap) { Sharpen filter = new Sharpen(); BitmapData sourceData = sourceBitmap.LockBits(new Rectangle(0, 0, sourceBitmap.Width, sourceBitmap.Height), ImageLockMode.ReadOnly, PixelFormat.Format32bppArgb); byte[] pixelBuffer = new byte[sourceData.Stride * sourceData.Height]; byte[] resultBuffer = new byte[sourceData.Stride * sourceData.Height]; Marshal.Copy(sourceData.Scan0, pixelBuffer, 0, pixelBuffer.Length); sourceBitmap.UnlockBits(sourceData); double blue = 0.0; double green = 0.0; double red = 0.0; int filterWidth = filter.FilterMatrix.GetLength(1); int filterHeight = filter.FilterMatrix.GetLength(0); int filterOffset = (filterWidth - 1) / 2; int calcOffset = 0; int byteOffset = 0; for (int offsetY = filterOffset; offsetY < sourceBitmap.Height - filterOffset; offsetY++) { for (int offsetX = filterOffset; offsetX < sourceBitmap.Width - filterOffset; offsetX++) { blue = 0; green = 0; red = 0; byteOffset = offsetY * sourceData.Stride + offsetX * 4; for (int filterY = -filterOffset; filterY <= filterOffset; filterY++) { for (int filterX = -filterOffset; filterX <= filterOffset; filterX++) { calcOffset = byteOffset + (filterX * 4) + (filterY * sourceData.Stride); blue += (double)(pixelBuffer[calcOffset]) * filter.FilterMatrix[filterY + filterOffset, filterX + filterOffset]; green += (double)(pixelBuffer[calcOffset + 1]) * filter.FilterMatrix[filterY + filterOffset, filterX + filterOffset]; red += (double)(pixelBuffer[calcOffset + 2]) * filter.FilterMatrix[filterY + filterOffset, filterX + filterOffset]; } } blue = filter.Factor * blue + filter.Bias; green = filter.Factor * green + filter.Bias; red = filter.Factor * red + filter.Bias; if (blue > 255) { blue = 255; } else if (blue < 0) { blue = 0; } if (green > 255) { green = 255; } else if (green < 0) { green = 0; } if (red > 255) { red = 255; } else if (red < 0) { red = 0; } resultBuffer[byteOffset] = (byte)(blue); resultBuffer[byteOffset + 1] = (byte)(green); resultBuffer[byteOffset + 2] = (byte)(red); resultBuffer[byteOffset + 3] = 255; } } Bitmap resultBitmap = new Bitmap(sourceBitmap.Width, sourceBitmap.Height); BitmapData resultData = resultBitmap.LockBits(new Rectangle(0, 0, resultBitmap.Width, resultBitmap.Height), ImageLockMode.WriteOnly, PixelFormat.Format32bppArgb); Marshal.Copy(resultBuffer, 0, resultData.Scan0, resultBuffer.Length); resultBitmap.UnlockBits(resultData); return resultBitmap; } string path = @""E:\lena.png""; string path2 = @""E:\mask.png""; Bitmap _inputImage; Bitmap _maskImage; private void LoadImages_Click(object sender, EventArgs e) { _inputImage = Grayscale.ToGrayscale(Bitmap.FromFile(path) as Bitmap); /* _maskImage = Grayscale.ToGrayscale(Bitmap.FromFile(path2) as Bitmap); */ SharpenFilter filter = new SharpenFilter(); double[,] mask = new double[,] { { -1, -1, -1, }, { -1, 9, -1, }, { -1, -1, -1, }, }; _maskImage = ImageDataConverter.ToBitmap(mask); inputImagePictureBox.Image = _inputImage; maskPictureBox.Image = _maskImage; } Bitmap _paddedImage; Bitmap _paddedMask; private void padButton_Click(object sender, EventArgs e) { Bitmap lena = Grayscale.ToGrayscale(_inputImage); Bitmap mask = Grayscale.ToGrayscale(_maskImage); ////Not working... //int maxWidth = (int)Math.Max(lena.Width, mask.Width); //int maxHeight = (int)Math.Max(lena.Height, mask.Height); ////This is working correctly in case if I use a png image as a mask. int maxWidth = (int)Tools.ToNextPow2(Convert.ToUInt32(lena.Width + mask.Width)); int maxHeight = (int)Tools.ToNextPow2(Convert.ToUInt32(lena.Height + mask.Height)); _paddedImage = ImagePadder.Pad(lena, maxWidth, maxHeight); _paddedMask = ImagePadder.Pad(mask, maxWidth, maxHeight); paddedImagePictureBox.Image = _paddedImage; paddedMaskPictureBox.Image = _paddedMask; } private void filterButton_Click(object sender, EventArgs e) { // Not working properly. // Freezes the application. Bitmap sharp = SharpenFilter.ApplyWithPadding(_paddedImage, _paddedMask); ////Works well. But, very slow. //Bitmap sharp = SharpenFilter.Apply(_paddedImage); filteredPictureBox.Image = sharp as Bitmap; }",FFT Convolution - 3x3 kernel
FFT-based Convolution," I have written some routines to sharpen a Grayscale image using a 3x3 kernel, The following code is working well in case of non-FFT (spatial-domain) convolution, but, not working in FFT-based (frequency-domain) convolution.The output image seems to be blurred.I have several problems:(1) This routine is not being able to generate desired result. It also freezes the application. (2) This routine gives good result. But, as slow as hell. (3) The following is my GUI code. SharpenFilter.ApplyWithPadding() works properly if I use an image as a mask. But, doesn't work if I use a, say, 3x3 kernel. Output:Source Code :You can download the entire solution from here in this link. <code>  -1 -1 -1 -1 9 -1 -1 -1 -1 public static Bitmap ApplyWithPadding(Bitmap image, Bitmap mask) { if(image.PixelFormat == PixelFormat.Format8bppIndexed) { Bitmap imageClone = (Bitmap)image.Clone(); Bitmap maskClone = (Bitmap)mask.Clone(); ///////////////////////////////////////////////////////////////// Complex[,] cPaddedLena = ImageDataConverter.ToComplex(imageClone); Complex[,] cPaddedMask = ImageDataConverter.ToComplex(maskClone); Complex[,] cConvolved = Convolution.Convolve(cPaddedLena, cPaddedMask); return ImageDataConverter.ToBitmap(cConvolved); } else { throw new Exception(""not a grascale""); } } public static Bitmap Apply(Bitmap sourceBitmap) { Sharpen filter = new Sharpen(); BitmapData sourceData = sourceBitmap.LockBits(new Rectangle(0, 0, sourceBitmap.Width, sourceBitmap.Height), ImageLockMode.ReadOnly, PixelFormat.Format32bppArgb); byte[] pixelBuffer = new byte[sourceData.Stride * sourceData.Height]; byte[] resultBuffer = new byte[sourceData.Stride * sourceData.Height]; Marshal.Copy(sourceData.Scan0, pixelBuffer, 0, pixelBuffer.Length); sourceBitmap.UnlockBits(sourceData); double blue = 0.0; double green = 0.0; double red = 0.0; int filterWidth = filter.FilterMatrix.GetLength(1); int filterHeight = filter.FilterMatrix.GetLength(0); int filterOffset = (filterWidth - 1) / 2; int calcOffset = 0; int byteOffset = 0; for (int offsetY = filterOffset; offsetY < sourceBitmap.Height - filterOffset; offsetY++) { for (int offsetX = filterOffset; offsetX < sourceBitmap.Width - filterOffset; offsetX++) { blue = 0; green = 0; red = 0; byteOffset = offsetY * sourceData.Stride + offsetX * 4; for (int filterY = -filterOffset; filterY <= filterOffset; filterY++) { for (int filterX = -filterOffset; filterX <= filterOffset; filterX++) { calcOffset = byteOffset + (filterX * 4) + (filterY * sourceData.Stride); blue += (double)(pixelBuffer[calcOffset]) * filter.FilterMatrix[filterY + filterOffset, filterX + filterOffset]; green += (double)(pixelBuffer[calcOffset + 1]) * filter.FilterMatrix[filterY + filterOffset, filterX + filterOffset]; red += (double)(pixelBuffer[calcOffset + 2]) * filter.FilterMatrix[filterY + filterOffset, filterX + filterOffset]; } } blue = filter.Factor * blue + filter.Bias; green = filter.Factor * green + filter.Bias; red = filter.Factor * red + filter.Bias; if (blue > 255) { blue = 255; } else if (blue < 0) { blue = 0; } if (green > 255) { green = 255; } else if (green < 0) { green = 0; } if (red > 255) { red = 255; } else if (red < 0) { red = 0; } resultBuffer[byteOffset] = (byte)(blue); resultBuffer[byteOffset + 1] = (byte)(green); resultBuffer[byteOffset + 2] = (byte)(red); resultBuffer[byteOffset + 3] = 255; } } Bitmap resultBitmap = new Bitmap(sourceBitmap.Width, sourceBitmap.Height); BitmapData resultData = resultBitmap.LockBits(new Rectangle(0, 0, resultBitmap.Width, resultBitmap.Height), ImageLockMode.WriteOnly, PixelFormat.Format32bppArgb); Marshal.Copy(resultBuffer, 0, resultData.Scan0, resultBuffer.Length); resultBitmap.UnlockBits(resultData); return resultBitmap; } string path = @""E:\lena.png""; string path2 = @""E:\mask.png""; Bitmap _inputImage; Bitmap _maskImage; private void LoadImages_Click(object sender, EventArgs e) { _inputImage = Grayscale.ToGrayscale(Bitmap.FromFile(path) as Bitmap); /* _maskImage = Grayscale.ToGrayscale(Bitmap.FromFile(path2) as Bitmap); */ SharpenFilter filter = new SharpenFilter(); double[,] mask = new double[,] { { -1, -1, -1, }, { -1, 9, -1, }, { -1, -1, -1, }, }; _maskImage = ImageDataConverter.ToBitmap(mask); inputImagePictureBox.Image = _inputImage; maskPictureBox.Image = _maskImage; } Bitmap _paddedImage; Bitmap _paddedMask; private void padButton_Click(object sender, EventArgs e) { Bitmap lena = Grayscale.ToGrayscale(_inputImage); Bitmap mask = Grayscale.ToGrayscale(_maskImage); ////Not working... //int maxWidth = (int)Math.Max(lena.Width, mask.Width); //int maxHeight = (int)Math.Max(lena.Height, mask.Height); ////This is working correctly in case if I use a png image as a mask. int maxWidth = (int)Tools.ToNextPow2(Convert.ToUInt32(lena.Width + mask.Width)); int maxHeight = (int)Tools.ToNextPow2(Convert.ToUInt32(lena.Height + mask.Height)); _paddedImage = ImagePadder.Pad(lena, maxWidth, maxHeight); _paddedMask = ImagePadder.Pad(mask, maxWidth, maxHeight); paddedImagePictureBox.Image = _paddedImage; paddedMaskPictureBox.Image = _paddedMask; } private void filterButton_Click(object sender, EventArgs e) { // Not working properly. // Freezes the application. Bitmap sharp = SharpenFilter.ApplyWithPadding(_paddedImage, _paddedMask); ////Works well. But, very slow. //Bitmap sharp = SharpenFilter.Apply(_paddedImage); filteredPictureBox.Image = sharp as Bitmap; }",FFT Convolution - 3x3 kernel
Rotating cursor," Is it possible to rotate FrameworkElement.Cursor?My application allows user to rotate objects around their center. Once rotated, default resize cursors appear awkward on top of tilted borders.My first thought was to apply RotateTransform to the Cursor property, but it looks like we can't do that in XAML. Next I tried inheriting from Cursor class, but it looks like MS guys have sealed it.Another way is to set default cursor to None and use my own image (with transform) and set its position upon MouseMove. I'm not willing to go down that path if there are easier alternatives. Anyone with a good suggestion?I'm looking for a WPF-only solution if at all possible. <code> ",Rotating cursor without using WinForms
c# kinect : How to determine if 4 points are on same plain," I'm choosing 4 points from an image outputted by Kinect therefor each point has its (x, y, z) coordinates.My objective is to determine whether the 4 points fall on the same plane.This is my function: The normal is also the normal (a cross product of 2 vectors on the plane, which been previously calculated from 3 out of 4 of the chosen points) to the plane and it's normalized: Vector3D is a class to represent a vector: i always get 1300 <= absPlaneEquation <= 1400 even when the 4 points are chosen so that they won't be on the same plane.What is the best way to detect that the 4 points refer to the same plane? <code>  public bool isValidPlane() { for (int i = 0; i < edgesPoints.Length; i++) { double absPlaneEquation = Math.Abs(distance - (normal.X * edgesPoints[i].X + normal.Y * edgesPoints[i].Y + normal.Z * edgesPoints[i].Z)); if (absPlaneEquation > 1500) /* 1500 is a tolerance error*/ { return false; } } return true; } private void calcPlaneNormalVector() { if (lastEdgeNumber < 3) { return; } Vector3D vec1 = new Vector3D(edgesPoints[0], edgesPoints[1]); Vector3D vec2 = new Vector3D(edgesPoints[0], edgesPoints[2]); vec2 = vec1.crossProduct(vec2); double lengthNormal = Math.Sqrt(Math.Pow(vec2.X, 2) + Math.Pow(vec2.Y, 2) + Math.Pow(vec2.Z, 2));//normalizing: normal = new Vector3D((vec2.X / lengthNormal), (vec2.Y / lengthNormal), (vec2.Z / lengthNormal)); distance = (-1) * (edgesPoints[0].X * normal.X + edgesPoints[0].Y * normal.Y + edgesPoints[0].Z + normal.Z); } public class Vector3D{ private double x, y, z; public Vector3D(Point3D p1, Point3D p2) { x = p2.X - p1.X; y = p2.Y - p1.Y; z = p2.Z - p1.Z; } public Vector3D(double a = 0, double b = 0, double c = 0) { x = a; y = b; z = c; } <get properties for x, y, z > public Vector3D crossProduct(Vector3D u) { double tmpX = 0, tmpY = 0, tmpZ = 0; tmpX = y * u.Z - z * u.Y; tmpY = z * u.X - x * u.Z; tmpZ = x * u.Y - y * u.X; return new Vector3D(tmpX, tmpY, tmpZ); } public double dotProduct(Vector3D u) { return x * u.X + y * u.Y + z * u.Z; }}",How to determine if 4 points are on same plane
c# kinect : How to determine if 4 points are on same plane," I'm choosing 4 points from an image outputted by Kinect therefor each point has its (x, y, z) coordinates.My objective is to determine whether the 4 points fall on the same plane.This is my function: The normal is also the normal (a cross product of 2 vectors on the plane, which been previously calculated from 3 out of 4 of the chosen points) to the plane and it's normalized: Vector3D is a class to represent a vector: i always get 1300 <= absPlaneEquation <= 1400 even when the 4 points are chosen so that they won't be on the same plane.What is the best way to detect that the 4 points refer to the same plane? <code>  public bool isValidPlane() { for (int i = 0; i < edgesPoints.Length; i++) { double absPlaneEquation = Math.Abs(distance - (normal.X * edgesPoints[i].X + normal.Y * edgesPoints[i].Y + normal.Z * edgesPoints[i].Z)); if (absPlaneEquation > 1500) /* 1500 is a tolerance error*/ { return false; } } return true; } private void calcPlaneNormalVector() { if (lastEdgeNumber < 3) { return; } Vector3D vec1 = new Vector3D(edgesPoints[0], edgesPoints[1]); Vector3D vec2 = new Vector3D(edgesPoints[0], edgesPoints[2]); vec2 = vec1.crossProduct(vec2); double lengthNormal = Math.Sqrt(Math.Pow(vec2.X, 2) + Math.Pow(vec2.Y, 2) + Math.Pow(vec2.Z, 2));//normalizing: normal = new Vector3D((vec2.X / lengthNormal), (vec2.Y / lengthNormal), (vec2.Z / lengthNormal)); distance = (-1) * (edgesPoints[0].X * normal.X + edgesPoints[0].Y * normal.Y + edgesPoints[0].Z + normal.Z); } public class Vector3D{ private double x, y, z; public Vector3D(Point3D p1, Point3D p2) { x = p2.X - p1.X; y = p2.Y - p1.Y; z = p2.Z - p1.Z; } public Vector3D(double a = 0, double b = 0, double c = 0) { x = a; y = b; z = c; } <get properties for x, y, z > public Vector3D crossProduct(Vector3D u) { double tmpX = 0, tmpY = 0, tmpZ = 0; tmpX = y * u.Z - z * u.Y; tmpY = z * u.X - x * u.Z; tmpZ = x * u.Y - y * u.X; return new Vector3D(tmpX, tmpY, tmpZ); } public double dotProduct(Vector3D u) { return x * u.X + y * u.Y + z * u.Z; }}",How to determine if 4 points are on same plane
.NET. Why ServicePointManager.SecurityProtocol default value is different on different machines?," Currently I have an issue and can't find strict answer on it. I have ASP.NET MVC 5 application targeting 4.6.1 framework and its goal is to work with third party API's that are secured by TLS 1.1/TLS 1.2 protocols.I have tried to run my application on 2 environments: my local machine Windows 10 with .NET 4.6.2 Framework, IIS Express;server machine Windows Server 2012 with .NET 4.6.1, IIS 8.0;The issue is in that when I start it locally ServicePointManager.SecurityProtocol default value is set to Ssl3, Tls, so I can't target API's and have to code it on application start to use TLS 1.1/TLS 1.2: ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls11 | SecurityProtocolType.Tls12.When application runs on server default value ServicePointManager.SecurityProtocol is set to Tls, Tls11, Tls12, so it works well.According to documentation applications run on .NET Framework 4.6 or above versions have to use TLS 1.1/TLS 1.2 by default, how it is on remote machine.Why the default values of ServicePointManager.SecurityProtocol are different? Is it because .NET Framework configuration? Or maybe registry settings? I have searched through it but couldn't find an answer. <code> ",Why ServicePointManager.SecurityProtocol default value is different on different machines?
c# binary serialization without srializable attribute," I want to serailize my object and used BinaryFormatter class. But when I run the code, throws an exception. SerializationException: Object is not marked as serializable.I think this exception thrown by BinaryFormatter.I do not want to mark as [Serializable] my objects. Or my library users may forget mark as [Serializable] their own Messages.Is there any other way to binary serialize my objects without using [Serializable] attribute? <code>  public static byte[] BinarySerialize(IMessage message){ using (var stream = new MemoryStream()) { var formatter = new BinaryFormatter(); formatter.Serialize(stream, message); return stream.ToArray(); }}",Binary serialization without serializable attribute
Is async partial void MyPartialMethod a good idea?," I've seen a lot of warnings about writing code such as... I've read that its OK with Eventhandlers as they must return void. However partial methods must also return void. You can have the following code... and then implement as... But what will happen to the application if the implementation of MyCustomCode encounters an exception? If it's a no go, given how prevalent async / await is, does that mean partial methods are essentially obsolete? Should code generation systems stop exposing partial methods in favour of events or perhaps better still empty protected virtual methods in a base class? i.e. EDIT: OK so I've made several updates to the code. After the original pseudo code I wrote didn't get well received. The code above I think demonstrates that there's definitely an issue with async partial void MyPartialMethod as the call to MyCodeGeneratedMethod does seem to bring down the app domain, despite the try catch around the call. I'm just wondering if there are better options than moving to protected virtual base class methods. <code>  public async void MyDangerousMethodWhichCouldCrashMyApp... static void Main(string[] args){ MainAsync().Wait(); Console.ReadLine();}async static Task MainAsync(){ MyCodeGeneratedClass c = new MyCodeGeneratedClass(); try { await c.MyCodeGeneratedMethod(); } catch(Exception ex) { Console.WriteLine(ex.Message); }}public partial class MyCodeGeneratedClass{ public async Task MyCodeGeneratedMethod() { HttpClient client = new HttpClient(); Console.WriteLine(await client.GetStringAsync(""http://msdn.microsoft.com"")); MyCustomCode(); } partial void MyCustomCode();} partial class MyCodeGeneratedClass{ async partial void MyCustomCode() { HttpClient client = new HttpClient(); Console.WriteLine(await client.GetStringAsync(""http://msdn.microsoft.com"")); throw new Exception(""Boom""); }} protected virtual Task MyCustomCode(T foo){ return Task.FromResult(0);}",Is async partial void MyPartialMethod() dangerous?
how can i self register a service to consul," I'm trying to self register my ASP.NET Core application to Consul registry on startup and deregister it on shutdown.From here I can gather that calling the http api [put /v1/agent/service/register] might be the way to go (or maybe not!).From my app, I thought I'll target the Startup class, starting with adding the my .json file But now, I'm stuck as ConfigureServices method tells me thats where I add services to the container, and Configure method is where I configure the Http request pipeline.Anybody to point me in the right directions, online readings, examples, etc.  <code>  public Startup(IHostingEnvironment env){ var builder = new Configuration().AddJsonFile(""consulconfig.json""); Configuration = builder.Build();}",How to self register a service with Consul
I can't figure out on how to change my C# VB cursor on hover," I can't find out on how I can change my cursor to a ""pointer"" or whatever it's called while hovering an image.I have tried with MouseOver but I can't get it to work. Here's my current code; However, the cursor doesn't change. <code>  private void image_Phone_MouseOver(object sender, EventArgs e){ Cursor.Current = Cursors.Hand;}",How to change the cursor on hover in C#
"C# - Is the ""when"" keyword in a try catch block the same as a if statement?"," In C# 6.0 the ""when"" keyword was introduced, now you're able to filter an exception in a catch block. But isn't this the same as a if statement inside a catch block? if so, isn't it just syntactic sugar or i'm missing something?For example a try catch block with the ""when"" keyword: Or <code>  try { } catch (WebException ex) when ex.Status == WebExceptionStatus.Timeout { //do something}catch (WebException ex) when ex.Status== WebExceptionStatus.SendFailure { //do something}catch (Exception caught) {} try { } catch (WebException ex) { if(ex.Status == WebExceptionStatus.Timeout) { //do something }}catch (WebException ex) { if(ex.Status == WebExceptionStatus.SendFailure) { //do something }}catch (Exception caught) {}","Is the ""when"" keyword in a try catch block the same as an if statement?"
"Is the ""when"" keyword in a try catch block the same as a if statement?"," In C# 6.0 the ""when"" keyword was introduced, now you're able to filter an exception in a catch block. But isn't this the same as a if statement inside a catch block? if so, isn't it just syntactic sugar or i'm missing something?For example a try catch block with the ""when"" keyword: Or <code>  try { } catch (WebException ex) when ex.Status == WebExceptionStatus.Timeout { //do something}catch (WebException ex) when ex.Status== WebExceptionStatus.SendFailure { //do something}catch (Exception caught) {} try { } catch (WebException ex) { if(ex.Status == WebExceptionStatus.Timeout) { //do something }}catch (WebException ex) { if(ex.Status == WebExceptionStatus.SendFailure) { //do something }}catch (Exception caught) {}","Is the ""when"" keyword in a try catch block the same as an if statement?"
LINQ to Entities does not recognize the method," Overview:In CompletedQuestions table, UserId corresponds to the user which completed that question. Id property corresponds to one of the questions in the Questions table. I know, i didn't specify relationships properly. But i'm not very experienced. I just want to finish a project, then i will come back and fix those bad coding practices once i learn more. I couldn't understand the following exception. The action where the exception occured: CompletedQuestion model: Question model: <code>  LINQ to Entities does not recognize the method 'Riddle.Models.CompletedQuestion LastOrDefault[CompletedQuestion](System.Linq.IQueryable`1[Riddle.Models.CompletedQuestion])' method, and this method cannot be translated into a store expression. Line 46: if (RiddleCompleted == null) Line 47: { Line 48: var lastCompletedQuestion = _db.CompletedQuestions.Where(q => q.UserId == currentUserId) // exception occurs in this line Line 49: .OrderBy(q => q.QuestionNumber) Line 50: .LastOrDefault(); public ActionResult Riddle(int Id) { string currentUserId = User.Identity.GetUserId(); var riddle = _db.Riddles.Where(r => r.Id == Id).Single(); if (riddle.User.Id == User.Identity.GetUserId()) { var question = riddle.Questions.Where(q => q.QuestionNumber == 1).SingleOrDefault(); if (question == null) { return View(""NoMoreQuestions""); } return View(""RiddleOwner"", question); } else { var RiddleCompleted = _db.CompletedRiddles.Where(r => r.Id == Id && r.UserId == currentUserId).SingleOrDefault(); if (RiddleCompleted == null) { var lastCompletedQuestion = _db.CompletedQuestions.Where(q => q.UserId == currentUserId) // exception occurs in this line .OrderBy(q => q.QuestionNumber) .LastOrDefault(); if (lastCompletedQuestion == null) { var question = riddle.Questions.Where(q => q.QuestionNumber == 1).Single(); return View(question); } else { var question = riddle.Questions.Where(q => q.QuestionNumber == lastCompletedQuestion.QuestionNumber + 1).SingleOrDefault(); return View(question); } } else { return View(""NoMoreQuestions""); } } } public class CompletedQuestion{ public int Id { get; set; } public string UserId { get; set; } public int QuestionNumber { get; set; }} public class Question { public int Id { get; set; } public string Body { get; set; } public string Answer { get; set; } public Riddle Riddle { get; set; } [Column(TypeName =""datetime2"")] public DateTime CreationDate { get; set; } public int QuestionNumber { get; set; } }",LINQ to Entities does not recognize the method: LastOrDefault
What is the correct way to encode from jquery and decode on asp.net-mvc server side?," I am programatically reading data from a text input using standard Jquery like this: and then I am adding a hidden input field into a form before submitting like this: In one example, the value in the field is: so on the UI it looks like this when I submit the form using: and check it on the asp.net-mvc server side i only see: being sent over. After some research, it was suggested to write some javascript to run the value through: After doing that and taking a look at the server side, I now see: How can I convert that back to on the C# asp.net-mvc server side? Or Seperately, if I am doing something wrong on the client side, please let me if you have any suggestions.My main question is why do i have to worry about encoding the value of a hidden input box in a form. I would have thought this would be taken care of for you. <code>  var listName = $('#list').val(); var myForm = $(""#myForm);myForm.append('<input type=""hidden"" name=""List"" value=""' + listName + '"" />'); Key Date & Times <input type=""hidden"" name=""MyList"" value=""Key Date & Times"" /> var myForm = $(""#myForm);myForm.submit(); Key Date encodeURIComponent() Key%20Date%20%26%20Times Key Date & Times",Why do I have to encode a string when reading and writing form inputs using jquery?
"C# search all files in a directory that contain a string, then parsing the string"," Using user input into a textbox, I want to search for which file in the directory contains that text. I would then like to parse out the information but I can't seem to find the string or at least return the information. Any help would be greatly appreciated. My current code: <code>  private void btnSearchSerial_Click(object sender, EventArgs e){ dynamic dirScanner = @""\\mypath\""; string strSerial; string strSID; string strInputLine; string strOutput; strSerial = Convert.ToString(txtSerialSearch); strSID = Convert.ToString(txtSID); if (txtSerialSearch.Text != """" && txtSID.Text != """") { try { string[] allFiles = Directory.GetFiles(dirScanner); foreach (string file in allFiles) { if (file.EndsWith("".txt"")) { using (StreamReader sr = new StreamReader(file)) { while (sr.Peek() >= 0) { strInputLine = sr.ReadLine(); if (strInputLine.Contains(strSerial)) { strOutput = Convert.ToString(strInputLine); lblOutput.Text = Convert.ToString(strOutput); } } } } } } }}","C# search all files in a directory that contain a string, then return that string"
"C# search all files in a directory that contain a string, then parse the string"," Using user input into a textbox, I want to search for which file in the directory contains that text. I would then like to parse out the information but I can't seem to find the string or at least return the information. Any help would be greatly appreciated. My current code: <code>  private void btnSearchSerial_Click(object sender, EventArgs e){ dynamic dirScanner = @""\\mypath\""; string strSerial; string strSID; string strInputLine; string strOutput; strSerial = Convert.ToString(txtSerialSearch); strSID = Convert.ToString(txtSID); if (txtSerialSearch.Text != """" && txtSID.Text != """") { try { string[] allFiles = Directory.GetFiles(dirScanner); foreach (string file in allFiles) { if (file.EndsWith("".txt"")) { using (StreamReader sr = new StreamReader(file)) { while (sr.Peek() >= 0) { strInputLine = sr.ReadLine(); if (strInputLine.Contains(strSerial)) { strOutput = Convert.ToString(strInputLine); lblOutput.Text = Convert.ToString(strOutput); } } } } } } }}","C# search all files in a directory that contain a string, then return that string"
C# possible to cast to interface that isn't inherited?, Why isn't it possible to cast an instance of: ...to this interface: ...even though Foo has the signature of IBar?How can I turn an instance of Foo into an IBar? Assume I have no control over Foo. <code>  sealed class Foo{ public void Go() { }} interface IBar{ void Go();},Possible to cast to interface that isn't inherited?
C# algorithm complexity in online test," I had to complete an online programming test for an internship, and got a question on complexity analysis. I answered the question and it was marked wrong, and I would just like to understand why, so I can improve.The Question: Give the complexity for the following algorithm when reverseOrder is true and when it is false: EDIT: It was multi-choice, and the possible answers were:O(1)O(nlogn)O(n)O(n^2)You could choose one for when reverseOrder is true, and another for when it is false.My Answer:When reverseOrder is true: O(n2)When reverseOrder is false: O(n2)I got to this answer by way of the following:The while loop will iterate n times, because it continues until there is no element left to pop offPop() is O(1)In the case of reverseOrder being true, an Insert to the front of the list is made. Since List<T> is backed by an array, it is dynamically resized and every element is moved up one space, and the element gets inserted at index 0. According to https://msdn.microsoft.com/en-us/library/sey5k5z4(v=vs.110).aspx : This method is an O(n) operation, where n is Count.In the case of reverseOrder being false, an Add is made to append an item to the back of the list. Since items is not given an initial size, Count is never less than Capacity, resulting in a resize, so according to https://msdn.microsoft.com/en-us/library/3wcytfd1(v=vs.110).aspx : If Count is less than Capacity, this method is an O(1) operation. If the capacity needs to be increased to accommodate the new element, this method becomes an O(n) operation, where n is Count.I am feeling quite discouraged at the moment, since getting this wrong caused my score to plummet, even though I got all the other questions on the test correct. <code>  List<int> stackToList(Stack<int> stack, bool reverseOrder) { List<int> items = new List<int>(); while (stack.Count > 0) { int item = stack.Pop(); if (reverseOrder) { items.Insert(0, item); } else { items.Add(item); } } return items;}",Algorithm complexity in online test
External/Internal Parameter Names in C#," Is there a way in C# to be able to refer to a a parameter by both an internal and external name (in Swift this is known as argument labels/parameters)? What I mean is suppose I have the following: Internally, I refer to the id as sportID, but externally, the parameter is known as id. <code>  public static class Sport{ public static void Print(int id sportID) { Console.Out.WriteLine(sportID); }}public static void main(){ Sport.Print(id: 123);}",Argument Labels in C#
How make default value for struct c#?," I'm trying to make default value for my struct. For example default value for Int - 0, for DateTime - 1/1/0001 12:00:00 AM.As known we can't define parameterless constructor in structure. How can I make a default value for struct? <code>  struct Test{ int num; string str;}class Program{ static void Main(string[] args) { Console.WriteLine(default(Test)); // shows namespace and name of struct test.Test Console.WriteLine(new Test()); // same Console.ReadKey(true); }}",How to make a default value for the struct in C#?
Public readonly property v.s. get-only property, Are there cases when you would want a public readonly field v.s. a get-only auto-implemented property? Both can only be set during the constructor and both offer readonly access outside of the class.. I'm a little tired so I might be missing something. <code>  public class Foo{ public readonly string Hello; public string Hello2 { get; }},Public readonly field v.s. get-only property
"An attempt to attach an auto-named database for file ''.mdf failed.A database with the same name exists, or"," I am developing a C# windows form application containing a service based data based. when I test my application it's database works fine but after publishing and installing the program when program tries to open sqlconnection , this error appears: System.Data.SqlClient.SqlException (0x80131904): An attempt to attach an auto-named database for file C:\Users\Behnam\AppData\Local\Apps\2.0\Data\5XVOVXV1.3VG\M5T04ZK7.QBJ\tahl..tion_45c3791d6509222d_0001.0000_be1c7cc05811ecf0\Data\AppData\TahlilGar.mdf failed. A database with the same name exists, or specified file cannot be opened, or it is located on UNC share.This is my ConnectionString: I also tried : User Instance= True; but it's result is : The user instance login flag is not allowed when connecting to a user instance of SQL Server. The connection will be closed.How can I fix this issue?Edit: I checked the mentioned path and there was not my .mdf file. so i copied it from my project and it worked fine after that. now why my mdf file is not copying when publishing and installing in the expected path.  <code>  <add name=""BA"" connectionString=""Data Source=(LocalDB)\v11.0;AttachDbFilename=|DataDirectory|\AppData\TahlilGar.mdf;Integrated Security=True;""providerName=""System.Data.SqlClient"" />",Database file not copied during publishing so installed application throws exception
Deserialize error with adding more serialized variables for saving/loading in Unity," I have been messing around with saving and loading in Unity in which I save a serialized class to a file. I have a Serializable class : and save it to a file A-OK. I can load it with no errors but if I wanted to add later : and I run my scripts it gives me a deserialization error which I completely understand as when I cast the deserialized file to my new class 'Saved' the new variable I added doesn't exist and it gives me the error. I found this error when I was fixing an Asset in the store and I know one fix can be just change the filename so a new file is created but I don't just want to wipe the contents of what was saved before. So my question is, if I wanted to add more variables to my serialized class how would I catch and adjust to old versions of it if people were to update the asset?Thanks! <code>  [Serializable]class Save{ public List<int> ID = new List<int>(); public List<int> Amounts = new List<int>();} [Serializable]class Save{ public List<int> ID = new List<int>(); public List<int> Amounts = new List<int>(); public int extra = 0;}",Saving/loading data in Unity
PayPal for ASP.NET Core, How do I integrate with the PayPal API in an ASP.NET Core app? I have tried various libraries but none of them are compatible with ASP.NET Core... how do I do it? <code> ,PayPal in ASP.NET Core
"In .NET Framework 4.6.2 the FormattedText() is Obsoleted, how can i fixed it"," When I try to build the WPF project with .net framework 4.6.2, I got an error, Because the FormattedText() is Obsoleted as below: [Obsolete(""Use the PixelsPerDip override"", false)] public FormattedText(string textToFormat, CultureInfo culture, FlowDirection flowDirection, Typeface typeface, double emSize, Brush foreground);The new override method is public FormattedText(string textToFormat, CultureInfo culture, FlowDirection flowDirection, Typeface typeface, double emSize, Brush foreground, double pixelsPerDip);Q: How can I determine the pixelsPerDip ?Q: How can I use old constructor without pixelsPerDip?, because the pixelsPerDip is useless for my project. <code> ","In .NET Framework 4.6.2 the FormattedText() is Obsoleted, how can I fix it"
Nuget: What is the purpose of requireReinstallation tag in packages.config," I upgraded my C# project (which already had some nuget packages) from 4.0 to 4.5.2. I saw that some <package /> elements now contain an additional attribute requireReinstallation=""true"".What is the purpose of this?Why is that some packages have while others don't.Before After <code>  <package id=""NLog"" version=""3.1.0.0"" targetFramework=""net40"" /> <package id=""NLog"" version=""3.1.0.0"" targetFramework=""net40"" requireReinstallation=""true"" />",Nuget: What is the purpose of the <package requireReinstallation /> attribute in packages.config?
ZeroMQ Request Reply pattern with potential drops," I'm trying to implement a ZeroMQ pattern on the TCP layer between a c# application and distributed python servers. I've gotten a version working with the request-reply REQ/REP pattern and it seems relatively stable when testing on localhost. However, in testing, I've debugged a few situations, where I accidently send multiple requests before receiving a reply which apparently is not acceptable.In practice the network will likely have lots of dropped packets and I suspect that I'll be dropping lots of replies and/or unable to send requests.1) Is there a way to reset the connection between REQ/REP request-reply sockets?Would a REOUTER/DEALER pattern instead make more sense? As this is my first application with ZeroMQ, I was hoping to keep it simple.2) Is there a good ZeroMQ mechanism for handling the connectivity events? I've been reading ""the guide"" and there are a few mentions of monitoring connections, but no examples. I found the ZMonitor, but can't get the events to trigger in c#. <code> ",How to protect ZeroMQ Request Reply pattern against potential drops of messages?
Why is this backstage XML not loading the defined user interface?," I have an Office addin which uses the following backstage XML to add custom UI elements into Microsoft Word backstage: This is the exact base-case scenario described here to modify the Save As dialog.On my machine, it does not show anything under Save As. I do however see that the following function gets called when the backstage is shown: What are some of the reasons why the UI will not show, and also, how can I debug what is going on here? I tried turning on Show add-in user interface errors in the Advanced tab of Word Options, under the General section, but it doesn't display any errors to me, as far as I can tell.Not sure if it helps, but our ribbon inherits IRibbonExtensibility.We've also found this logic sometimes works on some machines but not on others. I am clueless as to why...one thing I can tell you that is definitely different is that the types for this addin are registered with regasm instead of the addin being installed using a path|vstolocal registry key under Outlook's registry. In other words, we are using regasm to install the addin.Edit: I have tried the suggested answer but it is still not working given that approach. My team and I are pretty convinced at this point that this is a major VSTO bug and we have cooked up a project to showcase it. This project showcases backstage bugs with Windows 10 Pro 64-bit version 1607 (OS build 14393.351) and 32-bit Word 2016 16.0.7426.1009 (Office 2016 32-bit version 1610, build 7466.2023): https://github.com/Murdoctor/WordAddin1If you run this sample on the same or similar environment, you can see that if you click the Home tab at the top of Word, you will see the button that is defined in https://github.com/Murdoctor/WordAddin1/blob/master/WordAddIn1/Ribbon1.xml, but, if you open up the backstage you don't see the sample tab that should be inserted after the info tab, TabInfo (this screenshot was taken with a release build run in debug mode directly from Visual Studio, and I can see the addin is registered up and everything as well):The only thing that you will see is this (this is also proof the addin is running and registered to its local VSTO file):Edit: This also affects Office 64-bit. I just installed Word 2016 16.0.7426.1009 (Office 2016 64-bit version 1610, build 7466.2023) thinking that changing to x64 might help, but I still experience the same issue on my machine.Edit: This also affects today's release of Windows 10 Pro x64 version 1607, build 14393.447. Also, I have tried disabling all other addins, still the same thing. <code>  <?xml version=""1.0"" encoding=""UTF-8""?><customUI xmlns=""http://schemas.microsoft.com/office/2009/07/customui"" onLoad=""Ribbon_Load""> <backstage onShow=""Backstage_OnShow""> <tab idMso=""TabSave""> <firstColumn> <taskFormGroup idMso=""SaveGroup""> <category idMso=""Save""> <task id=""myCustomTask"" label=""My Custom Task"" insertAfterMso=""ButtonTaskDynamicServiceProvider""> <group id=""myGroupInTabSave"" label=""Custom functionality"" helperText=""This group contains custom functionality.""> <primaryItem> <button id=""myButton"" label=""My Button"" onAction=""CallMe"" /> </primaryItem> </group> </task> </category> </taskFormGroup> </firstColumn> </tab> </backstage></customUI> public void Backstage_OnShow(object contextObject) { // It hits this method.}",Why is this custom backstage UI for Word not displaying its user interface?
Extend IdentutyUser with custom property," I'm using asp.net Identity 2.0 for users to log into my website, where the authentication details are stored in an SQL database. Asp.net Identity has been implemented in a standard way as can be found in many online tutorials.The ApplicationUser class in IdentityModels has been extended to include a custom property: When I register a new user I pass the Code custom property in the RegisterBindingModel but I'm not sure how to insert this custom property to the WebUsers table.I did as bellow but it doesn't actually inserting this property to the table together with the username and password. And the entire function: What am I missing?I was looking at similar questions but couldn't find an answer for this. <code>  public class ApplicationUser : IdentityUser{ public async Task<ClaimsIdentity> GenerateUserIdentityAsync(UserManager<ApplicationUser> manager, string authenticationType) { CookieAuthenticationOptions.AuthenticationType var userIdentity = await manager.CreateIdentityAsync(this, authenticationType); return userIdentity; } //My extended property public string Code { get; set; }} var user = new ApplicationUser() { UserName = userName, Email = model.Email, Code=model.Code }; [AllowAnonymous][Route(""Register"")]public async Task<IHttpActionResult> Register(RegisterBindingModel model) { if (!ModelState.IsValid) { return BadRequest(ModelState); } var userName = !string.IsNullOrEmpty(model.UserName) ? model.UserName : model.Email; //I set it here but it doesn't get inserted to the table. var user = new ApplicationUser() { UserName = userName, Email = model.Email, Code=model.Code }; IdentityResult result = await UserManager.CreateAsync(user, model.Password); if (!result.Succeeded) { return GetErrorResult(result); } return Ok(); }",How to extend IdentityUser with custom property
Extend IdentityUser with custom property," I'm using asp.net Identity 2.0 for users to log into my website, where the authentication details are stored in an SQL database. Asp.net Identity has been implemented in a standard way as can be found in many online tutorials.The ApplicationUser class in IdentityModels has been extended to include a custom property: When I register a new user I pass the Code custom property in the RegisterBindingModel but I'm not sure how to insert this custom property to the WebUsers table.I did as bellow but it doesn't actually inserting this property to the table together with the username and password. And the entire function: What am I missing?I was looking at similar questions but couldn't find an answer for this. <code>  public class ApplicationUser : IdentityUser{ public async Task<ClaimsIdentity> GenerateUserIdentityAsync(UserManager<ApplicationUser> manager, string authenticationType) { CookieAuthenticationOptions.AuthenticationType var userIdentity = await manager.CreateIdentityAsync(this, authenticationType); return userIdentity; } //My extended property public string Code { get; set; }} var user = new ApplicationUser() { UserName = userName, Email = model.Email, Code=model.Code }; [AllowAnonymous][Route(""Register"")]public async Task<IHttpActionResult> Register(RegisterBindingModel model) { if (!ModelState.IsValid) { return BadRequest(ModelState); } var userName = !string.IsNullOrEmpty(model.UserName) ? model.UserName : model.Email; //I set it here but it doesn't get inserted to the table. var user = new ApplicationUser() { UserName = userName, Email = model.Email, Code=model.Code }; IdentityResult result = await UserManager.CreateAsync(user, model.Password); if (!result.Succeeded) { return GetErrorResult(result); } return Ok(); }",How to extend IdentityUser with custom property
change flow of messages in microsoft bot," Hello I'm new to Microsoft Bot Framework and I have a question that I couldn't find an answer to.I have a FormFlow that ask the user for some question, after a specific question I want the bot to do some logic and show messages accordingly (for example if the user selected option 1 then show message X and if the user selected option 2 show message Y).Here is my code: Updated code after Ezequiel's suggestion: Thanks in advance for the help <code>  using Microsoft.Bot.Builder.FormFlow;using Microsoft.Bot.Builder.Dialogs;using System;using System.Collections.Generic;using System.Linq;using System.Web;namespace Bot_CRM.FormFlow{ public enum RequestOptions { Unknown, CheckStatus, CreateCase }; [Serializable] public class CaseFormFlow { public RequestOptions RequestType; [Prompt(""What is your first name?"")] public string FirstName; public string LastName; public string ContactNumber; [Prompt(""Please enter your id"")] public string Id; public static IForm<CaseFormFlow> BuildForm() { OnCompletionAsyncDelegate<CaseFormFlow> processRequest = async (context, state) => { await context.PostAsync($@""Thanks for your request""); }; return new FormBuilder<CaseFormFlow>() .Message(""Hello and welcom to my service desk bot"") .Field(nameof(FirstName)) .Message(""hello {FirstName}"") .Field(nameof(Id)) .Field(nameof(RequestType)) => //here if user select 1 start flow of check status and if user select 2 start flow of create case .AddRemainingFields() .Message(""Thank you request. Our help desk team will get back to you shortly."") .OnCompletion(processRequest) .Build(); } }} return new FormBuilder<CaseFormFlow>() .Message(""Hello and welcom to my service desk bot"") .Field(nameof(FirstName)) .Message(""hello {FirstName}"") .Field(new FieldReflector<CaseFormFlow>(nameof(RequestType)) .SetActive(state => state.AskUserForRequestType) .SetNext((value, state) => { var selection = (RequestOptions)value; if (selection == RequestOptions.CheckStatus) { return new NextStep(new[] { nameof(Id) }); } else { return new NextStep(); } }))",Change flow of messages in Microsoft Bot Framework
Change flow of messages in microsoft bot," Hello I'm new to Microsoft Bot Framework and I have a question that I couldn't find an answer to.I have a FormFlow that ask the user for some question, after a specific question I want the bot to do some logic and show messages accordingly (for example if the user selected option 1 then show message X and if the user selected option 2 show message Y).Here is my code: Updated code after Ezequiel's suggestion: Thanks in advance for the help <code>  using Microsoft.Bot.Builder.FormFlow;using Microsoft.Bot.Builder.Dialogs;using System;using System.Collections.Generic;using System.Linq;using System.Web;namespace Bot_CRM.FormFlow{ public enum RequestOptions { Unknown, CheckStatus, CreateCase }; [Serializable] public class CaseFormFlow { public RequestOptions RequestType; [Prompt(""What is your first name?"")] public string FirstName; public string LastName; public string ContactNumber; [Prompt(""Please enter your id"")] public string Id; public static IForm<CaseFormFlow> BuildForm() { OnCompletionAsyncDelegate<CaseFormFlow> processRequest = async (context, state) => { await context.PostAsync($@""Thanks for your request""); }; return new FormBuilder<CaseFormFlow>() .Message(""Hello and welcom to my service desk bot"") .Field(nameof(FirstName)) .Message(""hello {FirstName}"") .Field(nameof(Id)) .Field(nameof(RequestType)) => //here if user select 1 start flow of check status and if user select 2 start flow of create case .AddRemainingFields() .Message(""Thank you request. Our help desk team will get back to you shortly."") .OnCompletion(processRequest) .Build(); } }} return new FormBuilder<CaseFormFlow>() .Message(""Hello and welcom to my service desk bot"") .Field(nameof(FirstName)) .Message(""hello {FirstName}"") .Field(new FieldReflector<CaseFormFlow>(nameof(RequestType)) .SetActive(state => state.AskUserForRequestType) .SetNext((value, state) => { var selection = (RequestOptions)value; if (selection == RequestOptions.CheckStatus) { return new NextStep(new[] { nameof(Id) }); } else { return new NextStep(); } }))",Change flow of messages in Microsoft Bot Framework
Remove Empty rows and Columns From Excel using Interop," I have a lot of excel files that contains data and it contains empty rows and empty columns.like shown bellowI am trying to remove Empty rows and columns from excel using interop.I create a simple winform application and used the following code and it works fine. But when cleaning big excel files it takes a lot of time.Any suggestions for optimizing this code? or another way to clean this excel files faster? Is there a function that can delete empty rows in one click?I don't have problem if answers are using C#EDIT:I uploaded a sample file Sample File. But not all files have same structure. <code>  Dim lstFiles As New List(Of String)lstFiles.AddRange(IO.Directory.GetFiles(m_strFolderPath, ""*.xls"", IO.SearchOption.AllDirectories))Dim m_XlApp = New Excel.ApplicationDim m_xlWrkbs As Excel.Workbooks = m_XlApp.WorkbooksDim m_xlWrkb As Excel.WorkbookFor Each strFile As String In lstFiles m_xlWrkb = m_xlWrkbs.Open(strFile) Dim m_XlWrkSheet As Excel.Worksheet = m_xlWrkb.Worksheets(1) Dim intRow As Integer = 1 While intRow <= m_XlWrkSheet.UsedRange.Rows.Count If m_XlApp.WorksheetFunction.CountA(m_XlWrkSheet.Cells(intRow, 1).EntireRow) = 0 Then m_XlWrkSheet.Cells(intRow, 1).EntireRow.Delete(Excel.XlDeleteShiftDirection.xlShiftUp) Else intRow += 1 End If End While Dim intCol As Integer = 1 While intCol <= m_XlWrkSheet.UsedRange.Columns.Count If m_XlApp.WorksheetFunction.CountA(m_XlWrkSheet.Cells(1, intCol).EntireColumn) = 0 Then m_XlWrkSheet.Cells(1, intCol).EntireColumn.Delete(Excel.XlDeleteShiftDirection.xlShiftToLeft) Else intCol += 1 End If End WhileNextm_xlWrkb.Save()m_xlWrkb.Close(SaveChanges:=True)Marshal.ReleaseComObject(m_xlWrkb)Marshal.ReleaseComObject(m_xlWrkbs)m_XlApp.Quit()Marshal.ReleaseComObject(m_XlApp)",Fastest method to remove Empty rows and Columns From Excel Files using Interop
Remove Empty rows and Columns From Excel Files using Interop," I have a lot of excel files that contains data and it contains empty rows and empty columns.like shown bellowI am trying to remove Empty rows and columns from excel using interop.I create a simple winform application and used the following code and it works fine. But when cleaning big excel files it takes a lot of time.Any suggestions for optimizing this code? or another way to clean this excel files faster? Is there a function that can delete empty rows in one click?I don't have problem if answers are using C#EDIT:I uploaded a sample file Sample File. But not all files have same structure. <code>  Dim lstFiles As New List(Of String)lstFiles.AddRange(IO.Directory.GetFiles(m_strFolderPath, ""*.xls"", IO.SearchOption.AllDirectories))Dim m_XlApp = New Excel.ApplicationDim m_xlWrkbs As Excel.Workbooks = m_XlApp.WorkbooksDim m_xlWrkb As Excel.WorkbookFor Each strFile As String In lstFiles m_xlWrkb = m_xlWrkbs.Open(strFile) Dim m_XlWrkSheet As Excel.Worksheet = m_xlWrkb.Worksheets(1) Dim intRow As Integer = 1 While intRow <= m_XlWrkSheet.UsedRange.Rows.Count If m_XlApp.WorksheetFunction.CountA(m_XlWrkSheet.Cells(intRow, 1).EntireRow) = 0 Then m_XlWrkSheet.Cells(intRow, 1).EntireRow.Delete(Excel.XlDeleteShiftDirection.xlShiftUp) Else intRow += 1 End If End While Dim intCol As Integer = 1 While intCol <= m_XlWrkSheet.UsedRange.Columns.Count If m_XlApp.WorksheetFunction.CountA(m_XlWrkSheet.Cells(1, intCol).EntireColumn) = 0 Then m_XlWrkSheet.Cells(1, intCol).EntireColumn.Delete(Excel.XlDeleteShiftDirection.xlShiftToLeft) Else intCol += 1 End If End WhileNextm_xlWrkb.Save()m_xlWrkb.Close(SaveChanges:=True)Marshal.ReleaseComObject(m_xlWrkb)Marshal.ReleaseComObject(m_xlWrkbs)m_XlApp.Quit()Marshal.ReleaseComObject(m_XlApp)",Fastest method to remove Empty rows and Columns From Excel Files using Interop
Remove Empty rows and Columns From Excel Files Faster using Interop," I have a lot of excel files that contains data and it contains empty rows and empty columns.like shown bellowI am trying to remove Empty rows and columns from excel using interop.I create a simple winform application and used the following code and it works fine. But when cleaning big excel files it takes a lot of time.Any suggestions for optimizing this code? or another way to clean this excel files faster? Is there a function that can delete empty rows in one click?I don't have problem if answers are using C#EDIT:I uploaded a sample file Sample File. But not all files have same structure. <code>  Dim lstFiles As New List(Of String)lstFiles.AddRange(IO.Directory.GetFiles(m_strFolderPath, ""*.xls"", IO.SearchOption.AllDirectories))Dim m_XlApp = New Excel.ApplicationDim m_xlWrkbs As Excel.Workbooks = m_XlApp.WorkbooksDim m_xlWrkb As Excel.WorkbookFor Each strFile As String In lstFiles m_xlWrkb = m_xlWrkbs.Open(strFile) Dim m_XlWrkSheet As Excel.Worksheet = m_xlWrkb.Worksheets(1) Dim intRow As Integer = 1 While intRow <= m_XlWrkSheet.UsedRange.Rows.Count If m_XlApp.WorksheetFunction.CountA(m_XlWrkSheet.Cells(intRow, 1).EntireRow) = 0 Then m_XlWrkSheet.Cells(intRow, 1).EntireRow.Delete(Excel.XlDeleteShiftDirection.xlShiftUp) Else intRow += 1 End If End While Dim intCol As Integer = 1 While intCol <= m_XlWrkSheet.UsedRange.Columns.Count If m_XlApp.WorksheetFunction.CountA(m_XlWrkSheet.Cells(1, intCol).EntireColumn) = 0 Then m_XlWrkSheet.Cells(1, intCol).EntireColumn.Delete(Excel.XlDeleteShiftDirection.xlShiftToLeft) Else intCol += 1 End If End WhileNextm_xlWrkb.Save()m_xlWrkb.Close(SaveChanges:=True)Marshal.ReleaseComObject(m_xlWrkb)Marshal.ReleaseComObject(m_xlWrkbs)m_XlApp.Quit()Marshal.ReleaseComObject(m_XlApp)",Fastest method to remove Empty rows and Columns From Excel Files using Interop
How to get passed and fail test case count in Cake script," I try to use the cake script for running the test cases written in Xunit using the cake script , I need to know the number of passed and failed test cases count. Reference : http://www.cakebuild.net/dsl/xunit-v2Can anyone please suggest how to get the number of passed and failed test cases? <code>  #tool ""nuget:?package=xunit.runner.console""var testAssemblies = GetFiles(""./src/**/bin/Release/*.Tests.dll"");XUnit2(testAssemblies);",How to get passed and fail test case count in xunit using cake(c# make) script
entity framework not including columns with default value in insert into query," I have a model that has some columns defined with default values like When I save a new entity in the database using context.SaveChanges(), I noticed that the columns with default values are not included in the insert into query that Entity Framework generates, so the values generated in the database are the default ones instead of the ones I'm passing in the model. Do I have to set up some property in the context to be able to set these properties through code? I'm using EF Core, but I don't know if this is a general behavior of all EF versions. UPDATE: the code is pretty simple. This is pseudo code of what I have.The Model has some properties defined with constraints such as the one I describe above table.Column<bool>(nullable: false, defaultValueSql: ""1"")I'll use column MyBooleanProperty as an example. I have in a service: I'm using Unit Of Work and Repositories so I have In the output window of VS, I see how it send all properties in an INSERT INTO query and then it does a SELECT on the properties with default values. The result is the newModel in the database with all the values I sent, except the columns with default values.I cannot change the configuration for those tables since it's being used by another system that needs those rules. I would like to know an explanation on why this is happening more than a solution. I can work around this, but I'd like to know why this behavior is happening <code>  table.Column<bool>(nullable: false, defaultValueSql: ""1"") var newModel = new GEAddress();newModel = someEntity.MyBooleanProperty; //it is false,but ends up as 1 in the database _unitOfWork.MyModelRepository.Add(newModel);_unitOfWork.SaveChanges();",Entity Framework not including columns with default value in insert into query
Difference Between Enabled and IsActiveAndEnabled in Unity," I cannot believe that this question has not already been asked somewhere; a fairly thorough Googling has turned up no results. The Unity documentation says this about the Behaviour.isActiveAndEnabled field: Has the Behaviour had enabled called. True while the behaviour is enabled, false when disabled.And it says this about Behaviour.enabled: Enabled Behaviours are Updated, disabled Behaviours are not. This is shown as the small checkbox in the inspector of the behaviour.So one article just elaborates on what ""Enabled"" means more than the other. As far as I can tell, these fields are true/false under the exact same conditions! So what is the difference? When would you use one over the other? A clarification would be much appreciated! <code> ","Difference between enabled, isActiveAndEnabled and activeInHierarchy in Unity"
Ho to add a custom code analyzer to a project without nuget or VSIX?," I want to write a custom code analyzer in Visual Studio 2015 for a C# ConsoleApplication. For this reason I don't want to create a seperate ""Analyzer with Code Fix"" project from template, because this requires to add this analyzer in my projects as nuget package.Is it possible, to add a analyzer reference manually? I would like to reference the analyzer without nuget. <code> ",How to add a custom code analyzer to a project without nuget or VSIX?
(In C#) Can I **guarantee** that a non-ref method call doesn't change an array size," See also:change array sizeResize array in C# later in the programBoth of those questions are different in that they ask HOW you would change the size, to which I'm well aware that the answer is: ""Don't ... use a list"". They also reference a ref-based Array.Resize(ref array, int size).My question is this:Given that I have a monolithic legacy codebase, that I can't possibly examine the entirety of, and can't make any guarantees of what it does, ... if I have call method passing in a not-by-ref array, can I be guaranteed that the size of the array afterwards is unchanged.Array.Resize isn't an issue, since the by-ref-ness would have to pass all the way up through the call stack, which it obviously doesn't.But are there any other possible issues?REMARKS ON NOT BEING A DUPLICATEI'd argue that this is a different question from the others, because this is an ""Is it possible?"" rather than ""how would I do it/what's the best way to do it"". Thus answers that would be evil and wrong and would not be mentioned in the latter, would still be relevant to my question. <code> ",Can I guarantee that a non-ref method doesn't change the array size C#
ASP.NET CORE MVC AmbiguousActionException: Multiple actions matched. The following actions matched route data and had all constraints satisfied," I am creating a website using ASP.NET Core MVC. When I click on an action I get this error: This is how I defined my action in the index.cshtmlm for my ProductsController: Here is my routing: Here is how I defined the actions: What have I done wrong?UpdateThanks @MegaTron for your response, however I would like to know why I can't have the same action path for different controllers. I feel like the solution you proposed won't scale well if I have many controllers that each create entities.  <code>  AmbiguousActionException: Multiple actions matched. The following actions matched route data and had all constraints satisfied:Web.Controllers.ChangeEventsController.Create (Web)Web.Controllers.ProductsController.CreateChangeEvent (Web) <a asp-controller=""ChangeEvents"" asp-action=""Create"" asp-route-id=""@item.Id"">Create Change Event</a> app.UseMvc(routes => { routes.MapRoute( name: ""default"", template: ""{controller=Home}/{action=Index}/{id?}""); }); // ChangeEventsController[HttpGet(""{id}"")]public IActionResult Create(Guid id)// ProductsController[HttpGet(""{id}"")]public IActionResult CreateChangeEvent(Guid id)",AmbiguousActionException: Multiple actions matched. The following actions matched route data and had all constraints satisfied
Using of Blockly inside a C# WPF WebBrowser," Is it possible to use the Blockly google javascript libraries inside a WPF WebBrowser?In particular, Blockly needs several js scripts. How can we reference the js libraries? <code> ",Use Blockly inside a WPF WebBrowser
Use Blockly inside a WebBrowser," Is it possible to use the Blockly google javascript libraries inside a WPF WebBrowser?In particular, Blockly needs several js scripts. How can we reference the js libraries? <code> ",Use Blockly inside a WPF WebBrowser
"Thread Safe Guid. ""lock"" fails occasionally"," In my below code, I'm locking the guid, to try and make it thread safe.With my example application, I will get a ""duplicate key"" about every 10 times I run the program. Aka, I get a duplicate, which is not what I need.Is there anyway to make the "".NextGuid"" thread safe? My code is a combination of:Making Guid properties threadsafeIncrement Guid in C#Since I'm getting ""Why not use Guid.NewGuid"" questions, I'll provide the reason here:I have a parent process that has a uniqueidentifier which is created by Guid.NewGuid(). I'll refer to this as the ""parent guid"". That parent process will create N number of files. If I were writing from scratch, I would just append the ""N"" at the end of the filename. So if the parent Guid was ""11111111-1111-1111-1111-111111111111"" for example, I would write files , etc, etc. However, via the existing ""contract"" with the client ::: the filename must have a (unique) Guid in it and not have that ""N"" (1,2,etc,etc) value in the filename (this ""contract"" has been in existence for years, so its set in stone pretty much). With the functionality laid out here, I'll be able to keep the ""contract"", but have file names that are loosely tied to the ""parent"" Guid (which again the parent is generated by Guid.NewGuid()). Collision is NOT an issue with the filenames (they are put under a distinct folder for the 'process' execution). Collision is an issue with the ""parent"" Guid. But again, that is already handled with Guid.NewGuid.So with a starting Guid of ""11111111-1111-1111-1111-111111111111"", I'll be able to write filenames like: So in my example above, the ""parent guid"" is represented by ""this.StartingGuid""....and then I get ""incremented"" guid's off of that.And also. I can write better unit-tests, because now I will know the filenames ahead of time.APPEND:Final Code Version: and UnitTests: <code>  using System; namespace MyConsoleOne.BAL{ public class GuidStore { private static object objectlock = new object(); private Guid StartingGuid { get; set; } private Guid? LastGuidHolder { get; set; } public GuidStore(Guid startingGuid) { this.StartingGuid = startingGuid; } public Guid? GetNextGuid() { lock (objectlock) { if (this.LastGuidHolder.HasValue) { this.LastGuidHolder = Increment(this.LastGuidHolder.Value); } else { this.LastGuidHolder = Increment(this.StartingGuid); } } return this.LastGuidHolder; } private Guid Increment(Guid guid) { byte[] bytes = guid.ToByteArray(); byte[] order = { 15, 14, 13, 12, 11, 10, 9, 8, 6, 7, 4, 5, 0, 1, 2, 3 }; for (int i = 0; i < 16; i++) { if (bytes[order[i]] == byte.MaxValue) { bytes[order[i]] = 0; } else { bytes[order[i]]++; return new Guid(bytes); } } throw new OverflowException(""Guid.Increment failed.""); } }}using MyConsoleOne.BAL;using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading.Tasks;namespace MyConsoleOne{ class Program { static void Main(string[] args) { GuidStore gs = new GuidStore(Guid.NewGuid()); for (int i = 0; i < 1000; i++) { Console.WriteLine(i); Dictionary<Guid, int> guids = new Dictionary<Guid, int>(); Parallel.For(0, 1000, j => { Guid? currentGuid = gs.GetNextGuid(); guids.Add(currentGuid.Value, j); Console.WriteLine(currentGuid); }); // Parallel.For } Console.WriteLine(""Press ENTER to Exit""); Console.ReadLine(); } }} ""11111111-1111-1111-1111-111111111111_1.txt""""11111111-1111-1111-1111-111111111111_2.txt""""11111111-1111-1111-1111-111111111111_3.txt"" OTHERSTUFF_111111111-1111-1111-1111-111111111112_MORESTUFF.txtOTHERSTUFF_111111111-1111-1111-1111-111111111113_MORESTUFF.txtOTHERSTUFF_111111111-1111-1111-1111-111111111114_MORESTUFF.txtOTHERSTUFF_111111111-1111-1111-1111-111111111115_MORESTUFF.txtOTHERSTUFF_111111111-1111-1111-1111-111111111116_MORESTUFF.txtOTHERSTUFF_111111111-1111-1111-1111-111111111117_MORESTUFF.txtOTHERSTUFF_111111111-1111-1111-1111-111111111118_MORESTUFF.txtOTHERSTUFF_111111111-1111-1111-1111-111111111119_MORESTUFF.txtOTHERSTUFF_111111111-1111-1111-1111-11111111111a_MORESTUFF.txtOTHERSTUFF_111111111-1111-1111-1111-11111111111b_MORESTUFF.txt public class GuidStore{ private static object objectlock = new object(); private static int[] byteOrder = { 15, 14, 13, 12, 11, 10, 9, 8, 6, 7, 4, 5, 0, 1, 2, 3 }; private Guid StartingGuid { get; set; } private Guid? LastGuidHolder { get; set; } public GuidStore(Guid startingGuid) { this.StartingGuid = startingGuid; } public Guid GetNextGuid() { return this.GetNextGuid(0); } public Guid GetNextGuid(int firstGuidOffSet) { lock (objectlock) { if (this.LastGuidHolder.HasValue) { this.LastGuidHolder = Increment(this.LastGuidHolder.Value); } else { this.LastGuidHolder = Increment(this.StartingGuid); for (int i = 0; i < firstGuidOffSet; i++) { this.LastGuidHolder = Increment(this.LastGuidHolder.Value); } } return this.LastGuidHolder.Value; } } private static Guid Increment(Guid guid) { var bytes = guid.ToByteArray(); var canIncrement = byteOrder.Any(i => ++bytes[i] != 0); return new Guid(canIncrement ? bytes : new byte[16]); }} public class GuidStoreUnitTests{ [TestMethod] public void GetNextGuidSimpleTest() { Guid startingGuid = new Guid(""11111111-1111-1111-1111-111111111111""); GuidStore gs = new GuidStore(startingGuid); List<Guid> guids = new List<Guid>(); const int GuidCount = 10; for (int i = 0; i < GuidCount; i++) { guids.Add(gs.GetNextGuid()); } Assert.IsNotNull(guids); Assert.AreEqual(GuidCount, guids.Count); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-111111111112""))); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-111111111113""))); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-111111111114""))); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-111111111115""))); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-111111111116""))); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-111111111117""))); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-111111111118""))); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-111111111119""))); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-11111111111a""))); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-11111111111b""))); } [TestMethod] public void GetNextGuidWithOffsetSimpleTest() { Guid startingGuid = new Guid(""11111111-1111-1111-1111-111111111111""); GuidStore gs = new GuidStore(startingGuid); List<Guid> guids = new List<Guid>(); const int OffSet = 10; guids.Add(gs.GetNextGuid(OffSet)); Assert.IsNotNull(guids); Assert.AreEqual(1, guids.Count); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-11111111111c""))); } [TestMethod] public void GetNextGuidMaxRolloverTest() { Guid startingGuid = new Guid(""ffffffff-ffff-ffff-ffff-ffffffffffff""); GuidStore gs = new GuidStore(startingGuid); List<Guid> guids = new List<Guid>(); const int OffSet = 10; guids.Add(gs.GetNextGuid(OffSet)); Assert.IsNotNull(guids); Assert.AreEqual(1, guids.Count); Assert.IsNotNull(guids.FirstOrDefault(g => g == Guid.Empty)); } [TestMethod] public void GetNextGuidThreadSafeTest() { Guid startingGuid = Guid.NewGuid(); GuidStore gs = new GuidStore(startingGuid); /* The ""key"" of the ConcurrentDictionary must be unique, so this will catch any duplicates */ ConcurrentDictionary<Guid, int> guids = new ConcurrentDictionary<Guid, int>(); Parallel.For( 0, 1000, j => { Guid currentGuid = gs.GetNextGuid(); if (!guids.TryAdd(currentGuid, j)) { throw new ArgumentOutOfRangeException(""GuidStore.GetNextGuid ThreadSafe Test Failed""); } }); // Parallel.For } [TestMethod] public void GetNextGuidTwoRunsProduceSameResultsTest() { Guid startingGuid = Guid.NewGuid(); GuidStore gsOne = new GuidStore(startingGuid); /* The ""key"" of the ConcurrentDictionary must be unique, so this will catch any duplicates */ ConcurrentDictionary<Guid, int> setOneGuids = new ConcurrentDictionary<Guid, int>(); Parallel.For( 0, 1000, j => { Guid currentGuid = gsOne.GetNextGuid(); if (!setOneGuids.TryAdd(currentGuid, j)) { throw new ArgumentOutOfRangeException(""GuidStore.GetNextGuid ThreadSafe Test Failed""); } }); // Parallel.For gsOne = null; GuidStore gsTwo = new GuidStore(startingGuid); /* The ""key"" of the ConcurrentDictionary must be unique, so this will catch any duplicates */ ConcurrentDictionary<Guid, int> setTwoGuids = new ConcurrentDictionary<Guid, int>(); Parallel.For( 0, 1000, j => { Guid currentGuid = gsTwo.GetNextGuid(); if (!setTwoGuids.TryAdd(currentGuid, j)) { throw new ArgumentOutOfRangeException(""GuidStore.GetNextGuid ThreadSafe Test Failed""); } }); // Parallel.For bool equal = setOneGuids.Select(g => g.Key).OrderBy(i => i).SequenceEqual( setTwoGuids.Select(g => g.Key).OrderBy(i => i), new GuidComparer<Guid>()); Assert.IsTrue(equal); }}internal class GuidComparer<Guid> : IEqualityComparer<Guid>{ public bool Equals(Guid x, Guid y) { return x.Equals(y); } public int GetHashCode(Guid obj) { return 0; }}",Building a thread-safe GUID increment'er
Building a thread-safe GUID," In my below code, I'm locking the guid, to try and make it thread safe.With my example application, I will get a ""duplicate key"" about every 10 times I run the program. Aka, I get a duplicate, which is not what I need.Is there anyway to make the "".NextGuid"" thread safe? My code is a combination of:Making Guid properties threadsafeIncrement Guid in C#Since I'm getting ""Why not use Guid.NewGuid"" questions, I'll provide the reason here:I have a parent process that has a uniqueidentifier which is created by Guid.NewGuid(). I'll refer to this as the ""parent guid"". That parent process will create N number of files. If I were writing from scratch, I would just append the ""N"" at the end of the filename. So if the parent Guid was ""11111111-1111-1111-1111-111111111111"" for example, I would write files , etc, etc. However, via the existing ""contract"" with the client ::: the filename must have a (unique) Guid in it and not have that ""N"" (1,2,etc,etc) value in the filename (this ""contract"" has been in existence for years, so its set in stone pretty much). With the functionality laid out here, I'll be able to keep the ""contract"", but have file names that are loosely tied to the ""parent"" Guid (which again the parent is generated by Guid.NewGuid()). Collision is NOT an issue with the filenames (they are put under a distinct folder for the 'process' execution). Collision is an issue with the ""parent"" Guid. But again, that is already handled with Guid.NewGuid.So with a starting Guid of ""11111111-1111-1111-1111-111111111111"", I'll be able to write filenames like: So in my example above, the ""parent guid"" is represented by ""this.StartingGuid""....and then I get ""incremented"" guid's off of that.And also. I can write better unit-tests, because now I will know the filenames ahead of time.APPEND:Final Code Version: and UnitTests: <code>  using System; namespace MyConsoleOne.BAL{ public class GuidStore { private static object objectlock = new object(); private Guid StartingGuid { get; set; } private Guid? LastGuidHolder { get; set; } public GuidStore(Guid startingGuid) { this.StartingGuid = startingGuid; } public Guid? GetNextGuid() { lock (objectlock) { if (this.LastGuidHolder.HasValue) { this.LastGuidHolder = Increment(this.LastGuidHolder.Value); } else { this.LastGuidHolder = Increment(this.StartingGuid); } } return this.LastGuidHolder; } private Guid Increment(Guid guid) { byte[] bytes = guid.ToByteArray(); byte[] order = { 15, 14, 13, 12, 11, 10, 9, 8, 6, 7, 4, 5, 0, 1, 2, 3 }; for (int i = 0; i < 16; i++) { if (bytes[order[i]] == byte.MaxValue) { bytes[order[i]] = 0; } else { bytes[order[i]]++; return new Guid(bytes); } } throw new OverflowException(""Guid.Increment failed.""); } }}using MyConsoleOne.BAL;using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading.Tasks;namespace MyConsoleOne{ class Program { static void Main(string[] args) { GuidStore gs = new GuidStore(Guid.NewGuid()); for (int i = 0; i < 1000; i++) { Console.WriteLine(i); Dictionary<Guid, int> guids = new Dictionary<Guid, int>(); Parallel.For(0, 1000, j => { Guid? currentGuid = gs.GetNextGuid(); guids.Add(currentGuid.Value, j); Console.WriteLine(currentGuid); }); // Parallel.For } Console.WriteLine(""Press ENTER to Exit""); Console.ReadLine(); } }} ""11111111-1111-1111-1111-111111111111_1.txt""""11111111-1111-1111-1111-111111111111_2.txt""""11111111-1111-1111-1111-111111111111_3.txt"" OTHERSTUFF_111111111-1111-1111-1111-111111111112_MORESTUFF.txtOTHERSTUFF_111111111-1111-1111-1111-111111111113_MORESTUFF.txtOTHERSTUFF_111111111-1111-1111-1111-111111111114_MORESTUFF.txtOTHERSTUFF_111111111-1111-1111-1111-111111111115_MORESTUFF.txtOTHERSTUFF_111111111-1111-1111-1111-111111111116_MORESTUFF.txtOTHERSTUFF_111111111-1111-1111-1111-111111111117_MORESTUFF.txtOTHERSTUFF_111111111-1111-1111-1111-111111111118_MORESTUFF.txtOTHERSTUFF_111111111-1111-1111-1111-111111111119_MORESTUFF.txtOTHERSTUFF_111111111-1111-1111-1111-11111111111a_MORESTUFF.txtOTHERSTUFF_111111111-1111-1111-1111-11111111111b_MORESTUFF.txt public class GuidStore{ private static object objectlock = new object(); private static int[] byteOrder = { 15, 14, 13, 12, 11, 10, 9, 8, 6, 7, 4, 5, 0, 1, 2, 3 }; private Guid StartingGuid { get; set; } private Guid? LastGuidHolder { get; set; } public GuidStore(Guid startingGuid) { this.StartingGuid = startingGuid; } public Guid GetNextGuid() { return this.GetNextGuid(0); } public Guid GetNextGuid(int firstGuidOffSet) { lock (objectlock) { if (this.LastGuidHolder.HasValue) { this.LastGuidHolder = Increment(this.LastGuidHolder.Value); } else { this.LastGuidHolder = Increment(this.StartingGuid); for (int i = 0; i < firstGuidOffSet; i++) { this.LastGuidHolder = Increment(this.LastGuidHolder.Value); } } return this.LastGuidHolder.Value; } } private static Guid Increment(Guid guid) { var bytes = guid.ToByteArray(); var canIncrement = byteOrder.Any(i => ++bytes[i] != 0); return new Guid(canIncrement ? bytes : new byte[16]); }} public class GuidStoreUnitTests{ [TestMethod] public void GetNextGuidSimpleTest() { Guid startingGuid = new Guid(""11111111-1111-1111-1111-111111111111""); GuidStore gs = new GuidStore(startingGuid); List<Guid> guids = new List<Guid>(); const int GuidCount = 10; for (int i = 0; i < GuidCount; i++) { guids.Add(gs.GetNextGuid()); } Assert.IsNotNull(guids); Assert.AreEqual(GuidCount, guids.Count); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-111111111112""))); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-111111111113""))); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-111111111114""))); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-111111111115""))); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-111111111116""))); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-111111111117""))); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-111111111118""))); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-111111111119""))); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-11111111111a""))); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-11111111111b""))); } [TestMethod] public void GetNextGuidWithOffsetSimpleTest() { Guid startingGuid = new Guid(""11111111-1111-1111-1111-111111111111""); GuidStore gs = new GuidStore(startingGuid); List<Guid> guids = new List<Guid>(); const int OffSet = 10; guids.Add(gs.GetNextGuid(OffSet)); Assert.IsNotNull(guids); Assert.AreEqual(1, guids.Count); Assert.IsNotNull(guids.FirstOrDefault(g => g == new Guid(""11111111-1111-1111-1111-11111111111c""))); } [TestMethod] public void GetNextGuidMaxRolloverTest() { Guid startingGuid = new Guid(""ffffffff-ffff-ffff-ffff-ffffffffffff""); GuidStore gs = new GuidStore(startingGuid); List<Guid> guids = new List<Guid>(); const int OffSet = 10; guids.Add(gs.GetNextGuid(OffSet)); Assert.IsNotNull(guids); Assert.AreEqual(1, guids.Count); Assert.IsNotNull(guids.FirstOrDefault(g => g == Guid.Empty)); } [TestMethod] public void GetNextGuidThreadSafeTest() { Guid startingGuid = Guid.NewGuid(); GuidStore gs = new GuidStore(startingGuid); /* The ""key"" of the ConcurrentDictionary must be unique, so this will catch any duplicates */ ConcurrentDictionary<Guid, int> guids = new ConcurrentDictionary<Guid, int>(); Parallel.For( 0, 1000, j => { Guid currentGuid = gs.GetNextGuid(); if (!guids.TryAdd(currentGuid, j)) { throw new ArgumentOutOfRangeException(""GuidStore.GetNextGuid ThreadSafe Test Failed""); } }); // Parallel.For } [TestMethod] public void GetNextGuidTwoRunsProduceSameResultsTest() { Guid startingGuid = Guid.NewGuid(); GuidStore gsOne = new GuidStore(startingGuid); /* The ""key"" of the ConcurrentDictionary must be unique, so this will catch any duplicates */ ConcurrentDictionary<Guid, int> setOneGuids = new ConcurrentDictionary<Guid, int>(); Parallel.For( 0, 1000, j => { Guid currentGuid = gsOne.GetNextGuid(); if (!setOneGuids.TryAdd(currentGuid, j)) { throw new ArgumentOutOfRangeException(""GuidStore.GetNextGuid ThreadSafe Test Failed""); } }); // Parallel.For gsOne = null; GuidStore gsTwo = new GuidStore(startingGuid); /* The ""key"" of the ConcurrentDictionary must be unique, so this will catch any duplicates */ ConcurrentDictionary<Guid, int> setTwoGuids = new ConcurrentDictionary<Guid, int>(); Parallel.For( 0, 1000, j => { Guid currentGuid = gsTwo.GetNextGuid(); if (!setTwoGuids.TryAdd(currentGuid, j)) { throw new ArgumentOutOfRangeException(""GuidStore.GetNextGuid ThreadSafe Test Failed""); } }); // Parallel.For bool equal = setOneGuids.Select(g => g.Key).OrderBy(i => i).SequenceEqual( setTwoGuids.Select(g => g.Key).OrderBy(i => i), new GuidComparer<Guid>()); Assert.IsTrue(equal); }}internal class GuidComparer<Guid> : IEqualityComparer<Guid>{ public bool Equals(Guid x, Guid y) { return x.Equals(y); } public int GetHashCode(Guid obj) { return 0; }}",Building a thread-safe GUID increment'er
Where's the package location in aspnet core?," I'm new to ASP.NET Core, and am trying to figure out where NuGet packages are stored on my local machine.I've installed the following NuGet packages: I want to replace one of the DLL's with my own compiled version, but I don't know where to put it. The Dependencies folder shows nothing. <code>  nuget dapper nuget MicroOrm.Pocos.SqlGenerator",Where's the NuGet package location in ASP.NET Core?
How to center Xamarin.Forms View using Relative Layout? `Width` and `Height` return -1," When trying to use the Height and Width properties of a control in Xamarin.Forms, both return -1, and it causes the Relative Layout to appear off-centered on the screen.  <code>  var mainLayout = new RelativeLayout();//Add the Switch to the center of the screenmainLayout.Children.Add(mySwitch, Constraint.RelativeToParent(parent => parent.Width / 2 - mySwitch.Width / 2), Constraint.RelativeToParent(parent => parent.Height / 2 - mySwitch.Height / 2));//Add a Label below the switchmainLayout.Children.Add(switchLabel, Constraint.RelativeToParent(parent => parent.Width / 2 - switchLabel.Width / 2), Constraint.RelativeToView(mySwitch, (parent, view) => view.Y + mySwitch.Height + 10));Content = mainLayout;",Xamarin.Forms: How to center views using Relative Layout? `Width` and `Height` return -1
async processing in asp.net core and kestrel thread pool," I'm new to ASP.NET Core and to C# in general coming from the Java world and I'm a bit confused about how async/await keywords work: This article explains that if a method is marked as async it means that ""this method contains control flow that involves awaiting asynchronous operations and will therefore be rewritten by the compiler into continuation passing style to ensure that the asynchronous operations can resume this method at the right spot. The whole point of async methods it that you stay on the current thread as much as possibleSo I thought that it is a very cool way of passing control between an async method and its caller running on the same thread implemented on byte-code/virtual machine level. I mean I expected that the below code would write by passing control from doSthAsync to Main with await keyword and then back to doSthAsync with task.Wait() (and all of this happening on a single thread).However the code above in fact prints which means that it is merely a way to delegate an ""async"" method to a separate thread if the current thread is busy, which is almost exactly opposite to what the mentioned article states: The async modifier on the method does not mean this method is automatically scheduled to run on a worker thread asynchronouslySo since ""continuations"" of async methods apparently are or at least may be scheduled to run on a different thread, I have some questions that seem fundamental for C# apps scalability:Does each async method may run on a newly spawned thread or is the C# runtime maintaining a special thread-pool for this purpose and in the latter case how do I control the size of this pool?UPDATE: thanks to @Servy I now know that in case of CMD-line apps it will be a thread-pool thread, but I still don't know how to control the number of these thread-pool threads).How about in case of ASP.NET Core: how can I control the size of a thread-pool that Kestrel uses to perform async entity framework operations or other (network) I/O? Is it the same thread-pool it uses to accept HTTP requests?UPDATE: thanks to this and this article by Stephen Cleary I now understand that it will run ""kind-of-single-threadly"" by default, ie:, at any given time there will be exactly one thread within the SynchronizationContext of a given HTTP request, but this thread may be switched to another when some async operation is marked as finished and task is resumed. I also learned that it is possible to dispatch any async method ""out of a given SynchronizationContext"" to a thread-pool thread by using ConfigureAwait(false). Still, I don't know how to control the number of thread-pool threads and if it is the same pool that is used by Kestrel to accept HTTP requests.As I understand if all I/O is done asynchronously properly then the the size of these pools (whether it's just 1 thread-pool in fact or 2 separate) does not have anything to do with the number of outgoing connections being opened to external resources like DB, right? (threads running an asynchronous code will be continuously accepting new HTTP requests and as a result of their processing will be opening outgoing connections (to DB or to some web server to fetch some resource from the web) as fast as they can without any blocking)This in turn means that if I don't want to kill my DB I should set a sane limit of its connection pool, and make sure that awaiting for an available connection is also done asynchronously, right?Assuming that I'm correct I would still want to be able to limit the number of thread-pool threads in case some long lasting I/O operation is mistakenly done synchronously to prevent large number of threads being spawned as a result of large numbers of threads being blocked on this synchronous operation (ie: I think it's better to limit performance of my app rather than make it spawn insane number of threads due to such bug)I also have ""just out of curiosity"" question: why actually async/await is not implemented to execute async tasks on the same thread? I don't know how to implement it on windows but on Unix this could be implemented using either select/poll system calls or signals, so I believe that there's a way to achieve this on windows as well and it would be a really cool language feature indeed.UPDATE: if I understand correctly this is almost how things will work if my SynchronizationContext is not null: ie code will run ""kind-of-single-threadly"": at any given time there will be exactly one thread within a given SynchronizationContext. However the way it is implemented will make a synchronous method waiting for async task to deadlock, right? (runtime will schedule marking of the task as finished to run on the same thread that is waiting for this task to be finished)Thanks! <code>  public static void Main(string[] args){ int delay = 10; var task = doSthAsync(delay); System.Console.WriteLine(""main 1: "" + Thread.CurrentThread.ManagedThreadId); // some synchronous processing longer than delay: Thread.Sleep(2 * delay) System.Console.WriteLine(""main 2: "" + Thread.CurrentThread.ManagedThreadId); task.Wait();}public static async Task<String> doSthAsync(int delay){ System.Console.WriteLine(""async 1: "" + Thread.CurrentThread.ManagedThreadId); await Task.Delay(delay); System.Console.WriteLine(""async 2: "" + Thread.CurrentThread.ManagedThreadId); return ""done"";} async 1: 1main 1: 1main 2: 1async 2: 1 async 1: 1main 1: 1async 2: 4main 2: 1",Async processing in asp.net core and kestrel thread pool
system.web > globalization in .net core," I have been using the following setting the the web.config of my previous application. Now in my new .net core project I don't know how to put this setting in the appsettings.json file.Thanks for your help,Nikolai <code>  <system.web> <globalization culture=""en-AU"" uiCulture=""en-AU"" /></system.web>",<system.web> globalization in .net core
cURL request in asp.net core," I want to do a web request in a asp.net core project. I tried the following but it doesn't seem to send the data in the request: I don't get an error, the request was send but it doesn't seem to send the data with the request. I also can't give the length of the data with the request. Is this a core issue? (ps: The credentials are send correctly)Can anyone help me? <code>  using System.Net;...//encoderUTF8Encoding enc = new UTF8Encoding();//datastring data = ""[\""some.data\""]"";//Create requestWebRequest request = WebRequest.Create(url);request.Method = ""POST"";request.ContentType = ""application/json"";request.Credentials = new NetworkCredential(user, secret);//Set data in requestStream dataStream = await request.GetRequestStreamAsync();dataStream.Write(enc.GetBytes(data), 0, data.Length); //Get the responseWebResponse wr = await request.GetResponseAsync();Stream receiveStream = wr.GetResponseStream();StreamReader reader = new StreamReader(receiveStream, Encoding.UTF8);string content = reader.ReadToEnd();",web request in asp.net core
does .sln file has any kind clue in it that leads to the pc it was written on?," My interest is in the first place regarding solution files containing C# projects.Is there anything, like the exact .NET framework version, user names and passwords, any other information that can identify the machine the solution file was created on? <code> ",Does Visual Studio solution (.sln) files have any hint to the machine they were created on?
Does a Visual Studio solution (.sln) files have any hint to the machine it was created on?," My interest is in the first place regarding solution files containing C# projects.Is there anything, like the exact .NET framework version, user names and passwords, any other information that can identify the machine the solution file was created on? <code> ",Does Visual Studio solution (.sln) files have any hint to the machine they were created on?
entity framework save IP as binary to MSSQL Server," I am learning C# and for a network scanning project I want to save IP addresses as binary to my SQL Server as this seems to be the ""optimal"" solution.But as I am pretty new I am quite confused on how telling EF6 to do that. I thought using the variable type IPAddress within my code, but EF will save that as a BIGINT within my database (using code-first). I guess I can make it a byte[] and use getter and setter to do the conversion of binary to the IPAddress type?Or is can I just tell it to use BINARY with data annotations? Do I still need to do the conversion manually then?Could someone please clarify that for me?As I will save a lot of IPs to the database I want to save them in the best way possible.Thanks a lot! <code> ",Entity Framework save IP as binary to SQL Server
C# is there a limit to the number of nested FOR loop?," Since everything has a limit, I was wondering if there is a limit to the number of nested for loops or as long as I have memory, I can add them, can the Visual Studio compiler create such a program?Of course a 64 or more nested for loops would be not handy to debug, but is it doable? <code>  private void TestForLoop(){ for (int a = 0; a < 4; a++) { for (int b = 0; b < 56; b++) { for (int c = 0; c < 196; c++) { //etc.... } } }}",Is there a limit to the number of nested 'for' loops?
Is there a limit to the number of nested FOR loops?," Since everything has a limit, I was wondering if there is a limit to the number of nested for loops or as long as I have memory, I can add them, can the Visual Studio compiler create such a program?Of course a 64 or more nested for loops would be not handy to debug, but is it doable? <code>  private void TestForLoop(){ for (int a = 0; a < 4; a++) { for (int b = 0; b < 56; b++) { for (int c = 0; c < 196; c++) { //etc.... } } }}",Is there a limit to the number of nested 'for' loops?
Why is tail call optimization not occuring?," We are using recursion to find factors and are receiving a StackOverflow exception. We've read that the C# compiler on x64 computers performs tail call optimizations: JIT definitely does tailcals when running optimized code and not debugging.Running dotnet --configuration release gets this far in our program: Why is tail call optimization not occuring?  <code>  ... 7214 is a factor of 12345678907606 is a factor of 123456789010821 is a factor of 123456789011409 is a factor of 1234567890 Process is terminated due to StackOverflowException. class Program{ static void Main(string[] args) { const long firstCandidate = 1; WriteAllFactors(1234567890, firstCandidate); } private static void WriteAllFactors(long number, long candidate) { if (number % candidate == 0) { System.Console.WriteLine($""{candidate} is a factor of {number}""); } candidate = candidate + 1; if(candidate > number / 2) { return; } WriteAllFactors(number, candidate); }}",Why is tail call optimization not occurring here?
30Mb limit uploading to Azure DataLake using _adlsFileSystemClient," I am receiving an error when using to upload files to a datalake. The error comes up with files over 30Mb. It works fine with smaller files. The error is: at Microsoft.Azure.Management.DataLake.Store.FileSystemOperations.d__16.MoveNext() --- End of stack trace from previous location where exception was thrown --- at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task) at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Microsoft.Azure.Management.DataLake.Store.FileSystemOperationsExtensions.d__23.MoveNext() --- End of stack trace from previous location where exception was thrown --- at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task) at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Microsoft.Azure.Management.DataLake.Store.FileSystemOperationsExtensions.Create(IFileSystemOperations operations, String accountName, String directFilePath, Stream streamContents, Nullable1 overwrite, Nullable1 syncFlag) at AzureDataFunctions.DataLakeController.CreateFileInDataLake(String destFilePath, Stream stream, Boolean overwrite) in F:\GitHub\ZutoDW\ADF_ProcessAllFiles\ADF_ProcessAllFiles\DataLakeController.cs:line 122Has anybody else encountered this? Or observed similar behaviour? I am getting around this by splitting my files into 30Mb pieces and uploading them. However this is impractical in the long term because the original file is 380Mb, and potentially quite a bit larger. I do not want to have 10-15 dissected files in my datalake in the long term. I would like to upload as a single file. I am able to upload the exact same file to the datalake through the portal interface. <code>  _adlsFileSystemClient.FileSystem.Create(_adlsAccountName, destFilePath, stream, overwrite)",30Mb limit uploading to Azure DataLake using DataLakeStoreFileSystemManagementClient
".net Core - Identity Email configure, how to implement the SendEmailAsync inteface and send Email"," I don't know how to invoke the SendEmailAsync functionRegister Post page Email configuration Page// this code was already there //I got this code from some other site. I don't know how to use this together. how the write the class definition to send email.Break point does not reach here, I think there is some problem with my implementation. <code>  public async Task<IActionResult> Register(RegisterViewModel model, string returnUrl = null) { ViewData[""ReturnUrl""] = returnUrl; if (ModelState.IsValid) { var user = new ApplicationUser { UserName = model.Email, Email = model.Email }; var result = await _userManager.CreateAsync(user, model.Password); if (result.Succeeded) { // For more information on how to enable account confirmation and password reset please visit http://go.microsoft.com/fwlink/?LinkID=532713 // Send an email with this link var code = await _userManager.GenerateEmailConfirmationTokenAsync(user); var callbackUrl = Url.Action(""ConfirmEmail"", ""Account"", new { userId = user.Id, code = code }, protocol: HttpContext.Request.Scheme); await _emailSender.SendEmailAsync(model.Email, ""Confirm your account"", $""Please confirm your account by clicking this link: <a href='{callbackUrl}'>link</a>""); await _signInManager.SignInAsync(user, isPersistent: false); _logger.LogInformation(3, ""User created a new account with password.""); return RedirectToLocal(returnUrl); } AddErrors(result); } // If we got this far, something failed, redisplay form return View(model); } public interface IEmailSender{ Task SendEmailAsync(string email, string subject, string message);} public class sendMail : IEmailSender // this line is written by me{ public async Task SendEmailAsync(string email, string subject, string message) { var emailMessage = new MimeMessage(); emailMessage.From.Add(new MailboxAddress(""Joe Bloggs"", ""jbloggs@example.com"")); emailMessage.To.Add(new MailboxAddress("""", email)); emailMessage.Subject = subject; emailMessage.Body = new TextPart(""plain"") { Text = message }; using (var client = new SmtpClient()) { client.LocalDomain = ""some.domain.com""; await client.ConnectAsync(""smtp.relay.uri"", 25, SecureSocketOptions.None).ConfigureAwait(false); await client.SendAsync(emailMessage).ConfigureAwait(false); await client.DisconnectAsync(true).ConfigureAwait(false); } }}",Implement the SendEmailAsync interface and send Email
How to implement the SendEmailAsync inteface and send Email," I don't know how to invoke the SendEmailAsync functionRegister Post page Email configuration Page// this code was already there //I got this code from some other site. I don't know how to use this together. how the write the class definition to send email.Break point does not reach here, I think there is some problem with my implementation. <code>  public async Task<IActionResult> Register(RegisterViewModel model, string returnUrl = null) { ViewData[""ReturnUrl""] = returnUrl; if (ModelState.IsValid) { var user = new ApplicationUser { UserName = model.Email, Email = model.Email }; var result = await _userManager.CreateAsync(user, model.Password); if (result.Succeeded) { // For more information on how to enable account confirmation and password reset please visit http://go.microsoft.com/fwlink/?LinkID=532713 // Send an email with this link var code = await _userManager.GenerateEmailConfirmationTokenAsync(user); var callbackUrl = Url.Action(""ConfirmEmail"", ""Account"", new { userId = user.Id, code = code }, protocol: HttpContext.Request.Scheme); await _emailSender.SendEmailAsync(model.Email, ""Confirm your account"", $""Please confirm your account by clicking this link: <a href='{callbackUrl}'>link</a>""); await _signInManager.SignInAsync(user, isPersistent: false); _logger.LogInformation(3, ""User created a new account with password.""); return RedirectToLocal(returnUrl); } AddErrors(result); } // If we got this far, something failed, redisplay form return View(model); } public interface IEmailSender{ Task SendEmailAsync(string email, string subject, string message);} public class sendMail : IEmailSender // this line is written by me{ public async Task SendEmailAsync(string email, string subject, string message) { var emailMessage = new MimeMessage(); emailMessage.From.Add(new MailboxAddress(""Joe Bloggs"", ""jbloggs@example.com"")); emailMessage.To.Add(new MailboxAddress("""", email)); emailMessage.Subject = subject; emailMessage.Body = new TextPart(""plain"") { Text = message }; using (var client = new SmtpClient()) { client.LocalDomain = ""some.domain.com""; await client.ConnectAsync(""smtp.relay.uri"", 25, SecureSocketOptions.None).ConfigureAwait(false); await client.SendAsync(emailMessage).ConfigureAwait(false); await client.DisconnectAsync(true).ConfigureAwait(false); } }}",Implement the SendEmailAsync interface and send Email
.Net Core Identity . How to implement the SendEmailAsync inteface and send Email," I don't know how to invoke the SendEmailAsync functionRegister Post page Email configuration Page// this code was already there //I got this code from some other site. I don't know how to use this together. how the write the class definition to send email.Break point does not reach here, I think there is some problem with my implementation. <code>  public async Task<IActionResult> Register(RegisterViewModel model, string returnUrl = null) { ViewData[""ReturnUrl""] = returnUrl; if (ModelState.IsValid) { var user = new ApplicationUser { UserName = model.Email, Email = model.Email }; var result = await _userManager.CreateAsync(user, model.Password); if (result.Succeeded) { // For more information on how to enable account confirmation and password reset please visit http://go.microsoft.com/fwlink/?LinkID=532713 // Send an email with this link var code = await _userManager.GenerateEmailConfirmationTokenAsync(user); var callbackUrl = Url.Action(""ConfirmEmail"", ""Account"", new { userId = user.Id, code = code }, protocol: HttpContext.Request.Scheme); await _emailSender.SendEmailAsync(model.Email, ""Confirm your account"", $""Please confirm your account by clicking this link: <a href='{callbackUrl}'>link</a>""); await _signInManager.SignInAsync(user, isPersistent: false); _logger.LogInformation(3, ""User created a new account with password.""); return RedirectToLocal(returnUrl); } AddErrors(result); } // If we got this far, something failed, redisplay form return View(model); } public interface IEmailSender{ Task SendEmailAsync(string email, string subject, string message);} public class sendMail : IEmailSender // this line is written by me{ public async Task SendEmailAsync(string email, string subject, string message) { var emailMessage = new MimeMessage(); emailMessage.From.Add(new MailboxAddress(""Joe Bloggs"", ""jbloggs@example.com"")); emailMessage.To.Add(new MailboxAddress("""", email)); emailMessage.Subject = subject; emailMessage.Body = new TextPart(""plain"") { Text = message }; using (var client = new SmtpClient()) { client.LocalDomain = ""some.domain.com""; await client.ConnectAsync(""smtp.relay.uri"", 25, SecureSocketOptions.None).ConfigureAwait(false); await client.SendAsync(emailMessage).ConfigureAwait(false); await client.DisconnectAsync(true).ConfigureAwait(false); } }}",Implement the SendEmailAsync interface and send Email
Implement the SendEmailAsync inteface and send Email," I don't know how to invoke the SendEmailAsync functionRegister Post page Email configuration Page// this code was already there //I got this code from some other site. I don't know how to use this together. how the write the class definition to send email.Break point does not reach here, I think there is some problem with my implementation. <code>  public async Task<IActionResult> Register(RegisterViewModel model, string returnUrl = null) { ViewData[""ReturnUrl""] = returnUrl; if (ModelState.IsValid) { var user = new ApplicationUser { UserName = model.Email, Email = model.Email }; var result = await _userManager.CreateAsync(user, model.Password); if (result.Succeeded) { // For more information on how to enable account confirmation and password reset please visit http://go.microsoft.com/fwlink/?LinkID=532713 // Send an email with this link var code = await _userManager.GenerateEmailConfirmationTokenAsync(user); var callbackUrl = Url.Action(""ConfirmEmail"", ""Account"", new { userId = user.Id, code = code }, protocol: HttpContext.Request.Scheme); await _emailSender.SendEmailAsync(model.Email, ""Confirm your account"", $""Please confirm your account by clicking this link: <a href='{callbackUrl}'>link</a>""); await _signInManager.SignInAsync(user, isPersistent: false); _logger.LogInformation(3, ""User created a new account with password.""); return RedirectToLocal(returnUrl); } AddErrors(result); } // If we got this far, something failed, redisplay form return View(model); } public interface IEmailSender{ Task SendEmailAsync(string email, string subject, string message);} public class sendMail : IEmailSender // this line is written by me{ public async Task SendEmailAsync(string email, string subject, string message) { var emailMessage = new MimeMessage(); emailMessage.From.Add(new MailboxAddress(""Joe Bloggs"", ""jbloggs@example.com"")); emailMessage.To.Add(new MailboxAddress("""", email)); emailMessage.Subject = subject; emailMessage.Body = new TextPart(""plain"") { Text = message }; using (var client = new SmtpClient()) { client.LocalDomain = ""some.domain.com""; await client.ConnectAsync(""smtp.relay.uri"", 25, SecureSocketOptions.None).ConfigureAwait(false); await client.SendAsync(emailMessage).ConfigureAwait(false); await client.DisconnectAsync(true).ConfigureAwait(false); } }}",Implement the SendEmailAsync interface and send Email
Implement the SendEmailAsync inteface and send Email - .Net Core Identity," I don't know how to invoke the SendEmailAsync functionRegister Post page Email configuration Page// this code was already there //I got this code from some other site. I don't know how to use this together. how the write the class definition to send email.Break point does not reach here, I think there is some problem with my implementation. <code>  public async Task<IActionResult> Register(RegisterViewModel model, string returnUrl = null) { ViewData[""ReturnUrl""] = returnUrl; if (ModelState.IsValid) { var user = new ApplicationUser { UserName = model.Email, Email = model.Email }; var result = await _userManager.CreateAsync(user, model.Password); if (result.Succeeded) { // For more information on how to enable account confirmation and password reset please visit http://go.microsoft.com/fwlink/?LinkID=532713 // Send an email with this link var code = await _userManager.GenerateEmailConfirmationTokenAsync(user); var callbackUrl = Url.Action(""ConfirmEmail"", ""Account"", new { userId = user.Id, code = code }, protocol: HttpContext.Request.Scheme); await _emailSender.SendEmailAsync(model.Email, ""Confirm your account"", $""Please confirm your account by clicking this link: <a href='{callbackUrl}'>link</a>""); await _signInManager.SignInAsync(user, isPersistent: false); _logger.LogInformation(3, ""User created a new account with password.""); return RedirectToLocal(returnUrl); } AddErrors(result); } // If we got this far, something failed, redisplay form return View(model); } public interface IEmailSender{ Task SendEmailAsync(string email, string subject, string message);} public class sendMail : IEmailSender // this line is written by me{ public async Task SendEmailAsync(string email, string subject, string message) { var emailMessage = new MimeMessage(); emailMessage.From.Add(new MailboxAddress(""Joe Bloggs"", ""jbloggs@example.com"")); emailMessage.To.Add(new MailboxAddress("""", email)); emailMessage.Subject = subject; emailMessage.Body = new TextPart(""plain"") { Text = message }; using (var client = new SmtpClient()) { client.LocalDomain = ""some.domain.com""; await client.ConnectAsync(""smtp.relay.uri"", 25, SecureSocketOptions.None).ConfigureAwait(false); await client.SendAsync(emailMessage).ConfigureAwait(false); await client.DisconnectAsync(true).ConfigureAwait(false); } }}",Implement the SendEmailAsync interface and send Email
Implement the SendEmailAsync inteface and send Email," I don't know how to invoke the SendEmailAsync functionRegister Post page Email configuration Page// this code was already there //I got this code from some other site. I don't know how to use this together. how the write the class definition to send email.Break point does not reach here, I think there is some problem with my implementation. <code>  public async Task<IActionResult> Register(RegisterViewModel model, string returnUrl = null) { ViewData[""ReturnUrl""] = returnUrl; if (ModelState.IsValid) { var user = new ApplicationUser { UserName = model.Email, Email = model.Email }; var result = await _userManager.CreateAsync(user, model.Password); if (result.Succeeded) { // For more information on how to enable account confirmation and password reset please visit http://go.microsoft.com/fwlink/?LinkID=532713 // Send an email with this link var code = await _userManager.GenerateEmailConfirmationTokenAsync(user); var callbackUrl = Url.Action(""ConfirmEmail"", ""Account"", new { userId = user.Id, code = code }, protocol: HttpContext.Request.Scheme); await _emailSender.SendEmailAsync(model.Email, ""Confirm your account"", $""Please confirm your account by clicking this link: <a href='{callbackUrl}'>link</a>""); await _signInManager.SignInAsync(user, isPersistent: false); _logger.LogInformation(3, ""User created a new account with password.""); return RedirectToLocal(returnUrl); } AddErrors(result); } // If we got this far, something failed, redisplay form return View(model); } public interface IEmailSender{ Task SendEmailAsync(string email, string subject, string message);} public class sendMail : IEmailSender // this line is written by me{ public async Task SendEmailAsync(string email, string subject, string message) { var emailMessage = new MimeMessage(); emailMessage.From.Add(new MailboxAddress(""Joe Bloggs"", ""jbloggs@example.com"")); emailMessage.To.Add(new MailboxAddress("""", email)); emailMessage.Subject = subject; emailMessage.Body = new TextPart(""plain"") { Text = message }; using (var client = new SmtpClient()) { client.LocalDomain = ""some.domain.com""; await client.ConnectAsync(""smtp.relay.uri"", 25, SecureSocketOptions.None).ConfigureAwait(false); await client.SendAsync(emailMessage).ConfigureAwait(false); await client.DisconnectAsync(true).ConfigureAwait(false); } }}",Implement the SendEmailAsync interface and send Email
Simulating a swipe gesture not working," That is my code to try and simulate a swipe gesture so when I build to mobile I know it will work. Nothing is being logged and I am confused on why it seems to not work. I want it to print out in the console that I either swiped RTL (Right to Left) or LTR (Left to right). I do not see what I am doing wrong. <code>  void Update(){ if (Input.GetMouseButtonDown(0)) { startPosition = Camera.main.ScreenToWorldPoint(Input.mousePosition); } if (Input.GetMouseButtonUp(0)) { endPosition = Camera.main.ScreenToWorldPoint(Input.mousePosition); } if (startPosition != endPosition && startPosition != Vector3.zero && endPosition != Vector3.zero) { float deltaX = endPosition.x - startPosition.x; float deltaY = endPosition.y - startPosition.y; if ((deltaX > 5.0f || deltaX < -5.0f) && (deltaY >= -1.0f || deltaY <= 1.0f)) { if (startPosition.x < endPosition.x) { print(""LTR""); } else { print(""RTL""); } } startPosition = endPosition = Vector3.zero; }}",Detect swipe gesture direction
DateTime To Be NULL when Null," In my console app I am attempting to format to HHmmss -> I am sure it is due to my data types but how can I have this be NULL when NULL and not display 1/1/0001 12:00:00 AM?This is my syntax If altered to public static DateTime? fmtLastScanTime; I get an error of 'No overload for method 'ToString' takes 1 argumentsHow can I have this display NULL instead of 1/1/0001 12:00:00 AM?Trying to account for 1/1/0001 12:00:00 AM being displayed <code>  public static DateTime fmtLST;public static string LST = null; if (LST != null){ IFormatProvider format = System.Threading.Thread.CurrentThread.CurrentCulture.DateTimeFormat; fmtLST = DateTime.ParseExact(LST, ""HHmmss"", format);}Console.WriteLine(fmtLST.ToString(""hh:mm:ss tt""));",DateTime To Be NULL when the value is DateTime.MinValue or it is Null
MSTest V2 - Assert.ThrowsExceptionAsync," Question:I haven't found much about MSTest V2 for examples or documentation. What is the correct way to use Assert.ThrowsExceptionAsync? this also fails the test: Message: Assert.ThrowsException failed. No exception thrown.PlaylistNotFoundException exception was expected.This is failing for me, even though I've debugged it and the exception is definitely thrown.Since this is still an RC, it's possible there is a bug. I've had this in 2 tests I'm trying to convert so I can use VS 2017.Update: This passes. Update 2: After Stephen Cleary's answer, I made this change. Thanks for pointing out my mis-use. I had changed it awhile back because I get ""Message: Test method .Test.Models.Helpers.PlaylistTargetFusionManagerTests.GetPlaylistByIdAsync_NonExistingPlaylist_ThrowsPlaylistNotFoundException threw exception:System.MissingMethodException: Method not found: 'System.Threading.Tasks.Task1<!!0> Microsoft.VisualStudio.TestTools.UnitTesting.Assert.ThrowsExceptionAsync(System.Func1<System.Threading.Tasks.Task>)'."" when I run the test. I have 2 packages in my packages.json <code>  public void GetPlaylistByIdAsync_NonExistingPlaylist_ThrowsPlaylistNotFoundException(){ var playlistId = Guid.NewGuid().ToString(); var manager = PlaylistTargetsFakeFactory.GetPlaylistTargetFusionManager(); Assert.ThrowsException<PlaylistNotFoundException>(async () => { await manager.GetPlaylistByIdAsync(playlistId); });} Assert.ThrowsException<PlaylistNotFoundException>(() =>{ return manager.GetPlaylistByIdAsync(playlistId);}); [TestMethod]public async Task GetPlaylistByIdAsync_NonExistingPlaylist_ThrowsPlaylistNotFoundException(){ var playlistId = Guid.NewGuid().ToString(); var manager = PlaylistTargetsFakeFactory.GetPlaylistTargetFusionManager(); //Assert.ThrowsException<PlaylistNotFoundException>(() => //{ try { await manager.GetPlaylistByIdAsync(playlistId); Assert.Fail(); } catch (PlaylistNotFoundException) { Assert.IsTrue(true); } //});} [TestMethod][TestCategory(TestCategories.CSharp)][TestCategory(TestCategories.PlaylistTargets)]public async Task GetPlaylistByIdAsync_NonExistingPlaylist_ThrowsPlaylistNotFoundException(){ var playlistId = Guid.NewGuid().ToString(); var manager = PlaylistTargetsFakeFactory.GetPlaylistTargetFusionManager(); await Assert.ThrowsExceptionAsync<PlaylistNotFoundException>(() => manager.GetPlaylistByIdAsync(playlistId));} <package id=""MSTest.TestAdapter"" version=""1.1.9-rc2"" targetFramework=""net451"" /> <package id=""MSTest.TestFramework"" version=""1.0.8-rc2"" targetFramework=""net451"" />",Assert.ThrowsExceptionAsync isn't working
Is casting to IList and the calling ToList() when null better?," When I have a IEnumerable<SomeClass> from which I don't know wheter its a list or not (in terms of List<T>), and I have to enumerate that IEnumerable to make sure that I dont enumerate that enumerable twice (such as looping over it twice, or something like that).Resharper warns me about possible multiple enumeration of IEnumerable - which is good, sometimes you forget it - and allows you to chose quickfixes:Enumerate to array Enumerate to listWhen I chose Enumerate to list, resharper introduces a local variable, and assigns the IEnumerable the following way (example): Now my question is:Why doesn't it simply do items.ToList();? What's the advantage of trying to cast to IList<SomeClass> first? <code>  var enumeratedItems = items as IList<SomeClass> ?? items.ToList();",Is casting to IList and then calling ToList() when null better than plain ToList()?
Find nonawaited async method calls," I've just stumbled across a rather dangerous scenario while migrating an ASP.NET application to the async/await model.The situation is that I made a method async: async Task DoWhateverAsync(), changed the declaration in the interface to Task DoWhateverAsync() and hoped that the compiler would tell me where the code now is wrong, via that Warning. Well, tough luck. Wherever that object gets injected via the interface, the warning doesn't happen. :-(This is dangerous. Is there any way to check automatically for non-awaited methods that return tasks? I don't mind a few warnings too many, but I wouldn't want to miss one.Here's an example: <code>  using System.Threading.Tasks;namespace AsyncAwaitGames{ // In my real case, that method just returns Task. public interface ICallee { Task<int> DoSomethingAsync(); } public class Callee: ICallee { public async Task<int> DoSomethingAsync() => await Task.FromResult(0); } public class Caller { public void DoCall() { ICallee xxx = new Callee(); // In my real case, the method just returns Task, // so there is no type mismatch when assigning a result // either. xxx.DoSomethingAsync(); // This is where I had hoped for a warning. } }}",Find non-awaited async method calls
C# - Export .pfx certificate and import it later as file," I basically need to export a .pfx certificate as a Base64string, store it in a database and recover it later, converting from Base64string.What I'm using at the moment is the X509Certificate2 class like the following:To convert it and store in DB the cert64 string: And get it later from DB (I need to store it as a Base64string): And it returns true when I compare C:\originalcert.pfx and C:\copycert.pfx using: For the application I'm running that requires a certificate to work properly, I sometimes get an error with some different .pfx certificates provided to me that I use to work around importing/installing to the machine and exporting it via web browser, creat a new .pfx file and voil.Using the copycert.pfx file gives me the same error but when I try to install copycert.pfx through the file or import it using a web browser I get: ""The import was successful"" message, but can't find the installed certificate under the ""Personal"" tab as I would if I installed the original originalcert.pfx.Also, it is important that I export from a .pfx file and import it later to a .pfx file.What am I doing wrong/is missing in the code export/import? <code>  X509Certificate2 pfx = new X509Certificate2(@""C:\originalcert.pfx"", ""password"", X509KeyStorageFlags.Exportable | X509KeyStorageFlags.PersistKeySet | X509KeyStorageFlags.UserKeySet);string cert64 = Convert.ToBase64String(pfx.RawData); X509Certificate2 cert = new X509Certificate2();cert.Import(Convert.FromBase64String(string64cert), ""password"", X509KeyStorageFlags.Exportable | X509KeyStorageFlags.PersistKeySet | X509KeyStorageFlags.UserKeySet);File.WriteAllBytes(@""C:\copycert.pfx"", cert.Export(X509ContentType.Pfx, ""password"")); X509Certificate2.Equals",C# - Export .pfx certificate and import it later as a file
Changing parts of views dynamically based on controller response," I'm looking for best approach suggestions for the below scenario:A user can choose one or more csv files to validate(Attachment 1) which on ""validate"" button click goes through the validation code(showing progress bar till it returns an output).A return response is either a success message or the error details for each file chosen to validate(Attachment 2)A successfully validated file can now be uploaded to azure storage with an ""Upload"" button.Attachment 1Attachment 2Now, to make everything asynchronous, my thought is that the view needs to have individual flexible section for each file.I'm working with MVC5 razor views with knockout.js, I have decent idea about partial views but I am not certain on how to go about this. If not partial views, then what would be the best approach. <code> ",Changing parts of view dynamically based on controller response
Correctly awaiting in F# a C# method with return type of Task<T>," I'd like to be able to consume a C# library from F#. Mostly this has been pretty straightforward. However, if I try to call a function that returns a Task<T> I am not able to get the returned value.So, I have C# method with the following definition: And I am trying to consume this method from F# as follows: I partially apply this function with an instance of an IEventStoreRepository and the stream name I wish to retrieve the event from: Then, finally, I apply the remaining parameter: When I get the value of event it is a FSharpAsync<object> rather than the T from the Task<T> that I had expected.What is the correct method in F# of calling an async method written in C# with a return type of Task<T> and accessing the value of T? <code>  public async Task<TEvent> ReadEventAsync<TEvent>(string streamName, int position) where TEvent: class let readEventFromEventStore<'a when 'a : not struct> (eventStore:IEventStoreRepository) (streamName:string) (position:int) = async { return eventStore.ReadEventAsync(streamName, position) |> Async.AwaitTask } let readEvent = readEventFromEventStore eventStore streamName let event = readEvent StreamPosition.Start",Correctly awaiting in F# an async C# method with return type of Task<T>
Google Protocol Buffers - serialize to byte array.," I'm following the tutorial for using Google Protocol Buffers for C#. I don't see an example for converting an object into a byte array - does anyone know how to do that? I've auto-generated a FilePath classes using the protoc compiler and have this so far: So, I need to know how to properly serialize the fp object without the use of BinaryFormatter.  <code>  FilePath fp = new FilePath{ Path = ""TestPath"", RealTimeMultiple = 5.0f};",Google Protocol Buffers - serialize to byte array
Google Protocol Buffers - serialize to byte array then send," I'm following the tutorial for using Google Protocol Buffers for C#. I don't see an example for converting an object into a byte array - does anyone know how to do that? I've auto-generated a FilePath classes using the protoc compiler and have this so far: So, I need to know how to properly serialize the fp object without the use of BinaryFormatter.  <code>  FilePath fp = new FilePath{ Path = ""TestPath"", RealTimeMultiple = 5.0f};",Google Protocol Buffers - serialize to byte array
Not all code paths return a value - bools in try," I'm trying to figure out why the compiler has a problem with this function. It gives me the ""Not all code paths return a value"" error, however I cannot see a situation where control-flow would pass to the if( a ) expression without a being true (so the if( a ) is superfluous, but the compiler doesn't seem to recognize that). The immediate fix is to simply remove the if( a ) guard statement completely and just return x immediately - but why does the compiler complain even though it should be able to statically prove all possible code paths will hit a return statement? Crucially, there are no loops, which are often the main reason for it failing to prove return-ness.I'm using VS2015 Update 3. <code>  public static Boolean Foo(Boolean x){ Boolean a = false; if( x ) { a = true; } else { try { SomethingThatMightThrow(); Assert.IsFalse( a ); return a; } catch(Exception) { a = true; } } if( a ) { return x; }}",Why does the compiler complain that 'not all code paths return a value' when I can clearly see that they do?
execute methods of null objects," I have read on MSDN that: The null keyword is a literal that represents a null reference, one that does not refer to any object.But I've seen the following code running without throwing any exception: So if the variable i is null, why can I execute it's method?  <code>  int? i = null;var s = i.ToString();",How is it that can I execute method on int? set to null without NullReferenceException?
get all registered routes in .net core," I am new to .NET Core. I want to get a list of all registered routes in ASP.NET Core. In ASP.NET MVC we had route table in System.Web.Routing, is there something equivalent in ASP.NET Core? I want to get the routes list in my Controller Action. <code> ",Get all registered routes in ASP.NET Core
Using Async/await or task usage in web api controller," I have a .net core API which has a controller that builds an aggregated object to return.the object it creates is made of data that comes from 3 method calls to a service class. These are all independent of each other and can be run in isolation from each other.Currently I am using tasks to improve the performance of this controller. the current version looks something like this... This works well however I am wondering if using tasks is the best solution here? Would using async/await be a better idea and more accepted way?For example should the controller be marked as async and an await put on each call to the the service methods? <code>  [HttpGet]public IActionResult myControllerAction(){ var data1 = new sometype1(); var data2 = new sometype2(); var data3 = new List<sometype3>(); var t1 = new Task(() => { data1 = service.getdata1(); }); t1.Start(); var t2 = new Task(() => { data2 = service.getdata2(); }); t2.Start(); var t3 = new Task(() => { data3 = service.getdata2(); }); t3.Start(); Task.WaitAll(t1, t2, t3); var data = new returnObject { d1 = data1, d2 = data2, d2 = data3 }; return Ok(data);}",Using async/await or task in web api controller (.net core)
Azure DocumentDB: ResourceType Document is unexpected," I'm new to Azure DocumentDB, and I've immediately run into a problem while trying it out. On the first save in an empty collection, I get the following error:ResourceType Document is unexpected.ActivityId: 29619975-e55a-4f31-a3d1-73d180ba3932My repository code (partial) is as follows: This is the first time anything has ever been written to this database/collection. Am I doing something wrong? <code>  public interface IEntity{ string Id { get; set; } DateTime DbCreatedAt { get; set; } DateTime DbLastUpdatedAt { get; set; }}public class Repository<T>: IRepository<T> where T: class, IEntity{ private DocumentClient _documentClient; private string _databaseName; private string _collectionName; // .... // .... public Task SaveAsync(T entity) { var documentUri = UriFactory.CreateDocumentUri(_databaseName, _collectionName, entity.Id); return _documentClient.UpsertDocumentAsync(documentUri, entity); }}",ResourceType Document is unexpected at UpsertDocumentAsync()
Implementing bitmap in Cuda from C#," I am using Cudafy as c# wrapper I need to get colour info InputBitmap0.GetPixel(x, y) of a bitmap and make an new bitmap for output .I need the following work to be done in GPU.IN CPU In short:How to GetPixel() for each pixel point of the input Bitmap, SetPixel() for each pixel point of the outputbitmap Bitmap in GPU. <code>  OutputBitmap.SetPixel(object_point_x, object_point_y, InputBitmap0.GetPixel(x, y));","C# Bitmap GetPixel(), SetPixel() in GPU"
"Yield Return, no throwing exception"," I have this code in visual studio that when the argument is null will not throw the exception and I cannot figure out why! Is the yield return messing with it somehow? <code>  IEnumerable<string> Method(string s){ if(string == null) { throw new Exception(); } if(dictionary.TryGetValue(s, out list)) { foreach(string k in list) { yield return k; } }}",Method having yield return is not throwing exception
Why encrypting HMAC-SHA1 in exactly the same code in C# and powershell show different results?," I've been trying to encrypt a Amazon S3-like authorization key with HMAC-SHA1 in PowerShell with the following code: This code outputs NcJQ1MapHbyRwC2FzvABYyte5uY=, which is incorrect according to our service provider's suggestion.Then I tried to use exactly the same classes in C# code: Oddly enough, this time, the result is correct: 1S+/P9zgcCCyjwUK1bPKaKeya7A=I also tried Python, and it vindicated the C# code. Why did PowerShell run into an incorrect answer even though the inputs, classes and the methods are exactly the same with those which are called in C# code? <code>  $str=""PUT\n\napplication/x-zip-compressed\nThu, 09 Feb 2017 08:59:43 GMT\n/test-bucket/test-key""$secret=""c334da95a6734ff4a04abd99efca450f""$sha = [System.Security.Cryptography.KeyedHashAlgorithm]::Create(""HMACSHA1"")$sha.Key = [System.Text.Encoding]::UTF8.Getbytes($secret)$sign = [Convert]::Tobase64String($sha.ComputeHash([System.Text.Encoding]::UTF8.Getbytes(${str})))echo $sign static void Main(string[] args){ var str = ""PUT\n\napplication/x-zip-compressed\nThu, 09 Feb 2017 08:59:43 GMT\n/test-bucket/test-key""; var secret = ""c334da95a6734ff4a04abd99efca450f""; var sha = System.Security.Cryptography.KeyedHashAlgorithm.Create(""HMACSHA1""); sha.Key = System.Text.Encoding.UTF8.GetBytes(secret); Console.WriteLine(Convert.ToBase64String(sha.ComputeHash(System.Text.Encoding.UTF8.GetBytes(str)))); //1S+/P9zgcCCyjwUK1bPKaKeya7A= Console.Read();}",Why does encrypting HMAC-SHA1 in exactly the same code in C# and PowerShell show different results?
How to Specify EntityFramework7 Table Mapping, I've made a simple Entity Framework ASP Core Application that works but I do not know why:I've made a context like this: And I have two tables with models like this: The interesting thing is that when I run my application it actually can pick up the data. It just seems weird because I have not specified any table mapping.I'm assuming this just automaps because the specified tables are the same name.My questions are:How do I specify Table explicit table mapping in case I do not want my model names to be exactly the same as the DB?How do I specify Custom Column Mapping.Is there anything special I have to specify for Primary/Foreign KeyseditTo clarifySay I had a table in the DB MyAccounts and I wanted to map that to an entity Accounts.Say I had a column password and I wanted that to map to a POCO property PasswordHash <code>  public class AstootContext : DbContext{ public AstootContext(DbContextOptions<AstootContext> options) : base(options) { } public DbSet<Account> Accounts { get; set; } public DbSet<User> Users { get; set; }} public class Account{ public int Id { get; set; } public string Username { get; set; } public string PasswordHash { get; set; } public DateTime Created { get; set; } List<User> Users { get; set; }}public class User{ public int Id { get; set; } public string FirstName { get; set; } public string LastName { get; set; } public string Email { get; set; } public DateTime Birthday { get; set; } public Account Account { get; set; }},How to Specify Entity Framework Core Table Mapping?
C# ReleaseMutex() is not releasing mutex in multiple instances of console applicaiton while launching from Visual Studio.," I have written a sample console application which creates a mutex as shown in below code sample. I am launching this application directly from Visual Studio (VS2013) by pressing Ctrl + F5 (running the application without debugger). For the 1st instance of console application I acquire the mutex and the following line is displayed in console: New Instance created...However, when I create a second instance of console application using Ctrl + F5 again, I get the following message in the console: Instance already acquired...even though I explicitly release mutex after 500ms with this line of code: In the same thread which acquires the mutex, I still see that my second instance of console application waits for the mutex to be released.Can someone explain to me why is it so or correct me if I am doing something wrong? If I understand, ReleaseMutex should release the mutex from the same thread which acquires it via mut.WaitOne(0) call so that any other thread waiting to acquire mutex should be provided ownership. However, in this case I am not able to see it working. If I close the 1st instance which acquired mutex (still my second is alive) and try to launch a 3rd instance with Ctrl+F5, I can see that there is an AbandonedMutexException: Unhandled Exception: System.Threading.AbandonedMutexException: The wait completed due to an abandoned mutex.PS: Interestingly I can see that this works fine if I pass false in mutex constructor as What's the significance of initiallyOwned parameter in the constructor version of mutex class?Console output for 2 instances run from VS <code>  mut.ReleaseMutex(); static Mutex mut = new Mutex(false, ""Global\\test""); public Mutex(bool initiallyOwned, string name); class Program{ static Mutex mut = new Mutex(true, ""Global\\test""); static void Main(string[] args) { if (IsInstance()) { Console.WriteLine(""New Instance created...""); } else { Console.WriteLine(""Instance already acquired...""); } Console.ReadLine(); } static bool IsInstance() { if (!mut.WaitOne(0)) { Console.WriteLine(""Thread id {0} Waiting at Mutex..."",AppDomain.GetCurrentThreadId()); return false; } else { Console.WriteLine(""Thread id {0} got Mutex..."", AppDomain.GetCurrentThreadId()); Thread.Sleep(500); mut.ReleaseMutex(); return true; } }}",C# ReleaseMutex() is not releasing mutex in multiple instances of console application while launching from Visual Studio
Can i use JSON.Stringify in code-behind of an ASP.Net project," In the code-behind of an ASP.NET project (MVP-pattern) I get in one of the presenters a string which contains something which looks like the content of a JSON file.Then I set one of the properties of the view - which is assigned to the presenter - with that string.In the view the string is displayed in a TextBox, but it doesn't look good, because it is not structured with newlines and line feeds.I know there is a JSON-function called Stringify which can make such strings pretty.Can I call that JSON-function in code-behind?Per example when I set the property of the view in the presenter?So I set it in the presenter: This is what I would like to do, if it's possible: GetContentAsJson is a function which creates and returns the JSON-string.This is my view: This is the property in the view which gets the string: <code>  this.view.ContentAsJson = GetContentAsJson(uuid); this.view.ContentAsJson = JSON.Stringify(GetContentAsJson(uuid)); <%@ Control Language=""C#"" AutoEventWireup=""true"" CodeBehind=""ContentJsonView.ascx.cs"" Inherits=""WebCenter.PP.PI.WebGui.View.FolderView.ContentJsonView"" %><%@ Import Namespace=""WebCenter.PP.Common.Domain"" %><div id=""DivContentJson"" class=""clearfix""> <p> <asp:TextBox runat=""server"" ID=""TbContentJson"" TextMode=""MultiLine"" Height=""100%"" Width=""100%"" /> </p></div> public string ContentAsJson{ set { if (!string.IsNullOrEmpty(value)) { TbContentJson.Text = value; } else { TbContentJson.Text = """"; } }}",Can I use JSON.Stringify in code-behind of an ASP.Net project?
How to host multiple .NET Core apps under same url," I am building a few web sites in ASP.NET Core (multiple user interface applications and a WebAPI app). They all work together, utilising the WebAPI. For the purpose of my question we'll call them App1, App2 and App3. I am hosting my websites in IIS.Typically, in the old .NET Framework (4.5.1), I would have one website in IIS, with multiple web apps to host my multiple applications. Like so:WebSite1 - running on port 443App1App2App3If the website (WebSite1) runs on port 443 (using the SSL cert), that means all apps are accessible via one domain url as follows:https://www.myapp.com/App1/https://www.myapp.com/App2/https://www.myapp.com/App3/With different app names at the end of the URL to identify them.When hosting the new ASP.NET Core applications, I host in IIS as well, and following the documentation for ASP.NET Core web site deployment, I host each .NET Core web app in a different site within IIS.As I have one domain name for all my sites, for example, https://www.example.com (I'm using an SSL cert), I have to give the other websites different ports. So I end up with something like this:WebSite1 - running on port 443WebSite2 - running on port 444WebSite3 - running on port 445All of these apps are then accessible via these domain name URLs:https://www.example.com/ or https://www.example.com:443/https://www.example.com:444/https://www.example.com:445/How do I host ASP.NET Core applications all under one website as different ""Applications"", meaning they resolve to the same domain name (https://www.example.com and the forward slash app name identifies which app we want)? OR alternatively, how do I take what I have configured now with the ports and route them all so App1 is default for example.com/, App 2 is example.com/app2/, and App 3 is example.com/app3/?Am I looking at this .NET Core deployment completely the wrong way? <code> ",How to host multiple .NET Core apps under the same URL?
ASP.net core Identity account administration," I'm trying to find a way to provide an administrator of the application I'm developing with an effective way to quickly lockout a user who has either left the company or has been identified as behaving in a way that would warrant an immediate lockout or use of the application.So far it looks like I can; But the above doesn't resolve if the user has a cookie with an expiration time of 30 min. Meaning, the user can continue to use the app if they have already authenticated and are within the default time I'm using for cookies to remain valid.Is there a user manager method that changes the 'check' that cookie is bounced against? I'm assuming the [Authorize] attribute tag is checking the cookie against something within Identity that is not exposed in the table. Wondering how I change the 'check' values so that they don't match cookie session? <code>  //enable the account to be locked out_userManager.SetLockoutEnabledAsync(ApplicationUser user, true);//Set an arbitrary date way into the future to lock them out until I want to unlock them_userManager.SetLockoutEndDateAsync(ApplicationUser user, ""01/01/2060"");",In ASP.net core Identity (UserManager & SignInManager) is it possible to ban a user immediately?
ASP.net core Identity (UserManager & SignInManager) Ban User ASAP?," I'm trying to find a way to provide an administrator of the application I'm developing with an effective way to quickly lockout a user who has either left the company or has been identified as behaving in a way that would warrant an immediate lockout or use of the application.So far it looks like I can; But the above doesn't resolve if the user has a cookie with an expiration time of 30 min. Meaning, the user can continue to use the app if they have already authenticated and are within the default time I'm using for cookies to remain valid.Is there a user manager method that changes the 'check' that cookie is bounced against? I'm assuming the [Authorize] attribute tag is checking the cookie against something within Identity that is not exposed in the table. Wondering how I change the 'check' values so that they don't match cookie session? <code>  //enable the account to be locked out_userManager.SetLockoutEnabledAsync(ApplicationUser user, true);//Set an arbitrary date way into the future to lock them out until I want to unlock them_userManager.SetLockoutEndDateAsync(ApplicationUser user, ""01/01/2060"");",In ASP.net core Identity (UserManager & SignInManager) is it possible to ban a user immediately?
ASP.net core return Json with status code," I'm looking for the correct way to return JSON with a HTTP status code in my .NET Core Web API controller. I use to use it like this: This was in a 4.6 MVC application but now with .NET Core I don't seem to have this IHttpActionResult I have ActionResult and using like this: But the response from the server is weird, as in the image below:I just want the Web API controller to return JSON with a HTTP status code like I did in Web API 2. <code>  public IHttpActionResult GetResourceData(){ return this.Content(HttpStatusCode.OK, new { response = ""Hello""});} public ActionResult IsAuthenticated(){ return Ok(Json(""123""));}",ASP.NET Core return JSON with status code
Compare list efficiently," I'm currently working on a web application in asp.net. In certain api-calls it is necessary to compare ListA with a ListB of Lists to determine if ListA has the same elements of any List in ListB. In other words: If ListA is included in ListB.Both collections are queried with Linq of an EF-Code-First db. ListB has either one matching List or none, never more than one. In the worst case ListB has millions of elements, so the comparison needs to be scalable.Instead of doing nested foreach loops, i'm looking for a pure linq query, which will let the db do the work. (before i consider multi column index)To illustrate the structure: Update StructureSince its a EF Database i'll provide the relevant Object Structure. I'm not sure if i'm allowed to post real code, so this example is still generic. The controller (for the api-call) wants to serve the right Curve-Object. To identify the right Object, a filter (ListA) is provided (which is in fact a Curve Object) Now the filter (ListA) needs to be compared to the List of Curves in Result (ListB)The only way to compare the Curves is by comparing the Points both have.(So infact comparing Lists)Curves have around 1 - 50 Points.Result can have around 500.000.000 CurvesIt's possible to compare by Object-Identity here, because all Objects (even the filter) is re-queried of the db. I'm looking for a way to implement this mechanism, not how to get around this situation. (e.g. by using multi column index (altering the table))(for illustration purposes): <code>  //In reality Lists are queried of EF var ListA = new List<Element>();var ListB = new List<List<Element>>(); List<Element> solution;bool flag = false;foreach (List e1 in ListB) { foreach(Element e2 in ListA) { if (e1.Any(e => e.id == e2.id)) flag = true; else { flag = false; break; } } if(flag) { solution = e1; break; }} //List Bclass Result { ... public int Id; public virtual ICollection<Curve> curves; ...}class Curve { ... public int Id; public virtual Result result; public int resultId; public virtual ICollection<Point> points; ...}public class Point{ ... public int Id; ...} class controller { ... public Response serveRequest(Curve filter) { foreach(Curve c in db.Result.curves) { if(compare(filter.points , c.points)) return c; } }}",How to compare list efficiently?
Deploying ASP.Net Web Forms project on github to dotnet CLI," Here is my current setup:My Local Computer: This is where I created and programmed my ASP.Net WebForms project with Cloudflare Flexible SSL enabled using visual studio 2015 professional on Windows 10. I also have the team explorer enabled meaning my project is synced to Github and all of my files are also stored there in my own repository.My Server Computer: Running Fedora 24, I've installed the dotnet CLI (a.k.a .Net Core), apache (httpd), nginx, and Mono for ASP.Net. I want to deploy/publish and host my webforms project on this computer in the default web directory (/var/www/html/mysite/)The problem is, the dotnet cli relies on a project.json and is not compatible with WebForms. .Net Core is basically not an option. When I use mod_mono, I get an Error 500 (see below) if I connect to https://localhost:9000/ while running the server using the command xsp4 --port 9000. I can't use xsp4 --port 80 or xsp4 --port 443 because then it claims Address is already in use even though httpd is the only process listening on those ports. Note that I can sucessfully build the project using the xbuild command.How can I take my project from github or my local computer and deploy it on to my server computer? Am I missing something? Here is my virtual hosts configuration for reference: httpd.conf. I typically get no errors when starting httpd.service.EDIT:I've also used nginx with fastcgi-mono-server4 with this configuration instead with nginx, which I got straight from here, but still no luck. I usually get this Error 500: other times I can get other types of Error 500. If there is a solution that works with either apache or nginx, please let me know. <code> ",Deploying ASP.Net Web Forms project to Fedora 24
Deploying ASP.Net Web Forms project on github to dotnet CLI on Fedora 23," Here is my current setup:My Local Computer: This is where I created and programmed my ASP.Net WebForms project with Cloudflare Flexible SSL enabled using visual studio 2015 professional on Windows 10. I also have the team explorer enabled meaning my project is synced to Github and all of my files are also stored there in my own repository.My Server Computer: Running Fedora 24, I've installed the dotnet CLI (a.k.a .Net Core), apache (httpd), nginx, and Mono for ASP.Net. I want to deploy/publish and host my webforms project on this computer in the default web directory (/var/www/html/mysite/)The problem is, the dotnet cli relies on a project.json and is not compatible with WebForms. .Net Core is basically not an option. When I use mod_mono, I get an Error 500 (see below) if I connect to https://localhost:9000/ while running the server using the command xsp4 --port 9000. I can't use xsp4 --port 80 or xsp4 --port 443 because then it claims Address is already in use even though httpd is the only process listening on those ports. Note that I can sucessfully build the project using the xbuild command.How can I take my project from github or my local computer and deploy it on to my server computer? Am I missing something? Here is my virtual hosts configuration for reference: httpd.conf. I typically get no errors when starting httpd.service.EDIT:I've also used nginx with fastcgi-mono-server4 with this configuration instead with nginx, which I got straight from here, but still no luck. I usually get this Error 500: other times I can get other types of Error 500. If there is a solution that works with either apache or nginx, please let me know. <code> ",Deploying ASP.Net Web Forms project to Fedora 24
Deploying ASP.Net Web Forms project on github to Fedora 23," Here is my current setup:My Local Computer: This is where I created and programmed my ASP.Net WebForms project with Cloudflare Flexible SSL enabled using visual studio 2015 professional on Windows 10. I also have the team explorer enabled meaning my project is synced to Github and all of my files are also stored there in my own repository.My Server Computer: Running Fedora 24, I've installed the dotnet CLI (a.k.a .Net Core), apache (httpd), nginx, and Mono for ASP.Net. I want to deploy/publish and host my webforms project on this computer in the default web directory (/var/www/html/mysite/)The problem is, the dotnet cli relies on a project.json and is not compatible with WebForms. .Net Core is basically not an option. When I use mod_mono, I get an Error 500 (see below) if I connect to https://localhost:9000/ while running the server using the command xsp4 --port 9000. I can't use xsp4 --port 80 or xsp4 --port 443 because then it claims Address is already in use even though httpd is the only process listening on those ports. Note that I can sucessfully build the project using the xbuild command.How can I take my project from github or my local computer and deploy it on to my server computer? Am I missing something? Here is my virtual hosts configuration for reference: httpd.conf. I typically get no errors when starting httpd.service.EDIT:I've also used nginx with fastcgi-mono-server4 with this configuration instead with nginx, which I got straight from here, but still no luck. I usually get this Error 500: other times I can get other types of Error 500. If there is a solution that works with either apache or nginx, please let me know. <code> ",Deploying ASP.Net Web Forms project to Fedora 24
Deploying ASP.Net Web Forms project on github to Fedora 24," Here is my current setup:My Local Computer: This is where I created and programmed my ASP.Net WebForms project with Cloudflare Flexible SSL enabled using visual studio 2015 professional on Windows 10. I also have the team explorer enabled meaning my project is synced to Github and all of my files are also stored there in my own repository.My Server Computer: Running Fedora 24, I've installed the dotnet CLI (a.k.a .Net Core), apache (httpd), nginx, and Mono for ASP.Net. I want to deploy/publish and host my webforms project on this computer in the default web directory (/var/www/html/mysite/)The problem is, the dotnet cli relies on a project.json and is not compatible with WebForms. .Net Core is basically not an option. When I use mod_mono, I get an Error 500 (see below) if I connect to https://localhost:9000/ while running the server using the command xsp4 --port 9000. I can't use xsp4 --port 80 or xsp4 --port 443 because then it claims Address is already in use even though httpd is the only process listening on those ports. Note that I can sucessfully build the project using the xbuild command.How can I take my project from github or my local computer and deploy it on to my server computer? Am I missing something? Here is my virtual hosts configuration for reference: httpd.conf. I typically get no errors when starting httpd.service.EDIT:I've also used nginx with fastcgi-mono-server4 with this configuration instead with nginx, which I got straight from here, but still no luck. I usually get this Error 500: other times I can get other types of Error 500. If there is a solution that works with either apache or nginx, please let me know. <code> ",Deploying ASP.Net Web Forms project to Fedora 24
Entity Framework Core: How to dinamically get the DbSet from a derived Type?," I have the following abstract class, named Sector: And a second class, GICSSector, wich inherits from Sector: I have the following DbSet in my DbContext: I am trying to write a generic method to loads data from a CSV file, create the objects on the fly and then store the objects in my SQLLite database: I use the fluent API to manage the tables: If I run the code I get the following exception: SQLite Error 1: 'no such table: Sectors'.If I check the type with typeof(T) or using myEntity.GetType() I get the same expected result: MyNamespace.GICSSectorWhy EF Core wants to store it in a table called ""Sectors"" (the base type) and not in the expected GICSSectors?How can I fix it?Note: The method is a generic one that won't be used to handle only classes that inherit from Sector. <code>  public abstract class Sector{ public string ID {get; set;} public string Name {get; set;} public Sector(){} } public class GICSSector: Sector{ public virtual ICollection<GICSIndustryGroup> IndustryGroups {get; set;}} public DbSet<GICSSector> GICSSectors {get; set;} public static void UpdateEntitiesFromCSV<T>(MyContextFactory factory, string fileName) where T : class{ var entities = new List<T>(); // ... Load entities from the CSV // ... Create the objects and add them to the list // Add the objects to the database using (var db = factory.Create(new DbContextFactoryOptions())) { var set = db.Set<T>(); foreach(T e in entities) { set.Add(e); } db.SaveChanges(); }} protected override void OnModelCreating(ModelBuilder modelBuilder){ //... // GICSSector modelBuilder.Entity<GICSSector>().HasKey(s => new { s.ID }); modelBuilder.Entity<GICSSector>().Property(s => s.ID).HasMaxLength(2); modelBuilder.Entity<GICSSector>().Property(s => s.Name).IsRequired(); modelBuilder.Entity<GICSSector>().Property(s => s.Name).HasMaxLength(50);}",Entity Framework Core: How to dynamically get the DbSet from a derived Type?
Best way to migrate html helpers to ASP.NET Core," I'm converting a project to ASP.NET Core. I need to migrate lots of reusable html helpers, but html helpers do not exist in Core.Some are complex, some simple. Here's a extremely simple example: Note that this is only an example.Point is writing a tag helper for that is gigantic overkill. Same for partials. Same for view components.We're talking about a little snippet of Razor. What is my best option? <code>  @helper EditIcon(){ <i class=""glyphicon glyphicon-pencil""></i>}",Migrate html helpers to ASP.NET Core
Is it possible to extend using block in C#.," Is there a way to extend the using block in C# in such a way that takes a delegate as a second parameter alongside an IDisposable object and executes every time when an exception is thrown inside that using block?Imagine we have a delegate, something like this: And suppose I have a method that matches that delegate, something like this: And I want to accomplish something like this: Is there a way to extend C# in such a way? <code>  public delegate void ExceptionHandler(Exception ex); public void Log(Exception ex){ // Some logging stuff goes here} using(SqlConnection connection = new SqlConnection(""""), Log){}",Is it possible to extend the 'using' block in C#?
Illegal characters in path when Directory.GetFiles C#," I have a directory with multiple sub directories that contain .doc files. Example: I want to get all the test*.doc files under all Debug folders. I tried: And it gives me an ""Illegal characters in path"" error.If I try: I get a different error: ""Could not find a part of the path C:\Users\user\Debug"". <code>  C:\Users\user\Documents\testenviroment\Released\test0.docC:\Users\user\Documents\testenviroment\Debug\test1.docC:\Users\user\Documents1\testenviroment\Debug\test2.docC:\Users\user\Documents1\testenviroment\Released\test20.doc string[] files = Directory.GetFiles(@""C:\Users\user"", ""*Debug\\test*.doc"", SearchOption.AllDirectories); string[] files = Directory.GetFiles(@""C:\Users\user"", ""\\Debug\\test*.doc"", SearchOption.AllDirectories); ","""Illegal characters in path"" error using wildcards with Directory.GetFiles"
Illegal characters in path when Directory.GetFiles," I have a directory with multiple sub directories that contain .doc files. Example: I want to get all the test*.doc files under all Debug folders. I tried: And it gives me an ""Illegal characters in path"" error.If I try: I get a different error: ""Could not find a part of the path C:\Users\user\Debug"". <code>  C:\Users\user\Documents\testenviroment\Released\test0.docC:\Users\user\Documents\testenviroment\Debug\test1.docC:\Users\user\Documents1\testenviroment\Debug\test2.docC:\Users\user\Documents1\testenviroment\Released\test20.doc string[] files = Directory.GetFiles(@""C:\Users\user"", ""*Debug\\test*.doc"", SearchOption.AllDirectories); string[] files = Directory.GetFiles(@""C:\Users\user"", ""\\Debug\\test*.doc"", SearchOption.AllDirectories); ","""Illegal characters in path"" error using wildcards with Directory.GetFiles"
Cannot Build Using Unity3d with Tiled2Unityi," I have the Tiled2Unity plugin. When I begin to build a version of my game in Unity, be it standalone version or anything else,i get the following error, ""Error building Player because scripts have compile errors in the editor""Then it points me to this class Can someone please help me figure out what is the problem? <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using UnityEditor;namespace Tiled2Unity{ public class CircleObject : TmxObject { }}",Error when Building Project: Error building Player because scripts have compile errors in the editor
Cannot Build Using Unity3d with Tiled2Unity," I have the Tiled2Unity plugin. When I begin to build a version of my game in Unity, be it standalone version or anything else,i get the following error, ""Error building Player because scripts have compile errors in the editor""Then it points me to this class Can someone please help me figure out what is the problem? <code>  using System;using System.Collections.Generic;using System.Linq;using System.Text;using UnityEditor;namespace Tiled2Unity{ public class CircleObject : TmxObject { }}",Error when Building Project: Error building Player because scripts have compile errors in the editor
"What are the practical scenarios to use IServiceCollection.AddTransient, IServiceCollection.AddSingleton and IServiceCollectionAddScopped Methods?"," After reading this post I can understand the differences between AddTransient,AddScoped and AddSingleton however, I am unable to see the practical usage of each of them. My understanding is AddTransientCreates a new instance every time when the client asks for it. will return a new DataAccess object every time a client code asks for it. More likely a constructor.Usage of AddTransientIn cases when we have to access a database to read and update it and destroy the access object (DataAccess) its best to use AddTransient - Not sure about the thread safty.AddScopedCreates a new instance for each http web request.Usage of AddScoped this mean each web request will be having its own shopping cart instance which intern means each user / client will be having its own shoping cart instance for that http web request.AddSingletonCreate single instance for all the http web requests.Usage of AddSingletonFound this code in an sample application but I dont understand how it is being useful. Can someone please give a decent practical example when to use AddSingleton and check if my understanding of AddTransient and AddScoped is correct? <code>  services.AddTransient<IDataAccess, DataAccess>(); services.AddScoped<ShoppingCart>(serviceProvider => ShoppingCart.GetShoppingCart(serviceProvider)); services.AddSingleton<IHttpContextAccessor, HttpContextAccessor>(); ","What are the practical scenarios to use IServiceCollection.AddTransient, IServiceCollection.AddSingleton and IServiceCollectionAddScoped Methods?"
C# Windows Forms Relative Path to Absolute Path conversion," I am trying to open a Help.txt file in windows Forms using a linkLabel. However unable to convert from absolute to relative path.First, I try to get the absolute path of the exe file. Which is successful.Second, get only directory of the exe file. Which is successful.Third, I am trying to combine the directory with the relative path of the Help.txt file. Which is unsuccessful. Exe file lives in -> \Project\bin\Debug folder, However the Help.txt file lives in \Project\Help folder. This is my code:- The result of my path is -> \Project\bin\Debug....\Help\Help.txt <code>  string exeFile = (new System.Uri(Assembly.GetEntryAssembly().CodeBase)).AbsolutePath; string Dir = Uri.UnescapeDataString(Path.GetDirectoryName(exeFile)); string path = Path.Combine(Dir, @""..\..\Help\Help.txt""); System.Diagnostics.Process.Start(path);",Convert Relative Path to Absolute Path
Filter with arguments and DI," There is a way to make filter with arguments and DI in ASP.NET Core?My working TestFilterAttribute with TestFilterFilter and DI without arguments: And want simply use [TestFilter('MyFirstArgument', 'MySecondArgument')] with agruments instead [TestFilter] without arguments <code>  public class TestFilterAttribute : TypeFilterAttribute{ public TestFilterAttribute() : base(typeof(TestFilterFilter)) { } private class TestFilterFilter : IActionFilter { private readonly MainDbContext _mainDbContext; public TestFilterFilter(MainDbContext mainDbContext) { _mainDbContext = mainDbContext; } public void OnActionExecuting(ActionExecutingContext context) { } public void OnActionExecuted(ActionExecutedContext context) { } }}",ASP.Net Core filters with arguments and DI
Override function with params string[] in the signature," I have these two functions I want to use the second overload when I do the following call Is there a way I can force it to go to the second definition of the method?The compilation error I have is: This call is ambiguous between the following methods or properties: (and then the two methods above)PS: I haven't chose to have these two functions. I can't change their signature or their names. <code>  public static string Function1 (string id, params string[]) { return Function1(id, null, null, params) }public static string Function1 (string id, string id2, Object a, params string[]){ string id = id, if (IsValidId(id)) { start = new ProcessStartInfo(); start.Arguments = params; if (string.IsNullOrEmpty(id2)==false) { start.RedirectStandardOutput = true; } }} MyStaticClaass.Function1( input1, input2, null, // (This one represents the Object) input3, input4, input5);",Overloaded function with params string[] in the signature
Entity Framework Core," Here we are on EF Core and got 3 tables:NewsItemsLinksAnd more (except News, Items): Content, Post, Form, etc.And my model definitions Table Links describe URL for every News and every Item.This means that Links has 4 columns:IdType - news or itemRowId - contains ID of Item or News (depends on the Type)URLHow to setup the relationships?Keep in mind that we need to resolve Entity by URL in Links table. <code>  public class Item{ public int Id { get; set; } public string Name { get; set; } public decimal Price { get; set; } public Link Link { get; set; }}public class News{ public int Id { get; set; } public string Header { get; set; } public string Content { get; set; } public Link Link { get; set; }}public class Link{ public int Id { get; set; } public string Type { get; set; } public int RowId { get; set; } public string Url { get; set; }}",How to setup entity relations in Entity Framework Core
Handle navigation keys in DataGridView," We have a DataGridView with data in a form. To enable quick search, we added TextBox to DataGridView.Controls and highlight cells which contain text from TextBox.However, there is an issue. DataGridView consumes the Left arrow , Right arrow , Home and End (with or without Shift) keys even if the cursor is in TextBox, and the user cannot change the caret position or select text from the keyboard.TextBox generates a PreviewKeyDown event and nothing more happens.Simplified code: Type 123 in TextBox and then try the Right arrow, Left arrow, End, or Home. DataGridView change the selected cell, but the TextBox caret doesn't move.TextBox works just fine if not inside a DataGridView (no problem at all when using the same method adding it into TreeView for example). TextBox acts similar to the Quick search Panel in the browser and has to be on top of the DataGridView. Adding a TextBox to a Form (or to be more specific, to a DataGridView parent) creates its own set of issues (tracking Location, Size, Visibility, ...) and is not acceptable.What can be done to make sure that TextBox receive those keys and change the caret position or select text? <code>  public partial class TestForm : Form{ public TestForm() { InitializeComponent(); Width = 400; Height = 400; var txt = new TextBox { Dock = DockStyle.Bottom, BackColor = Color.Khaki }; var dgv = new DataGridView { Dock = DockStyle.Fill, ColumnCount = 3, RowCount = 5 }; dgv.Controls.Add(txt); Controls.Add(dgv); dgv.PreviewKeyDown += DgvOnPreviewKeyDown; dgv.KeyDown += DgvOnKeyDown; txt.PreviewKeyDown += TxtOnPreviewKeyDown; txt.KeyDown += TxtOnKeyDown; } private void DgvOnPreviewKeyDown(object sender, PreviewKeyDownEventArgs e) { Debug.WriteLine(String.Format(""Dgv Key Preview {0}"", e.KeyCode)); e.IsInputKey = true; } private void DgvOnKeyDown(object sender, KeyEventArgs e) { Debug.WriteLine(String.Format(""Dgv Key {0}"", e.KeyCode)); } private void TxtOnPreviewKeyDown(object sender, PreviewKeyDownEventArgs e) { Debug.WriteLine(String.Format(""Txt Key Preview {0}"", e.KeyCode)); } private void TxtOnKeyDown(object sender, KeyEventArgs e) { Debug.WriteLine(String.Format(""Txt Key {0}"", e.KeyCode)); }}",Handle navigation keys in TextBox inside DataGridView
Better way using hangfire with structuremap on ASP.net core?," I'm using structuremap with hangfire on asp.net core, no error on application but hangfire not process queue/schedule task even though data already on database.Here my snippet configuration Is there any better way using hangfire and structuremap on asp.net core? Am I missing something so hangfire not working properly?My Hangfire structure map implementation Example hangfire call on controller Screenshot: <code>  public IServiceProvider ConfigureServices(IServiceCollection services) { // setup automapper var config = new AutoMapper.MapperConfiguration(cfg => { cfg.AddProfile(new AutoMapperProfileConfiguration()); }); var mapper = config.CreateMapper(); services.AddSingleton(mapper); // Bind settings parameter services.Configure<AppSettings>(Configuration.GetSection(""AppSettings"")); // Add framework services. services.AddApplicationInsightsTelemetry(Configuration); services.Configure<RouteOptions>(options => options.LowercaseUrls = true); services.AddDbContext<DefaultContext>(options => options.UseSqlServer(Configuration.GetConnectionString(""DefaultConnection""))); services.AddHangfire(options => options.UseSqlServerStorage(Configuration.GetConnectionString(""DefaultConnection""))); services.AddMvc(); // ASP.NET use the StructureMap container to resolve its services. return ConfigureIoC(services); } public IServiceProvider ConfigureIoC(IServiceCollection services) { var container = new Container(); GlobalConfiguration.Configuration.UseStructureMapActivator(container); container.Configure(config => { // Register stuff in container, using the StructureMap APIs... config.Scan(_ => { _.AssemblyContainingType(typeof(Startup)); _.WithDefaultConventions(); _.AddAllTypesOf<IApplicationService>(); _.ConnectImplementationsToTypesClosing(typeof(IOptions<>)); }); config.For<JobStorage>().Use(new SqlServerStorage(Configuration.GetConnectionString(""DefaultConnection""))); config.For<IJobFilterProvider>().Use(JobFilterProviders.Providers); config.For<ILog>().Use(c => LoggerFactory.LoggerFor(c.ParentType)).AlwaysUnique(); XmlDocument log4netConfig = new XmlDocument(); log4netConfig.Load(File.OpenRead(""log4net.config"")); var repo = LogManager.CreateRepository( Assembly.GetEntryAssembly(), typeof(log4net.Repository.Hierarchy.Hierarchy)); XmlConfigurator.Configure(repo, log4netConfig[""log4net""]); //Populate the container using the service collection config.Populate(services); }); return container.GetInstance<IServiceProvider>(); } using Hangfire;using StructureMap;namespace Lumochift.Helpers{ /// <summary> /// Bootstrapper Configuration Extensions for StructureMap. /// </summary> public static class StructureMapBootstrapperConfigurationExtensions { /// <summary> /// Tells bootstrapper to use the specified StructureMap container as a global job activator. /// </summary> /// <param name=""configuration"">Bootstrapper Configuration</param> /// <param name=""container"">StructureMap container that will be used to activate jobs</param> public static void UseStructureMapActivator(this GlobalConfiguration configuration, IContainer container) { configuration.UseActivator(new StructureMapJobActivator(container)); } }}using Hangfire;using StructureMap;using System;namespace Lumochift.Helpers{ public class StructureMapJobActivator : JobActivator { private readonly IContainer _container; /// <summary> /// Initializes a new instance of the <see cref=""StructureMapJobActivator""/> /// class with a given StructureMap container /// </summary> /// <param name=""container"">Container that will be used to create instances of classes during /// the job activation process</param> public StructureMapJobActivator(IContainer container) { if (container == null) throw new ArgumentNullException(nameof(container)); _container = container; } /// <inheritdoc /> public override object ActivateJob(Type jobType) { return _container.GetInstance(jobType) } /// <inheritdoc /> public override JobActivatorScope BeginScope(JobActivatorContext context) { return new StructureMapDependencyScope(_container.GetNestedContainer()); } private class StructureMapDependencyScope : JobActivatorScope { private readonly IContainer _container; public StructureMapDependencyScope(IContainer container) { _container = container; } public override object Resolve(Type type) { return _container.GetInstance(type); } public override void DisposeScope() { _container.Dispose(); } } }} BackgroundJob.Enqueue<CobaService>((cb) => cb.GetCoba()); BackgroundJob.Schedule<CobaService>((cb) => cb.GetCoba(), TimeSpan.FromSeconds(5) );",Is there any better way using hangfire with structuremap on ASP.net core?
Simple Puzzle algorythm," I develop a (really) simple puzzle game that asks you to join a point A to a B (enter/exit) using a ball and mechanisms that you can rotate to give the correct direction to the ball in order to join the exit.Here is screenshots of a simple level, showing clearly the purpose of the game:1) New level started, the mechanisms are rotated in a random way2) Level is completed, all the mechanisms are rotated properly to give the ball the right path to join the exitQuestion:How can I create an algorithm allowing me to automatically generate levels by taking into account the rotations and leaving only one possibility for the player to complete the level?I'd also like to add more complexity by adding more mechanisms (to create creating difficulty levels).I don't think it's necessary to talk about tech, but I'm using C# and Unity.Let me know if you need more information.Thank you! <code> ",Simple Puzzle Algorithm
Simple Puzzle Algorythm," I develop a (really) simple puzzle game that asks you to join a point A to a B (enter/exit) using a ball and mechanisms that you can rotate to give the correct direction to the ball in order to join the exit.Here is screenshots of a simple level, showing clearly the purpose of the game:1) New level started, the mechanisms are rotated in a random way2) Level is completed, all the mechanisms are rotated properly to give the ball the right path to join the exitQuestion:How can I create an algorithm allowing me to automatically generate levels by taking into account the rotations and leaving only one possibility for the player to complete the level?I'd also like to add more complexity by adding more mechanisms (to create creating difficulty levels).I don't think it's necessary to talk about tech, but I'm using C# and Unity.Let me know if you need more information.Thank you! <code> ",Simple Puzzle Algorithm
Microsoft.AspNet.WebApi.Client supported in .NET Core or not?," I'm currently trying to do some JSON formatting using the HttpClient in .NET Core and MediaTypeFormatters. Especially the function ""ReadAsAsync(..., MediaTypeFormatter, ...)"" (https://msdn.microsoft.com/de-de/library/system.net.http.httpcontentextensions.readasasync(v=vs.118).aspx) which was available in .NET Framework in the HttpContent-Class would be very helpful. As far as I understood, it can be found in the NuGet package Microsoft.AspNet.WebApi.Client but I cannot download it because it is not supported in .NET Core.Though I have read, that it should be:Where is HttpContent.ReadAsAsync?https://www.techrepository.in/consuming-rest-api-methods-in-net-core-mvc-applicationI know that it is possible to do the formatting using Newtonsoft and so on.But does someone know, if that package will be available in .NET Core some day again? I could not find any information really... <code> ",Is Microsoft.AspNet.WebApi.Client supported in .NET Core or not?
Can I extend / merge language gammars?, Is there a way to extend the default csharp.tmLanguage with some additional rule? With references to existing scopes? <code> ,Can I extend VS Code TextMate Language Grammars?
Can I extend / merge language grammars?, Is there a way to extend the default csharp.tmLanguage with some additional rule? With references to existing scopes? <code> ,Can I extend VS Code TextMate Language Grammars?
Can I extend / merge VS Code TextMate Language Grammars?, Is there a way to extend the default csharp.tmLanguage with some additional rule? With references to existing scopes? <code> ,Can I extend VS Code TextMate Language Grammars?
Unittest Controller decorated with [Authorize] attribute," My application is an ASP.NET Core 1.0 Web API.How do I test a controller which is decorated with the Authorize attribute?For example, with this controller and test method: This is just an example code to make it possible for you guys to answer. I am actually invoking the Controller via a TestServer object.This has already been asked but the accepted answer doesn't work anymore.Any suggestions how I could ""fake"" the users' authenticity? <code>  [TestMethod]public void GetSomeDataTest(){ var controller = new MyController(); Assert.AreEqual(controller.GetSomeData(), ""Test"");}[Authorize]public ActionResult GetSomeData(){ return this.Content(""Test"");}",Integration test on controller decorated with [Authorize] attribute
Integration test Controller decorated with [Authorize] attribute," My application is an ASP.NET Core 1.0 Web API.How do I test a controller which is decorated with the Authorize attribute?For example, with this controller and test method: This is just an example code to make it possible for you guys to answer. I am actually invoking the Controller via a TestServer object.This has already been asked but the accepted answer doesn't work anymore.Any suggestions how I could ""fake"" the users' authenticity? <code>  [TestMethod]public void GetSomeDataTest(){ var controller = new MyController(); Assert.AreEqual(controller.GetSomeData(), ""Test"");}[Authorize]public ActionResult GetSomeData(){ return this.Content(""Test"");}",Integration test on controller decorated with [Authorize] attribute
async provider in .net core DI," I'm just wondering if it's possible to have async/await during DI. Doing the following, the DI fails to resolve my service. where as the following works perfectly fine. <code>  services.AddScoped(async provider => { var client = new MyClient(); await client.ConnectAsync(); return client;}); services.AddScoped(provider => { var client = new MyClient(); client.ConnectAsync().Wait(); return client;});",Async provider in .NET Core DI
Unity3D does change my modified Manifests everytime?," Im currently trying to program a little game for android with Unity3D. Because I want a visible status bar, I modified the AndroidManifest in the Project Folder (C:\Users\Public\Documents\Unity Projects\ProjectName\Temp\StagingArea) like this : But everytime i generate the APK, unity changes the Android Manifest to this : Unity3D does change my modified Manifests everytime? <code>  <application android:theme=""Theme.Light.NoTitleBar"" android:icon=""@drawable/app_icon"" android:label=""@string/app_name"" android:debuggable=""false"" android:isGame=""true"" android:banner=""@drawable/app_banner""> <application android:theme=""@style/UnityThemeSelector"" android:icon=""@drawable/app_icon"" android:label=""@string/app_name"" android:debuggable=""false"" android:isGame=""true"" android:banner=""@drawable/app_banner"">",Use custom Manifest file and permission in Unity?
Use custom Manifest file in Unity?," Im currently trying to program a little game for android with Unity3D. Because I want a visible status bar, I modified the AndroidManifest in the Project Folder (C:\Users\Public\Documents\Unity Projects\ProjectName\Temp\StagingArea) like this : But everytime i generate the APK, unity changes the Android Manifest to this : Unity3D does change my modified Manifests everytime? <code>  <application android:theme=""Theme.Light.NoTitleBar"" android:icon=""@drawable/app_icon"" android:label=""@string/app_name"" android:debuggable=""false"" android:isGame=""true"" android:banner=""@drawable/app_banner""> <application android:theme=""@style/UnityThemeSelector"" android:icon=""@drawable/app_icon"" android:label=""@string/app_name"" android:debuggable=""false"" android:isGame=""true"" android:banner=""@drawable/app_banner"">",Use custom Manifest file and permission in Unity?
Difference when you use myArray.GetValue(2) and myArray[2]," Is there any difference between using myArray.GetValue(2) and myArray[2]?For example: <code>  namespace ConsoleApplication16{ class Program { static void Main(string[] args) { int[] numbers = new int[] { 1, 2, 3, 4 }; Console.WriteLine(numbers.GetValue(3)); Console.WriteLine(numbers[3]); Console.ReadLine(); } }}",What is the difference between myArray.GetValue(2) and myArray[2] in C#?
"cefsharp wait for page to load, winforms C#"," first and foremost I am a novice at C# and learning Cefsharp + javascript as I go so please attempt to comment any solution you feel are necessary, will save me asking stupid questions.I'm attempting to wait until the page has finished loading with Cefsharp to execute my code, I have tried several solutions found on other stackoverflow questions / github but no go.I thought the solution was ""NavStateChanged"" but I'm getting a C# error of:""ChromiumWebBrowser does not contain a definition for 'NavStateChanged'""Could anyone point me in the right direction or throw me a snippet ? I'm not asking you to write the entire thing for me but I'm genuinely lost here, im learning C#, Cefsharp & javascript all at once and well... its overwhelming.This is the code I found while looking for a solution online, it also matches a lot of the github references but doesn't seem to work :/ <code>  EventHandler<NavStateChangedEventArgs> handler = null;handler = (sender, args) = > { //TODO : show a loading gif until the page load completes //Wait for while page to finish loading not just the first frame if (!args.IsLoading) { chromeBrowser.NavStateChanged -= handler; MessageBox.Show(""The page has completed loading"", ""Load completed"", MessageBoxButtons.OK); //TODO : once load complete show the actual page }",Wait for a page to load with CefSharp
How to use Nullable Value Types," The Proto3 C# Reference contains the following text: Wrapper Type Fields Most of the well-known types in proto3 do not affect code generation, but the wrapper types (StringWrapper, Int32Wrapper etc) change the type and behaviour of the properties. All of the wrapper types that correspond to C# value types (Int32Wrapper, DoubleWrapper, BoolWrapper etc) are mapped to Nullable<T> where T is the corresponding non-nullable type. For example, a field of type DoubleValue results in a C# property of type Nullable<double>. Fields of type StringWrapper or BytesWrapper result in C# properties of type string and ByteString being generated, but with a default value of null, and allowing null to be set as the property value. For all wrapper types, null values are not permitted in a repeated field, but are permitted as the values for map entries.When trying to generate a .cs file from a .proto file, If I try to declare a field as Int32Wrapper in the .proto file, protoc.exe throws an error about Int32Wrapper not existing. It seems there is some additional step that is missing here, does anyone know how to enable these types? <code>  syntax =""proto3"";package prototest;import ""MessageIdentifier.proto"";message TestMessage { string messageTest = 1; fixed64 messageTimestampTicks = 2; uint32 sequenceNumber = 3; MessageUniqueID uniqueID = 4; Int32Wrapper nullableInt = 5; }",Can Nullable types be sent through Protocol Buffers?
C# Mysql - Using of locks on database query for async I/O," I have TcpListener class and I'm using async/await reading and writing.For this server I have created single database instance where I have prepared all database queries.But for more then one TcpClient I'm keep getting exception: An exception of type MySql.Data.MySqlClient.MySqlException occurred in MySql.Data.dll but was not handled in user code Additional information: There is already an open DataReader associated with this Connection which must be closed first.If I understand it correctly there can't be more then one database query at time which is problem with more then one async client.So I simply added locks in my queries like this and everything seems fine. I have also try the method with usings which create new connection for every query as mentioned from someone of SO community but this method is much more slower than locks: I used Stopwatch to benchmarks this methods and queries with one connection with locks are performed in +- 20ms which is +- only delay of network but with usings it is +- 55ms because of .Open() method which takes +- 35ms.Why a lot of people use method with usings if there is much worse performance? Or am I doing something wrong? <code>  // One MySqlConnection instance for whole program. lock (thisLock) { var cmd = connection.CreateCommand(); cmd.CommandText = ""SELECT Count(*) FROM logins WHERE username = @user AND password = @pass""; cmd.Parameters.AddWithValue(""@user"", username); cmd.Parameters.AddWithValue(""@pass"", password); var count = int.Parse(cmd.ExecuteScalar().ToString()); return count > 0;} using (MySqlConnection connection = new MySqlConnection(connectionString)) { connection.Open(); // This takes +- 35ms and makes worse performance than locks using (MySqlCommand cmd = connection.CreateCommand()) { cmd.CommandText = ""SELECT Count(*) FROM logins WHERE username = @user AND password = @pass""; cmd.Parameters.AddWithValue(""@user"", username); cmd.Parameters.AddWithValue(""@pass"", password); int count = int.Parse(cmd.ExecuteScalar().ToString()); return count > 0; } }",C# Mysql - Using of locks on database query for async await server
Update-Database command is not working in ASP.Net Core / Entity Framework 6 because object in database already exists," I was updating my database by the command line, but then I manually updated one of my tables. This seems to have disrupted my ability to update-database. I receive the following error when I try to update: I have been trying to fix this problem for the past few days. Most fellow developers suggest some variation of using Add-migration ""Reset"" -IgnoreChanges, like John Salewski from the following link. However, I keep getting an error that says ""A parameter cannot be found that matches parameter name 'IgnoreChanges'"".Any suggestions would be greatly appreciated!  <code>  System.Data.SqlClient.SqlException: There is already an object named 'ClientsAndTestimonials' in the database. at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction) at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose) at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady) at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite) at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite, String methodName) at System.Data.SqlClient.SqlCommand.ExecuteNonQuery() at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, String executeMethod, IReadOnlyDictionary`2 parameterValues, Boolean openConnection, Boolean closeConnection) at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues, Boolean manageConnection) at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection) at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration) at Microsoft.EntityFrameworkCore.Design.MigrationsOperations.UpdateDatabase(String targetMigration, String contextType) at Microsoft.EntityFrameworkCore.Tools.Cli.DatabaseUpdateCommand.<>c__DisplayClass0_0.<Configure>b__0() at Microsoft.Extensions.CommandLineUtils.CommandLineApplication.Execute(String[] args) at Microsoft.EntityFrameworkCore.Tools.Cli.Program.Main(String[] args) ClientConnectionId:d89989a8-ce8b-4167-be7e-fcddc4bcdf98 Error Number:2714,State:6,Class:16 There is already an object named 'ClientsAndTestimonials' in the database. ",Update-Database command is not working in ASP.Net Core / Entity Framework Core because object in database already exists
How to get connection string out of Azure KeyStore?," A hypothetical web-site currently connects using: Where the magical connection string is stored in web.config: Now i'd like to move the connection string out of the web.config file into Azure KeyVault. How do you retrieve anything out of the Azure key vault? Except i just made up the easy-to-use Azure API. What is the actual api?Untested attempt Bonus ReadingMSDN Forums: Storing sql connection string passwords in Key Vault for my Cloud ServicesHow to properly store connection strings in Azure?Easily switching ConnectionStrings on publish to Azure <code>  public SqlConnection CreateConnection(){ DbConnection connection = new SqlConnection(); connection.ConnectionString = GetConnectionString(); connection.Open(); return connection;} String GetConnectionString(){ //Get the connection string info from web.config ConnectionStringSettings cs = ConfigurationManager.ConnectionStrings[""db""]; if (cs == null) throw new Exception(""Could not locate DB connection string""); return cs.ConnectionString;} String GetConnectionString(){ //Get the connection string info from Azure KeyVault String connectionString = GetAzureSecret(""dbConnectionString""); if (String.IsNullOrWhitespace(connectionString) throw new Exception.Create(""Could not connection string of Azure Key Vault""); return connectionString;} string GetAzureSecret(string key){ KeyVaultClient vault = new KeyVaultClient(); vault.OnAuthenticate += VaultClientAuthenticate; var sec = await vault.GetSecretAsync(Key); return sec.Value;}public static async Task<string> VaultClientAuthenticate(string authority, string resource, string scope){ String clientID = ""8675209""; String clientSecret = ""correct battery horse pencil""; var authContext = new AuthenticationContext(authority); ClientCredential clientCred = new ClientCredential(clientID, clientSecret); AuthenticationResult result = await authContext.AcquireTokenAsync(resource, clientCred); if (result == null) throw new Exception(""Could not acquire token""); return result.AccessToken;}",How to get connection string out of Azure KeyVault?
How to surpress InMemoryEventId.TransactionIgnoredWarning when testing context with transactions?," I'm using an EF Core in-memory database and I'm trying to run a unit test on a method that uses transactions: However, I'm getting this error from the test runner:System.InvalidOperationException: Warning as error exception forwarning 'InMemoryEventId.TransactionIgnoredWarning': Transactions arenot supported by the in-memory store. Seehttp://go.microsoft.com/fwlink/?LinkId=800142 To suppress thisException use the DbContextOptionsBuilder.ConfigureWarnings API.ConfigureWarnings can be used when overriding theDbContext.OnConfiguring method or using AddDbContext on theapplication service provider.How do I suppress that error? <code>  using (var transaction = await _context.Database.BeginTransactionAsync()){ _context.Update(item); result = await _context.SaveChangesAsync(); // some other stuff transaction.Commit();}",How to suppress InMemoryEventId.TransactionIgnoredWarning when unit testing with in-memory database with transactions?
How to surpress InMemoryEventId.TransactionIgnoredWarning when using in-memory database with transactions?," I'm using an EF Core in-memory database and I'm trying to run a unit test on a method that uses transactions: However, I'm getting this error from the test runner:System.InvalidOperationException: Warning as error exception forwarning 'InMemoryEventId.TransactionIgnoredWarning': Transactions arenot supported by the in-memory store. Seehttp://go.microsoft.com/fwlink/?LinkId=800142 To suppress thisException use the DbContextOptionsBuilder.ConfigureWarnings API.ConfigureWarnings can be used when overriding theDbContext.OnConfiguring method or using AddDbContext on theapplication service provider.How do I suppress that error? <code>  using (var transaction = await _context.Database.BeginTransactionAsync()){ _context.Update(item); result = await _context.SaveChangesAsync(); // some other stuff transaction.Commit();}",How to suppress InMemoryEventId.TransactionIgnoredWarning when unit testing with in-memory database with transactions?
File name at client side after downloading," I've managed to download a file from server side: and code of client side: CORS settings: What I have at client side: However, there is no file name at client side when a file is downloaded from server side. How can I get file name?Update:I've removed a call to map(): however, there is no file name:Update 2:If I use the following policy for CORS: then I get the following error: <code>  [EnableCors(""AllowAll"")][HttpGet(""{id}"", Name = ""Get"")]public IActionResult Get(int id){ var fileName = ""Far30b4949.x86.20170503.zip""; //*** Creation file name var filepath = _hostingEnvironment.WebRootPath; byte[] fileBytes = System.IO.File.ReadAllBytes(_hostingEnvironment.WebRootPath + @""\"" + fileName); return File(fileBytes, ""application/zip"", fileName); //*** Sending file name} public downloadFile() { let projectAUrl = 'http://localhost:49591/api/file/5'; return this.http.get(projectAUrl, {responseType: ResponseContentType.Blob}) .map((response) => { return new Blob([response.blob()], {type:'application/zip'}) }) .subscribe((res)=> { saveAs(res, ""Name does not come here"")//there is no file name, //but there is a file type(""application/zip"") });} public void ConfigureServices(IServiceCollection services){ // Add framework services. services.AddMvc(); //Add CORS support to the service services.AddCors(options=> options.AddPolicy(""AllowAll"", p => p.AllowAnyOrigin() .AllowAnyHeader() .AllowAnyMethod() .AllowCredentials()));} public downloadFile() { let projectAUrl = 'http://localhost:49591/api/file/5'; return this.http.get(projectAUrl, {responseType: ResponseContentType.Blob}) .subscribe((res)=> { saveAs(res, ""Name does not come here"")//there is no file name, //but there is a file type(""application/zip"") });} services.AddCors(options => options.AddPolicy(""ExposeResponseHeaders"", p => { p.WithOrigins(""http://localhost:49591"") .WithExposedHeaders(""Content-Disposition""); })); XMLHttpRequest cannot load http://localhost:49591/api/file/5. No 'Access-Control-Allow-Origin' header is present on the requested resource. Origin 'http://localhost:3000' is therefore not allowed access. The response had HTTP status code 500.",Get file name at client side after downloading. CORS
Get file name at client side after downloading," I've managed to download a file from server side: and code of client side: CORS settings: What I have at client side: However, there is no file name at client side when a file is downloaded from server side. How can I get file name?Update:I've removed a call to map(): however, there is no file name:Update 2:If I use the following policy for CORS: then I get the following error: <code>  [EnableCors(""AllowAll"")][HttpGet(""{id}"", Name = ""Get"")]public IActionResult Get(int id){ var fileName = ""Far30b4949.x86.20170503.zip""; //*** Creation file name var filepath = _hostingEnvironment.WebRootPath; byte[] fileBytes = System.IO.File.ReadAllBytes(_hostingEnvironment.WebRootPath + @""\"" + fileName); return File(fileBytes, ""application/zip"", fileName); //*** Sending file name} public downloadFile() { let projectAUrl = 'http://localhost:49591/api/file/5'; return this.http.get(projectAUrl, {responseType: ResponseContentType.Blob}) .map((response) => { return new Blob([response.blob()], {type:'application/zip'}) }) .subscribe((res)=> { saveAs(res, ""Name does not come here"")//there is no file name, //but there is a file type(""application/zip"") });} public void ConfigureServices(IServiceCollection services){ // Add framework services. services.AddMvc(); //Add CORS support to the service services.AddCors(options=> options.AddPolicy(""AllowAll"", p => p.AllowAnyOrigin() .AllowAnyHeader() .AllowAnyMethod() .AllowCredentials()));} public downloadFile() { let projectAUrl = 'http://localhost:49591/api/file/5'; return this.http.get(projectAUrl, {responseType: ResponseContentType.Blob}) .subscribe((res)=> { saveAs(res, ""Name does not come here"")//there is no file name, //but there is a file type(""application/zip"") });} services.AddCors(options => options.AddPolicy(""ExposeResponseHeaders"", p => { p.WithOrigins(""http://localhost:49591"") .WithExposedHeaders(""Content-Disposition""); })); XMLHttpRequest cannot load http://localhost:49591/api/file/5. No 'Access-Control-Allow-Origin' header is present on the requested resource. Origin 'http://localhost:3000' is therefore not allowed access. The response had HTTP status code 500.",Get file name at client side after downloading. CORS
Not able to deserialize Lazy<Collection<T>> using serialization binder," I want to Serialize and DeSerialize an object which contains a Lazy Collection of some custom objects. Normally everything works perfectly fine but, if namespaces of classes used for serialization are changed, then this issue occurs. I have written a SerializationBinder to point to right classes while deserializing. But for some reason, I am not getting deserialized values.Following code snippet explains the problem that I am getting;Classes used for Serialization: Above same classes are used for Deserialization but only namespace is changed to ConsoleApplication14.OtherNamespaceFor such Deserialization to work, I have used following SerializationBinder class: Serialization and Deserialization of object of MyCustomClass: I am getting NullReferenceException when Value property of deserialized Lazy object is called. (i.e. when objOfOtherNamespaceClass.CollectionOfInnerObj.Value is called)Please help me resolve this issue... <code>  namespace ConsoleApplication14{ [Serializable] public class MyInnerClass : ISerializable { private string _stringInInnerClassKey = ""StringInInnerClass""; public string StringInInnerClass { get; set; } public MyInnerClass() { } private MyInnerClass(SerializationInfo info, StreamingContext context) { StringInInnerClass = info.GetString(_stringInInnerClassKey); } public void GetObjectData(SerializationInfo info, StreamingContext context) { info.AddValue(_stringInInnerClassKey, StringInInnerClass); } } [Serializable] public class MyOuterClass : ISerializable { private string _collectionOfObjKey = ""CollectionOfInnerObj""; public Lazy<Collection<MyInnerClass>> CollectionOfInnerObj { get; set; } private MyOuterClass(SerializationInfo info, StreamingContext context) { if (info == null) throw new ArgumentNullException(""serializationInfo""); CollectionOfInnerObj = (Lazy<Collection<MyInnerClass>>) info.GetValue(_collectionOfObjKey, typeof(Lazy<Collection<MyInnerClass>>)); } public MyOuterClass() { } public void GetObjectData(SerializationInfo info, StreamingContext context) { if (info == null) throw new ArgumentNullException(); info.AddValue(_collectionOfObjKey, CollectionOfInnerObj, typeof(Lazy<Collection<MyInnerClass>>)); } }} public class MyBinder : SerializationBinder{ public override Type BindToType(string assemblyName, string typeName) { if (assemblyName.Equals( ""ConsoleApplication14, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"")) { if (typeName.Equals(""ConsoleApplication14.MyOuterClass"")) return typeof(ConsoleApplication14.OtherNamespace.MyOuterClass); if (typeName.Equals(""ConsoleApplication14.MyInnerClass"")) return typeof(ConsoleApplication14.OtherNamespace.MyInnerClass); } if (assemblyName.Equals(""mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"")) { if (typeName.Equals( ""System.Collections.ObjectModel.Collection`1[[ConsoleApplication14.MyInnerClass, ConsoleApplication14, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"")) return typeof(Collection<ConsoleApplication14.OtherNamespace.MyInnerClass>); if (typeName.Equals( ""System.Collections.Generic.List`1[[ConsoleApplication14.MyInnerClass, ConsoleApplication14, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"")) return typeof(List<ConsoleApplication14.OtherNamespace.MyInnerClass>); if (typeName.Equals( ""System.Lazy`1[[System.Collections.ObjectModel.Collection`1[[ConsoleApplication14.MyInnerClass, ConsoleApplication14, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]"")) return typeof(Lazy<Collection<ConsoleApplication14.OtherNamespace.MyInnerClass>>); //I THINK, MAYBE THIS 'IF' CONDITION IS THE PROBLEM, BUT DONT KNOW HOW TO FIX THIS. if (typeName.Equals( ""System.Lazy`1+Boxed[[System.Collections.ObjectModel.Collection`1[[ConsoleApplication14.MyInnerClass, ConsoleApplication14, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]"")) return typeof(Lazy<Collection<ConsoleApplication14.OtherNamespace.MyInnerClass>>); } return Type.GetType(String.Format(""{0}, {1}"", typeName, assemblyName)); }} public static void Main(string[] args) { //----------------Object Creation---------------------- var objToSerialize = new MyOuterClass { CollectionOfInnerObj = new Lazy<Collection<MyInnerClass>>( () => new Collection<MyInnerClass> { new MyInnerClass { StringInInnerClass = ""a"" }, new MyInnerClass { StringInInnerClass = ""aa"" }, }) }; //------------------------------------------------------ //---------------------Serialization--------------------- using (var stream = File.Create(""E:\\tempFile.tmp"")) { var binaryFormatter = new BinaryFormatter(); binaryFormatter.Serialize(stream, objToSerialize); stream.Close(); } //------------------------------------------------------ //-------------------DeSerialization-------------------- using (var stream = File.OpenRead(""E:\\tempFile.tmp"")) { var binaryFormatter = new BinaryFormatter {Binder = new MyBinder()}; var objOfOtherNamespaceClass = (OtherNamespace.MyOuterClass) binaryFormatter.Deserialize(stream); //Getting NullReferenceException when Value property of objOfOtherNamespaceClass.CollectionOfInnerObj is called foreach (OtherNamespace.MyInnerClass stringVal in objOfOtherNamespaceClass.CollectionOfInnerObj.Value) Console.WriteLine(stringVal.StringInInnerClass); stream.Close(); } //----------------------------------------------------- }",Not able to deserialize Lazy object
Git stash on wnidows extremly slow compared to Libgit2," Recently I've been using git stash many times and I've been thinking that it is really slow, even on a new repository with a single file. I've read this question about git stash slowness and this other one and tried every answer to these questions but nothing actually works. For example I've done the following steps to reproduce it:git inittouch file.txtvim file.txt (edit the file adding 2 lines)git add .git commit -m ""Initial commit""vim file.txt (edit it again adding 1 line)time git stashOutput: 8 seconds for stashing a single line is so much time. Now a test using libgit2sharp: This code takes 74ms to stash the same change.If Libgit2 is that fast then it should be possible to speed up git stash command. How can I achieve this? Actually using windows 10 64bit and git 2.11 64bits. Other git commands (like status, add, commit, etc.) work fine.UPDATE: I've updated to git 2.13 and now it's 14,53s for git stash...UPDATE 2: I've updated to git 2.15 and trying the same test time git stash returns real 0m6,553s. Still really slow... <code>  $ time git stashSaved working directory and index state WIP on master: b9454ed Initial commitHEAD is now at b9454ed Initial commit real 0m8.042suser 0m0.000ssys 0m0.046s static void Main(string[] args){ Repository repo=new Repository(@""C:\Users\UserTest\TestGitRepo""); repo.Stashes.Add(new Signature(""test"", ""test@test.com"", new DateTimeOffset(DateTime.Now)), ""Stash on master"");}",Git stash on windows extremly slow compared to Libgit2
An error occurred trying to install required android components on Project, I have created a new Xamarin portable project in VS 2015 and I'm always getting that error An error occurred trying to install required android components on Project 'FirstApp.Android'. Project 'FirstApp.Android' requires the following components installed on your machine: Xamarin.Android.Support.Design JavaLibraryReference: https://dl-ssl.google.com/android/repository/android_m2repository_r29.zip-m2repository/com/android/support/design/23.3.0/design-23.3.0.aar-23.3.0.0 AndroidResources: https://dl-ssl.google.com/android/repository/android_m2repository_r29.zip-m2repository/com/android/support/design/23.3.0/design-23.3.0.aar-23.3.0.0 Xamarin.Android.Support.v4 JavaLibraryReference: https://dl-ssl.google.com/android/repository/android_m2repository_r29.zip-m2repository/com/android/support/support-v4/23.3.0/support-v4-23.3.0.aar-23.3.0.0 JavaLibraryReference: https://dl-ssl.google.com/android/repository/android_m2repository_r29.zip-m2repository/com/android/support/support-v4/23.3.0/support-v4-23.3.0.aar-23.3.0.0 AndroidResources: https://dl-ssl.google.com/android/repository/android_m2repository_r29.zip-m2repository/com/android/support/support-v4/23.3.0/support-v4-23.3.0.aar-23.3.0.0 Xamarin.Android.Support.Vector.Drawable JavaLibraryReference: https://dl-ssl.google.com/android/repository/android_m2repository_r29.zip-m2repository/com/android/support/support-vector-drawable/23.3.0/support-vector-drawable-23.3.0.aar-23.3.0.0 AndroidResources: https://dl-ssl.google.com/android/repository/android_m2repository_r29.zip-m2repository/com/android/support/support-vector-drawable/23.3.0/support-vector-drawable-23.3.0.aar-23.3.0.0 Xamarin.Android.Support.Animated.Vector.Drawable JavaLibraryReference: https://dl-ssl.google.com/android/repository/android_m2repository_r29.zip-m2repository/com/android/support/animated-vector-drawable/23.3.0/animated-vector-drawable-23.3.0.aar-23.3.0.0 AndroidResources: https://dl-ssl.google.com/android/repository/android_m2repository_r29.zip-m2repository/com/android/support/animated-vector-drawable/23.3.0/animated-vector-drawable-23.3.0.aar-23.3.0.0 Xamarin.Android.Support.v7.AppCompat JavaLibraryReference: https://dl-ssl.google.com/android/repository/android_m2repository_r29.zip-m2repository/com/android/support/appcompat-v7/23.3.0/appcompat-v7-23.3.0.aar-23.3.0.0 AndroidResources: https://dl-ssl.google.com/android/repository/android_m2repository_r29.zip-m2repository/com/android/support/appcompat-v7/23.3.0/appcompat-v7-23.3.0.aar-23.3.0.0 Xamarin.Android.Support.v7.MediaRouter JavaLibraryReference: https://dl-ssl.google.com/android/repository/android_m2repository_r29.zip-m2repository/com/android/support/mediarouter-v7/23.3.0/mediarouter-v7-23.3.0.aar-23.3.0.0 JavaLibraryReference: https://dl-ssl.google.com/android/repository/android_m2repository_r29.zip-m2repository/com/android/support/mediarouter-v7/23.3.0/mediarouter-v7-23.3.0.aar-23.3.0.0 AndroidResources: https://dl-ssl.google.com/android/repository/android_m2repository_r29.zip-m2repository/com/android/support/mediarouter-v7/23.3.0/mediarouter-v7-23.3.0.aar-23.3.0.0 Please double-click here to install it. Intallation Errors: XA5207 Please install package: 'Xamarin.Android.Support.Design' available in SDK installer. Java library file 'C:\Users\Kareem\AppData\Local\Xamarin\Xamarin.Android.Support.Design\23.3.0.0\content\classes.jar' doesn't exist. XA5207 Please install package: 'Xamarin.Android.Support.v4' available in SDK installer. Java library file 'C:\Users\Kareem\AppData\Local\Xamarin\Xamarin.Android.Support.v4\23.3.0.0\content\classes.jar' doesn't exist. XA5207 Please install package: 'Xamarin.Android.Support.v4' available in SDK installer. Java library file 'C:\Users\Kareem\AppData\Local\Xamarin\Xamarin.Android.Support.v4\23.3.0.0\content\libs/internal_impl-23.3.0.jar' doesn't exist. XA5207 Please install package: 'Xamarin.Android.Support.Vector.Drawable' available in SDK installer. Java library file 'C:\Users\Kareem\AppData\Local\Xamarin\Xamarin.Android.Support.Vector.Drawable\23.3.0.0\content\classes.jar' doesn't exist. XA5207 Please install package: 'Xamarin.Android.Support.Animated.Vector.Drawable' available in SDK installer. Java library file 'C:\Users\Kareem\AppData\Local\Xamarin\Xamarin.Android.Support.Animated.Vector.Drawable\23.3.0.0\content\classes.jar' doesn't exist. XA5207 Please install package: 'Xamarin.Android.Support.v7.AppCompat' available in SDK installer. Java library file 'C:\Users\Kareem\AppData\Local\Xamarin\Xamarin.Android.Support.v7.AppCompat\23.3.0.0\content\classes.jar' doesn't exist. XA5207 Please install package: 'Xamarin.Android.Support.v7.MediaRouter' available in SDK installer. Java library file 'C:\Users\Kareem\AppData\Local\Xamarin\Xamarin.Android.Support.v7.MediaRouter\23.3.0.0\content\classes.jar' doesn't exist. XA5207 Please install package: 'Xamarin.Android.Support.v7.MediaRouter' available in SDK installer. Java library file 'C:\Users\Kareem\AppData\Local\Xamarin\Xamarin.Android.Support.v7.MediaRouter\23.3.0.0\content\libs/internal_impl-23.3.0.jar' doesn't exist. 0What I have tried Reinstalling Xamarin.Android.Support.DesignIt started showing me a similar error for theXamarin.Android.Support.v7.MediaRouter package When I tried to reinstall theXamarin.Android.Support.v7.MediaRouter it started showing theerror message for the Xamarin.Android.Support.Design packageagainDownloading the missing filesDownloaded the zip file at https://dl-ssl.google.com/android/repository/android_m2repository_r29.zipExtracted the content of the design folder and copied it to C:\Users\Kareem\AppData\Local\Xamarin\Xamarin.Android.Support.Design\23.0.0\content\nothing worked and I'm now stuck and couldn't think of anything else to try <code> ,Xamarin - An error occurred trying to install required android components on Project
Minimal Footprint ASP.NET Core WebAPI," Just for fun, earlier today one of my colleagues asked if I could try and make a tiny-footprint WebAPI that echoed requests using ASP.NET Core. I was able to get the WebAPI done in about 70 lines of code. All thanks to ASP.NET Core being amazing! So, this is what I ended up with so far.The Code (The code above works as expected, and it's not broken.)The WebAPIThe WebAPI is supposed to echo back the request with a JSON.Example Request Example Response My ProblemI blew my colleague away with just the 70+ lines of code to do the job, but then when we took a look at the file size it wasn't as impressive... At the moment with all these dependencies, my WebAPI is compiling to 54.3MB.I am stuck with trying to figure out how to reduce the disk footprint of this project. The packages I have installed are bundled up with so much stuff we don't really need and I keep running into trouble trying to find out the best resource or method to removing the unneeded references for this project.The .csproj Is there any quick way for me to know what references my project needs based on the code provided? I started earlier by wiping clear all the above dependencies and then trying to add them one by one, but it turns out to become a never ending headache of trying to solve missing references and it seems to take forever to solve. I'm sure someone out there has a solution for something like this, but I can't seem to find it. Thanks. <code>  using Microsoft.AspNetCore.Builder;using Microsoft.AspNetCore.Hosting;using Microsoft.AspNetCore.Http;using Microsoft.Extensions.Configuration;using Microsoft.Extensions.DependencyInjection;using Newtonsoft.Json;using System;using System.Linq;namespace TinyWebApi{ class Program { static readonly IWebHost _host; static readonly string[] _urls = { ""http://localhost:80"" }; static Program() { IConfiguration _configuration = new ConfigurationBuilder() .AddJsonFile(""appsettings.json"", optional: true, reloadOnChange: true) .Build(); _host = BuildHost(new WebHostBuilder(), _configuration, _urls); } static void Main(string[] args) { _host.Run(); } static IWebHost BuildHost( IWebHostBuilder builder, IConfiguration configuration, params string[] urls) { return builder .UseKestrel(options => { options.NoDelay = true; }) .UseConfiguration(configuration) .UseUrls(urls) .Configure(app => { app.Map(""/echo"", EchoHandler); }) .Build(); } static void EchoHandler(IApplicationBuilder app) { app.Run(async context => { await context.Response.WriteAsync( JsonConvert.SerializeObject(new { StatusCode = (string)context.Response.StatusCode.ToString(), PathBase = (string)context.Request.PathBase.Value.Trim('/'), Path = (string)context.Request.Path.Value.Trim('/'), Method = (string)context.Request.Method, Scheme = (string)context.Request.Scheme, ContentType = (string)context.Request.ContentType, ContentLength = (long?)context.Request.ContentLength, QueryString = (string)context.Request.QueryString.ToString(), Query = context.Request.Query .ToDictionary( _ => _.Key, _ => _.Value, StringComparer.OrdinalIgnoreCase) }) ); }); } }} http://localhost/echo?q=foo&q=bar { ""StatusCode"": ""200"", ""PathBase"": ""echo"", ""Path"": """", ""Method"": ""GET"", ""Scheme"": ""http"", ""ContentType"": null, ""ContentLength"": null, ""QueryString"": ""?q=foo&q=bar"", ""Query"": { ""q"": [ ""foo"", ""bar"" ] }} <Project Sdk=""Microsoft.NET.Sdk""> <PropertyGroup> <OutputType>Exe</OutputType> <TargetFramework>netcoreapp1.1</TargetFramework> <RuntimeIdentifier>win7-x64</RuntimeIdentifier> <ApplicationIcon>Icon.ico</ApplicationIcon> </PropertyGroup> <ItemGroup> <PackageReference Include=""Microsoft.AspNetCore"" Version=""1.1.2"" /> <PackageReference Include=""Microsoft.AspNetCore.Hosting.Abstractions"" Version=""1.1.2"" /> <PackageReference Include=""Microsoft.AspNetCore.Mvc.Core"" Version=""1.1.3"" /> <PackageReference Include=""Microsoft.AspNetCore.Server.Kestrel"" Version=""1.1.2"" /> <PackageReference Include=""Microsoft.Extensions.Configuration.FileExtensions"" Version=""1.1.2"" /> <PackageReference Include=""Microsoft.Extensions.Configuration.Json"" Version=""1.1.2"" /> <PackageReference Include=""Microsoft.Extensions.Logging.Console"" Version=""1.1.2"" /> <PackageReference Include=""Newtonsoft.Json"" Version=""10.0.2"" /> </ItemGroup></Project>",Minimal Footprint / Bare-bones ASP.NET Core WebAPI
CosmosDB GeoSpatial index performance," I wrote my latest update, and then got the following error from Stack Overflow: ""Body is limited to 30000 characters; you entered 38676.""It's fair to say I have been very verbose in documenting my adventures, so I've rewritten what I have here to be more concise.I have stored my (long) original post and updates on pastebin. I don't think many people will read them, but I put a lot of effort in to them so it'd be nice not to have them lost.I have a collection which contains 100,000 documents for learning how to use CosmosDB and for things like performance testing.Each of these documents has a Location property which is a GeoJSON Point.According to the documentation, a GeoJSON point should be automatically indexed. Azure Cosmos DB supports automatic indexing of Points, Polygons, and LineStringsI've checked the Indexing Policy for my collection, and it has the entry for automatic point indexing: I've been looking for a way to list, or otherwise interrogate the indexes that have been created, but I haven't found such a thing yet, so I haven't been able to confirm that this property definitely is being indexed.I created a GeoJSON Polygon, and then used that to query my documents.This is my query: And I then pass that query object to the following method so I can get the results while tracking the Request Units used: The point locations are randomly chosen from 10s of millions of UK addresses, so they should have a fairly realistic spread.The polygon is made up of 16 points (with the first and last point being the same), so it's not very complex. It covers most of the most southern part of the UK, from London down.An example run of this query returned 8728 documents, using 3917.92 RU, in 170717.151 ms, which is just under 171 seconds, or just under 3 minutes.3918 RU / 171 s = 22.91 RU/sI currently have the Throughput (RU/s) set to the lowest value, at 400 RU/s.It was my understanding that this is the reserved level you are guaranteed to get. You can ""burst"" above that level at times, but do that too frequently and you'll be throttled back to your reserved level.The ""query speed"" of 23 RU/s is, obviously, much much lower than the Throughput setting of 400 RU/s.I am running the client ""locally"" i.e. in my office, and not up in the Azure data center.Each document is roughly 500 bytes (0.5 kb) in size.So what's happening?Am I doing something wrong?Am I misunderstanding how my query is being throttled with regard to RU/s?Is this the speed at which the GeoSpatial indexes operate, and so the best performance I'll get?Is the GeoSpatial index not being used?Is there a way I can view the created indexes?Is there a way I can check if the index is being used?Is there a way I can profile the query and get metrics about where time is being spent? e.g. s was used looking up documents by their type, s was used filtering them GeoSpatially, and s was used transferring the data.UPDATE 1Here's the polygon I'm using in the query: I have also tried reversing it (since ring orientation matters), but the query with the reversed polygon took significantly longer (I don't have the time to hand) and returned 91272 items.Also, the coordinates are specified as Longitude/Latitude, as this is how GeoJSON expects them (i.e. as X/Y), rather than the traditional order used when speaking of Latitude/Longitude. The GeoJSON specification specifies longitude first and latitude second.UPDATE 2Here's the JSON for one of my documents: UPDATE 3I created a minimal reproduction of the issue, and I found the issue no longer occured.This indicated that the problem was indeed in my own code.I set out to check all the differences between the original and the reproduction code and eventually found that something that appeared to be fairly innocent to me was infact having a big impact. And thankfully, that code wasn't needed at all, so it was an easy fix to simply not use that bit of code.At one point I was using a custom ContractResolver and I hadn't removed it once it was no longer needed.Here's the offending reproduction code: <code>  { ""automatic"":true, ""indexingMode"":""Consistent"", ""includedPaths"":[ { ""path"":""/*"", ""indexes"":[ ... { ""kind"":""Spatial"", ""dataType"":""Point"" }, ... ] } ], ""excludedPaths"":[ ]} var query = client .CreateDocumentQuery<TestDocument>(documentCollectionUri) .Where(document => document.Type == this.documentType && document.Location.Intersects(target.Area)); protected async Task<IEnumerable<T>> QueryTrackingUsedRUsAsync(IQueryable<T> query){ var documentQuery = query.AsDocumentQuery(); var documents = new List<T>(); while (documentQuery.HasMoreResults) { var response = await documentQuery.ExecuteNextAsync<T>(); this.AddUsedRUs(response.RequestCharge); documents.AddRange(response); } return documents;} Area = new Polygon(new List<LinearRing>(){ new LinearRing(new List<Position>() { new Position(1.8567 ,51.3814), new Position(0.5329 ,51.4618), new Position(0.2477 ,51.2588), new Position(-0.5329 ,51.2579), new Position(-1.17 ,51.2173), new Position(-1.9062 ,51.1958), new Position(-2.5434 ,51.1614), new Position(-3.8672 ,51.139 ), new Position(-4.1578 ,50.9137), new Position(-4.5373 ,50.694 ), new Position(-5.1496 ,50.3282), new Position(-5.2212 ,49.9586), new Position(-3.7049 ,50.142 ), new Position(-2.1698 ,50.314 ), new Position(0.4669 ,50.6976), new Position(1.8567 ,51.3814) })}) { ""GeoTrigger"": null, ""SeverityTrigger"": -1, ""TypeTrigger"": -1, ""Name"": ""13, LONSDALE SQUARE, LONDON, N1 1EN"", ""IsEnabled"": true, ""Type"": 2, ""Location"": { ""$type"": ""Microsoft.Azure.Documents.Spatial.Point, Microsoft.Azure.Documents.Client"", ""type"": ""Point"", ""coordinates"": [ -0.1076407397346815, 51.53970315059827 ] }, ""id"": ""0dc2c03e-082b-4aea-93a8-79d89546c12b"", ""_rid"": ""EQttAMGhSQDWPwAAAAAAAA=="", ""_self"": ""dbs/EQttAA==/colls/EQttAMGhSQA=/docs/EQttAMGhSQDWPwAAAAAAAA==/"", ""_etag"": ""\""42001028-0000-0000-0000-594943fe0000\"""", ""_attachments"": ""attachments/"", ""_ts"": 1497973747} using System;using System.Collections.Generic;using System.Configuration;using System.Diagnostics;using System.Linq;using System.Runtime.CompilerServices;using System.Threading;using System.Threading.Tasks;using Microsoft.Azure.Documents;using Microsoft.Azure.Documents.Client;using Microsoft.Azure.Documents.Spatial;using Newtonsoft.Json;using Newtonsoft.Json.Serialization;namespace Repro.Cli{ public class Program { static void Main(string[] args) { JsonConvert.DefaultSettings = () => { return new JsonSerializerSettings { ContractResolver = new PropertyNameMapContractResolver(new Dictionary<string, string>() { { ""ID"", ""id"" } }) }; }; //AJ: Init logging Trace.AutoFlush = true; Trace.Listeners.Add(new ConsoleTraceListener()); Trace.Listeners.Add(new TextWriterTraceListener(""trace.log"")); //AJ: Increase availible threads //AJ: https://docs.microsoft.com/en-us/azure/storage/storage-performance-checklist#subheading10 //AJ: https://github.com/Azure/azure-documentdb-dotnet/blob/master/samples/documentdb-benchmark/Program.cs var minThreadPoolSize = 100; ThreadPool.SetMinThreads(minThreadPoolSize, minThreadPoolSize); //AJ: https://docs.microsoft.com/en-us/azure/cosmos-db/performance-tips //AJ: gcServer enabled in app.config //AJ: Prefer 32-bit disabled in project properties //AJ: DO IT var program = new Program(); Trace.TraceInformation($""Starting @ {DateTime.UtcNow}""); program.RunAsync().Wait(); Trace.TraceInformation($""Finished @ {DateTime.UtcNow}""); //AJ: Wait for user to exit Console.WriteLine(); Console.WriteLine(""Hit enter to exit...""); Console.ReadLine(); } public async Task RunAsync() { using (new CodeTimer()) { var client = await this.GetDocumentClientAsync(); var documentCollectionUri = UriFactory.CreateDocumentCollectionUri(ConfigurationManager.AppSettings[""databaseID""], ConfigurationManager.AppSettings[""collectionID""]); //AJ: Prepare Test Documents var documentCount = 10000; //AJ: 10,000 var documentsForUpsert = this.GetDocuments(documentCount); await this.UpsertDocumentsAsync(client, documentCollectionUri, documentsForUpsert); var allDocuments = this.GetAllDocuments(client, documentCollectionUri); var area = this.GetArea(); var documentsInArea = this.GetDocumentsInArea(client, documentCollectionUri, area); } } private async Task<DocumentClient> GetDocumentClientAsync() { using (new CodeTimer()) { var serviceEndpointUri = new Uri(ConfigurationManager.AppSettings[""serviceEndpoint""]); var authKey = ConfigurationManager.AppSettings[""authKey""]; var connectionPolicy = new ConnectionPolicy { ConnectionMode = ConnectionMode.Direct, ConnectionProtocol = Protocol.Tcp, RequestTimeout = new TimeSpan(1, 0, 0), RetryOptions = new RetryOptions { MaxRetryAttemptsOnThrottledRequests = 10, MaxRetryWaitTimeInSeconds = 60 } }; var client = new DocumentClient(serviceEndpointUri, authKey, connectionPolicy); await client.OpenAsync(); return client; } } private List<TestDocument> GetDocuments(int count) { using (new CodeTimer()) { return External.CreateDocuments(count); } } private async Task UpsertDocumentsAsync(DocumentClient client, Uri documentCollectionUri, List<TestDocument> documents) { using (new CodeTimer()) { //TODO: AJ: Parallelise foreach (var document in documents) { await client.UpsertDocumentAsync(documentCollectionUri, document); } } } private List<TestDocument> GetAllDocuments(DocumentClient client, Uri documentCollectionUri) { using (new CodeTimer()) { var query = client .CreateDocumentQuery<TestDocument>(documentCollectionUri, new FeedOptions() { MaxItemCount = 1000 }); var documents = query.ToList(); return documents; } } private Polygon GetArea() { //AJ: Longitude,Latitude i.e. X/Y //AJ: Ring orientation matters return new Polygon(new List<LinearRing>() { new LinearRing(new List<Position>() { new Position(1.8567 ,51.3814), new Position(0.5329 ,51.4618), new Position(0.2477 ,51.2588), new Position(-0.5329 ,51.2579), new Position(-1.17 ,51.2173), new Position(-1.9062 ,51.1958), new Position(-2.5434 ,51.1614), new Position(-3.8672 ,51.139 ), new Position(-4.1578 ,50.9137), new Position(-4.5373 ,50.694 ), new Position(-5.1496 ,50.3282), new Position(-5.2212 ,49.9586), new Position(-3.7049 ,50.142 ), new Position(-2.1698 ,50.314 ), new Position(0.4669 ,50.6976), //AJ: Last point must be the same as first point new Position(1.8567 ,51.3814) }) }); } private List<TestDocument> GetDocumentsInArea(DocumentClient client, Uri documentCollectionUri, Polygon area) { using (new CodeTimer()) { var query = client .CreateDocumentQuery<TestDocument>(documentCollectionUri, new FeedOptions() { MaxItemCount = 1000 }) .Where(document => document.Location.Intersects(area)); var documents = query.ToList(); return documents; } } } public class TestDocument : Resource { public string Name { get; set; } public Point Location { get; set; } //AJ: Longitude,Latitude i.e. X/Y public TestDocument() { this.Id = Guid.NewGuid().ToString(""N""); } } //AJ: This should be ""good enough"". The times being recorded are seconds or minutes. public class CodeTimer : IDisposable { private Action<TimeSpan> reportFunction; private Stopwatch stopwatch = new Stopwatch(); public CodeTimer([CallerMemberName]string name = """") : this((ellapsed) => { Trace.TraceInformation($""{name} took {ellapsed}, or {ellapsed.TotalMilliseconds} ms.""); }) { } public CodeTimer(Action<TimeSpan> report) { this.reportFunction = report; this.stopwatch.Start(); } public void Dispose() { this.stopwatch.Stop(); this.reportFunction(this.stopwatch.Elapsed); } } public class PropertyNameMapContractResolver : DefaultContractResolver { private Dictionary<string, string> propertyNameMap; public PropertyNameMapContractResolver(Dictionary<string, string> propertyNameMap) { this.propertyNameMap = propertyNameMap; } protected override string ResolvePropertyName(string propertyName) { if (this.propertyNameMap.TryGetValue(propertyName, out string resolvedName)) return resolvedName; return base.ResolvePropertyName(propertyName); } }}",CosmosDB Query Performance
How fast deleted many files use C#," I have a folder in Windows Server with subfolders and 50000 files. When I click the right mouse button and choose delete (or shift+delete) all files are deleted in 10-20 seconds.When I delete files using code 1500-4000 seconds.Delete large number of files don't work for me.My code: How to delete files faster? <code>  string folderPath = @""C://myFolder"";DirectoryInfo folderInfo = new DirectoryInfo(folderPath);folderInfo.Delete(true); // true - recursive, with sub-folders",How to fast delete many files
asp:repeater collapsing table rows," I'm wondering if someone has a creative solution to my problem. I have a repeater that is populated from my database and it is as follows: and it produces a table that looks like thisWhat I've circled are rows with repeating Change Id's that I'd like to default to collapsed but can be clicked to be expanded (as well as clicked again to be collapsed again).I've begun to implement Jon P's solution below, and I'm almost done! Just the Jquery onclick event.Below is my codebehind PreRender method. Update again: The only thing I have left to fix is the jquery, which expands and collapses the hidden/opened rows on the toggler lines. Below is the jquery and css as per Jon P's help. Can someone help me out in this final stretch? I feel like I'm close. <code>  <asp:Repeater ID=""ResultsTableRepeater"" runat=""server"" OnPreRender=""ResultsTableRepeater_PreRender""> <HeaderTemplate> <table class=""td-table-bordered"" style=""font-size: small; width: 90%""> <tr> <th>Change #</th> <th>Change Title</th> <th>Change Description</th> <th>Clarity Id</th> <th>Package Description</th> <th>Package Name</th> <th>Package Status</th> <th>Assigned To</th> <th>New Package</th> </tr> </HeaderTemplate> <ItemTemplate> <asp:Literal runat=""server"" Text='<%# Eval(""ChangeId"") %>' ID=""IdTag"" Visible=""false""></asp:Label> <tr id=""tableRow"" class="""" data-changeId='<%# Eval(""ChangeId"") %>' runat=""server"" style='<%#(Eval(""AssignedTo"").ToString() == ""7"" || Eval(""AssignedTo"").ToString() == ""8"")? """": ""font-weight:bold; background-color:cornsilk"" %>'> <td><%# Eval(""ChangeId"") %></td> <td><%# Eval(""ChangeTitle"") %></td> <td><%# Eval(""ChangeDescription"") %></td> <td><%# Eval(""ClarityId"") %></td> <td><%# (Eval(""PackageId"").ToString() == string.Empty) ? """" : ""<a href=http://dev.rlaninfrastructure.tdbank.ca/RCIViewForm?ChangeId="" + Eval(""ChangeId"") + ""&PackageId="" + Eval(""PackageId"") + "" runat='server' id='RCILink'>"" %> <asp:Label ID=""ExistingPackageLabel"" runat=""server"" Text='<%# (Eval(""PackageId"").ToString() == string.Empty) ? ""No packages"" : Eval(""PackageDescription"").ToString() %>'> </asp:Label><%# (Eval(""PackageId"").ToString() == string.Empty) ? """" : ""</a>"" %> </td> <td><%# Eval(""PackageName"") %></td> <td> <asp:Label ID=""LabRequestedLabel"" runat=""server"" Text='<%# (Eval(""PackageStatus"").ToString() == ""1"") ? ""Requested"" : (Eval(""PackageStatus"").ToString() == ""2"") ? ""Built"" : (Eval(""PackageStatus"").ToString() == ""3"") ? ""NFT"" : (Eval(""PackageStatus"").ToString() == ""4"") ? ""Pilot"" : (Eval(""PackageStatus"").ToString() == ""5"") ? ""Production"" : (Eval(""PackageStatus"").ToString() == ""6"") ? ""Completed"" : (Eval(""PackageStatus"").ToString() == ""7"") ? ""Cancelled"" : (Eval(""PackageStatus"").ToString() == ""8"") ? ""Pending"" : """" %>'></asp:Label> </td> <td><%# (Eval(""EmployeeName"").ToString() == string.Empty) ? """" : Eval(""EmployeeName"")%></td> <td><%# ""<a href=http://dev.rlaninfrastructure.tdbank.ca/RCIViewForm?ChangeId="" + Eval(""ChangeId"") + "" runat='server' id='RCILink'>""%> <asp:Label ID=""NewPackageLabel"" runat=""server"" Text=""Create New""> </asp:Label><%#""</a>"" %></td> </tr> </ItemTemplate> <FooterTemplate> </table> </FooterTemplate> </asp:Repeater> protected void ResultsTableRepeater_PreRender(object sender, EventArgs e) { int previousId = 0; int currentId = 0; int nextId = 0; for (int item = 0; item < ResultsTableRepeater.Items.Count; item++) { Literal idTag = (Literal)ResultsTableRepeater.Items[item].FindControl(""IdTag""); Literal classTag = (Literal)ResultsTableRepeater.Items[item].FindControl(""ClassTag""); HtmlTableRow tableRow = (HtmlTableRow)ResultsTableRepeater.Items[item].FindControl(""tableRow""); if (item != ResultsTableRepeater.Items.Count - 1) int.TryParse(((Literal)ResultsTableRepeater.Items[item + 1].FindControl(""IdTag"")).Text.ToString(), out nextId); if (int.TryParse(idTag.Text, out currentId)) { if (currentId == previousId) { tableRow.Attributes[""class""] = ""hidden""; } else if (currentId != previousId && currentId == nextId) { tableRow.Attributes[""class""] = ""toggler""; } } else nextId = 0; int.TryParse(idTag.Text, out previousId); } } $("".toggler"").click(function(){ var idClicked = $(this).data(""changeid""); //Toggle hidden on the sibling rows with the same data id $(this).nextAll(""[data-changeId='"" + idClicked +""']"").toggleClass(""hidden""); //Toggle opened status on clicked row $(this).toggleClass(""opened"");});.hidden{display:none;}.toggler td:first-child::after{content:"" +"";}.toggler.opened td:first-child::after{content:"" -"";}",asp:repeater collapsing table rows - Updated
IdentityServer4 - how to include email in user's claim?, I am using IdentityServer4.I want to add other custom claims to access token but I'm unable to do this. I have modified Quickstart5 and added ASP.NET Identity Core and the custom claims via ProfileService as suggested by Coemgen below.You can download my code here: [zip package][3]. (It is based on: Quickstart5 with ASP.NET Identity Core and added claims via ProfileService).Issue: GetProfileDataAsync does not executed. <code> ,How to add custom claims to access token in IdentityServer4?
IdentityServer4 - how to add custom claims to access token?, I am using IdentityServer4.I want to add other custom claims to access token but I'm unable to do this. I have modified Quickstart5 and added ASP.NET Identity Core and the custom claims via ProfileService as suggested by Coemgen below.You can download my code here: [zip package][3]. (It is based on: Quickstart5 with ASP.NET Identity Core and added claims via ProfileService).Issue: GetProfileDataAsync does not executed. <code> ,How to add custom claims to access token in IdentityServer4?
asp.net core HttpContextBase namespace could not be Found, Any help on the work around with HttpContextBase in asp.net core? above is my sample code am working on to create a shopping cart. <code>  public string GetCartId(HttpContextBase context){ if (context.Session[CartSessionKey] == null) { if (!string.IsNullOrWhiteSpace(context.User.Identity.Name)) { context.Session[CartSessionKey] = context.User.Identity.Name; } else { // Generate a new random GUID using System.Guid class Guid tempCartId = Guid.NewGuid(); // Send tempCartId back to client as a cookie context.Session[CartSessionKey] = tempCartId.ToString(); } } return context.Session[CartSessionKey].ToString();} ,HttpContextBase namespace could not be found
HttpContextBase namespace could not be Found, Any help on the work around with HttpContextBase in asp.net core? above is my sample code am working on to create a shopping cart. <code>  public string GetCartId(HttpContextBase context){ if (context.Session[CartSessionKey] == null) { if (!string.IsNullOrWhiteSpace(context.User.Identity.Name)) { context.Session[CartSessionKey] = context.User.Identity.Name; } else { // Generate a new random GUID using System.Guid class Guid tempCartId = Guid.NewGuid(); // Send tempCartId back to client as a cookie context.Session[CartSessionKey] = tempCartId.ToString(); } } return context.Session[CartSessionKey].ToString();} ,HttpContextBase namespace could not be found
c# - simplest way to achieve O(n) performance when creating the union of 3 IEnumerables," Say a, b, c are all List<t> and I want to create an unsorted union of them. Although performance isn't super-critical, they might have 10,000 entries in each so I'm keen to avoid O(n^2) solutions.AFAICT the MSDN documentation doesn't say anything about the performance characteristics of union as far as the different types are concerned.My gut instinct says that if I just do a.Union(b).Union(c), this will take O(n^2) time, but new Hashset<t>(a).Union(b).Union(c) would be O(n).Does anyone have any documentation or metrics to confirm or deny this assumption? <code> ",What is the simplest way to achieve O(n) performance when creating the union of 3 IEnumerables?
c# stringbuilder and string equality check," I am trying this sample of code and OpTest when System.Console.WriteLine(s == t); it returns false. Can somebody explain this? <code>  public static void OpTest<T>(T s, T t) where T : class { System.Console.WriteLine(s == t);}static void Main() { string s1 = """"; System.Text.StringBuilder sb = new System.Text.StringBuilder(s1); System.Console.Write(sb); string s2 = sb.ToString(); OpTest<string>(s1, s2);}",StringBuilder and string equality check
Unable to cast object of type generic type to generic interface C#," I have two interfaces: And classes derived from this: Also I have two interfaces with restrictions: And one abstract class derived from this interface: After this I created two classes derived from this abstract class: RuleB : RuleA : Rule< DmModel,Middle,DbModel > : IRule< IDmModel,IDbModel > : IRuleAnd when I try to cast object of RuleB to IRule<IDmModel, IDbModel> occours unhandled exception Unable to cast object of type 'ParsreCombinators.RuleB' to type 'ParsreCombinators.IRule`2[ParsreCombinators.IDmModel,ParsreCombinators.IDbModel]'. What wrong with thisTo make the example less confusing I simplify it:EDIT:After the answers I understood, what is the problem and to make the example less confusing I simplify it: <code>  public interface IDbModel {}public interface IDmModel {} public class DbModel : IDbModel {}public class DmModel : IDmModel {}public class Middle { } public interface IRule { }public interface IRule<in TInput, out TOutput> : IRule where TInput : IDmModel where TOutput : IDbModel{ TOutput Apply(TInput elem);} public abstract class Rule<TDmModel, TMiddle, TDb> : IRule<TDmModel, TDb> where TDmModel : IDmModel where TDb : IDbModel{ private readonly Func<TDmModel, TMiddle> _rule; protected Rule(Func<TDmModel, TMiddle> rule) { _rule = rule; } protected abstract TDb Apply(TMiddle transformedMessage); public TDb Apply(TDmModel elem) { ... }} public class RuleA : Rule<DmModel, Middle, DbModel>{ public RuleA(Func<DmModel, Middle> rule) : base(rule) {} protected override DbMode Apply(Middle transformedMessage) { ... }}public class RuleB : RuleA{ public RuleB() : base((dm) => new Middle()) {}} var ruleB = (IRule<IDmModel, IDbModel>)new RuleB(); // Exception IDbModel dbModel = ruleB.Apply(new DmModel()); public interface IDbModel {}public interface IDmModel {}public class DbModel : IDbModel {}public class DmModel : IDmModel {}public interface IRule<in TInput, out TOutput> where TInput : IDmModel where TOutput : IDbModel{ TOutput Apply(TInput elem);}public class RuleA : IRule<DmModel, DbModel>{ public DbModel Apply(DmModel elem) { ... }}var ruleA = (IRule<IDmModel, IDbModel>)new RuleA(); // Exception",Unable to cast object of generic type to generic interface C#
Asp.Net TextBoxFor decimal," In my database I stored fields with the data type decimal. I am using exactly the same (decimal) data type in my ASP.NET application.This is inside my view in order to display the value. This pretty straight forward. The only issue I am facing is that by default in my view the data is displayed with 4 decimal places.I give you a few examples on how it looks and how it should look: 1,0000 => 1 1,2000 => 1,2 1,4300 => 1,43 1,8920 => 1,892 1,5426 => 1,5426 As you can see I want to cut off all the 0 as decimal places (only when displayed in the view).Remember: I am using commas instead of decimal points.Edit:My model <code>  @Html.TextBoxFor(model => model.Stock, new { id = ""Stock"", @class = ""k-textbox"" }) public class Article{ public decimal? Stock{ get; set; }}",TextBoxFor decimal
windows+mysql 5.7.18+.net core 1.1. +dapper, I use MySql.Data 8.08 and .NET Core to connect to MySql 5.7.18 but following exception is being thrown:MySql.Data.MySqlClient.MySqlException:The host localhost does not support SSL connections.How to deal with it? <code> ,MySql.Data.MySqlClient.MySqlException: The host localhost does not support SSL connections.
"In .Net, is there a way to reconstruct a tuple to a compatible class?"," Given a tuple (int, string) v and a class C { int, string }, in C#7, implementing C's Deconstruct(out int k, out string v) would allow the ff.: But the reverse seems unsupported, such that the tuple can be ""reconstructed"" to a compatible class: I'm thinking it should be supported if C has a constructor that ""matches"" C's Deconstruct() parameters: Is it possible? Available? Planned? I can't seem to find anything about it. Or perhaps a re-usable code/trick to ""Reconstruct""? <code>  C c = new C();(int k, string v) = c; (int k, string v) vt = (1, ""one"");C c = vt; class C{ public C(int k, string v) ...}",Is there a way to reconstruct a tuple to a compatible class?
select all check boxes WPF," I want to make all check boxes selected by selecting check box names with ""All of Above"".the checkboxes are in a List box back Code Can someone suggest a method? <code>  <ListBox SelectionMode=""Multiple"" BorderThickness=""0"" ItemsSource=""{Binding QuestionThreeSelection}"" SelectedItem=""{Binding QuestionThreeSelection}"" Name=""listBoxList"" SelectionChanged=""listBoxList_SelectionChanged""> <ListBox.InputBindings> <KeyBinding Command=""ApplicationCommands.SelectAll"" Modifiers=""Ctrl"" Key=""A"" /> </ListBox.InputBindings> <ListBox.ItemTemplate> <DataTemplate> <CheckBox Checked=""CheckBox_Checked_1"" Content=""{Binding SourceName}"" IsChecked=""{Binding Path=IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"" /> </DataTemplate> </ListBox.ItemTemplate></ListBox> private void CheckBox_Checked_1(object sender, RoutedEventArgs e){ var oo = listBoxList; CheckBox cb = (CheckBox)sender; //var w=e; IEnumerable<AddSource> listallityem = ((IEnumerable<AddSource>)listBoxList.Items.SourceCollection).Where(r => r.IsSelected == false); //IEnumerable<AddSource> listallityem1 = ((IEnumerable<AddSource>)listBoxList.Items.SourceCollection); AddSource vv = cb.DataContext as AddSource; if ((bool) cb.IsChecked) { } if (vv.SourceName== ""All of the above"") { r = listBoxList.ItemsSource; foreach (AddSource item in wer) { item.IsSelected = true; // false in case of unselect } }}",Select all check boxes WPF
calling C# code from python," Following is the C# code. How do I call the GenericMethod() inside the NonGenericClass from Python using pythonnet? Python code that I tried: Error that I got: <code>  namespace CSharpTestCode{ public interface Person { } public class Employee : Person { } public class TempGenericClass<T> { } public class NonGenericClass { public static T GenericMethod<T>(TempGenericClass<T> tempGeneric) where T : class, Person { return null; } }} import clrclr.AddReference(r'\Documents\visual studio 2015\Projects\SamplePythonApp\CSharpTestCode\bin\Debug\CSharpTestCode.dll')from CSharpTestCode import *genericMethod = NonGenericClass.GenericMethod(TempGenericClass[Employee]()) Unhandled Exception: System.ArgumentException: GenericArguments[0], 'CSharpTestCode.TempGenericClass`1[CSharpTestCode.Employee]', on 'T GenericMethod[T](CSharpTestCode.TempGenericClass`1[T])' violates the constraint of type 'T'. ---> System.Security.VerificationException: Method CSharpTestCode.NonGenericClass.GenericMethod: type argument 'CSharpTestCode.TempGenericClass`1[CSharpTestCode.Employee]' violates the constraint of type parameter 'T'. at System.RuntimeMethodHandle.GetStubIfNeeded(RuntimeMethodHandleInternal method, RuntimeType declaringType, RuntimeType[] methodInstantiation) at System.Reflection.RuntimeMethodInfo.MakeGenericMethod(Type[] methodInstantiation) --- End of inner exception stack trace --- at System.RuntimeType.ValidateGenericArguments(MemberInfo definition, RuntimeType[] genericArguments, Exception e) at System.Reflection.RuntimeMethodInfo.MakeGenericMethod(Type[] methodInstantiation) at Python.Runtime.MethodBinder.MatchParameters(MethodInfo[] mi, Type[] tp) at Python.Runtime.MethodBinder.Bind(IntPtr inst, IntPtr args, IntPtr kw, MethodBase info, MethodInfo[] methodinfo) at Python.Runtime.MethodBinder.Invoke(IntPtr inst, IntPtr args, IntPtr kw, MethodBase info, MethodInfo[] methodinfo) at Python.Runtime.MethodObject.Invoke(IntPtr target, IntPtr args, IntPtr kw, MethodBase info) at Python.Runtime.MethodBinding.tp_call(IntPtr ob, IntPtr args, IntPtr kw)",Calling C# code from python using pythonnet
C# - Get Description Attributes From a Flagged Enum," I am trying to create an extension method that will return a List<string> containing all the Description attributes for only the set values of a given [Flags] Enum.For example, suppose I have the following enum declared in my C# code: And then have a variable set as: So, the call I want to create would be: and the final result would be: I have created an extension method for getting the single description attribute for an Enum that can not have multiple flags set that is along the following lines: And I've found some answers online on how to get ALL the Description attributes for a given Enum type (such as here), but I'm having problems writing a generic extension method to return the list of descriptions for only the set attributes.Any help would be really appreciated.THANKS!! <code>  [Flags]public enum Result{ [Description(""Value 1 with spaces"")] Value1 = 1, [Description(""Value 2 with spaces"")] Value2 = 2, [Description(""Value 3 with spaces"")] Value3 = 4, [Description(""Value 4 with spaces"")] Value4 = 8} Result y = Result.Value1 | Result.Value2 | Result.Value4; List<string> descriptions = y.GetDescriptions(); descriptions = { ""Value 1 with spaces"", ""Value 2 with spaces"", ""Value 4 with spaces"" }; public static string GetDescription(this Enum value){ Type type = value.GetType(); string name = Enum.GetName(type, value); if (name != null) { System.Reflection.FieldInfo field = type.GetField(name); if (field != null) { DescriptionAttribute attr = Attribute.GetCustomAttribute(field, typeof(DescriptionAttribute)) as DescriptionAttribute; if (attr != null) { return attr.Description; } } } return null;}",Get Description Attributes From a Flagged Enum
"Windows UWP bluetooth app, devices showing up when scanning even if they are powered off"," I am developing a UWP app that is using bluetooth to connect to different devices.My problem is that some devices that has been paired or previously discovered is showing up in my device list even though they are turned off or not in range.As of my understanding the property System.Devices.Aep.IsPresent can be used to filter out cached devices that are not available at the time but I always get ""True"" for that property even though I know the device is not reachable.Any ideas on how this can be solved?Setup Callback for when device is addedHere isPresent is always true  <code>  string[] requestedProperties = { ""System.Devices.Aep.DeviceAddress"", ""System.Devices.Aep.IsConnected"", ""System.Devices.Aep.IsPresent"", ""System.Devices.Aep.ContainerId"", ""System.Devices.Aep.DeviceAddress"", ""System.Devices.Aep.Manufacturer"", ""System.Devices.Aep.ModelId"", ""System.Devices.Aep.ProtocolId"", ""System.Devices.Aep.SignalStrength""}; _deviceWatcher = DeviceInformation.CreateWatcher(""{REMOVED, NOT IMPORTANT}"", requestedProperties, DeviceInformationKind.AssociationEndpoint); _deviceWatcher.Added += DeviceAdded; _deviceWatcher.Updated += DeviceUpdated; _deviceWatcher.Removed += DeviceRemoved; _deviceWatcher.EnumerationCompleted += DeviceEnumerationCompleted; private void DeviceAdded(DeviceWatcher sender, DeviceInformation deviceInfo){ Device device = new Device(deviceInfo); bool isPresent = (bool)deviceInfo.Properties.Single(p => p.Key == ""System.Devices.Aep.IsPresent"").Value; Debug.WriteLine(""*** Found device "" + deviceInfo.Id + "" / "" + device.Id + "", "" + ""name: "" + deviceInfo.Name + "" ***""); Debug.WriteLine(""RSSI = "" + deviceInfo.Properties.Single(d => d.Key == ""System.Devices.Aep.SignalStrength"").Value); Debug.WriteLine(""Present: "" + isPresent); var rssi = deviceInfo.Properties.Single(d => d.Key == ""System.Devices.Aep.SignalStrength"").Value; if (rssi != null) device.Rssi = int.Parse(rssi.ToString()); if (DiscoveredDevices.All(x => x.Id != device.Id) && isPresent) { DiscoveredDevices.Add(device); DeviceDiscovered(this, new DeviceDiscoveredEventArgs(device)); }}","Windows UWP bluetooth app, devices showing up when scanning even when they are powered off"
How to handle MVC DisplayTemplates for two classes with the same name (differenct namespaces)," You can only have one View per class name in the DisplayTemplates folder as the class name is used as the name of the view.cshtml file.However, you can have two classes in a solution with the same name if they appear in different namespaces: Both try to use the DisplayTemplate defined by view: However in the view file you must declare the model - for example: This means that if you have a DisplayFor which takes a MyOtherNamespace.Class1 you get a runtime error due to a type mismatch.If you knew in advance the places where this was going to happen you could use the UIHint to force the DisplayFor to use an alternative template (or you could use a named template directly in the view). But if you don't know in advance (you have all these objects in an enumeration of some kind and therefore can't write specific code to handle edge cases like this without a lot of unwieldy reflection - is there any way to have DisplayTemplates for these classes? <code>  MyNamespace.Class1MyOtherNamespace.Class1 Class1.cshtml @model MyNamespace.Class1",How to handle MVC DisplayTemplates for two classes with the same name (different namespaces)
Moving UI-object to another scene," We tryed different ways to move UI-object to another scene, but we failed. Over object is in Canvas.Method 1: we used LoadLevelAdditive, but there moved all objects from first scene without over Canvas with it's elements.Method 2: we used DontDestroyOnLoad. We need to change our element on Canvas. DDOL save last position on the scene, but we can't change object at all.Can you get some advice, please?Thanks. <code> ",Move/Transfer GameObject to another scene
Asking for the meaning of the syntax: return _(); IEnumerable<TSource> _()," In the C# code below, I found the usage of _() strange. Can anyone explain what this means? <code>  public static IEnumerable<TSource> DistinctBy<TSource, TKey>(this IEnumerable<TSource> source, Func<TSource, TKey> keySelector, IEqualityComparer<TKey> comparer){ if (source == null) throw new ArgumentNullException(nameof(source)); if (keySelector == null) throw new ArgumentNullException(nameof(keySelector)); return _(); IEnumerable<TSource> _() { var knownKeys = new HashSet<TKey>(comparer); foreach (var element in source) { if (knownKeys.Add(keySelector(element))) yield return element; } }}",Meaning of the syntax: return _(); IEnumerable<TSource> _()
Is there a better way to cast an object to an implementation of an interface?," I am not sure if there's a better way to do this. maybe someone help?I want to cast an object of type JObject to a class in a factory. Class itself should be decided based on on another parameter. But I can only think of Serializing the object to a string an serializing back into a specific class. There has to be a better way?https://dotnetfiddle.net/3Qwq6V <code>  using Newtonsoft.Json;using Newtonsoft.Json.Serialization;using System;namespace Test{ public class Input { public int TypeId { get; set; } public object ObjectDefinesInput; } public class VoiceInput { public string Language; } public class TextInput { public string Encoding; } public interface IResponse { void Respond(); } public class VoiceResponse : IResponse { private VoiceInput input { get; set; } public VoiceResponse(VoiceInput input) { this.input = input; } public void Respond() { // use information on VoiceInput to do something Console.WriteLine(""(In ""+ this.input.Language +""): beep buup boop.""); } } public class TextResponse : IResponse { private TextInput input { get; set; } public TextResponse(TextInput input) { this.input = input; } public void Respond() { Console.WriteLine(""I am a text handler. Using ""+ this.input.Encoding +"".""); } } public static class ResponseFactory { public static IResponse CreateResponseHandler(Input input) { // ----------------- ISSUE HERE -----------------------------// // I'm using JsonConvert to serialize an <object> to a string, and then string jsonObjectDefinesInput = JsonConvert.SerializeObject(input.ObjectDefinesInput, new JsonSerializerSettings { Formatting = Formatting.Indented, ContractResolver = new CamelCasePropertyNamesContractResolver() }); switch (input.TypeId) { case 1: // (VoiceInput) input.ObjectDefinesInput throws exception // input.ObjectDefinesInput as VoiceInput returns null VoiceInput voiceInput = JsonConvert.DeserializeObject<VoiceInput>(jsonObjectDefinesInput); return new VoiceResponse(voiceInput); default: TextInput textInput = JsonConvert.DeserializeObject<TextInput>(jsonObjectDefinesInput); return new TextResponse(textInput); } } } public class Program { public static void Main(string[] args) { string jsonData1 = ""{ \""typeId\"": 1, \""ObjectDefinesInput\"": { \""Language\"": \""Robot\"" } }""; string jsonData2 = ""{ \""typeId\"": 2, \""ObjectDefinesInput\"": { \""Encoding\"": \""UTF-8\"" } }""; Input someInpput1 = JsonConvert.DeserializeObject<Input>(jsonData1); Input someInpput2 = JsonConvert.DeserializeObject<Input>(jsonData2); IResponse testResponse1 = ResponseFactory.CreateResponseHandler(someInpput1); IResponse testResponse2 = ResponseFactory.CreateResponseHandler(someInpput2); testResponse1.Respond(); testResponse2.Respond(); Console.ReadLine(); } }}",Is there a better way to cast an JObject to any implementation of an interface?
Embed an UUID into an installer," I have a Windows Forms application installed using InnoSetup that my users download from my website. They install this software onto multiple PCs.The application talks to a Web API which must be able to identify the user. I am creating a web application where the user can log in and download the app. I would like to embed a universally unique ID into the installer so that they do not have to login again after installation. I want them to download and run setup.exe, and have the application take care of itself.I am considering a couple of options:Embed a user-specific UUID into setup.exe and perform code-signing on-demand on the web serverDownside: not sure how to do this?Embed a user-specific UUID into the name of the installer file (e.g. setup_08adfb12_2712_4f1e_8630_e202da352657.exe)Downside: this is not pretty and would fail if the installer is renamedWrap the installer and a settings file containing the UUID into a self-extracting zipHow can I embed user-specific data into a signed executable on the web server? <code> ",Embed user-specific data into an authenticode signed installer on download
C# Compiler - Unassigned DateTime Field and Local Variable," Out of curiosity:This code is valid and executes: See it working on .NET FiddleBut this doesnt even compile (unassigned local variable): See it (not) working on .NET FiddleDateTime is a non nullable value type, so it doesnt need to be assigned and initialized to have a value, it has a default one.So why the compiler allows the DateTime field version compile and doesnt let the local variable version compile? When the code is compiled to IL, what prevents an value type local variable from being used? <code>  public class Program{ private static DateTime date; public static void Main() { Console.WriteLine(date.ToString(""o"")); }} public class Program{ public static void Main() { DateTime date; Console.WriteLine(date.ToString(""o"")); }}",C# Compiler - Unassigned Field and Local Variable Initial Value
Asp.Net Core 2.0 Kestrel not serving static content," When running a Asp.Net Core 2.0 (or 2.2) app using IIS express, static files (css, js) are served as expected. However when using command line/Kestrel via ""dotnet publish -o [targetDirectory]"" and dotnet [website.dll], Kestrel does not serve up any static content. Utilizing browser F12, I see Kestrel returns a 404 error. Looking closer, when entering the file path directly in the browser (localhost:5000/css/cssfile.css) the file is not displayed but the browser appears to redirect to ""localhost:5000/cssfile.css"" but still returns a 404 error (note the missing /css/ directory). I created this project via Visual Studio 2017, and chose the defaults for a new MVC Core 2.0 application (SDK was installed). I have followed the steps here to enable static files in the program.cs and startup.cs files. These implement ""app.UseStaticFiles();"" and "".UseContentRoot(Directory.GetCurrentDirectory())"". None of the articles found via google seem to help. I have verified dotnet copied the static content to the target directory. What am I missing? Thanks <code>  // Program.cspublic static IWebHost BuildWebHost(string[] args) => WebHost .CreateDefaultBuilder(args) .UseStartup<Startup>() .Build();// Startup.cspublic void Configure(IApplicationBuilder app, IHostingEnvironment env){ app.UseExceptionHandler(""/Error/HandleError""); app.UseStaticFiles(); app.UseMvc(routes => { routes.MapRoute( name: ""default"", template: ""{controller=User}/{action=Index}/{id?}""); });}",Asp.Net Core 2.0-2.2 Kestrel not serving static content
ASP.NET Core 2.0 - How to get TempData in my own utility class? Or TempData is null in constructor," I use TempData in some of my Views/Actions but I'd like to extract that into some class. The problem is if I try to create my class in Controller's constructor, the TempDate there is null. Better yet, I'd like to have my class to be injectable into Controller. So I need to get access to TempData when my class is created.So how can this TempData be constructed in a separate class?This is ASP.NET Core 2.0 web app. <code> ",How to access TempData in my own utility class? Or TempData is null in constructor
"Dotnet core 2.0 with EF core, how to refresh DBContext?"," When my table is updated by another party, the db context in dotnet core still return the old value, how can I force the Db context to refresh?I've done research but I only found people use Reload method, which is not available in EF core, to force the context to refresh.Some other solution suggests dispose the context after using, but I get error saying the DB context is created by dependency injection and I should not mess up with it. <code> ",How to refresh an Entity Framework Core DBContext?
SQLITE INSERT OR REPLACE IF <condition>?," I would like to insert or replace_on_condition. If the condition is not satisfied, do not insert or replace. Is this possible? For my project, I currently have two data collection processes. One is fast but doesn't catch everything. The other is slow but catches everything. With the fast process, I get data almost in real time. With the slow one I get data using a batch process at the end of day. My issue is this: sometimes the fast process will ""Complete"" a record (meaning it no longer needs to be updated) BEFORE the slow process, and later in the day during the nightly batch process, the ""Complete"" record will get replaced by an outdated ""Pending"" record found in the slow process's bulk data. What I would like is a conditional check that goes something like this pseudocode: If I begin with a standard INSERT OR REPLACE example: Which should result in a row in UserProgress table with entry [1,COMPLETE,5].If the following occurs: I would like for it to skip this, because there is already a COMPLETE record.I'm sure this is a duplicate question. But is it really? There are so many answers to this question I am not sure which is the best approach. Look at all these examples that I found:I can attempt to add a CASE statement, I have been told it is equivalent to a IF-THEN-ELSE statement. As done in this example.I can attempt to use SELECT or COALESCE statement in the VALUES. As done in this example.I can even attempt to use a SELECT WHERE statement. As done in this example.I can attempt to use an LEFT JOIN statement. As done in this example.Which is great for SQLite. There appears to be multiple ways to skin the same cat. Me being a novice I am now confused. It isn't clear which approach I should be using.I am looking for a solution that can be done in one sql statement.* UPDATE *I found a two transaction solution. I'm still on the hunt for a single transaction solution. This works, but uses two transactions: <code>  If(record_is_not_complete or does_not_exist) { INSERT or REPLACE; }Else { do_nothing and move_to_the_next; } INSERT OR REPLACE INTO UserProgress (id, status, level) VALUES (1, 'COMPLETE', 5); INSERT OR REPLACE INTO UserProgress (id, status, level) VALUES (1, 'PENDING', 4); public void Create(IEnumerable<UserProgress> items) { var sbFields = new StringBuilder(); sbFields.Append(""ID,""); sbFields.Append(""STATUS,""); sbFields.Append(""LEVEL,""); int numAppended = 3; var sbParams = new StringBuilder(); for (int i = 1; i <= numAppended; i++) { sbParams.Append(""@param""); sbParams.Append(i); if (i < numAppended) { sbParams.Append("", ""); } } // attempting this solution: https://stackoverflow.com/questions/2251699/sqlite-insert-or-replace-into-vs-update-where // first insert the new stuff. using (var command = new SQLiteCommand(Db)) { command.CommandText = ""INSERT OR IGNORE INTO USERPROGRESS ("" + sbFields + "") VALUES("" + sbParams + "")""; command.CommandType = CommandType.Text; using (var transaction = Db.BeginTransaction()) { foreach (var user in items) { command.Parameters.Add(new SQLiteParameter(""@param1"", user.Id)); command.Parameters.Add(new SQLiteParameter(""@param2"", user.Status)); command.Parameters.Add(new SQLiteParameter(""@param3"", user.Level)); command.ExecuteNonQuery(); } transaction.Commit(); } } using (var command = new SQLiteCommand(Db)) { string parameterized = """"; for (int i = 1; i <= 3; i++) { parameterized += _columnNames[i - 1] + ""="" + ""@param"" + i; if (i != 3) parameterized += "",""; } command.CommandText = ""UPDATE USERPROGRESS SET "" + parameterized + "" WHERE ID=@param1 AND STATUS !='COMPLETE'""; command.CommandType = CommandType.Text; using (var transaction = Db.BeginTransaction()) { foreach (var user in items) { command.Parameters.Add(new SQLiteParameter(""@param1"", user.Id)); command.Parameters.Add(new SQLiteParameter(""@param2"", user.Status)); command.Parameters.Add(new SQLiteParameter(""@param3"", user.Level)); command.ExecuteNonQuery(); } transaction.Commit(); } } }",How to conditionally INSERT OR REPLACE a row in SQLite?
Cross correlation using mathdotnet c#, I have recently started using Mathdotnet Numerics statistical package to do data analysis in c#.I am looking for the cross correlation function. Does Mathdotnet have an API for this?Previously I have been using MATLAB xcorr or Python numpy.correlate. So I am looking for a C# equivalent of these.I have looked through their documentation but it isn't very straightforward.https://numerics.mathdotnet.com/api/ <code> ,Cross correlation using mathdotnet
Xamarin.Forms dynamic layout depending on screen position or size," Did Xamarin.Forms already contain a control/layout which orders it's content depending on the screen orientation or size?What I want:Two stacklayouts which are ordered horizontal, if the screen got enough space.When the Screen changes, so that the screen got not enough horizontal-space, the two stacklayouts should be ordered vertical.I don't want to do it in code behind.I search for an solution which only uses the xaml. <code> ",Xamarin.Forms dynamic layout depending on screen orientation or size
How to stop Win32 from drawing classic title bar," I wanted to add a nice shadow to my borderless form, and the best way I found to do it with minimal performance loss is to use DwmExtendFrameIntoClientArea. However, this seems to be causing Windows to draw a classic title bar over the window, but it is non-functional (ie. the glitch is merely graphical).This is the code I am using: I have tried setting ALLOW_NCPAINT to 1, and I even tried returning 0 when the window receives WM_NCPAINT without calling DefWndProc, but it made no difference.Is there a way to resolve this weird issue while still using DwmExtendFrameIntoClientArea? <code>  int v = (int) DWMNCRENDERINGPOLICY.DWMNCRP_ENABLED;NativeApi.DwmSetWindowAttribute(Handle, DwmWindowAttribute.NCRENDERING_POLICY, ref v, sizeof(int));int enable = 0;NativeApi.DwmSetWindowAttribute(Handle, DwmWindowAttribute.ALLOW_NCPAINT, ref enable, sizeof(int));MARGINS margins = new MARGINS() { leftWidth = 0, topHeight = 0, rightWidth = 0, bottomHeight = 1};NativeApi.DwmExtendFrameIntoClientArea(Handle, ref margins);",Prevent Win32 from drawing classic title bar
How to use Hex to set button color?," How can I change the button color in Unity, using HEX values?I tried this, but it doesn't work, perhaps I made a mistake here: <code>  btn.image.color = ColorUtility.TryParseHtmlString(DADADAFF, out color); ",How to convert hex to Color(RGBA) with TryParseHtmlString
run a .NET core app (.dll) with cmd by using process.start," I'm new to .NET Core 2.0, so i might be doing this all wrong, if so let me know.I have a .NET core 2.0 app that should be cross platform, hence the app is a .dll console application, and it does work fine on all platforms.I'm trying to implement kind of a watchdog, that in case of necessary process will duplicate itself, and by the same way it was called My code is: The problem is that when the process runs this code, i'm getting the following exception Unhandled Exception: System.IO.FileNotFoundException: Could not load file or assembly 'System.Runtime, Version=4.2.0.0, Culture=neutral, PublicKeyToken=sometoken' or one of its dependencies. The system cannot find the file specified.I can't find any mention of ruining dotnet from code, and i don't know even if this is possible?Is it possible? Is .NET core process able to duplicate itself?Thanks  <code>  > $ dotnet process.dll var process = new Process{ StartInfo = new ProcessStartInfo { FileName = ""dotnet"", Arguments = ""path\release\PublishOutput\proces.dll"" UseShellExecute = true, RedirectStandardOutput = false, RedirectStandardError = false, CreateNoWindow = true } }; process.Start();",Running a .NET core app (.dll) with cmd by using process.start
"C# 8 Default Interface Implementations. What is deep meaningful difference now, between abstract class and interface?"," I know that an abstract class is a special kind of class that cannot be instantiated. An abstract class is only to be sub-classed (inherited from). In other words, it only allows other classes to inherit from it but, it cannot be instantiated. The advantage is that it can enforce certain hierarchies for all the subclasses. In simple words, it is a kind of contract that forces all the subclasses to carry on the same hierarchies or standards.Also I know that An interface is not a class. It is an entity that is defined by the word Interface. An interface has no implementation; it only has the signature or in other words, just the definition of the methods without the body. As one of the similarities to Abstract class, it is a contract that is used to define hierarchies for all subclasses or it defines specific set of methods and their arguments. The main difference between them is that a class can implement more than one interface but can only inherit from one abstract class. Since C# doesnt support multiple inheritance, interfaces are used to implement multiple inheritance.When we create an interface, we are basically creating a set of methods without any implementation that must be overridden by the implemented classes. The advantage is that it provides a way for a class to be a part of two classes: one from inheritance hierarchy and one from the interface.When we create an abstract class, we are creating a base class that might have one or more completed methods but at least one or more methods are left uncompleted and declared abstract. If all the methods of an abstract class are uncompleted then it is same as an interface.BUTBUTBUTI noticed that we will have Default Interface Methods in C# 8.0Maybe I'm asking it because I have only 1-2 years of experience in programming, but what would be main difference between abstract class and interface now?I know that we can't make state in interface, will it be only one difference between them? <code> ","Default Interface Methods. What is deep meaningful difference now, between abstract class and interface?"
"Default Interface Implementations. What is deep meaningful difference now, between abstract class and interface?"," I know that an abstract class is a special kind of class that cannot be instantiated. An abstract class is only to be sub-classed (inherited from). In other words, it only allows other classes to inherit from it but, it cannot be instantiated. The advantage is that it can enforce certain hierarchies for all the subclasses. In simple words, it is a kind of contract that forces all the subclasses to carry on the same hierarchies or standards.Also I know that An interface is not a class. It is an entity that is defined by the word Interface. An interface has no implementation; it only has the signature or in other words, just the definition of the methods without the body. As one of the similarities to Abstract class, it is a contract that is used to define hierarchies for all subclasses or it defines specific set of methods and their arguments. The main difference between them is that a class can implement more than one interface but can only inherit from one abstract class. Since C# doesnt support multiple inheritance, interfaces are used to implement multiple inheritance.When we create an interface, we are basically creating a set of methods without any implementation that must be overridden by the implemented classes. The advantage is that it provides a way for a class to be a part of two classes: one from inheritance hierarchy and one from the interface.When we create an abstract class, we are creating a base class that might have one or more completed methods but at least one or more methods are left uncompleted and declared abstract. If all the methods of an abstract class are uncompleted then it is same as an interface.BUTBUTBUTI noticed that we will have Default Interface Methods in C# 8.0Maybe I'm asking it because I have only 1-2 years of experience in programming, but what would be main difference between abstract class and interface now?I know that we can't make state in interface, will it be only one difference between them? <code> ","Default Interface Methods. What is deep meaningful difference now, between abstract class and interface?"
insert table in a single cell inside repeater," I am trying to build a table structure using asp.net Repeater like this below: But I got stuck in adding Table 1 and Table 2 for the Row 2. I am not sure how to add the table in a single cell inside the Repeater and the data needs to binding from the DataTable.And below is my code for Repeater: Could any one please suggest any idea on this one that would be very grateful to me? <code>  column 1 | Column 2Row1 cell1 cell2--------------------------------------- TABLE 1 TABLE 2 ---------------------------------- col1|Col2|Col3_ same column and rows are here as well Row2 row1____|____|____ row2___ |____|_____ row3____|____|_____ <asp:Repeater ID=""Repeaterp"" runat=""server""> <HeaderTemplate> <table> <tr><th>usedcount</th><th>notUsedCount</th></tr> </HeaderTemplate> <ItemTemplate> <tr> <td><asp:TextBox runat=""server"" ID=""txtAvai"" Text='<%#Eval(""Count"") %>' ReadOnly=""true""></asp:TextBox></td> <td><asp:TextBox runat=""server"" ID=""txtConv"" Text='' ReadOnly=""true""></asp:TextBox></td> </tr> </ItemTemplate> <FooterTemplate> </table> </FooterTemplate></asp:Repeater",Insert table in a single cell inside repeater
Table per Hierarchy in Entity Framework Core 2.0," These are my models: I wanted the following database structure:Table CompanyCompanyId (PK)NameAddressEmailUrlTable HeadOfficeHeadOfficeId (PK)CompanyId (FK)Table BranchOfficeBranchOfficeId (PK)HeadOfficeId (FK)CompanyId (FK)How can I do this?When I create this migration, the EF creates just one table, with all columns! I don't want this approach! <code>  public class Company{ public int CompanyId { get; set; } public string Name { get; set; } public string Address { get; set; } public string Email { get; set; } public string Url { get; set; } //...}public class HeadOffice : Company{ public int HeadOfficeId { get; set; } public virtual List<BranchOffice> BranchOffice { get; set; } = new List<BranchOffice>();}public class BranchOffice : Company{ public int BranchOfficeId { get; set; } public virtual HeadOffice HeadOffice { get; set; }}",Table per Type in Entity Framework Core 2.0
why is that colon character getting encrypted to x003A in xml element serailization process?," I have defined type as Example as shown below, after instantiating a object and serializing using XmlSerializer, i am getting x003A instead of colon :Here's my code: Serialization code Expected Result Actual Result: Any help and direction in this are greatly appreciated. Thanks in advance! <code>  public class Example { [XmlElement(""Node1"")] public string Node1 { get; set; } [XmlElement(""rd:Node2"")] public string Node2 { get; set; } } Example example = new Example { Node1 = ""value1"", Node2 = ""value2"" }; XmlSerializerNamespaces namespaceSerializer = new XmlSerializerNamespaces(); namespaceSerializer.Add(""rd"", @""http://schemas.microsoft.com/SQLServer/reporting/reportdesigner""); System.Xml.Serialization.XmlSerializer serializer = new System.Xml.Serialization.XmlSerializer(typeof(Example)); string path = System.Windows.Forms.Application.StartupPath + ""//example.xml""; using (StreamWriter writer = new StreamWriter(path)) { serializer.Serialize(writer, example, namespaceSerializer); } <?xml version=""1.0"" encoding=""utf-8""?><Example xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema""> <Node1>value1</Node1> <rd:Node2>value2</rd:Node2></Example> <?xml version=""1.0"" encoding=""utf-8""?><Example xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema""> <Node1>value1</Node1> <rd_x003A_Node2>value2</rd_x003A_Node2></Example>",Colon character getting encoded to x003A in xml element serialization process
C# GZipStream from MemoryStream only returns a few hundred bytes," I am trying to download a .gz file of a few hundred MBs, and turn it into a very long string in C#. My test URL: https://commoncrawl.s3.amazonaws.com/crawl-data/CC-MAIN-2017-47/segments/1510934803848.60/wat/CC-MAIN-20171117170336-20171117190336-00002.warc.wat.gzmemstream has a length of 283063949. The program lingers for about 15 seconds on the line where it is initialized, and my network is floored during it, which makes sense.outmemstream has a length of only 548.Written to the command line is the first lines of the zipped document. They are not garbled. I'm not sure how to get the rest. <code>  using (var memstream = new MemoryStream(new WebClient().DownloadData(url)))using (GZipStream gs = new GZipStream(memstream, CompressionMode.Decompress))using (var outmemstream = new MemoryStream()){ gs.CopyTo(outmemstream); string t = Encoding.UTF8.GetString(outmemstream.ToArray()); Console.WriteLine(t);}",GZipStream from MemoryStream only returns a few hundred bytes
ef core: how to UPDATE the enity before DELETE on SaveContext?," Goal is to track who had changed and deleted an entity.So I have an entity that implements an interface: Now the code of entity remove operation could look like this : In real: ModifiedBy update will be never executed (when my db history triggers expect to ""handle"" it). Only delete statement will be executed on DB.I want to know how to force EF Core ""update"" deleted entities/entries (which implements the specific interface) if entity was modified.Note: RowVersion adds additional complexity. P.S.To put additional SaveContext call manually - of course is an option, but I would like to have a generic solution: many various updates and deletes, then one SaveContext do all analyzes.To update those properties manually before SaveContext collecting var deletedEntries = entries.Where(e => e.State == EntityState.Deleted && isAuditable(e)) it is not an option since it can ruin EF Core locks order management and therefore provoke deadlocks.Most clear solution would be just stay with one SaveContext call but inject UPDATE statement on auditable fields just before EF CORE call DELETE. How to achieve this? May be somebody has the solution already?Alternative could be ""on delete do not compose DELETE statement but call stored procedure that can accept auditable fields as paramaters"" <code>  interface IAuditable { string ModifiedBy {get;set;}}class User: IAuditable { public int UserId {get;set;} public string UserName {get;set;} public string ModifiedBy {get;set;} [Timestamp] public byte[] RowVersion { get; set; }} User user = context.Users.First();user.ModifiedBy = CurrentUser.Name;context.Users.Remove(employer);context.SaveContext();",How to UPDATE modified and deleted entities on SaveContext?
How to UPDATE the entity before DELETE on SaveContext?," Goal is to track who had changed and deleted an entity.So I have an entity that implements an interface: Now the code of entity remove operation could look like this : In real: ModifiedBy update will be never executed (when my db history triggers expect to ""handle"" it). Only delete statement will be executed on DB.I want to know how to force EF Core ""update"" deleted entities/entries (which implements the specific interface) if entity was modified.Note: RowVersion adds additional complexity. P.S.To put additional SaveContext call manually - of course is an option, but I would like to have a generic solution: many various updates and deletes, then one SaveContext do all analyzes.To update those properties manually before SaveContext collecting var deletedEntries = entries.Where(e => e.State == EntityState.Deleted && isAuditable(e)) it is not an option since it can ruin EF Core locks order management and therefore provoke deadlocks.Most clear solution would be just stay with one SaveContext call but inject UPDATE statement on auditable fields just before EF CORE call DELETE. How to achieve this? May be somebody has the solution already?Alternative could be ""on delete do not compose DELETE statement but call stored procedure that can accept auditable fields as paramaters"" <code>  interface IAuditable { string ModifiedBy {get;set;}}class User: IAuditable { public int UserId {get;set;} public string UserName {get;set;} public string ModifiedBy {get;set;} [Timestamp] public byte[] RowVersion { get; set; }} User user = context.Users.First();user.ModifiedBy = CurrentUser.Name;context.Users.Remove(employer);context.SaveContext();",How to UPDATE modified and deleted entities on SaveContext?
Unable to serialize ServiceBus Message - Error getting value from 'ExpiresAtUtc'," I need to write a test where I manually create a Microsoft.Azure.ServiceBus.Message and serialize it to JSON. Example code: However, I get the following exception when serializing: Any ideas how I can create a valid Message (that can be later serialized)? ExpiresAtUtc is get only so cannot be directly set. Is there a way to indirectly set it? <code>  var message = new Microsoft.Azure.ServiceBus.Message { MessageId = ""0c8dfad9-6f0f-4d7f-a248-2a48fc899486"", CorrelationId = ""78b507b0-6266-458d-afe6-7882c935e481"", Body = Encoding.UTF8.GetBytes(""Hello world""), }; var json = JsonConvert.SerializeObject(message); Newtonsoft.Json.JsonSerializationException : Error getting value from 'ExpiresAtUtc' on 'Microsoft.Azure.ServiceBus.Message'. ---- System.InvalidOperationException : Operation is not valid due to the current state of the object.",Unable to serialize Azure ServiceBus Message - Error getting value from 'ExpiresAtUtc'
Using a variable int a linq statment," I'm attempting to use a variable inside of a LINQ select statement. Here is an example of what I'm doing now. I have a Some very not DRY code with the GetListOf... Methods i feel like i should be able to do something like this but that is not vaild code. I think the key Might Relate to Creating a Func if That is the answer how do I do that?Here is a second attempt using refelection But this is also a no go. I think the refection might be a DeadEnd/red herring but i thought i would show my work anyway. Note Sample Code is simplified in reality this is used to populate a datalist via AJAX to Create an autocomplete experience. That object has 20+ properties and I can complete by writing 20+ methods but I feel there should be a DRY way to complete this. Also making this one method also would clean up my controller action a bunch also. Question: Given the first section of code is there a way to abstract those similar methods into a single method buy passing some object into the select Statement???Thank you for your time. <code>  using System;using System.Collections.Generic;using System.Linq;using Faker;namespace ConsoleTesting{internal class Program{ private static void Main(string[] args) { List<Person> listOfPersons = new List<Person> { new Person(), new Person(), new Person(), new Person(), new Person(), new Person(), new Person(), new Person(), new Person(), new Person(), new Person() }; var firstNames = Person.GetListOfAFirstNames(listOfPersons); foreach (var item in listOfPersons) { Console.WriteLine(item); } Console.WriteLine(); Console.ReadKey(); } public class Person { public string City { get; set; } public string CountryName { get; set; } public string FirstName { get; set; } public string LastName { get; set; } public Person() { FirstName = NameFaker.Name(); LastName = NameFaker.LastName(); City = LocationFaker.City(); CountryName = LocationFaker.Country(); } public static List<string> GetListOfAFirstNames(IEnumerable<Person> listOfPersons) { return listOfPersons.Select(x => x.FirstName).Distinct().OrderBy(x => x).ToList(); } public static List<string> GetListOfCities(IEnumerable<Person> listOfPersons) { return listOfPersons.Select(x => x.FirstName).Distinct().OrderBy(x => x).ToList(); } public static List<string> GetListOfCountries(IEnumerable<Person> listOfPersons) { return listOfPersons.Select(x => x.FirstName).Distinct().OrderBy(x => x).ToList(); } public static List<string> GetListOfLastNames(IEnumerable<Person> listOfPersons) { return listOfPersons.Select(x => x.FirstName).Distinct().OrderBy(x => x).ToList(); } }}} public static List<string> GetListOfProperty(IEnumerable<Person> listOfPersons, string property) { return listOfPersons.Select(x =>x.property).Distinct().OrderBy(x=> x).ToList(); } public static List<string> GetListOfProperty(IEnumerable<Person> listOfPersons, string property) { Person person = new Person(); Type t = person.GetType(); PropertyInfo prop = t.GetProperty(property); return listOfPersons.Select(prop).Distinct().OrderBy(x => x).ToList();}",LINQ select property by name
"Using C# WPF, how do I play the Windows Notification sound? (It is not defined in System.Media.SystemSounds)"," When using System.Media, there is something called SystemSounds where you can easily play a couple of operating system sounds: Unfortunately, there are only these five options, and in Windows 10, three of them are the same while one of them doesn't even play anything.What I really want to do is play the Notification sound, as defined in the Sound panel (seen here):Does anyone know how to do this? <code>  System.Media.SystemSounds.Asterisk.Play();System.Media.SystemSounds.Beep.Play();System.Media.SystemSounds.Exclamation.Play();System.Media.SystemSounds.Hand.Play();System.Media.SystemSounds.Question.Play();",How do I play the Windows Notification sound? (It is not defined in System.Media.SystemSounds)
How to make a lot of web requests in parallel using async and await?," I read the how to by Microsoft atHow to: Make Multiple Web Requests in Parallel by Using async and await (C#)and found: I understand this code, but my question is: How do I modify this to scale it to like, let's say a hundred or a thousand? <code>  private async Task CreateMultipleTasksAsync() { // Declare an HttpClient object, and increase the buffer size. The // default buffer size is 65,536. HttpClient client = new HttpClient() { MaxResponseContentBufferSize = 1000000 }; // Create and start the tasks. As each task finishes, DisplayResults // displays its length. Task<int> download1 = ProcessURLAsync(""http://msdn.microsoft.com"", client); Task<int> download2 = ProcessURLAsync(""http://msdn.microsoft.com/library/hh156528(VS.110).aspx"", client); Task<int> download3 = ProcessURLAsync(""http://msdn.microsoft.com/library/67w7t67f.aspx"", client); // Await each task. int length1 = await download1; int length2 = await download2; int length3 = await download3; int total = length1 + length2 + length3; // Display the total count for the downloaded websites. resultsTextBox.Text += string.Format(""\r\n\r\nTotal bytes returned: {0}\r\n"", total); } ",How to make a lot of concurrent web requests using async and await?
Overriden method vs method with same name," I have pretty simple following code: Then in program I write: I do not understand and could not find on the web why Derived.Foo(object) is called? How can I make sure that Derived.Foo(int) is called?  <code>  public class Base{ public virtual void Foo(int x) { Console.WriteLine(""Base.Foo(int)""); }}public class Derived : Base{ public override void Foo(int x) { Console.WriteLine(""Derived.Foo(int)""); } public void Foo(object o) { Console.WriteLine(""Derived.Foo(object)""); }} Derived d = new Derived();int i = 1;d.Foo(i); //prints Derived.Foo(object)",Why less specific overload taken over more sepcific overriden method with same name?
EF Core 2.0 Scaffold-DbContext in Repository Pattern," I'm implementing repository pattern in company solution I work for, separating model classes in a Backend project and database context and migrations in DbContexts project.I'm using Scaffold-DbContext setting my Backend Project as default project to destination of model classes, however DbContext Class is always created in same folder as model classes. Is it possible to redirect the creation of the DbContext class to a different output folder, in my case to DbContexts project? <code> ",Scaffold-DbContext to different output folder
How to get the base constructor calling parameters with C# Reflection," How to get the hard-coded parameter that the sub-class constructor is used to call the base-class constructor? I would like to get all the hard-coded formatting string for the sub-classes of BaseMessage, i.e. ""Hello {0}"" and ""Hello {0}, I am {1}"" <code>  public class BaseMessage{ public BaseMessage(string format, params string[] parameteres) { }}public class HelloMessage : BaseMessage{ public HelloMessage(string name) : base(""Hello {0}"", name) { }}public class IntroductionMessage : BaseMessage{ public IntroductionMessage(string name, string myName) : base(""Hello {0}, I am {1}"", name, myName) { }}",How to get the base constructor calling parameters with Reflection
How can i use #Scrips.Render with .Net core 2.0 mvc application?," How can I use @Scripts.Render with a .NET Core 2.0 MVC application?I am converting code from .NET Framework 4.6.1 to .NET Core 2.0. I have read from here how to bundle with .NET Core 2.0. How can I fix the error, and replace the code with the new version?Code: It says The name 'Scripts' does not exist in the current contextExisting BundleConfig.cs: <code>  @Scripts.Render(""~/bundles/login"") public static void RegisterBundles(BundleCollection bundles){ bundles.Add(new ScriptBundle(""~/bundles/jquery"").Include( ""~/Scripts/jquery-{version}.js"")); bundles.Add(new ScriptBundle(""~/bundles/jqueryvalidate"").Include( BundleTable.EnableOptimizations = true;}",How can I use @Scripts.Render with .Net Core 2.0 MVC application?
How can i use @Scripts.Render with .Net core 2.0 mvc application?," How can I use @Scripts.Render with a .NET Core 2.0 MVC application?I am converting code from .NET Framework 4.6.1 to .NET Core 2.0. I have read from here how to bundle with .NET Core 2.0. How can I fix the error, and replace the code with the new version?Code: It says The name 'Scripts' does not exist in the current contextExisting BundleConfig.cs: <code>  @Scripts.Render(""~/bundles/login"") public static void RegisterBundles(BundleCollection bundles){ bundles.Add(new ScriptBundle(""~/bundles/jquery"").Include( ""~/Scripts/jquery-{version}.js"")); bundles.Add(new ScriptBundle(""~/bundles/jqueryvalidate"").Include( BundleTable.EnableOptimizations = true;}",How can I use @Scripts.Render with .Net Core 2.0 MVC application?
The meaning of Dictionary'2 in a stack trace, Sometimes I see this `2 in a stack trace. For example: System.Collections.Generic.KeyNotFoundException: The given key was not present in the dictionary. at System.Collections.Generic.Dictionary`2.get_Item(TKey key)What is the meaning of `2 after Dictionary? <code> ,The meaning of Dictionary`2 in a stack trace
Select from multiply tables in one call, In my code I have a page that includes information from 3 different tables. To show this information I make 3 SQL select calls and unite them in one list to pass as Model to my view. Can I do it with one SQL call? Data has no connection with one another. My code: If there is a way to load all 3 tables in one SQL request it will improve significantly the load time of this page.Thank you. <code>  public ActionResult Index(){ StorePageData PageData = new StorePageData(); return View(PageData);}public class StorePageData{ public List<Table1Data> Table1 { get; set; } public List<Table2Data> Table2 { get; set; } public List<Table3Data> Table3 { get; set; } public StorePageData() { Table1 = //loading from Database1 Table2 = //loading from Database2 Table3 = //loading from Database3 }}public class Table1Data{ public int Id { get; set; } public double Info1 { get; set; } public string Info2 { get; set; }}public class Table2Data{ public int Id { get; set; } public List<int> Info1 { get; set; } public List<int> Info2 { get; set; }}public class Table3Data{ public int Id { get; set; } public List<string> Info1 { get; set; } public List<string> Info2 { get; set; }},Select from multiple tables in one call
how can I get class name that calling my method," I want to write my own logger.This is my logger manager: I am calling Error(string name); method as below: In this way, I am geting the caller class name in my method called Error.But I don't want to pass the name to error method every time. I want to make my logger (Or another logger methods: Info(), Warn()) method get the name by itself.Thanks for your best practice... <code>  public static class LoggerManager{ public static void Error(string name) { }} public class Foo{ public void Test() { LoggerManager.Error(this.GetType().FullName); }}",How to get Class name that is calling my method?
ASPNET web api streaming lags on second call," This is updated question, there used to be a bug in my codeI would like to be able to send chunks of data over to the client. Anything will be appreciated. Is there a way to provide to asp.net core more control to how it streams the data.I am worried how the below code scales.Could someone please advise how to go streaming data through a web api in asp.net core? The answer that was provided and the code below works. I am not sure how it scales though?Is it possible to retrieve chunks of data and write them to the request, with only getting the chunks into memory. So i would be able to download very large files. <code>  using (FileStream fileStream = new FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.Read)){ return File(System.IO.File.OpenRead(filePath), ""audio/mpeg"");}",ASP.NET Core streaming - write chunks to a request
ASPNET Core streaming lags on second call," This is updated question, there used to be a bug in my codeI would like to be able to send chunks of data over to the client. Anything will be appreciated. Is there a way to provide to asp.net core more control to how it streams the data.I am worried how the below code scales.Could someone please advise how to go streaming data through a web api in asp.net core? The answer that was provided and the code below works. I am not sure how it scales though?Is it possible to retrieve chunks of data and write them to the request, with only getting the chunks into memory. So i would be able to download very large files. <code>  using (FileStream fileStream = new FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.Read)){ return File(System.IO.File.OpenRead(filePath), ""audio/mpeg"");}",ASP.NET Core streaming - write chunks to a request
ASPNET Core streaming music - Provide more control to it?," This is updated question, there used to be a bug in my codeI would like to be able to send chunks of data over to the client. Anything will be appreciated. Is there a way to provide to asp.net core more control to how it streams the data.I am worried how the below code scales.Could someone please advise how to go streaming data through a web api in asp.net core? The answer that was provided and the code below works. I am not sure how it scales though?Is it possible to retrieve chunks of data and write them to the request, with only getting the chunks into memory. So i would be able to download very large files. <code>  using (FileStream fileStream = new FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.Read)){ return File(System.IO.File.OpenRead(filePath), ""audio/mpeg"");}",ASP.NET Core streaming - write chunks to a request
ASPNET Core streaming - Provide more control to it?," This is updated question, there used to be a bug in my codeI would like to be able to send chunks of data over to the client. Anything will be appreciated. Is there a way to provide to asp.net core more control to how it streams the data.I am worried how the below code scales.Could someone please advise how to go streaming data through a web api in asp.net core? The answer that was provided and the code below works. I am not sure how it scales though?Is it possible to retrieve chunks of data and write them to the request, with only getting the chunks into memory. So i would be able to download very large files. <code>  using (FileStream fileStream = new FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.Read)){ return File(System.IO.File.OpenRead(filePath), ""audio/mpeg"");}",ASP.NET Core streaming - write chunks to a request
ASPNET Core streaming - contorl how many chunks are served over the server?," This is updated question, there used to be a bug in my codeI would like to be able to send chunks of data over to the client. Anything will be appreciated. Is there a way to provide to asp.net core more control to how it streams the data.I am worried how the below code scales.Could someone please advise how to go streaming data through a web api in asp.net core? The answer that was provided and the code below works. I am not sure how it scales though?Is it possible to retrieve chunks of data and write them to the request, with only getting the chunks into memory. So i would be able to download very large files. <code>  using (FileStream fileStream = new FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.Read)){ return File(System.IO.File.OpenRead(filePath), ""audio/mpeg"");}",ASP.NET Core streaming - write chunks to a request
"microsoft bot framework, there is a missing subtype"," I am trying to create a Bot application using ms bot framework. I followed the instructions here. When I try to create a bot application using create new project in VS 2017 it gives an error. The project file cannot be opened. There is a missing project subtype. Subtyle: '{349c5851-65df-11da-9384-00065b846f21}' is unsupported by this installationI re-installed the vs 2017 twice but still, I am getting the error. Does anyone have an idea?UPDATED!!!when I try to install MVC 5 using command but it gives an error saying that ""The current environment doesn't have a solution open."" Install-Package Microsoft.AspNet.Mvc -Version 5.2.4 <code> ","Microsoft Bot Framework, there is a missing subtype"
Array in .NET attribute gives error," I am getting the error An attribute argument must be a constant expression, typeof expression or array creation expression of an attribute parameter typeNotice the screenshot below:Notice that if I use the DataRow attribute with one or three parameters, I don't get a compile error. But if I use two parameters and the second parameter is an array of strings, then I do get a compile error.The signatures for DataRowAttribute are public DataRowAttribute (object data1); and public DataRowAttribute (object data1, params object[] moreData);The first one gives me no problem, but the second one seems to be getting confused.I considered that maybe the params object[] could be causing some confusion. Maybe it couldn't determine whether I meant [DataRow(new[] { 1 }, new[] { ""1"" })] or [DataRow(new[] { 1 }, ""1"")]To resolve that, I tried to cast the second attribute to object ([DataRow(new[] { 1 }, (object)new[] { ""1"" })]), but the error didn't go away and it warned me that the cast was redundant. I also tried specifying the types of the array explicitly, but that also did not help.I could just add a third dummy parameter, even null seems to fix this, but that's just a workaround. What's the correct way to do this? <code> ",Attribute with params object[] constructor gives inconsistent compiler errors
How to reference Microsoft.JQuery.Unobtrusive.Ajax within my ASP.NET MVC 5 project," I am trying to use Microsoft.JQuery.Unobtrusive.Ajax. I started by installing the package using NuGet and as expected I am able to see it among my dependencies.My problem is that I cant find a way to reference the script so I can use it within my view. Here I saw that I should add this to my layout: but that path leads to no file:Here is my controller action: The form: I am returning a JSON from the controller but I am getting redirected to the page showing the JSON data. My goal is to use the data in the JSON object to update components within the same view. <code>  <script src=""~/lib/Microsoft.jQuery.Unobtrusive.Ajax/jquery.unobtrusive-ajax.min.js""></script> [HttpPost]public IActionResult OrderItem([Bind(""Id,Quantity"")] Item item){ return Json(new { foo= item.Id, boo= item.Quantity});} <form asp-action=""OrderItem"" asp-controller=""Menu"" method=""POST"" data-ajax=""true"" data-ajax-update=""#divEmp"" data-ajax-mode=""replace"" data-ajax-complete=""onComplete"" data-ajax-failure=""onFailed"" data-ajax-success=""onSuccess""> <input asp-for=""@i.Id"" value=""@i.Id"" type=""hidden"" name=""Id"" /> <input asp-for=""@i.Quantity"" value=""@i.Quantity"" type=""number"" name=""Quantity"" class=""form-group"" /> <button class=""btn btn-primary"" type=""submit"">Add to Order</button></form>",How to reference Microsoft.JQuery.Unobtrusive.Ajax within my ASP.NET Core MVC project
Equivalant of SqlFunctions in EF Core," What is the equivalent of SqlFunctions in Entity Framework (EF) Core 2.0?I am trying to convert this to EF Core Edit #1:I should specify that I am generating a dynamic linq query with expression tree to query the database Thanks <code>  private static readonly MethodInfo StringConvertMethodDouble = typeof(SqlFunctions).GetMethod(""StringConvert"", new Type[] { typeof(double?) });",Equivalent of SqlFunctions in EF Core
external json vulnerable because of Json.Net TypeNameHandling auto?," I'm operating a small website where users can upload custom ""objects"" defined in JSON. Recently I've learned about possible threats using JSON with automatic type deserialization: JSON problem. I think I understand the problematics but I have to ask to be sure. If I only deserialize the incoming JSON with a given specific type (here MyObject) JsonConvert.DeserializeObject<MyObject>(json, settings); and no type inside MyObject and no subtype of any member of MyObject has the type System.Object or dynamic there is nothing that can go bad, right?TypeNameHandling of settings is set to TypeNameHandling.Auto (let's not question this decision it probably could work with None, but I want to understand the question with it set to Auto.)Edit:More information: I have tested the JSON from the previously mentioned website: If MyObject has a System.Object or dynamic typed field obj I can reproduce the threat. But what I want to know: I'm on the safe side with bad prepared user-json even if MyObject is a very complex Object with lots of (derived) sub objects but NONE of them is or has a System.Object or a dynamic field (also not something like List<Object>)? E.g. I could imagine that Json.NET does something like creating objects because of the $type information even if no according field in MyObject can be found. <code>  { ""obj"": { ""$type"": ""System.IO.FileInfo, System.IO.FileSystem"", ""fileName"": ""rce-test.txt"", ""IsReadOnly"": true }}",External json vulnerable because of Json.Net TypeNameHandling auto?
EF Core one-to-one relationship one way," Can a relationship one-to-one be created only one way? And the configuration looks like this But when I try to inspect the Relationship in an instance of Class2 I get something wrong. The RelationshipId has a value and the Relationship.Class1Id has a different value. The Relationship.Class1Id has the same value as Class2Id.Does Class1 is required to have also a property of type Class2 in order for EF Core to work correctly? <code>  public class Class1{ [Key] [DatabaseGenerated(DatabaseGeneratedOption.Identity)] public int Class1Id { get; set; } ...}public class Class2{ [Key] [DatabaseGenerated(DatabaseGeneratedOption.Identity)] public int Class2Id { get; set; } public int? RelationshipId { get; set; } public virtual Class1 Relationship { get; set; } ...} public void Configure(EntityTypeBuilder<Class2> builder){ builder.ToTable(""...""); builder.HasOne(m => m.Relationship) .WithOne() .HasForeignKey<Class1>(a => a.Class1Id);}",EF Core one-to-zero relationship one way
Convert List<dynamic> to List<string>," Suppose I have a List<dynamic> object containing strings: Is there any efficient way of converting this into a proper List<string> object? I know I can iterate over this list and cast each element to a string, then add this to the result list, but maybe some Linq magic could do the trick in one line?I tried using some Select() combined with ToList() and Cast<string>, but to no avail. How should this be done properly?Note: By saying ""efficient"" I mean of course number of lines of code. I do not take execution time or performance into account. Also - let's suppose I do not need to type check, there will always be strings only in this dynamic list.EDIT: Okay, so in regards to comments on ""why Cast wasn't working for you"" - looks like I had another problem regarding the data I receive (I'm using Dapper) and that's why it didn't work. Sorry for the confusion, I thought my list converting was wrong while the problem was not related to this. <code>  var dlist = new List<dynamic>(){ ""test"", ""test2"", ""test3""};",In C# Convert List<dynamic> to List<string>
ASP.NET Core MVC Dependency Injection via method," It has been well documented, how to inject dependencies into services.Question: But is it (already) possible in ASP.NET Core 2.0 to have the system's DI mechanism automatically inject a service into a method or into a property?Sidenote: In PHP-Symfony this pattern is called setter injection.Example:Say I have a common MyBaseController class for all controllers in my project and I want a service (e.g. the UserManager service) to be injected into MyBaseController that can be later accessed in all child controllers. I could use constructor injection to inject the service in the child class and pass it via base(userManager) to the parent. But having to perform this in all child constructors of all controllers is pretty tedious.So I would like to have a setter in MyBaseController like this: ...so I don't have to do the following in every child constructor just to pass the dependency to the parent: Update: The answer given here is what I want to achieve, however the question was asked for ASP.NET Core 1.0, I'm interested in whether any solutions have been added in ASP.NET Core 2.0. <code>  public abstract class MyBaseController : Controller{ public UserManager<User> userManager { get; set; } // system should auto inject UserManager here public void setUserManager(UserManager<User> userManager) { this.userManager = userManager; }} public class UsersController : MyBaseController{ public ChildController(UserManager<User> userManager) : base(userManager) {}",ASP.NET Core MVC Dependency Injection via property or setter method
Unity how Locking RectTrannsform's fields, I'm creating custom layout group and I want to control RectTransform on the child Objects. I want to lock some fields on child's RectTransform like when using canvas or Unity's Horizontal or Vertical group so that it cannot be modified.I need the same effect. You can see this message on top of child's RectTransform : Some values driven by HorizontalLayoutGroupI find a halfway :Adding [ExecuteInEditMode] then: Any other idea? <code>  public void Update(){#if UNITY_EDITOR if (!Application.isPlaying) { /* Todo => update child's positions here. */ }#endif},How to Lock RectTransform's fields
Programatically create service bus subscription using .net standard," My scenario: Website hosted on the cloud, where each instance creates a subscription to a Service Bus Topic for itself to listen for messages.My question: How do I programmatically create subscriptions? <code> ",Programmatically create service bus subscription using .net standard
Pass multiple parameters in a POST API without using a DTO class in .Net Core MVC," I have an action on my web project which calls to an API In the API project this is received as follows: This works fine - however, say I want to pass in an int id and a DateTime variable, how do I serialise and pass them both into the HttpContent? I can do it with a DTO object, but I don't want to be setting up DTO objects when there is only two fields. <code>  [HttpPost] public async Task<IActionResult> ExpireSurvey(int id) { var token = await HttpContext.GetTokenAsync(""access_token""); using (var client = new HttpClient()) { client.DefaultRequestHeaders.Authorization = new System.Net.Http.Headers.AuthenticationHeaderValue(""Bearer"", token); var path = ""/api/forms/ExpireSurvey""; var url = Domain + path; var data = JsonConvert.SerializeObject(id); HttpContent httpContent = new StringContent(data, Encoding.UTF8, ""application/json""); var response = await client.PutAsync(url, httpContent); return Json(response); } } [HttpPut] public IActionResult ExpireSurvey([FromBody] int surveyId) { _repository.ExpireSurvey(surveyId, expiryDate); return Ok(); }",Post Multiple Parameters Without DTO Class
How does the nuget pack command generate the package version?," NuGet version: 4.5.1.4879When using ""project-driven"" NuGet package building (i.e., passing the .csproj file to the nuget pack command), I thought I understood how NuGet will determine the version to use in the generated package. Specifically, that it will use AssemblyInformationalVersion if it exists in the AssemblyInfo, or AssemblyVersion if AssemblyInformationalVersion is not present.That seems to work as expected in some of my assemblies (I have a simple 1:1 relationship between assemblies and packages - 1 assembly produces 1 package of the same name), but not in others.In a problematic assembly, the AssemblyInfo includes this: In the .csproj file I also have this, among other stuff (note the <Version> tag): BTW, I have no .nuspec file.Despite those settings, when I try to build the package, using this command: It builds the package as XYZ.Core.Messaging.1.0.0-local.nupkg.For some other packages I build with a similar command (just a different .csproj file), with the same AssemblyInfo contents, those build the package with version 2.0.0 correctly.So where could NuGet be getting the 1.0.0 version from? <code>  [assembly: AssemblyVersion(""2.0.0.0"")][assembly: AssemblyFileVersion(""2.0.0.0"")][assembly: AssemblyInformationalVersion(""2.0.0"")] <PropertyGroup> <Configuration Condition="" '$(Configuration)' == '' "">Debug</Configuration> <Platform Condition="" '$(Platform)' == '' "">AnyCPU</Platform> <ProjectGuid>{E233E8E2-EB9E-461F-80C2-63F9AFCC425D}</ProjectGuid> <OutputType>Library</OutputType> <AppDesignerFolder>Properties</AppDesignerFolder> <RootNamespace>XYZ.Core.Messaging</RootNamespace> <AssemblyName>XYZ.Core.Messaging</AssemblyName> <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion> <FileAlignment>512</FileAlignment> <Version>2.0.0</Version> <NuGetPackageImportStamp> </NuGetPackageImportStamp> <TargetFrameworkProfile /> </PropertyGroup> nuget pack XYZ.Core.Messaging.csproj -OutputDirectory ""c:\build\nuget-local"" -Suffix ""local""",How does the NuGet pack command generate the package version?
How to setup Social Login in Asp.net Boilerplate Core startup template," I'm trying to authenticate users through Google.I'm using the ABP startup template for ASP.NET Core with Vue.Here's what I have done so far:I've created a GoogleAuthProviderApi in Web.Core: I've registered the Google External Authentication in AuthConfigurer.cs in Web.Host: I've added the settings to appsettings.json in Web.Host, and created the corresponding secrets (ClientId and ClientSecret) in the Secret Manager tool.I've forced the API to SSL with the RequireHttpsAttribute.I've registered the GoogleAuthProviderApi in the [ProjectName]WebCoreModule.cs: I don't know what I'm missing here, nor do I know what to expect exactly.I would have thought that a call to the api/TokenAuth/GetExternalAuthenticationProviders endpoint would at least give me a list with Google in it, but this request returns with an empty array in the results.Additionally, it's a bit unclear to me what the scope of this external authentication is, in the case of OAuth providers such as Google and Facebook. It seems to me that you either have OAuth for server-side usage, in which case I don't understand why you would expose part of it through the API. Or you have OAuth for JavaScript web apps, in which case you don't need an API endpoint on your own server, you just handle the entire thing client-side through the web app.So, what's the purpose exactly of the External Authenticate API endpoint? Is it so that your own server acts as a proxy for authentication? So that you can have both client-side and server-side usage of the External (Google) API?Update 1The comments require me to add some clarification.#1: If I add the Abp.TenantId header in Postman, the response remains the same: #2: The console ""tricks"" in Swagger result in errors: Update 2I think there's something wrong with the GoogleAuthProviderApi. After I made the debugger break on all CLR Exceptions, I caught the following error: <code>  using System;using System.Net.Http;using System.Net.Http.Headers;using System.Threading.Tasks;using Microsoft.AspNetCore.Authentication.Google;using Newtonsoft.Json.Linq;namespace Mindbus.MindbooksSEO.Authentication.External.Google{ public class GoogleAuthProviderApi : ExternalAuthProviderApiBase { public const string Name = ""Google""; public override async Task<ExternalAuthUserInfo> GetUserInfo(string accessCode) { using (var client = new HttpClient()) { client.DefaultRequestHeaders.UserAgent.ParseAdd(""Microsoft ASP.NET Core OAuth middleware""); client.DefaultRequestHeaders.Accept.ParseAdd(""application/json""); client.Timeout = TimeSpan.FromSeconds(30); client.MaxResponseContentBufferSize = 1024 * 1024 * 10; // 10 MB var request = new HttpRequestMessage(HttpMethod.Get, GoogleDefaults.UserInformationEndpoint); request.Headers.Authorization = new AuthenticationHeaderValue(""Bearer"", accessCode); var response = await client.SendAsync(request); response.EnsureSuccessStatusCode(); var payload = JObject.Parse(await response.Content.ReadAsStringAsync()); return new ExternalAuthUserInfo { //Name = GoogleHelper.GetName(payload), EmailAddress = GoogleHelper.GetEmail(payload), //Surname = GoogleHelper.GetFamilyName(payload), //ProviderKey = GoogleHelper.GetId(payload), Provider = Name }; } } }} if (bool.Parse(configuration[""Authentication:Google:IsEnabled""])){ services.AddAuthentication().AddGoogle(googleOptions => { googleOptions.ClientId = configuration[""Authentication:Google:ClientId""]; googleOptions.ClientSecret = configuration[""Authentication:Google:ClientSecret""]; });} public override void PreInitialize(){ Configuration.DefaultNameOrConnectionString = _appConfiguration.GetConnectionString( MindbooksSEOConsts.ConnectionStringName ); // Use database for language management Configuration.Modules.Zero().LanguageManagement.EnableDbLocalization(); Configuration.Modules.AbpAspNetCore() .CreateControllersForAppServices( typeof(MindbooksSEOApplicationModule).GetAssembly() ); ConfigureTokenAuth(); Configuration.Modules.Zero().UserManagement.ExternalAuthenticationSources.Add<GoogleAuthProviderApi>();} GET /api/TokenAuth/GetExternalAuthenticationProviders HTTP/1.1Host: localhost:44300Accept: application/jsonAbp.TenantId: 2Cache-Control: no-cachePostman-Token: 0cb72e57-4b9a-474d-b60d-492fa727a7a2 abp.swagger.login()undefinedVM40:49 POST https://localhost:44300/api/TokenAuth/Authenticate 500 ()abp.swagger.login @ VM40:49(anonymous) @ VM84:1abp.swagger.addAuthToken()false 'Mindbus.MindbooksSEO.Authentication.External.Google.GoogleAuthProviderApi' to type 'Abp.Authorization.Users.IExternalAuthenticationSource`2[Mindbus.MindbooksSEO.MultiTenancy.Tenant,Mindbus.MindbooksSEO.Authorization.Users.User]'.'",How to setup Social Login in ASP.NET Boilerplate?
ASP.NET Core CORS request blocked; why doesn't my API apply the right headers," Trying to set up CORS with authentication. I have a Web API site up at http://localhost:61000 and a consuming web application up at http://localhost:62000. In the Web API Startup.cs, I have: All the doucmentation seems to indicate that should be all I need. In my app's Javascript, I call: And I get in Chrome: Failed to load http://localhost:61000/config/api/v1/MyStuff: No 'Access-Control-Allow-Origin' header is present on the requested resource. Origin 'http://localhost:62000' is therefore not allowed access....and in Firefox: Cross-Origin Request Blocked: The Same Origin Policy disallows reading the remote resource at http://localhost:61000/config/api/v1/MyStuff. (Reason: CORS header Access-Control-Allow-Origin missing). What am I missing? This should be all I need to enable CORS, I thought, but clearly there is something else missing. <code>  public void ConfigureServices(IServiceCollection services) { services.AddCors(o => o.AddPolicy(""MyPolicy"", corsBuilder => { corsBuilder.WithOrigins(""http://localhost:62000"") .AllowAnyMethod() .AllowAnyHeader() .AllowCredentials(); })); IMvcBuilder builder = services.AddMvc(); // ...}// ...public void Configure(IApplicationBuilder app, IHostingEnvironment env){ app.UseCors(""MyPolicy""); app.UseDeveloperExceptionPage(); app.UseDefaultFiles(); app.UseStaticFiles(); app.UseMvc();} $.ajax({ type: 'POST', url: ""http://localhost:61000/config/api/v1/MyStuff"", data: matchForm.serialize(), crossDomain: true, xhrFields: { withCredentials: true }, success: function (data) { alert(data); } });",ASP.NET Core CORS request blocked; why doesn't my API apply the right headers?
Miracles of C# method overload resolution," Having these three methods available in Rx.NET library I write the following sample code in MSVS 2013: This does not compile due to ambiguous overloads. Exact output from the compiler being: However as soon as I replace while( true ) with while( false ) or with var condition = true; while( condition )... the error disappears and method call resolves to this: What is going on there? <code>  public static IObservable<TResult> Create<TResult>(Func<IObserver<TResult>, CancellationToken, Task> subscribeAsync) {...}public static IObservable<TResult> Create<TResult>(Func<IObserver<TResult>, CancellationToken, Task<IDisposable>> subscribeAsync) {...}public static IObservable<TResult> Create<TResult>(Func<IObserver<TResult>, CancellationToken, Task<Action>> subscribeAsync) {...} var sequence = Observable.Create<int>( async ( observer, token ) => { while ( true ) { token.ThrowIfCancellationRequested(); await Task.Delay( 100, token ); observer.OnNext( 0 ); } } ); Error 1 The call is ambiguous between the following methods or properties: 'System.Reactive.Linq.Observable.Create<int>(System.Func<System.IObserver<int>,System.Threading.CancellationToken,System.Threading.Tasks.Task<System.Action>>)' and 'System.Reactive.Linq.Observable.Create<int>(System.Func<System.IObserver<int>,System.Threading.CancellationToken,System.Threading.Tasks.Task>)' var sequence = Observable.Create<int>( async ( observer, token ) => { while ( false ) // It's the only difference { token.ThrowIfCancellationRequested(); await Task.Delay( 100, token ); observer.OnNext( 0 ); } } ); public static IObservable<TResult> Create<TResult>(Func<IObserver<TResult>, CancellationToken, Task> subscribeAsync) {...}",C# method overload resolution issues in Visual Studio 2013
VB vs C# - CType vs ChangeType," Why does this work in VB.Net: But this is throwing an error in C#: Stream is a Type, which is not valid in the current context To be honest, I'm not 100% clued up on converting types, I've only ever used them in code snippets and now I'm trying to convert a simple VB code snippet to a C# version... <code>  Dim ClipboardStream As New StreamReader( CType(ClipboardData.GetData(DataFormats.CommaSeparatedValue), Stream)) ClipboardStream = new StreamReader(Convert.ChangeType( ClipboardData.GetData(DataFormats.CommaSeparatedValue), Stream));",VB vs C#  CType vs ChangeType
Error Creating JTW Token using RSA Security Key with key size less than 2048," I'm facing an exception when trying to create a JWT token in C# Web API application.Test environmentPlatform: Windows 10 x64 with .net framework: 4.6.1jwt NuGet package: System.IdentityModel.Tokens.Jwt version: 4.0.2.206221351Here is the code responsible for generating RSA keys: And here is the code responsible for generating a JTW token signed with a RSA key pair generated with the above code: the exception thrown is of type System.ArgumentOutOfRangeException and the message is:""IDX10630: The 'System.IdentityModel.Tokens.RsaSecurityKey' for signing cannot be smaller than '2048' bits.\r\nParameter name: key.KeySize\r\nActual value was 512.""QuestionHow can I generate a JWT Token using an RSA Security Key with key size less than 2048? <code>  public SignatureInformation CreateNewSignatureInformation(int length = 0) { try { var signatureInformation = new SignatureInformation(); var rsaProvider = new RSACryptoServiceProvider(length); var publicKey = rsaProvider.ToXmlString(false); signatureInformation.Public = publicKey; var privateKey = rsaProvider.ToXmlString(true); signatureInformation.Private = privateKey; return signatureInformation; } catch (Exception) { return null; } } private string GenerateToken(string privateKeyInXml) { var cryptoServiceProvider = new RSACryptoServiceProvider(); cryptoServiceProvider.FromXmlString(privateKeyInXml); var creds = new SigningCredentials(new RsaSecurityKey(cryptoServiceProvider), SecurityAlgorithms.RsaSha256Signature, SecurityAlgorithms.Sha256Digest); var nbf = DateTime.UtcNow; var exp = nbf.AddMinutes(10); var jwtToken = new JwtSecurityToken(""SAMPLE_ISSUER"", ""SAMPLE_AUDIENCE"", null, //null is given as claims list in this sample nbf, exp, creds); var tokenHandler = new JwtSecurityTokenHandler(); var token = tokenHandler.WriteToken(jwtToken); //the exception is thrown here return token; }",Error Creating JWT Token using RSA Security Key with key size less than 2048
MongoDB CancellationToken," Does anyone know what the CancellationToken does if you add it with a parameter in the for example https://mongodb.github.io/mongo-csharp-driver/2.3/apidocs/html/M_MongoDB_Driver_IMongoCollectionExtensions_UpdateMany__1.htmIs it a rollback? Or what does it do? <code>  public static UpdateResult UpdateMany<TDocument>( this IMongoCollection<TDocument> collection, Expression<Func<TDocument, bool>> filter, UpdateDefinition<TDocument> update, UpdateOptions options = null, CancellationToken cancellationToken = null)",MongoDB C# driver CancellationToken
Securing a SPA by authorization server before first load using angular and dotnet core," I am using the 'new' project templates for angular SPA applications in dotnet core 2.1 as written in the article Use the Angular project template with ASP.NET Core.But this article doesn't mention anything about securing the SPA itself.All information i find is about securing a WEBAPI but first of all i am interested in securing the SPA.That means: When i open up my SPA e.g. https://localhost:44329/ i would like to be redirected to the authorization server immediatly instead of clicking some button that will do the authentication.Background: I have to ensure that only a authenticated users are allowed to see the SPA.I want to use Authorization Code Grant to get refresh tokens from my authorization server. I cannot use Implicit Grant because refresh tokens cannot be kept private on the browserCurrent approach is to enforce a MVC policy that requires a authenticated user. But this can only be applied to a MVC Controller. That's why i added HomeController to serve the first request. See project structure:My Startup.cs: Current behaviour: When i spin up my SPA i'm immediately redirected to my authorization server because of the MVC policy. After successful authentication i see the Index method of the home controller but not my SPA.So the question is how should i serve my SPA after i have been redirected from authentication server? <code>  public void ConfigureServices(IServiceCollection services){ services.AddAuthentication(options => { options.DefaultAuthenticateScheme = CookieAuthenticationDefaults.AuthenticationScheme; options.DefaultSignInScheme = CookieAuthenticationDefaults.AuthenticationScheme; options.DefaultChallengeScheme = ""CustomScheme""; }) .AddCookie() .AddOAuth(""CustomScheme"", options => { // Removed for brevity }); services.AddMvc(config => { // Require a authenticated user var policy = new AuthorizationPolicyBuilder() .RequireAuthenticatedUser() .Build(); config.Filters.Add(new AuthorizeFilter(policy)); }); // In production, the Angular files will be served from this directory services.AddSpaStaticFiles(configuration => { configuration.RootPath = ""ClientApp/dist""; });}// This method gets called by the runtime. Use this method to configure the HTTP request pipeline.public void Configure(IApplicationBuilder app, IHostingEnvironment env){ if (env.IsDevelopment()) { app.UseDeveloperExceptionPage(); } else { app.UseExceptionHandler(""/Home/Error""); } app.UseAuthentication(); app.UseStaticFiles(); app.UseSpaStaticFiles(); app.UseMvc(routes => { routes.MapRoute( name: ""default"", template: ""{controller=Home}/{action=Index}/{id?}""); }); app.UseSpa(spa => { spa.Options.SourcePath = ""ClientApp""; if (env.IsDevelopment()) { spa.UseAngularCliServer(npmScript: ""start""); } });}",Securing a SPA by authorization server before first load
Does Swagger can generate custom generic types?," Assume we have API return model in C# and returning ApiResult<string> object instance to clientso we have swagger generated model which is incorrectly converted to typescript class using https://swagger.io/swagger-codegen/ Is it possible to generate output models with generics same as in input models? <code>  public class ApiResult<T>{ public T Result; public bool Success;} ApiResult[String] { result (string, optional), success (boolean, optional)} 'use strict';import * as models from './models';export interface ApiResultString { result?: string; success?: boolean;}",Can Swagger generate custom generic types?
C# Can I declare named async tuple functions," C# 7 allows us to declare functions that return named tuples, so a declaration like the one illustrated below is now ok. I have need to process the response from an HTTP Client request and extract two values from it, and I want to do so asynchronously. The following is allowed My simple question is, is it possible to name the output strings in the same way that I could were the function to operate synchronously along the lines as illustrated below? <code>  (int quotient, int remainder) = GetDivisionResults(17, 5); public static async Task<<Tuple<string,string>> GetRequiredReturnValuesFromResponse(string response) public static async Task<Tuple< string OrderNumber,string OriginalId>> GetRequiredReturnValuesFromResponse(string response)",Can I declare named async tuple functions in C#?
Decoding Base64 Encoded String in C#," I have a key which is Base64 encoded.While trying to decode I am receiving the following error. The error is thrown by byte[] todecode_byte = Convert.FromBase64String(data); Error in base64DecodeThe input is not a valid Base-64 string as it contains a non-base 64 character, more than two padding characters, or an illegal character among the padding characters. I am using the below method to decode this: <code>  public string base64Decode(string data){ try { System.Text.UTF8Encoding encoder = new System.Text.UTF8Encoding(); System.Text.Decoder utf8Decode = encoder.GetDecoder(); byte[] todecode_byte = Convert.FromBase64String(data); // this line throws the exception int charCount = utf8Decode.GetCharCount(todecode_byte, 0, todecode_byte.Length); char[] decoded_char = new char[charCount]; utf8Decode.GetChars(todecode_byte, 0, todecode_byte.Length, decoded_char, 0); string result = new String(decoded_char); return result; } catch (Exception e) { throw new Exception(""Error in base64Decode"" + e.Message); }}","Convert.FromBase64String() throws ""invalid Base-64 string"" error"
Xamarin.Android: Ambiguous reference intellisense error from Resource.Designer.cs VS2017," I am running into a peculiar bug when developing on Visual Studio 2017 that I have been able to ignore for a while, but is now beginning to really bug me. I refer to this issue as a bug rather than an error because I am still able to build my projects in Visual Studio and deploy them to my development device without errors or warnings from the build output. This might seem alright to ignore for a bit, but over time it has become an issue because my intellisense is underlining it in red as an error every time I reference attributes from the Resource class. As you might guess, I refer this class a lot and the Visual Studio editor eventually becomes cluttered with these ""errors"" which (a) hinders my ability to find actual errors in my code and (b) irritates me beyond all reason...""Error"" InvestigationAs shown in the last image, intellisense is picking up an ""Ambiguous Reference"" to each attribute in the Resource class. When I check my Resource.Designer.cs file I only see one reference, but get a second error.It is now telling me that that a ""Member with the same name is already declared"". This lead me to believe that there is a second Resource.Designer.cs file, but my solution explorer and windows explorer both show only one. Attempted solutionsChanged the namespace from InventoryApp (the default namespace of the file) to InventoryApp.Resources. This rid me of the ghastly errors but, upon building the project, it reverts the namespace in the file back to it's default, and the errors pop back up. I was also told by somebody who knows better that this is a big no-no.Deleted the Resource.Designer.cs file, deleted the ""obj"" and ""bin"" folders from the project, cleaned and rebuilt the solution, then added the new Resource.Designer.cs file back to my solution. This did nothing to solve the problem.Created an entirely new project from scratch. Even after creating a Blank Android App from the Visual Studio templates, the error persists. This begs the question: Is this a problem with my installation of Xamarin.Android?Side-notesThe Resource.Designer.cs file's Build Action is set to ""Compile""The .csproj config file contains the tags:  <code>  <AndroidResgenFile>Resources\Resource.Designer.cs</AndroidResgenFile><AndroidResgenClass>Resource</AndroidResgenClass><GenerateSerializationAssemblies>Off</GenerateSerializationAssemblies><AndroidUseLatestPlatformSdk>false</AndroidUseLatestPlatformSdk><TargetFrameworkVersion>v7.1</TargetFrameworkVersion><AndroidManifest>Properties\AndroidManifest.xml</AndroidManifest><MonoAndroidResourcePrefix>Resources</MonoAndroidResourcePrefix><MonoAndroidAssetsPrefix>Assets</MonoAndroidAssetsPrefix>",Ambiguous reference intellisense error from Resource.Designer.cs
Why is my file posted to a Web API empty?," I am very new to file transfer between HttpClient and a Web API, so please excuse any ignorance and guesswork in my code. I have been trying to post a file created with System.IO.Compression.ZipFile to my web API now for about a day, and always I get a 404 response. If I post with an empty stream, the API action method is invoked, so I know the 404 is due to content and not the URI.This method is in the client WPF application that attempts to post the file: And this is the action method in the Web API that receives the post, but only if I don't do the outStream.Position = 0; before attempting to post: The action method is invoked and runs without error with an empty stream, but is pretty useless as it writes an empty file. What am I doing wrong? <code>  public async Task PostDirAsync(string localDirPath, string serverDir){ var sourcePath = Path.Combine(""Temp"", Guid.NewGuid() + "".zip""); ZipFile.CreateFromDirectory(localDirPath, sourcePath, CompressionLevel.Fastest, true); StreamContent streamContent; using (var fs = File.Open(sourcePath, FileMode.Open)) { var outStream = new MemoryStream(); await fs.CopyToAsync(outStream); outStream.Position = 0; streamContent = new StreamContent(outStream); } streamContent.Headers.Add(""Content-Type"", ""application/octet-stream""); var resp = await _client.PostAsync(""api/File/PostDir?serverPath={WebUtility.UrlEncode(serverDir)}"", streamContent);} [HttpPost(""PostDir"")][DisableRequestSizeLimit]public async Task<IActionResult> PostDir(string serverPath){ var zipName = Path.Combine(_config[""QuickDrive:TempDir""], Guid.NewGuid() + "".zip""); using (var ms = new MemoryStream()) using (var fileStream = System.IO.File.Create(zipName)) { await Request.Body.CopyToAsync(ms); ms.Position = 0; await ms.CopyToAsync(fileStream); } return Ok();}",Why do I get a 404 trying to post a large file to a Core Web API
Why do I get a 404 trying to post a file to a Core Web API using this code?," I am very new to file transfer between HttpClient and a Web API, so please excuse any ignorance and guesswork in my code. I have been trying to post a file created with System.IO.Compression.ZipFile to my web API now for about a day, and always I get a 404 response. If I post with an empty stream, the API action method is invoked, so I know the 404 is due to content and not the URI.This method is in the client WPF application that attempts to post the file: And this is the action method in the Web API that receives the post, but only if I don't do the outStream.Position = 0; before attempting to post: The action method is invoked and runs without error with an empty stream, but is pretty useless as it writes an empty file. What am I doing wrong? <code>  public async Task PostDirAsync(string localDirPath, string serverDir){ var sourcePath = Path.Combine(""Temp"", Guid.NewGuid() + "".zip""); ZipFile.CreateFromDirectory(localDirPath, sourcePath, CompressionLevel.Fastest, true); StreamContent streamContent; using (var fs = File.Open(sourcePath, FileMode.Open)) { var outStream = new MemoryStream(); await fs.CopyToAsync(outStream); outStream.Position = 0; streamContent = new StreamContent(outStream); } streamContent.Headers.Add(""Content-Type"", ""application/octet-stream""); var resp = await _client.PostAsync(""api/File/PostDir?serverPath={WebUtility.UrlEncode(serverDir)}"", streamContent);} [HttpPost(""PostDir"")][DisableRequestSizeLimit]public async Task<IActionResult> PostDir(string serverPath){ var zipName = Path.Combine(_config[""QuickDrive:TempDir""], Guid.NewGuid() + "".zip""); using (var ms = new MemoryStream()) using (var fileStream = System.IO.File.Create(zipName)) { await Request.Body.CopyToAsync(ms); ms.Position = 0; await ms.CopyToAsync(fileStream); } return Ok();}",Why do I get a 404 trying to post a large file to a Core Web API
"C#: How to determine whether two references refer to the same variable, even if null?"," How can I determine whether two ref variables refer to the same variable even if both variables contain null?Example: Things I have tried that don't work:return object.ReferenceEquals( a, b ); (Returns true in both test cases)unsafe { return &a == &b; } (Cannot take the address of a managed object) <code>  public static void Main( string[] args ){ object a = null; object b = null; Console.WriteLine( AreSame( ref a, ref b ) ); // Should print False Console.WriteLine( AreSame( ref a, ref a ) ); // Should print True}static bool AreSame<T1, T2>( ref T1 a, ref T2 b ){ // ?????}","How to determine whether two ""ref"" variables refer to the same variable, even if null?"
"How to determine whether two references refer to the same variable, even if null?"," How can I determine whether two ref variables refer to the same variable even if both variables contain null?Example: Things I have tried that don't work:return object.ReferenceEquals( a, b ); (Returns true in both test cases)unsafe { return &a == &b; } (Cannot take the address of a managed object) <code>  public static void Main( string[] args ){ object a = null; object b = null; Console.WriteLine( AreSame( ref a, ref b ) ); // Should print False Console.WriteLine( AreSame( ref a, ref a ) ); // Should print True}static bool AreSame<T1, T2>( ref T1 a, ref T2 b ){ // ?????}","How to determine whether two ""ref"" variables refer to the same variable, even if null?"
Replacing service layer with MediatR - when it's worth to do it?," Do you think it might be reasonable to replace my service layer or service classes with MediatR? For example, my service classes look like this: I want to achieve some sort of modular design so other dynamically loaded modules or plugins can write their own notification or command handlers for my main core application.Currently, my application is not event-driven at all and there's no easy way for my dynamically loaded plugins to communicate.I can either incorporate MediatR in my controllers removing service layer completely or use it with my service layer just publishing notifications so my plugins can handle them.Currently, my logic is mostly CRUD but there's a lot of custom logic going on before creating, updating, deleting.Possible replacement of my service would look like: Would it be something wrong to do?Basically, I'm struggling what to choose for my logic flow:Controller -> Service -> MediatR -> Notification handlers -> RepositoryController -> MediatR -> Command handlers -> RepositoryIt seems like with MediatR I can't have a single model for Create, Update and Delete, so one way to re-use it I'd need to derive requests like: or embed it in my command like: One advantage of MediatR is the ability to plug logic in and plug it out easily which seems like a nice fit for modular architecture but still, I'm a bit confused how to shape my architecture with it. <code>  public interface IEntityService<TEntityDto> where TEntityDto : class, IDto{ Task<TEntityDto> CreateAsync(TEntityDto entityDto); Task<bool> DeleteAsync(int id); Task<IEnumerable<TEntityDto>> GetAllAsync(SieveModel sieveModel); Task<TEntityDto> GetByIdAsync(int id); Task<TEntityDto> UpdateAsync(int id, TEntityDto entityDto);} public class CommandHandler : IRequestHandler<CreateCommand, Response>, IRequestHandler<UpdateCommand, Response>, IRequestHandler<DeleteCommand, bool>{ private readonly DbContext _dbContext; public CommandHandler(DbContext dbContext) { _dbContext = dbContext; } public Task<Response> Handle(CreateCommand request, CancellationToken cancellationToken) { //... } public Task<Response> Handle(UpdateCommand request, CancellationToken cancellationToken) { //... } public Task<bool> Handle(DeleteCommand request, CancellationToken cancellationToken) { ///... }} public CreateRequest : MyDto, IRequest<MyDto> {} public UpdateRequest : MyDto, IRequest<MyDto> {} public CreateRequest : IRequest<MyDto>{ MyDto MyDto { get; set; }}",Replacing service layer with MediatR - is it worth to do it?
Is OpenID Connect available in .NET?, The question in the title is fairly simple. All the tutorials available on internet talk about OpenID Connect implementation in .NET Core. My current project is developed in ASP.NET MVC (not ASP.NET Core) and I am required to implement OpenID Connect in it.I followed this post and tried but to no luck!Any help / clarification on this will be appreciated. <code> ,OpenID Connect with ASP.NET MVC
C# Covariance error in generically constrained class," I have an interface with a covariant type parameter: Additionally, I have a non-generic base class and another deriving from it: Covariance says that an I<Derived> can be assigned to an I<Base>, and indeed I<Base> ib = default(I<Derived>); compiles just fine.However, this behavior apparently changes with generic parameters with an inheritance constraint: Why are these two cases not treated the same? <code>  interface I<out T>{ T Value { get; }} class Base{}class Derived : Base{} class Foo<TDerived, TBase> where TDerived : TBase{ void Bar() { I<Base> ib = default(I<Derived>); // Compiles fine I<TBase> itb = default(I<TDerived>); // Compiler error: Cannot implicitly convert type 'I<TDerived>' to 'I<TBase>'. An explicit conversion exists (are you missing a cast?) }}",Covariance error in generically constrained class
"Visual C#, How to convert a multi-dimensional array to a dictionary?"," I have a n-by-3 array I wish to convert to a Dictionary<string,string[]> where the first column is the key and the rest of the column as an array for the value.For example: I'm aware of ToDictionary but I don't know how to set the value part. How can I set it up correctly? <code>  Key = arr[0,0], Value = new string[2] {arr[0,1], arr[0,2]}. arr.ToDictionary(x=>arr[x,0],x=>new string[2]{arr[x,1],arr[x,2]});//This doesn't work!!!",How to convert a multi-dimensional array to a dictionary?
How to properly make us of TestContext.Properties," I need to access TestContext.Properties before a TestMethod so the test can receive the correct environment to test.The contents of my test.runsettings: As you can see, the file only contains one parameter, called colegio (school)This are the contents of TestBase.cs: As you can see, public TestBase(int id = (int)ColegioEnum.ColegioDemoMovilidad2_Supervisor) receives an argument, which corresponds to the colegio environment I want to test. If no colegio is passed as an argument, the default one will be ColegioEnum.ColegioDemoMovilidad2_SupervisorHowever, when I try to instantiate TestContextin a TestClass, like this: The following error appears: An object reference is required for the non-static field, method, or propertyAny help is appreciated as I've given this problem a lot of time and I couldn't progress any further. <code>  <?xml version=""1.0"" encoding=""utf-8""?> <RunSettings> <TestRunParameters> <Parameter name=""colegio"" value=""7"" /> </TestRunParameters> using Microsoft.VisualStudio.TestTools.UnitTesting;using InfraestructureSelenium.Helper;using System.Collections.Generic;using InfraestructureSelenium.Configuration.Enumerados;namespace TestSelenium{ [DeploymentItem(""chromedriver.exe"")] [DeploymentItem(""IEDriverServer.exe"")] [DeploymentItem(""phantomjs.exe"")] [DeploymentItem(""geckodriver.exe"")] [TestClass] public class TestBase { protected TestBase() { } public TestBase(int id = (int)ColegioEnum.ColegioDemoMovilidad2_Supervisor) { DiccionarioCompartido = new Dictionary<string, string>(); SeleniumHelper = new HelperSelenium(id, WebDriverSelector.ObtenerWebDriver()); } public TestBase(HelperSelenium seleniumHelper, Dictionary<string, string> diccionarioCompartido = null) { SeleniumHelper = seleniumHelper; } public HelperSelenium SeleniumHelper { get; set; } public static Dictionary<string, string> DiccionarioCompartido { get; set; } public void CloseBrowser() { SeleniumHelper.Quit(); } #region Configuracin Test [TestInitialize] public void InitializeTest() { } [TestCleanup] public void TestCleanupTest() { SeleniumHelper.Quit(); } #endregion } } [TestClass] public class GenerarBoletinDeClase : TestBase { public TestContext TestContext { get; set; } private static TestContext _testContext; [TestInitialize] public static void SetupTests(TestContext testContext) { _testContext = testContext; } public GenerarBoletinDeClase() : base((int)TestContext.Properties[""colegio""]) { }",How to properly make use of TestContext.Properties
Why struct in array don't have to be initialized," I researched this subject but I couldn't find any duplicate. I am wondering why you can use a struct in an array without creating an instance of it.For example, I have a class and a struct: When ClassAPI is used in an array, it has to be initialized with the new keyword before being able to use its properties and methods: But this is not the case with StructAPI. It looks like StructAPI doesn't have to be initialized in the array: If you try the same thing with ClassAPI, you would get a NullReferenceException.Why is it different with structs when using them in an array?I understand the difference between class and struct with struct being a value type but that still doesn't make sense. To me, without the array being involved in this, it would look like I am doing this: Notice that the sp variable is not initialized and it should result in a compile-time error that says: Error CS0165 Use of unassigned local variable 'sp'but that's a different story when the struct is put in an array.Is the array initializing the struct in it? I would like to know what's going on. <code>  public class ClassAPI{ public Mesh mesh { get; set; }}public struct StructAPI{ public Mesh mesh { get; set; }} ClassAPI[] cAPI = new ClassAPI[1];cAPI[0] = new ClassAPI(); //MUST DO THIS!cAPI[0].mesh = new Mesh(); StructAPI[] sAPI = new StructAPI[1];sAPI[0].mesh = new Mesh(); StructAPI sp;sp.mesh = new Mesh();",Why doesn't a struct in an array have to be initialized?
Why is difference and why it work like this in Switch Case C#," I have two functions, one can be compiled and the other cannot. What is the difference?Does function number 1 assume that case 1 always will be hit, or it just a compiler problem? I tried of course searching for ""Declaring variables inside switch case in C#"", but to me it just seems like some sort of bug in C# now, preserved for backward compatibility.//After getting a warning that it was already answered, my question can now be reduced to what it is really about.Why: doesn't this work? <code>  public void Test(int x){ switch (x) { case 1: uint cId = (uint)3; break; case 2: cId = (uint)5; //NO ERROR HERE. WHY? break; }}public void DeclaringInsideSwitch(int x){ uint tst = 0; switch (x) { case 1: int y = 3; uint variable = tst; break; case 2: variable++; //ERROR HERE. WHY? break; }} int x;x++;",What is the difference and why does Switch Case work like this in C#?
Passing a List of objects to SQL Server Stored Procedure and retrieving an output value," I'm trying to pass list of objects and some other numbers and strings parameters to a SQL Server stored procedure using ado.net and execute it, and retrieve a value from an output parameter.To capture the list of objects from the SQL Server stored procedure, I used a user-defined table type as shown here:And this is the stored procedure: This is the C# code which calls the stored procedure. And below is the C# method which converts the contacts list to a data table. Now, when I run the code it does all the logic in stored procedure properly and completes all the changes I'm trying to do. I can see that data has been added via the stored procedure properly, but SaveAndPassToMailjetWindowsService methods throws an exception in the C# side (even though the stored procedure executed its logic properly). No mapping exists from object type System.Data.SqlClient.SqlParameter to a known managed provider native type.Any guidance to fix this is much appreciated. Thanks. <code>  ALTER PROCEDURE [dbo].[UpdateMailjetDetails] @listCode VARCHAR(1000), @listName VARCHAR(1000), @mailjetListId BIGINT, @mailjetListStatus INT, @autoAsync BIT, @contacts Contact READONLY, @companyId INT, @tblContactCompanyStatus INT, @espListContactStatus INT, @outputMessage VARCHAR(1000) OUTASBEGIN SET NOCOUNT ON; BEGIN TRANSACTION [Tran1] BEGIN TRY -- logic -- -- SET @outputMessage = 'success'; END TRY BEGIN CATCH ROLLBACK TRANSACTION [Tran1]; SELECT 'Error - Rollbacked -' AS CustomMessage, ERROR_NUMBER() AS ErrorNumber, ERROR_SEVERITY() AS ErrorSeverity, ERROR_STATE() AS ErrorState, ERROR_PROCEDURE() AS ErrorProcedure, ERROR_LINE() AS ErrorLine, ERROR_MESSAGE() AS ErrorMessage; SET @outputMessage = 'error - ' + ERROR_MESSAGE(); END CATCH END public string SaveAndPassToMailjetWindowsService(string listCode, string listName, long mailjetListId, MailjetListStatus mailjetListStatus, bool autoSync, List<Contact> contacts, int companyId, TblContactCompanyStatus tblContactCompanyStatus, EspListContactStatus espListContactStatus){ try { string result; var conString = GetMailCoreConnectionString(); using (var conn = new SqlConnection(conString)) { var command = new SqlCommand(""UpdateMailjetDetails"", conn) { CommandType = CommandType.StoredProcedure }; command.Parameters.Add(new SqlParameter(""@listCode"", listCode)); command.Parameters.Add(new SqlParameter(""@listName"", listName)); command.Parameters.Add(new SqlParameter(""@mailjetListId"", mailjetListId)); command.Parameters.Add(new SqlParameter(""@mailjetListStatus"", (int) mailjetListStatus)); command.Parameters.Add(new SqlParameter(""@autoAsync"", autoSync)); var contactsParam = new SqlParameter(""@contacts"", SqlDbType.Structured) { TypeName = ""dbo.Contact"", Value = GetSqlDataRecordsContactsList(contacts) }; command.Parameters.Add(new SqlParameter(""@contacts"", contactsParam)); command.Parameters.Add(new SqlParameter(""@companyId"", companyId)); command.Parameters.Add(new SqlParameter(""@tblContactCompanyStatus"", (int) tblContactCompanyStatus)); command.Parameters.Add(new SqlParameter(""@espListContactStatus"", (int) espListContactStatus)); var outputParameter = new SqlParameter { ParameterName = ""@outputMessage"", SqlDbType = SqlDbType.VarChar, Direction = ParameterDirection.Output }; command.Parameters.Add(outputParameter); conn.Open(); command.ExecuteNonQuery(); // throws exception result = outPutParameter.Value.ToString(); conn.Close(); } return result; } catch (Exception e) { Console.WriteLine(e); throw; }} private List<SqlDataRecord> GetSqlDataRecordsContactsList(List<Contact> contacts){ try { List<SqlDataRecord> datatable = new List<SqlDataRecord>(); SqlMetaData[] sqlMetaData = new SqlMetaData[5]; sqlMetaData[0] = new SqlMetaData(""Email"", SqlDbType.NVarChar, 512); sqlMetaData[1] = new SqlMetaData(""Name"", SqlDbType.NVarChar, 512); sqlMetaData[2] = new SqlMetaData(""TblContactId"", SqlDbType.BigInt); sqlMetaData[3] = new SqlMetaData(""CompanyId"", SqlDbType.Int); sqlMetaData[4] = new SqlMetaData(""TblContactCompanyId"", SqlDbType.BigInt); foreach (var contact in contacts) { SqlDataRecord row = new SqlDataRecord(sqlMetaData); row.SetValues(contact.Email, contact.Name, contact.TblContactId ?? (object) DBNull.Value, contact.CompanyId ?? (object) DBNull.Value, contact.TblContactCompanyId ?? (object) DBNull.Value); datatable.Add(row); } return datatable; } catch (Exception e) { Console.WriteLine(e); throw; }} command.ExecuteNonQuery(); ",Passing a List of objects to SQL Server stored procedure and retrieving an output value
"Why can the C# compiler ""see"" public properties, but not public methods, of a DLL that is not referenced?"," The premise of my question, in plain english:A library named Foo depends on a library named BarA class within Foo extends a class within BarFoo defines properties/methods that simply pass-through to BarAn application, FooBar, depends only on FooConsider the following sample: Foo is defined as follows Bar is defined as follows The part that is completely stumping me:Without a reference to the Bar libraryFooBar can retrieve the ID that is provided by Bar (or at least it compiles)FooBar cannot request Foo to do work that is ultimately accomplished by BarThe compiler error associated with foo.DoWorkOnBar(); is The type 'Bar' is defined in an assembly that is not referenced. You must add a reference to assembly 'Bar, Version 1.0.0.0, Culture=Neutral, PublicKeyToken=null' .Why does there appear to be a disparity in the compiler? I would have assumed that neither of these operations would compile without FooBar adding a reference to Bar. <code>  class Program{ static void Main(string[] args) { Foo foo = Foo.Instance; int id = foo.Id; // Compiler is happy foo.DoWorkOnBar(); // Compiler is not happy }} public class Foo : Bar{ public new static Foo Instance { get => (Foo)Bar.Instance; } public new int Id { get => Bar.Id; } public void DoWorkOnBar() { Instance.DoWork(); }} public class Bar{ public static Bar Instance { get => new Bar(); } public static int Id { get => 5; } public void DoWork() { }}","Why can the C# compiler ""see"" static properties, but not instance methods, of a class in a DLL that is not referenced?"
Can not close async TCP sever," I have a TCP server windows service developed in .net 4.0 with asynchronous server sockets.It works, but about 90 % of the time I simply can not stop it: after pressing stop button in Windows Service console, it hangs and stops after about a minute, but its process goes on and TCP communication continues. It hangs at _listener.Close(). Only thing I can do to close the communication is to restart Windows. There can be something with closing sockets. I tried to figure out but I simply can not find the root of the problem.Client side is not under my control, they are some 100 gadgets sending data via TCP.Here is my code (updated).Thanks a lot, any suggestions are highly appreciated! <code>  public class DeviceTCPServer{ public readonly IPAddress IPAddress; public readonly int Port; public readonly int InputBufferSize; public readonly ConcurrentDictionary<Guid, StateObject> Connections; public event EventHandler OnStarted; public event EventHandler OnStopped; public event ServerEventHandler OnConnected; public event ServerEventHandler OnDisconnected; public event RecievedEventHandler OnRecieved; public event DroppedEventHandler OnDropped; public event ExceptionEventHandler OnException; public event ServerLogEventHandler ServerLog; private volatile bool _iAmListening; private Socket _listener; private Thread _listenerThread; private readonly ManualResetEvent _allDone = new ManualResetEvent(false); public bool Listening { get { return _iAmListening; } } public DeviceTCPServer(IPAddress ipAddress, int port, int inputBufferSize) { IPAddress = ipAddress; Port = port; InputBufferSize = inputBufferSize; Connections = new ConcurrentDictionary<Guid, StateObject>(); } public void ThreadedStart() { _listenerThread = new Thread(Start) { CurrentUICulture = Thread.CurrentThread.CurrentUICulture, IsBackground = true }; _listenerThread.Start(); } private void Start() { try { var localEP = new IPEndPoint(IPAddress, Port); _listener = new Socket(localEP.Address.AddressFamily, SocketType.Stream, ProtocolType.Tcp); _listener.Bind(localEP); _listener.Listen(10000); if (OnStarted != null) OnStarted(this, new EventArgs()); _iAmListening = true; var listenerWithCultureInfo = new Tuple<Socket, CultureInfo>(_listener, Thread.CurrentThread.CurrentUICulture); while (_iAmListening) { _allDone.Reset(); _listener.BeginAccept(AcceptCallback, listenerWithCultureInfo); _allDone.WaitOne(); } } catch (Exception exc) { Debug.Assert(false, exc.Message); if (OnException != null) OnException(this, new ExceptionEventArgs(exc, ""Start"")); } } public void StopListening() { try { _iAmListening = false; _allDone.Set(); } catch(Exception exc) { Debug.Assert(false, exc.Message); if (OnException != null) OnException(this, new ExceptionEventArgs(exc, ""StopListening"")); } } public void Stop() { try { _listener.Close(0); CloseAllConnections(); _listenerThread.Abort(); } catch (Exception exc) { Debug.Assert(false, exc.Message); if (OnException != null) OnException(this, new ExceptionEventArgs(exc, ""Stop"")); } } private void AcceptCallback(IAsyncResult ar) { var arTuple = (Tuple<Socket, CultureInfo>)ar.AsyncState; var state = new StateObject(arTuple.Item2, InputBufferSize); try { Connections.AddOrUpdate(state.Guid, state, (k, v) => v); Thread.CurrentThread.CurrentUICulture = state.CurrentUICulture; var listener = arTuple.Item1; var handler = listener.EndAccept(ar); _allDone.Set(); if (!_iAmListening) return; state.WorkSocket = handler; handler.BeginReceive(state.Buffer, 0, state.InputBufferSize, 0, RecieveCallBack, state); if (OnConnected != null) OnConnected(this, new ServerEventArgs(state)); } catch(ObjectDisposedException) { _allDone.Set(); return; } catch (Exception exc) { Debug.Assert(false, exc.Message); if (OnException != null) OnException(this, new ExceptionEventArgs(exc, state, ""AcceptCallback"")); } } public void RecieveCallBack(IAsyncResult ar) { var state = (StateObject)ar.AsyncState; try { Thread.CurrentThread.CurrentUICulture = state.CurrentUICulture; var handler = state.WorkSocket; var read = handler.EndReceive(ar); var pBinayDataPocketCodecStore = new BinayDataPocketCodecStore(); if (read > 0) { state.LastDataReceive = DateTime.Now; var data = new byte[read]; Array.Copy(state.Buffer, 0, data, 0, read); state.AddBytesToInputDataCollector(data); //check, if pocket is complete var allData = state.InputDataCollector.ToArray(); var codecInitRes = pBinayDataPocketCodecStore.Check(allData); if (codecInitRes.Generic.Complete) { if (!codecInitRes.Generic.Drop) { if (OnRecieved != null) OnRecieved(this, new RecievedEventArgs(state, allData)); } else { if (OnDropped != null) OnDropped(this, new DroppedEventArgs(state, codecInitRes.Generic)); //get new data state.ResetInputDataCollector(); handler.BeginReceive(state.Buffer, 0, state.InputBufferSize, 0, RecieveCallBack, state); } } else { //get more data handler.BeginReceive(state.Buffer, 0, state.InputBufferSize, 0, RecieveCallBack, state); } } else { if ((handler.Connected == false) || (handler.Available == 0)) { Close(state); } } } catch (Exception exc) { Debug.Assert(false, exc.Message); if (OnException != null) OnException(this, new ExceptionEventArgs(exc, state, ""RecieveCallBack"")); } } public void Send(StateObject state, byte[] data) { try { var handler = state.WorkSocket; handler.BeginSend(data, 0, data.Length, 0, SendCallback, state); } catch (Exception exc) { Debug.Assert(false, exc.Message); if (OnException != null) OnException(this, new ExceptionEventArgs(exc, state, ""Send"")); } } private void SendCallback(IAsyncResult ar) { var state = (StateObject)ar.AsyncState; try { Thread.CurrentThread.CurrentUICulture = state.CurrentUICulture; var handler = state.WorkSocket; handler.EndSend(ar); handler.BeginReceive(state.Buffer, 0, state.InputBufferSize, 0, RecieveCallBack, state); } catch (Exception exc) { Debug.Assert(false, exc.Message); if (OnException != null) OnException(this, new ExceptionEventArgs(exc, state, ""SendCallback"")); } } public void Close(StateObject state) { try { if (state == null) return; var handler = state.WorkSocket; if (handler == null) return; if (!handler.Connected) return; if (handler.Available > 0) { var data = new byte[handler.Available]; handler.Receive(data); } handler.Shutdown(SocketShutdown.Both); handler.Close(0); if (OnDisconnected != null) OnDisconnected(this, new ServerEventArgs(state)); StateObject removed; var removeResult = Connections.TryRemove(state.Guid, out removed); } catch (Exception exc) { Debug.Assert(false, exc.Message); if (OnException != null) OnException(this, new ExceptionEventArgs(exc, ""Close"")); } } private void CloseAllConnections() { try { var connections = Connections.Select(c => c.Value); foreach(var connection in connections) { Close(connection); } } catch(Exception exc) { Debug.Assert(false, exc.Message); if (OnException != null) OnException(this, new ExceptionEventArgs(exc, ""CloseAllConnections"")); } } public override string ToString() { return string.Format(""{0}:{1}"", IPAddress, Port); }}",Can not stop async TCP sever Windows service
How to use IActionResult in .NET Framwork 4.6.1?," I have been searching around for an answer to this the last couple of hours without any success. Im relatively new to programming so please go easy on me :-)My problem is that it seems that I cant use IActionResult in one of my projects in my solution which is targeting .NET Framework 4.6.1 but in the same solution (different project) targeting .NET Standard 2.0 I can use it. I have tried to install exactly the same Nuget packages and everything looks exactly the same except for what framework that is targeted. I just want to write Azure Functions using IActionResults like: I'm guessing that my targeted framework is whats causing me to not be able to use IActionResult, but I don't understand why. Any help would be much appreciated, especially if one might know how to make this work.Thank you  <code>  public static async Task<IActionResult> MyFuntcion([HttpTrigger(AuthorizationLevel.Function, ""get"", Route = null"")]HttpRequest req, TraceWriter log) { //Do some stuff then redirect }",How to use IActionResult in .NET Framework 4.6.1?
Upload a file on ASP.NET WebApi with Swashbuckle Swagger," I have an ASP.NET Core 2 application with Swagger 3.0 and I would like to test POST action with file upload from Swagger UI. File uploader controller: Reading Swagger documentation and other topics I found that I need custom IOperationFilter, so this is what I came up with: It is registered in Swagger startup class: So, all the fields from IFormFile are gone and there is Upload File control instead so I can choose ""Try it out"" button, select a file, but after pressing ""Execute"" I'm getting following error:The web api itself does not crash and does not throw any error. What I noticed during debugging - the constructor of FileUploadController is reached but FileUpload method is not being triggered.  <code>  [ApiController]public class FileUploadController : ApiControllerBase{ private readonly IFileUploader _fileUploader; public FileUploadController(IFileUploader fileUploader, ILogger<FileUploadController> logger) : base(logger) { _fileUploader = fileUploader; } [HttpPost] [Route(nameof(UploadFile))] public FileUploadResult UploadFile(IFormFile uploadedFile) { return _FileUploader.UploadFile(Request.Form.Files[0]); }} public class FileUploadOperationFilter : IOperationFilter{ public void Apply(Operation operation, OperationFilterContext context) { if (operation.OperationId.ToLower() == ""apifileuploaduploadfilepost"") { operation.Parameters.Add(new NonBodyParameter() { Name = ""file"", In = ""formData"", Description = ""Upload File"", Required = true, Type = ""file"" }); operation.Consumes.Add(""multipart/form-data""); } }} options.OperationFilter<FileUploadOperationFilter>();",Upload a file on with Swashbuckle Swagger
Unity scripts are not loading after Update 2018.2.2f1, Yesterday I updated unity from unity5 to 2018.2.2f1. Unity scripts are not loading after Update 2018.2.2f1.Once I try to play the Scene the scripts are not loaded and I can't add the script again it gives this error: Can't add script component 'CubeScript' because the script class cannot be found. Make sure that there are no compile errors and that the file name and class name match. <code> ,Can't add script component because the script class cannot be found?
Why there is Console.Error() in C# but no Console.Warning in it?," In C#, if we want to output an error to the console, we can simply write: But when I try to write a warning to the console, I found that there isn't any: Instead, I need to write: Why is it designed this way? <code>  Console.Error.Write(""Error!""); Console.Warning.Write(""Warning!""); WarningException myEx = new WarningException(""This is a warning"");Console.Write(myEx.ToString());","Why is there Console.Error() in C#, but no Console.Warning?"
Why is there Console.Error() in C# but no Console.Warning?," In C#, if we want to output an error to the console, we can simply write: But when I try to write a warning to the console, I found that there isn't any: Instead, I need to write: Why is it designed this way? <code>  Console.Error.Write(""Error!""); Console.Warning.Write(""Warning!""); WarningException myEx = new WarningException(""This is a warning"");Console.Write(myEx.ToString());","Why is there Console.Error() in C#, but no Console.Warning?"
FluentNhibernate mapping of two tables and callback each other," I' m writing desktop Project in C#. I'm using Nhibernate to communicate with database. Moreover I use FluentNhibernate into mapping of models but I'm stuck in some part of mapping. Here is My mapping Class in ProductMapLoosing Map here is CurrencyMapCurrencyMap here is I have in my currency table one primary key and one unique key how I can refer in my LoosingMap class my unique instead of primary key ??? <code>  public LosingMap() { Id(x => x.id); Map(x => x.reason); Map(x => x.quantity); Map(x => x.lose_sum); Map(x => x.rate); Map(x => x.deleted); Map(x => x.create_date); Map(x => x.update_date); References(x => x.currency).Column(""CurrencyCode""); Table(""Loosing""); } } public CurrencyMap() { Id(x => x.id); Map(x => x.code).UniqueKey(""currency_code""); Map(x => x.name); Map(x => x.shname); Map(x => x.symbol); Map(x => x.deleted); HasMany(x => x.Losings).Cascade.All(); Table(""currency""); }}",FluentNhibernate mapping of two tables oneToMany using unique instea of primary key in mapping
FluentNhibernate mapping of two tables oneToMany and from Other table OneToOne," I' m writing desktop Project in C#. I'm using Nhibernate to communicate with database. Moreover I use FluentNhibernate into mapping of models but I'm stuck in some part of mapping. Here is My mapping Class in ProductMapLoosing Map here is CurrencyMapCurrencyMap here is I have in my currency table one primary key and one unique key how I can refer in my LoosingMap class my unique instead of primary key ??? <code>  public LosingMap() { Id(x => x.id); Map(x => x.reason); Map(x => x.quantity); Map(x => x.lose_sum); Map(x => x.rate); Map(x => x.deleted); Map(x => x.create_date); Map(x => x.update_date); References(x => x.currency).Column(""CurrencyCode""); Table(""Loosing""); } } public CurrencyMap() { Id(x => x.id); Map(x => x.code).UniqueKey(""currency_code""); Map(x => x.name); Map(x => x.shname); Map(x => x.symbol); Map(x => x.deleted); HasMany(x => x.Losings).Cascade.All(); Table(""currency""); }}",FluentNhibernate mapping of two tables oneToMany using unique instea of primary key in mapping
Strongly typed dataset (.xsd) error VS Comunity Edition 15.8.1," I updated my VS Community Edition to 15.8.1 and after that I got this error when I tried to edit my sql inside strongly typed dataset.  <code>  Configure TableAdapter failedUnable to find connection 'my_connection' for object 'Web.config'.The connection string could not be found in application settings, or the data provider associated with the connection string could not be loaded.""",Strongly typed dataset (.xsd) error VS Community Edition 15.8.1
How to validate salted password?," I used the below method to salt and hash the passwords So I get the fully encrypted password from the above, but now I can't login using the passwords that was entered in there. How can I unsalt the password when logging in? I figured I can just use the same method used to encrypt to unhash it but the salting doesn't return the same values.The below is the code on validation page <code>  public string CreateSalt(int size){ var rng = new System.Security.Cryptography.RNGCryptoServiceProvider(); var buff = new byte[size]; rng.GetBytes(buff); return Convert.ToBase64String(buff);}public string GenerateSHA256Hash(String input, String salt){ byte[] bytes = System.Text.Encoding.UTF8.GetBytes(input + salt); System.Security.Cryptography.SHA256Managed sha256hashstring = new System.Security.Cryptography.SHA256Managed(); byte[] hash = sha256hashstring.ComputeHash(bytes); return Convert.ToBase64String(hash);}public void Submit1_click(object sender, EventArgs r){ try { String salt = CreateSalt(10); String hashedpassword = GenerateSHA256Hash(password1.Text, salt); string MyConString = ""SERVER=localhost;DATABASE=mydb;UID=root;PASSWORD=abc123;""; MySqlConnection connection = new MySqlConnection(MyConString); string cmdText = ""INSERT INTO authentication(agentlogin ,password ,question ,answer)VALUES ( @login, @pwd, @question, @answer)""; MySqlCommand cmd = new MySqlCommand(cmdText, connection); cmd.Parameters.AddWithValue(""@login"", labeluname.Text); cmd.Parameters.AddWithValue(""@pwd"", hashedpassword); cmd.Parameters.AddWithValue(""@question"", ddlquestion.Text); cmd.Parameters.AddWithValue(""@answer"", txtanswer.Text); connection.Open(); int result = cmd.ExecuteNonQuery(); connection.Close(); lblmsg.Text = ""Registered succesfully""; lblmsg.ForeColor = System.Drawing.Color.Green; Response.Redirect(""index.aspx""); } catch (Exception) { Console.Write(""not entered""); lblmsg.Text = ""Registration failed!""; lblmsg.ForeColor = System.Drawing.Color.Red; Response.Redirect(""index.aspx""); }} public string GenerateSHA256Hash(String input) { byte[] bytes = System.Text.Encoding.UTF8.GetBytes(input); System.Security.Cryptography.SHA256Managed sha256hashstring = new System.Security.Cryptography.SHA256Managed(); byte[] hash = sha256hashstring.ComputeHash(bytes); return Convert.ToBase64String(hash); } public void Login_click(object sender, EventArgs r) { String hashedpassword = GenerateSHA256Hash(txtpassword.Text); string MyConString = ConfigurationManager.ConnectionStrings[""connStr""].ConnectionString; MySqlConnection con = new MySqlConnection(MyConString); MySqlCommand cmd = new MySqlCommand(""select * from authentication where agentlogin=@username and password=@word"", con); cmd.Parameters.AddWithValue(""@username"", txtusername.Text); cmd.Parameters.AddWithValue(""@word"", hashedpassword); MySqlDataAdapter sda = new MySqlDataAdapter(cmd); DataTable dt = new DataTable(); sda.Fill(dt); con.Open(); int i = cmd.ExecuteNonQuery(); con.Close(); if (dt.Rows.Count > 0) { Session[""id""] = txtusername.Text; Response.Redirect(""calendar.aspx""); Session.RemoveAll(); } else { lblmsg.Text = ""Credential doesn't match!""; lblmsg.ForeColor = System.Drawing.Color.Red; } }",How to validate salted and hashed password in c#
How exactly Microsoft.Extensions.Configuration dependent on ASP.net core? Does ASP.net(core) implements IConfiguration access to config values?," Does ASP.NET Core implement IConfiguration access to config values?Most likely my question arose because I don't understand what exactly ASP.NET Core is. Well, I know it's a web framework, Not sure, but looks like it is a namespace in .NET, or a package... I know in php, a framework could be a set of classes (a namespace) or compiled library which is provided as an extension so I presume a similar approach in .NET.Initially, I didn't intend to wrap my head around ASP.NET Core yet. I needed to store some config for my simple console C# application (VS Code and .NET Core). I've found a lot of topics (for example here: How to read values from config.json in Console Application) that to read JSON (recommended) config. Given that, I added three necessary nugget packages: I need to use: This returns an object that implements the IConfigurationRoot/IConfiguration interface. But all the examples are given in an ASP.NET Core context. I have a really simple app and I don't need any of ASP.NET functionality yet.So I've tried to access IConfigurationRoot without ASP.NET. The resulting object stores values from config file, but does not have all methods of its interface to access them.How to explain this in context of .NET namespaces? Does ASP.NET Core implement methods to access values from IConfiguration like Get<T>()?If Microsoft.Extensions.Configuration is part of or heavily dependent on Microsoft.AspNetCore.App, why is it in different namespace?If I add ASP.NET Core (NuGet package and namespaces), will it be an overkill?Maybe I should use soemthing other than ConfigurationBuilder to read JSON? <code>  using Microsoft.Extensions.Configuration;using Microsoft.Extensions.Configuration.FileExtensions;using Microsoft.Extensions.Configuration.Json; new ConfigurationBuilder() .SetBasePath(Directory.GetCurrentDirectory()) .AddJsonFile(""appsettings.json"").Build();",How exactly does Microsoft.Extensions.Configuration dependent on ASP.NET Core?
Serializing a list with IConvertible using Json.NET with the TypeNameHandling-flag," I have the following dictionary that I'd very much like to serialize using Json.Net. The dictionary contains items of the IConvertible interface allowing me to add whatever primitive type I need to the dictionary. I have the following implementation for serializing the list using Json.net: This gives me the following output: However. When trying to deserialize as such: ... I get the following error: I've looked around and found the following; but setting the typeNameHandling didn't solve it. Nor can I decorate the IConvertible value with a type name attribute seeing as it is a dictionary. Casting interfaces for deserialization in JSON.NETI haven't found any other information on the topic so some help would be greatly appreciated! I also found this solution but it involves creating a ExpandableObjectConverter which isn't a very elegant solution.Problems using JSON.NET with ExpandableObjectConverter <code>  var dic = new Dictionary<string, IConvertible>(); dic.Add(""bool2"", false); dic.Add(""int2"", 235); dic.Add(""string2"", ""hellohello""); var settings = new JsonSerializerSettings(); settings.TypeNameHandling = TypeNameHandling.Objects; var dicString = JsonConvert.SerializeObject(dic, Newtonsoft.Json.Formatting.Indented, settings); { ""$type"": ""System.Collections.Generic.Dictionary`2[[System.String, mscorlib],[System.IConvertible, mscorlib]], mscorlib"", ""bool2"": false, ""int2"": 235, ""string2"": ""hellohello"" } var dic2 = JsonConvert.DeserializeObject<Dictionary<string, IConvertible>>(dicString); Error converting value False to type 'System.IConvertible'. Path 'bool2', line 3, position 16.",Serializing a dictionary with IConvertible values using Json.NET with the TypeNameHandling-flag
c#: how to check parentheses validation," I want to be able to get string and check if the Parentheses are valid.For example: This is what I have tried: So in both cases my code will return true. Do you have any suggestions about what I need to add in order for the program to work correctly?  <code>  ""(ew)[]"" - this will be valid.""(ew[)]"" - this will be not valid. public static bool CheckString(string input){ int braceSum = 0, squareSum = 0, parenSum = 0; foreach (char c in input) { if (c == '{') braceSum++; if (c == '}') braceSum--; if (c == '[') squareSum++; if (c == ']') squareSum--; if (c == '(') parenSum++; if (c == ')') parenSum--; //check for negatives (pair closes before it opens) if (braceSum < 0 || squareSum < 0 || parenSum < 0) return false; } return (braceSum == 0 && squareSum == 0 && parenSum == 0);}",How to check parentheses validation
C# Difference between a List's Add and Append method?, Is there a difference between the .Append() and the .Add() method for lists in C#? I tried searching in Google and in the site but to my surprise no one asked it. My reason for asking is to know if one of the two methods are less performance intensive. I've been using the two methods interchangeably and I didn't see any differences to their function as they both added my object to the end of the list (and this is more or less the description visual studio gives you when you look at the method description).Edit:Hmmm I didn't think this mattered at first but I noticed I can use Append on an ASP.NET web application when I can't do that on a console application. So I was asking in the context of an ASP.NET Web App. <code> ,Difference between a List's Add and Append method?
C# - ASP.NET Difference between a List's Add and Append method?, Is there a difference between the .Append() and the .Add() method for lists in C#? I tried searching in Google and in the site but to my surprise no one asked it. My reason for asking is to know if one of the two methods are less performance intensive. I've been using the two methods interchangeably and I didn't see any differences to their function as they both added my object to the end of the list (and this is more or less the description visual studio gives you when you look at the method description).Edit:Hmmm I didn't think this mattered at first but I noticed I can use Append on an ASP.NET web application when I can't do that on a console application. So I was asking in the context of an ASP.NET Web App. <code> ,Difference between a List's Add and Append method?
send file and text pramiters using ajax on mvc," Check the jquery code below. Here, I am grabbing file from html and then post it by ajax call to my Controller Post method. And from Controller post method i am successfully receiving that file in variable called files as you can see. But my question is how can i send another two text parameters called- type and id from this ajax call then also how can i get that value from controller with that file? Basically i have to grab that file with those text value also. How is that possible? What change need in ajax and controller? Html: Jquery ajax: MVC .net core controller: <code>  <div class=""col-sm-3"" style=""float:left;""> <label class=""btn btn-outline-dark btn-block""> Browse... <span id=""uploaded-file-name"" style=""font-style: italic""></span> <input id=""file-upload"" type=""file"" name=""file"" onchange=""$('#uploaded-file-name').text($('#file-upload')[0].value);"" hidden> </label> </div> <div class=""col-sm-2"" style=""float:left;""> <button class=""btn btn-dark"" id=""start_upload"">Start Upload</button> </div> //file upload $(""#start_upload"").click(function (evt) { var fileUpload = $(""#file-upload"").get(0); var files = fileUpload.files; var data = new FormData(); for (var i = 0; i < files.length; i++) { data.append(files[i].name, files[i]); } $.ajax({ type: ""POST"", url: ""/Products/UploadFiles"", contentType: false, processData: false, data: data, success: function (message) { alert(message); }, error: function () { alert(""There was error uploading files!""); } }); }); [HttpPost]public IActionResult UploadFiles(){ //file upload process var files = Request.Form.Files; string type = """"; int id = ;}",send file and text parameters using ajax on mvc
Regex: match everything inside closest opening and closing curly braces around expression," It's a bit hard to explain what I really want (better title suggestions are appreciated so people can find this easily in the future).Suppose I have this: I want to match i.e. match everything from the last { before $myTagThing$ until the first } after $myTagThing$.So I thought I'd need this \{.*\$myTagThing\$.*\}, but it will also match the first { and last } in the string (i.e. the whole example). Then I tried using a lookahead and a lookbehind (both negative) \{(.*(?!\{))\$myTagThing\$.*(?<!\})\}(https://regex101.com/r/RfdHUH/1/). But this still doesn't work.My theory is that I might be using lookahead and lookbehind the wrong way since this is the first time I use them.Any ideas?EDIT: flags are \gms. <code>  { { $myTagThing$ }} { $myTagThing$} ",Regex: match everything inside closest opening and closing curly braces around expression while respecting the curly bracket hierarchy
.net Core 2.1 mvc Views in plugin," I have a problem that has tormented me for several days.As I do in a plugin in ASP .NET Core MVC to bring me views with the pluginI have this situationsolution:EVSControllers...Views...Pluginsthis folder contain a plugins dllother folders ...IPlugin.csProgram.csStartup.csfile IPlugin.cs file Program.cs file Startup.cs now let's take an example of pluginssolution:EVS.TestPluginControllersTestPluginController.csViewstest.cshtmlTestPlugin.csfile: TestPlugin.cs file: Controllers/TestPluginController.cs file : Views/test.cshtml Plugins are not included in the solution, but they are loaded dynamically depending whether they are in a folder solemnly for them.The problem:I can accordingly add controllers as(EVS.TestPlugin.PluginConfigureServices (...)) and MapRoute (EVS.TestPlugin.PluginConfigure (...))However, how could I also add the context of the views? Therefore it would be on:~/PluginName/Views/ViewName.cshatmlEDITI found this (link), but it's not really what I need. It partially solve the problem, because it only work if the view are compiled.EDIT 2Momentarily I solved it adding the views reference on to the plugins csproj, as follows: On the source project: This does not solve my problem because the .cshtml files come in clear in the plugin file, what I need is to be able to add the views from the assembly pluginname.views.dll or in some other way, the important that the views are compiledEDIT 3Good news, using ILSpy I parsed a PluginName.Views.dll file and I discovered that it implements RazorPage<object>With the following code I verified that I could initialize all the caches that cono RazorPage<object> which allows me to have the instances of the objects that create the view Solvedthanks to all I solved, there seems to be a problem with someone forgot to even put the razzor part factoryCompiledRazorAssemblyApplicationPartFactoryI solved that in addition I published a library that does everything efficientlyNETCore.Mvc.PluginsManager <code>  ...using McMaster.NETCore.Plugins;namespace EVS{ public interface IPlugin { string Name { get; } void Do(); void BootReg(); void BootExecute(); void PluginConfigure(IApplicationBuilder app, IHostingEnvironment env); void PluginConfigureServices(IServiceCollection services); } public class PluginsManager { public List<PluginLoader> PluginLoaders; public Dictionary<string, IPlugin> Plugins; public Dictionary<string, Assembly> Views; public List<String> dllFileNames; public PluginsManager() { PluginLoaders = new List<PluginLoader>(); Plugins = new Dictionary<string, IPlugin>(); dllFileNames = new List<string>(); string PloginDirectory= Path.Combine(AppContext.BaseDirectory, ""Plugins""); if (Directory.Exists(PloginDirectory)) dllFileNames.AddRange(Directory.GetFiles(PloginDirectory+""\\"", ""*.dll"")); foreach (string dllFile in dllFileNames) { if (!dllFile.Contains("".Views.dll"")) { var loader = PluginLoader.CreateFromAssemblyFile(dllFile,sharedTypes: new[] { typeof(IPlugin) }); PluginLoaders.Add(loader); } else { // // } } foreach (var loader in PluginLoaders) { foreach (IPlugin plugin in loader.LoadDefaultAssembly().GetTypes().Where(t => typeof(IPlugin).IsAssignableFrom(t) && !t.IsAbstract).Select((x)=> (IPlugin)Activator.CreateInstance(x))) if (!Plugins.ContainsKey(plugin.Name)) Plugins.Add(plugin.Name, plugin); } } }} namespace EVS{ public class Program { public static void Main(string[] args) { foreach (IPlugin plugin in Global.Static.PluginsManager.Plugins.Select((x) => x.Value)) plugin.BootReg(); CreateWebHostBuilder(args).Build().Run(); } public static IWebHostBuilder CreateWebHostBuilder(string[] args) => WebHost.CreateDefaultBuilder(args) .UseStartup<Startup>(); }} namespace EVS{ public class Startup { public Startup(IConfiguration configuration) { Configuration = configuration; } public IConfiguration Configuration { get; } public void ConfigureServices(IServiceCollection services) { services.Configure<CookiePolicyOptions>(options => { options.CheckConsentNeeded = context => true; options.MinimumSameSitePolicy = SameSiteMode.None; }); services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1); foreach (IPlugin plugin in Global.Static.PluginsManager.Plugins.Select((x) => x.Value)) { plugin.PluginConfigureServices(services); } } public void Configure(IApplicationBuilder app, IHostingEnvironment env) { if (env.IsDevelopment()) { app.UseDeveloperExceptionPage(); } else { app.UseExceptionHandler(""/Home/Error""); } app.UseStaticFiles(); app.UseCookiePolicy(); foreach (IPlugin plugin in Global.Static.PluginsManager.Plugins.Select((x) => x.Value)) { plugin.PluginConfigure(app,env); } app.UseMvc(routes => { routes.MapRoute( name: ""default"", template: ""{controller=Home}/{action=Index}/{id?}""); }); } }} namespace EVS.TestPlugin{ internal class TestPlugin : IPlugin { public string Name { get { return ""TestPlugin""; } } public void BootReg() { ... } public void BootExecute() { ... } public void Do() { } public void PluginConfigure(IApplicationBuilder app, IHostingEnvironment env) { app.UseMvc(routes => { routes.MapRoute(""TestPlugin"", ""TestPlugin/"", new { controller = ""TestPlugin"", action = ""index"" }); routes.MapRoute(""TestPlugint1"", ""TestPlugin/t1"", new { controller = ""TestPlugin"", action = ""t1"" }); }); } public void PluginConfigureServices(IServiceCollection services) { services.AddMvc().AddApplicationPart(typeof(TestPluginController).GetTypeInfo().Assembly).AddControllersAsServices(); } }} namespace EVS.TestPlugin.Controllers{ public class TestPluginController : Controller { public IActionResult Index() { return Content(""<h1>TestPluginController</h1>""); } public IActionResult t1() { return View(""test""); } }} @{ Layout = null;}`.cshtml` test view <ItemGroup> <EmbeddedResource Include=""Views\**\*.cshtml""/> <Content Remove=""Views\**\*.cshtml"" /></ItemGroup><PropertyGroup> <RazorCompileOnBuild>false</RazorCompileOnBuild></PropertyGroup> // p is a Instance of pluginforeach(IPlugin p in Plugins.Select((x) => x.Value)) services.Configure<RazorViewEngineOptions>(options => { options.FileProviders.Add( new EmbeddedFileProvider(p.GetType().GetTypeInfo().Assembly)); }); foreach (string dllview in Views.Select((x) => x.Key)){ PluginLoader loader = PluginLoader.CreateFromAssemblyFile(dllview, sharedTypes: new[] { typeof(RazorPage<object>) }); foreach (RazorPage<object> RazorP in loader.LoadDefaultAssembly().GetTypes().Where(t => typeof(RazorPage<object>).IsAssignableFrom(t)).Select((x) => (RazorPage<object>)Activator.CreateInstance(x))) { // i need a code for add a RazorPagein the in RazorViewEngine, or anywhere else that allows register in the context System.Diagnostics.Debug.WriteLine(RazorP.GetType().ToString()); /* - output AspNetCore.Views_test AspNetCore.Views_TestFolder_htmlpage as you can see is the folder structure - folder tree: Project plugin folder Views test.cshtml TestFolder htmlpage.cshtml */ }} var assembly = ...;services.AddMvc() .AddApplicationPart(assembly) services.AddMvc().ConfigureApplicationPartManager(apm => { foreach (var b in new CompiledRazorAssemblyApplicationPartFactory().GetApplicationParts(AssemblyLoadContext.Default.LoadFromAssemblyPath("".../ViewAssembypath/file.Views.dll""))) apm.ApplicationParts.Add(b); });",ASP .NET Core MVC 2.1 mvc Views in plugin
ASP .NET Core MVC 2.1 mvc Views in plugin," I have a problem that has tormented me for several days.As I do in a plugin in ASP .NET Core MVC to bring me views with the pluginI have this situationsolution:EVSControllers...Views...Pluginsthis folder contain a plugins dllother folders ...IPlugin.csProgram.csStartup.csfile IPlugin.cs file Program.cs file Startup.cs now let's take an example of pluginssolution:EVS.TestPluginControllersTestPluginController.csViewstest.cshtmlTestPlugin.csfile: TestPlugin.cs file: Controllers/TestPluginController.cs file : Views/test.cshtml Plugins are not included in the solution, but they are loaded dynamically depending whether they are in a folder solemnly for them.The problem:I can accordingly add controllers as(EVS.TestPlugin.PluginConfigureServices (...)) and MapRoute (EVS.TestPlugin.PluginConfigure (...))However, how could I also add the context of the views? Therefore it would be on:~/PluginName/Views/ViewName.cshatmlEDITI found this (link), but it's not really what I need. It partially solve the problem, because it only work if the view are compiled.EDIT 2Momentarily I solved it adding the views reference on to the plugins csproj, as follows: On the source project: This does not solve my problem because the .cshtml files come in clear in the plugin file, what I need is to be able to add the views from the assembly pluginname.views.dll or in some other way, the important that the views are compiledEDIT 3Good news, using ILSpy I parsed a PluginName.Views.dll file and I discovered that it implements RazorPage<object>With the following code I verified that I could initialize all the caches that cono RazorPage<object> which allows me to have the instances of the objects that create the view Solvedthanks to all I solved, there seems to be a problem with someone forgot to even put the razzor part factoryCompiledRazorAssemblyApplicationPartFactoryI solved that in addition I published a library that does everything efficientlyNETCore.Mvc.PluginsManager <code>  ...using McMaster.NETCore.Plugins;namespace EVS{ public interface IPlugin { string Name { get; } void Do(); void BootReg(); void BootExecute(); void PluginConfigure(IApplicationBuilder app, IHostingEnvironment env); void PluginConfigureServices(IServiceCollection services); } public class PluginsManager { public List<PluginLoader> PluginLoaders; public Dictionary<string, IPlugin> Plugins; public Dictionary<string, Assembly> Views; public List<String> dllFileNames; public PluginsManager() { PluginLoaders = new List<PluginLoader>(); Plugins = new Dictionary<string, IPlugin>(); dllFileNames = new List<string>(); string PloginDirectory= Path.Combine(AppContext.BaseDirectory, ""Plugins""); if (Directory.Exists(PloginDirectory)) dllFileNames.AddRange(Directory.GetFiles(PloginDirectory+""\\"", ""*.dll"")); foreach (string dllFile in dllFileNames) { if (!dllFile.Contains("".Views.dll"")) { var loader = PluginLoader.CreateFromAssemblyFile(dllFile,sharedTypes: new[] { typeof(IPlugin) }); PluginLoaders.Add(loader); } else { // // } } foreach (var loader in PluginLoaders) { foreach (IPlugin plugin in loader.LoadDefaultAssembly().GetTypes().Where(t => typeof(IPlugin).IsAssignableFrom(t) && !t.IsAbstract).Select((x)=> (IPlugin)Activator.CreateInstance(x))) if (!Plugins.ContainsKey(plugin.Name)) Plugins.Add(plugin.Name, plugin); } } }} namespace EVS{ public class Program { public static void Main(string[] args) { foreach (IPlugin plugin in Global.Static.PluginsManager.Plugins.Select((x) => x.Value)) plugin.BootReg(); CreateWebHostBuilder(args).Build().Run(); } public static IWebHostBuilder CreateWebHostBuilder(string[] args) => WebHost.CreateDefaultBuilder(args) .UseStartup<Startup>(); }} namespace EVS{ public class Startup { public Startup(IConfiguration configuration) { Configuration = configuration; } public IConfiguration Configuration { get; } public void ConfigureServices(IServiceCollection services) { services.Configure<CookiePolicyOptions>(options => { options.CheckConsentNeeded = context => true; options.MinimumSameSitePolicy = SameSiteMode.None; }); services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1); foreach (IPlugin plugin in Global.Static.PluginsManager.Plugins.Select((x) => x.Value)) { plugin.PluginConfigureServices(services); } } public void Configure(IApplicationBuilder app, IHostingEnvironment env) { if (env.IsDevelopment()) { app.UseDeveloperExceptionPage(); } else { app.UseExceptionHandler(""/Home/Error""); } app.UseStaticFiles(); app.UseCookiePolicy(); foreach (IPlugin plugin in Global.Static.PluginsManager.Plugins.Select((x) => x.Value)) { plugin.PluginConfigure(app,env); } app.UseMvc(routes => { routes.MapRoute( name: ""default"", template: ""{controller=Home}/{action=Index}/{id?}""); }); } }} namespace EVS.TestPlugin{ internal class TestPlugin : IPlugin { public string Name { get { return ""TestPlugin""; } } public void BootReg() { ... } public void BootExecute() { ... } public void Do() { } public void PluginConfigure(IApplicationBuilder app, IHostingEnvironment env) { app.UseMvc(routes => { routes.MapRoute(""TestPlugin"", ""TestPlugin/"", new { controller = ""TestPlugin"", action = ""index"" }); routes.MapRoute(""TestPlugint1"", ""TestPlugin/t1"", new { controller = ""TestPlugin"", action = ""t1"" }); }); } public void PluginConfigureServices(IServiceCollection services) { services.AddMvc().AddApplicationPart(typeof(TestPluginController).GetTypeInfo().Assembly).AddControllersAsServices(); } }} namespace EVS.TestPlugin.Controllers{ public class TestPluginController : Controller { public IActionResult Index() { return Content(""<h1>TestPluginController</h1>""); } public IActionResult t1() { return View(""test""); } }} @{ Layout = null;}`.cshtml` test view <ItemGroup> <EmbeddedResource Include=""Views\**\*.cshtml""/> <Content Remove=""Views\**\*.cshtml"" /></ItemGroup><PropertyGroup> <RazorCompileOnBuild>false</RazorCompileOnBuild></PropertyGroup> // p is a Instance of pluginforeach(IPlugin p in Plugins.Select((x) => x.Value)) services.Configure<RazorViewEngineOptions>(options => { options.FileProviders.Add( new EmbeddedFileProvider(p.GetType().GetTypeInfo().Assembly)); }); foreach (string dllview in Views.Select((x) => x.Key)){ PluginLoader loader = PluginLoader.CreateFromAssemblyFile(dllview, sharedTypes: new[] { typeof(RazorPage<object>) }); foreach (RazorPage<object> RazorP in loader.LoadDefaultAssembly().GetTypes().Where(t => typeof(RazorPage<object>).IsAssignableFrom(t)).Select((x) => (RazorPage<object>)Activator.CreateInstance(x))) { // i need a code for add a RazorPagein the in RazorViewEngine, or anywhere else that allows register in the context System.Diagnostics.Debug.WriteLine(RazorP.GetType().ToString()); /* - output AspNetCore.Views_test AspNetCore.Views_TestFolder_htmlpage as you can see is the folder structure - folder tree: Project plugin folder Views test.cshtml TestFolder htmlpage.cshtml */ }} var assembly = ...;services.AddMvc() .AddApplicationPart(assembly) services.AddMvc().ConfigureApplicationPartManager(apm => { foreach (var b in new CompiledRazorAssemblyApplicationPartFactory().GetApplicationParts(AssemblyLoadContext.Default.LoadFromAssemblyPath("".../ViewAssembypath/file.Views.dll""))) apm.ApplicationParts.Add(b); });",ASP .NET Core MVC 2.1 mvc Views in plugin
ASP .NET Core MVC 2.1 mvc Views in plugin [SOLVED]," I have a problem that has tormented me for several days.As I do in a plugin in ASP .NET Core MVC to bring me views with the pluginI have this situationsolution:EVSControllers...Views...Pluginsthis folder contain a plugins dllother folders ...IPlugin.csProgram.csStartup.csfile IPlugin.cs file Program.cs file Startup.cs now let's take an example of pluginssolution:EVS.TestPluginControllersTestPluginController.csViewstest.cshtmlTestPlugin.csfile: TestPlugin.cs file: Controllers/TestPluginController.cs file : Views/test.cshtml Plugins are not included in the solution, but they are loaded dynamically depending whether they are in a folder solemnly for them.The problem:I can accordingly add controllers as(EVS.TestPlugin.PluginConfigureServices (...)) and MapRoute (EVS.TestPlugin.PluginConfigure (...))However, how could I also add the context of the views? Therefore it would be on:~/PluginName/Views/ViewName.cshatmlEDITI found this (link), but it's not really what I need. It partially solve the problem, because it only work if the view are compiled.EDIT 2Momentarily I solved it adding the views reference on to the plugins csproj, as follows: On the source project: This does not solve my problem because the .cshtml files come in clear in the plugin file, what I need is to be able to add the views from the assembly pluginname.views.dll or in some other way, the important that the views are compiledEDIT 3Good news, using ILSpy I parsed a PluginName.Views.dll file and I discovered that it implements RazorPage<object>With the following code I verified that I could initialize all the caches that cono RazorPage<object> which allows me to have the instances of the objects that create the view Solvedthanks to all I solved, there seems to be a problem with someone forgot to even put the razzor part factoryCompiledRazorAssemblyApplicationPartFactoryI solved that in addition I published a library that does everything efficientlyNETCore.Mvc.PluginsManager <code>  ...using McMaster.NETCore.Plugins;namespace EVS{ public interface IPlugin { string Name { get; } void Do(); void BootReg(); void BootExecute(); void PluginConfigure(IApplicationBuilder app, IHostingEnvironment env); void PluginConfigureServices(IServiceCollection services); } public class PluginsManager { public List<PluginLoader> PluginLoaders; public Dictionary<string, IPlugin> Plugins; public Dictionary<string, Assembly> Views; public List<String> dllFileNames; public PluginsManager() { PluginLoaders = new List<PluginLoader>(); Plugins = new Dictionary<string, IPlugin>(); dllFileNames = new List<string>(); string PloginDirectory= Path.Combine(AppContext.BaseDirectory, ""Plugins""); if (Directory.Exists(PloginDirectory)) dllFileNames.AddRange(Directory.GetFiles(PloginDirectory+""\\"", ""*.dll"")); foreach (string dllFile in dllFileNames) { if (!dllFile.Contains("".Views.dll"")) { var loader = PluginLoader.CreateFromAssemblyFile(dllFile,sharedTypes: new[] { typeof(IPlugin) }); PluginLoaders.Add(loader); } else { // // } } foreach (var loader in PluginLoaders) { foreach (IPlugin plugin in loader.LoadDefaultAssembly().GetTypes().Where(t => typeof(IPlugin).IsAssignableFrom(t) && !t.IsAbstract).Select((x)=> (IPlugin)Activator.CreateInstance(x))) if (!Plugins.ContainsKey(plugin.Name)) Plugins.Add(plugin.Name, plugin); } } }} namespace EVS{ public class Program { public static void Main(string[] args) { foreach (IPlugin plugin in Global.Static.PluginsManager.Plugins.Select((x) => x.Value)) plugin.BootReg(); CreateWebHostBuilder(args).Build().Run(); } public static IWebHostBuilder CreateWebHostBuilder(string[] args) => WebHost.CreateDefaultBuilder(args) .UseStartup<Startup>(); }} namespace EVS{ public class Startup { public Startup(IConfiguration configuration) { Configuration = configuration; } public IConfiguration Configuration { get; } public void ConfigureServices(IServiceCollection services) { services.Configure<CookiePolicyOptions>(options => { options.CheckConsentNeeded = context => true; options.MinimumSameSitePolicy = SameSiteMode.None; }); services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1); foreach (IPlugin plugin in Global.Static.PluginsManager.Plugins.Select((x) => x.Value)) { plugin.PluginConfigureServices(services); } } public void Configure(IApplicationBuilder app, IHostingEnvironment env) { if (env.IsDevelopment()) { app.UseDeveloperExceptionPage(); } else { app.UseExceptionHandler(""/Home/Error""); } app.UseStaticFiles(); app.UseCookiePolicy(); foreach (IPlugin plugin in Global.Static.PluginsManager.Plugins.Select((x) => x.Value)) { plugin.PluginConfigure(app,env); } app.UseMvc(routes => { routes.MapRoute( name: ""default"", template: ""{controller=Home}/{action=Index}/{id?}""); }); } }} namespace EVS.TestPlugin{ internal class TestPlugin : IPlugin { public string Name { get { return ""TestPlugin""; } } public void BootReg() { ... } public void BootExecute() { ... } public void Do() { } public void PluginConfigure(IApplicationBuilder app, IHostingEnvironment env) { app.UseMvc(routes => { routes.MapRoute(""TestPlugin"", ""TestPlugin/"", new { controller = ""TestPlugin"", action = ""index"" }); routes.MapRoute(""TestPlugint1"", ""TestPlugin/t1"", new { controller = ""TestPlugin"", action = ""t1"" }); }); } public void PluginConfigureServices(IServiceCollection services) { services.AddMvc().AddApplicationPart(typeof(TestPluginController).GetTypeInfo().Assembly).AddControllersAsServices(); } }} namespace EVS.TestPlugin.Controllers{ public class TestPluginController : Controller { public IActionResult Index() { return Content(""<h1>TestPluginController</h1>""); } public IActionResult t1() { return View(""test""); } }} @{ Layout = null;}`.cshtml` test view <ItemGroup> <EmbeddedResource Include=""Views\**\*.cshtml""/> <Content Remove=""Views\**\*.cshtml"" /></ItemGroup><PropertyGroup> <RazorCompileOnBuild>false</RazorCompileOnBuild></PropertyGroup> // p is a Instance of pluginforeach(IPlugin p in Plugins.Select((x) => x.Value)) services.Configure<RazorViewEngineOptions>(options => { options.FileProviders.Add( new EmbeddedFileProvider(p.GetType().GetTypeInfo().Assembly)); }); foreach (string dllview in Views.Select((x) => x.Key)){ PluginLoader loader = PluginLoader.CreateFromAssemblyFile(dllview, sharedTypes: new[] { typeof(RazorPage<object>) }); foreach (RazorPage<object> RazorP in loader.LoadDefaultAssembly().GetTypes().Where(t => typeof(RazorPage<object>).IsAssignableFrom(t)).Select((x) => (RazorPage<object>)Activator.CreateInstance(x))) { // i need a code for add a RazorPagein the in RazorViewEngine, or anywhere else that allows register in the context System.Diagnostics.Debug.WriteLine(RazorP.GetType().ToString()); /* - output AspNetCore.Views_test AspNetCore.Views_TestFolder_htmlpage as you can see is the folder structure - folder tree: Project plugin folder Views test.cshtml TestFolder htmlpage.cshtml */ }} var assembly = ...;services.AddMvc() .AddApplicationPart(assembly) services.AddMvc().ConfigureApplicationPartManager(apm => { foreach (var b in new CompiledRazorAssemblyApplicationPartFactory().GetApplicationParts(AssemblyLoadContext.Default.LoadFromAssemblyPath("".../ViewAssembypath/file.Views.dll""))) apm.ApplicationParts.Add(b); });",ASP .NET Core MVC 2.1 mvc Views in plugin
Is this Unit Test Necessary," I have a unit test which is intended to check the access right and also make sure there is enough access right to file system before constructing a class. But, I think my unit test is violating the unit testing principle (FIRST) such as: Isolated/Independent and Thorough which are talking about building an independent unit test and also considering several aspects of failure scenarios. I also believe that this unit test in the way that is implemented is unit testing the .Net framework not the functionality of the code written by me because the underlying class is not mocked. But I would like to know your opinions as well and see how wrong or right I am.Explanation of the Unit Test:The unit test is trying to make sure that the constructor of EventFeedFile is executing a method which is checking the access rights. That method called VerifyWritable(). Note that the EventFeedFile is a separate class and the VerifyWritable() is seating in another class. <code>  [Test]public void DirectoryNotWritableTest(){ var tempPath = Path.Combine(Path.GetTempPath(), ""EventFileDirectoryWriteDeniedTest""); int pageSize = 10; try { if (Directory.Exists(tempPath)) Directory.Delete(tempPath, true); var directoryInfo = Directory.CreateDirectory(tempPath); var securityRules = directoryInfo.GetAccessControl(); var writeDeniedRule = new FileSystemAccessRule(""Everyone"", FileSystemRights.CreateFiles, AccessControlType.Deny); securityRules.AddAccessRule(writeDeniedRule); directoryInfo.SetAccessControl(securityRules); // ReSharper disable once ObjectCreationAsStatement Assert.Throws<UnauthorizedAccessException>(() => new EventFeedFile(new PersistenceDirectory(tempPath), pageSize)); } finally { if (Directory.Exists(tempPath)) Directory.Delete(tempPath, true); }}/// <param name=""directory"">The directory containing the persistence file.</param>/// <param name=""pageSize"">The size of event feed page.</param>public EventFeedFile(PersistenceDirectory directory, int pageSize){ directory.EnsureExists(); directory.VerifyWritable(); mParentDirectory = directory.TargetPath; mFullName = Path.Combine(mParentDirectory, Constants.FILE_NAME_EVENTPERSISTENCE); mPageSize = pageSize;}public void VerifyWritable(){ using (File.Create( Path.Combine(TargetPath, Path.GetRandomFileName()), 1024, FileOptions.DeleteOnClose)) { }}",Is this Unit Test implemented correctly?
c# BaseClass with instance counter," I have a base class and several derived classes (for example Base and ChildA : Base). Each time I create an instance of ChildA class, I want it to be assigned a unique instance number (similar to autoincrement IDs in relational databases, but for my classes in memory as opposed to in a database).My question is similar to this one, but there is one distinct difference: I would like the base class to handle this automatically. For each of my derived classes (ChildA, ChildB, ChildC, etc.), I would like the base class to maintain a separate count and increment this when a new instance of that derived class is created.So, the information held in my Base class might end up looking like this: If I then instantiate a new ChildB (var instance = new ChildB();), I would expect ChildB to be assigned the id 7, since it follows on from 6.Then, if I instantiate a new ChildA, I would expect ChildA to be assigned the id 6.-How can I handle this within the constructor of my Base class? <code>  ChildA,5ChildB,6ChildC,9",BaseClass with instance counter
Timer Tick not increasing values on time interval asp.net c#," I want to increase values on timer tick event but it is not increasing don't know what I am forgetting it is showing only 1. <code>  <asp:Timer ID=""Timer1"" runat=""server"" OnTick=""Timer1_Tick"" Interval=""1000""></asp:Timer>private int i = 0;protected void Timer1_Tick(object sender, EventArgs e){ i++; Label3.Text = i.ToString();}",Timer Tick not increasing values on time interval
Flip the path that draws the text/string," I have this method in my Text Class and I can't seem to flip the whole text.I am using a Matrix to transform the GraphicsPath which is used to draw the string.Here's the code since I used @Jimi's answer: Now the problem is, it goes out the center of the picturebox. <code>  public LayerClass DrawString(LayerClass.Type _text, string text, RectangleF rect, Font _fontStyle, Brush brush, float angle, PaintEventArgs e) { using (StringFormat string_format = new StringFormat()) { SizeF stringSize = e.Graphics.MeasureString(text, _fontStyle); rect.Location = new PointF(Shape.center.X - (rect.Width / 2), Shape.center.Y - (rect.Height / 2)); GraphicsContainer gc = e.Graphics.BeginContainer(); e.Graphics.SmoothingMode = SmoothingMode.AntiAlias; e.Graphics.CompositingQuality = CompositingQuality.HighQuality; //e.Graphics.DrawRectangle(Pens.Red, Rectangle.Round(rect)); RectangleF r = new RectangleF(rect.Location, rect.Size); GraphicsPath path = new GraphicsPath(); if (text == """" || text == "" "") path.Dispose(); //Disposes the path to prevent OutOfMemoryExcetption else { path.AddString(text, _fontStyle.FontFamily, Convert.ToInt32(_fontStyle.Style), _fontStyle.Height, new Point(0,0), string_format); RectangleF text_rectf = path.GetBounds(); PointF[] target_pts = { new PointF(r.Left, r.Top), new PointF(r.Right, r.Top), new PointF(r.Left, r.Bottom)}; //e.Graphics.DrawRectangle(Pens.Red, Rectangle.Round(r)); using (Matrix m = new Matrix(text_rectf, target_pts)) using (Matrix rotate = new Matrix()) using (Matrix FlipXMatrix = new Matrix(-1, 0, 0, 1, 0, 0)) using (Matrix FlipYMatrix = new Matrix(1, 0, 0, -1, 0, 0)) using (Matrix TransformMatrix = new Matrix()) { TransformMatrix.Multiply(m); m.RotateAt(angle, new PointF(0 + (stringSize.Width / 2), +(r.Height * 2))); rotate.RotateAt(angle, new PointF(r.X, r.Y)); TransformMatrix.Multiply(rotate); if (flipped) { TransformMatrix.Multiply(FlipXMatrix); } path.Transform(TransformMatrix); if (flipY) { TransformMatrix.Multiply(FlipYMatrix); path.Transform(TransformMatrix); } //Checks if the user wants the text filled or outlined if (!isOutlined) e.Graphics.FillPath(Brushes.Red, path); else e.Graphics.DrawPath(Pens.Red, path); } } e.Graphics.EndContainer(gc); } this._Text = text; this._TextRect = rect; this.brush = brush; this._Angle = angle; return new LayerClass(_text, this, text, rect); }",Flip the GraphicsPath that draws the text/string
Random Selenium E2e Tests Fail on Azure DevOps but work locally and with remote Selenium (BrowserStack Automate)," I've got a suite of Selenium tests that work perfectly in my local environment and using Browserstack Automate, but fail on Azure DevOps. There are no configuration or setting changes when running on Azure Devops.We've followed all the documentation here: https://docs.microsoft.com/en-us/azure/devops/pipelines/test/continuous-test-selenium?view=vstsRandom tests fail, never the same ones. The tests always fail because of timeouts. I wait for the pages to load for 5 minutes so it's not a case of the timeouts being too low. There are no firewalls in place, the application is public.Authentication always succeeds so the tests are able to load the application.Not sure what to try next.Below is a copy of the Azure DevOps log. 4 tests passed but all the other's failed. Usually, only 4-5 tests fail.This tests works perfectly using BrowserStack Automate (remote selenium) and locally. <code>  2018-11-17T05:40:28.6300135Z Failed StripeAdmin_WhenOnTab_DefaultSortIsByIdDescending2018-11-17T05:40:28.6300461Z Error Message:2018-11-17T05:40:28.6304198Z Test method CS.Portal.E2e.Tests.Admin.StripeAdmin.StripeAdminTests.StripeAdmin_WhenOnTab_DefaultSortIsByIdDescending threw exception: 2018-11-17T05:40:28.6305677Z OpenQA.Selenium.WebDriverTimeoutException: Timed out after 300 seconds2018-11-17T05:40:28.6307041Z Stack Trace:2018-11-17T05:40:28.6307166Z at OpenQA.Selenium.Support.UI.DefaultWait`1.ThrowTimeoutException(String exceptionMessage, Exception lastException)2018-11-17T05:40:28.6307999Z at OpenQA.Selenium.Support.UI.DefaultWait`1.Until[TResult](Func`2 condition)2018-11-17T05:40:28.6308188Z at CS.Portal.E2e.Tests.Utility.WebDriverUtilities.WaitForElement(IWebDriver driver, By by, Boolean mustBeDisplayed) in D:\a\1\s\CS.Portal.E2e.Tests\Utility\WebDriverUtilities.cs:line 262018-11-17T05:40:28.6319651Z at CS.Portal.E2e.Tests.Admin.StripeAdmin.StripeAdminTests.StripeAdmin_WhenOnTab_DefaultSortIsByIdDescending() in D:\a\1\s\CS.Portal.E2e.Tests\Admin\StripeAdmin\StripeAdminTests.cs:line 512018-11-17T05:40:28.6319982Z 2018-11-17T05:40:34.4671568Z Results File: D:\a\1\s\TestResults\VssAdministrator_factoryvm-az416_2018-11-17_03_08_24.trx2018-11-17T05:40:34.4692222Z 2018-11-17T05:40:34.4695222Z Attachments:2018-11-17T05:40:34.4697610Z D:\a\1\s\TestResults\672f4d28-5082-42e9-a7e7-f5645aadcfd8\VssAdministrator_factoryvm-az416 2018-11-17 03_02_43.coverage2018-11-17T05:40:34.4697943Z 2018-11-17T05:40:34.4698278Z Total tests: 34. Passed: 4. Failed: 30. Skipped: 0.",Random Selenium E2e Tests Fail because of timeouts on Azure DevOps but work locally and with remote Selenium (BrowserStack Automate)
HTTPClient and JWT Authetication in C#," I'm having a hard time trying to use authorization in C# Winforms. My purpose is to access the API. I already get the access token but when I try to pass it to the header, it returns an error: HTTP error 400.My code: <code>  using (var httpClient = new HttpClient()){ var url = @""https://acerportal.com/v1/414232363/status/device/""; httpClient.BaseAddress = new Uri(url); httpClient.DefaultRequestHeaders.Accept.Clear(); httpClient.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue(""application/json"")); httpClient.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue(""Basic"", accessToken); var response = await httpClient.GetStringAsync(url); string checkResult = response.ToString(); MessageBox.Show(checkResult);}",HTTPClient and JWT Authentication in C#
Why a property inherited from interface became virtual?," Say I have one interface and two classes, and one of the classes implement this interface: In class AAA2, property F1 is 'inherited' (I'm not sure) from interface IAAA, then I use reflection to check whether a property is virtual: The output is: Any reason for this? <code>  interface IAAA{ int F1 { get; set; }}class AAA1{ public int F1 { get; set; } public int F2 { get; set; }}class AAA2 : IAAA{ public int F1 { get; set; } public int F2 { get; set; }} Console.WriteLine(""AAA1 which does not implement IAAA"");foreach (var prop in typeof(AAA1).GetProperties()){ var virtualOrNot = prop.GetGetMethod().IsVirtual ? """" : "" not""; Console.WriteLine($@""{prop.Name} is{virtualOrNot} virtual"");}Console.WriteLine(""AAA2 which implements IAAA"");foreach (var prop in typeof(AAA2).GetProperties()){ var virtualOrNot = prop.GetGetMethod().IsVirtual ? """" : "" not""; Console.WriteLine($""{prop.Name} is{virtualOrNot} virtual"");} AAA1 which does not implement IAAAF1 is not virtualF2 is not virtualAAA2 which implements IAAAF1 is virtualF2 is not virtual",Why does a property inherited from an interface become virtual?
How to remove the square brackets in child rows of a json from sql server 2016?," I have a problem with the ouput for a query like this: The resulting of that is like this: The problem is when i deserialize that in C# with Newtonsoft, the square brackets in ""NivelAcceso"" and ""Estatus"" can't be parse because Newtonsoft thinks is an Array.My C# classes are this: Actually I'm using something like this: Anybody can help me how to deserialize that? <code>  SELECT Users.Id, Users.FbId, Users.Email, Users.Nombre, (SELECT * FROM AccessLevel WHERE AccessLevel.Id = Users.NivelAcceso FOR JSON PATH) AS NivelAcceso, (SELECT * FROM UserStatus WHERE UserStatus.Id = Users.Estatus FOR JSON PATH) AS EstatusFROM Users WHERE Users.Id = 1 FOR JSON AUTO, WITHOUT_ARRAY_WRAPPER; { ""Id"": 1, ""Email"": ""some@email.com"", ""NivelAcceso"": [ { ""Id"": 1, ""Clave"": ""Usuario"" } ], ""Estatus"": [ { ""Id"": 1, ""Estatus"": ""Activo"" } ]} public class AccessLevel{ [JsonProperty(PropertyName = ""Id"")] public int Id { get; set; } [JsonProperty(PropertyName = ""Clave"")] public string Clave { get; set; } [JsonProperty(PropertyName = ""Descripcion"")] public string Descripcion { get; set; }}public class UserStatus{ [JsonProperty(PropertyName = ""Id"")] public int Id { get; set; } [JsonProperty(PropertyName = ""Estatus"")] public string Estatus { get; set; } [JsonProperty(PropertyName = ""Descripcion"")] public string Descripcion { get; set; }}public class Users{ public long Id { get; set; } public string Email { get; set; } [JsonProperty(PropertyName = ""NivelAcceso"")] public AccessLevel NivelAcceso { get; set; } [JsonProperty(PropertyName = ""Estatus"")] public UserStatus Estatus { get; set; }} Users data = JsonConvert.DeserializeObject<Users>(_dataReader[0].ToString().Replace('[', '\0').Replace(']', '\0'));",How to remove the square brackets in child rows of a json from SQL Server 2016?
Re-enable title bar in VS 2019 (Preview)," I've downloaded the preview version of Visual Studio 2019 and the title bar is disabled by default.This doesn't work for me as I currently develop C# applications using multiple instances of visual studio at a time, and I like knowing what window relates to which solution, and whether I am running with elevated privileges. I've found that I can re-enable the title bar by going to the 'Preview Features' section in options, but this will obviously not be in the real release of Visual Studio 2019. I've searched online, but have only found feature requests to not remove the title bar.Is there currently any way to re-enable the title bar in VS 2019 (that is not related to the preview features option)?  <code> ",Re-enable title bar in Visual Studio 2019
What is going on with Task.Delay()?," I'm confused why Task.Delay().Wait() takes 4x more time, then Thread.Sleep()? E.g. task-00 was running on only thread 9 and took 2193ms?I'm aware, that sync wait is bad in tasks, because the whole thread being blocked. It is just for test.Simple test in console application: With Task.Delay().Wait():task-03 ThrID: 05, Wait=300ms, START: 184mstask-04 ThrID: 07, Wait=100ms, START: 184mstask-00 ThrID: 09, Wait=100ms, START: 0mstask-06 ThrID: 04, Wait=100ms, START: 185mstask-01 ThrID: 08, Wait=300ms, START: 183mstask-05 ThrID: 03, Wait=300ms, START: 185mstask-02 ThrID: 06, Wait=100ms, START: 184mstask-07 ThrID: 10, Wait=300ms, START: 209mstask-07 ThrID: 10, Wait=300ms, END: 1189mstask-08 ThrID: 12, Wait=100ms, START: 226mstask-09 ThrID: 10, Wait=300ms, START: 226mstask-09 ThrID: 10, Wait=300ms, END: 2192mstask-06 ThrID: 04, Wait=100ms, END: 2193mstask-08 ThrID: 12, Wait=100ms, END: 2194mstask-05 ThrID: 03, Wait=300ms, END: 2193mstask-03 ThrID: 05, Wait=300ms, END: 2193mstask-00 ThrID: 09, Wait=100ms, END: 2193mstask-02 ThrID: 06, Wait=100ms, END: 2193mstask-04 ThrID: 07, Wait=100ms, END: 2193mstask-01 ThrID: 08, Wait=300ms, END: 2193ms With Thread.Sleep():task-00 ThrID: 03, Wait=100ms, START: 0mstask-03 ThrID: 09, Wait=300ms, START: 179mstask-02 ThrID: 06, Wait=100ms, START: 178mstask-04 ThrID: 08, Wait=100ms, START: 179mstask-05 ThrID: 04, Wait=300ms, START: 179mstask-06 ThrID: 07, Wait=100ms, START: 184mstask-01 ThrID: 05, Wait=300ms, START: 178mstask-07 ThrID: 10, Wait=300ms, START: 184mstask-00 ThrID: 03, Wait=100ms, END: 284mstask-08 ThrID: 03, Wait=100ms, START: 184mstask-02 ThrID: 06, Wait=100ms, END: 285mstask-09 ThrID: 06, Wait=300ms, START: 184mstask-04 ThrID: 08, Wait=100ms, END: 286mstask-06 ThrID: 07, Wait=100ms, END: 293mstask-08 ThrID: 03, Wait=100ms, END: 385mstask-03 ThrID: 09, Wait=300ms, END: 485mstask-05 ThrID: 04, Wait=300ms, END: 486mstask-01 ThrID: 05, Wait=300ms, END: 493mstask-07 ThrID: 10, Wait=300ms, END: 494mstask-09 ThrID: 06, Wait=300ms, END: 586ms Edit:With async lambda and await Task.Delay() is as fast as Thread.Sleep(), may be also faster (511ms).Edit 2:With ThreadPool.SetMinThreads(16, 16); Task.Delay().Wait() works as fast as Thread.Sleep for 10 iteration in the loop. With more iterations it's slower again. It's also interesting, that if without adjusting I increase the number of iterations for Thread.Sleep to 30, it's still faster, then 10 iteration with Task.Delay().Wait()Edit 3:The overloading Task.Delay(wait).Wait(wait) works as fast as Thread.Sleep() <code>  bool flag = true;var sw = Stopwatch.StartNew();for (int i = 0; i < 10; i++){ var cntr = i; { var start = sw.ElapsedMilliseconds; var wait = flag ? 100 : 300; flag = !flag; Task.Run(() => { Console.WriteLine($""task-{cntr.ToString(""00"")} \t ThrID: {Thread.CurrentThread.ManagedThreadId.ToString(""00"")},\t Wait={wait}ms, \t START: {start}ms""); //Thread.Sleep(wait); Task.Delay(wait).Wait(); Console.WriteLine($""task-{cntr.ToString(""00"")} \t ThrID: {Thread.CurrentThread.ManagedThreadId.ToString(""00"")},\t Wait={wait}ms, \t END: {sw.ElapsedMilliseconds}ms""); ; }); }}Console.ReadKey();return;",What is going on with Task.Delay().Wait()?
Entity framework core 2.1 - owned types and nested value objects," I'm learning DDD and the tutorial I'm currently following is implemented using NHibernate, but since my lack of experience with it I've decided to go through the course using EF Core 2.1. However, I'm currently a bit stuck with the following: I have three classes Customer which is an entity and two value objects (CustomerStatus and inside of it value object ExpirationDate) - like this: When I try to do the following inside of my DbContext: I'm getting the following error: The expression 'x => x.ExpirationDate.Date' is not a valid property expression. The expression should represent a simple property access: 't => t.MyProperty'. Parameter name: propertyAccessExpression'Beside this I've tried doing things like: But it also leads to: The expression 'x => x.Status.ExpirationDate' is not a valid property expression. The expression should represent a simple property access: 't => t.MyProperty'.I've also tried: But with no luck as well... Anyways, any help would be greatly appreciated, also if possible it would be really great if someone could explain why none of my tries are not working? Thanks in advance! UPDATEAfter doing as stated in Ivan's comment first I was getting error about CustomerStatus class constructor so I've added default protected one. After that I started getting error: Field 'k__BackingField' of entity type 'CustomerStatus' is readonly and so cannot be set.Here's inner of my CustomerStatus class if it helps: UPDATEAll it took was adding private setters on Type and ExpirationDate properties inside of CustomerStatus class and in combination with Ivan's answer it works like a charm. Thanks a lot! <code>  public class Customer : Entity{ //... constructor, other properties and behavior omitted for the sake of simplicity public CustomerStatus Status { get; set; }}public class CustomerStatus : ValueObject<CustomerStatus>{ // customer status is enum containing two values (Regular,Advanced) public CustomerStatusType Type { get; } public ExpirationDate ExpirationDate { get; }}public class ExpirationDate : ValueObject<ExpirationDate>{ //... constructor, other properties and behavior omitted for the sake of simplicity public DateTime? Date { get; private set; }} modelBuilder.Entity<Customer>(table =>{ table.OwnsOne(x => x.Status, name => { name.Property(x => x.ExpirationDate.Date).HasColumnName(""StatusExpirationDate""); name.Property(x => x.Type).HasColumnName(""Status""); });}); table.OwnsOne(x => x.Status.ExpirationDate, name => { name.Property(x => x.Date).HasColumnName(""StatusExpirationDate""); }); table.OwnsOne(x => x.Status, name => { name.Property(x => x.Type).HasColumnName(""Status""); }); modelBuilder.Entity<Customer>() .OwnsOne(p => p.Status, cb => cb.OwnsOne(c => c.ExpirationDate)); public class CustomerStatus : ValueObject<CustomerStatus>{ public CustomerStatusType Type { get; } public ExpirationDate ExpirationDate { get; } public static readonly CustomerStatus Regular = new CustomerStatus(CustomerStatusType.Regular, ExpirationDate.Infinite); public bool IsAdvanced => Type == CustomerStatusType.Advanced && !ExpirationDate.IsExpired; private CustomerStatus(CustomerStatusType type, ExpirationDate expirationDate) { Type = type; ExpirationDate = expirationDate; } protected CustomerStatus() { } public static CustomerStatus Create(CustomerStatusType type, ExpirationDate expirationDate) { return new CustomerStatus(type, expirationDate); } public CustomerStatus Promote() { return new CustomerStatus(CustomerStatusType.Advanced, ExpirationDate.Create(DateTime.UtcNow.AddYears(1)).Value); } protected override bool EqualsCore(CustomerStatus other) { return Type == other.Type && ExpirationDate == other.ExpirationDate; } protected override int GetHashCodeCore() { return Type.GetHashCode() ^ ExpirationDate.GetHashCode(); }}",Entity Framework Core 2.1 - owned types and nested value objects
.NET Core FromSql InvalidOperationException," I have a simple model and in my DbContext and in my controller Which is returning the error: InvalidOperationException: The required column 'InterfaceID' was not present in the results of a 'FromSql' operation.I am using FromSql in other methods similar to this with no issue although those models do contain an InterfaceId. Why does this operation expect an InterfaceId when it is not in the model. I have also tried the below with the same result. I have also tried: After declaring via the fluent api: with the same result.For clarity here is the table in MSSQL: UPDATEI've looked at the SQL that EF is generating: Where is it getting InterfaceID from? <code>  [Table(""InterfaceType"")]public class InterfaceType{ [Key] public int InterfaceTypeId { get; set; } public string Description { get; set; }} public DbSet<InterfaceType> InterfaceTypes { get; set; } List<InterfaceType> types = _context.InterfaceTypes.FromSql( ""SELECT * FROM [Interfaces].[Control].[InterfaceType]"").ToList(); List<InterfaceType> types = _context.InterfaceTypes.FromSql( ""SELECT InterfaceTypeId, Description FROM [Interfaces].[Control].[InterfaceType]"").ToList(); interfacesOverview.SelectedInterface.InterfaceTypes = _context.InterfaceTypes.ToList(); protected override void OnModelCreating(ModelBuilder modelBuilder) { modelBuilder.Entity<InterfaceType>().ToTable(""InterfaceType"", ""Control""); } CREATE TABLE [Control].[InterfaceType]( [InterfaceTypeId] [tinyint] NOT NULL, [Description] [varchar](25) NULL, CONSTRAINT [PK_InterfaceType] PRIMARY KEY CLUSTERED ( [InterfaceTypeId] ASC)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]) ON [PRIMARY] SELECT [i].[InterfaceTypeId], [i].[Description], [i].[InterfaceID] FROM [Control].[InterfaceType] AS [i]",.NET Core Entity Framework InvalidOperationException
.NET Core InvalidOperationException," I have a simple model and in my DbContext and in my controller Which is returning the error: InvalidOperationException: The required column 'InterfaceID' was not present in the results of a 'FromSql' operation.I am using FromSql in other methods similar to this with no issue although those models do contain an InterfaceId. Why does this operation expect an InterfaceId when it is not in the model. I have also tried the below with the same result. I have also tried: After declaring via the fluent api: with the same result.For clarity here is the table in MSSQL: UPDATEI've looked at the SQL that EF is generating: Where is it getting InterfaceID from? <code>  [Table(""InterfaceType"")]public class InterfaceType{ [Key] public int InterfaceTypeId { get; set; } public string Description { get; set; }} public DbSet<InterfaceType> InterfaceTypes { get; set; } List<InterfaceType> types = _context.InterfaceTypes.FromSql( ""SELECT * FROM [Interfaces].[Control].[InterfaceType]"").ToList(); List<InterfaceType> types = _context.InterfaceTypes.FromSql( ""SELECT InterfaceTypeId, Description FROM [Interfaces].[Control].[InterfaceType]"").ToList(); interfacesOverview.SelectedInterface.InterfaceTypes = _context.InterfaceTypes.ToList(); protected override void OnModelCreating(ModelBuilder modelBuilder) { modelBuilder.Entity<InterfaceType>().ToTable(""InterfaceType"", ""Control""); } CREATE TABLE [Control].[InterfaceType]( [InterfaceTypeId] [tinyint] NOT NULL, [Description] [varchar](25) NULL, CONSTRAINT [PK_InterfaceType] PRIMARY KEY CLUSTERED ( [InterfaceTypeId] ASC)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]) ON [PRIMARY] SELECT [i].[InterfaceTypeId], [i].[Description], [i].[InterfaceID] FROM [Control].[InterfaceType] AS [i]",.NET Core Entity Framework InvalidOperationException
How can I use Microsoft.Extensions.DependencyInjection in an .Net Core Console app?," I have a library that I would like to run on all platforms supported by .NET Core (Xamarin, Windows, Mac). And to do this I need to have a cross platform DI to handle the platform specific customizations such as storage, security, etc.All of the examples I've seen for Microsoft.Extensions.DependencyInjection include code for ASP.NET Core. Does any equivalent / supported scenario exist for a console app?Alternatively (ideally) I would like the DI framework used for the console to work for ASP.NET Core, Xamarin, and Win32Error ExampleI'm using this code as the basis for my .NET Core application. It appears that ServiceCollection should be public, but when I use Xamarin on the Mac the default implementation of IServiceCollection (ServiceCollection) is missing: <code> ",How can I use Microsoft.Extensions.DependencyInjection in an .NET Core console app?
How to make a Windows Service from .Net Core 2.1/2.2," Recently I had a need to convert a .NET Core 2.1 or 2.2 console application into a Windows Service.As I didn't have a requirement to port this process to Linux, I could dispense with the multiple platform solutions that I had seen on StackOverflow that dealt with any combination of .NET Framework, .NET Standard and .NET Core. <code> ",How to make a Windows Service from .NET Core 2.1/2.2
Visual Studio remote debugging application hosted on Linux - unable to enumerate running instances of the coreclr in the specific process," I'm trying to debug remotely an application that's being hosted on Linux ""Debian GNU/Linux 8 (jessie)""with.NET Command Line Tools (2.1.500)I'm connecting via Visual Studio via SSHand I've tried both modes:Managed .NET Core for UnixNative (GDB)Project has been compiled on Windows and also and works perfectly fine, but for some reason I'm receiving:Managed .NET Core for Unix: Fail to attach to process: Unable to enumerate running instances of the CoreCLR in the specific processAnd if that's relevant (probably not, because other people use Managed .NET Core for Unix for that)Native (GDB):Unable to start debugging. Unable to estabilish a connection to GDB. Debug output may containt more informationdebug information: In Visual Studio process is listed as: Anybody has an idea what can cause that?You can see how people do that with Raspberry Pi here:https://youtu.be/ySzTCl-H10w?t=955 <code>  dotnet publish --configuration Release -r linux-x64 dotnet publish --configuration Debug -r linux-x64 Starting unix command: 'gdb --interpreter=mi'bash: gdb: command not foundgdb --interpreter=mi exited with code 127. Process: MyProjectNameTitle: /home/deploy/app/MyProjectName StartUpArgument",Visual Studio remote debugging application hosted on Linux - unable to enumerate running instances of the CoreCLR in the specific process
C# Allow Cors Origin," I am using Microsoft.ApsNetCore.Cors 2.2""Access to XMLHttpRequest at 'exampleapi.local' from origin 'example.local' has been blocked by CORS policy:No 'Access-Control-Allow-Origin' header is present on the requested resource.""I set the settings with this: But It doesn't work, always I got the same error <code>  public void ConfigureServices(IServiceCollection services){ services.AddCors(options => { options.AddPolicy(""AllowSpecificOrigin"", builder => { builder .AllowAnyOrigin() .AllowAnyMethod() .AllowAnyHeader(); }); }); services.Configure<TokenSettings>(this.Configuration.GetSection(""Tokens"")); services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme) .AddJwtBearer(opt => { opt.TokenValidationParameters = new TokenValidationParameters { ValidateIssuer = true, ValidateAudience = true, ValidateLifetime = true, ValidateIssuerSigningKey = true, ValidIssuer = Configuration[""Tokens:Issuer""], ValidAudience = Configuration[""Tokens:Audience""], IssuerSigningKey = new SymmetricSecurityKey(Encoding.ASCII.GetBytes(Configuration[""Tokens:SecurityKey""])) }; }); services.AddMvc(); services.Configure<LdapConfig>(Configuration.GetSection(""ldap"")); services.AddScoped<ILdapAuthenticationService, LdapAuthenticationService>(); services.AddScoped<IUserService, UserService>(); services.AddScoped<IProjectService, ProjectService>(); services.AddScoped<IProjectMembersService, ProjectMembersService>(); services.AddScoped<IJourneyUsersService, JourneyUsersService>(); services.AddScoped<IProjectRolesService, ProjectRolesService>(); services.AddScoped<IPmoGuardianService, PmoGuardianService>(); services.AddScoped<IHolidaysService, HolidaysService>(); services.AddScoped<IMailService, MailService>(); services.AddScoped<INotificationsService, NotificationsService>(); services.AddScoped<INotificationUsersService, NotificationUsersService>(); services.Configure<AWSConfigSes>(Configuration.GetSection(""AWSSmtp"")); services.AddDbContext<JourneyContext>(options => options.UseSqlServer(Configuration.GetConnectionString(""JourneyConnection""))); services.AddDbContext<TSMContext>(options => options.UseSqlServer(Configuration.GetConnectionString(""TSMConnection""))); services.AddDbContext<PmoGuardianContext>(options => options.UseSqlServer(Configuration.GetConnectionString(""PmoGuardianConnection"")));}public void Configure(IApplicationBuilder app, IHostingEnvironment env, IMailService mail, INotificationsService not){ if (env.IsDevelopment()) { app.UseDeveloperExceptionPage(); } Recurrence recurrency = Recurrence.GetInstance(not); //new TSMClockService(mail); app.UseCors(""AllowSpecificOrigin""); app.UseAuthentication(); app.UseMvc();}[Produces(""application/json"")][Route(""api/Mail"")][EnableCors(""AllowSpecificOrigin"")]",Allow Cors Origin in ASP.NET Core
How to download the latest build artifacts from Azure DevOops?, I have a .NET C# application and I would like to download the latest artifacts generated by the latest build of this public Azure DevOps project:https://dev.azure.com/LumiaWoA/Boot%20Shim/_build?definitionId=3How does one interface with Azure DevOps to download the artifacts for such a task? I have in mind to use an HttpClient to download the zipped artifacts using some special URL. <code> ,How to download the latest build artifacts from Azure DevOps programmatically?
How to download the latest build artifacts from Azure DevOps?, I have a .NET C# application and I would like to download the latest artifacts generated by the latest build of this public Azure DevOps project:https://dev.azure.com/LumiaWoA/Boot%20Shim/_build?definitionId=3How does one interface with Azure DevOps to download the artifacts for such a task? I have in mind to use an HttpClient to download the zipped artifacts using some special URL. <code> ,How to download the latest build artifacts from Azure DevOps programmatically?
Is safe calling StateHasChanged() from an arbitrary thread?," Is it safe to call StateHasChanged() from an arbitrary thread?Let me give you some context. Imagine a Server-side Blazor/Razor Components application where you have:A singleton service NewsProvider that raises BreakingNews events from an arbitrary thread.A component News.cshtml that gets the service injected and subscribes to BreakingNews event. When the event is raised, the component updates the model and calls StateHashChanged()NewsProvider.cs News.cshtml Startup.cs it apparently works, but I don't know if StateHasChanged() is thread safe. If it isn't, how can I call StateHashChanged() safely?. Is there something similar to Control.BeginInvoke? Should I use SyncrhonizationContext.Post? <code>  using System;using System.Threading;namespace BlazorServer.App{ public class BreakingNewsEventArgs: EventArgs { public readonly string News; public BreakingNewsEventArgs(string news) { this.News = news; } } public interface INewsProvider { event EventHandler<BreakingNewsEventArgs> BreakingNews; } public class NewsProvider : INewsProvider, IDisposable { private int n = 0; public event EventHandler<BreakingNewsEventArgs> BreakingNews; private Timer timer; public NewsProvider() { timer = new Timer(BroadCastBreakingNews, null, 10, 2000); } void BroadCastBreakingNews(object state) { BreakingNews?.Invoke(this, new BreakingNewsEventArgs(""Noticia "" + ++n)); } public void Dispose() { timer.Dispose(); } }} @page ""/news""@inject INewsProvider NewsProvider@implements IDisposable<h1>News</h1>@foreach (var n in this.news){ <p>@n</p>}@functions { EventHandler<BreakingNewsEventArgs> breakingNewsEventHandler; List<string> news = new List<string>(); protected override void OnInit() { base.OnInit(); breakingNewsEventHandler = new EventHandler<BreakingNewsEventArgs>(OnBreakingNews); this.NewsProvider.BreakingNews += breakingNewsEventHandler; } void OnBreakingNews(object sender, BreakingNewsEventArgs e) { this.news.Add(e.News); StateHasChanged(); } public void Dispose() { this.NewsProvider.BreakingNews -= breakingNewsEventHandler; }} using Microsoft.AspNetCore.Blazor.Builder;using Microsoft.Extensions.DependencyInjection;using BlazorServer.App.Services;namespace BlazorServer.App{ public class Startup { public void ConfigureServices(IServiceCollection services) { // Since Blazor is running on the server, we can use an application service // to read the forecast data. services.AddSingleton<WeatherForecastService>(); services.AddSingleton<INewsProvider, NewsProvider>(); } public void Configure(IBlazorApplicationBuilder app) { app.AddComponent<App>(""app""); } }}",Is it safe to call StateHasChanged() from an arbitrary thread?
Why aren't Implicitly Property Names allowed in an array of anonymous types?," Why isn't this allowed? When I try to compile, I get: CS0826: No best type found for implicitly-typed arrayFeels a bit counter-intuitive, because with a regular anonymous type I can do this: <code>  int A = 5, B = 10, X = 5, Y = 5;var array = new[] { new { A, B }, new { X, Y } }; int X = 5, Y = 5;var point = new { X, Y };",Why are implicit property names not allowed in an array of anonymous types?
SmtpClient.SendMailAsync methog is hanging when sending a big amount of mails," I am trying to send a lot of emails to using SmtpClient.SendMailAsync method.Here is my test method that I call from the simple console application. Sometimes the method is hanging - it awaits to SendMailAsync which seems stuck and doesn't return.I see one related question SmtpClient SendMailAsync sometimes never returns .But there is no fix suggested that works for me.When I tried to use the synchronous method SmtpClient.Send everything is OK and application never hangs.Does anybody have any idea what is wrong? <code>  static void Main(string[] args) { SendMailsOnebyOneAsync().GetAwaiter().GetResult(); } public static async Task SendMailsOnebyOneAsync() { for (int i = 0; i < 1000; i++) { try { using (SmtpClient sMail = new SmtpClient(""XXX"")) { sMail.DeliveryMethod = SmtpDeliveryMethod.Network; sMail.UseDefaultCredentials = false; sMail.Credentials = null; var fromMailAddress = new MailAddress(""XXX""); var toMailAddress = new MailAddress(""XXX""); MailMessage message = new MailMessage(fromMailAddress, toMailAddress) { Subject = ""test"" }; await sMail.SendMailAsync(message); Console.WriteLine(""Sent {0}"", i); } } catch (Exception e) { Console.WriteLine(e.Message); } } }",SmtpClient.SendMailAsync method is hanging when sending a big amount of mails
Roslyn recommended symbols don't include keywords or aliases," I am using Roslyn to create a C# scripting control with IntelliSense.I am generally very happy with the results I am getting, however, the recommended symbols don't include keywords such as for and if et cetera and also don't contain type aliases such as int, when it includes Int32.More specifically, I am using Microsoft.CodeAnalysis.Recommendations, that is: My SemanticModel object is obtained from a C# compilation which always has a reference to mscorlib.dll at the very least.At all positions in my script, the recommended completions are always correct. However, I would argue that they are incomplete if they are missing keywords such as if, else and for etc.I can see that it would be easy for me to include common type aliases in my IntelliSense manually. That is, if Int32 is a possible completion, then I could manually add int.However, it is less obvious when an if statement or a for statement or even is/as would be appropriate in the given scope.Is there a way to include these keywords when getting the recommended symbols this way?Is there also a way to automatically include type aliases? <code>  Recommender.GetRecommendedSymbolsAtPositionAsync(mySemanticModel, scriptPosition, myAdhocWorkspace);",How to include keywords and aliases in Roslyn recommended symbols?
EntityFramework Core DbContext.RemoveRange and type constraints," This code throws an exception System.InvalidOperationException: The entity type 'List<..>' was not found. Ensure that the entity type has been added to the model. However, if you add the type constraint where T: class no exception is thrown. Why is this? I was under the impression C# type constraints didn't affect run time behavior like this. Both versions compile fine.  <code>  private static void Update<T>(DbContext context, ICollection<T> existing, ICollection<T> updated) // where T: class{ context.RemoveRange(existing); updated.ToList().ForEach(existing.Add);}",Entity Framework Core DbContext.RemoveRange and type constraints
reading a string from one char to another in C#," I have the following string: FB:77:CB:0B:EC:09{W: 0,623413, X: 0,015374, Y: 0,005306, Z: -0,781723}I want to read out the values of W,X,Y,Z as a float/decimal. The values are not always the same length.How can I read this string from one character to another without using relative positions?  <code> ",Reading a string from one char to another
"C# 8 non-nullable string type, how to use with Asp.Net Core options"," MS states Express your design intent more clearly with nullable and non-nullable reference types. My intent is to express, that properties Issuer and Audience in my JwtOptions are never null. Which is very reasonable intent for consumers of these options, is not? These not null values are ensured by Asp.Net Core validation described below. But if JwtOptions has not all properties initialized by the constructor, so C# 8 compiler reports Warning CS8618 Non-nullable property 'Issuer' is uninitialized. And for some technical reasons, Asp.Net Core options cannot have a constructor with parameters. So I am stuck with my intent. I can switch nullable checking off or declare Issuer and other properties nullable, but I think this is not the best solution. Is there any elegant solution in this case?Snippet from csproj: I have these strongly typed options in Asp.Net Core application: Options are configured by a next code in Startup.cs: and consumed by HomeController: As you can see, nor Audience nor Issuer cannot be null for the consumer. Make these properties nullable makes no sense. <code>  <PropertyGroup> <TargetFramework>netcoreapp2.2</TargetFramework> <AspNetCoreHostingModel>InProcess</AspNetCoreHostingModel> <LangVersion>8.0</LangVersion> <Nullable>enable</Nullable></PropertyGroup> public class JwtOptions{ [Required] public string Issuer { get; set; } [Required] public string Audience { get; set; }} public void ConfigureServices(IServiceCollection services) { services.AddMvc(); services.AddOptions<JwtOptions>() .Bind(Configuration.GetSection(""JwtOption"")) .ValidateDataAnnotations(); } public HomeController(IOptions<JwtOptions> options) { string audience = options.Value.Audience; string issuer = options.Value.Issuer; }","Non-nullable string type, how to use with Asp.Net Core options"
Get handle to message box," I am working on trying to close a specific MessageBox if it shows up based on the caption and text. I have it working when the MessageBox doesn't have an icon. The above code works just fine when the MessageBox is shown without an icon like the following. However, if it includes an icon (from MessageBoxIcon) like the following, it doesn't work; GetWindowTextLength returns 0 and nothing happens. My best guess is that the 3rd and/or 4th paramters of FindWindowEx need to change but I'm not sure what to pass instead. Or maybe the 2nd parameter needs to change to skip the icon? I'm not really sure. <code>  IntPtr handle = FindWindowByCaption(IntPtr.Zero, ""Caption"");if (handle == IntPtr.Zero) return;//Get the Text window handleIntPtr txtHandle = FindWindowEx(handle, IntPtr.Zero, ""Static"", null);int len = GetWindowTextLength(txtHandle);//Get the textStringBuilder sb = new StringBuilder(len + 1);GetWindowText(txtHandle, sb, len + 1);//close the messageboxif (sb.ToString() == ""Original message""){ SendMessage(new HandleRef(null, handle), WM_CLOSE, IntPtr.Zero, IntPtr.Zero);} MessageBox.Show(""Original message"", ""Caption""); MessageBox.Show(""Original message"", ""Caption"", MessageBoxButtons.OK, MessageBoxIcon.Information);",How to get the text of a MessageBox when it has an icon?
What is Range and Index types in c# 8?," In C# 8, two new types are added to the System namespace: System.Index and System.Range.How do they work and when can we use them? <code> ",What are Range and Index types in C# 8?
Use dependency injection in static class in net core 2.2," I need to use Dependency Injection in a static class.the method in the static class needs the value of an injected dependency.The following code sample demonstrates my problem: <code>  public static class XHelper{ public static TResponse Execute(string metodo, TRequest request) { // How do I retrieve the IConfiguracion dependency here? IConfiguracion x = ...; // The dependency gives access to the value I need string y = x.apiUrl; return xxx; }}",Use dependency injection in static class
Use dependency injection in static class in .NET Core," I need to use Dependency Injection in a static class.the method in the static class needs the value of an injected dependency.The following code sample demonstrates my problem: <code>  public static class XHelper{ public static TResponse Execute(string metodo, TRequest request) { // How do I retrieve the IConfiguracion dependency here? IConfiguracion x = ...; // The dependency gives access to the value I need string y = x.apiUrl; return xxx; }}",Use dependency injection in static class
ASP.NET core routing wanting to get 405 instead of 404," I am trying to get 405 errors when a valid route is supplied but the HTTP method is not found. Currently, the application returns 404s as it requires both the route and method to match on the function (expected behaviour in MVC). In this example, if I do a DELETE or PUT request it won't route to either of those functions and just return a 404.My current solution is to create a function in every controller which has all the routes hardcoded to catch the request no matter what HTTP method is used. This will then just throw a 405 error. However, I don't really like this way too much as it duplicates the code over several controllers and the hardcoded route list needs to be updated every time a new action is created in the controller.Is there a cleaner solution available to handle the routes in the way I want? Such as using attributes or filters? <code>  [HttpGet(""api/action"")]public IActionResult ActionGet(){ // code}[HttpPost(""api/action"")]public IActionResult ActionPost(){ //code} [Route(""api/action"", Order = 2)]public IActionResult Handle405(){ return StatusCode(405);}",Want to get 405 (Method Not Allowed) instead of 404
Am I using the set/get function wrong in C#?," There is this problem which I need to solve in my program which is about the get/set function.HERE IS THE FULL UNEDITED CODE: https://pastebin.com/Vd8zC51mEDIT: My good friend found the solution, which was to use ""value"" like so: I'M SORRY IF I WASTED ANYONES TIME...!The problem goes like this:Make a Price attribute which returns the price reduced by 10% if it's over 30 using set/get.What I'm getting:Value of 0.I know what's wrong, I just don't know how to fix it. I know it's in the set command.After I show the code, you might have a better understanding.I've tried searching around the internet how to use the set command correctly and tried different ways of doing the set command. ----------These are the main parts cut from the program---------------------- <code>  { get { return this.returnValue; } set { if (value > 30) { this.returnValue = value - (value * 0.10f); } else { this.returnValue = value; } } } public class Book{ public string Name; public string writerName; public string bPublisher; public float bPrice; public string bTheme; public float returnValue; public Book(string name, string writer, string publisher, float price, string theme) { Name = name; writerName = writer; bPublisher = publisher; bPrice = price; bTheme = theme; } public float Price { get { return returnValue; } set { if (this.bPrice > 30) { returnValue = this.bPrice - (this.bPrice * 0.10f); } else { returnValue = this.bPrice; } } }} static void Main(string[] args){ Book k2 = new Book(""A book"", ""O. Writer"", ""Publisher Ab"", 36.90f, ""Fantasy""); Console.WriteLine(k2.Price);}",Am I using the set/get function wrong?
How do I rotate a Quaternion with a global Quaternion on its local or global axes without using transform.Rotate?," Transform.Rotate has a very helpful interface for selecting whether or not a rotation should be made relative to world axes or the local axes. Behind the scenes, it's doing some math to the transform's rotation, a Quaternion, with another Quaternion. And the exact nature of this math changes depending on if you choose the local or world flag.How can I do this sort of math without assigning the first Quaternion to a Transform's rotation (wasting memory and/or time) just to do some math with it?Suppose my first Quaternion is Quaternion q1 = Quaternion.Euler(0f,0f,90f); and the second is Quaternion q2 = Quaternion.Euler(90f,0f,0f).Applying the second to the first along its local axes would give a rotation that rotates its right side to face down and its front to face right. Applying the second to the first along the original axes would give a rotation that rotates its back to face down and its top to face right. <code> ",How do I rotate a Quaternion with 2nd Quaternion on its local or world axes without using transform.Rotate?
How do I rotate a Quaternion with a global Quaternion on its local or world axes without using transform.Rotate?," Transform.Rotate has a very helpful interface for selecting whether or not a rotation should be made relative to world axes or the local axes. Behind the scenes, it's doing some math to the transform's rotation, a Quaternion, with another Quaternion. And the exact nature of this math changes depending on if you choose the local or world flag.How can I do this sort of math without assigning the first Quaternion to a Transform's rotation (wasting memory and/or time) just to do some math with it?Suppose my first Quaternion is Quaternion q1 = Quaternion.Euler(0f,0f,90f); and the second is Quaternion q2 = Quaternion.Euler(90f,0f,0f).Applying the second to the first along its local axes would give a rotation that rotates its right side to face down and its front to face right. Applying the second to the first along the original axes would give a rotation that rotates its back to face down and its top to face right. <code> ",How do I rotate a Quaternion with 2nd Quaternion on its local or world axes without using transform.Rotate?
NLog all levels set to true," I am using NLog with dotnet core app configured like described here. https://github.com/NLog/NLog.Web/wiki/Getting-started-with-ASP.NET-Core-2In nlog.config if I set minLevel to Error and launch my app I can see on logger that logDebug is disabled.If I restore back to trace then all levels are set to true (error, trace, debug, info, warning)and if I put this into config file (appsettings.json) then nothing happens, all logger levels are still set to true, what might be wrong ?  <code>  ""Logging"": { ""LogLevel"": { ""Default"": ""Error"", ""Microsoft"": ""Information"" } }",Changing loglevel in appsettings.json won't get applied to NLog
How to fix this error in .NET ASP.NET tutorial," I'm new to this and following this .Net ASP.NET wep api tutorial but cant get past this error. When doing the ""Test the GetTodoItems method"" and running the Postman to get/set against the DB.When I start debugging, Chrome launches and the following error is thrown: System.InvalidOperationException: 'The following errors occurred with attribute routing information: Error 1: For action: 'TodoApi.Controllers.TodoController.GetTodoItems (TodoApi)' Error: While processing template 'api/[TodoController]', a replacement value for the token 'TodoController' could not be found. Available tokens: 'action, controller'. To use a '[' or ']' as a literal string in a route or within a constraint, use '[[' or ']]' instead. Error 2: For action: 'TodoApi.Controllers.TodoController.GetTodoItem (TodoApi)' Error: While processing template 'api/[TodoController]/{id}', a replacement value for the token 'TodoController' could not be found. Available tokens: 'action, controller'. To use a '[' or ']' as a literal string in a route or within a constraint, use '[[' or ']]' instead.'This is my controller code straight from the tutorial: Here is the startup.cs <code>  using Microsoft.AspNetCore.Mvc;using Microsoft.EntityFrameworkCore;using System.Collections.Generic;using System.Linq;using System.Threading.Tasks;using TodoApi.Models;namespace TodoApi.Controllers{ [Route(""api/[TodoController]"")] [ApiController] public class TodoController : ControllerBase { private readonly TodoContext _context; public TodoController(TodoContext context) { _context = context; if (_context.TodoItems.Count() == 0) { // Create a new TodoItem if collection is empty, // which means you can't delete all TodoItems. _context.TodoItems.Add(new TodoItem { Name = ""Item1"" }); _context.SaveChanges(); } } // GET: api/Todo [HttpGet] public async Task<ActionResult<IEnumerable<TodoItem>>> GetTodoItems() { return await _context.TodoItems.ToListAsync(); } // GET: api/Todo/5 [HttpGet(""{id}"")] public async Task<ActionResult<TodoItem>> GetTodoItem(long id) { var todoItem = await _context.TodoItems.FindAsync(id); if (todoItem == null) { return NotFound(); } return todoItem; } }} using Microsoft.AspNetCore.Builder;using Microsoft.AspNetCore.Hosting;using Microsoft.AspNetCore.Mvc;using Microsoft.EntityFrameworkCore;using Microsoft.Extensions.Configuration;using Microsoft.Extensions.DependencyInjection;using TodoApi.Models;namespace TodoApi{ public class Startup { public Startup(IConfiguration configuration) { Configuration = configuration; } public IConfiguration Configuration { get; } // This method gets called by the runtime. Use this method to add services to the //container. public void ConfigureServices(IServiceCollection services) { services.AddDbContext<TodoContext>(opt => opt.UseInMemoryDatabase(""TodoList"")); services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2); } // This method gets called by the runtime. Use this method to configure the HTTP //request pipeline. public void Configure(IApplicationBuilder app, IHostingEnvironment env) { if (env.IsDevelopment()) { app.UseDeveloperExceptionPage(); } else { // The default HSTS value is 30 days. You may want to change this for // production scenarios, see https://aka.ms/aspnetcore-hsts. app.UseHsts(); } app.UseHttpsRedirection(); app.UseMvc(); } }}","While processing template api/[TodoController], a replacement value for the token TodoController could not be found"
Add parameters to httpwebrequest," I wrote a HTTP request in Postman and I want to write the same request in my application. There is an option in postman to see the code of the request for C#. In postman it shows request using RestSharp, since I don't want to use external NuGet packages in my project I'm trying to write the same request with objects from .NET Framework.The RestSharp code looks like this: I tried to write the same request with HttpWebRequest: but I'm getting HTML content I think that I need to add the parameters not as header, how can this be achieved? <code>  var client = new RestClient(""https://login.microsoftonline.com/04xxxxa7-xxxx-4e2b-xxxx-89xxxx1efc/oauth2/token"");var request = new RestRequest(Method.POST); request.AddHeader(""Host"", ""login.microsoftonline.com""); request.AddHeader(""Content-Type"", ""application/x-www-form-urlencoded"");request.AddParameter(""undefined"", ""grant_type=password&client_id=6e97fc60-xxx-445f-xxxx-a9b1bbc9eb2d&client_secret=4lS*xxxxxYn%5BENP1p%2FZT%2BpqmqF4Q&resource=https%3A%2F%2Fgraph.microsoft.com&username=myNameHere%402comp.onmicrosoft.com&password=xxxxxxxxxx6"", ParameterType.RequestBody);IRestResponse response = client.Execute(request); HttpWebRequest request = (HttpWebRequest)WebRequest.Create(""https://login.microsoftonline.com/0475dfa7-xxxxxxxx-896cf5e31efc/oauth2/token"");request.Method = ""GET"";request.Referer = ""login.microsoftonline.com"";request.ContentType = ""application/x-www-form-urlencoded"";request.Headers.Add(""grant_type"", ""password"");request.Headers.Add(""client_id"", ""6e97fc60-xxxxxxxxx-a9bxxxxxb2d"");request.Headers.Add(""client_secret"", ""4lSxxxxxxxxxxxmqF4Q"");request.Headers.Add(""resource"", ""https://graph.microsoft.com"");request.Headers.Add(""username"", ""xxxx@xxxxx.onmicrosoft.com"");request.Headers.Add(""password"", ""xxxxxxxxxxxxx"");HttpWebResponse response = (HttpWebResponse)await request.GetResponseAsync();",Add parameters to httpclient
Does readonly modifier create a hidden copy of a field?," The only difference between MutableSlab and ImmutableSlab implementations is the readonly modifier applied on the handle field: But they produce different results: GCHandle is a mutable struct and when you copy it then it behaves exactly like in scenario with immutableSlab.Does the readonly modifier create a hidden copy of a field? Does it mean that it's not only a compile-time check? I couldn't find anything about this behaviour here. Is this behaviour documented? <code>  using System;using System.Runtime.InteropServices;public class Program{ class MutableSlab : IDisposable { private GCHandle handle; public MutableSlab() { this.handle = GCHandle.Alloc(new byte[256], GCHandleType.Pinned); } public bool IsAllocated => this.handle.IsAllocated; public void Dispose() { this.handle.Free(); } } class ImmutableSlab : IDisposable { private readonly GCHandle handle; public ImmutableSlab() { this.handle = GCHandle.Alloc(new byte[256], GCHandleType.Pinned); } public bool IsAllocated => this.handle.IsAllocated; public void Dispose() { this.handle.Free(); } } public static void Main() { var mutableSlab = new MutableSlab(); var immutableSlab = new ImmutableSlab(); mutableSlab.Dispose(); immutableSlab.Dispose(); Console.WriteLine($""{nameof(mutableSlab)}.handle.IsAllocated = {mutableSlab.IsAllocated}""); Console.WriteLine($""{nameof(immutableSlab)}.handle.IsAllocated = {immutableSlab.IsAllocated}""); }} mutableSlab.handle.IsAllocated = FalseimmutableSlab.handle.IsAllocated = True",Does the 'readonly' modifier create a hidden copy of a field?
How to add debug logging to C# .NET Core unit tests?," I'm trying to add some simple console logging to my unit tests in ASP.NET Core 2.2 and am having trouble since the logging configuration changed.I currently have this code, which creates a logger for my class, ""DataTests"": But it doesn't log to the debug window, and I can't configure it. I would like to do something like But that extension is now obsolete and no longer available. It is replaced by an extension on ILoggingBuilder instead of ILoggerFactory. This is how it's used in file program.cs: My problem is I don't know how to get the ILoggingBuilder from my unit test class. How can I do this? It's a shame it's so complicated to add a simple logger to a simple unit test class - this should be built in by default I would think. <code>  // Create logger for our unit testsvar serviceProvider = new ServiceCollection() .AddLogging() .BuildServiceProvider();var factory = serviceProvider.GetService<ILoggerFactory>();var logger = factory.CreateLogger<DataTests>(); factory.AddDebug(); public static void Main(string[] args){ var webHost = new WebHostBuilder() .UseKestrel() .UseContentRoot(Directory.GetCurrentDirectory()) .ConfigureAppConfiguration((hostingContext, config) => { var env = hostingContext.HostingEnvironment; config.AddJsonFile(""appsettings.json"", optional: true, reloadOnChange: true) .AddJsonFile($""appsettings.{env.EnvironmentName}.json"", optional: true, reloadOnChange: true); config.AddEnvironmentVariables(); }) .ConfigureLogging((hostingContext, logging) => { // Requires `using Microsoft.Extensions.Logging;` logging.AddConfiguration(hostingContext.Configuration.GetSection(""Logging"")); logging.AddConsole(); logging.AddDebug(); logging.AddEventSourceLogger(); }) .UseStartup<Startup>() .Build(); webHost.Run();}",How to add debug logging to C# .NET Core unit tests
"Converting a nullable reference type to a non nullable reference type, less verbosely"," Is there a way I can convert a nullable reference type to non-nullable reference type in the below example less verbosely? This would be for when the nullable reference flag for the compiler is enabled.When the nullable reference type is null, I would like it to throw an exception. <code>  Assembly? EntryAssemblyNullable = Assembly.GetEntryAssembly();if (EntryAssemblyNullable is null){ throw new Exception(""The CLR method of Assembly.GetEntryAssembly() returned null"");}Assembly EntryAssembly = EntryAssemblyNullable;var LocationNullable = Path.GetDirectoryName(EntryAssembly.Location);if (LocationNullable is null){ throw new Exception(""The CLR method of Assembly.GetEntryAssembly().Location returned null"");}string ExecutableLocationPath = LocationNullable;","Converting a nullable reference type to a non-nullable reference type, less verbosely"
Where is the root of all dependencies stored?," I'm learning C# and the best practices around it.Now that I know:Single Responsibility PrincipleStatic classSingletonDependency InjectionEveryone said to avoid Singleton and Static, and prefer dependency injection instead.Now I have converted all of my classes so that they won't have to get their own data, such as removing: and instead injecting my dependency inside MyClass. However, now that MyClass following Single Responsibility Principle, and getting all dependencies from outside MyClass, what/which class will be responsible to giving all the dependencies?My example problem in Unity is:UIStatusPanelClass depend on CurrentCharacter.GameInputClass depend on CurrentCharacter and CurrentCamera.CharacterManagerClass hold the CurrentCharacter, but isn't responsible to pass to other class, as its single responsibility is to hold all the character in scene.UIInventoryClass depend on InventoryClass, which is hold by CurrentCharacter.StatisticClass depend on CurrentCharacter.ItemRepositoryClass is responsible to hold List but not responsible to get the item.Please help me straighten my knowledge of these things. <code>  _myItem = Repository.Instance.FindById(1); public MyClass(Repository repository) { _myItem = repository.FindById(1);}",Where is the root of all (OOP) dependencies stored?
Reference WinForm from a .Net Core class library," I am trying to create a .net core 3 class library that references the .net core 3 version of winform (so this assembly can itself be referenced by a .net core 3 WinForm assembly).A new .net core WinForm project references Microsoft.WindowsDesktop.App.WindowsForms, however I can't find any nuget package with that name. What do I need to do to reference the .net core 3 winform? <code> ",Use Windows Forms in a .Net Core Class Library - .NET Core Control Library
"""The attribute names could not be inferred from bind attribute 'bind-value'"" exception in Blazor"," I've just migrated a Blazor project from Core 3 Preview 6 to Preview 8 and I'm now getting this error: The attribute names could not be inferred from bind attribute 'bind-value'. Bind attributes should be of the form 'bind' or 'bind-value' along with their corresponding optional parameters like 'bind-value:event', 'bind:format' etc.I've isolated the component that's causing this to happen, and the code certainly seems to bind-value set as per the instructions in the error message: I've tried removing the @ from @bind-Value and changing the capitalisation @bind-Valueetc. but all to no avail. What can be causing this? <code>  <TelerikDropdownList Data=""@State.ContainerSizes"" ValueField=@nameof(ContainerSize.ContainerSizeId) TextField=@nameof(ContainerSize.ContainerSizeName) @bind-Value=""@ContainerSizeIdNoNull"" > </TelerikDropdownList>","""The attribute names could not be inferred from bind attribute 'bind-value'"" error in Blazor"
Create assembly that when referenced it prevents a program from using Main entry method," I am editing my question I think it is a little confusing and it does not explain what my intent is.Edit:My goal is that when my HelloWorld application references MyClassLibrary my code does not compile so that I ensure to initialize some code prior to running the main method. Kind of like a constructor of a class. When I reference MyClassLibrary I will like to run some code in there before running the main method of my HelloWorld application. NUnit has a similar functionality. When my HelloWorld application references NUnit I get the error: Error CS0017 Program has more than one entry point defined. Compile with /main to specify the type that contains the entry point. As @Alex pointed out that Main method that NUnit creates is auto-generated. I will like to auto-generate a main method with some custom code. How can I do that from MyClassLibrary without doing anything on my HelloWorld application just like NUnit does it?OLD Question:I want to perform the same behavior that NUnit tests perform that it prevents using a Main method. In this case the error that I need is a good thing. Let me explain what I mean.I create a hello world application targeting the .net coreProject file: Code file: (default hello world c# code)If I then run that application it runs fineAdd a reference to NUnit and my project file now contains.. When I try to compile the project I get the error: Error CS0017 Program has more than one entry point defined. Compile with /main to specify the type that contains the entry point. That means that there is another Main method. That method is probably located on the NUnit nuget package I am referencing. This is the error I am trying to replicate!.Now this is how I try to replicate the same error:I remove the NUnit nugget package having no references to NUnit on my hello world application.Create a Project ClassLibrary1 with the following code:. Have my hello world application reference that project:When I compile I get no errors even though there are 2 Main methods!How does NUnit manages to prevent using a Main method? How can I replicate the same behavior? I want to create an assembly that when referenced it prevents executing the Main method. <code>  <Project Sdk=""Microsoft.NET.Sdk""> <PropertyGroup> <OutputType>Exe</OutputType> <TargetFramework>netcoreapp2.1</TargetFramework> </PropertyGroup></Project> <Project Sdk=""Microsoft.NET.Sdk""> <PropertyGroup> <OutputType>Exe</OutputType> <TargetFramework>netcoreapp2.1</TargetFramework> </PropertyGroup> <ItemGroup> <PackageReference Include=""NUnit"" Version=""3.12.0"" /> <PackageReference Include=""NUnit3TestAdapter"" Version=""3.13.0"" /> <PackageReference Include=""Microsoft.NET.Test.Sdk"" Version=""16.2.0"" /> </ItemGroup></Project> public class MyLib{ static void Main() { Console.WriteLine(""fooooo""); // do something }}",Auto-generate main method from referenced assembly
Unity c#: Detect if I clicked on a certain part of text," I'm using Unity to create an Android/IOS application.In a page containing a paragraph, I want to know if I click on the last sentence of the text. (""Click here for more details"" for example).After clicking on this sentence I want to open a new page.I know I can put 2 text elements and add this sentence to the second element and the reset to the first element and add onClick event on the second element.This is a solution for the problem, but in my case, it can't solve the problem because I am getting text dynamically and its size will change from time to time, so the second text element will not start on the same line after the first element ends.I need a solution that is done in code.I saw the same question but it is for HTML and JavaScript, not for Unity.I will post one of the answer's code snippet which has the same behaviour of what I want.  <code>  const clickables = document.querySelectorAll('.clickable')clickables.forEach(el => new Clickable(el))function Clickable (el) { const _handleClick = ({target}) => console.log(target.innerHTML) const texts = el.textContent.split(/\s/) el.innerHTML = '' texts.forEach(t => { const span = document.createElement('span') span.innerHTML = `${t} ` span.addEventListener('click', _handleClick) el.appendChild(span) })} <h1 class=""clickable"">Some text</h1><h2 class=""clickable"">Some! more! text2</h1>",Detect if I clicked on a certain part of text
.NET Core Environment Variable returns Null," I have a .NET Core console application. I'm trying to retrieve the environment variable using the below code. However, the variable ""environment"" always return null. I set the environment variable ""ASPNETCORE_ENVIRONMENT"" through Control Panel -> System Properties -> Environment Variables -> System VariablesI also tried setting the environment variable using the command set ASPNETCORE_ENVIRONMENT=development, but that also did not work. When I debug the code (F5) in Visual Studio, the variable always return null. I have made sure that there aren't any spaces where I set the variable, or in my code where I read it. Is there anything I'm missing? <code>  var environment = Environment.GetEnvironmentVariable(""ASPNETCORE_ENVIRONMENT"");",.NET Core environment variable returns null
What's the difference between using and await using," I've noticed that in some case, Visual Studio recommends to do this Instead of this What is the difference between using and await using?How should I decide which one to use? <code>  await using var disposable = new Disposable();// Do something using var disposable = new Disposable();// Do something",What is the difference between using and await using? And how can I decide which one to use?
What's the difference between using and await using? And which one should I use?," I've noticed that in some case, Visual Studio recommends to do this Instead of this What is the difference between using and await using?How should I decide which one to use? <code>  await using var disposable = new Disposable();// Do something using var disposable = new Disposable();// Do something",What is the difference between using and await using? And how can I decide which one to use?
How to write search query with case insensitive in EF Core?," I want to ask a question about SQL Server and EF Core. Collation in the database is Latin1_CI_AS and I want to write a search query that contains Turkish characters.In the database, there is a record named ""SELM"" in the 'personnel' table. When I write a query like this in EF Core: The list is empty if my search condition is ""selim"".I don't have a chance to change the collation in the database to Turkish because our application is multilingual. I think there will be a problem with other languages. Or am I wrong?I also wrote the string extension. However, when converting a LINQ query to SQL, all records come to the service layer because the LIKE operator does not assign the WHERE clause. It's very important to run this condition on the sql side. If I take all the dataset to the service layer and query it, it will cost me a lot.I can solve the problem when I type a query in the database like this: I think if I can manipulate collate on EF Core I will solve the problem. <code>  public async Task<IList<PersonnelGetDto>> Get(PersonnelGetPayload payload) { if (payload.Name != null) query = query.Where(x => x.Name.Contains(payload.Name)); } SELECT * FROM Personnel WHERE Name LIKE 'selim' COLLATE Turkish_CI_AS",Write a search query which is case insensitive in EF Core?
Write search query with case insensitive in EF Core?," I want to ask a question about SQL Server and EF Core. Collation in the database is Latin1_CI_AS and I want to write a search query that contains Turkish characters.In the database, there is a record named ""SELM"" in the 'personnel' table. When I write a query like this in EF Core: The list is empty if my search condition is ""selim"".I don't have a chance to change the collation in the database to Turkish because our application is multilingual. I think there will be a problem with other languages. Or am I wrong?I also wrote the string extension. However, when converting a LINQ query to SQL, all records come to the service layer because the LIKE operator does not assign the WHERE clause. It's very important to run this condition on the sql side. If I take all the dataset to the service layer and query it, it will cost me a lot.I can solve the problem when I type a query in the database like this: I think if I can manipulate collate on EF Core I will solve the problem. <code>  public async Task<IList<PersonnelGetDto>> Get(PersonnelGetPayload payload) { if (payload.Name != null) query = query.Where(x => x.Name.Contains(payload.Name)); } SELECT * FROM Personnel WHERE Name LIKE 'selim' COLLATE Turkish_CI_AS",Write a search query which is case insensitive in EF Core?
What does exclamation mark mean before invoking a mehtod in C# version 8.0," I have found a code written in C# seemingly version 8.0. In the code, there is an exclamation mark before invoking a method. What does this part of the code mean, and above all, what are its uses? <code>  var foo = Entity!.DoSomething();",What does exclamation mark mean before invoking a method in C# 8.0?
What does exclamation mark mean before invoking a mehtod in C# 8.0?," I have found a code written in C# seemingly version 8.0. In the code, there is an exclamation mark before invoking a method. What does this part of the code mean, and above all, what are its uses? <code>  var foo = Entity!.DoSomething();",What does exclamation mark mean before invoking a method in C# 8.0?
OData on .Net Core doesn't return the right results," I've added OData to my WebAPI project.Versions: Core 3.1 OData 7.3.0 (beta version in order to work with Core 3.x)EF Core 3.1.0Here is my startup.cs And the controller is: The APIs are working fine, but when I try to add some OData action like $select I get the following and not the expected results: <code>  public class Startup{ public Startup(IConfiguration configuration) { Configuration = configuration; } public IConfiguration Configuration { get; } public void ConfigureServices(IServiceCollection services) { services.AddDbContext<Models.Contexts.EntityContext>(opts => opts.UseSqlServer(Configuration[""ConnectionString:MailBackup""])); services.AddControllers(); services.AddMvc(options => { options.EnableEndpointRouting = false; }).SetCompatibilityVersion(Microsoft.AspNetCore.Mvc.CompatibilityVersion.Version_3_0); services.AddOData(); } public void Configure(IApplicationBuilder app, IWebHostEnvironment env) { if (env.IsDevelopment()) { app.UseDeveloperExceptionPage(); } app.UseMvc(routeBuilder => { routeBuilder.EnableDependencyInjection(); routeBuilder.Expand().Select().OrderBy().Filter(); }); app.UseHttpsRedirection(); app.UseAuthorization(); }} [EnableQuery()][HttpGet][Route(""GetAll"")]public IQueryable<Models.EmailMessage> GetAll(){ return this._context.EmailMessages;} { ""instance"": null, ""container"": {}, ""modelID"": ""529e8054-04c4-4729-aa91-d7eaf67a55d0"", ""untypedInstance"": null, ""instanceType"": null, ""useInstanceForProperties"": false},{ ""instance"": null, ""container"": {}, ""modelID"": ""529e8054-04c4-4729-aa91-d7eaf67a55d0"", ""untypedInstance"": null, ""instanceType"": null, ""useInstanceForProperties"": false},",OData on .Net Core doesn't return the right results on $select
Logging into Slack & Add to Slack in dotnetcore without having Identity Framework error: The oauth state was missing or invalid," I'm trying to create a very simple page for my slackbot so that users can login and register. However, even when using their generated ""Login with Slack"" button I receive an error ""The oauth state was missing or invalid."". The same error happens with ""Add to Slack"".I based my code off of https://dotnetthoughts.net/slack-authentication-with-aspnet-core/. Even though it's outdated, it's the only example I could find online. I tried figuring out what I need to change in order to get it to work with the dotnetcore 3 and Slack 2.0, but I've come to my wits end.In my services, I have the following before calling AddMvc, etc. My configure method looks like Besides the ""oauth state was missing on invalid"", if in my app I directly go to /login I don't receive the error, but it doesn't appear that I'm logged in as User.Identity.IsAuthenticated is false.I'm really at a loss, and could use some much appreciated help!Thank you!MASSIVE UPDATEI got the log into slack to work, but I cannot get the Add to Slack button to work.Here is my new services: Per @timur,I scraped my app.Map and went with an Authentication Controller: The ""Add to Slack"" button is provided as is from Slack. So, when the use clicks ""Login"" it logs them in and I get their name, etc. You'll notice in my Authentication Controller I added a function with the path ""~/signin-slack"" this is because I manually added the ""Options.CallbackPath"" to add a state parameter. If I remove ""Options.CallbackPath"", I get an error stating that the oauth state was missing or invalid.So, I'm not sure what I'm missing here on the Slack side. They make it sound so easy!Sorry for the long post/update. Thanks for your help. <code>  services.AddAuthentication(options => options.DefaultSignInScheme = CookieAuthenticationDefaults.AuthenticationScheme) .AddCookie(options => { options.Cookie.Name = ""MyAuthCookieName""; options.Cookie.HttpOnly = true; options.Cookie.SecurePolicy = CookieSecurePolicy.Always; options.Cookie.MaxAge = TimeSpan.FromDays(7); options.ExpireTimeSpan = TimeSpan.FromDays(7); options.LoginPath = $""/login""; options.LogoutPath = $""/logout""; options.AccessDeniedPath = $""/AccessDenied""; options.SlidingExpiration = true; options.ReturnUrlParameter = CookieAuthenticationDefaults.ReturnUrlParameter; }) //.AddSlack(options => //{ // options.ClientId = Configuration[""Slack:ClientId""]; // options.ClientSecret = Configuration[""Slack:ClientSecret""]; //}); .AddOAuth(""Slack"", options => { options.ClientId = Configuration[""Slack:ClientId""]; options.ClientSecret = Configuration[""Slack:ClientSecret""]; options.CallbackPath = new PathString(""/signin-slack""); options.AuthorizationEndpoint = $""https://slack.com/oauth/authorize""; options.TokenEndpoint = ""https://slack.com/api/oauth.access""; options.UserInformationEndpoint = ""https://slack.com/api/users.identity?token=""; options.Scope.Add(""identity.basic""); options.Events = new OAuthEvents() { OnCreatingTicket = async context => { var request = new HttpRequestMessage(HttpMethod.Get, context.Options.UserInformationEndpoint + context.AccessToken); var response = await context.Backchannel.SendAsync(request, context.HttpContext.RequestAborted); response.EnsureSuccessStatusCode(); var userObject = JObject.Parse(await response.Content.ReadAsStringAsync()); var user = userObject.SelectToken(""user""); var userId = user.Value<string>(""id""); if (!string.IsNullOrEmpty(userId)) { context.Identity.AddClaim(new Claim(ClaimTypes.NameIdentifier, userId, ClaimValueTypes.String, context.Options.ClaimsIssuer)); } var fullName = user.Value<string>(""name""); if (!string.IsNullOrEmpty(fullName)) { context.Identity.AddClaim(new Claim(ClaimTypes.Name, fullName, ClaimValueTypes.String, context.Options.ClaimsIssuer)); } } }; }); app.UseHttpsRedirection();app.UseStaticFiles();app.UseRouting();app.UseAuthentication();app.UseAuthorization();app.Map(""/login"", builder =>{ builder.Run(async context => { await context.ChallengeAsync(""Slack"", properties: new AuthenticationProperties { RedirectUri = ""/"" }); });});app.Map(""/logout"", builder =>{ builder.Run(async context => { await context.SignOutAsync(CookieAuthenticationDefaults.AuthenticationScheme); context.Response.Redirect(""/""); });});app.UseEndpoints(endpoints =>{ endpoints.MapControllers(); endpoints.MapRazorPages();}); services.AddAuthentication(options => { options.DefaultScheme = CookieAuthenticationDefaults.AuthenticationScheme; }) .AddCookie(options => { options.LoginPath = ""/login""; options.LogoutPath = ""/logout""; }) .AddSlack(options => { options.ClientId = Configuration[""Slack:ClientId""]; options.ClientSecret = Configuration[""Slack:ClientSecret""]; options.CallbackPath = $""{SlackAuthenticationDefaults.CallbackPath}?state={Guid.NewGuid():N}""; options.ReturnUrlParameter = new PathString(""/""); options.Events = new OAuthEvents() { OnCreatingTicket = async context => { var request = new HttpRequestMessage(HttpMethod.Get, $""{context.Options.UserInformationEndpoint}?token={context.AccessToken}""); var response = await context.Backchannel.SendAsync(request, context.HttpContext.RequestAborted); response.EnsureSuccessStatusCode(); var userObject = JObject.Parse(await response.Content.ReadAsStringAsync()); var user = userObject.SelectToken(""user""); var userId = user.Value<string>(""id""); if (!string.IsNullOrEmpty(userId)) { context.Identity.AddClaim(new Claim(ClaimTypes.NameIdentifier, userId, ClaimValueTypes.String, context.Options.ClaimsIssuer)); } var fullName = user.Value<string>(""name""); if (!string.IsNullOrEmpty(fullName)) { context.Identity.AddClaim(new Claim(ClaimTypes.Name, fullName, ClaimValueTypes.String, context.Options.ClaimsIssuer)); } } }; }); public class AuthenticationController : Controller{ [HttpGet(""~/login"")] public async Task<IActionResult> SignIn() { return Challenge(new AuthenticationProperties { RedirectUri = ""/"" }, ""Slack""); } [HttpGet(""~/signin-slack"")] public IActionResult SignInSlack() { return RedirectToPage(""/Index""); } [HttpGet(""~/logout""), HttpPost(""~/logout"")] public IActionResult SignOut() { return SignOut(new AuthenticationProperties { RedirectUri = ""/"" }, CookieAuthenticationDefaults.AuthenticationScheme); }} <a href=""https://slack.com/oauth/authorize?scope=incoming-webhook,commands,bot&client_id=#############""><img alt=""Add to Slack"" height=""40"" width=""139"" src=""https://platform.slack-edge.com/img/add_to_slack.png"" srcset=""https://platform.slack-edge.com/img/add_to_slack.png 1x, https://platform.slack-edge.com/img/add_to_slack@2x.png 2x"" /></a>",Add to Slack in dotnetcore without having Identity Framework error: The oauth state was missing or invalid
How do I route in blazor with an email as a route parameter?," Hi there stackoverflow! I am using Client side Blazor and have stumbled upon a tricky section regards to routing with strings and dots (.). I wish to route from an admin control page to a page with the following route: @page ""/ManageGradingExamResults/{StudentEmail}"". I tested such with this request: https://localhost/ManageGradingExamResults/1234@high.school.nz, but I get a not found. If I change the razor route to @page ""/ManageGradingExamResults/{*StudentEmail}"" I end up with the following exception: System.InvalidOperationException: Invalid template 'ManageGradingExamResults/{*StudentEmail}'. The character '*' in parameter segment '{*StudentEmail}' is not allowed.. I tried that due to the similarities in cshtml pages. I have found that I can route with integers but have had no luck with strings. I also have come across this Microsoft doc explaining rout params and suggesting the ** in my page route. This allows me into my page however i then need to use the ? before my email in the request, the page does not load with my data as I can see it did not pull the parameter into my variable. Any suggestions or help with routing in client side Blazor would be greatly appreciated!Request Code: Request URL: Razor page route: My Variable: <code>  NavigationManager.NavigateTo($""/ManageGradingExamResults/?{student.Email}""); https://localhost/ManageGradingExamResults/?1234@high.school.nz @page ""/**ManageGradingExamResults/{StudentEmail}""@page ""/ManageGradingExamResults"" @code{ [Parameter] public string StudentEmail { get; set; }...",How do I route in client-side blazor with a string route parameter containing dots (.)?
Dotnet CORE 3.1 - accessing an embedded file in an associated project library," I have been following THIS little tutorial on embedded resources. Its by Derek Comartin and deals with the simple operation of adding an embedded resource into the the .csproj file.Fine. did that as per his instructions however I get null in the resourceStream. There were a couple of gotcha's re not setting your resource to ""embedded resource"" in properties etc but I did all that.Here are the resource properties:My solution has quite a number of projects that make it up including a main project or startup project. The resource or JSON file I want to use as an embedded resource is in the Initialisation project which is a DotNet Core library project and IS NOT the start up project.I followed the advice regarding finding the names etc using: This revealed it was not even available so as a result I got ""null"" for the resource stream.Here is my code for accessing the embedded resource. Here is my csproj file for the project that has the embedded resource. Here is my csproj file for the main project... I am pretty sure it would show up if it was in the main project but it isnt in that project.How do I access an embedded resource that is an embedded resource in a sub project (dotnet core library)? <code>  var resourceNames = assembly.GetManifestResourceNames(); public void CATALOGInitialiseSuburbs(CATALOGContext context) { var assembly = Assembly.GetEntryAssembly(); var resourceNames = assembly.GetManifestResourceNames(); var resourceStream = assembly.GetManifestResourceStream(""EmbeddedResource.SUBURB.Initialisations.SuburbJSON.australianSuburbs.json""); using (var reader = new StreamReader(resourceStream, Encoding.UTF8)) { var list = reader.ReadToEndAsync(); } } <Project Sdk=""Microsoft.NET.Sdk""> <PropertyGroup> <TargetFramework>netcoreapp3.1</TargetFramework> <ApplicationIcon /> <Win32Resource /> </PropertyGroup> <ItemGroup> <None Remove=""SUBURB.Initialisations\SuburbJSON\australianSuburbs2019-08.json"" /> <None Remove=""SUBURB.Initialisations\SuburbJSON\australian_postcodes 2019.csv"" /> </ItemGroup> <ItemGroup> <EmbeddedResource Include=""SUBURB.Initialisations\SuburbJSON\australianSuburbs2019-08.json"" /> <EmbeddedResource Include=""SUBURB.Initialisations\SuburbJSON\australian_postcodes 2019.csv"" /> </ItemGroup> <ItemGroup> <PackageReference Include=""Microsoft.EntityFrameworkCore"" Version=""3.1.0"" /> </ItemGroup> <ItemGroup> <ProjectReference Include=""..\JobsLedger.AUTHORISATION\JobsLedger.AUTHORISATION.csproj"" /> <ProjectReference Include=""..\JobsLedger.CATALOG.ENTITIES\JobsLedger.CATALOG.ENTITIES.csproj"" /> <ProjectReference Include=""..\JobsLedger.CATALOG\JobsLedger.CATALOG.csproj"" /> <ProjectReference Include=""..\JobsLedger.DATA\JobsLedger.DATA.csproj"" /> </ItemGroup></Project> <Project Sdk=""Microsoft.NET.Sdk.Web""> <PropertyGroup> <TargetFramework>netcoreapp3.1</TargetFramework> <TypeScriptCompileBlocked>true</TypeScriptCompileBlocked> <TypeScriptToolsVersion>Latest</TypeScriptToolsVersion> </PropertyGroup> <ItemGroup> <PackageReference Include=""FluentValidation"" Version=""8.6.1"" /> <PackageReference Include=""Microsoft.AspNetCore.Authentication.JwtBearer"" Version=""3.1.0"" /> <PackageReference Include=""Microsoft.AspNetCore.Mvc.NewtonsoftJson"" Version=""3.1.0"" /> <PackageReference Include=""Microsoft.EntityFrameworkCore"" Version=""3.1.0"" /> <PackageReference Include=""Microsoft.EntityFrameworkCore.Analyzers"" Version=""3.1.0"" /> <PackageReference Include=""Microsoft.EntityFrameworkCore.Relational"" Version=""3.1.0"" /> <PackageReference Include=""Microsoft.EntityFrameworkCore.SqlServer"" Version=""3.1.0"" /> <PackageReference Include=""Microsoft.EntityFrameworkCore.Tools"" Version=""3.1.0""> <PrivateAssets>all</PrivateAssets> <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets> </PackageReference> <PackageReference Include=""Microsoft.IdentityModel.Tokens"" Version=""5.6.0"" /> <PackageReference Include=""Microsoft.VisualStudio.Web.CodeGeneration.Design"" Version=""3.1.0"" /> </ItemGroup> <ItemGroup> <ProjectReference Include=""..\JobsLedger.AUTHORISATION\JobsLedger.AUTHORISATION.csproj"" /> <ProjectReference Include=""..\JobsLedger.CATALOG\JobsLedger.CATALOG.csproj"" /> <ProjectReference Include=""..\JobsLedger.DATA\JobsLedger.DATA.csproj"" /> <ProjectReference Include=""..\JobsLedger.INITIALISATION\JobsLedger.INITIALISATION.csproj"" /> <ProjectReference Include=""..\JobsLedger.TESTDATA\JobsLedger.TESTDATA.csproj"" /> </ItemGroup> <Target Name=""DebugRunWebpack"" BeforeTargets=""Build"" Condition="" '$(Configuration)' == 'Debug' And !Exists('wwwroot\dist') ""> <!-- Ensure Node.js is installed --> <Exec Command=""node --version"" ContinueOnError=""true""> <Output TaskParameter=""ExitCode"" PropertyName=""ErrorCode"" /> </Exec> <Error Condition=""'$(ErrorCode)' != '0'"" Text=""Node.js is required to build and run this project. To continue, please install Node.js from https://nodejs.org/, and then restart your command prompt or IDE."" /> <!-- In development, the dist files won't exist on the first run or when cloning to a different machine, so rebuild them if not already present. --> <Message Importance=""high"" Text=""Performing first-run Webpack build..."" /> <Exec Command=""npm install"" /> <Exec Command=""npm ddp"" /> <Exec Command=""npm run webpack:Debug"" /> </Target> <Target Name=""PublishRunWebpack"" AfterTargets=""ComputeFilesToPublish""> <!-- As part of publishing, ensure the JS resources are freshly built in production mode --> <Exec Command=""npm install"" /> <Exec Command=""npm ddp"" /> <Exec Command=""npm run webpack:$(Configuration)"" /> <!-- Include the newly-built files in the publish output --> <ItemGroup> <!-- First, clean up previously generated content that may have been removed. --> <ContentWithTargetPath Remove=""@(ContentWithTargetPath)"" Condition=""!Exists('%(Identity)')"" /> <_WebpackFiles Include=""wwwroot\dist\**"" /> <ContentWithTargetPath Include=""@(_WebpackFiles->'%(FullPath)')"" RelativePath=""%(_WebpackFiles.Identity)"" TargetPath=""%(_WebpackFiles.Identity)"" CopyToPublishDirectory=""Always"" /> </ItemGroup> </Target></Project>",Dotnet CORE 3.1 - accessing an embedded resource (file) in an associated project library
Entity Framework (core) - cascading delete," Im using EF Core 3.1.1, but I believe this question applies to all versions of EF.It seems the EF has the ability to cascade delete - if it is enabled, and if the dependent objects are loaded in the context. The above statement deletes all the blogs posts, and then the blog - each with a different sql statement.This is what I want, however when using code-first, it also creates the tables with cascading delete enabled in the database. (ON DELETE CASCADE)Can you enable cascade delete in EF, and rely of EF deleting dependent objects, without also enabling database level cascade delete? (Or am I understanding this incorrectly?)The reason is migrations fail because SQL wont enable cascade delete in the database because it detects multiple cascade paths (even though multiple wouldnt occur naturally in the schema)Thanks! <code>  var blog = context.blogs.Include(x => x.Posts).First(x => x.BlogId == id);context.blogs.Remove(blog);",Entity Framework (Core) - cascading delete
How to repeat function while button is held down (unity input system)," Trying to repeat the function function OnAttack() continuously while a button is being held down. Basically I'm looking for an equivalent to Update() { GetKeyDown() {//code }} But with the input system.Edit: using a joystick, cant tell what button is being pressed. <code> ",How to repeat function while button is held down (New unity input system) Solved
How to repeat function while button is held down (New unity input system)," Trying to repeat the function function OnAttack() continuously while a button is being held down. Basically I'm looking for an equivalent to Update() { GetKeyDown() {//code }} But with the input system.Edit: using a joystick, cant tell what button is being pressed. <code> ",How to repeat function while button is held down (New unity input system) Solved
HttpClient.GetJsonAsync Not found," I have installed the package by adding the latest package ref.from https://www.nuget.org/packages/Microsoft.AspNetCore.Blazor.HttpClient/But still i am unable to find the desired function like .. Client.GetJsonAsync Can you please help me out if i am missing something?Thanks.I am trying out here but cant. <code>  public async Task<User> GetUser(string Id) { HttpClient client = new HttpClient(); var user = await client.GetJsonAsync($""{BaseUrl}Get-User/{Id}""); return JsonConvert.DeserializeObject<User>(user); }",HttpClient.GetJsonAsync Not found. (blazor server)
c# IHttpActionResult use generic object," I have a http Action that will needs to take in two different object model. The Implementation looks at the two model object and know what to do at that point. Can I use a generic object? <code>  [HttpPost]public IHttpActionResult InsertData(string accessKey, [FromBody] T content){ try { MobileAppService ms = new MobileAppService(); ResultStatus resultStatus = ms.ProcessAppLogging(t); return Ok(resultStatus.ResultCode); } catch (Exception e) { Elmah.ErrorSignal.FromCurrentContext().Raise(e); }}",Web API Generic Action
".NET Core 3.1 ChangePasswordAsnyc Inner Exception ""Cannot update Idenitty column"""," I am upgrading a .NET Core Web API from 2.2 to 3.1. When testing the ChangePasswordAsync function, I receive the following error message: Cannot update identity column 'UserId'.I ran a SQL Profile and I can see that the Identity column is not included in the 2.2 UPDATE statement but it is in 3.1. The line of code in question returns NULL, as opposed to success or errors, and is as follows: The implementation of the ChangePasswordAsnyc is as follows (code truncated for brevity). Note: AspNetUsers extends IdentityUser. The UserId is included in the objResult, along with a lot of other fields, which is then returned at the end of the method. From what I can tell, without being able to step through the ChangePasswordAsync method, the function updates all fields that are contained in the objUser. Question:How do I suppress the identity column from being populated in the UPDATE statement that ChangePasswordAsnyc is generating? Do I need to add an attribute in the model? Do I need to remove the UserId from the objUser before passing it into the ChangePasswordAsync? Or, something else?Bounty QuestionI have created a custom user class that extends the IdentityUser class. In this custom class, there is an additional IDENTITY column. In upgrading the .NET Core 2.2 to 3.1, the ChangePasswordAsync function no longer works because the 3.1 method is trying to UPDATE this IDENTITY column whereas this does not happen in 2.1.There was no code change other than upgrading an installing the relevant packages. The accepted answer needs to fix the problem.UPDATEMigrations are not used as this results in a forced marriage between the database and the Web API with it's associated models. In my opinion, this violated the separation of duties between database, API, and UI. But, that's Microsoft up to its old ways again.I have my own defined ADD, UPDATE, and DELETE methods that use EF and set the EntityState. But, when stepping through the code for ChangePasswordAsync, I do not see any of these functions called. It is as if ChangePasswordAsync uses the base methods in EF. So, I do not know how to modify this behavior. from Ivan's answer.Note: I did post a question to try and understand how the ChangePasswordAsync method calls EF here [Can someone please explain how the ChangePasswordAsnyc method works?][1].namespace ABC.Model.AspNetCore namespace ABC.Model.Clients EntitiesRepo <code>  objResult = await this.UserManager.ChangePasswordAsync(objUser, objChangePassword.OldPassword, objChangePassword.NewPassword); [HttpPost(""/[controller]/change-password"")]public async Task<IActionResult> ChangePasswordAsync([FromBody] ChangePassword objChangePassword){ AspNetUsers objUser = null; IdentityResult objResult = null; // retrieve strUserId from the token. objUser = await this.UserManager.FindByIdAsync(strUserId); objResult = await this.UserManager.ChangePasswordAsync(objUser, objChangePassword.OldPassword, objChangePassword.NewPassword); if (!objResult.Succeeded) { // Handle error. } return this.Ok(new User(objUser));} using ABC.Common.Interfaces;using ABC.Model.Clients;using Microsoft.AspNetCore.Identity;using System;using System.ComponentModel.DataAnnotations;using System.ComponentModel.DataAnnotations.Schema;namespace ABC.Model.AspNetCore{ // Class for AspNetUsers model public class AspNetUsers : IdentityUser { public AspNetUsers() { // Construct the AspNetUsers object to have some default values here. } public AspNetUsers(User objUser) : this() { // Populate the values of the AspNetUsers object with the values found in the objUser passed if it is not null. if (objUser != null) { this.UserId = objUser.UserId; // This is the problem field. this.Email = objUser.Email; this.Id = objUser.AspNetUsersId; // Other fields. } } // All of the properties added to the IdentityUser base class that are extra fields in the AspNetUsers table. [DatabaseGenerated(DatabaseGeneratedOption.Identity)] [Key] public int UserId { get; set; } // Other fields. }} using ABC.Model.AspNetCore;using JsonApiDotNetCore.Models;using System;using System.ComponentModel.DataAnnotations;namespace ABC.Model.Clients{ public class User : Identifiable { public User() { // Construct the User object to have some default values show when creating a new object. } public User(AspNetUsers objUser) : this() { // Populate the values of the User object with the values found in the objUser passed if it is not null. if (objUser != null) { this.AspNetUsersId = objUser.Id; this.Id = objUser.UserId; // Since the Identifiable is of type Identifiable<int> we use the UserIdas the Id value. this.Email = objUser.Email; // Other fields. } } // Properties [Attr(""asp-net-users-id"")] public string AspNetUsersId { get; set; } [Attr(""user-id"")] public int UserId { get; set; } [Attr(""email"")] public string Email { get; set; } [Attr(""user-name"")] public string UserName { get; set; } // Other fields. }} using Microsoft.EntityFrameworkCore;using System;using System.Collections.Generic;using System.Linq;using System.Linq.Expressions;namespace ABC.Data.Infrastructure{ public abstract class EntitiesRepositoryBase<T> where T : class { #region Member Variables protected Entities m_DbContext = null; protected DbSet<T> m_DbSet = null; #endregion public virtual void Update(T objEntity) { this.m_DbSet.Attach(objEntity); this.DbContext.Entry(objEntity).State = EntityState.Modified; } }}",".NET Core 3.1 ChangePasswordAsync Inner Exception ""Cannot update Identity column"""
".NET Core 3.1 ChangePasswordAsnyc Inner Exception ""Cannot update Identity column"""," I am upgrading a .NET Core Web API from 2.2 to 3.1. When testing the ChangePasswordAsync function, I receive the following error message: Cannot update identity column 'UserId'.I ran a SQL Profile and I can see that the Identity column is not included in the 2.2 UPDATE statement but it is in 3.1. The line of code in question returns NULL, as opposed to success or errors, and is as follows: The implementation of the ChangePasswordAsnyc is as follows (code truncated for brevity). Note: AspNetUsers extends IdentityUser. The UserId is included in the objResult, along with a lot of other fields, which is then returned at the end of the method. From what I can tell, without being able to step through the ChangePasswordAsync method, the function updates all fields that are contained in the objUser. Question:How do I suppress the identity column from being populated in the UPDATE statement that ChangePasswordAsnyc is generating? Do I need to add an attribute in the model? Do I need to remove the UserId from the objUser before passing it into the ChangePasswordAsync? Or, something else?Bounty QuestionI have created a custom user class that extends the IdentityUser class. In this custom class, there is an additional IDENTITY column. In upgrading the .NET Core 2.2 to 3.1, the ChangePasswordAsync function no longer works because the 3.1 method is trying to UPDATE this IDENTITY column whereas this does not happen in 2.1.There was no code change other than upgrading an installing the relevant packages. The accepted answer needs to fix the problem.UPDATEMigrations are not used as this results in a forced marriage between the database and the Web API with it's associated models. In my opinion, this violated the separation of duties between database, API, and UI. But, that's Microsoft up to its old ways again.I have my own defined ADD, UPDATE, and DELETE methods that use EF and set the EntityState. But, when stepping through the code for ChangePasswordAsync, I do not see any of these functions called. It is as if ChangePasswordAsync uses the base methods in EF. So, I do not know how to modify this behavior. from Ivan's answer.Note: I did post a question to try and understand how the ChangePasswordAsync method calls EF here [Can someone please explain how the ChangePasswordAsnyc method works?][1].namespace ABC.Model.AspNetCore namespace ABC.Model.Clients EntitiesRepo <code>  objResult = await this.UserManager.ChangePasswordAsync(objUser, objChangePassword.OldPassword, objChangePassword.NewPassword); [HttpPost(""/[controller]/change-password"")]public async Task<IActionResult> ChangePasswordAsync([FromBody] ChangePassword objChangePassword){ AspNetUsers objUser = null; IdentityResult objResult = null; // retrieve strUserId from the token. objUser = await this.UserManager.FindByIdAsync(strUserId); objResult = await this.UserManager.ChangePasswordAsync(objUser, objChangePassword.OldPassword, objChangePassword.NewPassword); if (!objResult.Succeeded) { // Handle error. } return this.Ok(new User(objUser));} using ABC.Common.Interfaces;using ABC.Model.Clients;using Microsoft.AspNetCore.Identity;using System;using System.ComponentModel.DataAnnotations;using System.ComponentModel.DataAnnotations.Schema;namespace ABC.Model.AspNetCore{ // Class for AspNetUsers model public class AspNetUsers : IdentityUser { public AspNetUsers() { // Construct the AspNetUsers object to have some default values here. } public AspNetUsers(User objUser) : this() { // Populate the values of the AspNetUsers object with the values found in the objUser passed if it is not null. if (objUser != null) { this.UserId = objUser.UserId; // This is the problem field. this.Email = objUser.Email; this.Id = objUser.AspNetUsersId; // Other fields. } } // All of the properties added to the IdentityUser base class that are extra fields in the AspNetUsers table. [DatabaseGenerated(DatabaseGeneratedOption.Identity)] [Key] public int UserId { get; set; } // Other fields. }} using ABC.Model.AspNetCore;using JsonApiDotNetCore.Models;using System;using System.ComponentModel.DataAnnotations;namespace ABC.Model.Clients{ public class User : Identifiable { public User() { // Construct the User object to have some default values show when creating a new object. } public User(AspNetUsers objUser) : this() { // Populate the values of the User object with the values found in the objUser passed if it is not null. if (objUser != null) { this.AspNetUsersId = objUser.Id; this.Id = objUser.UserId; // Since the Identifiable is of type Identifiable<int> we use the UserIdas the Id value. this.Email = objUser.Email; // Other fields. } } // Properties [Attr(""asp-net-users-id"")] public string AspNetUsersId { get; set; } [Attr(""user-id"")] public int UserId { get; set; } [Attr(""email"")] public string Email { get; set; } [Attr(""user-name"")] public string UserName { get; set; } // Other fields. }} using Microsoft.EntityFrameworkCore;using System;using System.Collections.Generic;using System.Linq;using System.Linq.Expressions;namespace ABC.Data.Infrastructure{ public abstract class EntitiesRepositoryBase<T> where T : class { #region Member Variables protected Entities m_DbContext = null; protected DbSet<T> m_DbSet = null; #endregion public virtual void Update(T objEntity) { this.m_DbSet.Attach(objEntity); this.DbContext.Entry(objEntity).State = EntityState.Modified; } }}",".NET Core 3.1 ChangePasswordAsync Inner Exception ""Cannot update Identity column"""
Invoke changes in blazor web assembly page when adding a new student via signal r service," I have a blazor web assembly project and a signal r service project I would like to invoke the changes to the ui when I add a student.Currently I have to refesh the page to see the addition.StudentService.cs Students.razor Students hub in another project. <code>  public class StudentService{ public HubConnection connection; public StudentServicen() { connection = new HubConnectionBuilder() .WithUrl("".../StudentsHub"") .Build(); connection.StartAsync(); } public async Task<List<Students>> GetAllStudents() => await connection.InvokeAsync<List<Students>>(""GetAllStudents"")); public async Task<Boolean> AddStudent(StudentData student) => await connection.InvokeAsync<Boolean>(""AddStudent"", student);} @inject StudentService StudentService<ul > @foreach (var student in students) { <li>@student.Name</li> } </ul>@code { private List<Students> students = new List<Students>(); protected override async Task OnInitializedAsync(){ students = await StudentService.GetAllStudents(); } public class StudentsHub : Hub{ public Task<List<Students>> GetAllStudents() => Task.FromResult(getAllStudents.GetAll()); public Boolean AddStudent(StudentData student) => studentService.AddStudent(student);}",Notify all clients of added student and update ui
How to change items inside double?," How can I change items in my double variable based on a simple condition?Check this example: After executing the function setDouble(), these values didn't change. No errors found. How can I fix this? <code>  public partial class Form1 : Form{ double[] vk = new double[11] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }; ... ... void setDouble() { if (bunifuDropdown1.selectedIndex == 0) { double[] vk = new double[11] { 2, 4.86, 11.81, 28.68, 69.64, 169.13, 410.75, 997.55, 2422.61, 5883.49, 21000 }; } if (bunifuDropdown1.selectedIndex == 1) { double[] vk = new double[11] { 2, 4.51, 10.14, 22.81, 51.31, 115.46, 259.78, 584.51, 1315.14, 2959.07, 21000 }; } if (bunifuDropdown1.selectedIndex == 2) { double[] vk = new double[11] { 2, 6.86, 18.67, 47.33, 116.94, 286.01, 696.59, 1693.71, 4115.30, 9996.29, 21000 }; } if (bunifuDropdown1.selectedIndex == 3) { double[] vk = new double[11] { 2, 6.51, 16.64, 39.43, 90.72, 206.12, 465.78, 1049.99, 2364.49, 5322.09, 21000 }; } if (bunifuDropdown1.selectedIndex == 4) { double[] vk = new double[11] { 2, 6.86, 18.67, 47.33, 108.94, 264.58, 642.55, 1560.47, 3789.71, 9203.58, 21000 }; } if (bunifuDropdown1.selectedIndex == 5) { double[] vk = new double[11] { 2, 6.51, 16.64, 39.43, 82.72, 186.12, 418.78, 942.24, 2120.05, 4770.11, 21000 }; } }",How can I change items inside a double array?
How to change items inside double array?," How can I change items in my double variable based on a simple condition?Check this example: After executing the function setDouble(), these values didn't change. No errors found. How can I fix this? <code>  public partial class Form1 : Form{ double[] vk = new double[11] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }; ... ... void setDouble() { if (bunifuDropdown1.selectedIndex == 0) { double[] vk = new double[11] { 2, 4.86, 11.81, 28.68, 69.64, 169.13, 410.75, 997.55, 2422.61, 5883.49, 21000 }; } if (bunifuDropdown1.selectedIndex == 1) { double[] vk = new double[11] { 2, 4.51, 10.14, 22.81, 51.31, 115.46, 259.78, 584.51, 1315.14, 2959.07, 21000 }; } if (bunifuDropdown1.selectedIndex == 2) { double[] vk = new double[11] { 2, 6.86, 18.67, 47.33, 116.94, 286.01, 696.59, 1693.71, 4115.30, 9996.29, 21000 }; } if (bunifuDropdown1.selectedIndex == 3) { double[] vk = new double[11] { 2, 6.51, 16.64, 39.43, 90.72, 206.12, 465.78, 1049.99, 2364.49, 5322.09, 21000 }; } if (bunifuDropdown1.selectedIndex == 4) { double[] vk = new double[11] { 2, 6.86, 18.67, 47.33, 108.94, 264.58, 642.55, 1560.47, 3789.71, 9203.58, 21000 }; } if (bunifuDropdown1.selectedIndex == 5) { double[] vk = new double[11] { 2, 6.51, 16.64, 39.43, 82.72, 186.12, 418.78, 942.24, 2120.05, 4770.11, 21000 }; } }",How can I change items inside a double array?
What is ValueChanged and ValueExpression used for in Blazor?," I'm seeing this common pattern in some libraries (MatBlazor, Telerik) of having ValueChanged and ValueExpression properties and it really confuses me.What is the difference between both? And when to use it? <code> ",When to use ValueChanged and ValueExpression in Blazor?
What is the best way to implement equality for readonly structs in C# ( 7.2 <= verson)?," I've just started to program in C# last year and I'm still learning the language. I have a question regarding readonly struct type and equality comparison methods.When creating a struct in C#, I know it's usually considered to be a best practice to implement IEquatable as the default reflection-based comparison is very slow. I also learned that in C# 7.2 and later we can define readonly structs and for these types, we can also use in parameter to avoid unnecessary copying.As structs are usually defined as immutable readonly types, I suppose it's not unusual to define Equals methods for read only structs.Given the above facts, however, what I'm wondering is if there is a good effective way to implement equality comparison methods for them. My point is that none of these equality methods and operators actually need to modify parameters so I want to utilize in parameters somehow to save unnecessary copying.Below is my attempt at doing this: The above certainly works but I think it's not perfect solution as copying is still needed if it's called through the IEquatable interface. Note that I can't just implement IEquatable implicitly with in param as Equal method taking in modifier is considered to have different signature and treated as an overload.Is there a known best practice to implement this correctly?What I would really like to know is if there is a known best practices and patterns to effectively implement equality for such readonly structs. Especially I'm interested in a way to properly utilize in parameter modifier for implementing Equality comparison methods.So far I haven't found any satisfactory answer on the Web, and I also checked some source codes of the core library. For example, System.DateTime is now defined as readonly struct and it's rather big, but in parameter isn't utilized t here. (Existing type might well need to keep compatibility, I know they often need to have compromise, though.)Note that the Point struct defined above is small composing only two 32 bit slot, so copying might not actually be a big problem here, but it's just meant for a simple illustrative example.Update for .NET6(C# 10)Now that C#10 has officially been released, the original question has become almost obsolete. We can now create such a read only struct as an readonly record struct. Of course depending of your model, it can also defined as a normal refence type record (class).https://devblogs.microsoft.com/dotnet/welcome-to-csharp-10/The point is that optimized equality comparison methods and operators are automatically generated for record types. <code>  public readonly struct Point : IEquatable<Point>{ public int X { get; } public int Y { get; } public Point(int x, int y) { X = x; Y = y; } // Explicitly implementing IEquatable<Point> and delegating to an Equals method taking in param. bool IEquatable<Point>.Equals(Point other) => Equals(other); public bool Equals(in Point other) => X == other.X && Y == other.Y; public override bool Equals(object? obj) => obj is Point other && Equals(other); public static bool operator ==(in Point left, in Point right) => left.Equals(right); public static bool operator !=(in Point left, in Point right) => !left.Equals(right); public override int GetHashCode() => HashCode.Combine(X, Y); public override string ToString() => $""Point({X}, {Y})"";} public readonly record struct Person { public string FirstName { get; init; } public string LastName { get; init; } }",What is the best practice to implement equality for readonly structs?
What is the best way to implement equality for readonly structs in C# ( 7.2 <= version)?," I've just started to program in C# last year and I'm still learning the language. I have a question regarding readonly struct type and equality comparison methods.When creating a struct in C#, I know it's usually considered to be a best practice to implement IEquatable as the default reflection-based comparison is very slow. I also learned that in C# 7.2 and later we can define readonly structs and for these types, we can also use in parameter to avoid unnecessary copying.As structs are usually defined as immutable readonly types, I suppose it's not unusual to define Equals methods for read only structs.Given the above facts, however, what I'm wondering is if there is a good effective way to implement equality comparison methods for them. My point is that none of these equality methods and operators actually need to modify parameters so I want to utilize in parameters somehow to save unnecessary copying.Below is my attempt at doing this: The above certainly works but I think it's not perfect solution as copying is still needed if it's called through the IEquatable interface. Note that I can't just implement IEquatable implicitly with in param as Equal method taking in modifier is considered to have different signature and treated as an overload.Is there a known best practice to implement this correctly?What I would really like to know is if there is a known best practices and patterns to effectively implement equality for such readonly structs. Especially I'm interested in a way to properly utilize in parameter modifier for implementing Equality comparison methods.So far I haven't found any satisfactory answer on the Web, and I also checked some source codes of the core library. For example, System.DateTime is now defined as readonly struct and it's rather big, but in parameter isn't utilized t here. (Existing type might well need to keep compatibility, I know they often need to have compromise, though.)Note that the Point struct defined above is small composing only two 32 bit slot, so copying might not actually be a big problem here, but it's just meant for a simple illustrative example.Update for .NET6(C# 10)Now that C#10 has officially been released, the original question has become almost obsolete. We can now create such a read only struct as an readonly record struct. Of course depending of your model, it can also defined as a normal refence type record (class).https://devblogs.microsoft.com/dotnet/welcome-to-csharp-10/The point is that optimized equality comparison methods and operators are automatically generated for record types. <code>  public readonly struct Point : IEquatable<Point>{ public int X { get; } public int Y { get; } public Point(int x, int y) { X = x; Y = y; } // Explicitly implementing IEquatable<Point> and delegating to an Equals method taking in param. bool IEquatable<Point>.Equals(Point other) => Equals(other); public bool Equals(in Point other) => X == other.X && Y == other.Y; public override bool Equals(object? obj) => obj is Point other && Equals(other); public static bool operator ==(in Point left, in Point right) => left.Equals(right); public static bool operator !=(in Point left, in Point right) => !left.Equals(right); public override int GetHashCode() => HashCode.Combine(X, Y); public override string ToString() => $""Point({X}, {Y})"";} public readonly record struct Person { public string FirstName { get; init; } public string LastName { get; init; } }",What is the best practice to implement equality for readonly structs?
What is the best practice to implement equality for readonly structs in C# ( 7.2 <= version)?," I've just started to program in C# last year and I'm still learning the language. I have a question regarding readonly struct type and equality comparison methods.When creating a struct in C#, I know it's usually considered to be a best practice to implement IEquatable as the default reflection-based comparison is very slow. I also learned that in C# 7.2 and later we can define readonly structs and for these types, we can also use in parameter to avoid unnecessary copying.As structs are usually defined as immutable readonly types, I suppose it's not unusual to define Equals methods for read only structs.Given the above facts, however, what I'm wondering is if there is a good effective way to implement equality comparison methods for them. My point is that none of these equality methods and operators actually need to modify parameters so I want to utilize in parameters somehow to save unnecessary copying.Below is my attempt at doing this: The above certainly works but I think it's not perfect solution as copying is still needed if it's called through the IEquatable interface. Note that I can't just implement IEquatable implicitly with in param as Equal method taking in modifier is considered to have different signature and treated as an overload.Is there a known best practice to implement this correctly?What I would really like to know is if there is a known best practices and patterns to effectively implement equality for such readonly structs. Especially I'm interested in a way to properly utilize in parameter modifier for implementing Equality comparison methods.So far I haven't found any satisfactory answer on the Web, and I also checked some source codes of the core library. For example, System.DateTime is now defined as readonly struct and it's rather big, but in parameter isn't utilized t here. (Existing type might well need to keep compatibility, I know they often need to have compromise, though.)Note that the Point struct defined above is small composing only two 32 bit slot, so copying might not actually be a big problem here, but it's just meant for a simple illustrative example.Update for .NET6(C# 10)Now that C#10 has officially been released, the original question has become almost obsolete. We can now create such a read only struct as an readonly record struct. Of course depending of your model, it can also defined as a normal refence type record (class).https://devblogs.microsoft.com/dotnet/welcome-to-csharp-10/The point is that optimized equality comparison methods and operators are automatically generated for record types. <code>  public readonly struct Point : IEquatable<Point>{ public int X { get; } public int Y { get; } public Point(int x, int y) { X = x; Y = y; } // Explicitly implementing IEquatable<Point> and delegating to an Equals method taking in param. bool IEquatable<Point>.Equals(Point other) => Equals(other); public bool Equals(in Point other) => X == other.X && Y == other.Y; public override bool Equals(object? obj) => obj is Point other && Equals(other); public static bool operator ==(in Point left, in Point right) => left.Equals(right); public static bool operator !=(in Point left, in Point right) => !left.Equals(right); public override int GetHashCode() => HashCode.Combine(X, Y); public override string ToString() => $""Point({X}, {Y})"";} public readonly record struct Person { public string FirstName { get; init; } public string LastName { get; init; } }",What is the best practice to implement equality for readonly structs?
Overload Resolution with two implicit conversions," I basically want two separate overloads for string/FormattableString (the background is that I want to nudge people towards using string constants for log messages and pass parameters via structured logging instead of the log message to simplify analysis. So the FormattableString logging method would be obsoleted). Now due to the way the compiler works, you cannot directly overload the methods, because a FormattableString devolves to a string before it's being passed. What does work though is to have a wrapper struct that defines implicit overloads: So far so good. What I don't understand: Why does removing the cause the call Log($""Hello"") to become ambiguous? CS0121 The call is ambiguous between the following methods or properties: Test.Log(StringIfNotFormattableStringAdapter)' and 'Test.Log(FormattableString)'` <code>  public struct StringIfNotFormattableStringAdapter{ public string StringValue { get; } private StringIfNotFormattableStringAdapter(string s) { StringValue = s; } public static implicit operator StringIfNotFormattableStringAdapter(string s) { return new StringIfNotFormattableStringAdapter(s); } public static implicit operator StringIfNotFormattableStringAdapter(FormattableString fs) { throw new InvalidOperationException(""This only exists to allow correct overload resolution. "" + ""This should never be called since the FormattableString overload should be preferred to this.""); }}public static class Test{ public static void Log(StringIfNotFormattableStringAdapter msg) { } public static void Log(FormattableString msg) { } public static void Foo() { Log(""Hello""); // resolves to StringIfNotFormattableStringAdapter overload Log($""Hello""); // resolves to FormattableString overload } } implicit operator StringIfNotFormattableStringAdapter(FormattableString fs)",Overload Resolution with implicit conversions
Validate string based on custom format in C#," I want to validate a string based on custom format: (_.__,_.__). This should be a decimal input followed by a comma followed by another decimal input, wrapped in a parenthesese.g.(1.01,3.21). I want the string pattern to accept one and more entriese.g.(1.01,3.21)(3.01,4.51)...(2.1,5.6). Is it possible to do that? <code> ",String validation based on a custom format
Change the provider of crystal report by code," I am trying to change the provider of my Crystal Reports from OLEDBSQL to MSOLEDBSQL as OLEDBSQL does not support TLS 1.2My Code: Im using the following Crystal Report Versions:I have noted the followingCalling verifyDatabase() or refresh() on the ReportDocument changes the provider property back into original.I have tried the ApplyLogOnInfo() - Found that it only reset the username and password and not the provider. Calling this method also resets the changed provider.Now that I've managed to change the Provider by the following code, but It always reset the provider to the original provider.How can this be done?Are there any workarounds for this?Further UpdateI was able to change the provider to MSOLEDBSQL in the main report by using the code suggested by Frank (With thanks) below. But still, it fails for the subreports and gives the following error.Not supported within subreportsFurther Update (2) - on Subreport provider changeI was able to change the provider for Crystal Report Subreports by the following code. Lessons LearntNoticed that, I can not update the driver if the installed CrystalReport Runtime does not match with the Visual studio references (I have taken the DLLs from some Nuget packages that are not official releases). ICouldn't make the code work with Crystal Reports 10.5.3700 that I usedand I updated the runtime to 13.0.2000 (As per this article)Crystal Reports also have tight rules with the processor architecture.Since I'm using a 32bit version, I have set all the settings in VisualStudio to compile the project as a 32bit app. <code>  Private Sub ProcessReport() Dim crxRpt As New CrystalDecisions.CrystalReports.Engine.ReportDocument crxRpt.Load(""D:\RND\Crystal Reports - Connector\CrystallReportConvertVB\SummaryReport.rpt"") ChangeOleDbConnectionInfo(crxRpt, ""SERVER"", ""DBNAME"", ""MSOLEDBSQL"", False, ""USERID"", ""PASSWORD"")End SubFriend Shared Sub ChangeOleDbConnectionInfo(ByVal reportDocument As ReportDocument, ByVal server As String, ByVal database As String, ByVal oledbProvider As String, ByVal integratedSecurity As Boolean, ByVal userId As String, ByVal password As String) Dim boMainPropertyBag = New NameValuePairs2() Dim boInnerPropertyBag = New NameValuePairs2() boInnerPropertyBag.Add(New NameValuePair2(""Application Intent"", ""READWRITE"")) boInnerPropertyBag.Add(New NameValuePair2(""Auto Translate"", ""-1"")) boInnerPropertyBag.Add(New NameValuePair2(""Connect Timeout"", ""15"")) boInnerPropertyBag.Add(New NameValuePair2(""Data Source"", server)) boInnerPropertyBag.Add(New NameValuePair2(""DataTypeCompatibility"", ""0"")) boInnerPropertyBag.Add(New NameValuePair2(""General Timeout"", ""0"")) boInnerPropertyBag.Add(New NameValuePair2(""Initial Catalog"", database)) boInnerPropertyBag.Add(New NameValuePair2(""Integrated Security"", If(integratedSecurity, ""True"", ""False""))) boInnerPropertyBag.Add(New NameValuePair2(""Locale Identifier"", ""1033"")) boInnerPropertyBag.Add(New NameValuePair2(""MARS Connection"", ""0"")) boInnerPropertyBag.Add(New NameValuePair2(""OLE DB Services"", ""-5"")) boInnerPropertyBag.Add(New NameValuePair2(""Provider"", oledbProvider)) boInnerPropertyBag.Add(New NameValuePair2(""Tag with column collation when possible"", ""0"")) boInnerPropertyBag.Add(New NameValuePair2(""Trust Server Certificate"", ""0"")) boInnerPropertyBag.Add(New NameValuePair2(""Use DSN Default Properties"", ""False"")) boInnerPropertyBag.Add(New NameValuePair2(""Use Encryption for Data"", ""0"")) boMainPropertyBag.Add(New NameValuePair2(""Database DLL"", ""crdb_ado.dll"")) boMainPropertyBag.Add(New NameValuePair2(""QE_DatabaseName"", database)) boMainPropertyBag.Add(New NameValuePair2(""QE_DatabaseType"", ""OLE DB (ADO)"")) boMainPropertyBag.Add(New NameValuePair2(""QE_LogonProperties"", boInnerPropertyBag)) boMainPropertyBag.Add(New NameValuePair2(""QE_ServerDescription"", server)) boMainPropertyBag.Add(New NameValuePair2(""QE_SQLDB"", ""True"")) boMainPropertyBag.Add(New NameValuePair2(""SSO Enabled"", ""False"")) Dim conAttributes As New CrystalDecisions.Shared.DbConnectionAttributes() conAttributes.Collection = boMainPropertyBag Dim boConnectionInfo = New ConnectionInfo With { .Attributes = conAttributes, .DatabaseName = database, .ServerName = server } If Not integratedSecurity Then boConnectionInfo.UserID = userId boConnectionInfo.Password = password End If Dim myTables As CrystalDecisions.CrystalReports.Engine.Tables = reportDocument.Database.Tables For Each myTable As CrystalDecisions.CrystalReports.Engine.Table In reportDocument.Database.Tables Dim myTableLogonInfo As CrystalDecisions.Shared.TableLogOnInfo = myTable.LogOnInfo myTableLogonInfo.ConnectionInfo.Attributes.Collection.Clear() myTableLogonInfo.ConnectionInfo.Attributes = boConnectionInfo.Attributes Next Dim mySections As CrystalDecisions.CrystalReports.Engine.Sections = reportDocument.ReportDefinition.Sections For Each mySection As CrystalDecisions.CrystalReports.Engine.Section In mySections Dim myReportObjects As CrystalDecisions.CrystalReports.Engine.ReportObjects = mySection.ReportObjects For Each myReportObject As CrystalDecisions.CrystalReports.Engine.ReportObject In myReportObjects If myReportObject.Kind = CrystalDecisions.Shared.ReportObjectKind.SubreportObject Then Dim mySubreportObject As CrystalDecisions.CrystalReports.Engine.SubreportObject = CType(myReportObject, CrystalDecisions.CrystalReports.Engine.SubreportObject) Dim subReportDocument As CrystalDecisions.CrystalReports.Engine.ReportDocument = mySubreportObject.OpenSubreport(mySubreportObject.SubreportName) Dim mytablessub As CrystalDecisions.CrystalReports.Engine.Tables = subReportDocument.Database.Tables For Each myTable As CrystalDecisions.CrystalReports.Engine.Table In mytablessub Dim myTableLogonInfo As CrystalDecisions.Shared.TableLogOnInfo = myTable.LogOnInfo myTableLogonInfo.ConnectionInfo.Attributes.Collection.Clear() myTableLogonInfo.ConnectionInfo.Attributes = boConnectionInfo.Attributes Next End If Next Next reportDocument.VerifyDatabase() reportDocument.SaveAs(""D:\RND\Crystal Reports - Connector\CrystallReportConvertVB\CrystallReportConvertVB\Rpt-changed3.rpt"")End Sub Friend Shared Function ChangeOleDbConnectionInfoSubReports(ByVal reportDocument As ReportDocument, ByVal server As String, ByVal database As String, ByVal schema As String, ByVal oledbProvider As String, ByVal integratedSecurity As Boolean, ByVal userId As String, ByVal password As String) As ReportDocument Dim boInnerPropertyBag = New PropertyBag() boInnerPropertyBag.Add(""Application Intent"", ""READWRITE"") boInnerPropertyBag.Add(""Auto Translate"", ""-1"") boInnerPropertyBag.Add(""Connect Timeout"", ""15"") boInnerPropertyBag.Add(""Data Source"", server) boInnerPropertyBag.Add(""DataTypeCompatibility"", ""0"") boInnerPropertyBag.Add(""General Timeout"", ""0"") boInnerPropertyBag.Add(""Initial Catalog"", database) boInnerPropertyBag.Add(""Integrated Security"", If(integratedSecurity, ""True"", ""False"")) boInnerPropertyBag.Add(""Locale Identifier"", ""1033"") boInnerPropertyBag.Add(""MARS Connection"", ""0"") boInnerPropertyBag.Add(""OLE DB Services"", ""-5"") boInnerPropertyBag.Add(""Provider"", oledbProvider) boInnerPropertyBag.Add(""Tag with column collation when possible"", ""0"") boInnerPropertyBag.Add(""Trust Server Certificate"", ""0"") boInnerPropertyBag.Add(""Use DSN Default Properties"", ""False"") boInnerPropertyBag.Add(""Use Encryption for Data"", ""0"") Dim boMainPropertyBag = New PropertyBag() boMainPropertyBag.Add(""Database DLL"", ""crdb_ado.dll"") boMainPropertyBag.Add(""QE_DatabaseName"", database) boMainPropertyBag.Add(""QE_DatabaseType"", ""OLE DB (ADO)"") boMainPropertyBag.Add(""QE_LogonProperties"", boInnerPropertyBag) boMainPropertyBag.Add(""QE_ServerDescription"", server) boMainPropertyBag.Add(""QE_SQLDB"", ""True"") boMainPropertyBag.Add(""SSO Enabled"", ""False"") Dim boConnectionInfo = New CrystalDecisions.ReportAppServer.DataDefModel.ConnectionInfo With { .Attributes = boMainPropertyBag, .Kind = CrConnectionInfoKindEnum.crConnectionInfoKindCRQE } If Not integratedSecurity Then boConnectionInfo.UserName = userId boConnectionInfo.Password = password End If For Each subreport As ReportDocument In reportDocument.Subreports For Each table As CrystalDecisions.ReportAppServer.DataDefModel.Table In reportDocument.ReportClientDocument.SubreportController.GetSubreportDatabase(subreport.Name).Tables Dim boTable = New CrystalDecisions.ReportAppServer.DataDefModel.Table With { .ConnectionInfo = boConnectionInfo, .Name = table.Name, .QualifiedName = schema & ""."" & table.Name, .[Alias] = table.[Alias] } reportDocument.ReportClientDocument.SubreportController.SetTableLocation(subreport.Name, table, boTable) Next Next reportDocument.VerifyDatabase() Return reportDocumentEnd Function",Crystal Reports - change the provider from OLEDBSQL to MSOLEDBSQL to support TLS 1.2 by code
Change the provider of crystal report from OLEDBSQL to MSOLEDBSQL by code," I am trying to change the provider of my Crystal Reports from OLEDBSQL to MSOLEDBSQL as OLEDBSQL does not support TLS 1.2My Code: Im using the following Crystal Report Versions:I have noted the followingCalling verifyDatabase() or refresh() on the ReportDocument changes the provider property back into original.I have tried the ApplyLogOnInfo() - Found that it only reset the username and password and not the provider. Calling this method also resets the changed provider.Now that I've managed to change the Provider by the following code, but It always reset the provider to the original provider.How can this be done?Are there any workarounds for this?Further UpdateI was able to change the provider to MSOLEDBSQL in the main report by using the code suggested by Frank (With thanks) below. But still, it fails for the subreports and gives the following error.Not supported within subreportsFurther Update (2) - on Subreport provider changeI was able to change the provider for Crystal Report Subreports by the following code. Lessons LearntNoticed that, I can not update the driver if the installed CrystalReport Runtime does not match with the Visual studio references (I have taken the DLLs from some Nuget packages that are not official releases). ICouldn't make the code work with Crystal Reports 10.5.3700 that I usedand I updated the runtime to 13.0.2000 (As per this article)Crystal Reports also have tight rules with the processor architecture.Since I'm using a 32bit version, I have set all the settings in VisualStudio to compile the project as a 32bit app. <code>  Private Sub ProcessReport() Dim crxRpt As New CrystalDecisions.CrystalReports.Engine.ReportDocument crxRpt.Load(""D:\RND\Crystal Reports - Connector\CrystallReportConvertVB\SummaryReport.rpt"") ChangeOleDbConnectionInfo(crxRpt, ""SERVER"", ""DBNAME"", ""MSOLEDBSQL"", False, ""USERID"", ""PASSWORD"")End SubFriend Shared Sub ChangeOleDbConnectionInfo(ByVal reportDocument As ReportDocument, ByVal server As String, ByVal database As String, ByVal oledbProvider As String, ByVal integratedSecurity As Boolean, ByVal userId As String, ByVal password As String) Dim boMainPropertyBag = New NameValuePairs2() Dim boInnerPropertyBag = New NameValuePairs2() boInnerPropertyBag.Add(New NameValuePair2(""Application Intent"", ""READWRITE"")) boInnerPropertyBag.Add(New NameValuePair2(""Auto Translate"", ""-1"")) boInnerPropertyBag.Add(New NameValuePair2(""Connect Timeout"", ""15"")) boInnerPropertyBag.Add(New NameValuePair2(""Data Source"", server)) boInnerPropertyBag.Add(New NameValuePair2(""DataTypeCompatibility"", ""0"")) boInnerPropertyBag.Add(New NameValuePair2(""General Timeout"", ""0"")) boInnerPropertyBag.Add(New NameValuePair2(""Initial Catalog"", database)) boInnerPropertyBag.Add(New NameValuePair2(""Integrated Security"", If(integratedSecurity, ""True"", ""False""))) boInnerPropertyBag.Add(New NameValuePair2(""Locale Identifier"", ""1033"")) boInnerPropertyBag.Add(New NameValuePair2(""MARS Connection"", ""0"")) boInnerPropertyBag.Add(New NameValuePair2(""OLE DB Services"", ""-5"")) boInnerPropertyBag.Add(New NameValuePair2(""Provider"", oledbProvider)) boInnerPropertyBag.Add(New NameValuePair2(""Tag with column collation when possible"", ""0"")) boInnerPropertyBag.Add(New NameValuePair2(""Trust Server Certificate"", ""0"")) boInnerPropertyBag.Add(New NameValuePair2(""Use DSN Default Properties"", ""False"")) boInnerPropertyBag.Add(New NameValuePair2(""Use Encryption for Data"", ""0"")) boMainPropertyBag.Add(New NameValuePair2(""Database DLL"", ""crdb_ado.dll"")) boMainPropertyBag.Add(New NameValuePair2(""QE_DatabaseName"", database)) boMainPropertyBag.Add(New NameValuePair2(""QE_DatabaseType"", ""OLE DB (ADO)"")) boMainPropertyBag.Add(New NameValuePair2(""QE_LogonProperties"", boInnerPropertyBag)) boMainPropertyBag.Add(New NameValuePair2(""QE_ServerDescription"", server)) boMainPropertyBag.Add(New NameValuePair2(""QE_SQLDB"", ""True"")) boMainPropertyBag.Add(New NameValuePair2(""SSO Enabled"", ""False"")) Dim conAttributes As New CrystalDecisions.Shared.DbConnectionAttributes() conAttributes.Collection = boMainPropertyBag Dim boConnectionInfo = New ConnectionInfo With { .Attributes = conAttributes, .DatabaseName = database, .ServerName = server } If Not integratedSecurity Then boConnectionInfo.UserID = userId boConnectionInfo.Password = password End If Dim myTables As CrystalDecisions.CrystalReports.Engine.Tables = reportDocument.Database.Tables For Each myTable As CrystalDecisions.CrystalReports.Engine.Table In reportDocument.Database.Tables Dim myTableLogonInfo As CrystalDecisions.Shared.TableLogOnInfo = myTable.LogOnInfo myTableLogonInfo.ConnectionInfo.Attributes.Collection.Clear() myTableLogonInfo.ConnectionInfo.Attributes = boConnectionInfo.Attributes Next Dim mySections As CrystalDecisions.CrystalReports.Engine.Sections = reportDocument.ReportDefinition.Sections For Each mySection As CrystalDecisions.CrystalReports.Engine.Section In mySections Dim myReportObjects As CrystalDecisions.CrystalReports.Engine.ReportObjects = mySection.ReportObjects For Each myReportObject As CrystalDecisions.CrystalReports.Engine.ReportObject In myReportObjects If myReportObject.Kind = CrystalDecisions.Shared.ReportObjectKind.SubreportObject Then Dim mySubreportObject As CrystalDecisions.CrystalReports.Engine.SubreportObject = CType(myReportObject, CrystalDecisions.CrystalReports.Engine.SubreportObject) Dim subReportDocument As CrystalDecisions.CrystalReports.Engine.ReportDocument = mySubreportObject.OpenSubreport(mySubreportObject.SubreportName) Dim mytablessub As CrystalDecisions.CrystalReports.Engine.Tables = subReportDocument.Database.Tables For Each myTable As CrystalDecisions.CrystalReports.Engine.Table In mytablessub Dim myTableLogonInfo As CrystalDecisions.Shared.TableLogOnInfo = myTable.LogOnInfo myTableLogonInfo.ConnectionInfo.Attributes.Collection.Clear() myTableLogonInfo.ConnectionInfo.Attributes = boConnectionInfo.Attributes Next End If Next Next reportDocument.VerifyDatabase() reportDocument.SaveAs(""D:\RND\Crystal Reports - Connector\CrystallReportConvertVB\CrystallReportConvertVB\Rpt-changed3.rpt"")End Sub Friend Shared Function ChangeOleDbConnectionInfoSubReports(ByVal reportDocument As ReportDocument, ByVal server As String, ByVal database As String, ByVal schema As String, ByVal oledbProvider As String, ByVal integratedSecurity As Boolean, ByVal userId As String, ByVal password As String) As ReportDocument Dim boInnerPropertyBag = New PropertyBag() boInnerPropertyBag.Add(""Application Intent"", ""READWRITE"") boInnerPropertyBag.Add(""Auto Translate"", ""-1"") boInnerPropertyBag.Add(""Connect Timeout"", ""15"") boInnerPropertyBag.Add(""Data Source"", server) boInnerPropertyBag.Add(""DataTypeCompatibility"", ""0"") boInnerPropertyBag.Add(""General Timeout"", ""0"") boInnerPropertyBag.Add(""Initial Catalog"", database) boInnerPropertyBag.Add(""Integrated Security"", If(integratedSecurity, ""True"", ""False"")) boInnerPropertyBag.Add(""Locale Identifier"", ""1033"") boInnerPropertyBag.Add(""MARS Connection"", ""0"") boInnerPropertyBag.Add(""OLE DB Services"", ""-5"") boInnerPropertyBag.Add(""Provider"", oledbProvider) boInnerPropertyBag.Add(""Tag with column collation when possible"", ""0"") boInnerPropertyBag.Add(""Trust Server Certificate"", ""0"") boInnerPropertyBag.Add(""Use DSN Default Properties"", ""False"") boInnerPropertyBag.Add(""Use Encryption for Data"", ""0"") Dim boMainPropertyBag = New PropertyBag() boMainPropertyBag.Add(""Database DLL"", ""crdb_ado.dll"") boMainPropertyBag.Add(""QE_DatabaseName"", database) boMainPropertyBag.Add(""QE_DatabaseType"", ""OLE DB (ADO)"") boMainPropertyBag.Add(""QE_LogonProperties"", boInnerPropertyBag) boMainPropertyBag.Add(""QE_ServerDescription"", server) boMainPropertyBag.Add(""QE_SQLDB"", ""True"") boMainPropertyBag.Add(""SSO Enabled"", ""False"") Dim boConnectionInfo = New CrystalDecisions.ReportAppServer.DataDefModel.ConnectionInfo With { .Attributes = boMainPropertyBag, .Kind = CrConnectionInfoKindEnum.crConnectionInfoKindCRQE } If Not integratedSecurity Then boConnectionInfo.UserName = userId boConnectionInfo.Password = password End If For Each subreport As ReportDocument In reportDocument.Subreports For Each table As CrystalDecisions.ReportAppServer.DataDefModel.Table In reportDocument.ReportClientDocument.SubreportController.GetSubreportDatabase(subreport.Name).Tables Dim boTable = New CrystalDecisions.ReportAppServer.DataDefModel.Table With { .ConnectionInfo = boConnectionInfo, .Name = table.Name, .QualifiedName = schema & ""."" & table.Name, .[Alias] = table.[Alias] } reportDocument.ReportClientDocument.SubreportController.SetTableLocation(subreport.Name, table, boTable) Next Next reportDocument.VerifyDatabase() Return reportDocumentEnd Function",Crystal Reports - change the provider from OLEDBSQL to MSOLEDBSQL to support TLS 1.2 by code
Change the provider of Crystal Reports from OLEDBSQL to MSOLEDBSQL by code to support TLS 1.2," I am trying to change the provider of my Crystal Reports from OLEDBSQL to MSOLEDBSQL as OLEDBSQL does not support TLS 1.2My Code: Im using the following Crystal Report Versions:I have noted the followingCalling verifyDatabase() or refresh() on the ReportDocument changes the provider property back into original.I have tried the ApplyLogOnInfo() - Found that it only reset the username and password and not the provider. Calling this method also resets the changed provider.Now that I've managed to change the Provider by the following code, but It always reset the provider to the original provider.How can this be done?Are there any workarounds for this?Further UpdateI was able to change the provider to MSOLEDBSQL in the main report by using the code suggested by Frank (With thanks) below. But still, it fails for the subreports and gives the following error.Not supported within subreportsFurther Update (2) - on Subreport provider changeI was able to change the provider for Crystal Report Subreports by the following code. Lessons LearntNoticed that, I can not update the driver if the installed CrystalReport Runtime does not match with the Visual studio references (I have taken the DLLs from some Nuget packages that are not official releases). ICouldn't make the code work with Crystal Reports 10.5.3700 that I usedand I updated the runtime to 13.0.2000 (As per this article)Crystal Reports also have tight rules with the processor architecture.Since I'm using a 32bit version, I have set all the settings in VisualStudio to compile the project as a 32bit app. <code>  Private Sub ProcessReport() Dim crxRpt As New CrystalDecisions.CrystalReports.Engine.ReportDocument crxRpt.Load(""D:\RND\Crystal Reports - Connector\CrystallReportConvertVB\SummaryReport.rpt"") ChangeOleDbConnectionInfo(crxRpt, ""SERVER"", ""DBNAME"", ""MSOLEDBSQL"", False, ""USERID"", ""PASSWORD"")End SubFriend Shared Sub ChangeOleDbConnectionInfo(ByVal reportDocument As ReportDocument, ByVal server As String, ByVal database As String, ByVal oledbProvider As String, ByVal integratedSecurity As Boolean, ByVal userId As String, ByVal password As String) Dim boMainPropertyBag = New NameValuePairs2() Dim boInnerPropertyBag = New NameValuePairs2() boInnerPropertyBag.Add(New NameValuePair2(""Application Intent"", ""READWRITE"")) boInnerPropertyBag.Add(New NameValuePair2(""Auto Translate"", ""-1"")) boInnerPropertyBag.Add(New NameValuePair2(""Connect Timeout"", ""15"")) boInnerPropertyBag.Add(New NameValuePair2(""Data Source"", server)) boInnerPropertyBag.Add(New NameValuePair2(""DataTypeCompatibility"", ""0"")) boInnerPropertyBag.Add(New NameValuePair2(""General Timeout"", ""0"")) boInnerPropertyBag.Add(New NameValuePair2(""Initial Catalog"", database)) boInnerPropertyBag.Add(New NameValuePair2(""Integrated Security"", If(integratedSecurity, ""True"", ""False""))) boInnerPropertyBag.Add(New NameValuePair2(""Locale Identifier"", ""1033"")) boInnerPropertyBag.Add(New NameValuePair2(""MARS Connection"", ""0"")) boInnerPropertyBag.Add(New NameValuePair2(""OLE DB Services"", ""-5"")) boInnerPropertyBag.Add(New NameValuePair2(""Provider"", oledbProvider)) boInnerPropertyBag.Add(New NameValuePair2(""Tag with column collation when possible"", ""0"")) boInnerPropertyBag.Add(New NameValuePair2(""Trust Server Certificate"", ""0"")) boInnerPropertyBag.Add(New NameValuePair2(""Use DSN Default Properties"", ""False"")) boInnerPropertyBag.Add(New NameValuePair2(""Use Encryption for Data"", ""0"")) boMainPropertyBag.Add(New NameValuePair2(""Database DLL"", ""crdb_ado.dll"")) boMainPropertyBag.Add(New NameValuePair2(""QE_DatabaseName"", database)) boMainPropertyBag.Add(New NameValuePair2(""QE_DatabaseType"", ""OLE DB (ADO)"")) boMainPropertyBag.Add(New NameValuePair2(""QE_LogonProperties"", boInnerPropertyBag)) boMainPropertyBag.Add(New NameValuePair2(""QE_ServerDescription"", server)) boMainPropertyBag.Add(New NameValuePair2(""QE_SQLDB"", ""True"")) boMainPropertyBag.Add(New NameValuePair2(""SSO Enabled"", ""False"")) Dim conAttributes As New CrystalDecisions.Shared.DbConnectionAttributes() conAttributes.Collection = boMainPropertyBag Dim boConnectionInfo = New ConnectionInfo With { .Attributes = conAttributes, .DatabaseName = database, .ServerName = server } If Not integratedSecurity Then boConnectionInfo.UserID = userId boConnectionInfo.Password = password End If Dim myTables As CrystalDecisions.CrystalReports.Engine.Tables = reportDocument.Database.Tables For Each myTable As CrystalDecisions.CrystalReports.Engine.Table In reportDocument.Database.Tables Dim myTableLogonInfo As CrystalDecisions.Shared.TableLogOnInfo = myTable.LogOnInfo myTableLogonInfo.ConnectionInfo.Attributes.Collection.Clear() myTableLogonInfo.ConnectionInfo.Attributes = boConnectionInfo.Attributes Next Dim mySections As CrystalDecisions.CrystalReports.Engine.Sections = reportDocument.ReportDefinition.Sections For Each mySection As CrystalDecisions.CrystalReports.Engine.Section In mySections Dim myReportObjects As CrystalDecisions.CrystalReports.Engine.ReportObjects = mySection.ReportObjects For Each myReportObject As CrystalDecisions.CrystalReports.Engine.ReportObject In myReportObjects If myReportObject.Kind = CrystalDecisions.Shared.ReportObjectKind.SubreportObject Then Dim mySubreportObject As CrystalDecisions.CrystalReports.Engine.SubreportObject = CType(myReportObject, CrystalDecisions.CrystalReports.Engine.SubreportObject) Dim subReportDocument As CrystalDecisions.CrystalReports.Engine.ReportDocument = mySubreportObject.OpenSubreport(mySubreportObject.SubreportName) Dim mytablessub As CrystalDecisions.CrystalReports.Engine.Tables = subReportDocument.Database.Tables For Each myTable As CrystalDecisions.CrystalReports.Engine.Table In mytablessub Dim myTableLogonInfo As CrystalDecisions.Shared.TableLogOnInfo = myTable.LogOnInfo myTableLogonInfo.ConnectionInfo.Attributes.Collection.Clear() myTableLogonInfo.ConnectionInfo.Attributes = boConnectionInfo.Attributes Next End If Next Next reportDocument.VerifyDatabase() reportDocument.SaveAs(""D:\RND\Crystal Reports - Connector\CrystallReportConvertVB\CrystallReportConvertVB\Rpt-changed3.rpt"")End Sub Friend Shared Function ChangeOleDbConnectionInfoSubReports(ByVal reportDocument As ReportDocument, ByVal server As String, ByVal database As String, ByVal schema As String, ByVal oledbProvider As String, ByVal integratedSecurity As Boolean, ByVal userId As String, ByVal password As String) As ReportDocument Dim boInnerPropertyBag = New PropertyBag() boInnerPropertyBag.Add(""Application Intent"", ""READWRITE"") boInnerPropertyBag.Add(""Auto Translate"", ""-1"") boInnerPropertyBag.Add(""Connect Timeout"", ""15"") boInnerPropertyBag.Add(""Data Source"", server) boInnerPropertyBag.Add(""DataTypeCompatibility"", ""0"") boInnerPropertyBag.Add(""General Timeout"", ""0"") boInnerPropertyBag.Add(""Initial Catalog"", database) boInnerPropertyBag.Add(""Integrated Security"", If(integratedSecurity, ""True"", ""False"")) boInnerPropertyBag.Add(""Locale Identifier"", ""1033"") boInnerPropertyBag.Add(""MARS Connection"", ""0"") boInnerPropertyBag.Add(""OLE DB Services"", ""-5"") boInnerPropertyBag.Add(""Provider"", oledbProvider) boInnerPropertyBag.Add(""Tag with column collation when possible"", ""0"") boInnerPropertyBag.Add(""Trust Server Certificate"", ""0"") boInnerPropertyBag.Add(""Use DSN Default Properties"", ""False"") boInnerPropertyBag.Add(""Use Encryption for Data"", ""0"") Dim boMainPropertyBag = New PropertyBag() boMainPropertyBag.Add(""Database DLL"", ""crdb_ado.dll"") boMainPropertyBag.Add(""QE_DatabaseName"", database) boMainPropertyBag.Add(""QE_DatabaseType"", ""OLE DB (ADO)"") boMainPropertyBag.Add(""QE_LogonProperties"", boInnerPropertyBag) boMainPropertyBag.Add(""QE_ServerDescription"", server) boMainPropertyBag.Add(""QE_SQLDB"", ""True"") boMainPropertyBag.Add(""SSO Enabled"", ""False"") Dim boConnectionInfo = New CrystalDecisions.ReportAppServer.DataDefModel.ConnectionInfo With { .Attributes = boMainPropertyBag, .Kind = CrConnectionInfoKindEnum.crConnectionInfoKindCRQE } If Not integratedSecurity Then boConnectionInfo.UserName = userId boConnectionInfo.Password = password End If For Each subreport As ReportDocument In reportDocument.Subreports For Each table As CrystalDecisions.ReportAppServer.DataDefModel.Table In reportDocument.ReportClientDocument.SubreportController.GetSubreportDatabase(subreport.Name).Tables Dim boTable = New CrystalDecisions.ReportAppServer.DataDefModel.Table With { .ConnectionInfo = boConnectionInfo, .Name = table.Name, .QualifiedName = schema & ""."" & table.Name, .[Alias] = table.[Alias] } reportDocument.ReportClientDocument.SubreportController.SetTableLocation(subreport.Name, table, boTable) Next Next reportDocument.VerifyDatabase() Return reportDocumentEnd Function",Crystal Reports - change the provider from OLEDBSQL to MSOLEDBSQL to support TLS 1.2 by code
"C# - meaning of curly braces after the ""is"" operator"," I found in some C# source code the following line: and here is another one: What is the meaning of the curly braces ({ }) after the is operator? <code>  if(!(context.Compilation.GetTypeByMetadataName(""Xunit.FactAttribute"") is { } factAttribute)) if(!(diagnostic.Location.SourceTree is { } tree))","Meaning of curly braces after the ""is"" operator"
Passing key from controller to repository," I am currently building an application where each user has an unique key stored in the users' session storage. This key is used to decrypt the users data in the database. Since the repository layer of the application handles database queries (using Dapper) I would like the decryption to take place there.Now the problem: I can retrieve the users key from the session storage, pass it to the controller, then to the service then to the repository using a parameter of name ""key"" in each method that is chained. Is there a way to pass a key from the controller through to the repository layer without having to include the key manually in every call?If there is a better solution than to store it in session storage I am open to it, if it is going to make this easier.The encryption system I am following is as follows (from another SO answer): <code> ",Retrieve users http data in repository service
Uploading and Downloading large files (e.g. 2Gb MP4 file) in chunks in ASP.NET Core 3.1 API?, I am working on an ASP.NET Core 3.1 API project using clean architecture and I have the following classlibs (tiers):Infrastructure (security stuff and upload helpers etc ...)Persistence (DA layer)Domain (Domain Models)Application (use cases - Business logics)API (API Project as my startup project)I want to be able to upload large files to server (like 2Gb of file size or even more) and download them after that and want to do it without having future problems with memory overflowing and everything.Any help would be appreciated. <code> ,Uploading and Downloading large files in ASP.NET Core 3.1?
Uploading and Downloading large files (e.g. 2Gb MP4 file) in ASP.NET Core 3.1 API?, I am working on an ASP.NET Core 3.1 API project using clean architecture and I have the following classlibs (tiers):Infrastructure (security stuff and upload helpers etc ...)Persistence (DA layer)Domain (Domain Models)Application (use cases - Business logics)API (API Project as my startup project)I want to be able to upload large files to server (like 2Gb of file size or even more) and download them after that and want to do it without having future problems with memory overflowing and everything.Any help would be appreciated. <code> ,Uploading and Downloading large files in ASP.NET Core 3.1?
How to mock GetConnectionString() from IConfiguration using moq in XUnit?," Research: Mocking IConfiguration from .NET CoreI need to integration test my data access layer to ensure that all the code is working properly.I know that it isn't going to work using the normal way: Normally the data access layer uses dependency injection and it retrieves the connection string with IConfiguration.My integration test: But I get an errorSystem.InvalidOperationException: The ConnectionString property has not been initialized.I'm a bit lost here, I'm not sure what happened. <code>  //Will return a NotSupportedExceptionvar mock = new Mock<IConfiguration>(); mock.Setup(arg => arg.GetConnectionString(It.IsAny<string>())) .Returns(""testDatabase""); [Fact]public async void GetOrderById_ScenarioReturnsCorrectData_ReturnsTrue(){ // Arrange OrderDTO order = new OrderDTO(); // Mocking the ASP.NET IConfiguration for getting the connection string from appsettings.json var mockConfSection = new Mock<IConfigurationSection>(); mockConfSection.SetupGet(m => m[It.Is<string>(s => s == ""testDB"")]).Returns(""mock value""); var mockConfiguration = new Mock<IConfiguration>(); mockConfiguration.Setup(a => a.GetSection(It.Is<string>(s => s == ""ConnectionStrings:testDB""))).Returns(mockConfSection.Object); IDataAccess dataAccess = new SqlDatabase(mockConfiguration.Object); IRepository repository = new repository(dataAccess, connectionStringData); var connectionStringData = new ConnectionStringData { SqlConnectionLocation = ""testDatabase"" }; // Act int id = await repository.CreateOrder(order); // Assert Assert.Equal(1, id);}",How to mock GetConnectionString() from IConfiguration using moq?
Angular does not adding XSRF-TOKEN when Dot-net core API return a response with XSRF-TOKEN on cookies," I am using Angular10 and .NET core 2.2. I have configured Startup.cs to return a response with an XSRF-TOKEN. The backend is returning it but Angular doesn't pass it on to the browser's cookies.Reference Microsoft doc https://docs.microsoft.com/en-us/aspnet/core/security/anti-request-forgery?view=aspnetcore-3.1#javascript-ajax-and-spasServer-side code <code>  // on ConfigureServices services.AddAntiforgery(options => { options.HeaderName = ""X-XSRF-TOKEN""; });// on Configureapp.Use(next => context => { string path = context.Request.Path.Value; if (path != null && path.ToLower().Contains(""/api"")) { var tokens = antiforgery.GetAndStoreTokens(context); context.Response.Cookies.Append(""XSRF-TOKEN"", tokens.RequestToken, new CookieOptions() { HttpOnly = false }); } return next(context); });",XSRF-TOKEN not added to cookies by Angular (Client side) when .NET core API returns a response with an XSRF-TOKEN
Angular does not adding XSRF-TOKEN to cookies when Dot-net core API return a response with XSRF-TOKEN," I am using Angular10 and .NET core 2.2. I have configured Startup.cs to return a response with an XSRF-TOKEN. The backend is returning it but Angular doesn't pass it on to the browser's cookies.Reference Microsoft doc https://docs.microsoft.com/en-us/aspnet/core/security/anti-request-forgery?view=aspnetcore-3.1#javascript-ajax-and-spasServer-side code <code>  // on ConfigureServices services.AddAntiforgery(options => { options.HeaderName = ""X-XSRF-TOKEN""; });// on Configureapp.Use(next => context => { string path = context.Request.Path.Value; if (path != null && path.ToLower().Contains(""/api"")) { var tokens = antiforgery.GetAndStoreTokens(context); context.Response.Cookies.Append(""XSRF-TOKEN"", tokens.RequestToken, new CookieOptions() { HttpOnly = false }); } return next(context); });",XSRF-TOKEN not added to cookies by Angular (Client side) when .NET core API returns a response with an XSRF-TOKEN
XSRF-TOKEN not added to cookies in Angular when .NET core API returns a response with an XSRF-TOKEN," I am using Angular10 and .NET core 2.2. I have configured Startup.cs to return a response with an XSRF-TOKEN. The backend is returning it but Angular doesn't pass it on to the browser's cookies.Reference Microsoft doc https://docs.microsoft.com/en-us/aspnet/core/security/anti-request-forgery?view=aspnetcore-3.1#javascript-ajax-and-spasServer-side code <code>  // on ConfigureServices services.AddAntiforgery(options => { options.HeaderName = ""X-XSRF-TOKEN""; });// on Configureapp.Use(next => context => { string path = context.Request.Path.Value; if (path != null && path.ToLower().Contains(""/api"")) { var tokens = antiforgery.GetAndStoreTokens(context); context.Response.Cookies.Append(""XSRF-TOKEN"", tokens.RequestToken, new CookieOptions() { HttpOnly = false }); } return next(context); });",XSRF-TOKEN not added to cookies by Angular (Client side) when .NET core API returns a response with an XSRF-TOKEN
Fetch access token from authorization header without bearer prefix and signature," I'm using the Microsoft.AspNetCore.Authentication.JwtBearer and System.IdentityModel.Tokens.Jwt packages for my .NET Core project.There are some controller endpoints protected by the [Authorize] annotation that have to fetch the access token from the request. Currently I'm fetching the access token in my controller method this way: and I would like to know if there is a better ""ready to use"" solution for this because using the code above might still lead to errors while taking the substring from the bearer token. <code>  string accessTokenWithBearerPrefix = Request.Headers[HeaderNames.Authorization];string accessTokenWithoutBearerPrefix = accessTokenWithBearerPrefix.Substring(""Bearer "".Length);",Fetch access token from authorization header without bearer prefix
Azure .NET Core Web App: Making ConfigureServices function asyncronous causes error," After changing the signature of the function ConfigureServices to be asynchronous (originally it was just a void synchronous function and the application worked perfectly fine), I get the following error:Unable to find the required services. Please add all the required services by calling IServiceCollection.AddAuthorization inside the call to ConfigureServices(...) in the application startup code.Below is the code of my ConfigureServices function. ConfigureServices is automatically called at runtime. <code>  // This method gets called by the runtime. Use this method to add services to the container.public async Task ConfigureServices(IServiceCollection services){ services.AddRazorPages(); // Create the necessary Cosmos DB infrastructure await CreateDatabaseAsync(); await CreateContainerAsync();}",Run async code during startup in a ASP.Net Core application
Azure .NET Core Web App: Making ConfigureServices function asynchronous causes error," After changing the signature of the function ConfigureServices to be asynchronous (originally it was just a void synchronous function and the application worked perfectly fine), I get the following error:Unable to find the required services. Please add all the required services by calling IServiceCollection.AddAuthorization inside the call to ConfigureServices(...) in the application startup code.Below is the code of my ConfigureServices function. ConfigureServices is automatically called at runtime. <code>  // This method gets called by the runtime. Use this method to add services to the container.public async Task ConfigureServices(IServiceCollection services){ services.AddRazorPages(); // Create the necessary Cosmos DB infrastructure await CreateDatabaseAsync(); await CreateContainerAsync();}",Run async code during startup in a ASP.Net Core application
Run async code during startup in a Dotnet/ASP.Net Core application," After changing the signature of the function ConfigureServices to be asynchronous (originally it was just a void synchronous function and the application worked perfectly fine), I get the following error:Unable to find the required services. Please add all the required services by calling IServiceCollection.AddAuthorization inside the call to ConfigureServices(...) in the application startup code.Below is the code of my ConfigureServices function. ConfigureServices is automatically called at runtime. <code>  // This method gets called by the runtime. Use this method to add services to the container.public async Task ConfigureServices(IServiceCollection services){ services.AddRazorPages(); // Create the necessary Cosmos DB infrastructure await CreateDatabaseAsync(); await CreateContainerAsync();}",Run async code during startup in a ASP.Net Core application
Azure Durable Framwork Function App VERY Slow," I have made an app that uses azure functions durable fan-out strategy to make parallel inquiries and updates to a database by sending http requests to our own internal API.I found out that the fan-out strategy is EXTREMELY slower than it would be to use TPL library and doing parallelism this way on a normal .net Core webapp. It's not just slower it's about 20 times slower. It takes 10 minutes for 130 updates while the .net core 3.1 app that I've made for speed comparisson that does the exact same thing does 130 updates in 0.5 minutes and in a significantly lower plan.I understand there is a latency becuase of the durable framwork infrastructure (communicating with the storage account and whatnot) but I don't see how that speed difference is normal. Each individual update happens in an ActivityTrigger function and the orchestrator is the one that gathers all the necessary updates and puts them in a Task.WhenAll() call just like the example from Microsoft docs.Am I doing something wrong here? Is this business scenario maybe not compatible with this technology? The code seems to work fine and the parallelism works It's just a LOT slower than the .net core app. Another thing to mention is that the moment the function opens a second instance (due to either it being in consuption plan and naturally openning a second instance to deal with heavy load or it being in appservice plan and I manually opening an instance) it goes even slower although the cpu load somehow balances in the two instances. I suspect this could be extra latency due to azure queue comunication between the two instances but I'm not entirely sure.One last detail is that the app also has a TimeTrigger that does a simple select in a database every one minute (nothing even remotely cpu intensive but it might play a role in the performance).I've tried the function app in a premium plan, consuption plan, and appservice plan and it seems to top at 130 updates in 10 minutes no matter how huge the plan is. <code> ",Azure Durable Framework Function App VERY Slow
How Ignore Empty string And Null in deserialisation using System.Text.Json," In .Net Core 3.1 and using System.Text.Json library, I'm facing an issue that didn't occur in Newtonsoft library.If I send an empty string in JSON for some properties of type (type in backend) DateTime? or int?, it returns 400 status code with an error message that value can't be deserialized. However, with Newtonsoft an empty string is automatically interpreted as a null value for any Nullable<T>.A minimal example would be: Is there any way to make System.Text.Json behave in the same way? Demo here. <code>  var json = ""\""\"""";Assert.AreEqual(null, Newtonsoft.Json.JsonConvert.DeserializeObject<DateTime?>(json)); // PassesAssert.AreEqual(null, System.Text.Json.JsonSerializer.Deserialize<DateTime?>(json)); // Throws System.Text.Json.JsonException: The JSON value could not be converted to System.Nullable`1[System.DateTime].",How to deserialize an empty string to a null value for all `Nullable<T>` value types using System.Text.Json?
How to force ASP.NET 5 source code to not be optimized," I'm trying to debug the Antiforgery code in the ASP.NET Core framework.I have built the code successfully using the instructions in https://github.com/dotnet/aspnetcore/blob/master/docs/BuildFromSource.md using the Debug configuration.I have added the source code project to my test project and referenced it.I've checked that the Configuration is set to Debug.I've made sure that ""Suppress JIT Optimizations"" has been checked.""Optimize Code"" in Project Properties -> Build, is unchecked for both projects.""Debug Info"" dropdown has been set to ""Full"" in the Advanced Options (Under Build tab) for both projects.However when I hit the breakpoint in DefaultAntiforgeryTokenSerializer.Serialize(), it gives me this error when viewing the method's local vars in the Watch window:Cannot obtain value of local or argument as it is not available atthis instruction pointer, possibly because it has been optimized awayHow can I force the code to not be optimized?I'm using Visual Studio Enterprise 2019 v16.8.3. <code> ",How to force ASP.NET Core source code to not be optimized
How to force ASP.NET Core 5 source code to not be optimized," I'm trying to debug the Antiforgery code in the ASP.NET Core framework.I have built the code successfully using the instructions in https://github.com/dotnet/aspnetcore/blob/master/docs/BuildFromSource.md using the Debug configuration.I have added the source code project to my test project and referenced it.I've checked that the Configuration is set to Debug.I've made sure that ""Suppress JIT Optimizations"" has been checked.""Optimize Code"" in Project Properties -> Build, is unchecked for both projects.""Debug Info"" dropdown has been set to ""Full"" in the Advanced Options (Under Build tab) for both projects.However when I hit the breakpoint in DefaultAntiforgeryTokenSerializer.Serialize(), it gives me this error when viewing the method's local vars in the Watch window:Cannot obtain value of local or argument as it is not available atthis instruction pointer, possibly because it has been optimized awayHow can I force the code to not be optimized?I'm using Visual Studio Enterprise 2019 v16.8.3. <code> ",How to force ASP.NET Core source code to not be optimized
How to disable automatic model binding for a specific ASP.NET Core 5.0 web API action?," I have a third-party proprietary application, for which I need to write an API endpoint in my ASP.NET Core 5.0 web API application.The third party application sends out an HTTP post request, with only binary data in the request body, alongside the content type application/x-www-form-urlencoded or, sometimes, application/octet-stream (kind of random, but the data is the same).My action handler looks like this: When the third-party application is sending its HTTP post request to my API endpoint, my API application crashes with a System.ArgumentException: The logs are showing that the correct route action is being used.How do I disable automatic model binding for only this specific action handler?Reminder: I cannot do any changes to the third-party application. I have to handle what I receive. I know the request content type is wrong. Please don't make any notes in that regard.Edit: I have found the surface-level cause for this error. When I remove [FromRoute] string requestId from the function signature, the error will not occur. When I reintroduce it, the error occurs again.Does not work (causes ASP.NET Core internal exception): Does work: However, I need to access the route variable through Request.RouteValues[""requestId""].Anyway, the question still stands:How do I disable automatic model binding for only this specific action handler? <code>  [Route(""~/Validation"")][ApiController]public class ValidationController : ControllerBase{ [HttpPost(""{requestId}"")] [Consumes(@""application/octet-stream"", @""application/x-www-form-urlencoded"")] [Produces(@""application/octet-stream"")] public async Task<IActionResult> Validation_Post([FromRoute] string requestId) { byte[] rawRequestBody = Array.Empty<byte>(); { long streamInitialPos = 0; if (Request.Body.CanSeek) // rewind for this read. { streamInitialPos = Request.Body.Position; Request.Body.Seek(0, SeekOrigin.Begin); } using (var ms = new MemoryStream()) { await Request.Body.CopyToAsync(ms); rawRequestBody = ms.ToArray() ?? throw new NullReferenceException(); } if (Request.Body.CanSeek) // rewind to initial position. Request.Body.Seek(streamInitialPos, SeekOrigin.Begin); } // TODO: Handle rawRequestBody data. return new FileContentResult(new byte[] { 1 }, @""application/octet-stream"") { EnableRangeProcessing = true, LastModified = DateTime.UtcNow }; } Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Error: Connection ID ""18374686481282236432"", Request ID ""80000011-0000-ff00-b63f-84710c7967bb"": An unhandled exception was thrown by the application.System.ArgumentException: The key '[omitted binary data]' is invalid JQuery syntax because it is missing a closing bracket. (Parameter 'key') at Microsoft.AspNetCore.Mvc.ModelBinding.JQueryKeyValuePairNormalizer.NormalizeJQueryToMvc(StringBuilder builder, String key) at Microsoft.AspNetCore.Mvc.ModelBinding.JQueryKeyValuePairNormalizer.GetValues(IEnumerable`1 originalValues, Int32 valueCount) at Microsoft.AspNetCore.Mvc.ModelBinding.JQueryFormValueProviderFactory.AddValueProviderAsync(ValueProviderFactoryContext context) at Microsoft.AspNetCore.Mvc.ModelBinding.CompositeValueProvider.CreateAsync(ActionContext actionContext, IList`1 factories) at Microsoft.AspNetCore.Mvc.ModelBinding.CompositeValueProvider.TryCreateAsync(ActionContext actionContext, IList`1 factories) at Microsoft.AspNetCore.Mvc.Controllers.ControllerBinderDelegateProvider.<>c__DisplayClass0_0.<<CreateBinderDelegate>g__Bind|0>d.MoveNext()--- End of stack trace from previous location --- at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()--- End of stack trace from previous location --- at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker) at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger) at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()Microsoft.AspNetCore.Hosting.Diagnostics: Information: Request finished HTTP/1.1 POST http://localhost:10891/validation/dummy application/x-www-form-urlencoded 11072 - 500 - - 164.0024ms public async Task<IActionResult> Validation_Post([FromRoute] string requestId) public async Task<IActionResult> Validation_Post()",How do I disable automatic model binding for a specific ASP.NET Core 5.0 Web API action?
How to change the combobox slide button color, How could I change the slide button color?not border color and not slide item colors.I already change the slide item colorsIs there any way to change the color? <code> ,How to change the ComboBox dropdown button color
Calculate centroid of 3D mesh of triangles," I'm trying to calculate the centroid of a 3D mesh of triangles.EDIT : it turns out I was not, I was trying to calculate the center of gravity, which is not the sameMy code is made of bits and pieces, mainly :This nice paper by Cha Zhang and Tsuhan ChenSO : How to calculate the volume of a 3D mesh object the surface of which is made up trianglesSO : How to compute the centroid of a mesh with triangular faces?I compared my results to those provided by Rhino. I calculate the centroid and volume :of the reference NURBS volume with Rhino 7of a 27k triangle mesh with Rhino 7of a simplified 1k triangle mesh with Rhino 7of the same 1k triangle mesh with my code.As you can see, it works great to calculate the volume, but not for the centroid, and i can't seem to know why. I need the error to be less than 0.01. I checked everything several times, but there must be something obvious.I'm not great with numerical instability :should I work in milimeters instead of meters ?should I calculate the tetrahedrons signed volume with another point than the origin, as suggested by galinette in the second reference ? I tried and it didn't improve much.MY CODEBefore calculationg anything, I check that my mesh is correct (code not provided) :closed mesh, no naked edges or any holes ;the vertices of all triangles are ordered consistently, i.e. triangles are correctly oriented towards the outside of the mesh. <code>  using HelixToolkit.Wpf;using System.Collections.Generic;using System.Windows.Media.Media3D;internal static class CentroidHelper{ public static Point3D Centroid(this List<MeshGeometry3D> meshes, out double volume) { Vector3D centroid = new Vector3D(); volume = 0; foreach (var mesh in meshes) { var c = mesh.Centroid(out double v); volume += v; centroid += v *c ; } return (centroid / volume).ToPoint3D(); } public static Vector3D Centroid(this MeshGeometry3D mesh, out double volume) { Vector3D centroid = new Vector3D(); double totalArea = 0; volume = 0; for (int i = 0; i < mesh.TriangleIndices.Count; i += 3) { var a = mesh.Positions[mesh.TriangleIndices[i + 0]].ToVector3D(); var b = mesh.Positions[mesh.TriangleIndices[i + 1]].ToVector3D(); var c = mesh.Positions[mesh.TriangleIndices[i + 2]].ToVector3D(); var triangleArea = AreaOfTriangle(a, b, c); totalArea += triangleArea; centroid += triangleArea * (a + b + c) / 3; volume += SignedVolumeOfTetrahedron(a, b, c); } return centroid / totalArea; } private static double SignedVolumeOfTetrahedron(Vector3D a, Vector3D b, Vector3D c) { return Vector3D.DotProduct(a, Vector3D.CrossProduct(b, c)) / 6.0d; } private static double AreaOfTriangle(Vector3D a, Vector3D b, Vector3D c) { return 0.5d * Vector3D.CrossProduct(b - a, c - a).Length; }} ",Calculate the centroid of a 3D mesh of triangles
C# - How to call a constructor with an ambiguous generic parameter?," I have the following generic class: I want to create an instance of this class with T being a string, using constructor B.Calling new Foo<string>(""Hello"") uses constructor A. How can I call constructor B (without using reflection)? <code>  class Foo<T>{ //Constructor A public Foo(string str) { Console.Write(""A""); } //Constructor B public Foo(T obj) { Console.Write(""B""); }}",How to call a constructor with an ambiguous generic parameter?
"Why does ECDsa produce different signatures for the same data, whereas RSA doesn't?"," Consider the following code using RSA...Example: Output:043a718774c572bd8a25adbeb1bfcd5c0256ae11cecf9f9c3f925d0e52beaf89043a718774c572bd8a25adbeb1bfcd5c0256ae11cecf9f9c3f925d0e52beaf89043a718774c572bd8a25adbeb1bfcd5c0256ae11cecf9f9c3f925d0e52beaf89043a718774c572bd8a25adbeb1bfcd5c0256ae11cecf9f9c3f925d0e52beaf89043a718774c572bd8a25adbeb1bfcd5c0256ae11cecf9f9c3f925d0e52beaf89Now consider the same code, except using ECDSA...Example: Output:043a718774c572bd8a25adbeb1bfcd5c0256ae11cecf9f9c3f925d0e52beaf89a31fe9656fc8d3a459e623dc8204e6d0268f8df56d734dac3ca3262edb5db883a871c47a7f48a12b38a994e48a9659fab5d6376f3dbce37559bcb617efe8662dd7ef0a04f3c8055644677299a9414a75adcb15916eb48417416c9317ace2ff4f779f5dd63960abda52a7da70464b92eedd47f84a8dffda2d672e6a99de1bab95RSA's signature output I expected; ECDSA's, I didnt. Why does ECDSA produce different signatures for the same data? <code>  byte[] raw = Encoding.Default.GetBytes(""Hello, World!"");RSA key = RSA.Create();for (int index = 0; index < 5; index++){ byte[] signed = key.SignData(raw, HashAlgorithmType.SHA256, RSASignaturePadding.Pkcs1); string hashed = signed.ToSha256String(); Console.WriteLine(hashed);} byte[] raw = Encoding.Default.GetBytes(""Hello, World!"");ECDsa key = ECDsa.Create();for (int index = 0; index < 5; index++){ byte[] signed = key.SignData(raw, HashAlgorithmType.SHA256); string hashed = signed.ToSha256String(); Console.WriteLine(hashed);}","Why does ECDSA produce different signatures for the same data, whereas RSA doesn't?"
Date Only cannot be mapped SQL 2019," I am trying to use the new DateOnly aspects of c# but when I come to do my migrations I am having the following issue. I am using SQL Server 2019 the error is.'Amenitie.StartDate could not be mapped because it is of type 'DateOnly', which is not a supported primitive type or a valid entity type. Either explicitly map this property, or ignore it using the'My model is as follows My Dal project and my web project are both set to I am using the following package versions. Is DateOnly available in EF Core 6 and above I presume? <code>  public class Amenitie{ public int? Id { get; set; } public Rooms? Rooms { get; set; } public string? Description { get; set; } public DateOnly StartDate { get; set; } public DateOnly EndDate { get; set; } public bool? isAvailable { get; set; } public bool? isDeleted { get; set; } public bool? isActive { get; set; } public DateTime? LastModifiedBy { get; set; } public DateTime? CreateDate { get; set; }} <PropertyGroup> <TargetFramework>net6.0</TargetFramework> <Nullable>enable</Nullable></PropertyGroup> <ItemGroup> <PackageReference Include=""Microsoft.AspNetCore.Identity"" Version=""2.2.0"" /> <PackageReference Include=""Microsoft.AspNetCore.Identity.EntityFrameworkCore"" Version=""5.0.9"" /> <PackageReference Include=""Microsoft.EntityFrameworkCore"" Version=""5.0.9"" /> <PackageReference Include=""Microsoft.EntityFrameworkCore.Design"" Version=""5.0.9""> <PrivateAssets>all</PrivateAssets> <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets> </PackageReference> <PackageReference Include=""Microsoft.EntityFrameworkCore.Relational.Design"" Version=""2.0.0-preview1-final"" /> <PackageReference Include=""Microsoft.EntityFrameworkCore.SqlServer"" Version=""5.0.9"" /> <PackageReference Include=""Microsoft.EntityFrameworkCore.SqlServer.Design"" Version=""2.0.0-preview1-final"" /> <PackageReference Include=""Microsoft.EntityFrameworkCore.Tools"" Version=""5.0.9""> <PrivateAssets>all</PrivateAssets> <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets> </PackageReference> <PackageReference Include=""Microsoft.Extensions.Configuration"" Version=""5.0.0"" /></ItemGroup>",Date Only cannot be mapped SQL Server 2019
".net 6 Configuration object, how to get it?"," In earlier versions, we had Startup.cs class and we get configuration object as follows in the startup file. Now in .NET 6 (With Visual Studio 2022), we don't see the Startup.cs class. Looks like its days are numbered. So how do we get these objects like Configuration(IConfiguration) and Hosting Environment(IHostEnvironment)How do we get these objects, to say read the configuration from appsettngs? Currently the Program.cs file looks like this. I want to read the configuration from appsettings file. <code>  public class Startup{ private readonly IHostEnvironment environment; private readonly IConfiguration config; public Startup(IConfiguration configuration, IHostEnvironment environment) { this.config = configuration; this.environment = environment; } public void ConfigureServices(IServiceCollection services) { ... } public void Configure(IApplicationBuilder app, IWebHostEnvironment env) { ... }} using Festify.Database;using Microsoft.EntityFrameworkCore;var builder = WebApplication.CreateBuilder(args);// Add services to the container.builder.Services.AddRazorPages();builder.Services.AddDbContext<FestifyContext>();////////////////////////////////////////////////// The following is Giving me error as Configuration // object is not avaible, I dont know how to inject this here.////////////////////////////////////////////////builder.Services.AddDbContext<FestifyContext>(opt => opt.UseSqlServer( Configuration.GetConnectionString(""Festify"")));var app = builder.Build();// Configure the HTTP request pipeline.if (!app.Environment.IsDevelopment()){ app.UseExceptionHandler(""/Error""); // The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts. app.UseHsts();}app.UseHttpsRedirection();app.UseStaticFiles();app.UseRouting();app.UseAuthorization();app.MapRazorPages();app.Run();",ASP.NET Core 6 how to access Configuration during startup
ASP.NET Core 6 how to access Configuration during setup," In earlier versions, we had Startup.cs class and we get configuration object as follows in the startup file. Now in .NET 6 (With Visual Studio 2022), we don't see the Startup.cs class. Looks like its days are numbered. So how do we get these objects like Configuration(IConfiguration) and Hosting Environment(IHostEnvironment)How do we get these objects, to say read the configuration from appsettngs? Currently the Program.cs file looks like this. I want to read the configuration from appsettings file. <code>  public class Startup{ private readonly IHostEnvironment environment; private readonly IConfiguration config; public Startup(IConfiguration configuration, IHostEnvironment environment) { this.config = configuration; this.environment = environment; } public void ConfigureServices(IServiceCollection services) { ... } public void Configure(IApplicationBuilder app, IWebHostEnvironment env) { ... }} using Festify.Database;using Microsoft.EntityFrameworkCore;var builder = WebApplication.CreateBuilder(args);// Add services to the container.builder.Services.AddRazorPages();builder.Services.AddDbContext<FestifyContext>();////////////////////////////////////////////////// The following is Giving me error as Configuration // object is not avaible, I dont know how to inject this here.////////////////////////////////////////////////builder.Services.AddDbContext<FestifyContext>(opt => opt.UseSqlServer( Configuration.GetConnectionString(""Festify"")));var app = builder.Build();// Configure the HTTP request pipeline.if (!app.Environment.IsDevelopment()){ app.UseExceptionHandler(""/Error""); // The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts. app.UseHsts();}app.UseHttpsRedirection();app.UseStaticFiles();app.UseRouting();app.UseAuthorization();app.MapRazorPages();app.Run();",ASP.NET Core 6 how to access Configuration during startup
Redirect to Another Page when First Time Login in ASP.NET Core," currently I'm building web apps for local. When I create new user, I'm setup the user with Default Password. And I want to, if the User login with the Default Password it will redirect to Change Password Page. And User will not be able to access any page until they change the password.My current workaround is checking in each controller, is there any Smart way to do this?Here's some code after doing login For the other Controller, we always check the Password from session. If the Password is same as Default Password we redirect it to NewPassword PageThanks in advance! <code>  [HttpPost][AllowAnonymous][ValidateAntiForgeryToken]public async Task<IActionResult> Login([FromForm] LoginViewModel vm, string returnUrl = null){ if (ModelState.IsValid) { var result = await repository.Login(vm); if (result.IsSuccess) { await HttpContext.SignInAsync(CookieAuthenticationDefaults.AuthenticationScheme, result.Data, new AuthenticationProperties { IssuedUtc = DateTime.UtcNow, ExpiresUtc = DateTime.UtcNow.AddDays(1), IsPersistent = false }); if (vm.Password != Password.DefaultPassword) { return RedirectToLocal(returnUrl); } else { return RedirectToAction(nameof(UserController.NewPassword)); } } else { ViewBag.ErrorMessage = result.ErrorMessage; } } return View(vm);}",Force Redirect to Another Page when First Time Login in ASP.NET Core
How to bind selected values from dropdownlists in a dynamically generated table? MVC .Net Core," In my ASP.NET Core MVC project there is a table with two columns containing dropdownlists where the user is supposed to pick rates values and click save to update them for each row in the table. There are dozens of dynamically generated rows in total, which results in twice as many dropdownlists with values to track.Again, the goal is to update each row with the values selected in the two dropdownlists in that row.I was able to create the table and display the values. There is a loop that generates each row in the table. The issue I am having is not knowing how to pass all of the values from all of the dropdownlists back to the controller along with rownumbers so I can write the logic to update the values in the database. I can pass a single dropdown combination from the first row and I don't know how to do the same for all of them or indicate which row they are from. The fact that dropdownlists are in a loop makes this difficult.This is the part of the view where I display the table: This is the model: As you can see I added IEnumerable<SelectListItem> object because I thought they would need to be used and iterated in the controller. This is a guess, I don't know how to bind to them. And it's important I associate them with the correct row.This is what I came up with in the controller for the header, the actual code inside is not relevant to the question: Any help would be appreciated. Please let me know if something is not clear, I did my best to describe this question. Thank you! <code>  <tbody> @foreach (var item in Model.WorksheetRates) { var recordNumber = PagedContext.Page * PagedContext.PageSize + Model.WorksheetRates.IndexOf(item) + 1; <tr> <td>@recordNumber</td> <td> @item.Program </td> <td> @item.Area </td> <td> @Html.DropDownListFor(x => x.GARateID, gaRatesList, new { @style = ""width:280px;"" }) </td> <td> @Html.DropDownListFor(x => x.OverheadRateID, overheadRatesList, new { @style = ""width:280px;"" }) </td> </tr> } </tbody> public class BudgetPrepViewModel{ public List<WorksheetRate> WorksheetRates { get; set; } public int GARateID { get; set; } public int OverheadRateID { get; set; } public IEnumerable<SelectListItem> GARateList { get; set; } public IEnumerable<SelectListItem> OverheadRateList { get; set; }} [HttpPost, ActionName(""SelectRates"")]public IActionResult SelectRates([Bind(""GARateID, OverheadRateID"")] BudgetPrepViewModel data){ BPViewModel model = new BPViewModel { MonthNameList = MonthSelectList(), PrepStep = 8 }; return View(""Index"", model);}",How to bind selected values from dropdownlists in a dynamically generated table? ASP.NET Core MVC
